'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1003:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.MCa=this.jnb=this.Qbe=this.sfe=this.q9b=this.m7e=null}}Object(K.a)(h,"AppsForOfficeOauthResult",null,[])},1004:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=
this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static c6f(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(K.a)(h,"WopiAuthContext",null,[1166])},1297:function(K,S,d){d.r(S);var h=d(0),e=d(18),r=d(395),m=d(275);class n{constructor(){this.UXh=new e.a}get nMc(){return this.UXh}kqj(I){r.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",I);const V=
new e.a;for(let Ba of this.nMc)for(let cb of Ba.Smc)cb.id===I&&V.add(cb);return V}xui(){var I=this.kqj("ContextMenuText");if(I&&0<I.count){const V=Object.assign(new m.a,{ControlList:[]});for(let Ba of I)I=Ba.Ewc(),0<I.length&&Array.addRange(V.ControlList,I);return V}return null}Yyf(I){this.nMc.add(I)}i$k(I){for(let V of this.nMc)if(V.oCf===I.oCf){this.nMc.remove(V);break}}static LXi(I,V,Ba=null){I=n.Sgj(I);0<I.length&&(n.std(I,!1),Ba&&Ba(V,I))}static Sgj(I){const V=[];if(I&&I.Smc&&0<I.Smc.count)for(let Ba of I.Smc)if(Ba.controls&&
0<Ba.controls.count)for(let cb of Ba.controls)if(cb.menuItems&&0<cb.menuItems.count)for(let Nb of cb.menuItems)Array.add(V,Nb.id);return V}static std(I,V){if(I.length){var Ba=[];for(const cb of I)Ba.push(appChrome.actions.updateControlEnabledDisabledState(cb,V));appChrome.api.dispatch(Ba)}}}Object(h.a)(n,"ContextMenuExtensibilityCache",null,[757,758]);var z=d(27),t=d(379),x=d(107),B=d(71),D=d(7);class w{constructor(I,V,Ba){this._id=I;this.uWh=V;this.EYh=Ba;this.Jng=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get VUd(){return this.uWh}get nGi(){return this.EYh}execute(I,
V,Ba){Ba=Ba||{};Ba.commandMode=this.Jng;V.invokeAppCommand(this.VUd,this.nGi,Ba,(cb,Nb)=>{I.bch(this.id,this.VUd,cb,Nb)})}}Object(h.a)(w,"AddinNativeActionBase",null,[739]);class J extends w{constructor(I,V){super(1,I,V);this.Jng=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(J,"AddinTakeSnapshotAction",w,[]);class F{iQf(I,V){let Ba=null;switch(I){case 1:Ba=new J(V,this.A$d().getNativeActionName(I));break;case 2:Ba=new w(2,V,this.A$d().getNativeActionName(I));break;case 3:Ba=new w(3,V,this.A$d().getNativeActionName(I))}return Ba}A$d(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(F,"AddinNativeActionManager",null,[688]);class L{invokeAppCommand(I,V,Ba,cb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,V,Ba,cb)}static getInstance(){L.La||(L.La=new L);return L.La}}L.La=null;Object(h.a)(L,"OSFAddinCommandsRuntimeManager",null,[687]);var M=d(78);class Q{constructor(){this.xXf=this.displayName=this.f3b=this.$H=this.VM=null;this.isUpgraded=!1}Ftg(I,V){return this.VM.getStoreType().toLowerCase()===I.toLowerCase()&&this.VM.getSolutionId().toLowerCase()===V.toLowerCase()}}
Object(h.a)(Q,"AddinCommandsResourceItem",null,[]);class C{constructor(){this.TBd=null;this.UGd=0;this.vId=!1;this.Oa=new M.a;this.g2h=new e.a}Nhi(I){this.Oa.addHandler("AddinCommandsLoadingMessageChanged",I)}get $_b(){return this.TBd}FOb(I){I!==this.TBd&&(this.TBd=I,this.Oa.raiseEvent("AddinCommandsLoadingMessageChanged"))}Xnl(){this.UGd++;this.$_b||this.FOb(CommonUIStrings.l_LoadingAddInsTitle)}A0e(){this.UGd--;this.R5c()&&(this.vId?this.$_b!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.FOb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.FOb(null))}tpl(){this.vId=!0;this.FOb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}TLf(){this.vId=!1;this.R5c()?this.FOb(null):this.FOb(CommonUIStrings.l_LoadingAddInsTitle)}R5c(){return 0>=this.UGd}get DAb(){return this.g2h}p$a(I,V,Ba=0){for(let cb of this.DAb)if(cb.Ftg(I,V)&&(!cb.$H||cb.$H.Bcj===Ba))return cb;return null}Izf(I,V,Ba,cb){const Nb=new Q;Nb.VM=I;Nb.$H=V;Nb.f3b=Ba;Nb.displayName=cb;this.DAb.add(Nb)}Kfi(I,V,Ba,cb){const Nb=new Q;Nb.VM=I;Nb.$H=V;Nb.f3b=null;Nb.xXf=Ba;Nb.displayName=
cb;this.DAb.add(Nb)}R9k(I,V){let Ba=0;for(let cb of this.DAb)cb.VM.getStoreType()===I&&cb.VM.getSolutionId()===V?this.DAb.removeAt(Ba):Ba++}static getInstance(){C.La||(C.La=new C);return C.La}}C.La=null;Object(h.a)(C,"AddinCommandsResourceManager",null,[]);var O=d(201),U=d(453),T=d(175),ca=d(146);class N extends Sys.EventArgs{constructor(){super();this.$H=this.Aw=null}}Object(h.a)(N,"InsertionParamEventArgs",Sys.EventArgs,[]);class da{constructor(I,V,Ba,cb,Nb,Ec){this.Az=I;this.Aw=V;this.Hga=Ba;this.displayName=
Nb;this.owg=Ec}}Object(h.a)(da,"PostLaunchAddinCommandsParameters",null,[]);var Y=d(15),fa=d(16),aa=d(1172),ka=d(36),H=d(47);class ra{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(ra,"AddinAbstract",null,[]);var ha=d(1253);class Ma{constructor(I,V,Ba,cb=null){this.Asc=z.AFrameworkApplication.fa.Ha("RoamingServiceHandlerWebServiceBase");this.appName=I;this.fVb=V;this.cVb=Ba;this.YXb=cb}u7d(I){this.O3i(I,Object(D.a)(this,this.Bab,"getRequestSuccessCallback"),Object(D.a)(this,
this.YEa,"getRequestFailureCallback"))}O3i(I,V,Ba){const cb=new Sys.StringBuilder(this.Asc);cb.append("RoamingServiceHandler.ashx?action=");cb.append("getAddinTeachingCalloutSettings");cb.append("&");cb.append(this.Cde(I));cb.append("&");cb.append(z.AFrameworkApplication.Pg);z.AFrameworkApplication.Je.qj(cb.toString(),1,null,null,!0,2,V,Ba,null)}GSc(I){this.V3i(I)}V3i(I){var V=new Sys.StringBuilder(this.Asc);V.append("RoamingServiceHandler.ashx?action=");V.append("saveAddinTeachingCalloutSettings");
V.append("&");V.append(z.AFrameworkApplication.Pg);V=V.toString();I=ka.c(I);z.AFrameworkApplication.Je.qj(V,2,I,null,!0,4,null,Object(D.a)(this,this.BKa,"postRequestFailureCallback"),null)}Bab(I){let V=!1,Ba=null;try{if(0<I.data.Wd.length){const cb=Object(ha.a)(Object,ka.a(I.data.Wd)),Nb=cb?cb[this.appName]:null;Nb&&(Ba=Object(ha.a)(Object,ka.a(Nb.toString())))}V=!0}catch(cb){this.YEa(null)}V&&this.fVb&&this.fVb(Ba)}YEa(I){this.cVb&&this.cVb(I?I.data:null)}BKa(I){this.YXb&&this.YXb(I?I.data:null)}Cde(I){const V=
new Sys.StringBuilder("requestedsettings=");for(let Ba=0;Ba<I.count;Ba++)V.append(I.ga(Ba)),Ba<I.count-1&&V.append(";");return V.toString()}}Object(h.a)(Ma,"AddinTeachingUIRoamingRequestHandler",null,[]);class Ga extends Sys.EventArgs{constructor(I){super();this.solutionId=I.solutionId;this.assetId=I.assetId;this.storeType=I.storeType;this.storeId=I.storeId;this.assetStoreId=I.assetStoreId;this.targetType=I.targetType;this.width=I.width;this.height=I.height;this.displayName=I.displayName;this.version=
I.version}}Object(h.a)(Ga,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var na=d(126),wa=d(177);class Fa{constructor(I){this.ftb=this.Aw=null;this.Uuh=!1;this.dOa=this.Syc=this.vya=this.Xi=this.VBd=this.$Mb=null;this.Ir=I}get appName(){return z.AFrameworkApplication.fa.Ha("WebAppShortName")}get RBf(){this.VBd||(this.VBd=new Ma(this.appName,Object(D.a)(this,this.Bab,"getRequestSuccessCallback"),Object(D.a)(this,this.YEa,"getRequestFailureCallback"),Object(D.a)(this,this.BKa,"postRequestFailureCallback")));
return this.VBd}get VQa(){this.Syc||(this.Syc=new e.a);return this.Syc}set VQa(I){this.Syc=I}get S8a(){this.dOa||(this.dOa=new e.a);return this.dOa}set S8a(I){this.dOa=I}Iei(I,V){window.addEventListener?(this.Aw=I,this.ftb=V,window.addEventListener("LaunchAddinTaskpane",Object(D.a)(this,this.VIk,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(D.a)(this,this.PGk,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(D.a)(this,
this.MFk,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.D$g,"onCampaignLaunchedHandler"),!0)):r.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}xNl(I,V,Ba,cb){this.Xi=I;this.VQa=V;this.S8a=Ba;this.vya=cb;r.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",V?V.count.toString():"null",Ba?Ba.count.toString():"null");0<this.VQa.count||
0<this.S8a.count?(I=new e.a,I.add(this.appName),this.RBf.u7d(I)):this.vya(new e.a,null)}VIk(){const I=new Y.ScriptSharpLegacyMap;this.ftb&&this.ftb.tabs&&!this.ftb.tabs[0].isOfficeTab&&I.$("SDX.FeatureFlags","NonOfficeTab");this.VCb(Fa.r4(this.Aw),"ClickOnLaunch",I);this.Sgd();this.ftb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.ftb,()=>{const V=new N;V.Aw=this.Aw;this.Ir.raiseEvent(O.a.Hwg,V)}):r.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}MFk(){this.VCb(Fa.r4(this.Aw),
"ClickOnClose");this.Sgd()}PGk(){this.VCb(Fa.r4(this.Aw),"ClickOnDismiss");this.Sgd()}D$g(I){if(I&&(I=I.detail)&&I.id&&this.CXj(I.id)){const V=(I.action||"").toLowerCase();if(I.success&&"opened"===V)this.VCb(Fa.r4(this.Aw),"CampaignLaunched"),r.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.Sgd(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.D$g,"onCampaignLaunchedHandler"),!0);else{let Ba;try{Ba=
JSON.stringify(I),r.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Ba)}catch(cb){Ba="id : "+I.id+" telemetryEventName: "+I.telemetryEventName,r.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Ba+" Error: "+(cb?cb.toString():""))}}}}CXj(I){I=H.a.ug(I);return-1!==I.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==I.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==I.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==I.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||
-1!==I.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==I.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}Prd(I){if(this.appName){const V={},Ba={};Ba.LastTeachingUIShowTime=(new Date).toUTCString();Ba.AddinHasShown=I;V[this.appName]=ka.c(Ba);this.RBf.GSc(V);r.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else r.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")}Sgd(){if(!this.Uuh){const I=
window.g_roamingAddinList;I&&(this.Prd(I),this.Uuh=!0)}}Bab(I){I?this.Hyl(I)?(r.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.$Mb="AddinHasShown"in I&&I.AddinHasShown?I.AddinHasShown.toString():null,this.tOf()):(r.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.vya(this.VQa,null)):(r.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.$Mb=null,this.tOf())}YEa(I){r.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",
I?I.Oe:-1);this.vya(this.VQa,null)}BKa(I){r.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",I?I.Oe:-1)}tOf(){const I=this.GWi();0===I.targetType?(I.solutionId?this.h_k(I):this.VCb(null,"NoSolutionId"),this.eRh(I),this.vya(this.VQa,null)):this.vya(this.VQa,I);r.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",I.addinId)}h_k(I){const V=new aa.a;V.callbackFunc=Ba=>{if(Ba.errorCode){this.VCb(I.solutionId,"FailToGetAppDetails");var cb=
window.g_roamingAddinList;cb&&this.Prd(cb)}else if(Ba.value)for(cb of Ba.value)if(Ba=cb[1],Ba===I.solutionId){const Nb={};Nb.solutionId=Ba;Nb.assetId=cb[5];Nb.storeType=cb[12];Nb.storeId=cb[11];Nb.assetStoreId=cb[6];Nb.targetType=cb[3];Nb.width=cb[7];Nb.height=cb[8];Nb.displayName=cb[0];Nb.version=cb[4];r.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",I.solutionId);cb=new Ga(Nb);this.Ir.raiseEvent(O.a.jEh,cb);break}};V.storeType=OSF.StoreTypeEnum.PrivateCatalog;
V.fromInsertDialog=!1;V.refresh=!1;this.Xi.queryEntitlementDetails(V)}Hyl(I){if("LastTeachingUIShowTime"in I){if(I=+new Date-+new Date(I.LastTeachingUIShowTime.toString()),I<z.AFrameworkApplication.fa.eX("AddinShowTeachingUIIntervalInMS",864E5))return r.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",I),!1}else r.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}GWi(){let I=new fa.a(new ra,0),V=new fa.a(new ra,0),Ba=0,cb=
0,Nb=0;var Ec=new e.a;for(var Oc of this.VQa)Ec.add(Oc);for(let je of this.S8a)Ec.add(je);for(let je of Ec)if(!("excatalog"!==je.storeType||na.b(je.installTimeInMS)||!je.installTimeInMS||je.installTimeInMS<=z.AFrameworkApplication.fa.eX("DateTimeInMSForNewAddin",16409952E5))){Ec=Fa.G5f(je);if(this.$Mb&&(Oc=this.$Mb.split(","),0<Oc.length&&Array.contains(Oc,Ec))){Nb++;r.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Ec.startsWith("private_")?(I=Fa.F$f(je,I),cb++):
(V=Fa.F$f(je,V),Ba++)}r.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",cb,Ba,Nb);return 0<V.value?V.key:0<I.value?I.key:Object.assign(new ra,{addinId:null,targetType:-1,solutionId:null})}VCb(I,V,Ba=null){I={["AppTeachingUICalloutAction"]:V,["SDX.Id"]:I,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ba)for(let cb of Ba.keys)I[cb]=Ba.ga(cb);ca.a.sendTelemetryEvent(Object.assign(new wa.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.VI(I)}))}eRh(I){I&&(window.g_roamingAddinList=this.$Mb?this.$Mb+","+I.addinId:I.addinId)}static r4(I){return Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)}static F$f(I,V){return V.value<I.installTimeInMS?new fa.a(Object.assign(new ra,{addinId:Fa.G5f(I),targetType:I.targetType,solutionId:I.solutionId}),I.installTimeInMS):V}static G5f(I){return Telemetry.PrivacyRules.IsPrivateAddin(I.storeType,
I.assetId,null,null,I.storeId)?"private_"+I.installTimeInMS:I.solutionId}}Object(h.a)(Fa,"PrivateCatalogTeachingCalloutHandler",null,[]);class pa{constructor(I){this.UJd=null;this.Ikf=I}get ldb(){return this.UJd}Qsb(I,V=null){this.Ikf.Qsb(I,V);this.UJd=I}UWe(I){this.Ikf.UWe(I)}Czh(I){this.UJd=I}}Object(h.a)(pa,"RibbonExtensibilityManagerWithChangeDetection",null,[796]);var Ea=d(77);const ta=()=>{const I=Ea.a.Pyb(window.location.href.toLowerCase(),"wdomexsrctype");return!!I&&"4"===I},ia=()=>Ea.a.Pyb(window.location.href.toLowerCase(),
"wdtpl"),Ja=()=>{const I=Ea.a.Pyb(window.location.href.toLowerCase(),"wdomexsrctype");return!!I&&"1"===I},ab=I=>{let V=null;switch(I){case 0:V="omex";break;case 1:V="spcatalog";break;case 2:V="spapp";break;case 3:V="filesystem";break;case 4:V="exchange";break;case 6:V="registry";break;case 7:V="inmemory";break;case 8:V="uploadfiledevcatalog";break;case 9:V="hardcodedpreinstall";break;case 10:V="excatalog";break;case 16:V="wopicatalog"}return V},Oa=I=>{let V=-1;switch(I.toLowerCase()){case "omex":V=
0;break;case "spcatalog":V=1;break;case "spapp":V=2;break;case "filesystem":V=3;break;case "exchange":V=4;break;case "registry":V=6;break;case "inmemory":V=7;break;case "uploadfiledevcatalog":V=8;break;case "hardcodedpreinstall":V=9;break;case "excatalog":V=10;break;case "wopicatalog":V=16}return V};class Za{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Za,"AddInDataTransferObject",null,[]);class Na{constructor(I,V,Ba){this.Qyc=I;this.qWh=V;this.rWh=Ba}get JF(){return this.Qyc}get ofi(){return this.qWh}get pfi(){return this.rWh}static q7b(I){return(I=
I.Eaa)?Object.assign(new Za,{tabs:I.JF.toArray(),id:I.ofi,title:I.pfi}):null}}Object(h.a)(Na,"OneLineRibbonExtensibility",null,[]);class sa{Qsb(I,V=null){if(I=Na.q7b(I)){appChrome.addInApi.dispatchActionsToInstallAddIn(I,V);for(const Ba of I.tabs)if(Ba.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(I,()=>{});break}}}UWe(I){(I=Na.q7b(I))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(I)}Czh(){}static RXi(I,V,Ba=null){I=sa.ptj(I);0<I.length&&(sa.std(I,!1),Ba&&Ba(V,I))}static ptj(I){const V=
[];if(I&&(I=I.Eaa,I.JF&&0<I.JF.count))for(let Ba of I.JF)if(Ba.groups&&0<Ba.groups.length)for(const cb of Ba.groups)if(cb.controls&&0<cb.controls.length)for(const Nb of cb.controls)Array.add(V,Nb.id);return V}static std(I){if(I.length){var V=[];for(const Ba of I)V.push(appChrome.actions.updateControlEnabledDisabledState(Ba,!0));appChrome.api.dispatch(V)}}}Object(h.a)(sa,"OneLineRibbonExtensibilityManager",null,[796]);class Sa{constructor(){this.Ver=1}}Object(h.a)(Sa,"CacheItem",null,[]);class xb{constructor(){}}
Object(h.a)(xb,"AppsDataCacheManager",null,[786]);class gc{constructor(){new xb(t.a.instance)}wyh(I,V){I=O.a.f9f()+I;t.a.instance.setItem(I,V.toString())}Urj(){var I=O.a.Ibg();r.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",I);I=t.a.instance.getItem(I);return ka.a(I)}Prl(I){const V=O.a.Ibg();r.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",V);t.a.instance.setItem(V,ka.c(I))}k2j(){return!!t.a.instance.localStorage}static get instance(){gc.La||(gc.La=new gc);return gc.La}}gc.La=null;
Object(h.a)(gc,"AddInCommandsCacheManager",null,[735]);var zc=d(548),Xb=d(72);class jb{static M9f(I){const V=new e.a;if(jb.iOf)for(var Ba of jb.iOf)V.add(Ba);Ba=null;switch(I){case "Workbook":Ba=jb.g_l;break;case "Document":Ba=jb.vZi;break;case "Presentation":Ba=jb.rXk}if(Ba)for(const cb of Ba)V.add(cb);return V}}jb.iOf=["PrimaryCommandSurface","ContextMenu"];jb.g_l=null;jb.vZi=null;jb.rXk=null;Object(h.a)(jb,"ExtensionPointType",null,[]);class zb{constructor(I){this.vqf=null;if(na.b(I))throw r.ULS.sendTraceTag(9175315,
220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.BWh=I}get Smc(){return this.vqf||(this.vqf=new e.a)}get oCf(){return this.BWh}}Object(h.a)(zb,"ContextMenuExtensibility",null,[760]);class Tb{constructor(I,V=null,Ba=0){if(na.b(I))throw r.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.s6h=
I;this.V$h=V;this.M0h=Ba}get Eaa(){return this.s6h}get startedNode(){return this.V$h}get Bcj(){return this.M0h}}Object(h.a)(Tb,"RibbonExtensibility",null,[858]);class Ya{constructor(I){this.M_h=I.entitlement}get entitlement(){return this.M_h}createActionContext(I,V){I={};I.ownerAddinInfo=this.entitlement;I.action=V;return I}}Object(h.a)(Ya,"AddInCommandsContextProvider",null,[]);class sb{constructor(I,V,Ba){this.Scf=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=
null;this.ribbonBuilder=I;this.eventBuilder=V;this.contextMenuBuilder=Ba}get addinInfo(){return this.Scf}vNi(I){return new Ya(I)}createActionBuilder(I,V){return OfficeExt.DefaultControlActionBinder.createActionBuilder(I,V.entitlement,V.manifest)}startApplyAddin(I){this.Scf=I;const V=this.vNi(I);this.actionBuilder=this.createActionBuilder(V,I)}endApplyAddin(){}n$d(I,V,Ba=0){return this.ribbonBuilder.JF&&0<this.ribbonBuilder.JF.count?new Tb(this.icj(I,V),this.addinInfo.startedNode,Ba):null}e5f(){var I=
null;if(this.contextMenuBuilder.jhd&&0<this.contextMenuBuilder.jhd.count){I||(I=this.addinInfo.entitlement.solutionId);I=new zb(I);for(let V of this.contextMenuBuilder.jhd)I.Smc.add(V);return I}return null}icj(I,V){return this.ribbonBuilder.JF&&0<this.ribbonBuilder.JF.count?new Na(this.ribbonBuilder.JF,I,V):null}}Object(h.a)(sb,"AddinCommandsBuilder",null,[]);class oc{constructor(I,V,Ba,cb,Nb,Ec,Oc){this.xmb=new Xb.a;this.Az=I;this.Xi=V;this.fT=Ba;this.YMb=cb;this.W0d=Nb;this.sLa=Ec;this.ctb=Oc;this.pba=
z.AFrameworkApplication.Aa.BV}w5c(I,V,Ba,cb,Nb,Ec,Oc){const je=(De,Pd,Ke,xg)=>{Nb(De,Pd,Ke,xg);De=zc.a[this.Az]+Pd.assetId;({value:Pd}=this.xmb.vg(De)).returnValue&&(Pd.stop(),this.xmb.remove(De))};if(0!==this.Az&&I){r.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",I.count);4===this.Az&&(r.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",cb)),this.JDi(I,cb),Ec());for(let De of I)if(I=De,r.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",
this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId))),this.JSh(I))if(Oc&&I.requireConsent)Oc(I,Pd=>{try{if(this.pba){const xg=zc.a[this.Az]+Pd.solutionId,Gg=this.pba.Ii("ComponentAttach",xg);this.xmb.$(xg,Gg)}const Ke=this.sLa.p$a(Pd.storeType,Pd.solutionId);6!==this.Az&&(Ke&&(this.kNc(Ke),Ke.VM.purge(!1)),this.Xi.insertOsfControl(this.Jpc(Pd,V,Ba,je)),Ke&&this.Xi.ownerAddinControlRecreated(Pd.solutionId,Pd.storeType))}catch(Ke){r.ULS.sendTraceTag(572839882,
220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.solutionId,Pd.ownerAddinStoreType||Pd.storeType,Pd.assetId,null,null,Pd.storeId),Pd.version,Pd.storeType,Pd.storeId,Ke.message)),je(!1,Pd,null,null)}});else try{if(this.pba){const Ke=zc.a[this.Az]+I.solutionId,xg=this.pba.Ii("ComponentAttach",Ke);this.xmb.$(Ke,xg)}const Pd=this.sLa.p$a(I.storeType,I.solutionId);
!z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==z.AFrameworkApplication.Aa.mb.Ti&&1!==z.AFrameworkApplication.Aa.mb.Ti&&2!==z.AFrameworkApplication.Aa.mb.Ti||3!==this.Az||"excatalog"===I.storeType||!Pd||Pd.isUpgraded?6!==this.Az&&(Pd&&(this.kNc(Pd),Pd.VM.purge(!1)),this.Xi.insertOsfControl(this.Jpc(I,V,Ba,je)),Pd&&this.Xi.ownerAddinControlRecreated(I.solutionId,I.storeType)):(this.YMb.Czh(Pd.$H),je(!0,I,null,Pd.displayName))}catch(Pd){r.ULS.sendTraceTag(17388185,
220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId),I.version,I.storeType,I.storeId,Pd.message)),je(!1,I,null,null)}else je(!1,I,null,null)}}Oak(I,V,Ba,cb,Nb,Ec){const Oc=(je,De,Pd,Ke)=>{Ec(je,De,Pd,Ke);je=zc.a[this.Az]+De.solutionId;({value:De}=this.xmb.vg(je)).returnValue&&(De.stop(),
this.xmb.remove(je))};if(6===this.Az&&I)if(r.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId))),this.JSh(I))try{if(this.pba){const De=zc.a[this.Az]+I.solutionId,Pd=this.pba.Ii("ComponentAttach",De);this.xmb.$(De,Pd)}const je=this.sLa.p$a(I.storeType,I.solutionId);je||Oc(!1,I,null,null);z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.mb.aUf?
this.v5f(I,V,cb,Nb,Ba,De=>{Oc(De,I,Ba,je.displayName)}):(this.v5f(I,V,cb,Nb,Ba),Oc(!0,I,Ba,je.displayName))}catch(je){r.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId),I.version,I.storeType,I.storeId,je.message)),Oc(!1,I,null,null)}else Oc(!1,
I,null,null)}rEk(I,V,Ba,cb,Nb,Ec){if(Ec)if(Ec._isAddinCommandsManifest(this.fT.XT))try{z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.mb.aUf?this.u5f(I,V,Ba,Nb,Ec,Oc=>{cb(Oc,I,Ec,Ec.getDefaultDisplayName())}):(this.u5f(I,V,Ba,Nb,Ec),cb(!0,I,Ec,Ec.getDefaultDisplayName()))}catch(Oc){r.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,
I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId),I.version,I.storeType,I.storeId,Oc.message)),cb(!1,I,Ec,Ec.getDefaultDisplayName())}else r.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId),I.version,I.storeType,I.storeId)),cb(!1,
I,null,null);else r.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.fT.XT,Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.ownerAddinStoreType||I.storeType,I.assetId,null,null,I.storeId),I.version,I.storeType,I.storeId)),cb(!1,I,null,null)}Jpc(I,V,Ba,cb){const Nb={},Ec=document.createElement("div");Ec.setAttribute("visible","false");Nb.div=Ec;Nb.id=I.solutionId;Nb.solutionId=I.solutionId;
Nb.version=I.version;Nb.storeType=I.storeType;Nb.storeId=I.storeId;Nb.assetId=I.assetId;Nb.assetStoreId=I.assetStoreId;Nb.isvirtualOsfControl=!0;Nb.virtualOsfControlActivationCallback=(Oc,je)=>{const De=this.sLa.p$a(I.storeType,I.solutionId);De&&(De.isUpgraded&&(I.isUpgraded=!0),this.kNc(De));this.rEk(I,V,Ba,cb,Oc,je)};Nb.reason=3===this.Az?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Nb}u5f(I,V,Ba,cb,Nb,Ec=null){const Oc=
{};Oc.solutionId=cb.getSolutionId();Oc.version=cb.getVersion();Oc.storeType=cb.getStoreType();Oc.storeId=cb.getStoreId();Oc.assetId=cb.getAssetId();Oc.assetStoreId=cb.getAssetStoreId();Oc.targetType=cb.getOsfControlType();let je=null,De=null;if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))je=(new OfficeExt.Parser.AddinCommandsManifestParser(this.fT.XT,this.fT.formFactor)).parseExtensions(Oc,Nb,this.ctb),De=jb.M9f(this.fT.XT);
else try{je=(new OfficeExt.Parser.AddinCommandsManifestParser(this.fT.XT,this.fT.formFactor)).parseExtensions(Oc,Nb,this.ctb),De=jb.M9f(this.fT.XT)}catch(Ke){throw r.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ke.message),Ke;}if(De&&0<De.count){if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Pd=V(I);V=Ba(I);Ba=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");
Pd=new sb(Pd,null,V);for(let Ke of De)Pd.commandSurface=Ke,je.apply(Pd,this.ctb,Ba)}else try{let Ke=V(I),xg=Ba(I),Gg=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Pd=new sb(Ke,null,xg);for(let ph of De)Pd.commandSurface=ph,je.apply(Pd,this.ctb,Gg)}catch(Ke){throw r.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Ke.message),Ke;}if(OSF.OUtil.checkFlight(14))try{let Ke=Pd.n$d(I.solutionId,Nb.getDefaultDisplayName()),
xg=Pd.e5f();Ke&&this.YMb.Qsb(Ke,Ec);xg&&this.W0d.Yyf(xg);this.sLa.Izf(cb,Ke,xg,Nb.getDefaultDisplayName());r.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Nb.getDefaultDisplayName())}catch(Ke){throw OfficeExt.DevConsole.log(Ke),r.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ke.message),Ke;}else try{let Ke=Pd.n$d(I.solutionId,Nb.getDefaultDisplayName()),xg=Pd.e5f();Ke&&this.YMb.Qsb(Ke);xg&&this.W0d.Yyf(xg);this.sLa.Izf(cb,Ke,xg,Nb.getDefaultDisplayName());
r.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Nb.getDefaultDisplayName())}catch(Ke){throw r.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ke.message),Ke;}}}v5f(I,V,Ba,cb,Nb,Ec=null){const Oc={};Oc.solutionId=I.solutionId;Oc.version=I.version;Oc.storeType=I.storeType;Oc.storeId=I.storeId;Oc.assetId=I.assetId;Oc.assetStoreId=I.assetStoreId;Oc.targetType=I.targetType;const je=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.fT.XT,this.fT.formFactor);
try{const De=V.getManifest(),Pd=je.parse(Oc,De,Nb,this.ctb,V.getSharedRuntimeId(),V),Ke=Ba(I),xg=cb(I),Gg=new sb(Ke,null,xg);Gg.commandSurface="PrimaryCommandSurface";Pd.apply(Gg,this.ctb,!0);if(Gg.ribbonBuilder.JF&&0<Gg.ribbonBuilder.JF.count){const ph=Gg.n$d(I.solutionId,V.getManifest().getDefaultDisplayName(),1);z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.YMb.Qsb(ph,Ec):ph&&this.YMb.Qsb(ph,Ec);this.sLa.Kfi(V,ph,
Nb,V.getManifest().getDefaultDisplayName());r.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",V.getManifest().getDefaultDisplayName())}}catch(De){r.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",V.getManifest().getDefaultDisplayName(),De.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(De)}}kNc(I){I.$H&&this.YMb.UWe(I.$H);I.f3b&&this.W0d.i$k(I.f3b);this.sLa.R9k(I.VM.getStoreType(),I.VM.getSolutionId())}JDi(I,V){V=
ab(V);for(let Ba of this.sLa.DAb){if(Ba.VM.getStoreType()!==V)continue;let cb=!0;for(let Nb of I){const Ec=Nb;if(Ec&&Ba.Ftg(Ec.storeType,Ec.solutionId)){cb=!1;break}}cb&&(this.kNc(Ba),Ba.VM.purge(!1))}}JSh(I){return!!I&&!!I.solutionId&&!!I.version&&!!I.storeType&&!!I.storeId}}Object(h.a)(oc,"AddInCommandsIntegration",null,[]);var wb=d(1200),rc=d(170),Ka=d(945),Db=d(587),bc=d(358),Mc=d(946),mb=d(143),Wa=d(99),db=d(65),ub=d(55);class Lb{static get w8(){return Lb.KG||(Lb.KG=ub.a.instance.rb("Common.Utils.IAriaNotifier"))}static oQf(I,
V,Ba,cb){Lb.aW&&Lb.aW.WL&&Lb.aW.dismiss();Lb.aW=wb.a.l2d(V,I,I,3);Lb.aW.content=Ba;na.a(cb)||(Lb.aW.title=cb,Lb.aW.q$b=!0);I=new Sys.UI.Bounds(0,0,Wa.a.MYc(),Wa.a.LYc());Lb.aW.w_=Lb.eae(I,V,Lb.aW.Mba,1);Lb.aW.show();Lb.w8&&Lb.w8.sendNotification(Ba.innerText,!0)}static E1d(I,V,Ba,cb=null){mb.UISurfaces.KL().then(Nb=>{let Ec=null;Lb.fYb&&(Nb.removeNotification(Lb.fYb),Lb.fYb=null);const Oc=Nb.callout(Object.assign(new Ka.a,{target:I,title:V,content:Ba,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,
calloutProps:Object.assign(new Mc.a,{onDismiss:()=>{Nb.removeNotification(Ec)},directionalHint:null!=cb?cb:null})})),je=Object.assign(new bc.a,{expirationOptions:Object.assign(new Db.a,{displayTimeoutSeconds:7,onExpire:()=>{Nb.removeNotification(Lb.fYb)}})});Ec=Lb.fYb=Nb.addNotification(Oc,je);return null},Nb=>{r.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Nb);return null})}static w3e(I){Lb.aW&&Lb.aW.WL&&Lb.aW.dismiss();const V=new x.StandardDialog;V.Y1a=!1;V.Ad=0;
V.Yy(rc.a.Gak,CommonUIStrings.l_DialogError,na.a(I)?Lb.n8f():I,null)}static Azl(I){Lb.aW&&Lb.aW.WL&&Lb.aW.dismiss();r.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",I.errorCode));const V=na.a(I.description)?Lb.n8f():I.description,Ba=new x.StandardDialog;let cb=null;I.t1b?(Ba.Ad=1,Ba.Le(1,I.buttonText),Ba.cza(1)):Ba.Ad=0;cb=Nb=>{1===Nb?I.t1b():I.Q4b&&I.Q4b()};Ba.Y1a=!1;0===I.jje?Ba.Yy(I.errorCode,I.title?I.title:CommonUIStrings.l_DialogError,V,cb):1===
I.jje?Ba.zP(I.title?I.title:CommonUIStrings.l_DialogWarning,V,cb):Ba.dmb(I.title?I.title:CommonUIStrings.l_DialogInfo,V,cb)}static eae(I,V,Ba,cb){let Nb=0===cb?0:4;const Ec=I.x+I.width-V.x-V.width;V.x-I.x+V.width/2<=Ba/2?Nb=0===cb?2:5:Ec+V.width/2<=Ba/2&&(Nb=0===cb?3:6);return Nb}static Lzl(I,V,Ba,cb=!1){(V=Na.q7b(V))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(V,Nb=>{Nb&&(cb||Lb.E1d(Nb,Ba,I,5))})}static Mzl(I,V,Ba=!1){Lb.Lzl(V.startedNode?
V.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,I),V,V.startedNode?V.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,I),Ba)}static Kzl(I,V,Ba,cb){if(Lb.cSh)I=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ba,cb,CommonUIStrings.l_InsertionDialogRefresh)),Lb.E1d(V,I,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{V=db.a.mi(V);var Nb=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),
Ec=document.createElement("span");Ec.innerText=Nb[0];var Oc=document.createElement("span");Oc.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Ba,cb,CommonUIStrings.l_InsertionDialogRefresh);Oc.className="UIFontBold";Ba=document.createElement("span");Ba.innerText=Nb[1];cb=document.createElement("div");Sys.UI.DomElement.addCssClass(cb,"ModalCalloutControl");cb.appendChild(Ec);cb.appendChild(Oc);cb.appendChild(Ba);Lb.oQf(I,V,cb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static hBl(I,
V){var Ba=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,cb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;Lb.cSh?Lb.E1d(V,Ba,cb):(V=db.a.mi(V),Lb.oQf(I,V,Lb.$vi(cb),Ba))}static $vi(I){const V=document.createElement("div");Sys.UI.DomElement.addCssClass(V,"ModalCalloutControl");V.innerText=I;return V}static n8f(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get cSh(){return z.AFrameworkApplication.Aa.mb.Qp&&z.AFrameworkApplication.Aa.mb.iWa}}
Lb.aW=null;Lb.fYb=null;Lb.KG=null;Object(h.a)(Lb,"AddInCommandsNotificationFactory",null,[]);class Kb{constructor(I,V,Ba,cb,Nb,Ec,Oc,je=null){this.Oa=new M.a;this.UBd=I;this.$Yh=V;this.gB=Ba;this.Jwf=cb;this.urb=Nb;this.sWh=Ec;this.Tyc=Oc;this.i6h=je}Mhi(I){this.Oa.addHandler(O.a.MBf,I)}Iii(I){this.Oa.addHandler(O.a.Hwg,I)}gli(I){this.Oa.addHandler(O.a.lEh,I)}Zhi(I){this.Oa.addHandler(O.a.iXd,I)}abk(I,V,Ba){const cb=Ba[O.a.gKc],Nb=void 0===Ba[O.a.bsa]?0:Ba[O.a.bsa];if(cb&&0!==Nb)if(0>=cb.count&&4!==
Nb)this.Uih(new da(Nb,null,null,V,null,!0));else{var Ec=cb.count,Oc=new pa(new sa),je=void 0===Ba[O.a.csa]?-1:Ba[O.a.csa],De=new oc(Nb,this.gB,this.UBd,Oc,this.$Yh,this.urb,this.Tyc),Pd=qg=>this.Jwf.uvi(qg.solutionId,this.Tyc,this.UBd,I),Ke=qg=>this.Jwf.wui(qg.solutionId),xg=(qg,th,ci)=>{Ec--;ci=new da(Nb,th,Oc,V,ci,0>=Ec);if(qg&&th)this.Uih(ci);else{if(3===Nb||th&&th.isUpgraded)qg="",th&&(qg=Telemetry.PrivacyRules.GetPrivacyCompliantId(th.solutionId,th.ownerAddinStoreType||th.storeType,th.assetId,
null,null,th.storeId)),th={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:qg},ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.VI(th)}));this.Tih(ci)}Ec||z.AFrameworkApplication.Aa.updateCommandUI()},Gg=(qg,th,ci,Hf)=>{xg(qg,th,Hf)},ph=()=>{this.QLe();0>=cb.count&&4===Nb&&this.urb.A0e()};6===Nb?(je=Ba[O.a.w_i],Ba=Ba[O.a.x_i],De.Oak(cb.ga(0),je,Ba,Pd,Ke,(qg,th,ci,Hf)=>{xg(qg,th,Hf)})):De.w5c(cb,
Pd,Ke,je,Gg,ph,this.i6h)}else ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.VI({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),r.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.UBd.XT)),this.Tih(new da(Nb,null,null,V,null,!0))}Tih(I){this.QLe(I);this.fFh(!1,I)}Uih(I){const V=I.Aw;let Ba=null;null!==V&&
(Ba=V.storeType,Ba=Ba.toLowerCase());if(I&&"omex"===Ba&&(3===I.Az||V.isUpgraded)){var cb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.ownerAddinStoreType||V.storeType,V.assetId,null,null,V.storeId)};ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.VI(cb)}))}this.QLe(I);cb=Ja()&&"omex"===Ba&&!!I.Hga&&!!V.solutionId&&2===I.Az&&V.solutionId.toLowerCase()===
ia().toLowerCase();var Nb="excatalog"===Ba&&3===I.Az;if("omex"===Ba&&I.Hga&&(3===I.Az&&"hardcodedpreinstall"!==Ba||V.isUpgraded)||cb||Nb)cb=new N,cb.Aw=V,cb.$H=I.Hga.ldb,this.Oa.raiseEvent(O.a.iXd,cb);cb=ta();Nb=ia();cb&&V&&"excatalog"===V.storeType&&I.Hga&&5===I.Az&&Nb&&(V.storeId&&V.storeId.toLowerCase()===Nb.toLowerCase()||V.assetId&&V.assetId.toLowerCase()===Nb.toLowerCase())&&(cb=new N,cb.Aw=V,cb.$H=I.Hga.ldb,this.Oa.raiseEvent(O.a.iXd,cb),r.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));
V&&(gc.instance.wyh(Oa(Ba),!0),"uploadfiledevcatalog"===Ba&&(cb=this.sWh.createAddinDataProvider(Ba,this.gB))&&cb.localCacheAddinCommands(this.gB.Wxa,V.solutionId,V.version,V.storeId),U.a.fxc(O.a.jKc,"true",Oa(Ba)));this.fFh(!0,I)}fFh(I,V){I?z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&V.Hga&&5===V.Az&&V.Hga.ldb&&void 0!==V.Aw.showCallout&&null!==V.Aw.showCallout&&V.Aw.showCallout?((new Fa(this.Oa)).Iei(V.Aw,Na.q7b(V.Hga.ldb)),
I=new N,I.$H=V.Hga.ldb,I.Aw=V.Aw,this.Oa.raiseEvent(O.a.lEh,I)):3!==V.Az?V.owg&&this.urb.A0e():V.Hga&&V.Hga.ldb&&"hardcodedpreinstall"!==V.Aw.storeType&&Lb.Mzl(V.displayName,V.Hga.ldb,V.Aw.isAutoLaunched):3===V.Az?V.Aw&&"uploadfiledevcatalog"===V.Aw.storeType.toLowerCase()?(V=this.Tyc.bkj(V.Aw.solutionId),Lb.w3e(V?V:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.urb.tpl():V.owg&&this.urb.A0e()}QLe(I=null){var V=I?I.Aw:null;const Ba=new N;if(Ba.Aw=V){var cb=this.urb.p$a(V.storeType,
V.solutionId,6===I.Az?1:0);if(cb&&cb.$H){Ba.$H=cb.$H;var Nb=ia();Nb=Ja()&&!!V.solutionId&&!!Nb&&V.solutionId.toLowerCase()===Nb.toLowerCase()&&2===I.Az;if(3===I.Az&&"hardcodedpreinstall"!==V.storeType||Nb)I="",cb.$H.Eaa&&cb.$H.Eaa.JF&&(cb=cb.$H.Eaa.JF.ga(0))&&(I=cb.id),V={["SDX_CommandPlacement"]:I,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.ownerAddinStoreType||V.storeType,V.assetId,null,null,V.storeId)},
ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:T.a.VI(V)}))}}this.Oa.raiseEvent(O.a.MBf,Ba)}}Object(h.a)(Kb,"LaunchAddinCommandsHandler",null,[748]);class uc{constructor(I){this.D6h=I}get Wxa(){return this.D6h}insertOsfControl(I){return this.Wxa.insertOsfControl(I)}getManifestInvaildErrorString(){return this.Wxa.getManifestInvaildErrorString()}isAddinCommandsAsync(I,V){this.Wxa.isAddinCommandsAsync(I,V)}isAddinCommandsExAsync(I,V){this.Wxa.isAddinCommandsExAsync(I,
V)}ownerAddinControlRecreated(I,V){this.Wxa.ownerAddinControlRecreated(I,V)}queryEntitlementDetails(I){this.Wxa.queryEntitlementDetails(I)}}Object(h.a)(uc,"ContextActivationMgrWrapper",null,[756]);class Yb{}Yb.Xnb="Alt";Yb.Ynb="Command";Yb.id="Id";Yb.p3a="Image16by16";Yb.Znb="LabelText";Yb.button="Button";Yb.s9d="FlyoutAnchor";Object(h.a)(Yb,"AddinDataNodeConstants",null,[]);var Tc=d(210),sc=d(414),Qb=d(319),kb=d(69);class Ib{constructor(I,V){this.oEc=this.vff=null;if(na.b(I)||na.b(V))throw r.ULS.sendTraceTag(9175312,
220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.fEd=V;this._id=I;this.QN[Yb.id]=this._id}get id(){return this._id||""}get QN(){return this.vff||(this.vff={})}get controlType(){return this.fEd||""}get menuItems(){return this.oEc||(this.oEc=new e.a)}Ewc(){let I=null;this.fEd===Yb.s9d?I=Object.assign(new sc.a,{Menu:this.Dzk()}):this.fEd===Yb.button&&(I=Object.assign(new Tc.a,{}));I&&(this.QN[Yb.id]&&
(I.ExternalId=this.QN[Yb.id]),this.QN[Yb.Ynb]&&(I.Command=this.QN[Yb.Ynb].toString()),this.QN[Yb.Znb]&&(I.LabelText=this.QN[Yb.Znb]),this.QN[Yb.Xnb]&&(I.Alt=this.QN[Yb.Xnb]),this.QN[Yb.p3a]&&(kb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.QN[Yb.p3a]),I.ExternalImageId=this._id));return I}Dzk(){const I=Object.assign(new Qb.a,{UpdateDynamically:!0,MenuSectionList:[]});if(this.oEc){const V=Object.assign(new m.a,{ControlList:[]});for(let Ba of this.oEc)Array.add(V.ControlList,
Ba.Ewc());Array.add(I.MenuSectionList,V)}return I}}Object(h.a)(Ib,"ControlDefinition",null,[753]);class eb{constructor(I){this.oca=null;if(na.b(I))throw r.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=I;this.Slc[Yb.id]=this._id}get Slc(){return this.oca||(this.oca={})}get id(){return this._id||""}Ewc(){const I=Object.assign(new Tc.a,{});this.oca[Yb.id]&&(I.ExternalId=this.oca[Yb.id]);
this.oca[Yb.Ynb]&&(I.Command=this.oca[Yb.Ynb].toString());this.oca[Yb.Znb]&&(I.LabelText=this.oca[Yb.Znb]);this.oca[Yb.Xnb]&&(I.Alt=this.oca[Yb.Xnb]);this.oca[Yb.p3a]&&(kb.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.oca[Yb.p3a]),I.ExternalImageId=this._id);return I}}Object(h.a)(eb,"MenuItemDefinition",null,[822]);class Rb{constructor(I){this.kAc=null;if(na.b(I))throw r.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),
Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=I}get id(){return this._id}get controls(){return this.kAc||(this.kAc=new e.a)}Ewc(){const I=[];if(this.kAc)for(let V of this.kAc){const Ba=V.Ewc();Ba&&I.push(Ba)}return I}}Object(h.a)(Rb,"OfficeMenuDefinition",null,[738]);var pc=d(37);class Wc{constructor(I,V,Ba){this.QV=this.hpb=null;this.CLd=I;this.Sob=V;this.iob=Ba;this.s5h=new e.a}get Zhd(){return this.CLd}get K2b(){return this.Sob}get SSd(){return this.iob}addButton(I){r.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",I.actionType);this.QV=new Ib(this.uRa(I.id),Yb.button);this.QV.QN[Yb.Znb]=I.label;this.QV.QN[Yb.Xnb]=I.label;this.QV.QN[Yb.p3a]=I.icon["16"];this.$0b(this.QV.QN[Yb.id],I.action);this.s7a(this.QV.QN);this.hpb.controls.add(this.QV);this.QV=null}startBuildMenu(I){if(na.b(this.hpb))this.hpb=new Rb(I.id);else{const V=this.uRa(I.id);this.QV=new Ib(V,Yb.s9d);this.iub(this.QV.QN,I);this.QV.QN[Yb.p3a]=I.icon["16"];this.QV.QN[Yb.Ynb]=pc.a.s8}}addMenuItem(I){r.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",I.actionType);const V=new eb(this.uRa(I.id));this.iub(V.Slc,I);I.icon&&(V.Slc[Yb.p3a]=I.icon["16"]);this.$0b(V.Slc[Yb.id],I.action);this.s7a(V.Slc);this.QV.menuItems.add(V)}endBuildMenu(){na.b(this.QV)?(this.jhd.add(this.hpb),this.hpb=null):(this.hpb.controls.add(this.QV),this.QV=null)}get jhd(){return this.s5h}$0b(I,V){this.SSd.bindAction(I,V)}s7a(I){this.K2b.s7a(I)}uRa(I){return this.Zhd.KEa(I)}iub(I,V){I[Yb.Znb]=V.label;I[Yb.Xnb]=V.label}}Object(h.a)(Wc,
"ContextMenuExtensibilityCreator",null,[785,779]);class Ic{constructor(I){this.jXb=I}get wmc(){return this.jXb}KEa(I){return this.wmc+I}}Object(h.a)(Ic,"DefaultContextMenuNamingProvider",null,[782]);class nd{constructor(I,V,Ba,cb){this.jXb=I;z.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&Ba.Boj();this.svf=V;this.i$h=cb}get wmc(){return this.jXb}get solutionId(){return this.svf}get a3e(){return this.i$h}KEa(I){I=this.wmc+this.solutionId+I;return this.a3e?(I in nd.kKc||(nd.kKc[I]=
"AddinControl"+nd.Xli++),nd.kKc[I]):I}jTf(I){if(this.a3e){const Ba=nd.kKc;for(let cb in Ba){var V=cb;if(I===Ba[cb])return V.substr(this.wmc.length+this.solutionId.length)}}return I}Kxj(I){I=this.wmc+this.solutionId+I;return this.a3e?(I in nd.aVd||(nd.aVd[I]="AddinTab"+nd.bmi++),nd.aVd[I]):I}}nd.kKc={};nd.aVd={};nd.bmi=0;nd.Xli=0;Object(h.a)(nd,"DefaultRibbonNamingProvider",null,[751]);class ob{bindAction(I,V){OfficeExt.DefaultControlActionBinder.bindAction(I,V)}}Object(h.a)(ob,"DefaultUIControlActionBinder",
null,[780]);class $b{constructor(I){this.DYh=I}get command(){return this.DYh}s7a(I){I[Yb.Ynb]=this.command}}Object(h.a)($b,"DefaultUIControlCommandBinder",null,[781]);var Hc=d(526);class Pb{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(h.a)(Pb,"AddInControl",null,[]);class Yc{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(h.a)(Yc,"AddInGroup",null,
[]);class Rd{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(Rd,"AddInMenuItem",null,[]);class Gb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(h.a)(Gb,"AddInTab",null,[]);class Bb{constructor(I,V,Ba,cb,Nb,Ec){this.Qyc=new e.a;this.HTb=this.OAa=this.ipb=null;this.CLd=I;this.iob=V;this.Sob=Ba;this.svf=cb;this.Tyc=
Nb;this.Nhf=Ec}get Zhd(){return this.CLd}get JF(){return this.Qyc}get SSd(){return this.iob}get K2b(){return this.Sob}startBuildTab(I){const V=I.isOfficeTab?I.id:this.Zhd.Kxj(I.id),Ba=I.isOfficeTab?null:I.label;this.ipb=Object.assign(new Gb,{id:V,title:Ba,isOfficeTab:I.isOfficeTab,visible:I.visible,groups:[],tabType:I.tabType,insertBefore:I.insertBefore,insertAfter:I.insertAfter,autoFocus:I.autoFocus})}startBuildGroup(I){const V=this.uRa(I.id);this.OAa=Object.assign(new Yc,{id:V,mlrId:I.mlrId,title:I.label,
controls:[],groupType:0})}addNativeGroup(I){this.OAa=Object.assign(new Yc,{id:I.id,mlrId:I.mlrId,title:I.label,controls:[],groupType:1});this.ipb.groups.push(this.OAa)}addButton(I){const V=this.uRa(I.id);V&&(this.$0b(V,I.action),r.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",I.actionType),I=Object.assign(new Pb,{id:V,title:I.label,iconLocation:this.Rbe(I),enabled:I.enabled,controlType:0,attributes:this.iub()}),this.Nhf.Eyf(new Hc.a(V,this.K2b.command.toString())),
this.OAa.controls.push(I))}addNativeControl(I){I.id&&(r.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",I.actionType),I=Object.assign(new Pb,{id:I.id,title:"",iconLocation:"",enabled:I.enabled,controlType:2,attributes:this.iub()}),this.OAa.controls.push(I))}startBuildMenu(I){const V=this.uRa(I.id);V&&(this.HTb=Object.assign(new Pb,{id:V,title:I.label,iconLocation:this.Rbe(I),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(I){const V=this.uRa(I.id);V&&(this.$0b(V,
I.action),r.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",I.actionType),I=Object.assign(new Rd,{id:V,title:I.label,iconLocation:this.Rbe(I),enabled:I.enabled,attributes:this.iub()}),this.Nhf.Eyf(new Hc.a(V,this.K2b.command.toString())),this.HTb.menuItems.push(I))}endBuildMenu(){na.b(this.HTb.id)||this.OAa.controls.push(this.HTb);this.HTb=null}endBuildGroup(){na.b(this.OAa.id)||this.ipb.groups.push(this.OAa);this.OAa=null}endBuildTab(){na.b(this.ipb.id)||this.Qyc.add(this.ipb);
this.ipb=null}iub(){const I={};this.s7a(I);return I}Rbe(I){return I.icon["80"]?I.icon["80"]:I.icon["32"]}s7a(I){this.K2b.s7a(I)}uRa(I){return this.Zhd.KEa(I)}$0b(I,V){this.SSd.bindAction(I,V)}}Object(h.a)(Bb,"OneLineRibbonExtensibilityCreator",null,[778,779]);class dc{constructor(I,V){this.jXb=I;this.iob=new ob;this.Sob=new $b(V)}wui(I){I=new Ic(I);return new Wc(I,this.Sob,this.iob)}uvi(I,V,Ba,cb){Ba=new nd(this.jXb,I,Ba,!0);return new Bb(Ba,this.iob,this.Sob,I,V,cb)}}Object(h.a)(dc,"UIExtensibilityFactory",
null,[736]);class Xc{createAddinDataProvider(I,V){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(I,V.Wxa)}static get instance(){Xc.La||(Xc.La=new Xc);return Xc.La}}Xc.La=null;Object(h.a)(Xc,"OSFAddinDataProviderFactory",null,[737]);class Fb{constructor(){this.dtb=null}setErrorMessageForAddin(I,V){this.dtb||(this.dtb={});this.dtb[I]=V}bkj(I){return this.dtb&&I in this.dtb?this.dtb[I]:null}}Object(h.a)(Fb,"AddinCommandsErrorManager",null,[]);class kd{constructor(){this.jje=0;this.t1b=
this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Ujg=!1;this.iOj=this.Q4b=null}}Object(h.a)(kd,"AddInCommandsNotificationParameters",null,[]);class od{constructor(){this.Edf=this.ABd=null}get TSd(){return this.ABd||(this.ABd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set TSd(I){this.ABd=I}get Fri(){return this.Edf||(this.Edf=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(I,V){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(I,
V)}M9b(I,V,Ba,cb,Nb){r.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",I);if((I=V.p$a(Nb.ownerAddinInfo.storeType,Nb.ownerAddinInfo.solutionId))&&I.VM&&!I.VM.getIsUpgrading())if(V=null,0<I.VM.getNotificationParams().length&&(V=this.uHf(I.VM.getNotificationParams()[0]))&&2147758681===V.errorCode&&(I.isUpgraded=!0),2!==I.VM.getStatus()&&(1!==I.VM.getStatus()||V&&2147758681===V.errorCode))V&&this.gEh(I,V,null);else try{Ba.setOwnerAddinEToken(I.VM.getEToken()),Nb.action(Ba,cb.Wxa)}catch(Ec){r.ULS.sendTraceTag(17425949,
220,10,String.format("HandleAddinCommandsAction error info : {0}.",z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ec.stack:Ec.message)),Lb.w3e(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}gEh(I,V,Ba=null){const cb=I.VM;if(1===cb.getNotificationParams().length||V.Ujg){const Nb=V.t1b,Ec=V.Q4b;V.t1b=()=>{cb.removeFirstNotification();if(0<cb.getNotificationParams().length){const Oc=this.uHf(cb.getNotificationParams()[0]);
this.gEh(I,Oc)}2147758681===V.errorCode&&(sa.RXi(I.$H,cb,Object(D.a)(this,this.Jlg,"initUpgradeStateDetectTask")),n.LXi(I.f3b,cb,Object(D.a)(this,this.Jlg,"initUpgradeStateDetectTask")));Nb&&Nb()};V.Q4b=()=>{Ec&&Ec();Ba&&Ba()};Lb.Azl(V)}}Jlg(I,V){let Ba=null;Ba=()=>{I.getIsUpgrading()?window.setTimeout(Ba,1E3):I.getUpgradingFailed()?sa.std(V,!0):z.AFrameworkApplication.Aa.updateCommandUI()};window.setTimeout(Ba,1E3)}uHf(I){const V=new kd;V.jje=I.infoType;V.id=I.id;V.title=I.title;V.description=I.description;
V.buttonText=I.buttonTxt;V.t1b=I.buttonCallback;V.Ujg=I.highPriority;V.Q4b=I.dismissCallback;V.errorCode=I.errorCode;V.iOj=I.iframeNotificationUrl;return V}}Object(h.a)(od,"AddinCommandsActionHandler",null,[759]);class Gd{constructor(){this.labelText=null;this.visible=!1}}Object(h.a)(Gd,"AddinStatusCommandValues",null,[]);class Fd{static z_k(I){const V=new Gd;V.labelText=I.$_b;V.visible=V.labelText?!0:!1;return V}static V3e(){const I=document.getElementById(void 0);I?Fd.$Eh(void 0,void 0,I,void 0,
void 0):r.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static $Eh(I,V,Ba,cb,Nb){Ba?I.$_b===CommonUIStrings.l_ErrorLoadingAddInsTitle?Lb.Kzl(V,Ba,cb,Nb):I.$_b===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Lb.hBl(V,Ba):r.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(h.a)(Fd,"AddinCommandsStatusHandler",null,[]);class ee{constructor(){this.Az=this.KKa=0;this.RUd=null;this.Cnd=this.$xd=
0;this.dOa=this.pGd=this.SBd=null}get iKc(){this.SBd||(this.SBd=new e.a);return this.SBd}get f$d(){this.pGd||(this.pGd=new e.a);return this.pGd}get S8a(){this.dOa||(this.dOa=new e.a);return this.dOa}}Object(h.a)(ee,"AddinCommandsListLoaderContext",null,[]);class Bf{constructor(I,V){this.entitlement=I;this.metadata=V}p8e(){var I=this.entitlement;const V={};V.solutionId=I.solutionId;V.version=I.version;V.storeType=I.storeType;V.storeId=I.storeId;V.assetId=I.assetId;V.assetStoreId=I.assetStoreId;V.targetType=
I.targetType;V.requireConsent=I.requireConsent||!1;V.isAddinCommands=!0;V.addinCommandsActionType=0;V.targetType=this.targetType;return V}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:
this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(h.a)(Bf,"AddinEntitlementEx",null,[]);class be extends Sys.EventArgs{constructor(I){super();this.properties=I}}Object(h.a)(be,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class af{constructor(I,V,Ba){this.Ir=new M.a;this.context=new ee;this.ZQd=null;this.contextActivationMgr=I;this.Yli=
V;this.hKc=Ba;this.appName=z.AFrameworkApplication.fa.Ha("WebAppShortName")}get pKh(){this.ZQd||(this.ZQd=new Fa(this.Ir));return this.ZQd}Lhi(I){this.Ir.addHandler(O.a.LBf,I)}ili(I){this.Ir.addHandler(O.a.jEh,I)}sPl(I){null!==I&&(this.context.KKa=I[O.a.csa],this.context.Az=I[O.a.bsa],this.context.$xd=this.context.Cnd=0,I=O.a.F7a in I?I[O.a.F7a]:0,-1!==this.context.KKa&&0!==this.context.Az&&(this.context.RUd=this.Yli.createAddinDataProvider(ab(this.context.KKa),this.contextActivationMgr),this.context.RUd?
this.context.RUd.getEntitlementsAsync(this.contextActivationMgr.Wxa,!0,I,V=>{this.aJk(V)}):r.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.KKa)))}aJk(I){if(I&&0<I.length){this.context.$xd=I.length;const Ba=z.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?ia():null;for(let cb=0;cb<I.length;cb++){const Nb=I[cb];if(z.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&
Ja()&&Nb&&Nb.storeType&&"omex"===Nb.storeType.toLowerCase()&&Nb.assetId&&Ba&&Nb.assetId.toLowerCase()===Ba.toLowerCase()){var V={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:af.r4(Nb)};ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:T.a.VI(V)}))}!Nb||1!==Nb.targetType&&-1!==Nb.targetType?this.kMe():(V={},z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?
(V.solutionId=Nb.solutionId,V.version=Nb.version):(V.marketplaceId=Nb.solutionId,V.marketplaceVersion=Nb.version),V.storeType=Nb.storeType,V.storeId=Nb.storeId,V.targetData=Nb,this.contextActivationMgr.isAddinCommandsExAsync(V,Object(D.a)(this,this.HIk,"onIsAddinCommandsExCompleted")))}}else this.kMe()}kMe(){var I;(I=this.context).Cnd=I.Cnd+1;this.context.Cnd>=this.context.$xd&&(this.hKc.wyh(this.context.KKa,!1),0<this.context.$xd&&10===this.context.KKa&&("Excel"===this.appName||"PowerPoint"===this.appName||
"Word"===this.appName)?(I=!1,ta()&&(I=this.Uek(this.context.f$d)),this.jek(this.context.f$d),z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!I?this.pKh.xNl(this.contextActivationMgr,this.context.iKc,this.context.S8a,(V,Ba)=>{const cb=new e.a;for(let Nb of V)V=Nb.p8e(),Ba&&Ba.solutionId===Nb.solutionId&&(V.showCallout=!0,this.pKh.eRh(Ba)),cb.add(V);this.vya(cb)}):this.vya(this.sOf(this.context.iKc))):this.vya(this.sOf(this.context.iKc)))}sOf(I){const V=
new e.a;if(I)for(let Ba of I)V.add(Ba.p8e());return V}vya(I){I&&I.count||U.a.fxc(O.a.jKc,"false",this.context.KKa);I={["ack2"]:I};I[O.a.csa]=this.context.KKa;I[O.a.bsa]=this.context.Az;this.Ir.raiseEvent(O.a.LBf,new be(I),this)}Uek(I){let V=!1;if(I&&1>I.count)return V;const Ba=ia();if(!Ba)return V;for(let cb of I)if(cb.storeId&&cb.storeId.toLowerCase()===Ba.toLowerCase()||cb.assetId&&cb.assetId.toLowerCase()===Ba.toLowerCase())I={["SDX_Id"]:af.Hbg(cb),["SDX_TargetType"]:na.b(cb.targetType)?"":cb.targetType.toString()},
ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:T.a.VI(I)})),V=!0;return V}jek(I){if(!(I&&1>I.count))if(this.hKc.k2j()){var V=this.hKc.Urj();V?(I=this.N7f(I,V),r.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(I=this.N7f(I,null),r.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.hKc.Prl(I)}else r.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}N7f(I,V){const Ba={};let cb=!1;
for(let Nb of I)if(I=af.Hbg(Nb))!V||I in V||(this.Nea(Nb,I),r.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===I.toLowerCase()?cb||(cb=!0,Ba[I]=null):Ba[I]=null;return Ba}Nea(I,V){var Ba=I.installTimeInMS?(new Date(I.installTimeInMS)).toISOString():"";Ba={["SDX.Id"]:V,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:na.b(I.targetType)?"":I.targetType.toString(),["SDX.AdminDeploymentTime"]:Ba};ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:T.a.VI(Ba)}));1===I.targetType&&(I={["SDX.Id"]:V,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:T.a.VI(I)})))}HIk(I,V,Ba,cb){I?(I=new Bf(Ba.targetData,cb),V&&this.context.iKc.add(I),10===this.context.KKa&&(this.context.f$d.add(I),0===I.targetType&&this.context.S8a.add(I))):(V=Ba.targetData,r.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.storeType,V.assetId,null,null,V.storeId),V.storeType));this.kMe()}static r4(I){return Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)}static Hbg(I){return Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)}}Object(h.a)(af,"AddInCommandsListLoader",null,[]);var Ue=d(1164),qf=d(182),Xa=d(1286),vb=d(29),cc=d(63);class wc{constructor(I,V,Ba){this.Jdb=
this.RGa=this.ofa=this.Ogb=null;this.sGe=this.Ddd=-1;this.EH=null;this.l_g=!1;this.Lzg=I;this.Ib=V;this.Qzg=this.Ib.uc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);this.oik=this.Ib.uc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.Q6c=this.Ib.Ha("WebAppShortName");this.Fc=Ba;H.a.Xa(this.Q6c)&&(this.Q6c="PowerPoint")}r4(I){return Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)}e9k(I){this.EH=I;this.Fc.B7a(Object(D.a)(this,this.ybh,
"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(D.a)(this,this.eNk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",Object(D.a)(this,this.QGk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(D.a)(this,this.NFk,"onCloseButtonClicked_ContentAddin"),!0)}TIk(){this.ofa&&this.Jdb&&(this.Lzg.M9b({["SourceControlId"]:this.Jdb}),r.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}Pzl(I,
V){V?(this.ofa=V.Aw,(this.Ogb=V.$H)&&this.Ogb.Eaa&&this.Ogb.Eaa.JF&&(this.RGa=this.Ogb.Eaa.JF.ga(0)),this.RGa?this.RGa.isOfficeTab?(I=this.ofa.solutionId,V=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),I in V?this.Jdb=V[I]:(r.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.r4(this.ofa)),this.Jdb=this.cdj(this.Ogb)),this.Jdb?0<this.RGa.id.indexOf(cc.a.Nnh)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Na.q7b(this.Ogb),
()=>{this.tFh(this.JXc(this.Jdb))}):this.Fc.B7a(Object(D.a)(this,this.qeh,"onTabSwitched")):(this.UWa("NoEnabledButtonFound",this.ofa),r.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),this.yJa())):this.vFh(this.JXc(this.RGa.id),0):(this.UWa("NoTabFound",this.ofa),r.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.yJa())):this.yJa()}qeh(I,V){!this.RGa||void 0===this.RGa.id||null===this.RGa.id||
0>H.a.ug(this.RGa.id).indexOf(H.a.ug(V.Zfa))||(this.Fc.Lrc(Object(D.a)(this,this.qeh,"onTabSwitched")),this.UZd(V.x9g,V.Zfa,this.Qzg,!1))}ybh(I,V){"Insert"===V.Zfa&&(this.Fc.Lrc(Object(D.a)(this,this.ybh,"onInsertTabSwitched_ContentAddin")),this.UZd(V.x9g,V.Zfa,this.Qzg,!0))}UZd(I,V,Ba,cb){if(0>Ba)this.UWa("TabSwitchTimeOut",this.ofa);else{var Nb=document.querySelector("button"+this.JXc(V));Nb.hasAttribute("aria-selected")&&"false"!==Nb.getAttribute("aria-selected")?(0<this.sGe&&window.clearTimeout(this.sGe),
cb?this.fCl():this.tFh(this.JXc(this.Jdb))):this.sGe=window.setTimeout(()=>{this.UZd(I,V,Ba-1,cb)},1E3)}}JXc(I){return"[id="+I+"]"}fCl(){let I=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var V=I?window.getComputedStyle(I,null):null;if(!I||V&&"none"===V.display)if(I=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))r.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.aDb("NoAnchor",this.EH);r.ULS.sendTraceTag(512499850,
220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else r.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(V=ub.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&I?(V.execute(Ba=>{Ba.logActivity("ShowTeachingUIForContentAddin",null)}),this.aDb("Show",this.EH),r.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.aDb("NoSifFutureObject",this.EH),r.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}eNk(){this.aDb("ClickOnLaunch",
this.EH);this.yJa();const I={};I.solutionId=this.EH.solutionId;I.assetId=this.EH.assetId;I.assetStoreId=this.EH.assetStoreId;I.height=this.EH.height?this.EH.height:600;I.storeId=this.EH.storeId;I.targetType=this.EH.targetType;I.width=this.EH.width?this.EH.width:600;I.displayName=this.EH.displayName;I.version=this.EH.version;I.storeType=this.EH.storeType;I.isAddinCommands=!1;this.Lzg.Hd.ICb("0",3,I)}NFk(){this.aDb("ClickOnClose",this.EH);this.yJa()}QGk(){this.aDb("ClickOnDismiss",this.EH);this.yJa()}vFh(I,
V){if(V>this.oik)window.clearTimeout(this.Ddd),this.uFh("[data-unique-id='pivotOverflowButton']"),r.ULS.sendTraceTag(512499845,220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Ba=document.querySelector("button"+I);!Ba||Ba.hasAttribute("tabIndex")&&"-1"===Ba.getAttribute("tabIndex")?this.Ddd=window.setTimeout(()=>{this.vFh(I,V+1)},1E3):(0<this.Ddd&&window.clearTimeout(this.Ddd),this.uFh(I))}}tFh(I){let V=document.querySelector("button[data-unique-id='RightPaddle']");
if(V)this.UWa("RightPaddlePresent",this.ofa);else if(I=(V=document.querySelector("button"+I))?window.getComputedStyle(V,null):null,!V||I&&"none"===I.display)if(V=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!V){this.UWa("NoAnchor",this.ofa);r.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.yJa();return}this.sMh(V,"ShowTeachingUIForAddinButton")}uFh(I){let V=document.querySelector("button"+I);if(!V&&("[data-unique-id='pivotOverflowButton']"!==
I&&(V=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!V)){this.UWa("NoAnchor",this.ofa);r.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.yJa();return}this.sMh(V,"ShowTeachingUIForAddinTab")}sMh(I,V){I.setAttribute("lpp-id","latestAddin");const Ba=ub.a.instance.Ia("Common.ISystemInitiatedFeedback");Ba&&I?(this.UWa("Show",this.ofa),Ba.execute(cb=>{cb.logActivity(V,null)}),r.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):
(this.UWa("NoSifFutureObject",this.ofa),r.ULS.sendTraceTag(512499842,220,15,"TriggerLPPActivity failed to get a sifFuture"),this.yJa())}cdj(I){if(!I||!I.Eaa||!I.Eaa.JF)return null;for(let V of I.Eaa.JF)if(V)for(const Ba of V.groups)if(Ba)for(const cb of Ba.controls){if(cb&&cb.attributes&&0===cb.controlType&&cb.enabled)return cb.id;if(cb.menuItems)for(const Nb of cb.menuItems)if(Nb.attributes&&Nb.enabled)return cb.id}return null}UWa(I,V){wc.Nea(I,this.r4(V))}aDb(I,V){V=Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,
V.storeType,V.assetId,null,null,V.storeId);wc.Nea(I,V)}Prd(I){const V={};V[this.Q6c]=ka.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:I});(new Ma(this.Q6c,null,null,Object(D.a)(this,this.BKa,"postRequestFailureCallback"))).GSc(V);r.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}BKa(I){r.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",
I?I.Oe:-1)}yJa(){if(!this.l_g){const I=window.g_roamingAddinList;I&&(this.Prd(I),this.l_g=!0)}}static Nea(I,V){I={["AppTeachingUICalloutAction"]:I,["SDX.Id"]:V,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};ca.a.sendTelemetryEvent(Object.assign(new wa.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:T.a.VI(I)}))}}Object(h.a)(wc,"AddinTeachingCalloutHandler",null,[]);class Ad{}Object(h.a)(Ad,"AddinCommandsHost",null,[]);var Md=d(80),Sd=
d(141);class Le extends Md.a{constructor(){super(void 0,void 0,void 0,!0);this.VTb="AddinCommandsUILessDialog";this.zRd="WACDialogTitleText";this.Xba="0";this.QP=380;this.xN=190;this.ig=this.VTb;this.Ad=5;this.TYh=String.format("{0}px",this.QP);this.Wba=String.format("{0}px",this.xN);this.dhe=this.Mr=!1;this.Gu()}Gu(){super.Gu();this.xm.style.width=this.TYh;this.xm.style.height=this.Wba;this.xm.style.padding=this.Xba}dza(I){this.ZA();document.getElementById(this.Vh(this.zRd)).innerText=I}ZA(){super.ZA();
this.Jb.style.width=String.format("{0}px",this.QP);this.Jb.style.height=String.format("{0}px",this.xN);this.Jb.removeAttribute(Sd.a.hf);this.Jb.removeAttribute(Sd.a.t_)}hide(){this.Uhe()}get ika(){return this.xm}initializeAndShowWithTitle(){this.sj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Le,"AddinCommandsUILessDialog",Md.a,[755]);var fe=d(42),Vf=d(159),Cd=d(39),Sc=d(341);class jg extends Ad{constructor(I,V,Ba,cb){super();this.P$=I;this.Oc=V;this.x$c=Ba;this.vhb=cb}setOwnerAddinEToken(I){this.P$.eToken=
I}showTaskpane(I,V,Ba){r.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.tmg(I,V,Ba,!0)||r.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(I,V,Ba){r.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.tmg(I,V,Ba,!1,this.x$c)||r.ULS.sendTraceTag(509699667,806,10,String.format("UILess : instance id is null."))}disposeHost(){}tmg(I,V,Ba,cb,Nb=!1){var Ec=this.Oc.HQ(I.solutionId);
Ec||(Ec=this.Oc.z8i(I,V,this.P$.solutionId,Nb));if(Ec&&this.Oc.Oua(Ec.instanceId))return this.Oc.tkb(Ec.instanceId),Ba(Ec.instanceId,0),Nb||this.Oc.MNb(Ec.instanceId,cb),!0;let Oc=null;if(!Ec)if(Ec=this.Oc.hui(I,V,cb,this.P$.solutionId,Nb),Ec.setValue(Cd.a.ownerAddinStoreType,this.P$.storeType),Oc=Ec.sa(Vf.a.sharedRuntimeId,null),this.Myg(!!Oc,!0),Nb&&(Nb=Nb&&!Oc),V=Nb?new Le:null,Nb?this.Oc.$lb(Ec,V.ika):(Ec.setValue(fe.a.q0b,cb||!!Oc),this.Oc.ash(Ec)),Ec=this.Oc.HQ(I.solutionId))if(Nb&&this.vhb.$(Ec.instanceId,
V),I=this.Oc.tEa(this.P$.solutionId)){if(I=new Sc.a(I),this.Oc.qPh(I.id,Ec.instanceId),Oc&&!this.Oc.F6b(I.wya)&&(I=this.Oc.L$d(I.wya)))I.tw||I.Ddi(Oc),this.Oc.wJc(this.P$.solutionId,I)}else{I=this.Oc.gui(this.P$,Oc);if(!I)return Ba(null,5001),!1;this.Oc.wJc(this.P$.solutionId,I);this.dek(!!Oc)}else return Ba(null,5001),!1;Ba(Ec.instanceId,0);Ba=this.Oc.Oua(Ec.instanceId);this.Oc.MNb(Ec.instanceId,Ba?cb:!0);this.Myg(!!Oc,!1);return!0}Myg(I,V){I&&window.performance&&window.performance.memory&&r.ULS.sendTraceTag(509699666,
802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",V,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}dek(I){r.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.P$.solutionId,this.P$.storeType,this.P$.assetId,null,null,this.P$.storeId),this.P$.storeType,
I)}}Object(h.a)(jg,"WACPowerPointAddInCommandsHost",Ad,[]);var mg=d(192);class Pa{constructor(I,V,Ba,cb,Nb,Ec,Oc,je,De,Pd,Ke){this.EH=this.r2g=null;if(!I)throw Error.argumentNull("app");this.gma=new C;this.jCg=Ba;this.Rb=I.To;this.$d=Oc;this.Oc=V;this.hma=Ec;this.Oc.Eji(Object(D.a)(this,this.iEi,"clearLoadingAddinMessage"));this.gma.Nhi(Object(D.a)(this,this.DCj,"handleAddinCommandsLoadingMessageChanged"));this.Da=cb;this.Ib=Nb;Ue.a.D$b=Ue.a.mjh;this.vhb=new Xb.a;this.jEb=De;this.wl=Pd;this.akk=new e.a;
this.UDb=new e.a;this.Fc=Ke}get Hd(){return this.Oc}w5c(I){r.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",I[O.a.bsa]);if(this.Da.FBb||!this.Da.Tca){var V=I[O.a.gKc];if(V&&0<V.count){const cb=V.count;for(let Nb=cb-1;0<=Nb;Nb--){const Ec=V.ga(Nb);OSF.OsfControl.isFirstPartyStoreString(Ec.storeType)||V.remove(V.ga(Nb))}V.count<cb&&(this.Da.FBb&&!this.wl.wea(22)&&this.wl.VDa(22),this.Da.Tca||this.wl.wea(36)||this.wl.VDa(36));if(!V.count)return}}let Ba=null;Ba=z.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?
new Kb(this.hma,this.jCg,new uc(this.Oc.Xi),new dc("",pc.a.u7a),this.gma,Xc.instance,new Fb,(cb,Nb)=>{const Ec={};Ec.solutionId=cb.solutionId;Ec.version=cb.version;Ec.storeType=cb.storeType;Ec.storeId=cb.storeId;Ec.assetId=cb.assetId;Ec.assetStoreId=cb.assetStoreId;this.Oc.nCl(Ec,()=>{Nb(cb)})}):new Kb(this.hma,this.jCg,new uc(this.Oc.Xi),new dc("",pc.a.u7a),this.gma,Xc.instance,new Fb);Ba.Zhi(Object(D.a)(this,this.bFk,"onAutoLaunchAddin"));Ba.Mhi(Object(D.a)(this,this.UIk,"onLaunchAddinCommandsCompleted"));
this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(V=new wc(this,this.Ib,this.Fc),Ba.Iii(Object(D.a)(V,V.TIk,"onLaunchAddinButtonClicked")),Ba.gli(Object(D.a)(V,V.Pzl,"showCalloutOnAddin")));try{qf.a.get_instance().Vj(5,null).continueWith(()=>{Ba.abk(this.jEb,vb.App.Mb.UF(),I)},11)}catch(cb){r.ULS.sendTraceTag(512499868,220,10,String.format("LaunchAddinCommands error message : {0}.",cb.message))}}ACj(I){I=I[this.hma.YRa];I=(new od).TSd(I);return z.AFrameworkApplication.Tca||
OSF.OsfControl.isFirstPartyStoreString(I.ownerAddinInfo.storeType)}M9b(I){const V=new od;this.mge(V,I[this.hma.YRa])}mge(I,V){const Ba=I.TSd(V),cb=new jg(Ba.ownerAddinInfo,this.Oc,this.Da.zla,this.vhb);I.M9b(V,this.gma,cb,new uc(this.Oc.Xi),Ba)}Elh(I){const V=Fd.z_k(this.gma);I[Xa.a.LabelText]=V.labelText;I[Xa.a.Visible]=V.visible}Czl(){this.V3e()}bPb(I){I&&O.a.UUd in I&&I[O.a.UUd]&&Lb.w3e(I[O.a.UUd].toString())}q6k(){if(this.gma.R5c()){this.gma.TLf();const I=this.P$d();if(I&&0<I.count)for(let V of I)this.RMb({["ack1"]:V,
["ack0"]:4,["ak0"]:(new Date).getTime()})}else this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(r.ULS.sendTraceTag(509669719,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.gma.R5c()),this.dV(10,!0),this.dV(0,!0))}DCj(){this.$d.Uy(new mg.a(2));this.V3e()}WZk(I){I&&O.a.csa in I?this.dV(I[O.a.csa],!0):r.ULS.sendTraceTag(509669718,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}dV(I,V=!1){this.Oc?
(r.ULS.sendTraceTag(509669716,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",I,V),this.Oc.dV(I,V)):r.ULS.sendTraceTag(509669717,220,10,"QueryAddinDetails: abort because m_appForOfficeManager is null.")}RMb(I){r.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",I[O.a.bsa],I[O.a.csa]);this.gma.Xnl();window.setTimeout(()=>{const V=new af(new uc(this.Oc.Xi),Xc.instance,gc.instance);V.Lhi((Ba,cb)=>{this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.dV(I[O.a.csa]);this.w5c(cb.properties)});V.ili((Ba,cb)=>{this.EH=cb;this.r2g=new wc(this,this.Ib,this.Fc);this.r2g.e9k(this.EH)});V.sPl(I)},0)}iEi(){this.gma.TLf()}Ari(I){var V=this.Oc.HQ(I);if(V&&V.tw&&V.tw.Pya&&!(0>=V.tw.state)){var Ba=new od,cb=Ba.getTaskPaneControlIdFromSolutionIdRuntimeId(I,V.tw.Pya);cb&&(this.Oc.wJc(I,V),this.mge(Ba,cb),this.Oc.XMf(I),(V=this.Oc.HQ(I+cb))?this.Oc.setInitialDisplayMode(V.instanceId,1):r.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+
I))}}Eri(I){if(I&&I.solutionId){var V=new od,Ba=V.Fri;if(Ba=I.solutionId in Ba?Ba[I.solutionId]:null){let cb=this.Oc.HQ(I.solutionId);if(!cb){cb=this.Oc.L$d(I.solutionId);if(!cb){r.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)));return}this.Oc.wJc(I.solutionId,cb)}I=cb.settings;(I=O.a.KBf in I?I[O.a.KBf]:null)&&"true"===I.toLowerCase()&&this.mge(V,
Ba)}}else r.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}Dwl(I){if(void 0===I||null===I||void 0===I[this.hma.YRa]||null===I[this.hma.YRa])return!1;I=I[this.hma.YRa];return H.a.Xa(I)?!1:this.UDb.contains(I)}rsl(I){I=I.Eaa;if(!I)r.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(I.JF)for(let V of I.JF)if(V.groups)for(const Ba of V.groups)if(Ba.controls)for(const cb of Ba.controls)if(this.I6e(cb.id,
cb.enabled),1===cb.controlType&&cb.menuItems)for(const Nb of cb.menuItems)this.I6e(Nb.id,Nb.enabled)}I6e(I,V){if(I&&I.length){var Ba=this.UDb.contains(I);Ba&&V&&this.UDb.remove(I);Ba||V||this.UDb.add(I)}}uSl(I){let V=null,Ba=null,cb=!0;void 0!==I[O.a.W5d]&&null!==I[O.a.W5d]&&void 0!==I[this.hma.YRa]&&null!==I[this.hma.YRa]&&void 0!==I[O.a.U5d]&&null!==I[O.a.U5d]&&(V=I[O.a.W5d],Ba=I[this.hma.YRa],cb=I[O.a.U5d]);H.a.Xa(V)||H.a.Xa(Ba)||(I=(new nd("",V,this.hma,!0)).KEa(Ba),this.I6e(I,cb),this.Rb.updateCommandUI())}e6b(I){if(void 0!==
I&&null!==I&&void 0!==I[O.a.V5d]&&null!==I[O.a.V5d])switch(I[O.a.V5d]){case 1:this.uSl(I);break;case 4:this.UDb.clear(),this.UDb.addRange(this.akk)}}bFk(I,V){if(V)if(V)if(I=V.Aw,V=V.$H,!Ja()&&!ta()||this.Oc.L$d(I.solutionId)){var Ba=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(V=I.solutionId in Ba?Ba[I.solutionId]:this.$gj(V))?(this.M9b({["SourceControlId"]:V}),I.isAutoLaunched=!0):r.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else r.ULS.sendTraceTag(512259016,
220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)));else r.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else r.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}$gj(I){if(!I)return r.ULS.sendTraceTag(512499859,220,10,"Failed to get button id for addin"),null;I=I.Eaa;if(!I||!I.JF||!I.JF.count)return r.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),
null;I=I.JF.ga(0);if(!I.groups||1!==I.groups.length)return r.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;I=I.groups[0];if(!I.controls||1!==I.controls.length)return r.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;I=I.controls[0];return I.attributes&&0===I.controlType&&I.enabled?I.id:null}UIk(I,V){let Ba=null;V&&(Ba=V);Ba&&Ba.$H&&this.rsl(Ba.$H);Ba?(Ba.Aw&&this.Ari(Ba.Aw.solutionId),this.Da.UVj&&window.setTimeout(()=>{Ba.Aw&&this.Eri(Ba.Aw)},0)):r.ULS.sendTraceTag(512499855,
220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}P$d(){const I=new e.a;this.Da.Gua&&(this.Da.h1c&&I.add(0),this.Ib.ka("187")&&I.add(1),this.Ib.ka("305")&&I.add(10),I.add(8));return I}V3e(){const I=this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)||this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1),V=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");Fd.$Eh(this.gma,
this.Rb.UF(),V,I?ResourceStrings.L_TabHome:ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}Nuc(I){I&&this.vhb.Gb(I)&&this.vhb.ga(I).initializeAndShowWithTitle()}B$b(I){I&&this.vhb.Gb(I)&&this.vhb.ga(I).hide()}}Object(h.a)(Pa,"AddinCommandsManager",null,[683]);class bb{constructor(){this.X1g={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};
this.ZOg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};this.Nbd=null}get YRa(){return"SourceControlId"}get XT(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}Boj(){if(!this.Nbd){this.Nbd=
{};for(const I of Object.keys(this.X1g))this.Nbd[I]=this.X1g[I];for(const I of Object.keys(this.ZOg))this.Nbd[I]=this.ZOg[I][0]}}}Object(h.a)(bb,"AddinCommandsStringProvider",null,[682]);class Fc{constructor(I){this.FKi=I}Jbj(){return this.FKi.xui()}}Object(h.a)(Fc,"ContextMenuExtensibilityHandler",null,[681]);var yd=d(82),ge=d(33);class rb{constructor(I,V,Ba,cb){this.MDe=null;this.Oc=I;this.o2g=V;this.pa=Ba;this.Rf=cb}get zdc(){return this.MDe}set zdc(I){this.MDe=I}register(){this.pa.FC(Object(D.a)(this,
this.Esd,"selectionChangeEventHandler"));ge.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Rf.E7a(Object(D.a)(this,this.Esd,"selectionChangeEventHandler"))}dispose(){this.pa.Cga(Object(D.a)(this,this.Esd,"selectionChangeEventHandler"));ge.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Rf.Orc(Object(D.a)(this,this.Esd,"selectionChangeEventHandler"))}Esd(){try{this.zdc&&this.o2g.Kg(this.zdc),this.MDe=new yd.a(4,1,0,()=>{this.zdc=null;this.bNl()},90,"50"),this.o2g.Hb(this.zdc)}catch(I){r.ULS.sendTraceTag(18442309,
802,10,I.toString())}}bNl(){try{this.Oc.Amh(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),null);const V=this.pa.Fk();if(V){var I=V.yj();if(I)for(const Ba of I)if(Ba.nr){const cb=new Sc.a(Ba);this.Oc.s0a(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),cb.id,null)}}}catch(V){r.ULS.sendTraceTag(18442310,802,10,V.toString())}}}Object(h.a)(rb,"AppForOfficeApiSelectionChangeEventListener",null,[662,108]);var gf=d(557),Ab=d(1003),fc=d(740);class kc{}kc.generalException=
"generalException";kc.invalidArgument="invalidArgument";kc.notAllowed="notAllowed";kc.apiNotAvailable="apiNotAvailable";kc.unresolvedPendingRequest="unresolvedPendingRequest";kc.timeout="timeout";kc.adalTimeout="adalTimeout";kc.userNotSignedIn="userNotSignedIn";kc.userAborted="userAborted";kc.silentSignInFailed="silentSignInFailed";kc.invalidResourceUrl="invalidResourceUrl";kc.invalidGrant="invalidGrant";kc.connectionLost="connectionLost";kc.clientError="clientError";kc.serverError="serverError";
Object(h.a)(kc,"WopiHostErrorCodes",null,[]);var ud=d(218);class zd{}Object(h.a)(zd,"OAuthCallerMetadata",null,[]);var Td=d(56);class Me{constructor(I){this.CM=I;this.G_h=z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}Yci(I,V,Ba,cb,Nb,Ec){if(!this.CM)return cb=new Ab.a,cb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(cb);const Oc=new zd;Oc.AddinName=Nb;Oc.AddinTrustId=Ec;let je=-1;Ec=null;if(cb&&this.org())Ec=
this.CM.jNh(O.a.Axd,I,cb,Me.Kbg(Nb),Oc);else{const De=Date.now();Ec=this.CM.mI(O.a.Axd,I,Oc).then(Pd=>{je=Date.now()-De;const Ke=(V||Ba)&&"login_required"===Pd.ErrorCode;return(V&&("interaction_required"===Pd.ErrorCode||"consent_required"===Pd.ErrorCode||"invalid_grant"===Pd.ErrorCode)||Ke)&&this.org()?this.CM.jNh(O.a.Axd,I,null,Me.Kbg(Nb),Oc):Promise.resolve(Pd)})}return Ec.then(De=>{const Pd=new Ab.a;De.IsSuccess?(Pd.token=De.Token,De.Telemetry&&(Pd.jnb=De.Telemetry.fromCache,Pd.expiresOn=De.Telemetry.expiresOn)):
(Pd.errorCode=this.$xk(De),Pd.m7e=this.CQk(De));return Pd}).catch(()=>{const De=new Ab.a;De.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(De)}).then(De=>{De.MCa="OauthManager";0<=je&&(De.q9b=je);return De})}a_j(I){const V=(z.AFrameworkApplication.fa.Ha(z.AFrameworkApplication.yK)||"").toLowerCase();return(Td.a.zGa||"teams"===V&&ud.OAuthManagerSettings.ubb)&&!Me.vZj(I)||!this.CM||!this.CM.xog()?!1:!0}org(){return this.G_h||1!==fc.a.cVc()}$xk(I){switch(I.ErrorCode){case "UserCancelled":case "interaction_required":I=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":I=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:I=I.ErrorCode===kc.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:I.ErrorCode===kc.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:I.ErrorCode===kc.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:I.ErrorCode===kc.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:I.ErrorCode===kc.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return I}CQk(I){let V=
"";(I=RegExp("AADSTS(\\d+)").exec(I.ErrorMessage))&&1<I.length&&(V=I[1]);return V}static Kbg(I){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,I)}static vZj(I){if(!I)return!1;I=I.toLowerCase();for(const V of gf.AppsForOfficeSingleSignOnManager.PTc)if(V===I)return!0;return!1}}Object(h.a)(Me,"AppsforOfficeTokenFromOauthManager",null,[856]);class tf{constructor(I){this.ewk=I}static G9e(){if(z.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var I=
null;try{I=ub.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(V){r.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+V)}I=new Me(I);tf.La=new tf(I)}}static getInstance(){tf.Ckf||(tf.G9e(),tf.Ckf=!0);return tf.La}}tf.La=null;tf.Ckf=!1;Object(h.a)(tf,"AppsForOfficeOauthManagerFactory",null,[811]);class re{constructor(I){const V=tf.getInstance();this.lvf=new gf.AppsForOfficeSingleSignOnManager(I,V)}getAccessTokenAsync(I,V){return new Promise(Ba=>{const cb=z.AFrameworkApplication.fa.ka("342");
this.lvf.getAccessToken(I,cb,V,(Nb,Ec)=>{const Oc={};Oc.errorCode=Nb;Oc.accessToken=Ec?Ec.accessToken:"";Ba(Oc)})})}removeCallbackForAddin(I){this.lvf.removeCallbackForAddin(I)}}Object(h.a)(re,"AppForOfficeAuthProvider",null,[728]);class lh{TMi(I){return new re(I)}}Object(h.a)(lh,"AppForOfficeAuthFactory",null,[627]);var ze=d(236),Je=d(58),Wh=d(49),Kg=d(637);class pd{constructor(I,V,Ba,cb,Nb,Ec,Oc){this.IHe=this.HHe=this.mFe=this.lFe=0;this.fQg=.5;this.vFb=null;this.TAe=0;this.Eik={};this.Zic=document.createElement("div");
this.Zic.className="OsfAddinOverlay";V.appendChild(this.Zic);Ba.cql(this.Zic);this.pxk=I;this.ZJ=Oc;this.ZJ.KJc(Object(D.a)(this,this.CJb,"onZoomed"));this.ua=cb;this.Kc=Nb;this.Vq=Ec;this.Vq.eT(Object(D.a)(this,this.sWe,"registerSlideViewElementEvents"))}dispose(){this.ZJ.eqd(Object(D.a)(this,this.CJb,"onZoomed"));this.Vq.Voa(Object(D.a)(this,this.sWe,"registerSlideViewElementEvents"))}initialize(){if(this.ua.Ba){this.sWe(null,null);const I=this.Kc.Hc;I&&(this.lFe=parseFloat(I.$U.style.left),this.mFe=
parseFloat(I.$U.style.top),this.HHe=parseFloat(I.ye.xa.style.left),this.IHe=parseFloat(I.ye.xa.style.top))}this.maf();this.CJb(null,new Kg.a(this.pxk.zoom))}sWe(I,V){(I=this.Kc.Hc)&&I!==this.vFb&&(I.qli(Object(D.a)(this,this.MQh,"updateOffsetFromSlideView")),I.ski(Object(D.a)(this,this.LQh,"updateOffsetFromPageContentContainer")),this.vFb&&(this.vFb.Mcl(Object(D.a)(this,this.MQh,"updateOffsetFromSlideView")),this.vFb.jcl(Object(D.a)(this,this.LQh,"updateOffsetFromPageContentContainer")),this.H6e(this.vFb,
!1)),V&&V.c4c&&1!==this.TAe&&this.H6e(I,!0),this.vFb=I)}H6e(I,V){if(I&&(I=I.$c)&&I.isConnected){var Ba=I.yj();if(Ba&&Ba.length)for(const Nb of Ba)if(Nb.nr){Ba=Nb.sa(Cd.a.q_,null);var cb=Je.a.ax(I.eb(Cd.a.sid),I.eb(Cd.a.cid)).toString();const Ec=Nb.get_shapeId().toString();Ba=Ba+Ec+cb;ge.a("Microsoft.Office.SharedOnline.FixBug6808089")?(cb=Nb.rg(0),(null===cb||void 0===cb?0:cb.xa)?this.HLa(Ba,V,cb.xa.te):this.HLa(Ba,V,null)):this.HLa(Ba,V,null)}}}W6(I){this.TAe=I;const V=this.Kc.Hc;V?(r.ULS.sendTraceTag(512369926,
806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",V.$c.sid,V.$c.cid),this.H6e(V,2===I)):r.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}LQh(I,V){this.lFe=V.x;this.mFe=V.y;this.maf()}MQh(I,V){this.HHe=V.x;this.IHe=V.y;this.maf()}maf(){this.Zic.style.left=Wh.a.Pc(this.lFe+this.HHe+ze.a.Q6-this.fQg);this.Zic.style.top=Wh.a.Pc(this.mFe+this.IHe+ze.a.Q6-this.fQg)}AWj(I){return I in
this.jsa}mjl(I,V){this.jsa[I]=V}HLa(I,V,Ba){1===this.TAe&&V||I in this.jsa&&this.jsa[I].HLa(V,Ba)}Uph(I){I in this.jsa&&(this.jsa[I].dispose(),delete this.jsa[I])}k0e(I,V){I in this.jsa&&this.jsa[I].k0e(V)}CJb(){}get jsa(){return this.Eik}}Object(h.a)(pd,"AppForOfficeContentAppsContainer",null,[680,108]);var Nc=d(408);class le extends x.StandardDialog{constructor(I,V){super();this.gYh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.Z_h=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.$_h=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.TZh=I;this.UTb=V}showDialog(I,V){const Ba=new Md.a(void 0,void 0,!1);Ba.Ad=0;Ba.ig=Nc.a.opd(Number.MAX_VALUE).toString();Ba.hg=String.format("<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",V,this.$_h,this.Z_h,this.gYh);Ba.sj(I,Object(D.a)(this,this.HFk,"onCheckboxExecute$4"),{optInCheckbox:!1})}HFk(I,
V){1===I&&V.optInCheckbox&&(t.a.instance.getItem("optedIntoAddinDeveloperMode")?t.a.instance.removeItem("optedIntoAddinDeveloperMode"):(t.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.Ruc()))}Ruc(){const I=new x.StandardDialog;I.Ad=4;const V=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.TZh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;I.zP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
V,this.UTb)}}Object(h.a)(le,"AppForOfficeDeveloperModeOptInDialog",x.StandardDialog,[]);const Ye=I=>{const V=[];if(!I)return V;V[OSF.DDA.Marshaling.ThemingKeys.Accent1]=Zc(I.Accent1);V[OSF.DDA.Marshaling.ThemingKeys.Accent2]=Zc(I.Accent2);V[OSF.DDA.Marshaling.ThemingKeys.Accent3]=Zc(I.Accent3);V[OSF.DDA.Marshaling.ThemingKeys.Accent4]=Zc(I.Accent4);V[OSF.DDA.Marshaling.ThemingKeys.Accent5]=Zc(I.Accent5);V[OSF.DDA.Marshaling.ThemingKeys.Accent6]=Zc(I.Accent6);V[OSF.DDA.Marshaling.ThemingKeys.Background1]=
Zc(I.OsfColorScheme?I.OsfColorScheme.Background1:null);V[OSF.DDA.Marshaling.ThemingKeys.Background2]=Zc(I.OsfColorScheme?I.OsfColorScheme.Background2:null);V[OSF.DDA.Marshaling.ThemingKeys.Text1]=Zc(I.OsfColorScheme?I.OsfColorScheme.Text1:null);V[OSF.DDA.Marshaling.ThemingKeys.Text2]=Zc(I.OsfColorScheme?I.OsfColorScheme.Text2:null);V[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=Zc(I.Hyperlink);V[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=Zc(I.FollowedHyperlink);const Ba=I.OsfFontScheme;Ba&&(V[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=
Ba.HdEaFt,V[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Ba.HdLtnFt,V[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Ba.HdLclFt,V[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Ba.HdSptFt,V[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Ba.BdEaFt,V[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Ba.BdLtnFt,V[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Ba.BdLclFt,V[OSF.DDA.Marshaling.ThemingKeys.BdScript]=Ba.BdSptFt);V[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=Zc(I.Background);return V},Zc=I=>{if(!I)return null;let V;
V=I.b;V+=I.g<<8;return V+=I.r<<16};class Jf{constructor(I,V,Ba){this.kQg=I;this.iR=V;this.flk=Ba}register(){this.kQg.gk(Object(D.a)(this,this.YKh,"themeChangedCallback"))}dispose(){this.kQg.Qm(Object(D.a)(this,this.YKh,"themeChangedCallback"))}YKh(I,V){if(V.node.Ta(Cd.a.Fd)&&(V.property===Cd.a.Fd||V.property===Cd.a.Kba)){I=V.node;try{var Ba=Ye(I?I.Fd:null)}catch(cb){return}if(I){I=I.yj();for(const cb of I)cb.nr&&(I=this.flk.N3(cb),this.iR.s0a(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),
I.id,Ba))}this.iR.Amh(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Ba)}}}Object(h.a)(Jf,"AppForOfficeDocumentThemeListener",null,[662,108]);var pg=d(223);class gd extends Md.a{constructor(I,V,Ba){super();this.Kra=null;this.zRd="WACDialogTitleText";this.Xba="0";this.uqa="15px";this.SYh="0px";this.Wba="calc(100% - 30px)";this.RYh="100%";this.Psf=0;this.Oa=new M.a;this.wWh=new F;this.Ad=5;this.ig=this.VTb=Ba;this.SEd=I;this.kgf=V;this.sFd=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}mji(I){this.Oa.addHandler("OnDialogClosedEventKey",
I)}Tql(){this.Wqa=null}Gu(){super.Gu();this.xm.style.width="100%";this.xm.style.height=this.r$b?this.Wba:this.RYh;this.xm.style.marginTop=this.r$b?this.uqa:this.SYh;this.xm.style.padding=this.Xba}ZA(){super.ZA();this.Jb.style.width=String.format("{0}px",this.SEd*window.innerWidth/100);this.Jb.style.height=String.format("{0}px",this.kgf*window.innerHeight/100);this.Jb.style.minWidth="0px";this.sFd&&z.AFrameworkApplication.isRtl&&100===this.SEd&&(this.Jb.style.right="0px",this.Jb.style.marginRight=
"0px");this.Kra=document.getElementById(this.Vh(this.zRd));this.Kra.style.position="absolute";this.Kra.style.whiteSpace="nowrap";this.Kra.style.textOverflow="ellipsis";z.AFrameworkApplication.isRtl?(this.Kra.style.right="14px",this.Kra.style.left="44px"):(this.Kra.style.right="44px",this.Kra.style.left="14px")}dza(I){super.dza(I);this.Kra&&this.Kra.setAttribute("title",I)}get ika(){return this.xm}wYe(){this.Jb.style.width=String.format("{0}px",this.SEd*window.innerWidth/100);this.Jb.style.height=
String.format("{0}px",this.kgf*window.innerHeight/100);this.Jb.style.overflowY="hidden";this.Jb.style.overflowX="hidden";this.Jb.style.marginTop="";this.Jb.style.top="";Td.a.Dcb&&z.AFrameworkApplication.isRtl?(this.Jb.style.right="",this.Jb.style.marginRight=""):(this.Jb.style.left="",this.Jb.style.marginLeft="")}hide(){this.wWh.iQf(3,this.VTb).execute(this,L.getInstance(),{});this.Psf=window.setTimeout(()=>{this.Oa.raiseEvent("OnDialogClosedEventKey",this.VTb);pg.a.prototype.hide.call(this)},500)}bch(I){3===
I&&(window.clearTimeout(this.Psf),this.Oa.raiseEvent("OnDialogClosedEventKey",this.VTb),super.hide())}}Object(h.a)(gd,"AppsForOfficeDialog",Md.a,[809,670]);class bd{constructor(){this.dialog=this.ig=null}}Object(h.a)(bd,"DialogInfo",null,[]);class Ne{}Ne.url="url";Ne.height="height";Ne.width="width";Ne.h5d="displayInIframe";Ne.d_c="hideTitle";Object(h.a)(Ne,"DialogSettings",null,[]);class rf{constructor(){this.height=this.width=0;this.ig=this.controlId=this.pageUrl=null;this.d_c=this.h5d=!1}}Object(h.a)(rf,
"DisplayDialogParams",null,[]);class Fh extends Sys.EventArgs{constructor(I,V,Ba=null,cb="",Nb=""){super();this.controlId=I;this.messageType=V;this.messageContent=Ba;this.nKe=cb;this.GMa=Nb}}Object(h.a)(Fh,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class Ae extends Sys.EventArgs{constructor(I,V,Ba=null,cb="",Nb=""){super();this.controlId=I;this.messageType=V;this.messageContent=Ba;this.nKe=cb;this.GMa=Nb}}Object(h.a)(Ae,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Kf=d(103);class Mf{constructor(I){this.Oa=
new M.a;this.gB=I}Kji(I){this.Oa.addHandler("OnMessageParentEventKey",I)}rrh(I){this.Oa.removeHandler("OnMessageParentEventKey",I)}Jji(I){this.Oa.addHandler("OnMessageDialogEventKey",I)}Obl(I){this.Oa.removeHandler("OnMessageDialogEventKey",I)}showDialog(I,V,Ba,cb){if(Mf.jqa.Gb(V))r.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Ke=ka.b(I),xg=Ke[Ne.url];if(this.gB.getOsfControl(V).checkAppDomains(xg)){var Nb=
new rf;Nb.width=Ke[Ne.width];Nb.height=Ke[Ne.height];Nb.pageUrl=xg;Nb.h5d=Ke[Ne.h5d];Nb.d_c=Ke[Ne.d_c];Nb.controlId=V;Nb.ig=Kf.a.create().toString();var Ec=new bd;Ec.ig=Nb.ig;var Oc=this.gB.getOsfControl(Nb.controlId).getManifest().getDefaultDisplayName(),je=this.gB.getOsfControl(Nb.controlId).getStoreType().toLowerCase();I=null;I=(4===z.AFrameworkApplication.Aa.mb.Ti&&"hardcodedpreinstall"===je||"sdxcatalog"===je)&&Nb.d_c?this.createAndShowAppsForOfficeDialog(Nb.width,Nb.height,Nb.ig,!0,Oc):this.createAndShowAppsForOfficeDialog(Nb.width,
Nb.height,Nb.ig,!1,Oc);var De=this.gB.getOsfControl(Nb.controlId),Pd=De.getManifest();V={};V.id=Nb.ig;V.solutionId=De.getSolutionId();V.version=De.getVersion();V.storeType=je;V.storeId=De.getStoreId();V.assetId=De.getAssetId();V.assetStoreId=De.getAssetStoreId();V.ownerAddinSolutionId=De.getOwnerAddinSolutionId();V.ownerAddinStoreType=De.getOwnerAddinStoreType();V.appDomains=Pd.getAppDomains();V.dialogUrl=xg;V.osfControlType=1;V.agaveName=Oc;V.div=I.ika;r.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(V.solutionId,V.ownerAddinStoreType||V.storeType,V.assetId,null,null,V.storeId),H.a.nL(Nb.pageUrl));this.gB.insertDialogControl(V);I.mji(Object(D.a)(this,this.BGk,"onDialogClosed"));Ec.dialog=I;Mf.jqa.$(Nb.controlId,Ec);cb&&cb(V);Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else r.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Ke){r.ULS.sendTraceTag(18371104,
344,10,"ShowDialog: action failed. Exception message: {0}",Ke.message),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}kAk(I,V,Ba,cb){z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===cb&&(cb=Ba);try{const Nb=this.KEa(I);Nb&&this.Oa.raiseEvent("OnMessageParentEventKey",new Ae(Nb,OSF.DialogMessageType.DialogMessageReceived,V,Ba,cb))}catch(Nb){return r.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",
Nb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}kFi(I,V){if(Mf.jqa.Gb(I))try{const Ba=Mf.jqa.ga(I);Ba.dialog&&Ba.dialog.hide();this.gB.purgeDialogControl(Ba.ig);Mf.jqa.remove(I);V(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ba){r.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ba.message),V(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else r.ULS.sendTraceTag(18896286,344,
10,"CloseDialog: agave dialog map does not has dialog info for this control."),V(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}gml(I,V,Ba,cb){z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===cb&&(cb=Ba);if(Mf.jqa.Gb(I)&&(I=Mf.jqa.ga(I),I.dialog))try{this.Oa.raiseEvent("OnMessageDialogEventKey",new Fh(I.ig,OSF.DialogMessageType.DialogParentMessageReceived,V,Ba,cb))}catch(Nb){r.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",
Nb.message)}}KEa(I){let V=null;for(let Ba of Mf.jqa)if(Ba.value.ig===I){V=Ba.key;break}return V}BGk(I,V){if(I=this.KEa(V))this.gB.purgeDialogControl(V),Mf.jqa.remove(I),this.Oa.raiseEvent("OnMessageParentEventKey",new Ae(I,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(I,V,Ba,cb,Nb){I=new gd(I,V,Ba);Nb=cb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Nb);cb&&(I.r$b=!1,I.Mr=!1);I.sj(Nb,null,null);I.Tql();return I}static vfg(){return Mf.jqa}static getInstance(I){Mf.La||
(Mf.La=new Mf(I));return Mf.La}}Mf.La=null;Mf.jqa=new Xb.a;Object(h.a)(Mf,"AppsForOfficeDialogManager",null,[769]);var vf=d(735),eg=d(67),zf=d(120),Nd=d(96),Se=d(176),Qe=d(125);class Ei extends Sys.EventArgs{constructor(I){super();this.Rca=I}}Object(h.a)(Ei,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var Ff=d(48);class Jh{constructor(I,V,Ba,cb,Nb,Ec){this.hR=[];this.mJe=new vf.a;this.Fa=V;this.Vr=Ba;this.jb=cb;this.Oc=Nb;this.$d=Ec}get u3(){return this.hR}get Hd(){return this.Oc.value}ahe(){return 0<
this.Omc}m_(I){I&&(this.u3.push(I),1===this.Omc&&this.Fa.wj(Qe.a.oYd,!0),I.isVisible&&this.Vr.addHandler(I.xa,eg.a.Df,Object(D.a)(this,this.aig,"handleShortCutsOnAddinPane")))}wqh(I){I&&(Array.remove(this.hR,I),this.Vr.removeHandler(I.xa,eg.a.Df,Object(D.a)(this,this.aig,"handleShortCutsOnAddinPane")),this.Omc||this.Fa.wj(Qe.a.oYd,!1))}W6(I){if(1===I||2===I){if(1===I){this.mJe=new vf.a;for(const V of this.u3)V.isVisible&&this.mJe.add(V.id.toLowerCase())}I=2===I;for(const V of this.u3)this.mJe.contains(V.id.toLowerCase())&&
(V.Zp(I),(I&&1===this.Omc||!I&&!this.Omc)&&this.Fa.wj(Qe.a.oYd,I))}}WFj(I,V){for(const Ba of this.hR)I=Ba.layout(I,V)}XU(I,V){if(I){I=null;if(V===Ff.a.qg)for(V=this.hR.length-1;0<=V;V--){if(this.hR[V].isVisible){I=this.hR[V];break}}else if(V===Qe.a.fIf||V===Qe.a.ywi||V===zf.AFrame.nW||V===zf.AFrame.T6b||V===Qe.a.D3||V===Qe.a.Dwi||V===Ff.a.aI||V===Ff.a.nJ||V===Ff.a.YW)for(V=0;V<this.hR.length;V++)if(this.hR[V].isVisible){I=this.hR[V];break}this.z9d(I)}}z9d(I){if(I){var V=this.Hd.HTc(I.id);V&&this.$d.L0k(new Ei(V.Rca));
this.Hd.notifyAgave(I.id,11)}else r.ULS.sendTraceTag(508891138,806,10,"Focus could not be put on the null addin pane!")}u$i(I,V){var Ba;for(Ba=0;Ba<this.hR.length&&this.hR[Ba].id!==I;Ba++);if(Ba===this.hR.length)r.ULS.sendTraceTag(508891137,806,10,String.format("Failed to find the taskpane with instance id: {0}",I)),this.g9e(V);else{I=null;if(5===V)for(--Ba;0<=Ba;Ba--){if(this.hR[Ba].isVisible){I=this.hR[Ba];break}}else if(6===V)for(Ba+=1;Ba<this.hR.length;Ba++)if(this.hR[Ba].isVisible){I=this.hR[Ba];
break}I?this.z9d(I):this.g9e(V)}}I3f(I){for(const V of this.hR)if(V.id===I){Nd.FocusManager.Zq(V.qFi);return}r.ULS.sendTraceTag(508891136,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",I))}NOl(I){for(let V of Mf.vfg())if(V.value.ig.toLowerCase()===I.toLowerCase())return V.value.dialog.hide(),V.key;return null}g9e(I){5===I?this.Fa.KUa(!1):6===I&&this.Fa.KUa(!0)}T_f(){const I=this.jb.Ud();I&&1===I.length&&(this.jb.selectShape(I[0],!0),this.Fa.Bd())}get Omc(){let I=
0;for(const V of this.u3)V.isVisible&&I++;return I}aig(I){if(I.keyCode===Se.a.EZ&&I.ctrlKey)for(var V=0;V<this.u3.length;V++){var Ba=this.u3[V];if(Ba.isVisible&&Ba.xa.contains(I.target)){Ba=null;if(I.shiftKey)for(V+=1;V<this.u3.length;V++){if(this.u3[V].isVisible){Ba=this.u3[V];break}}else for(--V;0<=V;V--)if(this.u3[V].isVisible){Ba=this.u3[V];break}Ba&&(this.z9d(Ba),I.preventDefault(),I.stopPropagation());break}}}wf(I){this.Fa.wf(I)}}Object(h.a)(Jh,"AppForOfficeFocusManager",null,[676]);var Wf=
d(966);class md{sNi(I,V,Ba){I=Wf.a.Idg(I.Zib);I.appName=OSF.AppName.PowerpointWebApp;I.clientMode=1;I.formFactor="DefaultSettings";I.hostControl=V;V=ub.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");I.allowExternalMarketplace=I.allowExternalMarketplace&&V.g3b;Ba.register(I);Ba=new OSF.ContextActivationManager(I);Ba.setWSA(z.AFrameworkApplication.Ci);return Ba}}Object(h.a)(md,"AppForOfficeImportedClassFactory",null,[675]);class Gf{constructor(I){this.jAg=I}fWe(){for(const I of this.jAg)I.register()}dispose(){for(const I of this.jAg)I.dispose()}}
Object(h.a)(Gf,"AppForOfficeListenerManager",null,[671,108]);var Hd=d(1254),Ee=d(1255),Ki=d(153),wf;(function(I){I[I.myAddins=0]="myAddins";I[I.adminManaged=1]="adminManaged";I[I.popular=2]="popular"})(wf||(wf={}));Object(h.b)("AddinCollectionType",wf);class ag{constructor(){this.downloadNumber=this.AUP=this.priority=0}}Object(h.a)(ag,"AddinDetailInfo",null,[]);class Og{constructor(I){this.solutionIds=null;this.errorCode=0;this.failure=null;this.Fsa=I}}Object(h.a)(Og,"AddinCollection",null,[]);class Kh extends Sys.EventArgs{constructor(I,
V,Ba,cb=null){super();this.p_=I;this.errorCode=V;this.tW=Ba;this.failure=cb}}Object(h.a)(Kh,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class Xg{constructor(I){this.errorCode=I;this.tW=[];this.failure=null}}Object(h.a)(Xg,"GetAddinDetailsResult",null,[]);var Yd=d(390);class ce{}Object(h.a)(ce,"GetEntitlementDetailsParameters",null,[]);var Rh=d(144),ng=d(198),Vi=d(6);class $h{constructor(I,V,Ba=null){this.Oa=new M.a;this.jw=new Hd.a(Ee.a.Gk());this.Jn=new Ki.a;this.j3=null;this.Qia=new ng.a;
this.Qia.add(OSF.StoreTypeEnum.MarketPlace,0);this.Qia.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ma=I;this.gB=V;this.fB=Ba;this.BVb=$h.g8b(I,"https://store-images.s-microsoft.com");this.OQa(Object(D.a)(this,this.o_a,"onAddinDetailsRefreshed"))}get yTa(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get ubc(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Xi(){return this.gB.value}H$a(I){if(!this.yla(I))return I=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:wf[I]}),Object.assign(new Xg(1),{failure:I});if(this.Jn.ga(I).failure)return Object.assign(new Xg(this.Jn.ga(I).errorCode),{failure:this.Jn.ga(I).failure});r.ULS.shipAssertTag(509870082,220,!!this.Jn.ga(I).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",I);const V=new Xg(0);for(let Ba of this.Jn.ga(I).solutionIds)this.jw.Gb(Ba)&&Array.add(V.tW,this.jw.ga(Ba));return V}v7b(I){return this.jw.Gb(I)?
this.jw.ga(I):null}nWe(I){if(I){this.OQa(I);for(let Ba of this.Jn.keys)if(this.yla(Ba)&&!this.Jn.ga(Ba).failure){r.ULS.shipAssertTag(509870081,220,!!this.Jn.ga(Ba).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ba);var V=[];for(let cb of this.Jn.ga(Ba).solutionIds)Array.add(V,this.jw.ga(cb));V=new Kh(Ba,this.Jn.ga(Ba).errorCode,V);I(null,V)}}}dV(I,V=!1){0!==I&&10!==I?r.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
Yd.a[I]):this.Zpc(I,Object(D.a)(this,this.Dnc,"onQueryAddinDetailsCompleted"),V)}OQa(I){this.Oa.addHandler(O.a.etb,I)}Dnc(I,V,Ba){if(Ba)if($h.$dc(I,Ba,window.performance.now()-V),0===Ba.errorCode){let Nb;if(Ba.value){let Ec=0;Nb=Array(Ba.value.length);Ba.value.forEach(Oc=>{Nb[Ec++]=Oc})}else Nb=[];this.RM(I,Nb)}else if(-1===Ba.errorCode||10===Ba.errorCode)this.RM(I,[]);else{var cb={};cb.collectionType=wf[I];cb.invokeResultCode=Ba.errorCode;cb["queryResult.Value"]=Ba.value?String.format("Length: {0}",
Ba.value.length):"null";cb.queryStart=V;cb.queryDuration=window.performance.now()-V;this.Jn.$(I,Object.assign(new Og(I),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",cb)}));r.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",wf[I],this.Jn.ga(I).failure.toString(),JSON.stringify(this.Jn.ga(I).failure))}else cb={},cb.collectionType=wf[I],cb.queryResult=Ba?"not null":
"null",cb.queryStart=V,cb.queryDuration=window.performance.now()-V,this.Jn.$(I,Object.assign(new Og(I),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",cb)})),r.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",wf[I],this.Jn.ga(I).failure.toString(),JSON.stringify(this.Jn.ga(I).failure))}Tge(I){const V={};V.collectionType=wf[I];this.Jn.$(I,Object.assign(new Og(I),{errorCode:2,
failure:Error.create("The store is disabled.",V)}));r.ULS.sendTraceTag(510253056,220,15,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",wf[I],this.Jn.ga(I).failure.toString(),JSON.stringify(this.Jn.ga(I).failure))}tuc(){return this.yla(2)?this.Ma.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Jn.ga(2).failure:!1:!0}Zpc(I,V,Ba=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",I);I!==OSF.StoreTypeEnum.MarketPlace&&
I!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",I):(this.tuc()&&this.queryStoreDisabled(0,(cb,Nb)=>{Nb?this.Tge(2):(cb=window.performance.now(),V(2,cb,this.yde()))}),this.queryStoreDisabled(I,(cb,Nb)=>{if(cb===OSF.StoreTypeEnum.MarketPlace&&Nb)this.Tge(0);else if(cb===OSF.StoreTypeEnum.PrivateCatalog&&Nb)this.Tge(1);else{var Ec=window.performance.now();this.Xi.getEntitlementDetails(Object.assign(new ce,{storeType:cb,refresh:Ba}),Oc=>{V(this.Qia.ga(cb),
Ec,Oc)})}}))}RM(I,V){I=new Kh(I,0,V);this.Oa.raiseEvent(O.a.etb,I)}o_a(I,V){I=Object.assign(new Og(V.p_),{solutionIds:new e.a});var Ba=V.tW;for(const cb of Ba)Ba=cb.solutionId,this.jw.Gb(Ba)?this.jw.$(Ba,this.Ulc(this.jw.ga(Ba),V.p_,cb)):this.jw.add(Ba,cb),I.solutionIds.add(Ba);this.Jn.$(V.p_,I)}yla(I){return this.Jn.Gb(I)?!!this.jw:!1}get H0b(){return this.fB?!this.fB.AreThirdPartyAddInsAllowed||this.fB.AppsForOfficeThirdPartyIsDisabled:!this.Ma.ka("AreThirdPartyAddInsAllowed")||this.Ma.ka("AppsForOfficeThirdPartyIsDisabled")}get Rbc(){return this.fB?
!this.fB.AppsForOfficeAllowExternalMarketplace:!this.Ma.ka("AppsForOfficeAllowExternalMarketplace")}get wKa(){return this.fB?this.fB.PopularAddinDetailsJsonString:this.Ma.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(I,V){if(this.H0b)V(I,!0);else if(I===OSF.StoreTypeEnum.MarketPlace&&this.Rbc)V(I,!0);else{const Ba=$h.Gwc(I);if(Ba){const cb=window.performance.now();this.Xi.queryStoreDisabled(Ba,Nb=>{r.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
I,Nb,cb,window.performance.now()-cb);V(I,Nb)})}else V(I,!1)}}Ulc(I,V,Ba){if(!I)return Ba;if(!Ba)return I;if(this.yTa)return 2===V?$h.XZa(Ba,I):$h.XZa(I,Ba);if(2===V)return I.addinInfo=Ba.addinInfo,I;Ba.addinInfo=I.addinInfo;return Ba}yde(){if(!this.j3){const I=JSON.parse(this.wKa);this.R6b(I);this.j3=I}return $h.e8a(0,this.j3)}R6b(I){this.yTa&&$h.y0b(I);this.Btb(I);this.S6b(I)}Btb(I){const V=this.m1b();for(var Ba=0;Ba<I.length&&0<V.count;Ba++){const cb=I[Ba];if(V.Gb(cb.solutionId)){let Nb=String.format("Found an override, solutionId: {0}",
cb.solutionId);const Ec=V.ga(cb.solutionId);Ec&&(isNaN(Ec.addinInfo.priority)||(Nb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Nb,cb.addinInfo.priority,Ec.addinInfo.priority),cb.addinInfo.priority=Ec.addinInfo.priority),isNaN(Ec.addinInfo.AUP)||(Nb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Nb,cb.addinInfo.AUP,Ec.addinInfo.AUP),cb.addinInfo.AUP=Ec.addinInfo.AUP),isNaN(Ec.addinInfo.downloadNumber)||(Nb=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Nb,cb.addinInfo.downloadNumber,
Ec.addinInfo.downloadNumber),cb.addinInfo.downloadNumber=Ec.addinInfo.downloadNumber),Ec.displayName&&(Nb=String.format("{0}; DisplayName: update {1} to {2}",Nb,cb.displayName,Ec.displayName),cb.displayName=Ec.displayName),Ec.iconUrl&&(Nb=String.format("{0}; IconUrl: update {1} to {2}",Nb,cb.iconUrl,Ec.iconUrl),cb.iconUrl=Ec.iconUrl),Ec.description&&(Nb=String.format("{0}; Description: update {1} to {2}",Nb,cb.description,Ec.description),cb.description=Ec.description));V.remove(cb.solutionId);this.ubc&&
r.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Nb)}}for(let cb of V.keys)Ba=V.ga(cb),Ba.displayName&&Ba.iconUrl&&Ba.addinInfo&&(I.push(Ba),this.ubc&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ba)))}m1b(){const I=new Hd.a(Ee.a.Gk());let V=this.Ma.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!V)return I;V=V.trim();if(12>=V.length)return 0<
V.length&&r.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",V),I;this.ubc&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",V);try{const Ba=[],cb=V.split("|");for(let Nb=cb.length-1;0<=Nb;Nb--){const Ec=cb[Nb],Oc=Ec.split("\\");if(2>Oc.length){Ba.push(Ec);continue}const je=$h.Goc(Oc);je?I.Gb(je.solutionId)||I.add(je.solutionId,je):Ba.push(Ec)}this.ubc&&0<Ba.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",
Ba.join("|"));this.ubc&&0<I.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",I.count,JSON.stringify(Vi.toArray(I.values)));return I}catch(Ba){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",V,Ba.toString())}return I}S6b(I){for(let V=0;V<I.length;V++)Rh.c(I[V].iconUrl.toLowerCase(),"http",0)||(I[V].iconUrl=String.format("{0}/image/apps.{1}",this.BVb,I[V].iconUrl))}static $dc(I,
V,Ba){const cb={};cb.AddinCollectionType=wf[I];cb.ErrorCode=V.errorCode;cb.AddinCount=V.value?V.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",Ba,JSON.stringify(cb))}static e8a(I,V){const Ba={};Ba.errorCode=I;Ba.value=V;return Ba}static Gwc(I){return I===OSF.StoreTypeEnum.MarketPlace?"omex":I===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static XZa(I,V){V.solutionId=V.solutionId||I.solutionId;V.version=V.version||
I.version;V.storeType=V.storeType||I.storeType;V.storeId=V.storeId||I.storeId;V.assetId=V.assetId||I.assetId;V.assetStoreId=V.assetStoreId||I.assetStoreId;V.displayName=V.displayName||I.displayName;V.provider=V.provider||I.provider;V.description=V.description||I.description;V.iconUrl=V.iconUrl||I.iconUrl;V.webApplicationId=V.webApplicationId||I.webApplicationId;V.highResolutionIconUrl=V.highResolutionIconUrl||I.highResolutionIconUrl;V.licenseUrl=V.licenseUrl||I.licenseUrl;V.privacyUrl=V.privacyUrl||
I.privacyUrl;V.addinInfo=V.addinInfo||I.addinInfo;isNaN(V.targetType)&&(V.targetType=I.targetType);isNaN(V.height)&&(V.height=I.height);isNaN(V.width)&&(V.width=I.width);return V}static y0b(I){for(const V of I)isNaN(V.targetType)&&(V.targetType=1),V.assetId=V.assetId||V.solutionId,V.storeId=V.storeId||"en-US",V.storeType=V.storeType||"omex",V.assetStoreId=V.assetStoreId||"omex",isNaN(V.width)&&(V.width=0),isNaN(V.height)&&(V.height=0)}static Goc(I){const V={};let Ba=0;Ba<I.length&&0<I[Ba].trim().length&&
I[Ba].trim().toLowerCase().startsWith("wa")&&(V.solutionId=I[Ba].trim(),V.addinInfo=Object.assign(new ag,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.priority=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.AUP=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.downloadNumber=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.displayName=I[Ba].trim()),++Ba<I.length&&
0<I[Ba].trim().length&&(V.iconUrl=I[Ba].trim()),++Ba<I.length&&0<I[Ba].trim().length&&(V.description=I[Ba].trim()));return V.solutionId?V:null}static g8b(I,V){I=I.Ha("AddinImageStoreServiceUrl");if(!I)return V;I=I.toLowerCase();return I.startsWith("http://")||I.startsWith("https://")?I:V}}Object(h.a)($h,"AddinDetailsManager",null,[838,839]);class fg{constructor(I,V=0){this.failure=null;this.Fsa=I;this.errorCode=V}}Object(h.a)(fg,"AddinQueryResult",null,[]);class dk extends fg{constructor(I,V=0){super(I,
V);this.solutionIds=null}}Object(h.a)(dk,"AddinCollection",fg,[]);var xi=d(699);class yh{constructor(I,V,Ba=null){this.Oa=new M.a;this.jw=new Hd.a(Ee.a.Gk());this.Jn=new Ki.a;this.j3=null;this.Qia=new ng.a;this.Qia.add(OSF.StoreTypeEnum.MarketPlace,0);this.Qia.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ma=I;this.gB=V;this.fB=Ba;this.BVb=yh.g8b(I,"https://store-images.s-microsoft.com");this.OQa(Object(D.a)(this,this.o_a,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ma&&this.Ma.ka("IsAnonymousUser")}get x9d(){return!!this.Ma&&
this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get c7b(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get yTa(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get Bka(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Xi(){return this.gB.value}H$a(I){if(!this.yla(I))return I=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:wf[I]}),Object.assign(new Xg(1),{failure:I});if(this.Jn.ga(I).failure)return Object.assign(new Xg(this.Jn.ga(I).errorCode),{failure:this.Jn.ga(I).failure});r.ULS.shipAssertTag(509870082,220,!!this.Jn.ga(I).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",I);const V=new Xg(0);for(let Ba of this.Jn.ga(I).solutionIds)this.jw.Gb(Ba)&&Array.add(V.tW,this.jw.ga(Ba));return V}v7b(I){return this.jw.Gb(I)?
this.jw.ga(I):null}nWe(I){if(I){this.OQa(I);for(let V of this.Jn.keys){if(!this.yla(V)||this.Jn.ga(V).failure)continue;r.ULS.shipAssertTag(509870081,220,!!this.Jn.ga(V).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",V);const Ba=[],cb=this.Jn.ga(V);for(let Nb of cb.solutionIds)Array.add(Ba,this.jw.ga(Nb));I(null,new Kh(V,cb.errorCode,Ba,cb.failure))}}}dV(I,V=!1){0!==I&&10!==I?r.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
Yd.a[I]):this.Zpc(I,Object(D.a)(this,this.Dnc,"onQueryAddinDetailsCompleted"),V)}OQa(I){this.Oa.addHandler(O.a.etb,I)}Dnc(I,V,Ba){if(Ba)if(yh.$dc(I,Ba,window.performance.now()-V),0===Ba.errorCode){let cb;if(Ba.value){let Nb=0;cb=Array(Ba.value.length);Ba.value.forEach(Ec=>{cb[Nb++]=Ec})}else cb=[];this.RM(new fg(I),cb)}else-1===Ba.errorCode||10===Ba.errorCode?this.RM(new fg(I),[]):(I=this.aYd(I,V,Ba),this.RM(I));else I=yh.bYd(I,V),this.RM(I)}aYd(I,V,Ba){const cb={};cb.collectionType=wf[I];cb.invokeResultCode=
Ba.errorCode;cb["queryResult.Value"]=Ba.value?String.format("Length: {0}",Ba.value.length):"null";cb.queryStart=V;cb.queryDuration=window.performance.now()-V;return Object.assign(new fg(I,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",cb)})}tuc(){return this.yla(2)?this.Ma.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Jn.ga(2).failure:!1:!0}Zpc(I,V,Ba=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",I);
I!==OSF.StoreTypeEnum.MarketPlace&&I!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",I):(this.tuc()&&this.queryStoreDisabled(0,(cb,Nb)=>{Nb?(cb=yh.f8a(2),this.RM(cb)):(cb=window.performance.now(),V(2,cb,this.yde()))}),this.c7b&&this.isAnonymousUser?(I=yh.UXd(I===OSF.StoreTypeEnum.MarketPlace?0:1),this.RM(I)):this.queryStoreDisabled(I,(cb,Nb)=>{if(cb===OSF.StoreTypeEnum.MarketPlace&&Nb)Nb=yh.f8a(0),this.RM(Nb);else if(cb===OSF.StoreTypeEnum.PrivateCatalog&&
Nb)Nb=yh.f8a(1),this.RM(Nb);else{var Ec=window.performance.now();this.Xi.getEntitlementDetails(Object.assign(new ce,{storeType:cb,refresh:Ba}),Oc=>{V(this.Qia.ga(cb),Ec,Oc)})}}))}RM(I,V=null){0!==I.errorCode?(r.ULS.shipAssertTag(509116673,220,!V,"The parameter addinDetails must be null for any failed queries"),r.ULS.shipAssertTag(509116672,220,!!I.failure,"The result.Failure must not be available for any failed queries"),r.ULS.sendTraceTag(510253056,220,this.vfe(I),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",
wf[I.Fsa],xi.a[I.errorCode],I.failure?I.failure.toString():"null",JSON.stringify(I.failure))):(r.ULS.shipAssertTag(509116643,220,!!V,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",wf[I.Fsa]),r.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",wf[I.Fsa],V?V.length:-1));I=new Kh(I.Fsa,I.errorCode,V,I.failure);this.Oa.raiseEvent(O.a.etb,I)}vfe(I){return 3===I.errorCode&&(this.c7b&&
-2147208619===yh.j8b(I)||this.x9d&&-2===yh.j8b(I))?15:2===I.errorCode?15:10}o_a(I,V){if(0!==V.errorCode)this.Jn.$(V.p_,Object.assign(new dk(V.p_,V.errorCode),{failure:V.failure}));else{I=Object.assign(new dk(V.p_),{solutionIds:new e.a});var Ba=V.tW;for(const cb of Ba)Ba=cb.solutionId,this.jw.Gb(Ba)?this.jw.$(Ba,this.Ulc(this.jw.ga(Ba),V.p_,cb)):this.jw.add(Ba,cb),I.solutionIds.add(Ba);this.Jn.$(V.p_,I)}}yla(I){return this.Jn.Gb(I)?!!this.jw:!1}get H0b(){return this.fB?!this.fB.AreThirdPartyAddInsAllowed||
this.fB.AppsForOfficeThirdPartyIsDisabled:!this.Ma.ka("AreThirdPartyAddInsAllowed")||this.Ma.ka("AppsForOfficeThirdPartyIsDisabled")}get Rbc(){return this.fB?!this.fB.AppsForOfficeAllowExternalMarketplace:!this.Ma.ka("AppsForOfficeAllowExternalMarketplace")}get wKa(){return this.fB?this.fB.PopularAddinDetailsJsonString:this.Ma.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(I,V){if(this.H0b)V(I,!0);else if(I===OSF.StoreTypeEnum.MarketPlace&&this.Rbc)V(I,!0);else{const Ba=yh.Gwc(I);if(Ba){const cb=
window.performance.now();this.Xi.queryStoreDisabled(Ba,Nb=>{r.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",I,Nb,cb,window.performance.now()-cb);V(I,Nb)})}else V(I,!1)}}Ulc(I,V,Ba){if(!I)return Ba;if(!Ba)return I;if(this.yTa)return 2===V?yh.XZa(Ba,I):yh.XZa(I,Ba);if(2===V)return I.addinInfo=Ba.addinInfo,I;Ba.addinInfo=I.addinInfo;return Ba}yde(){if(!this.j3){const I=JSON.parse(this.wKa);this.R6b(I);this.j3=I}return yh.e8a(0,
this.j3)}R6b(I){this.yTa&&yh.y0b(I);this.Btb(I);this.S6b(I)}Btb(I){const V=this.m1b();for(var Ba=0;Ba<I.length&&0<V.count;Ba++){const cb=I[Ba];if(V.Gb(cb.solutionId)){let Nb=String.format("Found an override, solutionId: {0}",cb.solutionId);const Ec=V.ga(cb.solutionId);Ec&&(isNaN(Ec.addinInfo.priority)||(Nb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Nb,cb.addinInfo.priority,Ec.addinInfo.priority),cb.addinInfo.priority=Ec.addinInfo.priority),isNaN(Ec.addinInfo.AUP)||(Nb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Nb,cb.addinInfo.AUP,Ec.addinInfo.AUP),cb.addinInfo.AUP=Ec.addinInfo.AUP),isNaN(Ec.addinInfo.downloadNumber)||(Nb=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Nb,cb.addinInfo.downloadNumber,Ec.addinInfo.downloadNumber),cb.addinInfo.downloadNumber=Ec.addinInfo.downloadNumber),Ec.displayName&&(Nb=String.format("{0}; DisplayName: update {1} to {2}",Nb,cb.displayName,Ec.displayName),cb.displayName=Ec.displayName),Ec.iconUrl&&(Nb=String.format("{0}; IconUrl: update {1} to {2}",Nb,cb.iconUrl,
Ec.iconUrl),cb.iconUrl=Ec.iconUrl),Ec.description&&(Nb=String.format("{0}; Description: update {1} to {2}",Nb,cb.description,Ec.description),cb.description=Ec.description));V.remove(cb.solutionId);this.Bka&&r.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Nb)}}for(let cb of V.keys)Ba=V.ga(cb),Ba.displayName&&Ba.iconUrl&&Ba.addinInfo&&(I.push(Ba),this.Bka&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(Ba)))}m1b(){const I=new Hd.a(Ee.a.Gk());let V=this.Ma.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!V)return I;V=V.trim();if(12>=V.length)return 0<V.length&&r.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",V),I;this.Bka&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",V);try{const Ba=[],cb=V.split("|");for(let Nb=cb.length-1;0<=Nb;Nb--){const Ec=
cb[Nb],Oc=Ec.split("\\");if(2>Oc.length){Ba.push(Ec);continue}const je=yh.Goc(Oc);je?I.Gb(je.solutionId)||I.add(je.solutionId,je):Ba.push(Ec)}this.Bka&&0<Ba.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ba.join("|"));this.Bka&&0<I.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",I.count,JSON.stringify(Vi.toArray(I.values)));return I}catch(Ba){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
V,Ba.toString())}return I}S6b(I){for(let V=0;V<I.length;V++)Rh.c(I[V].iconUrl.toLowerCase(),"http",0)||(I[V].iconUrl=String.format("{0}/image/apps.{1}",this.BVb,I[V].iconUrl))}static bYd(I,V){const Ba={};Ba.collectionType=wf[I];Ba.queryResult="null";Ba.queryStart=V;Ba.queryDuration=window.performance.now()-V;return Object.assign(new fg(I,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ba)})}static f8a(I){const V={};V.collectionType=wf[I];return Object.assign(new fg(I,2),{failure:Error.create("The store is disabled.",
V)})}static UXd(I){const V={};V.collectionType=wf[I];V.invokeResultCode=-2147208619;V.queryDuration=0;return Object.assign(new fg(I,3),{failure:Error.create("Anonymous users do not have installed add-ins.",V)})}static j8b(I){return I.failure?I.failure.invokeResultCode:-1E3}static $dc(I,V,Ba){const cb={};cb.AddinCollectionType=wf[I];cb.ErrorCode=V.errorCode;cb.AddinCount=V.value?V.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",
Ba,JSON.stringify(cb))}static e8a(I,V){const Ba={};Ba.errorCode=I;Ba.value=V;return Ba}static Gwc(I){return I===OSF.StoreTypeEnum.MarketPlace?"omex":I===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static XZa(I,V){V.solutionId=V.solutionId||I.solutionId;V.version=V.version||I.version;V.storeType=V.storeType||I.storeType;V.storeId=V.storeId||I.storeId;V.assetId=V.assetId||I.assetId;V.assetStoreId=V.assetStoreId||I.assetStoreId;V.displayName=V.displayName||I.displayName;V.provider=V.provider||
I.provider;V.description=V.description||I.description;V.iconUrl=V.iconUrl||I.iconUrl;V.webApplicationId=V.webApplicationId||I.webApplicationId;V.highResolutionIconUrl=V.highResolutionIconUrl||I.highResolutionIconUrl;V.licenseUrl=V.licenseUrl||I.licenseUrl;V.privacyUrl=V.privacyUrl||I.privacyUrl;V.addinInfo=V.addinInfo||I.addinInfo;isNaN(V.targetType)&&(V.targetType=I.targetType);isNaN(V.height)&&(V.height=I.height);isNaN(V.width)&&(V.width=I.width);return V}static y0b(I){for(const V of I)isNaN(V.targetType)&&
(V.targetType=1),V.assetId=V.assetId||V.solutionId,V.storeId=V.storeId||"en-US",V.storeType=V.storeType||"omex",V.assetStoreId=V.assetStoreId||"omex",isNaN(V.width)&&(V.width=0),isNaN(V.height)&&(V.height=0)}static Goc(I){const V={};let Ba=0;Ba<I.length&&0<I[Ba].trim().length&&I[Ba].trim().toLowerCase().startsWith("wa")&&(V.solutionId=I[Ba].trim(),V.addinInfo=Object.assign(new ag,{priority:Number.NaN,AUP:Number.NaN,downloadNumber:Number.NaN}),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.priority=
parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.AUP=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.downloadNumber=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.displayName=I[Ba].trim()),++Ba<I.length&&0<I[Ba].trim().length&&(V.iconUrl=I[Ba].trim()),++Ba<I.length&&0<I[Ba].trim().length&&(V.description=I[Ba].trim()));return V.solutionId?V:null}static g8b(I,V){I=I.Ha("AddinImageStoreServiceUrl");if(!I)return V;I=I.toLowerCase();
return I.startsWith("http://")||I.startsWith("https://")?I:V}}Object(h.a)(yh,"AddinDetailsManager1",null,[838,839]);class Lg{constructor(I,V=null){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=I.solutionId;this.version=I.version;this.storeType=
I.storeType;this.storeId=I.storeId;this.assetId=I.assetId;this.assetStoreId=I.assetStoreId;this.displayName=I.displayName;this.provider=I.provider;this.description=I.description;this.targetType=I.targetType;this.height=I.height;this.width=I.width;this.iconUrl=I.iconUrl;this.webApplicationId=I.webApplicationId;this.highResolutionIconUrl=I.highResolutionIconUrl;this.licenseUrl=I.licenseUrl;this.privacyUrl=I.privacyUrl;this.addinInfo=V}p8e(){const I={};I.solutionId=this.solutionId;I.version=this.version;
I.storeType=this.storeType;I.storeId=this.storeId;I.assetId=this.assetId;I.assetStoreId=this.assetStoreId;I.targetType=this.targetType;I.displayName=this.displayName;I.width=this.width;I.height=this.height;return I}}Object(h.a)(Lg,"AddinDetail",null,[]);class yi{constructor(I,V,Ba,cb,Nb){this.jHc=null;this.Ma=I;this.gB=V;this.X5a=Ba;this.Y7h=cb;this.ETb=Nb}dV(I,V){this.Xi.queryAppDetails(this.Y7h,this.ETb,this.solutionIds,I,(Ba,cb)=>{const Nb=Array(cb.length);for(let Ec=0;Ec<cb.length;Ec++)Nb[Ec]=
new Lg(cb[Ec],this.Khk(cb[Ec].solutionId));V(Ba,Nb)})}get k0j(){return!!this.Xi.queryAppDetails}Khk(I){return this.X5a.ga(I)}get solutionIds(){if(!this.jHc){this.jHc=new e.a;for(let I of this.X5a.keys)this.jHc.add(Rh.d(I))}return this.jHc.toArray()}get Xi(){return this.gB.value}}Object(h.a)(yi,"AddinDetailsLoader",null,[]);class Vd{constructor(I,V=0){this.failure=null;this.Fsa=I;this.errorCode=V}}Object(h.a)(Vd,"AddinQueryResult",null,[]);class lf extends Vd{constructor(I,V=0){super(I,V);this.L5e=
this.solutionIds=null}}Object(h.a)(lf,"AddinCollection",Vd,[]);var Zj=d(1311);class Cj extends Zj.a{constructor(){super(Ee.a.Gk())}}Object(h.a)(Cj,"AddinDetailTable",Zj.a,[]);class he{constructor(I,V,Ba=null){this.Oa=new M.a;this.jw=new Hd.a(Ee.a.Gk());this.Jn=new Ki.a;this.X5a=this.j3=null;this.Qia=new ng.a;this.Qia.add(OSF.StoreTypeEnum.MarketPlace,0);this.Qia.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ma=I;this.gB=V;this.fB=Ba;this.BVb=he.g8b(I,"https://store-images.s-microsoft.com");this.tNd=
null;this.OQa(Object(D.a)(this,this.o_a,"onAddinDetailsRefreshed"))}get isAnonymousUser(){return!!this.Ma&&this.Ma.ka("IsAnonymousUser")}get x9d(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get c7b(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get yTa(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get Bka(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Xi(){return this.gB.value}get WQe(){this.tNd||(this.tNd=new yi(this.Ma,this.gB,this.ITk,0,this.Xi.getAppUILocale()));return this.tNd}H$a(I){if(!this.yla(I))return I=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:wf[I]}),Object.assign(new Xg(1),{failure:I});const V=this.Jn.ga(I);if(V.failure)return Object.assign(new Xg(V.errorCode),{failure:V.failure});r.ULS.shipAssertTag(509870082,220,!!V.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
I);const Ba=new Xg(0);for(let cb=0;cb<V.solutionIds.count;cb++){const Nb=V.solutionIds.ga(cb),Ec=V.L5e.ga(cb);if(this.jw.Gb(Nb)){const Oc=this.jw.ga(Nb);Oc.Gb(Ec)?Array.add(Ba.tW,Oc.ga(Ec)):r.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",Nb,I,Ec)}else r.ULS.sendTraceTag(0,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",Nb,I)}return Ba}v7b(I,V=null){if(I=this.ddj(I))if(V||(V=this.uiCulture),
I.Gb(V))return I.ga(V);return null}ddj(I){return this.jw.Gb(I)?this.jw.ga(I):null}nWe(I){if(I){this.OQa(I);for(let V of this.Jn.keys){if(!this.yla(V)||this.Jn.ga(V).failure)continue;r.ULS.shipAssertTag(509870081,220,!!this.Jn.ga(V).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",V);const Ba=[],cb=this.Jn.ga(V);for(let Nb of cb.solutionIds)Array.add(Ba,this.jw.ga(Nb));I(null,new Kh(V,cb.errorCode,Ba,cb.failure))}}}dV(I,V=!1){0!==I&&10!==I?r.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",Yd.a[I]):this.Zpc(I,Object(D.a)(this,this.Dnc,"onQueryAddinDetailsCompleted"),V)}OQa(I){this.Oa.addHandler(O.a.etb,I)}Dnc(I,V,Ba){Ba?(he.$dc(I,Ba,window.performance.now()-V),0===Ba.errorCode?(V=Ba.value?he.Tni(Ba.value):[],this.RM(new Vd(I),V)):-1===Ba.errorCode||10===Ba.errorCode?this.RM(new Vd(I),[]):(I=this.aYd(I,V,Ba),this.RM(I))):(I=he.bYd(I,V),this.RM(I))}aYd(I,V,Ba){const cb={};cb.collectionType=wf[I];cb.invokeResultCode=Ba.errorCode;
cb["queryResult.Value"]=Ba.value?String.format("Length: {0}",Ba.value.length):"null";cb.queryStart=V;cb.queryDuration=window.performance.now()-V;return Object.assign(new Vd(I,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",cb)})}tuc(){return this.yla(2)?this.Ma.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.Jn.ga(2).failure:!1:!0}Zpc(I,V,Ba=!1){r.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",I);I!==OSF.StoreTypeEnum.MarketPlace&&
I!==OSF.StoreTypeEnum.PrivateCatalog?r.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",I):(this.tuc()&&this.queryStoreDisabled(0,(cb,Nb)=>{Nb?(cb=he.f8a(2),this.RM(cb)):this.eXk(V)}),this.c7b&&this.isAnonymousUser?(I=he.UXd(I===OSF.StoreTypeEnum.MarketPlace?0:1),this.RM(I)):this.queryStoreDisabled(I,(cb,Nb)=>{if(cb===OSF.StoreTypeEnum.MarketPlace&&Nb)Nb=he.f8a(0),this.RM(Nb);else if(cb===OSF.StoreTypeEnum.PrivateCatalog&&Nb)Nb=he.f8a(1),this.RM(Nb);else{var Ec=window.performance.now();
this.Xi.getEntitlementDetails(Object.assign(new ce,{storeType:cb,refresh:Ba}),Oc=>{V(this.Qia.ga(cb),Ec,Oc)})}}))}RM(I,V=null){0!==I.errorCode?(r.ULS.shipAssertTag(509116673,220,!V,"The parameter addinDetails must be null for any failed queries"),r.ULS.shipAssertTag(509116672,220,!!I.failure,"The result.Failure must not be available for any failed queries"),r.ULS.sendTraceTag(510253056,220,this.vfe(I),"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; errorCode: {1}; failure: {2}; errorInfo: {3}",
wf[I.Fsa],xi.a[I.errorCode],I.failure?I.failure.toString():"null",JSON.stringify(I.failure))):(r.ULS.shipAssertTag(509116643,220,!!V,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is invalid.",wf[I.Fsa]),r.ULS.sendTraceTag(509116642,220,15,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",wf[I.Fsa],V?V.length:-1));I=new Kh(I.Fsa,I.errorCode,V,I.failure);this.Oa.raiseEvent(O.a.etb,I)}vfe(I){return 3===I.errorCode&&(this.c7b&&
-2147208619===he.j8b(I)||this.x9d&&-2===he.j8b(I))?15:2===I.errorCode?15:10}o_a(I,V){if(0!==V.errorCode)this.Jn.$(V.p_,Object.assign(new lf(V.p_,V.errorCode),{failure:V.failure}));else{I=Object.assign(new lf(V.p_),{solutionIds:new e.a,L5e:new e.a});var Ba=V.tW;for(const Nb of Ba){Ba=Nb.solutionId;const Ec=Nb.storeId;if(this.jw.Gb(Ba)){var cb=this.jw.ga(Ba);cb.Gb(Ec)?cb.$(Ec,this.Ulc(cb.ga(Ec),V.p_,Nb)):cb.add(Ec,Nb)}else cb=new Cj,cb.add(Ec,Nb),this.jw.add(Ba,cb);I.solutionIds.add(Ba);I.L5e.add(Ec)}this.Jn.$(V.p_,
I)}}yla(I){return this.Jn.Gb(I)?!!this.jw:!1}get uiCulture(){return this.fB&&this.fB.UICulture?this.fB.UICulture:z.AFrameworkApplication.uiCulture}get H0b(){return this.fB?!this.fB.AreThirdPartyAddInsAllowed||this.fB.AppsForOfficeThirdPartyIsDisabled:!this.Ma.ka("AreThirdPartyAddInsAllowed")||this.Ma.ka("AppsForOfficeThirdPartyIsDisabled")}get Rbc(){return this.fB?!this.fB.AppsForOfficeAllowExternalMarketplace:!this.Ma.ka("AppsForOfficeAllowExternalMarketplace")}get ITk(){if(!this.X5a){this.X5a=new Hd.a(Ee.a.Gk());
const I=JSON.parse(this.wKa);for(const V of I)this.X5a.add(V.solutionId,V.addinInfo)}return this.X5a}get wKa(){return this.fB?this.fB.PopularAddinDetailsJsonString:this.Ma.Ha("PopularAddinDetailsJsonString")}queryStoreDisabled(I,V){if(this.H0b)V(I,!0);else if(I===OSF.StoreTypeEnum.MarketPlace&&this.Rbc)V(I,!0);else{const Ba=he.Gwc(I);if(Ba){const cb=window.performance.now();this.Xi.queryStoreDisabled(Ba,Nb=>{r.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
I,Nb,cb,window.performance.now()-cb);V(I,Nb)})}else V(I,!1)}}Ulc(I,V,Ba){if(!I)return Ba;if(!Ba)return I;if(this.yTa)return 2===V?he.XZa(Ba,I):he.XZa(I,Ba);if(2===V)return I.addinInfo=Ba.addinInfo,I;Ba.addinInfo=I.addinInfo;return Ba}eXk(I){const V=window.performance.now();if(this.j3)I(2,V,he.e8a(0,this.j3));else if(this.WQe&&this.WQe.k0j)this.WQe.dV(!1,(cb,Nb)=>{this.Btb(Nb);this.j3=Nb;I(2,V,he.e8a(cb,this.j3))});else{var Ba=JSON.parse(this.wKa);this.R6b(Ba);this.j3=Ba;I(2,V,he.e8a(0,this.j3))}}R6b(I){this.yTa&&
he.y0b(I);this.Btb(I);this.S6b(I)}Btb(I){const V=this.m1b();for(var Ba=0;Ba<I.length&&0<V.count;Ba++){const cb=I[Ba];if(V.Gb(cb.solutionId)){let Nb=String.format("Found an override, solutionId: {0}",cb.solutionId);const Ec=V.ga(cb.solutionId);Ec&&(isNaN(Ec.addinInfo.priority)||(Nb=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Nb,cb.addinInfo.priority,Ec.addinInfo.priority),cb.addinInfo.priority=Ec.addinInfo.priority),isNaN(Ec.addinInfo.AUP)||(Nb=String.format("{0}; AddinInfo.AUP: update {1} to {2}",
Nb,cb.addinInfo.AUP,Ec.addinInfo.AUP),cb.addinInfo.AUP=Ec.addinInfo.AUP),isNaN(Ec.addinInfo.downloadNumber)||(Nb=String.format("{0}; AddinInfo.DownloadNumber: update {1} to {2}",Nb,cb.addinInfo.downloadNumber,Ec.addinInfo.downloadNumber),cb.addinInfo.downloadNumber=Ec.addinInfo.downloadNumber),Ec.displayName&&(Nb=String.format("{0}; DisplayName: update {1} to {2}",Nb,cb.displayName,Ec.displayName),cb.displayName=Ec.displayName),Ec.iconUrl&&(Nb=String.format("{0}; IconUrl: update {1} to {2}",Nb,cb.iconUrl,
Ec.iconUrl),cb.iconUrl=Ec.iconUrl),Ec.description&&(Nb=String.format("{0}; Description: update {1} to {2}",Nb,cb.description,Ec.description),cb.description=Ec.description));V.remove(cb.solutionId);this.Bka&&r.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Nb)}}for(let cb of V.keys)Ba=V.ga(cb),Ba.displayName&&Ba.iconUrl&&Ba.addinInfo&&(I.push(Ba),this.Bka&&r.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(Ba)))}m1b(){const I=new Hd.a(Ee.a.Gk());let V=this.Ma.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!V)return I;V=V.trim();if(12>=V.length)return 0<V.length&&r.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",V),I;this.Bka&&r.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",V);try{const Ba=[],cb=V.split("|");for(let Nb=cb.length-1;0<=Nb;Nb--){const Ec=
cb[Nb],Oc=Ec.split("\\");if(2>Oc.length){Ba.push(Ec);continue}const je=he.Goc(Oc);je?I.Gb(je.solutionId)||I.add(je.solutionId,je):Ba.push(Ec)}this.Bka&&0<Ba.length&&r.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ba.join("|"));this.Bka&&0<I.count&&r.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",I.count,JSON.stringify(Vi.toArray(I.values)));return I}catch(Ba){r.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
V,Ba.toString())}return I}S6b(I){for(let V=0;V<I.length;V++)Rh.c(I[V].iconUrl.toLowerCase(),"http",0)||(I[V].iconUrl=String.format("{0}/image/apps.{1}",this.BVb,I[V].iconUrl))}static bYd(I,V){const Ba={};Ba.collectionType=wf[I];Ba.queryResult="null";Ba.queryStart=V;Ba.queryDuration=window.performance.now()-V;return Object.assign(new Vd(I,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ba)})}static f8a(I){const V={};V.collectionType=wf[I];return Object.assign(new Vd(I,2),{failure:Error.create("The store is disabled.",
V)})}static UXd(I){const V={};V.collectionType=wf[I];V.invokeResultCode=-2147208619;V.queryDuration=0;return Object.assign(new Vd(I,3),{failure:Error.create("Anonymous users do not have installed add-ins.",V)})}static j8b(I){return I.failure?I.failure.invokeResultCode:-1E3}static $dc(I,V,Ba){const cb={};cb.AddinCollectionType=wf[I];cb.ErrorCode=V.errorCode;cb.AddinCount=V.value?V.value.length:0;r.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",
Ba,JSON.stringify(cb))}static e8a(I,V){const Ba={};Ba.errorCode=I;Ba.value=V;return Ba}static Gwc(I){return I===OSF.StoreTypeEnum.MarketPlace?"omex":I===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static XZa(I,V){V.solutionId=V.solutionId||I.solutionId;V.version=V.version||I.version;V.storeType=V.storeType||I.storeType;V.storeId=V.storeId||I.storeId;V.assetId=V.assetId||I.assetId;V.assetStoreId=V.assetStoreId||I.assetStoreId;V.displayName=V.displayName||I.displayName;V.provider=V.provider||
I.provider;V.description=V.description||I.description;V.iconUrl=V.iconUrl||I.iconUrl;V.webApplicationId=V.webApplicationId||I.webApplicationId;V.highResolutionIconUrl=V.highResolutionIconUrl||I.highResolutionIconUrl;V.licenseUrl=V.licenseUrl||I.licenseUrl;V.privacyUrl=V.privacyUrl||I.privacyUrl;V.addinInfo=V.addinInfo||I.addinInfo;isNaN(V.targetType)&&(V.targetType=I.targetType);isNaN(V.height)&&(V.height=I.height);isNaN(V.width)&&(V.width=I.width);return V}static Tni(I){const V=Array(I.length);for(let Ba=
0;Ba<V.length;Ba++)V[Ba]=new Lg(I[Ba],I[Ba].addinInfo);return V}static y0b(I){for(const V of I)isNaN(V.targetType)&&(V.targetType=1),V.assetId=V.assetId||V.solutionId,V.storeId=V.storeId||"en-US",V.storeType=V.storeType||"omex",V.assetStoreId=V.assetStoreId||"omex",isNaN(V.width)&&(V.width=0),isNaN(V.height)&&(V.height=0)}static Goc(I){const V={};let Ba=0;Ba<I.length&&0<I[Ba].trim().length&&I[Ba].trim().toLowerCase().startsWith("wa")&&(V.solutionId=I[Ba].trim(),V.addinInfo=Object.assign(new ag,{priority:Number.NaN,
AUP:Number.NaN,downloadNumber:Number.NaN}),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.priority=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.AUP=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.addinInfo.downloadNumber=parseInt(I[Ba].trim())),++Ba<I.length&&0<I[Ba].trim().length&&(V.displayName=I[Ba].trim()),++Ba<I.length&&0<I[Ba].trim().length&&(V.iconUrl=I[Ba].trim()),++Ba<I.length&&0<I[Ba].trim().length&&(V.description=I[Ba].trim()));return V.solutionId?
V:null}static g8b(I,V){I=I.Ha("AddinImageStoreServiceUrl");if(!I)return V;I=I.toLowerCase();return I.startsWith("http://")||I.startsWith("https://")?I:V}}Object(h.a)(he,"AddinDetailsManager2",null,[838,839]);class ij{static createInstance(I,V,Ba=null){if(ij.i3j(I)){if(ij.Zli(I))return r.ULS.sendTraceTag(508925833,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),new he(I,V,Ba);r.ULS.sendTraceTag(508925832,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");
return new yh(I,V,Ba)}r.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");return new $h(I,V,Ba)}static i3j(I){return(I||z.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static Zli(I){return(I||z.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}}Object(h.a)(ij,"AddinDetailsManagerFactory",
null,[]);var Rf=d(199),zh=d(317),Sh=d(584),jj=d(1252);class Dj extends Md.a{constructor(){super();this.Wba="calc(100% - 46px)";this.uqa="15px";this.Xba="0";this.YTb="WACDialogPanel";this.QP=695;this.ZTb=462;this.xN="80%";this.NSb=350;this.UNa="100%";this.Ad=5;this.ig="AppsForOfficeInsertionDialog";this.sFd=!!z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}Gu(){super.Gu();this.xm.style.width=this.UNa;this.xm.style.height=this.Wba;this.xm.style.marginTop=
this.uqa;this.xm.style.padding=this.Xba}Maa(){this.xm.style.width=this.UNa;this.xm.style.height=this.Wba;this.xm.style.marginTop=this.uqa;this.xm.style.padding=this.Xba;this.QP>pg.a.YR?(this.Jb.style.width=String.format("{0}px",pg.a.YR),this.Jb.style.overflowX="scroll",z.AFrameworkApplication.isRtl?this.Jb.style.right="0":this.Jb.style.left="0"):(this.Jb.style.width=String.format("{0}px",this.QP),this.Jb.style.overflowX="hidden");this.Jb.offsetHeight>pg.a.oP||this.ZTb+50>pg.a.oP?(this.Jb.style.height=
String.format("{0}px",pg.a.oP),this.Jb.style.overflowY="scroll",this.Jb.style.top="0",z.AFrameworkApplication.isRtl?this.Jb.style.right="0":this.Jb.style.left="0",this.sFd||(this.Jb.style.marginTop="-48px"),this.xm.style.minHeight=String.format("{0}px",this.NSb)):(this.Jb.style.overflowY="hidden",this.Jb.style.top="10%",this.Jb.style.height=this.xN);this.XCa()}XCa(){if(this.Jb){var I=this.Jb.style.zIndex;this.Jb.style.zIndex="-9999";if(this.QP>pg.a.YR)z.AFrameworkApplication.isRtl?this.Jb.style.marginRight=
"0":this.Jb.style.marginLeft="0";else{const V=String.format("{0}px",Math.floor(-this.Jb.offsetWidth/2));z.AFrameworkApplication.isRtl?this.Jb.style.marginRight=V:this.Jb.style.marginLeft=V;z.AFrameworkApplication.isRtl?this.Jb.style.right="50%":this.Jb.style.left="50%"}this.Jb.style.zIndex=String(I)}else r.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}ZA(){super.ZA();const I=document.getElementById(this.Vh(this.YTb));I.style.width=String.format("{0}px",this.QP);I.style.height=
this.xN}get ika(){return this.xm}}Object(h.a)(Dj,"AppsForOfficeInsertionDialog",Md.a,[727]);class Ah extends Md.a{constructor(I=!0,V=!0,Ba=null){super();this.Wba="calc(100% - 46px)";this.uqa="15px";this.Xba="0";this.YTb="WACDialogPanel";this.QP=695;this.ZTb=462;this.xN="80%";this.NSb=350;this.UNa="100%";this.Jgf="auto";this.Kgf="5px";this.Lgf="auto";this.Igf="40px";this.UAc="100px";this.$Tb="200px";this.Ad=5;this.ig="SDXDialog";this.eDc=I;this.r$b=V;this.PAc=Ba}Gu(){super.Gu();this.xm.style.width=
this.UNa;this.xm.style.height=this.Wba;this.xm.style.marginTop=this.uqa;this.xm.style.padding=this.Xba}Maa(){this.xm.style.width=this.UNa;this.xm.style.height=this.eDc?this.Wba:"100%";this.xm.style.marginTop=this.eDc?this.uqa:"0px";this.xm.style.padding=this.Xba;if(this.eDc){this.UAc&&this.$Tb&&(this.QP=parseInt(this.$Tb.substring(0,this.$Tb.length-2)),this.xN=this.UAc);this.QP>pg.a.YR?(this.Jb.style.width=String.format("{0}px",pg.a.YR),this.Jb.style.overflowX="scroll",z.AFrameworkApplication.isRtl?
this.Jb.style.right="0":this.Jb.style.left="0"):(this.Jb.style.width=String.format("{0}px",this.QP),this.Jb.style.overflowX="hidden");if(this.Jb.offsetHeight>pg.a.oP||this.ZTb+50>pg.a.oP)this.Jb.style.height=String.format("{0}px",pg.a.oP),this.Jb.style.overflowY="scroll",this.Jb.style.top="0",z.AFrameworkApplication.isRtl?this.Jb.style.right="0":this.Jb.style.left="0",this.xm.style.minHeight=String.format("{0}px",this.NSb);else{this.Jb.style.overflowY="hidden";const I="%"===this.xN.substring(this.xN.length-
1,this.xN.length),V=I?parseInt(this.xN.substring(0,this.xN.length-1)):parseInt(this.xN.substring(0,this.xN.length-2));this.Jb.style.top=I?(100-V)/2+"%":100*(pg.a.oP-V)/pg.a.oP/2+"%";this.Jb.style.height=this.xN}this.XCa()}else this.Jb.style.left=this.Jgf,this.Jb.style.right=this.Kgf,this.Jb.style.top=this.Lgf,this.Jb.style.bottom=this.Igf,this.Jb.style.width=this.$Tb,this.Jb.style.height=this.UAc,this.Jb.style.overflowX="hidden",this.Jb.style.overflowY="hidden"}XCa(){if(this.Jb){var I=this.Jb.style.zIndex;
this.Jb.style.zIndex="-9999";if(this.QP>pg.a.YR)z.AFrameworkApplication.isRtl?this.Jb.style.marginRight="0":this.Jb.style.marginLeft="0";else{const V=String.format("{0}px",Math.floor(-this.Jb.offsetWidth/2));z.AFrameworkApplication.isRtl?this.Jb.style.marginRight=V:this.Jb.style.marginLeft=V;z.AFrameworkApplication.isRtl?this.Jb.style.right="50%":this.Jb.style.left="50%"}this.Jb.style.zIndex=String(I)}else r.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}ZA(){super.ZA();
const I=document.getElementById(this.Vh(this.YTb));I.style.width=String.format("{0}px",this.QP);I.style.height=this.xN}get wBb(){return this.eDc}get ika(){return this.xm}Uol(I,V,Ba,cb){this.Jgf=I;this.Kgf=V;this.Lgf=Ba;this.Igf=cb}Vol(I,V){this.UAc=I;this.$Tb=V}}Object(h.a)(Ah,"SDXDialog",Md.a,[]);class hf extends Md.a{constructor(I,V,Ba,cb){super();this.Wba="calc(100% - 46px)";this.uqa="15px";this.Xba="0";this.YTb="WACDialogPanel";this.QP=695;this.ZTb=462;this.xN="80%";this.NSb=350;this.UNa="100%";
this.EOa=null;this.Ad=5;this.ig="AddinInstallDialog";this.dXh=I;this.gca=V;this.Abi=Ba;this.o6h=cb}Gu(){super.Gu();this.xm.style.width=this.UNa;this.xm.style.height=this.Wba;this.xm.style.marginTop=this.uqa;this.xm.style.padding=this.Xba;document.getElementById(this.Vh("WACDialogButtonPanel")).style.display="none";this.QRa.setAttribute("tabindex","0");$addHandler(this.QRa,"keyup",Object(D.a)(this,this.QIk,"onKeyUp"));const I=document.createElement("iframe");I.setAttribute("id","InstallAddinDialog");
I.setAttribute("src","about:blank");I.setAttribute("width","100%");I.setAttribute("height","100%");I.setAttribute("marginHeight","0");I.setAttribute("marginWidth","0");I.setAttribute("frameBorder","0");I.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const V=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.dXh,this.gca,this.Abi);I.setAttribute("src",V);this.EOa=I;$addHandler(I,"load",
Object(D.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(D.a)(this,this.onMessage,"onMessage"));this.xm.appendChild(I);this.xm.appendChild(this.mOi())}mOi(){const I=document.createElement("div");I.setAttribute("tabindex","0");$addHandler(I,"focus",Object(D.a)(this,this.fJk,"onLoopPivotFocus"));return I}QIk(I){13!==I.keyCode&&32!==I.keyCode||this.hide()}fJk(){this.QRa.focus()}onLoad(){this.EOa.focus()}onMessage(I){I=I.rawEvent;if(I.source===this.EOa.contentWindow&&(I=(I=I.data)?
I.split("|"):null)&&0<I.length&&("REFRESH_REQUIRED"===I[0]||"PRELOAD_MANIFEST"===I[0])){t.a.instance.setItem("refreshRequired","true");const V={};V.solutionId=I[1];V.version=hf.CCk(I[3]);V.storeType=I[4];V.storeId=I[5];V.assetId=I[6];V.targetType=hf.pRk(I[2]);V.assetStoreId=I[7];V.width=parseInt(I[8]);V.height=parseInt(I[9]);this.o6h(V)}}Maa(){this.xm.style.width=this.UNa;this.xm.style.height=this.Wba;this.xm.style.marginTop=this.uqa;this.xm.style.padding=this.Xba;this.QP>pg.a.YR?(this.Jb.style.width=
String.format("{0}px",pg.a.YR),this.Jb.style.overflowX="scroll",z.AFrameworkApplication.isRtl?this.Jb.style.right="0":this.Jb.style.left="0"):(this.Jb.style.width=String.format("{0}px",this.QP),this.Jb.style.overflowX="hidden");this.Jb.offsetHeight>pg.a.oP||this.ZTb+50>pg.a.oP?(this.Jb.style.height=String.format("{0}px",pg.a.oP),this.Jb.style.overflowY="scroll",this.Jb.style.top="0",z.AFrameworkApplication.isRtl?this.Jb.style.right="0":this.Jb.style.left="0",this.xm.style.minHeight=String.format("{0}px",
this.NSb)):(this.Jb.style.overflowY="hidden",this.Jb.style.top="10%",this.Jb.style.height=this.xN);this.XCa()}XCa(){if(this.Jb){var I=this.Jb.style.zIndex;this.Jb.style.zIndex="-9999";if(this.QP>pg.a.YR)z.AFrameworkApplication.isRtl?this.Jb.style.marginRight="0":this.Jb.style.marginLeft="0";else{const V=String.format("{0}px",Math.floor(-this.Jb.offsetWidth/2));z.AFrameworkApplication.isRtl?this.Jb.style.marginRight=V:this.Jb.style.marginLeft=V;z.AFrameworkApplication.isRtl?this.Jb.style.right="50%":
this.Jb.style.left="50%"}this.Jb.style.zIndex=String(I)}else r.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}ZA(){super.ZA();const I=document.getElementById(this.Vh(this.YTb));I.style.width=String.format("{0}px",this.QP);I.style.height=this.xN}get ika(){return this.xm}dispose(){super.dispose();$removeHandler(window,"message",Object(D.a)(this,this.onMessage,"onMessage"))}static pRk(I){switch(I){case "1":return 0;case "2":return 1;default:return 0}}static CCk(I){const V=
I.split(".");for(let Ba=0;Ba<4-V.length;Ba++)I+=".0";return I}}Object(h.a)(hf,"AddinInstallDialog",Md.a,[]);var rg=d(171);class Ej{constructor(I,V,Ba){this.dAb=I;this.onSuccess=V;this.onError=Ba;$addHandler(window,"message",Object(D.a)(this,this.U9b,"handleResponse"))}U9b(I){try{if(I&&I.rawEvent&&I.rawEvent.origin&&this.dAb&&this.dAb.id){var V=this.Rgh(I.rawEvent.origin);const Ba=this.Rgh(document.domain);if(Ee.a.Gk().equals(Ba,V))if(I.rawEvent.source&&I.rawEvent.source.frameElement&&I.rawEvent.source.frameElement.id&&
Ee.a.Gk().equals(I.rawEvent.source.frameElement.id,this.dAb.id)){V=null;try{V=JSON.parse(I.rawEvent.data)}catch(cb){r.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",cb.message)}V?(V.statusCode!==rg.a.mx||void 0!==V.error&&V.error?(r.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",V.statusCode,V.error),this.onError()):
(r.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(V.authorizationCode?V.authorizationCode:V.signInUrl)),$removeHandler(window,"message",Object(D.a)(this,this.U9b,"handleResponse")),this.dAb?document.body.contains(this.dAb)?document.body.removeChild(this.dAb):r.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):r.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):r.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else r.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else r.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else r.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ba){r.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ba.message)}}Rgh(I){let V="";
try{I&&(V=-1<I.indexOf("//")?I.split("/")[2]:I.split("/")[0])&&(V=V.split(":")[0],V=V.split("?")[0])}catch(Ba){r.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Ba.message)}return V}static my(I,V,Ba){new Ej(I,V,Ba)}}Object(h.a)(Ej,"ResponseHandler",null,[]);var Li=d(216);class Gh{constructor(I){this.Pra=I}tryAuthenticate(I,V){this.xmd(Gh.K1h,()=>{I()},V)}tryAuthorize(I,V){this.xmd(Gh.mXh,I,V)}getSignInUrl(I,V){this.xmd(Gh.jvf,I,V)}signOut(I,V){this.xmd(Gh.z$h,I,V)}xmd(I,
V,Ba){var cb=new Li.QueryStringBuilder("AuthenticationProxyHandler.aspx");cb.xg("responseType",I);z.AFrameworkApplication.GQa(cb);cb=String.format("{0}{1}&{2}",this.Pra,cb.toString(),z.AFrameworkApplication.Pg);const Nb=document.createElement("iframe");Nb.setAttribute("id","privateCatalogIframe");Nb.setAttribute("name","privateCatalogIframe");Nb.setAttribute("style","display: none");Ee.a.Gk().equals(I,Gh.jvf)||Nb.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
Ej.my(Nb,V,Ba);Nb.setAttribute("src",cb);document.body.appendChild(Nb)}}Gh.mXh="authcode";Gh.K1h="identitytoken";Gh.jvf="signinurl";Gh.z$h="signout";Object(h.a)(Gh,"AuthenticationProxy",null,[]);class hg{}hg.getUserId="getUserId";hg.getLastStoreUpdate="laststoreupdate";hg.getEntitlement="getEntitlements";hg.getEToken="getEToken";hg.getManifest="getManifest";hg.getAppState="getAppState";hg.getKilledApps="getRemovedAddins";hg.getAppDetails="getAppDetails";hg.removeApps="removeAddin";hg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";hg.getPrivateCatalogAddIns="getAddIns";hg.getPrivateCatalogManifests="getAppManifests";hg.isStoreDisabled="isStoreDisabled";Object(h.a)(hg,"S2SWebRequestActions",null,[]);var Lh=d(534);class La{getUserId(I,V){const Ba=new e.a;Ba.add(new fa.a("corr",I));this.Xx(hg.getUserId,Ba,1,V)}getLastStoreUpdate(I,V,Ba){const cb=new e.a;cb.add(new fa.a("lc",I));cb.add(new fa.a("corr",V));this.Xx(hg.getLastStoreUpdate,cb,1,Ba)}getEntitlement(I,V,Ba,cb){I=new e.a;I.add(new fa.a("av",
V));I.add(new fa.a("corr",Ba));this.Xx(hg.getEntitlement,I,1,cb)}getEToken(I,V,Ba,cb,Nb,Ec){const Oc=new e.a;Oc.add(new fa.a("cmu",I));Oc.add(new fa.a("cmf",V));Oc.add(new fa.a("assetid",Ba));Oc.add(new fa.a("expver",cb));Oc.add(new fa.a("corr",Nb));this.Xx(hg.getEToken,Oc,1,Ec)}getManifest(I,V,Ba,cb){const Nb=new e.a;Nb.add(new fa.a("cmu",I));Nb.add(new fa.a("assetid",V));Nb.add(new fa.a("corr",Ba));this.Xx(hg.getManifest,Nb,1,cb)}getAppState(I,V,Ba){const cb=new e.a;cb.add(new fa.a("ma",I));cb.add(new fa.a("corr",
V));this.Xx(hg.getAppState,cb,1,Ba)}getKilledApps(I,V){const Ba=new e.a;Ba.add(new fa.a("corr",I));this.Xx(hg.getKilledApps,Ba,1,V)}getAppDetails(I,V,Ba,cb){const Nb=new e.a;Nb.add(new fa.a("cmo",I));Nb.add(new fa.a("corr",Ba));this.sendWithBody(hg.getAppDetails,Nb,V,2,cb,!1)}removeApps(I,V,Ba){const cb=new e.a;cb.add(new fa.a("corr",V));this.sendWithBody(hg.removeApps,cb,I,2,Ba,!1)}getLastPrivateCatalogUpdate(I,V,Ba,cb,Nb,Ec){const Oc=new e.a;Oc.add(new fa.a("catalog","privatecatalog"));Oc.add(new fa.a("clientCode",
I));Oc.add(new fa.a("clientVersion",V));Oc.add(new fa.a("corr",Nb));I=String.format("authorizationCode={0}&refreshToken={1}",Ba?H.a.Ne(Ba):"",cb?H.a.Ne(cb):"");this.sendWithBody(hg.getLastPrivateCatalogUpdate,Oc,I,2,Ec,!0)}getPrivateCatalogAddIns(I,V,Ba,cb,Nb,Ec){const Oc=new e.a;Oc.add(new fa.a("catalog","privatecatalog"));Oc.add(new fa.a("clientCode",I));Oc.add(new fa.a("clientVersion",V));Oc.add(new fa.a("corr",Nb));I=String.format("authorizationCode={0}&refreshToken={1}",Ba?H.a.Ne(Ba):"",cb?H.a.Ne(cb):
"");this.sendWithBody(hg.getPrivateCatalogAddIns,Oc,I,2,Ec,!0)}getPrivateCatalogManifests(I,V,Ba,cb,Nb){const Ec=new e.a;Ec.add(new fa.a("catalog","privatecatalog"));Ec.add(new fa.a("corr",cb));I=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",H.a.Ne(I),V?H.a.Ne(V):"",Ba?H.a.Ne(Ba):"");this.sendWithBody(hg.getPrivateCatalogManifests,Ec,I,2,Nb,!0)}isStoreDisabled(I,V){const Ba=new e.a;Ba.add(new fa.a("corr",I));this.Xx(hg.isStoreDisabled,Ba,2,V)}Xx(I,V,Ba,cb){this.sendWithBody(I,
V,null,Ba,cb,!1)}sendWithBody(I,V,Ba,cb,Nb,Ec){const Oc=new Li.QueryStringBuilder("AddinServiceHandler.ashx");Oc.xg("action",I);Oc.xg("app",Lh.a[z.AFrameworkApplication.Aa.mb.Ti]);for(let je of V)Oc.xg(je.key,je.value);V=String.format("{0}{1}&{2}",z.AFrameworkApplication.Aa.mb.aoa,Oc.toString(),z.AFrameworkApplication.Pg);z.AFrameworkApplication.Je.qj(V,cb,Ba,null,!1,2,je=>{let De=null,Pd=null;je&&je.data&&(je.data.Dj["X-BlockedForMinor"]&&"1"===je.data.Dj["X-BlockedForMinor"].toString()&&(je.data.Oe=
451),De=je.data.Wd,Pd=je.data.Dj);Nb(je.data.Oe,De,Pd)},je=>{var De=null;let Pd=null;Ec&&je&&je.data&&je.data.Wd&&(De=je.data.Wd,Pd=je.data.Dj);Nb(je.data.Oe,De,Pd);if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){De={message:"AddinServiceHandler request failed"};De.code=je.data.Oe;De.action=I;if(je.data.request||je.data.request.get_headers())De["X-UserSessionId"]=je.data.request.get_headers()["X-UserSessionId"];408===je.data.Oe||
503===je.data.Oe?r.ULS.sendTraceTag(538784582,220,10,JSON.stringify(De)):r.ULS.sendTraceTag(18392345,220,50,JSON.stringify(De))}else r.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",je.data.Oe)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+I,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(La,"S2SWebRequestManager",null,[]);var lb=d(32),Ob=d(84);class mc{constructor(I,V){this.state=I;this.Pya=V}}Object(h.a)(mc,"BackgroundAppData",null,[715]);class Rc{constructor(I,
V,Ba,cb,Nb,Ec,Oc,je){this.Rca=null;this.Cik=I;this.zvk=cb;this.yA=V;this.Bu=Ba;this.cHb=Nb;this.settings=Ec;this.Gik=Oc;this.tw=je}get qp(){return this.Cik}get taskpane(){return this.zvk}get instanceId(){return this.yA}get shape(){return this.Bu}get f_e(){return this.cHb}get jy(){return this.Gik}Ddi(I){this.tw=new mc(0,I)}}Object(h.a)(Rc,"AppForOffice",null,[668]);var Ud=d(31);class ue{}ue.c_Error="Error";Object(h.a)(ue,"ApiResponseKeyStrings",null,[]);class Xe{constructor(I,V,Ba,cb,Nb){this.EventDispId=
I;this.ControlId=V;this.TargetId=Ba;this.Handler=cb;this.Callback=Nb}}Object(h.a)(Xe,"EventRegistrationParams",null,[]);var pe=d(28);class gg{constructor(I,V){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.wb=z.AFrameworkApplication.De;this.EEe=I;this.TEg=V}InvokeDdaMethod(I,V,Ba){const cb=I.DdaMethod.DispatchId,Nb=this.EEe.Ldj(cb);Nb?(Nb.parameters=I,Nb.callback=V,Nb.fmi=Ba,Nb.controlId=I.DdaMethod.ControlId,this.wb.Hb(new yd.a(2,1,0,Object(D.a)(Nb,
Nb.go,"go"),90,"51"))):(I="API Call for method ID "+cb+" does not exist:"+Ud.Debug.mu(),pe.a.J(8958091,802,10,I),this.ZYd(V))}RegisterDdaEventAsync(I,V,Ba,cb,Nb){const Ec=new yd.a(2,1,0,Object(D.a)(this,this.E7k,"registerEventTaskProcess"),90,"52");Ec.customData=new Xe(I,V,Ba,cb,Nb);this.wb.Hb(Ec)}UnregisterDdaEventAsync(I,V,Ba,cb,Nb){const Ec=new yd.a(2,1,0,Object(D.a)(this,this.TQl,"unregisterEventTaskProcess"),90,"53");Ec.customData=new Xe(I,V,Ba,cb,Nb);this.wb.Hb(Ec)}E7k(I){I=I.customData;var V=
this.TEg.I$d(I.EventDispId);V?V.addHandler(I.ControlId,I.Handler,I.Callback,I.TargetId):(V="Event for dispatch ID "+I.EventDispId+" does not exist:"+Ud.Debug.mu(),pe.a.J(8958093,802,10,V),this.ZYd(I.Callback))}TQl(I){I=I.customData;var V=this.TEg.I$d(I.EventDispId);V?V.removeHandler(I.ControlId,I.Handler,I.Callback,I.TargetId):(V="Event for dispatch ID "+I.EventDispId+" does not exist:"+Ud.Debug.mu(),pe.a.J(8958095,802,10,V),this.ZYd(I.Callback))}ZYd(I){if(I){var V={};V[ue.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
I(V)}}}Object(h.a)(gg,"AppForOfficeApiAdapter",null,[725]);class cg{constructor(I,V,Ba,cb){this.menuItemId=I;this.sV=V;this.BGl=Ba;this.f7i=cb}}Object(h.a)(cg,"NewDocumentParameters",null,[]);var Sg=d(591),Hh=d(130),li=d(142),Oh=d(44),Wi=d(53),Xi=d(75),Fi=d(34),Mi=d(41),mh=d(51),ai=d(40),Aa=d(35),Ua=d(59);class gb{constructor(I,V,Ba){this.Ugb=[];this.Y8c=this.mEb=!1;this.ta=I;this.gG=V;this.Gz=Ba}build(){const I=this.ta.vy();if(!I)return this.Ugb;for(const V of I)if(this.OYk(V),this.Y8c)break;return this.Ugb}OYk(I){const V=
Fi.ParagraphReader.textLength(I);this.PYk(I,V);this.Y8c||this.vYk(I)}PYk(I,V){this.mEb||(this.gG>=V?this.gG-=V:(this.mEb=!0,this.Gz||this.Ugb.push(mh.a.Oj(Object(ha.a)(Ob.a,I),this.gG))));this.mEb&&(this.Gz>V-this.gG?0<V&&(this.Ugb.push(mh.a.createTextRange(Object(ha.a)(Ob.a,I),this.gG,V)),this.Gz-=V-this.gG,this.gG=0):0<this.Gz&&(this.Ugb.push(mh.a.createTextRange(Object(ha.a)(Ob.a,I),this.gG,this.gG+this.Gz)),this.Gz=0));0>=this.Gz&&(this.Y8c=!0)}vYk(I){this.mEb||(0<this.gG?--this.gG:(this.mEb=
!0,this.Gz||this.Ugb.push(mh.a.eSa(Object(ha.a)(Ob.a,I)))));this.mEb&&0<this.Gz&&(this.Ugb.push(mh.a.nda(Object(ha.a)(Ob.a,I))),--this.Gz);0>=this.Gz&&(this.Y8c=!0)}}Object(h.a)(gb,"TextSelectionBuilder",null,[]);var Eb=d(991),Ub=d(30);class vc{constructor(I,V,Ba,cb,Nb,Ec,Oc,je,De,Pd,Ke,xg,Gg,ph,qg,th,ci,Hf,Xh,bm,Qn,Sm,lg,Cm){this.Da=I;this.Ib=V;this.MO=Ba;this.egb=cb;this.pa=Nb;this.GJ=Ec;this.rbd=Oc;this.Fb=je;this.ia=De;this.ua=Ke;this.wb=xg;this.Ub=Pd;this.Sb=Gg;this.lc=ph;this.zik=qg;this.jb=
th;this.Eb=ci;this.wk=Hf;this.Ga=Xh;this.Tb=bm;this.uIa=Qn;this.Hh=Sm;this.Rq=lg;this.Tpk=Cm}Auj(){let I;I="";if(this.jb.vH()){if(1<this.jb.Bsd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Zsc:I};const V=this.jb.Ll();if(this.X7j(V)){const Ba=[];this.Ga.vG(V,cb=>{cb&&Ba.push(cb.characterData)});I=Ba.join(vc.VIf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Zsc:I}}}else if(this.jb.uz())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,
Zsc:I}}wuj(){let I;I="";return{returnValue:({O4e:I}=this.getSelectedSlides()).returnValue,tll:I}}myb(){return this.MO.Zib.documentUrl}SBj(I){if(!I)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var V=this.Sb.rj();if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const Ba=this.ua.Ba.qe;switch(I){case "previous":I=Ba-1;break;case "next":I=Ba+1;break;case "first":I=0;break;case "last":I=V-1;break;default:if(I=parseInt(I),isNaN(I))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>
I||I>V-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;V=this.Sb.zx(I);if(!V)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Ub.Ba=V;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}TBj(I){if(!I)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;I=parseInt(I);if(isNaN(I))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;I=this.wee(I);if(!I)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Ub.Ba=I;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Jsl(I){var V=
this.jb.Ud();if(!V.length){if(V=Object(ha.a)(116,this.jb.Fk()||this.ua.Ba)){var Ba=V.Cb;I=this.wk.u2d(Ba.cid,Ba.sid,V.Cs()+1,I,"");Ba=this.Fb.yd(7);Ba.jc(V);V.oB(I);this.jb.selectShape(I,!0);Ba.dispose();this.Rq.oA=I;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===V.length){if(this.jb.vH())return this.Ltl(I);if(this.jb.uz())return this.Mtl(I)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}BAh(I,V,Ba,cb,Nb,Ec,Oc,je){if(this.WSc(Nb,0,vc.aob)||this.WSc(Ec,0,vc.aob)||
this.WSc(Ba,-vc.aob,vc.aob)||this.WSc(cb,-vc.aob,vc.aob)||0!==Oc&&1!==Oc)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(I.length>this.Da.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var De=this.jb.Ud().length;if(V||Nb||Ec||!De){De=this.ua.Ba;if(!De)throw Error.argumentNull("ActiveSlide is null");const Ke=De.Cb,xg=De.Cs();let Gg=!0,ph=new Ua.a(0,0);V?ph=new Ua.a(Ba,cb):!this.Da.$Uk||Nb&&Ec?ph=this.Sb.Uka(Nb,Ec):Gg=!1;const qg=
this.wk.Xja(!1,Ke.cid,Ke.sid,0,Sg.a.VH(ph.x),Sg.a.VH(ph.y),Sg.a.VH(Nb),Sg.a.VH(Ec),xg+1,!0);Gg||(qg.yo(Mi.a.My),qg.yo(Mi.a.Ny));qg.tj=!0;qg.Avd=!0;qg.sz=Oc;qg.nea=0===Oc?this.IQf(I):I;const th=(I=this.NXj(je)&&this.Da.ka("ChatPPTImgShowDesigner"))&&this.Da.ka("ChatPPTHideImg");qg.QAb=!0;Oc=this.Fb.yd(7,void 0,()=>{th&&(this.jb.iu(),this.jb.nh())},()=>{th&&(this.jb.iu(),this.jb.nh())});try{if(I&&(Oc.gd=Ub.a.mJc,th)){var Pd=this.Da.uc("ChatPPTHideImgMs",3E3);qg.lQb=Date.now()+Pd;this.wb.Hb(new yd.a(2,
1,Pd+this.Da.uc("ChatPPTUnhideUpdateMs",2E3),()=>{if(0!=qg.lQb){qg.lQb=0;const ci=Object(ha.a)(117,qg.qc(this.Eb.Na));null===ci||void 0===ci?void 0:ci.gAa()}},void 0,"ShowAddInImg"))}Oc.jc(De);De.oB(qg);this.jb.selectShape(qg,!0)}catch(ci){pe.a.J(509112541,802,10,"setSelectedImageData got exception "+ci)}finally{Oc&&Oc.dispose()}this.Rq.oA=qg;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===De&&(Pd=this.jb.Ll())&&Pd.BMc){De=this.ua.Ba;if(!De)throw Error.argumentNull("ActiveSlide is null");
V=this.Gab(De,Pd);V.tj=!0;V.sz=Oc;V.nea=0===Oc?this.IQf(I):I;V.QAb=!0;I=this.Fb.yd(7);try{I.jc(De),De.cS([Pd]),De.oB(V),this.jb.selectShape(V,!0)}finally{I&&I.dispose()}this.Rq.oA=V;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}pe.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}NXj(I){return this.Da.Ha("ChatPPTOrigin")===I}zla(){return this.Da.zla}EWj(){return this.Ib.ka("342")}ljj(I){if(!I)return null;
I=this.zik.N3(I);I=0===I.jy?I.node:this.ua.Ba;if(!I)return null;I=Object(ha.a)(115,this.lc.jg(I));return Ye(I.Fd)}XZe(I,V){if(I&&V)if(ge.a("UseUndoTransactionForSaveSettingToApp")){var Ba=this.Fb.yd(15,void 0,void 0,void 0,!0);try{Ba.jc(I),Ba.gd=Ub.a.sAb,Eb.a.pPh(this.rbd.value,I,V)}finally{Ba&&Ba.dispose()}}else{Ba=this.Fb.yd(4);try{Ba.jc(I),Eb.a.pPh(this.rbd.value,I,V),this.Ub.Di.Iga()}finally{Ba&&Ba.dispose()}}}c9a(I,V,Ba){const cb=new x.StandardDialog;cb.Ad=4;cb.Tx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_NewFileAPIConsentMessage,1,Nb=>{2===Nb||0===Nb?Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):(Nb=new cg("blank","agave",I?vc.XBk:vc.YBk,I),this.Tpk.create(V,Ba,Nb).c9a())})}Re(){return this.jb.Re()}Ud(){return this.jb.Ud()}Euj(){var I=this.jb.Ud();if(!(I.length&&this.jb.uz()&&this.pa.value&&this.pa.value.Pa.length))return[];const V=this.pa.value.Pa.ga(0);return(I=vc.xsj(I[0],V))&&2===I.length?I:[]}wPl(I){if(!I)return!1;this.jb.s9a();if(!I.length)return!0;I[0]!==this.ua.Ba&&
(this.Ub.Ba=I[0]);for(const V of I)V&&this.jb.y7a(V);return!0}vPl(I){if(!I)return!1;if(!I.length)return this.jb.nh(),!0;this.jb.j1a(I,!0);return!0}xPl(I,V,Ba){if(!vc.sug(I))return!1;if(0>V)return!0;I=(new gb(I,V,Ba)).build();I=[new Hh.Selection(I,!0)];I=new li.SelectionCollection(I,0);this.jb.gF(I);return!0}getSelectedSlides(){let I;I="";var V=null;if(!V||!V.length){var Ba=this.jb.Fk()||this.ua.Ba;V||(V=[]);Ba&&V.push(Ba)}if(!V.length)return pe.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,O4e:I};Ba=[];for(const cb of V){V=cb.qe+1;if(!V)return pe.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,O4e:I};Array.add(Ba,[cb.sid.toString(),cb.title||"",V.toString()])}I=ka.c(Ba);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,O4e:I}}getSelectedTextRange(){var I=[];for(let V=0;V<this.pa.value.Pa.length;V++){const Ba=this.pa.value.Pa.ga(V);
Array.add(I,this.VXc(Ba))}I=I.join(vc.VIf);if(I===Xi.AParagraphNode.L_)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Zsc:I};I=Xi.AParagraphNode.Zpd(I);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Zsc:I}}X7j(I){if(!I)return!1;let V=I.Rla||I.Gw||I.Wf||I.xd;if(!V&&I.Ik)switch(I.Cj){case 0:case 2:case 1:case 3:case 10:case 8:V=!0}return V}Y7j(I){if(!I)return!1;let V=I.Rla||I.Gw;if(!V&&I.Ik)switch(I.Cj){case 0:case 2:case 1:case 3:case 8:V=
!0}return V}VXc(I){let V="";if(I)for(let Ba=0;Ba<I.length;Ba++){const cb=I.ga(Ba),Nb=cb.Ra,Ec=cb.Lb-Nb;let Oc="";Fi.ParagraphReader.fe(cb.node)&&(Oc=cb.node.characterData);switch(cb.contextId){case ai.a.paragraph:V+=Oc+"\r";break;case ai.a.textRange:0<Ec&&(V+=Oc.substr(Nb,Ec));break;case ai.a.endOfParagraph:V+="\r"}}return V}wee(I){var V=this.ua.presentation;if(!V)throw Error.argumentNull("Presentation is null");V=V.slides||[];for(let Ba=0;Ba<V.length;Ba++)if(V[Ba].Cb.sid===I)return Object(ha.a)(116,
V[Ba]);return null}Mtl(I){if(!this.pa.value||!this.GJ.value||!this.egb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.pa.value.Pa.length){if(!Oh.SelectionEditor.Ex(this.pa.value.Pa.nb)&&32!==this.ia.processAction(Aa.a.MDa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var V=this.pa.value.Pa.nb.Ua;const Ba=V.node,cb=V.Ra;V=V.Lb;const Nb=this.Fb.yd(7);try{Nb.jc(Ba);let Ec=null;Ec=cb===V?mh.a.Oj(Ba,cb):mh.a.createTextRange(Ba,cb,V);this.GJ.value.replaceTextRange(Ec,
I)}finally{Nb.dispose()}V=cb+I.length;this.pa.value.setSelection(Wi.SelectionFactory.R3(Ba,cb,V));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}pe.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}Ltl(I){if(!this.pa.value||!this.GJ.value||!this.egb.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const V=this.jb.Ll();if(!V)return I="Fail to get shape while setting selected shape's text: shape returned as null: "+
Ud.Debug.mu(),pe.a.J(512263106,802,10,I),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.Y7j(V)){const Ba=this.Tb.Lc(V),cb=this.Fb.yd(7);try{cb.jc(Ba);V.deleteParagraph();this.egb.value.vW(Ba,!0);this.uIa.yi(Ba);const Nb=Ba.currentNode,Ec=this.Hh.textLength(Nb),Oc=mh.a.createTextRange(Nb,0,Ec);this.GJ.value.replaceTextRange(Oc,I)}finally{cb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}pe.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}WSc(I,
V,Ba){return I<V||Ba<I}IQf(I){return"data:image/png;base64,"+I}Gab(I,V){if(!I)return null;var Ba=I.Cb;I=I.Cs();let cb;const Nb=cc.a.UR,Ec=cc.a.BY;cb=V?V.Jyb(cc.a.UR,cc.a.BY):this.Sb.Uka(cc.a.UR,cc.a.BY);Ba=this.wk.Xja(!0,Ba.cid,Ba.sid,0,cb.x,cb.y,Nb,Ec,I+1,!0);V&&(Ba.B8=V.id);return Ba}static sug(I){if(!I)return!1;let V=I.Rla||I.Gw;if(!V&&I.Ik)switch(I.Cj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:V=!0}return V}static Ayj(I,V){I=I.vy();if(!I||!V)return 0;let Ba=0;for(const cb of I){if(cb===
V)break;Ba+=Fi.ParagraphReader.textLength(Object(ha.a)(Ob.a,cb))+1}return Ba}static xsj(I,V){if(!vc.sug(I)||!V)return[];var Ba=-1;let cb=0;for(let Nb of V){V=Fi.ParagraphReader.fe(Nb.node)?Fi.ParagraphReader.textLength(Nb.node):0;if(-1===Ba)switch(Ba=Fi.ParagraphReader.fe(Nb.node)?vc.Ayj(I,Object(ha.a)(5,Nb.node)):0,Nb.contextId){case ai.a.paragraph:break;case ai.a.textRange:case ai.a.Mf:Ba+=Nb.Ra;break;case ai.a.endOfParagraph:Ba+=V;break;default:return[]}switch(Nb.contextId){case ai.a.paragraph:cb+=
V+1;break;case ai.a.textRange:cb+=Math.max(0,Nb.Lb-Nb.Ra);break;case ai.a.endOfParagraph:cb+=1}}return[Ba,cb]}}vc.VIf=" ";vc.aob=169056;vc.YBk="streamEmpty";vc.XBk="streamBase64";Object(h.a)(vc,"AppForOfficeApiFacadeEditorImpl",null,[720]);class jd{Chg(I,V,Ba){if(Ba.tEa(I))r.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(I=Ba.F6b(I)){const cb={};cb.solutionId=I.qp.id;cb.version=I.qp.version;cb.storeType=I.qp.storeType;
cb.storeId=I.qp.store;cb.assetId=null;cb.assetStoreId=null;cb.targetType=1;cb.isAddinCommands=!0;cb.addinCommandsActionType=1;cb.sharedRuntimeId=I.tw?I.tw.Pya:null;cb.backgroundState=I.tw?I.tw.state:-1;I.settings=V;Ba.LVd.kH().Ja(Ub.a.$_c,2,cb);return!0}return!1}BWj(I,V){if(!I&&!V)return!0;if(!I||!V||Object.keys(I).length!==Object.keys(V).length)return!1;for(let Nb in I){var Ba=Nb,cb=I[Nb];if(!(Ba in V)||V[Ba]!==cb)return!1}return!0}}Object(h.a)(jd,"AppForOfficeAppSettingProxy",null,[]);class Id{constructor(I,
V,Ba,cb){this._id=I;this.f7a=V;this.f8=Ba;this.sHc=cb}get id(){return this._id}get version(){return this.f7a}get store(){return this.f8}get storeType(){return this.sHc}}Object(h.a)(Id,"AppForOfficeReference",null,[718]);class Od{constructor(I,V){this._id=I;this.L$h=V}get id(){return this._id}get slideId(){return this.L$h}}Object(h.a)(Od,"AppForOfficeShape",null,[717]);class ba{constructor(I,V,Ba,cb,Nb,Ec=null,Oc=!1){this.d_h=I;this.sci=V;this.k7a=Ba;this.h9h=cb;this.LMd=Nb;this.isForUILessAction=
Oc;this.J6h=Ec}get MWf(){return this.d_h}get visibility(){return this.sci}get width(){return this.k7a}get row(){return this.h9h}get ownerAddinSolutionId(){return this.LMd}get ownerAddinStoreType(){return this.J6h}}Object(h.a)(ba,"AppForOfficeTaskpane",null,[716]);class Da{constructor(I,V,Ba,cb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=I;this.controlId=V;this.ddaBinding=Ba;this.ArrayData=cb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(Da,"DdaEventArgs",null,[]);class Qa{constructor(I,V){this.gEb=null;this.Oc=I;this.ia=V}I$d(I){this.gEb||this.WTk();if(!I||!this.gEb[I])return null;I=this.gEb[I];I.Hd=this.Oc;I.un=this.ia;return I}nMf(I){const V=this.gEb;for(let Ba in V)V[Ba].removeHandler(I)}set(I,V){this.gEb[I]=V}}Object(h.a)(Qa,"ApiEventStore",null,[]);class nb{constructor(){this.ro=this.ia=this.Oc=null;this.yl={}}get handlers(){return this.yl}get un(){return this.ia}set un(I){this.ia=I}get Hd(){return this.Oc}set Hd(I){this.Oc=
I}raiseEvent(I,V=null){I=this.hua(I);if(V){var Ba=this.yl[V];Ba&&Ba(I)}else for(Ba in V=this.yl,V){const cb=V[Ba];cb&&cb(I)}}addHandler(I,V,Ba=null){this.yl[I]=V;this.p8a(Ba)}removeHandler(I,V,Ba=null){delete this.yl[I];this.p8a(Ba)}get result(){return this.ro}p8a(I){this.uB(I,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}uB(I,V){I&&(this.ro={},this.ro[ue.c_Error]=V,I(this.ro))}}Object(h.a)(nb,"ApiEvent",null,[800]);class Wb extends nb{constructor(){super()}hua(I){return I}static get instance(){Wb.Up||
(Wb.Up=new Wb);return Wb.Up}}Wb.Up=null;Object(h.a)(Wb,"ActivationStatusChangedEvent",nb,[]);class Jb extends nb{constructor(){super()}hua(){return"view"}static get instance(){Jb.Up||(Jb.Up=new Jb);return Jb.Up}}Jb.Up=null;Object(h.a)(Jb,"ActiveViewChangedEvent",nb,[]);var Uc=d(106);class Jd extends nb{constructor(){super();this.fve=null}hua(){return null}get bta(){!this.fve&&this.Hd&&(this.fve=Mf.getInstance(this.Hd.Xi));return this.fve}addHandler(I,V,Ba=null,cb=null){this.Hd?this.Hd.au.zla()?I in
this.handlers?this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(r.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(I,cb,Nb=>{Nb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Uc.a.count(this.handlers)||this.bta.Kji(Object(D.a)(this,this.dOe,"onMessageParentEvent")),this.handlers[I]=V,this.Hd.Xi?({value:Nb}=Mf.vfg().vg(I),Nb?(this.Hd.Xi.setActivationCompletedStatus(Nb.ig,!0),this.Hd.s0a(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),Nb.ig,
!0)):r.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):r.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.p8a(Ba)):(r.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",Nb.toString()),this.uB(Ba,Nb))})):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(I,V,Ba=null){this.Hd?this.Hd.au.zla()?
I in this.handlers?(r.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.bta.kFi(I,cb=>{delete this.handlers[I];Uc.a.count(this.handlers)||this.bta.rrh(Object(D.a)(this,this.dOe,"onMessageParentEvent"));cb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&r.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",cb.toString());this.uB(Ba,cb)})):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(I,V,Ba){try{this.bta.showDialog(V,I,Ba,null)}catch(cb){r.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",cb.message),Ba(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}dOe(I,V){if(V.controlId in this.yl){I={};I[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=V.messageType;I[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
V.messageContent;I[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=V.nKe;I[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=V.GMa;const Ba=this.yl[V.controlId];Ba&&Ba(I);V.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.yl[V.controlId],Uc.a.count(this.yl)||this.bta.rrh(Object(D.a)(this,this.dOe,"onMessageParentEvent")))}}static get instance(){Jd.Up||(Jd.Up=new Jd);return Jd.Up}}Jd.Up=null;Object(h.a)(Jd,"DialogMessageReceivedEvent",nb,[]);
class ne extends nb{constructor(){super()}hua(){return null}addHandler(I,V,Ba=null){this.Hd?this.Hd.au.zla()?(V=this.Hd.Vxb(I))&&V.taskpane&&V.taskpane.isForUILessAction?(this.un.Ja(pc.a.Nuc,2,I),this.p8a(Ba)):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(I,V,Ba=null){this.Hd?this.Hd.au.zla()?(V=this.Hd.Vxb(I))&&V.taskpane?V.taskpane.isForUILessAction?
(this.un.Ja(pc.a.B$b,2,I),this.p8a(Ba)):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(ne,"DialogNotificationShownInAddinEvent",nb,[]);class bf extends nb{constructor(){super();this.Xi=this.rWd=null}hua(){return null}get bta(){this.rWd||(this.rWd=Mf.getInstance(this.contextActivationMgr));
return this.rWd}get contextActivationMgr(){!this.Xi&&this.Hd&&(this.Xi=this.Hd.Xi);return this.Xi}addHandler(I,V,Ba=null){this.Hd&&!this.Hd.au.zla()?this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):I in this.yl?this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(Uc.a.count(this.yl)||this.bta.Jji(Object(D.a)(this,this.Xbh,"onMessageDialogEvent")),this.yl[I]=V,this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(I,V,Ba=null){this.Hd&&!this.Hd.au.zla()?
this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):I in this.yl?(delete this.yl[I],Uc.a.count(this.yl)||this.bta.Obl(Object(D.a)(this,this.Xbh,"onMessageDialogEvent")),this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}Xbh(I,V){V.controlId in this.yl&&(I={},I[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=V.messageType,I[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
V.messageContent,I[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=V.nKe,I[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=V.GMa,(V=this.yl[V.controlId])&&V(I))}static get instance(){bf.Up||(bf.Up=new bf);return bf.Up}}bf.Up=null;Object(h.a)(bf,"DialogParentMessageReceivedEvent",nb,[]);class sd extends nb{constructor(){super()}hua(){return{}}static get instance(){sd.Up||(sd.Up=new sd);return sd.Up}}sd.Up=null;Object(h.a)(sd,"DocumentSelectionChangedEvent",
nb,[]);class vd extends nb{constructor(){super()}hua(){return null}raiseEvent(I,V){try{const Ba=this.yl[V];Ba&&(V={},V[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=I,Ba(V))}catch(Ba){pe.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Ba.message)}}static get instance(){vd.Up||(vd.Up=new vd);return vd.Up}}vd.Up=null;Object(h.a)(vd,"DocumentThemeChangedEvent",nb,[]);class $c extends nb{constructor(){super()}hua(){return null}addHandler(I,V,Ba=null){this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(I,
V,Ba=null){this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){$c.Up||($c.Up=new $c);return $c.Up}}$c.Up=null;Object(h.a)($c,"OfficeThemeChangedEvent",nb,[]);class hd{constructor(I){this.$8h=I}onRegisterRichApiEvent(){}onUnregisterRichApiEvent(){}sendRichApiMessageEventEntriesToControl(I,V){this.$8h.executeHandlers(I,V)}}Object(h.a)(hd,"RichApiEventManagerHost",null,[801]);class Dd extends nb{constructor(){super();this.DOd=null}hua(I){return I}addHandler(I,
V,Ba=null,cb=null){this.Hd&&na.a(cb)?(this.DOd||(this.DOd=new hd(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.DOd)),this.yl[I]=V,this.p8a(Ba)):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(I,V,Ba=null,cb=null){this.Hd&&na.a(cb)&&I in this.yl?(delete this.yl[I],this.p8a(Ba)):this.uB(Ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}executeHandlers(I,V){const Ba={};Ba[OSF.DDA.WAC.UniqueArguments.ArrayData]=V;(I=this.yl[I])&&I(Ba)}static get instance(){return Dd.La||
(Dd.La=new Dd)}}Dd.La=null;Object(h.a)(Dd,"RichApiMessageEvent",nb,[]);class Re extends nb{constructor(){super()}hua(I){return I}static get instance(){Re.Up||(Re.Up=new Re);return Re.Up}}Re.Up=null;Object(h.a)(Re,"SettingsChangedEvent",nb,[]);class ml extends Qa{constructor(I,V){super(I,V)}WTk(){this.gEb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,Re.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,Jb.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,
Wb.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,vd.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,$c.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,sd.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Jd.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,bf.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new ne);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,
Dd.instance)}}Object(h.a)(ml,"EditorEventStore",Qa,[]);class Mh{constructor(I){this.yic=null;this.Oc=I}Ldj(I){this.yic||this.lUk();if(!I||!this.yic[I])return null;if(I=this.yic[I]())I.Hd=this.Oc;return I}set(I,V){this.yic[I]=V}}Object(h.a)(Mh,"ApiMethodFactory",null,[]);class we{constructor(I,V,Ba,cb){this.instanceId=I.toLowerCase();this.fileSize=V;this.s8d=cb;this.nGh=Ba}}Object(h.a)(we,"DocumentCopy",null,[]);var Yi=d(398),nl=d(264);class Pj extends Yi.a{constructor(I,V,Ba,cb,Nb,Ec,Oc){super();
this.RB=I.string;this.yA=V;this.Lma=Ba;this.Lfa=Nb;this.uuk=cb;this.hec=Ec;this.YWa=Oc;this.u_a=Object(D.a)(this,this.KHk,"onGetDocumentCopyChunkFinished");this.onError=Object(D.a)(this,this.JHk,"onGetDocumentCopyChunkError")}start(){this.Rud=!1;nl.a.v8f(this.RB,this.yA,this.Lma,this.uuk,this.Lfa,Object(D.a)(this,this.gea,"handleWebserviceResponse"),Object(D.a)(this,this.fea,"handleWebserviceError"))}KHk(I){if(I.pTa){const V={};I=I.result;V.value=I.FileData;V.errorCode=I.ErrorCode;this.hec(this.yA,
V)}else this.handleError(I)}JHk(I){this.handleError(I)}handleError(I){this.YWa&&(I=I.error,this.YWa(this.yA,!!I&&2===I.type))}}Object(h.a)(Pj,"GetDocumentCopyChunkTask",Yi.a,[]);class ol extends Yi.a{constructor(I,V,Ba,cb,Nb,Ec){super();this.RB=I.string;this.yA=V;this.Lma=Ba;this.Lfa=cb;this.hec=Nb;this.YWa=Ec;this.u_a=Object(D.a)(this,this.MHk,"onGetDocumentCopyFinished");this.onError=Object(D.a)(this,this.LHk,"onGetDocumentCopyError")}start(){this.Rud=!1;nl.a.ijj(this.RB,this.yA,this.Lma,Object(D.a)(this,
this.gea,"handleWebserviceResponse"),Object(D.a)(this,this.fea,"handleWebserviceError"))}MHk(I){if(I.pTa){const V={};I=I.result;V.fileSize=I.FileSize;V.errorCode=I.ErrorCode;V.format=this.Lma;V.sliceSize=this.Lfa;this.hec(this.yA,V)}else this.handleError(I)}LHk(I){this.handleError(I)}handleError(I){this.YWa&&(I=I.error,this.YWa(this.yA,!!I&&2===I.type))}}Object(h.a)(ol,"GetDocumentCopyTask",Yi.a,[]);class mi extends Yi.a{constructor(I,V,Ba,cb,Nb,Ec,Oc){super();this.RB=I.string;this.yA=V;this.Lma=
Ba;this.iok=cb;this.hok=Nb;this.hec=Ec;this.YWa=Oc;this.u_a=Object(D.a)(this,this.YKk,"onReleaseDocumentCopyFinished");this.onError=Object(D.a)(this,this.XKk,"onReleaseDocumentCopyError")}start(){this.Rud=!1;nl.a.Arc(this.RB,this.yA,this.Lma,this.iok,this.hok,Object(D.a)(this,this.gea,"handleWebserviceResponse"),Object(D.a)(this,this.fea,"handleWebserviceError"))}YKk(I){if(I.pTa){const V={};V.errorCode=I.result.ErrorCode;this.hec(this.yA,V)}else this.handleError(I)}XKk(I){this.handleError(I)}handleError(I){this.YWa&&
(I=I.error,this.YWa(this.yA,!!I&&2===I.type))}}Object(h.a)(mi,"ReleaseGetDocumentCopyTask",Yi.a,[]);class nk{constructor(){this.Ffd=null}start(){this.Ffd.start()}static wOi(I,V,Ba,cb,Nb,Ec){const Oc=new nk;Oc.Ffd=new ol(I,V,Ba,cb,Nb,Ec);return Oc}static vOi(I,V,Ba,cb,Nb,Ec,Oc){const je=new nk;je.Ffd=new Pj(I,V,Ba,cb,Nb,Ec,Oc);return je}static RRf(I,V,Ba,cb,Nb,Ec,Oc){const je=new nk;je.Ffd=new mi(I,V,Ba,cb,Nb,Ec,Oc);return je}}Object(h.a)(nk,"AppForOfficeTask",null,[]);class ek{constructor(){this.Nwe=
1;this.bif=new Xb.a}get rEa(){return this.bif}vyi(I,V,Ba,cb){const Nb=this.zag();I=new we(I,V,Ba,cb);this.rEa.$(Nb.toString(),I);return Nb}Jpg(I,V){for(let Ba of this.rEa){const cb=Ba.value;if(cb.instanceId===I.toLowerCase()&&cb.s8d===V)return!0}return!1}z6f(I){return this.rEa.ga(I.toString())}$9k(I){this.rEa.remove(I.toString())}Arc(I,V,Ba,cb){(cb&&this.a$k(V)||Ba&&this.T9k())&&nk.RRf(I,V,4,Ba,cb,()=>{},()=>{}).start()}T9k(){let I=!1;0<this.rEa.count&&(this.bif=new Xb.a,I=!0);return I}a$k(I){if(!I)return!1;
const V=[];for(let Ba of this.rEa)Ba.value.instanceId===I.toLowerCase()&&V.push(Ba.key);for(I=0;I<V.length;I++)this.rEa.remove(V[I]);return 0<V.length}zag(){return this.Nwe++}}Object(h.a)(ek,"GetDocumentCopyHelper",null,[655]);class bj{constructor(I,V){this.YFg=V.length;this.Lfa=I;this.tuk=Math.ceil(this.YFg/I);this.sLi(V)}sLi(I){for(let V=0;V<this.tuk;V++){const Ba=V*this.Lfa;I.slice(Ba,Math.min(Ba+this.Lfa,this.YFg))}}}Object(h.a)(bj,"DocumentCopyCache",null,[]);class Nk{constructor(){this.xFe=
this.VFe=null;this.yFe=this.WFe=0}add(I,V,Ba,cb){4===V?(this.WFe=I,this.VFe=new bj(Ba,cb)):3===V&&(this.yFe=I,this.xFe=new bj(Ba,cb))}remove(I){this.WFe===I?(this.WFe=0,this.VFe=null):this.yFe===I&&(this.yFe=0,this.xFe=null)}contains(I){return 4===I&&!!this.VFe||3===I&&!!this.xFe}}Object(h.a)(Nk,"PerAppCache",null,[]);class Qj{get cache(){return Qj.vi}get t8d(){return Qj.jlk}Jpg(I,V){return I in this.cache&&this.cache[I].contains(V)}v8f(){}Arc(I){if(I.toString()in this.t8d){const V=this.t8d[I.toString()];
delete this.t8d[I.toString()];this.cache[V].remove(I)}}zag(){return Qj.Nwe++}}Qj.vi={};Qj.jlk={};Qj.Nwe=1;Object(h.a)(Qj,"GetFileApiProxy",null,[844]);class Nf{constructor(I,V,Ba){this.ph=0;this.controlId=this.fBa=this.KE=this.pDb=this.Oc=this.ro=null;this.parameters=I;this.callback=V;this.fmi=Ba;new Qj;this.Pdb=new jd;this.MXa=new ek}get GKc(){this.Pdb||(this.Pdb=new jd);return this.Pdb}get Tda(){return this.MXa}get ljl(){this.KE||(this.KE=ub.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));
return this.KE}get aNj(){return this.fBa||(this.fBa=ub.a.instance.Ia("Postmessage.IHostPostmessenger"))}get errorCode(){return this.ph}set errorCode(I){this.ph=I}get result(){return this.ro}set result(I){this.ro=I}get au(){return this.pDb}get Hd(){return this.Oc}set Hd(I){(this.Oc=I)?(this.pDb=this.Oc.au,this.MXa=this.Oc.Tda):this.MXa=this.pDb=null}go(){this.ro={};try{this.Fq()}catch(I){this.iek(I)}this.bI()}iek(I){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;pe.a.J(18396573,802,10,
"Error when executing API: {0}",I.toString())}bI(){this.ph!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&pe.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",this.ph);this.ro[ue.c_Error]=this.ph;this.callback(this.ro)}K$d(){return this.controlId?this.Hd?this.Hd.g0.$W(this.controlId):null:null}Sdj(){if(!this.controlId)return null;let I=null;this.Hd&&(I=this.Hd.g0.$W(this.controlId));return I?0===I.jy?this.Hd.U1f(I.shape.slideId,I.shape.id):1===I.jy?this.Hd.tEa(I.qp.id):null:
null}efe(I){return I?this.Hd?this.Hd.efe(I):null:null}}Object(h.a)(Nf,"ApiMethod",null,[]);class Bg extends Nf{constructor(){super()}Fq(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[O.a.Uli][O.a.Tli],this.parameters);this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(h.a)(Bg,"AppCommandInvocationCompletedMethod",Nf,[]);class Xk extends Nf{constructor(){super()}go(){this.ro={};this.Fq()}Fq(){if(this.au)try{const I=
this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();I&&I.length>this.Hd.LVd.rd.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(r.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",I.length),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.bI()):this.au.c9a(I,Object(D.a)(this,this.SNi,"createDocumentSuccessCallback"),Object(D.a)(this,this.RNi,"createDocumentFailCallback"))}catch(I){pe.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+
I.toString()),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.bI()}else this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.bI()}SNi(I){const V=new x.StandardDialog;V.Ad=4;V.Tx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Ba=>{1===Ba&&window.open(I);this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.bI()})}RNi(I){this.ph=I?I:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}get description(){return"Create a new ppt document in the user's default folder."}}
Object(h.a)(Xk,"CreateDocumentMethod",Nf,[]);var Ni=d(97),nh=d(89);class ni{static R4k(I){const V=new Map;V.set("ApiId",I.toString());Ni.Health.instance.recordKpiUsage(ni.Xvh,1,ni.Tvh,V)}static Q4k(I,V,Ba){const cb=new Map;cb.set("ApiId",I.toString());I=Object.assign(new nh.a,{extendedProperties:cb,durationMs:ni.A8f(V,Ba)});Ni.Health.instance.recordKpiSuccess(ni.Xvh,I)}static voh(I){const V=new Map;V.set("fWacPartition",I.toString());Ni.Health.instance.recordKpiUsage(ni.Yvh,1,ni.Tvh,V)}static QVe(I,
V){I=Object.assign(new nh.a,{durationMs:ni.A8f(I,V)});Ni.Health.instance.recordKpiSuccess(ni.Yvh,I)}static A8f(I,V){let Ba=null;I&&V&&(Ba=V-I);return Ba}}ni.Xvh="PptApiCall";ni.Yvh="PptApiRequest";ni.Tvh="pptom";Object(h.a)(ni,"PptWacApiTelemetry",null,[]);class ye{constructor(){this.ver=0;this.exec=this.sel=null}}Object(h.a)(ye,"ApiRequest",null,[]);class Dg{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(Dg,"SelectionData",null,[]);const Fj=(I,V)=>{var Ba=Object,cb=Ba.assign,Nb=
new ye,Ec=Object,Oc=Ec.assign,je=new Dg,De=I.au.Re();const Pd=[];if(De){Pd.length=De.length;for(var Ke=0;Ke<De.length;Ke++)Pd[Ke]=De[Ke].Cb.toString()}De=I.au.Ud();Ke=[];if(De){Ke.length=De.length;for(let xg=0;xg<De.length;xg++)Ke[xg]=De[xg].get_shapeId().toString()}I=cb.call(Ba,Nb,{ver:1,exec:V,sel:Oc.call(Ec,je,{sldLst:Pd,shpLst:Ke,txRn:I.au.Euj()})});return Sys.Serialization.JavaScriptSerializer.serialize(I)},Gj=I=>{if(z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.PowerPointOnline.IncludeWacApiHostTypeRegister")){var V=
I.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Ba=V.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ba.addParameter("shortcuts","String[]",1,null,0);V.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Ba=V.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ba.addParameter("shortcuts","Object",1,null,0);V=I.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ba=V.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Ba.addParameter("pickerCustomizationJsonString","String",1,null,0);V=I.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Ba=V.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Ba.addParameter("appName","String",1,null,0);Ba.addParameter("target","String",1,
null,0);V=I.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);V.addProperty("Data",4,"String",1,!1,null,0);V=I.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);Ba=V.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Ba.addParameter("data","String",1,null,0);V.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",
0,1,"_RegisterHostMessageReceivedEvent",4);V.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);V=I.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);V.addProperty("BatchId",6,"String",1,!1,null,0);V=I.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Ba=V.addMethod("EndCopilotOperation",
5,"Void",0,0,"EndCopilotOperation",4);Ba.addParameter("batchId","String",1,null,0);Ba=V.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);Ba.addParameter("batchId","String",1,null,0);V.addMethod("Undo",1,"Boolean",1,0,"Undo",4);V.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);V.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4)}V=I.addType("Microsoft.Office.PowerPoint.Application",
"{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Ba=V.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Ba.addParameter("address","String",1,null,0);Ba.addParameter("displayName","String",1,null,0);Ba=V.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);Ba.addParameter("slideContent","String",1,null,0);V=I.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}",
"",3,0);V.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);V.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);V.addProperty("Tags",4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);V.addProperty("Title",1,"String",1,!0,null,0);Ba=V.addMethod("ApplyJOfcCommands",10,"String",1,0,"ApplyJOfcCommands",4);Ba.addParameter("commandPayload","String",1,null,0);Ba.addParameter("options","Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions",
2,null,0);V.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);V.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);V.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);V.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRangeOrNullObject",0);Ba=V.addMethod("InsertSlidesFromBase64",
1003,"Void",0,0,"InsertSlidesFromBase64",0);Ba.addParameter("base64File","String",1,null,0);Ba.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Ba=V.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Ba.addParameter("slideIds","String[]",1,null,0);Ba=V.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Ba.addParameter("referenceId","String",1,null,0);Ba.addParameter("eventType","Int32",1,null,0);Ba=V.addMethod("_UnregisterEvent",1002,"Void",
0,1,"_UnregisterEvent",0);Ba.addParameter("referenceId","String",1,null,0);Ba.addParameter("eventType","Int32",1,null,0);V=I.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);V.addProperty("LayoutId",1,"String",1,!1,null,0);V.addProperty("SlideMasterId",2,"String",1,!1,null,0);V=I.addType("Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions","{65f2dfc9-c96e-44ce-8f74-6ecb42f994cf}","{feeaf50c-98cf-4bed-93d5-a78df27c3b78}",
2,0);V.addProperty("DesignerOptions",1,"String",1,!1,null,0);V=I.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}","",3,0);V.addProperty("Visible",2,"Boolean",1,!1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=I.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");V.addEnumField("Straight",0);V.addEnumField("Elbow",1);V.addEnumField("Curve",2);V=I.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");V.addEnumField("LineInverse",
0);V.addEnumField("Triangle",1);V.addEnumField("RightTriangle",2);V.addEnumField("Rectangle",3);V.addEnumField("Diamond",4);V.addEnumField("Parallelogram",5);V.addEnumField("Trapezoid",6);V.addEnumField("NonIsoscelesTrapezoid",7);V.addEnumField("Pentagon",8);V.addEnumField("Hexagon",9);V.addEnumField("Heptagon",10);V.addEnumField("Octagon",11);V.addEnumField("Decagon",12);V.addEnumField("Dodecagon",13);V.addEnumField("Star4",14);V.addEnumField("Star5",15);V.addEnumField("Star6",16);V.addEnumField("Star7",
17);V.addEnumField("Star8",18);V.addEnumField("Star10",19);V.addEnumField("Star12",20);V.addEnumField("Star16",21);V.addEnumField("Star24",22);V.addEnumField("Star32",23);V.addEnumField("RoundRectangle",24);V.addEnumField("Round1Rectangle",25);V.addEnumField("Round2SameRectangle",26);V.addEnumField("Round2DiagonalRectangle",27);V.addEnumField("SnipRoundRectangle",28);V.addEnumField("Snip1Rectangle",29);V.addEnumField("Snip2SameRectangle",30);V.addEnumField("Snip2DiagonalRectangle",31);V.addEnumField("Plaque",
32);V.addEnumField("Ellipse",33);V.addEnumField("Teardrop",34);V.addEnumField("HomePlate",35);V.addEnumField("Chevron",36);V.addEnumField("PieWedge",37);V.addEnumField("Pie",38);V.addEnumField("BlockArc",39);V.addEnumField("Donut",40);V.addEnumField("NoSmoking",41);V.addEnumField("RightArrow",42);V.addEnumField("LeftArrow",43);V.addEnumField("UpArrow",44);V.addEnumField("DownArrow",45);V.addEnumField("StripedRightArrow",46);V.addEnumField("NotchedRightArrow",47);V.addEnumField("BentUpArrow",48);V.addEnumField("LeftRightArrow",
49);V.addEnumField("UpDownArrow",50);V.addEnumField("LeftUpArrow",51);V.addEnumField("LeftRightUpArrow",52);V.addEnumField("QuadArrow",53);V.addEnumField("LeftArrowCallout",54);V.addEnumField("RightArrowCallout",55);V.addEnumField("UpArrowCallout",56);V.addEnumField("DownArrowCallout",57);V.addEnumField("LeftRightArrowCallout",58);V.addEnumField("UpDownArrowCallout",59);V.addEnumField("QuadArrowCallout",60);V.addEnumField("BentArrow",61);V.addEnumField("UturnArrow",62);V.addEnumField("CircularArrow",
63);V.addEnumField("LeftCircularArrow",64);V.addEnumField("LeftRightCircularArrow",65);V.addEnumField("CurvedRightArrow",66);V.addEnumField("CurvedLeftArrow",67);V.addEnumField("CurvedUpArrow",68);V.addEnumField("CurvedDownArrow",69);V.addEnumField("SwooshArrow",70);V.addEnumField("Cube",71);V.addEnumField("Can",72);V.addEnumField("LightningBolt",73);V.addEnumField("Heart",74);V.addEnumField("Sun",75);V.addEnumField("Moon",76);V.addEnumField("SmileyFace",77);V.addEnumField("IrregularSeal1",78);V.addEnumField("IrregularSeal2",
79);V.addEnumField("FoldedCorner",80);V.addEnumField("Bevel",81);V.addEnumField("Frame",82);V.addEnumField("HalfFrame",83);V.addEnumField("Corner",84);V.addEnumField("DiagonalStripe",85);V.addEnumField("Chord",86);V.addEnumField("Arc",87);V.addEnumField("LeftBracket",88);V.addEnumField("RightBracket",89);V.addEnumField("LeftBrace",90);V.addEnumField("RightBrace",91);V.addEnumField("BracketPair",92);V.addEnumField("BracePair",93);V.addEnumField("Callout1",94);V.addEnumField("Callout2",95);V.addEnumField("Callout3",
96);V.addEnumField("AccentCallout1",97);V.addEnumField("AccentCallout2",98);V.addEnumField("AccentCallout3",99);V.addEnumField("BorderCallout1",100);V.addEnumField("BorderCallout2",101);V.addEnumField("BorderCallout3",102);V.addEnumField("AccentBorderCallout1",103);V.addEnumField("AccentBorderCallout2",104);V.addEnumField("AccentBorderCallout3",105);V.addEnumField("WedgeRectCallout",106);V.addEnumField("WedgeRRectCallout",107);V.addEnumField("WedgeEllipseCallout",108);V.addEnumField("CloudCallout",
109);V.addEnumField("Cloud",110);V.addEnumField("Ribbon",111);V.addEnumField("Ribbon2",112);V.addEnumField("EllipseRibbon",113);V.addEnumField("EllipseRibbon2",114);V.addEnumField("LeftRightRibbon",115);V.addEnumField("VerticalScroll",116);V.addEnumField("HorizontalScroll",117);V.addEnumField("Wave",118);V.addEnumField("DoubleWave",119);V.addEnumField("Plus",120);V.addEnumField("FlowChartProcess",121);V.addEnumField("FlowChartDecision",122);V.addEnumField("FlowChartInputOutput",123);V.addEnumField("FlowChartPredefinedProcess",
124);V.addEnumField("FlowChartInternalStorage",125);V.addEnumField("FlowChartDocument",126);V.addEnumField("FlowChartMultidocument",127);V.addEnumField("FlowChartTerminator",128);V.addEnumField("FlowChartPreparation",129);V.addEnumField("FlowChartManualInput",130);V.addEnumField("FlowChartManualOperation",131);V.addEnumField("FlowChartConnector",132);V.addEnumField("FlowChartPunchedCard",133);V.addEnumField("FlowChartPunchedTape",134);V.addEnumField("FlowChartSummingJunction",135);V.addEnumField("FlowChartOr",
136);V.addEnumField("FlowChartCollate",137);V.addEnumField("FlowChartSort",138);V.addEnumField("FlowChartExtract",139);V.addEnumField("FlowChartMerge",140);V.addEnumField("FlowChartOfflineStorage",141);V.addEnumField("FlowChartOnlineStorage",142);V.addEnumField("FlowChartMagneticTape",143);V.addEnumField("FlowChartMagneticDisk",144);V.addEnumField("FlowChartMagneticDrum",145);V.addEnumField("FlowChartDisplay",146);V.addEnumField("FlowChartDelay",147);V.addEnumField("FlowChartAlternateProcess",148);
V.addEnumField("FlowChartOffpageConnector",149);V.addEnumField("ActionButtonBlank",150);V.addEnumField("ActionButtonHome",151);V.addEnumField("ActionButtonHelp",152);V.addEnumField("ActionButtonInformation",153);V.addEnumField("ActionButtonForwardNext",154);V.addEnumField("ActionButtonBackPrevious",155);V.addEnumField("ActionButtonEnd",156);V.addEnumField("ActionButtonBeginning",157);V.addEnumField("ActionButtonReturn",158);V.addEnumField("ActionButtonDocument",159);V.addEnumField("ActionButtonSound",
160);V.addEnumField("ActionButtonMovie",161);V.addEnumField("Gear6",162);V.addEnumField("Gear9",163);V.addEnumField("Funnel",164);V.addEnumField("MathPlus",165);V.addEnumField("MathMinus",166);V.addEnumField("MathMultiply",167);V.addEnumField("MathDivide",168);V.addEnumField("MathEqual",169);V.addEnumField("MathNotEqual",170);V.addEnumField("CornerTabs",171);V.addEnumField("SquareTabs",172);V.addEnumField("PlaqueTabs",173);V.addEnumField("ChartX",174);V.addEnumField("ChartStar",175);V.addEnumField("ChartPlus",
176);V=I.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");V.addEnumField("KeepSourceFormatting",0);V.addEnumField("UseDestinationTheme",1);V=I.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);V.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);V.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);V.addProperty("TargetSlideId",5,"String",1,!1,null,
0);V=I.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");V.addEnumField("Left",0);V.addEnumField("Center",1);V.addEnumField("Right",2);V.addEnumField("Justify",3);V.addEnumField("JustifyLow",4);V.addEnumField("Distributed",5);V.addEnumField("ThaiDistributed",6);V=I.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);V.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,null,0);V.addProperty("HorizontalAlignment",
2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);V.addProperty("Height",1,"Double",1,!1,null,0);V.addProperty("Left",2,"Double",1,!1,null,0);V.addProperty("Top",3,"Double",1,!1,null,0);V.addProperty("Width",4,"Double",1,!1,null,0);V=I.addType("Microsoft.Office.PowerPoint.ShapeCollection",
"{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Ba=V.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Ba.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Ba.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ba=V.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Ba.addParameter("connectorType","Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Ba.addParameter("options",
"Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Ba=V.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Ba.addParameter("text","String",1,null,0);Ba.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);
Ba.addParameter("index","Int32",1,null,0);Ba=V.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);V=I.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Name",3,"String",1,!0,null,0);V.addProperty("Shapes",
4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Ba.addParameter("index","Int32",
1,null,0);Ba=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);V=I.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,
!0,null,0);V.addProperty("Name",4,"String",1,!0,null,0);V.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);V.addProperty("Key",2,"String",1,!0,null,0);V.addProperty("Value",3,"String",1,!1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}",
"",3,0);Ba=V.addMethod("Add",1,"Void",0,0,"Add",0);Ba.addParameter("key","String",1,null,0);Ba.addParameter("value","String",1,null,0);Ba=V.addMethod("Delete",2,"Void",0,0,"Delete",0);Ba.addParameter("key","String",1,null,0);V.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Ba.addParameter("index","Int32",1,null,0);Ba=
V.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Ba.addParameter("key","String",1,null,0);V.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);V=I.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);V.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",
3,!0,null,0);V.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);V.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);V.addMethod("Delete",3,"Void",0,0,"Delete",0);Ba=V.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Ba.addParameter("shapeIds","String[]",1,null,0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=I.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");V.addEnumField("NoFill",0);V.addEnumField("Solid",
1);V.addEnumField("Gradient",2);V.addEnumField("Pattern",3);V.addEnumField("PictureAndTexture",4);V.addEnumField("SlideBackground",5);V=I.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);V.addProperty("ForegroundColor",2,"String",1,!1,null,0);V.addProperty("Transparency",5,"Double",1,!1,null,0);V.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);V.addMethod("Clear",1,"Void",0,0,"Clear",0);Ba=V.addMethod("SetSolidColor",4,
"Void",0,0,"SetSolidColor",0);Ba.addParameter("color","String",1,null,0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=I.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");V.addEnumField("Single",0);V.addEnumField("ThickBetweenThin",1);V.addEnumField("ThickThin",2);V.addEnumField("ThinThick",3);V.addEnumField("ThinThin",4);V=I.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");V.addEnumField("Dash",0);V.addEnumField("DashDot",1);V.addEnumField("DashDotDot",2);V.addEnumField("LongDash",
3);V.addEnumField("LongDashDot",4);V.addEnumField("RoundDot",5);V.addEnumField("Solid",6);V.addEnumField("SquareDot",7);V.addEnumField("LongDashDotDot",8);V.addEnumField("SystemDash",9);V.addEnumField("SystemDot",10);V.addEnumField("SystemDashDot",11);V=I.addType("Microsoft.Office.PowerPoint.ShapeLineFormat","{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);V.addProperty("Color",1,"String",1,!1,null,0);V.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);V.addProperty("Style",
4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);V.addProperty("Transparency",5,"Double",1,!1,null,0);V.addProperty("Visible",6,"Boolean",1,!1,null,0);V.addProperty("Weight",7,"Double",1,!1,null,0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=I.addEnumType("Microsoft.Office.PowerPoint.ShapeType");V.addEnumField("Unsupported",0);V.addEnumField("Image",1);V.addEnumField("GeometricShape",2);V.addEnumField("Group",3);V.addEnumField("Line",4);V=I.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");
V.addEnumField("AutoSizeNone",0);V.addEnumField("AutoSizeTextToFitShape",1);V.addEnumField("AutoSizeShapeToFitText",2);V.addEnumField("AutoSizeMixed",3);V=I.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");V.addEnumField("Top",0);V.addEnumField("Middle",1);V.addEnumField("Bottom",2);V.addEnumField("TopCentered",3);V.addEnumField("MiddleCentered",4);V.addEnumField("BottomCentered",5);V=I.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");V.addEnumField("None",0);V.addEnumField("Single",
1);V.addEnumField("Double",2);V.addEnumField("Heavy",3);V.addEnumField("Dotted",4);V.addEnumField("DottedHeavy",5);V.addEnumField("Dash",6);V.addEnumField("DashHeavy",7);V.addEnumField("DashLong",8);V.addEnumField("DashLongHeavy",9);V.addEnumField("DotDash",10);V.addEnumField("DotDashHeavy",11);V.addEnumField("DotDotDash",12);V.addEnumField("DotDotDashHeavy",13);V.addEnumField("Wavy",14);V.addEnumField("WavyHeavy",15);V.addEnumField("WavyDouble",16);V=I.addType("Microsoft.Office.PowerPoint.ShapeFont",
"{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);V.addProperty("Bold",1,"Boolean",1,!1,null,0);V.addProperty("Color",2,"String",1,!1,null,0);V.addProperty("Italic",3,"Boolean",1,!1,null,0);V.addProperty("Name",5,"String",1,!1,null,0);V.addProperty("Size",6,"Double",1,!1,null,0);V.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);V.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}",
"",3,0);V.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);V.addProperty("Length",7,"Int32",1,!1,null,0);V.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);V.addProperty("Start",9,"Int32",1,!1,null,0);V.addProperty("Text",5,"String",1,!1,null,0);V.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Ba=V.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",
0);Ba.addParameter("start","Int32",1,null,0);Ba.addParameter("length","Int32",1,null,0);V.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);V.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.TextFrame","{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);V.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);V.addProperty("BottomMargin",2,"Double",1,!1,null,0);V.addProperty("HasText",4,"Boolean",1,!0,null,0);V.addProperty("LeftMargin",
6,"Double",1,!1,null,0);V.addProperty("RightMargin",7,"Double",1,!1,null,0);V.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);V.addProperty("TopMargin",9,"Double",1,!1,null,0);V.addProperty("VerticalAlignment",10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);V.addProperty("WordWrap",11,"Boolean",1,!1,null,0);V.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);V.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);
V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);V.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);V.addProperty("Height",5,"Double",1,!1,null,0);V.addProperty("Id",1,"String",1,!0,null,0);V.addProperty("Left",6,"Double",1,!1,null,0);V.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);V.addProperty("Name",7,"String",1,!1,null,0);V.addProperty("Tags",
3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);V.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);V.addProperty("Top",8,"Double",1,!1,null,0);V.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",1,!0,null,0);V.addProperty("Width",10,"Double",1,!1,null,0);V.addMethod("Delete",4,"Void",0,0,"Delete",0);V.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);V.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",
3,0,"ParentSlideLayout",0);V.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);V.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMaster",0);V.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);V.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",
0);V.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Ba.addParameter("index","Int32",1,null,0);Ba=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",
3,0,"ItemOrNullObject",0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);V=I.addType("Microsoft.Office.PowerPoint.SlideCollection","{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Ba=V.addMethod("Add",6,"Void",0,0,"Add",0);Ba.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",2,null,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",
3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ba.addParameter("index","Int32",1,null,0);Ba=V.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);V=I.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}",
"",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Ba.addParameter("index","Int32",1,null,0);Ba=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",
!0);V=I.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);V.addMethod("GetCount",1,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideMaster",3,0);Ba.addParameter("key","String",1,null,0);Ba=V.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Ba.addParameter("index","Int32",1,null,0);Ba=V.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",
0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);V=I.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);V.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ba=V.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ba.addParameter("appRuntimeState",
"Microsoft.AppRuntime.AppRuntimeState",1,null,0);V=I.addEnumType("Microsoft.AppRuntime.AppRuntimeState");V.addEnumField("Inactive",0);V.addEnumField("Background",1);V.addEnumField("Visible",2);V=I.addEnumType("Microsoft.AppRuntime.Visibility");V.addEnumField("Hidden",1);V.addEnumField("Visible",2);V=I.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);V.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeStartState",0);Ba=V.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Ba.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);V=I.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");V.addEnumField("Unknown",0);V.addEnumField("Basic",1);V.addEnumField("Premium",2);V=I.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ba=V.addMethod("GetFeatureTier",
2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ba.addParameter("feature","String",1,null,0);Ba.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ba=V.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Ba.addParameter("feature","String",1,null,0);Ba=V.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);Ba.addParameter("resource","String",1,null,0);Ba.addParameter("policy","String",
1,null,0);Ba.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Ba=V.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ba.addParameter("feature","String",1,null,0);Ba.addParameter("fallbackValue","Boolean",1,null,0);V.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ba=V.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ba.addParameter("experienceId","String",1,null,0);Ba=V.addMethod("_TestFireStateChangedEvent",
6,"Void",0,0,"_TestFireStateChangedEvent",4);Ba.addParameter("feature","String",1,null,0);V=I.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);V.addProperty("Id",5,"String",1,!0,null,0);V.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);V.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);V=I.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",
3,0);V.addProperty("Scopes",1,"String",1,!1,null,0);V=I.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);V.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ba=V.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ba.addParameter("jsonCreate","String",1,null,0);Ba=V.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ba.addParameter("jsonUpdate",
"String",1,null,0);Ba=V.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ba.addParameter("id","String",1,null,0);Ba=V.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ba.addParameter("id","String",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);V.addProperty("Id",2,"String",1,!0,null,0);Ba=V.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Ba.addParameter("visibility","Boolean",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);V.addProperty("Enabled",3,"Boolean",1,!1,null,0);V.addProperty("Id",2,"String",1,!0,null,0);V.addProperty("Label",4,"String",1,!0,null,0);Ba=V.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ba.addParameter("enabled","Boolean",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V=I.addType("Microsoft.DynamicRibbon.RibbonButtonCollection",
"{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);V.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ba=V.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ba.addParameter("key","String",1,null,0);V.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);V.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};var xj=d(43);class Rj{constructor(I,V){this.dkc=I;this.Gjc=V}VQf(I){return[200,null,I]}Z3i(I,V,Ba,cb,Nb,Ec){const Oc=xj.a.xZ(),je=this.dkc.create(V,Ba,cb);cb.xyf=je;const De=this.Gjc.create(Ec,
je);De.context.appId=V;De.context.controlId=Ba;const Pd=()=>{ni.voh(!0);je.xnd=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(je,Gj,De,I).then(xg=>{if(!xg)return r.ULS.sendTraceTag(508850825,802,10,"ExecuteRichApiRequest failed."),Nb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;ni.QVe(Oc,xj.a.xZ());Nb(xg,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},xg=>{r.ULS.sendTraceTag(508850824,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",
V,xg);Nb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},Ke=()=>{ni.voh(!1);let xg=I[4];ge.a("ExtensibilityUseSerializedPayloads")&&(xg=Fj(cb,xg));OfficeExtension.WacRuntime.Utility.createPromise(Gg=>{const ph={};ph.promiseToResolve=Gg;ph.requestBody=xg;z.AFrameworkApplication.Qa.Ja(Ub.a.BSc,2,ph)}).then(Gg=>{ge.a("ExtensibilityResetResponse")&&z.AFrameworkApplication.Qa.Ja(Ub.a.BSc,2,{promiseToResolve:null,requestBody:""});if(ge.a("ExtensibilityUseSerializedPayloads")){a:if((Gg=
Sys.Serialization.JavaScriptSerializer.deserialize(Gg.toString()))&&Gg.sel&&Gg.sel.sldLst){var ph=Ec.presentation,qg=Gg.sel.sldLst,th=[];if(qg)for(ci of qg)({slideId:qg}=Je.a.hNh(ci)).returnValue&&(qg=Object(ha.a)(116,ph.XC(qg)))&&th.push(qg);var ci=th;if(ci.length&&!cb.au.wPl(ci))Gg=null;else{ci=1===ci.length?ci[0]:null;ph=null;if(ci&&Gg.sel.shpLst){th=Gg.sel.shpLst;ph=[];if(th)for(Hf of th)(th=ci.MQ(parseInt(Hf)))&&ph.push(th);var Hf=ph;if(Hf.length&&!cb.au.vPl(Hf)){Gg=null;break a}ph=1===Hf.length?
Hf[0]:null}Gg=ph&&Gg.sel.txRn&&(Gg.sel.txRn.length&&2!==Gg.sel.txRn.length||2===Gg.sel.txRn.length&&0<=Gg.sel.txRn[0]&&!cb.au.xPl(ph,Gg.sel.txRn[0],Gg.sel.txRn[1]))?null:Gg.rst}}else Gg=null;Gg?(ni.QVe(Oc,xj.a.xZ()),Nb(this.VQf(Gg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):Nb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else ni.QVe(Oc,xj.a.xZ()),Nb(this.VQf(Gg),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{Nb(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
return null})};I?(je.xnd=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(je,Gj,De,I).then(xg=>{xg&&je.nFg?Pd():Ke();return null},()=>{Ke();return null})):Pd()}}Object(h.a)(Rj,"RichApiRequest",null,[]);class Bl extends Nf{constructor(I,V,Ba){super();this.dkc=I;this.Gjc=V;this.ua=Ba}go(){this.ro={};this.Fq()}Fq(){const I=this.parameters.ArrayData;if(I){var V=null,Ba=this.K$d();Ba&&Ba.taskpane&&(V=Ba.taskpane.ownerAddinSolutionId);try{(new Rj(this.dkc,this.Gjc)).Z3i(I,V,this.controlId,this.Hd,
Object(D.a)(this,this.$3i,"executeRichApiRequestCallback"),this.ua)}catch(cb){pe.a.J(509112536,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+cb.toString()),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.bI()}}else this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.bI()}$3i(I,V){this.errorCode=V;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.ro.Data=I);this.bI()}get description(){return"Run ExecuteRichApi Invocation Completed."}}
Object(h.a)(Bl,"ExecuteRichApiRequestMethod",Nf,[]);class Cl extends Nf{constructor(){super()}go(){this.ro={};this.Fq()}Fq(){const I=this.pDb.EWj();r.ULS.sendTraceTag(587747344,802,50,"GetAccessToken was called!");const V=(Ba,cb)=>{Ba===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(cb=cb.accessToken,this.ro[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=cb):(cb=this.Hd.g0.$W(this.controlId),r.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Ba.toString(),["appId"]:cb.qp.id,
["storeType"]:cb.qp.storeType}));this.ph=Ba;this.bI()};this.aNj.execute(Ba=>{const cb=this.Hd.Xi,Nb=tf.getInstance();gf.AppsForOfficeSingleSignOnManager.getInstance(cb,Ba,Nb).getAccessToken(this.controlId,I,this.parameters,V)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(Cl,"GetAccessTokenMethod",Nf,[]);class Th extends Nf{constructor(){super()}Fq(){let I=null;this.au&&(I=Microsoft.Office.WebExtension.ActiveView.Edit);I?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=
I,this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}Object(h.a)(Th,"GetActiveViewMethod",Nf,[]);var hi=d(1004);class Yk extends Nf{constructor(){super()}go(){this.ro={};this.Fq()}Fq(){var I=this.Oc.Xi.getOsfControl(this.controlId);if(!z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||I.isFirstParty()){I=I.getManifest();
var V=I.getMarketplaceID(),Ba=I.getWebApplicationId(),cb=I.getWebApplicationMsaId();ub.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(V).then(Nb=>{this.errorCode=0;const Ec={};Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Nb.upn;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Nb.userId;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ba;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=cb?cb:Ba;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=
Nb.authority;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=hi.a.c6f(Nb.authorityType);Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Nb.isAnonymous;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Nb.tenantId;Ec[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Nb.supportsAuthToken;this.ro[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ec;this.bI()},Nb=>{this.ph=1;this.ro[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=
Nb;this.bI()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)(Yk,"GetAuthContextMethod",Nf,[]);class cj extends Nf{constructor(){super()}go(){this.ro={};this.Fq();this.ph!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.bI()}Fq(){var I=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const V=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];I=this.Tda.z6f(I);!I||V*I.nGh>=I.fileSize?this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:
(nk.vOi(this.Hd.presentationId,this.controlId,I.s8d,V,I.nGh,Object(D.a)(this,this.q4b,"customizedOnFinished"),Object(D.a)(this,this.p4b,"customizedOnError")).start(),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}q4b(I,V){I?0===V.errorCode?(I=V.value,this.ro[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=I,this.ro[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=I.length,this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:
this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}p4b(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}get description(){return"Returns the specified slice."}}Object(h.a)(cj,"GetDocumentCopyChunkMethod",Nf,[]);class Am extends Nf{constructor(){super();this.Lfa=this.Lma=0}go(){this.ro={};this.Fq();this.ph!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.bI()}Fq(){try{const I=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];
this.Lfa=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.Lfa||4194304<this.Lfa)pe.a.J(17310339,802,50,"GetDocumentCopyMethod: Invalid slice size: "+this.Lfa),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(I){case 1:this.Lma=4;break;case 2:this.Lma=3;break;default:pe.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+I);this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.Tda.Jpg(this.controlId,
this.Lma)?this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.Tda.rEa.count>=this.Hd.LVd.rd.pptEditorAppForOfficeMaxDocumentReaders?this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.ljl.h4(!1,!0,()=>{this.wjl()},Object(D.a)(this,this.Qya,"saveFailureCallback")),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(I){pe.a.J(17310343,802,10,"Exception thrown at GetDocumentCopyMethod: "+I.toString()),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}wjl(){nk.wOi(this.Hd.presentationId,
this.controlId,this.Lma,this.Lfa,Object(D.a)(this,this.q4b,"customizedOnFinished"),Object(D.a)(this,this.p4b,"customizedOnError")).start()}Qya(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI();return!1}q4b(I,V){if(I&&I.length){I=V.format;var Ba=V.sliceSize,cb=V.errorCode;0===cb?(V=V.fileSize,this.ro[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=V,V=this.Tda.vyi(this.controlId,V,Ba,I),this.ro[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=V,this.ph=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ph=174===cb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:175===cb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}p4b(I,V){this.ph=V?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}get description(){return"Returns the entire document file in slices."}}
Object(h.a)(Am,"GetDocumentCopyMethod",Nf,[]);class Pl extends Nf{constructor(){super()}Fq(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const I=this.Sdj(),V=this.au.ljj(I);V&&(this.ro[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=V,this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(I){pe.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+I)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(Pl,
"GetDocumentThemeMethod",Nf,[]);class Dl extends Nf{constructor(){super()}Fq(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let I=null;if(this.au&&void 0!==(I=this.au.myb())&&null!==(I=this.au.myb())){var V={};V[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=I;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=V;this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}Object(h.a)(Dl,
"GetFilePropertiesMethod",Nf,[]);class ii{constructor(){this.context=null;this.errorCode=0}}Object(h.a)(ii,"NestedAppAuthContextResult",null,[]);class oh{static rpj(I,V){const Ba=new ii;(I=I.getOsfControl(V))&&I.isFirstParty()?(Ba.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,I={},V=z.AFrameworkApplication.fa.Ha("AADUserObjectId"),I.userObjectId=V?V:z.AFrameworkApplication.fa.Ha("HostUserId"),I.userPrincipalName=z.AFrameworkApplication.fa.Ha("UserPrincipalName"),I.tenantId=z.AFrameworkApplication.fa.Ha("TenantId"),
V=(z.AFrameworkApplication.fa.Ha("HostAuthType")||"").toLowerCase(),I.authorityType="aad"===V?"aad":"msa"===V?"msa":"other",Ba.context=I):Ba.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return Ba}}Object(h.a)(oh,"NestedAppAuthUtil",null,[]);class ok extends Nf{constructor(){super()}Fq(){const I=oh.rpj(this.Oc.Xi,this.controlId);I.errorCode==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.ro=I.context:this.ph=I.errorCode}get description(){return"Returns information needed by MSAL.js to authenticate."}}
Object(h.a)(ok,"GetNestedAppAuthContextMethod",Nf,[]);class ya extends Nf{constructor(){super()}Fq(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(ya,"GetOfficeThemeMethod",Nf,[]);class qd extends Nf{constructor(){super()}Fq(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.au)try{var I=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();I===
Microsoft.Office.WebExtension.CoercionType.SlideRange?(I=null,this.ph=({tll:I}=this.au.wuj()).returnValue,this.ro[OSF.DDA.WAC.UniqueArguments.Data]=I):I===Microsoft.Office.WebExtension.CoercionType.Text?(I=null,this.ph=({Zsc:I}=this.au.Auj()).returnValue,this.ro[OSF.DDA.WAC.UniqueArguments.Data]=I):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(V){pe.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+V.toString())}}get description(){return"Get data contained in the current selection of the document."}}
Object(h.a)(qd,"GetSelectedDataMethod",Nf,[]);class ea extends Nf{constructor(){super()}Fq(){var I=this.K$d();if(I){const V={};V.Settings=this.X9d(I.settings);this.ro[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=V;this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else I="AppForOffice instance could not be found for ID "+this.controlId+Ud.Debug.mu(),pe.a.J(8958160,802,10,I),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}X9d(I){const V=
{};let Ba=0;for(let cb in I)V[Ba.toString()]=[cb,I[cb]],Ba++;return V}}Object(h.a)(ea,"LoadSettingsMethod",Nf,[]);class Ok extends Nf{constructor(){super()}Fq(){r.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.pDb.zla()?(this.ph=Jd.instance.bta.kAk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[O.a.mKc],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.ph!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&
r.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",this.ph.toString())):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(Ok,"MessageParentMethod",Nf,[]);class kj extends Nf{constructor(){super()}Fq(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.au)try{const I=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],V=I[OSF.DDA.Marshaling.NavigationKeys.GoToType],
Ba=I[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.ph=V===OSF.DDA.Marshaling.GoToType.Index?this.au.SBj(Ba):V===OSF.DDA.Marshaling.GoToType.Slide?this.au.TBj(Ba):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(I){pe.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+I.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)(kj,"NavigateToMethod",Nf,[]);class Ek extends Nf{constructor(){super();this.uAe=0}go(){this.ro={};this.Fq();
this.ph!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.bI()}Fq(){this.uAe=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const I=this.Tda.z6f(this.uAe);I?(nk.RRf(this.Hd.presentationId,this.controlId,I.s8d,!1,!1,Object(D.a)(this,this.q4b,"customizedOnFinished"),Object(D.a)(this,this.p4b,"customizedOnError")).start(),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}q4b(I,V){I?0===V.errorCode?
(this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.Tda.$9k(this.uAe)):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}p4b(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.bI()}get description(){return"Closes the document file."}}Object(h.a)(Ek,"ReleaseDocumentCopyMethod",Nf,[]);class Uf extends Nf{constructor(){super();this.SIa=null}Fq(){var I=this.K$d();if(I){var V=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];
this.SIa=this.X9d(Array.isArray(V[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?V[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);V=null;I.taskpane&&(V=I.taskpane.ownerAddinSolutionId);var Ba;if(I.taskpane&&V)if(Ba=this.Hd.tEa(V)){this.au.XZe(Ba,this.SIa);if(Ba=this.Hd.g0.J$d(V))Ba.settings=this.SIa;I.settings=this.SIa;this.Hd.Baf(V,this.SIa);this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.GKc.Chg(V,this.SIa,this.Oc)?(I.settings=this.SIa,this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):
this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;else(Ba=0===I.jy?this.Hd.U1f(I.shape.slideId,I.shape.id):this.Hd.tEa(I.qp.id))?(this.au.XZe(Ba,this.SIa),I.settings=this.SIa,this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else I="AppForOffice instance could not be found for ID "+this.controlId+Ud.Debug.mu(),pe.a.J(9052994,802,10,I),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}X9d(I){const V=
{};if(I)for(let Ba=0;Ba<I.length;Ba++){const cb=Array.isArray(I[Ba])?I[Ba]:null;cb&&1<cb.length&&(V[cb[0]]=cb[1])}return V}}Object(h.a)(Uf,"SaveSettingsMethod",Nf,[]);class pl extends Nf{constructor(){super()}Fq(){this.pDb.zla()?(Jd.instance.bta.gml(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[O.a.mKc],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(pl,"SendMessageMethod",Nf,[]);class Zk extends Nf{constructor(){super()}Fq(){this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.au)try{const V=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var I=V.CoerceType.toString();const Ba=V[OSF.DDA.WAC.UniqueArguments.Data];if(I===Microsoft.Office.WebExtension.CoercionType.Text)this.ph=this.au.Jsl(Ba);else{let cb;if(I===Microsoft.Office.WebExtension.CoercionType.Image)cb=0;else if(I===Microsoft.Office.WebExtension.CoercionType.XmlSvg)cb=
1;else{this.ph=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}I=!1;let Nb=0,Ec=0,Oc=0,je=0;({sLj:I,x:Nb,y:Ec,width:Oc,height:je}=this.T4i(V,I,Nb,Ec,Oc,je));this.ph=this.au.BAh(Ba,I,Nb,Ec,Oc,je,cb,this.parameters[O.a.mKc])}}catch(V){pe.a.J(509112542,802,10,"Exception thrown at SetSelectedDataMethod: "+V)}}T4i(I,V,Ba,cb,Nb,Ec){const Oc=I[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],je=I[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==Oc&&null!==Oc&&"number"===typeof Oc&&void 0!==
je&&null!==je&&"number"===typeof je&&(V=!0,Ba=Oc,cb=je);I[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&(Nb=I[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);I[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Ec=I[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{sLj:V,x:Ba,y:cb,width:Nb,height:Ec}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(Zk,"SetSelectedDataMethod",Nf,[]);class Sf extends Mh{constructor(I){super(I)}lUk(){this.yic={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new ea);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new Uf);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Th);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new kj);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new qd);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new Dl);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new Pl);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new ya);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new Zk);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Am);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new cj);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Ek);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new Bg);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new Ok);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new pl);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new Cl);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Yk);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new Xk);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new Bl(this.Oc.Ihl,this.Oc.sXk,this.Oc.hO));this.set(OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod,()=>new ok)}}Object(h.a)(Sf,"EditorMethodFactory",Mh,[]);class bi extends Sys.EventArgs{constructor(I){super();this.h2h=I}get instanceId(){return this.h2h}}Object(h.a)(bi,"FirstPartyAddInHidingEventArgs",
Sys.EventArgs,[]);class qc{constructor(){this.dYa={};this.GBe={};this.xdd={};this.q$c={}}Iyf(I,V){V&&I&&(this.dYa[I]=V,this.q$c[I]=!1)}nei(I,V){I&&V&&(this.xdd[I]=V)}W9k(I){if(I){var V=this.dYa[I];V&&(delete this.xdd[V.qp.id],delete this.dYa[I],delete this.GBe[I],delete this.q$c[I])}}$W(I){return I?this.dYa[I]:null}Jmj(I){return I?this.q$c[I]:!1}wwj(I){return I?this.GBe[I]:null}rQh(I,V){I&&(this.q$c[I]=V)}kVl(I,V){I&&(this.GBe[I]=V)}J$d(I){if(!I)return null;const V=this.dYa;for(let Ba in V){const cb=
V[Ba];if(cb&&cb.qp.id.toLowerCase()===I.toLowerCase())return cb}return null}Ndj(I,V,Ba){if(!I||!V||!Ba)return null;const cb=this.dYa;for(let Nb in cb){const Ec=cb[Nb];if(Ec&&Ec.taskpane&&Ec.taskpane.ownerAddinSolutionId&&Ec.taskpane.ownerAddinSolutionId.toLowerCase()===I.toLowerCase()){const Oc=Ba.getOsfControl(Ec.instanceId);if(Oc&&Oc.getSharedRuntimeId()===V)return Ec}}return null}J9d(I){Uc.a.forEach(this.dYa,(V,Ba)=>{V=Object(ha.a)(668,Ba);1===V.jy&&I(V)},null)}q7i(I){const V=this.dYa;for(let Ba in V){const cb=
Object(ha.a)(668,V[Ba]);if(cb&&I(cb))return cb}return null}T1f(I){return I in this.xdd?this.xdd[I]:null}}Object(h.a)(qc,"OsfAppInstacneCache",null,[]);class ql{constructor(){}}Object(h.a)(ql,"AppForOfficeSDXDialog",null,[711]);class Kc{constructor(I,V,Ba,cb,Nb,Ec,Oc,je,De,Pd,Ke,xg,Gg,ph,qg,th,ci,Hf,Xh,bm,Qn,Sm,lg,Cm,Eg){this.g3b=!1;this.Odb=this.lfa=this.Vue=this.xyf=null;this.va=new M.a;this.DJg=!1;this.Yo=I;this.MO=V;this.EEe=new Sf(this);this.P6c=new ml(this,bm);this.MXa=Qn;this.sXa=cb;this.eBg=
{};this.mG=new qc;this.Aik=Ba;this.EDb=Nb.value;this.rA=Oc;this.Tb=Ec;this.E5=je;this.Rb=De;this.pik=ci;this.c$=Pd;this.Ib=Ke;this.ei=xg;this.ua=Gg;this.Ga=ph;this.lc=qg;this.ic=th;this.yec=Xh;this.Pdb=new jd;this.mik=Hf;this.wl=Sm;this.dkc=lg;this.Gjc=Cm;this.cqk=Eg}initialize(){this.W6(this.Rb.mode);this.Rb.MI(Object(D.a)(this,this.ohg,"handleModeSwitch"))}dispose(){this.Rb.WY(Object(D.a)(this,this.ohg,"handleModeSwitch"))}get GKc(){this.Pdb||(this.Pdb=new jd);return this.Pdb}get Xi(){if(!Kc.wva){this.Yo&&
(this.Yo.rd.DWj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new La),this.Ib.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new La,new Gh(this.Yo.rd.yg?z.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:z.AFrameworkApplication.fa.appSettings.WebServiceBase),this.Ib.ka("306")),OfficeExt.MosRequestHandler.init(new La),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new La));const I=new gg(this.EEe,
this.P6c);this.Odb=this.MF.HMi(this.mG);Kc.wva=this.Aik.sNi(this.MO,I,this.Odb);Kc.wva.setOAuthManager(this.cqk);Kc.wva&&"undefined"!==typeof Kc.wva.hostCheckReadyHandler&&z.AFrameworkApplication.Fii(Object(D.a)(Kc.wva,Kc.wva.hostCheckReadyHandler,"hostCheckReadyHandler"))}return Kc.wva}L$e(I){(I=this.Xi.getOsfControl(I))&&this.Odb&&this.Odb.W$g(I)}kJb(I,V){this.Odb.kJb(I,V)}ICb(I,V,Ba){this.Odb?this.Odb.Iak(I,V,Ba):r.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}$lb(I,V,Ba=null){const cb=
this.MF.N3(I);if(this.Ib.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Dvb(cb.storeType)))this.wl.wea(22)||this.wl.VDa(22);else if(0===cb.jy)this.sXa.AWj(cb.id)?(Ba=this.sXa.jsa[cb.id],ge.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.sXa.HLa(cb.id,this.P2e(I),V):(Ba.j0e(V),this.sXa.HLa(cb.id,this.P2e(I),null))):(I=this.evd(I,V),I.j0e(V),this.sXa.mjl(cb.id,I));else if(1===cb.jy){const Nb=cb.node.sa(Cd.a.q_,null);this.Oua(cb.id)?cb.Yng||this.MNb(Nb,!0):this.evd(I,V,Ba);this.Yo.rd.Gua&&
!cb.ownerAddinSolutionId&&(V=this.efe(cb.wya),this.Baf(cb.wya,V.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.lfa=new Dj;this.lfa.sj("",null,null);this.Xi.launchInsertDialog(this.lfa.ika)}Hak(I,V){I=this.lKc.v7b(I,V);this.Yo.kH().Ja(pc.a.Yje,2,{version:I.version,storeType:I.storeType,storeId:I.storeId,assetId:I.assetId,assetStoreId:I.assetStoreId,targetType:I.targetType,displayName:I.displayName,solutionId:I.solutionId,width:I.width,height:I.height});this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&(I={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)},V=new wa.a,V.name="Office.Extensibility.Host.InstallMRUAddinFromFlyout",V.dataFields=T.a.VI(I),ca.a.sendTelemetryEvent(V))}x5c(I){const V=this.Xi.getAppUILocale()||"en-US";this.Pzg=new hf(I,"wac_powerpoint",V,Ba=>{this.Yo.kH().Ja(pc.a.Yje,2,Ba);this.Pzg.hide();if(this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)){Ba={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba.solutionId,
Ba.storeType,Ba.assetId,null,null,Ba.storeId)};const cb=new wa.a;cb.name="Office.Extensibility.Host.InstallPopularAddinFromFlyout";cb.dataFields=T.a.VI(Ba);ca.a.sendTelemetryEvent(cb)}});this.Pzg.sj("",null,null);return!0}Vak(I){this.va.raiseEvent("OnInsertionDialogOpened");this.lfa=new Dj;this.lfa.sj("",null,null);if(I){const V={navigationMode:0};V.assetId=I;this.Xi.launchInsertDialog(this.lfa.ika,"{98143890-AC66-440E-A448-ED8771A02D52}",V)}else this.Xi.launchInsertDialog(this.lfa.ika)}Pwg(I){this.va.raiseEvent("OnInsertionDialogOpened");
this.lfa=new Dj;this.lfa.sj("",null,null);this.Xi.launchInsertDialog(this.lfa.ika,I,{navigationMode:0,assetId:null,category:null})}Ijg(){this.lfa&&this.lfa.hide()}tkb(I){const V=this.v2f(I);V?this.ash(V):r.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",I))}ash(I){const V=this.MF.N3(I);if(this.Ib.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Dvb(V.storeType)))this.wl.wea(22)||this.wl.VDa(22);else{var Ba=(cb,Nb)=>{const Ec=this.MF.N3(cb),
Oc=this.MF.OOc(z.AFrameworkApplication.isRtl,Ec.id,Ec.width,Ec.visibility);Nb.m_(Oc);let je=Nb=null;this.Yo.rd.Gua&&this.Yo.rd.w8j&&(je=this.qpd(I),Nb=()=>{this.eH(Oc,!0,!1);this.SQb(je)});this.$lb(cb,Oc.FKc,Nb);je&&(cb=this.HQ(je.qp.id).Rca,Oc.Vtl(cb));Oc.Zp(Ec.visibility)};if(this.Yo.rd.Gua){const cb=this.MF.N3(I),Nb={};Nb.solutionId=cb.wya;Nb.version=cb.version;Nb.storeType=this.Dvb(cb.storeType);Nb.storeId=cb.store;Nb.targetData=I;this.Xi.isAddinCommandsAsync(Nb,(Ec,Oc)=>{const je=this.qpd(I);
var De=I.sa(Vf.a.isForUILessAction,!1);const Pd=I.sa(Vf.a.sharedRuntimeId,null),Ke=cb.ownerAddinSolutionId,xg=!!je.tw&&0<je.tw.state&&!!je.tw.Pya;if(!Oc&&cb.visibility||Oc&&Ke&&!xg||De&&!H.a.Xa(Pd))Ba(I,this.rA),this.g0.rQh(cb.id,Oc);else if(Oc){if(De=this.F6b(cb.wya))je.settings=De.settings,this.au.XZe(I,je.settings);this.g0.Iyf(je.instanceId,je);this.g0.rQh(je.instanceId,Oc);this.Baf(je.qp.id,je.settings);if(cb.visibility&&this.c$.installVisibleAddinCommandsEnabled||xg){if("omex"!==Nb.storeType.toLowerCase()&&
!xg)return;let Gg=!1;this.uTe(ph=>{if(!ph[O.a.$li]){if(ph[O.a.NBf])for(const qg of ph[O.a.NBf])if(Gg=Rh.e(qg[1])===Rh.e(cb.wya))break;Gg||this.$Ic(je)}})}}Ec||pe.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",cb.wya,this.Dvb(cb.storeType))})}else Ba(I,this.rA)}}Qxb(I){return I&&I.assetId?I.sourceLocationOverrideResourceId?String.format("{0}.{1}",I.assetId,I.sourceLocationOverrideResourceId):I.assetId:null}Ddl(I){I.svb=-1;const V=this.hHf(I);this.cHb=new Ah(I.HQc,I.LQc,I.I4d);
void 0!=I.dialogLeft&&void 0!=I.K4b&&void 0!=I.dialogTop&&void 0!=I.I4b&&this.cHb.Uol(I.dialogLeft,I.K4b,I.dialogTop,I.I4b);void 0!=I.dialogHeight&&void 0!=I.dialogWidth&&this.cHb.Vol(I.dialogHeight,I.dialogWidth);this.cHb.sj(I.jka,null,null);this.evd(V,this.cHb.ika,null,I)}odl(I){I.svb=1;const V=this.hHf(I),Ba=this.MF.N3(V);if(z.AFrameworkApplication.L3c(Ba.wya)){const cb=this.MF.OOc(z.AFrameworkApplication.isRtl,Ba.id,Ba.width,Ba.visibility,I);this.rA.m_(cb);cb.Zp(Ba.visibility);this.evd(V,cb.FKc,
null,I)}}uTe(I){const V={};V.callback=I;z.AFrameworkApplication.Qa.Ja(pc.a.i0a,2,V)}$Ic(I){const V=this.MF.OOc(z.AFrameworkApplication.isRtl,I.instanceId,I.taskpane.width,I.taskpane.visibility);this.rA.m_(V);V.Zp(I.taskpane.visibility);const Ba=V.FKc;Object(ha.a)(667,this.MF.H1d(this.Yo.rd,I,Ba,z.AFrameworkApplication.isRtl,this)).$Ic(this.Xi,Ba,()=>{this.SQb(I);this.eH(V,!1,!!I.tw&&!!I.tw.Pya);t.a.instance.setItem(O.a.TUd,"true")})}eH(I,V,Ba){I.Zp(!1);Ba||(Kc.wva.purgeOsfControl(I.id,!1),V?this.Yo.kH().Ja(Ub.a.WZc,
2,I.id):this.P6c.nMf(I.id),I.dispose())}SQb(I){var V={};V.solutionId=I.qp.id;V.version=I.qp.version;V.storeType=I.qp.storeType;V.storeId=I.qp.store;V.assetId=null;V.assetStoreId=null;V.sharedRuntimeId=I.tw?I.tw.Pya:null;V.backgroundState=I.tw?I.tw.state:-1;I=new e.a;I.add(V);V={};V[O.a.gKc]=I;V[O.a.bsa]=3;this.Yo.kH().Ja(pc.a.v5c,2,V)}$Uc(){const I=this.E5.Gf;var V=null;I&&(V=new lb.GraphIterator,V.set(I),V=V.Db(18));return V}HQ(I){return I?(I=this.mG.J$d(I))&&I.taskpane?I:null:null}z8i(I,V,Ba,cb){if(!I||
!V||!Ba)return null;I=this.getSharedRuntimeId(V,cb,I.solutionId,Ba);return(Ba=this.mG.Ndj(Ba,I,this.Xi))&&Ba.taskpane?Ba:null}HTc(I){return I?(I=this.mG.$W(I))&&I.taskpane?I:null:null}tEa(I){if(!I)return null;var V=this.$Uc();if(V&&(V=this.Tb.Lc(V))&&V.Db(19)){do{const Ba=V.currentNode;if(this.G0b(Ba.sa(fe.a.qtb,null),I))return Ba}while(V.Pj(19))}return null}v2f(I){if(!I)return null;var V=this.$Uc();if(V&&(V=this.Tb.Lc(V))&&V.Db(19)){do{const Ba=V.currentNode;if(this.G0b(Ba.sa(Cd.a.q_,null),I))return Ba}while(V.Pj(19))
}return null}U1f(I,V){return(I=this.ic.Qk(I))?I.MQ(V):null}VVj(I){return I?this.mG.Jmj(I):!1}hui(I,V,Ba,cb,Nb){if(!I||!I)return null;let Ec;if(!(I.solutionId&&I.version&&I.storeId&&I.storeType))return r.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Ec=Object(ha.a)(Ob.a,this.EDb.createInstance(1074135137));Ec.setValue(fe.a.qtb,I.solutionId);Ec.setValue(fe.a.OKc,I.version);Ec.setValue(fe.a.NKc,I.storeId);Ec.setValue(Cd.a.n0b,this.zOc(I.storeType));Ec.setValue(fe.a.JKc,!1);Ec.setValue(Cd.a.q_,
Kf.a.create().toString());Ec.setValue(fe.a.GVd,"right");Ec.setValue(fe.a.q0b,Ba);Nb&&Ec.setValue(Vf.a.isForUILessAction,Nb);cb&&(Ec.setValue(Cd.a.Wfh,cb),(I=this.getSharedRuntimeId(V,Nb,I.solutionId,cb))&&Ec.setValue(Vf.a.sharedRuntimeId,I));return Ec}L$d(I){I=this.tEa(I);return this.qpd(I)}gui(I,V){if(!(I&&I&&I.solutionId&&I.version&&I.storeId&&I.storeType))return null;I=new Id(I.solutionId,I.version,I.storeId,I.storeType);V=V?new mc(0,V):null;return new Rc(I,null,null,null,null,{},1,V)}cRc(I){gf.AppsForOfficeSingleSignOnManager.CBi(I);
const V=this.mG.$W(I);V&&(Kc.wva.purgeOsfControl(V.instanceId,!1),this.P6c.nMf(V.instanceId),this.mG.W9k(V.instanceId),this.sXa.Uph(V.instanceId),this.MXa.Arc(this.presentationId,I,!1,!0))}notifyAgave(I,V){this.Xi.notifyAgave(I,V)}Z6k(I){!this.DJg&&I.hk&&(I=I.hk,I.zd(47).p8(Object(D.a)(this,this.VCf,"appDisposeHandler")),I.zd(10).p8(Object(D.a)(this,this.VCf,"appDisposeHandler")),this.DJg=!0)}VCf(I,V){I=V.node;V=1074135137===I.Xe;if(I.sa(Cd.a.nr,!1)||V)I=this.MF.N3(I),this.cRc(I.id)}hHf(I){var V;
const Ba=Object(ha.a)(9,this.EDb.createInstance(1074135137));Ba.setValue(fe.a.OKc,"1.0.0.0");Ba.setValue(fe.a.NKc,"en-US");Ba.setValue(Cd.a.q_,Kf.a.create().toString());Ba.setValue(fe.a.q0b,!0);Ba.setValue(Cd.a.zVd,null);Ba.setValue(Cd.a.TCf,null);Ba.setValue(fe.a.qtb,this.Qxb(I));(null!==(V=I.Uaf)&&void 0!==V?V:1)?(Ba.setValue(fe.a.o0b,"sdxcatalog"),Ba.setValue(Cd.a.n0b,this.zOc("sdxcatalog"))):(Ba.setValue(fe.a.o0b,"firstparty"),Ba.setValue(Cd.a.n0b,this.zOc("firstparty")));Ba.setValue(Cd.a.isAddinCommands,
!1);Ba.setValue(fe.a.JKc,!1);Ba.setValue(fe.a.GVd,"right");return Ba}qpd(I,V=null){if(!I)return null;I=this.MF.N3(I);var Ba=this.Dvb(I.storeType);const cb=new Id(I.wya,I.version,I.store,Ba);let Nb=null,Ec=null,Oc;if(-1==(null===V||void 0===V?void 0:V.svb))Oc=new ql;else if(0===I.jy)Nb=new Od(I.shapeId,I.slideId);else if(1===I.jy)Ec=new ba(I.MWf,I.visibility,I.width,I.row,I.ownerAddinSolutionId,I.ownerAddinStoreType,I.Yng);else return null;let je={};V&&OSF.OsfControl.isFirstPartyStoreString(Ba)?je=
OSF.OUtil.serializeSettings(V.nonPersistedSettings):I.ownerAddinSolutionId||(je=I.settings);Ba=I.V7a?new mc(I.Qtb,I.V7a):null;return new Rc(cb,I.id,Nb,Ec,Oc,je,Oc&&V?V.svb:I.jy,Ba)}Poh(I,V=null){if(this.Ib.ka("883")){var Ba=this.Xi.getOsfControl(I);if(Ba&&V){if(V.nonPersistedSettings){var cb=OSF.OUtil.serializeSettings(V.nonPersistedSettings);Ba.setSettings(cb);Ba.setHostSettings(cb)}V.cB&&(cb=Object(ha.a)(668,this.HTc(I)))&&(cb.Rca=V.cB,this.MNb(I,!0));Ba.refresh();this.L$e(I)}}}evd(I,V,Ba=null,
cb=null){const Nb=this.qpd(I,cb);if(!Nb||OSF.OsfControl.isFirstPartyStoreString(Nb.qp.storeType)&&!z.AFrameworkApplication.L3c(Nb.qp.id))return null;var Ec=this.MF.N3(I);if(this.Ib.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Dvb(Ec.storeType)))return this.wl.wea(22)||this.wl.VDa(22),null;cb&&cb.cB&&(Nb.Rca=cb.cB);Ec=Object(ha.a)(667,this.MF.H1d(this.Yo.rd,Nb,V,z.AFrameworkApplication.isRtl,this));this.mG.Iyf(Nb.instanceId,Nb);this.mG.nei(Nb.qp.id,V);cb&&cb.n6&&cb.n6();this.Yo.rd.Gua&&
Nb.taskpane&&Nb.taskpane.ownerAddinSolutionId&&(V=this.mG.J$d(Nb.taskpane.ownerAddinSolutionId))&&this.qPh(V.instanceId,Nb.instanceId);Ec.Fzl(this.Xi,this.P2e(I),Ba,cb,this.c$.powerPointDragInsertImageIsEnabled);Nb.taskpane&&Nb.taskpane.ownerAddinSolutionId||this.Z6k(I);return Ec}aKh(I){if(this.c$.n9j){const Ba=this.g0.$W(I);if(Ba&&0===Ba.jy&&Ba.shape){var V=this.g0.wwj(I);const cb=new Date;!V||cb.getTime()-V.getTime()>=this.c$.pptEditorAppForOfficeSnapshotIntervalTime?(r.ULS.sendTraceTag(512508173,
806,50,"Start to generate addin [{0}] {1} snapshot",Ba.qp.id,I),(V=this.pik.iQf(1,I))?(this.g0.kVl(I,cb),V.execute(this,this.mik,null)):r.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Ba?Ba.qp.id:"AppNotExist",I)):r.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",Ba?Ba.qp.id:"AppNotExist",I)}}}bch(I,V,Ba,cb){1===I&&this.OMk(V,Ba,cb)}OMk(I,V,Ba){let cb=null;Ba&&Ba.result&&(Ba=Ba.result,cb=Ba.substr(Ba.indexOf("base64,")+
7));const Nb=this.g0.$W(I);V===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&cb&&0<cb.length&&Nb?0===Nb.jy&&Nb.shape&&Nb.qp&&this.ei.JPh(Nb.shape.slideId.toString(),Nb.shape.id,cb,()=>{r.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",Nb.qp.id,I,cb.length)},()=>{r.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",Nb.qp.id,I);return!1}):r.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",
Nb?Nb.qp.id:"AppNotExist",I,cb?cb.length:0)}F6b(I){return I?this.eBg[I]:null}wJc(I,V){I&&V&&(this.eBg[I]=V)}get au(){this.Vue||(this.Vue=new vc(this.Yo.rd,ub.a.instance.resolve("Common.IAppSettingsManager"),this.MO,ub.a.instance.ue("Box4.IOutlineEditor"),ub.a.instance.ue("Box4.ISelectionManager"),ub.a.instance.ue("Box4.ICharacterPropertiesEditor"),ub.a.instance.ue("PowerPointWebEditor.IClassFactory"),ub.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.Yo.kH(),ub.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),
ub.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ub.a.instance.resolve("Common.ITaskManager"),ub.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),ub.a.instance.resolve("PowerPointWebEditor.ISlideReader"),ub.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),ub.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),ub.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),ub.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),ub.a.instance.resolve("PowerPointWebEditor.IShapeReader"),
ub.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),ub.a.instance.resolve("Box4.IOutlineElementNavigator"),ub.a.instance.resolve("Box4.IParagraphReader"),ub.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),ub.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.Vue}get Tda(){return this.MXa}s0a(I,V,Ba){this.P6c.I$d(I).raiseEvent(Ba,V)}Amh(I,V){this.mG.J9d(Ba=>{this.s0a(I,Ba.instanceId,V)})}qPh(I,V){if(I&&V){I=this.g0.$W(I);var Ba=this.g0.$W(V);
I&&Ba&&(Ba.settings=I.settings,this.gch(V,I.settings))}}Baf(I,V){I&&V&&this.g0.J9d(Ba=>{this.G0b(Ba.taskpane.ownerAddinSolutionId,I)&&!this.GKc.BWj(Ba.settings,V)&&(Ba.settings=V,this.gch(Ba.instanceId,V))})}ohg(I){this.W6(I.mode)}W6(I){if(1!==I&&2!==I)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",I));r.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===I?"Show":"Edit");this.sXa.W6(I);
this.rA.W6(I)}gch(I,V){const Ba=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.s0a(Ba,I,V)}Dvb(I){switch(I){case 0:I="spcatalog";break;case 1:I="filesystem";break;case 2:I="omex";break;case 3:I="spapp";break;case 4:I="registry";break;case 5:I="inmemory";break;case 6:I="uploadfiledevcatalog";break;case 7:I="excatalog";break;case 8:I="firstparty";break;case 9:I="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",I));}return I}zOc(I){if(!I)throw Error.create("Store Type should not be null.");
Kc.H6||Kc.UQj();if(I in Kc.H6)return Kc.H6[I];throw Error.create(String.format("[{0}] is not the valid store type.",I));}efe(I){return I?this.mG.q7i(V=>this.G0b(V.qp.id,I)):null}get LVd(){return this.Yo}Eji(I){this.va.addHandler("OnInsertionDialogOpened",I)}PJc(I){this.va.addHandler("OnFirstPartyAddInHidden",I)}Ebl(I){this.va.removeHandler("OnFirstPartyAddInHidden",I)}s1k(I){this.va.raiseEvent("OnFirstPartyAddInHidden",new bi(I))}G_d(I){const V=Rf.a.fqa(this.rA.u3,Ba=>Ba.id===I);if(1!==V.length)return!1;
this.eH(V[0],!0,this.Oua(I));return!0}MNb(I,V){const Ba=Rf.a.fqa(this.rA.u3,cb=>cb.id===I);1!==Ba.length?pe.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Ba.length):Ba[0].Zp(V)}Zcj(I){const V=Rf.a.fqa(this.rA.u3,Ba=>Ba.id===I);return 1!==V.length?(pe.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",V.length),!1):V[0].isVisible}BPl(I,V){const Ba=this.F6b(I);Ba&&Ba.tw&&Ba.tw.Pya&&(Ba.tw.state=V?1:0,(this.tEa(I)||this.GKc.Chg(I,Ba.settings,this))&&this.Yo.kH().Ja(Ub.a.tPh,
2,Ba))}$cj(I){return(I=this.F6b(I))&&I.tw?1===I.tw.state:!1}XMf(I){this.g0.J9d(V=>{this.G0b(V.taskpane.ownerAddinSolutionId,I)&&this.G_d(V.instanceId)})}Vxb(I){return this.mG.$W(I)}Oua(I){if(!I||4===this.Xi.getOsfControlStatus(I))return!1;I=this.Xi.getOsfControl(I);return!!I&&!!I.getSharedRuntimeId()}setInitialDisplayMode(I,V){(I=this.Xi.getOsfControl(I))&&I.setInitialDisplayMode(V)}getSharedRuntimeId(I,V,Ba,cb){if(!I)return null;const Nb=new bb;if(!Nb)return null;if(V)return I.getSharedRuntimeId(Nb.XT,
V,null);Ba=(new nd("",cb,Nb,!0)).jTf(Ba.substr(cb.length));return I.getSharedRuntimeId(Nb.XT,V,Ba)}V8i(I,V){const Ba={};Ba.visibility=V?"Visible":"Hidden";V=JSON.stringify(Ba);this.K2f(I,65539,"",V)}X8i(I,V,Ba){this.K2f(I,1,V,Ba)}nCl(I,V){I=new Id(I.solutionId,I.version,I.storeId,I.storeType);var Ba=new ba("right",!0,350,0,null,null,!1);I=new Rc(I,zh.a.create().toString(),null,Ba,null,{},1,null);const cb=this.MF.OOc(z.AFrameworkApplication.isRtl,I.instanceId,I.taskpane.width,I.taskpane.visibility);
this.rA.m_(cb);cb.Zp(I.taskpane.visibility);Ba=cb.FKc;Object(ha.a)(667,this.MF.H1d(this.Yo.rd,I,Ba,z.AFrameworkApplication.isRtl,this)).$Ic(this.Xi,Ba,()=>{this.eH(cb,!1,!1);V()})}K2f(I,V,Ba,cb){var Nb=Array(6);Nb[0]=65536;Nb[1]=V;Nb[2]=Ba;Nb[3]=cb;Nb[4]=-1;Nb[5]=!1;V=Array(1);V[0]=Nb;Nb=new Da(OSF.DDA.EventDispId.dispidRichApiMessageEvent,I,null,V);this.s0a(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),I,Nb)}G0b(I,V){return I&&V?I.toLowerCase()===V.toLowerCase():!1}P2e(I){return!this.Rb||
1!==this.Rb.mode||I&&"FA000000012"===I.sa(Cd.a.zVd,null)?1===this.MF.N3(I).jy?!0:this.Ga.wGa(I)?this.ua.Ba===this.lc.jg(I):!1:!1}get presentationId(){return this.Yo.tUa().presentationId}get aPf(){return this.sXa}get g0(){return this.mG}get MF(){return this.yec.value}get Ihl(){return this.dkc}get sXk(){return this.Gjc}get hO(){return this.ua}static UQj(){Kc.H6={};Kc.H6.inmemory=5;Kc.H6.uploadfiledevcatalog=6;Kc.H6.spcatalog=0;Kc.H6.omex=2;Kc.H6.registry=4;Kc.H6.spapp=3;Kc.H6.filesystem=1;Kc.H6.excatalog=
7;Kc.H6.firstparty=8;Kc.H6.sdxcatalog=9}get lKc(){return this.SUd}get SUd(){this.rKc&&!this.Pue&&(ge.a("Microsoft.Office.SharedOnline.AddinDetailsManagerConfigEnabled")?this.Pue=ij.createInstance(this.Ib,new jj.a(()=>this.Xi),{["AppsForOfficeAllowExternalMarketplace"]:this.c$.h1c,["AppsForOfficeThirdPartyIsDisabled"]:this.c$.FBb,["AreThirdPartyAddInsAllowed"]:this.c$.Tca,["PopularAddinDetailsJsonString"]:Kc.wKa}):this.Pue=ij.createInstance(new Sh.a({["AppsForOfficeAllowExternalMarketplace"]:this.c$.h1c.toString(),
["AppsForOfficeThirdPartyIsDisabled"]:this.c$.FBb.toString(),["AreThirdPartyAddInsAllowed"]:this.c$.Tca.toString(),["PopularAddinDetailsJsonString"]:Kc.wKa}),new jj.a(()=>this.Xi)));return this.Pue}get rKc(){return this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}dV(I,V){this.SUd&&this.SUd.dV(I,V)}static get wKa(){return'[{"displayName":"Pro Word Cloud","solutionId":"wa104038830","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Create beautiful word cloud images from your text","iconUrl":"65503.58165d84-0d6e-4545-a991-40ffee49b75a.9fa95f4f-0649-45b6-8ea9-b3b9e7611d90.2a84fadc-6e9a-4a27-a8c3-4c7a71e76546.jpeg","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://prowritingaid.com/art/245/Privacy-Policy.aspx","addinInfo":{"priority":2,"AUP":1,"downloadNumber":2924240}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":2,"AUP":1,"downloadNumber":5211012}},{"displayName":"Pickit | Make impactful presentations in minutes","solutionId":"wa104178141","version":"4.3.3.0","targetType":1,"width":0,"height":0,"description":"Unlimited access to licensed photos, clipart and your company\'s images in PowerPoint.","iconUrl":"52119.865d61ab-6329-4325-ab0d-d26b79dacfb7.7c9712b0-85a4-4901-839e-2ac101b87124.5e9898d6-d6c2-49a0-8098-1eb30d35701b.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickit.com/en/privacy-policy","addinInfo":{"priority":1,"AUP":1885,"downloadNumber":1159314}},{"displayName":"Poll Everywhere Presenter","solutionId":"wa104218073","version":"3.0.0.1","targetType":0,"width":960,"height":540,"description":"Gather audience responses via SMS or web, and display them instantly in gorgeous PowerPoint charts.","iconUrl":"27009.88b1aa30-f74d-43ab-b5f6-4565d9a70427.06bc2362-a830-44c4-84e3-f5b99c45acf8.47ba58ff-e53f-4c3e-bea2-3aa7562d1cc6.png","licenseUrl":"https://www.polleverywhere.com/terms","privacyUrl":"https://www.polleverywhere.com/privacy-policy","addinInfo":{"priority":2,"AUP":1495,"downloadNumber":682480}},{"displayName":"Web Video Player","solutionId":"wa104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":947,"downloadNumber":331140}},{"displayName":"Web Viewer","solutionId":"wa104295828","version":"1.9.0.0","targetType":0,"width":960,"height":540,"description":"Take it to the web! Insert a secure webpage into your presentation.","iconUrl":"53665.f48f5d64-1b9c-4db4-8579-0a8a770cc1df.479bd539-f5d1-4edd-8d3f-fd2aa12fe078.d7ba8494-d2ee-426a-985a-25a7db9bf8f5.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949675993/Asset_901070fc-4837-4edc-83b0-b3438f2ddf97/OfficeMixEULA.docx","privacyUrl":"https://aka.ms/mixaddinprivacy","addinInfo":{"priority":2,"AUP":2439,"downloadNumber":5015403}},{"displayName":"Mentimeter - Interactive Presentations","solutionId":"wa104379261","version":"3.0.2.4","targetType":0,"width":1000,"height":700,"description":"Engage your audience with fun and interactive presentations, visualizing their opinions in real-time","iconUrl":"51223.47e20eb4-286a-415c-a7c6-a30d8aaf5dd8.bb9bb1df-e506-4b71-82d1-44c6d0de3876.92bae303-c177-4756-a889-8da8fce426e2.png","licenseUrl":"https://www.mentimeter.com/terms","privacyUrl":"https://www.mentimeter.com/privacy","addinInfo":{"priority":1,"AUP":3793,"downloadNumber":4298337}},{"displayName":"LessonPix Symbols","solutionId":"wa104379370","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access your LessonPix Account and over 50K clipart symbols from within Microsoft Office.","iconUrl":"52104.453267e0-c2e7-43b0-b9d8-1a14024ce16f.bf27c658-00f3-4406-81ca-374c6f1bd24b.9ef3504f-30b7-4fd3-b135-7931280a8d74.png","licenseUrl":"https://lessonpix.com/articles/11/299/LessonPix%20Office%20Add-In%20Terms%20and%20Conditions","privacyUrl":"https://lessonpix.com/articles/11/26/LessonPix+Privacy+Policy","addinInfo":{"priority":1,"AUP":350,"downloadNumber":8447}},{"displayName":"Pexels - Free Stock Photos","solutionId":"wa104379997","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Get great looking free stock photos for your documents and presentations.","iconUrl":"42183.883a975e-b768-42b6-804b-7440e32d8a14.594bab1e-71b2-4309-b08a-27d3d8832a91.9373d154-174d-40db-873f-11b8a2e636a4.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://officeconsult.no/en/pexels-office-add-in/#privacy","addinInfo":{"priority":1,"AUP":412,"downloadNumber":601175}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":795,"downloadNumber":525805}},{"displayName":"Emoji Keyboard","solutionId":"wa104380121","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Emoji for Microsoft Word, PowerPoint and OneNote","iconUrl":"59740.f26acde8-b516-46ad-8220-2984e6945380.2f899a00-04c7-483e-9ee2-e1b35c2b080f.12545571-342a-4850-b117-43d02783ed9d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://emoji.patbu.xyz/#/privacy","addinInfo":{"priority":1,"AUP":591,"downloadNumber":319195}},{"displayName":"Templafy Company Templates","solutionId":"wa104380278","version":"1.0.0.6","targetType":1,"width":0,"height":0,"description":"Access best practice professional templates and digital assets within your Office applications","iconUrl":"39478.da1eadf9-2005-4a37-9f41-d99acc46197e.5e0830db-920f-4070-b60e-bbd8de8c498c.6e4a303a-5acd-4946-9a57-53715948ec92.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.templafy.com/privacy","addinInfo":{"priority":3,"AUP":110,"downloadNumber":25675}},{"displayName":"PickMe - Presentation images","solutionId":"wa104380510","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Search and add images, photos, icons and background images for your best presentation.","iconUrl":"45844.d6cd8bac-3b6d-45dc-8fbe-6307d6477d25.c4010abd-54d6-4345-be6e-fb8cdb8f926e.2095bcd7-d785-46dd-9472-c95cceb628d2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pickme.gettyimagesbank.com/guide/Privacy/privacy_policy","addinInfo":{"priority":3,"AUP":1,"downloadNumber":14098}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":3,"AUP":685,"downloadNumber":3103601}},{"displayName":"officeatwork | Content Chooser for Office","solutionId":"wa104380602","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared content in Word, Excel, PowerPoint, Outlook, Browser, and other Apps.","iconUrl":"21517.8509aff9-edc8-4f6a-8b59-4b406996c84a.d1a19980-7c71-4be1-8215-82ff5834af8f.fa526dd8-ee50-4045-add0-21357070c87b.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":3,"AUP":379,"downloadNumber":300574}},{"displayName":"PP Timer","solutionId":"wa104380667","version":"3.0.0.1","targetType":0,"width":640,"height":480,"description":"Insert a timer into your PowerPoint presentation. Add an analog or digital timer into your slide.","iconUrl":"34537.0bb60981-b391-4645-8398-65b19c9df09a.571de747-edd5-4568-9dd0-072bcf87df09.69ce727f-55eb-405a-9470-668ccee0d6fc.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://pp-timer.com/privacy-policy","addinInfo":{"priority":1,"AUP":8,"downloadNumber":1681399}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":305,"downloadNumber":177312}},{"displayName":"Pixton Comic Characters","solutionId":"wa104380907","version":"3.1.0.0","targetType":1,"width":0,"height":0,"description":"Add illustrated, posable comic characters to your training or educational presentations.","iconUrl":"29860.e57c0b3f-b9bb-4ebd-b4e4-8b64b797db43.8ed21d66-e83f-4ec7-98e4-f637d866c239.755b4296-081d-4793-8eb5-ed82118043d8.png","licenseUrl":"https://www.pixton.com/terms-of-use/addons","privacyUrl":"https://www.pixton.com/privacy-policy/addons","addinInfo":{"priority":1,"AUP":1485,"downloadNumber":1043265}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":211,"downloadNumber":149144}},{"displayName":"Icons by Noun Project","solutionId":"wa104381063","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Over 1 million high-quality icons to choose from, perfect for presentations.","iconUrl":"43800.2d301a6f-7f58-486a-aa28-60900de38763.afe578dd-fbdd-497d-b1e4-66a6217bfb17.c7c39ea5-5370-437d-8e9d-f9fe1fa77b09.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://thenounproject.com/legal/#!privacy-policy","addinInfo":{"priority":1,"AUP":318,"downloadNumber":218656}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint","solutionId":"wa104381155","version":"1.1.1.0","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"31139.c4694bde-161e-42b4-8b8f-87f0c1b5010e.4a78185a-5a69-438c-99c2-80f85f7092a3.39897ffc-7ed4-4e29-bd29-b748bc14ae57.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":2,"AUP":3852,"downloadNumber":5854335}},{"displayName":"IconScout - Icons, Illustrations & 3D Assets","solutionId":"wa104381411","version":"2.4.1.0","targetType":1,"width":0,"height":0,"description":"Seamlessly access over 4.5 Million+ Design assets within Microsoft Office Applications","iconUrl":"36684.41fa480b-3128-4253-a7ae-3e7c1406bfb6.07fc268d-eaaa-4f81-b6b3-911c8b2d104d.5b4a7a13-0f35-4b05-a07e-7b5c347ad154.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://iconscout.com/legal/privacy-policy","addinInfo":{"priority":1,"AUP":645,"downloadNumber":71152}},{"displayName":"Ubi Timer","solutionId":"wa104381448","version":"1.0.0.8","targetType":0,"width":348,"height":720,"description":"Add a customisable timer to your PowerPoint presentation slides.","iconUrl":"8460.b2044bd4-1b25-41e3-9810-3564d9472171.804e0d26-99a8-4b72-a103-49327a1a30b8.f01fef0d-5053-4e80-b246-34524e7c5f69.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ubicompsolutions.co.uk/timer_privacy","addinInfo":{"priority":3,"AUP":84,"downloadNumber":37025}},{"displayName":"Forms","solutionId":"wa104381526","version":"1.0.0.2","targetType":0,"width":800,"height":450,"description":"Embed surveys, quizzes, and polls directly into a PowerPoint slide.","iconUrl":"3597.3f744035-7cc5-4b23-9aea-1e7380b37172.42f8397f-a77f-48a3-a506-4032a34b3bf7.14bf7247-1539-4086-9824-7fe176221f3d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?linkid=871815","addinInfo":{"priority":1,"AUP":6617,"downloadNumber":16064476}},{"displayName":"Wooclap","solutionId":"wa104381682","version":"1.0.0.5","targetType":0,"width":900,"height":500,"description":"With its many features and intuitive use, Wooclap turns events into interactive and dynamic learning","iconUrl":"13441.9fb6980a-f99b-4bf1-9d44-82fefa4843e1.4d33dfef-862e-473d-bfb1-2bdabc490da8.e1403f2d-3a83-46a6-8215-0a1020f33bbc.png","licenseUrl":"https://www.wooclap.com/en/terms-of-service","privacyUrl":"https://www.wooclap.com/en/privacy-policy","addinInfo":{"priority":2,"AUP":935,"downloadNumber":4539455}},{"displayName":"MathType","solutionId":"wa104381909","version":"3.5.1.0","targetType":1,"width":0,"height":0,"description":"Write math equations and chemical formulas in your documents and presentations with MathType.","iconUrl":"44741.813eee75-3ca3-4574-8852-d4a1ee5fd6fb.a6600903-ad52-41cc-a277-a99d413f741b.18009730-067c-46f9-a8f7-539cd53cbd6b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.wiris.com/en/mathtype-privacy-policy","addinInfo":{"priority":1,"AUP":1672,"downloadNumber":4062279}},{"displayName":"EasyTimer","solutionId":"wa104382064","version":"1.0.0.2","targetType":0,"width":1000,"height":600,"description":"An easy-to-use timer for your PowerPoint presentations.","iconUrl":"17586.18a4e21f-e685-4cd1-910e-2b2e032b01ff.5f21673c-f2a3-4710-8cdc-532e6d7a4f45.baa310be-ee05-44be-8e2b-1373024798f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://lixiaoooowei.github.io/TimerLab/Home/PrivacyPolicy.html","addinInfo":{"priority":2,"AUP":1364,"downloadNumber":1063634}},{"displayName":"Pear Deck Add-in","solutionId":"wa200000094","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Add formative assessments and interactive activities to lessons and presentations","iconUrl":"59452.62af3df0-63ba-40f1-83d3-a0bc16189b66.26661aad-7dc8-4f47-a9d9-3aa9c939d106.e9f66df9-6115-41f5-8721-fab23ac9b3a8.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.peardeck.com/privacy-policy","addinInfo":{"priority":2,"AUP":9847,"downloadNumber":2600980}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":783,"downloadNumber":992110}},{"displayName":"Adobe Creative Cloud for Word and PowerPoint","solutionId":"wa200000729","version":"3.19.222.0","targetType":1,"width":0,"height":0,"description":"Bring your creative elements into Microsoft Office. Creative Cloud app is required for this add-in.","iconUrl":"18500.2f664073-3b83-4944-804c-69c30f0e9064.600364c5-532a-4bb4-8ea4-627757d016c6.9c5597d2-2156-401e-8697-18cb65b7c13c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.adobe.com/go/privacy-policy","addinInfo":{"priority":2,"AUP":681,"downloadNumber":1506340}},{"displayName":"Present Pal add-in - Presentation Support","solutionId":"wa200001313","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Control your slideshow directly from the Present Pal app to make presenting easy and accessible!","iconUrl":"26522.34e9b858-f1e6-4aa8-b47f-dfb0c9224869.2f9ca7d4-7141-4377-bde9-adcb55b44237.6092b85f-1084-427b-a1ec-55b33b8ee41f.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://presentpal.co.uk/privacy-policy","addinInfo":{"priority":3,"AUP":96,"downloadNumber":108511}},{"displayName":"Premast Plus","solutionId":"wa200001396","version":"4.1.3.0","targetType":1,"width":0,"height":0,"description":"Use Premast plus features and professional templates to design better presentation, faster. Without ","iconUrl":"62947.925c188e-dab2-4231-acfb-60d131eb7da4.132d74f0-1c13-48eb-b8f5-fcec0b139825.1b91bd7f-2be5-430e-a33c-2016eb52f79a.png","licenseUrl":"https://premast.com/plus-terms-of-use","privacyUrl":"https://premast.com/privacy-policy","addinInfo":{"priority":1,"AUP":103,"downloadNumber":37282}},{"displayName":"Slides365 - Build Professional Presentations Yourself","solutionId":"wa200001409","version":"1.0.0.3","targetType":1,"width":0,"height":0,"description":"Guided storytelling using pre-built Templates, Industry Domain Slides, Design Slides and Icons","iconUrl":"10382.5c0bebe6-0d6f-40c0-88ff-4bcc1c0a3acb.9a0fd746-d03b-42f5-8b9f-1eced5547c82.1b9b795d-9337-411d-be6b-fd064ef3dec8.png","licenseUrl":"https://slides365.com/Terms.html","privacyUrl":"https://slides365.com/Privacy-Policy.html","addinInfo":{"priority":2,"AUP":124,"downloadNumber":42358}},{"displayName":"SlideHub","solutionId":"wa200001625","version":"1.0.0.7","targetType":1,"width":0,"height":0,"description":"Helps SlideHub users build better presentations faster via various tools and an on-demand service ","iconUrl":"28341.df79b07c-0691-4db6-9851-8b81eaa9f482.805bbb88-2bbf-4a63-9d09-d9c6ebedfc46.339597b4-5e8a-4295-8925-ed11ad30fbc1.png","licenseUrl":"https://slidehub.io/eula","privacyUrl":"https://slidehub.io/privacy","addinInfo":{"priority":2,"AUP":1735,"downloadNumber":12877}},{"displayName":"Breaktime","solutionId":"wa200001661","version":"2.1.0.2","targetType":0,"width":800,"height":600,"description":"A quick way to tell everyone when you\'ll be back, because it\'s Breaktime!","iconUrl":"53429.790a3023-92b3-4c27-bd32-62a1ac84d552.c35b1205-7b21-4321-84c7-9708e97de568.4d0318b8-f51d-4eef-ae55-3c20fb66521e.png","licenseUrl":"https://www.flosim.com/breaktime/EULA.html","privacyUrl":"https://www.flosim.com/breaktime/Privacy_Policy.html","addinInfo":{"priority":1,"AUP":3240,"downloadNumber":3146674}},{"displayName":"Canto Connector","solutionId":"wa200001766","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Simplify how you add images and brand elements to Word and PowerPoint from your Canto image library.","iconUrl":"7869.c66666c2-edf3-4109-955b-4b8dcefb734e.39d11081-f25d-4285-9427-84ecd59deb0a.d2b7f5df-5a3f-4755-a8a6-9c5dd4a750dc.png","licenseUrl":"https://team.canto.com/b/Q9GTF","privacyUrl":"https://www.canto.com/privacy-policy","addinInfo":{"priority":3,"AUP":32,"downloadNumber":52636}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":2,"AUP":1456,"downloadNumber":948014}},{"displayName":"Kahoot! for PowerPoint","solutionId":"wa200002908","version":"1.1.0.0","targetType":0,"width":800,"height":480,"description":"Host kahoots within PowerPoint and make presentations awesome! ","iconUrl":"5821.dc651664-7ea2-4fed-b845-27e926a3bf3f.29a4cdf3-8814-4a22-b5b3-c79c432e8b0f.0c3e5c0c-62fb-4d25-8518-3bf537f62cd0.png","licenseUrl":"https://trust.kahoot.com/terms-and-conditions","privacyUrl":"https://trust.kahoot.com/privacy-policy","addinInfo":{"priority":1,"AUP":563,"downloadNumber":4724708}},{"displayName":"RRSlide Library","solutionId":"wa200003157","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"We supply PowerPoint templates, infographics, charts, 3D icons, etc. to make a quick presentation","iconUrl":"27146.0ffbcab3-3f86-4d90-847e-e9e416c2f04d.1ada7438-24b1-4363-861f-4f3235e1fe56.1c5b196a-7fe5-49ea-ad4c-a502150e70e9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://rrslide.com/privacy-policy","addinInfo":{"priority":2,"AUP":150,"downloadNumber":37950}},{"displayName":"Personalised QR Code Generator","solutionId":"wa200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":179,"downloadNumber":203447}},{"displayName":"Microsoft Power BI","solutionId":"wa200003233","version":"2.0.0.3","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.68115a5f-13b5-4260-9fe9-b6c37e561377.e47b03c9-a5b9-4b5b-97be-affb2ee9bff5.82fc138b-c424-4039-b098-8fdbd0d76965.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":43414,"downloadNumber":23707798}},{"displayName":"Microsoft Power BI Beta","solutionId":"wa200003251","version":"2.0.0.4","targetType":0,"width":960,"height":570,"description":"Enhance storytelling with data by easily including Power BI reports into your presentation.","iconUrl":"44848.e29569b7-a73e-472a-906f-7d3d7b5b56d0.6c0dd532-76c1-4565-a1f0-e5e8d45f1138.f53a6d02-633b-4da5-a56f-f804e844a2a0.png","licenseUrl":"https://docs.microsoft.com/en-us/dynamics365/legal/apps-for-power-platform-tou","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":250,"downloadNumber":6885}},{"displayName":"Showmaster (Helper Plugin)","solutionId":"wa200003676","version":"1.0.0.0","targetType":0,"width":957,"height":538,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.cc4515b5-7941-4c49-8152-a4da1dceef8d.f2ec1037-3774-4e94-a41a-f9e6432611d8.b9e80121-ccc1-40f9-b6f7-3430a31b50fc.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":156,"downloadNumber":22550}},{"displayName":"Showmaster","solutionId":"wa200003706","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Impress with remarkable animations, countdown and music before your presentation.","iconUrl":"38182.e0b83de2-8341-4aaf-a8da-e9a86c1dfdd3.e729953e-7bb6-4556-8a33-55c83e572918.0fe180b8-8511-42ae-b526-0796e91fbee1.png","licenseUrl":"https://showmaster.app/terms","privacyUrl":"https://showmaster.app/privacy","addinInfo":{"priority":3,"AUP":75,"downloadNumber":27278}},{"displayName":"PresenterMedia | Thousands of Animations, Templates, and Designs at your Fingertips","solutionId":"wa200003891","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Insert customized graphics, templates and videos directly into your presentation.","iconUrl":"37569.30ec0671-d417-4ae9-8009-4cee496ea074.3b3c120c-ea56-4a82-a3c1-82e4591f6140.e03fae66-8132-4071-a176-963a53dd2798.png","licenseUrl":"https://www.presentermedia.com/addin_terms_of_use","privacyUrl":"https://www.presentermedia.com/privacy_policy","addinInfo":{"priority":3,"AUP":109,"downloadNumber":17025}},{"displayName":"Read on reMarkable","solutionId":"wa200003915","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily send Word and PowerPoint documents to your reMarkable.","iconUrl":"7364.f24d322e-3985-4b36-9f2b-d1a92a90534c.43df7b3a-e5a9-4d72-ad4c-53ba599d45c7.1c530b09-8be4-40d7-878f-1bacd2fd0bce.png","licenseUrl":"https://support.remarkable.com/hc/en-us/articles/360000282757-reMarkable-End-User-License-Agreement","privacyUrl":"https://support.remarkable.com/hc/en-us/sections/360000090338-Privacy-Policy","addinInfo":{"priority":2,"AUP":250,"downloadNumber":271987}},{"displayName":"Adobe Acrobat Sign for Microsoft Word and PowerPoint - Government","solutionId":"wa200003944","version":"1.1.0.1","targetType":1,"width":0,"height":0,"description":"Do business faster with Adobe Acrobat Sign for Word and PowerPoint.","iconUrl":"36564.aa7b92f6-ad15-4d7f-9951-1891d6c9b744.bab76294-ed68-4ac6-b148-791343322826.105c41f6-ff06-4b30-8a37-a9168d40cfee.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":2,"AUP":3813,"downloadNumber":1223}},{"displayName":"beautiful.ai | AI powered slide templates","solutionId":"wa200003964","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Create beautiful presentations faster with AI powered slide templates","iconUrl":"5525.df072342-580e-437e-9d68-96615f75b68a.7429d240-ba6f-4dc1-b122-5ce6e89e8b49.50a5f98b-bd54-446f-a983-3d56cf4f16ca.png","licenseUrl":"https://www.beautiful.ai/terms-of-service","privacyUrl":"https://www.beautiful.ai/privacy-policy","addinInfo":{"priority":1,"AUP":157,"downloadNumber":39188}},{"displayName":"Project Plan","solutionId":"wa200004643","version":"1.0.0.3","targetType":0,"width":957,"height":538,"description":"Visualize your project plans and roadmaps right in PowerPoint and Excel.","iconUrl":"48512.5fa6879a-44fb-480a-8848-5280995a049e.88d32693-93e0-4681-93a8-a59ee99f893b.c488f1bf-ea9e-4e56-9711-4a5a41a432c4.png","licenseUrl":"https://www.projectplan-powerpoint.com/terms","privacyUrl":"https://www.projectplan-powerpoint.com/privacy","addinInfo":{"priority":1,"AUP":192,"downloadNumber":20986}},{"displayName":"Vevox for PowerPoint (BETA)","solutionId":"wa200004709","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Include Live Polls and interaction in PowerPoint presentations with the #1 rated polling platform.","iconUrl":"30836.b99a2c67-c0f9-4608-ab59-33f5dab5dffa.3c46736f-fe0e-4dad-b17e-edb4bd558f68.7ecef1a1-72c6-4083-afb1-715afe5fb27c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.vevox.com/terms-conditions#PrivacyPolicy","addinInfo":{"priority":1,"AUP":251,"downloadNumber":274040}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":14,"downloadNumber":54328}}]'}xpl(I,
V=null){if(this.Xi.getOsfControl(I)&&V){if(V.cB){const Ba=Object(ha.a)(668,this.HTc(I));Ba&&(Ba.Rca=V.cB)}this.L$e(I)}}}Kc.H6=null;Kc.wva=null;Object(h.a)(Kc,"AppForOfficeManager",null,[669,108,670]);class Of{constructor(I,V,Ba){this.iR=I;this.kHg=V;this.Tb=Ba}register(){this.kHg.gk(Object(D.a)(this,this.eDf,"appSettingChangedEventHandler"))}dispose(){this.kHg.Qm(Object(D.a)(this,this.eDf,"appSettingChangedEventHandler"))}eDf(I,V){I=V.node;V=V.property;try{if(1074135139===I.Xe&&V===fe.a.MKc){V=null;
var Ba=this.Tb.Lc(I);Ba.rc(47)||Ba.rc(10);Ba.Cc();this.moe(Ba.currentNode)&&(V=new Sc.a(Ba.currentNode));var cb=V.settings;ge.a("RefreshAppSettingsValue")&&(this.iR.Vxb(V.id).settings=cb);this.iR.s0a(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),V.id,cb)}}catch(Nb){r.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",Nb)}}moe(I){if(!I)return!1;const V=Object(ha.a)(4,I);return 1074135137===I.Xe||!!V&&V.nr}}Object(h.a)(Of,"AppForOfficeSettingChangedEventListener",
null,[662,108]);class nj{constructor(I,V,Ba){this.iR=I;this.mAg=V;this.Tb=Ba}register(){for(const I of this.mAg)I.KF(Object(D.a)(this,this.fDf,"appSettingCreatedEventHandler"))}dispose(){for(const I of this.mAg)I.vP(Object(D.a)(this,this.fDf,"appSettingCreatedEventHandler"))}fDf(I,V){I=V.node;try{if(this.moe(I)&&21===V.HW){this.Tb.Lc(I).B9b()||r.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const Ba=new Sc.a(I),cb=Ba.settings;this.iR.s0a(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),
Ba.id,cb)}}catch(Ba){r.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Ba)}}moe(I){if(!I)return!1;const V=Object(ha.a)(4,I);return 1074135137===I.Xe||!!V&&V.nr}}Object(h.a)(nj,"AppForOfficeSettingCreatedEventListener",null,[662,108]);class Hj{constructor(I,V){this.ia=I;this.Ur=V}register(){this.Ur.gk(Object(D.a)(this,this.nKh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Ur.Qm(Object(D.a)(this,this.nKh,"taskpaneAppCreatedEventHandler"))}nKh(I,V){if(I=V.node)I=
new Sc.a(I),V.property.id===Cd.a.q_.id&&1===I.jy&&(V=V.node.sa(Cd.a.q_,null))&&this.ia.Ja(Ub.a.tkb,2,V)}}Object(h.a)(Hj,"AppForOfficeTaskpaneAppCreatedEventListener",null,[662,108]);var Xf=d(659),$l=d(540),kg=d(914),Rm=d(915);class oi{constructor(I,V,Ba,cb,Nb){this.iR=I;this.Yo=V;this.Rb=Ba;this.mG=cb;this.rA=Nb}register(I){I.controlStatusChanged=Object(D.a)(this,this.W$g,"onControlStatusChanged");I.notifyHost=Object(D.a)(this,this.hch,"onOsfNotifyHost")}W$g(I){let V=this.mG.T1f(I.getSolutionId());
const Ba=this.mG.$W(I.getID());Ba&&Ba.qp&&I.isFirstParty()&&(V=this.mG.T1f(Ba.qp.id));if(V&&Ba&&V.previousSibling){var cb=I.getSolutionId(),Nb=I.getVersion(),Ec=null,Oc=null;Oc=I.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(cb,""):OSF.OsfManifestManager.getCachedManifest(cb,Nb);I.isFirstParty()&&Ba.Rca?Ec=Ba.Rca:Oc&&(Ec=Oc.getDefaultDisplayName(),Ba.Rca=Ec);if(0!==Ba.jy&&-1!==Ba.jy){Nb=null;Oc&&(Nb=Oc.getDefaultIconUrl());Oc=Object.assign(new kg.a,{getContent:()=>V,type:"LegacyTaskPaneProps"});
var je=Object.assign(new Xf.a,{title:Ec,hideHeader:!0,iconUrl:Nb,width:320,location:2,contentProps:Oc,onOpen:()=>{},onClose:()=>{},isModernPane:!0});this.Yo.rd.X2c&&(null===Ba||void 0===Ba?0:Ba.settings)&&Rm.a.mqg(Ba.settings)&&(je.hideHeader=!1,je.contentProps=Rm.a.rkj(Ba.instanceId,Ba.settings,Oc));mb.UISurfaces.Iq().then(De=>{const Pd=I.getID();De.updateTaskPane(Pd,je);return null}).catch(()=>{pe.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",cb)});V.previousSibling&&(V.previousSibling.innerText===
Ec||!I.isFirstParty()&&""!==V.previousSibling.innerText)||!Ec||!Ba.taskpane||Ba.taskpane.isForUILessAction||(V.previousSibling.innerText=Ec,this.Rb.dbb())}}}Iak(I,V,Ba){this.hch(I,V,Ba)}get rKc(){return this.Yo.rd.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}Zpi(I,V){return Ee.a.Gk().equals(I.solutionId,V.solutionId)&&Ee.a.Gk().equals(I.storeType,V.storeType)}hch(I,V,Ba){3===V?(this.iR.Ijg(),this.rA.wf(Ff.a.lF),Ba?(this.kJb("InsertAgave",Ba),this.Yo.kH().Ja(Ub.a.$_c,
2,Ba)):r.ULS.sendTraceTag(512360769,806,10,"InsertAgave: should have valid insert agave parameters")):41===V?this.kJb("ClickTrust",Ba):40===V?this.rKc&&this.GDe&&Ba&&this.Zpi(this.GDe,Ba)&&Ba.storeType&&(r.ULS.sendTraceTag(509669715,220,50,"AgaveHostAction.OsfControlLoad: the loadedAgaveParams' PrivacyCompliantId: {0}",oi.r4(Ba)),this.GDe=void 0,this.iR.dV(Oa(Ba.storeType))):36===V?Ba?this.Yo.kH().Ja(Ub.a.$_c,2,Ba):r.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):
37===V?Ba&&(I=Object(ha.a)(Object,Ba),I={["ak1"]:this.iR.Xi.getDevManifestInvalidUrlErrorString(I.manifestUrl)},this.Yo.kH().Ja(pc.a.bPb,2,I)):2===V?this.iR.Ijg():9===V?this.Yo.rd.Gua&&this.Yo.rd.Vng&&this.Yo.kH().Ja(pc.a.TVe,2,Ba):5===V||6===V?(Ba=this.mG.$W(I))?0===Ba.jy?this.rA.g9e(V):this.rA.u$i(I,V):r.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",I)):13===V||14===V?(Ba=this.mG.$W(I))?0===Ba.jy||Ba.taskpane&&Ba.taskpane.isForUILessAction?
this.iR.notifyAgave(I,13===V?11:12):(Td.a.mg&&document.activeElement.blur(),13===V?Nd.FocusManager.instance().t1e(Ff.a.sS):this.rA.I3f(I)):r.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",I)):16===V?(V=this.mG.$W(I))?0===V.jy&&this.rA.T_f():r.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",I)):17===V||18===V?(V=this.mG.$W(I))?0===V.jy?this.rA.T_f():(Td.a.mg&&document.activeElement.blur(),this.rA.I3f(I)):
r.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",I)):1===V||10===V?(V=this.mG.$W(I))?0===V.jy&&this.iR.aKh(I):r.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",I)):8===V?(I={["ak1"]:this.iR.Xi.getManifestInvaildErrorString()},this.Yo.kH().Ja(pc.a.bPb,2,I)):15===V?(I=this.rA.NOl(I))&&(V=this.iR.Vxb(I))&&V.taskpane&&!V.taskpane.isForUILessAction&&this.iR.notifyAgave(I,11):23===V?ca.a.sendOtelEvent(Object.assign(new $l.a,
{otelEvent:Ba})):38===V?ca.a.sendOtelCustomerContent(Object.assign(new $l.a,{otelEvent:Ba})):32===V?(I=Object(ha.a)(Object,Ba).solutionId,this.iR.XMf(I)):34===V&&(I=Object(ha.a)(Object,Ba),V=I.controlId,Ba=new nd("",I.ownerAddinSolutionId,new bb,!0),I.originalControlId=Ba?Ba.jTf(V):V)}kJb(I,V){this.rKc&&V&&(this.GDe=V)}static r4(I){return Telemetry.PrivacyRules.GetPrivacyCompliantId(I.solutionId,I.storeType,I.assetId,null,null,I.storeId)}}Object(h.a)(oi,"AppForOfficeAppEventHandler",null,[752]);var oj=
d(253),zi=d(1271);class sh{static egi(I){var V=I.getAttribute("style");V=V?V.toString():"";0>V.indexOf("pointer-events: auto")&&I.className!==sh.dNb&&(ge.a("Microsoft.Office.SharedOnline.FixBug6808089")?I.style.pointerEvents="auto":I.setAttribute("style",V+" pointer-events: auto"))}static Qzf(I){var V=I.getAttribute("style");V=V?V.toString():"";0>V.indexOf("pointer-events: none")&&I.className===sh.dNb&&(ge.a("Microsoft.Office.SharedOnline.FixBug6808089")?I.style.pointerEvents="none":I.setAttribute("style",
V+" pointer-events: none"))}static gal(I){var V=I.getAttribute("style");V=V?V.toString():"";0<=V.indexOf("pointer-events: none")&&I.className===sh.dNb&&(ge.a("Microsoft.Office.SharedOnline.FixBug6808089")?I.style.pointerEvents="":(V=V.replace("pointer-events: none",""),I.setAttribute("style",V)))}}sh.sil="AppForOfficeContainer EditAppForOfficeContainer";sh.dNb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";sh.FZe="";Object(h.a)(sh,"AppForOfficeViewHelper",null,[]);var Ij=
d(989),Uh=d(139);class mf{constructor(I,V,Ba,cb,Nb){this.sA=this.Nzg=null;this.DIa=!1;this.qA=V;this.Uk=Ba;V&&V.taskpane&&V.taskpane.isForUILessAction?(this.sA=null,this.Nzg=Ba):(this.sA=new Uh.a,this.sA.te.className=sh.dNb,this.sA.te.id="AppForOffice_"+this.qA.instanceId,this.sA.te.style.width="100%",this.sA.te.style.height="100%",this.sA.te.style.position="relative",this.sA.te.style.left="0",this.sA.te.style.top="0",Ba.appendChild(this.sA.te));this.Oc=Nb}dispose(){this.X9k();this.qA=null}X9k(){this.sA&&
this.sA.Eq()}j0e(I){I&&this.sA&&I!==this.Uk&&(this.Uk=I,I.appendChild(this.sA.te),this.DIa&&this.pea())}bDa(I){I&&(I.te.innerHTML="")}Fzl(I,V,Ba=null,cb=null,Nb=!1){this.hdi(I,V,Ba,cb,Nb)}$Ic(I,V,Ba){V=this.Jpc(V);I.insertBlankControlWithErrorUX(V,()=>{Ba()})}hdi(I,V,Ba=null,cb=null,Nb=!1){this.DIa=Nb;this.bDa(this.sA);this.qA&&I&&(this.HLa(V,null),V=this.Jpc(this.sA?this.sA.te:this.Nzg,cb,I),V.virtualOsfControlActivationCallback=Ba,I.insertOsfControl(V),I.setActivationCompletedStatus(this.qA.instanceId,
!0),Nb&&this.pea())}pea(){if(this.sA){var I=this.sA.xa;if(I){var V=I.parentNode;V&&"OsfAddinOverlay"!==V.className&&(oj.a.instance.ub(eg.a.Vfa,V,Object(D.a)(this,this.Aqh,"removePointerEventsStyleHandler")),zi.a.instance.ub(eg.a.drop,V,Object(D.a)(this,this.Aqh,"removePointerEventsStyleHandler")),oj.a.instance.ub(eg.a.Wfa,V,Object(D.a)(this,this.fgi,"addPointerEventsStyleHandler")),sh.Qzf(I))}}}Aqh(I){I=I.nc.target;for(let V=0;V<I.childNodes.length;++V)sh.gal(I.childNodes[V]);return!0}fgi(I){I=I.nc.target;
for(let V=0;V<I.childNodes.length;++V)sh.Qzf(I.childNodes[V]);return!0}HLa(I,V){this.sA&&(I?(null!=V&&this.j0e(V),this.sA.te.className=""===sh.FZe?sh.sil:sh.FZe,sh.egi(this.sA.xa)):(this.sA.te.className!==sh.dNb&&(sh.FZe=this.sA.te.className),this.sA.te.className=sh.dNb))}k0e(I){this.sA&&(this.sA.te.style.zIndex=String(I))}Jpc(I,V=null,Ba=null){const cb={};cb.div=I;cb.id=this.qA.instanceId;I=this.qA.qp.id;const Nb=this.qA.taskpane?this.qA.taskpane.ownerAddinSolutionId:null;if(Ba&&Nb){const Ec=this.qA.taskpane.isForUILessAction;
this.qA.tw?cb.sharedRuntimeId=this.qA.tw.Pya:(Ba=Ba.getOsfControl(Nb).getManifest(),cb.sharedRuntimeId=this.Oc.getSharedRuntimeId(Ba,Ec,I,Nb));cb.initialDisplayMode=Ec?1:2}cb.hostInfoFlags=0;cb.sharedRuntimeId?(cb.hostInfoFlags|=1,cb.solutionId=Nb):V?(cb.solutionId=V.assetId,cb.sourceLocationOverrideResourceId=V.sourceLocationOverrideResourceId,cb.featureGates=z.AFrameworkApplication.fa.Rkj(V.assetId)):cb.solutionId=I;cb.version=this.qA.qp.version;cb.storeId=this.qA.qp.store;cb.storeType=this.qA.qp.storeType;
cb.assetId=null;cb.assetStoreId=null;cb.settings=this.qA.settings;V&&OSF.OsfControl.isFirstPartyStoreString(this.qA.qp.storeType)&&(cb.hostSettings=OSF.OUtil.serializeSettings(V.nonPersistedSettings));cb.reason=Ij.a.contains(this.qA.qp.id,this.qA.jy,this.qA.qp.store,this.qA.qp.storeType,this.qA.qp.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.qA.jy?cb.osfControlType=0:1===this.qA.jy&&(cb.osfControlType=
1);z.AFrameworkApplication.Tca||OSF.OsfControl.isFirstPartyStoreString(cb.storeType)||(r.ULS.sendTraceTag(512369924,802,50,(0===this.qA.jy?"Content":"Taskpane")+" web add-in disabled by doc IRM"),cb.hostInfoFlags|=4);this.qA.taskpane?(cb.isForUILessAction=this.qA.taskpane.isForUILessAction,cb.ownerAddinSolutionId=Nb,cb.ownerAddinStoreType=this.qA.taskpane.ownerAddinStoreType):cb.isForUILessAction=!1;return cb}}Object(h.a)(mf,"AppForOfficeView",null,[667]);var Ql=d(278),Fk=d(79);class dj{constructor(I,
V,Ba,cb,Nb,Ec,Oc,je,De,Pd,Ke,xg,Gg,ph,qg){new Ql.a(0,0,0,0);this.Aec=this.Bec=this.Qdb=this.BO=this.gl=null;this.HIe=ResourceStrings.l_AddinPane;this.ob=Wh.a.ee();this.Rb=Ec;this.Rc=je;this.rA=Oc;this.le=De;this.vu=I;this.yA=V;this.Yo=Ba;this.qik=cb;this.Ab=Nb;this.Vr=Pd;this.Oc=Ke;this.Mc=xg;this.pc=Gg;this.uD=ph;this.Ns=qg;this.initialize()}dispose(){this.Rc&&this.gl&&(this.Rc.Bb(eg.a.click,this.gl,Object(D.a)(this,this.jDa,"closePaneButtonClickHandler")),this.Vr.removeHandler(this.gl,eg.a.Df,Object(D.a)(this,
this.cig,"handleShortCutsOnCloseButton")),this.gl=null);this.Mc.skb(Object(D.a)(this,this.Oy,"onUnifiedAppStateChanged"));this.Rb.xMb(Object(D.a)(this,this.HY,"onSetOffline"));this.rA.wqh(this)}initialize(){const I="label_"+this.yA,V="icon_"+this.yA;this.ob.className=this.vu?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";if(Object(ge.a)("AddClassOnSDXPaneContainer")&&this.Ns){const Ba=this.Ns.iKh;Ba&&(this.ob.className+=" "+Ba)}this.ob.style.position="absolute";this.ob.style.display="none";this.ob.setAttribute(Sd.a.hf,
Sd.a.nsa);this.ob.setAttribute(Sd.a.t_,I);this.gl=this.vDa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.gl,"AddinPaneCloseButton");this.Rc.ub(eg.a.click,this.gl,Object(D.a)(this,this.jDa,"closePaneButtonClickHandler"));this.Vr.addHandler(this.gl,eg.a.Df,Object(D.a)(this,this.cig,"handleShortCutsOnCloseButton"));this.ob.appendChild(this.gl);Object(ge.a)("AddInPaneHeaderEnhancement")?this.Vpl():Object(ge.a)("TempHeaderIconForActionAI")&&this.Ns&&"ActionAITaskPane"===this.Ns.iKh&&
(this.Bec=Wh.a.xB(),this.Bec.className="PaneIcon",this.Bec.id=V,this.Bec.src="https://fa000000121.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.1.2303.9002/en-us_web/assets/M365Orange.svg",this.ob.appendChild(this.Bec));this.Qdb=Wh.a.ee();this.Qdb.className="PaneLabel";this.Qdb.id=I;this.Qdb.setAttribute(Sd.a.hf,Sd.a.YEf);this.Qdb.setAttribute(Sd.a.I0b,"1");this.ob.appendChild(this.Qdb);this.BO=Wh.a.ee();this.BO.className="AddinPanePanelResize";this.ob.appendChild(this.BO);this.Mc.Qca(Object(D.a)(this,
this.Oy,"onUnifiedAppStateChanged"));this.Rb.QQa(Object(D.a)(this,this.HY,"onSetOffline"))}Vpl(){var I,V,Ba;const cb="icon_"+this.yA;kb.c()?(null===(V=this.Ns)||void 0===V?0:V.jKh)?(this.Aec=Wh.a.ee(),this.Aec.className="PaneIcon",this.Aec.id=cb,null===appChrome||void 0===appChrome?void 0:appChrome.api.renderIcon(this.Ns.jKh,this.Aec),this.ob.appendChild(this.Aec)):pe.a.J(509120517,811,50,"No Header Icon for current pane:{0}",null===(Ba=this.Ns)||void 0===Ba?void 0:Ba.cB):pe.a.J(508966294,811,10,
"appChrome not loaded yet for pane:{0}",null===(I=this.Ns)||void 0===I?void 0:I.cB)}Oy(I,V){V.mcb&&!this.pc.Ho&&this.isVisible&&this.xjg()}HY(I){I&&this.isVisible&&(Object(ge.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Oc.cRc(this.yA),this.xjg())}xjg(){this.Zp(!1);this.Yo.kH().Ja(Ub.a.WZc,2,this.yA);this.vse()||this.dispose()}layout(I,V){const Ba=V?I.AG(this.width):I.BG(this.width);this.isVisible&&(V?Ba.AG(1):Ba.BG(1),this.BO.style.height=(I.height-this.gl.clientHeight-this.Qdb.clientHeight).toString()+
"px",this.BO.style.width="100%");Wh.a.K6(this.ob,Ba);return I}Vtl(I){this.HIe=I}Zp(I){const V=this.Ab!==I;if(this.Ab=I)this.ob.style.display="block";const Ba=this.vse();this.uD.vql(this.yA,Ba);let cb=this.HIe;Object(ge.a)("TaskPaneToolTip")?this.Ns&&this.Ns.lKh?cb=this.Ns.lKh:this.Ns&&(cb=this.Ns.cB):cb=this.Ns?this.Ns.cB:this.HIe;this.uD.sK(this,this.Ab,cb,this.yA);Ba&&(this.gl.style.visibility=I?"visible":"hidden",V&&this.Oc.V8i(this.yA,I))}vse(){return this.Oc.Oua(this.yA)}jDa(){this.Zp(!1);this.Yo.kH().Ja(Ub.a.WZc,
2,this.yA);this.vse()||this.dispose();return!0}uDa(I,V,Ba,cb,Nb,Ec){const Oc=Wh.a.xB();Oc.alt=Nb;Oc.className=Fk.getImageClassWithCluster(I,cb);Oc.src=this.le.qk(I+".png");Oc.setAttribute("Unselectable","on");I=Wh.a.Hl();I.className=V+" cui-img-cont-float";I.appendChild(Oc);V=Wh.a.Hl();V.className=Ba;V.setAttribute("Unselectable","on");V.appendChild(I);Ba=Wh.a.mda();Ba.className="CommentPaneNoBorderButton cui-ctl";Ba.title=Nb;Ba.setAttribute(Sd.a.hf,Sd.a.Ou);Ba.tabIndex=0;Ba.appendChild(V);Ec&&(Nb=
Wh.a.Hl(),Nb.className="cui-ctl-mediumlabel",Nb.setAttribute("Unselectable","on"),Nb.innerText=Ec,Ba.appendChild(Nb));return Ba}vDa(I,V){return this.uDa(I,"cui-img-16by16","cui-ctl-iconContainer",V,CommonUIStrings.l_DialogClose,null)}cig(I){I.keyCode===Se.a.jp||I.keyCode===Se.a.BK?(this.jDa(null),I.preventDefault(),I.stopPropagation()):I.keyCode===Se.a.$q&&(I.shiftKey?this.Oc.notifyAgave(this.yA,12):this.Oc.notifyAgave(this.yA,11),I.preventDefault(),I.stopPropagation())}get isVisible(){return this.Ab}get xa(){return this.ob}get order(){return 6}get width(){return this.isVisible?
this.qik:0}get FKc(){return this.BO}get qFi(){return this.gl}get id(){return this.yA}}Object(h.a)(dj,"AddInPane",null,[707,654,108]);class yj{constructor(I,V,Ba,cb,Nb,Ec,Oc,je,De,Pd){this.Yo=I;this.Rb=V;this.rA=Ba;this.Rc=cb;this.le=Nb;this.vR=Ec;this.Oc=Oc;this.Mc=je;this.pc=De;this.uD=Pd}OOc(I,V,Ba,cb,Nb){return new dj(I,V,this.Yo,Ba,cb,this.Rb,this.rA,this.Rc,this.le,this.vR,this.Oc,this.Mc,this.pc,this.uD,Nb)}N3(I){return new Sc.a(I)}HMi(I){return new oi(this.Oc,this.Yo,this.Rb,I,this.rA)}H1d(I,
V,Ba,cb,Nb){return new mf(I,V,Ba,cb,Nb)}}Object(h.a)(yj,"AppforOfficeClassFactory",null,[656]);class ma{constructor(I){this.HFg=this.sR=!1;this.Pl=xj.a.xZ();this.gAg=I;ni.R4k(this.gAg)}ew(){this.HFg=!0}dispose(){if(this.HFg&&!this.sR){var I=xj.a.xZ();ni.Q4k(this.gAg,this.Pl,I);this.sR=!0}}}Object(h.a)(ma,"ApiCallLogger",null,[108]);class ib{get formatting(){return 0}set formatting(I){}get sourceSlideIds(){return null}set sourceSlideIds(I){}get targetSlideId(){return null}set targetSlideId(I){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(I){switch(I){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,V){switch(I){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"Array<string>");return;
case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}}
Object(h.a)(ib,"InsertSlideOptions",null,[]);class yb{constructor(){this.controlId=this.appId=null}}Object(h.a)(yb,"RequestContext",null,[]);class ac{constructor(){this.qvf=this.Wnf=null}get layoutId(){return this.Wnf}set layoutId(I){this.Wnf=I}get slideMasterId(){return this.qvf}set slideMasterId(I){this.qvf=I}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(I){switch(I){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,V){switch(I){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}}Object(h.a)(ac,"AddSlideOptions",null,[]);class Qc{constructor(I,V,Ba){this.Cec=I;this.L0=V;this.Oc=Ba}getAppRuntimeStartState(){if(!this.Oc.Oua(this.L0))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Oc.$cj(this.Cec)?1:0}setAppRuntimeStartState(I){if(!this.Oc.Oua(this.L0)||0!==I&&1!==I)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Oc.BPl(this.Cec,1===I)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,
V){switch(I){case 2:return this.Udj();case 1:return this.Lnl(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}Udj(){return this.getAppRuntimeStartState()}Lnl(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");this.setAppRuntimeStartState(I);return null}}Object(h.a)(Qc,"AppRuntimePersistenceService",null,[]);class me{constructor(I,V){this.L0=
I;this.Oc=V}getAppRuntimeState(){if(!this.Oc.Oua(this.L0))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Oc.Zcj(this.L0)?2:1}setAppRuntimeState(I){if(!this.Oc.Oua(this.L0)||2!==I&&1!==I)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Oc.MNb(this.L0,2===I)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 2:return this.Vdj();case 1:return this.Mnl(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,
V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}Vdj(){return this.getAppRuntimeState()}Mnl(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");this.setAppRuntimeState(I);return null}}Object(h.a)(me,"AppRuntimeService",null,[]);class Ge{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 1001:return this.ITj(V);case 1002:return this.cUj(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}ITj(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"string");this.insertHyperLink(V,I);return null}cUj(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.insertSlideFromContent(I)}}Object(h.a)(Ge,"Application",null,[]);class sf{constructor(I,V){this.OG=
!1;this._id=I;this.LMd=V}get enabled(){return this.OG}set enabled(I){this.OG=I;z.AFrameworkApplication.Qa.Ja(pc.a.e6b,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.LMd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(I){switch(I){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,V){switch(I){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 5:return this.jpl(V);
case 1:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}jpl(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"boolean");this.setEnabled(I);return null}pI(){this._OnAccess();return null}}Object(h.a)(sf,"RibbonButton",null,[]);class uf{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(I){switch(I){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 3:return this.wul(V);case 1:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,
V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}wul(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"boolean");this.setVisibility(I);return null}pI(){this._OnAccess();return null}}Object(h.a)(uf,"RibbonTab",null,[]);class xf{constructor(I,V){this.NNa=this.gB=this.gFc=null;this.wqa=I;this.F3a=V;H.a.Xa(this.wqa)||(this.NNa=V.Vxb(I),this.gFc=(this.gB=this.F3a?this.F3a.Xi:null)?this.gB.getOsfControl(this.wqa):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(I){let V=
null;if(!this.Opg())return this.sQf();if(!H.a.Xa(I)&&this.NNa&&this.NNa.taskpane){if(!this.ALf(I))return this.GQf(I);V=new sf(I,this.NNa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(V)}getTab(I){let V=null;if(!this.Opg())return this.sQf();if(!H.a.Xa(I)&&this.NNa&&this.NNa.taskpane){if(!this.ALf(I))return this.GQf(I);V=new uf(I)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(V)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(I){switch(I){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){switch(I){case 1:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){switch(I){case 7:return this.X3i(V);
case 6:return this.Y3i(V);case 3:return this.Sej(V);case 5:return this.Lxj(V)}I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}X3i(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.executeRequestCreate(I)}Y3i(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.executeRequestUpdate(I)}Sej(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getButton(I)}Lxj(I){I=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getTab(I)}pI(){this._OnAccess();return null}GQf(I){return this.TQf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+I)}sQf(){return this.TQf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Opg(){const I=!H.a.Xa(this.gFc.getSharedRuntimeId());pe.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",I));return I}ALf(I){if(this.gFc){var V=
this.gFc.getManifest();if(V&&(V=V.getRibbonExtensionControlMap()))return I in V||this.NBi(I)}return!1}NBi(I){var V=this.q8i();if(V){V=V.xXf;for(const Ba of V.tabs){if(Ba.id===I)return!0;for(const cb of Ba.groups)for(const Nb of cb.controls){if(Nb.id===I)return!0;if("Menu"===Nb.type){V=Nb;for(const Ec of V.items)if(Ec.id===I)return!0}}}}return!1}q8i(){return C.getInstance().p$a(this.NNa.taskpane.ownerAddinStoreType,this.NNa.taskpane.ownerAddinSolutionId,1)}TQf(I,V){return OfficeExtension.WacRuntime.Utility.createPromise((Ba,
cb)=>{cb(OfficeExtension.WacRuntime.Utility.createRichApiException(I,V))})}}Object(h.a)(xf,"DynamicRibbon",null,[]);class dg{constructor(I,V,Ba,cb){this.hef="";this.uBc=0;this.JG=I;this._id=V;this.BXb=Ba;this.F3a=cb}get id(){return this._id}_RegisterStateChange(){this.uBc||this.JG.execute(I=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.BXb,this._id,1);this.hef=I.C0a(this._id,V=>{this.F3a.X8i(this.BXb,this._id,JSON.stringify(V))})});this.uBc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.uBc--;
this.uBc||this.JG.execute(I=>{I.lkb(this._id,this.hef)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(I){switch(I){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){switch(I){case 6:return this.VVh();case 7:return this.$Vh()}I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}VVh(){return this._RegisterStateChange()}$Vh(){return this._UnregisterStateChange()}}Object(h.a)(dg,"LicenseFeature",
null,[]);class df{get scopes(){return null}set scopes(I){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(I){switch(I){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,V){switch(I){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}}Object(h.a)(df,"MsaDeviceTicketOptions",null,[]);class If{constructor(I,V){this.JG=ub.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
this.BXb=I;this.F3a=V}getFeatureTier(I,V){return OfficeExtension.WacRuntime.Utility.createPromise(Ba=>{const cb=1===V?1:2===V?2:0;this.JG.execute(Nb=>{Nb.getFeatureTier(I,cb).then(Ec=>{Ba(this.wnj(Ec))},()=>{Ba(V)})})})}getLicenseFeature(I){I=new dg(this.JG,I,this.BXb,this.F3a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}getMsaDeviceTicket(){return null}isFeatureEnabled(I,V){return OfficeExtension.WacRuntime.Utility.createPromise(Ba=>{this.JG.execute(cb=>{cb.isFeatureEnabled(I,
V).then(Nb=>{Ba(Nb)},()=>{Ba(V)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(I=>{this.JG.execute(V=>{V=V.isFreemiumUpsellEnabled();I(V)})})}launchUpsellExperience(I){if(this.F3a.Xi.getOsfControl(this.BXb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.JG.execute(V=>{V.launchUpsellExperience(I)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied","");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 7:return this.lpj(V);case 6:return this.XVh(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,
V){switch(I){case 2:return this.qkj(V);case 5:return this.vnj(V);case 1:return this.q_j(V);case 3:return this.e0j();case 4:return this.cbk(V)}I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}qkj(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"int");return this.getFeatureTier(V,I)}vnj(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");
return this.getLicenseFeature(I)}lpj(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string"),Ba=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,2,df);return this.getMsaDeviceTicket(V,Ba,I)}q_j(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"boolean");return this.isFeatureEnabled(V,I)}e0j(){return this.isFreemiumUpsellEnabled()}cbk(I){I=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.launchUpsellExperience(I)}XVh(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");this._TestFireStateChangedEvent(I);return null}wnj(I){switch(I){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(If,"License",null,[]);class Ai{get height(){return 0}set height(I){}get left(){return 0}set left(I){}get top(){return 0}set top(I){}get width(){return 0}set width(I){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(I){switch(I){case 1:return this.height;
case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,V){switch(I){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 3:this.top=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,
V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}}Object(h.a)(Ai,"ShapeAddOptions",null,[]);class nc{constructor(){this.ggf=null}get designerOptions(){return this.ggf}set designerOptions(I){this.ggf=I}getTypeName(){return"Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions"}invokePropertyGet(I){switch(I){case 1:return this.designerOptions}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,
V){switch(I){case 1:this.designerOptions=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}}
Object(h.a)(nc,"ApplyJOfcCommandsOptions",null,[]);class hn{constructor(I){if(!I)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.nJe=I}areShortcutsInUse(I){return OfficeExtension.WacRuntime.Utility.createPromise((V,Ba)=>{this.nJe.checkShortcutsInUse(I).then(cb=>{V(cb)}).catch(cb=>{Ba(cb)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((I,V)=>{this.nJe.getShortcuts().then(Ba=>{I(Ba)}).catch(Ba=>{V(Ba)})})}replaceShortcuts(I){return OfficeExtension.WacRuntime.Utility.createPromise((V,
Ba)=>{this.nJe.replaceShortcuts(I).then(()=>{V(null)}).catch(cb=>{Ba(cb)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokeMethodAsync(I,V){switch(I){case 3:return this.bqi(V);case 1:return this.Ivj();case 2:return this.Xdl(V)}I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}bqi(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"Array<string>");return this.areShortcutsInUse(I)}Ivj(){return this.getShortcuts()}Xdl(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"any");return this.replaceShortcuts(I)}}Object(h.a)(hn,"ActionService",
null,[]);class yn{constructor(){this.data=null}}Object(h.a)(yn,"AugLoopHostMessageReceivedEventArgs",null,[]);var Bm=d(709);class gh{constructor(I,V=!1,Ba=null){this.wqa=I;this.jDc=V;this.IFd=Ba||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(I){this.jDc||Bm.a.$xh(I)}_RegisterHostMessageReceivedEvent(){this.jDc||(gh.wph||(Bm.a.lph(I=>{this.IFd.fireEvent("",65542,Object.assign(new yn,{data:I}))}),gh.wph=!0),this.IFd.register(this.wqa,"",65542))}_UnregisterHostMessageReceivedEvent(){this.jDc||
this.IFd.unregister(this.wqa,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,
V){switch(I){case 1:return this.fml(V);case 2:return this.UVh();case 3:return this.ZVh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}fml(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");this.sendMessage(I);return null}UVh(){this._RegisterHostMessageReceivedEvent();return null}ZVh(){this._UnregisterHostMessageReceivedEvent();return null}}
gh.wph=!1;Object(h.a)(gh,"AugLoopEventService",null,[]);var pj=d(338),Rl=d(254);class Yg{constructor(I,V,Ba){this.CPa=this.Vif=null;this.wqa=I;this.arf=V;if(this.Ma=Ba)this.Vif=this.Ma.Ha("GetAccessTokenOAuthFirstPartyAllowList")}dqj(){this.CPa||(this.CPa=Rl.a.Ot(ub.a.instance.Ia("Common.App.OAuth.IOAuthManager")));return this.CPa}q0j(I,V){if(!this.arf||""===this.wqa||!this.Ma)return!1;const Ba=this.arf.getOsfControl(this.wqa);if(!Ba)return!1;let cb=!1;this.Vif.split(";").forEach(Nb=>{V===Nb&&(cb=
!0)});return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===z.AFrameworkApplication.Aa.mb.Ti&&Ba.isFirstParty()&&I===Yg.Bni&&cb&&Rh.d(Ba.getSolutionId())===Yg.Cni}getAccessTokenFirstPartyOAuth(I,V){let Ba;Ba=this.q0j(I,V)?cb=>{const Nb=this.dqj();Nb.continueWith(()=>{Nb.result.mI(I,V).then(Ec=>{cb(Ec);return Ec})})}:cb=>{cb(Object.assign(new pj.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Ba)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){switch(I){case 1:return this.Jcj(V)}I=this.invokeMethod(I,
V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}Jcj(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"string");return this.getAccessTokenFirstPartyOAuth(V,I)}}Yg.Bni="Maker";Yg.Cni="fa000000043";Object(h.a)(Yg,"Auth",null,[]);var va=d(3);class zn{constructor(){this.iQa=null}Fvj(){this.iQa||(this.iQa=Rl.a.Ot(ub.a.instance.Ia("Common.App.SharedFilePicker.ISharedFilePicker")));return this.iQa}getSharedFilePickerResponse(I){return OfficeExtension.WacRuntime.Utility.createPromise((V,
Ba)=>{try{const cb=this.Fvj();va.Task.WAA.call(null,cb).continueWith(()=>{const Nb=cb.result;if(Nb){let Ec={};({Su:Ec}=ka.d(I)).returnValue?Nb.jWc(Ec).then(Oc=>{Oc&&0<Oc.length?V(Oc):Ba(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Oc=>{Ba(Oc)}):Ba(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ba(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(cb){Ba(cb)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokeMethodAsync(I,V){switch(I){case 1:return this.Evj(V)}I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}Evj(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getSharedFilePickerResponse(I)}}Object(h.a)(zn,"SharedFilePicker",null,[]);class jh{createInstance(I,V,Ba="",cb=null,Nb=null){switch(I){case "Microsoft.Office.ActionService":return new hn(V);case "Microsoft.Office.SharedFilePicker":return new zn;case "Microsoft.Office.Auth":return new Yg(Ba,
cb,Nb);case "Microsoft.Office.AugLoopEventService":return new gh(Ba)}return null}}Object(h.a)(jh,"WacApiHost",null,[]);class Qg{constructor(I,V,Ba){this.xnd=!1;this.nFg=!0;this.oJe=null;this.Cec=I;this.L0=V;this.Oc=Ba}hostName(){return"PowerPointOnline"}appId(){return this.Cec}controlId(){return this.L0}createInstance(I){switch(I){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new ac;case "Microsoft.Office.PowerPoint.Application":return new Ge;case "Microsoft.Office.PowerPoint.ApplyJOfcCommandsOptions":return new nc;
case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new ib;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Ai;case "Microsoft.AppRuntime.AppRuntimeService":return new me(this.L0,this.Oc);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Qc(this.Cec,this.L0,this.Oc);case "Microsoft.Office.Licensing.License":return new If(this.L0,this.Oc);case "Microsoft.DynamicRibbon.DynamicRibbon":return new xf(this.L0,this.Oc);case "Microsoft.Office.AugLoopEventService":const V=
this.Oc.Xi.getOsfControl(this.L0);if(null===V||void 0===V?0:V.isFirstParty())return this.oJe||(this.oJe=new jh),I=this.oJe.createInstance(I,null,this.L0),I.jDc=this.xnd,I}r.ULS.sendTraceTag(509085406,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",I);return null}static Gq(I){const V=ub.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").xyf;I||(V.nFg=!1);return!V.xnd}}Object(h.a)(Qg,"RichApiHost",null,[708]);class Pk{constructor(I,
V,Ba){this.wBd=this.Zh=-1;this.wC=Ba;0<=I&&(this.Zh+=I,this.wBd=0<V?I+V<this.wC.getCount()?I+V:this.wC.getCount():this.wC.getCount())}get_current(){return-1<this.Zh&&this.Zh<this.wBd?this.wC.getItemAt(this.Zh):null}moveNext(){const I=this.$Ol();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}$Ol(){return this.Zh+1<this.wBd?(this.Zh++,!0):!1}}Object(h.a)(Pk,"ElementEnumerator",null,[831]);class Sj{constructor(I,V){this.y6a=I;this.US=V}get fill(){Qg.Gq(!1);return null}get height(){Qg.Gq(!1);
return 0}set height(I){Qg.Gq(!1)}get id(){const I=new ma(28);try{pe.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.y6a)return pe.a.J(577525073,802,10,"Shape is null."),"";const V=this.y6a.get_shapeId().toString();I.ew();return V}finally{I&&I.dispose()}}get left(){Qg.Gq(!1);return 0}set left(I){Qg.Gq(!1)}get lineFormat(){Qg.Gq(!1);return null}get name(){Qg.Gq(!1);return null}set name(I){Qg.Gq(!1)}get tags(){Qg.Gq(!1);return null}get textFrame(){Qg.Gq(!1);return null}get top(){Qg.Gq(!1);
return 0}set top(I){Qg.Gq(!1)}get type(){Qg.Gq(!1);return 0}get width(){Qg.Gq(!1);return 0}set width(I){Qg.Gq(!1)}deleteObject(){if(Qg.Gq(!0)){var I=new ma(45);try{pe.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const V=Object(ha.a)(116,this.US);V&&(V.MVi(Object(ha.a)(4,this.y6a)),I.ew())}finally{I&&I.dispose()}}}getParentSlide(){Qg.Gq(!1);return null}getParentSlideLayout(){Qg.Gq(!1);return null}getParentSlideLayoutOrNullObject(){Qg.Gq(!1);return null}getParentSlideMaster(){Qg.Gq(!1);return null}getParentSlideMasterOrNullObject(){Qg.Gq(!1);
return null}getParentSlideOrNullObject(){Qg.Gq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(I){switch(I){case 11:return this.fill;case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I,V){switch(I){case 5:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,
0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(V,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){switch(I){case 4:return this.m4d();case 15:return this.Wqj();case 16:return this.Xqj();case 18:return this.Yqj();case 17:return this.Zqj();case 19:return this.$qj();case 20:return this.arj();
case 2:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}m4d(){this.deleteObject();return null}Wqj(){return this.getParentSlide()}Xqj(){return this.getParentSlideLayout()}Yqj(){return this.getParentSlideLayoutOrNullObject()}Zqj(){return this.getParentSlideMaster()}$qj(){return this.getParentSlideMasterOrNullObject()}arj(){return this.getParentSlideOrNullObject()}pI(){this._OnAccess();
return null}}Object(h.a)(Sj,"Shape",null,[]);class fk{constructor(I){this.tVb=this.Irb=null;this.US=I;if(I=Object(ha.a)(116,this.US))this.Irb=I.AUa();this.eUk()}eUk(){this.tVb=new Y.ScriptSharpLegacyMap;if(this.Irb)for(const I of this.Irb){const V=new Sj(I,this.US);this.tVb.add(V.id,V)}}addGeometricShape(){Qg.Gq(!1);return null}addLine(){Qg.Gq(!1);return null}addTextBox(){Qg.Gq(!1);return null}getCount(){const I=new ma(29);try{pe.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.Irb)return pe.a.J(577525071,
802,50,"In Shape.GetCount(), _shapes is null"),0;I.ew();return this.Irb.length}finally{I&&I.dispose()}}getItem(I){const V=new ma(31);try{pe.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");try{const Ba=this.tVb.ga(I);V.ew();return Ba}catch(Ba){throw pe.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");
}}finally{V&&V.dispose()}}getItemAt(I){const V=new ma(30);try{pe.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Ba=this.Irb[I].get_shapeId().toString(),cb=this.tVb.ga(Ba);V.ew();return cb}catch(Ba){throw pe.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{V&&
V.dispose()}}getItemOrNullObject(I){const V=new ma(32);try{pe.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let Ba;({value:Ba}=this.tVb.vg(I));V.ew();return Ba}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(I,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Pk(I,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=
this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 6:return this.Zei(V);case 7:return this.wfi(V);case 8:return this.ghi(V);case 1:return this.W$a();case 2:return this.mab(V);case 5:return this.lab(V);case 3:return this.nab(V);
case 4:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}Zei(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,Ai);return this.addGeometricShape(V,I)}wfi(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
1,Ai);return this.addLine(V,I)}ghi(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,Ai);return this.addTextBox(V,I)}W$a(){return this.getCount()}mab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getItem(I)}lab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");return this.getItemAt(I)}nab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,"string");return this.getItemOrNullObject(I)}pI(){this._OnAccess();return null}}Object(h.a)(fk,"ShapeCollection",null,[797]);class km{constructor(I){this.iHc=I}get id(){const I=new ma(15);try{pe.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.iHc)return pe.a.J(576581654,802,10,"SlideLayout is null."),"";const V=this.iHc.Id.toString();I.ew();return V}finally{I&&I.dispose()}}get name(){const I=new ma(16);try{pe.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.iHc)return pe.a.J(576581655,
802,10,"SlideLayout is null."),"";const V=this.iHc.Name;I.ew();return V}finally{I&&I.dispose()}}get shapes(){Qg.Gq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(I){switch(I){case 1:return this.id;case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){switch(I){case 2:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}pI(){this._OnAccess();return null}}Object(h.a)(km,"SlideLayout",null,[]);class jn{constructor(I){this.uVb=null;this.nZb=I;this.fUk()}fUk(){this.uVb=
new Y.ScriptSharpLegacyMap;if(this.nZb)for(const I of this.nZb){const V=new km(I);this.uVb.add(V.id,V)}}getCount(){const I=new ma(17);try{pe.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.nZb)return pe.a.J(576581651,802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;I.ew();return this.nZb.length}finally{I&&I.dispose()}}getItem(I){const V=new ma(19);try{pe.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Ba=this.uVb.ga(I);V.ew();
return Ba}catch(Ba){throw pe.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{V&&V.dispose()}}getItemAt(I){const V=new ma(18);try{pe.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Ba=this.uVb.ga(this.nZb[I].Id.toString());V.ew();return Ba}catch(Ba){throw pe.a.J(576581653,
802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{V&&V.dispose()}}getItemOrNullObject(I){const V=new ma(20);try{pe.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let Ba;({value:Ba}=this.uVb.vg(I));V.ew();return Ba}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(I,
V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Pk(I,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,
V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 1:return this.W$a();case 2:return this.mab(V);case 3:return this.lab(V);case 4:return this.nab(V);case 5:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}W$a(){return this.getCount()}mab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,"string");return this.getItem(I)}lab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");return this.getItemAt(I)}nab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getItemOrNullObject(I)}pI(){this._OnAccess();return null}}Object(h.a)(jn,"SlideLayoutCollection",null,[797]);class wk{constructor(I){this.Urb=I}get id(){const I=new ma(21);try{pe.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.Urb)return pe.a.J(576581648,
802,10,"SlideMaster is null."),"";const V=this.Urb.Id.toString();I.ew();return V}finally{I&&I.dispose()}}get layouts(){const I=new ma(23);try{pe.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.Urb)return pe.a.J(576581649,802,10,"SlideMaster is null."),null;const V=new jn(this.Urb.ContentMasters);I.ew();return V}finally{I&&I.dispose()}}get name(){const I=new ma(22);try{pe.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.Urb)return pe.a.J(576581650,802,10,"SlideMaster is null."),
"";const V=this.Urb.Name;I.ew();return V}finally{I&&I.dispose()}}get shapes(){Qg.Gq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(I){switch(I){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I){switch(I){case 2:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}pI(){this._OnAccess();return null}}Object(h.a)(wk,"SlideMaster",null,[]);class rl{constructor(I,V){this.US=I;this.ABa=V}get id(){const I=
new ma(5);try{pe.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.US)return pe.a.J(587747398,802,10,"Slide is null."),"";const V=this.US.Cb.toString();I.ew();return V}finally{I&&I.dispose()}}get layout(){const I=new ma(9);try{pe.a.J(572643284,802,50,"PptApi Call - Slide.GetLayout");const V=this.ABa.AY;for(let Ba=0;Ba<V.length;Ba++){const cb=V[Ba].ContentMasters;for(let Nb=0;Nb<cb.length;Nb++)if(this.US.Qn===cb[Nb].Id){const Ec=new km(cb[Nb]);I.ew();return Ec}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a Layout.");}finally{I&&I.dispose()}}get shapes(){const I=new ma(6);try{pe.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");const V=new fk(this.US);I.ew();return V}finally{I&&I.dispose()}}get slideMaster(){const I=new ma(8);try{pe.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const V=this.ABa.AY;for(let Ba=0;Ba<V.length;Ba++)if(this.US.mj===V[Ba].Id){const cb=new wk(V[Ba]);I.ew();return cb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),
"Slide does not have a SlideMaster.");}finally{I&&I.dispose()}}get tags(){Qg.Gq(!1);return null}deleteObject(){if(Qg.Gq(!0)){var I=new ma(7);try{pe.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.ABa.TI(this.US),I.ew()}finally{I&&I.dispose()}}}setSelectedShapes(){Qg.Gq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(I){switch(I){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 3:return this.m4d();case 8:return this.Hsl(V);case 2:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}m4d(){this.deleteObject();return null}Hsl(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"Array<string>");this.setSelectedShapes(I);return null}pI(){this._OnAccess();return null}}Object(h.a)(rl,"Slide",null,[]);class Oi{constructor(I){this.vVb=null;this.ABa=I;this.Vrb=this.ABa.slides;this.gUk()}gUk(){this.vVb=new Y.ScriptSharpLegacyMap;if(this.Vrb)for(const I of this.Vrb){const V=
new rl(I,this.ABa);this.vVb.add(V.id,V)}}tij(){return 0<this.getCount()?this.Vrb[this.getCount()-1]:null}Qae(I){return I?I.mj:this.ABa.AY[0].Id}vij(I){const V=this.ABa.AY;for(let Ba=0;Ba<V.length;Ba++)if(I===V[Ba].Id)return V[Ba].ContentMasters[0].Id;return 0}add(I){if(Qg.Gq(!0)){var V=new ma(10);try{pe.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const Ba=this.tij();let cb=0;cb=I&&I.slideMasterId?parseInt(I.slideMasterId):this.Qae(Ba);let Nb=0;Nb=I&&I.layoutId?parseInt(I.layoutId):this.vij(cb);
this.ABa.L_b(Ba,null,cb,Nb);V.ew()}finally{V&&V.dispose()}}}getCount(){const I=new ma(11);try{pe.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.Vrb)return pe.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;I.ew();return this.Vrb.length}finally{I&&I.dispose()}}getItem(I){const V=new ma(13);try{pe.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const Ba=this.vVb.ga(I);V.ew();return Ba}catch(Ba){throw pe.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{V&&V.dispose()}}getItemAt(I){const V=new ma(12);try{pe.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Ba=this.vVb.ga(this.Vrb[I].Cb.toString());V.ew();return Ba}catch(Ba){throw pe.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{V&&V.dispose()}}getItemOrNullObject(I){const V=new ma(14);try{pe.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let Ba;({value:Ba}=this.vVb.vg(I));V.ew();return Ba}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(I,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Pk(I,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 6:return this.ufi(V);case 1:return this.W$a();case 5:return this.mab(V);case 2:return this.lab(V);case 3:return this.nab(V);
case 4:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}ufi(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,ac);this.add(I);return null}W$a(){return this.getCount()}mab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getItem(I)}lab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,"int");return this.getItemAt(I)}nab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getItemOrNullObject(I)}pI(){this._OnAccess();return null}}Object(h.a)(Oi,"SlideCollection",null,[797]);class Qk{constructor(I){this.wVb=null;this.oZb=I;this.hUk()}hUk(){this.wVb=new Y.ScriptSharpLegacyMap;if(this.oZb)for(const I of this.oZb){const V=new wk(I);this.wVb.add(V.id,V)}}getCount(){const I=new ma(24);try{pe.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.oZb)return pe.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;I.ew();return this.oZb.length}finally{I&&I.dispose()}}getItem(I){const V=new ma(26);try{pe.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Ba=this.wVb.ga(I);V.ew();return Ba}catch(Ba){throw pe.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{V&&V.dispose()}}getItemAt(I){const V=new ma(25);try{pe.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Ba=this.wVb.ga(this.oZb[I].Id.toString());V.ew();return Ba}catch(Ba){throw pe.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Ba.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{V&&V.dispose()}}getItemOrNullObject(I){const V=new ma(27);try{pe.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let Ba;({value:Ba}=this.wVb.vg(I));V.ew();return Ba}finally{V&&V.dispose()}}_OnAccess(){}getAsyncEnumerator(I,V){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Pk(I,V,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 1:return this.W$a();case 2:return this.mab(V);case 3:return this.lab(V);case 4:return this.nab(V);case 5:return this.pI()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);
}invokeMethodAsync(I,V){I=this.invokeMethod(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}W$a(){return this.getCount()}mab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getItem(I)}lab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"int");return this.getItemAt(I)}nab(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");return this.getItemOrNullObject(I)}pI(){this._OnAccess();return null}}
Object(h.a)(Qk,"SlideMasterCollection",null,[797]);class gk{constructor(I,V,Ba){this.BE=new yb;this.F5=I.presentation;this.uU=Ba;this.Ctk=V}get context(){return this.BE}get slideMasters(){const I=new ma(2);try{pe.a.J(508908362,802,50,"PptApi Call - Presentation.GetSlideMasters");const V=new Qk(this.F5.AY);I.ew();return V}finally{I&&I.dispose()}}get slides(){const I=new ma(3);try{pe.a.J(508908361,802,50,"PptApi Call - Presentation.GetSlides");const V=new Oi(this.F5);I.ew();return V}finally{I&&I.dispose()}}get tags(){Qg.Gq(!1);
return null}get title(){const I=new ma(4);try{return pe.a.J(508908360,802,50,"PptApi Call - Presentation.GetTitle"),I.ew(),"This is the title property"}finally{I&&I.dispose()}}applyJOfcCommands(I,V){if(Qg.Gq(!0))return ge.a("PptApplyJOfcCommandsUseSharedCode")?this.uU.applyJOfcCommands(I,V.designerOptions,this.Ctk.appId()):OfficeExtension.WacRuntime.Utility.createPromise(Ba=>{const cb={};cb.promiseToResolve=Ba;cb.requestBody=I;z.AFrameworkApplication.Qa.Ja(Ub.a.V9a,2,cb)}).then(Ba=>{z.AFrameworkApplication.Qa.Ja(Ub.a.V9a,
2,{promiseToResolve:null,requestBody:""});return Ba.toString()},()=>null)}getSelectedShapes(){Qg.Gq(!1);return null}getSelectedSlides(){Qg.Gq(!1);return null}getSelectedTextRange(){Qg.Gq(!1);return null}getSelectedTextRangeOrNullObject(){Qg.Gq(!1);return null}insertSlidesFromBase64(){Qg.Gq(!1)}setSelectedSlides(){Qg.Gq(!1)}_RegisterEvent(I,V){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,I,V)}_UnregisterEvent(I,V){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,
I,V)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(I){switch(I){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertyGetAsync(I){I=this.invokePropertyGet(I);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}invokePropertySet(I){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokePropertySetAsync(I,
V){this.invokePropertySet(I,V);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(I,V){switch(I){case 5:return this.vuj();case 6:return this.xuj();case 7:return this.Cuj();case 9:return this.Duj();case 1003:return this.dUj(V);case 8:return this.Isl(V);case 1001:return this.TVh(V);case 1002:return this.YVh(V)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(I);}invokeMethodAsync(I,V){switch(I){case 10:return this.Soi(V)}I=this.invokeMethod(I,V);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(I)}Soi(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,nc);return this.applyJOfcCommands(V,I)}vuj(){return this.getSelectedShapes()}xuj(){return this.getSelectedSlides()}Cuj(){return this.getSelectedTextRange()}Duj(){return this.getSelectedTextRangeOrNullObject()}dUj(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,ib);this.insertSlidesFromBase64(V,I);return null}Isl(I){I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"Array<string>");this.setSelectedSlides(I);return null}TVh(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"int");this._RegisterEvent(V,I);return null}YVh(I){const V=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,
0,"string");I=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(I,1,"int");this._UnregisterEvent(V,I);return null}}Object(h.a)(gk,"Presentation",null,[]);class Lf{constructor(I){this.uU=I}create(I,V){return new gk(I,V,this.uU)}}Object(h.a)(Lf,"PresentationFactory",null,[661]);class am{create(I,V,Ba){return new Qg(I,V,Ba)}}Object(h.a)(am,"RichApiHostFactory",null,[660]);class jo{constructor(I){this.ob=document.createElement("div");this.ob.className="AddinPaneFrame";this.rA=I}dispose(){}layout(I,
V){this.rA.value.WFj(I,V);return I}get isVisible(){return!1}get xa(){return this.ob}get order(){return 13}}Object(h.a)(jo,"AddinPaneFrame",null,[626,654,108]);class Rk{constructor(){this.ueb=this.i8c=this.K=this.Oc=this.BH=null}get name(){return"PowerPointWebEditor.AppForOffice"}Oog(I){return I.resolve("PowerPointWebEditor.IApplicationSettings").ccb}Xb(I){this.BH=I.resolve("Common.AFrameworkApplication");this.K=I;this.K.register(ek,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").oa(()=>
new ek).na();this.K.register(Jh,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").oa(()=>new Jh(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").xa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.ue("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).na();this.K.register(pd,
"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").oa(()=>new pd(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).na();
Object(ge.a)("RegisterPackageBeforeResolve")&&this.Oog(this.K)&&(this.K.register(am,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>new am).na(),this.K.register(Lf,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new Lf(this.K.resolve("PowerPointWebEditor.ICopilotProxy"))).na());this.K.register(Kc,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").oa(()=>
new Kc(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new md,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.ue("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new F,L.getInstance(),this.K.ue("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),
this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).na();const V=new n;this.K.register(Pa,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").oa(()=>new Pa(this.BH,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),V,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("Common.IAppSettingsManager"),new bb,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).na();this.K.register(Fc,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").oa(()=>new Fc(V)).na();this.K.register(Gf,
"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").oa(()=>new Gf(this.Ibj())).na();this.K.register(yj,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").oa(()=>new yj(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IPathManager"),
this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).na();Object(ge.a)("RegisterPackageBeforeResolve")&&this.Oog(this.K)||(this.K.register(am,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").oa(()=>
new am).na(),this.K.register(Lf,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").oa(()=>new Lf(this.K.resolve("PowerPointWebEditor.ICopilotProxy"))).na());this.K.register(626,"PowerPointWebEditor.IAddinPaneFrame").na().oa(()=>new jo(this.K.ue("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(627,"PowerPointWebEditor.IAppForOfficeAuthFactory").na().oa(()=>new lh)}init(){z.AFrameworkApplication.cta||this.K.resolve("Common.IAppSettingsManager").$e(Object(D.a)(this,
this.jn,"onFullAppSettingsReady"))}jn(){this.Oc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Oc.g3b=!0;z.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(I=>{I.isFeatureEnabled(Rk.fqk,!0).then(V=>{this.Oc.g3b=V;this.pAb();return null})}):this.pAb()}pAb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").fWe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const I=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");I.qNl();I.rNl();I.QDj();this.pPl();this.lRj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}lRj(){const I=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame"),
V=this.K.resolve("PowerPointWebEditor.IFocusManager"),Ba=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");V.C4(Ff.a.FCa,Ff.a.$i,I,!Ba.ahe());this.BH.To.Du()}Ibj(){const I=[];var V=[];V.push(this.K.resolve("Box4.Graph.IGraphInstance").zd(47));V.push(this.K.resolve("Box4.Graph.IGraphInstance").zd(10));V=new nj(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),V,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));I.push(V);V=new Of(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),
this.K.resolve("Box4.Graph.IGraphInstance").zd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));I.push(V);V=new rb(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));I.push(V);V=new Hj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphInstance").zd(47));I.push(V);V=new Jf(this.K.resolve("Box4.Graph.IGraphInstance").zd(8),
this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));I.push(V);return I}pPl(){this.ueb=z.AFrameworkApplication.fa.Ha("DevAddinManifestFileUrl");this.i8c=z.AFrameworkApplication.fa.Ha("DevAddinManifestGuid");var I=z.AFrameworkApplication.fa.Ha("IsDevAddinTest");if(this.ueb&&this.i8c&&I)if(I="true"===I,t.a.instance.getItem("optedIntoAddinDeveloperMode")||I&&z.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(t.a.instance.getItem(this.i8c)||
I&&z.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Oc.Xi.validateAndCacheNewDevAddinManifest(this.ueb);else{I=new x.StandardDialog;I.Ad=4;const V=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.ueb)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;I.zP(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,V,Object(D.a)(this,this.gph,"registerDevAddinManifestHandler"))}else I=
Object(D.a)(this,this.gph,"registerDevAddinManifestHandler"),I=new le(this.ueb,I),I.Ad=0,I.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}gph(I){1===I&&this.ueb&&this.v7k()}v7k(){this.Oc&&(this.Oc.Xi.validateAndCacheNewDevAddinManifest(this.ueb),t.a.instance.setItem(this.i8c,"true"))}static main(){B.a.instance.Ac(new Rk)}}Rk.fqk="mso_officeStore";Object(h.a)(Rk,"AppForOfficePackage",null,[2,3]);var ve=
d(13);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Object(ve.c)("AppForOffice");Type.registerNamespace("CommandUI.AddInCommands");Rk.main();Object(ve.b)("AppForOffice")},390:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]="spApp";e[e.fileSystem=
3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(K.b)("AddinProviderType",h)},453:function(K,S,d){d.d(S,"a",function(){return r});K=d(0);var h=d(395),e=d(201);class r{static yDh(m){return parseInt(r.vnb(e.a.WUd,m)||"-1")<=(new Date).getTime()}static y$d(m){return parseInt(r.vnb(e.a.F7a,
m)||"-1")}static bhe(m){return Boolean.parse(r.vnb(e.a.jKc,m)||"false")}static vnb(m,n){let z=null;try{const t=r.rab();if(void 0!==t&&t){const x=e.a.PUc(m)+n;z=t.getItem(x)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(t){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",m,n)}return z}static fxc(m,n,z){try{const t=r.rab();if(void 0!==t&&t){const x=e.a.PUc(m)+z;t.setItem(x,n)}else h.ULS.sendTraceTag(42074647,
220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(t){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",m,z)}}static rab(){if(!r.hVa)return null;let m=null;try{m=localStorage}catch(n){r.hVa=!1,m=null}return m}}r.hVa=!0;Object(K.a)(r,"AddinUtil",null,[])},548:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";
e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(K.b)("AddinCommandsLaunchOperationType",h)},557:function(K,S,d){d.r(S);K=d(0);var h=d(18),e=d(395),r=d(72);class m{constructor(){this.startTime=0;this.callback=null}}Object(K.a)(m,"SSOCallbackInfo",null,[]);
class n{constructor(){this.accessToken=null}}Object(K.a)(n,"AccessTokenInformation",null,[897]);var z=d(1003);class t{constructor(){this.token=null;this.expiresOn=0;this.MCa=this.zW=null}}Object(K.a)(t,"CachedTokenInfo",null,[]);class x{constructor(){this.zzc=new h.a;this.fsa=this.esa=!1;this.WMa=this.zW=null;this.startTime=this.retryCount=0;this.SBf=null}get $Yd(){return this.zzc}}Object(K.a)(x,"SSORequestInfo",null,[]);class B extends x{constructor(){super();this.errorCode=0}}Object(K.a)(B,"SSOFailedRequestInfo",
x,[]);var D=d(27);class w{constructor(ca,N,da,Y){this.a8=new h.a;this.FS=new h.a;this.YNa=null;this.kYb=new h.a;this.Knf=Promise.resolve(null);this.hvf=!1;this.M8h=N;this.wqa=ca;this.sHc=da;this.vWh=Y}ayl(ca){if(this.YNa&&this.YNa.zW===ca.zW){if(Date.now()/1E3+w.azk>this.YNa.expiresOn)return this.YNa=null,!1;ca=new z.a;ca.token=this.YNa.token;ca.expiresOn=this.YNa.expiresOn;ca.MCa=this.YNa.MCa;ca.jnb=!0;ca.q9b=0;this.$9b(ca);return!0}return!1}Awl(ca){for(let N=0;N<this.FS.count;N++)if(this.FS.ga(N).zW===
ca.zW&&this.FS.ga(N).WMa===ca.WMa){let da;(da=this.FS.ga(N)).retryCount=da.retryCount+1;ca.retryCount=this.FS.ga(N).retryCount;if(this.FS.ga(N).retryCount<w.UZa||!this.FS.ga(N).esa&&ca.esa||!this.FS.ga(N).fsa&&ca.fsa){if(!this.FS.ga(N).esa&&ca.esa||!this.FS.ga(N).fsa&&ca.fsa)ca.retryCount=0;this.FS.removeAt(N);break}ca=new z.a;ca.errorCode=this.FS.ga(N).errorCode;this.$9b(ca);return!0}return!1}mhi(ca,N){for(let da=0;da<this.FS.count;da++)if(this.FS.ga(da).WMa===ca.WMa&&this.FS.ga(da).zW===ca.zW)return;
this.FS.add(Object.assign(new B,{esa:ca.esa,fsa:ca.fsa,zW:ca.zW,WMa:ca.WMa,errorCode:N,retryCount:ca.retryCount}))}get resource(){return this.M8h}u$d(ca,N,da,Y,fa,aa){const {AppsForOfficeSingleSignOnManager:ka}=d(557);""===da&&(da=null);if(this.hvf)ka.ema(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var H=null;for(let ra of this.a8)if(ra.esa===ca&&ra.fsa===N&&ra.zW===da&&ra.WMa===fa){H=ra;break}H||(H=Object.assign(new x,{esa:ca,fsa:N,zW:da,SBf:Y,WMa:fa,retryCount:0,startTime:ka.TF()}),
this.a8.add(H));H.retryCount=0;H.$Yd.add(aa);this.Knf=this.Knf.then(()=>{var {AppsForOfficeSingleSignOnManager:ra}=d(557);if(0<this.a8.count){var ha=this.a8.ga(0);if(this.ayl(ha)||this.Awl(ha))return null;for(let Ga=0;Ga<this.kYb.count;)this.kYb.ga(Ga)+w.AKl<ra.TF()?this.kYb.removeAt(Ga):Ga++;if(this.kYb.count>=w.qzk||this.a8.count>=w.Yyk)return ha=new z.a,ha.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.$9b(ha),null;let Ma=null;D.AFrameworkApplication.Aa&&(ra=D.AFrameworkApplication.Aa.BV)&&
(Ma=ra.Ii("ComponentAttach",this.wqa+w.$$h));return ha.WMa.Yci(this.resource,ha.esa,ha.fsa,ha.zW,this.vWh,ha.SBf).then(Ga=>{Ma&&Ma.stop();this.$9b(Ga)},()=>{Ma&&Ma.stop();const Ga=new z.a;Ga.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.$9b(Ga)})}return null})}}$9b(ca){const {AppsForOfficeSingleSignOnManager:N}=d(557);try{if(this.a8.count){var da=this.a8.ga(0);this.a8.removeAt(0);var Y=null;ca.errorCode||(Y=new n,Y.accessToken=ca.token);ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&ca.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.mhi(da,ca.errorCode);var fa={};null!=ca.q9b&&(fa.getTokenSilentTime=ca.q9b.toString());null!=ca.sfe&&(fa.getTokenPopupTime=ca.sfe.toString());null!=ca.Qbe&&(fa.getIDTokenTime=ca.Qbe.toString());null!=ca.jnb&&(fa.tokenCached=ca.jnb.toString());ca.m7e&&(fa.detailedError=ca.m7e);ca.MCa&&
(fa.authLibrary=ca.MCa);da.retryCount&&(fa.retryCount=da.retryCount);for(var aa of da.$Yd)N.ema(aa,ca.errorCode,Y,fa);null!=ca.jnb&&ca.jnb||this.kYb.add(da.startTime);if(!ca.errorCode)for(null!=ca.expiresOn&&(this.YNa=Object.assign(new t,{token:ca.token,expiresOn:ca.expiresOn,zW:da.zW,MCa:ca.MCa})),this.FS.clear(),aa=0;aa<this.a8.count;)if(this.a8.ga(aa).zW===da.zW){for(let ka of this.a8.ga(aa).$Yd)N.ema(ka,ca.errorCode,Y,fa);this.a8.removeAt(aa)}else aa++}}catch(ka){e.ULS.sendTraceTag(21628945,344,
10,"ReceivedAccessTokenHandler: exception message: {0}",ka.message)}}shutdown(){this.hvf=!0;this.a8.clear()}}w.AKl=6E4;w.qzk=6;w.Yyk=6;w.UZa=3;w.azk=300;w.$$h="GetAccessToken";Object(K.a)(w,"SSOCallbackManager",null,[]);var J=d(201),F=d(218),L=d(175),M=d(77),Q=d(56),C=d(47),O=d(146),U=d(177);d.d(S,"AppsForOfficeSingleSignOnManager",function(){return T});class T{constructor(ca,N,da=null){this.pob=new r.a;const Y=new h.a;N&&Y.add(N.ewk);da&&Y.addRange(da);this.gB=ca;this.jbi=Y}removeCallbackForAddin(ca){this.pob.Gb(ca)&&
(this.pob.ga(ca).shutdown(),this.pob.remove(ca))}v$d(ca,N,da,Y,fa,aa,ka,H,ra,ha){ha=Object.assign(new m,{startTime:T.TF(),callback:ha});try{const na=!!da&&""!==da;var Ma=ha.startTime;const wa=this.getOsfControl(ca);let Fa=wa.getStoreType()||"",pa=wa.getOwnerAddinStoreType()||"",Ea=wa.getSolutionId()||"";const ta=wa.getVersion()||"";Fa=Fa.toLowerCase();pa=pa.toLowerCase();Ea=Ea.toLowerCase();var Ga=M.a.AWc(N)||"";const ia=M.a.AWc(wa.getIframeUrl())||"",Ja=Ga.toLowerCase()===ia.toLowerCase();Ga=Fa;
"inmemory"===Fa&&(Ga=pa);const ab=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,Ga,wa.getAssetId(),null,null,wa.getStoreId()),Oa={["callInstanceId"]:Ma.toString(),["controlSolutionId"]:ab,["controlVersion"]:ta,["storeType"]:Fa,["ownerStoreType"]:pa,["allowConsentPrompt"]:Y.toString(),["forMSGraphAccess"]:fa.toString(),["allowSignInPrompt"]:aa.toString(),["hasAddinAuthChallenge"]:na.toString(),["securityOriginEqualsSourceLocation"]:Ja.toString(),["singleSignOnEnabled"]:ka.toString(),["accountTypeFilter"]:H||
""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Oa);O.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:L.a.VI(Oa)}));Ma=!0;const Za=D.AFrameworkApplication.fa.Ha("HostAuthType");switch(H){case "aad":Ma="aad"===Za;break;case "msa":Ma="msa"===Za;break;default:Ma=!H||"noFilter"===H}if(Ma){H=null;if(ka)for(let Na of this.jbi)if(Na.a_j(Ea)){H=Na;break}H?this.isSSOAddin(ca)?(ka=!0,"omex"===Ga&&(ka=!1),"spapp"===Ga||"spcatalog"===Ga?(e.ULS.sendTraceTag(594043737,
344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),T.ema(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):fa&&!ka?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),T.ema(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(fa&&"exchange"===Ga&&(Y=!1),this.u$d(ca,N,da,Ga,Y,aa,ra,H,ha))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),
T.ema(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):T.ema(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else T.ema(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(na){this.X5c(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",na.message),T.ema(ha,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(ca,N,da,Y){this.v$d(ca,da[J.a.mKc]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||
null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,N,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,da[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,Y)}u$d(ca,N,da,Y,fa,aa,ka,H,ra){this.pob.Gb(ca)?Y=this.pob.ga(ca):(Y=new w(ca,this.getWebApplicationResource(ca).split(",")[0],
Y,this.getDefaultDisplayName(ca)),this.pob.add(ca,Y));const ha=Y.resource;ca=T.itj(ha,this.getWebApplicationId(ca));const Ma=OfficeExt.WACUtils.getHostSecure(N);ca&&Ma?ca.toLowerCase()===Ma.toLowerCase()?Y.u$d(fa,aa,da,ka,H,ra):(T.Fdb('SSO Resource "'+ha+'" cannot be used from "'+N+'" origin due to domain mismatch.'),e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),T.ema(ra,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null)):(ca||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Ma||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),T.ema(ra,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}X5c(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(ca){return this.gB.getOsfControl(ca)}isSSOAddin(ca){return this.getOsfControl(ca).getManifest().isSSOAddin()}getWebApplicationId(ca){return this.getOsfControl(ca).getManifest().getWebApplicationId()}getWebApplicationResource(ca){return this.getOsfControl(ca).getManifest().getWebApplicationResource()}getDefaultDisplayName(ca){return this.getOsfControl(ca).getManifest().getDefaultDisplayName()}static ddg(){try{const ca=
{};Q.a.zGa&&F.OAuthManagerSettings.ubb&&(ca.UiHostSupportsAuthTokenAddinList=T.PTc);ca.UiHostSupportsAuthToken=F.OAuthManagerSettings.ubb;return ca}catch(ca){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ca.message)}return null}static getInstance(ca,N,da=null){T.La||(T.La=new T(ca,da));return T.La}static CBi(ca){T.La&&T.La.removeCallbackForAddin(ca)}static Fdb(ca){window.console.warn&&window.console.warn(ca)}static itj(ca,N){if(!ca)return"";N||(N="");
let da=ca.toLowerCase();var Y=N.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(Y)||(T.Fdb('SSO App Id "'+N+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));da.endsWith(Y)||(T.Fdb('SSO Resource "'+ca+'" does not end with App Id "'+N+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!da.startsWith("https://")&&
!da.startsWith("api://"))return T.Fdb('SSO Resource "'+ca+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(N=0;N<ca.length;N++){Y=ca.charAt(N);const fa=C.a.charCodeAt(ca,N);if(33>fa||126<fa||"&"===Y||"?"===Y||"#"===Y||"%"===Y||"\\"===Y)return T.Fdb('SSO Resource "'+ca+'" contains an invalid character "'+Y+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+Y+"' in resource URI."),""}if(0<=ca.indexOf("::"))return T.Fdb('SSO Resource "'+
ca+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<ca.length)return T.Fdb('SSO Resource "'+ca+'" is '+ca.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+ca.length+"."),"";da.startsWith("api://")&&(da="https://"+da.substring(6,da.length));return 8===da.length?"":OfficeExt.WACUtils.getHostSecure(da)||""}static ema(ca,N,da,Y){var fa=ca.startTime;let aa=0;0<fa&&(aa=
T.TF()-fa);fa={["callInstanceId"]:fa.toString(),["callDuration"]:aa.toString(),["errorCode"]:N.toString()};if(Y)for(let ka in Y)fa[ka]=Y[ka];e.ULS.sendTraceTag(51401116,344,50,"{0}",fa);O.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:L.a.VI(fa)}));ca.callback(N,da)}static TF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(ca){}return Date.now()}}T.PTc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
T.La=null;Object(K.a)(T,"AppsForOfficeSingleSignOnManager",null,[857])},709:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(18);class e{static lph(r){e.F$b.add(r)}static Sxh(r){for(let m of e.F$b)m(r)}static uph(r){e.Ykb.add(r);if(0<e.WKa.count){for(let m of e.WKa)r(m);e.WKa=new h.a}}static $xh(r){if(0<e.Ykb.count)for(let m of e.Ykb)m(r);else e.WKa.add(r)}}e.WKa=new h.a;e.Ykb=new h.a;e.F$b=new h.a;Object(K.a)(e,"AugLoopEventUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.appforoffice.js.map