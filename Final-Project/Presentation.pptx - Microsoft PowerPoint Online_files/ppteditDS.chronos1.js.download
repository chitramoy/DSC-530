'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1005:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.Bya=e}}Object(K.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},1006:function(K,S,d){d.r(S);d.d(S,"InsightsMenuItemFactory",function(){return m});K=d(0);var h=d(108),e=d(131),r=d(47);class m{constructor(n=null){this.e2h=n||CommonUIStrings.l_InsightsButtonText}get Gkb(){return 10}tL(n){var z=
n.hK;n=h.a.P9()?h.a.ADa(z,1):h.a.F2d(z);z=String.format(this.e2h,z);return this.$bj(n,z)}$bj(n,z){return e.a(m.Tmg,h.a.P9()?"1914896509":"3317204163",r.a.ze(z),h.a.tUj,null,r.a.ze(n),r.a.ze(z),null,null)}}m.Tmg="bInsights";Object(K.a)(m,"InsightsMenuItemFactory",null,[988])},1007:function(K,S,d){d.d(S,"a",function(){return r});K=d(0);var h=d(131),e=d(47);class r{constructor(m,n,z,t,x){this.gPd=m;this.fPd=n;this.Sai=z;this.r1h=t;this.qkf=x}get Gkb(){return 4}tL(m,n=null){n=n.sessionId+"|"+n.x9+"|"+
m.hK;if(this.qkf||this.r1h){let z=this.qkf||e.a.pC(CommonUIStrings.l_HelpTooltip)===e.a.pC(m.hK.trim());if(this.Sai&&2<m.hK.length){const t=m.hK;";"===t.charAt(0)&&";"===t.charAt(t.length-1)&&t.substring(1,t.length-1)===r.Khe&&(z=!0)}m=z?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.hK);return this.n5f(n,e.a.ze(m),z)}return this.n5f(n,e.a.ze(String.format(CommonUIStrings.l_TextWithQuotation,m.hK)),!1)}n5f(m,n,z){return h.a(r.Khe,z?this.fPd:this.gPd,
n,"OfficeAssistant_16x16x32","A0",e.a.ze(m),n,null,null)}}r.Khe="bSearchHelp";Object(K.a)(r,"AssistanceMenuItemFactory",null,[988])},1008:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(27),e=d(131),r=d(79),m=d(47);class n{get Gkb(){return 13}tL(){return n.Iui()}static Iui(){return e.b(n.W2f,"798637440",m.a.ze(CommonUIStrings.l_LookupFirstRunExperienceTitle),h.AFrameworkApplication.km,r.getImageClass("Info_32x32x32"),null,null,m.a.ze(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,m.a.ze(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}n.W2f="bTellMeFirstRun";Object(K.a)(n,"FirstRunMenuItemFactory",null,[988])},1009:function(K,S,d){d.d(S,"a",function(){return m});K=d(0);var h=d(27),e=d(131),r=d(47);class m{constructor(n=null,z=null){this.Zpf=n;this.T5h=z||CommonUIStrings.l_LookupNoResultsDescription}get Gkb(){return 14}tL(n){n=String.format(this.T5h,n.hK);return this.qvi(n)}qvi(n){return e.b(m.k8g,"798637440",r.a.ze(CommonUIStrings.l_LookupNoResultsTitle),
this.Zpf?h.AFrameworkApplication.km:null,this.Zpf,null,null,r.a.ze(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,r.a.ze(n),null,null)}}m.k8g="lookupNoResults";Object(K.a)(m,"NoCommandsFoundMenuItemFactory",null,[988])},1010:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=r}}Object(K.a)(h,"LabelFormatted",null,[])},1011:function(K,S,d){d.d(S,"a",function(){return z});K=d(0);d(145);var h=d(160),
e=d(174),r=d(173),m=d(108),n=d(47);class z{constructor(t){this.qb=t}pE(){return"Assistance"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:this.qb.boc?3:2}IB(t,x,B=!1,D,w=null){D=new r.a(t);if((!w||Array.contains(w,8))&&!m.a.aG(t)){w=new e.a(8);if(B){B=n.a.pC(CommonUIStrings.l_HelpTooltip)===n.a.pC(t.Ef.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,t.Ef);const J=[];this.qb.wWa&&(this.qb.s3e||J.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",
{"default":"search_20"})),B=this.Dag(t.Ef));const F="||"+t.Ef;J.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",B));J.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",F));appChrome.api.dispatch(J);t=new h.a("GetHelpFromTellMe",4,t.Ef,null,1)}else t=new h.a("bSearchHelp",4,t.Ef,null,1);w.ys(t);w.displayName=CommonUIStrings.l_HelpButtonTitle;D.Bq(w)}x.resultsUpdated(D)}NUa(t,x=null){const B=new e.a(8),D=n.a.pC(CommonUIStrings.l_HelpTooltip)===n.a.pC(t.Ef.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:
String.format(CommonUIStrings.l_TextWithQuotation,t.Ef);for(let J=0;J<x.length&&2>J;J++){var w=void 0;w=[];let F="GetHelpWithDescriptionFromTellMe"+(J+1).toString(),L=4;if(this.qb.muc)w.push(appChrome.actions.setControlLabel(F,D)),w.push(appChrome.actions.setCompoundButtonCommandValueId(F,t.Ef)),w.push(appChrome.actions.updateCompoundButtonDescription(F,this.lzj(x.length)));else if(this.qb.nuc){let M=this.Meg(x[J]);F="GetHelpFromTellMe"+(J+1).toString();this.qb.wWa&&(M=this.Dag(M));L=9;w.push(appChrome.actions.setControlLabel(F,
M));w.push(appChrome.actions.setButtonCommandValueId(F,this.jzj(x[J])))}appChrome.api.dispatch(w);w=new h.a(F,L,null,null,0);w.label=this.Meg(x[J]);w.description=this.izj(x[J]);B.ys(w);if(this.qb.nuc)break}B.displayName=CommonUIStrings.l_HelpButtonTitle;return B}lzj(t){return 1===t?String.format(CommonUIStrings.l_SearchResultText,t):String.format(CommonUIStrings.l_SearchResultsText,t)}Dag(t){return this.qb.Bre?m.a.Bbe(t,CommonUIStrings.l_HelpScopedButtonText):t+CommonUIStrings.l_HelpScopedButtonText}Meg(t){return t.name?
t.name:""}izj(t){return t.description?t.description:""}jzj(t){return t.id?"AssetID="+t.id:""}}Object(K.a)(z,"AssistanceResultsProvider",null,[909])},1012:function(K,S,d){d.d(S,"a",function(){return t});K=d(0);d(145);var h=d(160),e=d(174),r=d(173),m=d(117),n=d(108),z=d(302);class t{constructor(x){this.qb=x}pE(){return"Image"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:3===this.qb.Hq?3:2}IB(x,B,D,w,J=null){D=new r.a(x);(!J||Array.contains(J,19))&&n.a.aG(x)&&this.qb.gI&&this.NUa(x,D,1);B.resultsUpdated(D)}NUa(x,
B,D,w=null){var J=[];let F;m.TellMeActor.instance.lH()&&m.TellMeActor.instance.lH().wWa?(F=this.qb.Bre?n.a.Bbe(x.Ef,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):x.Ef+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.qb.s3e||J.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):F=this.qb.gI?n.a.aG(x)?this.qb.eRa?n.a.OTa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:
this.qb.eRa?n.a.OTa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,x.Ef)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,x.Ef):this.qb.VOb?CommonUIStrings.l_TellMeImageSuggestionButtonText:x.Ef+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.qb.cea?(m.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",F)),J=n.a.ADa(x.Ef,9,Object.assign(new z.a,{landingTab:"Image"})),m.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",
J))):(J.push(appChrome.actions.setControlLabel("ImageForSearch",F)),x=n.a.ADa(x.Ef,9,Object.assign(new z.a,{landingTab:"Image"})),J.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",x)),appChrome.api.dispatch(J));D=new h.a("ImageForSearch",12,null,null,D);w&&(D.score=w.ConfidenceScore);w=new e.a(19,this.qb.VOb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);w.ys(D);B.Bq(w)}}Object(K.a)(t,"ImageResultsProvider",null,[909])},1013:function(K,S,d){d.d(S,"a",function(){return z});
K=d(0);d(145);var h=d(160),e=d(174),r=d(173),m=d(108),n=d(27);class z{constructor(t){this.qb=t}pE(){return"Template"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:3}IB(t,x){t=new r.a(t);x.resultsUpdated(t)}NUa(t,x,B){var D=[];let w;w=this.qb.gI?this.qb.eRa?m.a.OTa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,t.Ef)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,t.Ef):String.format(CommonUIStrings.l_TellMeTemplateButtonText,t.Ef);D.push(appChrome.actions.setControlLabel("TemplateForSearch",
w));D.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(n.AFrameworkApplication.fa.Ha("TellMeTemplateProviderURL"),n.AFrameworkApplication.uiCulture,t.Ef)));appChrome.api.dispatch(D);t=new e.a(23);t.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;D=new h.a("TemplateForSearch",24,null,null,0);D.label=B[0].Title?B[0].Title:"";D.description=B[0].Description?B[0].Description:"";t.ys(D);x.Bq(t)}}Object(K.a)(z,"TemplateResultsProvider",null,[909])},1014:function(K,
S,d){d.d(S,"a",function(){return B});K=d(0);d(145);var h=d(344),e=d(160),r=d(174),m=d(173),n=d(710),z=d(117),t=d(108),x=d(47);class B{constructor(D,w,J,F){this.LS=D;this.uQa=w;this.Fwf=F;this.u0h=J;this.qb=z.TellMeActor.instance.lH()}pE(){return"EmptyQuery"}LL(){return 1===this.qb.Hq?1:0}IB(D,w,J=!1,F,L=null){F=new m.a(D);if((!L||Array.contains(L,5)||Array.contains(L,6)||Array.contains(L,4))&&t.a.aG(D)){this.LS.T7b().length||!this.u0h||this.Fwf||(D=new r.a(6),L=new e.a(null,13,void 0,void 0,1),D.ys(L),
F.Bq(D));D=new r.a(4);if(0<this.LS.T7b().length){D.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;L=this.LS.T7b();var M=[];for(var Q of L)M.push(Q.Id);h.CommandResultsUtility.nRb(M,this.qb);for(var C of L)h.CommandResultsUtility.fbc(C.Id)&&D.ys(new e.a(C.Id,5,null,null,2));F.Bq(D)}if(this.Fwf&&0<this.uQa.length&&this.LS.T7b().length<B.K5g){Q=new r.a(5);Q.displayName=CommonUIStrings.l_TellMeTryQueryTitle;C=B.K5g-D.results.length;D=[];for(L=0;L<this.uQa.length&&L<C;++L){if(J){M=t.a.P9e+(L+1);
const O=this.uQa[L].key,U=x.a.replaceAll(O,'"',"");D.push(appChrome.actions.setControlLabel(M,O));D.push(appChrome.actions.setButtonCommandValueId(M,U));M=new n.a(O,7,0,U,M)}else M=new n.a(this.uQa[L].key,7,0,this.uQa[L].value);Q.ys(M)}0<D.length&&appChrome.api.dispatch(D);F.Bq(Q)}}w.resultsUpdated(F)}}B.K5g=5;Object(K.a)(B,"EmptyQueryResultsProvider",null,[909])},1015:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.bxd=this.xua=this.oVa=this.xt=this.VLc=this.Vz=
this.Snb=0}}Object(K.a)(h,"TRIESCAN",null,[])},1016:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.Service=0]="Service";e[e.Local=1]="Local";e[e.MRU=2]="MRU";e[e.TestResult=3]="TestResult";e[e.Unknown=4]="Unknown"})(h||(h={}));Object(K.b)("SubResultType",h)},1033:function(K,S,d){d.r(S);var h=d(0),e=d(145),r=d(391),m=d(265),n=d(160),z=d(174),t=d(173),x=d(117),B=d(108),D=d(302);class w{constructor(Aa){this.qb=Aa}pE(){return"ActionAI"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?
1:2}IB(Aa,Ua,gb=!1,Eb,Ub=null){Eb=new t.a(Aa);if(!Ub||Array.contains(Ub,24))if(this.qyl()||!B.a.aG(Aa)){Ub=new z.a(24);var vc=B.a.aG(Aa);gb&&(gb=null,B.a.P9()&&(gb=B.a.ADa(vc?"":Aa.Ef,1,Object.assign(new D.a,{landingTab:"ActionAI"}))),this.qb.cea?gb&&x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",gb)):(Aa=[],gb&&Aa.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",gb)),appChrome.api.dispatch(Aa)));Ub.ys(new n.a("ActionAIFromTellMe",
25,null,null,1));Eb.Bq(Ub)}Ua.resultsUpdated(Eb)}qyl(){return B.a.P9()&&this.qb.Cne}}Object(h.a)(w,"ActionAIResultsProvider",null,[909]);var J=d(725);class F{constructor(Aa,Ua){this.bCd=Aa;this.Zh=Ua}resultsUpdated(Aa){this.bCd.osl(this.Zh,Aa)}}Object(h.a)(F,"AggregatorResultsProviderCallback",null,[1028]);class L{constructor(Aa){this.Rba=null;this.qb=Aa;this.qb.N7a&&(this.Rba=null)}pE(){return"AppsForOffice"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua,gb,Eb,Ub=null){gb=new t.a(Aa);if(!Ub||
Array.contains(Ub,1))Ub=new z.a(1),this.Rba.s0l(Ub,Aa.Ef),gb.Bq(Ub);Ua.resultsUpdated(gb)}}Object(h.a)(L,"AppsForOfficeRecommendationResultsProvider",null,[909]);var M=d(1011),Q=d(81),C=d(226),O=d(19);class U{constructor(Aa,Ua){this.Ka=Aa;this.Rkk=Ua}isMatch(Aa,Ua){if(!Object(O.a)(1213,Aa))throw Error.argument("objToTest","Expected feature bundle");let gb;return({value:gb}=Aa.ln(this.Ka.Vca)).returnValue?this.Ka.kbf.isMatch(gb,Ua):this.Rkk}}Object(h.a)(U,"AnnotatedWithAndValueMatchesAnnotationFilter",
null,[1307]);class T{constructor(Aa,Ua){this.Ka=Aa;this.eze=Ua}isMatch(Aa){if(!Object(O.a)(1213,Aa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.eze^Aa.ln(this.Ka.Vca).returnValue)}}Object(h.a)(T,"AnnotatedWithAnnotationFilter",null,[1307]);class ca{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){if(!Object(O.a)(1215,Aa))throw Error.argument("objToTest","Expected struct value");return this.Ka.kbf.isMatch(Aa.cUa(this.Ka.zta),Ua)}}Object(h.a)(ca,"FieldValueMatchesStructFilter",
null,[1307]);class N{constructor(Aa,Ua){Aa&&(this.zta=Aa.ga(0),this.kbf=Ua.i9(Aa.ga(1)))}}Object(h.a)(N,"FieldValueMatchesStructFilterInit",null,[]);class da{constructor(Aa){this.eze=Aa}isMatch(Aa){if(!Object(O.a)(1213,Aa))throw Error.argument("objToTest","Expected feature bundle");return!!(this.eze^Aa.che)}}Object(h.a)(da,"HasAnnotationsAnnotationFilter",null,[1307]);class Y{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa,Ua){if(!Object(O.a)(1214,Aa))throw Error.argument("objToTest","Expected list value");
switch(this.Tq){case 0:for(const gb of Aa.items)if(this.Ka.filter.isMatch(gb,Ua))return!0;return!1;case 1:for(const gb of Aa.items)if(!this.Ka.filter.isMatch(gb,Ua))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(Y,"ItemTestListFilter",null,[1307]);class fa{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){if(!Object(O.a)(1214,Aa))throw Error.argument("objToTest","Expected list value");return this.Ka.filter.isMatch(Aa.items.length,Ua)}}Object(h.a)(fa,"LengthMatchesListFilter",null,[1307]);
class aa{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa,Ua,gb=null){let Eb=0===this.Tq;for(const Ub of this.Ka.ILf)if((Eb=Ub.isMatch(Aa,Ua,gb))?1===this.Tq:0===this.Tq)return Eb;2===this.Tq&&(Eb=!Eb);return Eb}}Object(h.a)(aa,"NonterminalFilter",null,[1307]);class ka{constructor(Aa,Ua){if(Aa){var gb=Aa.ga(0);this.ILf=Array(gb);for(let Eb=0;Eb<gb;++Eb)this.ILf[Eb]=Ua.i9(Aa.ga(1+Eb))}}}Object(h.a)(ka,"NonterminalFilterInit",null,[]);class H{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa,Ua){if("number"!==
typeof Aa)throw Error.argument("objToTest","Expected number value");let gb=this.Ka.number;if(this.Ka.query){Ua=this.Ka.query.zp(null,Ua);if("number"!==typeof Ua)throw Error.invalidOperation("Query did not return number");gb+=Ua}switch(this.Tq){case 0:return Aa===gb;case 1:return Aa<gb;case 2:return Aa<=gb;case 3:return Aa>gb;case 4:return Aa>=gb;default:throw Error.notImplemented();}}}Object(h.a)(H,"NumberFilter",null,[1307]);class ra{constructor(Aa,Ua){Aa&&(this.number=Aa.ga(0),this.query=Aa.ga(1)?
Ua.lE(Aa.ga(1)):null)}}Object(h.a)(ra,"NumberFilterInit",null,[]);class ha{constructor(Aa,Ua,gb){this.iWc=this.pkj;this.pIa=Aa;this.SFg=Ua;this.QFg=gb}xZd(Aa){this.SFg=Aa}pkj(Aa){if(!Aa)throw Error.argument("name","Invalid named feature bundle reference");const Ua=Aa.substr(1);return 1===Aa.charCodeAt(0)&&Ua===this.pIa?this.SFg:this.QFg?this.QFg.iWc(Aa):null}}Object(h.a)(ha,"SimpleNamedFeatureBundleResolver",null,[1318]);class Ma{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){if(!Object(O.a)(1213,Aa))throw Error.argument("objToTest",
"Expected feature bundle");Aa=this.Ka.query.zp(null,new ha(this.Ka.tAd,Aa,Ua));if("boolean"!==typeof Aa)throw Error.invalidOperation("Query did not return bool");return Aa}}Object(h.a)(Ma,"PredicateAnnotationFilter",null,[1307]);class Ga{constructor(Aa,Ua){Aa&&(this.tAd=Ua.YC(Aa.ga(0)),this.query=Ua.lE(Aa.ga(1)))}}Object(h.a)(Ga,"PredicateAnnotationFilterInit",null,[]);class na{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){if("boolean"!==typeof Aa)throw Error.argument("objToTest","Expected bool value");
Ua=this.Ka.query.zp(null,Ua);if("boolean"!==typeof Ua)throw Error.invalidOperation("Query did not return bool");return Aa===Ua}}Object(h.a)(na,"QueryBooleanFilter",null,[1307]);class wa{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa,Ua){if("number"!==typeof Aa)throw Error.argument("objToTest","Expected integer");Ua=this.Ka.query.zp(null,Ua);if("number"!==typeof Ua)throw Error.invalidOperation("Query did not return an enum value");switch(this.Tq){case 0:return Aa===Ua;case 1:return 0!==(Aa&Ua);
case 2:return Aa===(Aa&Ua);case 3:return Ua===(Aa&Ua);default:throw Error.notImplemented();}}}Object(h.a)(wa,"QueryEnumFilter",null,[1307]);class Fa{constructor(Aa,Ua){Aa&&(this.S2c=1===Aa.ga(0),this.query=Ua.lE(Aa.ga(1)))}}Object(h.a)(Fa,"QueryEnumFilterInit",null,[]);class pa{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa,Ua){if(!Object(O.a)(1214,Aa))throw Error.argument("objToTest","Expected list value");Ua=this.Ka.query.zp(null,Ua);if(!Object(O.a)(1214,Ua))throw Error.invalidOperation("Query did not return list value");
if(Aa.VU!==Ua.VU)return!1;switch(this.Tq){case 0:return Q.Annotations.n3a(Q.Annotations.Tnj(Aa.VU),Aa,Ua);case 1:for(const gb of Aa.items)for(const Eb of Ua.items)if(Q.Annotations.n3a(Aa.VU,gb,Eb))return!0;return!1;case 2:for(const gb of Aa.items)for(const Eb of Ua.items)if(!Q.Annotations.n3a(Aa.VU,gb,Eb))return!1;return!0;case 3:for(const gb of Ua.items)for(const Eb of Aa.items)if(!Q.Annotations.n3a(Aa.VU,gb,Eb))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(pa,"QueryListFilter",
null,[1307]);class Ea{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa,Ua){if("string"!==typeof Aa)throw Error.argument("objToTest","Expected string");Ua=this.Ka.query.zp(null,Ua);if("string"!==typeof Ua)throw Error.invalidOperation("Query did not return string");this.Ka.Zne&&(Aa=Aa.toUpperCase(),Ua=Ua.toUpperCase());switch(this.Tq){case 0:return Aa===Ua;case 1:return 0<=Aa.indexOf(Ua);case 2:return Aa.startsWith(Ua);case 3:return Aa.endsWith(Ua);case 4:return 0<=Ua.indexOf(Aa);case 5:return Ua.startsWith(Aa);
case 6:return Ua.endsWith(Aa);default:throw Error.notImplemented();}}}Object(h.a)(Ea,"QueryStringFilter",null,[1307]);class ta{constructor(Aa,Ua){Aa&&(this.query=Ua.lE(Aa.ga(0)),this.Zne=1===Aa.ga(1))}}Object(h.a)(ta,"QueryStringFilterInit",null,[]);class ia{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){if(!Object(O.a)(1215,Aa))throw Error.argument("objToTest","Expected struct value");Ua=this.Ka.query.zp(null,Ua);if(!Object(O.a)(1215,Ua))throw Error.invalidOperation("Query did not return struct value");
return Aa.isEqual(Aa)}}Object(h.a)(ia,"QueryStructFilter",null,[1307]);class Ja{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){Aa=this.Ka.query.zp(null,Ua);if("boolean"!==typeof Aa)throw Error.invalidOperation("Query did not return bool");return Aa}}Object(h.a)(Ja,"QueryWhereConstraintFilter",null,[1307]);class ab{constructor(Aa){this.Ka=Aa}isMatch(Aa){if("string"!==typeof Aa)throw Error.argument("objToTest","Expected string");return this.Ka.regex.test(Aa)}}Object(h.a)(ab,"RegexStringFilter",null,[1307]);
class Oa{constructor(Aa,Ua){Aa&&(this.regex=Ua.Wbg(Aa.ga(0)))}}Object(h.a)(Oa,"RegexStringFilterInit",null,[]);class Za{constructor(Aa,Ua){Aa&&(this.filter=Ua.i9(Aa.ga(0)))}}Object(h.a)(Za,"SingleFilterFilterInit",null,[]);class Na{constructor(Aa,Ua){Aa&&(this.query=Ua.lE(Aa.ga(0)))}}Object(h.a)(Na,"SingleQueryFilterInit",null,[]);class sa{constructor(Aa){this.Ka=Aa}isMatch(Aa){if("boolean"!==typeof Aa)throw Error.argument("objToTest","Expected bool value");return Aa===this.Ka.value}}Object(h.a)(sa,
"StoredValueBooleanFilter",null,[1307]);class Sa{constructor(Aa){Aa&&(this.value=1===Aa.ga(0))}}Object(h.a)(Sa,"StoredValueBooleanFilterInit",null,[]);class xb{constructor(Aa,Ua){this.Ka=Aa;this.Tq=Ua}isMatch(Aa){if("number"!==typeof Aa)throw Error.argument("objToTest","Expected integer");switch(this.Tq){case 0:return this.Ka.S2c?this.Ka.value?!!(Aa&this.Ka.value):!Aa:Aa===this.Ka.value;case 1:return this.Ka.S2c?(Aa&this.Ka.value)===this.Ka.value:32>Aa&&(1<<Aa&this.Ka.value)===this.Ka.value;case 2:return this.Ka.S2c?
!!(Aa&this.Ka.value):32>Aa&&!!(1<<Aa&this.Ka.value);default:throw Error.notImplemented();}}}Object(h.a)(xb,"StoredValueEnumFilter",null,[1307]);class gc{constructor(Aa){Aa&&(this.S2c=1===Aa.ga(0),this.value=Aa.ga(1))}}Object(h.a)(gc,"StoredValueEnumFilterInit",null,[]);class zc{constructor(){this.zQk=null;this.nYd=this.xbb=0}}Object(h.a)(zc,"WHEREConstraintData",null,[]);class Xb{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua){if(!Object(O.a)(zc,Aa))throw Error.argument("objToTest","Expected WHERE constraint data");
let gb=-1,Eb=-1;const Ub=Aa.zQk;switch(this.Ka.rZd){case 4:gb=Ub.P6b;Eb=Ub.e5e;break;case 5:gb=Aa.xbb;Eb=Ub.P6b-Aa.xbb;break;case 6:gb=Ub.P6b+Ub.e5e;Eb=Aa.xbb+Aa.nYd-gb;break;case 1:case 2:case 3:let vc=!1;for(let jd=Ub.F0l;jd;jd=jd.next)if(this.Ka.NWl===jd.name){vc=!0;1===this.Ka.rZd?(gb=jd.P6b,Eb=jd.e5e):2===this.Ka.rZd?(gb=Aa.xbb,Eb=jd.P6b-Aa.xbb):(gb=jd.P6b+jd.e5e,Eb=Aa.xbb+Aa.nYd-gb);break}if(!vc)return!1;break;case 7:gb=Aa.xbb;Eb=Aa.nYd;break;default:throw Error.notImplemented();}return null!==
this.Ka.UEl.f1l(Ub.H2l,gb,Eb,gb,!0,2,Ua)}}Object(h.a)(Xb,"SubSreWhereConstraintFilter",null,[1307]);class jb{constructor(Aa,Ua){if(Aa){var gb=Ua.YC(Aa.ga(0));this.rZd=gb.charCodeAt(0);this.NWl=gb.substr(1);this.UEl=Ua.Stj(Aa.ga(1))}}}Object(h.a)(jb,"SubSreWhereConstraintFilterInit",null,[]);class zb{constructor(Aa){this.Ka=Aa}isMatch(Aa,Ua,gb=null){if(!Object(O.a)(1213,Aa))throw Error.argument("objToTest","Expected feature bundle");if(null==gb)throw Error.argumentNull("parentTextForSpan");if(this.Ka.SCf&&
!this.Ka.SCf.isMatch(Aa,Ua))return!1;if(this.Ka.H7e){let Eb;if(({value:Eb}=Aa.ln(this.Ka.oEl)).returnValue){if(!this.Ka.H7e.isMatch(Eb,Ua))return!1}else{let Ub,vc;if(!({value:Ub}=Aa.ln(this.Ka.PGh)).returnValue||!({value:vc}=Aa.ln(this.Ka.OGh)).returnValue||0>Ub||0>vc||Ub+vc>gb.length||!this.Ka.H7e.isMatch(gb.substr(Ub,vc),Ua))return!1}}if(this.Ka.qHh){let Eb;if(!({value:Eb}=Aa.ln(this.Ka.PGh)).returnValue||!this.Ka.qHh.isMatch(Eb,Ua))return!1}if(this.Ka.bxg){let Eb;if(!({value:Eb}=Aa.ln(this.Ka.OGh)).returnValue||
!this.Ka.bxg.isMatch(Eb,Ua))return!1}return!0}}Object(h.a)(zb,"TextSpanFilter",null,[1307]);class Tb{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.PGh=Aa.ga(0),this.OGh=Aa.ga(1),this.oEl=Aa.ga(2),this.H7e=Aa.ga(3)?Ua.i9(Aa.ga(3)):null,this.SCf=Aa.ga(4)?Ua.i9(Aa.ga(4)):null,this.qHh=Aa.ga(5)?Ua.i9(Aa.ga(5)):null,this.bxg=Aa.ga(6)?Ua.i9(Aa.ga(6)):null)}}Object(h.a)(Tb,"TextSpanFilterInit",null,[]);class Ya{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.Vca=Aa.ga(0),this.kbf=
Aa.ga(1)?Ua.i9(Aa.ga(1)):null)}}Object(h.a)(Ya,"ValueFilterAnnotationFilterInit",null,[]);var sb=d(279);class oc{i9(Aa,Ua){const gb=Aa.ga(0),Eb=new sb.a;Eb.FTa(Aa,1,Aa.count-1);switch(gb){case 1:return new aa(new ka(Eb,Ua),0);case 2:return new aa(new ka(Eb,Ua),1);case 3:return new aa(new ka(Eb,Ua),2);case 101:return new ab(new Oa(Eb,Ua));case 103:return new Ea(new ta(Eb,Ua),0);case 104:return new Ea(new ta(Eb,Ua),1);case 105:return new Ea(new ta(Eb,Ua),2);case 106:return new Ea(new ta(Eb,Ua),3);case 107:return new Ea(new ta(Eb,
Ua),4);case 108:return new Ea(new ta(Eb,Ua),5);case 109:return new Ea(new ta(Eb,Ua),6);case 201:return new sa(new Sa(Eb));case 202:return new na(new Na(Eb,Ua));case 301:return new H(new ra(Eb,Ua),0);case 302:return new H(new ra(Eb,Ua),1);case 303:return new H(new ra(Eb,Ua),2);case 304:return new H(new ra(Eb,Ua),3);case 305:return new H(new ra(Eb,Ua),4);case 401:return new xb(new gc(Eb),0);case 402:return new xb(new gc(Eb),1);case 403:return new xb(new gc(Eb),2);case 404:return new wa(new Fa(Eb,Ua),
0);case 405:return new wa(new Fa(Eb,Ua),1);case 406:return new wa(new Fa(Eb,Ua),2);case 407:return new wa(new Fa(Eb,Ua),3);case 501:return new ca(new N(Eb,Ua));case 502:return new ia(new Na(Eb,Ua));case 601:return new Y(new Za(Eb,Ua),0);case 602:return new Y(new Za(Eb,Ua),1);case 603:return new fa(new Za(Eb,Ua));case 604:return new pa(new Na(Eb,Ua),0);case 605:return new pa(new Na(Eb,Ua),1);case 606:return new pa(new Na(Eb,Ua),2);case 607:return new pa(new Na(Eb,Ua),3);case 701:return new da(!1);
case 702:return new da(!0);case 703:return new T(new Ya(Eb,Ua),!1);case 704:return new T(new Ya(Eb,Ua),!0);case 705:return new U(new Ya(Eb,Ua),!1);case 706:return new U(new Ya(Eb,Ua),!0);case 707:return new Ma(new Ga(Eb,Ua));case 901:return new zb(new Tb(Eb,Ua));case 1002:return new Ja(new Na(Eb,Ua));case 1001:return new Xb(new jb(Eb,Ua));default:throw Error.argument("initData");}}}Object(h.a)(oc,"FilterFactory",null,[1298]);var wb=d(140);class rc{constructor(Aa){this.Ka=Aa}get wy(){return this.Ka.wy}get iV(){return this.Ka.iV}get Dwd(){return this.Ka.Dwd}get C1c(){return this.Ka.C1c}load(Aa,
Ua){return this.zp(Aa,Aa?new ha("root",Aa,Ua):Ua)}store(Aa,Ua,gb){this.EPb(Aa,Ua,Aa?new ha("root",Aa,gb):gb,null)}zp(Aa,Ua){if(!this.C1c&&!this.Ka.annotations.pBb(this.wy,Aa))throw Error.argument("input","Input value not of expected type");let gb=this.Ka.$2f;for(;gb;)Aa=gb.load(Aa,Ua),gb=gb.next;return Aa}EPb(Aa,Ua,gb,Eb){if(!this.Dwd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.C1c&&!this.Ka.annotations.pBb(this.wy,Aa))throw Error.argument("lvalue",
"Lvalue not of expected type");if(!this.Ka.annotations.pBb(this.iV,Ua))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ka.$2f.store(Aa,Ua,gb,Eb)}static sNf(Aa,Ua,gb,Eb){if(gb===Eb)return Ua;if(Q.Annotations.rC(gb)&&Q.Annotations.rC(Eb)){gb=Q.Annotations.REa(gb);Eb=Q.Annotations.REa(Eb);const Ub=new wb.a(Aa,Eb);for(const vc of Ua.items)Array.add(Ub.items,rc.sNf(Aa,vc,gb,Eb));return Ub}if(gb===Q.Annotations.Wpa){if(Eb===Q.Annotations.Bba)return Ua;if(Eb===Q.Annotations.yZ)return Ua.toString()}else if(gb===
Q.Annotations.Bba){if(Eb===Q.Annotations.Wpa)return Math.floor(Ua);if(Eb===Q.Annotations.yZ)return Ua.toString()}else if(gb===Q.Annotations.yZ){if(Eb===Q.Annotations.Wpa)return parseInt(Ua);if(Eb===Q.Annotations.Bba)return parseFloat(Ua)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(h.a)(rc,"AnnotationQuery",null,[1316]);class Ka{constructor(){this.iV=this.wy=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}VEa(Aa){if(this.next)return{returnValue:this.next,
Lpa:Aa};if(Aa){const Ua=Aa.nPf;Aa=Aa.kkh;return{returnValue:Ua,Lpa:Aa}}return{returnValue:null,Lpa:Aa}}}Object(h.a)(Ka,"AnnotationQueryStep",null,[1321]);class Db extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){Ua=this.Ka.query.zp(Aa,Ua);if(Q.Annotations.rC(this.wy)){var gb=Q.Annotations.REa(this.wy);let Ub=new wb.a(this.Ka.annotations,gb);if(Q.Annotations.rC(this.Ka.query.iV)){if(Aa.items.length!==Ua.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");
for(let vc=0,jd=Aa.items.length;vc<jd;++vc)Array.add(Ub.items,this.sMc(Aa.items[vc],Ua.items[vc],gb===Q.Annotations.Bba))}else for(var Eb of Aa.items)Array.add(Ub.items,this.sMc(Eb,Ua,gb===Q.Annotations.Bba));return Ub}if(Q.Annotations.rC(this.Ka.query.iV)){Eb=new wb.a(this.Ka.annotations,this.wy);for(gb of Ua.items)Array.add(Eb.items,this.sMc(Aa,gb,this.wy===Q.Annotations.Bba));return Eb}return this.sMc(Aa,Ua,this.wy===Q.Annotations.Bba)}sMc(Aa,Ua,gb){Aa=this.xub(Aa,Ua);return gb?Aa:Math.floor(Aa)}}
Object(h.a)(Db,"NumericAnnotationQueryStep",Ka,[]);class bc extends Db{constructor(Aa){super(Aa)}xub(Aa,Ua){return Aa+Ua}}Object(h.a)(bc,"AddAnnotationQueryStep",Db,[]);class Mc extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){if(this.wy===Q.Annotations.qha&&this.Ka.query.iV===Q.Annotations.qha){let Ub;if(({result:Ub}=this.cKf(Aa)).returnValue)return Ub}if(Q.Annotations.rC(this.wy)){var gb=new wb.a(this.Ka.annotations,Q.Annotations.qha);Ua=this.Ka.query.zp(Aa,Ua);if(Q.Annotations.rC(this.Ka.query.iV)){if(Aa.items.length!==
Ua.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Ub=0,vc=Aa.items.length;Ub<vc;++Ub)Array.add(gb.items,this.W2b(Ua.items[Ub],Aa.items[Ub]))}else for(var Eb of Aa.items)Array.add(gb.items,this.W2b(Ua,Eb));return gb}Eb=this.Ka.query.zp(Aa,Ua);if(Q.Annotations.rC(this.Ka.query.iV)){Ua=new wb.a(this.Ka.annotations,Q.Annotations.qha);for(gb of Eb.items)Array.add(Ua.items,this.W2b(gb,Aa));return Ua}return this.W2b(Eb,Aa)}}Object(h.a)(Mc,"BinaryBooleanAnnotationQueryStep",
Ka,[]);class mb extends Mc{constructor(Aa){super(Aa)}cKf(Aa){return{returnValue:!Aa,result:!1}}W2b(Aa,Ua){return Aa&&Ua}}Object(h.a)(mb,"AndAnnotationQueryStep",Mc,[]);class Wa{constructor(Aa){Aa&&(this.annotations=Aa)}}Object(h.a)(Wa,"AnnotationsOnlyQueryStepInit",null,[]);class db extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){Ua=this.Ka.query.zp(Aa,Ua);Aa=Aa.clone();Q.Annotations.rC(this.Ka.query.iV)?Array.addRange(Aa.items,Ua.items):Array.add(Aa.items,Ua);return Aa}}Object(h.a)(db,
"AppendAnnotationQueryStep",Ka,[]);class ub extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){if(this.wy===Q.Annotations.mN)return this.f6b(Aa,Ua);const gb=new wb.a(this.Ka.annotations,Q.Annotations.mN);for(const Eb of Aa.items)Array.add(gb.items,this.f6b(Eb,Ua));return gb}f6b(Aa,Ua){const gb=new C.a(this.Ka.annotations);gb.qDa(Aa);Aa=new C.a(this.Ka.annotations);this.Ka.script.V8(null,new ha("Input",gb,new ha("Output",Aa,Ua)));return Aa}}Object(h.a)(ub,"ApplyAnnotationQueryStep",Ka,[]);class Lb extends Ka{constructor(Aa){super();
this.Ka=Aa}load(Aa,Ua){if(this.wy===Q.Annotations.mN)return Ua=this.f6b(Aa,Ua),Ua.ln(this.Ka.RCf).returnValue||new wb.a(this.Ka.annotations,Q.Annotations.mN),Ua;const gb=new wb.a(this.Ka.annotations,Q.Annotations.mN);for(const Eb of Aa.items)if(Aa=this.f6b(Eb,Ua),({value:Aa}=Aa.ln(this.Ka.RCf)).returnValue)for(const Ub of Aa.items)Array.add(gb.items,Ub);return gb}f6b(Aa,Ua){const gb=new C.a(this.Ka.annotations);gb.qDa(Aa);Aa=new C.a(this.Ka.annotations);this.Ka.script.V8(null,new ha("Input",gb,new ha("Output",
Aa,Ua)));return Aa}}Object(h.a)(Lb,"ApplyExpandAnnotationQueryStep",Ka,[]);class Kb{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.script=Ua.K$a(Aa.ga(0)),this.RCf=Aa.ga(1))}}Object(h.a)(Kb,"ApplyExpandQueryStepInit",null,[]);class uc{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.script=Ua.K$a(Aa.ga(0)))}}Object(h.a)(uc,"ApplyQueryStepInit",null,[]);class Yb extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){if(this.wy===Q.Annotations.mN)return this.Q5c(Aa);const Ua=
new wb.a(this.Ka.annotations,this.Ka.annotations.getAttributeType(this.Ka.Vca));for(const gb of Aa.items)Array.add(Ua.items,this.Q5c(gb));return Ua}store(Aa,Ua,gb,Eb){if(this.wy===Q.Annotations.mN){var Ub=Ua,vc=({Lpa:Eb}=this.VEa(Eb)).returnValue;vc&&(Ub=vc.store(Q.Annotations.rL(this.Q5c(Aa)),Ua,gb,Eb));Aa.Iu(this.Ka.Vca,Ub)}else{var jd=Ua;if(Ub=({Lpa:Eb}=this.VEa(Eb)).returnValue){jd=new wb.a(this.Ka.annotations,this.Ka.annotations.getAttributeType(this.Ka.Vca));for(vc of Aa.items)Array.add(jd.items,
this.Q5c(vc));jd=Ub.store(jd,Ua,gb,Eb)}Ua=jd;if(Ua.items.length!==Aa.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Id=0,Od=Aa.items.length;Id<Od;++Id)gb=Aa.items[Id],gb.isReadOnly&&(gb=gb.clone(),Aa.items[Id]=gb),gb.Iu(this.Ka.Vca,Ua.items[Id])}return Aa}Q5c(Aa){({value:Aa}=Aa.ln(this.Ka.Vca)).returnValue||(Aa=this.Ka.annotations.Zdj(this.Ka.Vca));return Aa}}Object(h.a)(Yb,"AttrAnnotationQueryStep",Ka,[]);class Tc{constructor(Aa,Ua){Aa&&
(this.annotations=Ua,this.Vca=Aa.ga(0))}}Object(h.a)(Tc,"AttrQueryStepInit",null,[]);class sc extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){const Ua=new C.a(this.Ka.annotations);Ua.qDa(Aa);return this.Ka.module.execute(Ua)}}Object(h.a)(sc,"CallModuleAnnotationQueryStep",Ka,[]);class Qb{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.module=Ua.Nce(Aa.ga(0)))}}Object(h.a)(Qb,"CallModuleQueryStepInit",null,[]);class kb extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){if(Q.Annotations.rC(this.wy)){var gb=
this.Ka.query.zp(Aa,Ua);Ua=new wb.a(this.Ka.annotations,Q.Annotations.yZ);let vc="string"===typeof gb;for(var Eb of Aa.items)if(vc)Array.add(Ua.items,Eb+gb);else for(var Ub of gb.items)Array.add(Ua.items,Eb+Ub);return Ua}Eb=this.Ka.query.zp(Aa,Ua);if("string"===typeof Eb)return Aa+Eb;Ub=new wb.a(this.Ka.annotations,Q.Annotations.yZ);for(gb of Eb.items)Array.add(Ub.items,Aa+gb);return Ub}}Object(h.a)(kb,"ConcatAnnotationQueryStep",Ka,[]);class Ib extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){return rc.sNf(this.Ka.annotations,
Aa,this.wy,this.iV)}}Object(h.a)(Ib,"ConvertAnnotationQueryStep",Ka,[]);class eb extends Ka{constructor(){super()}load(Aa){return Aa.items.length}}Object(h.a)(eb,"CountAnnotationQueryStep",Ka,[]);class Rb extends Db{constructor(Aa){super(Aa)}xub(Aa,Ua){return Aa/Ua}}Object(h.a)(Rb,"DivideAnnotationQueryStep",Db,[]);class pc extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){Ua=new ha(this.Ka.tAd,null,Ua);for(const gb of Aa.items)if(Ua.xZd(gb),this.Ka.query.zp(gb,Ua))return!0;return!1}}Object(h.a)(pc,
"ExistsAnnotationQueryStep",Ka,[]);class Wc extends Db{constructor(Aa){super(Aa)}xub(Aa,Ua){return Math.pow(Aa,Ua)}}Object(h.a)(Wc,"ExpAnnotationQueryStep",Db,[]);class Ic{constructor(Aa,Ua){Aa&&(this.yta=Ua.YC(Aa.ga(0)))}}Object(h.a)(Ic,"FeatureBundleNameQueryStepInit",null,[]);class nd extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){if(Q.Annotations.rC(this.wy)){const Ua=new wb.a(this.Ka.annotations,this.Ka.annotations.Iab(Q.Annotations.REa(this.wy),this.Ka.zta));for(const gb of Aa.items)Array.add(Ua.items,
gb.cUa(this.Ka.zta));return Ua}return Aa.cUa(this.Ka.zta)}store(Aa,Ua,gb,Eb){if(Q.Annotations.rC(this.wy)){var Ub=Ua,vc=({Lpa:Eb}=this.VEa(Eb)).returnValue;if(vc){Ub=new wb.a(this.Ka.annotations,this.Ka.annotations.Iab(Q.Annotations.REa(this.wy),this.Ka.zta));for(var jd of Aa.items)Array.add(Ub.items,jd.cUa(this.Ka.zta));Ub=vc.store(Ub,Ua,gb,Eb)}Ua=Ub;if(Ua.items.length!==Aa.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Id=0,Od=Aa.items.length;Id<
Od;++Id)gb=Aa.items[Id],gb.isReadOnly&&(gb=gb.clone(),Aa.items[Id]=gb),gb.B0e(this.Ka.zta,Ua.items[Id])}else vc=Ua,(jd=({Lpa:Eb}=this.VEa(Eb)).returnValue)&&(vc=jd.store(Q.Annotations.rL(Aa.cUa(this.Ka.zta)),Ua,gb,Eb)),Aa.B0e(this.Ka.zta,vc);return Aa}}Object(h.a)(nd,"FieldAnnotationQueryStep",Ka,[]);class ob{constructor(Aa,Ua){Aa&&(this.annotations=Ua,this.zta=Aa.ga(0))}}Object(h.a)(ob,"FieldQueryStepInit",null,[]);class $b extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){for(const gb of Aa.items)if(this.Ka.filter.isMatch(gb,
Ua))return gb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Aa,Ua,gb,Eb){let Ub=Ua,vc=-1;for(let Id=0,Od=Aa.items.length;Id<Od;Id++)if(this.Ka.filter.isMatch(Aa.items[Id],gb)){vc=Id;break}if(0>vc)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const jd=({Lpa:Eb}=this.VEa(Eb)).returnValue;jd&&(Ub=jd.store(Q.Annotations.rL(Aa.items[vc]),Ua,gb,Eb));Aa.items[vc]=Ub;return Aa}}Object(h.a)($b,"FirstItemMatchingAnnotationQueryStep",
Ka,[]);class Hc extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){Ua=new ha(this.Ka.tAd,null,Ua);for(const gb of Aa.items)if(Ua.xZd(gb),!this.Ka.query.zp(gb,Ua))return!1;return!0}}Object(h.a)(Hc,"ForAllAnnotationQueryStep",Ka,[]);class Pb extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){Aa=Ua?Ua.iWc(this.Ka.yta):null;if(!Aa)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ka.yta+'"');return Aa}store(Aa,Ua,gb,Eb){Aa=gb?gb.iWc(this.Ka.yta):null;if(!Aa)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ka.yta+'"');let Ub=Ua;const vc=({Lpa:Eb}=this.VEa(Eb)).returnValue;vc&&(Ub=vc.store(Aa,Ua,gb,Eb));Aa!==Ub&&Aa.qDa(Ub);return Aa}}Object(h.a)(Pb,"GetAnnotationQueryStep",Ka,[]);class Yc{constructor(Aa,Ua){this.bZh=Aa;this.B7h=Ua}get nPf(){return this.bZh}get kkh(){return this.B7h}}Object(h.a)(Yc,"AnnotationQueryStoreContinuation",null,[1322]);class Rd extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){return this.Ka.mxd.zp(Aa,Ua)?this.Ka.JMh.zp(Aa,Ua):this.Ka.hTc?this.Ka.hTc.zp(Aa,Ua):
Aa}store(Aa,Ua,gb,Eb){var Ub=this.Ka.mxd.zp(Aa,gb);this.next&&(Eb=new Yc(this.next,Eb));if(Ub)return this.Ka.JMh.EPb(Aa,Ua,gb,Eb);if(this.Ka.hTc)return this.Ka.hTc.EPb(Aa,Ua,gb,Eb);Ub=Ua;let vc=null;Eb&&(vc=Eb.nPf,Eb=Eb.kkh);vc&&(Ub=vc.store(Q.Annotations.rL(Aa),Ua,gb,Eb));return Ub}}Object(h.a)(Rd,"IfAnnotationQueryStep",Ka,[]);class Gb{constructor(Aa,Ua){Aa&&(this.mxd=Ua.lE(Aa.ga(0)),this.JMh=Ua.lE(Aa.ga(1)),this.hTc=Aa.ga(2)?Ua.lE(Aa.ga(2)):null)}}Object(h.a)(Gb,"IfQueryStepInit",null,[]);class Bb{constructor(Aa,
Ua){Aa&&(this.GPj=Ua.lE(Aa.ga(0)),this.Gvg=Ua.lE(Aa.ga(1)))}}Object(h.a)(Bb,"IndexAndItemQueryStepInit",null,[]);class dc extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){const gb=this.Ka.GPj.zp(Aa,Ua);Ua=this.Ka.Gvg.zp(Aa,Ua);Aa=Aa.clone();if(0>gb||gb>Aa.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(Q.Annotations.rC(this.Ka.Gvg.iV))for(let Eb=0;Eb<Ua.items.length;++Eb)Array.insert(Aa.items,gb+Eb,Ua.items[Eb]);else Array.insert(Aa.items,gb,Ua);
return Aa}}Object(h.a)(dc,"InsertAtAnnotationQueryStep",Ka,[]);class Xc extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){return!(!Ua||!Ua.iWc(this.Ka.yta))}}Object(h.a)(Xc,"IsDefinedAnnotationQueryStep",Ka,[]);class Fb extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){Ua=this.Byb(Aa,Ua);return Aa.items[Ua]}store(Aa,Ua,gb,Eb){const Ub=this.Byb(Aa,gb);let vc=Ua;const jd=({Lpa:Eb}=this.VEa(Eb)).returnValue;jd&&(vc=jd.store(Q.Annotations.rL(Aa.items[Ub]),Ua,gb,Eb));Aa.items[Ub]=vc;return Aa}Byb(Aa,
Ua){Ua=this.Ka.query.zp(Aa,Ua);if(0>Ua||Ua>=Aa.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ua}}Object(h.a)(Fb,"ItemAnnotationQueryStep",Ka,[]);class kd extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){const gb=new wb.a(this.Ka.annotations,Q.Annotations.REa(this.wy));for(const Eb of Aa.items)this.Ka.filter.isMatch(Eb,Ua)&&Array.add(gb.items,Eb);return gb}}Object(h.a)(kd,"ItemsMatchingAnnotationQueryStep",Ka,[]);class od extends Ka{constructor(Aa){super();
this.Ka=Aa}load(Aa,Ua){Ua=this.Byb(Aa,Ua);return Aa.items[Aa.items.length-Ua-1]}store(Aa,Ua,gb,Eb){const Ub=this.Byb(Aa,gb);let vc=Ua;const jd=({Lpa:Eb}=this.VEa(Eb)).returnValue;jd&&(vc=jd.store(Q.Annotations.rL(Aa.items[Aa.items.length-Ub-1]),Ua,gb,Eb));Aa.items[Aa.items.length-Ub-1]=vc;return Aa}Byb(Aa,Ua){Ua=this.Ka.query?this.Ka.query.zp(Aa,Ua):0;if(0>Ua||Ua>=Aa.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ua}}Object(h.a)(od,"LastItemAnnotationQueryStep",
Ka,[]);class Gd extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){if(Q.Annotations.rC(this.wy)){const Ua=new wb.a(this.Ka.annotations,Q.Annotations.Wpa);for(const gb of Aa.items)Array.add(Ua.items,gb.length);return Ua}return Aa.length}}Object(h.a)(Gd,"LengthAnnotationQueryStep",Ka,[]);class Fd extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){if(Q.Annotations.rC(this.wy)){const gb=new wb.a(this.Ka.annotations,Q.Annotations.qha);for(const Eb of Aa.items)Array.add(gb.items,this.Ka.filter.isMatch(Eb,
Ua));return gb}return this.Ka.filter.isMatch(Aa,Ua)}}Object(h.a)(Fd,"MatchesAnnotationQueryStep",Ka,[]);class ee extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){return this.Ka.filter.isMatch(Aa,Ua)}}Object(h.a)(ee,"MatchesAsListAnnotationQueryStep",Ka,[]);class Bf extends Db{constructor(Aa){super(Aa)}xub(Aa,Ua){return Aa%Ua}}Object(h.a)(Bf,"ModuloAnnotationQueryStep",Db,[]);class be extends Db{constructor(Aa){super(Aa)}xub(Aa,Ua){return Aa*Ua}}Object(h.a)(be,"MultiplyAnnotationQueryStep",
Db,[]);class af extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){if(Q.Annotations.rC(this.wy)){const Ua=new wb.a(this.Ka.annotations,Q.Annotations.qha);for(const gb of Aa.items)Array.add(Ua.items,!gb);return Ua}return!Aa}}Object(h.a)(af,"NotAnnotationQueryStep",Ka,[]);class Ue extends Mc{constructor(Aa){super(Aa)}cKf(Aa){return{returnValue:Aa,result:!0}}W2b(Aa,Ua){return Aa||Ua}}Object(h.a)(Ue,"OrAnnotationQueryStep",Mc,[]);class qf extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){const gb=
this.Ka.y5e.zp(Aa,Ua);Aa=this.Ka.w3b.zp(Aa,Ua);Ua=new wb.a(this.Ka.annotations,Q.Annotations.Wpa);for(let Eb=0;Eb<Aa;++Eb)Array.add(Ua.items,gb+Eb);return Ua}}Object(h.a)(qf,"RangeAnnotationQueryStep",Ka,[]);class Xa{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.filter=Ua.i9(Aa.ga(0)))}}Object(h.a)(Xa,"SingleFilterQueryStepInit",null,[]);class vb{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.query=Aa.ga(0)?Ua.lE(Aa.ga(0)):null)}}Object(h.a)(vb,"SingleOptionalQueryQueryStepInit",
null,[]);class cc{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.query=Ua.lE(Aa.ga(0)))}}Object(h.a)(cc,"SingleQueryQueryStepInit",null,[]);class wc{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.y5e=Ua.lE(Aa.ga(0)),this.w3b=Aa.ga(1)?Ua.lE(Aa.ga(1)):null)}}Object(h.a)(wc,"StartAndCountOrLengthQueryStepInit",null,[]);class Ad extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){let gb;({uMa:Ua,length:gb}=this.lYc(Aa,Ua));const Eb=new wb.a(this.Ka.annotations,Aa.VU);
for(let Ub=0;Ub<gb;++Ub)Array.add(Eb.items,Aa.items[Ua+Ub]);return Eb}store(Aa,Ua,gb,Eb){let Ub,vc;({uMa:Ub,length:vc}=this.lYc(Aa,gb));var jd=Ua;const Id=({Lpa:Eb}=this.VEa(Eb)).returnValue;if(Id){jd=new wb.a(this.Ka.annotations,Aa.VU);for(let Od=0;Od<vc;++Od)Array.add(jd.items,Aa.items[Ub+Od]);jd=Id.store(jd,Ua,gb,Eb)}Ua=jd;for(gb=0;gb<vc;++gb)Array.removeAt(Aa.items,Ub);for(let Od=0,ba=Ua.items.length;Od<ba;++Od)Array.insert(Aa.items,Ub+Od,Ua.items[Od]);return Aa}lYc(Aa,Ua){let gb;gb=this.Ka.y5e.zp(Aa,
Ua);if(0>gb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ua=this.Ka.w3b?this.Ka.w3b.zp(Aa,Ua):Aa.items.length-gb;if(0>Ua||gb+Ua>Aa.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{uMa:gb,length:Ua}}}Object(h.a)(Ad,"SublistAnnotationQueryStep",Ka,[]);class Md extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa,Ua){if(Q.Annotations.rC(this.wy)){const gb=new wb.a(this.Ka.annotations,Q.Annotations.yZ);for(let Eb=
0,Ub=Aa.items.length;Eb<Ub;++Eb)Array.add(gb.items,this.getSubstring(Aa.items[Eb],Ua));return gb}return this.getSubstring(Aa,Ua)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(Aa,Ua){let gb;({uMa:Ua,length:gb}=this.lYc(Aa,Ua));return Aa.substr(Ua,gb)}lYc(Aa,Ua){let gb;gb=this.Ka.y5e.zp(Aa,Ua);if(0>gb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ua=this.Ka.w3b?this.Ka.w3b.zp(Aa,Ua):Aa.length-gb;if(0>Ua||gb+Ua>
Aa.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{uMa:gb,length:Ua}}}Object(h.a)(Md,"SubstringAnnotationQueryStep",Ka,[]);class Sd extends Db{constructor(Aa){super(Aa)}xub(Aa,Ua){return Aa-Ua}}Object(h.a)(Sd,"SubtractAnnotationQueryStep",Db,[]);class Le extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){const Ua=new wb.a(this.Ka.annotations,Q.Annotations.yZ);for(let gb=0;gb<Aa.length;++gb)Array.add(Ua.items,Aa.charAt(gb).toString());
return Ua}}Object(h.a)(Le,"ToCharListAnnotationQueryStep",Ka,[]);class fe extends Ka{constructor(Aa){super();this.Ka=Aa}load(Aa){const Ua=new wb.a(this.Ka.annotations,this.wy);Array.add(Ua.items,Aa);return Ua}}Object(h.a)(fe,"ToListAnnotationQueryStep",Ka,[]);class Vf extends Ka{constructor(Aa){super();this.Ka=Aa}load(){return this.Ka.value}}Object(h.a)(Vf,"ValueAnnotationQueryStep",Ka,[]);class Cd{constructor(Aa,Ua){if(Aa){var gb=Aa.ga(0),Eb=1;this.value=({x4:Eb}=Ua.Xsa(gb,Aa,Eb,null,null,null)).returnValue;
Q.Annotations.xdb(this.value)}}}Object(h.a)(Cd,"ValueQueryStepInit",null,[]);class Sc{constructor(Aa,Ua){Aa&&(this.tAd=Ua.YC(Aa.ga(0)),this.query=Ua.lE(Aa.ga(1)))}}Object(h.a)(Sc,"VarNameAndQueryQueryStepInit",null,[]);class jg{constructor(Aa,Ua){this.tif=null;if(Aa){this.annotations=Ua.annotations;var gb=0;this.wy=Aa.ga(gb);++gb;this.iV=Aa.ga(gb);++gb;this.Dwd=1===Aa.ga(gb);++gb;this.C1c=1===Aa.ga(gb);++gb;var Eb=Aa.ga(gb);++gb;if(Eb){var Ub=gb,vc=gb+Eb,jd=gb+2*Eb;gb+=3*Eb;var Id=Aa.count-gb,Od=
null;for(let Da=0;Da<Eb;++Da){var ba=gb+Aa.ga(jd+Da);const Qa=(Da===Eb-1?Id:Aa.ga(jd+Da+1))-Aa.ga(jd+Da),nb=new sb.a;nb.FTa(Aa,ba,Qa);ba=jg.ypj(Aa.ga(vc+Da),nb,Ua);ba.wy=Aa.ga(Ub+Da);ba.iV=Da===Eb-1?this.iV:Aa.ga(Ub+Da+1);Od?Od.next=ba:this.tif=ba;Od=ba}}}}get $2f(){return this.tif}static ypj(Aa,Ua,gb){switch(Aa){case 1:return new Pb(new Ic(Ua,gb));case 2:return new Xc(new Ic(Ua,gb));case 3:return new Yb(new Tc(Ua,gb.annotations));case 4:return new nd(new ob(Ua,gb.annotations));case 5:return new Rd(new Gb(Ua,
gb));case 6:return new Fd(new Xa(Ua,gb));case 43:return new ee(new Xa(Ua,gb));case 45:return new ub(new uc(Ua,gb));case 49:return new Lb(new Kb(Ua,gb));case 46:return new Vf(new Cd(Ua,gb.annotations));case 51:return new sc(new Qb(Ua,gb));case 52:return new qf(new wc(Ua,gb));case 53:return new Ib(new Wa(gb.annotations));case 13:return new Fb(new cc(Ua,gb));case 14:return new od(new vb(Ua,gb));case 15:return new eb;case 18:return new $b(new Xa(Ua,gb));case 16:return new Hc(new Sc(Ua,gb));case 17:return new pc(new Sc(Ua,
gb));case 22:return new dc(new Bb(Ua,gb));case 24:return new db(new cc(Ua,gb));case 26:return new Ad(new wc(Ua,gb));case 27:return new kd(new Xa(Ua,gb));case 30:return new fe(new Wa(gb.annotations));case 31:return new Md(new wc(Ua,gb));case 32:return new kb(new cc(Ua,gb));case 47:return new Gd(new Wa(gb.annotations));case 48:return new Le(new Wa(gb.annotations));case 34:return new bc(new cc(Ua,gb));case 35:return new Sd(new cc(Ua,gb));case 36:return new be(new cc(Ua,gb));case 37:return new Rb(new cc(Ua,
gb));case 38:return new Bf(new cc(Ua,gb));case 39:return new Wc(new cc(Ua,gb));case 40:return new mb(new cc(Ua,gb));case 41:return new Ue(new cc(Ua,gb));case 42:return new af(new Wa(gb.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(jg,"AnnotationQueryInit",null,[]);class mg{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){this.V8(Aa,Aa?new ha("root",Aa,Ua):Ua)}V8(Aa,Ua){for(const gb of this.Ka.commands)Ua=gb.execute(Aa,Ua)}}Object(h.a)(mg,"AnnotationScript",null,[1315]);class Pa{constructor(Aa){this.Ka=
Aa}execute(Aa,Ua){const gb=this.Ka.uTj.zp(Aa,Ua),Eb=this.Ka.fPk.zp(Aa,Ua);this.Ka.script.V8(Aa,new ha("Input",gb,new ha("Output",Eb,Ua)));return Ua}}Object(h.a)(Pa,"ApplyAnnotationScriptCommand",null,[1319]);class bb{constructor(Aa,Ua){Aa&&(this.uTj=Ua.lE(Aa.ga(0)),this.fPk=Ua.lE(Aa.ga(1)),this.script=Ua.K$a(Aa.ga(2)))}}Object(h.a)(bb,"ApplyScriptCommandInit",null,[]);class Fc{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){const gb=this.Ka.DZe.zp(Aa,Ua);this.Ka.l6c.EPb(Aa,gb,Ua,null);return Ua}}Object(h.a)(Fc,
"AssignAnnotationScriptCommand",null,[1319]);class yd{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){const gb=this.Ka.l6c.zp(Aa,Ua);Aa=this.Ka.DZe.zp(Aa,Ua);gb!==Aa&&gb.qDa(Aa);return Ua}}Object(h.a)(yd,"CopyAnnotationScriptCommand",null,[1319]);class ge{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){let gb=this.Ka.qte.zp(Aa,Ua);if(this.Ka.qte.Dwd){gb=Q.Annotations.rL(gb);var Eb=new ha(this.Ka.yta,null,Ua);for(let vc=0,jd=gb.items.length;vc<jd;++vc){var Ub=this.x_f(Aa,gb.items[vc],Eb);if(0>this.Ka.Yqd)gb.items[vc]=
Ub;else if(({value:Ub}=Ub.ln(this.Ka.Yqd)).returnValue)gb.items[vc]=Ub;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ka.qte.EPb(Aa,gb,Ua,null)}else{Eb=new ha(this.Ka.yta,null,Ua);for(let vc=0,jd=gb.items.length;vc<jd;++vc)this.x_f(Aa,gb.items[vc],Eb)}return Ua}x_f(Aa,Ua,gb){let Eb;0>this.Ka.Yqd?Eb=Q.Annotations.rL(Ua):(Eb=new C.a(this.Ka.annotations),Eb.Iu(this.Ka.Yqd,Ua));gb.xZd(Eb);this.Ka.$si.V8(Aa,gb);return Eb}}Object(h.a)(ge,"EnumerateAnnotationScriptCommand",
null,[1319]);class rb{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.yta=Ua.YC(Aa.ga(0)),this.qte=Ua.lE(Aa.ga(1)),this.$si=Ua.K$a(Aa.ga(2)),this.Yqd=Aa.ga(3))}}Object(h.a)(rb,"EnumerateScriptCommandInit",null,[]);class gf{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){this.Ka.mxd.zp(Aa,Ua)?this.Ka.ONl.V8(Aa,Ua):this.Ka.i1f&&this.Ka.i1f.V8(Aa,Ua);return Ua}}Object(h.a)(gf,"IfAnnotationScriptCommand",null,[1319]);class Ab{constructor(Aa,Ua){Aa&&(this.mxd=Ua.lE(Aa.ga(0)),this.ONl=Ua.K$a(Aa.ga(1)),
this.i1f=Aa.ga(2)?Ua.K$a(Aa.ga(2)):null)}}Object(h.a)(Ab,"IfScriptCommandInit",null,[]);class fc{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.l6c=Ua.lE(Aa.ga(0)),this.DZe=Ua.lE(Aa.ga(1)))}}Object(h.a)(fc,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class kc{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){const gb=this.Ka.DZe.zp(this.Ka.l6c.zp(Aa,Ua),Ua);this.Ka.l6c.EPb(Aa,gb,Ua,null);return Ua}}Object(h.a)(kc,"ModifyAnnotationScriptCommand",null,[1319]);class ud{constructor(Aa){this.Ka=
Aa}execute(Aa,Ua){const gb=new C.a(this.Ka.annotations);this.Ka.query&&gb.qDa(this.Ka.query.zp(Aa,Ua));return Ua=new ha(this.Ka.yta,gb,Ua)}}Object(h.a)(ud,"NewAnnotationScriptCommand",null,[1319]);class zd{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.yta=Ua.YC(Aa.ga(0)),this.query=Aa.ga(1)?Ua.lE(Aa.ga(1)):null)}}Object(h.a)(zd,"NewScriptCommandInit",null,[]);class Td{constructor(Aa){this.Ka=Aa}execute(Aa,Ua){Aa=this.Ka.query.zp(Aa,Ua);if(this.Ka.query.iV===Q.Annotations.mN)Aa.Tpd(this.Ka.Vca);
else for(const gb of Aa.items)gb.Tpd(this.Ka.Vca);return Ua}}Object(h.a)(Td,"RemoveAnnotationScriptCommand",null,[1319]);class Me{constructor(Aa,Ua){Aa&&(this.annotations=Ua.annotations,this.query=Ua.lE(Aa.ga(0)),this.Vca=Aa.ga(1))}}Object(h.a)(Me,"RemoveScriptCommandInit",null,[]);class tf{constructor(Aa,Ua){if(Aa){var gb=0,Eb=Aa.ga(gb);++gb;if(Eb){var Ub=gb,vc=gb+Eb;gb+=2*Eb;var jd=Aa.count-gb;this.commands=Array(Eb);for(let Id=0;Id<Eb;++Id){const Od=gb+Aa.ga(vc+Id),ba=(Id===Eb-1?jd:Aa.ga(vc+Id+
1))-Aa.ga(vc+Id),Da=new sb.a;Da.FTa(Aa,Od,ba);this.commands[Id]=tf.upj(Aa.ga(Ub+Id),Da,Ua)}}}}static upj(Aa,Ua,gb){switch(Aa){case 1:return new Fc(new fc(Ua,gb));case 2:return new kc(new fc(Ua,gb));case 3:return new Td(new Me(Ua,gb));case 6:return new ud(new zd(Ua,gb));case 7:return new ge(new rb(Ua,gb));case 8:return new gf(new Ab(Ua,gb));case 9:return new yd(new fc(Ua,gb));case 10:return new Pa(new bb(Ua,gb));default:throw Error.argument("initData");}}}Object(h.a)(tf,"AnnotationScriptInit",null,
[]);var re=d(722);class lh{constructor(Aa){this.rI=Aa;this.wN=0}VY(){const Aa=this.rI.Hu(this.wN,4);this.wN+=4;return Aa}get K0b(){return this.rI}get offset(){return this.wN}set offset(Aa){this.wN=Aa}}Object(h.a)(lh,"ByteArrayReader",null,[]);class ze{constructor(){this.jD=null;this.WHg=this.Gz=0}ga(Aa){if(0>Aa||Aa>=this.Gz)throw Error.argumentOutOfRange("index");return this.jD.Hu(this.WHg+4*Aa,4)}get count(){return this.Gz}static sOi(Aa,Ua,gb){const Eb=new ze;Eb.jD=Aa;Eb.WHg=Ua;Eb.Gz=gb;return Eb}}
Object(h.a)(ze,"ReadOnlyListOverByteArray",null,[1186]);class Je{constructor(Aa,Ua){this.IFg=this.qFg=!1;this.Pr=this.oxa=this.Tue=this.TFg=null;try{this.Pr=Ua.annotations;const gb=Ua.QTa(Aa.ga(0)),Eb=new lh(gb);if(-914743053!==Eb.VY())throw Error.argument("Input does not represent a flat lexicon");this.qFg=1===Eb.VY();this.IFg=1===Eb.VY();const Ub=Eb.VY();Eb.offset+=Ub;const vc=Eb.VY();this.Tue=Je.EQk(Eb,vc,this.Pr);const jd=Eb.VY();this.TFg=Je.RQk(Eb,jd);const Id=Eb.VY();this.oxa=new re.a(Eb.K0b,
Eb.offset);Eb.offset+=Id}catch(gb){throw Error.argument("initData");}}get trie(){return this.oxa}dfj(Aa){return"i"===Aa&&this.IFg?"\u0130":Aa.toUpperCase()}Zne(){return this.qFg}Ddj(Aa){let Ua;Ua=new wb.a(this.Pr,Q.Annotations.mN);if(1!==Aa)if(0===Aa)Aa=new C.a(this.Pr),Array.add(Ua.items,Aa);else if(Aa&1073741824){Aa=this.TFg[Aa&-1073741825];for(let Eb=0;Eb<Aa.length;++Eb){var gb=Aa[Eb];gb=0===gb?new C.a(this.Pr):this.Tue[gb-2];Array.add(Ua.items,gb)}}else Array.add(Ua.items,this.Tue[Aa-2]);return{returnValue:!0,
Lbk:Ua}}static EQk(Aa,Ua,gb){if(Ua%4)throw Error.argument("reader");const Eb=ze.sOi(Aa.K0b,Aa.offset,Ua/4);Aa.offset+=Ua;Aa=[];for(Ua=0;Ua<Eb.count;){const Ub=({x4:Ua}=gb.Xsa(Q.Annotations.mN,Eb,Ua,null,null,null)).returnValue;Array.add(Aa,Ub)}return Aa}static RQk(Aa,Ua){Ua=Aa.offset+Ua;const gb=[];for(;Aa.offset<Ua;){const Eb=Aa.VY(),Ub=Array(Eb);for(let vc=0;vc<Eb;++vc){const jd=Aa.VY();Ub[vc]=jd}Array.add(gb,Ub)}return gb}}Object(h.a)(Je,"RawFlatLexicon",null,[1314]);var Wh=d(711),Kg=d(712);class pd{constructor(Aa){if(null==
Aa)throw Error.argumentNull("base64String");const Ua=Aa.length;if(Ua%4)throw Error.argument("base64String's length must be a multiple of 4");this.Gz=.75*Ua;this.Pva=Array(Math.ceil(this.Gz/4));Aa.endsWith("==")?this.Gz-=2:Aa.endsWith("=")&&--this.Gz;let gb=0;for(let Eb=0;Eb<Ua;Eb+=4){const Ub=pd.Krd[Aa.charCodeAt(Eb)-43]<<18|pd.Krd[Aa.charCodeAt(Eb+1)-43]<<12|pd.Krd[Aa.charCodeAt(Eb+2)-43]<<6|pd.Krd[Aa.charCodeAt(Eb+3)-43];let vc=Ub>>16&255;this.Pva[Math.floor(gb/4)]|=vc<<gb%4*8;++gb;vc=Ub>>8&255;
this.Pva[Math.floor(gb/4)]|=vc<<gb%4*8;++gb;vc=Ub&255;this.Pva[Math.floor(gb/4)]|=vc<<gb%4*8;++gb}}get length(){return this.Gz}ga(Aa){if(0>Aa||Aa>=this.Gz)throw Error.argumentOutOfRange("i");return this.w6f(Aa)}Hu(Aa,Ua){if(0>Aa||0>Ua||Aa+Ua>this.Gz)throw Error.argument("Bad range");let gb=0;for(let Eb=0;Eb<Ua;++Eb)gb|=this.w6f(Aa+Eb)<<8*Eb;return gb}y4k(Aa,Ua){let gb=0,Eb=0,Ub=Math.floor(Aa/8);for(Aa%=8;Eb<Ua;){const vc=8-Aa>Ua-Eb?Ua-Eb:8-Aa,jd=this.ga(Ub);gb|=(jd>>Aa&~(255<<vc))<<Eb;Eb+=vc;++Ub;
Aa=0}return gb}w6f(Aa){return this.Pva[Math.floor(Aa/4)]>>Aa%4*8&255}}pd.Krd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(pd,"ByteArray",null,[]);class Nc{constructor(Aa,Ua,gb){this.Hy=Aa;this.plk=Ua;this.Mpk=gb;this.FIg=Array(Aa.b?Aa.b.length:0);this.cIe=new Wh.a(new Kg.a(this.QTa(this.Hy.s)));this.$X=Array(Aa.t.length);
this.MWh=new Q.Annotations(this.NTa(0),this)}get annotations(){return this.MWh}get KZi(){return this.Hy.d}Zoj(){if(!(""in this.Hy.m))throw Error.argument("name","Unrecognized module");return this.Nce(this.Hy.m[""])}QTa(Aa){if(0>Aa||!this.Hy.b||Aa>=this.Hy.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.FIg[Aa]||(this.FIg[Aa]=new pd(this.Hy.b[Aa]))}YC(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not a string");
if(null==this.$X[Aa]){const Ua=this.NTa(Aa).ga(0);this.$X[Aa]=this.cIe.YC(Ua)}return this.$X[Aa]}Wbg(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.$X[Aa]){var Ua=this.NTa(Aa);const gb=this.YC(Ua.ga(0));Ua=1===Ua.ga(1);this.$X[Aa]=new RegExp(gb,Ua?"i":"")}return this.$X[Aa]}Stj(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Hy.t[Aa])throw Error.argument("blobID",
"Requested blob is not an SRE");throw Error.notImplemented();}Nce(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not an NL module");return this.$X[Aa]||(this.$X[Aa]=this.Mpk.opj(this.NTa(Aa),this))}lE(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not an annotation query");return this.$X[Aa]||(this.$X[Aa]=
new rc(new jg(this.NTa(Aa),this)))}K$a(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not an annotation script");return this.$X[Aa]||(this.$X[Aa]=new mg(new tf(this.NTa(Aa),this)))}i9(Aa){if(1>Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not a filter");return this.$X[Aa]||(this.$X[Aa]=this.plk.i9(this.NTa(Aa),this))}ysj(Aa){if(1>
Aa||Aa>=this.Hy.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Hy.t[Aa])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.$X[Aa]||(this.$X[Aa]=new Je(this.NTa(Aa),this))}NTa(Aa){const Ua=this.Hy.n[Aa];Aa=(Aa<this.Hy.t.length-1?this.Hy.n[Aa+1]:this.Hy.n.length)-Ua;if(0>Ua||0>Aa||Ua+Aa>this.Hy.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ua+","+Aa+")");const gb=new sb.a;gb.yUc(this.Hy.n,Ua,Aa);return gb}}Object(h.a)(Nc,
"ObjectFetcher",null,[1297]);class le{constructor(Aa,Ua,gb){if(!Aa)throw Error.argumentNull("prediction");if(!Ua)throw Error.argumentNull("fieldNames");if(!gb)throw Error.argumentNull("values");if(Ua.length!==gb.length)throw Error.argument("values","fieldNames and values do not have same length");this.q7h=Aa;this.Leb=Ua;this.Ahb=gb}get prediction(){return this.q7h}get x1f(){return this.Leb.length}gbe(Aa){return 0<=Aa&&Aa<this.Leb.length?this.Leb[Aa]:null}eb(Aa){return 0<=Aa&&Aa<this.Ahb.length?this.Ahb[Aa]:
null}}Object(h.a)(le,"PredictionData",null,[]);class Ye{constructor(Aa,Ua){if(!Aa)throw Error.argumentNull("predictions");if(!Ua)throw Error.argumentNull("tokenAttributes");this.osk=Aa;this.dwk=Ua}Ade(){return this.osk}L5f(){return this.dwk}}Object(h.a)(Ye,"PredictionDataWithTokenAttributes",null,[]);class Zc{constructor(Aa,Ua){this.prediction=null;this.score=0;this.prediction=Aa;this.score=Ua}}Object(h.a)(Zc,"PredictionWithScore",null,[]);class Jf{constructor(Aa,Ua){if(!Aa)throw Error.argumentNull("predictions");
if(!Ua)throw Error.argumentNull("attributes");this.r7h=Aa;this.jXh=Ua}Ade(){return this.r7h}L5f(){return this.jXh}}Object(h.a)(Jf,"PredictionsWithTokenAttributes",null,[]);class pg{constructor(Aa,Ua,gb){if(!Aa)throw Error.argumentNull("attributeName");if(!Ua)throw Error.argumentNull("fieldNames");if(!gb)throw Error.argumentNull("values");if(Ua.length!==gb.length)throw Error.argument("values","fieldNames and values do not have same length");this.iXh=Aa;this.Leb=Ua;this.Ahb=gb}get attributeName(){return this.iXh}get x1f(){return this.Leb.length}gbe(Aa){return 0<=
Aa&&Aa<this.Leb.length?this.Leb[Aa]:null}eb(Aa){return 0<=Aa&&Aa<this.Ahb.length?this.Ahb[Aa]:null}}Object(h.a)(pg,"TokenAttributes",null,[]);var gd=d(7),bd=d(1);class Ne{constructor(Aa,Ua,gb,Eb,Ub){this.vyc=0;this.Tbf=null;this.wyc=this.iSb=0;this.aBd=this.Wnb=this.Oba=this.jSb=null;this.Ubf=0;this.H5a=this.gz=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.CK=Aa;this.aUh=this.fUh=Ua;this.$Th=this.cUh=gb;this.ryc=this.bUh=
Eb;this.syc=this.dUh=Ub}YAd(){this.wyc=0;return this.hSb}hSb(){if(!(this.wyc<this.ryc))return this.uyc;this.jSb=this.aUh.items[this.wyc+this.$Th];this.Oba=new C.a(this.CK.Ka.annotations);1!==this.ryc&&this.CK.Ka.cbc||this.Oba.qDa(this.jSb);if(0<=this.CK.Ka.Xhd){({value:this.Wnb}=this.Oba.ln(this.CK.Ka.Xhd)).returnValue?this.Wnb=this.Wnb.rL():this.Wnb=new wb.a(this.CK.Ka.annotations,Q.Annotations.mN);this.aBd=this.syc.items;this.Ubf=this.aBd.length;for(this.vyc=0;this.vyc<this.Ubf;++this.vyc)this.Tbf=
this.aBd[this.vyc],Array.add(this.Wnb.items,this.Tbf);this.Oba.Iu(this.CK.Ka.Xhd,this.Wnb)}else 0<=this.CK.Ka.G4e?this.Oba.Iu(this.CK.Ka.G4e,this.syc.items[0]):0<=this.CK.Ka.GXd?this.Oba.Iu(this.CK.Ka.GXd,!0):this.CK.Ka.tsg?this.syc.items[0].fUc((Aa,Ua)=>this.Oba.Iu(Aa,Ua)):(this.Oba.qDa(this.syc.items[0]),1!==this.ryc&&this.CK.Ka.cbc||(({value:this.iSb}=this.jSb.ln(this.CK.Ka.jT)).returnValue&&this.Oba.Iu(this.CK.Ka.jT,this.iSb),({value:this.iSb}=this.jSb.ln(this.CK.Ka.yW)).returnValue&&this.Oba.Iu(this.CK.Ka.yW,
this.iSb),this.jSb.ln(this.CK.Ka.hRa).returnValue&&this.Oba.Iu(this.CK.Ka.hRa,this.iSb)));this.gz=this.Oba;this._state=2;return this.$Ad}uyc(){this._state=3}ZAd(){this.wyc++;return this.hSb}$Ad(){return 1<this.ryc&&this.CK.Ka.cbc?this.uyc:this.ZAd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Ne(this.CK,this.fUh,this.cUh,this.bUh,this.dUh)).getEnumerator()}[Symbol.iterator](){return Object(bd.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?
this._state=1:(this._state=1,this.H5a=this.YAd());for(;1===this._state;)this.H5a=this.H5a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.gz}}Object(h.a)(Ne,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[108,141,143]);class rf{constructor(Aa,Ua,gb){this.Rgc=this.XHg=0;this.LDb=null;this.nIe=this.Hve=this.zDb=this.Q7c=this.Iwe=0;this.T8c=!1;this.GEe=Aa;
this.FIe=Ua;this.Iqk=gb}yag(){null===this.LDb&&({RKh:this.LDb,xkg:this.Iwe,length:this.Q7c,m5i:Aa}=this.GEe.Keg(this.FIe.items[this.Rgc],this.Iqk),this.T8c=Aa||this.T8c);if(this.zDb<this.Q7c){var Aa=this.LDb.charAt(this.Iwe+this.zDb);++this.zDb;return{returnValue:!0,ch:Aa}}if(this.Rgc===this.FIe.items.length-1)return{returnValue:!1,ch:"\x00"};++this.Rgc;this.zDb=0;this.LDb=null;return{returnValue:!0,ch:" "}}vWe(Aa,Ua){this.zDb===this.Q7c&&this.LDb&&(this.nIe=Ua,this.Hve=this.Rgc-this.XHg+1)}Xfl(Aa){if(0>
Aa||Aa>=this.FIe.items.length)throw Error.argumentOutOfRange("iToken");this.Rgc=this.XHg=Aa;this.LDb=null;this.Hve=this.zDb=this.Q7c=this.Iwe=0;this.nIe=-1;this.T8c=!1}ioj(){return{twi:this.Hve,cak:this.nIe,Z4i:this.T8c}}}Object(h.a)(rf,"TriePrefixVisitor",null,[1281]);class Fh{constructor(Aa){this.Ka=Aa}execute(Aa){if(!({value:gb}=Aa.ln(this.Ka.qsa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ua;({value:Ua}=Aa.ln(this.Ka.KCa)).returnValue||(Ua=null);var gb=
this.jdj(gb,Ua);Aa=Q.Annotations.rL(Aa);Aa.Iu(this.Ka.qsa,gb);return Aa}jdj(Aa,Ua){let gb=null;const Eb=this.Ka.flatLexicon.trie,Ub=new rf(this,Aa,Ua);let vc=null;this.Ka.flatLexicon.Zne()&&(vc=Object(gd.a)(this.Ka.flatLexicon,this.Ka.flatLexicon.dfj,"getCaseInsensitiveForm"));let jd=0,Id;var Od;let ba;for(;jd<Aa.items.length;){const Da=Aa.items[jd];Ub.Xfl(jd);Eb.bTh(Ub,vc);({twi:Id,cak:Od,Z4i:ba}=Ub.ioj());if(0<Id){({Lbk:Od}=this.Ka.flatLexicon.Ddj(Od));for(let Qa of this.OPi(Aa,jd,Id,Od)){1<Id&&
this.Ka.cbc&&this.vQi(Aa,Ua,jd,Da,Id,ba,Qa);if(!gb)for(gb=new wb.a(this.Ka.annotations,Q.Annotations.mN),Od=0;Od<jd;++Od)Array.add(gb.items,Aa.items[Od]);Array.add(gb.items,Qa)}jd+=Id}else gb&&Array.add(gb.items,Da),++jd}return gb||Aa}vQi(Aa,Ua,gb,Eb,Ub,vc,jd){if(vc)vc=!0;else if(this.Ka.csg){vc=!1;var Id=-1;for(var Od=0;Od<Ub;Od++){var ba=Aa.items[gb+Od];let Wb;var Da=void 0;if(!({value:Wb}=ba.ln(this.Ka.jT)).returnValue||!({value:Da}=ba.ln(this.Ka.yW)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Od){if(Wb>Id+1){vc=!0;break}if(0>Id||null===Ua||Id>=Ua.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Ua.charAt(Id)){vc=!0;break}}Id=Wb+Da}}else vc=!1;if(vc){Da=new Sys.StringBuilder;for(vc=0;vc<Ub;++vc)({RKh:Id,xkg:Od,length:ba}=this.Keg(Aa.items[gb+vc],Ua)),0<vc&&Da.append(" "),Da.append(Id.substr(Od,ba));jd.Iu(this.Ka.hRa,Da.toString())}Aa=Aa.items[gb+Ub-1];let Qa,nb;({value:Eb}=Eb.ln(this.Ka.jT)).returnValue&&
({value:Qa}=Aa.ln(this.Ka.jT)).returnValue&&({value:nb}=Aa.ln(this.Ka.yW)).returnValue?(jd.Iu(this.Ka.jT,Eb),jd.Iu(this.Ka.yW,Qa+nb-Eb)):(jd.Tpd(this.Ka.jT),jd.Tpd(this.Ka.yW))}OPi(Aa,Ua,gb,Eb){return new Ne(this,Aa,Ua,gb,Eb)}Keg(Aa,Ua){let gb,Eb;if(({value:gb}=Aa.ln(this.Ka.hRa)).returnValue)Eb=!0,Ua=0,Aa=gb.length;else{Eb=!1;if(null===Ua)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");gb=Ua;if(!({value:Ua}=Aa.ln(this.Ka.jT)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:Aa}=Aa.ln(this.Ka.yW)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Ua||0>Aa||Ua+Aa>gb.length)throw Error.argument("Token start/length values out of range","token");}return{RKh:gb,xkg:Ua,length:Aa,m5i:Eb}}}Object(h.a)(Fh,"FlatLexiconNLModule",null,[1187]);class Ae{constructor(Aa,Ua){this.GXd=this.Xhd=this.G4e=this.hRa=this.yW=this.jT=this.KCa=this.qsa=0;this.tsg=this.csg=this.cbc=!1;this.flatLexicon=null;this.annotations=Ua.annotations;
let gb=0;try{this.qsa=Aa.ga(gb),++gb,this.KCa=Aa.ga(gb),++gb,this.jT=Aa.ga(gb),++gb,this.yW=Aa.ga(gb),++gb,this.hRa=Aa.ga(gb),++gb,this.G4e=Aa.ga(gb),++gb,this.Xhd=Aa.ga(gb),++gb,this.GXd=Aa.ga(gb),++gb,this.cbc=1===Aa.ga(gb),++gb,this.csg=1===Aa.ga(gb),++gb,this.tsg=1===Aa.ga(gb),++gb,this.flatLexicon=Ua.ysj(Aa.ga(gb))}catch(Eb){throw Error.argument("initData");}}}Object(h.a)(Ae,"FlatLexiconNLModuleInit",null,[]);class Kf{constructor(){this.P$b=0;this.F8d=null;this.Usc=0}}Object(h.a)(Kf,"FeatureGenStackRec",
null,[]);class Mf{constructor(Aa){this.D8e=Array(Aa);this.IQb=Array(Aa);this.O5e=[];this.bIh=[]}}Object(h.a)(Mf,"TokenStringLattice",null,[]);const vf=(Aa,Ua,gb)=>{for(let Eb=0;Eb<Aa.length;Eb++)gb=Ua(gb,Aa[Eb]);return gb},eg=(Aa,Ua)=>{const gb=Array(Aa.length);for(let Eb=0;Eb<Aa.length;Eb++)gb[Eb]=Ua(Aa[Eb]);return gb},zf=(Aa,Ua)=>{Ua=Array(Math.min(Ua,Aa.length));for(let gb=0;gb<Ua.length;gb++)Ua[gb]=Aa[gb];return Ua},Nd=(Aa,Ua)=>{const gb=[];for(const Eb of Aa)Ua(Eb)&&Array.add(gb,Eb);return gb};
class Se{constructor(Aa,Ua){this.key=Aa;this.value=Ua}}Object(h.a)(Se,"KeyValuePair",null,[]);const Qe=(Aa,Ua)=>({returnValue:Ua in Aa,value:Aa[Ua]}),Ei=Aa=>{const Ua=[];for(let gb in Aa){const Eb=new Se(gb,Aa[gb]);Array.add(Ua,Eb)}return Ua};class Ff{constructor(Aa){this.Jeg=this.czj;this.Ka=Aa;this.Hbd=this.vEe=this.wEe=0;for(const Ua of this.Ka.kTc)this.wEe=Math.max(this.wEe,Ua.ORe),this.vEe=Math.max(this.vEe,Ua.jRe),this.Hbd=Math.max(this.Hbd,Ua.sPb.length)}get B7i(){return this.Ka.Zxd.trie}execute(Aa){if(!Aa)throw Error.argumentNull("input");
let Ua,gb;({tokens:Ua,Fak:gb}=this.dzj(Aa));let Eb=null,Ub=null,vc={};if(this.Ka.xbc){Ua=Q.Annotations.rL(Ua);for(var jd=0;jd<Ua.items.length;++jd)Ua.items[jd]=Q.Annotations.rL(Ua.items[jd])}else({n1f:Ub,returnValue:Eb}=this.Xag(Aa,vc));jd=Array(this.Hbd);const Id=Array(this.Hbd);for(var Od=0;Od<Id.length;++Od)Id[Od]=new Kf;for(Od=-this.wEe;Od<Ua.items.length+this.vEe;++Od){let ba=null;this.Ka.xbc&&(ba=Ua.items[Od],vc={},{n1f:Ub,returnValue:Eb}=this.Xag(ba,vc));for(const Da of this.Ka.kTc){if(0>Od&&
-Od>Da.ORe||Od>=Ua.items.length&&Od-Ua.items.length+1>Da.jRe)continue;let Qa=!0;for(let nb=0;nb<Da.sPb.length;++nb){const Wb=Od+Da.sPb[nb];jd[nb]=Wb;if(0>Wb?0>this.Ka.PRe:Wb>=Ua.items.length?0>this.Ka.kRe:!gb.IQb[Wb]){Qa=!1;break}}Qa&&({BTi:Eb,CTi:Ub}=this.zUj(Da,gb,Eb,Ub,vc,Id,jd))}this.Ka.xbc&&(ba.Iu(this.Ka.XFa?this.Ka.Ntb:this.Ka.Ltb,Eb),this.Ka.XFa&&ba.Iu(this.Ka.Mtb,Ub))}Aa=Q.Annotations.rL(Aa);this.Ka.xbc?Aa.Iu(this.Ka.qsa,Ua):(Aa.Iu(this.Ka.XFa?this.Ka.Ntb:this.Ka.Ltb,Eb),this.Ka.XFa&&Aa.Iu(this.Ka.Mtb,
Ub));return Aa}dzj(Aa){let Ua,gb;if(!Aa||!({value:Ua}=Aa.ln(this.Ka.qsa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Eb;({value:Eb}=Aa.ln(this.Ka.KCa)).returnValue||(Eb="");gb=new Mf(Ua.items.length);const Ub=Nd(this.Ka.H8e,vc=>!vc.nac||vc.nac.isMatch(Aa,null));for(let vc=0;vc<Ua.items.length;++vc){const jd=Ua.items[vc];let Id=null;gb.D8e[vc]=gb.O5e.length;let Od=gb.IQb[vc]=0;for(const ba of Ub)0<ba.Llc&&gb.IQb[vc]+Od>=ba.Llc||ba.Mwc&&!ba.Mwc.isMatch(jd,
null)||({Nwc:Id,u1b:Od}=ba.apply(this,jd,vc,gb,Eb,Id,Od))}return{tokens:Ua,Fak:gb}}zUj(Aa,Ua,gb,Eb,Ub,vc,jd){let Id=0;vc[0].P$b=-1;for(vc[0].F8d=Aa.Yuh;;){var Od=jd[Id],ba=0>Od||Od>=Ua.IQb.length?1:Ua.IQb[Od];let nb=!1;for(;vc[Id].P$b<ba-1;){++vc[Id].P$b;var Da=void 0,Qa=void 0;0>Od?(Da=this.Ka.PRe,Qa=1):Od>=Ua.D8e.length?(Da=this.Ka.kRe,Qa=1):(Qa=Ua.D8e[Od]+vc[Id].P$b,Da=Ua.O5e[Qa],Qa=Ua.bIh[Qa]);vc[Id].Usc=Qa*(Id?vc[Id-1].Usc:Aa.score);if(({value:Da}=Qe(vc[Id].F8d,Da.toString())).returnValue){Id===
Aa.sPb.length-1?(Od=Da,vc[Id].Usc&&(({value:ba}=Qe(Ub,Od.toString())).returnValue||(ba=-1),0>ba&&(gb=Q.Annotations.rL(gb),Array.add(gb.items,Od)),this.Ka.XFa&&(Eb=Q.Annotations.rL(Eb),0>ba?Array.add(Eb.items,vc[Id].Usc):Eb.items[ba]+=vc[Id].Usc),0>ba&&(this.Ka.hvg||this.Ka.XFa)&&(Ub[Od.toString()]=gb.items.length-1))):(++Id,vc[Id].P$b=-1,vc[Id].F8d=Da);nb=!0;break}}if(!nb&&(--Id,0>Id))break}return{BTi:gb,CTi:Eb}}Xag(Aa,Ua){let gb;if(({value:gb}=Aa.ln(this.Ka.XFa?this.Ka.Ntb:this.Ka.Ltb)).returnValue)for(let Eb=
0;Eb<gb.items.length;++Eb)Ua[gb.items[Eb].toString()]=Eb;else gb=new wb.a(this.Ka.annotations,Q.Annotations.Wpa);if(this.Ka.XFa){if(({value:Ua}=Aa.ln(this.Ka.Mtb)).returnValue||(Ua=new wb.a(this.Ka.annotations,Q.Annotations.Bba)),Ua.items.length!==gb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ka.annotations.C2(Q.Annotations.mN,Aa));}else Ua=null;return{returnValue:gb,n1f:Ua}}get NLl(){return this.Ka.Zxd}czj(Aa,
Ua){var gb;if(({value:gb}=Ua.ln(this.Ka.hRa)).returnValue)Aa=gb;else{if(!({value:gb}=Ua.ln(this.Ka.jT)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Ua}=Ua.ln(this.Ka.yW)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>gb||0>Ua||gb+Ua>Aa.length)throw Error.argument("Token indices are out of range");Aa=Aa.substr(gb,Ua)}return Aa}}Object(h.a)(Ff,"NGramNLModule",null,[1187,1268]);class Jh{constructor(Aa){this.sPb=null;this.score=this.jRe=this.ORe=
0;this.Yuh=null;if(Aa){var Ua=0;try{if(Aa.ga(Ua)!==Jh.h8a)throw Error.argument("initData","Input does not represent a feature template");++Ua;const gb=Aa.ga(Ua);++Ua;this.sPb=Array(gb);for(let Eb=0;Eb<gb;++Eb)this.sPb[Eb]=Aa.ga(Ua),++Ua;this.ORe=Aa.ga(Ua);++Ua;this.jRe=Aa.ga(Ua);++Ua;this.score=Aa.ga(Ua);++Ua;this.Yuh=({ukg:Ua}=Jh.Snh(Aa,Ua)).returnValue}catch(gb){throw Error.argument("initData");}}}static Snh(Aa,Ua){const gb=Aa.ga(Ua);++Ua;const Eb={};for(let Ub=0;Ub<gb;++Ub){const vc=Aa.ga(Ua);
++Ua;Aa.ga(Ua)?Eb[vc.toString()]=({ukg:Ua}=Jh.Snh(Aa,Ua)).returnValue:(++Ua,Eb[vc.toString()]=Aa.ga(Ua),++Ua)}return{returnValue:Eb,ukg:Ua}}}Jh.h8a=240803228;Object(h.a)(Jh,"FeatureTemplate",null,[1285]);var Wf=d(555);class md{constructor(Aa,Ua){this.XFa=this.hvg=this.xbc=!1;this.hRa=this.yW=this.jT=this.qsa=this.KCa=this.Mtb=this.Ntb=this.Ltb=0;this.Zxd=null;this.kRe=this.PRe=0;this.kTc=this.H8e=null;if(Aa){this.annotations=Ua.annotations;var gb=0;try{this.xbc=1===Aa.ga(gb);++gb;this.hvg=1===Aa.ga(gb);
++gb;this.XFa=1===Aa.ga(gb);++gb;this.Ltb=Aa.ga(gb);++gb;this.Ntb=Aa.ga(gb);++gb;this.Mtb=Aa.ga(gb);++gb;this.KCa=Aa.ga(gb);++gb;this.qsa=Aa.ga(gb);++gb;this.jT=Aa.ga(gb);++gb;this.yW=Aa.ga(gb);++gb;this.hRa=Aa.ga(gb);++gb;this.Zxd=this.nRk(Ua.QTa(Aa.ga(gb)));++gb;this.PRe=Aa.ga(gb);++gb;this.kRe=Aa.ga(gb);++gb;const Eb=Aa.ga(gb);++gb;this.H8e=Array(Eb);for(let vc=0;vc<Eb;++vc){const jd=Aa.ga(gb);++gb;const Id=this.Zxd.trie,Od=new sb.a;Od.FTa(Aa,gb,jd);this.H8e[vc]=this.sRk(Od,Ua,Id);gb+=jd}const Ub=
Aa.ga(gb);++gb;this.kTc=Array(Ub);for(Ua=0;Ua<Ub;++Ua){const vc=Aa.ga(gb);++gb;const jd=new sb.a;jd.FTa(Aa,gb,vc);this.kTc[Ua]=this.SQk(jd);gb+=vc}}catch(Eb){throw Error.argument("initData");}}}nRk(Aa){return new Wh.a(new Kg.a(Aa))}sRk(Aa,Ua,gb){return Wf.a.create(Aa,Ua,gb)}SQk(Aa){return new Jh(Aa)}}Object(h.a)(md,"NGramNLModuleInit",null,[]);class Gf{constructor(Aa){this.Ka=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");Aa=Aa.clone();this.Ka.script.execute(Aa,null);return Aa}}Object(h.a)(Gf,
"ScriptNLModule",null,[1187]);class Hd{constructor(Aa,Ua){Aa&&(this.script=Ua.K$a(Aa.ga(0)))}}Object(h.a)(Hd,"ScriptNLModuleInit",null,[]);const Ee=Aa=>{Aa=eg(Aa,Ua=>Ua*Ua);return Math.sqrt(vf(Aa,(Ua,gb)=>Ua+gb,0))},Ki=Aa=>vf(Aa,(Ua,gb)=>Ua>gb?Ua:gb,Aa[0]);class wf{constructor(Aa){this.Ka=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");var Ua=[],gb=[];this.ZFi(Aa,Ua,gb);this.gmi(Ua,gb);const Eb={};for(let vc=0;vc<Ua.length;++vc){var Ub=Ua[vc];const jd=this.Ka.fng.ga(Ub);Ub=this.Ka.gng.ga(Ub);
for(let Id=0;Id<Ub;++Id){const Od=this.Ka.nDi.ga(this.Ka.RLf.ga(jd+Id)),ba=this.Ka.SLf.ga(jd+Id);let Da;({value:Da}=Qe(Eb,Od)).returnValue||(Da=0);Eb[Od]=Da+gb[vc]*ba}}gb=Ei(Eb);gb.sort((vc,jd)=>{var Id=vc.value,Od=jd.value;(Id=-(Id>Od?1:Id<Od?-1:0))||(Id=vc.key.localeCompare(jd.key));return Id});Ua=new wb.a(this.Ka.annotations,Q.Annotations.mN);for(const vc of zf(gb,this.Ka.Wyk))gb=new C.a(this.Ka.annotations),gb.Iu(this.Ka.ari,vc.key),gb.Iu(this.Ka.cri,vc.value),Array.add(Ua.items,gb);Aa.Iu(this.Ka.bri,
Ua);return Aa}ZFi(Aa,Ua,gb){if(({value:Aa}=Aa.ln(this.Ka.$qi)).returnValue){let Eb;if(({value:Eb}=Aa.ln(this.Ka.Ntb)).returnValue){let Ub;if(!({value:Ub}=Aa.ln(this.Ka.Mtb)).returnValue||Eb.items.length!==Ub.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.LNc(Eb,Ub,Ua,gb)}if(({value:Eb}=Aa.ln(this.Ka.eri)).returnValue){let Ub;if(!({value:Ub}=Aa.ln(this.Ka.fri)).returnValue||Eb.items.length!==Ub.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.LNc(Eb,Ub,Ua,gb)}({value:Eb}=Aa.ln(this.Ka.Ltb)).returnValue&&this.LNc(Eb,null,Ua,gb);({value:Eb}=Aa.ln(this.Ka.dri)).returnValue&&this.LNc(Eb,null,Ua,gb)}}LNc(Aa,Ua,gb,Eb){for(let vc=0;vc<Aa.items.length;++vc){var Ub=void 0;Aa.VU===Q.Annotations.yZ?({value:Ub}=Qe(this.Ka.vXf,Aa.items[vc])).returnValue||(Ub=-1):(Ub=Aa.items[vc],Ub=Ub>=this.Ka.qKe&&Ub<=this.Ka.pzk?this.Ka.DLe?this.Ka.DLe.ga(Ub-this.Ka.qKe)-1:Ub-this.Ka.qKe:-1);if(0<=Ub){let jd;jd=Ua?Ua.items[vc]:1;0<jd&&(Array.add(gb,Ub),Array.add(Eb,
jd))}}}gmi(Aa,Ua){if(Aa.length){switch(this.Ka.m_k){case 0:break;case 1:for(var gb=0;gb<Ua.length;++gb)Ua[gb]=1+Math.log(Ua[gb]);break;case 2:gb=Ki(Ua);for(let Eb=0;Eb<Ua.length;++Eb)Ua[Eb]=.5+Ua[Eb]/gb*.5;break;case 3:for(gb=0;gb<Ua.length;++gb)Ua[gb]=1;break;default:throw Error.notImplemented();}if(this.Ka.M0c)for(gb=0;gb<Ua.length;++gb)Ua[gb]*=this.Ka.M0c.ga(Aa[gb]);Aa=Ee(Ua);for(gb=0;gb<Ua.length;++gb)Ua[gb]/=Aa}}}Object(h.a)(wf,"TfIdfRankerNLModule",null,[1187]);class ag{constructor(Aa,Ua=0){if(!Aa)throw Error.argumentNull("byteArray");
this.PJ=Ua;if(604662927!==Aa.Hu(this.PJ+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.pn=Aa.Hu(this.PJ+4,4);this.NAg=Aa.Hu(this.PJ+8,4);this.$ik=Aa}ga(Aa){if(0>Aa||Aa>=this.count)throw Error.argumentOutOfRange("index");return this.$ik.y4k(8*this.PJ+96+Aa*this.NAg,this.NAg)}get count(){return this.pn}}Object(h.a)(ag,"CompactIntArray",null,[1186]);const Og=(Aa,Ua)=>{Ua=Array(Ua);for(let vc=0;vc<Ua.length;vc++){var gb=vc,Eb=Aa.VY(),Ub=1===(Eb>>31&1)?-1:1;
const jd=Eb&8388607;Eb=Eb>>23&255;256===Eb+1?Ub=jd?Number.NaN:1===Ub?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Eb?(Eb-=127,Ub=Ub*Kh(jd,1)*Math.pow(2,Eb)):Ub=Ub*Kh(jd,0)*Math.pow(2,-126);Ua[gb]=Ub}return Ua},Kh=(Aa,Ua)=>{let gb=0;for(let Eb=0;23>Eb;Eb++)gb+=(Aa>>22-Eb&1)/Math.pow(2,Eb+1);return Ua+gb};class Xg{constructor(Aa,Ua){this.DLe=null;this.U8g=0;this.gng=this.fng=this.M0c=null;this.T8g=0;this.SLf=this.RLf=null;this.annotations=Ua.annotations;let gb=0;this.dri=Aa.ga(gb);++gb;this.Ltb=
Aa.ga(gb);++gb;this.eri=Aa.ga(gb);++gb;this.fri=Aa.ga(gb);++gb;this.Ntb=Aa.ga(gb);++gb;this.Mtb=Aa.ga(gb);++gb;this.$qi=Aa.ga(gb);++gb;this.bri=Aa.ga(gb);++gb;this.ari=Aa.ga(gb);++gb;this.cri=Aa.ga(gb);++gb;var Eb=Aa.ga(gb);++gb;var Ub=Array(Eb);for(var vc=0;vc<Eb;++vc)Ub[vc]=Ua.YC(Aa.ga(gb)),++gb;this.nDi=sb.a.y2d(Ub);this.Wyk=Aa.ga(gb);++gb;this.m_k=Aa.ga(gb);++gb;Eb=Aa.ga(gb);++gb;this.vXf={};for(Ub=0;Ub<Eb;++Ub){vc=Ua.YC(Aa.ga(gb));++gb;const jd=Aa.ga(gb);++gb;this.vXf[vc]=jd}this.qKe=Aa.ga(gb);
++gb;this.pzk=Aa.ga(gb);++gb;Eb=Aa.ga(gb);++gb;0<Eb&&(Eb=Ua.QTa(Aa.ga(gb)),++gb,this.DLe=this.Vld(new lh(Eb)));++gb;Aa=Ua.QTa(Aa.ga(gb));this.cRk(Aa)}Vld(Aa){return new ag(Aa.K0b,Aa.offset)}cRk(Aa){try{const Ua=new lh(Aa);this.U8g=Ua.VY();1===Ua.VY()?this.M0c=sb.a.y2d(Og(Ua,this.U8g)):this.M0c=null;const gb=Ua.VY();this.fng=this.Vld(Ua);Ua.offset+=gb;const Eb=Ua.VY();this.gng=this.Vld(Ua);Ua.offset+=Eb;this.T8g=Ua.VY();const Ub=Ua.VY();this.RLf=this.Vld(Ua);Ua.offset+=Ub;this.SLf=sb.a.y2d(Og(Ua,this.T8g))}catch(Ua){throw Error.argument("byteReader");
}}}Object(h.a)(Xg,"TfIdfRankerNLModuleInit",null,[]);class Yd{constructor(Aa,Ua,gb,Eb){this.SPe=Aa;this.M2f=gb;this.tokens=Eb;this.K8=Ua;this.FNb=-1;this.Qsd=0}}Object(h.a)(Yd,"TokenizerData",null,[]);class ce{constructor(Aa){this.Ka=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");if(!({value:Eb}=Aa.ln(this.Ka.KCa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ua;({value:Ua}=Aa.ln(this.Ka.jT)).returnValue||(Ua=0);let gb;({value:gb}=
Aa.ln(this.Ka.yW)).returnValue||(gb=Eb.length-Ua);if(0>Ua||Ua>Eb.length)throw Error.argument("input","Start index out of range");if(0>gb||gb>Eb.length)throw Error.argument("input","Length out of range");if(Ua+gb>Eb.length)throw Error.argument("input","Bad start-length range");var Eb=new Yd(Eb,Ua,Ua+gb,new wb.a(this.Ka.annotations,Q.Annotations.mN));this.OLl(Eb);Aa=Aa.isReadOnly?Aa.clone():Aa;Aa.Iu(this.Ka.qsa,Eb.tokens);return Aa}OLl(Aa){for(;Aa.K8<Aa.M2f;){if(this.Ka.jge){var Ua=this.Ka.jge.fzg(Aa.SPe,
Aa.K8,Aa.M2f-Aa.K8,null);!Ua.succeeded&&Ua.b8g&&(Ua=Ua.b8g);if(Ua.succeeded){this.dch(Aa,Ua.length,this.Ka.ogg);Aa.K8+=Ua.length;continue}}Ua=Aa.SPe.substr(Aa.K8);let gb=-1,Eb=-1,Ub=-1;for(let vc=0;vc<this.Ka.Crd.length;++vc){const jd=this.Ka.Crd[vc].exec(Ua);jd&&0<jd[1].length&&(0>gb||jd[0].length>Eb)&&(gb=vc,Eb=jd[0].length,Ub=jd[1].length)}0<=gb?(this.dch(Aa,Ub,this.Ka.uZe[gb]),Aa.K8+=Ub):Aa.K8+=1}}dch(Aa,Ua,gb){if(this.Ka.Rtg)gb!==ce.lyi&&(0>Aa.FNb&&(Aa.FNb=Aa.K8),Aa.Qsd=Aa.K8+Ua-Aa.FNb,gb===
ce.kyi&&(0<=Aa.FNb&&0<Aa.Qsd&&(Ua=new C.a(this.Ka.annotations),Ua.Iu(this.Ka.jT,Aa.FNb),Ua.Iu(this.Ka.yW,Aa.Qsd),Ua.Iu(this.Ka.SWd,ce.myi),Ua.Iu(this.Ka.KCa,Aa.SPe),Array.add(Aa.tokens.items,Ua)),Aa.FNb=-1,Aa.Qsd=0));else{let Eb=new C.a(this.Ka.annotations);Eb.Iu(this.Ka.jT,Aa.K8);Eb.Iu(this.Ka.yW,Ua);Eb.Iu(this.Ka.SWd,gb);Array.add(Aa.tokens.items,Eb)}}}ce.lyi="GAP";ce.kyi="EOS_CHUNK";ce.myi="SENTENCE";Object(h.a)(ce,"TokenizerNLModule",null,[1187]);class Rh{constructor(Aa,Ua){this.yW=this.jT=this.SWd=
this.qsa=this.KCa=0;this.Rtg=!1;this.uZe=this.Crd=this.ogg=this.jge=null;if(Aa){this.annotations=Ua.annotations;var gb=0;try{this.KCa=Aa.ga(gb);++gb;this.qsa=Aa.ga(gb);++gb;this.SWd=Aa.ga(gb);++gb;this.jT=Aa.ga(gb);++gb;this.yW=Aa.ga(gb);++gb;this.Rtg=1===Aa.ga(gb);++gb;var Eb=Aa.ga(gb);++gb;0<Eb&&(this.jge=Ua.Nce(Eb).B7i);this.ogg=Aa.ga(gb)?Ua.YC(Aa.ga(gb)):"";++gb;const Ub=Aa.ga(gb);++gb;this.Crd=Array(Ub);this.uZe=Array(Ub);for(Eb=0;Eb<Ub;++Eb)this.Crd[Eb]=new RegExp(Ua.YC(Aa.ga(gb))),++gb,this.uZe[Eb]=
Ua.YC(Aa.ga(gb)),++gb}catch(Ub){throw Error.argument("initData");}}}}Object(h.a)(Rh,"TokenizerNLModuleInit",null,[]);class ng{constructor(Aa){this.Ka=Aa}execute(Aa){if(!Aa)throw Error.argumentNull("input");let Ua;if(!({value:Ua}=Aa.ln(this.Ka.AFf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const gb of this.Ka.p5e)Ua=gb.apply(Ua);Aa=Q.Annotations.rL(Aa);Aa.Iu(this.Ka.BFf,Ua);return Aa}static pWd(Aa,Ua){const gb=new Sys.StringBuilder;for(let Eb=
0;Eb<Aa.length;++Eb)gb.append(Ua(Aa.substr(Eb,1)));return gb.toString()}}Object(h.a)(ng,"TransliteratorNLModule",null,[1187]);class Vi{constructor(Aa){Aa&&(this.style=Aa.ga(0))}apply(Aa){return ng.pWd(Aa,Ua=>Vi.eBi(Ua,this.style))}static eBi(Aa,Ua){switch(Ua){case 0:return Aa.toLowerCase();case 1:return"I"===Aa?"\u0131":Aa.toLowerCase();case 2:return Aa.toUpperCase();case 3:return"i"===Aa?"\u0130":Aa.toUpperCase();default:throw Error.invalidOperation();}}}Vi.j8a=0;Object(h.a)(Vi,"ChangeCaseTransliterationStage",
null,[1212]);class $h{apply(Aa){return ng.pWd(Aa,$h.DMl)}static DMl(Aa){const Ua=Aa.charCodeAt(0);return 65281<=Ua&&65374>=Ua?String.fromCharCode(Ua-65248):Aa}}$h.j8a=4;Object(h.a)($h,"LatinFullWidthToHalfWidthTransliterationStage",null,[1212]);class fg{constructor(Aa,Ua){Aa&&(this.regex=Ua.Wbg(Aa.ga(0)),this.gel=Ua.YC(Aa.ga(1)))}apply(Aa){return Aa.replace(this.regex,this.gel)}}fg.j8a=1;Object(h.a)(fg,"RegexReplaceTransliterationStage",null,[1212]);class dk{constructor(Aa,Ua){if(Aa){var gb=Aa.ga(0),
Eb=Ua.YC(Aa.ga(1)),Ub=new ag(Ua.QTa(Aa.ga(2)));Aa=0>Aa.ga(3)?null:new ag(Ua.QTa(Aa.ga(3)));this.i6e={};for(Ua=0;Ua<gb;++Ua)this.i6e[Eb.charAt(Ua).toString()]=Eb.substr(Ub.ga(Ua),Aa?Aa.ga(Ua):1)}}apply(Aa){return ng.pWd(Aa,Ua=>Ua in this.i6e?this.i6e[Ua]:Ua)}}dk.j8a=2;Object(h.a)(dk,"SingleCharSubstitutionsTransliterationStage",null,[1212]);class xi{constructor(Aa,Ua){this.BFf=this.AFf=0;this.p5e=null;if(Aa){this.annotations=Ua.annotations;var gb=0;try{this.AFf=Aa.ga(gb);++gb;this.BFf=Aa.ga(gb);++gb;
const Eb=Aa.ga(gb);++gb;this.p5e=Array(Eb);for(let Ub=0;Ub<Eb;++Ub){const vc=Aa.ga(gb);++gb;const jd=Aa.ga(gb);++gb;const Id=new sb.a;Id.FTa(Aa,gb,jd);gb+=jd;this.p5e[Ub]=this.mRk(vc,Id,Ua)}}catch(Eb){throw Error.argument("initData");}}}mRk(Aa,Ua,gb){switch(Aa){case Vi.j8a:return new Vi(Ua);case fg.j8a:return new fg(Ua,gb);case dk.j8a:return new dk(Ua,gb);case $h.j8a:return new $h;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)(xi,"TransliteratorNLModuleInit",
null,[]);class yh{opj(Aa,Ua){const gb=Aa.ga(0),Eb=new sb.a;Eb.FTa(Aa,1,Aa.count-1);switch(gb){case 0:return new Gf(new Hd(Eb,Ua));case 2:return new ce(new Rh(Eb,Ua));case 3:return new Ff(new md(Eb,Ua));case 5:return new Fh(new Ae(Eb,Ua));case 9:return new ng(new xi(Eb,Ua));case 10:return new wf(new Xg(Eb,Ua));default:throw Error.notImplemented();}}}Object(h.a)(yh,"NLModuleFactory",null,[1147]);class Lg{constructor(Aa){this.fyi=";";if(!Aa)throw Error.argumentNull("resource");this.z5=new Nc(Aa,new oc,
new yh);this.GEe=this.z5.Zoj();this.zAg=this.z5.annotations.A7b("Text.Text");this.xAg=this.z5.annotations.A7b("Classification.Predictions");this.mve=this.z5.annotations.A7b("Classification.PredictionString");this.yAg=this.z5.annotations.A7b("Classification.Probability");this.Jik=this.z5.annotations.A7b("NLMod.Tokens");if(0>this.zAg||0>this.xAg||0>this.mve||0>this.yAg)throw Error.argument("resourceObj","Resource does not represent a ranker");}rej(){const Aa=[];this.r7d(void 0,this.n6f(Aa),null);return Aa}tej(Aa,
Ua){const gb=[],Eb=[];this.r7d(Aa,this.n6f(gb),(Ub,vc)=>{const jd=this.z5.annotations.$5f(Ub),Id=[],Od=[];Ua&&Ua.length&&-1===Array.indexOf(Ua,jd)||(Ub=this.z5.annotations.getAttributeType(Ub),this.Mih(Ub,vc,Id,Od),vc=new pg(jd,Id,Od),Array.add(Eb,vc))});return new Jf(gb,Eb)}sej(Aa){const Ua=[];this.r7d(Aa,gb=>{let Eb;if(({value:Eb}=gb.ln(this.mve)).returnValue){let Ub;({value:Ub}=gb.ln(this.yAg)).returnValue&&Array.add(Ua,new Zc(Eb,Ub))}},null);return Ua}r7d(Aa,Ua,gb){var Eb=new C.a(this.z5.annotations);
Eb.Iu(this.zAg,Aa);Aa=this.GEe.execute(Eb);if(({value:Eb}=Aa.ln(this.xAg)).returnValue)for(const Ub of Eb.items)Ua(Ub);if(gb&&({value:Ua}=Aa.ln(this.Jik)).returnValue)for(const Ub of Ua.items)Ub.fUc(gb)}Mih(Aa,Ua,gb,Eb){if(Q.Annotations.rC(Aa))for(var Ub of Ua.items)this.Mih(Ua.VU,Ub,gb,Eb);else if(Q.Annotations.kOh(Aa)){Ub=this.z5.annotations.Jag(Aa);for(let vc=0;vc<Ub;vc++)Array.add(gb,this.z5.annotations.Mdg(Aa,vc)),Array.add(Eb,this.z5.annotations.C2(this.z5.annotations.Iab(Aa,vc),Ua.cUa(vc)))}else Array.add(gb,
"VALUE"),Array.add(Eb,this.z5.annotations.C2(Aa,Ua))}n6f(Aa){return Ua=>{let gb;({value:gb}=Ua.ln(this.mve)).returnValue&&Array.add(Aa,this.Krj(gb))}}Krj(Aa){const Ua=Aa.indexOf(this.fyi);return 0>Ua?Aa:Aa.substring(0,Ua)}}Object(h.a)(Lg,"Ranker",null,[]);var yi=d(344),Vd=d(392),lf=d(27);class Zj{constructor(Aa,Ua){this.Jnf="";this.PNd=null;this.QNd=!1;this.Rba=null;this.lXh=["TellMe.TellMeParamCollection"];this.qb=Aa;this.vBa=Ua;this.qb.N7a&&(this.Rba=null)}get kod(){if(!this.PNd&&!this.QNd){let Aa=
null;try{Aa=window.TellMeModel}catch(Ua){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("QueryRanker","TellMeModel not found. Exception: "+Ua)}if(Aa){try{this.PNd=new Lg(Aa)}catch(Ua){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ua)}this.QNd=!0}else if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("QueryRanker","Classifier model not found")}return this.PNd}pE(){return"Command"}LL(){return 0===
this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua,gb=!1,Eb=e.a.tellMe,Ub=null){const vc=new t.a(Aa);if((!Ub||Array.contains(Ub,0))&&!B.a.aG(Aa)){if(!this.kod&&this.QNd){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.qb.N7a&&this.Rba&&this.Rba.initialize();if(yi.CommandResultsUtility.goe(Aa.Ef)&&(Ub=yi.CommandResultsUtility.q7f(Aa.Ef),0<Ub.results.length)){Ub.displayName=
"Classifier Debug";vc.Bq(Ub);Ua.resultsUpdated(vc);return}Ub=Aa?this.Jnf=Aa.Ef:this.Jnf;if(lf.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){Ub=this.Mrj(Ub);var jd=this.wVc(Ub.Ade());Ub=Ub.L5f()}else Ub=this.Lrj(Ub),jd=this.ogj(Ub),Ub=[];yi.CommandResultsUtility.Y5c(jd,!1,"Classifier","TFIDF");jd=yi.CommandResultsUtility.H8b(Aa,jd,this.qb,this.Rba,this.vBa,Ub,0,1);0<jd.results.length&&Eb!==e.a.contextMenu&&(jd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);gb||jd.results.length||
this.qb.KFa||this.qb.vza||(Aa=new n.a("lookupNoResults",14,Aa.Ef,null,1),jd.ys(Aa));0<jd.results.length&&vc.Bq(jd);vc.attributes=Ub}Ua.resultsUpdated(vc)}Ade(){let Aa=[];try{Aa=this.kod.rej()}catch(Ua){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("GetPredictions","Exception: "+Ua)}return Aa}Lrj(Aa){let Ua=[];try{Ua=this.kod.sej(Aa)}catch(gb){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("GetPredictionsWithScore","Exception: "+gb)}return Ua}Mrj(Aa){try{return this.kod.tej(Aa,
this.lXh)}catch(Ua){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("GetPredictionsWithTokenAttributes","Exception: "+Ua)}return new Jf([],[])}wVc(Aa){const Ua=[];if(Aa)for(const gb of Aa)Ua.push(new Vd.a(gb,-99999));return Ua}ogj(Aa){const Ua=[];if(Aa)for(const gb of Aa)Ua.push(new Vd.a(gb.prediction,gb.score));return Ua}}Object(h.a)(Zj,"CommandResultsProvider",null,[909]);var Cj=d(1014);class he{constructor(Aa){this.qb=Aa}pE(){return"Feedback"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?
1:2}IB(Aa,Ua,gb,Eb,Ub=null){Aa=new t.a(Aa);if(!Ub||Array.contains(Ub,21))Ub=[],Ub.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Ub),Ub=new z.a(22),Ub.displayName="",Ub.ys(new n.a("TellMeFeedback",23,null,null,1)),Aa.Bq(Ub);Ua.resultsUpdated(Aa)}}Object(h.a)(he,"FeedbackResultsProvider",null,[909]);class ij{constructor(Aa,Ua,gb,Eb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Aa;this.CommandId=Ua;
this.CommandValueId=gb;this.InputText=Eb}}Object(h.a)(ij,"FindInDocumentProp",null,[]);var Rf=d(47);class zh{constructor(Aa){this.XKd=2;this.E5a=[];this.wPa=[];this.qb=Aa;zh.yka=Aa.$1f;zh.e2f="FindInDocumentSuggestion";zh.Vhh="FindInDocumentSuggestion3";this.j4h=Object.assign(new D.a,{landingTab:"Indoc",data:null});this.N9h=this.qb.UOb||!!lf.AFrameworkApplication.Aa&&lf.AFrameworkApplication.Aa.mb.UOb}pE(){return"FindInDocument"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:3===this.qb.Hq?this.qb.QFh?
2:3:2}IB(Aa,Ua,gb=!1,Eb,Ub=null){const vc=new t.a(Aa);if(Ub&&!Array.contains(Ub,2))Ua.resultsUpdated(vc);else if(Array.clear(this.E5a),B.a.aG(Aa)){if(gb&&this.FDh()){gb=new z.a(2);gb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ub=1;Eb="";if(0<this.wPa.length&&!this.qb.VOb)for(var jd of this.wPa)if(""!==jd.Label.toLowerCase()){if(Ub>=this.XKd)break;this.bRh(gb,jd.Label,jd.CommandValueId,zh.e2f+Ub,jd.InputText);Ub++}jd="";this.qb.gI?(vc.Bq(gb),gb=new z.a(3),jd=this.qb.eRa?B.a.OTa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):jd=CommonUIStrings.l_TellMeOpenFindPaneText;Eb=this.p7f("");this.bRh(gb,jd,Eb,zh.Vhh,"");vc.Bq(gb)}Ua.resultsUpdated(vc)}else jd="",gb&&(gb=this.p7f(Aa.Ef),Eb=[],this.qb.wWa?(this.qb.s3e&&Eb.push(appChrome.actions.setControlIconSet(zh.yka,{"default":"FindInDocument_20"})),jd=this.qb.Bre?B.a.Bbe(Aa.Ef,CommonUIStrings.l_FindInDocumentScopedButtonText):Aa.Ef+CommonUIStrings.l_FindInDocumentScopedButtonText):this.qb.gI?(jd=this.qb.eRa?B.a.OTa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
Aa.Ef)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Aa.Ef),Eb.push(appChrome.actions.setControlIconSet(zh.yka,{"default":"FindInDocument_20"}))):jd=this.qb.VOb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Aa.Ef),this.qb.cea?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(zh.yka,jd)),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(zh.yka,gb))):(Eb.push(appChrome.actions.setControlLabel(zh.yka,
jd)),Eb.push(appChrome.actions.setButtonCommandValueId(zh.yka,gb)),appChrome.api.dispatch(Eb)),this.Mzh(jd,zh.yka,gb,Aa.Ef)),this.qb.QFh?(jd=new n.a(zh.yka,8,Aa.Ef),gb=new z.a(2),gb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,gb.ys(jd),vc.Bq(gb),Ua.resultsUpdated(vc)):this.qb.Akj().then(Id=>{const Od=new n.a(zh.yka,8,Aa.Ef,null,1);Od.count=Id;Id=new z.a(2);Id.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Id.ys(Od);vc.Bq(Id);Ua.resultsUpdated(vc)},Id=>{x.TellMeActor.instance.Kd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+Id);Id=new n.a(zh.yka,8,Aa.Ef,null,1);const Od=new z.a(2);Od.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Od.ys(Id);vc.Bq(Od);Ua.resultsUpdated(vc)})}FDh(){return!!this.qb&&this.qb.Uud}bRh(Aa,Ua,gb,Eb,Ub=null){const vc=[];Ua&&vc.push(appChrome.actions.setControlLabel(Eb,Ua));this.qb.gI&&vc.push(appChrome.actions.setControlIconSet(Eb,{"default":"FindInDocument_20"}));vc.push(appChrome.actions.setButtonCommandValueId(Eb,gb));appChrome.api.dispatch(vc);
this.Mzh(Ua,Eb,gb,"");Aa.ys(new n.a(Eb,8,Ub,null,1,-99999))}p7f(Aa){return this.N9h?B.a.ADa(Aa,15,this.j4h):Rf.a.ze(Aa)}Mzh(Aa,Ua,gb,Eb){this.FDh()&&this.E5a.length<this.XKd&&(Aa=new ij(Aa,Ua,gb,Eb),Array.add(this.E5a,Aa))}Rql(Aa){for(let Ua=0;Ua<this.E5a.length;Ua++)if(this.E5a[Ua].CommandId===Aa){const gb=this.E5a[Ua].Label;let Eb=!1;if(0<this.wPa.length){let Ub=0;for(const vc of this.wPa){if(vc.Label===gb){Array.removeAt(this.wPa,Ub);Eb=!0;break}Ub++}}!Eb&&this.wPa.length>=this.XKd-1&&Array.removeAt(this.wPa,
1);Array.insert(this.wPa,0,this.E5a[Ua])}}}zh.yka=null;zh.e2f=null;zh.Vhh=null;Object(h.a)(zh,"FindInDocumentResultsProvider",null,[909]);var Sh=d(1012);class jj{constructor(Aa){this.qb=Aa}pE(){return"Insights"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua,gb=!1,Eb,Ub=null){Eb=new t.a(Aa);if(!Ub||Array.contains(Ub,13))if(this.Ayl()||!B.a.aG(Aa)){Ub=new z.a(13);var vc=""===Aa.Ef.trim(),jd=vc?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Id=new n.a(jd,10,Aa.Ef,null,1);gb&&(gb=null,
B.a.P9()?vc?vc=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(vc=this.qb.VOb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Aa.Ef),gb=B.a.ADa(Aa.Ef,1)):(vc=String.format(CommonUIStrings.l_InsightsButtonText,Aa.Ef),gb=B.a.F2d(Aa.Ef)),this.qb.cea?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(jd,vc)),gb&&x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",gb))):
(Aa=[],Aa.push(appChrome.actions.setControlLabel(jd,vc)),gb&&Aa.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",gb)),appChrome.api.dispatch(Aa)),Id.label=vc);Ub.ys(Id);Eb.Bq(Ub)}Ua.resultsUpdated(Eb)}Ayl(){return B.a.P9()&&this.qb.BJl&&!this.qb.Z3}}Object(h.a)(jj,"InsightsResultsProvider",null,[909]);var Dj=d(1010);class Ah{constructor(Aa){this.qb=Aa}pE(){return"Learning"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua,gb,Eb,Ub=null){gb=new t.a(Aa);Ub&&!Array.contains(Ub,
21)||!B.a.aG(Aa)||(Ub=[],Eb=this.qb.zbk,Ub.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Eb)),Eb=Ah.Zkj(Eb),Ub.push(appChrome.actions.setControlLabel("LearningForSearch",Eb)),appChrome.api.dispatch(Ub),Aa=new n.a("LearningForSearch",22,Aa.Ef,null,1),Ub=new z.a(21),Ub.ys(Aa),gb.Bq(Ub));Ua.resultsUpdated(gb)}static Zkj(Aa){const Ua=[];Array.add(Ua,new Dj.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ua,new Dj.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Ua,new Dj.a(600,Aa));Array.add(Ua,new Dj.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Aa={};Aa.parts=Ua;return JSON.stringify(Aa)}}Object(h.a)(Ah,"LearningProvider",null,[909]);var hf=d(1099);class rg{constructor(Aa,Ua){this.vqb=this.Asb=this.RPa=this.uEc=null;this.mw=!1;this.Mqb=Aa;this.AZh=Ua;Aa&&this.q0f(Aa)}Cyd(){this.Mqb.Cyd()&&this.q0f(this.Mqb)}Cxj(Aa){let Ua=[];var gb=[];Aa=rg.GCk(Aa);var Eb="";Array.clear(gb);for(let Ub=0;Ub<Aa.length;Ub++){const vc=Aa.charAt(Ub);-1!==
" ".indexOf(vc)?(Eb.length&&Array.add(gb,Eb),Eb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(vc)?(Eb.length&&Array.add(gb,Eb),Eb=vc,Array.add(gb,Eb),Eb=""):Eb+=vc}Eb.length&&Array.add(gb,Eb);for(Aa=0;Aa<gb.length;Aa++)Eb=this.ngj(gb[Aa]),Eb=this.kLi(Eb),Ua=rg.Mzk(Ua,Eb);return Ua=this.kgi(Ua)}Wpe(){this.mw||this.Cyd();return this.mw}cQc(Aa){return this.uEc[Aa.toString()]}kgi(Aa){for(let Ua=0;Ua<Aa.length;Ua++){const gb=this.RPa[Ua];if(Aa[Ua].commandId!==this.cQc(gb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Eb;(Eb=Aa[Ua]).score=Eb.score+gb[1]}return Aa}kLi(Aa){const Ua=[];for(var gb=0;gb<this.RPa.length;gb++)Ua.push(new Vd.a(this.cQc(this.RPa[gb][0]),-5));gb=new hf.a;for(var Eb=0;Eb<Aa.length;Eb++)gb.add(this.cQc(Aa[Eb][0]));for(Eb=0;Eb<Ua.length;Eb++){const vc=Ua[Eb];for(let jd=0;jd<Aa.length;jd++){var Ub=Aa[jd];const Id=this.cQc(Ub[0]);Ub=Ub[1];if(Id===vc.commandId){vc.score=Ub;gb.remove(Id);break}}if(!gb.count)break}return Ua}ngj(Aa){const Ua=1>Aa.length;for(let jd=0;2>=jd;jd++){const Id=this.vqb;
for(let Od in Id){var gb=Id[Od],Eb=Aa,Ub=Od;const ba=Ub.length+1,Da=Array((Eb.length+1)*ba);for(var vc=0;vc<=Eb.length;vc++)Da[vc*ba]=vc;for(vc=0;vc<=Ub.length;vc++)Da[vc]=vc;for(vc=0;vc<Ub.length;vc++)for(let Qa=0;Qa<Eb.length;Qa++)Da[(Qa+1)*ba+(vc+1)]=Eb.charAt(Qa)===Ub.charAt(vc)?Da[Qa*ba+vc]:Math.min(Math.min(Da[Qa*ba+(vc+1)]+1,Da[(Qa+1)*ba+vc]+1),Da[Qa*ba+vc]+1);Eb=Da[Eb.length*ba+Ub.length];if((!Eb||!Ua)&&Eb<=jd)return gb}}return this.Asb}q0f(Aa){this.uEc=Aa.Mce();this.RPa=Aa.Zrj();this.Asb=
Aa.Gzj();this.vqb=Aa.Ymj();if(this.mw=!!this.uEc&&!!this.RPa&&!!this.vqb&&!!this.Asb)this.mw=0<this.RPa.length&&rg.Nne(this.RPa);this.mw&&(this.mw=0<this.Asb.length&&rg.Nne(this.Asb));this.mw&&(this.vqb=rg.iAj(this.vqb));this.mw||(this.vqb=this.Asb=this.RPa=this.uEc=null)}kzj(Aa){Aa=this.Cxj(Aa);return this.o7i(Aa,this.AZh)}o7i(Aa,Ua){let gb=[];for(let Eb=0;Eb<Aa.length;Eb++)Aa[Eb].score>=Ua&&gb.push(Aa[Eb]);gb.sort((Eb,Ub)=>Eb.score<Ub.score?1:Eb.score>Ub.score?-1:0);0<gb.length-10&&(gb=gb.slice(0,
10));return gb}static Mzk(Aa,Ua){if(!Aa.length)return Ua;if(Aa.length!==Ua.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let gb=0;gb<Aa.length;gb++){if(Aa[gb].commandId!==Ua[gb].commandId)throw Error.create("Incorrect CommandId");let Eb;(Eb=Aa[gb]).score=Eb.score+Ua[gb].score}return Aa}static GCk(Aa){return Rf.a.ug(Aa)}static Nne(Aa){for(let Ua=0;Ua<Aa.length;Ua++)if(2!==Aa[Ua].length)return!1;return!0}static iAj(Aa){const Ua={};for(let Ub in Aa){var gb=
Ub,Eb=Aa[Ub];const vc=Eb;vc.length&&rg.Nne(vc)&&(Ua[gb]=Eb)}return Ua}}Object(h.a)(rg,"NaiveBayesClassifierModel",null,[]);class Ej{constructor(Aa,Ua){this.Rba=null;this.qb=Aa;this.gXb=new rg(Ua,Aa.uag);this.qb.N7a&&(this.Rba=null)}pE(){return"NBCommand"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua,gb=!1,Eb=e.a.tellMe,Ub=null){const vc=new t.a(Aa);if((!Ub||Array.contains(Ub,0))&&!B.a.aG(Aa)){if(yi.CommandResultsUtility.goe(Aa.Ef)&&(Ub=yi.CommandResultsUtility.q7f(Aa.Ef),0<Ub.results.length)){Ub.displayName=
"Classifier Debug";vc.Bq(Ub);Ua.resultsUpdated(vc);return}if(!this.gXb.Wpe()){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.qb.N7a&&this.Rba&&this.Rba.initialize();Ub=this.gXb.kzj(Aa.Ef);yi.CommandResultsUtility.Y5c(Ub,!1,"Classifier","NaiveBayesian");Ub=yi.CommandResultsUtility.H8b(Aa,Ub,this.qb,this.Rba,null,null,0,1);0<Ub.results.length&&
Eb!==e.a.contextMenu&&(Ub.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);gb||Ub.results.length||this.qb.KFa||this.qb.vza||(Aa=new n.a("lookupNoResults",14,Aa.Ef,null,1),Ub.ys(Aa));0<Ub.results.length&&vc.Bq(Ub)}Ua.resultsUpdated(vc)}}Object(h.a)(Ej,"NaiveBayesCommandProvider",null,[909]);class Li{constructor(){this.C5a=null;this.mw=!1;this.Cyd()}Cyd(){this.mw||(this.C5a=window.NBCRM)&&4===this.C5a.length&&(this.mw=!0);return this.mw}Zrj(){return this.mw?this.C5a[1]:null}Gzj(){return this.mw?
this.C5a[2]:null}Ymj(){return this.mw?this.C5a[3][0]:null}Mce(){return this.mw?this.C5a[0][0]:null}}Object(h.a)(Li,"NaiveBayesModelAdapter",null,[1020]);var Gh=d(144);class hg{constructor(Aa){this.qb=Aa}pE(){return"OfficeScript"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua){const gb=new t.a(Aa);if(!B.a.aG(Aa)){Aa=Gh.d(Aa.Ef);var Eb=new z.a(28);Eb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Eb=this.Yzf(Aa,hg.BQl,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Eb);Eb=this.Yzf(Aa,hg.Caj,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Eb);gb.Bq(Eb)}Ua.resultsUpdated(gb)}Yzf(Aa,Ua,gb,Eb,Ub,vc){const jd=[];for(const Id of Ua)if(Gh.a(Aa,Id)){this.qb.cea?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(gb,Ub)),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(gb,Eb))):(jd.push(appChrome.actions.setControlLabel(gb,Ub)),jd.push(appChrome.actions.setButtonCommandValueId(gb,
Eb)),appChrome.api.dispatch(jd));vc.ys(new n.a(gb,28,null,null,1));break}return vc}}hg.BQl="unhide row rows col cols column columns".split(" ");hg.Caj=["freeze","selection","pane","panes"];Object(h.a)(hg,"OfficeScriptsSamplesProvider",null,[909]);var Lh=d(18),La=d(16),lb=d(456),Ob=d(305),mc=d(455),Rc=d(36),Ud=d(103),ue=d(126);class Xe{constructor(Aa){this.CI=null;this.DS=-1;this.ZJe=14;this.$Je=12;this.attributes=this.YRd=this.query=null;this.LBb=!1;this.wrb=[];this.ji=lf.AFrameworkApplication.Je;
lf.AFrameworkApplication.fa&&(this.ZJe=lf.AFrameworkApplication.fa.uc("TellMeMaxTermedResults",this.ZJe),this.$Je=lf.AFrameworkApplication.fa.uc("TellMeMaxZeroTermResults",this.$Je));this.IJ=Aa}get Yk(){return this.wrb}get dzd(){return this.YRd}Bq(Aa){let Ua=!1;for(let gb=0;gb<this.Yk.length;gb++)if(30!==this.Yk[gb].groupType&&this.Yk[gb].groupType===Aa.groupType){this.LTd(this.Yk[gb],Aa);Ua=!0;break}Ua||this.Yk.push(Aa)}LTd(Aa,Ua){for(let gb=0;gb<Ua.results.length;gb++)Aa.ys(Ua.results[gb])}Dqh(Aa){const Ua=
[];for(const gb of this.Yk)gb.groupType!==Aa&&Ua.push(gb);this.Yk.length!==Ua.length&&(this.wrb=Ua)}X$k(Aa){let Ua=null,gb=null,Eb=null;for(let Ub=0;Ub<Aa.length;Ub++){const vc=Aa[Ub];if(vc&&vc.Yk&&vc.Yk.length)for(const jd of vc.Yk)if(17===jd.groupType||18===jd.groupType)Ua=jd;else if(0===jd.groupType||16===jd.groupType)gb=jd,Eb=vc}Ua&&gb&&0<gb.results.length&&(17===Ua.groupType&&({xTd:gb,YTd:Ua}=yi.CommandResultsUtility.hfi(gb,Ua,this.IJ.lH()?this.IJ.lH().Bfj:-.6)),Eb.Dqh(gb.groupType))}aEl(){this.IJ&&
(new Lh.a,this.avc(this.IJ.PZg))}Scc(Aa,Ua){return this.query.Ef.length>this.IJ.lH().ssj&&this.a5j(Aa,Ua)||this.query.Ef.length>this.IJ.lH().tsj&&this.N7j(Aa,Ua)?!0:!1}N7j(Aa,Ua){return Aa&&Aa.length&&Ua&&Ua.length?-1===Ua.toLowerCase().indexOf(Aa.toLowerCase())?!1:!0:!1}a5j(Aa,Ua){return Aa&&Aa.length&&Ua&&Ua.length?Ua.toLowerCase().startsWith(Aa.toLowerCase()):!1}z7i(Aa){const Ua=[];for(const gb of this.IJ.lH().gI?this.dzd:this.Yk)Aa.contains(gb.groupType)||Ua.push(gb);this.IJ.lH().gI?this.YRd=
Ua:this.wrb=Ua}GUl(Aa,Ua){const gb=[];for(const Eb of this.Yk){const Ub=Eb;if(13!==Ub.groupType||24!==Ub.groupType){const vc=Aa[Ob.a[Ub.groupType].toLowerCase()];let jd="False";vc<Ua&&(jd="True");Ub.displayName=Ub.displayName+" ("+jd+": "+vc+")"}gb.push(Ub)}this.wrb=gb}avc(Aa,Ua=!1,gb=null){if(this.IJ.lH().gI){if(!Ua)for(this.YRd=Array(this.Yk.length),Ua=0;Ua<this.Yk.length;Ua++)this.dzd[Ua]=this.Yk[Ua];this.IJ.M0g.avc(this.Yk,this.dzd,this.query,Aa,gb)}else{for(gb=new Lh.a;this.Yk.length;){Ua=this.Yk.pop();
const Eb=Ob.a[Ua.groupType].toLowerCase(),Ub=Aa[Eb];if(ue.b(Ub))throw Error.create("GroupId "+Eb+" missed from group SortingOrder");gb.add(new La.a(Ub,Ua))}gb.Sc((Eb,Ub)=>Eb.key<Ub.key?-1:1);for(Aa=0;Aa<gb.count;Aa++)Ua=gb.ga(Aa).value,this.Yk.push(Ua)}}bEl(){var Aa=!1;let Ua=!1,gb=!1;for(let Ub=0;Ub<this.Yk.length;Ub++){var Eb=this.Yk[Ub];const vc=Eb.groupType;if(8===vc||15===vc||14===vc){Eb=Eb.results;for(let jd=0;jd<Eb.length;jd++){if(8===vc&&this.Scc(this.query.Ef,Eb[jd].label)){Aa=!0;break}if(15===
vc&&this.Scc(this.query.Ef,Eb[jd].label)){Ua=!0;break}if(14===vc){if(this.Scc(this.query.Ef,Eb[jd].label)||this.Scc(this.query.Ef,Eb[jd].description)){gb=!0;break}const Id=Eb[jd].label.split(" ");for(const Od of Id)if(this.Scc(this.query.Ef,Od)){gb=!0;break}}}}}Aa=this.IJ.Qtj(Aa,Ua,gb);this.avc(Aa)}Hib(Aa,Ua,gb,Eb,Ub,vc){if(Ub===this.CI){var jd=Aa.data.Wd;Ub=null;try{Ub=Rc.b(jd)}catch(Uc){x.TellMeActor.instance.Kd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
Uc);return}if("RankerResults"in Ub&&Ub.RankerResults){this.Ija();var Id=Ub.RankerResults,Od=new Lh.a,ba=new Lh.a;jd=0;for(var Da of Id){Id=Da.ProviderId;var Qa=Da.Score;jd+=Qa;Od.add(new La.a(Id,Qa))}Od.Sc((Jd,ne)=>Jd.value>ne.value?-1:1);Qa=vc?vc.Uuj:1E-6;Da={};Id={};let Uc=0;for(var nb=0;nb<Od.count;nb++){let Jd=parseInt(Od.ga(nb).key),ne=Od.ga(nb).value/jd;1===Jd&&(Id.answer=Uc++,Id.entity=Uc++,Id.definition=Uc++,Id.wolframanswer=Uc++,ne<Qa&&(ba.add(9),ba.add(11),ba.add(10),ba.add(12)),Da.answer=
ne,Da.entity=ne,Da.definition=ne,Da.wolframanswer=ne);2===Jd&&(Id.assistance=Uc++,ne<Qa&&ba.add(8),Da.assistance=ne);3===Jd&&(Id.classifier=Uc++,Id.serviceclassifier=Uc++,ne<Qa&&(ba.add(0),ba.add(17)),Da.classifier=ne,Da.serviceclassifier=ne);4===Jd&&(Id.people=Uc++,ne<Qa&&ba.add(14),Da.people=ne);5===Jd&&(Id.document=Uc++,ne<Qa&&ba.add(15),Da.document=ne);6===Jd&&(Id.findindocument=Uc++,ne<Qa&&ba.add(2),Da.findindocument=ne);7===Jd&&(Id.notes=Uc++,ne<Qa&&ba.add(20),Da.notes=ne);8===Jd&&(Id.image=
Uc++,ne<Qa&&ba.add(19),Da.image=ne)}Od=new Lh.a;Od.add("classifier");Od.add("serviceclassifier");Od.add("appsforoffice");Od.add("addin");Od.add("findindocument");Od.add("assistance");Od.add("document");Od.add("people");Od.add("answer");Od.add("wolframanswer");Od.add("definition");Od.add("entity");Od.add("image");Od.add("template");Od.add("officescript");for(nb=0;nb<Od.count;nb++)Od.ga(nb)in Id||(Id[Od.ga(nb)]=Uc++);Id.learning=Uc++;Id.insights=Uc++;Id.actionai=Uc++;Id.actionaicommand=Uc++;Id.feedback=
Uc++;vc&&vc.B2j&&this.GUl(Da,Qa);vc&&vc.C2j&&this.z7i(ba);ba={};for(var Wb in Da)ba[Wb]=Da[Wb]*jd;this.avc(Id,!0,ba)}if(vc.V3c&&"Intents"in Ub&&Ub.Intents){Wb=Ub.Intents;for(var Jb of Wb)if(this.$re(Jb)&&"Serplet"===Jb.GroupType&&Jb.ConfidenceScore>Jb.ConfidenceThreshold){Wb=!1;Ub=0;if(vc.hre){jd=new n.a("",32);for(ba=0;ba<this.Yk.length;ba++)if((Od=this.Yk[ba].results)&&0<Od.length){Ub=ba;jd=Od[0];break}2===jd.groupType&&(Wb=!0)}jd=new z.a(13);Wb&&vc.hre&&(jd=new z.a(13,CommonUIStrings.l_TellMeWebTitle));
ba=new n.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Ef,null,0);Od=[];Da=null;Da=B.a.P9()?B.a.ADa(this.query.Ef,1):B.a.F2d(this.query.Ef);Od.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Da));Da=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Ef);Od.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Da));appChrome.api.dispatch(Od);jd.ys(ba);ba=[];if(Wb&&vc.hre)for(ba.push(this.Yk[Ub]),ba.push(jd),Wb=
Ub+1;Wb<this.Yk.length;Wb++)(Ub=this.Yk[Wb].results)&&0<Ub.length&&ba.push(this.Yk[Wb]);else for(ba.push(jd),Wb=0;Wb<this.Yk.length;Wb++)(Ub=this.Yk[Wb].results)&&0<Ub.length&&ba.push(this.Yk[Wb]);this.wrb=ba}}if(vc.adc&&!vc.gI){Jb=Wb=-1;for(Ub=0;Ub<this.Yk.length;Ub++)switch(this.Yk[Ub].groupType){case 23:Wb=Ub;break;case 0:case 17:case 2:-1===Jb&&(Jb=Ub)}if(-1!==Wb){Jb=-1===Jb?0:Wb>Jb?Jb+1:Jb;Wb=this.Yk[Wb];Ub=Array(this.Yk.length);jd=0;for(ba=0;ba<Ub.length;ba++)ba===Jb?Ub[ba]=Wb:(23===this.Yk[jd].groupType&&
jd++,Ub[ba]=this.Yk[jd],jd++);this.wrb=Ub}}Eb.resultsUpdated(this);Eb=x.TellMeActor.instance.Kd;Eb.o6(Ua.length,"RankerInference",Aa.data.Oe.toString(),Math.round(window.performance.now()-gb),mc.a.yKh,!0,lb.a.vua);this.LBb&&Eb&&(Aa=this.query.j0a,Ua=Eb.xAc,vc.m4c&&Aa>Ua&&!vc.gI&&(Eb.bue(this.query.Ef),Eb.u0e(Aa)))}}$re(Aa){if("GroupType"in Aa&&Aa.GroupType&&"ConfidenceScore"in Aa&&"ConfidenceThreshold"in Aa)return!0;x.TellMeActor.instance.Kd.onError("IsValidIntentGroup","Invalid intents found");return!1}uib(Aa,
Ua,gb,Eb,Ub){Eb===this.CI&&(this.Ija(),x.TellMeActor.instance.Kd.o6(Ua.length,"RankerInference",Aa.data.Oe.toString(),Math.round(window.performance.now()-gb),mc.a.yKh,!1,lb.a.vua));Ub.resultsUpdated(this)}Ija(){-1!==this.DS&&(window.clearTimeout(this.DS),this.DS=-1)}cEl(Aa){let Ua;Ua=this.IJ.lH().gI?x.TellMeActor.instance.Kd.Oee(this.dzd,this.query.Ef):x.TellMeActor.instance.Kd.Oee(this.Yk,this.query.Ef);var gb=this.IJ.lH().Tuj;""!==gb&&(gb="_"+gb);let Eb="";this.IJ.lH().Vpe&&(Eb="RankerInference"+
gb+",");this.IJ.lH().V3c&&(Eb+="SerpletClassifier");","===Eb.charAt(Eb.length-1)&&(Eb=Eb.substring(0,Eb.length-1));gb=x.TellMeActor.instance.Kd.meg(Eb);const Ub=this.CI=Ud.a.create().toString();gb["Client-Request-Id"]=Ub;const vc=window.performance.now(),jd=this.IJ.lH()?this.IJ.lH().Vuj:600;this.Ija();this.DS=window.setTimeout(()=>{if(Ub===this.CI){this.CI="";this.DS=-1;Aa.resultsUpdated(this);const Id={};Id[r.a.provider]="Ranker";Id[r.a.Ejb]=this.query.j0a;x.TellMeActor.instance.Kd.TH(m.a.timedOut,
jd,Id)}},jd);this.ji.qj(x.TellMeActor.instance.Kd.neg(),2,Ua,gb,!1,0,Id=>{this.Hib(Id,this.query.Ef,vc,Aa,Ub,this.IJ.lH())},Id=>{this.uib(Id,this.query.Ef,vc,Ub,Aa)},null,null,!1,4E3,6E3)}ENl(){var Aa=0,Ua=new Lh.a,gb=this.IJ.NZg,Eb=this.IJ.OZg;for(var Ub=0;Ub<this.Yk.length;Ub++){var vc=this.Yk[Ub],jd=Ob.a[vc.groupType].toLowerCase(),Id=gb[jd];Aa+=vc.results.length;vc.results.length>Id&&(jd=Eb[jd],ue.b(jd)||Ua.add(new La.a(jd,vc)))}Eb=!this.query||""===this.query.Ef.trim();Ub=Aa-(Eb?this.$Je:this.ZJe);
if(!(0>=Ub)){Eb=window.performance.now();Aa=Aa.toString()+" total,"+Ub.toString()+" to remove.";if(0<Ua.count)for(Ua.Sc((Od,ba)=>Od.key>ba.key?-1:1),vc=0;vc<Ua.count&&0<Ub;vc++){jd=Ua.ga(vc).value;Id=Ob.a[jd.groupType].toLowerCase();let Od=jd.results.length-gb[Id];Od>Ub&&(Od=Ub);0<Od&&(jd.SWe(Od),Aa+=Id+": "+Od.toString()+" results removed.",Ub-=Od)}if(0<Ub){Aa+=Ub.toString()+" results left after trimming.";Ua=new Lh.a;gb=this.IJ.SZg;for(vc=0;vc<this.Yk.length;vc++)jd=this.Yk[vc],Id=gb[Ob.a[jd.groupType].toLowerCase()],
ue.b(Id)||Ua.add(new La.a(Id,jd));Ua.Sc((Od,ba)=>Od.key<ba.key?-1:1);for(gb=0;0<Ub;)vc=Ua.ga(gb++).value,Ub>=vc.results.length?(Array.remove(this.Yk,vc),Aa+=Ob.a[vc.groupType]+": "+vc.results.length.toString()+" results force removed.",Ub-=vc.results.length):(vc.SWe(Ub),Aa+=Ob.a[vc.groupType]+": "+Ub.toString()+" results force removed.",Ub=0)}x.TellMeActor.instance.Kd&&(Ua={},Ua[r.a.message]=Aa,x.TellMeActor.instance.Kd.TH("ShowOptimal",window.performance.now()-Eb,Ua))}}}Object(h.a)(Xe,"CombineResultsUpdatedEventArgs",
null,[944]);class pe{constructor(Aa,Ua,gb,Eb=!1,Ub=""){this.dNd=this.tOd=!1;this.RD=Aa;this.j6a=[];this.usf=Ua.length;this.qb=x.TellMeActor.instance.lH();this.uDc=Eb;this.vQa=Ub;this.fsb={};for(Aa=0;Aa<Ua.length;++Aa)this.fsb[Aa.toString()]=gb?0:Ua[Aa].LL()}osl(Aa,Ua){Ua&&Ua.query&&Ua.query.j0a<x.TellMeActor.instance.Bca||(this.j6a[Aa]=Ua,this.dNd?this.tOd=!0:(!this.qb||3!==this.qb.Hq||3!==this.fsb[Aa.toString()]||this.DVf())&&this.T0c())}lSk(){this.dNd=!0}KQl(){this.dNd=!1;this.tOd&&(this.tOd=!1,
this.T0c())}DVf(){if(this.j6a.length<this.usf)return!1;for(let Aa=0;Aa<this.usf;++Aa)if(!this.j6a[Aa])return!1;return!0}T0c(){var Aa=this.DVf();const Ua=window.performance.now(),gb=new Xe(x.TellMeActor.instance.jjf);gb.X$k(this.j6a);for(var Eb=0;Eb<this.j6a.length;++Eb){var Ub=this.j6a[Eb];if(Ub&&Ub.Yk&&Ub.Yk.length&&(gb.query=Ub.query,Ub.attributes&&0<Ub.attributes.length&&(gb.attributes=Ub.attributes),Ub&&Ub.Yk&&(Aa||this.NCi(Eb,this.j6a))))for(const vc of Ub.Yk)gb.Bq(vc)}gb.Yk&&gb.Yk.length&&(gb.LBb=
Aa,this.qb&&this.qb.l9e&&gb.ENl(),this.qb&&this.qb.d6j&&gb.query.Ef&&0<gb.query.Ef.length?gb.bEl():gb.aEl(),this.qb&&(this.qb.Vpe||this.qb.V3c)&&this.uDc&&gb.query.Ef&&0<gb.query.Ef.length&&gb.LBb&&this.vQa!==e.a.contextMenu?(3===this.qb.Hq&&Aa||this.RD.resultsUpdated(gb),gb.cEl(this.RD)):this.RD.resultsUpdated(gb),Aa=x.TellMeActor.instance.Kd,gb.LBb&&Aa&&(Eb=gb.query.j0a,Ub=Aa.xAc,gb.query.Ef&&0<gb.query.Ef.length&&this.uDc&&this.qb.m4c&&this.vQa!==e.a.contextMenu&&Eb>Ub&&!this.qb.Vpe&&!this.qb.gI&&
(Aa.bue(gb.query.Ef),Aa.u0e(Eb)),Aa.TH(m.a.ihl,window.performance.now()-Ua)))}NCi(Aa,Ua){if(!(this.fsb&&Aa.toString()in this.fsb)||Ua.length<=Aa||!Ua[Aa])return!1;if(!Ua[Aa].Yk.length)return!0;const gb=this.fsb[Aa.toString()];if(0===gb)return!0;const Eb=this.fsb;for(let vc in Eb){var Ub=Eb[vc];const jd=Number.parseInvariant(vc);if(jd!==Aa&&Ub===gb&&!(Ua.length>jd&&Ua[jd]))return!1}return!0}}Object(h.a)(pe,"ResultsAggregator",null,[]);var gg=d(1044);class cg{constructor(){this.tQb=this.uQb=this.sQb=
this.logCount=this.logRank=this.invertedRank=0}Mei(Aa,Ua){switch(Aa){case 1:this.invertedRank=Ua;break;case 3:this.logRank=Ua;break;case 2:this.logCount=Ua;break;case 5:this.sQb=Ua;break;case 4:this.uQb=Ua;break;case 6:this.tQb=Ua}}}Object(h.a)(cg,"CommandFeatures",null,[]);class Sg{constructor(Aa){this.Zhf=0;this.qia=Aa;this.BYh={}}get modelId(){return this.qia}get featureIntercept(){return this.Zhf}get F2b(){return this.BYh}Odi(Aa,Ua,gb){0===Ua?this.Zhf=gb:(this.F2b[Aa]||(this.F2b[Aa]=new cg),this.F2b[Aa].Mei(Ua,
gb))}}Object(h.a)(Sg,"CoefficientsModel",null,[]);const Hh=(Aa,Ua)=>Math.pow(10,-Ua/(60*Math.LN10/Math.LN2*Aa));class li{constructor(Aa,Ua){this.pn=1;this.vBc=new cg;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Aa?1/Aa:0;this.features.logRank=2/Math.pow(2,Aa);this.features.sQb=Hh(10,Ua);this.features.uQb=Hh(2,Ua);this.features.tQb=Hh(1,Ua)}get count(){return this.pn}get features(){return this.vBc}wPj(){this.pn=this.count+1;this.features.logCount=1+Math.log(this.count)/
Math.LN2}zUl(Aa){const Ua=2/Math.pow(2,Aa);this.features.invertedRank=Math.max(this.features.invertedRank,Aa?1/Aa:0);this.features.logRank=Math.max(this.features.logRank,Ua)}NVl(Aa){const Ua=Hh(10,Aa),gb=Hh(2,Aa);Aa=Hh(1,Aa);this.features.sQb=Math.max(this.features.sQb,Ua);this.features.uQb=Math.max(this.features.uQb,gb);this.features.tQb=Math.max(this.features.tQb,Aa)}}Object(h.a)(li,"CommandModel",null,[]);class Oh{constructor(Aa){this.lTb=null;if(!Aa&&x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("PredictionEngine",
"IModelAdapter can't be null");this.Mqb=Aa;this.tEc=this.vte()}vte(){const Aa=this.Mqb.Soj(),Ua=this.Mqb.Mce();if(void 0===Aa||null===Aa||void 0===Ua||null===Ua)return!1;try{window.performance.now();this.lTb={};for(let gb=0;gb<Aa.length;gb++){const Eb=Aa[gb],Ub=Ua[Eb[0].toString()].trim(),vc=Eb[1],jd=0!==vc?Ua[Eb[2].toString()].trim():"",Id=Eb[3];Ub in this.lTb||(this.lTb[Ub]=new Sg(Ub));this.lTb[Ub].Odi(jd,vc,Id)}}catch(gb){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("LoadModelData",
"Error Loading Suggestions Model: "+gb);return!1}return!0}Zbj(){const Aa=this.Mqb.wmj(),Ua={};if(!Aa)return Ua;let gb=1;for(let Eb=0;Eb<Aa.length;Eb++){const Ub=Aa[Eb];Ub.Id in Ua?(Ua[Ub.Id].wPj(),Ua[Ub.Id].zUl(gb),Ua[Ub.Id].NVl(Ub.TimeElapsedSinceClick)):Ua[Ub.Id]=new li(gb,Ub.TimeElapsedSinceClick);gb++}return Ua}Wpe(){this.tEc||(this.tEc=this.vte());return this.tEc}Irj(){let Aa=[];if(!this.tEc){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("GetPredictedCommands","IModelAdapter returned no data");
return Aa}const Ua=this.Zbj(),gb=this.lTb;for(let Ub in gb){const vc=gb[Ub],jd=vc.modelId;let Id=0;for(let Od in Ua){var Eb=Od;const ba=Ua[Od].features;(Eb=Eb in vc.F2b?vc.F2b[Eb]:null)&&(Id+=ba.invertedRank*Eb.invertedRank+ba.logRank*Eb.logRank+ba.logCount*Eb.logCount+ba.sQb*Eb.sQb+ba.uQb*Eb.uQb+ba.tQb*Eb.tQb)}Id+=vc.featureIntercept;Aa.push(new Vd.a(jd,Id))}Aa.sort((Ub,vc)=>Ub.score<vc.score?1:Ub.score>vc.score?-1:0);0<Aa.length-10&&(Aa=Aa.slice(0,10));return Aa}}Object(h.a)(Oh,"PredictionEngine",
null,[]);class Wi{constructor(){this.xuf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}wVc(Aa,
Ua){return Ua&&"word"===Ua.application.toLowerCase()&&Aa in this.xuf?this.xuf[Aa]:[]}}Object(h.a)(Wi,"SuggestionResultsUtility",null,[]);class Xi{constructor(Aa,Ua,gb){this.qb=Ua;this.gXb=new Oh(Aa);this.LS=gb;this.Pvf=new Wi}pE(){return"Suggestion"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(Aa,Ua,gb,Eb=e.a.tellMe,Ub=null){gb=new t.a(Aa);x.TellMeActor.instance.Sxc=!1;if((!Ub||Array.contains(Ub,16))&&B.a.aG(Aa)){if(!this.gXb.Wpe()){if(x.TellMeActor.instance.Kd)x.TellMeActor.instance.Kd.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.cre()&&0<this.Pvf.wVc(x.TellMeActor.instance.SPc,this.qb).length){const jd=this.Pvf.wVc(x.TellMeActor.instance.SPc,this.qb);Ub=[];for(var vc of jd)this.qb.Uud&&"Find"===vc||Ub.push(new Vd.a(vc,0));x.TellMeActor.instance.Sxc=!0}else Ub=this.gXb.Irj();yi.CommandResultsUtility.Y5c(Ub,!0,"Recommended","LRE");vc=[];for(const jd of Ub)this.LS&&this.LS.J0d(jd.commandId)||
vc.push(jd);Aa=yi.CommandResultsUtility.H8b(Aa,vc,this.qb,null,null,null,16,1);0<Aa.results.length&&Eb!==e.a.contextMenu&&(Aa.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Aa.results.length&&gb.Bq(Aa)}Ua.resultsUpdated(gb)}cre(){return!!this.qb&&(this.qb.cre||this.qb.z$j)}}Object(h.a)(Xi,"SuggestionResultsProvider",null,[909]);class Fi{wmj(){return x.TellMeActor.instance.RDd}Soj(){return window.TellMeSuggestionModel}Mce(){return window.CoefficientModelIdMap}}Object(h.a)(Fi,"SuggestionsModelAdapter",
null,[1019]);var Mi=d(1079),mh=d(1013);d.d(S,"AggregatorResultsProvider",function(){return ai});class ai{constructor(Aa=!1){this.irb={};this.irb[e.a.tellMe]=[];this.irb[e.a.contextMenu]=[];this.uDc=Aa}Fvg(Aa,Ua,gb,Eb,Ub=null){let vc;var jd=!1;switch(Eb){case e.a.contextMenu:vc=this.irb[e.a.contextMenu];jd=!0;break;default:vc=this.irb[e.a.tellMe]}Ua=new pe(Ua,vc,jd,this.uDc,Eb);Ua.lSk();for(let Id=0;Id<vc.length;++Id){const Od=window.performance.now(),ba=new F(Ua,Id);(jd=x.TellMeActor.instance.lH())&&
jd.zti?window.setTimeout(()=>{vc[Id].IB(Aa,ba,gb,Eb,Ub);if(x.TellMeActor.instance.Kd){const Da={};Da[r.a.provider]=vc[Id].pE();Da[r.a.Ejb]=Aa.j0a;x.TellMeActor.instance.Kd.TH(m.a.IB,window.performance.now()-Od,Da)}},0):(vc[Id].IB(Aa,ba,gb,Eb,Ub),x.TellMeActor.instance.Kd&&(jd={},jd[r.a.provider]=vc[Id].pE(),jd[r.a.Ejb]=Aa.j0a,x.TellMeActor.instance.Kd.TH(m.a.IB,window.performance.now()-Od,jd)))}Ua.KQl()}pE(){return"Aggregator"}LL(){return 0}IB(Aa,Ua,gb=!1,Eb=e.a.tellMe,Ub=null){if(x.TellMeActor.instance.LAk)this.Fvg(Aa,
Ua,gb,Eb,Ub);else{const vc=window.performance.now();x.TellMeActor.instance.WYl.then(()=>{x.TellMeActor.instance.Kd&&x.TellMeActor.instance.Kd.TH(m.a.MAk,window.performance.now()-vc);this.Fvg(Aa,Ua,gb,Eb,Ub);return!0})}}kz(Aa,Ua){this.irb[Ua].push(Aa)}Cfi(Aa){switch(Aa){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ua=this.irb[e.a.tellMe];for(const gb of Ua)if("FindInDocument"===gb.pE()){gb.Rql(Aa);break}}}static createInstance(Aa,Ua,gb,Eb){const Ub=
Ua.Z3;var vc=Eb&&B.a.S2e(Ua),jd=vc&&Ua.ePe&&!Ub;const Id=Ua.Ore&&!B.a.iCb()&&!Ub,Od=Ua.dqe&&!Ub,ba=new ai(vc);if(Ua.Byl&&!Ub){var Da=new Ah(Ua);ba.kz(Da,e.a.tellMe)}Da=Ua.Qp?lf.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):lf.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const Qa=!Da&&lf.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");ba.kz(new Cj.a(Aa,Ua.mPl,Qa,!1),e.a.tellMe);Da&&!Ub&&ba.kz(new Xi(new Fi,Ua,Aa),e.a.tellMe);Aa=lf.AFrameworkApplication.Aa.mb.Jug?
new Ej(Ua,new Li):new Zj(Ua,gb);ba.kz(Aa,e.a.contextMenu);(vc&&Ua.fPe||jd)&&ba.kz(Mi.a.pSf(Ua,!0),e.a.tellMe);ba.kz(Aa,e.a.tellMe);!Ua.$7i||Ub||"Word"===Ua.application&&Ua.a2f||ba.kz(new zh(Ua),e.a.tellMe);Ua.N7a&&!Ub&&(jd=new L(Ua),ba.kz(jd,e.a.tellMe),ba.kz(jd,e.a.contextMenu));!Ua.Ktb||Ua.nuc||Ua.muc||Ub||ba.kz(new M.a(Ua),e.a.tellMe);Eb&&(Ua.KFa||B.a.P9())&&(jd=new jj(Ua),ba.kz(jd,e.a.tellMe),ba.kz(jd,e.a.contextMenu));vc&&ba.kz(Mi.a.pSf(Ua,!1),e.a.tellMe);Eb&&!Ua.k6e&&B.a.R2e(Ua)&&!Ub&&(ba.kz(new gg.a(Ua),
e.a.tellMe),Ua.bHl&&ba.kz(new gg.a(Ua),e.a.contextMenu));Id&&ba.kz(new he(Ua),e.a.tellMe);!Ua.$Ob&&!Ua.gI||Ub||ba.kz(new Sh.a(Ua),e.a.tellMe);Ua.adc&&!Ub&&ba.kz(new mh.a(Ua),e.a.tellMe);Ua.Cne&&(vc=new w(Ua),ba.kz(vc,e.a.tellMe),ba.kz(vc,e.a.contextMenu));Eb&&Ua.g1c&&!Ub&&ba.kz(new J.AddinResultsProvider(Ua),e.a.tellMe);Od&&"Excel"===Ua.application&&!Ub&&ba.kz(new hg(Ua),e.a.tellMe);return ba}}Object(h.a)(ai,"AggregatorResultsProvider",null,[909])},1044:function(K,S,d){K=d(0);var h=d(145),e=d(684),
r=d(391),m=d(265);class n{constructor(aa,ka,H,ra,ha,Ma){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=aa;this.url=ka;this.spWebUrl=H;this.uniqueId=ra;this.size=ha;this.lastModified=Ma}}Object(K.a)(n,"FileInfo",null,[]);var z=d(456);class t{constructor(aa,ka){this.DimensionValue=this.DimensionName=null;this.DimensionName=aa;this.DimensionValue=ka}}Object(K.a)(t,"Dimension",null,[]);class x{constructor(aa,ka,H,ra,ha){this.Query=this.EntityType=null;
this.Size=this.From=0;this.Filter=null;this.EntityType=aa;this.Query=ka;this.From=H;this.Size=ra;ha&&(this.Filter=ha)}}Object(K.a)(x,"EntityRequest",null,[]);class B{constructor(aa){this.QueryString=null;this.QueryString=aa}}Object(K.a)(B,"Query",null,[]);var D=d(160);class w{constructor(aa,ka){this.Dimensions=this.Name=null;this.Name=aa;this.Dimensions=ka}}Object(K.a)(w,"Scenario",null,[]);var J=d(174),F=d(173);class L{constructor(aa,ka,H,ra){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=
null;this.EntityRequests=aa;this.TimeZone=ka;this.Cvid=H;this.Scenario=ra}}Object(K.a)(L,"SubstrateBody",null,[]);var M=d(455),Q=d(117),C=d(108),O=d(27),U=d(952),T=d(951),ca=d(302),N=d(36),da=d(47),Y=d(103);d.d(S,"a",function(){return fa});class fa{constructor(aa){this.uXb=this.bQa=this.GEc=this.JUb=this.TXb=0;this.aqf=this.Jrf=this.CI=null;this.oKd=0;this.DS=-1;this.xZb="";this.wGd=!1;this.ji=O.AFrameworkApplication.Je;this.qb=aa;this.uHc=this.Pee();this.p6a=new e.a;this.$of=this.qb.l9e?3:2;this.cRd=
this.qb.l9e&&this.qb.dFh?5:3;this.LSd=this.qb.Uud?2:3;this.Wxf=1;this.hEc=this.qb.Lag;this.rvf=this.qb.E7j;this.wYb=aa.ndg;O.AFrameworkApplication.fa&&(this.Jrf=O.AFrameworkApplication.fa.Ha("AppCatalogUrl")+O.AFrameworkApplication.fa.Ha("SearchPersonaPhotoBaseUrl"),this.wGd=this.qb.Pwb||this.qb.Z3||this.qb.WRc);this.qb.Z3&&(this.LSd=this.cRd=5)}pE(){return"Substrate"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:3}IB(aa,ka,H,ra=h.a.tellMe,ha=null){const Ma=new F.a(aa);if(!ha||Array.contains(ha,14)||
Array.contains(ha,15)||Array.contains(ha,20))if(!this.oKd||window.performance.now()-this.oKd>=C.a.Yxd)if(H=this.p6a.Rdg())this.oKd=window.performance.now(),H.then(Ga=>{Ga&&""!==Ga?(this.xZb=Ga,""!==this.CI&&this.Qdg(aa,ra,this.xZb,ka,ha)):(Q.TellMeActor.instance.Kd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ka.resultsUpdated(Ma))},Ga=>{Q.TellMeActor.instance.Kd.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ga);ka.resultsUpdated(Ma)});
else{if(Q.TellMeActor.instance.Kd)Q.TellMeActor.instance.Kd.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ka.resultsUpdated(Ma)}else this.xZb&&""!==this.xZb?this.Qdg(aa,ra,this.xZb,ka,ha):(ka.resultsUpdated(Ma),Q.TellMeActor.instance.Kd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ka.resultsUpdated(Ma)}V1(){this.bQa=this.uXb=this.GEc=this.JUb=this.TXb=0}Qdg(aa,ka,H,ra,ha){this.V1();const Ma=new F.a(aa),Ga=this.CI=Y.a.create().toString();
this.Ija();this.DS=window.setTimeout(()=>{if(Ga===this.CI){this.CI="";this.DS=-1;ra.resultsUpdated(Ma);const Fa={};Fa[r.a.provider]=this.pE();Fa[r.a.Ejb]=aa.j0a;Q.TellMeActor.instance.Kd.TH(m.a.timedOut,this.wYb,Fa)}},this.wYb);const na={"Content-Type":"application/json",Accept:"application/json"};na.Authorization="Bearer "+H;na["X-Office-Version"]=O.AFrameworkApplication.buildVersion;na["X-Office-Application"]=O.AFrameworkApplication.fa.Ha("Application");na["X-Office-Platform"]="WAC";na["X-TellMe-SessionId"]=
Q.TellMeActor.instance.uYc();na["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;na["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;na["Client-Request-Id"]=Ga;const wa=window.performance.now();this.ji.qj(this.pxj(),2,this.qxj(aa.Ef,this.qb.application,Q.TellMeActor.instance.uYc(),C.a.aG(aa)),na,!1,0,Fa=>{this.Hib(Fa,aa,ra,Ga,wa,ka,ha)},Fa=>{this.uib(Fa,aa,ra,Ga,wa)},null,null,!1,4E3,6E3)}Ija(){-1!==this.DS&&(window.clearTimeout(this.DS),this.DS=-1)}Hib(aa,ka,H,ra,ha,Ma,Ga){Q.TellMeActor.instance.Kd.o6(ka.Ef.length,
this.uHc.join(","),aa.data.Oe.toString(),Math.round(window.performance.now()-ha),M.a.substrate,!0,z.a.vua);const na=C.a.aG(ka),wa=new F.a(ka);if(ra===this.CI){this.Ija();aa=N.b(aa.data.Wd);if(aa.Groups){aa=aa.Groups;for(const Fa of aa)"People"===Fa.Type&&this.qb.awc&&(Ga?Array.contains(Ga,14):1)?(aa=this.mbg(Fa.Suggestions,na,Ma),0<aa.results.length&&wa.Bq(aa)):"File"===Fa.Type&&this.qb.Zvc&&(Ga?Array.contains(Ga,15):1)?(aa=this.lbe(Fa.Suggestions,na,Ma),0<aa.results.length&&(this.r2c()&&(ra=new D.a("GenerateSlidesFromTellMe",
30,"",null,1),aa.ys(ra)),wa.Bq(aa))):"Notes"===Fa.Type&&this.qb.xWa&&Ma!==h.a.contextMenu&&(Ga?Array.contains(Ga,20):1)&&(aa=this.Iag(Fa.Suggestions,na,ka),0<aa.results.length&&wa.Bq(aa))}H.resultsUpdated(wa);Q.TellMeActor.instance.Kd.o6(ka.Ef.length,this.uHc.join(","),"",Math.round(window.performance.now()-ha),"",!0,z.a.provider)}else H.resultsUpdated(wa)}Iag(aa,ka,H){const ra=new J.a(20);ra.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ha of aa)this.N9j(ha)&&(aa=ha.NotesType,
aa=da.a.ug(aa),aa=this.Xpj(aa,ha.LastModifiedTime,ha.BodyPreview,ha.Subject,ka,H,ha))&&(aa.groupType=20,ra.ys(aa));return ra}mbg(aa,ka,H){const ra=new J.a(14);ra.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Ma of aa)if(this.O9j(Ma)){var ha=Ma.Id.split("@")[0];aa=Ma.EmailAddresses[0];let Ga=Ma.Type;if(void 0===Ga||null===Ga)Ga="User";if(ha=this.lrj(Ga,Ma.DisplayName,Ma.JobTitle,aa,ha,H,ka))ha.description=aa,aa=Ma.JobTitle,"Department"in Ma&&"CompanyName"in Ma&&(aa+="@"+Ma.Department+
"@"+Ma.CompanyName),ha.bVd=aa,ra.ys(ha)}return ra}lbe(aa,ka,H){const ra=new J.a(15);ra.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Fa of aa)if(this.E9j(Fa)){var ha=Fa.FileName;aa=Fa.FileExtension;var Ma=ha;ha.length>aa.length&&Ma.endsWith(aa)&&(Ma=ha.substr(0,ha.length-aa.length-1));var Ga=void 0,na=0;"DateCreated"in Fa&&Fa.DateCreated?(na=C.a.qfe(Fa.DateCreated),Ga=C.a.Deg(Fa.DateCreated),Ga=String.format(CommonUIStrings.l_CreatedTimeFormatString,Fa.Author,Ga)):Ga=Fa.Author;var wa=
Fa.AccessUrl+"?web=1";const pa=da.a.I$b(wa);ha=String.format('<a href="{0}">{1}</a>',pa,da.a.mVa(ha));if(H!==h.a.contextMenu||da.a.I9(wa))if(Ma=this.tkj(Ma,H===h.a.contextMenu?ha:wa,Ga,Fa.FileExtension,Fa.Text,ka))Ma.description=Fa.Author,Ma.vKc=na,ra.ys(Ma),this.wGd&&(na=Fa.AccessUrl,ha=C.a.kWc(aa),Ga=Fa.DateModified?Fa.DateModified:Fa.DateCreated,wa=Fa.Size?Fa.Size:Fa.FileSize,this.Lxl()&&(na=na.replace(RegExp("%20","g")," "),ha=C.a.uwj(aa)),aa=new n(ha,na,Fa.SPWebUrl,Fa.Id,wa,Ga),Q.TellMeActor.instance.Y$e(!1,
Ma.value,aa))}return ra}uib(aa,ka,H,ra,ha){ra===this.CI&&(this.Ija(),Q.TellMeActor.instance.Kd.o6(ka.Ef.length,this.uHc.join(","),aa.data.Oe.toString(),Math.round(window.performance.now()-ha),M.a.substrate,!1,z.a.vua));aa=new F.a(ka);H.resultsUpdated(aa)}lrj(aa,ka,H,ra,ha,Ma,Ga){Ga=Ga?this.Wxf:this.$of;if(!window.LPC&&!C.a.Aoe()||this.TXb===Ga)return null;this.TXb+=1;Ga="PeopleSuggestion"+this.TXb.toString();var na=this.Jrf+"?size=1&accountName="+ra;aa=Object.assign(new U.a,{PersonaType:aa,Smtp:ra,
ProfilePictureUrl:na,AadObjectId:ha});const wa=Object.assign(new T.a,{identifiers:aa,displayName:ka});aa=Ma===h.a.contextMenu;this.qb.cea?(Q.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ga,wa,ka,H)),Ma===h.a.contextMenu&&(H=C.a.$Rf(ka,ra,ha),Q.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ga,H))),Q.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ga,aa))):(na=[],na.push(appChrome.actions.setPersonaButtonCoauthor(Ga,
wa,ka,H)),Ma===h.a.contextMenu&&(H=C.a.$Rf(ka,ra,ha),na.push(appChrome.actions.setButtonCommandValueId(Ga,H))),na.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ga,aa)),appChrome.api.dispatch(na));return new D.a(Ga,11,ka,ra,0)}Xpj(aa,ka,H,ra,ha,Ma,Ga){if(ha&&!this.qb.Nug||this.GEc===this.hEc||this.uXb===this.hEc||this.bQa===this.hEc)return null;var na=null;this.GEc+=1;ha="";const wa=[],Fa={};Ga.type="Notes";this.aqf=Object.assign(new ca.a,{landingTab:"Notes",data:Ga});Ma=C.a.ADa(Ma.Ef,
33,this.aqf);if("onenotepagepreviews"===aa){if(!("ClickthroughUrl"in Ga&&Ga.ClickthroughUrl)||""===Ga.ClickthroughUrl)return null;this.uXb+=1;ha="OnenoteNotesSuggestion"+this.uXb.toString();Fa["default"]="SaveAsonetoc2_20";na=Ga.ClickthroughUrl;wa.push(appChrome.actions.setControlIconSet(ha,Fa));wa.push(appChrome.actions.setCompoundButtonCommandValueId(ha,na));na=new D.a(ha,19,null,null,0)}else if("stickynote"===aa){if(!this.rvf)return null;this.bQa+=1;ha="NotesSuggestion"+this.bQa.toString();Fa["default"]=
"ShowAllNotes_20";wa.push(appChrome.actions.setControlIconSet(ha,Fa));wa.push(appChrome.actions.setCompoundButtonCommandValueId(ha,Ma));na=new D.a(ha,21,null,null,0)}else if("samsung"===aa){if(!this.rvf)return null;this.bQa+=1;ha="NotesSuggestion"+this.bQa.toString();Fa["default"]="CategoryCollapsed_20";wa.push(appChrome.actions.setControlIconSet(ha,Fa));wa.push(appChrome.actions.setCompoundButtonCommandValueId(ha,Ma));na=new D.a(ha,20,null,null,0)}""!==ha&&(aa=C.a.Deg(ka),aa=String.format(CommonUIStrings.l_LastModifiedString,
aa),na.label=ra,na.vKc=C.a.qfe(ka),wa.push(appChrome.actions.setControlLabel(ha,ra)),wa.push(appChrome.actions.updateCompoundButtonDescription(ha,aa)),wa.push(appChrome.actions.setControlCustomTooltip(ha,H)),appChrome.api.dispatch(wa));return na}tkj(aa,ka,H,ra,ha,Ma){if(this.JUb===(Ma?this.LSd:this.cRd)||this.wGd&&"Word"!==C.a.kWc(ra))return null;this.JUb+=1;Ma="FileSuggestion"+this.JUb.toString();const Ga=[],na={};na["default"]=C.a.Vlj(ra);this.qb.cea?(Q.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma,
aa)),Q.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Ma,na)),Q.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ma,H)),Q.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ma,ka)),Q.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ma,ha)),this.qb.Pwb&&Q.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(Ma,"QuickActionOnFile"))):(Ga.push(appChrome.actions.setControlLabel(Ma,
aa)),Ga.push(appChrome.actions.setControlIconSet(Ma,na)),Ga.push(appChrome.actions.updateCompoundButtonDescription(Ma,H)),Ga.push(appChrome.actions.setCompoundButtonCommandValueId(Ma,ka)),Ga.push(appChrome.actions.setControlCustomTooltip(Ma,ha)),this.qb.Pwb&&Ga.push(appChrome.actions.setCompoundButtonSecondaryButtonId(Ma,"QuickActionOnFile")),appChrome.api.dispatch(Ga));return new D.a(Ma,6,aa,H,0)}Pee(){const aa=[];this.qb.awc&&Array.add(aa,"People");this.qb.Zvc&&Array.add(aa,"File");this.qb.xWa&&
Array.add(aa,"Notes");return aa}qxj(aa,ka,H,ra){var ha=new B(aa);aa=new x("File",ha,0,ra?this.LSd:this.cRd,null);ra=new x("People",ha,0,ra?this.Wxf:this.$of,C.a.vSk);ha=new x("Notes",ha,0,this.hEc,null);(this.qb.Pwb||this.qb.WRc)&&"powerpoint"===ka.toLowerCase()&&(ka="word");ka=new t("app",ka.toLowerCase());var Ma=[];Array.add(Ma,ka);ka=new w("tellmesearch",Ma);Ma=[];this.qb.Zvc&&Array.add(Ma,aa);this.qb.awc&&Array.add(Ma,ra);this.qb.xWa&&Array.add(Ma,ha);H=new L(Ma,"UTC",H,ka);return N.c(H)}pxj(){let aa=
this.qb.cHl;this.qb.xWa&&(aa+="?&setflight=NotesFrom3S");""!==this.qb.Sdg&&(aa=aa+"&"+this.qb.Sdg);return aa}O9j(aa){return"DisplayName"in aa&&"Id"in aa&&"EmailAddresses"in aa&&!!aa.Id&&!!aa.EmailAddresses}E9j(aa){return"FileExtension"in aa&&!!aa.FileExtension&&"FileName"in aa&&!!aa.FileName&&""!==aa.FileName&&"AccessUrl"in aa&&!!aa.AccessUrl&&""!==aa.AccessUrl}N9j(aa){return"Id"in aa&&!!aa.Id&&"NotesType"in aa&&!!aa.NotesType&&"Subject"in aa&&!!aa.Subject&&""!==aa.Subject}r2c(){return!!O.AFrameworkApplication.fa&&
O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Lxl(){return!!O.AFrameworkApplication.fa&&O.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(K.a)(fa,"SubstrateResultsProvider",null,[909])},1079:function(K,S,d){K=d(0);var h=d(18),e=d(145),r=d(684),m=d(391),n=d(265),z=d(456),t=d(160),x=d(174),B=d(173),D=d(117),w=d(108);class J{constructor(Y){this.qb=Y;this.uHc=
this.Pee()}pE(){return"Add-ins"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:3}IB(Y,fa){Y=new B.a(Y);fa.resultsUpdated(Y)}NUa(Y,fa,aa){let ka;ka=this.qb.gI?new x.a(29):new x.a(27);ka.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;aa&&this.$Bl(Y.Ef,fa,ka)}$Bl(Y,fa,aa){const ka=[];let H;H=this.qb.XVj?this.qb.gI&&this.qb.eRa?w.a.OTa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):this.qb.YVj?
this.qb.gI&&this.qb.eRa?w.a.OTa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.qb.gI&&this.qb.eRa?w.a.OTa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,Y);this.qb.cea?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",H)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
Y))):(ka.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",H)),ka.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(ka));aa.ys(new t.a("LaunchAddinDialogFromTellMe",29));fa.Bq(aa)}Pee(){const Y=[];this.qb.g1c&&Array.add(Y,"Addin");return Y}}Object(K.a)(J,"AddinStoreResultsProvider",null,[909]);var F=d(1011),L=d(344),M=d(392),Q=d(1012),C=d(1044),O=d(1013),U=d(455),T=d(27),ca=d(36),N=d(103);d.d(S,"a",function(){return da});class da{constructor(Y,
fa,aa){this.jQa=this.eZb=this.fZb=this.aHc=!1;this.CI=null;this.DS=-1;this.TBa=this.EZb=this.vQa=this.J6a=null;this.Onf=this.Qnf=0;this.qb=Y;const ka=w.a.P9();this.tOa=fa||[];this.ji=T.AFrameworkApplication.Je;this.avf=Y.fPe;this.gZb=Y.ePe;this.ZGc=ka&&this.Xlb();this.$Gc=ka&&this.Ylb();this.cvf=ka&&this.Zlb();this.cHc=this.aPb();this.OPd=this.$Ob();if((fa=Y.k6e&&w.a.R2e(Y))||Y.Z3)this.J6a=new C.a(Y),this.aHc=Y.Zvc;fa&&(this.fZb=Y.awc,this.eZb=Y.xWa,this.jQa=this.aHc&&this.Ls("File")||this.fZb&&this.Ls("People")||
this.eZb&&this.Ls("Notes"));this.YGc=this.tyl();this.hZb=Y.boc;this.bHc=this.Iyl();this.NPd=this.syl();this.Mrb=this.Tud();this.CAa=this.jyj();this.udf=new F.a(Y);this.Q1h=new Q.a(Y);this.Qai=new O.a(Y);this.zWh=new J(Y);this.wYb=aa;this.p6a=new r.a;this.hZb&&(this.udf=new F.a(Y));Y.Z3&&(this.NPd=this.bHc=this.hZb=this.jQa=this.eZb=this.fZb=this.OPd=this.cHc=this.cvf=this.$Gc=this.ZGc=this.gZb=!1,T.AFrameworkApplication.fa&&this.Ls("File")&&this.UDh()||this.Mrb)&&(Y=this.p6a.tfe("Search",T.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")),
this.s6b(Y,"TellMeService",!0),Y=this.p6a.tfe("SmartLookup",T.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")),this.s6b(Y,"Shredder",!1));T.AFrameworkApplication.fa&&this.jQa&&this.Ls("File")&&this.UDh()&&(Y=this.p6a.tfe("Search",T.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")),this.s6b(Y,"TellMeService",!0))}Ls(Y){return Array.contains(this.tOa,Y)?!0:!1}pE(){return"TellMeService"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:this.Ls("Command")||this.Ls("Recommended")?
2:3}gyj(Y){let fa="";if(!Y&&this.Ls("Command")&&this.qb.Ype){fa+="CommandSearch_DLIS,";var aa=this.qb.CKh;0<aa.length&&(fa+=aa+",")}Y&&this.Ls("Recommended")&&this.gZb&&(aa=this.YAj(),0<aa.length&&(fa+=aa+","));!Y&&this.Ls("Help")&&(Y=this.qb.BKh,0<Y.length&&(fa+=Y+","));this.qb.Z3&&this.TBa&&0<this.TBa.length&&(fa+="IsRecallEnabled_true,");(this.qb.Pwb||this.qb.WRc||this.qb.Z3)&&this.jQa&&(fa+="IsGenerateSlidesEnabled_true,");0<fa.length&&(fa=fa.substr(0,fa.length-1));return fa}s6b(Y,fa,aa){const ka=
aa?this.Qnf:this.Onf;if(!ka||window.performance.now()-ka>=w.a.Yxd)if(Y)aa?this.Qnf=window.performance.now():this.Onf=window.performance.now(),Y.then(H=>{aa?this.EZb=H:(this.TBa=H,D.TellMeActor.instance.y4e=H)},H=>{D.TellMeActor.instance.Kd.onError("TellMeServiceProvider:FetchTokenForService_"+fa,"tellMeServiceToken promise rejected: "+H)});else if(D.TellMeActor.instance.Kd)D.TellMeActor.instance.Kd.onError("TellMeServiceProvider:FetchTokenForService_"+fa,"undefined token promise")}IB(Y,fa,aa,ka=e.a.tellMe,
H=null){const ra=new B.a(Y);aa=w.a.aG(Y);this.Ls("File")&&(this.jQa||this.qb.Z3)&&this.s6b(this.p6a.kyj(),"TellMeService",!0);(this.Ls("File")&&this.qb.Z3||this.Ls("ActionAI")&&this.Mrb)&&this.s6b(this.p6a.Mvj(),"Shredder",!1);var ha=this.jQa&&!!this.EZb;const Ma=this.qb.Z3&&!!this.TBa;var Ga=ha||Ma||aa&&this.Ls("Recommended")&&this.gZb;ha=ha||Ma||!aa&&(this.avf&&this.Ls("Command")||this.ZGc&&this.Ls("Answer")||this.$Gc&&this.Ls("Definition")||this.OPd&&this.Ls("Image")||this.hZb&&this.Ls("Help")||
this.cHc&&this.Ls("WolframAnswer")||this.bHc&&this.Ls("Template")||this.NPd&&this.Ls("Addin"));if(Ga||ha)if(this.vQa=ka,ka={"Content-Type":"application/json",Accept:"application/json"},ka["X-Office-Version"]=T.AFrameworkApplication.buildVersion,ka["X-Office-Application"]=T.AFrameworkApplication.fa.Ha("Application"),ka["X-Office-Platform"]="WAC",ka["X-TellMe-SqmUserId"]=T.AFrameworkApplication.fa.Ha("LoggableUserId")||"",ka["X-TellMe-SessionId"]=D.TellMeActor.instance.uYc(),this.EZb&&(ka.Authorization=
"Bearer "+this.EZb),this.TBa&&0<this.TBa.length&&(ka["X-TellMe-ShredderToken"]="Bearer "+this.TBa),Ga=this.gyj(aa),0<Ga.length&&(ka["X-TellMe-Flights"]=Ga),Ga=[],!aa&&this.Ls("Answer")&&this.ZGc&&(H?Array.contains(H,9):1)&&Array.add(Ga,"Answer"),!aa&&this.Ls("Command")&&this.avf&&!L.CommandResultsUtility.goe(Y.Ef)&&(H?Array.contains(H,17):1)&&Array.add(Ga,"Command"),!aa&&this.Ls("Definition")&&this.$Gc&&(H?Array.contains(H,10):1)&&Array.add(Ga,"Definition"),!aa&&this.Ls("Help")&&this.hZb&&(H?Array.contains(H,
8):1)&&Array.add(Ga,"Help"),!aa&&this.Ls("WolframAnswer")&&this.cHc&&(H?Array.contains(H,12):1)&&Array.add(Ga,"WolframAnswer"),aa&&this.Ls("Recommended")&&this.gZb&&!D.TellMeActor.instance.Sxc&&(H?Array.contains(H,18):1)&&Array.add(Ga,"Recommended"),!aa&&this.Ls("Image")&&this.OPd&&(H?Array.contains(H,19):1)&&Array.add(Ga,"Image"),this.EZb&&this.jQa&&(H?Array.contains(H,14)||Array.contains(H,15)||Array.contains(H,20):1)&&(this.J6a.V1(),this.aHc&&this.Ls("File")&&Array.add(Ga,"File"),this.fZb&&this.Ls("People")&&
Array.add(Ga,"People"),this.eZb&&this.Ls("Notes")&&Array.add(Ga,"Notes")),this.TBa&&0<this.TBa.length&&this.qb.Z3&&(H?Array.contains(H,15):1)&&(this.J6a.V1(),this.Ls("File")&&Array.add(Ga,"File")),!aa&&this.Ls("Template")&&this.bHc&&(H?Array.contains(H,23):1)&&Array.add(Ga,"Template"),!aa&&this.Ls("Addin")&&this.NPd&&(H?Array.contains(H,27):1)&&Array.add(Ga,"Addin"),!aa&&this.Ls("ActionAI")&&this.Mrb&&(H?Array.contains(H,25):1)&&Array.add(Ga,"ActionAI"),Ga.length){ka["X-TellMe-SuggestionTypes"]=Ga.join(",");
ka["X-TellMe-Culture"]=T.AFrameworkApplication.uiCulture;ka["X-TellMe-ProcessSessionId"]=T.AFrameworkApplication.userSessionId;var na=this.CI=N.a.create().toString();ka["Client-Request-Id"]=na;var wa=window.performance.now();this.Ija();this.DS=window.setTimeout(()=>{if(na===this.CI){this.CI="";this.DS=-1;fa.resultsUpdated(ra);const Fa={};Fa[m.a.provider]=this.pE();Fa[m.a.Ejb]=Y.j0a;D.TellMeActor.instance.Kd.TH(n.a.timedOut,this.wYb,Fa)}},this.wYb);this.ji.qj(this.CAa,2,this.iyj(Y.Ef),ka,!1,0,Fa=>
{this.Hib(Fa,Y,fa,na,wa,H)},Fa=>{this.uib(Fa,Y,fa,na,wa)},null,null,!1,4E3,this.Mrb?3E4:6E3)}else D.TellMeActor.instance.Kd.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),fa.resultsUpdated(ra);else fa.resultsUpdated(ra)}Ija(){-1!==this.DS&&(window.clearTimeout(this.DS),this.DS=-1)}Hib(Y,fa,aa,ka,H,ra){const ha=new B.a(fa);if(ka===this.CI){this.Ija();D.TellMeActor.instance.Kd.o6(fa.Ef.length,this.tOa.join(","),Y.data.Oe.toString(),Math.round(window.performance.now()-
H),U.a.tellMe,!0,z.a.vua);ka=Y.data.Wd;Y=null;try{Y=ca.b(ka)}catch(pa){D.TellMeActor.instance.Kd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+pa);return}ka=w.a.aG(fa);if("Groups"in Y&&Y.Groups){var Ma=Y.Groups;for(var Ga of Ma)if("GroupType"in Ga&&"Suggestions"in Ga&&Ga.Suggestions)if("Commands"===Ga.GroupType&&(ra?Array.contains(ra,17):1)||"Recommended"===Ga.GroupType&&(ra?Array.contains(ra,18):1)){var na=(Ma="Recommended"===Ga.GroupType)?"DLIS":"NaiveBayes";"Source"in
Ga&&Ga.Source&&(na=Ga.Source);var wa=Ga.Suggestions;new h.a;var Fa=[];for(const pa of wa)this.B9j(pa)&&(wa=pa.Type,("Command"===wa||Ma&&"Recommended"===wa)&&Fa.push(new M.a(pa.CommandId,pa.Score)));L.CommandResultsUtility.Y5c(Fa,!fa.Ef.trim().length,Ga.GroupType,na);na=D.TellMeActor.instance.LS;wa=[];for(const pa of Fa)Ma&&na&&na.J0d(pa.commandId)||wa.push(pa);Fa=L.CommandResultsUtility.H8b(fa,wa,this.qb,null,null,null,Ma?18:17,0);0<Fa.results.length&&(this.vQa!==e.a.contextMenu&&(Fa.displayName=
Ma?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ha.Bq(Fa))}else if("Answer"===Ga.GroupType){wa=Ga.Suggestions;Ma=null;Fa=2147483647;na="";for(const pa of wa)if(this.y9j(pa))if(na=pa.Type,wa=this.Uyb(na),"Answer"===na&&this.ZGc){Ma=this.URf(na,pa,fa.Ef);break}else wa&&wa<Fa&&(Fa=wa,Ma=this.URf(na,pa,fa.Ef));Fa=w.a.hhl(fa.Ef,na);Ma&&(ra?Array.contains(ra,Ma.type):1)&&(na=[],this.YGc?this.qb.cea?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma.value,
Ma.hK)),D.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ma.value,Ma.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ma.value,Fa))):(na.push(appChrome.actions.setControlLabel(Ma.value,Ma.hK)),na.push(appChrome.actions.updateCompoundButtonDescription(Ma.value,Ma.description)),na.push(appChrome.actions.setCompoundButtonCommandValueId(Ma.value,Fa)),appChrome.api.dispatch(na)):this.qb.cea?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ma.value,
Ma.hK+" - "+Ma.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ma.value,Fa))):(na.push(appChrome.actions.setControlLabel(Ma.value,Ma.hK+" - "+Ma.description)),na.push(appChrome.actions.setButtonCommandValueId(Ma.value,Fa)),appChrome.api.dispatch(na)),Fa=this.HRi(Ma.type),Fa.ys(Ma),ha.Bq(Fa))}else"Help"===Ga.GroupType&&Ga.Suggestions.length&&(ra?Array.contains(ra,8):1)?this.hZb&&(Ma=this.udf.NUa(fa,Ga.Suggestions))&&0<Ma.results.length&&ha.Bq(Ma):"Template"===
Ga.GroupType&&(ra?Array.contains(ra,23):1)?(Ma=Ga.Suggestions)&&0<Ma.length&&this.Qai.NUa(fa,ha,Ma):"Addin"===Ga.GroupType&&(ra?Array.contains(ra,27):1)?(Ma=Ga.Suggestions)&&0<Ma.length&&this.zWh.NUa(fa,ha,Ma):"ActionAI"===Ga.GroupType&&(ra?Array.contains(ra,25):1)?(Fa=Ga.Suggestions,Ma=[],new x.a(25),Fa&&1===Fa.length&&(na=Fa[0])&&na.CommandId&&(Fa=na.CommandId,Ma.push(new M.a(Fa,"Score"in na?na.Score:0)),Ma=L.CommandResultsUtility.H8b(fa,Ma,this.qb,null,null,null,25,0),Ma.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,
ha.Bq(Ma))):"Substrate"===Ga.GroupType&&this.jQa&&"Type"in Ga?"File"===Ga.Type&&this.aHc&&(ra?Array.contains(ra,15):1)?(Ma=this.J6a.lbe(Ga.Suggestions,ka,this.vQa))&&0<Ma.results.length&&(this.r2c()&&(Fa=new t.a("GenerateSlidesFromTellMe",30,"",null,1),Ma.ys(Fa)),ha.Bq(Ma)):"People"===Ga.Type&&this.fZb&&(ra?Array.contains(ra,14):1)?(Ma=this.J6a.mbg(Ga.Suggestions,ka,this.vQa))&&0<Ma.results.length&&ha.Bq(Ma):"Notes"===Ga.Type&&this.eZb&&(ra?Array.contains(ra,14):1)&&(Ma=this.J6a.Iag(Ga.Suggestions,
ka,fa))&&0<Ma.results.length&&ha.Bq(Ma):"Recall"===Ga.GroupType&&this.qb.Z3&&"Type"in Ga&&"IntentService"===Ga.Type&&(ra?Array.contains(ra,15):1)&&(Ma=this.J6a.lbe(Ga.Suggestions,ka,this.vQa))&&0<Ma.results.length&&(this.r2c()&&(Fa=new t.a("GenerateSlidesFromTellMe",30,"",null,1),Ma.ys(Fa)),ha.Bq(Ma));else D.TellMeActor.instance.Kd.onError("OnSuccessCallBack","GroupType"in Ga?"Invalid group suggestions found for "+Ga.GroupType:"Invalid group found")}if(Y.Intents){Ga=Y.Intents;for(const pa of Ga)this.$re(pa)&&
("Image"===pa.GroupType&&pa.ConfidenceScore>pa.ConfidenceThreshold&&(ra?Array.contains(ra,19):1)?this.Q1h.NUa(fa,ha,0,pa):"Commands"===pa.GroupType&&pa.ConfidenceScore<pa.ConfidenceThreshold&&(ra?Array.contains(ra,17):1)&&(Ga=new x.a(17),ha.Bq(Ga)))}aa.resultsUpdated(ha);D.TellMeActor.instance.Kd.o6(fa.Ef.length,this.tOa.join(","),"",Math.round(window.performance.now()-H),"",!0,z.a.provider)}}uib(Y,fa,aa,ka,H){const ra=new B.a(fa);ka===this.CI&&(this.Ija(),D.TellMeActor.instance.Kd.o6(fa.Ef.length,
this.tOa.join(","),Y.data.Oe.toString(),Math.round(window.performance.now()-H),U.a.tellMe,!1,z.a.vua));aa.resultsUpdated(ra)}Uyb(Y){switch(Y){case "Entity":return this.cvf?3:0;case "Definition":return this.$Gc?5:0;case "WolframAnswer":return this.cHc?2:0;default:return 0}}URf(Y,fa,aa){switch(Y){case "Answer":return new t.a(this.YGc?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===fa.Title?aa:fa.Title,fa.Description,0);case "Entity":return new t.a(this.YGc?"AnswerForSearch":"AnswerForSearchSingleLine",
2,""===fa.Title?aa:fa.Title,fa.Description,0);case "Definition":return new t.a(this.YGc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===fa.Title?aa:fa.Title,fa.Description,0);case "WolframAnswer":return new t.a("WolframForSearch",3,""===fa.Title?aa:fa.Title,fa.Description,0);default:return null}}HRi(Y){switch(Y){case 0:return new x.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new x.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new x.a(10,CommonUIStrings.l_TellMeDefinitionTitle);
case 3:return new x.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new x.a(19,this.qb.VOb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}y9j(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}B9j(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&""!==Y.CommandId&&"Score"in Y&&!!Y.Score}$re(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in
Y)return!0;D.TellMeActor.instance.Kd.onError("IsValidIntentGroup","Invalid intents found");return!1}iyj(Y){const fa=w.a.kug(Y),aa={};aa.Query=Y;fa&&this.gZb&&(this.T2j()?aa.UserActionEvents=D.TellMeActor.instance.gxf:(aa.CommandClickedEvents=D.TellMeActor.instance.RDd,aa.CommandActionEvents=D.TellMeActor.instance.cff),aa.TellMeCommandClickMruEvents=D.TellMeActor.instance.Bpf,aa.ContentType=D.TellMeActor.instance.SPc);this.bHc&&(Y={},Y.Application=this.qb.application,aa.TemplateInfo=Y);return ca.c(aa)}Xlb(){return!!this.qb&&
this.qb.Xlb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.mb.Xlb}Ylb(){return!!this.qb&&this.qb.Ylb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.mb.Ylb}Zlb(){return!!this.qb&&this.qb.Zlb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.mb.Zlb}aPb(){return!!this.qb&&this.qb.aPb||!!T.AFrameworkApplication.Aa&&T.AFrameworkApplication.Aa.mb.aPb}$Ob(){return!!this.qb&&(this.qb.$Ob||this.qb.gI)}tyl(){return!!this.qb&&!this.qb.wWa}Iyl(){return!!this.qb&&this.qb.adc}syl(){return!!this.qb&&
this.qb.ZVj&&this.qb.WVj}Tud(){return!!this.qb&&this.qb.Tud}Lug(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Mug(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}T2j(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",
!1)}r2c(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}UDh(){return!!T.AFrameworkApplication.fa&&T.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}YAj(){return T.AFrameworkApplication.fa?T.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}jyj(){if(!T.AFrameworkApplication.fa)return"";
if(this.Mug())return T.AFrameworkApplication.fa.Ha("TellMeServiceProdEndpointForSearch");if(this.Lug())return T.AFrameworkApplication.fa.Ha("TellMeServiceEdogEndpointForSearch");if(w.a.Aoe())return T.AFrameworkApplication.fa.Ha("TellMeServiceIntEndpointForSearch");let Y=T.AFrameworkApplication.fa.Ha("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=T.AFrameworkApplication.AKh);return Y}static pSf(Y,fa){if(fa)return new da(Y,["Command","Recommended"],Y.okj);fa=w.a.P9()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):
"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new da(Y,fa,Y.ndg)}}Object(K.a)(da,"TellMeServiceProvider",null,[909])},108:function(K,S,d){K=d(0);var h=d(16);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(K.a)(e,"InsertMentionParameters",null,[]);class r{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(K.a)(r,"InsightsParameters",null,[]);var m=d(1007),n=d(1008),z=d(1009),t=d(1010),x=d(27),B=d(342),D=
d(452),w=d(36),J=d(56),F=d(47),L=d(126);d.d(S,"a",function(){return M});class M{static get tUj(){return"Insights_16x16x32"}static get Z7i(){return"Find_16x16x32"}static get Ngh(){return"-Parameterized"}static get F4e(){return"Parameterized"}static get Iyd(){return"bTryQuery"}static get P9e(){return"TellMeSuggestion_"}static get GNh(){return"bTryQueryAlternate"}static get s7e(){return"MenuTellMe"}static get vSk(){const Q={},C=[];Array.add(C,{Term:{PeopleType:"Person"}});Q.And=C;return Q}static bTi(Q){return Q+
M.Ngh}static getParameter(Q){let C="",O="";if(Q)for(let U=0;U<Q.x1f;++U)"Type"===Q.gbe(U)?C=Q.eb(U):"Value"===Q.gbe(U)&&(O=Q.eb(U));return new h.a(C,O)}static F2d(Q){Q=Object.assign(new r,{neighborhood:Q,mentionStart:0,mentionLength:Q.length});return w.c(Q)}static $Rf(Q,C,O){Q=Object.assign(new e,{displayName:Q,email:C,userId:O});return w.c(Q)}static ADa(Q,C,O=null){return w.c(M.rdg(Q,C,O,null))}static rdg(Q,C,O=null,U=null){Q=Object.assign(new D.a,{neighborhood:Q,mentionStart:0,mentionLength:Q?Q.length:
0});return Object.assign(new B.a,{selection:Q,userIntent:U,entryPoint:C,launchData:O})}static hhl(Q,C){return M.ADa(Q,M.tuh(C))}static tuh(Q){switch(Q){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static r0j(){return!!x.AFrameworkApplication.fa&&x.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static iCb(){const Q=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"):
null;return!!Q&&0<Q.length}static isEnterpriseUser(){const Q=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ha("HostAuthType"):null;return!!Q&&"aad"===Q.toLowerCase()||"external"===Q&&M.Aoe()}static S2e(Q){return Q.DJl&&!M.iCb()}static x6j(){const Q=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.Ha("UiHostIntegrationType"):"";return!!x.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===Q&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static R2e(Q){return Q.Sza&&Q.T6i&&(Q.awc||Q.Zvc||Q.xWa)&&!M.x6j()&&M.isEnterpriseUser()&&!M.iCb()}static P9(){return x.AFrameworkApplication.fa?x.AFrameworkApplication.vza||x.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):x.AFrameworkApplication.vza}static aG(Q){return!Q||M.kug(Q.Ef)}static kug(Q){return!Q||!Q.trim().length}static qyd(Q){if(!Q)return 0;const C=Math.pow(10,5);return Math.round(Q*C)/C}static oLl(){var Q=new Date;return Q?new Date(Q.getUTCFullYear(),Q.getUTCMonth(),
Q.getUTCDate(),Q.getUTCHours(),Q.getUTCMinutes(),Q.getUTCSeconds(),Q.getUTCMilliseconds()):null}static qfe(Q){return(M.oLl().getTime()-(new Date(Q)).getTime())/1E3}static Iug(Q){const {InsightsMenuItemFactory:C}=d(1006);switch(Q){case m.a.Khe:case n.a.W2f:case C.Tmg:case z.a.k8g:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return Q.startsWith(M.Iyd)||
Q.startsWith(M.P9e)||Q.startsWith(M.GNh)||Q.startsWith("PeopleSuggestion")||Q.startsWith("FileSuggestion")||Q.startsWith("FindInDocumentSuggestion")||Q.startsWith("NotesSuggestion")||Q.startsWith("OnenoteNotesSuggestion")||Q.startsWith("SmartLookupFromTellMe")||Q.startsWith("GetHelpFromTellMe")||Q.startsWith("GetHelpWithDescriptionFromTellMe")||Q.startsWith("AddinSuggestion")||Q.startsWith("OfficeScripts")?!0:!1}static Bbe(Q,C){const O=[];Array.add(O,new t.a(400,Q));Array.add(O,new t.a(200,C));Q=
{};Q.parts=O;return JSON.stringify(Q)}static OTa(Q){const C=Q.indexOf("<b0>"),O=Q.lastIndexOf("</b0>"),U=[];Array.add(U,new t.a(400,Q.substring(0,C)));Array.add(U,new t.a(600,Q.substring(C+4,O)));Array.add(U,new t.a(400,Q.substring(O+5,Q.length)));Q={};Q.parts=U;return JSON.stringify(Q)}static Deg(Q){const C=M.qfe(Q);return 60>C?CommonUIStrings.l_TimeSince_SecsAgo:3600>C?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(C/60).toString()):86400>C?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(C/3600).toString()):172800>C?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(Q)).localeFormat("MMMM dd, yyyy"))}static mgj(Q){const C=Array(Q.length);for(let O=0;O<Q.length;O++)C[O]=Q[O].commandId;return C}static Aoe(){if("Dev Box"===x.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse"))return!0;let Q=x.AFrameworkApplication.fa.Ha("UserPrincipalName");Q=L.b(Q)?"":F.a.ug(Q);const C=x.AFrameworkApplication.fa.gu("TellMeIntEnabledForFeatureCrew")?
x.AFrameworkApplication.fa.ty("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(C,Q)&&"inner"===x.AFrameworkApplication.fa.Ha("Microsoft365Ring")}static Vlj(Q){switch(M.kWc(Q)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static uwj(Q){Q=M.kWc(Q);switch(Q){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return Q}}static kWc(Q){switch(Q.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Fx(){return J.a.gU&&!J.a.ik}}M.Yxd=9E5;Object(K.a)(M,"TellMeUtils",null,[])},117:function(K,S,d){d.r(S);K=d(0);var h=d(1254),e=d(1255),r=d(7),m=d(19),n=d(1253),z=d(724),t=d(267);class x{constructor(eb,Rb,pc,Wc,Ic,nd){this.groupType=eb;this.resultType=Rb;this.h6e=pc;this.bbb=Wc;this.i5d=Ic;this.resultIndex=
nd}}Object(K.a)(x,"ClickLoggingInfo",null,[]);const B=eb=>{const Rb=[];for(;eb;)Array.add(Rb,"{ContextId:"+eb.contextId+", IsGraphNodeContext:"+eb.Rk+"}"),eb=eb.RE;Rb.reverse();return"{"+Rb.join(", ")+"}"};class D{constructor(){this.x9=this.sessionId=null}}Object(K.a)(D,"CorrelationRecord",null,[1048]);var w=d(265);class J{constructor(eb,Rb){this.provider=eb;this.Vyd=Rb}}Object(K.a)(J,"ExternalResultProvider",null,[]);class F{constructor(eb,Rb){this.Id=null;this.TimeStamp=0;this.Id=eb;this.TimeStamp=
Rb}}Object(K.a)(F,"MRUControl",null,[]);var L=d(713),M=d(108),Q=d(27),C=d(379);class O{constructor(eb,Rb){this.i5h=10;this.bW=[];this.sia=[];this.Rlf=this.Qlf=!1;this.iXb=this.hXb="";this.jEc=Rb;this.qb=eb}T7b(){!this.Qlf&&this.qb&&(this.hXb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.qb.application,this.bW=this.B6f(),this.Qlf=!0);return this.bW}osj(){!this.Rlf&&this.qb&&(this.iXb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.qb.application,this.sia=this.B6f(!0),this.Rlf=!0);return this.sia}A8j(eb){return eb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===eb||"TryOfficeUpsell"===eb}poe(eb){return this.zWj(eb)||this.A8j(eb)||M.a.Iug(eb)?!1:!0}pei(eb){eb=eb.ControlId;this.poe(eb)&&(eb=this.bXe(eb),this.aal(eb),this.Mxk(),Array.insert(this.bW,0,new F(eb,Date.now())),this.hXb.length&&(eb=JSON.stringify(this.bW),C.a.instance.setItem(this.hXb,eb)))}kz(eb){this.Lxk();Array.insert(this.sia,0,new F(L.a[eb],Date.now()));this.iXb.length&&(eb=JSON.stringify(this.sia),C.a.instance.setItem(this.iXb,eb))}B6f(eb=!1){if(!this.bW.length){var Rb=
eb?C.a.instance.getItem(this.iXb):C.a.instance.getItem(this.hXb);if(!Rb||""===Rb)return eb?this.sia:this.bW;let pc=null;try{pc=JSON.parse(Rb)}catch(Wc){this.PDi(eb),pc=null}if(!pc||!pc.length||10<pc.length)return eb?this.sia:this.bW;Rb=0;for(const Wc of pc)if(eb||this.qb.B4c(Wc.Id)&&this.poe(Wc.Id))if(eb?Array.insert(this.sia,Rb++,Wc):Array.insert(this.bW,Rb++,Wc),Rb===this.jEc)break}return eb?this.sia:this.bW}J0d(eb){eb=this.bXe(eb);for(const Rb of this.bW)if(Rb.Id===eb)return!0;return!1}PDi(eb=
!1){C.a.instance.setItem(eb?this.iXb:this.hXb,"")}PYj(eb){eb=this.bXe(eb.ControlId);return this.poe(eb)?this.J0d(eb):!1}aal(eb){if(0<this.bW.length){let Rb=0;for(const pc of this.bW){if(pc.Id===eb){Array.removeAt(this.bW,Rb);break}Rb++}}}bXe(eb){return"Excel"===this.qb.application&&eb.startsWith("m_excelWebRenderer_ewaCtl_")?eb.substr(26,eb.length):eb}Mxk(){this.bW.length===this.jEc&&Array.removeAt(this.bW,this.bW.length-1)}Lxk(){this.sia.length===this.i5h&&Array.removeAt(this.sia,this.sia.length-
1)}zWj(eb){eb=eb.split("|");let Rb="";if(6<=eb.length)Rb=eb[0];else if(3<=eb.length){if("3"===eb[0])return!0;Rb=eb[1]}return Rb.startsWith("WA")}static createInstance(eb){let Rb=3;Q.AFrameworkApplication.fa&&(Rb=Q.AFrameworkApplication.fa.uc("TellMeMaxRecommendedResultsToReturn",3));return new O(eb,Rb)}}Object(K.a)(O,"MruControlsManager",null,[1047]);class U{constructor(eb){this.U5a=eb}tL(eb,Rb){let pc;return eb.hK&&(pc=this.U5a[eb.value])?pc.tL(eb,Rb):(pc=this.n7f(eb.value))?pc.tL(pc.TAk,Rb):null}Uqj(eb,
Rb){if(eb=this.U5a[eb])for(const pc of Rb)if(Rb=M.a.getParameter(pc),Rb.key===eb.yQk)return Rb.value;return null}iDk(eb){(eb=this.n7f(eb))&&eb.gDk()}n7f(eb){const Rb=eb.indexOf(M.a.Ngh);return 0<Rb?this.U5a[eb.substring(0,Rb)]:null}}Object(K.a)(U,"ParameterizedCommandManager",null,[1046]);var T=d(305);class ca{constructor(eb,Rb){this.Ef=eb;this.j0a=Rb}}Object(K.a)(ca,"TellMeQuery",null,[]);var N=d(710);class da{constructor(eb,Rb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=eb;this.TimeElapsedSinceClick=
Rb}}Object(K.a)(da,"CommandClickedEvent",null,[]);var Y=d(126);class fa{constructor(eb,Rb){this.p6h=eb;this.Bca=Rb}resultsUpdated(eb){this.p6h(Y.b(eb.query)?"":eb.query.Ef,eb.Yk,eb.attributes,this.Bca,eb.LBb)}}Object(K.a)(fa,"ResultsUpdatedCallback",null,[1028]);class aa{constructor(eb,Rb,pc,Wc,Ic){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=eb;this.TimeElapsedSinceClick=pc;this.CommandSurface=Wc;this.CommandId=
Rb;this.TerminalParentControlId=Ic}}Object(K.a)(aa,"UserActionEvent",null,[]);var ka=d(18);class H{constructor(eb,Rb){this.menuModel=eb;this.suh=Rb}}Object(K.a)(H,"GeneratedMenuModel",null,[]);class ra{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(K.a)(ra,"MenuModel",null,[]);class ha{constructor(eb,Rb,pc){this.qb=eb;this.U5a=Rb;this.fCa=pc}ucj(eb,Rb,pc){const {TellMeActor:Wc}=d(117);let Ic=0;const nd=new ra,ob=[];let $b="";
nd.sections=[];let Hc=new ka.a;const Pb=!!this.qb&&this.qb.wWa;var Yc=!!this.qb&&this.qb.UOb||Q.AFrameworkApplication.Aa.mb.UOb;for(const Gb of eb){eb=0;Pb||(Hc=new ka.a);const Bb=new ka.a;let dc=Gb.displayName;for(const Xc of Gb.results){if(0<=Xc.value.indexOf(M.a.F4e)){if(Xc.hK){var Rd=this.U5a[Xc.value];if(Rd&&Xc.value.endsWith(M.a.F4e)){if("FindParameterized"!==Xc.value&&!Yc){const Fb=[];Fb.push(appChrome.actions.setControlLabel(Xc.value,Rd.anj(Xc)));Fb.push(appChrome.actions.setButtonCommandValueId(Xc.value,
Rd.pgj(Xc)));appChrome.api.dispatch(Fb)}Rd=Xc.value.replace(M.a.F4e,"");Hc.remove(Rd)?eb--:Bb.add(Rd);Hc.add(Xc.value);eb++}}}else switch(Xc.type){case 5:Bb.contains(Xc.value)||(Hc.add(Xc.value),eb++);break;case 7:Hc.add(Xc.hK);eb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Hc.add(Xc.value),eb++}13===Gb.groupType&&(dc=M.a.P9()?0<Rb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Rb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Rb));21===Gb.groupType&&(dc=CommonUIStrings.l_LearningUILiveText)}Ic+=eb;""!==dc&&0<eb&&($b+=" , "+eb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+dc+" , ");0<Hc.count&&!Pb&&(eb=appChrome.api.menuSection(Hc.toArray(),Gb.displayName,null,T.a[Gb.groupType]),ob.push(eb))}Yc=null;0<Ic&&(Yc=0<Rb.length?1!==Ic?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
Ic,Rb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Rb):1!==Ic?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Ic):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Pb?(Rb=appChrome.api.menuSection(Hc.toArray(),"",null,null),ob.push(Rb)):Yc+=$b);pc&&(this.qb.cea?Wc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Yc)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Yc)));nd.sections=
ob;return new H(nd,Ic,[])}static get k6d(){return ha.qhf||(ha.qhf=new H(Object.assign(new ra,{sections:[]}),0,[]))}}ha.qhf=null;Object(K.a)(ha,"TellMeMenuDefintionGenerator",null,[]);var Ma;(function(eb){eb[eb.TellMeControlActivated=0]="TellMeControlActivated";eb[eb.TellMeQueryExecuted=1]="TellMeQueryExecuted";eb[eb.TellMeResultsRendered=2]="TellMeResultsRendered";eb[eb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Ma||(Ma={}));Object(K.b)("PerformanceMarker",Ma);var Ga;(function(eb){eb[eb.TellMeTimeToRender=
0]="TellMeTimeToRender";eb[eb.TellMeSessionLength=1]="TellMeSessionLength";eb[eb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Ga||(Ga={}));Object(K.b)("PerformanceMeasure",Ga);class na{mark(eb){window.performance.mark(Ma[eb])}measure(eb,Rb,pc){const {TellMeActor:Wc}=d(117);try{window.performance.measure(Ga[eb],Ma[Rb],Ma[pc])}catch(Ic){Wc.instance.Kd.onError("TellMePerformance:Measure","error measuring "+Ga[eb])}}Ste(eb,Rb,pc){const {TellMeActor:Wc}=d(117);Wc.instance.Kd.Zte(Rb,pc,eb,this.soj(eb))}NRa(eb){for(const Rb of eb)window.performance.clearMarks(Ma[Rb])}clearMeasures(eb){for(const Rb of eb)window.performance.clearMeasures(Ga[Rb])}soj(eb){let Rb=
0;(eb=this.odj(eb))&&0<eb.length&&(Rb=eb[eb.length-1].duration);return Rb}odj(eb){return window.performance.getEntriesByName(Ga[eb],"measure")}}Object(K.a)(na,"TellMePerformance",null,[]);var wa=d(456),Fa=d(455),pa=d(36);class Ea{constructor(eb){this.Oai=eb}NOe(eb,Rb,pc){const {TellMeActor:Wc}=d(117);Wc.instance.Kd.o6(Rb,Fa.a.iLb,eb.data.Oe.toString(),Math.round(window.performance.now()-pc),Fa.a.iLb,!0,wa.a.vua);eb=pa.b(eb.data.Wd);Rb=-1;eb.Index&&(Rb=eb.Index);Wc.instance.Kd.wgk(Rb,this.Oai)}inc(eb,
Rb,pc){const {TellMeActor:Wc}=d(117);Wc.instance.Kd.o6(Rb,Fa.a.iLb,eb.data.Oe.toString(),Math.round(window.performance.now()-pc),Fa.a.iLb,!1,wa.a.vua)}rsj(eb){if(eb&&""!==eb.trim()){const pc=window.performance.now(),Wc=Q.AFrameworkApplication.xKh;var Rb={};Rb.Text=eb;Rb.IsFileHash="false";Rb=pa.c(Rb);Q.AFrameworkApplication.Je.qj(Wc,2,Rb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Ic=>{this.NOe(Ic,eb.length,pc)},Ic=>{this.inc(Ic,eb.length,pc)},null,null,!1,4E3,6E3)}}}Object(K.a)(Ea,
"TellMeQueryIndexCallback",null,[]);var ta=d(145);class ia{constructor(eb,Rb,pc){this.xml=eb;this.suh=Rb;this.zYi=pc}}Object(K.a)(ia,"GeneratedMenuXml",null,[]);var Ja=d(1007),ab=d(47);class Oa{constructor(eb,Rb){this.gAc=eb||{};this.vBa=Rb}get Gkb(){return 5}tL(eb,Rb=null){return this.vBa.tL(eb,Rb)||this.pui(eb.value)}pui(eb){return Oa.oui(eb,this.gAc[eb]||null)}static oui(eb,Rb=null){eb=String.format('<ClonedControl Id="{0}" ',eb);for(let Ic in Rb){var pc=Ic,Wc=Rb[Ic];Wc=Wc?ab.a.ze(Wc.toString()):
"";eb+=String.format('{0}="{1}" ',pc,Wc)}return eb+"/>"}}Object(K.a)(Oa,"CommandMenuItemFactory",null,[988]);var Za=d(131);class Na{constructor(){this.p0h=CommonUIStrings.l_FindInDocumentText}get Gkb(){return 8}tL(eb){var Rb=eb.hK;eb=ab.a.ze(eb.value);const pc=ab.a.ze(Rb);Rb=ab.a.ze(String.format(this.p0h,Rb));return this.Kbj(eb,pc,Rb)}Kbj(eb,Rb,pc){return Za.a(eb,"1540292897",pc,M.a.Z7i,null,Rb,pc,null,null)}}Object(K.a)(Na,"FindInDocumentMenuItemFactory",null,[988]);var sa=d(1008),Sa=d(1006),xb=
d(1009);class gc{get Gkb(){return 7}tL(eb){const Rb=Object(n.a)(N.a,eb);return this.Acj(ab.a.ze(eb.value),Rb.id)}Acj(eb,Rb){return Za.a(Rb,"1404166600",eb,null,null,eb,eb,null,null)}}Object(K.a)(gc,"TryQueryMenuItemFactory",null,[988]);class zc{constructor(eb){this.Gqa=[];this.qb=eb}mkj(eb){for(const Rb of this.Gqa)if(Rb.Gkb===eb)return Rb;return null}B0a(eb){this.Gqa.push(eb)}s7k(eb){this.B0a(new Oa(this.qb.PKi,eb));this.B0a(new xb.a(this.qb.uCk));this.B0a(new Ja.a(this.qb.Hkl,this.qb.Gkl,this.qb.OJl,
this.qb.fMj,this.qb.qxl));this.B0a(new Sa.InsightsMenuItemFactory);this.B0a(new Na);this.B0a(new sa.a);this.B0a(new gc)}}Object(K.a)(zc,"MenuItemFactoryRegistry",null,[]);var Xb=d(160);class jb{constructor(eb,Rb){this.qb=eb;this.gpf=new zc(this.qb);this.gpf.s7k(Rb)}vcj(eb,Rb){let pc=0;const Wc=[],Ic=[];for(const ob of eb){eb=M.a.s7e;var nd=[];for(const $b of ob.results){const Hc=this.gpf.mkj($b.type).tL($b,Rb);eb=M.a.s7e;nd.push(Hc);if(13===$b.type||14===$b.type)eb="Menu32";17===$b.type&&(eb="MenuTellMeExtended");
$b.groupType=ob.groupType;Ic.push(Object(n.a)(Xb.a,$b))}pc=pc?pc:nd.length;nd=Za.c("TellMeDropdownControls",nd);eb=Za.e("TellMeDropdownMenuSection",nd,eb,ob.displayName);Wc.push(eb)}Rb=Za.f(Wc,"LookupDropdownMenu");return new ia(Rb,pc,Ic)}static get QRc(){return jb.rhf||(jb.rhf=new ia(Za.f([],"LookupDropdownMenu"),0,[]))}}jb.rhf=null;Object(K.a)(jb,"TellMeXmlGenerator",null,[]);class zb{}zb.pBk="MRU";zb.test="Test";Object(K.a)(zb,"ActionType",null,[]);var Tb=d(391),Ya=d(1016),sb=d(106);class oc{constructor(eb,
Rb,pc,Wc,Ic=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=eb;this.IsEnabled=Rb;this.ResultType=L.a[pc];this.SubResultType=Ya.a[Wc];this.OptionalData=Ic?sb.a.toJSON(Ic):null}}Object(K.a)(oc,"ResultInfo",null,[]);var wb=d(175),rc=d(146),Ka=d(184);class Db{constructor(eb,Rb=null){this.Mkf="TellMeWAC.";this.U6h=eb;this.rbi=Rb}npa(eb,Rb,pc){Rb=wb.a.VI(Rb);eb=wb.a.T2d(eb,this.U6h,this.rbi,pc,Rb);rc.a.npa(eb,this.Mkf)}DLa(eb,Rb,pc=0){Rb=
wb.a.VI(Rb);rc.a.DLa(Object.assign(new Ka.a,{name:eb,dataFields:Rb,durationMs:pc}),this.Mkf)}}Object(K.a)(Db,"TellMeOtelLogger",null,[1081]);var bc=d(103);class Mc{constructor(eb,Rb,pc,Wc,Ic,nd,ob){this.cW=this.e_=this.gff=null;this.s7=eb;this.ETb=Rb;this.lra=pc;this.YOa=Wc;this.iBa=Ic;this.K3h=nd;this.cW=ob?ob:new Db(this.YOa?t.CuiHelper.E4e:t.CuiHelper.B7e)}get Qp(){return this.YOa}get Noa(){return this.lra}Ptd(eb){this.gff=eb;switch(eb){case ta.a.contextMenu:this.e_=ta.a.contextMenu;break;default:this.e_=
ta.a.tellMe}}isi(eb,Rb){this.lra.x9||(this.lra.x9=bc.a.create().toString(),this.byg(eb,!0,Rb))}PYf(eb,Rb=!0){this.lra.x9&&this.Vek(eb,Rb);this.YOa&&appChrome.api.updateTellMeCorrelationId("");this.lra.x9=null}byg(eb,Rb,pc){const {TellMeActor:Wc}=d(117),Ic=this.NW(w.a.FAb);Ic[Tb.a.culture]=this.ETb;Ic[Tb.a.appName]=this.s7;Ic[Tb.a.context]=eb;Ic[Tb.a.N3c]=this.iBa;Ic[Tb.a.x8j]=this.K3h;Ic[Tb.a.c7j]=pc;Ic[Tb.a.p1j]=Rb;Ic[Tb.a.contentType]=Wc.instance.SPc;this.cW.npa(w.a.FAb,Ic,this.gff);this.YOa&&appChrome.api.updateTellMeCorrelationId(this.lra.x9)}Vek(eb,
Rb){const pc=this.NW(w.a.$mg);pc[Tb.a.v_i]=eb;pc[Tb.a.o1j]=Rb;this.cW.DLa(w.a.$mg,pc)}vgk(eb,Rb,pc){let Wc=0;!pc&&0<eb.length&&(Wc=eb.trim().split(" ").length);const Ic=this.NW(w.a.query);Ic[Tb.a.query]="!";Ic[Tb.a.Ejb]=Rb;Ic[Tb.a.Qlh]=eb.length;Ic[Tb.a.Evg]=pc;Ic[Tb.a.e_l]=Wc;this.cW.npa(w.a.query,Ic,this.e_)}Qfk(eb,Rb,pc,Wc,Ic,nd,ob,$b=null){const Hc=this.NW(w.a.latency);Hc[Tb.a.culture]=this.ETb;Hc[Tb.a.Qlh]=eb;Hc[Tb.a.oOh]=Rb;Hc[Tb.a.statusCode]=pc;Hc[Tb.a.cnl]=Ic;Hc[Tb.a.isSuccess]=nd;Hc[Tb.a.Eak]=
ob;$b&&(Hc[Tb.a.GLl]=$b);this.cW.DLa(w.a.latency,Hc,Wc)}Zte(eb,Rb,pc,Wc){const Ic=this.NW(w.a.performance);Ic[Tb.a.culture]=this.ETb;Ic[Tb.a.lsi]=Ma[eb];Ic[Tb.a.g1i]=Ma[Rb];Ic[Tb.a.FSk]=Ga[pc];this.cW.DLa(w.a.performance,Ic,Wc)}Fgk(eb,Rb){var {TellMeActor:pc}=d(117);const {CommandResultsUtility:Wc}=d(344);if(eb.results.length){var Ic=this.NW(w.a.wsh);Ic[Tb.a.bbb]=Rb.toString();Ic[Tb.a.groupType]=T.a[eb.groupType];16===eb.groupType&&(Ic[Tb.a.G6j]=pc.instance.Sxc);Rb=[];pc=[];var nd=[];for(const ob of eb.results)Ic[Tb.a.resultType]||
(Ic[Tb.a.resultType]=L.a[ob.type]),eb={},27===ob.type&&(eb.AssetId=ob.bVd),pc.push(Wc.fbc(ob.value)),Rb.push(ob.value),nd.push(new oc(ob.value,Wc.fbc(ob.value),ob.type,ob.subType,eb));0<Rb.length&&(Ic[Tb.a.jhl]="{"+Rb.join(", ")+"}",Ic[Tb.a.H0i]="{"+pc.join(", ")+"}",Ic[Tb.a.fhl]=pa.c(nd));this.cW.npa(w.a.wsh,Ic,this.e_)}}Rcj(eb,Rb){if(4===eb)return zb.pBk;switch(Rb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return L.a[Rb]}Aek(eb,
Rb,pc,Wc,Ic){const nd=this.NW(w.a.click);nd[Tb.a.oOh]=eb;nd[Tb.a.AQk]=Rb;nd[Tb.a.commandId]=pc;nd[Tb.a.fDa]=Wc;nd[Tb.a.actionType]=this.Rcj(Ic.groupType,Ic.resultType);nd[Tb.a.resultType]=L.a[Ic.resultType];nd[Tb.a.h6e]=Ya.a[Ic.h6e];nd[Tb.a.groupType]=T.a[Ic.groupType];nd[Tb.a.bbb]=Ic.bbb.toString();nd[Tb.a.i5d]=Ic.i5d.toString();nd[Tb.a.resultIndex]=Ic.resultIndex.toString();this.cW.npa(w.a.click,nd,this.e_)}Eek(eb,Rb){this.lra.x9||(this.lra.x9=bc.a.create().toString(),this.byg("",!1,Rb));Rb=this.NW(w.a.pPf);
Rb[Tb.a.Ejb]=eb;this.cW.DLa(w.a.pPf,Rb)}kyg(eb,Rb,pc){if(eb){if(pc)for(let Wc in pc)eb[Wc]=pc[Wc];this.cW.DLa(w.a.events,eb,Rb)}}MGa(eb,Rb,pc=null){const Wc=this.NW(w.a.events);Wc[Tb.a.event]=eb;this.kyg(Wc,Math.round(Rb),pc)}Adb(eb,Rb,pc=null){const Wc=this.NW(w.a.events);Wc[Tb.a.event]=w.a.error;Wc[Tb.a.module]=eb;Wc[Tb.a.errorMessage]=Rb;Wc[Tb.a.message]=Rb;this.kyg(Wc,Math.round(window.performance.now()),pc)}yek(eb){const Rb=this.NW(w.a.ENf);Rb[Tb.a.value]=eb;Rb[Tb.a.ppd]=this.YOa;this.cW.npa(w.a.ENf,
Rb,this.e_)}Ydk(eb){const Rb=this.NW(w.a.iyf);Rb[Tb.a.value]=eb;Rb[Tb.a.ppd]=this.YOa;this.cW.npa(w.a.iyf,Rb,this.e_)}ifk(eb){const Rb=this.NW(w.a.M1f);Rb[Tb.a.value]=eb;Rb[Tb.a.ppd]=this.YOa;this.cW.npa(w.a.M1f,Rb,this.e_)}ugk(eb){const Rb=this.NW(w.a.xlh);Rb[Tb.a.value]=eb;Rb[Tb.a.ppd]=this.YOa;this.cW.npa(w.a.xlh,Rb,this.e_)}lek(eb){const Rb=this.NW(w.a.lyh);Rb[Tb.a.value]=eb;this.cW.npa(w.a.lyh,Rb,this.e_)}xgk(eb,Rb){const pc=this.NW(w.a.Olh);pc[Tb.a.iLb]=eb;Rb&&(pc[Tb.a.x9]=Rb);this.cW.DLa(w.a.Olh,
pc)}NW(eb){return{["SessionID"]:this.lra.sessionId,["CorrelationID"]:this.lra.x9,["Time"]:(new Date).getTime(),["Event"]:eb,["Scenario"]:this.e_}}}Object(K.a)(Mc,"UsageLogger",null,[1037]);var mb=d(96);class Wa{}Wa.Callback="action";Object(K.a)(Wa,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var db=d(543),ub=d(302),Lb=d(82),Kb=d(141),uc=d(495),Yb=d(251),Tc=d(56),sc=d(272),Qb=d(73),kb=d(37);d.d(S,"TellMeActor",function(){return Ib});class Ib{constructor(){this.vBa=this.LS=this.Pd=this.Ma=this.G2=
this.JG=this.ae=this.Ca=this.Kd=this.ZD=this.dLd=this.Vxf=this.b8=this.qb=null;this.uqb=!1;this.RDd=[];this.cff=[];this.gxf=[];this.Bpf=[];this.Cpf=[];this.wmf=!1;this.Tob=this.fCa=null;this.WVb=this.iBa=!1;this.vEc=!0;this.hQ=this.vCc=this.jjf=this.oLd=this.vpf=null;this.I2=[];this.iOa=this.kpb=this.Rha=this.TFc=this.gvf=null;this.aqb=!1;this.iLd=0;this.Lob=null;this.Bca=-1;this.hpf=0;this.eWb=!1;this.tOa=null;this.dxf=!1;this.Mob=this.DN=null}get SPc(){return this.G2?this.G2.contentType:Ib.unknown}Zvb(){return this.G2?
[""]:[]}get actions(){return this.I2}set actions(eb){this.I2=eb}uYc(){return this.Kd?this.Kd.Noa.x9:null}lH(){return this.qb}get LAk(){return this.vEc}get WYl(){return this.vpf}performance(){return this.ZD}get y4e(){return this.gvf}set y4e(eb){this.gvf=eb}get Sxc(){return this.dxf}set Sxc(eb){this.dxf=eb}pF(eb){const Rb=window.performance.now();this.fCa&&!Y.b(eb)&&(this.fCa(eb),this.Kd.TH(w.a.pF,window.performance.now()-Rb))}initialize(eb,Rb=null,pc=null,Wc=null,Ic=null,nd=null,ob=null,$b=null,Hc=
null,Pb=null,Yc=null){const {InteractionLogger:Rd}=d(1195),{GroupsPlacementInfo:Gb}=d(1192),{AggregatorResultsProvider:Bb}=d(1033);this.qb=eb;this.iBa=!!Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.mb.cCb;this.Kd=Wc;if(!Wc){Wc=new D;Wc.sessionId=Q.AFrameworkApplication.userSessionId;const dc=sc.a.He(Q.AFrameworkApplication.lcid)||sc.a.Oac;this.Kd=new Rd(new Mc(this.qb.application,dc.name,Wc,this.qb.Qp,this.iBa,eb.Sza,null),this.qb.QKi,this.qb)}this.vBa=new U(this.qb.parameterData);this.Vxf=
pc||new jb(this.qb,this.vBa);this.fCa=ob;this.dLd=this.dLd||new ha(this.qb,this.qb.parameterData,ob);this.Pd=mb.FocusManager.instance();this.LS=O.createInstance(this.qb);this.jjf=new Gb(eb);this.Ca=Ic||Q.AFrameworkApplication.Qa;this.ae=nd||Q.AFrameworkApplication.De;this.JG=Hc;this.b8=Rb;this.DN=Yc;this.ZD=new na;this.Mob=new h.a(e.a.Gk());this.TFc=[];Hc?Hc.execute(dc=>{dc.isFeatureEnabled(Ib.CJl,!0).then(Xc=>{const {AggregatorResultsProvider:Fb}=d(1033);this.eWb=Xc;this.b8=this.b8||Fb.createInstance(this.LS,
this.qb,this.vBa,this.eWb);for(const kd of this.TFc)this.b8.kz(kd.provider,kd.Vyd);this.TFc=[];return null})}):(this.eWb=!0,this.b8=this.b8||Bb.createInstance(this.LS,this.qb,this.vBa,this.eWb));this.Ma=$b;this.Rha=jb.QRc;this.vpf=new Promise(dc=>{this.oLd=dc});Pb&&Pb.execute(dc=>{this.G2=dc})}vb(){this.fhi()}fhi(){this.Ca.ra(kb.a.tellMe,Qb.a.frame,Object(r.a)(this,this.tellMe,"tellMe"),96);this.Ca.ra(kb.a.r7e,Qb.a.frame,Object(r.a)(this,this.YIf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.ra(kb.a.v7e,
Qb.a.frame,Object(r.a)(this,this.wyg,"logItemExecuted"),96);this.Ca.ra(kb.a.y7e,Qb.a.frame,Object(r.a)(this,this.gyg,"logControlDeactivation"),96);this.Ca.ra(kb.a.x7e,Qb.a.frame,Object(r.a)(this,this.syg,"logInputFocus"),96);this.Ca.ra(kb.a.u7e,Qb.a.frame,Object(r.a)(this,this.FAb,"interactionBegin"),96);this.Ca.ra(kb.a.A7e,Qb.a.frame,Object(r.a)(this,this.FAb,"interactionBegin"),96);this.Ca.ra(kb.a.w7e,Qb.a.frame,Object(r.a)(this,this.ryg,"logInputBlur"),96);this.Ca.ra(kb.a.z7e,Qb.a.frame,Object(r.a)(this,
this.fyg,"logControlActivated"),96);this.Ca.ra(kb.a.$vc,Qb.a.frame,Object(r.a)(this,this.L3f,"focusSearchBox"),96);this.Ca.ra(kb.a.q7e,Qb.a.frame,Object(r.a)(this,this.JOf,"constructLiveNotificationForMenu"),96);this.Ca.ra(kb.a.C7e,Qb.a.frame,Object(r.a)(this,this.Yme,"insertTryQuery"),96);this.Ca.ra(kb.a.bte,Qb.a.frame,Object(r.a)(this,this.Yme,"insertTryQuery"),96);this.Ca.ra(kb.a.v8d,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.w8d,Qb.a.frame,Object(r.a)(this,this.Uxa,
"openOrInsertUrl"),96);this.Ca.ra(kb.a.x8d,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.y8d,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.z8d,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.bPe,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.cPe,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.dPe,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);
this.Ca.ra(kb.a.kQe,Qb.a.frame,Object(r.a)(this,this.yac,"insertMention"),96);this.Ca.ra(kb.a.lQe,Qb.a.frame,Object(r.a)(this,this.yac,"insertMention"),96);this.Ca.ra(kb.a.mQe,Qb.a.frame,Object(r.a)(this,this.yac,"insertMention"),96);this.Ca.ra(kb.a.t7e,Qb.a.frame,Object(r.a)(this,this.gfh,"openFeedback"),96);this.Ca.ra(kb.a.D7e,Qb.a.frame,Object(r.a)(this,this.Uxa,"openOrInsertUrl"),96);this.Ca.ra(kb.a.YUd,Qb.a.frame,Object(r.a)(this,this.ICb,"launchAddin"),96);this.Ca.ra(kb.a.ZUd,Qb.a.frame,Object(r.a)(this,
this.ICb,"launchAddin"),96);this.Ca.ra(kb.a.$Ud,Qb.a.frame,Object(r.a)(this,this.ICb,"launchAddin"),96);this.Ca.ra(kb.a.gmb,Qb.a.frame,Object(r.a)(this,this.gmb,"showTellMeCoachmark"),96);this.Ca.ra(kb.a.Use,Qb.a.frame,Object(r.a)(this,this.Iwg,"launchAddinStore"),96);this.Ca.ra(kb.a.RUe,Qb.a.frame,Object(r.a)(this,this.pmh,"quickActionOnFileHandler"),96);this.Ca.ra(kb.a.p$d,Qb.a.frame,Object(r.a)(this,this.q5f,"generateSlidesFromFiles"),96)}S6k(eb){this.vEc=!1;const Rb=window.performance.now();eb.KGa.isCompleted?
(this.vEc=!0,this.oLd(!0)):eb.sW(()=>{this.vEc=!0;this.oLd(!0);this.Kd.TH(w.a.TVi,window.performance.now()-Rb)});this.x7k(eb)}x7k(eb){Yb.a.Gpd(Object(r.a)(this,this.mYi,"dispatcher"));Yb.a.Q5b([new uc.a(kb.a.tellMe,Qb.a.frame,96),new uc.a(kb.a.r7e,Qb.a.frame,96),new uc.a(kb.a.v7e,Qb.a.frame,96),new uc.a(kb.a.y7e,Qb.a.frame,96),new uc.a(kb.a.x7e,Qb.a.frame,96),new uc.a(kb.a.u7e,Qb.a.frame,96),new uc.a(kb.a.A7e,Qb.a.frame,96),new uc.a(kb.a.w7e,Qb.a.frame,96),new uc.a(kb.a.z7e,Qb.a.frame,96),new uc.a(kb.a.$vc,
Qb.a.frame,96),new uc.a(kb.a.q7e,Qb.a.frame,96),new uc.a(kb.a.C7e,Qb.a.frame,96),new uc.a(kb.a.bte,Qb.a.frame,96),new uc.a(kb.a.v8d,Qb.a.frame,96),new uc.a(kb.a.w8d,Qb.a.frame,96),new uc.a(kb.a.x8d,Qb.a.frame,96),new uc.a(kb.a.y8d,Qb.a.frame,96),new uc.a(kb.a.z8d,Qb.a.frame,96),new uc.a(kb.a.bPe,Qb.a.frame,96),new uc.a(kb.a.cPe,Qb.a.frame,96),new uc.a(kb.a.dPe,Qb.a.frame,96),new uc.a(kb.a.kQe,Qb.a.frame,96),new uc.a(kb.a.lQe,Qb.a.frame,96),new uc.a(kb.a.mQe,Qb.a.frame,96),new uc.a(kb.a.t7e,Qb.a.frame,
96),new uc.a(kb.a.D7e,Qb.a.frame,96),new uc.a(kb.a.YUd,Qb.a.frame,96),new uc.a(kb.a.ZUd,Qb.a.frame,96),new uc.a(kb.a.$Ud,Qb.a.frame,96),new uc.a(kb.a.gmb,Qb.a.frame,96),new uc.a(kb.a.Use,Qb.a.frame,96),new uc.a(kb.a.RUe,Qb.a.frame,96),new uc.a(kb.a.p$d,Qb.a.frame,96)],eb)}mYi(eb,Rb,pc,Wc,Ic){if(Rb.contextId===Qb.a.frame)switch(eb){case kb.a.tellMe:return this.tellMe(eb,Rb,pc,Wc,Ic);case kb.a.r7e:return this.YIf(eb,Rb,pc,Wc,Ic);case kb.a.v7e:return this.wyg(eb,Rb,pc,Wc,Ic);case kb.a.y7e:return this.gyg(eb,
Rb,pc,Wc,Ic);case kb.a.x7e:return this.syg(eb,Rb,pc,Wc,Ic);case kb.a.u7e:return this.FAb(eb,Rb,pc,Wc,Ic);case kb.a.A7e:return this.restoreFocus(eb,Rb,pc,Wc,Ic);case kb.a.w7e:return this.ryg(eb,Rb,pc,Wc,Ic);case kb.a.z7e:return this.fyg(eb,Rb,pc,Wc,Ic);case kb.a.$vc:return this.L3f(eb,Rb,pc,Wc,Ic);case kb.a.q7e:return this.JOf(eb,Rb,pc,Wc,Ic);case kb.a.C7e:case kb.a.bte:return this.Yme(eb,Rb,pc,Wc,Ic);case kb.a.v8d:case kb.a.w8d:case kb.a.x8d:case kb.a.y8d:case kb.a.z8d:case kb.a.bPe:case kb.a.cPe:case kb.a.dPe:case kb.a.D7e:return this.Uxa(eb,
Rb,pc,Wc,Ic);case kb.a.kQe:case kb.a.lQe:case kb.a.mQe:return this.yac(eb,Rb,pc,Wc,Ic);case kb.a.t7e:return this.gfh(eb,Rb,pc,Wc,Ic);case kb.a.YUd:case kb.a.ZUd:case kb.a.$Ud:return this.ICb(eb,Rb,pc,Wc,Ic);case kb.a.gmb:return this.gmb(eb,Rb,pc,Wc,Ic);case kb.a.Use:return this.Iwg(eb,Rb,pc,Wc,Ic);case kb.a.RUe:return this.pmh(eb,Rb,pc,Wc,Ic);case kb.a.p$d:return this.q5f(eb,Rb,pc,Wc,Ic)}return 2}L3f(eb,Rb,pc){if(1===pc)return 32;this.RAh();eb=!1;(this.qb.Sza||this.iBa)&&(Rb=document.getElementById("SearchButton"))&&
Rb.click();if(!this.qb.Sza&&this.iBa)for(Rb=document.getElementsByClassName("ms-suiteux-search-box"),pc=0;pc<Rb.length;pc++){const Wc=Rb[pc].querySelector("input[type=search]");Wc&&(eb=mb.FocusManager.Zq(Wc))}else eb=mb.FocusManager.Zq($get(this.qb.Qp?t.CuiHelper.E4e:t.CuiHelper.B7e));this.WVb=!0;return eb?32:8}Yme(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.RAh();eb=Ic.CommandValueId;Rb=this.qb.Qp?t.CuiHelper.E4e:
t.CuiHelper.B7e;this.qb.Qp&&!Y.b(Ic[db.a.iba])&&(Ic[db.a.iba]=!1);if(eb){if(this.qb.Qp)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(eb)),this.tOa=[19],32;if(Ic=$get(Rb))Ic.value=eb}return mb.FocusManager.Zq($get(Rb))?32:8}RAh(){this.Pd.cV(this.qb.Sza||this.iBa?this.qb.RZc:this.qb.wLa,!1)}Mcj(eb,Rb){switch(eb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Rb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,
Rb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Rb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,Rb)}return Rb}JOf(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;eb=this.Rha?this.Rha.suh:0;Ic.Value=1!==eb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,eb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;
if(this.Rha)for(const nd of this.Rha.zYi)Ic=Object(m.a)(N.a,nd)?nd.id:ab.a.replaceAll(nd.value,'"',""),(Ic=$get(Ic+"-"+M.a.s7e))&&Kb.a.gS(Ic,Kb.a.fr,ab.a.ze(this.Mcj(nd.groupType,Ic.innerText)));return 32}YIf(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.Lob=new Lb.a(2,1,0,()=>{Ic[Wa.Callback]()},97);this.Rha&&this.ae.Hb(this.Lob);return 32}wyg(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:LogItemExecuted",
"actiondata comes null"),16;Ic.CloseAllMenus&&(eb=void 0===Ic.ParentControlId||null===Ic.ParentControlId?"<NA>":Ic.ParentControlId,Rb=this.Tob?this.Tob[Ic.ControlId]:null,!Rb&&this.Tob&&"<NA>"!==eb&&(Rb=this.Tob[eb]),Rb||(Rb=this.uqb&&this.LS.PYj(Ic),Rb=this.PWi(Rb,Ic.ControlId),Rb=new x(Rb,32,4,-1,-1,-1),this.Kd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Ic.ControlId+" determined group:"+T.a[Rb.groupType])),this.Kd.ZFk(Ic.ControlId,eb,Ic.CommandId,Ic.CloseAllMenus,Rb),this.vBa.iDk(Ic.ControlId),
Ic.Location!==ta.a.contextMenu&&(this.LS.pei(Ic),this.LS.kz(Rb.resultType),this.qb.Uud&&this.b8.Cfi(Ic.CommandId)));return 32}gyg(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;(new Ea(this.uYc())).rsj(this.kpb);eb=this.kpb;Rb=this.Bca;pc=this.Kd.xAc;if(Y.b(Ic))return this.Kd.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Ic=Ic.UILocation;eb&&0<eb.length&&this.eWb&&M.a.S2e(this.qb)&&this.qb.m4c&&19!==Ic&&Rb>pc&&!this.qb.gI&&(this.Kd.bue(eb),this.Kd.u0e(Rb));this.Kd.Lfl();this.qb.fAd&&
19!==Ic&&(this.ZD.mark(3),this.ZD.measure(1,0,3),this.ZD.measure(2,2,3),this.ZD.Ste(0,1,2),this.ZD.Ste(2,2,3),this.ZD.Ste(1,0,3),this.ZD.NRa([0,1,2,3]),this.ZD.clearMeasures([0,2,1]));this.Kd.kGk(window.performance.now()-this.iLd);this.qb.Qp&&(this.iOa=null,this.Kd.wbh());this.WVb=this.aqb=!1;this.kpb="";return 32}syg(eb,Rb,pc){if(1===pc)return 32;this.Kd.xbh(B(Rb),this.WVb);return 32}ryg(eb,Rb,pc){if(1===pc)return 32;this.Kd.wbh();this.aqb=!1;return 32}fyg(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;this.hQ=
null;Ic&&(this.hQ=Ic);this.qb.fAd&&(Y.b(this.hQ)||this.hQ.Location!==ta.a.contextMenu)&&this.ZD.mark(0);this.Kd.Ptd(Y.b(this.hQ)||Y.b(this.hQ.Location)?ta.a.unknown:this.hQ.Location);this.Kd.jGk(this.hpf,this.WVb);if(!this.aqb)this.onc();return 32}UQf(eb,Rb){const pc=[],Wc=Date.now();for(let Ic of eb)eb=(Wc-Ic.timeStamp)/1E3,eb=M.a.qyd(eb),Array.add(pc,new da(Rb?Ic.commandId:Ic.controlId,eb));return pc}aTi(eb){const Rb=[],pc=Date.now();for(let Wc of eb)if(Wc.controlId||"keyboardShortcut"===Wc.commandSurface)eb=
(pc-Wc.timeStamp)/1E3,eb=M.a.qyd(eb),Array.add(Rb,new aa(Wc.controlId,Wc.commandId,eb,Wc.commandSurface,Wc.lxd));return Rb}sRf(eb=!1){var Rb=eb?this.LS.osj():this.LS.T7b();eb=[];const pc=Date.now();for(const Wc of Rb)Rb=(pc-Wc.TimeStamp)/1E3,Rb=M.a.qyd(Rb),Array.add(eb,new da(Wc.Id,Rb));return eb}onc(){if(!this.aqb){this.uqb=this.aqb=!0;""!==this.qb.dxh&&Q.AFrameworkApplication.uk(this.qb.dxh);if(!this.wmf){this.wmf=!0;const eb={};eb.IsMLREnabled=this.qb.H2j;eb.IsReactRibbonEnabled=this.qb.Qp;eb.IsSharedHeaderEnabled=
!!Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.mb.uO;eb.IsSearchUxEnabled=this.iBa;eb.IsTellMeInHeaderEnabled=this.qb.Sza;eb.IsGoLocalEnv=M.a.r0j();eb.IsSovereignEnvironment=M.a.iCb();eb.IsTellMeServiceResultsEnabled=M.a.S2e(this.qb);eb.IsSubstrateProviderEnabled=M.a.R2e(this.qb);eb.ShouldFetchTokens=!!Q.AFrameworkApplication.Aa&&Q.AFrameworkApplication.Aa.mb.TOb;eb.IsSerpletEnabled=M.a.P9();eb.FirstOnClickTimeInMS=Math.round(window.performance.now());eb.IsHeaderHidden=Q.AFrameworkApplication.hideHeader||
Q.AFrameworkApplication.UT;eb.IsSearchInHeaderHidden=Q.AFrameworkApplication.a_c;void 0!==window.performance.timing&&null!==window.performance.timing&&(eb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));eb.IsFindWithMatchesEnabled=this.qb.a2f;eb.HelpShowsTopSearchResult=this.qb.nuc;eb.HelpShowsNumberOfMatches=this.qb.muc;Q.AFrameworkApplication.fa&&(eb.UiHost=Q.AFrameworkApplication.fa.Ha("UiHostIntegrationType"));this.Kd.Qgk(JSON.stringify(eb))}this.RDd=this.UQf(z.a.instance.zTb,
!1);this.cff=this.UQf(z.a.instance.V3a,!0);this.gxf=this.aTi(z.a.instance.V3a);this.Bpf=this.sRf();this.Cpf=this.sRf(!0);this.Kd.onc()}}FAb(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Tc.a.tX)return 32;this.iLd=window.performance.now();this.onc();eb=new fa(Object(r.a)(this,this.jga,"onRequestCompleted"),0);this.Bca++;this.Kd.beginQuery("",this.Bca,this.uqb);this.Y$e(!0,null);this.Rha=jb.QRc;this.iOa=ha.k6d;if(this.b8)Ib.instance.actions=
[],this.b8.IB(new ca("",this.Bca),eb,this.qb.Qp);else this.Kd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Lob&&this.ae.Hb(this.Lob);return 32}restoreFocus(eb,Rb,pc){if(1===pc)return 32;this.Pd.J1(this.qb.Sza||this.iBa?this.qb.RZc:this.qb.wLa,!1);return 32}tellMe(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.hQ=Ic;this.Kd.Ptd(Y.b(this.hQ.Location)?ta.a.unknown:this.hQ.Location);eb=
this.hQ.Value;this.qb.Qp||eb&&""!==eb.trim()?(!this.iOa&&this.qb.Qp&&(this.Kd.xbh(B(Rb),this.WVb),this.onc()),this.c4i(eb,this.hQ.Location),this.hQ.PopulationXML=this.Rha.xml):this.uqb?this.hQ.PopulationXML=this.Rha.xml:(this.hQ.PopulationXML=jb.QRc.xml,this.iOa=ha.k6d,this.kpb="");return 32}c4i(eb,Rb){this.iLd=window.performance.now();this.qb.fAd&&Rb!==ta.a.contextMenu&&this.ZD.mark(1);this.qb.Qp&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(eb));eb&&0<eb.trim().length&&(this.uqb=
!1);this.qb.R2i();Rb=Y.b(Rb)?ta.a.tellMe:Rb;if(eb!==this.kpb||this.qb.Qp){this.Bca++;this.Kd.beginQuery(eb,this.Bca,this.uqb);this.Y$e(!0,null);const pc=new ca(eb,this.Bca),Wc=new fa(Object(r.a)(this,this.jga,"onRequestCompleted"),this.Bca);this.Rha=jb.QRc;this.iOa=ha.k6d;if(this.b8)Ib.instance.actions=[],this.b8.IB(pc,Wc,this.qb.Qp,Rb,this.tOa),this.tOa=null;else this.Kd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.hpf=this.Bca;this.kpb=eb}}BTl(eb){if(this.qb.Qp){var Rb=
appChrome.selectors.getActiveControlStates();if(Rb=Object(n.a)(Object,Rb[eb.value])){eb.label=Rb.label;let pc=null;"description"in Rb&&(pc=Rb.description);pc&&Object.getType(pc)===String?eb.description=pc:"secondaryText"in Rb?eb.description=Rb.secondaryText:"fullDescriptionLabel"in Rb&&(eb.description=Rb.fullDescriptionLabel)}}}QTk(eb){this.Tob={};let Rb=0,pc=0;for(const Wc of eb){eb=0;for(const Ic of Wc.results)this.Tob[Ic.value]=new x(Ic.groupType,Ic.type,Ic.subType,Rb,eb,pc),eb++,pc++,Ic.label||
5!==Ic.type||this.BTl(Ic);0<eb&&Rb++}}HJb(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(eb=Ic.CommandValueId)&&window.open(eb,"_blank");return 32}Uwg(eb){const Rb={};Rb.token=this.y4e;Rb.files=pa.c(eb);Rb.type="MultiFilesDeckGeneration";if(Q.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.Ca.Ja(kb.a.Mwg,2,Rb),!0;eb=M.a.rdg("",M.a.tuh("GenerateDeckFromFile"),
Object.assign(new ub.a,{landingTab:"All",data:Rb}));eb=this.Ca.Ja(kb.a.Y0c,2,eb);return 32!==eb?(this.Kd.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+eb+"."),!1):!0}pmh(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Pd.G3f();if(eb=Ic.TerminalParentControlId){eb=this.Mob.ga(eb);if(!eb)return 16;Rb=[];Array.add(Rb,eb);if(!this.Uwg(Rb))return 8}return 32}q5f(){if(!this.Mob.count)return 16;
const eb=[];for(let Rb of this.Mob.values)Array.add(eb,Rb);return this.Uwg(eb)?32:8}yac(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:InsertMention","actiondata comes null"),16;eb=Ic.UILocation;let nd;Ic=Ic.CommandValueId;try{nd=pa.a(Ic)}catch(ob){return this.Kd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Y.b(nd)?(this.Kd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Y.b(this.vCc)?(this.Kd.onError("TellMeActor:InsertMention",
"_iInsertContentHandler comes null"),16):19!==eb?(this.Kd.onError("TellMeActor:InsertMention","location "+eb+" is unexpected"),16):this.vCc.yac(nd.displayName,nd.email,nd.userId)?32:(this.Kd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Uxa(eb,Rb,pc,Wc,Ic){return 1===pc?32:Y.b(Ic)?(this.Kd.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Ic.UILocation?this.nUj(pc,Ic):this.HJb(eb,Rb,pc,Wc,Ic)}gfh(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:OpenFeedback",
"actiondata comes null"),16;this.DN&&window.setTimeout(()=>{this.DN.execute(nd=>{nd.hmb("TellMeSurvey",null)})},Ib.t6i);return 32}nUj(eb,Rb){if(1===eb)return 32;if(Y.b(Rb))return this.Kd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Y.b(this.vCc))return this.Kd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;eb=Rb.CommandValueId;return Y.b(eb)?(this.Kd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.vCc.insertHtmlText(eb)?32:(this.Kd.onError("TellMeActor:InsertUrl",
"url is not inserted"),16)}jga(eb,Rb,pc,Wc,Ic){pc=window.performance.now();this.QTk(Rb);this.Kd.Dql(Rb);this.qb.Qp?(this.iOa=this.dLd.ucj(Rb,eb,Ic),this.qb.cea?(this.I2.push(appChrome.actions.updateTellMeSearchResults(this.iOa.menuModel,eb,Ic)),appChrome.api.dispatch(this.I2)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.iOa.menuModel,eb,Ic)),this.qb.fAd&&this.aqb&&(Y.b(this.hQ)||this.hQ.Location!==ta.a.contextMenu)&&(this.ZD.mark(2),this.ZD.measure(0,1,2))):this.Rha=this.Vxf.vcj(Rb,
this.Kd.Noa);this.Lob&&this.ae.Hb(this.Lob);Ic={};Ic.GroupsCount=Rb.length;Ic.QueryID=Wc;Ic.QueryLength=eb.length;this.Kd.TH(w.a.ZQi,window.performance.now()-pc,Ic)}PWi(eb,Rb){return Rb.startsWith(this.qb.Qp?M.a.P9e:M.a.Iyd)?5:eb?4:"bSearchHelp"===Rb||Rb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Rb||Rb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Rb?24:Rb===this.qb.$1f?2:0}kz(eb,Rb){this.b8?this.b8.kz(eb,Rb):Array.add(this.TFc,new J(eb,Rb))}Iwg(eb,Rb,pc,Wc,Ic){if(1===pc)return 32;
if(Y.b(Ic))return this.Kd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){eb={};eb.SourceControlId=Ic.SourceControlId;eb.Query=Ic.CommandValueId;Ic=this.Ca.Ja(kb.a.Vse,2,eb);if(32!==Ic)this.Kd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Ic+".");return Ic}return this.Ca.Ja(kb.a.Vse,2,Ic)}ICb(eb,Rb,pc,Wc,Ic){({AddinResultsProvider:eb}=
d(725));if(1===pc)return 32;if(Y.b(Ic))return this.Kd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;pc=Ic.CommandValueId;if(Y.a(pc))return this.Kd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!eb.G7a[pc])return this.Kd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+pc+" doesn't not exist in entitlements"),16;Ic=d(725).AddinResultsProvider.G7a[pc];eb={};eb.solutionId=Ic.id;eb.version=Ic.appVersion;eb.storeType=Ic.storeType;eb.storeId=Ic.storeId;eb.assetId=
Ic.assetId;eb.assetStoreId=Ic.assetStoreId;eb.displayName=Ic.displayName;eb.targetType=Ic.targetType;eb.height=Ic.height;eb.width=Ic.width;Ic=this.Ca.Ja(kb.a.Gmg,2,eb);if(32!==Ic)this.Kd.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Ic+". AssetId: "+pc);return Ic}gmb(){if(!Y.b(this.DN))for(let eb of z.a.instance.V3a){if("ShowContextMenuWithFloatie"===eb.commandId)return this.DN.execute(Rb=>{Rb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(eb.commandId&&
-1===eb.commandId.indexOf("Tab"))break}return 8}Y$e(eb,Rb="",pc=null){eb?this.Mob=new h.a(e.a.Gk()):Rb&&pc&&this.Mob.add(Rb,pc)}static get instance(){return Ib.La||(Ib.La=new Ib)}}Ib.La=null;Ib.CJl="mso_tellMeService";Ib.unknown="Unknown";Ib.t6i=500;Object(K.a)(Ib,"TellMeActor",null,[])},1177:function(K,S,d){d.r(S);d.d(S,"SurfaceStringTokenStringGenerator",function(){return e});K=d(0);var h=d(555);class e extends h.a{constructor(r){super(r);this.Ka=r}apply(r,m,n,z,t,x,B){null==x&&(x=r.Jeg(t,m));B=
h.a.tAf(r,x,this.Ka.score,n,z,B);return{Nwc:x,u1b:B}}}e.v1b=0;Object(K.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1178:function(K,S,d){d.r(S);d.d(S,"QueryTokenStringGenerator",function(){return r});K=d(0);var h=d(555),e=d(81);class r extends h.a{constructor(m){super(m);this.Ka=m}apply(m,n,z,t,x,B,D){n=this.Ka.query.load(n,null);x=0;let w=null;this.Ka.query.iV===e.Annotations.qha?n&&(w=this.Ka.name):((w=this.Ka.name)&&(w+="_"),w+=this.Ka.annotations.C2(this.Ka.query.iV,n));null!=w&&(x=h.a.tAf(m,
w,this.Ka.score,z,t,x));return{Nwc:B,u1b:D+x}}}r.v1b=1;Object(K.a)(r,"QueryTokenStringGenerator",h.a,[])},1179:function(K,S,d){d.r(S);d.d(S,"FuzzyMatchTokenStringGenerator",function(){return e});K=d(0);var h=d(555);class e extends h.a{constructor(r){super(r);this.Ka=r}apply(r,m,n,z,t,x,B){null==x&&(x=r.Jeg(t,m));r=this.Ka.g_f.Jhk(x);if(this.Ka.afh)for(var D of r)if(!D.hH&&D.RTc)return{Nwc:x,u1b:B};D=0;for(const w of r)if(w.hH&&!({lYd:D}=this.FEf(w,!0,n,z,D)).returnValue)return{Nwc:x,u1b:B};if(this.Ka.mlg)for(const w of r)if(!({lYd:D}=
this.FEf(w,!1,n,z,D)).returnValue)break;return{Nwc:x,u1b:B}}FEf(r,m,n,z,t){let x;m?(m=0,x=r.RTc?1:0):(m=r.RTc?1:0,x=r.count-m);for(let B=0;B<x;++B)if(h.a.uAf(r.wTa+m+B,this.Ka.score,n,z),++t,0<this.Ka.YJe&&t>=this.Ka.YJe)return{returnValue:!1,lYd:t};return{returnValue:!0,lYd:t}}}e.v1b=2;Object(K.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1192:function(K,S,d){d.r(S);K=d(0);var h=d(305),e=d(18),r=d(16),m=d(1253),n=d(174);class z{constructor(M,Q,C,O=0){this.qgg=M;this.groupType=Q;this.kge=O;this.ssc=
C}}Object(K.a)(z,"SortingGroup",null,[]);class t{constructor(M,Q,C,O){this.order=M;this.bbb=Q;this.tCj=C;this.groupType=O}}Object(K.a)(t,"SortingProp",null,[]);var x=d(117),B=d(145),D=d(108),w=d(126);class J{constructor(M,Q){this.RZg={};this.QZg={};this.QYg=this.J4g=1;this.FHf(M,Q)}dEl(M,Q,C){var O=D.a.aG(C)?this.RZg:this.QZg;C=new e.a;for(var U of Q)Q=Object(m.a)(t,O[h.a[U.groupType].toLowerCase()]),w.b(Q)||C.add(new r.a(Q,U));C.Sc((ca,N)=>ca.key.order<N.key.order?-1:1);Array.clear(M);U=x.TellMeActor.instance.hQ;
for(Q=0;Q<C.count;){O=C.ga(Q).key.bbb;var T=C.ga(Q).value;const ca=new n.a(C.ga(Q).key.groupType);w.b(U)||U.Location===B.a.contextMenu||(ca.displayName=C.ga(Q).key.tCj);for(const N of T.results)ca.ys(N);for(T=++Q;T<C.count&&C.ga(T).key.bbb===O;)this.LTd(ca,C.ga(T).value),T=++Q;M.push(ca)}}lVl(M,Q){this.QYg=this.J4g=1;this.FHf(M,Q)}FHf(M,Q){this.HGh(M);for(var C=0;C<M.length;C++){let O=M[C];for(const U of O.ssc)this.efi(U,C,O.qgg,O.groupType)}this.HGh(Q);for(M=0;M<Q.length;M++){C=Q[M];for(const O of C.ssc)this.dfi(O,
M,C.qgg,C.groupType)}}HGh(M){M.sort((Q,C)=>Object(m.a)(z,Q).kge>Object(m.a)(z,C).kge?-1:1)}efi(M,Q,C,O){this.RZg[h.a[M].toLowerCase()]=new t(this.J4g++,Q,C,O)}dfi(M,Q,C,O){this.QZg[h.a[M].toLowerCase()]=new t(this.QYg++,Q,C,O)}LTd(M,Q){for(let C=0;C<Q.results.length;C++)M.ys(Q.results[C])}}Object(K.a)(J,"BaseGroupingSorter",null,[]);class F{constructor(){this.Egd=[new z("",26,[26]),new z("",24,[24]),new z(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new z(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new z("",13,[13]),new z("",22,[22])];this.sdd=[new z("",25,[25]),new z(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new z(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new z(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new z("",13,[13]),new z("",22,[22])];this.rHg=new J(this.Egd,this.sdd)}avc(M,Q,C,O=null,U=null){let T=!1;if(O){for(const ca of D.a.aG(C)?
this.Egd:this.sdd)this.I3k(ca,O);T=!0}if(U){for(const ca of D.a.aG(C)?this.Egd:this.sdd)this.mVl(Q,ca,U);T=!0}T&&this.rHg.lVl(this.Egd,this.sdd);this.rHg.dEl(M,Q,C)}I3k(M,Q){const C=new e.a;for(var O of M.ssc){const U=Q[h.a[O].toLowerCase()];C.add(new r.a(w.b(U)?Number.MAX_VALUE:U,O))}if(C.count){C.Sc((U,T)=>U.key<T.key?-1:1);Q=Array(C.count);for(O=0;O<C.count;O++)Q[O]=C.ga(O).value;M.ssc=Q}}mVl(M,Q,C){let O=0;for(const U of Q.ssc)if(h.a[U].toLowerCase()in C&&C[h.a[U].toLowerCase()])for(const T of M)if(T.groupType===
U){O+=C[h.a[U].toLowerCase()];break}Q.kge=O}}Object(K.a)(F,"SimplifiedGroupingSorter",null,[]);d.d(S,"GroupsPlacementInfo",function(){return L});class L{constructor(M){this.PZg={};this.NZg={};this.OZg={};this.SZg={};this.VGe={};this.t_g=this.nwk=this.puk=this.Muk=1;this.M0g=null;this.lq=M;this.Svi();this.pUk();this.Ovi();this.Rui();M.gI&&(this.M0g=new F)}jz(M){this.PZg[h.a[M].toLowerCase()]=this.Muk++}nB(M,Q){this.NZg[h.a[M].toLowerCase()]=Q}Xra(M){this.OZg[h.a[M].toLowerCase()]=this.puk++}cT(M){this.SZg[h.a[M].toLowerCase()]=
this.nwk++}hy(M){this.VGe[h.a[M].toLowerCase()]=this.t_g++}Svi(){const M=!!this.lq&&this.lq.wWa,Q=!!this.lq&&this.lq.boc,C=!!this.lq&&this.lq.xWa,O=!!this.lq&&this.lq.Ore&&!D.a.iCb(),U=!!this.lq&&this.lq.adc,T=!!this.lq&&this.lq.g1c,ca=!!this.lq&&this.lq.dqe,N=!!this.lq&&this.lq.Cne;this.lq&&(this.lq.Pwb||this.lq.Z3||this.lq.WRc)&&this.jz(26);N&&this.jz(24);this.jz(4);this.jz(18);this.jz(16);this.jz(7);this.jz(17);this.jz(0);this.jz(1);ca&&this.jz(28);U&&this.jz(23);M||this.jz(2);M&&!Q||this.jz(8);
this.jz(15);C&&this.jz(20);this.jz(14);this.jz(9);this.jz(12);this.jz(10);this.jz(11);M&&this.jz(2);M&&!Q&&this.jz(8);this.jz(19);T&&this.jz(27);this.jz(21);this.jz(13);O&&this.jz(22);this.jz(30)}pUk(){this.nB(21,1);this.nB(4,3);this.nB(18,3);this.nB(16,3);this.nB(7,3);this.nB(17,5);this.nB(0,5);this.nB(1,1);this.nB(28,2);this.nB(2,1);this.nB(8,2);this.nB(15,3);this.nB(14,2);this.nB(27,3);this.nB(9,1);this.nB(12,1);this.nB(10,1);this.nB(11,1);this.nB(19,1);this.nB(23,1);this.nB(13,1);this.nB(24,1);
this.nB(25,1);this.nB(20,2);this.nB(22,1);this.nB(26,1)}Ovi(){this.Xra(4);this.Xra(0);this.Xra(17);this.Xra(7);this.Xra(16);this.Xra(18);this.Xra(15);this.Xra(20);this.Xra(8);this.Xra(14)}Rui(){this.cT(14);this.cT(10);this.cT(12);this.cT(9);this.cT(11);this.cT(20);this.cT(15);this.cT(8);this.cT(2);this.cT(1);this.cT(27);this.cT(7);this.cT(18);this.cT(16);this.cT(17);this.cT(0);this.cT(4)}Tfl(){this.VGe={};this.t_g=1}Qtj(M,Q,C){this.Tfl();const O=!!this.lq&&this.lq.wWa,U=!!this.lq&&this.lq.boc,T=!!this.lq&&
this.lq.xWa,ca=!!this.lq&&this.lq.Ore&&!D.a.iCb(),N=!!this.lq&&this.lq.adc,da=!!this.lq&&this.lq.g1c,Y=!!this.lq&&this.lq.dqe,fa=!!this.lq&&this.lq.Tud;M=M&&U;fa&&this.hy(25);this.hy(4);this.hy(18);this.hy(16);this.hy(7);this.hy(17);this.hy(0);this.hy(1);Y&&this.hy(28);N&&this.hy(23);O&&!U||!M||this.hy(8);Q&&this.hy(15);O||this.hy(2);da&&this.hy(27);C&&this.hy(14);O&&!U||M||this.hy(8);Q||this.hy(15);T&&this.hy(20);C||this.hy(14);this.hy(9);this.hy(12);this.hy(10);this.hy(11);O&&this.hy(2);O&&!U&&
this.hy(8);this.hy(19);this.hy(21);this.hy(13);ca&&this.hy(22);return this.VGe}lH(){return this.lq}}Object(K.a)(L,"GroupsPlacementInfo",null,[])},1195:function(K,S,d){d.r(S);K=d(0);var h=d(724),e=d(456),r=d(305),m=d(1079),n=d(455);class z{constructor(L="",M="",Q="",C=-99999,O=-1,U=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=M?M:"";this.Type=Q?Q:"";this.Score=C;this.Age=O;this.Count=U}}Object(K.a)(z,"Suggestion",null,[]);class t{constructor(L,
M){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=M}}Object(K.a)(t,"SuggestionGroup",null,[]);class x{}x.help="help";x.answer="answer";x.commands="commands";x.dnl="servicecommands";x.DKh="template";Object(K.a)(x,"SuggestionGroupType",null,[]);var B=d(117),D=d(108),w=d(27),J=d(36);d.d(S,"InteractionLogger",function(){return F});class F{constructor(L,M,Q){this.lFd=0;this.aRd=this.CWb=null;this.Lj=L;this.ZPd=this.eEd=this.LHd=!1;this.iZh=M;this.ji=w.AFrameworkApplication.Je;this.qb=
Q;this.xAc=this.TMd=0}get Noa(){return this.Lj.Noa}Ptd(L){this.Lj.Ptd(L)}Gyg(){if(this.CWb){var L=0;for(const M of this.CWb)this.Lj.Fgk(M,L++);this.CWb=null}}beginQuery(L,M,Q){this.Lj.vgk(L,M,Q)}xbh(L,M){this.Lj.isi(L,M);this.LHd=!0;this.ZPd=!1}wbh(){this.LHd=!1;this.eEd||(this.Gyg(),this.Lj.PYf(this.lFd))}wgk(L,M){this.Lj.xgk(L,M)}ZFk(L,M,Q,C,O){for(const U of this.iZh)if(L.startsWith(U)){this.ZPd=!0;break}this.Lj.Aek(L,M,Q,C,O)}kGk(L){this.eEd=!1;this.lFd=L;this.LHd||this.ZPd||(this.Gyg(),this.Lj.PYf(this.lFd,
!1))}jGk(L,M){this.Lj.Eek(L,M);this.eEd=!0}k$d(L,M){if(!L.count)return"";let Q="";const C=Date.now();for(let O of L)L=(C-O.timeStamp)/1E3,L=D.a.qyd(L),0<Q.length&&(Q+=";"),Q+=M?O.commandId:O.controlId,Q+=":",Q+=L.toString();return Q}onc(){var L=this.k$d(h.a.instance.zTb,!1);0<L.length&&this.Lj.yek(L);L=this.k$d(h.a.instance.V3a,!0);0<L.length&&this.Lj.Ydk(L);L=this.k$d(h.a.instance.ABc,!0);0<L.length&&this.Lj.ifk(L);L=B.TellMeActor.instance.Cpf;0<L.length&&this.Lj.ugk(J.c(L))}Qgk(L){this.Lj.lek(L)}o6(L,
M,Q,C,O,U,T,ca=null){this.Lj.Qfk(L,M,Q,C,O,U,T,ca)}Zte(L,M,Q,C){this.Lj.Zte(L,M,Q,C)}TH(L,M,Q=null){this.Lj.MGa(L,M,Q)}onError(L,M,Q=null){this.Lj.Adb(L,M,Q)}Dql(L){this.CWb=L}xxj(L){const M=[];if(!L)return M;for(let Q=0;Q<L.length;Q++){const C=r.a[L[Q].groupType].toLowerCase(),O=[],U=L[Q].results;if(U){for(let T=0;T<U.length;T++)"findindocument"===C?Array.add(O,new z("","",C,U[T].score,U[T].vKc,U[T].count)):Array.add(O,new z(U[T].label,U[T].description,C,U[T].score,U[T].vKc,U[T].count));"answer"===
C||"definition"===C||"wolframanswer"===C||"entity"===C?Array.add(M,new t(O,x.answer)):"classifier"===C||"appsforoffice"===C?Array.add(M,new t(O,x.commands)):"serviceclassifier"===C?Array.add(M,new t(O,x.dnl)):"assistance"===C?Array.add(M,new t(O,x.help)):("document"===C||"people"===C||"findindocument"===C||"notes"===C||"image"===C||"template"===C)&&Array.add(M,new t(O,C))}}return M}Oee(L,M){const Q={};Q.Query=M;Q.SuggestionGroups=J.c(this.xxj(L));return J.c(Q)}meg(L){const M={"Content-Type":"application/json",
Accept:"application/json"};M["X-Office-Version"]=w.AFrameworkApplication.buildVersion;M["X-Office-Application"]=w.AFrameworkApplication.fa.Ha("Application");M["X-Office-Platform"]="WAC";M["X-TellMe-SqmUserId"]=w.AFrameworkApplication.fa.Ha("LoggableUserId")||"";M["X-TellMe-SessionId"]=this.Lj.Noa.x9;M["X-TellMe-SuggestionTypes"]="Ranker";M["X-TellMe-Culture"]=w.AFrameworkApplication.uiCulture;M["X-TellMe-ProcessSessionId"]=w.AFrameworkApplication.userSessionId;M["X-TellMe-Flights"]=L;M["X-TellMe-PartialQueryIndex"]=
this.TMd;return M}Hib(L,M,Q){this.o6(M.length,"RankerLogging",L.data.Oe.toString(),Math.round(window.performance.now()-Q),n.a.zKh,!0,e.a.vua)}uib(L,M,Q){this.o6(M.length,"RankerLogging",L.data.Oe.toString(),Math.round(window.performance.now()-Q),n.a.zKh,!1,e.a.vua)}neg(){this.aRd||(this.aRd=new m.a(this.qb,null,6E3));return this.aRd.CAa}bue(L){const M=this.Oee(this.CWb,L),Q=this.meg("RankerLogging"),C=window.performance.now();this.ji.qj(this.neg(),2,M,Q,!1,0,O=>{this.Hib(O,L,C)},O=>{this.uib(O,L,
C)},null,null,!1,4E3,6E3);this.TMd++}Lfl(){this.TMd=0}u0e(L){this.xAc=L}}Object(K.a)(F,"InteractionLogger",null,[])},1300:function(K,S,d){d.r(S);var h=d(0),e=d(27),r=d(71),m=d(395),n=d(948),z=d(96),t=d(55),x=d(1252),B=d(7),D=d(1291),w=d(94),J=d(67),F=d(176),L=d(974),M=d(80);class Q{static get hg(){return M.a.pz(Q.Fo,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Q.Fo="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(h.a)(Q,"InsertSymbolsDialogHtml",null,[]);var C=d(35),O=d(220);class U extends D.a{constructor(La,lb,Ob){super();this.vnf=this.Bra=this.oQa=null;this.THd=0;this.Ca=La;this.Pd=lb;this.YBa=Ob;this.Le(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Le(0,CommonUIStrings.l_DialogClose);this.ZV=!1;this.hg=Q.hg;this.ig="InsertSymbolsDialog"}dispose(){0<U.HRd&&m.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.THd,U.HRd);U.jgf++;
m.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",U.jgf);this.Ca=this.YBa=null;super.dispose()}Rga(){this.sj(Box4Intl.Box4Strings.L_SymbolSingle,Object(B.a)(this,this.iUj,"insertSymbolsDialogHandler"),null);this.THd=0;U.ogf++;m.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",U.ogf);const La=this.Tee("symbol_d_"+U.zWb);La&&La.focus()}hide(){var La=document.getElementById("symbolsContainer");if(La&&(La=La.getElementsByTagName("a")))for(let lb=0;lb<
La.length;lb++)w.a.removeHandler(La[lb],J.a.focus,Object(B.a)(this,this.eJh,"symbolFocusHandler"));super.hide()}iUj(La){1===La?(this.UNe("symbol_d_"+U.zWb),this.Pd.cV(this.CL,!0),this.Pd.Kl().Gj.mF(this.QD),this.QD.focus()):this.hide()}get GCb(){return U.Rnf}set GCb(La){U.Rnf=La}get CCb(){return U.Dnf}set CCb(La){U.Dnf=La}Hxa(){super.Hxa();var La=document.getElementById("symbolsContainer");if(La&&(L.a.Atd(La,this.YBa.Pui(),"InsertSymbolsDialog"),La=La.getElementsByTagName("a")))for(let lb=0;lb<La.length;lb++)w.a.addHandler(La[lb],
J.a.focus,Object(B.a)(this,this.eJh,"symbolFocusHandler"))}x8(){const La=document.getElementById("symbolsContainer");La&&(this.oQa||(this.oQa=Object(B.a)(this,this.QHl,"symbolClickHandler"),this.Ln.ub(J.a.click,La,this.oQa),this.Ln.ub(J.a.doubleClick,La,this.oQa)),this.Bra||(this.Bra=Object(B.a)(this,this.SHl,"symbolKeyHandler"),this.Wg.ub(J.a.Df,La,this.Bra),this.Wg.ub(J.a.Ay,La,this.Bra),this.Wg.ub(J.a.Tl,La,this.Bra)));super.x8()}$sa(){const La=document.getElementById("symbolsContainer");La&&(this.oQa&&
(this.Ln.Bb(J.a.click,La,this.oQa),this.Ln.Bb(J.a.doubleClick,La,this.oQa),this.oQa=null),this.Bra&&(this.Wg.Bb(J.a.Df,La,this.Bra),this.Wg.Bb(J.a.Ay,La,this.Bra),this.Wg.Bb(J.a.Tl,La,this.Bra),this.Bra=null));super.$sa()}GLk(La){this.SAh("symbol_d_"+U.zWb,!1);U.zWb=parseInt(La.substr(La.lastIndexOf("_")+1));this.SAh(La,!0);if(La=document.getElementById("SymbolNameValueLabel")){const lb=this.oYc(U.zWb);La.innerText=lb.altText}}oYc(La){const lb=this.YBa.Dvc.Lwd.value,Ob=O.a(lb);return lb[Ob[La]]}eJh(La){if(La.target!==
this.vnf){const lb=this.Pd.Kl();lb&&lb.Gj&&(lb.Gj.mF(La.target),this.vnf=La.target)}this.GLk(La.target.id)}QHl(La){const lb=La.Bc;if("a"!==lb.tagName.toLowerCase())return!1;La.eventName===J.a.doubleClick&&this.UNe(lb.id);this.Pd.cV(this.CL,!0);this.Pd.Kl().Gj.mF(lb);lb.focus();return!0}SHl(La){var lb=La.Bc;if("a"!==lb.tagName.toLowerCase())return!1;const Ob=parseInt(lb.id.substr(lb.id.lastIndexOf("_")+1));if(La.nc.ctrlKey||La.nc.altKey||La.nc.keyCode>=F.a.cob&&La.nc.keyCode<=F.a.uAa)return!1;if(La.eventName===
J.a.Df){La=La.nc.keyCode;let mc=-1;La===Sys.UI.Key.enter?(this.UNe(lb.id),this.Pd.cV(this.CL,!0),this.Pd.Kl().Gj.mF(lb),lb.focus()):La===Sys.UI.Key.up?mc=Ob-15:La===Sys.UI.Key.down?mc=Ob+15:La===Sys.UI.Key.left?mc=e.AFrameworkApplication.isRtl?Ob+1:Ob-1:La===Sys.UI.Key.right&&(mc=e.AFrameworkApplication.isRtl?Ob-1:Ob+1);0<=mc&&(lb=this.Tee("symbol_d_"+mc))&&lb.focus()}return!0}UNe(La){this.THd++;U.HRd++;La=parseInt(La.substr(La.lastIndexOf("_")+1));const lb=this.oYc(La),Ob={};Ob.SourceControlId="symbol_"+
La+"_"+lb.Kwd;this.Ca.Ja(C.a.zVa,2,Ob);m.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",La)}Tee(La){const lb=document.getElementById("symbolsContainer");return lb?lb.querySelector("#"+La):null}SAh(La,lb){(La=this.Tee(La))&&(lb?La.setAttribute("selected","true"):La.removeAttribute("selected"))}}U.zWb=0;U.Rnf=null;U.Dnf=null;U.ogf=0;U.jgf=0;U.HRd=0;Object(h.a)(U,"InsertSymbolsDialog",D.a,[]);var T=d(44),ca=d(53),N=d(40),da=d(186),Y=d(109);class fa{constructor(La,lb,
Ob,mc,Rc,Ud,ue,Xe){this.Ca=La;this.VK=lb;this.iai=new x.a(Object(B.a)(this,this.Ixj,"getSymbolsDropDownMenuProps"));this.jai=new x.a(Object(B.a)(this,this.Uee,"getSymbolsDropDownXml"));this.MQd=mc.Dvc.Lwd;this.Mk=Ob;this.YBa=mc;this.XD=Rc;this.MP=Ud;this.Uc=ue;this.Um=Xe}Ixj(){return this.YBa.Cvi()}Uee(){return this.YBa.build()}vb(){this.Ca.ra(C.a.Xnd,N.a.application,Object(B.a)(this,this.Xnd,"queryInsertSymbols"),96);this.Ca.ya(C.a.gjb,N.a.view,Object(B.a)(this,this.gjb,"populateSymbolsDropDown"));
this.Ca.ya(C.a.Mwd,N.a.view,Object(B.a)(this,this.fJh,"symbolsDropDownOpenHandler"));this.Ca.ya(C.a.mUe,N.a.view,Object(B.a)(this,this.lmh,"querySymbolPositionHandler"));this.Ca.ya(C.a.zVa,N.a.view,Object(B.a)(this,this.JFa,"insertSymbolViewHandler"));this.Ca.ya(C.a.gjb,N.a.Mf,Object(B.a)(this,this.gjb,"populateSymbolsDropDown"));this.Ca.ya(C.a.Mwd,N.a.Mf,Object(B.a)(this,this.fJh,"symbolsDropDownOpenHandler"));this.Ca.ya(C.a.mUe,N.a.Mf,Object(B.a)(this,this.lmh,"querySymbolPositionHandler"));this.Ca.ya(C.a.zVa,
N.a.Mf,Object(B.a)(this,this.hUj,"insertSymbolHandler"));this.Ca.ie(C.a.gjb,1124);this.Ca.ie(C.a.Mwd,1036);this.Ca.ie(C.a.mUe,1124);this.Ca.ie(C.a.zVa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.ya(C.a.j0c,N.a.view,Object(B.a)(this,this.YEh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ya(C.a.j0c,N.a.Mf,Object(B.a)(this,this.YEh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ie(C.a.j0c,1124))}lmh(La,lb,Ob,mc,Rc){if(1===Ob)return 32;La=this.YBa.Xgh(Rc);
La=String.format(this.YBa.RHl,La.character);Rc[n.a.InnerHTML]=La;Rc[n.a.On]=!1;return 32}JFa(La,lb,Ob,mc,Rc){if(({Nf:La,selected:Ob,JFa:Xe}=this.xTf(lb,Ob)).returnValue)return Xe;var Ud=T.SelectionEditor.Xg(Ob);let ue=!0;Ob=8;var Xe=this.Mk.ke(15);Xe.ld(La.Ag);Ud||(Ob=this.Ca.ii(lb,C.a.MDa,2,!0,mc,null),lb=32===Ob,m.ULS.shipAssertTag(6407387,348,lb,"DeleteForReplace did not succeed. Response is {0}",Ob),ue=lb);ue&&(lb=La.Nb.ak,Ud=T.SelectionEditor.Xg(lb),m.ULS.shipAssertTag(6407388,348,Ud,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
lb.contextId),Ob=8,Ud&&(Ob=this.Ca.ii(lb,C.a.zVa,2,!1,mc,Rc),m.ULS.shipAssertTag(6407389,348,32===Ob,"Insertion at IP context did not succeed. Response is {0}",Ob),32===Ob&&z.FocusManager.instance().wf(La.$I)));Xe.dispose();return Ob}xTf(La,lb){let Ob,mc;Ob=null;La.view.Uh&&(Ob=La.view);mc=null;return Ob&&Ob.Nb?(mc=Ob.Nb.ak)?this.MP.ga(14)&&this.XD.U8a(mc)?{returnValue:!0,Nf:Ob,selected:mc,JFa:8}:Ob.Nb.Pa.yH||this.Um&&this.Um.instance&&this.Um.instance.qX(mc)||T.SelectionEditor.p1c(La.RE)?{returnValue:!0,
Nf:Ob,selected:mc,JFa:2}:1===lb?{returnValue:!0,Nf:Ob,selected:mc,JFa:32}:{returnValue:!1,Nf:Ob,selected:mc,JFa:32}:{returnValue:!0,Nf:Ob,selected:mc,JFa:2}:(Y.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",La.toString()),{returnValue:!0,Nf:Ob,selected:mc,JFa:8})}hUj(La,lb,Ob,mc,Rc){if(1===Ob)return 32;if(T.SelectionEditor.p1c(lb))return 2;La=this.YBa.Xgh(Rc);mc.PC=La.index;mc=this.VK.Lc(lb.node);Ob=mc.rc(11);m.ULS.shipAssertTag(6379466,
324,Ob,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",da.a[lb.node.type]);Ob=this.Mk.ke(15);Ob.Xy(mc);fa.characterPropertiesEditor.replaceTextRange(lb,La.character,!0,!1);lb=ca.SelectionFactory.Qg(mc.currentNode,lb.Ra+1);this.Uc.setSelection(lb);Ob.dispose();return 32}gjb(La,lb,Ob,mc,Rc){if(1===Ob)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.Rp?Rc.MenuItems=this.iai.value:Rc.PopulationXML=this.jai.value;return 32}fJh(La,lb,Ob){({JFa:La}=this.xTf(lb,
Ob));return La}YEh(La,lb,Ob){2===Ob&&(new U(this.Ca,z.FocusManager.instance(),t.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).Rga();return 32}Xnd(){return 32}static get characterPropertiesEditor(){return fa.mh||(fa.mh=t.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(La){fa.mh=La}}fa.mh=null;Object(h.a)(fa,"SymbolsActor",null,[855]);class aa{constructor(La,lb){this.Kwd=La;this.altText=lb}}Object(h.a)(aa,"Symbol",null,[]);class ka{constructor(){this.LQd=
null;this.MQd=new x.a(ka.L2d)}get Lwd(){return this.MQd}Tmj(La){this.LQd||(this.LQd=O.a(this.MQd.value));return Array.indexOf(this.LQd,La)}static L2d(){const La={};La["\u2022"]=new aa("\u2022",Box4Intl.Box4Strings.L_Bullet);La["\u20ac"]=new aa("\u20ac",Box4Intl.Box4Strings.L_EuroSign);La["\u00a3"]=new aa("\u00a3",Box4Intl.Box4Strings.L_PoundSign);La["\u00a5"]=new aa("\u00a5",Box4Intl.Box4Strings.L_YenSign);La["\u00a9"]=new aa("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);La["\u00ae"]=new aa("\u00ae",
Box4Intl.Box4Strings.L_RegisteredSign);La["\u2122"]=new aa("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);La["\u00b1"]=new aa("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);La["\u2260"]=new aa("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);La["\u2264"]=new aa("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);La["\u2265"]=new aa("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);La["\u00f7"]=new aa("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);La["\u00d7"]=new aa("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);
La["\u221e"]=new aa("\u221e",Box4Intl.Box4Strings.L_Infinity);La["\u00b5"]=new aa("\u00b5",Box4Intl.Box4Strings.L_MicroSign);La["\u03b1"]=new aa("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);La["\u03b2"]=new aa("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);La["\u03c0"]=new aa("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);La["\u03a9"]=new aa("\u03a9",Box4Intl.Box4Strings.L_OhmSign);La["\u03a3"]=new aa("\u03a3",Box4Intl.Box4Strings.L_NArySummation);La["\u00b0"]=new aa("\u00b0",
Box4Intl.Box4Strings.L_DegreeSign);La["\u0394"]=new aa("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);La["\u263a"]=new aa("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);La["\u2665"]=new aa("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);La["\u20b9"]=new aa("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);La["\u00bf"]=new aa("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);La["\u00a1"]=new aa("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);La["\u2014"]=new aa("\u2014",Box4Intl.Box4Strings.L_EmDash);
La["\u2026"]=new aa("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);La["\u00c0"]=new aa("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);La["\u00c1"]=new aa("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);La["\u00c2"]=new aa("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);La["\u00c3"]=new aa("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);La["\u00c4"]=new aa("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);La["\u00c5"]=
new aa("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);La["\u00c6"]=new aa("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);La["\u00c7"]=new aa("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);La["\u00c8"]=new aa("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);La["\u00c9"]=new aa("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);La["\u00ca"]=new aa("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);La["\u00cb"]=new aa("\u00cb",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);La["\u00cc"]=new aa("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);La["\u00cd"]=new aa("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);La["\u00ce"]=new aa("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);La["\u00cf"]=new aa("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);La["\u00d1"]=new aa("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);La["\u00d2"]=new aa("\u00d2",
Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);La["\u00d3"]=new aa("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);La["\u00d4"]=new aa("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);La["\u00d5"]=new aa("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);La["\u00d6"]=new aa("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);La["\u00d9"]=new aa("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);La["\u00da"]=new aa("\u00da",
Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);La["\u00db"]=new aa("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);La["\u00dc"]=new aa("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);La["\u00df"]=new aa("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);La["\u00e0"]=new aa("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);La["\u00e1"]=new aa("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);La["\u00e2"]=new aa("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);
La["\u00e3"]=new aa("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);La["\u00e4"]=new aa("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);La["\u00e5"]=new aa("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);La["\u00e6"]=new aa("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);La["\u00e7"]=new aa("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);La["\u00e8"]=new aa("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);La["\u00e9"]=new aa("\u00e9",
Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);La["\u00ea"]=new aa("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);La["\u00eb"]=new aa("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);La["\u00ec"]=new aa("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);La["\u00ed"]=new aa("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);La["\u00ee"]=new aa("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);La["\u00ef"]=new aa("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);
La["\u00f1"]=new aa("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);La["\u00f2"]=new aa("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);La["\u00f3"]=new aa("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);La["\u00f4"]=new aa("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);La["\u00f5"]=new aa("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);La["\u00f6"]=new aa("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);La["\u00f9"]=
new aa("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);La["\u00fa"]=new aa("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);La["\u00fb"]=new aa("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);La["\u00fc"]=new aa("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);La["\u00ff"]=new aa("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);La["\u011e"]=new aa("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);La["\u011f"]=new aa("\u011f",
Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);La["\u0130"]=new aa("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);La["\u0131"]=new aa("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);La["\u0152"]=new aa("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);La["\u0153"]=new aa("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);La["\u015e"]=new aa("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);La["\u015f"]=new aa("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);
La["\u0178"]=new aa("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return La}}Object(h.a)(ka,"SymbolsLoader",null,[854]);var H=d(47),ra=d(319),ha=d(275),Ma=d(210),Ga=d(593),na=d(1284),wa=d(131),Fa=d(79);class pa{constructor(La){this.kai=La}get Dvc(){return this.kai}get RHl(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}Xgh(La){La=La.SourceControlId.split("_");const lb={};2===La.length?(lb.character=La[1],lb.index=this.Dvc.Tmj(lb.character)):
(lb.character=La[2],lb.index=parseInt(La[1]));return lb}Cvi(){return this.Xdg()}build(){return this.Uee()}Pui(){const La=new Sys.StringBuilder;La.append('<table class="moreSymbolsTable">');const lb=this.Dvc.Lwd.value,Ob=O.a(lb);let mc=0;for(;mc<Ob.length;){mc%15||La.append('<tr role="presentation">');const Rc=lb[Ob[mc]];La.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+mc,H.a.mVa(Rc.Kwd),H.a.mVa(Rc.altText)));mc++;mc%15&&mc!==Ob.length||La.append("</tr>")}La.append("</table>");return La.toString()}Uee(){const La=this.Xdg();return wa.l(La)}Xdg(){const La=Object.assign(new ra.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(La.MenuSectionList,this.Zgi());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(La.MenuSectionList,this.Hfi());return La}Hfi(){const La=Object.assign(new ha.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),lb=Object.assign(new Ma.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:H.a.ze(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:H.a.ze(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.km,Image16by16Class:Fa.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(La.ControlList,lb);return La}Zgi(){const La=Object.assign(new ha.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),lb=Object.assign(new Ga.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Ob=this.Dvc.Lwd.value,mc=O.a(Ob),Rc=Math.min(25,mc.length);for(let ue=0;ue<Rc;ue++){var Ud=Ob[mc[ue]];Ud=Object.assign(new na.a,{Id:String.format("{0}{1}_{2}","symbol_",ue,Ud.Kwd),Character:Ud.Kwd,Command:"3966968829",QueryCommand:"816646517",Alt:H.a.ze(Ud.altText)});lb.GalleryItems.push(Ud)}Array.add(La.ControlList,
lb);return La}}Object(h.a)(pa,"SymbolsUiBuilder",null,[853]);var Ea=d(64),ta=d(122),ia=d(38),Ja=d(520),ab=d(291);class Oa{constructor(){this.Ea=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Ea.resolve("Box4.Symbols.ISymbolsActor").vb()}dispose(){}Xb(La){this.Ea=La;this.Ea.register(ka,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").na();this.Ea.register(pa,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").na().oa(()=>
new pa(this.Ea.resolve("Box4.Symbols.ISymbolsLoader")));this.Ea.register(fa,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").na().oa(()=>new fa(e.AFrameworkApplication.Qa,new Ja.a,new ab.a,this.Ea.resolve("Box4.Symbols.ISymbolsUIBuilder"),ta.a.instance,ia.a.instance,Ea.a.instance,this.Ea.Ia("Box4.IExternalSelectionManager")))}static main(){r.a.instance.Ac(new Oa)}}Object(h.a)(Oa,"Box4SymbolsPackage",null,[2,3]);var Za=d(1098),Na=d(36),sa=d(77),Sa=d(454);class xb{constructor(La,lb){this.EPd=
this.DPd=null;this.Krb=new Za.a;this.ji=La;this.lCa=lb.appSettings[xb.eZl]||""}get cwl(){return this.Krb.task}get eda(){return this.ji.value}hfl(){const La={};La[xb.uKj]=e.AFrameworkApplication.Pg;La["Content-Type"]="application/json; charset=utf-8";m.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const lb=sa.a.Pi(this.lCa+xb.dwl,xb.YDk,e.AFrameworkApplication.Aa.mb.Ti.toString());this.eda.qj(lb,1,"",La,!0,2,Object(B.a)(this,this.NOe,"onSuccessCallback"),
Object(B.a)(this,this.inc,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}dgk(La){try{const lb={};lb.FlightName=La.FlightName;lb.SessionID=La.SessionID;m.ULS.sendTraceTag(594883776,215,50,Na.c(lb))}catch(lb){m.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}NOe(La){if((La=La.data.Wd)&&La.length)try{const lb=Na.a(La);this.DPd=lb.NavBarDataJson;m.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.DPd?({Su:this.EPd}=Na.d(lb.NavBarDataJson)).returnValue?
(this.dgk(this.EPd),this.Krb.Ng(this.EPd)):(m.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Sa.a.axc(this.DPd)}),this.Krb.b2()):(m.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Krb.b2())}catch(lb){m.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Krb.b2()}else m.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}inc(){this.Krb.b2();m.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return xb.La||
(xb.La=xb.J$a())}static J$a(){return new xb(new x.a(()=>e.AFrameworkApplication.Je),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.mb.Ti)}}xb.uKj="X-qs";xb.YDk="at";xb.dwl="O365ShellServiceProxy.ashx";xb.La=null;xb.eZl="ShellWebServiceBase";Object(h.a)(xb,"O365ShellActor",null,[915]);class gc{constructor(){this.Ea=null}get name(){return"Common.App.O365Shell"}Xb(La){this.Ea=La;this.Ea.register(xb,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").na().oa(()=>new xb(new x.a(()=>
e.AFrameworkApplication.Je),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.mb.Ti))}init(){e.AFrameworkApplication.fa.$e(Object(B.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){e.AFrameworkApplication.eAd&&e.AFrameworkApplication.Aa.mb.uO&&this.Ea.resolve("Common.App.O365Shell.O365ShellActor").hfl()}dispose(){}static main(){r.a.instance.Ac(new gc)}}Object(h.a)(gc,"PackageManager",null,[2,3]);var zc=d(78),Xb=d(269);class jb{constructor(La){this.Oa=new zc.a;this.qI=La}WJc(La){this.Oa.addHandler(jb.Xza,
La)}pXe(La){this.Oa.removeHandler(jb.Xza,La)}B3e(){this.Oa.raiseEvent(jb.JNb)}A3e(){this.Oa.raiseEvent(jb.KNb)}}jb.JNb="SE";jb.KNb="SEP";jb.Xza="SER";jb.G8e="TRP";Object(h.a)(jb,"NullSessionExpirationManager",null,[886,887]);var zb=d(170);class Tb{constructor(){this.YYb=this.gQa=!1;const La=e.AFrameworkApplication.gm;0>=La||(this.gm=La,m.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.gm,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Yca}),
Xb.a.instance.MUd(Object(B.a)(this,this.wJb,"onSessionExpiredDetected")),Xb.a.instance.KUd(Object(B.a)(this,this.Hnc,"onSessionExpiringDetected")))}wJb(){Xb.a.instance.Nrh(Object(B.a)(this,this.wJb,"onSessionExpiredDetected"));m.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Sge()}Hnc(){Xb.a.instance.xcl(Object(B.a)(this,this.Hnc,"onSessionExpiringDetected"));this.YYb||this.gQa||(m.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.YYb=!0,
this.h4e())}Sge(){this.gQa||(e.AFrameworkApplication.No(zb.a.sessionAccessTokenExpired),this.gQa=!0,this.Evd())}}Object(h.a)(Tb,"ASessionExpirationManager",null,[]);var Ya=d(287),sb=d(37);class oc{constructor(La,lb,Ob,mc){this.W7e="";this.Kyc=La;this.Juf=Ob;this.Guf=mc;this.vlf=lb;La=(new Date(this.Kyc)).format(e.AFrameworkApplication.zCh);this.W7e=this.vlf?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,La)}HNb(La){1===La?this.Juf&&this.Juf(this.vlf):
0===La&&e.AFrameworkApplication.Qa.Ja(sb.a.close,2,Ya.g)}dispose(){this.Guf&&this.Guf()}}oc.id="SessionExpirationDialog";Object(h.a)(oc,"SessionExpirationDialogSharedProperties",null,[]);class wb{}wb.hg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(wb,"SessionExpirationDialogHtml",null,[]);class rc extends M.a{constructor(La,lb,Ob,mc){super(lb);const Rc={};this.RBa=new oc(La,lb,Ob,
mc);this.ig=oc.id;e.AFrameworkApplication.QJf?(this.Ad=1,this.Le(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Mr=!1);lb||1===e.AFrameworkApplication.Aa.mode?this.Le(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Le(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.hg=wb.hg;Rc.WACSessionExpirationText=this.RBa.W7e;this.sj(CommonUIStrings.l_DefaultDialogTitle,Object(B.a)(this,this.HNb,"sessionExpirationDialogHandler"),Rc);this.J6(this.Vh("WACSessionExpirationText"))}HNb(La){this.RBa.HNb(La)}O1c(){return this.aR}x$b(){this.hide()}dispose(){super.dispose();
this.RBa&&this.RBa.dispose()}}Object(h.a)(rc,"LegacySessionExpirationDialog",M.a,[1027]);var Ka=d(107);class Db extends Ka.StandardDialog{constructor(La,lb,Ob,mc){super(lb);this.RBa=new oc(La,lb,Ob,mc);this.ig=oc.id;e.AFrameworkApplication.QJf?(this.Ad=1,this.Le(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Mr=!1);lb||1===e.AFrameworkApplication.Aa.mode?this.Le(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Le(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Tx(CommonUIStrings.l_DefaultDialogTitle,
this.RBa.W7e,0,Object(B.a)(this,this.HNb,"sessionExpirationDialogHandler"))}HNb(La){this.RBa.HNb(La)}O1c(){return this.aR}x$b(){this.hide()}dispose(){super.dispose();this.RBa&&this.RBa.dispose()}}Object(h.a)(Db,"SessionExpirationDialog",Ka.StandardDialog,[1027]);const bc=(La,lb,Ob,mc)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.gD&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new Db(La,lb,Ob,mc):new rc(La,lb,Ob,mc);var Mc=d(223);class mb extends Tb{constructor(La){super();
this.Nrb=this.Orb=!0;this.fQ=null;this.Oa=new zc.a;this.qI=La}WJc(La){this.Oa.addHandler(mb.Xza,La)}pXe(La){this.Oa.removeHandler(mb.Xza,La)}B3e(La){this.Orb=La}A3e(La){this.Nrb=La}h4e(){if(!this.fQ&&!Mc.a.wx){if(this.Nrb){const La=Object(B.a)(this,this.vwb,"disposeCallback");this.fQ=bc(this.gm,!1,Object(B.a)(this,this.INb,"sessionExpirationHandler"),La)}this.Oa.raiseEvent(mb.KNb)}}Evd(){this.fQ&&(this.fQ.O1c()&&this.fQ.x$b(),this.fQ=null);if(this.Orb){const La=Object(B.a)(this,this.vwb,"disposeCallback");
this.fQ=bc(this.gm,!0,Object(B.a)(this,this.INb,"sessionExpirationHandler"),La)}this.Oa.raiseEvent(mb.JNb)}vwb(){this.fQ=null}INb(){this.qI.refreshDocument(null)}}mb.JNb="SE";mb.KNb="SEP";mb.Xza="SER";mb.G8e="TRP";Object(h.a)(mb,"SessionExpirationManager",Tb,[886,887]);var Wa=d(18);class db{}db.Nci="Aborting";db.dJc="ActivityDuration";db.error="Error";db.g7d="Errors";db.failed="Failed";db.MTc="FirstActivity";db.initialized="Initialized";db.kak="KickedOut";db.sak="LastActivity";db.Auh="RetryOverride";
db.Kqd="RequestGroups";db.P0a="Requests";db.Vqd="Responses";db.Usd="SessionDuration";db.status="Status";db.success="Success";db.eHl="Successful";db.tokens="Tokens";db.UQe="PollingDuration";Object(h.a)(db,"SessionExpirationStrings",null,[]);var ub=d(82);class Lb{constructor(La){this.gz={};this.q7={};this.QPa={};this.uyg=15;this.Emf=!1;this.E9h=new Date;this.DDc=new Date;this.ae=La;this.g8=new ub.a(2,2,6E4*this.uyg,Object(B.a)(this,this.LTh,"writeMeasures"),135,"SL",!1);this.ae.Hb(this.g8);this.gSj()}LTh(){m.ULS.sendTraceTag(41964821,
217,50,m.ULS.sse({["Aggregate"]:this.q7,["Current"]:this.gz}))}gSj(){this.q7[db.Kqd]=0;this.q7[db.P0a]=0;this.q7[db.Vqd]=0;this.q7[db.status]=db.initialized;this.q7[db.MTc]=new Date;this.q7[db.Usd]=0;this.q7[db.dJc]=0;this.q7[db.Usd]=0;this.gz[db.Usd]=0;this.q7[db.dJc]=0;this.gz[db.dJc]=0}get DTk(){this.QPa[db.UQe]=+new Date-+this.QPa[db.MTc];return this.QPa}Wie(La,lb){var Ob=La[lb];Ob=Ob?Ob:0;Ob++;La[lb]=Ob;this.R0e(La)}R0e(La){const lb=new Date;La[db.dJc]=+lb-+this.DDc;this.DDc=lb;La[db.Usd]=+this.DDc-
+this.E9h;La[db.sak]=this.DDc}fZ(La,lb){this.gz[La]=lb;this.R0e(this.gz)}t0e(La,lb){this.gz[La]=lb;this.R0e(this.gz)}nAb(La){this.Wie(this.gz,La);this.Wie(this.q7,La);this.Wie(this.QPa,La)}flush(){this.Emf||(this.q7[db.status]=this.gz[db.status],this.LTh(this.g8),this.ae.U1(this.g8,6E4*this.uyg))}Gfl(){const La=this.gz[db.status];La&&(this.q7[db.status]=La);this.gz={}}Nfl(){this.QPa={};this.QPa[db.UQe]=0;this.QPa[db.MTc]=new Date}stop(){m.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Emf=!0;this.ae.Kg(this.g8)}}Object(h.a)(Lb,"SessionLogger",null,[882]);class Kb{constructor(La,lb){this.aIc=La;this.Yha=lb}get tokens(){return this.aIc}get errors(){return this.Yha}}Object(h.a)(Kb,"TokenRefreshArgs",null,[921]);var uc=d(97),Yb=d(205),Tc=d(135);class sc extends Sys.EventArgs{constructor(La,lb,Ob,mc,Rc,Ud,ue){super();this.QPa=La;this.Kqd=mc;this.failed=Rc;this.P0a=Ud;this.Vqd=ue}}Object(h.a)(sc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Qb=d(89);class kb{constructor(La,
lb=null,Ob=null){this.YYb=this.gQa=!1;this.Nrb=this.Orb=!0;this.Oa=new zc.a;this.$Yb=this.qWb=this.eGc=!1;this.sNd=null;this.Rrf=10;this.iDc=!1;this.BRd=La;this.EJd=e.AFrameworkApplication.o$j;this.ae=Tc.a.instance;m.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.gm,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.Yca});this.Lj=lb||new Lb(Tc.a.instance);this.Pia=Ob;Xb.a.instance.MUd(Object(B.a)(this,
this.Jci,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));Xb.a.instance.KUd(Object(B.a)(this,this.MSd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Yb.SessionStatusManager.instance.BUd(Object(B.a)(this,this.MSd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Yb.SessionStatusManager.instance.Dki(Object(B.a)(this,this.GWk,"preemptiveTokenRefresh"));this.Cnf=new Date;e.AFrameworkApplication.n$j&&(Xb.a.instance.oZd=Object(B.a)(this,this.p6k,"refreshAccessTokenWhenSessionExpired"));
La=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.Rrf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),La=e.AFrameworkApplication.fa.ka("WopiTokenRefreshWhenNetworkResumed"));La?Yb.SessionStatusManager.instance.BUd(Object(B.a)(this,
this.Kci,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):Yb.SessionStatusManager.instance.BUd(Object(B.a)(this,this.MSd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}WJc(La){this.Oa.addHandler(kb.Xza,La)}pXe(La){this.Oa.removeHandler(kb.Xza,La)}p6k(){this.Z9b(!1);return!Xb.a.instance.vGa(e.AFrameworkApplication.gm)}Jci(La,lb){Xb.a.instance.Z3c?this.wJb(La,lb):this.EJd?(this.qWb=!1,this.Z9b(!1)):(this.gQa||m.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),
this.wJb(La,lb))}Kci(La,lb){Xb.a.instance.X3c?this.Hnc(La,lb):(Y.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.qWb=!1,this.Z9b(!0))}MSd(La,lb){Xb.a.instance.X3c?this.Hnc(La,lb):this.Z9b(!0)}Z9b(La){if(!this.eGc&&!this.qWb)if(this.Pia&&this.Pia.Gcb)this.$Yb=!0,this.Lj.fZ(db.status,db.kak),this.Lj.flush(),this.Lj.stop();else if(m.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",La,this.$Yb),this.$Yb)this.Evd();
else{this.Lj.flush();this.Lj.Gfl();this.Lj.nAb(db.Kqd);this.eGc=!0;this.iDc||(this.Lj.Nfl(),this.iDc=!0,this.yMi());const lb=this.BRd.L6k(La);lb.continueWith(()=>{if(this.BRd.kZk(lb))this.Lj.nAb(db.eHl),this.Lj.fZ(db.status,db.success),this.Nrb=!1,this.EJd&&(this.Orb=!1),this.qWb=!1,this.Cnf=new Date,this.lGl(),this.Oa.raiseEvent(kb.Xza,new Kb(lb.result.tokens,null));else{const Ob=lb.result.errors;this.Lj.nAb(db.failed);this.Lj.fZ(db.status,db.failed);La||(this.$Yb=this.BRd.lcc(Ob));this.$Yb&&(this.Lj.fZ(db.Nci,
JSON.stringify(Ob)),m.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.qWb=!0;this.Oa.raiseEvent(kb.Xza,new Kb(null,Ob))}this.Lj.flush();this.eGc=!1})}}wJb(){this.EJd||Xb.a.instance.Nrh(Object(B.a)(this,this.wJb,"onSessionExpiredDetected"));m.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Sge(Xb.a.instance.Z3c)}Hnc(){this.YYb||this.gQa||(m.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.YYb=!0,this.h4e(Xb.a.instance.X3c))}Sge(La){if(!this.gQa){var lb=
La?zb.a.hnl:zb.a.sessionAccessTokenExpired;const Ob=Object.assign(new Qb.a,{extendedProperties:new Map});Ob.extendedProperties.set("ErrorCode",String.format("{0}",lb));e.AFrameworkApplication.No(lb,void 0,["SessionExpired"],Ob);La||(La=new Date,lb=new Date(e.AFrameworkApplication.Yca),m.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",lb,La,+La-+lb),864E5>+La-+lb&&uc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],
!0,!0,!1,!0,Ob),2592E5>+La-+lb&&uc.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Ob));this.gQa=!0;this.Evd()}}lGl(){this.iDc&&(this.ae.Kg(this.sNd),this.iDc=!1)}yMi(){this.sNd=new ub.a(2,2,1E3*this.Rrf,Object(B.a)(this,this.ILl,"tokenRefreshPolling"),135);this.ae.Hb(this.sNd)}ILl(){const La=this.Lj.DTk;m.ULS.sendTraceTag(555255521,217,50,"{0}",Na.c(La));this.Oa.raiseEvent(kb.G8e,new sc(La,La[db.UQe],La[db.MTc],La[db.Kqd],La[db.failed],
La[db.P0a],La[db.Vqd]))}GWk(){3E5<+new Date-+this.Cnf?(m.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.Z9b(!1)):m.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}kb.JNb="SE";kb.KNb="SEP";kb.Xza="SER";kb.G8e="TRP";Object(h.a)(kb,"ASessionExpirationManagerWithRefresh",null,[]);class Ib extends kb{constructor(La,lb,Ob=null,mc=null){super(lb,Ob,mc);this.fQ=null;this.qI=La}B3e(La){this.Orb=La}A3e(La){this.Nrb=
La}h4e(La){if(!this.fQ&&!Mc.a.wx){if(La){var lb=Object(B.a)(this,this.vwb,"disposeCallback");this.fQ=bc(e.AFrameworkApplication.jNb,!1,Object(B.a)(this,this.INb,"sessionExpirationHandler"),lb)}else if(this.Nrb){if(this.eGc)return;lb=Object(B.a)(this,this.vwb,"disposeCallback");this.fQ=bc(e.AFrameworkApplication.gm,!1,Object(B.a)(this,this.INb,"sessionExpirationHandler"),lb)}m.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",kb.KNb,La);this.Oa.raiseEvent(kb.KNb)}}Evd(){this.fQ&&
(this.fQ.O1c()&&this.fQ.x$b(),this.fQ=null);if(this.Orb){this.Lj.stop();if(this.Pia&&this.Pia.Gcb)return;const La=Object(B.a)(this,this.vwb,"disposeCallback");this.fQ=bc(e.AFrameworkApplication.gm,!0,Object(B.a)(this,this.INb,"sessionExpirationHandler"),La)}m.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",kb.JNb);this.Oa.raiseEvent(kb.JNb)}vwb(){this.fQ=null}INb(){this.qI.refreshDocument(null)}}Object(h.a)(Ib,"SessionExpirationManagerWithRefresh",kb,[886,887]);class eb{constructor(La,lb,Ob=
null,mc=null){this.$wf=!1;this.La=null;this.EOa=La;this.pPa=lb;this.Lj=Ob||new Lb(Tc.a.instance);this.Pia=mc}create(){this.$wf=e.AFrameworkApplication.zz;if(!this.$wf)return new mb(this.EOa);e.AFrameworkApplication.uk("WOPITokenRefreshIsEnabled");m.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.La)switch(e.AFrameworkApplication.rZl){case 1:m.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this.La=new jb(this.EOa);break;
case 2:m.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.La=new Ib(this.EOa,this.pPa,this.Lj,this.Pia);break;default:m.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.La=new mb(this.EOa)}m.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.La).getName());return this.La}}Object(h.a)(eb,"SessionExpirationManagerFactory",null,[885]);var Rb=d(1253),pc=d(19);class Wc{}
Object(h.a)(Wc,"Error",null,[]);class Ic{}Object(h.a)(Ic,"NamedResult",null,[]);class nd extends Ic{}Object(h.a)(nd,"ErrorInfo",Ic,[]);var ob=d(478),$b=d(103),Hc=d(178),Pb=d(127),Yc=d(727);class Rd{constructor(La,lb,Ob,mc=null,Rc=!1,Ud=null,ue=!1,Xe=!1){this.JBa=0;this.Era=this.rn=null;this.aIc=new Wa.a;this.Yha=new Wa.a;this.ow=null;this.gWb=!1;this.OZb=this.PZb=null;this.ae=La;this.Wrf=lb;this.Wrf.execute(pe=>{pe.fC(Pb.a.kie,Object(B.a)(this,this.nIk,"onHostResponseReceived"))});this.RS=Ob;this.vwf=
new Yc.a("WebServiceCall","TokenRefresh");this.Lj=mc||new Lb(La);this.y9h=Rc;this.xra=Ud?Ud:Yb.SessionStatusManager.instance;this.thf=ue;this.iBc=Xe}nIk(La){if(La.MessageId!==Pb.a.kie)Y.c(39408099,306,15,"Unexpected message.");else{var lb=new Wa.a,Ob=new Wa.a;this.Lj.nAb(db.Vqd);var mc=La.Values[Hc.a.oyh];if(!mc||0>=mc.length)Y.c(40122317,306,15,"Found no tokens in the dictionary"),mc=La.Values;Y.c(40122318,306,100,"The Tokens array contains {0} tokens",mc.length);this.Lj.fZ("Correlation",La.CorrelationId);
var Rc="";for(let Xe=0;Xe<mc.length;Xe++){this.Lj.t0e(db.tokens,mc.length);var Ud=mc[Xe],ue=Ud;if(!ue||!ue.Name)continue;this.Lj.nAb(ue.Name);const pe=Ud;if(pe&&pe.Value)Y.c(39408128,306,100,"Received token with name: {0}",pe.Name),lb.add(pe),this.aIc.add(pe),this.iBc||this.Lj.fZ(db.status,db.success),this.thf&&this.xra&&this.xra.agl();else if(Ud=this.guj(Ud),Y.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ue.Name,JSON.stringify(Ud),this.Era),Ob.add(Ud),
this.iBc||(this.Yha.add(Ud),Rc=JSON.stringify(Ud),this.Lj.fZ(db.error,JSON.stringify(Ud)),this.Lj.fZ(db.status,db.failed)),this.thf)for(const gg of Ud.Errors)ue=this.akj(gg),this.xra&&this.xra.thi(ue)}this.iBc?(0<Ob.count?this.OZb?this.OZb(new Kb(lb,Ob)):Y.c(512267295,306,15,"Received errors but the promise has completed"):this.PZb?this.PZb(new Kb(lb,Ob)):Y.c(512267294,306,15,"Received valid tokens but the promise has completed"),Y.c(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
lb.count,Ob.count,La.CorrelationId,this.Era)):(0<Ob.count&&""!==Rc?(mc=Object.assign(new Qb.a,{extendedProperties:new Map}),mc.extendedProperties.set("Errors",Rc),mc.extendedProperties.set("RetryCount",this.JBa.toString()),mc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),mc.extendedProperties.set("IsTokenExpiring",this.gWb.toString()),uc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,mc)):uc.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),Y.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",lb.count,Ob.count,La.CorrelationId,this.Era),0<Ob.count&&!this.lcc(Ob)?(La=this.RS.kcg(Ob),La!==this.RS.UMb&&(this.Lj.t0e(db.Auh,La),this.ae.U1(this.rn,La))):(this.Lj.flush(),this.rn&&(Y.c(39408131,306,100,"Deleting task {0} from task manager",this.rn.name),this.ae.Kg(this.rn)),this.ow&&!this.ow.task.isCompleted?this.ow.Ng(new Kb(lb,Ob)):Y.c(512267293,306,15,"Received results but the task has completed")))}}guj(La){if(!La)return null;
const lb=Object.assign(new nd,{Name:La.Name,Errors:[]});for(const Ob of La.Errors)La=new Wc,La.Id=Ob.Id,La.Details=ob.a.Zyb(Ob.Details,500),lb.Errors.push(La);return lb}requestTokensOnce(){this.yth()}yth(){e.AFrameworkApplication.Oea("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.JBa>=this.RS.L5g?(Y.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Era),this.YNi(this.ow)):(uc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),
this.Kxh())}Kxh(){const La={};La[Hc.a.oyh]=this.RS.tokens;const lb=$b.a.create().toString();Y.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.RS.tokens),this.JBa+1,lb,this.Era);this.Wrf.execute(Ob=>{Ob.sendMessage(Pb.a.EVd,La,lb)});this.JBa++;this.Lj.nAb(db.P0a)}YNi(La){const lb=new Wa.a;for(let Ob=0;Ob<this.RS.tokens.length;Ob++){const mc=Object.assign(new nd,{Name:this.RS.tokens[Ob],Errors:[Object.assign(new Wc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
lb.add(mc);this.Yha.add(mc)}this.ae.Kg(this.rn);this.Lj.fZ(db.g7d,JSON.stringify(this.Yha));this.Lj.fZ(db.status,db.failed);La&&!La.task.isCompleted&&La.Ng(new Kb(new Wa.a,this.Yha))}L6k(La){this.vwf.start();this.gWb=La;this.Era=$b.a.create().toString();Y.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Era,this.gWb);this.JBa=0;this.Yha.clear();this.aIc.clear();this.ow=new Za.a;this.iBc?this.zth(this.RS.L5g).then(lb=>{this.ow&&!this.ow.task.isCompleted&&this.ow.Ng(lb);
this.OZb=this.PZb=null;this.Lj.fZ(db.g7d,JSON.stringify(this.Yha));this.Lj.fZ(db.status,db.success);this.Lj.flush()}).catch(lb=>{this.ow&&!this.ow.task.isCompleted&&this.ow.Ng(Object(Rb.a)(921,lb));this.OZb=this.PZb=null;this.Lj.fZ(db.g7d,JSON.stringify(this.Yha));this.Lj.fZ(db.status,db.failed);this.Lj.flush()}):(this.rn=new ub.a(this.RS.priority,2,this.RS.UMb,Object(B.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Pb.a.EVd,!0),this.y9h&&this.yth(),this.ae.Hb(this.rn));return this.ow.task}zth(La){const lb=
this,Ob=new Promise((Xe,pe)=>{lb.PZb=Xe;lb.OZb=pe;uc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);lb.Kxh()}),mc=this,Rc=new Promise((Xe,pe)=>{window.setTimeout(()=>{pe(mc.XQf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},mc.RS.UMb)});let Ud=La;const ue=this;return new Promise((Xe,pe)=>{Ud--;Promise.race([Ob,Rc]).then(gg=>{uc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Xe(gg)}).catch(gg=>{var cg=ue.RS.UMb;if(Object(pc.a)(921,
gg)&&(gg=Object(Rb.a)(921,gg),0<gg.errors.count)){ue.Yek(gg.errors);ue.fzf(gg.errors);if(ue.lcc(gg.errors)){pe(gg);return}const Sg=ue.RS.kcg(gg.errors);Sg!==ue.RS.UMb?(ue.Lj.t0e(db.Auh,Sg),cg=Sg):ue.L8j(gg.errors)&&(cg=0)}Ud?window.setTimeout(()=>{ue.zth(Ud).then(Xe).catch(pe)},cg):(cg=ue.XQf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ue.fzf(cg.errors),pe(cg),Y.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ue.Era))})})}fzf(La){for(let lb of La)this.Yha.add(lb)}L8j(La){if(!La.count)return!1;La=La.ga(La.count-1);return La.Errors.length?"TIMEOUT"==La.Errors[0].Id:!1}XQf(La,lb){const Ob=new Wa.a;for(let mc=0;mc<this.RS.tokens.length;mc++){const Rc=this.ZNi(this.RS.tokens[mc],La,lb);Ob.add(Rc)}return new Kb(new Wa.a,Ob)}ZNi(La,lb,Ob){return Object.assign(new nd,{Name:La,Errors:[Object.assign(new Wc,{Id:lb,Details:Ob})]})}Yek(La){if(La.count){La=La.ga(La.count-1);La=JSON.stringify(La);var lb=Object.assign(new Qb.a,
{extendedProperties:new Map});lb.extendedProperties.set("Errors",La);lb.extendedProperties.set("RetryCount",this.JBa.toString());lb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());lb.extendedProperties.set("IsTokenExpiring",this.gWb.toString());uc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,lb);this.Lj.fZ(db.error,La);this.Lj.fZ(db.status,db.failed)}}kZk(La){this.vwf.stop();const lb=this.PKj(La.result.errors);m.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!lb,this.Era,this.gWb,this.JBa,this.Yha.count,0<La.result.errors.count?La.result.errors.ga(0).Name:"",0<La.result.errors.count&&0<La.result.errors.ga(0).Errors.length?La.result.errors.ga(0).Errors[0].Id:"",0<La.result.errors.count&&0<La.result.errors.ga(0).Errors.length?La.result.errors.ga(0).Errors[0].Details:"");return lb?
!1:this.jZk(La.result.tokens)}lcc(La){return this.RS.lcc(La)}jZk(La){for(let lb=0;lb<La.count;lb++){const Ob=La.ga(lb);if(Ob.Name===Hc.a.accessToken){const mc=(new Date).getTime();Ob.Expiry>e.AFrameworkApplication.gm?(m.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Ob.Expiry,["NowGetTime"]:mc,["BootTime"]:e.AFrameworkApplication.Yca},"PreviousAccessTokenTtl",e.AFrameworkApplication.gm),e.AFrameworkApplication.accessToken=Ob.Value,e.AFrameworkApplication.gm=Math.floor(Ob.Expiry),
e.AFrameworkApplication.Ebf=mc,e.AFrameworkApplication.k_=Math.floor(Ob.Expiry)):m.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Ob.Expiry,["NowGetTime"]:mc,["BootTime"]:e.AFrameworkApplication.Yca},"PreviousAccessTokenTtl",e.AFrameworkApplication.gm)}}return!0}PKj(La){let lb=!1;for(let Ob=0;Ob<La.count;Ob++){lb=!0;const mc=La.ga(Ob);m.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",
mc.Name,JSON.stringify(mc.Errors),this.Era)}return lb}akj(La){let lb=zb.a.sessionAccessTokenExpired;La=parseInt(La.Id);if(isNaN(La))lb=zb.a.vZl;else{switch(La){case 401:lb=zb.a.yZl;break;case 403:lb=zb.a.tZl;break;case 500:lb=zb.a.uZl;break;case 503:lb=zb.a.xZl}lb===zb.a.sessionAccessTokenExpired&&(lb=500<La?zb.a.wZl:zb.a.sZl)}return lb}}Object(h.a)(Rd,"TokenRefreshManager",null,[884]);class Gb{constructor(){this.UMb=e.AFrameworkApplication.BZl;this.L5g=e.AFrameworkApplication.zZl;this.tokens=e.AFrameworkApplication.BBj();
this.priority=e.AFrameworkApplication.CZl;this.rtf=this.qsl();this.ASd=e.AFrameworkApplication.ABj()}lcc(La){La=JSON.stringify(La);if(this.ASd&&0<this.ASd.length)for(const lb of this.ASd)if(0<lb.length&&0<=La.indexOf(lb))return!0;return!1}kcg(La){try{if(La)for(let lb of La)if(lb.Errors)for(const Ob of lb.Errors)if(Ob.Id in this.rtf)return Number.parseInvariant(this.rtf[Ob.Id].toString())}catch(lb){m.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",lb.toString())}return this.UMb}qsl(){const La=
{};try{if(!e.AFrameworkApplication.SYc()||0>=e.AFrameworkApplication.SYc().length||""===e.AFrameworkApplication.SYc()[0])return La;for(const lb of e.AFrameworkApplication.SYc())0<lb.length&&(La[lb]=e.AFrameworkApplication.AZl)}catch(lb){m.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",lb.toString())}return La}}Object(h.a)(Gb,"TokenRefreshPolicy",null,[883]);class Bb{constructor(){this.Ea=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.$e(()=>
{this.zFa()})}zFa(){this.Ea.resolve("Common.ISessionExpirationManagerFactory");this.Ea.resolve("Common.ISessionExpirationManager");this.Ea.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Xb(La){this.Ea=La;La.register(882,"Common.App.SessionExpiration.ISessionLogger").na().oa(()=>new Lb(Tc.a.instance));La.register(883,"Common.App.SessionExpiration.ITokenRefreshPolicy").na().oa(()=>new Gb);La.register(884,"Common.App.SessionExpiration.ITokenRefreshManager").na().oa(()=>new Rd(Tc.a.instance,
e.AFrameworkApplication.QT(),La.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),La.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),La.rb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSyncMessageWithTimeout")));La.register(885,"Common.ISessionExpirationManagerFactory").na().oa(()=>
new eb(e.AFrameworkApplication.Aa,La.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),La.resolve("Common.App.SessionExpiration.ISessionLogger"),La.rb("Common.ISessionStatus")));La.register(886,"Common.ISessionExpirationManagerWithDialog").na().oa(()=>La.resolve("Common.ISessionExpirationManagerFactory").create());La.register(887,"Common.ISessionExpirationManager").na().oa(()=>La.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){r.a.instance.Ac(new Bb)}}Object(h.a)(Bb,
"SessionExpirationPackage",null,[2,3]);var dc=d(56),Xc=d(447),Fb=d(39),kd=d(155),od=d(120),Gd=d(141),Fd=d(63),ee=d(28),Bf=d(33),be=d(30);class af extends Mc.a{constructor(La,lb){super();this.Qfa=null;this.Nik=!1;this.Rjk="";this.JPg=this.KPg=this.UAg=this.VAg=null;this.Ad=3;this.Le(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Le(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=La;this.BQg=lb.qk(Fd.a.tSk)}dispose(){this.Qfa=null;super.dispose()}showDialog(La){this.sj(La);this.VAg=document.getElementById("btnMaximize");
this.KPg=Object(B.a)(this,this.CLk,"onScaleUpButton");w.a.addHandler(this.VAg,"click",this.KPg);this.UAg=document.getElementById("btnEnsure");this.JPg=Object(B.a)(this,this.BLk,"onScaleDownButton");w.a.addHandler(this.UAg,"click",this.JPg)}sj(La){this.Wqa=Object(B.a)(this,this.atl,"setSlideOrientationRatio");this.dza(La);this.xm.style.width="420px";this.show()}hide(){this.Jb&&(e.AFrameworkApplication.Aa.hx.Eo(od.AFrame.f6),super.hide())}CLk(La){this.ia.processAction(be.a.Htc,2);La.preventDefault();
this.ZV&&this.hide()}BLk(La){this.ia.processAction(be.a.Gtc,2);La.preventDefault();this.ZV&&this.hide()}atl(La){1===La?this.ia.processAction(be.a.Htc,2):2===La?this.ia.processAction(be.a.Gtc,2):ee.a.J(25277209,822,50,"Cancle the slide orientation change.");this.ZV&&this.hide()}dza(){this.Gu();this.ZA()}Gu(){super.Gu();Sys.UI.DomElement.addCssClass(this.Jb,this.Rjk);var La=$get("WACDialogTitleText");La.innerText=ResourceStrings.l_SetSlideScaleTitle;La.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);
La=document.createElement("div");La.id=this.Vh("WACDialogHtmlPanel");La.className="WACDialogHtmlPanel";this.xm.appendChild(La);this.Qfa=document.createElement("div");this.Qfa.id=this.Vh("WACDialogText");La.appendChild(this.Qfa);La=document.createElement("div");La.id=this.Vh("Scalediv");La.className="WACDialogRow";this.Qfa.appendChild(La);var lb=document.createElement("label");lb.id=this.Vh("Scalelabel");lb.innerText=ResourceStrings.L_SetSlideOrientationInformation;La.appendChild(lb);La=document.createElement("div");
La.id=this.Vh("ScaleMode");La.setAttribute("style","margin-left: 20px;");La.className="WACDialogRow";this.Qfa.appendChild(La);lb=af.cRf(Fd.a.Ghh+"_MaximizeFit_170x130x32",this.BQg,ResourceStrings.L_SetSlideOrientationMaximize);lb.id=this.Vh("btnMaximize");var Ob=document.createElement("td");Ob.className=String.format("clip{0}x{1}","170","130");Ob.setAttribute("style","border: #ccc 1px solid");Ob.appendChild(lb);lb=af.cRf(Fd.a.Ghh+"_Ensurefit_170x130x32",this.BQg,ResourceStrings.L_SetSlideOrientationEnsure);
lb.id=this.Vh("btnEnsure");var mc=document.createElement("td");mc.className=String.format("clip{0}x{1}","170","130");mc.setAttribute("style","border: #ccc 1px solid");mc.appendChild(lb);var Rc=document.createElement("td");Rc.setAttribute("style","width: 30px;");lb=document.createElement("tr");lb.appendChild(Ob);lb.appendChild(Rc);lb.appendChild(mc);Ob=document.createElement("td");Ob.setAttribute("align","center");mc=document.createElement("label");mc.id=this.Vh("Maxlabel");mc.className="UIFontBold";
mc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Ob.appendChild(mc);mc=document.createElement("td");mc.setAttribute("align","center");Rc=document.createElement("label");Rc.id=this.Vh("Ensurelabel");Rc.className="UIFontBold";Rc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;mc.appendChild(Rc);const Ud=document.createElement("td");Ud.setAttribute("style","width: 30px;");Rc=document.createElement("tr");Rc.appendChild(Ob);Rc.appendChild(Ud);Rc.appendChild(mc);Ob=document.createElement("table");
Ob.appendChild(lb);Ob.appendChild(Rc);La.appendChild(Ob)}ZA(){this.Mvd(Mc.a.kpc+(Mc.a.oP-af.Twi)/2-12,Mc.a.jpc+(Mc.a.YR-af.Ywi)/2-12)}Mvd(La,lb){this.Jb.style.top=(0>La?0:La)+"px";Bf.a("DeprecateIE.SetSlideOrientation")?this.Jb.style.left=(0>lb?0:lb)+"px":dc.a.Dcb&&e.AFrameworkApplication.isRtl?this.Jb.style.right=(0>lb?0:lb)+"px":this.Jb.style.left=(0>lb?0:lb)+"px";this.Nik||(this.Jb.style.width=String.format("{0}em",this.width));this.Jb.style.display="Block"}static cRf(La,lb,Ob){const mc=document.createElement("img");
mc.className=La;mc.setAttribute("Unselectable","on");mc.setAttribute(Gd.a.hf,Gd.a.qQ);mc.src=lb;Ob&&(mc.alt=Ob,mc.title=Ob);return mc}}af.Ywi=350;af.Twi=200;Object(h.a)(af,"SetSlideOrientationDialog",Mc.a,[]);var Ue=d(52),qf=d(112),Xa=d(237),vb=d(69);class cc extends M.a{constructor(La,lb){super(!1,!1,!0);this.sPf=this.V3=null;if(!La)throw Error.argumentNull("actionManager");if(!lb)throw Error.argumentNull("presentationReader");this.ia=La;this.ic=lb}AFa(){this.V3=Object(B.a)(this,this.btl,"setSlideSizeAndLayoutDialogResultHandler");
this.sPf=this.Ebj(this.getCurrentSlideDimensions());this.sj(ResourceStrings.L_SetSlideSize,this.V3,this.sPf)}btl(La,lb){1===La&&this.ia.Ja(be.a.KAh,2,lb);this.dispose()}getCurrentSlideDimensions(){const La=this.ic.Tu(),lb={};lb.height=La.height;lb.width=La.width;lb.slideType=this.ic.nwj();return lb}Ebj(La){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:La,["numberFormatInfo"]:vb.e().numberFormatInfo}}}Object(h.a)(cc,"SlideSizeAndLayoutDialog",M.a,[]);class wc{constructor(La,lb,Ob,mc,Rc,
Ud,ue,Xe,pe){this.YIa=this.Ena=this.OU=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");this.YFh=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.lGh=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=La;this.Fa=lb;this.qf=Ob;this.Fb=
mc;this.Ub=Rc;this.ua=Ud;this.pa=Xe;this.ic=ue;this.le=pe}vb(){this.ia.ra(be.a.Hod,Ue.a.application,Object(B.a)(this,this.gUe,"querySlideSize"),96);this.ia.ra(be.a.God,Ue.a.application,Object(B.a)(this,this.gUe,"querySlideSize"),96);this.ia.ra(be.a.hUe,Ue.a.application,Object(B.a)(this,this.gUe,"querySlideSize"),96);this.ia.ya(be.a.dtl,Ue.a.application,Xc.a.sH);this.ia.ra(be.a.S_k,Ue.a.application,Xc.a.P1,96);this.ia.ra(be.a.Jtc,Ue.a.application,Object(B.a)(this,this.aJj,"handleSetSlideSize"),4);
this.ia.ra(be.a.Ztd,Ue.a.application,Object(B.a)(this,this.cJj,"handleSetSlideSize4x3"),4);this.ia.ra(be.a.Ytd,Ue.a.application,Object(B.a)(this,this.bJj,"handleSetSlideSize16x9"),4);this.ia.ra(be.a.kPe,Ue.a.application,Object(B.a)(this,this.bbk,"launchSlideSizeAndLayoutDialogHandler"),4);this.ia.ra(be.a.pOk,Ue.a.application,Object(B.a)(this,this.Twg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.ra(be.a.qOk,Ue.a.application,Object(B.a)(this,this.Twg,"launchSetSlideOrientationScaleTypeDialogHandler"),
4);this.ia.ra(be.a.Htc,Ue.a.application,Object(B.a)(this,this.JAh,"setSlideOrientationHandler"),4);this.ia.ra(be.a.Gtc,Ue.a.application,Object(B.a)(this,this.JAh,"setSlideOrientationHandler"),4);this.ia.ra(be.a.KAh,Ue.a.application,Object(B.a)(this,this.ctl,"setSlideSizeAndLayoutHandler"),4);this.ia.ya(be.a.etl,Ue.a.application,Xc.a.sH);this.ia.ya(be.a.setSlideHeight,Ue.a.application,Xc.a.sH);this.ia.ra(be.a.U_k,Ue.a.application,Xc.a.P1,96);this.ia.ra(be.a.T_k,Ue.a.application,Xc.a.P1,96);this.ia.ya(be.a.DEl,
Ue.a.application,Xc.a.sH);this.ia.ya(be.a.CEl,Ue.a.application,Xc.a.sH)}me(){}gUe(La,lb,Ob,mc,Rc){ee.a.J(34936782,822,50,"Click slide size drop down.");if(lb.contextId!==Ue.a.application)return 2;if(lb=Object(Rb.a)(qf.a,Rc))La=wc.bZj(this.ic.Tu(),La),lb.If(La);return 32}bbk(La,lb,Ob){lb=this.ua.Ba;return!lb||this.qf.fd(lb)||!Bf.a("DeprecateIE.CustomizeSlideSizeActor")&&dc.a.Fx?8:1===Ob?32:kd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",La,()=>{(new cc(this.ia,this.ic)).AFa();
ee.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}Twg(La,lb,Ob,mc,Rc){La=this.ua.Ba;if(!La||this.qf.fd(La))return 16;if(1===Ob)return 32;if("slideType"in Rc&&"slideWidth"in Rc&&"slideHeight"in Rc)if(this.YIa=6,"o_custom"===Rc.slideType.toString().toLowerCase())this.OU=6*Math.round(Rc.slideWidth),this.Ena=6*Math.round(Rc.slideHeight);else{Ob=0;for(const Ud of this.slideSizeType){if(Rc.slideType.toString().toLowerCase()===Ud.toLowerCase()){this.YIa=Ob;break}Ob++}"landscape"===
Rc.orientation.toString()?(this.Ena=this.YFh[Ob],this.OU=this.lGh[Ob]):(this.OU=this.YFh[Ob],this.Ena=this.lGh[Ob])}(new af(this.ia,this.le)).showDialog(ResourceStrings.l_SetSlideScaleTitle);ee.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}aJj(La,lb,Ob){La=this.ua.Ba;return!La||this.qf.fd(La)?8:this.ia.processAction(be.a.B9a,Ob)}cJj(La,lb,Ob){ee.a.J(34936788,822,50,"click set slide size 4:3.");lb=this.ua.Ba;if(!lb||this.qf.fd(lb))return 16;if(1===Ob||960===this.ic.Tu().width)return 32;
this.OU=5760;this.Ena=4320;this.YIa=0;return this.sOb(this.OU,this.Ena,La,this.YIa,"EnsureFit")}bJj(La,lb,Ob){ee.a.J(34936792,822,50,"click set slide size 16:9.");lb=this.ua.Ba;if(!lb||this.qf.fd(lb))return 16;if(1===Ob)return 32;Ob=this.ic.Tu();if(1280===Ob.width)return 32;this.OU=7680;this.Ena=4320;this.YIa=16;return 960===Ob.width&&720===Ob.height?this.sOb(this.OU,this.Ena,La,this.YIa,""):this.sOb(this.OU,this.Ena,La,this.YIa,"EnsureFit")}ctl(La,lb,Ob,mc,Rc){lb=this.ua.Ba;return!lb||this.qf.fd(lb)?
8:1===Ob?32:this.sOb(Rc.width,Rc.height,La,Rc.slideType,Rc.slideScaleType)}JAh(La,lb,Ob){lb=this.ua.Ba;return!lb||this.qf.fd(lb)?16:1===Ob?32:this.Ena&&this.OU?La===be.a.Htc?this.sOb(this.OU,this.Ena,La,this.YIa,"Maximize"):La===be.a.Gtc?this.sOb(this.OU,this.Ena,La,this.YIa,"EnsureFit"):32:(ee.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}sOb(La,lb,Ob,mc,Rc){const Ud=this.ua.Ba;let ue=!1;if(Ud){var Xe=Ud.yj();if(Xe&&0<Xe.length)for(const pe of Xe)if(pe.SFa){ue=
!0;break}}Xe=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{Xe.ld(Ud),Xe.gd=Ob,Xe.ry[Xa.a.Fzb]=ue,Ud.setValue(Fb.a.slideWidth,La),Ud.setValue(Fb.a.slideHeight,lb),Ud.setValue(Fb.a.slideScaleType,Rc),Ud.setValue(Fb.a.slideSizeType,mc)}finally{Xe&&Xe.dispose()}ee.a.J(34936798,822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",La,lb,Rc);this.qf.c1b(this.Ub.Gf,Ud,Ob);return 32}static bZj(La,lb){La=La.width/La.height;switch(lb){case be.a.Hod:return.01>Math.abs(La-1.33);case be.a.God:return.01>
Math.abs(La-1.77);default:return!1}}}Object(h.a)(wc,"CustomizeSlideSizeActor",null,[268]);class Ad{}Ad.Sth=0;Ad.Mfl=22711;Object(h.a)(Ad,"ImageConstants",null,[]);var Md=d(234),Sd=d(330),Le=d(451),fe=d(43),Vf=d(105),Cd=d(246),Sc=d(111);class jg extends Sc.a{constructor(){super();this.ImageToken=null;this.ErrorCode=0}ul(){return 78}}Object(h.a)(jg,"NotifyImageUploadFailureRequest",Sc.a,[]);class mg{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg,cg,Sg,Hh,li,Oh,Wi,Xi,Fi,Mi,mh,ai,Aa,Ua){this.R5=this.mXa=this.xu=
null;this.UHb=!1;this.oKk=(gb,Eb)=>{(gb=t.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&Eb&&Eb.t4j&&gb.execute(Ub=>{Ub.logActivity("InsertPicture",null)})};this.ia=La;this.jb=Ob;this.fc=lb;this.ua=Rc;this.Fb=Ud;this.Fa=mc;this.QB=ue;this.BR=Xe;this.wk=pe;this.XDe=gg;this.Rq=cg;this.Vd=Sg;this.Eb=Hh;this.xjc=li;this.Dhc=Oh;this.$Xa=Wi;this.ei=Xi;this.kj=Fi;this.Da=Mi;this.wl=mh;this.Fc=ai;this.BU=Mi.KKb;this.Ga=Aa;this.Knk=null===Ua||void 0===Ua?void 0:Ua.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",
!1);this.Jt()}Jt(){this.Knk&&this.Fc.Oji(this.oKk)}vb(){this.ia.ra(be.a.insertPicture,N.a.application,Object(B.a)(this,this.ghg,"handleInsertPicture"),4);this.ia.ra(be.a.ATc,N.a.view,Object(B.a)(this,this.dKj,"handleUploadPictureAll"),4);this.ia.ra(be.a.TMc,N.a.application,Object(B.a)(this,this.EDj,"handleChangePicture"),4);this.ia.ra(be.a.Qqd,N.a.application,Object(B.a)(this,this.wIj,"handleResetPicture"),4);this.ia.ra(be.a.Qth,N.a.application,Object(B.a)(this,this.xIj,"handleResetPictureAndSize"),
4);this.ia.ra(be.a.Rth,N.a.application,Object(B.a)(this,this.yIj,"handleResetPictureSplitButton"),4);this.ia.ra(be.a.ysa,N.a.application,Object(B.a)(this,this.FDj,"handleChangePictureStyle"),4);this.ia.ra(be.a.I5d,N.a.application,Object(B.a)(this,this.ghg,"handleInsertPicture"),4);this.ia.ra(be.a.dXf,N.a.application,Object(B.a)(this,this.tEj,"handleDragAndInsertImage"),4)}me(){}ghg(La,lb,Ob){this.Da.Npg&&!Bf.a("DummyChangeGateForTest")&&ee.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");
lb=this.ua.Ba;lb=this.Da.r3c&&!!lb&&!this.fc.fd(lb);lb=(this.Dhc=this.xjc.yXj()&&this.Dhc)?lb&&!!this.QB&&this.QB.Zzd:this.BR.qqg&&lb;if(!lb)return 16;if(1===Ob)return 32;this.UHb=!0;this.R5=this.ua.Ba;this.Hvd(La!==be.a.I5d,!0);return 32}dKj(La,lb,Ob,mc,Rc){var Ud=this.ua?this.ua.Ba:null;if(!Ud||!Ud.isConnected)return 16;if(!this.kj.hD(Ud,1))return this.kj.KD(Ud),16;ee.a.J(512500497,822,50,"Start picture upload");lb=mg.c8j(Rc);(mc=fe.a.Kb)&&mc.Wa(Vf.a.qUj,lb?"1":"0");this.Fc.B3k();let ue=!1;if(this.UHb&&
this.Dhc&&!this.QB.Tlb&&this.i2j(lb)){if(Ud=Ud.R_(this.jb.Ud())){if(15!==Ud.Cj){const Xe=Ud.dS;Xe.BottomLeft.X!==Xe.TopLeft.X&&(ue=!0)}mc&&mc.Wa(Vf.a.Thl,ue?"1":"0")}Ud&&(15===Ud.Cj||ue)?(mc&&mc.Wa(Vf.a.e8d,ue?"PlaceHolder Rotated":"Picture Type PlaceHolder"),La=this.nig(La,Ob,Rc)):La=this.fKj(La,Ob,Rc)}else this.QB.Tlb=!1,La=this.nig(La,Ob,Rc);lb&&32===La&&ee.a.J(512500496,822,50,"Upload a svg file successfully.");return La}i2j(La){return La?this.Da.powerPointInsertSVGFileLocalRenderingEnabled:!0}tEj(La,
lb,Ob,mc,Rc){if(!this.QB.$Sk)return ee.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Rc)return 16;La=[];lb=0;Ob=!1;for(const Ud of Rc)if(lb++,"string"===typeof Ud.type)if(Rc=H.a.ug(Ud.type),ee.a.J(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",lb,Ud.size,Rc),0<=Rc.indexOf("image")&&0===this.QB.qAd(Ud.name))if(La.length<this.Da.powerPointDragInsertMultipleImageQuantityLimit)Array.add(La,
Ud);else{this.wl.wL(19);break}else Ob||(this.wl.wL(18),Ob=!0);if(1>La.length)return ee.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.QB.b_i(La);return 32}nig(La,lb,Ob){if(!(this.ua&&this.ua.Ba&&this.QB))return 16;if(1===lb)return 32;this.BR.cjb=new Date;this.UHb&&this.jb.nj();this.Fa.Bd();this.fc.blockContent(this.ua.presentation,La);const mc=fe.a.Kb;this.QB.B5e(Ob,Rc=>{fe.a.YI(mc,()=>{ee.a.J(512500492,822,50,"Picture upload successful");this.dHj(Ob,
Rc,La);this.g4f()})},Rc=>{ee.a.J(512500491,822,10,"Upload picture failed");this.b$b(Rc.error);this.g4f()});return 32}fKj(La,lb,Ob){if(!(this.ua&&this.ua.Ba&&this.QB))return 16;if(1===lb)return 32;const mc=String.format("{0}{1}","client",$b.a.create().toString());ee.a.J(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",mc,Ob.oJ);this.BR.tsi(mc);const Rc=fe.a.Kb;Rc&&(lb="InsertPicture",this.UHb||(lb="ChangePicture"),Rc.actionName=lb,Rc.Qj=!0);const Ud=new Date;fe.a.yk("PictureUploadStart",
fe.a.vf(Ud));fe.a.yk("ImageSize",Ob.oJ.toString());fe.a.yk("ImageToken",mc);const ue=this.ua.Ba.sid;this.ia.Ja(be.a.dke,2,ue);this.QB.B5e(Ob,Xe=>{fe.a.YI(Rc,()=>{ee.a.J(512500489,822,50,"Upload picture completed");fe.a.yk("PictureUploadDurationMS",(+new Date-+Ud).toString());this.ZSk(mc,Xe);this.ia.Ja(be.a.o0c,2,ue)})},Xe=>{this.BR.$Yf(mc);var pe=Object.assign(new jg,{ImageToken:mc,ErrorCode:Xe.error.Code});Rc&&Rc.Wa("UploadPictureErrorCode",Md.a[pe.ErrorCode]);pe=new Cd.a(pe,null,()=>mg.KJk());this.ei.Hb(pe);
ee.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",mc,Md.a[Xe.error.Code],Xe.error.Message);this.ia.Ja(be.a.o0c,2,ue)},mc);this.insertPicture(mc,La,Ob);return 32}EDj(La,lb,Ob){La=this.BU?this.bab():this.uyb();if(!(this.BU?this.mcc(La):this.s3c(La)&&this.Da.r3c&&this.BR.qqg&&!this.fc.fd(La)))return 16;if(1===Ob)return 32;this.UHb=!1;this.Hvd(!0,!1);return 32}wIj(La,lb,Ob){return this.ysa(lb,Ob,Ad.Sth,La)}xIj(La,lb,Ob){return this.ysa(lb,Ob,Ad.Mfl,La)}yIj(La,
lb,Ob,mc,Rc){return this.ysa(lb,1,Rc,La)}FDj(La,lb,Ob,mc,Rc){return this.ysa(lb,Ob,Rc,La)}ysa(La,lb,Ob,mc){const Rc=this.jb.Ud();if(!(Rc&&0<Rc.length))return 8;La=[];if(Bf.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.quj(Rc,La);else for(const ue of Rc){if(this.asg(ue)||this.fc.fd(ue))return 8;(this.BU?this.mcc(ue):this.s3c(ue))&&La.push(ue)}if(0>=La.length)return 8;if(1===lb)return 32;ee.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Ob);lb=fe.a.Kb?fe.a.Kb.actionName:
null;for(var Ud of La)this.cTa(Ud);Ud=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{Ud.jc(La[0]);Ud.gd=mc;for(const ue of La)ue.bjb=Ob}finally{Ud&&Ud.dispose()}if(mc=fe.a.Kb)lb&&(mc.actionName=lb),mc.Wa("PictureStyleId",Ob.toString()),fe.a.Naa(mc);return 32}quj(La,lb){let Ob=!1;for(const mc of La){if(!mc||this.asg(mc)||this.fc.fd(mc))return;mc.Ug&&(Ob=!0)}if(Ob)for(const mc of La)mc.Ug&&this.mcc(mc)&&lb.push(mc);else for(const mc of La)if(this.mcc(mc))lb.push(mc);else if(mc.Of){La=this.Ga.yx(mc);
for(const Rc of La)this.mcc(Rc)&&lb.push(Rc)}}dHj(La,lb,Ob){this.BR.O_a=new Date;const mc=lb.result;if(La){if(this.UHb?(lb="InsertPicture",this.WTj(mc,La,Ob)):(lb="ChangePicture",Bf.a("ChangePictureOnMultiSelectFixEnabled")?this.mBi(mc,La,Ob):this.nBi(mc,La,Ob)),La=fe.a.Kb)La.actionName=lb,La.Wa("PictureUploadStart",fe.a.vf(this.BR.cjb)),La.Wa("PictureUploadDurationMS",(+this.BR.O_a-+this.BR.cjb).toString())}else La=Object.assign(new Sd.a,{Code:94}),this.b$b(La)}ZSk(La,lb){this.BR.$Yf(La);lb.result||
ee.a.J(512500486,822,50,"Upload picture completed with null response")}WTj(La,lb,Ob){const mc=this.ua.Ba;if(mc&&mc.isConnected){this.mXa=mc.R_(this.jb.Ud());var Rc=this.Fb.yd(15,void 0,void 0,()=>{this.jb.selectShape(this.xu,!0);this.Fa.Bd()});try{Rc.jc(mc),Rc.gd=Ob,Rc.ry[Xa.a.pka]=Xa.a.A4f,this.xu=this.wk.XNi(mc.Cb),this.mXa&&(this.xu.B8=this.mXa.id),this.xu.gOb(La.ItemId,this.Da.Uua?null:lb.fileName,lb.fileName),mc.oB(this.xu)}finally{Rc&&Rc.dispose()}this.fc.usa(this.ua.Ba,this.xu,this.Eb.Na,"InsertPictureAfterUpload");
this.Rq.oA=this.xu}}mBi(La,lb,Ob){var mc=this.jb.Ud();if(mc){var Rc=[];for(const Ud of mc)Ud.Of||Rc.push(Ud);for(const Ud of Rc)this.cTa(Ud);mc=this.Fb.yd(15);try{mc.gd=Ob;mc.jc(Rc[0]);for(const Ud of Rc)Ud.B8=Ud.id,this.Da.Uua?(Ud.gOb(La.ItemId,null,lb.fileName),Ud.set_alt("")):Ud.gOb(La.ItemId,lb.fileName,lb.fileName)}finally{mc&&mc.dispose()}for(const Ud of Rc)this.fc.usa(this.ua.Ba,Ud,this.Eb.Na,"ChangePictureAfterUpload")}}nBi(La,lb,Ob){const mc=this.BU?this.bab():this.uyb();if(mc){this.cTa(mc);
var Rc=this.Fb.yd(15);try{Rc.gd=Ob,Rc.jc(mc),mc.B8=mc.id,this.Da.Uua?(mc.gOb(La.ItemId,null,lb.fileName),mc.set_alt("")):mc.gOb(La.ItemId,lb.fileName,lb.fileName)}finally{Rc&&Rc.dispose()}this.fc.usa(this.ua.Ba,mc,this.Eb.Na,"changePictureAfterUploadSingleImage")}}b$b(La){this.BR.O_a=new Date;ee.a.J(512500484,822,50,"Upload picture failed");this.Vd.rH(La.Code,lb=>{lb.JC=1;lb.jTa=La.ExtraErrorParam;return!1})}g4f(){this.fc.zK(this.ua.presentation)}Hvd(La,lb){this.XDe?Le.a(ResourceStrings.l_GenericDialogTitle,
CommonUIStrings.l_NeedToSignIn,null):this.QB&&(this.QB.S5c=this.Dhc,this.QB.FRb=0,La&&this.QB.nlh(lb))}uyb(){const La=this.jb.Ud();for(const lb of La)if(lb&&lb.tj)return lb;return null}bab(){const La=this.jb.Ud();return La&&La.length?this.uWd(La)?La[0]:this.uyb():null}uWd(La){if(!La||!La.length)return!1;let lb=La[0].tj,Ob=1===La[0].mediaType;for(const mc of La)lb=lb&&mc.tj,Ob=Ob&&1===mc.mediaType;return lb||Ob}rk(La){return La?Object(Rb.a)(117,La.qc(this.Eb.Na)):null}cTa(La){La&&La.Lv&&(La=this.rk(La))&&
La.cZ(!1)}s3c(La){return this.ua&&this.ua.Ba&&La&&La.tj?!0:!1}mcc(La){return this.ua&&this.ua.Ba&&La&&(La.tj||1===La.mediaType)?!0:!1}asg(La){return this.ua&&this.ua.Ba&&La&&La.Pp?!0:!1}insertPicture(La,lb,Ob){var mc=this.ua.Ba;const Rc=Object(Rb.a)(424,mc.qc(this.Eb.Na)),Ud=this.R5.Cb;if(mc&&mc.isConnected&&Rc&&this.R5&&this.R5.isConnected){mc=this.R5.Cs();this.mXa=this.R5.R_(this.jb.Ud());var ue,Xe;({m8d:Xe,mC:ue}=this.$Xa.z0d(this.mXa,Ob.imageWidth,Ob.imageHeight));var pe=this.Fb.yd(15,void 0,
()=>{this.jb.iu();this.jb.nh();this.Fa.Bd()},()=>{this.Rq.oA=this.xu;this.jb.selectShape(this.xu,!0)});try{pe.jc(this.R5);pe.gd=lb;this.xu=this.wk.Xja(!0,Ud.cid,Ud.sid,0,ue.x,ue.y,Xe.width,Xe.height,mc+1,!1);const gg=this.$Xa.IXd(this.Eb.Nd,Xe,ue,Rc.$T);this.xu.dS=gg;this.mXa&&(this.xu.B8=this.mXa.id,this.R5.cS([this.mXa]));this.xu.gOb(La,this.Da.Uua?null:Ob.fileName,Ob.fileName);this.xu.isResizable=!0;this.xu.Ubc=!0;this.xu.bM=!0;this.xu.FJa=!0;this.xu.tj=!0;this.xu.jxb=!!Ob.WIb;this.xu.Mea=Ob.WIb||
Ob.y_c;this.R5.oB(this.xu)}finally{pe&&pe.dispose()}fe.a.X9e()}}static c8j(La){return!!La&&!!La.fileName&&La.fileName.toLowerCase().indexOf(".svg")===La.fileName.length-4}static KJk(){ee.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(mg,"PictureActor",null,[268]);var Pa=d(115),bb=d(202),Fc=d(737),yd=d(927),ge=d(86);class rb extends Sys.EventArgs{constructor(La,lb){super();this.D4j=La;this.s4c=lb}}Object(h.a)(rb,"TokenRefreshEventArgs",Sys.EventArgs,[]);class gf{constructor(La,
lb,Ob,mc,Rc,Ud,ue){this.OHb=0;this.Mc=La;this.cHe=lb;this.zu=Ob;this.ia=mc;this.$o=Rc;this.wb=Ud;this.Da=ue;this.cHe&&this.cHe.WJc(Object(B.a)(this,this.Ieh,"onTokenRefreshed"))}KZd(La){!this.Da.podTokenRefreshImprovementEnabled&&this.wb.sua&&this.wb.tLa();const lb=Xb.a.instance.vGa(e.AFrameworkApplication.gm),Ob=Xb.a.instance.W3c(e.AFrameworkApplication.gm,e.AFrameworkApplication.Yia);ee.a.J(41562886,801,lb||Ob?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",
lb,Ob,La,this.Da.podTokenRefreshImprovementEnabled,this.OHb);Xb.a.instance.IRa();this.Da.podTokenRefreshImprovementEnabled&&this.wb.sua&&this.wb.tLa()}Ieh(La,lb){ee.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Ob=Object(Rb.a)(Kb,lb)||new Kb(null,null),mc=Ob.tokens,Rc=Ob.errors;La="";if(void 0===Rc||null===Rc||0>=Rc.count)for(lb=0;lb<mc.count;lb++)if(mc.ga(lb).Name===Hc.a.lnl){const ue=mc.ga(lb)?mc.ga(lb):null;La=ue&&ue.Value&&0<ue.Value.length?ue.Value:"";break}const Ud=
Xb.a.instance.vGa(e.AFrameworkApplication.gm);ee.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Ud,this.Da.LRe,this.OHb,this.Da.Gjh);if(0<La.length&&Ud&&this.Da.LRe&&this.OHb<this.Da.Gjh)ee.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",
(new Date).getTime(),new Date,e.AFrameworkApplication.gm,new Date(e.AFrameworkApplication.gm),this.Da.LRe,this.OHb),this.OHb++,this.KZd(2);else if(0<La.length&&!Ud){ee.a.J(41562890,809,Ud?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.gm,new Date(e.AFrameworkApplication.gm));bb.App.mbe=e.AFrameworkApplication.rwb=H.a.Ne(La);const ue=this.zu.Npc.presentationId.P5e+
"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.gm.toString());this.zu.Npc=new yd.a(new Fc.a(ue));this.Mc.Hnh(new rb(this.$o?this.$o.P_:!1,!0))}else{if(Bf.a("CleanPIIFromC49mm")&&Rc)for(let ue of Rc)if(ue.Errors)for(const Xe of ue.Errors)"403"===Xe.Id&&Xe.Details&&Xe.Details.startsWith("<")&&(Xe.Details=null);ee.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",
Rc?Pa.c(Rc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.OHb);Rc&&0<=Pa.c(Rc).indexOf("The caller is not authenticated")?(e.AFrameworkApplication.No(ge.a.Ph(383)),uc.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.No(ge.a.Ph(380)),uc.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.hv&&e.AFrameworkApplication.hv.X8();this.Mc.Hnh(new rb(this.$o?
this.$o.P_:!1,!1));this.ia.Ja(be.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Ob){ee.a.J(41562894,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Pa.c(Ob))}}dispose(){this.cHe.pXe(Object(B.a)(this,this.Ieh,"onTokenRefreshed"))}}Object(h.a)(gf,"PPTTokenRefreshManager",null,[860]);var Ab=d(87),fc=d(662);class kc{constructor(La,lb,Ob,mc,Rc,Ud){this.EY=this.ZYl=this.ZXe=null;this.o6b=this.A8d=!1;this.Tfd=
0;this.job=fe.a.Jj("SeamlessFailover");1!==lb&&2!==lb||fe.a.BGa();this.Nj=new Date;fe.a.HCb=this.startTime;this.C6h=Ob;this.hSa=0;this.u8h=lb;this.c0h=mc;this.m7h=Rc;this.eNl=Ud;this.T5i=!1;this.resultCode=0;this.Rhf=!0;if(La=e.AFrameworkApplication.Md)this.Vc.Wa("Host",Object(Rb.a)(String,La.Host)),this.Vc.Wa("Ring",Object(Rb.a)(String,La.Ring))}bBh(La,lb){this.Tfd=window.setTimeout(La,lb)}nGl(){this.Rhf=!1}dispose(){fe.a.Cdc=new Date;0<=this.Tfd&&(window.clearTimeout(this.Tfd),this.Tfd=-1)}get Q5i(){return this.Rhf}get Vc(){return this.job}get startTime(){return this.Nj}get DOk(){return this.C6h}get Bya(){return this.u8h}get e5i(){return this.c0h}get podsCleaningRequestPattern(){return this.m7h}}
Object(h.a)(kc,"SeamlessFailoverState",null,[108]);const ud=La=>{La=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ha("361"),La);e.AFrameworkApplication.Je.qW(La,1,null,null,null,0,()=>{ee.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{ee.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var zd;(function(La){La[La.unknown=0]="unknown";La[La.mouse=
1]="mouse";La[La.keyboard=2]="keyboard";La[La.podsPopsUnavailable=4]="podsPopsUnavailable"})(zd||(zd={}));Object(h.b)("RehydrationTrigger",zd);var Td=d(674),Me=d(1005);class tf{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg,cg,Sg,Hh,li,Oh,Wi,Xi,Fi,Mi,mh,ai,Aa,Ua){this.Me=this.rwe=null;this.vJe=this.Bgd=-1;this.K_g=0;this.vgb=La;this.la=lb;this.Ub=Ob;this.ia=mc;this.wb=Rc;this.DE=Ud;this.Ie=ue;this.Hg=pe;this.Hz=gg;this.Vd=cg;this.$m=Sg;this.ih=Hh;this.pc=li;this.CR=Oh;this.Qr=Fi;this.dHe=new Date;this.Qv=
Wi;this.NB=Xi;this.ua=Mi;this.Ib=mh;this.Mic=ai;Ua.execute(gb=>{this.rwe=gb});this.n9c=[];this.Otk=this.Ib.uc("SeamlessFailoverMaxRetryAttempts",0);this.Ntk=this.Ib.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.Ptk=this.Ib.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");ee.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get P_(){return!!this.Me&&this.Me.Q5i}get e1f(){return this.K_g}OSd(La){if(this.P_){e.AFrameworkApplication.zz&&(this.ih.Prc(Object(B.a)(this,
this.nga,"onWopiTokenRefreshed")),this.j2b());var lb=0;if(this.la.nBb)this.Me.Vc.qC("Result","abortedOnIrmProtectedFile"),lb=365;else if(this.Me.Vc.qC("Result",La),"abortedOnExitApp"!==La||this.Ptk)lb=4===this.Me.Bya?356:357;this.Zkb(!1,lb,!this.Me.o6b&&"abortedOnRefreshDoc"!==La)}}d9e(La,lb,Ob){if(this.P_)ee.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.hv||(e.AFrameworkApplication.hv=ee.a.G3b());this.Vd.disabled=!1;this.Vd.nla=!1;this.Me=
new kc(La,lb,this.Ie.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Ob);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Me.bBh(Object(B.a)(this,this.Iah,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Me.Vc.Wa("PopsAvailable",this.Hg.tG.toString());this.Me.Vc.Wa("OrderlyShutdown",La.toString());this.Me.Vc.Wa("Trigger",zd[lb]);this.Me.Vc.Wa("TriggerErrorCode",Md.a[Ob]);this.Me.Vc.Wa("OldPodsId",this.Me.DOk);this.Me.Vc.Wa("OldPopsId",
this.Ie.Wk);ee.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Me.Vc.actionId,this.Me.Vc.xQb());if(1===lb||2===lb)e.AFrameworkApplication.Yg=!1,this.ua.presentation&&this.ua.presentation.FYe();this.ih.eKc(Object(B.a)(this,this.nga,"onWopiTokenRefreshed"));e.AFrameworkApplication.zz&&Xb.a.instance.IRa()?(ee.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.gm,new Date(e.AFrameworkApplication.gm)),this.j2b(),this.Bgd=window.setTimeout(Object(B.a)(this,this.ENk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.nih&&this.Mic.e4f(!1)):(this.ih.Prc(Object(B.a)(this,this.nga,"onWopiTokenRefreshed")),this.oMh(lb))}}W5i(La){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,ge.a.Ph(La).toString())){if(!this.n9c.length)return!0;const lb=new Date;let Ob=0;for(let mc=this.n9c.length-
1;0<=mc;mc--){const Rc=this.n9c[mc];if(+lb-+Rc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Rc.eNl===La&&Ob++}if(Ob<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;ee.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",La,Ob,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}oMh(La){e.AFrameworkApplication.zz&&(this.ih.Prc(Object(B.a)(this,
this.nga,"onWopiTokenRefreshed")),this.j2b());if(++this.K_g>this.Otk)this.rge("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Me.bBh(Object(B.a)(this,this.Iah,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.dHe>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.rge("RecoveryStreamExpired",358);else{if(this.Me.A8d&&(this.Me.Vc.qC("Trigger",zd[La]+"_GetFileUrlExpired"),this.bXj())){this.rge("GetFileUrlExpired_NoAzureBackup",
364);return}this.Me.e5i&&this.sDi();this.ih.hpd(new Td.a(4===La?5:2));this.ih.G2k();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===La&&(ee.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Ie.Wk),this.CR.Aub(()=>{},()=>{}));this.$m.isPaused||this.$m.pause();this.Me.Vc.zm("CreatePodsWithRetryST",new Date);this.Me.Vc.zm("SessionStartTime",this.dHe);this.Fph()}}rge(La,lb){this.wb.sua&&this.wb.tLa();this.Me.Vc.qC("Result",La);this.Zkb(!1,lb)}ENk(){this.ih.Prc(Object(B.a)(this,
this.nga,"onWopiTokenRefreshed"));this.j2b();ee.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Me.Vc.Wa("WopiTokenRefreshed","TO");e.AFrameworkApplication.No(ge.a.Ph(382));uc.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.hv&&e.AFrameworkApplication.hv.X8();this.Me.o6b=!0;this.ia.Ja(be.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}nga(La,lb){La=
lb.s4c;this.ih.Prc(Object(B.a)(this,this.nga,"onWopiTokenRefreshed"));this.j2b();this.la.nih&&this.Mic.e4f(!0);lb=0<e.AFrameworkApplication.gm&&(new Date).getTime()>=e.AFrameworkApplication.gm-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;ee.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",La,(new Date).getTime(),new Date,e.AFrameworkApplication.gm,new Date(e.AFrameworkApplication.gm));
this.Me.Vc.Wa("WopiTokenRefreshed","True");this.Me.Vc.Wa("WopiTokenRefreshedSuccessfully",La.toString());this.Me.A8d=lb;La?this.oMh(this.Me.Bya):this.Me.o6b=!0}j2b(){-1!==this.vJe&&(window.clearTimeout(this.vJe),this.vJe=-1);-1!==this.Bgd&&(window.clearTimeout(this.Bgd),this.Bgd=-1)}bXj(){const La=H.a.ug(this.Ib.Ha("152")||""),lb=!e.AFrameworkApplication.Rg.IsRealEdit&&1!==this.Me.Bya&&2!==this.Me.Bya;return".pptx"!==La&&".ppsx"!==La||lb}sDi(){try{let La=0,lb=0;const Ob={},mc={};this.Qr.Mci(Rc=>{if(-1<
Rc.request.get_url().search(new RegExp(this.Me.podsCleaningRequestPattern,"i")))return this.ULh(Ob,this.fcg(Rc.request.get_url())),La++,!0;this.ULh(mc,this.fcg(Rc.request.get_url()));lb++;return!1});ee.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",La,Ob,lb,mc)}catch(La){ee.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",La)}}fcg(La){let lb=La;const Ob=La.indexOf("?");0<
Ob&&(lb=La.substr(0,Ob));La=lb.lastIndexOf("/");0<La&&(lb=lb.substr(La+1));return lb}ULh(La,lb){La[lb]=lb in La?La[lb]+1:1}Iah(){this.P_&&(this.Me.Vc.qC("Result","Timeout"),this.Me.Vc.Wa("TimeoutDuration",(+new Date-+this.Me.startTime).toString()),this.Zkb(!1,4===this.Me.Bya?354:355))}Zkb(La,lb=0,Ob=!0){if(this.P_){this.Hz.qkb(Object(B.a)(this,this.hga,"onPodSessionRefreshed"));this.Ub.Di.contentReplicator.Krc(Object(B.a)(this,this.Q9g,"onAfterReplication"));var mc=+new Date-+this.dHe>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.zz&&(mc=0<e.AFrameworkApplication.gm&&(new Date).getTime()>=e.AFrameworkApplication.gm-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&ee.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.gm,new Date(e.AFrameworkApplication.gm));La&&mc&&this.Me.Vc.Wa("SkipPopsReason","FileUrlExpired");this.pc.Pyg();var Rc=this.Me.Bya;this.Me.Vc.Wa("IsInEditingMode",
this.pc.Ho.toString());this.Me.Vc.Wa("IsPreviousModeEditing",this.pc.rcc.toString());this.Me.Vc.Wa("IsLastKnownModeEditing",this.pc.Jpe.toString());this.Me.Vc.Wa("PopSessionEverInitialized",this.Hg.bpc.toString());this.Me.Vc.Wa("ResultErrorCode",Md.a[lb]);this.Me.Vc.Wa("RefreshPage",Ob.toString());this.Me.Vc.Wa("FRehydrationInitiatedPageRefresh",this.Me.o6b.toString());this.Me.T5i=La;this.Me.resultCode=lb;this.Me.nGl();this.n9c.push(this.Me);this.Ntk||this.XTc();La?(this.ih.inh(new Me.a(Rc)),this.zMh(mc,
Rc)):(this.XTc(),0!==lb&&(La=ge.a.Ph(lb),e.AFrameworkApplication.No(La),uc.Health.instance.recordQosError(ge.a.kda(La),["UnexpectedAppRefresh"],399===lb,!1,!0,Ob,null)),Ob?(e.AFrameworkApplication.hv&&e.AFrameworkApplication.hv.X8(),this.ia.Ja(be.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.ih.inh(new Me.a(Rc)),this.zMh(mc,Rc)))}}p6b(){return this.Me&&this.Me.Vc?!0:!1}XTc(){this.p6b()&&(ee.a.J(512497874,801,15,"Action Telemetry: {0}",this.Me.Vc.xQb()),this.Me.Vc.finish(!0),
this.Me.dispose(),this.Me=null)}zMh(La,lb){!this.pc.YL||La||2!==lb&&1!==lb&&4!==lb?(this.p6b()&&this.Me.Vc.Wa("PopsRehydrationAttempted","false"),ee.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",La,lb),this.NRf(null)):(this.p6b()&&this.Me.Vc.Wa("PopsRehydrationAttempted","true"),this.CR.Aga(4===lb?6:7,Object(B.a)(this,this.BQi,"createPopSessionSucceededCallback"),Object(B.a)(this,this.NRf,"createPopSessionFailedCallback")))}BQi(){this.p6b()&&
(this.d3f(),this.Me.Vc.Wa("POPSessionCreated","true"),this.XTc())}NRf(){if(!this.p6b())return!1;this.d3f();this.Me.Vc.Wa("POPSessionCreated","false");this.XTc();return!1}d3f(){this.Me.Vc.qC("IsInEditingMode",this.pc.Ho.toString());this.Me.Vc.qC("IsPreviousModeEditing",this.pc.rcc.toString());this.Me.Vc.qC("PopSessionEverInitialized",this.Hg.bpc.toString())}gNl(La){ee.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.Ib.ka("UserHasValidLicenseForEnterpriseFonts"),this.Ib.ka("PPTOEnterpriseFontsEnabled"));this.Ib.ka("UserHasValidLicenseForEnterpriseFonts")&&this.Ib.ka("PPTOEnterpriseFontsEnabled")&&ud(La)}Fph(){this.Me.EY=fc.a();this.wb.sua||this.wb.stop();let La=this.la.restoreRCInCreatePodSessionRequest&&this.ua.pk?this.ua.pk.toString():"";La=H.a.replaceAll(La,"#","%23");this.vgb.createPodSession(this.Me.EY,"SeamlessFailover_"+this.Me.Bya,this.Me.hSa,+new Date-+this.Me.startTime,Object(B.a)(this,this.AQi,
"createPodSessionSucceededCallback"),Object(B.a)(this,this.zQi,"createPodSessionFailedCallback"),this.DE,this.Ie.podSessionId,La);this.vgb.oUl(this.Me.EY,Object(B.a)(this,this.gNl,"triggerFontsInstallationCallback"));this.wb.tLa()}AQi(La){if(this.P_){fe.a.Exd=[];this.Me.Vc.Wa("NewPodsId",this.Me.EY);this.Ie.podSessionId=this.Me.EY;this.Me.Vc.Wa("CreatePodsWithRetryResult","true");this.Me.Vc.Wa("CreatePodsRetryCount",this.Me.hSa.toString());this.Me.Vc.Wa("CreatePodsDuration",(+new Date-+this.Me.startTime).toString());
this.$m.isPaused&&this.$m.Bnb();try{this.$m.jKf()}catch(lb){ee.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",lb)}if(this.la.restoreRCInCreatePodSessionRequest&&La&&Ab.a.Doc in La&&!H.a.Xa(La[Ab.a.Doc])){const lb=Boolean.parse(La[Ab.a.Doc]);this.Me.Vc.Wa("RCRestoredWhenCreatePodSession",La[Ab.a.Doc]);lb?(this.Me.Vc.qC("Result","Success"),this.Zkb(!0)):(this.rwe&&this.rwe.IDi(),this.Me.Vc.Wa("DocRefreshTriggered","true"),La={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},La.podSessionId=this.Ie.podSessionId,this.Me.o6b=!0,this.ia.Ja(be.a.cMb,2,La))}else this.rMh()}}rMh(){this.Ub.Di.contentReplicator.OJc(Object(B.a)(this,this.Q9g,"onAfterReplication"));this.kNl()}kNl(){const La=()=>{this.Me.ZXe=new Date;this.Me.Vc.zm("InboundStartTime",this.Me.ZXe);this.Ub.Di.contentReplicator.SF(null,null,null)};ee.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ua.Ba?
this.ua.Ba.sid:0,this.Me.EY);4===this.Me.Bya&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ua.Ba?(this.NB.W$b&&this.NB.W$b.Ang(this.ua.Ba.Cb),this.Me.Vc.zm("ForceInboundSlideStartTime",new Date),this.Qv.N9d(this.ua.Ba,(lb,Ob)=>{ee.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",lb,Ob);this.P_&&(this.Me.Vc.zm("ForceInboundSlideEndTime",new Date),La())},!0,!1)):La()}zQi(La){if(!this.P_)return!0;const lb=+new Date-
+this.Me.startTime;if(399===La)return ee.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Ie.podSessionId,lb),this.Vd.rH(La,null),this.Zkb(!1,La,!1),!0;if(this.Me.A8d&&230===La)return ee.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Ie.podSessionId,lb),this.XYf("CreatePodSessionFailed_GetFileUrlFailed",
La),!0;if(this.Me.hSa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&lb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Ob;(Ob=this.Me).hSa=Ob.hSa+1;ee.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Ie.podSessionId,this.Me.hSa,lb,La);this.Fph();return!0}ee.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Ie.podSessionId,this.Me.hSa,lb,La);this.XYf("CreatePodSessionFailed",La);return!0}XYf(La,lb){this.Me.Vc.Wa("CreatePodsWithRetryResult","false");this.Me.Vc.Wa("CreatePodsRetryCount",this.Me.hSa.toString());this.Me.Vc.zm("CreatePodsWithRetryET",new Date);this.Me.Vc.qC("Result",La);this.Me.Vc.Wa("CreatePodsDuration",(+new Date-+this.Me.startTime).toString());this.Zkb(!1,lb)}Q9g(La,lb){this.P_&&(lb.nsg?ee.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
lb.vld):(this.Me.Vc.qC("InboundDuration",(+new Date-+this.Me.ZXe).toString()),this.Me.Vc.qC("Result","Success"),this.Zkb(!0)))}hga(La,lb){this.P_&&(this.Me.Vc.Wa("WaitPodsRefreshedDuration",(+new Date-+this.Me.ZYl).toString()),this.Me.Vc.Wa("NewPodsId",lb.EY),this.Hz.qkb(Object(B.a)(this,this.hga,"onPodSessionRefreshed")),this.$m.isPaused&&this.$m.Bnb(),this.rMh())}}Object(h.a)(tf,"PodSeamlessFailoverManager",null,[859]);class re{constructor(La,lb,Ob){this.Gva=La;this.Ya=Ob}n_(){}H_b(){}q7a(La){La&&
(Array.add(La,Ab.a.RPe),Array.add(La,Ab.a.Faa),Array.add(La,Ab.a.YJb),Array.add(La,Ab.a.kQk),Array.add(La,Ab.a.Doc))}eea(La,lb){lb?((lb=La[Ab.a.YJb])&&lb.toLowerCase()!==(this.Ya.Gaa?this.Ya.Gaa.toLowerCase():"")&&(ee.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",lb),this.Ya.Gaa=lb),this.Gva?(La=La[Ab.a.RPe])?(this.Gva.ccpInfo=La,ee.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",La.length)):ee.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
ee.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):ee.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(re,"RehydrationHeaderHandler",null,[881]);class lh{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg){this.YO=null;this.j9c=!1;this.ehg=cg=>{if(cg.keyCode===F.a.jAd||cg.keyCode===F.a.oNa||cg.keyCode===F.a.Nnb||cg.keyCode>=F.a.cob&&cg.keyCode<=F.a.uAa)return!1;this.xWe(2);return!0};this.tf=La;this.Mc=
lb;this.yR=Ob;this.Vr=mc;this.Rc=Rc;this.af=Ud;this.e0g=pe;this.Da=ue;this.$o=Xe;this.Vfd=gg}init(){this.Mc&&(this.Mc.LUd(Object(B.a)(this,this.sessionExpired,"sessionExpired")),this.Mc.C7a(Object(B.a)(this,this.WKk,"onRehydrateSession")))}sessionExpired(){this.QEh(!0);m.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");uc.Health.instance.stopAllHealthTimers()}xWe(La){this.QEh(!1);const lb=e.AFrameworkApplication.zz||!Bf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");m.ULS.sendTraceTag(544789148,
821,100,"Should refresh token: {0}",lb);lb&&this.Vfd&&this.Vfd.KZd(0);this.Da.podsSeamlessFailoverEnabled&&this.$o.d9e(!1,La,223)}WKk(){m.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");uc.Health.instance.resumeAllHealthTimers()}QEh(La){this.j9c!==La&&this.tf&&(La?(this.YO||(this.YO=this.af.ee(),this.YO.id="sessiontimeoutoverlay",this.YO.className="SessionTimeoutOverlay",this.YO.tabIndex=-1,this.Wqi(this.YO),this.tf.appendChild(this.YO)),this.j9c=!0,this.e0g(this.YO)):(this.WUf(this.YO),
this.YO&&this.YO.parentNode&&this.YO.parentNode.removeChild(this.YO),this.YO=null,this.j9c=!1))}Wqi(La){La&&(this.Rc.ub(J.a.click,La,Object(B.a)(this,this.cbb,"handleClickEvent")),this.Rc.ub(J.a.doubleClick,La,Object(B.a)(this,this.cbb,"handleClickEvent")),Bf.a("FixRehydrationOnKeyPress")?this.Vr.addHandler(La,J.a.Df,this.ehg):this.yR.ub(J.a.Df,La,Object(B.a)(this,this.ihg,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(B.a)(this,this.onVisibilityChange,"onVisibilityChange")))}WUf(La){La&&
(this.Rc.Bb(J.a.click,La,Object(B.a)(this,this.cbb,"handleClickEvent")),this.Rc.Bb(J.a.doubleClick,La,Object(B.a)(this,this.cbb,"handleClickEvent")),Bf.a("FixRehydrationOnKeyPress")?this.Vr.removeHandler(La,J.a.Df,this.ehg):this.yR.Bb(J.a.Df,La,Object(B.a)(this,this.ihg,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(B.a)(this,this.onVisibilityChange,"onVisibilityChange")))}cbb(){this.xWe(1);return!0}ihg(La){if(La.nc.ctrlKey||La.nc.altKey||La.nc.shiftKey||La.nc.keyCode>=F.a.cob&&
La.nc.keyCode<=F.a.uAa)return!1;this.xWe(2);return!0}onVisibilityChange(){e.AFrameworkApplication.zz&&!window.document.hidden&&this.Vfd&&this.Vfd.KZd(1)}dispose(){this.Mc.Mrh(Object(B.a)(this,this.sessionExpired,"sessionExpired"));this.YO&&(this.WUf(this.YO),this.YO.parentNode&&this.YO.parentNode.removeChild(this.YO));this.Vr=this.yR=this.Rc=null;this.j9c=!1;this.e0g=null}}Object(h.a)(lh,"SessionRehydrationController",null,[]);class ze{constructor(){this.Ea=null}Xb(La){this.Ea=La||t.a.instance}dispose(){}}
Object(h.a)(ze,"TellMePackage",null,[2,3]);var Je=d(117),Wh=d(145),Kg=d(29),pd=d(16),Nc=d(108),le=d(953);class Ye{constructor(La=null,lb=null,Ob=null,mc,Rc=null){this.WBd=null;this.Tcf=!1;this.jif=this.xob=null;this.t$h=this.Vuf=this.UWh=this.kif=!1;this.gAc=null;this.eXh=null==lb?e.AFrameworkApplication.Ktb:lb;this.f2h=null==Ob?e.AFrameworkApplication.KFa:Ob;this.O$h=null==Rc?e.AFrameworkApplication.vza:Rc;this.s1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");
this.Tai=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.Vul(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.Kai=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.$cc;this.Lai=!Nc.a.Fx()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.Jai=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.h0h=!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.mb.TOb;this.Mai=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.f$h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.v6h=this.nuc||this.muc;this.t6h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.u6h=this.Ype;this.E3h=!!e.AFrameworkApplication.fa&&this.Sza&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");
this.Q0h=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Y0h=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.N0h=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.B3h=
!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.l3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.T3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);
this.o2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.s$j||this.I3j);this.Mrb=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.eai=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.a1h=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.g$h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.C$h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.p$h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||this.gI;this.M3h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.i3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.z3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&"en-US"===e.AFrameworkApplication.uiCulture;this.J3h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.Z3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.WWh=
this.Sza&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.o1h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.H$h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==e.AFrameworkApplication.fa.Ha("Application"));
this.EXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Zbi=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled");this.q2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.u2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.X0h=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.L3h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.Kug;this.s2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.t2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.r2h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.E_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.F_h=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.D_h=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.BOc&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.Nai=this.y8j&&(this.ePe||this.fPe||this.boc||this.Sza&&Nc.a.P9()&&!!e.AFrameworkApplication.fa&&(this.$Ob||this.Xlb||this.Ylb||this.Zlb||this.aPb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));
this.xWh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.Tca;this.yWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.xRj(La||{});this.gPd="2918242107";this.fPd="1454393937";this.U5a={};this.uQa=[];this.QKi=[Nc.a.Iyd]}get application(){return this.xob}get Ktb(){return this.eXh}get Hkl(){return this.gPd}get Gkl(){return this.fPd}get $1f(){return this.jif}get $7i(){return this.kif}get KFa(){return this.f2h}get vza(){return this.O$h}get N7a(){return this.UWh}get fMj(){return this.s1h}get OJl(){return this.Tai}get y8j(){return!0}get DJl(){return this.Nai}get qxl(){return this.Vuf}Vul(La){this.Vuf=
La}get Sza(){return this.Kai}get awc(){return this.Lai}get Zvc(){return this.Jai}get T6i(){return this.h0h}get BJl(){return this.Mai}get l9e(){return!1}get boc(){return this.v6h}get ePe(){return this.t6h}get fPe(){return this.u6h}get wWa(){return!1}get m4c(){return!1}get Bre(){return this.E3h}get s3e(){return this.t$h}get $Ob(){return!1}get Byl(){return!1}get zbk(){return""}get Jce(){return 2}get ssj(){return 4}get tsj(){return 5}get Tuj(){return""}get okj(){return this.Q0h}get ndg(){return this.Y0h}get Vuj(){return 1E3}get Uuj(){return 1E-6}get cHl(){return this.eai}get k6e(){return!1}get bHl(){return!1}get d6j(){return this.z3h}get V3c(){return!1}get hre(){return!1}get C2j(){return!1}get B2j(){return!1}get Kug(){return!1}get Nug(){return!1}get a2f(){return!1}get UOb(){return!1}get Xlb(){return!1}get Ylb(){return!1}get Zlb(){return!1}get aPb(){return!1}get nuc(){return this.f$h}get VOb(){return this.g$h}get muc(){return!1}get Aae(){return null}get cre(){return!1}get Uud(){return this.p$h}get Lag(){return 0}get Bfj(){return this.N0h}get Sdg(){return this.a1h}get E7j(){return this.B3h}get Cne(){return this.o2h}get Tud(){return this.Mrb}get uag(){return-3.9}get gI(){return this.C$h}get adc(){return this.M3h}get dqe(){return this.i3h}get Ore(){return this.J3h}get eRa(){return this.WWh}get z$j(){return this.Z3h}get cea(){return this.o1h}get QFh(){return this.H$h}get zti(){return this.EXh}get fAd(){return this.Zbi}get g1c(){return this.q2h}get ZVj(){return this.u2h}get Hq(){return this.X0h}get xWa(){return this.L3h}get XVj(){return this.s2h}get YVj(){return this.t2h}get WVj(){return this.r2h}get PBf(){return this.xWh}get QBf(){return this.yWh}get Z3(){return this.E_h}get WRc(){return this.F_h}get Pwb(){return this.D_h}get s$j(){return this.T3h}get I3j(){return this.l3h}get Rp(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.mb.Qp}get Qp(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.Qp}get H2j(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.lza}get uCk(){return Fa.getImageClass("OfficeAssistant_32x32x32")}Akj(){return Promise.reject("GetFindMatchCount method is not overridden")}B4c(La){return Array.contains(appChrome.selectors.getVisibleControlIds(),La)}ooe(){return!1}get Vpe(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get BKh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ha("TellMeServiceHelpClassifierModelName"):""}get Ype(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get RZc(){return"NoOpHeaderUi"}get PKi(){return this.gAc}get parameterData(){return this.U5a}get mPl(){return this.uQa}R2i(){if(this.WBd&&!this.Tcf&&(this.Tcf=!0,this.iud(this.WBd),this.Qp)){var La=t.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");La=(new le.a(La)).w$d(this.WBd.zba);appChrome.api.dispatch(La)}}get dxh(){return""}iud(){}UWi(La){const lb=
[];for(let Ob=0;Ob<La.length;++Ob)La[Ob].kzl?lb.push(new pd.a(La[Ob].alternate,Nc.a.GNh+Ob.toString())):lb.push(new pd.a(La[Ob].standard,Nc.a.Iyd+Ob.toString()));return lb}xRj(La){const lb={};for(let Ob in La){const mc=Ob,Rc=La[Ob];for(let Ud in Rc){const ue=Ud,Xe=Rc[Ud];(lb[ue]||(lb[ue]={}))[mc]=Xe}}this.gAc=lb}get CKh(){return""}get dFh(){return!1}}Object(h.a)(Ye,"TellMeApplicationData",null,[940]);class Zc{constructor(La,lb=null,Ob=!1){this.standard=La;this.alternate=lb;this.kzl=Ob}}Object(h.a)(Zc,
"TryQuerySet",null,[]);class Jf{constructor(){this.ypf=this.zpf=null}get TAk(){return this.ypf}tL(La){this.zpf=La;return this.yPi(La)}gDk(){this.ypf=this.zpf}anj(La){return 8===La.type?String.format(CommonUIStrings.l_FindInDocumentText,La.hK):La.hK}pgj(La){return La.hK}}Object(h.a)(Jf,"ParameterizedCommand",null,[]);class pg extends Jf{constructor(La){super();this.j7j=La}get commandId(){return this.j7j?"FindParameterized":"EditingFind"}get yQk(){return"Find"}yPi(La){if(!La)return null;const lb=H.a.ze(String.format(ResourceStrings.l_ParamFindInDocTitle,
La.hK));return wa.a(Nc.a.bTi(La.value),"1540292897",lb,"Find_16x16x32",null,H.a.ze(La.hK),lb,null,null)}}Object(h.a)(pg,"FindParameterizedCommand",Jf,[]);var gd=d(125);class bd extends Ye{constructor(){super(window.TellMeControlMetadataOverrides);this.xob="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var La=[new Zc(ResourceStrings.l_TellMeTryQuery01,"",!1),new Zc(ResourceStrings.l_TellMeTryQuery02,"",!1),new Zc(ResourceStrings.l_TellMeTryQuery03,"",!1),new Zc(ResourceStrings.l_TellMeTryQuery04,
"",!1),new Zc(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.uQa=this.UWi(La)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(La=new pg(bd.i7j()),this.parameterData[La.commandId]=La,this.kif=!0,this.jif=La.commandId)}get wLa(){return gd.a.iIf}iud(La){if(La){La=La.zba;var lb=e.AFrameworkApplication.fa;La["PptTellMe.Animation"]=!lb.ka("TellMeAnimationsTransitionsIsEnabled")||lb.ka("241");La["PptTellMe.Transition"]=!lb.ka("TellMeAnimationsTransitionsIsEnabled");La["PptTellMe.SelectAll"]=
!lb.ka("TellMeSelectAllResultIsEnabled");La["PptTellMe.AnimationNew"]=!lb.ka("241")||!lb.ka("TellMeAnimationsTransitionsIsEnabled");La["PptTellMe.Designer"]=!lb.ka("248");lb=lb.ka("TellMeDesktopUpSellIsEnabled");var Ob=e.AFrameworkApplication.z8j;La["PptTellMe.WordArtUpSellButton"]=!lb||Ob;La["PptTellMe.SpellCheckDictUpSellButton"]=!lb||Ob;La["PptTellMe.InsertAudioUpSellButton"]=!lb||Ob;La["PptTellMe.InsertChartUpSellButton"]=!lb||Ob;La["PptTellMe.WordArtUpSellButtonEnterprise"]=!lb||!Ob;La["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=
!lb||!Ob;La["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!lb||!Ob;La["PptTellMe.InsertChartUpSellButtonEnterprise"]=!lb||!Ob}}get Kug(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get Nug(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get Lag(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",
2)}get CKh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get k6e(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",!1)}get BKh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get $Ob(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",
!1)}get Ype(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get Jce(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",0)}get dFh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get m4c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",
!1)}get Q7j(){return e.AFrameworkApplication.BOc&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSummarizeDeckInTellMe",!1)}get Aae(){const La={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?La.FontName="FontPicker":La.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(La.NewSlide="NewSlideSplit",La.ChangeLayout="ChangeLayoutFlyout"):(La.NewSlideSplit="NewSlide",La.ChangeLayoutFlyout="ChangeLayout");return La}get uag(){var La=
e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");La=parseFloat(La);return isNaN(La)?-3.9:La}get V3c(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get PBf(){return e.AFrameworkApplication.fa.ka("51")}get QBf(){return e.AFrameworkApplication.fa.ka("305")}static i7j(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.Rp}}Object(h.a)(bd,
"PowerPointTellMeApplicationData",Ye,[]);var Ne;(function(La){La[La.none=0]="none";La[La.waitAll=1]="waitAll";La[La.synchronizeFast=2]="synchronizeFast";La[La.synchronizeSlow=3]="synchronizeSlow"})(Ne||(Ne={}));Object(h.b)("ProviderSynchronizationType",Ne);var rf;(function(La){La[La.immediate=0]="immediate";La[La.waitAll=1]="waitAll";La[La.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";La[La.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(rf||(rf={}));Object(h.b)("MenuUpdatePolicy",
rf);var Fh=d(173),Ae=d(305),Kf=d(160),Mf=d(713),vf=d(174),eg=d(1016);class zf{constructor(La,lb,Ob){this.lq=La;this.jb=lb;this.ua=Ob}pE(){return"SummarizeSlidesProvider"}LL(){return this.lq.Jce?this.lq.Jce===rf.waitAll?Ne.waitAll:Ne.synchronizeSlow:Ne.none}IB(La,lb,Ob,mc,Rc=null){var Ud,ue,Xe,pe;const gg=new Fh.a(La);if(this.aG(La))if(null!=Rc&&0>Rc.indexOf(Ae.a.ActionAI))lb.resultsUpdated(gg);else{this.hIe="SummarizeDeckFromTellMe";if(1<(null===(ue=null===(Ud=this.jb)||void 0===Ud?void 0:Ud.Re())||
void 0===ue?void 0:ue.length))this.hIe="SummarizeSlidesFromTellMe";else if(null===(pe=null===(Xe=this.ua)||void 0===Xe?void 0:Xe.presentation)||void 0===pe||!pe.slides||2>this.ua.presentation.Gpa){lb.resultsUpdated(gg);return}appChrome&&appChrome.selectors.isControlDisabled(this.hIe)?lb.resultsUpdated(gg):(La=new Kf.a(this.hIe,Mf.a.SummarizeDeck,"","",eg.a.Local),Ob=new vf.a(Ae.a.SummarizeDeck),Ob.ys(La),gg.Bq(Ob),window.requestAnimationFrame(()=>{lb.resultsUpdated(gg)}))}else lb.resultsUpdated(gg)}aG(La){return!La||
!La.Ef||!La.Ef.trim().length}}Object(h.a)(zf,"SummarizeSlidesProvider",null,[909]);class Nd extends ze{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.wKh){var La=Kg.App.Mb.mb.uee(sb.a.tellMe);La.T1c?Nd.zih():La.sW(Object(B.a)(this,this.skl,"scriptResource_LoadFinished"));var lb=new bd;Je.TellMeActor.instance.initialize(lb,null,null,null,null,null,Object(B.a)(Kg.App.Mb,Kg.App.Mb.h4f,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,
this.Ea.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Ea.Ia("Common.IActionContextProvider"),this.Ea.Ia("Common.ISystemInitiatedFeedback"));Je.TellMeActor.instance.S6k(La);La=e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("822");lb.Q7j&&La&&Je.TellMeActor.instance.kz(new zf(lb,this.Ea.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Ea.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),Wh.a.tellMe)}}skl(){Nd.zih()}static zih(){Kg.App.Mb.updateCommandUI()}}
Object(h.a)(Nd,"PowerPointTellMePackage",ze,[]);var Se=d(215),Qe=d(193);class Ei{constructor(){this.jh=this.G5=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Xb(La){this.K=La;this.G5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.G5.WEa(4,this.name);this.K.register(re,"PowerPointWebEditor.RehydrationHeaderHandler").na().oa(()=>new re(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.K.register(lh,"PowerPointWebEditor.SessionRehydrationController").na().oa(()=>new lh(this.K.resolve("Box4.IAppFrame").UF(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
lb=>{z.FocusManager.Zq(lb)},e.AFrameworkApplication.zz?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(859,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").na().oa(()=>new tf(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),
this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ia("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.zz&&this.K.register(860,"PowerPointWebEditor.IPPTTokenRefreshManager").na().oa(()=>
new gf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let La=this.jh.du("resolvechronos1");const lb=this.K.resolve("Common.AFrameworkApplication"),Ob=
this.K.resolve("PowerPointWebEditor.IApplicationContext").rd;var mc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Rc=this.K.resolve("Common.IActionManagerExtended"),Ud=this.K.resolve("PowerPointWebEditor.IFocusManager"),ue=this.K.resolve("Common.Transaction.ITransactionFactory"),Xe=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),pe=this.K.resolve("PowerPointWebEditor.IShapeEditor"),gg=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
cg=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Sg=this.K.resolve("PowerPointWebEditor.PictureContext"),Hh=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),li=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Oh=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.jh.lu(La);La=this.jh.du("regactorschronos1");mc=[new mg(Rc,gg,Xe,Ud,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ue,Oh,Sg,pe,e.AFrameworkApplication.dR,li,this.K.resolve("PowerPointWebEditor.IErrorHandler"),
mc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Ob.J0j,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),Hh,cg,Ob,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Common.IAppSettingsManager"))];for(var Wi of mc)Wi.vb(),Wi.me();this.jRj();this.jh.lu(La);La=this.jh.du("tellme");Wi=new Nd;Wi.Xb(this.K);Wi.load(lb);this.jh.lu(La);Ob.pptEditorTimeoutDialogRemovalIsEnabled&&
Ob.yg&&(La=this.jh.du("initrehydrationcontroller"),this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.jh.lu(La));Ob.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.zz&&(La=this.jh.du("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.jh.lu(La));this.zck()}jRj(){const La=this.K.resolve("Common.IActionManagerExtended"),lb=this.K.resolve("PowerPointWebEditor.IFocusManager"),
Ob=this.K.resolve("Common.AFrameworkApplication").To.Ld,mc=this.K.resolve("Common.Transaction.ITransactionFactory"),Rc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Ud=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),ue=this.K.resolve("PowerPoint.IPathManager"),Xe=this.K.resolve("PowerPointWebEditor.IPresentationReader"),pe=Qe.a(this.K);pe("powerpoint-editor-intl").then(()=>{ee.a.J(512497373,801,50,"Editor script is loaded successfully");pe("powerpoint-ribbon-intl").then(()=>
{ee.a.J(512497372,801,50,"Ribbon script is loaded successfully");const gg=[];gg.push(new wc(La,lb,Ud,mc,Ob,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Xe,Rc,ue));for(const cg of gg)cg.vb(),cg.me()}).catch(()=>{ee.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{ee.a.J(512497370,801,10,"Failed to load Editor script")})}zck(){ee.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.chronos2",
()=>{const La=this.K.resolve("PowerPointWebEditor.ISessionState");La&&La.A6("Chronos2DownloadFinished")},()=>d.e(6).then(d.bind(null,1295)))}dispose(){const La=this.K.resolve("PowerPointWebEditor.IApplicationSettings");La.pptEditorTimeoutDialogRemovalIsEnabled&&La.yg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.zz&&La.yg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Yg&&dc.a.mg?
ee.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):r.a.instance.Ac(Se.a(new Ei,4))}}Object(h.a)(Ei,"Chronos1Package",null,[2,3]);var Ff=d(659),Jh=d(143),Wf=d(591),md=d(59),Gf=d(48);class Hd{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg,cg){this.type="FormatPictureTaskPaneProps";this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.isPicturePropertiesInactive=this.isCropInactive=!1;this.onChange=null;
this.emptyValueFields=0;this.onSectionToggle=this.formatPictureSections=null;const Sg=Object(Rb.a)(Object,vb.e().numberFormatInfo);if(!Sg)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=Sg;this.width=La;this.height=lb;this.top=mc;this.left=Ob;this.brightness=Rc;this.contrast=Ud;this.saturation=ue;this.isCropInactive=Xe;this.isPicturePropertiesInactive=pe;this.emptyValueFields=gg;this.formatPictureSections=cg}}Object(h.a)(Hd,"FormatPictureTaskPaneProps",null,[]);const Ee=ResourceStrings.L_PictureProperties,
Ki=ResourceStrings.L_CropPicture;class wf{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg,cg,Sg,Hh){this.QCe=this.aCe=!0;this.mCg=this.RAg=this.h3g=this.mOg=this.X0=this.u1=0;this.A_g=100;this.eZa=this.Ab=this.VEg=!1;this.Wva=new Map([[Ee,!1],[Ki,!1]]);this.onSectionToggle=(li,Oh)=>{this.Wva.forEach((Wi,Xi)=>this.Wva.set(Xi,Xi===li?Oh:!1));this.LPh();this.kl(!0)};Hh("powerpoint-editor-intl").then(()=>{this.eZa=!0}).catch(li=>{ee.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+li.toString())});
this.jb=La;this.Rb=lb;this.ia=Ob;this.Fa=mc;this.Rf=Rc;this.ua=Ud;this.Eb=ue;this.oi=Xe;this.i$=pe;this.fc=gg;this.Fc=cg;if(!Sg)throw Error.argumentNull("appSettings");this.la=Sg;this.Rf.zCa(Object(B.a)(this,this.ijd,"onChangeRenderFormatPicturePane"));this.Rb.MI(Object(B.a)(this,this.Eu,"onAppFrameModeSwitched"));this.Fc.SQa(Object(B.a)(this,this.ijd,"onChangeRenderFormatPicturePane"))}dispose(){this.Rf.G0a(Object(B.a)(this,this.ijd,"onChangeRenderFormatPicturePane"));this.Rb.WY(Object(B.a)(this,
this.Eu,"onAppFrameModeSwitched"));this.Fc.pkb(Object(B.a)(this,this.ijd,"onChangeRenderFormatPicturePane"))}me(){}vb(){this.ia.ra(be.a.GLb,Ue.a.application,Object(B.a)(this,this.GLb,"queryShowHideReactPictureCropPane"),96);this.ia.ra(be.a.Juc,Ue.a.application,Object(B.a)(this,this.Juc,"showHideReactPictureCropPane"),4);this.ia.ra(be.a.$2a,Ue.a.application,Object(B.a)(this,this.$2a,"updatePictureCropPane"),4)}GLb(La,lb,Ob,mc,Rc){(La=Object(Rb.a)(qf.a,Rc))&&La.If(this.Ab);return 32}Juc(La,lb,Ob,mc,
Rc){if(!this.eZa)return 8;if(1===Ob)return 32;lb=this.ua.presentation;if(!this.ua.Ba||!lb||this.fc.fd(lb))return 16;this.mrl(Rc);return kd.b("ShowHideReactPictureCropPane:",this.Ab.toString(),La,()=>{if(this.Ab=!this.Ab){if(this.kl(),!this.la.Exb&&Bf.a("CropControlEnableOnDisplayingFormatPicturePane")){const Ud=this.jb.Ll();(null===Ud||void 0===Ud?0:Ud.Lv)||this.ia.processAction(be.a.GPc,2)}}else this.Kq();return 32})}mrl(La){null!=La&&"FormatPicture"===La.SourceControlId?(this.Wva.set(Ee,!0),this.Wva.set(Ki,
!1)):(this.Wva.set(Ki,!0),this.Wva.set(Ee,!1))}$2a(La,lb,Ob,mc,Rc){if(!this.Ab)return 8;if(2===Ob)if(this.la.Exb)this.onSectionToggle(Rc.nNb,Rc.o2l);else this.kl(!0);return 32}kl(La=!1){var lb=this.TXc();lb=this.kA(lb);const Ob=Object.assign(new Ff.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:lb,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Jh.UISurfaces.Iq().then(mc=>{La?mc.updateTaskPane(Gf.a.sKa,Ob):mc.showTaskPane(Gf.a.sKa,Ob);return null}).catch(mc=>
{ee.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+mc.toString())})}Kq(){Jh.UISurfaces.Iq().then(La=>{La.hideTaskPane(Gf.a.sKa,2);return null}).catch(La=>{ee.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+La.toString())})}kA(La){var lb=null;if(La){lb=La.Dae();const Ob=this.Eb.Nd;this.X0=Wf.a.$v(Ob.gf(this.oi.cI(md.a.Ql(lb.ga(0),lb.ga(3)),La.zoom),1));this.u1=Wf.a.$v(Ob.gf(this.oi.cI(md.a.Ql(lb.ga(0),lb.ga(1)),La.zoom),0));this.mOg=Wf.a.$v(Ob.gf(this.oi.cI(lb.ga(0).x,
La.zoom),0));this.h3g=Wf.a.$v(Ob.gf(this.oi.cI(lb.ga(0).y,La.zoom),1));this.aCe=!1;this.VEg=!0}else this.aCe=!0;La=this.VEg?0:15;this.la.Exb&&(this.QCe=!1,this.s3c()||(this.Wva.forEach((Ob,mc)=>this.Wva.set(mc,!1)),La=15,this.QCe=!0));lb=new Hd(this.u1,this.X0,this.mOg,this.h3g,this.RAg,this.mCg,this.A_g,this.aCe,this.QCe,La,this.Wva);lb.onChange=Object(B.a)(this,this.Lxa,"onPropertyChange");lb.onSectionToggle=this.onSectionToggle;return lb}TXc(){const La=this.jb.Ll();return La&&La.Lv&&La.isConnected?
this.i$.hJ(La):null}s3c(){const La=this.jb.Ud(),lb=this.jb.rWc(La);return 1==La.length&&(null===lb||void 0===lb?void 0:lb.tj)}Lxa(La,lb){const Ob={};Ob.Number=La;switch(lb){case 0:this.ia.Ja(be.a.Kzd,2,Ob);break;case 1:this.ia.Ja(be.a.Hzd,2,Ob);break;case 2:this.ia.Ja(be.a.Izd,2,Ob);break;case 3:this.ia.Ja(be.a.Jzd,2,Ob);break;case 4:this.ia.Ja(be.a.wPh,2,Ob);this.RAg=La;break;case 5:this.ia.Ja(be.a.KPh,2,Ob);this.mCg=La;break;case 6:this.ia.Ja(be.a.jRh,2,Ob),this.A_g=La}this.kl(!0)}rk(La){return La?
La.qc(this.Eb.Na):null}LPh(){var La=this.jb.Ll();this.Wva.get(Ki)?Bf.a("CropControlEnableOnDisplayingFormatPicturePane")&&La&&((null===La||void 0===La?0:La.Lv)||this.ia.processAction(be.a.GPc,2)):(La=this.rk(La))&&La.cZ(!1)}ijd(){this.Ab&&(this.la.Exb&&this.LPh(),this.kl(!0))}Eu(La){1===La.mode&&this.Ab&&(this.Ab=!1,this.Kq(),this.Fa.wj(Gf.a.sKa,this.Ab))}}Object(h.a)(wf,"FormatPicturePaneActor",null,[]);var ag=d(874);class Og{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg,cg,Sg,Hh,li,Oh,Wi,Xi,Fi){this.QEb=
!1;if(!Oh)throw Error.argumentNull("shapeReader");if(Wi&&!Xi)throw Error.argumentNull("shapeSVGDependencyLoader");if(!Fi)throw Error.argumentNull("businessBarController");this.ia=La;this.pa=lb;this.Fb=Ob;this.ei=mc;this.fc=Rc;this.PCe=Ud;this.xJg=ue;this.Zo=Xe;this.Eb=pe;this.ua=gg;this.oi=cg;this.i$=Sg;this.uM=Hh;this.Z0=li;this.Ga=Oh;this.mna=Wi;this.jZa=Xi;this.wl=Fi}vb(){this.ia.ra(be.a.GPc,N.a.application,Object(B.a)(this,this.T9b,"handlePictureCropEvent"),4);this.xJg?(this.ia.ra(be.a.Z2d,N.a.application,
Object(B.a)(this,this.Hgg,"handleCropSplitButton"),4),this.ia.ra(be.a.$2d,N.a.application,Object(B.a)(this,this.Hgg,"handleCropSplitButton"),4)):(this.ia.ra(be.a.Z2d,N.a.application,Object(B.a)(this,this.T9b,"handlePictureCropEvent"),4),this.ia.ra(be.a.$2d,N.a.application,Object(B.a)(this,this.T9b,"handlePictureCropEvent"),4));this.ia.ra(be.a.VTe,N.a.application,Object(B.a)(this,this.w_k,"queryIsActive"),101);this.ia.ra(be.a.gtc,N.a.application,Object(B.a)(this,this.XIj,"handleSendCropInfo"),4);this.ia.ra(be.a.fih,
N.a.application,Object(B.a)(this,this.Lge,"handlePictureCropToShapeEvent"),4);this.ia.ra(be.a.eih,N.a.application,Object(B.a)(this,this.Lge,"handlePictureCropToShapeEvent"),4);this.ia.ra(be.a.lLb,N.a.application,Object(B.a)(this,this.god,"queryPictureCropBounding"),100);this.ia.ra(be.a.nLb,N.a.application,Object(B.a)(this,this.god,"queryPictureCropBounding"),100);this.ia.ra(be.a.mLb,N.a.application,Object(B.a)(this,this.god,"queryPictureCropBounding"),100);this.ia.ra(be.a.sqc,N.a.application,Object(B.a)(this,
this.god,"queryPictureCropBounding"),100);this.ia.ra(be.a.Hzd,N.a.application,Object(B.a)(this,this.Gzd,"updatePictureCropBounding"),4);this.ia.ra(be.a.Kzd,N.a.application,Object(B.a)(this,this.Gzd,"updatePictureCropBounding"),4);this.ia.ra(be.a.Izd,N.a.application,Object(B.a)(this,this.Gzd,"updatePictureCropBounding"),4);this.ia.ra(be.a.Jzd,N.a.application,Object(B.a)(this,this.Gzd,"updatePictureCropBounding"),4)}Hgg(La,lb,Ob,mc,Rc){return 1===Ob?32===this.Lge(La,lb,Ob,mc,Rc)||32===this.T9b(La,lb,
Ob,mc,Rc)?32:8:this.T9b(La,lb,Ob,mc,Rc)}XIj(La,lb,Ob,mc,Rc){if(!Rc)return ee.a.J(512500482,824,50,"Send Crop Info called with no cropping info"),8;lb=Rc.pictCropperInfo;Rc=Rc.shapeNode;if(!Rc||!Rc.pictureCropInfo)return ee.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Ob)return 32;if(Ob=fe.a.Kb)Ob.actionName="EndCropPicture",Ob.Qj=!1,Ob.$p=!0;Ob=this.Fb.yd(15);try{Ob.jc(Rc),Ob.gd=La,Rc.Roc=lb}finally{Ob&&Ob.dispose()}return 32}Lge(La,lb,Ob,mc,Rc){if(!this.xJg||this.fc.fd(this.pa.Fk()))return 8;
lb=this.pa.Qf();if(!lb||!lb.length)return 8;const Ud=[];for(var ue of lb)ue&&Ud.push(ue);if(!Ud.length)return 8;for(const gg of Ud)if(gg.isLocal||this.uM.pX(gg)||!this.r4j(gg))return 8;if(1===Ob)return 32;ee.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Xe=Rc?Rc.SourceControlId:"";ue=0;Ob=Xe.split("_");if(3===Ob.length)ue=Number.parseInvariant(Ob[2]);else return ee.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",
Xe),16;Ob=window.performance.now();Rc=new ag.a;Rc.TargetShapeTypeAsInt=ue;ue=this.Fb.yd(15,void 0,()=>{for(const gg of Ud)if(gg.Lv){const cg=this.rk(gg);cg&&cg.cZ(!1)}ee.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Xe)});try{ue.jc(Ud[0]);ue.gd=La;for(var pe of Ud)pe.Soc=Rc}finally{ue&&ue.dispose()}La=window.performance.now();if(pe=fe.a.Kb)pe.actionName="PictureCropToShape",pe.Wa("PictureCropShapeType",Rc.TargetShapeTypeAsInt.toString()),
pe.Wa("PictureCropToShapeDuration",(La-Ob).toString()),fe.a.Naa(pe);ee.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Rc.TargetShapeTypeAsInt);return 32}T9b(La,lb,Ob){if(!this.PCe||this.fc.fd(this.pa.Fk()))return 16;if(this.mna&&!this.jZa.urg)return ee.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;lb=this.pa.Ud();const mc=this.pa.rWc(lb);if(1!==lb.length)return Bf.a("CropCannotBePerformedOnCurrentSelection")&&
1!==Ob&&this.jWf(),8;if(!mc)return 8;if(this.Ga.yx(mc).length)return Bf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Ob&&this.jWf(),8;if(!this.wqe(mc))return 8;if(1===Ob)return 32;if(mc.isLocal||this.uM.pX(mc))return 16;if(mc.Lv){La=this.rk(mc);if(!La)return 8;La.cZ(!1);mc.pictureCropInfo=null;Kg.App.Mb.updateCommandUI();this.$2a(null===mc||void 0===mc?void 0:mc.Lv);return 32}this.pa.nj();const Rc=this.ua.Ba;this.fc.blockContent(Rc,La);const Ud=fe.a.Kb;Ud&&(Ud.actionName="BeginCropPicture",Ud.Qj=
!1,Ud.$p=!0);this.ei.pbg(mc.get_sid(),mc.get_cid(),mc.get_shapeId(),ue=>{fe.a.qy(Ud,()=>{this.SHk(mc,Rc,ue)})},()=>this.RHk(mc,Rc),!0);return 32}w_k(La,lb,Ob,mc,Rc){if(!Object(pc.a)(qf.a,Rc))return 8;La=this.pa.Ll();Rc.If(La?La.Lv:!1);return 32}TXc(){const La=this.pa.Ll();return La&&La.Lv&&La.isConnected?this.i$.hJ(La):null}rk(La){return La?Object(Rb.a)(117,La.qc(this.Eb.Na)):null}jWf(){this.wl.wL(26)}god(La,lb,Ob,mc,Rc){if(!this.PCe||!Rc)return 16;lb=this.TXc();if(!lb)return 16;Ob=lb.Dae();mc=this.Eb.Nd;
La=La===be.a.lLb?mc.gf(this.oi.cI(md.a.Ql(Ob.ga(0),Ob.ga(3)),lb.zoom),1):La===be.a.nLb?mc.gf(this.oi.cI(md.a.Ql(Ob.ga(0),Ob.ga(1)),lb.zoom),0):La===be.a.mLb?mc.gf(this.oi.cI(Ob.ga(0).x,lb.zoom),0):mc.gf(this.oi.cI(Ob.ga(0).y,lb.zoom),1);Rc=Rc.queryResult;null!==Rc&&(Rc.nba=parseFloat(Wf.a.$v(La).toFixed(2)).toString());return 32}Gzd(La,lb,Ob,mc,Rc){if(!this.PCe||this.mna&&!this.jZa.urg)return 16;lb=this.TXc();if(1===Ob)return lb?32:16;if(!lb||!Rc)return 16;if(2===Ob){Ob=!1;mc=lb.Dae().copy();Rc=Wf.a.iX(Rc.Number);
const Ud=md.a.Ql(mc.ga(0),mc.ga(1)),ue=md.a.Ql(mc.ga(0),mc.ga(3)),Xe=this.Eb.Nd;La===be.a.Hzd?(Rc=this.oi.tK(Xe.Pe(Rc,1),lb.zoom),La=Rc-ue,mc.ga(2).NM(0,La),mc.ga(3).NM(0,La)):La===be.a.Kzd?(Rc=this.oi.tK(Xe.Pe(Rc,0),lb.zoom),La=Rc-Ud,mc.ga(1).NM(La,0),mc.ga(2).NM(La,0)):La===be.a.Izd?(Ob=!0,Rc=this.oi.tK(Xe.Pe(Rc,0),lb.zoom),La=Rc-mc.ga(0).x,mc.move(La,0)):La===be.a.Jzd&&(Ob=!0,Rc=this.oi.tK(Xe.Pe(Rc,1),lb.zoom),La=Rc-mc.ga(0).y,mc.move(0,La));lb.xSl(mc,Ob)}return 32}r4j(La){let lb=[];La.Of?lb=this.Ga.yx(La):
La.Ug&&(lb=this.Ga.yx(La.Fs()));if(lb.length){for(const Ob of lb)if(!this.wqe(Ob))return!1;return!0}return this.wqe(La)}wqe(La){const lb=this.Zo.u6e&&!La.isGif&&(La.tj||1===La.mediaType)&&!La.get_isSVGBlipFilled();return this.Z0?lb&&!La.LIb:lb}RHk(La,lb){this.fc.zK(lb);if(!this.isActive||!La.isConnected)return!0;this.isActive=!1;La.pictureCropInfo=null;ee.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}SHk(La,lb,Ob){this.fc.zK(lb);if(La.isConnected)if(lb=
fe.a.Kb,fe.a.qy(lb,()=>{this.ia.processAction(be.a.N8a,2)}),this.uM.pX(La))ee.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var mc=La.rg(this.Eb.Na);if(mc){var Rc=new Date;La.pictureCropInfo=JSON.parse(Ob.PictureCropInfoStr);this.i$.dJ(La).pFl();Ob=new Date;lb&&(lb.zm("ParseCropInfoStart",Rc),lb.zm("ParseCropInfoEnd",Ob),fe.a.Naa(lb));mc.dB();this.$2a(null===La||void 0===La?void 0:La.Lv)}}}$2a(La){this.ia.Ja(be.a.$2a,2,{["sectionName"]:"Crop",["sectionNewState"]:La})}get isActive(){return this.QEb}set isActive(La){this.QEb=
La}}Object(h.a)(Og,"PictureCropActor",null,[]);var Kh=d(1261),Xg=d(200),Yd=d(181),ce=d(221),Rh=d(133),ng=d(165),Vi=d(387),$h=d(873),fg=d(636),dk=d(49),xi=d(68),yh=d(741),Lg=d(124),yi=d(214),Vd=d(167),lf=d(907),Zj=d(334),Cj=d(213),he=d(191),ij=d(192),Rf=d(283);class zh{constructor(La,lb,Ob,mc,Rc,Ud,ue,Xe,pe,gg,cg,Sg,Hh,li){this.Ab=!0;this.Tk=!1;this.Tn=[];this.l5=this.MB=this.NX=this.QH=this.OJ=this.yb=null;this.sD=Array(8);this.awa=this.rm=this.Sv=null;this.PU=this.nd=1;this.CHe=new md.a(0,0);this.Wn=
new Xg.a;this.HR=new Yd.a;this.Lkc=new md.a(0,0);this.ghb=0;this.Zr=new Yd.a;this.pwa=new md.a(0,0);this.fna=new md.a(0,0);this.glc=this.JHa=!1;this.aic=new md.a(0,0);this.maa=this.N$=null;this.hEg=new zc.a;this.Bu=null;if(!mc)throw Error.argumentNull("clickInputManager");if(!La)throw Error.argumentNull("shapeNode");if(cg&&!Sg)throw Error.argumentNull("transformFactory");if(cg&&!Hh)throw Error.argumentNull("presReader");this.ta=La;this.Ga=lb;this.lc=Ob;this.Rc=mc;this.ia=Rc;this.vD=Ud;this.$d=ue;
this.o$=Xe;this.Ttk=pe;this.Cwa=gg;this.mna=cg;this.Lk=Sg;this.ulk=li}Bm(La){this.yb=new he.a;this.yb.ek(1);this.yb.Sd(!1);this.yb.opa(xi.a.LGl);La.appendChild(this.yb.viewport);this.OJ=new yh.a(!1,this.mna);this.yb.appendChild(this.OJ);this.QH=new yh.a(!1,this.mna);this.yb.appendChild(this.QH);this.QH.ek(1);this.NX=new Vd.a;this.NX.fv(Fd.a.h2);this.NX.xr(Fd.a.hF);this.NX.dF(Lg.a.none);this.NX.ek(1);this.yb.appendChild(this.NX);this.l5=new Vd.a;this.l5.ek(1);this.l5.Bl(xi.a.Bza);this.l5.opa("ShapeMoveHandle");
this.l5.dF(Lg.a.none);this.yb.appendChild(this.l5);this.MB=new yi.a;this.Q3b(this.MB);this.yb.appendChild(this.MB);this.yb.viewport.xa.setAttribute("class",xi.a.Woc);this.yb.Sd(!1);this.Rc.ub(J.a.click,this.l5.xa,Object(B.a)(this,this.wid,"noOpHandler"));this.Rc.ub(J.a.click,this.NX.xa,Object(B.a)(this,this.wid,"noOpHandler"))}Q3b(La){for(let mc=0;8>mc;++mc){var lb="cropHandle"+mc;const Rc=new yi.a;Rc.xa.id=lb;if(dc.a.wMa){var Ob=new Zj.a;Ob.xa.id=lb;Ob.setVisibility(!1);Ob.setPosition(-10,-10);Ob.ah(20,
20);Rc.appendChild(Ob)}Ob=new ng.a(mc);lb=Ob.hbc()?this.xNi(Ob,lb):this.ERi(Ob,lb);Rc.appendChild(lb);Rc.ek(1);this.sD[mc]=Rc;La.appendChild(Rc)}}wie(La){for(let lb=0;8>lb;++lb)if(this.sD[lb].xa.id===La.id)return new ng.a(lb);return null}P5j(La){return La.id.startsWith("cropHandle")}dispose(){this.o$();this.Tk=!0;this.Ab=!1;this.yb&&this.yb.Eq();this.yb=null;this.l5&&this.Rc.Bb(J.a.click,this.l5.xa,Object(B.a)(this,this.wid,"noOpHandler"));this.l5=null;this.NX&&this.Rc.Bb(J.a.click,this.NX.xa,Object(B.a)(this,
this.wid,"noOpHandler"));this.MB=this.NX=null;this.sD&&Array.clear(this.sD);this.N$=this.maa=this.sD=null;this.aic=new md.a(0,0)}Iud(La,lb,Ob,mc){const Rc=this.qee(),Ud=La-Rc.x+this.fna.x+Ob,ue=lb-Rc.y+this.fna.y+mc;return isNaN(Ud)||isNaN(ue)?(ee.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",La,Rc.x,this.fna.x,Ob,lb,Rc.y,this.fna.y,
mc,this.nd),new md.a(0,0)):new md.a(Ud,ue)}setPosition(La,lb){this.JHa&&this.ta.pictureCropInfo&&(this.pwa=La=new md.a(La/this.nd,lb/this.nd),this.Cwa?(this.N$&&this.OJ&&(lb=this.Iud(this.N$.Position.X,this.N$.Position.Y,La.x,La.y),this.OJ.setPosition(lb.x,lb.y)),this.maa&&this.QH&&this.QH.image&&(La=this.Iud(this.maa.Position.X,this.maa.Position.Y,La.x,La.y),this.QH.image.setPosition(La.x,La.y))):((lb=this.ta.pictureCropInfo.MaskViewElem)&&this.OJ&&(lb=this.Iud(lb.Position.X,lb.Position.Y,La.x,La.y),
this.OJ.setPosition(lb.x,lb.y)),(lb=this.ta.pictureCropInfo.TextureViewElem)&&this.QH&&this.QH.image&&(La=this.Iud(lb.Position.X,lb.Position.Y,La.x,La.y),this.QH.image.setPosition(La.x,La.y))),this.yb.em())}ZDl(La,lb){const Ob=new md.a(this.Ga.CB(this.ta,this.vD).x/this.nd,this.Ga.CB(this.ta,this.vD).y/this.nd),mc=new md.a(this.fna.x+this.pwa.x,this.fna.y+this.pwa.y);if(this.Cwa)this.N$&&this.OJ&&this.OJ.setPosition(this.N$.Position.X-Ob.x+mc.x+La/this.nd,this.N$.Position.Y-Ob.y+mc.y+lb/this.nd),
this.maa&&this.QH&&this.QH.image.setPosition(this.maa.Position.X-Ob.x+mc.x+La/this.nd,this.maa.Position.Y-Ob.y+mc.y+lb/this.nd);else{var Rc=this.ta.pictureCropInfo.MaskViewElem;Rc&&this.OJ.setPosition(Rc.Position.X-Ob.x+mc.x+La/this.nd,Rc.Position.Y-Ob.y+mc.y+lb/this.nd);(Rc=this.ta.pictureCropInfo.TextureViewElem)&&this.QH.image.setPosition(Rc.Position.X-Ob.x+mc.x+La/this.nd,Rc.Position.Y-Ob.y+mc.y+lb/this.nd)}this.yb.em()}$Dl(La,lb){lb.Kj(1/this.PU);this.qBh(La,Xg.a.add(this.k_a,lb))}resize(La,
lb){lb.Kj(1/this.PU);this.qBh(La,lb)}qBh(La,lb){La=this.dYd(La,lb);this.wq(La);this.setOffsets(lb)}qee(){const La=this.Ga.CB(this.ta,this.vD);return new md.a(La.x/this.nd,La.y/this.nd)}xRh(){this.ta.Lv&&(this.PU=this.lc.jg(this.ta).Xp/this.CHe.x)}pFl(){const La=this.lc.jg(this.ta);this.CHe.update(La.Xp,La.Xk)}Kj(La){this.nd=La;this.yb.Kj(this.nd);La=new Yd.a;La.Pca(1/this.nd,1/this.nd);this.MB.fF(La,Cj.a.Zca);this.ulk?this.SY(!1):this.SY(!0)}get zoom(){return this.nd/this.PU}Dae(){this.xRh();this.Sv||
(this.Sv=this.ta.Nn);var La=md.a.Ql(this.Sv.ga(0),this.Sv.ga(1));const lb=md.a.Ql(this.Sv.ga(0),this.Sv.ga(3)),Ob=this.Sv.Zf(),mc=new Rh.a(new md.a(0,0),new md.a(La,0),new md.a(La,lb),new md.a(0,lb));mc.move(Ob.x-La/2,Ob.y-lb/2);La=this.qee();mc.move(La.x,La.y);mc.scale(this.PU,this.PU);return mc}xSl(La,lb){La=La.copy();La.scale(1/this.PU,1/this.PU);var Ob=this.qee();La.move(-1*Ob.x,-1*Ob.y);Ob=La.Zf();const mc=new Yd.a;lb?mc.m8(this.ta.get_shapeRotation(),Ob):mc.m8(this.ta.get_shapeRotation(),this.Sv.ga(0));
mc.ql(La);lb||La.move(this.Sv.ga(0).x-La.ga(0).x,this.Sv.ga(0).y-La.ga(0).y);this.Sv=La;this.NX.Mt(this.Sv.points);lb=this.QH.clipPath;Bf.a("SVGCreationOnChangesFromFormatPane")&&this.mna&&lb?(lb.y2b=this.vPc(La),this.IJc(La.ga(0))):lb&&lb.E8a&&lb.E8a.qaf(this.Sv.points);this.glc=!0;this.SY(!0);this.yb.em()}setZIndex(La){this.yb.lC(La+2*Vi.a.Bha)}setOffsets(La){this.Sv||(this.Sv=this.ta.Nn);this.Emi(La);this.Wn=La;var lb=this.MB.DDb;La=new md.a(lb[0].x/this.nd,lb[0].y/this.nd);var Ob=new md.a(lb[2].x/
this.nd,lb[2].y/this.nd);const mc=new md.a(lb[4].x/this.nd,lb[4].y/this.nd);lb=new md.a(lb[6].x/this.nd,lb[6].y/this.nd);La=new Rh.a(La,Ob,mc,lb);this.NX.Mt(this.Sv.points);Ob=this.QH.clipPath;this.mna&&Ob?(this.IJc(md.a.xV(La.points[this.ghb],this.Lkc)),Ob.y2b=this.vPc(La)):Ob&&Ob.E8a&&Ob.E8a.qaf(La.points);this.yb.em()}Emi(La){var lb=this.Sv,Ob=md.a.Ql(lb.ga(0),lb.ga(1));lb=md.a.Ql(lb.ga(0),lb.ga(3));La.bottom-La.top<-1*lb&&(lb+=La.bottom-La.top,La.top+=lb,La.bottom-=lb);La.right-La.left<-1*Ob&&
(Ob+=La.right-La.left,La.left+=Ob,La.right-=Ob)}wq(La){this.HR=La;this.NX.fF(La,Cj.a.Zca);this.SY(!0)}Ju(La){this.Zr=La;this.yb.fF(La,Cj.a.uub);this.yb.em()}ny(){Array.clear(this.Tn)}ZC(La){return this.P5j(La)?this.wie(La):null}TA(La){const lb=[];var Ob=this.ta.pictureCropInfo;if(this.ta.Lv){const mc=this.lc.jg(this.ta);if(Ob.MaskViewElem){let Rc=Rf.a.tPc(6,mc.Xp,mc.Xk);Array.add(lb,Rc)}Ob.TextureViewElem&&(Ob=Rf.a.tPc(7,mc.Xp,mc.Xk),Array.add(lb,Ob));Array.add(this.Tn,La)}else this.Ab=!1,this.yb.Sd(!1);
return lb}kC(){}XVl(){this.aic.x!==this.OJ.x&&this.aic.y!==this.OJ.y&&(ee.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),this.N$.Position.X=this.OJ.x+this.Ga.CB(this.ta,this.vD).x/this.nd,this.N$.Position.Y=this.OJ.y+this.Ga.CB(this.ta,this.vD).y/this.nd,this.maa.Position.X=this.QH.image.x+this.Ga.CB(this.ta,this.vD).x/this.nd,this.maa.Position.Y=this.QH.image.y+this.Ga.CB(this.ta,this.vD).y/this.nd,this.fna.update(0,
0))}n1b(La,lb){const Ob=this.Lk.CPc();this.ta.get_isVerticallyFlipped()&&(Ob.Pca(1,-1),Ob.DC(0,2*lb._y));this.ta.get_isHorizontallyFlipped()&&(Ob.Pca(-1,1),Ob.DC(2*lb._x,0));Ob.m8(La,lb);return Ob}Fdg(){return this.ta.get_isVerticallyFlipped()&&this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}IJc(La){const lb=new Yd.a;lb.DC(La._x,La._y);this.QH.clipPath.fF(lb,Cj.a.Zca)}vPc(La){ee.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");
var lb=this.ta.get_shapeRotation();this.Lk.qda(-lb,La.Zf()).ql(La);this.Bu||(this.Bu=svgShape.FactoryGlobal.createShape());this.Bu.setSVGRoot(this.yb.xa,!1);this.ta.mL?this.Bu.setShapeType(this.ta.mL):(this.Bu.setShapeType(4),ee.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.Bu.setOffsets(this.ta.get_xPersisted()+Kh.a.RY(La.ga(0).x/this.PU,0),this.ta.get_yPersisted()+Kh.a.RY(La.ga(0).y/this.PU,1));this.Bu.setExtents(Kh.a.RY(La.ga(1).x-La.ga(0).x,0),Kh.a.RY(La.ga(2).y-La.ga(1).y,1));
var Ob=svgShape.FactoryGlobal.getConvertor().getPath(this.Bu,!1,this.PU,this.PU);if(!Ob||!Ob.length)throw ee.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");La=Array(Ob.length);lb=0;for(const mc of Ob)Ob=new Vd.a,Ob.dZ(mc),Ob.xa.setAttribute(Lg.a.OQb,this.Zr.hnb()),La[lb++]=Ob;ee.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return La}draw(La,lb){if(Array.contains(this.Tn,
La)){Array.remove(this.Tn,La);if(this.ta.pictureCropInfo&&!this.JHa){if(this.ta.pictureCropInfo.MaskViewElem){La=this.ta.pictureCropInfo.MaskViewElem;var Ob=La.Clip,mc=this.lc.jg(this.ta);mc=Rf.a.tPc(6,mc.Xp,mc.Xk);if(mc=lb[mc.toString()])this.OJ.eql(mc.Base64Data,La.Id.toString(),Ob.Bounds.Left,Ob.Bounds.Top,Ob.TotalWidth,Ob.TotalHeight,Ob.Bounds.Right-Ob.Bounds.Left,Ob.Bounds.Bottom-Ob.Bounds.Top),this.OJ.Sd(!0),this.OJ.setPosition(La.Position.X-this.Ga.CB(this.ta,this.vD).x/this.nd,La.Position.Y-
this.Ga.CB(this.ta,this.vD).y/this.nd);this.N$=La;this.aic=new md.a(this.OJ.x,this.OJ.y)}this.ta.pictureCropInfo.TextureViewElem?(La=this.lc.jg(this.ta),mc=Rf.a.tPc(7,La.Xp,La.Xk),La=this.ta.pictureCropInfo.TextureViewElem,Ob=La.Clip,(lb=lb[mc.toString()])?this.mna?(this.ghb=this.Fdg(),this.Lkc=this.rm.points[this.ghb].copy(),this.IJc(md.a.xV(this.ta.Nn.points[this.ghb],this.Lkc)),this.Zr=this.n1b(this.ta.get_shapeRotation(),this.ta.Nn.Zf()),this.QH.fql(lb.Base64Data,La.Id.toString(),La.Position.X-
this.Ga.CB(this.ta,this.vD).x/this.nd,La.Position.Y-this.Ga.CB(this.ta,this.vD).y/this.nd,Ob.TotalWidth,Ob.TotalHeight,this.rm.copy().points,this.vPc(this.rm.copy()))):this.QH.dql(lb.Base64Data,La.Id.toString(),La.Position.X-this.Ga.CB(this.ta,this.vD).x/this.nd,La.Position.Y-this.Ga.CB(this.ta,this.vD).y/this.nd,Ob.TotalWidth,Ob.TotalHeight,this.ta.Nn.points):ee.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.maa=La):ee.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");
this.Sv&&md.a.Ql(this.Sv.ga(0),this.Sv.ga(2))||(this.Sv=this.ta.Nn);this.awa=this.ta.G_a;this.l5.Mt(this.awa.points);this.NX.Mt(this.Sv.points);this.JHa=!0;this.SY(!0);this.visible=this.Ab}else this.Cwa&&this.N$&&this.maa&&(this.XVl(),this.OJ.setPosition(this.N$.Position.X-this.Ga.CB(this.ta,this.vD).x/this.nd,this.N$.Position.Y-this.Ga.CB(this.ta,this.vD).y/this.nd),this.QH.image.setPosition(this.maa.Position.X-this.Ga.CB(this.ta,this.vD).x/this.nd,this.maa.Position.Y-this.Ga.CB(this.ta,this.vD).y/
this.nd),this.mna?(this.ghb=this.Fdg(),this.Lkc=this.rm.points[this.ghb].copy(),this.IJc(md.a.xV(this.ta.Nn.points[this.ghb],this.Lkc)),this.Zr=this.n1b(this.ta.get_shapeRotation(),this.ta.Nn.Zf()),this.QH.clipPath.y2b=this.vPc(this.ta.Nn)):this.QH.clipPath.E8a=new lf.a(this.ta.Nn.points,0),this.aic=new md.a(this.OJ.x,this.OJ.y),this.Sv=this.ta.Nn,this.awa=this.ta.G_a,this.l5.Mt(this.awa.points),this.NX.Mt(this.Sv.points),this.SY(!0),ee.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));
this.yb.em();this.yb.Sd(this.Ab)}}dSl(){if(this.Sv){var La=this.MB.DDb;const lb=new md.a(La[0].x/this.nd,La[0].y/this.nd),Ob=new md.a(La[2].x/this.nd,La[2].y/this.nd),mc=new md.a(La[4].x/this.nd,La[4].y/this.nd);La=new md.a(La[6].x/this.nd,La[6].y/this.nd);this.Sv=new Rh.a(lb,Ob,mc,La)}else this.Sv=this.ta.Nn;this.rm=this.Sv.copy();this.awa||(this.awa=this.ta.G_a);this.awa.move(this.pwa.x,this.pwa.y);this.l5.Mt(this.awa.points);this.fna.NM(this.pwa.x,this.pwa.y);this.pwa.update(0,0);this.$d.Uy(new ij.a(1))}Lfj(){var La=
this.MB.DDb;const lb=new md.a(La[0].x,La[0].y),Ob=new md.a(La[2].x,La[2].y),mc=new md.a(La[4].x,La[4].y);La=new md.a(La[6].x,La[6].y);return new Rh.a(lb,Ob,mc,La)}Nhj(){var La=this.ta.G_a.copy().points,lb=new md.a(La[0].x*this.nd,La[0].y*this.nd);const Ob=new md.a(La[1].x*this.nd,La[1].y*this.nd),mc=new md.a(La[2].x*this.nd,La[2].y*this.nd);La=new md.a(La[3].x*this.nd,La[3].y*this.nd);lb=new Rh.a(lb,Ob,mc,La);lb.scale(1/this.PU,1/this.PU);lb.move((this.fna.x+this.pwa.x)*this.nd,(this.fna.y+this.pwa.y)*
this.nd);return lb}JD(La){this.JHa&&(this.MB.Sd(!La),La?(this.xRh(),this.glc=!0):(this.dSl(),this.ia.Ja(be.a.$2a,2,{["sectionName"]:"Crop",["sectionNewState"]:this.JHa}),this.Cwa&&(La={["pictCropperInfo"]:this.gHf(),["shapeNode"]:this.ta},this.ia.Ja(be.a.gtc,2,La))))}Mp(){return this.yb.Mp()}SY(La){if(this.JHa){var lb=this.Sv.copy();La&&this.HR.ql(lb);La=new Yd.a;La.Ssb(this.ta.get_shapeRotation());var Ob=2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let mc=0;8>mc;++mc){const Rc=this.sD[mc];
Rc.Bl(dk.a.WN(ce.a.box4Image(zh.Msc[Ob]),xi.a.aB));this.NLa(Rc,lb.Wj(new ng.a(mc)));Rc.fF(La,Cj.a.uub);Ob=(Ob+1)%8}}}NLa(La,lb){La.x===lb.x*this.nd&&La.y===lb.y*this.nd||La.setPosition(lb.x*this.nd,lb.y*this.nd)}get visible(){return this.Ab}set visible(La){this.Ab=La;!La&&this.JHa&&(this.e4i(),this.JHa=!1);this.yb.Sd(this.Ab)}e4i(){if(this.JHa){if(this.glc){const La={["pictCropperInfo"]:this.gHf(),["shapeNode"]:this.ta};this.ia.Ja(be.a.gtc,2,La)}this.G3()}}gHf(){let La,lb,Ob,mc;const Rc=this.Iyi();
({left:La,top:lb,right:Ob,bottom:mc}=this.vHi());return Object.assign(new $h.a,{Left:La,Top:lb,Right:Ob,Bottom:mc,X:Rc.x,Y:Rc.y})}vHi(){let La,lb,Ob,mc;({left:La,top:lb,right:Ob,bottom:mc}=this.LWi());({left:La,top:lb,right:Ob,bottom:mc}=this.dLi(La,lb,Ob,mc));({left:La,top:lb,right:Ob,bottom:mc}=zh.CXl(La,lb,Ob,mc));return{left:La,top:lb,right:Ob,bottom:mc}}LWi(){let La,lb,Ob;var mc=this.awa.points;const Rc=this.Sv.points;La=fg.a(mc[3],mc[0],Rc[3],Rc[0]);lb=fg.a(mc[0],mc[1],Rc[0],Rc[1]);Ob=fg.a(mc[1],
mc[2],Rc[1],Rc[2]);mc=fg.a(mc[2],mc[3],Rc[2],Rc[3]);return{left:La,top:lb,right:Ob,bottom:mc}}dLi(La,lb,Ob,mc){var Rc=this.awa.points;const Ud=md.a.Ql(Rc[0],Rc[1]);Rc=md.a.Ql(Rc[1],Rc[2]);La=Math.floor(La/Ud*1E6)/1E6;lb=Math.floor(lb/Rc*1E6)/1E6;Ob=Math.floor(Ob/Ud*1E6)/1E6;mc=Math.floor(mc/Rc*1E6)/1E6;return{left:La,top:lb,right:Ob,bottom:mc}}Iyi(){var La=this.Sv.copy(),lb=new Yd.a,Ob=La.Zf();lb.m8(-1*this.ta.get_shapeRotation(),Ob);lb.ql(La);Ob=this.Ga.CB(this.ta,this.vD);this.Ttk?(lb=this.vD.gf(La.kc*
this.nd+Ob.x,0),La=this.vD.gf(La.mc*this.nd+Ob.y,1),La=new md.a(lb,La)):La=new md.a(La.kc+Ob.x/this.nd,La.mc+Ob.y/this.nd);return md.a.scale(La,this.PU,this.PU)}wid(){return!0}G3(){this.NX.fF(new Yd.a,Cj.a.Zca);this.l5.setPosition(0,0);this.Wn=new Xg.a;this.rm=this.Sv=this.HR=this.ta.pictureCropInfo=null;this.fna.update(0,0);this.glc=!1;this.CHe.update(0,0);this.PU=1}dYd(La,lb){const Ob=new Yd.a;this.rm||(this.rm=La);La=this.rm.Zf();const mc=md.a.Ql(this.rm.ga(0),this.rm.ga(1)),Rc=md.a.Ql(this.rm.ga(0),
this.rm.ga(3)),Ud=mc?1+(lb.right-lb.left)/mc:1,ue=Rc?1+(lb.bottom-lb.top)/Rc:1,Xe=La.copy();Xe.NM(-1*mc/2,-1*Rc/2);Ob.m8(-1*this.ta.get_shapeRotation(),La);Ob.DC(-1*Xe.x,-1*Xe.y);Ob.Pca(Ud,ue);Ob.DC(lb.left+Xe.x,lb.top+Xe.y);Ob.m8(this.ta.get_shapeRotation(),La);return Ob}xNi(La,lb){var Ob=[new md.a(0,0),new md.a(20,0),new md.a(20,5),new md.a(5,5),new md.a(5,20),new md.a(0,20)];Ob=new lf.a(Ob,0);Ob.xa.id=lb;Ob.dF("black");Ob.fv("white");Ob.xr(1);La.equals(ng.a.TE)?Ob.ULa(90):La.equals(ng.a.Zu)?Ob.ULa(0):
La.equals(ng.a.jF)?Ob.ULa(180):La.equals(ng.a.iI)&&Ob.ULa(-90);return Ob}ERi(La,lb){const Ob=new Zj.a;Ob.xa.id=lb;Ob.dF("black");Ob.fv("white");Ob.xr(1);Ob.ah(20,5);La.equals(ng.a.north)?Ob.setPosition(-10,0):La.equals(ng.a.south)?Ob.setPosition(-10,-5):La.equals(ng.a.east)?(Ob.setPosition(-5,-10),Ob.ah(5,20)):La.equals(ng.a.west)&&(Ob.setPosition(0,-10),Ob.ah(5,20));return Ob}get k_a(){return this.Wn}get ye(){return this.yb.viewport}Nde(La){return!this.ta.Lv&&8>La.index?this.sD[La.index].xa:null}PL(){return!1}Xw(La){La&&
(this.glc=!1)}setSelection(){}static CXl(La,lb,Ob,mc){.999999<La+Ob&&(ee.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",La,Ob),Ob=(999999-1E6*La)/1E6);.999999<lb+mc&&(ee.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",lb,mc),mc=(999999-1E6*lb)/1E6);return{left:La,top:lb,right:Ob,bottom:mc}}}zh.Msc=[xi.a.mIh,xi.a.kIh,xi.a.lIh,xi.a.jIh,xi.a.oIh,xi.a.nIh,xi.a.pIh,xi.a.qIh];Object(h.a)(zh,"PictureCropShapeView",null,[847,282,283,108]);var Sh=
d(673);class jj{constructor(La,lb,Ob){this.Ga=La;this.vD=lb;this.i$=Ob}setPosition(La,lb,Ob){this.i$.hJ(La.shapeNode).ZDl(lb,Ob)}setOffsets(La,lb){this.i$.hJ(La.shapeNode).$Dl(La.C$e.copy(),lb)}cJ(La,lb){const Ob=new Yd.a,mc=this.i$.hJ(La.shapeNode);lb=lb?mc.Lfj().copy():mc.Nhj().copy();La=this.Ga.CB(La.shapeNode,this.vD);Ob.DC(La.x,La.y);Ob.ql(lb);return new Sh.a(lb)}yG(La){return La.shapeNode.Lv}}Object(h.a)(jj,"ShapeCropMoveResizeHandler",null,[829]);class Dj{constructor(La,lb,Ob){this.i$=La;this.Cwa=
lb;this.Hcd=Ob}cZ(La,lb,Ob){if((La=this.i$.hJ(La))&&La.visible!==Ob){for(const mc of lb)this.Hcd&&(lb=Object(Rb.a)(826,mc))&&lb.setSelected(!Ob),mc!==La&&(mc.visible=!Ob);La.visible=Ob}}bvd(){return!1}lzd(La,lb,Ob){this.i$.hJ(La).resize(Ob,lb)}cvd(){return!1}mzd(La,lb,Ob,mc){mc&&this.i$.hJ(La).setPosition(lb,Ob)}H4c(){return!this.Cwa}S$a(La,lb){return this.Cwa?lb:[this.i$.hJ(La)]}yG(La){return La.Lv}}Object(h.a)(Dj,"ShapeViewCropUpdateStrategyHandler",null,[827,828]);var Ah=d(343);class hf{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PictureCrop"}Xb(La){this.K=La;this.K.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").na().oa(()=>new Ah.a((lb,Ob)=>{let mc=null;const Rc=Object(Rb.a)(117,lb.qc(this.K.resolve("Box4.IPageView").Na));Rc&&!Rc.Ml&&(mc=new zh(lb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.IPageView").Nd,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Ob,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").IQe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").zmd,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").l9d),
mc.Bm(Rc.xa),mc.setZIndex(3),mc.visible=!1,Rc.uK(mc.ye.xa,!0),Rc.$ra(mc,3));return mc}));this.K.register(Og,"PowerPointWebEditor.PictureCropActor").na().oa(()=>new Og(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").s4j,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").HQe,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").gla,
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").zmd,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(wf,"PowerPointWebEditor.FormatPicturePaneActor").na().oa(()=>new wf(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Qe.a(this.K)))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new Dj(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").IQe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Amd));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new jj(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.IPageView").Nd,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").vb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").vb();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").me()}dispose(){}static main(){r.a.instance.Ac(Se.a(new hf,0))}}Object(h.a)(hf,"PPTWebEditorPictureCropPackage",null,[2,3]);var rg=d(41),Ej=d(247);class Li{constructor(La,
lb,Ob,mc,Rc){this.pA=[rg.a.ej,rg.a.font,Fb.a.autonumberBulletType];this.Tb=La;this.Yl=lb;this.Hh=Ob;this.zjc=mc;this.MJ=Rc}format(La){if(La&&La.pCb){La=this.Tb.Lc(La);for(var lb=this.Yl.O3(La,La.currentNode);lb.moveNext();){var Ob=lb.currentNode;if(Ob&&this.Hh.fe(Ob)){const mc=this.MJ.JQ(La,this.Hh.Tib(Ob));(Ob=this.zjc.YWc(Ob))&&Ej.d(mc,Ob,this.pA)}}}}}Object(h.a)(Li,"BeautifyListFormatter",null,[792]);class Gh{constructor(La,lb,Ob,mc,Rc){this.ia=La;this.ua=Ob;this.Fb=lb;this.Ga=mc;this.Tik=Rc}initialize(){this.vb()}vb(){this.ia.ra(be.a.mWd,
N.a.application,Object(B.a)(this,this.mWd,"applyTextFormatterSuggestion"),4)}mWd(La,lb,Ob){if(1===Ob)return 32;La=this.ua.Ba;if(!La)return 16;lb=La.yj();if(!lb||!lb.length)return 16;lb=this.Ga.a0(lb);if(!lb.length)return 16;Ob=this.Fb.yd(15);Ob.jc(La);for(const mc of lb)this.Tik.format(mc);Ob.dispose();return 32}}Object(h.a)(Gh,"TextFormatterActor",null,[]);class hg{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Xb(La){this.K=La;La.register(792,"PowerPointWebEditor.IBeautifyListFormatter").na().oa(()=>
new Li(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor")));La.register(Gh,"PowerPointWebEditor.TextFormatter.TextFormatterActor").na().oa(()=>new Gh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const La=this.K.resolve("Common.IAppSettingsManager");La.$e(()=>{La.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){r.a.instance.Ac(Se.a(new hg,0))}}Object(h.a)(hg,"PPTWebEditorTextFormatterPackage",null,[2,3]);var Lh=d(13);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(Lh.c)("Chronos1");Oa.main();Type.registerNamespace("Common.App.O365Shell");gc.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Bb.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");
Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Ei.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",
Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",
Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},
{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",
Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},
{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},
{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",
attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",
attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",
Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",
Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",
Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",
LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},
children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",
Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",
Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};hf.main();hg.main();Type.registerNamespace("NLRT");Object(Lh.b)("Chronos1")},140:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(226);class e{constructor(r,m){this.ZOa=!1;const {Annotations:n}=d(81);if(!r)throw Error.argumentNull("annotations");if(!r.dse(m))throw Error.argument("memberTypeID","Invalid type ID");if(n.rC(m))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.Pr=r;this.q5h=m;this.wC=[]}get otb(){return this.Pr}get isReadOnly(){return this.ZOa}get VU(){return this.q5h}get items(){return this.wC}C2(){const {Annotations:r}=d(81);let m="[";for(let n=0,z=this.items.length;n<z;++n){0<n&&(m+=", ");const t=this.Pr.C2(this.VU,this.items[n]);this.VU===r.yZ?(m+='"',m+=h.a.i7d(t),m+='"'):m+=t}return m+"]"}isEqual(r){const {Annotations:m}=d(81);if(this===r)return!0;if(!r||r.otb!==this.Pr||r.VU!==this.VU||r.items.length!==this.items.length)return!1;
for(let n=0;n<this.items.length;++n)if(!m.n3a(this.VU,this.items[n],r.items[n]))return!1;return!0}clone(){const r=new e(this.Pr,this.VU);Array.addRange(r.items,this.items);return r}rL(){return this.isReadOnly?this.clone():this}Dte(){const {Annotations:r}=d(81);if(!this.isReadOnly){this.ZOa=!0;for(const m of this.items)r.xdb(m)}}toString(){return this.C2()}}Object(K.a)(e,"ListValue",null,[1214,1216])},145:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.tellMe="TellMe";h.contextMenu=
"ContextMenu";h.unknown="Unknown";Object(K.a)(h,"TellMeScenario",null,[])},160:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r,m=null,n=null,z=4,t=-99999,x=0){this.bVd="";this.vKc=-1;this.value=e;this.type=r;this.subType=z;this.label=this.hK=m;this.groupType=30;this.description=n;this.score=t;this.count=x}}Object(K.a)(h,"ResultBinding",null,[])},173:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.Yk=
[]}Bq(e){this.Yk.push(e)}Dqh(e){const r=[];for(const m of this.Yk)m.groupType!==e&&r.push(m);this.Yk.length!==r.length&&(this.Yk=r)}get LBb(){return!1}}Object(K.a)(h,"SimpleResultsUpdatedEventArgs",null,[944])},174:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e=30,r=""){this.U8h=[];this.groupType=e;this.displayName=r}get results(){return this.U8h}ys(e){e.groupType=this.groupType;Array.add(this.results,e)}SWe(e=1){if(this.results.length>=e)for(let r=0;r<e;r++)Array.removeAt(this.results,
this.results.length-1)}}Object(K.a)(h,"SimpleResultGroup",null,[945])},226:function(K,S,d){K=d(0);class h{constructor(r,m){this.gRa=r;this.value=m}}Object(K.a)(h,"AttrValuePair",null,[]);d.d(S,"a",function(){return e});class e{constructor(r){this.ZOa=!1;if(!r)throw Error.argumentNull("annotations");this.Pr=r;this.DO=[]}get otb(){return this.Pr}get isReadOnly(){return this.ZOa}get che(){return 0<this.DO.length}ln(r){if(!this.Pr.tCb(r))throw Error.argument("attributeID","Invalid attribute ID");for(const m of this.DO)if(r===
m.gRa)return r=m.value,{returnValue:!0,value:r};return{returnValue:!1,value:null}}Iu(r,m){var {Annotations:n}=d(81);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Pr.tCb(r))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Pr.pBb(this.Pr.getAttributeType(r),m))throw Error.argument("value","Value is not of the correct type for the specified attribute");n.xdb(m);for(n=0;n<this.DO.length;++n){const z=this.DO[n];if(r===
z.gRa){z.value=m;return}}Array.add(this.DO,new h(r,m))}Tpd(r){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Pr.tCb(r))throw Error.argument("attributeID","Invalid attribute ID");for(let m=0;m<this.DO.length;++m)if(r===this.DO[m].gRa){Array.removeAt(this.DO,m);break}}fUc(r){if(!r)throw Error.argumentNull("action");for(const m of this.DO)r(m.gRa,m.value)}clone(){const r=new e(this.Pr);r.qDa(this);return r}qDa(r){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");
if(!r)throw Error.argumentNull("other");if(r.otb!==this.Pr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.DO);r.fUc((m,n)=>{this.Iu(m,n)})}C2(){const {Annotations:r}=d(81);let m="[",n=!0;for(const z of this.DO){n?n=!1:m+=", ";m+=this.Pr.$5f(z.gRa);m+="=";const t=this.Pr.getAttributeType(z.gRa),x=this.Pr.C2(t,z.value);t===r.yZ?(m+='"',m+=e.i7d(x),m+='"'):m+=x}return m+"]"}isEqual(r){const {Annotations:m}=d(81);if(!r)throw Error.argumentNull("other");if(this===r)return!0;
if(!r||this.Pr!==r.otb||this.che!==r.che)return!1;let n=0,z=null,t=!1;r.fUc((x,B)=>{++n;if(!t){var D=-1;for(let w=0,J=this.DO.length;w<J;++w)if(this.DO[w].gRa===x){D=w;break}0>D?t=!0:(z||(z=Array(this.DO.length)),z[D]=B)}});if(this.DO.length!==n||t)return!1;for(let x=0,B=this.DO.length;x<B;++x)if(!m.n3a(this.Pr.getAttributeType(this.DO[x].gRa),this.DO[x].value,z[x]))return!1;return!0}rL(){return this.isReadOnly?this.clone():this}Dte(){const {Annotations:r}=d(81);if(!this.isReadOnly){this.ZOa=!0;for(const m of this.DO)r.xdb(m.value)}}toString(){return this.C2()}static i7d(r){return r.replace("\\",
"\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(K.a)(e,"FeatureBundle",null,[1213,1216])},265:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.click="Click";h.FAb="InteractionBegin";h.$mg="InteractionEnd";h.pPf="ControlActivated";h.query="Query";h.Olh="QueryIndexRecorded";h.ENf="Clicks";h.iyf="ActionEvents";h.M1f="FilteredActionEvents";h.lyh="SessionContext";h.latency="Latency";h.performance="Performance";h.wsh="RenderedResults";h.events="Events";h.ZQi="CreateResultsMenu";
h.pF="UpdateRibbonControls";h.ihl="ResultsAggregation";h.IB="IssueQuery";h.rGi="CommandSuggestions";h.error="Error";h.vte="LoadModelData";h.TVi="DepsResolveTime";h.MAk="ModelDataWaitTime";h.timedOut="TimedOut";h.ami="AddinQueryCommandReady";h.edj="GetAddinEntitlements";h.xlh="ProviderMRUEvents";h.y0i="EnableAddinSearchCommands";Object(K.a)(h,"EventNames",null,[])},279:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.mGe=null;this.Gz=this.VHe=0}yUc(e,r,m){if(!e)throw Error.argumentNull("referenceList");
if(0>r||r>e.length)throw Error.argumentOutOfRange("startIndex");if(0>m||m>e.length)throw Error.argumentOutOfRange("length");if(r+m>e.length)throw Error.argument("Invalid start-length range");this.mGe=e;this.VHe=r;this.Gz=m}FTa(e,r,m){this.yUc(e.mGe,e.VHe+r,m)}ga(e){if(0>e||e>=this.Gz)throw Error.argumentOutOfRange("index");return this.mGe[this.VHe+e]}get count(){return this.Gz}static y2d(e){const r=new h;r.yUc(e,0,e.length);return r}}Object(K.a)(h,"ReadOnlyList",null,[1186])},305:function(K,S,d){d.d(S,
"a",function(){return h});K=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]=
"Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=
29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";e[e.MergedScopedSearches=32]="MergedScopedSearches";e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(h||(h={}));Object(K.b)("ResultGroupType",h)},344:function(K,S,d){d.r(S);d.d(S,"CommandResultsUtility",function(){return B});K=d(0);var h=d(391),e=d(265),r=d(392),m=d(160),n=d(174),z=d(117),t=d(108),x=d(27);class B{static nRb(D,w){if(w&&w.Qp){const J={};for(const F of D)w.B4c(F)&&(J[F]=appChrome.selectors.getModelType(F));
z.TellMeActor.instance.pF(J)}}static QJl(D){return D.startsWith("btnTellMeOfficeAddIn")}static fbc(D){const w=z.TellMeActor.instance.lH();return!!w&&w.Qp&&!appChrome.selectors.isControlDisabled(D)}static Y5c(D,w,J,F){if(z.TellMeActor.instance.Kd&&D){const L=[];for(const M of D)L.push(String.format('{{"Id":"{0}","Score":{1}}}',M.commandId,M.score));D={};D[h.a.suggestions]="[{"+L.join(",")+"}]";D[h.a.Evg]=w;D[h.a.groupType]=J;D[h.a.provider]=F;z.TellMeActor.instance.Kd.TH(e.a.rGi,window.performance.now(),
D)}}static khj(D,w){const J=[],F=[];for(const L of w){w=L.commandId;let M=L;L.commandId in D&&(w=D[L.commandId],M=new r.a(w,L.score));Array.contains(F,w)||(J.push(M),F.push(w))}return J}static H8b(D,w,J,F,L,M,Q,C){J.Aae&&(w=B.khj(J.Aae,w));var O=t.a.mgj(w);B.nRb(O,J);var U=[],T=[];O=[];const ca=new n.a(Q);Q=16===Q||18===Q||7===Q||4===Q?x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.uc("TellMeMaxRecommendedResultsToReturn",3):3:0===Q||17===Q||25===Q?5:0;for(const N of w)if(!B.NYj(N.commandId)){w=
B.QJl(N.commandId);if(J.B4c(N.commandId)&&!w){if(t.a.Iug(N.commandId))continue;w=null;L&&M&&(w=L.Uqj(N.commandId,M));B.fbc(N.commandId)?Array.add(U,new m.a(N.commandId,5,w,null,C,N.score)):Array.add(T,new m.a(N.commandId,5,w,null,C,N.score))}else J.N7a&&w&&F&&Array.add(O,N.commandId.substr(21));if(U.length+O.length>=Q)break}J=0;for(L=0;L<U.length&&J<Q;L++,J++)ca.ys(U[L]);for(U=0;U<T.length&&J<Q;U++,J++)ca.ys(T[U]);for(T=0;T<O.length&&J<Q;T++,J++)F.S2l(D,O[T],ca);return ca}static NYj(D){B.xGf||(x.AFrameworkApplication.fa&&
x.AFrameworkApplication.fa.gu("TellMeControlPredictionBlockList")&&x.AFrameworkApplication.fa.ty("TellMeControlPredictionBlockList").forEach(w=>{Array.add(B.wGf,w.toLowerCase())}),B.xGf=!0);return Array.contains(B.wGf,D.toLowerCase())}static goe(D){return 2<D.length&&";"===D.charAt(0)&&";"===D.charAt(D.length-1)&&!!x.AFrameworkApplication.fa&&(x.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static q7f(D){const w=new n.a(0);var J=D.split(";");D=z.TellMeActor.instance.lH();for(const F of J)if(0<F.length){J=F.split(":");const L=2===J.length?J[0]:F;if(!D.B4c(L))break;if(1===J.length)J=new m.a(L,5,null,null,1),w.ys(J);else if(2===J.length)J=new m.a(L,5,J[1],null,1),w.ys(J);else break}return w}static hfi(D,w,J){if(!(w&&w.results&&D&&D.results&&D.results.length))return{returnValue:!1,xTd:D,YTd:w};const F=[];for(var L of w.results)Array.add(F,L.value);L=0;const M=0<w.results.length?w.results[0].score:
0;for(const Q of D.results)if(Q.score>J&&!Array.contains(F,Q.value)&&B.fbc(Q.value)&&(0<M&&(Q.score=M),Array.insert(w.results,L,Q),L++),2===L)break;return 0<L?(J=w.results.length-5,0<J&&w.SWe(J),{returnValue:!0,xTd:D,YTd:w}):{returnValue:!1,xTd:D,YTd:w}}}B.xGf=!1;B.wGf=[];Object(K.a)(B,"CommandResultsUtility",null,[])},391:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.appName="AppName";h.fDa="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message=
"Message";h.errorMessage="ErrorMessage";h.event="Event";h.x9="CorrelationID";h.AQk="ParentUiElement";h.query="Input";h.Ejb="QueryID";h.Qlh="QueryLength";h.iLb="QueryIndex";h.jhl="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.oOh="UiElement";h.ppd="ReactUx";h.value="Val";h.statusCode="StatusCode";h.cnl="Service";h.isSuccess="IsSuccess";h.GLl="TokenAcquired";h.Eak="LatencyType";h.groupName="GroupName";h.bbb="GroupIndex";
h.groupType="GroupType";h.fhl="ResultInfoList";h.resultType="ResultType";h.h6e="SubResultType";h.o1j="IsInputBlur";h.p1j="IsInputFocus";h.c7j="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.v_i="DwellTime";h.Evg="IsZeroTerm";h.e_l="WordsCount";h.N3c="IsSearchUxEnabled";h.x8j="IsTellMeInHeaderEnabled";h.module="Module";h.resultIndex="ResultIndex";h.i5d="DisplayIndex";h.H0i="EnableList";h.provider="Provider";h.contentType="ContentType";h.G6j="IsSelectionBased";h.lsi="BeginPerformanceMarker";
h.g1i="EndPerformanceMarker";h.FSk="PerformanceMeasure";Object(K.a)(h,"Columns",null,[])},392:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r){this.commandId=e;this.score=r}}Object(K.a)(h,"CommandSuggestion",null,[])},454:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{static axc(e){if(!e)return"{NULL}";const r=e.length;return 600>=r?e:e.substring(0,400)+"[...]"+e.substring(r-195,r)}}Object(K.a)(h,"LogUtils",null,[])},455:function(K,S,d){d.d(S,"a",function(){return h});
K=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.iLb="QueryIndex";h.yKh="TellMeRanker";h.zKh="TellMeRankerLogging";Object(K.a)(h,"Services",null,[])},456:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.vua="HttpRequest";h.provider="Provider";Object(K.a)(h,"LatencyTypes",null,[])},555:function(K,S,d){K=d(0);class h{constructor(){this.Mwc=this.nac=null;this.YJe=this.score=this.Llc=0}TPe(J,F,L){this.score=J.ga(F);++F;this.nac=J.ga(F)?L.i9(J.ga(F)):null;++F;
this.Mwc=J.ga(F)?L.i9(J.ga(F)):null;++F;this.Llc=J.ga(F);++F;this.YJe=J.ga(F);++F;return F}}Object(K.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(J,F,L,M,Q){this.wTa=J;this.count=F;this.RTc=L;this.hH=M;this.depth=Q}}Object(K.a)(e,"ErrorTolerantTrieMatch",null,[]);var r=d(722),m=d(1015);class n{constructor(J=null,F=0,L=0,M=0){this.pbi=J||new m.a;this.Mda=F;this.hH=L;this.depth=M}get HV(){return this.pbi}getKey(){return this.HV.xt.toString()+":"+this.Mda.toString()}}Object(K.a)(n,"TrieBookmark",
null,[]);class z{constructor(J,F){this.oxa=J;this.tEe=F}Jhk(J){if(null==J)throw Error.argumentNull("prefix");let F={};var L=F[""]=new n;this.s_c(L,F);for(L=0;L<J.length;++L){const M=J.charCodeAt(L),Q={};for(let C in F)this.Vmi(M,F[C],Q);F=Q}return this.NMl(F)}s_c(J,F){if(!(J.hH>=this.tEe)&&(J=new n(r.a.F_d(J.HV),J.Mda,J.hH+1,J.depth),J.HV.Vz&r.a.zNa&&(J.Mda+=1),this.oxa.pnb(J.HV))){J.depth+=1;let L=!0;for(;L;)z.Fzd(J,F),this.s_c(J,F),J.Mda+=this.oxa.jyb(J.HV,!0)+(J.HV.Vz&r.a.zNa?1:0),L=this.oxa.Vwc(J.HV)}}Vmi(J,
F,L){F.hH+1<=this.tEe&&(F.hH+=1,z.Fzd(F,L),--F.hH);F.HV.Vz&r.a.zNa&&(F.Mda+=1);if(this.oxa.pnb(F.HV)){F.depth+=1;let M=!0;for(;M;)F.HV.Snb===J?(z.Fzd(F,L),this.s_c(F,L)):F.hH+1<=this.tEe&&(F.hH+=1,z.Fzd(F,L),this.s_c(F,L),--F.hH),F.Mda+=this.oxa.jyb(F.HV,!0)+(F.HV.Vz&r.a.zNa?1:0),M=this.oxa.Vwc(F.HV)}}NMl(J){const F=[];for(var L in J){const M=J[L];if(!M.HV.xt)continue;const Q=!!(M.HV.Vz&r.a.zNa),C=this.oxa.jyb(M.HV,!1)+(Q?1:0);Array.add(F,new e(M.Mda,C,Q,M.hH,M.depth))}F.sort((M,Q)=>{let C=M.wTa-
Q.wTa;return C||(C=-(M.count-Q.count))?C:C=M.depth-Q.depth});if(2>F.length)return F;J=[];for(L=0;L<F.length;)L+=z.eMh(L,F,J);return J}static Fzd(J,F){const L=J.getKey();L in F?(F=F[L],F.hH=Math.min(F.hH,J.hH)):F[L]=new n(r.a.F_d(J.HV),J.Mda,J.hH,J.depth)}static eMh(J,F,L){const M=F[J];let Q=M.wTa;const C=Q+M.count;let O=1,U=M.RTc;for(;J+O<F.length&&F[J+O].wTa<C;){const T=F[J+O];T.wTa>Q&&(Array.add(L,new e(Q,T.wTa-Q,U,M.hH,M.depth)),U=!1);O+=z.eMh(J+O,F,L);Q=T.wTa+T.count}Q<C&&Array.add(L,new e(Q,
C-Q,U,M.hH,M.depth));return O}}Object(K.a)(z,"ErrorTolerantTrieLookupEngine",null,[1306]);class t extends h{constructor(J,F,L){super();this.mlg=this.afh=!1;this.g_f=null;if(J){var M=0;try{M=this.TPe(J,M,F);this.afh=1===J.ga(M);++M;this.mlg=1===J.ga(M);++M;const Q=J.ga(M);this.g_f=this.QQk(L,Q)}catch(Q){throw Error.argument("initData");}}}QQk(J,F){return new z(J,F)}}Object(K.a)(t,"FuzzyMatchTokenStringGeneratorInit",h,[]);class x extends h{constructor(J,F){super();this.query=this.name=null;if(J){this.annotations=
F.annotations;var L=0;try{L=this.TPe(J,L,F),this.name=F.YC(J.ga(L)),++L,this.query=F.lE(J.ga(L))}catch(M){throw Error.argument("initData");}}}}Object(K.a)(x,"QueryTokenStringGeneratorInit",h,[]);class B extends h{constructor(J,F){super();if(J)try{this.TPe(J,0,F)}catch(L){throw Error.argument("initData");}}}Object(K.a)(B,"SurfaceStringTokenStringGeneratorInit",h,[]);var D=d(279);d.d(S,"a",function(){return w});class w{constructor(J){this.uve=J}get nac(){return this.uve.nac}get Mwc(){return this.uve.Mwc}get Llc(){return this.uve.Llc}static create(J,
F,L){const {SurfaceStringTokenStringGenerator:M}=d(1177),{QueryTokenStringGenerator:Q}=d(1178),{FuzzyMatchTokenStringGenerator:C}=d(1179);let O=0;try{if(J.ga(O)!==w.h8a)throw Error.argument("initData","Input does not represent a token string generator");++O;const U=J.ga(O);++O;const T=new D.a;T.FTa(J,O,J.count-O);switch(U){case M.v1b:return new M(new B(T,F));case Q.v1b:return new Q(new x(T,F));case C.v1b:return new C(new t(T,F,L));default:throw Error.argument("initData");}}catch(U){throw Error.argument("initData");
}}static tAf(J,F,L,M,Q,C){J=J.NLl.getId(F,null);if(0>J)return++C,C;w.uAf(J,L,M,Q);return C}static uAf(J,F,L,M){Array.add(M.O5e,J);Array.add(M.bIh,F);++M.IQb[L]}}w.h8a=1099767983;Object(K.a)(w,"TokenStringGenerator",null,[1286])},710:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(160);class h extends d.a{constructor(e,r,m,n,z=null){super(e,r,z,null,m);this.id=n}}Object(K.a)(h,"TryQueryResultBinding",d.a,[])},711:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.Ka=
e}get IJa(){return this.Ka.IJa}get tHl(){return 4!==this.Ka.style}get wHl(){return!0}get trie(){return this.Ka.trie}getId(e,r){if(!this.tHl)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ka.style){case 0:return this.Wlj(e,r);default:throw Error.notImplemented();}}YC(e){if(!this.wHl)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.IJa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ka.style){case 0:return this.Xwj(e);
case 4:return this.Wwj(e);default:throw Error.notImplemented();}}Wlj(e,r){e=this.Ka.trie.fzg(e,0,e.length,r);if(!e.succeeded)return-1;if(0>e.RQb||e.RQb>=this.Ka.IJa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ka.Wwc?this.Ka.brc.Hu(this.Ka.Wwc+4*e.RQb,4):e.RQb}Xwj(e){if(this.Ka.Wwc){let r=0;for(;r<this.Ka.IJa&&this.Ka.brc.Hu(this.Ka.Wwc+4*r,4)!==e;++r);if(r>=this.Ka.IJa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ka.trie.Kdg(r)}return this.Ka.trie.Kdg(e)}Wwj(e){const r=
this.Ka.brc.Hu(this.Ka.$Hh+4*e,4);e=this.Ka.brc.Hu(this.Ka.aIh+4*e,4);if(0>e||0>r)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const m=Array(r);for(let n=0;n<r;++n)m[n]=({ANj:e}=this.t4k(e)).returnValue;return String.fromCharCode.apply(null,m)}t4k(e){let r=0;for(let m=0;3>m;++m){const n=this.Ka.brc.ga(this.Ka.bLf+e)^182;++e;r|=(n&127)<<7*m;if(!(n&128))break}return{returnValue:r,ANj:e}}}Object(K.a)(h,"StringTable",null,[1234])},712:function(K,S,d){d.d(S,"a",function(){return e});
K=d(0);var h=d(722);class e{constructor(r){this.trie=null;this.bLf=this.$Hh=this.aIh=this.Wwc=0;if(r){this.brc=r;var m=0;if(r.Hu(m,4)!==e.h8a)throw Error.argument("bytes","Input does not represent a string table");m+=4;this.IJa=r.Hu(m,4);m+=4;this.style=r.Hu(m,4);m+=4;switch(this.style){case 0:const n=1===r.Hu(m,4);m+=4;n||(this.Wwc=m,m+=4*this.IJa);r.Hu(m,4);this.trie=this.tRk(r,m+4);break;case 4:this.aIh=m;this.$Hh=m+=4*this.IJa;m+=4*this.IJa;r.Hu(m,4);this.bLf=m+4;break;default:throw Error.argument("bytes");
}}}tRk(r,m){return new h.a(r,m)}}e.h8a=1025118440;Object(K.a)(e,"StringTableInit",null,[])},713:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=
11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";
e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(h||(h={}));Object(K.b)("ResultType",h)},722:function(K,S,d){K=d(0);class h{constructor(t){this.b8g=t;this.succeeded=!1;this.RQb=t?t.RQb:0;this.u8j=!1;this.length=this.eJl=0}}Object(K.a)(h,"TrieResult",
null,[]);class e{constructor(t,x,B){this.ro=new h(null);this.jpk=t;this.Qgc=x;this.GEg=x+B-1}get result(){return this.ro}yag(){let t;return this.Qgc<=this.GEg?(t=this.jpk.charAt(this.Qgc),++this.Qgc,{returnValue:!0,ch:t}):{returnValue:!1,ch:"\x00"}}vWe(t,x,B){t&&(this.ro.u8j=!0,this.ro.eJl=x);this.ro.length=this.Qgc;this.ro.succeeded=!0;this.ro.RQb=B;this.Qgc!==this.GEg+1&&(this.ro=new h(this.ro))}}Object(K.a)(e,"LookUpStringVisitor",null,[1281]);var r=d(1015);class m{constructor(){this.KKf=this.cIf=
this.eIf=this.bIf=this.dIf=this.kYd=this.jYd=this.mYd=this.iYd=0}}Object(K.a)(m,"TRIESTATS",null,[]);class n{constructor(){this.symbol=this.Nmc=0}}Object(K.a)(n,"TrieSymbol",null,[]);d.d(S,"a",function(){return z});class z{constructor(t,x){this.QU=null;this.f$c=this.$Hg=this.YHg=this.bIg=this.UHg=this.aIg=this.ZHg=this.cIg=this.VHg=0;this.jD=t;if(t.Hu(x,4)!==z.h8a)throw Error.argument("Input does not represent a trie");x+=4;this.kFg=1===t.Hu(x,4);x+=4;this.Vkk=1===t.Hu(x,4);x+=4;this.Gkk=t.Hu(x,4);
x+=4;if(t.Hu(x,4)){t=x+4;this.QU=this.v4k(t);this.VHg=x=t+z.Pwi;this.cIg=x+=z.YLc*(this.QU.iYd+(this.QU.iYd%2?1:0));this.ZHg=x+=z.YLc*(this.QU.mYd+(this.QU.mYd%2?1:0));this.aIg=x+=z.YLc*(this.QU.jYd+(this.QU.jYd%2?1:0));this.UHg=x+=z.YLc*(this.QU.kYd+(this.QU.kYd%2?1:0));this.bIg=x+=z.sYd*this.QU.bIf;this.YHg=x+=z.tYd*this.QU.eIf;this.$Hg=x+=z.tYd*this.QU.cIf;x+=z.tYd*this.QU.dIf;if(x!==t+this.QU.KKf)throw Error.argument("Corrupted trie binary");this.f$c=x}else this.QU=null}fzg(t,x,B,D){t=new e(t,
x,B);this.bTh(t,D);return t.result}Kdg(t){if(this.kFg)if(t)--t;else return"";if(!this.QU)throw Error.argument("Invalid trieID");const x=new r.a;x.Vz=0;this.pnb(x);const B=[];for(;;){if(x.Vz&z.zNa)if(t)--t;else return Array.add(B,x.Snb),String.fromCharCode.apply(null,B);const D=!!(x.Vz&z.hBd),w=this.jyb(x,!0);if(D||t<w){if(Array.add(B,x.Snb),!this.pnb(x))throw Error.argument("Invalid trieID");}else if(t-=w,!this.Vwc(x))throw Error.argument("Invalid trieID");}}bTh(t,x){let B=0;this.kFg&&(t.vWe(this.Vkk,
this.Gkk,0),++B);if(this.QU){var D=new r.a;D.Vz=0;if(this.pnb(D))for(;;){var w=void 0;if(!({ch:w}=t.yag()).returnValue)break;x&&(w=x(w));w=w.toString().charCodeAt(0);let J=!1;for(;!J;){const F=!!(D.Vz&z.zNa);if(D.Snb===w){if(J=!0,F&&t.vWe(!!(D.Vz&z.jcf),D.bxd,B),!this.pnb(D))return}else if(B+=this.jyb(D,!0),!this.Vwc(D))return;F&&++B}}}}pnb(t){if(!t.Vz)return this.X8e(t),!0;if(!(t.Vz&z.gBd))return!1;t.xua=0;t.xt=t.oVa;this.X8e(t);return!0}Vwc(t){if(t.Vz&z.hBd)return!1;this.X8e(t);return!0}jyb(t,x){return t.Vz&
z.icf?t.VLc:t.Vz&z.gBd?!x&&t.Vz&z.hBd?this.qhj(t):1:0}qhj(t){t=z.F_d(t);if(!this.pnb(t))return 0;let x=0;do t.Vz&z.zNa&&++x,x+=this.jyb(t,!1);while(this.Vwc(t));return x}X8e(t){t.Vz||(t.xua=0,t.xt=this.f$c);var x=this.dQc(this.VHg,t.xt),B=x.symbol;t.xt+=x.Nmc;x=this.jD.Hu(this.UHg+z.sYd*B,z.sYd);t.Snb=x&65535;t.Vz=x>>16;t.Vz&z.icf&&(t.VLc=this.qUi(t));t.Vz&z.jcf&&(x=this.dQc(this.cIg,t.xt),B=x.symbol,t.xt+=x.Nmc,t.bxd=this.jD.Hu(this.bIg+4*B,4));t.Vz&z.xVh?(t.oVa=this.f$c+((this.jD.ga(t.xt)<<8|this.jD.ga(t.xt+
1))<<8|this.jD.ga(t.xt+2)),t.xt+=3):t.Vz&z.yVh?(t.oVa=t.xt,t.xua=t.oVa):t.Vz&z.zVh?(x=this.dQc(this.ZHg,t.xt),B=x.symbol,t.xt+=x.Nmc,t.oVa=this.f$c+this.jD.Hu(this.YHg+4*B,4)):t.Vz&z.gBd&&(x=this.dQc(this.aIg,t.xt),B=x.symbol,t.xt+=x.Nmc,t.xua||(t.xua=t.xt),t.xua+=this.jD.Hu(this.$Hg+4*B,4),t.oVa=t.xua)}dQc(t,x){const B=new n;let D=0;for(;;){D+=this.jD.ga(x);++x;++B.Nmc;const w=this.jD.Hu(t,2);if(D<w)break;B.symbol+=w;D-=w;t+=2;D<<=8}B.symbol+=D;return B}qUi(t){let x=this.jD.ga(t.xt);192<=x?(x=(x&
63)<<15|(this.jD.ga(t.xt+1)&127)<<8,x|=this.jD.ga(t.xt+2),t.xt+=3):128<=x?(x=(x&127)<<8|this.jD.ga(t.xt+1),t.xt+=2):t.xt+=1;return x}v4k(t){const x=new m;x.iYd=this.jD.Hu(t+12,2);x.mYd=this.jD.Hu(t+14,2);x.jYd=this.jD.Hu(t+16,2);x.kYd=this.jD.Hu(t+18,2);x.dIf=this.jD.Hu(t+24,4);x.bIf=this.jD.Hu(t+28,4);x.eIf=this.jD.Hu(t+32,4);x.cIf=this.jD.Hu(t+36,4);x.KKf=this.jD.Hu(t+40,4);return x}static F_d(t){const x=new r.a;x.Snb=t.Snb;x.Vz=t.Vz;x.VLc=t.VLc;x.xt=t.xt;x.oVa=t.oVa;x.xua=t.xua;x.bxd=t.bxd;return x}}
z.h8a=1654263084;z.Pwi=48;z.YLc=2;z.tYd=4;z.sYd=4;z.zNa=1;z.hBd=2;z.icf=4;z.jcf=8;z.gBd=16;z.yVh=64;z.zVh=128;z.xVh=256;Object(K.a)(z,"Trie",null,[1237])},725:function(K,S,d){d.r(S);K=d(0);d(145);var h=d(265);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(K.a)(e,"AppsForOfficeStoreType",null,[]);var r=d(117),m=d(27),n=d(82),z=d(37);class t{constructor(){this.pQd=0}uTe(M,Q){this.pQd=window.performance.now();this.o3a(()=>{const C=window.performance.now(),O={},U=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);Q.PBf&&(O.callback=T=>{M(T,e.marketPlace,C)},U&&(O.storeType=e.marketPlace),m.AFrameworkApplication.Qa.Ja(z.a.i0a,2,O));Q.QBf&&(O.callback=T=>{M(T,e.privateCatalog,C)},U?O.storeType=e.privateCatalog:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?O.storeType=10:O.storeType=e.privateCatalog,m.AFrameworkApplication.Qa.Ja(z.a.i0a,2,O))},0,()=>{if(r.TellMeActor.instance.Kd)r.TellMeActor.instance.Kd.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.pQd)+" ms")})}o3a(M,Q=0,C=null){2!==m.AFrameworkApplication.Qa.processAction(z.a.i0a,1)?(r.TellMeActor.instance.Kd&&r.TellMeActor.instance.Kd.TH(h.a.ami,window.performance.now()-this.pQd),M()):Q<t.tzk?m.AFrameworkApplication.De.Hb(new n.a(2,1,t.YYl,()=>{this.o3a(M,Q+1,C)})):C&&C()}static get instance(){t.La||(t.La=new t);return t.La}}t.La=null;t.tzk=20;t.YYl=500;Object(K.a)(t,"AddinEntitlementsQuery",null,[]);class x{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Ase=this.storeType=this.storeId=this.OZk=this.iconUrl=null}}Object(K.a)(x,"AddinInfo",null,[]);var B=d(160),D=d(174),w=d(173),J=d(108),F=d(69);d.d(S,"AddinResultsProvider",function(){return L});class L{constructor(M){this.fOd=[];this.qb=M;this.NHk=(Q,C,O)=>{if(Q){const U=Q.errorCode;if(r.TellMeActor.instance.Kd){const T={};T.StoreType=C;T.ErrorCode=U;T.AddinCount=Q.value?
Q.value.length:0;r.TellMeActor.instance.Kd.TH(h.a.edj,window.performance.now()-O,T)}if(0===U&&Q.value){L.G7a=L.G7a||{};Q=Q.value;for(const T of Q)Q=new x,Q.displayName=T[0],Q.id=T[1],Q.description=T[2],Q.targetType=T[3],Q.appVersion=4<T.length?T[4]:"",Q.assetId=5<T.length?T[5]:"",Q.assetStoreId=6<T.length?T[6]:"",Q.width=7<T.length?T[7]:0,Q.height=8<T.length?T[8]:0,Q.iconUrl=9<T.length?T[9]:"",Q.OZk=10<T.length?T[10]:"",Q.storeId=11<T.length?T[11]:"",Q.storeType=12<T.length?T[12]:"",Q.Ase=this.Vmj(Q),
L.G7a[Q.id]=Q,0<Q.iconUrl.length&&(C="AddinIcon_"+Q.id,m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.mph(C,Q.iconUrl):appChrome.addInApi.registerAddinIcon(C,Q.iconUrl))}}};t.instance.uTe(this.NHk,this.qb)}pE(){return"Add-ins"}LL(){return 0===this.qb.Hq?0:1===this.qb.Hq?1:2}IB(M,Q,C,O,U=null){C=new w.a(M);U&&!Array.contains(U,27)||J.a.aG(M)||(U=new D.a(27),U.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.Dmj(M.Ef,
U),C.Bq(U));Q.resultsUpdated(C)}Dmj(M,Q){if((M=this.Ekl(M))&&0<M.length){let C=0;M.forEach(O=>{if(!(3<++C)){var U="AddinSuggestion"+C,T={};if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var ca="AddinIcon_"+O.id;0>Array.indexOf(this.fOd,ca)&&0<O.iconUrl.length&&this.mph(ca,O.iconUrl);T["default"]=0<=Array.indexOf(this.fOd,ca)?ca:"AppForOfficeLogo_20"}else T["default"]=0<O.iconUrl.length?"AddinIcon_"+O.id:"AppForOfficeLogo_20";
ca=[];ca.push(appChrome.actions.setControlLabel(U,O.displayName));ca.push(appChrome.actions.setControlIconSet(U,T));ca.push(appChrome.actions.setCompoundButtonCommandValueId(U,O.id));ca.push(appChrome.actions.updateCompoundButtonDescription(U,O.description));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(T=window.performance.now(),ca.push(appChrome.actions.updateControlEnabledDisabledState(U,!1)),r.TellMeActor.instance.Kd&&r.TellMeActor.instance.Kd.TH(h.a.y0i,
window.performance.now()-T));appChrome.api.dispatch(ca);U=new B.a(U,27,void 0,void 0,1);U.bVd=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.id,O.storeType,O.assetId,null,null,O.storeId);Q.ys(U)}})}}mph(M,Q){F.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(M,Q),Array.add(this.fOd,M))}Ekl(M){if(!L.G7a)return null;const Q=[],C=L.G7a;for(let U in C){var O=C[U];O&&L.Myk(M,O)&&Array.add(Q,O)}return Q}Vmj(M){return L.SEl(M.displayName)}static Myk(M,Q){if(!Q.Ase)return!1;
for(const C of M.split(" ")){M=!1;for(const O of Q.Ase)if(O.toLowerCase().startsWith(C.toLowerCase())){M=!0;break}if(!M)return!1}return!0}static SEl(M){const Q=[];for(const C of M.split(" ")){M=0;for(let O=0;O<C.length;O++){const U=C.charAt(O);U.toString().toUpperCase()===U.toString()&&O>M&&(Array.add(Q,C.substring(M,O)),M=O)}Array.add(Q,C.substring(M,C.length));M&&Array.add(Q,C.substring(0,C.length))}return Q}}L.G7a=null;Object(K.a)(L,"AddinResultsProvider",null,[909])},81:function(K,S,d){d.r(S);
K=d(0);var h=d(19),e=d(226),r=d(140),m=d(711),n=d(712);class z{constructor(x,B){this.ZOa=!1;this.e5=null;if(!x)throw Error.argumentNull("annotations");if(!x.uCb(B))throw Error.argument("structTypeID","Invalid struct type ID");this.Pr=x;this.ADb=this.Pr.Jag(B);this.cai=B}get otb(){return this.Pr}get isReadOnly(){return this.ZOa}get Aza(){return this.cai}cUa(x){if(0>x||x>=this.ADb)throw Error.argument("iField","Invalid field index");return this.e5&&null!=this.e5[x]?this.e5[x]:this.Pr.Ldg(this.Aza,x)}B0e(x,
B){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>x||x>=this.ADb)throw Error.argument("iField","Invalid field index");if(!this.Pr.pBb(this.Pr.Iab(this.Aza,x),B))throw Error.argument("value","Value is not of the correct type for the specified field");(this.e5||(this.e5=Array(this.ADb)))[x]=B}C2(){const {Annotations:x}=d(81);let B="[";if(this.e5){let D=!0;for(let w=0;w<this.ADb;++w){if(null==this.e5[w])continue;const J=this.Pr.Iab(this.Aza,
w);if(x.n3a(J,this.e5[w],this.Pr.Ldg(this.Aza,w)))continue;D?D=!1:B+=", ";B+=this.Pr.Mdg(this.Aza,w);B+="=";const F=this.Pr.C2(J,this.e5[w]);J===x.yZ?(B+='"',B+=e.a.i7d(F),B+='"'):B+=F}}return B+"]"}isEqual(x){const {Annotations:B}=d(81);if(this===x)return!0;if(!x||this.Pr!==x.otb||this.Aza!==x.Aza)return!1;for(let D=0;D<this.ADb;++D)if(!B.n3a(this.Pr.Iab(this.Aza,D),this.cUa(D),x.cUa(D)))return!1;return!0}clone(){const x=new z(this.Pr,this.Aza);this.e5&&(x.e5=Array.clone(this.e5));return x}rL(){return this.isReadOnly?
this.clone():this}Dte(){const {Annotations:x}=d(81);if(!this.isReadOnly&&(this.ZOa=!0,this.e5))for(let B=0;B<this.ADb;++B){const D=this.e5[B];null!=D&&x.xdb(D)}}toString(){return this.C2()}}Object(K.a)(z,"StructValue",null,[1215,1216]);d.d(S,"Annotations",function(){return t});class t{constructor(x,B){if(!x)throw Error.argumentNull("initData");if(!B)throw Error.argumentNull("objectFetcher");this.tkk=B.KZi;let D=0;var w=B.QTa(x.ga(D));++D;this.cIe=new m.a(new n.a(w));this.N_h=x.ga(D);++D;this.MEg=
Array(this.sSc);this.agc=Array(this.sSc);this.EXa=Array(this.sSc);for(w=0;w<this.sSc;++w){this.MEg[w]=B.YC(x.ga(D));++D;this.agc[w]=x.ga(D);++D;var J=x.ga(D);++D;this.EXa[w]=Array(J);for(var F=0;F<J;++F)this.EXa[w][F]=B.YC(x.ga(D)),++D}this.bai=x.ga(D);++D;this.L1g=Array(this.nvc);this.ofd=Array(this.nvc);this.pfd=Array(this.nvc);this.nfd=Array(this.nvc);for(w=0;w<this.nvc;++w)for(this.L1g[w]=B.YC(x.ga(D)),++D,J=x.ga(D),++D,this.ofd[w]=Array(J),this.pfd[w]=Array(J),this.nfd[w]=Array(J),F=0;F<J;++F)this.ofd[w][F]=
B.YC(x.ga(D)),++D,this.pfd[w][F]=x.ga(D),++D,this.nfd[w][F]=({x4:D}=this.Xsa(this.pfd[w][F],x,D,null,null,null)).returnValue,t.xdb(this.nfd[w][F]);this.hXh=x.ga(D);++D;this.kve=Array(this.Otb);this.lve=Array(this.Otb);this.jve=Array(this.Otb);for(w=0;w<this.Otb;++w)this.kve[w]=B.YC(x.ga(D)),++D,this.lve[w]=x.ga(D),++D,this.jve[w]=({x4:D}=this.Xsa(this.lve[w],x,D,null,null,null)).returnValue,t.xdb(this.jve[w])}A7b(x){for(let B=0;B<this.Otb;++B)if(this.kve[B]===x)return B;return-1}$5f(x){if(!this.tCb(x))throw Error.argument("attrID",
"Invalid attribute ID");return this.kve[x]}getAttributeType(x){if(!this.tCb(x))throw Error.argument("attrID","Invalid attribute ID");return this.lve[x]}Iab(x,B){if(!this.uCb(x))throw Error.argument("structTypeID","Invalid struct type ID");x=this.pfd[t.ovc(x)];if(0>B||B>=x.length)throw Error.argument("iField","Invalid field index");return x[B]}C2(x,B){if(!this.dse(x))throw Error.argument("typeID","Invalid type ID");if(!this.pBb(x,B))throw Error.argument("value","Value is not of the correct type");
switch(x){case t.yZ:return B;case t.qha:return B?"True":"False";case t.Wpa:case t.Bba:return B.toString();case t.mN:return B.C2();default:if(!t.rC(x)&&t.mxc(x)){x=t.c7d(x);const J=this.EXa[x].length;switch(this.agc[x]){case 0:return this.EXa[x][B];case 1:if(B){var D="";for(var w=1;w<J;++w)B&1<<w-1&&(0<D.length&&(D+=" & "),D+=this.EXa[x][w]);return D}return this.EXa[x][0];case 2:D="";for(w=0;w<J;++w)B&1<<w&&(0<D.length&&(D+=" & "),D+=this.EXa[x][w]);return D;default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.agc[x]);}}else return B.C2()}}dse(x){switch(x){case t.yZ:case t.qha:case t.Wpa:case t.Bba:case t.mN:return!0;default:return t.rC(x)?this.dse(t.REa(x)):t.mxc(x)?this.D9j(x):this.uCb(x)}}D9j(x){x=t.c7d(x);return 0<=x&&x<this.MEg.length}uCb(x){x=t.ovc(x);return 0<=x&&x<this.L1g.length}tCb(x){return 0<=x&&x<this.Otb}pBb(x,B){if(null==B)return!1;switch(x){case t.yZ:return"string"===typeof B;case t.qha:return"boolean"===typeof B;case t.Wpa:return"number"===typeof B;case t.Bba:return"number"===typeof B;
case t.mN:return Object(h.a)(1213,B);default:if(t.rC(x))return Object(h.a)(1214,B)&&B.VU===t.REa(x);if(t.mxc(x)){if("number"!==typeof B)return!1;x=t.c7d(x);const D=this.EXa[x].length;switch(this.agc[x]){case 0:return 0<=B&&B<D;case 1:return!(B&-1<<D-1);case 2:return!!B&&!(B&-1<<D);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.agc[x]);}}else return Object(h.a)(1215,B)&&B.Aza===x}}get Otb(){return this.hXh}get sSc(){return this.N_h}get nvc(){return this.bai}Zdj(x){if(!this.tCb(x))throw Error.argument("attrID",
"Invalid attribute ID");return this.jve[x]}Jag(x){if(!this.uCb(x))throw Error.argument("structTypeID","Invalid struct type ID");return this.ofd[t.ovc(x)].length}Mdg(x,B){if(!this.uCb(x))throw Error.argument("structTypeID","Invalid struct type ID");return this.ofd[t.ovc(x)][B]}Ldg(x,B){if(!this.uCb(x))throw Error.argument("structTypeID","Invalid struct type ID");x=this.nfd[t.ovc(x)];if(0>B||B>=x.length)throw Error.argument("iField","Invalid field index");return x[B]}Xsa(x,B,D,w,J,F){if(!B)throw Error.argumentNull("initData");
if(t.rC(x)){var L=B.ga(D);++D;x=t.REa(x);var M=new r.a(this,x);for(var Q=0;Q<L;++Q)Array.add(M.items,({x4:D}=this.Xsa(x,B,D,w,J,F)).returnValue);return{returnValue:M,x4:D}}switch(x){case t.yZ:return{returnValue:(w||this.cIe).YC(B.ga(D++)),x4:D};case t.qha:return{returnValue:1===B.ga(D++),x4:D};case t.Wpa:return{returnValue:B.ga(D++),x4:D};case t.Bba:return{returnValue:(J||this.tkk)[B.ga(D++)],x4:D};case t.mN:x=B.ga(D++);L=new e.a(this);for(M=0;M<x;++M)Q=B.ga(D),++D,F&&(Q=F[Q]),L.Iu(Q,({x4:D}=this.Xsa(this.getAttributeType(Q),
B,D,w,J,F)).returnValue);return{returnValue:L,x4:D};default:if(t.mxc(x))return{returnValue:B.ga(D++),x4:D};if(t.kOh(x)){L=B.ga(D++);M=new z(this,x);for(Q=0;Q<L;++Q){const C=B.ga(D);++D;M.B0e(C,({x4:D}=this.Xsa(this.Iab(x,C),B,D,w,J,F)).returnValue)}return{returnValue:M,x4:D}}throw Error.argument("typeID","Invalid type ID");}}static mxc(x){return 16<=(x&16383)&&16384!==(x&16384)&&32768!==(x&32768)}static kOh(x){return 16<=(x&16383)&&16384===(x&16384)&&32768!==(x&32768)}static rC(x){return 32768===
(x&32768)}static Tnj(x){if(t.rC(x))throw Error.argument("nonListTypeID","Non-list type ID required");return x|32768}static REa(x){if(!t.rC(x))throw Error.argument("listTypeID","List type ID required");return x&-32769}static n3a(x,B,D){switch(x){case t.yZ:case t.qha:case t.Wpa:case t.Bba:return B===D;case t.mN:return B.isEqual(D);default:return t.rC(x)?B.isEqual(D):t.mxc(x)?B===D:B.isEqual(D)}}static xdb(x){Object(h.a)(1216,x)&&x.Dte()}static rL(x){return Object(h.a)(1216,x)?x.rL():x}static c7d(x){return x-
16}static ovc(x){return(x&-16385)-16}}t.yZ=1;t.qha=2;t.Wpa=3;t.Bba=5;t.mN=9;Object(K.a)(t,"Annotations",null,[1217])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.chronos1.js.map