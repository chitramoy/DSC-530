'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1301:function(K,S,d){d.r(S);var h=d(0),e=d(1252),r=d(1314),m=d(27),n=d(273),z=d(96),t=d(71),x=d(18);class B{constructor(Ab){Ab.Ia("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(h.a)(B,"DocumentContentExtractionManager",null,[1175]);var D=d(395),w=d(7),J=d(1098);class F{}F.UDl="mso_smartLookup";F.channelId="SmartLookup";F.TDl="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";
F.zGh="https://uci.edog.cdn.office.net/mirrored/smartlookup/";F.AGh="https://uci.cdn.office.net/mirrored/smartlookup/";F.SDl="https://hedwigtestserver.blob.core.windows.net/builds/";F.RDl="http://localhost:8080/";F.Zuc="current";F.yGh="next";F.FPk=2;F.Jld=CommonUIStrings.L_SmartLookupPaneTitle;F.uZ="InsightsTaskPane";F.width=400;F.uKh="appCorrelationId";F.vKh="message";Object(h.a)(F,"InsightsConstants",null,[]);var L=d(954),M=d(175);class Q{}Object(h.a)(Q,"ActivityContractInfo",null,[]);class C{}
Object(h.a)(C,"BrowserPaneDataField",null,[]);class O{}Object(h.a)(O,"BrowserPaneTelemetryEvent",null,[]);var U=d(146),T=d(55),ca=d(184),N=d(177);class da{static Lt(Ab,fc){const kc=new O;kc.eventName="Diagnostics";kc.isActivity=!1;kc.activityContract=Object.assign(new Q,{success:!0});const ud=[],zd=new C;zd.name="Message";zd.dataType=0;zd.value=Ab;Ab=new C;Ab.name="Level";Ab.dataType=0;Ab.value=da.unj(fc);Array.add(ud,zd);Array.add(ud,Ab);kc.dataFields=ud;da.sendTelemetryEvent(kc)}static Lsd(Ab,fc){const kc=
new O;kc.eventName=Ab;kc.isActivity=!1;kc.activityContract=Object.assign(new Q,{success:!0});Ab=[];const ud=new C;ud.name="AppCorrelationId";ud.dataType=0;ud.value=fc;Array.add(Ab,ud);kc.dataFields=Ab;da.sendTelemetryEvent(kc)}static dml(Ab,fc,kc,ud,zd,Td){const Me=new O;Me.eventName="LaunchPaneWithError";Me.isActivity=!1;Me.activityContract=Object.assign(new Q,{success:!0});const tf=[],re=new C;re.name="IsNetworkConnected";re.dataType=0;re.value=Ab?"true":"false";Ab=new C;Ab.name="IsHostruntimeAvailable";
Ab.dataType=0;Ab.value=fc?"true":"false";fc=new C;fc.name="EntryPoint";fc.dataType=0;fc.value=kc;kc=new C;kc.name="RuntimeVersion";kc.dataType=0;kc.value=ud;ud=new C;ud.name="IsFirstRelease";ud.dataType=1;ud.value=zd?"true":"false";zd=new C;zd.name="IsZeroTerm";zd.dataType=1;zd.value=Td?"true":"false";Td=new C;Td.name="IsClientSideRendering";Td.dataType=1;Td.value="false";Array.add(tf,re);Array.add(tf,fc);Array.add(tf,Ab);Array.add(tf,kc);Array.add(tf,ud);Array.add(tf,zd);Array.add(tf,Td);Me.dataFields=
tf;da.sendTelemetryEvent(Me)}static J_e(Ab,fc,kc){const ud=new O;ud.eventName="CDNDownloadLatency";ud.isActivity=!0;ud.activityContract=Object.assign(new Q,{duration:kc,success:!0});kc=[];const zd=new C;zd.name="CDNHostname";zd.dataType=0;zd.value=Ab;Ab=new C;Ab.name="Filename";Ab.dataType=0;Ab.value=fc;Array.add(kc,zd);Array.add(kc,Ab);ud.dataFields=kc;da.sendTelemetryEvent(ud,1)}static etc(Ab,fc,kc,ud,zd,Td,Me,tf){const re=new O;re.eventName="LaunchPane";re.isActivity=!0;re.activityContract=Object.assign(new Q,
{duration:fc,success:!0});fc=[];const lh=new C;lh.name="AppCorrelationId";lh.dataType=0;lh.value=Ab;Ab=new C;Ab.name="EntryPoint";Ab.dataType=0;Ab.value=kc;kc=new C;kc.name="IsServerSideRendering";kc.dataType=1;kc.value="true";const ze=new C;ze.name="UxVersion";ze.dataType=0;ze.value=ud;ud=new C;ud.name="FeatureGates";ud.dataType=0;ud.value=zd;zd=new C;zd.name="IsFirstRelease";zd.dataType=1;zd.value=Td?"true":"false";Td=new C;Td.name="IsZeroTerm";Td.dataType=1;Td.value=Me?"true":"false";Me=new C;
Me.name="IsClientSideRendering";Me.dataType=1;Me.value=tf?"true":"false";Array.add(fc,lh);Array.add(fc,Ab);Array.add(fc,kc);Array.add(fc,ze);Array.add(fc,ud);Array.add(fc,zd);Array.add(fc,Td);Array.add(fc,Me);re.dataFields=fc;da.sendTelemetryEvent(re)}static sendTelemetryEvent(Ab,fc=2){if(Ab.isFeedbackActivity)da.dfk(Ab.eventName);else{var kc=-1<Ab.eventName.indexOf(da.tKh)?Ab.eventName:da.tKh+Ab.eventName,ud=da.eij(Ab.dataFields);Ab.isActivity?(Ab=Object.assign(new ca.a,{name:kc,samplingPolicy:fc,
dataFields:ud,succeeded:Ab.activityContract.success,durationMs:Ab.activityContract.duration}),U.a.sendActivityEvent(Ab)):(Ab=Object.assign(new N.a,{name:kc,samplingPolicy:fc,dataFields:ud}),U.a.sendTelemetryEvent(Ab))}}static unj(Ab){switch(Ab){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static eij(Ab){const fc=[];if(Ab&&0<Ab.length)for(const kc of Ab)(Ab=M.a.V_(kc.name,kc.value,da.BLi(kc.dataType)))&&Array.add(fc,Ab);return fc}static BLi(Ab){switch(Ab){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static dfk(Ab){const fc=T.a.instance.rb("Common.ISystemInitiatedFeedback");fc?fc.logActivity(Ab,null):D.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}da.tKh="Office.Insights.SmartLookup.";Object(h.a)(da,"TelemetryUtils",null,[]);var Y=d(547),fa=d(342),aa=d(452),ka=d(205),H=d(36),ra=d(103);class ha{static WQ(Ab,fc,kc,ud,zd,Td){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;if(zd.value.Zyl())return da.Lt("Skipping Serplet launch",
10),32;fc=Td;if(!fc)return 8;Ab=ha.L$a();if(kc=fc.CommandValueId)try{fc=H.a(kc)}catch(Me){return D.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",kc),8}kc=fc;fc.selection||(fc.neighborhood?kc=Object.assign(new fa.a,{selection:fc}):(fc=zd.value.iab(),kc.selection=Object.assign(new aa.a,{neighborhood:fc.neighborhood,mentionStart:fc.mentionStart,mentionLength:fc.mentionLength})));kc.selection.clientDetectedLanguage=null;return ha.bxb(Td,null,kc,Ab,
0,zd)}static bxb(Ab,fc,kc,ud,zd,Td){const Me={};Me.controlId=Ab?Ab.SourceControlId:"shortcut";kc&&(Me.entryPoint=Y.a[kc.entryPoint]);D.ULS.sendTraceTag(594044172,1303,50,ha.Fka("Show insights",ud,Me));fc?Td.value.aBl(fc,ud,zd):kc&&(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?Td.value.Bzl(kc,ud):Td.value.bBl(kc,ud,zd));return 32}static Fka(Ab,fc,kc=null){Ab={["appCorrelationId"]:fc,["message"]:Ab};if(kc)for(let ud in kc)Ab[ud]=kc[ud];return H.c(Ab)}static L$a(){return ra.a.create().toString()}}
Object(h.a)(ha,"InvokingPaneUtils",null,[]);class Ma{}Object(h.a)(Ma,"LaunchDataInDoc",null,[]);class Ga{}Object(h.a)(Ga,"LaunchDataPasteAsSlide",null,[]);class na{}Object(h.a)(na,"LaunchDataSlidesCompression",null,[]);var wa=d(400),Fa=d(120),pa=d(69),Ea=d(302),ta=d(82),ia=d(65),Ja=d(73),ab=d(542),Oa=d(37);class Za{constructor(Ab,fc,kc,ud,zd,Td,Me,tf,re){this.aUb=this.pCc=this.Zn=null;this.hz=Ab;this.Ca=fc||m.AFrameworkApplication.Qa;this.QK=kc;this.Pd=ud;this.vmf=tf;this.DPa=zd;this.Ma=Td;this.ae=
Me;this.MRj();this.cia=new e.a(()=>new wa.a(re.value,Object(w.a)(this,this.UEa,"getMoreInfoEventReceived")))}vb(){this.Ca.ya(Oa.a.rUj,Ja.a.frame,Object(w.a)(this,this.ZAl,"showInsights"));this.Ca.ya(Oa.a.sUj,Ja.a.frame,Object(w.a)(this,this.$Al,"showInsightsForTellMe"));this.Ca.ya(Oa.a.definitions,Ja.a.frame,Object(w.a)(this,this.fAl,"showDefinitions"));this.Ca.ya(Oa.a.lVi,Ja.a.frame,Object(w.a)(this,this.gAl,"showDefinitionsForTellMe"));this.Ca.ya(Oa.a.T3e,Ja.a.frame,Object(w.a)(this,this.T3e,"showInsightsForSuggestion"));
this.vmf&&(this.Ca.ya(Oa.a.Y0c,Ja.a.frame,Object(w.a)(this,this.WQ,"invokeSmartLookupPane")),this.Ca.ya(Oa.a.sne,Ja.a.frame,Object(w.a)(this,this.sne,"invokeInDocSerplet")),this.Ca.ya(Oa.a.a1c,Ja.a.frame,Object(w.a)(this,this.a1c,"invokeSerpletRibbon")),this.Ca.ya(Oa.a.$0c,Ja.a.frame,Object(w.a)(this,this.$0c,"invokeSerpletContextMenu")),this.Ca.ya(Oa.a.yne,Ja.a.frame,Object(w.a)(this,this.yne,"invokeSerpletTellMeZeroTerm")),this.Ca.ya(Oa.a.xne,Ja.a.frame,Object(w.a)(this,this.xne,"invokeSerpletTellMeNotes")),
this.Ca.ya(Oa.a.rne,Ja.a.frame,Object(w.a)(this,this.rne,"invokeImageSerpletContextMenu")),this.Ca.ya(Oa.a.c1c,Ja.a.frame,Object(w.a)(this,this.c1c,"invokeSynonymsSerpletContextMenu")),this.Ca.ya(Oa.a.pne,Ja.a.frame,Object(w.a)(this,this.pne,"invokeDictionarySerpletContextMenu")),this.Ca.ya(Oa.a.zne,Ja.a.frame,Object(w.a)(this,this.zne,"invokeZeroTermSerpletContextMenu")),this.Ca.ya(Oa.a.one,Ja.a.frame,Object(w.a)(this,this.one,"invokeDefinitionSearchFromFloatie")),this.Ca.ya(Oa.a.Z0c,Ja.a.frame,
Object(w.a)(this,this.Z0c,"invokeSerpletBrowseFiles")),this.Ca.ya(Oa.a.tne,Ja.a.frame,Object(w.a)(this,this.tne,"invokeInDocSerpletWithLaunchData")),this.Ca.ya(Oa.a.LUe,Ja.a.frame,Object(w.a)(this,this.LUe,"queryToggleSerplet")),this.Ca.ya(Oa.a.O0e,Ja.a.frame,Object(w.a)(this,this.O0e,"setInDocSearchParameter")),this.Ca.ya(Oa.a.b1c,Ja.a.frame,Object(w.a)(this,this.b1c,"invokeSerpletSlidesCompression")),this.Ca.ya(Oa.a.wne,Ja.a.frame,Object(w.a)(this,this.wne,"invokeSerpletPasteAsNewSlide")),m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.Ca.ya(Oa.a.BVj,Ja.a.frame,Object(w.a)(this,this.DVj,"invokeSmartLookupPaneConversations")),this.Ca.ya(Oa.a.nne,Ja.a.frame,Object(w.a)(this,this.nne,"invokeAutoLaunchSearchRequest"))),this.I7k().continueWith(()=>{m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.updateCommandUI(!0)}))}kzf(){this.Ca.ra(Oa.a.HAb,Ja.a.frame,Object(w.a)(this,this.HAb,"invokeFilesSerplet"),4);this.Ca.ra(Oa.a.Fng,Ja.a.frame,Object(w.a)(this,this.HAb,"invokeFilesSerplet"),4);this.Ca.ra(Oa.a.Hng,Ja.a.frame,
Object(w.a)(this,this.qVj,"invokeLinkFilesSerplet"),4);if(this.Ma.ka("IsTellMeUpSellEnterpriseEnabled")&&this.Ma.ka("SmartLookupTokenPrefetchIsEnabled")){const Ab=ta.a.sPc(0,Object(w.a)(this,this.Njh,"prefetchToken"),0,177);this.ae.Hb(Ab)}}$Td(){pa.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.Ca.ya(Oa.a.HAb,Ja.a.frame,Object(w.a)(this,this.qne,"invokeFilesSerpletUnavailable")),this.Ca.ya(Oa.a.Fng,Ja.a.frame,Object(w.a)(this,
this.qne,"invokeFilesSerpletUnavailable")),this.Ca.ya(Oa.a.Hng,Ja.a.frame,Object(w.a)(this,this.qne,"invokeFilesSerpletUnavailable")))}Njh(Ab){D.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",Ab.interval,!!Ab.data);this.aRb().then(fc=>{let kc=1;if(fc)D.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.U_e("SmartLookupFiles: Token prefetch succeeded",!0),fc=6E4*this.Ma.uc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{D.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.U_e("SmartLookupFiles: Token prefetch failed",!1);kc=parseInt(Ab.data||"1");if(kc>this.Ma.uc("SmartLookupTokenRenewalRetryThreshold",5)){D.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.U_e("SmartLookupFiles: Token prefetch max retry count reached",!1);return}fc=6E4*this.Ma.uc("SmartLookupTokenRetryWaitDurationInMinutes",10);kc++}fc=new ta.a(3,1,fc,Object(w.a)(this,
this.Njh,"prefetchToken"),177);fc.data=kc.toString();this.ae.Hb(fc)})}U_e(Ab="",fc=!1){this.DPa.execute(kc=>{kc&&kc.DNb("PrefetchToken",fc,0,"SmartLookup",Ab)})}aRb(){return this.DPa?new Promise(Ab=>{this.DPa.execute(fc=>{if(fc){var kc=Date.now();fc.getToken("SmartLookup",this.Ma.Ha("SmartLookupShredderServiceEndpoint")).then(ud=>{Ab(!!ud&&0<ud.length);fc.DNb("TryGetTokenInternal",!!ud&&0<ud.length,Date.now()-kc,"SmartLookup")})}else Ab(!1)})}):Promise.resolve(!1)}I7k(){const Ab=new J.a;if(this.Ma.ka("BrowserSupportsInsightsPaneSSO"))this.kzf(),
Ab.Ng(!0);else{if(!this.DPa)return D.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),Ab.Ng(!1),this.$Td(),Ab.task;this.DPa.execute(fc=>{fc?fc.getToken("SmartLookup",this.Ma.Ha("SmartLookupShredderServiceEndpoint")).then(kc=>{D.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!kc&&0<kc.length);kc&&0<kc.length?(this.kzf(),Ab.Ng(!0)):this.$Td()}):(D.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),Ab.Ng(!1),this.$Td())})}return Ab.task}ZAl(Ab,fc,kc,ud,zd){if(1===
kc)return m.AFrameworkApplication.Aa&&m.AFrameworkApplication.fa.ka("OneNoteDelayLoadContextActivationManager")&&!m.AFrameworkApplication.g3b?8:this.hz.value.lrg()?32:8;Ab=ha.L$a();fc=this.hz.value.iab();return this.vmf?(fc=Object.assign(new aa.a,{neighborhood:fc.neighborhood,mentionStart:fc.mentionStart,mentionLength:fc.mentionLength}),fc=Object.assign(new fa.a,{selection:fc,userIntent:null,entryPoint:0,launchData:Object.assign(new Ea.a,{landingTab:"All"})}),ha.bxb(zd,null,fc,Ab,0,this.hz)):ha.bxb(zd,
fc,null,Ab,0,this.hz)}fAl(Ab,fc,kc,ud,zd){if(1===kc)return this.hz.value.lrg()?32:8;Ab=ha.L$a();fc=this.hz.value.iab();return ha.bxb(zd,fc,null,Ab,1,this.hz)}$Al(Ab,fc,kc,ud,zd){return 1===kc?32:this.P_f(zd,0)}gAl(Ab,fc,kc,ud,zd){return 1===kc?32:this.P_f(zd,1)}P_f(Ab,fc){const kc=ha.L$a(),ud=Ab.CommandValueId;let zd;try{zd=H.a(ud)}catch(Td){return D.ULS.sendTraceTag(6295941,1303,15,ha.Fka(String.format("Insights parameters [{0}] is not in proper format.",ud),kc)),8}return ha.bxb(Ab,zd,null,kc,fc,
this.hz)}T3e(Ab,fc,kc,ud,zd){if(1===kc)return 32;if(!zd)return 8;Ab=zd.query?zd.query:"";fc=ha.L$a();kc=new L.a;kc.neighborhood=Ab;kc.mentionStart=0;kc.mentionLength=Ab.length;return ha.bxb(zd,kc,null,fc,0,this.hz)}qVj(Ab,fc,kc,ud){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;const zd=m.AFrameworkApplication.fa.ka("InsertFileLinkSerpletIsEnabled"),Td=this.hz.value.gUa();return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Td.neighborhood,mentionStart:0,
mentionLength:0}),launchData:Object.assign(new Ea.a,{landingTab:"File"}),entryPoint:zd?32:10}))}HAb(Ab,fc,kc,ud){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;const zd=m.AFrameworkApplication.fa.ka("InvokeReuseSlidesSerpletIsEnabled"),Td=this.hz.value.gUa();return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Td.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new Ea.a,{landingTab:zd?"Slide":"File"}),entryPoint:zd?20:10}))}qne(){return 2}sne(Ab,
fc,kc,ud,zd){if(1===kc)return ka.SessionStatusManager.instance.jla?8:32;const Td=this.hz.value.gUa();zd=void 0===zd||null===zd?18:19;return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Td.neighborhood,mentionStart:Td.mentionStart,mentionLength:Td.mentionLength}),launchData:Object.assign(new Ea.a,{landingTab:"Indoc"}),entryPoint:zd}))}tne(Ab,fc,kc,ud,zd){zd=zd.CommandValueId;if(!zd||zd&&this.aUb&&zd.query===this.aUb.query&&zd.matchCase===this.aUb.matchCase&&
zd.matchWholeWordOnly===this.aUb.matchWholeWordOnly)return 32;const Td=this.hz.value.gUa();return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Td.neighborhood,mentionStart:Td.mentionStart,mentionLength:Td.mentionLength}),launchData:Object.assign(new Ea.a,{landingTab:"Indoc",data:Object.assign(new Ma,{type:4,query:zd.query,matchCase:zd.matchCase,matchWholeWord:zd.matchWholeWordOnly})}),entryPoint:18}))}LUe(Ab,fc,kc,ud,zd){zd&&(zd[ab.a.On]=this.hz.value.fcc);
return 32}O0e(Ab,fc,kc,ud,zd){if(Ab=zd.CommandValueId)this.aUb=Ab;return 32}DVj(Ab,fc,kc){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;Ab=this.hz.value.gUa();Ab=Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Ab.neighborhood,mentionStart:Ab.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Ea.a,{landingTab:"All"})});this.hz.value.Yse(Ab);return 32}nne(Ab,fc,kc){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;Ab=this.hz.value.gUa();
Ab=Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Ab.neighborhood,mentionStart:Ab.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new Ea.a,{landingTab:"All",data:m.AFrameworkApplication.JSa})});fc=ha.L$a();this.hz.value.Nsd(Ab,fc);return 32}a1c(Ab,fc,kc,ud){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;const zd=this.hz.value.Cmj();return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:zd.neighborhood,
mentionStart:zd.mentionStart,mentionLength:zd.mentionLength}),entryPoint:4,launchData:Object.assign(new Ea.a,{landingTab:"All"})}))}$0c(Ab,fc,kc,ud){return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{entryPoint:5,launchData:Object.assign(new Ea.a,{landingTab:"All"})}))}yne(Ab,fc,kc,ud){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;const zd=this.hz.value.gUa();return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:zd.neighborhood,mentionStart:zd.mentionStart,
mentionLength:0}),launchData:Object.assign(new Ea.a,{landingTab:"All"}),entryPoint:26}))}pne(Ab,fc,kc,ud){return 1===kc?(Ab=this.hz.value.iab())&&0<Ab.mentionLength?32:8:this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{entryPoint:22,launchData:Object.assign(new Ea.a,{landingTab:"All"})}))}one(Ab,fc,kc,ud){return 1===kc?(Ab=this.hz.value.iab())&&0<Ab.mentionLength?32:8:this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{entryPoint:7,launchData:Object.assign(new Ea.a,{landingTab:"All"})}))}rne(Ab,fc,kc,ud){return this.WQ(Ab,
fc,kc,ud,Object.assign(new fa.a,{launchData:Object.assign(new Ea.a,{landingTab:"Image"}),entryPoint:9}))}c1c(Ab,fc,kc,ud){return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{launchData:Object.assign(new Ea.a,{landingTab:"All"}),entryPoint:24}))}xne(Ab,fc,kc,ud){return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{launchData:Object.assign(new Ea.a,{landingTab:"Notes"}),entryPoint:33}))}zne(Ab,fc,kc,ud){if(1===kc)return ka.SessionStatusManager.instance.o0?32:8;const zd=this.hz.value.gUa();return this.WQ(Ab,
fc,kc,ud,Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:zd.neighborhood,mentionStart:zd.mentionStart,mentionLength:0}),launchData:Object.assign(new Ea.a,{landingTab:"All"}),entryPoint:27}))}b1c(Ab,fc,kc,ud,zd){if(!zd)return 8;const Td=zd.url;zd=zd.selectedSlideIDs;return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{launchData:Object.assign(new Ea.a,{landingTab:"All",data:Object.assign(new na,{type:6,url:Td,selectedSlideIDs:zd})}),entryPoint:37}))}wne(Ab,fc,kc,ud,zd){if(!zd)return 8;
const Td=zd.Selection;zd=zd.CurrentDocTitle;return this.WQ(Ab,fc,kc,ud,Object.assign(new fa.a,{launchData:Object.assign(new Ea.a,{landingTab:"All",data:Object.assign(new Ga,{type:5,selection:Td,currentDocTitle:zd})}),entryPoint:36}))}WQ(Ab,fc,kc,ud,zd){return ha.WQ(Ab,fc,kc,ud,this.hz,zd)}Z0c(Ab,fc,kc){if(1===kc)return 32;this.Zn||this.cia.value.Yda("Browse File from Search pane",!0);if(!this.pCc||""===this.pCc)return D.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),
8;ia.a.In(this.pCc,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}UEa(Ab){this.Zn||3!==Ab.state||(this.Zn=Ab,this.pCc=this.Zn.ZR)}MRj(){const Ab=this.Pd.Ic(F.uZ);Ab.parent=Fa.AFrame.$i;Ab.n8(Object(w.a)(this,this.O_e,"sendIFrameTakeFocusMessage"));this.QK.cja(F.uZ)}O_e(){document.activeElement.blur();m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.mb.mtg||(this.hz.value.E0e(),this.hz.value.aml())}dispose(){this.hz.value&&this.hz.value.dispose()}}Object(h.a)(Za,"InsightsActor",null,
[108]);var Na=d(1253),sa=d(707),Sa=d(56),xb=d(272),gc=d(47);const zc=Ab=>{Ab=Ab.split("-");return Ab[Ab.length-1]},Xb=Ab=>18===Ab||19===Ab||15===Ab,jb=()=>{var Ab=sb();if(Ab)return Promise.resolve(Ab);Ab=rc().replace("SearchWeb","searchweb");Ab=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Ab+F.yGh+"/":Ab+F.Zuc+"/";Ab+="version.json";if(Sa.a.Fx)return zb(Ab);try{const fc=new Sys.Net.WebRequest;fc.set_httpVerb("GET");fc.set_url(Ab);
Ab={};Ab.method=fc.get_httpVerb();return"function"!==typeof window.fetch?(da.Lt("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(fc.getResolvedUrl(),Ab).then(kc=>kc.json()).catch(()=>{da.Lt("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(kc=>{kc=H.b(JSON.stringify(kc));return kc.version?kc.version:""},kc=>{da.Lt("InsightsUtils - Failed to deserialize version: "+kc.toString(),10);D.ULS.sendTraceTag(591971029,
1303,15,"Insights: Failed to deserialize version: "+kc.toString());return""}).then(kc=>kc)}catch(fc){return da.Lt("InsightsUtils - Failed to download version.json: "+fc.toString(),10),D.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+fc.toString()),Promise.resolve("")}},zb=Ab=>{const fc=m.AFrameworkApplication.Je;return new Promise(kc=>{const ud=new sa.a(Ab,1,null,null,!0,2,null);fc.send(ud).ckb(zd=>{zd&&zd.data?zd.data.Wd||(da.Lt("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
zd.data.Oe,10),kc("")):(da.Lt("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),kc(""));try{const Td=H.b(zd.data.Wd);Td.version&&kc(Td.version)}catch(Td){da.Lt("InsightsUtils - Failed to deserialize version: "+Td.toString(),10),kc("")}},zd=>{zd&&zd.data?da.Lt("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+zd.data.Oe,10):da.Lt("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);kc("")})})},Tb=()=>m.AFrameworkApplication.fa.ka("SmartLookupEnableLocalOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),Ya=()=>{const Ab=rc();return Tb()||m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")?Ab+sb()+"/":m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Ab+F.yGh:Ab+F.Zuc},sb=()=>Tb()?"dev":m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")?
m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion").split("/")[1]:m.AFrameworkApplication.fa.Ha("SmartLookupClientVersion"),oc=Ab=>{var fc=3===m.AFrameworkApplication.Aa.mb.Ti?"wordwac":2===m.AFrameworkApplication.Aa.mb.Ti?"pptwac":"excelwac";var kc=xb.a.He(m.AFrameworkApplication.lcid);const ud=kc?kc.name:"en-us";kc=rc();const zd=Db();fc="main_ssr_wac.html?appName="+fc+"&culture="+ud;return"LOCAL"===zd?kc+fc:kc+((""!==Ab?Ab:F.Zuc)+"/")+fc},wb=Ab=>rc()+(""!==Ab?Ab:F.Zuc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
rc=()=>{switch(Db()){case "LOCAL":return F.RDl;case "PR":const Ab=m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion").split("/");return F.SDl+Ab[0]+"/";case "INT":return F.TDl;case "EDOG":return F.zGh;default:return F.AGh}},Ka=()=>{if(!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(Db()){case "EDOG":return F.zGh;case "PROD":return F.AGh;default:return""}},Db=()=>{if(m.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(m.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(m.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(m.AFrameworkApplication.fa.Ha("SmartLookupPRClientVersion")&&m.AFrameworkApplication.fa.Ha("SmartLookupPRIntentSvc"))return"PR";if(Tb())return"LOCAL";switch(Object(Na.a)(String,m.AFrameworkApplication.Md.AudienceGroup)||""){case "Dogfood":if(m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let Ab=m.AFrameworkApplication.fa.Ha("UserPrincipalName");Ab=gc.a.ug(Ab);const fc=m.AFrameworkApplication.fa.gu("SmartLookupINTEnabledForSKITeam")?
m.AFrameworkApplication.fa.ty("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(fc,Ab))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},bc=()=>{let Ab;Ab=m.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":m.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":m.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":Db();const fc=m.AFrameworkApplication.fa.Ha("IntentServiceEndpoint"),kc=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===Ab&&""!==fc)return fc+"searchendpointv2/";switch(Ab){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return m.AFrameworkApplication.fa.Ha("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(kc?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(kc?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},Mc=()=>{const Ab=
Db(),fc=m.AFrameworkApplication.fa.Ha("IntentServiceEndpoint");switch(Ab){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===Ab&&""!==fc?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class mb{sendTelemetryEvent(Ab){da.sendTelemetryEvent(Ab)}}Object(h.a)(mb,"OtelTelemetrySink",null,[1203]);class Wa{}Object(h.a)(Wa,"ApplicationProperties",
null,[]);class db{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(h.a)(db,"CurrentDocumentProperties",null,[]);class ub{}Object(h.a)(ub,"EnterpriseUserInfo",null,[]);class Lb{}Object(h.a)(Lb,"FeatureGates",null,[]);var Kb=d(77);class uc{constructor(Ab,fc){this.Oq=this.qh=null;this.s7="Search";this.PJg=!0;this.f7a=fc;this.JG=Ab;this.JG.execute(kc=>{kc.isFeatureEnabled("mso_sendASmile",!0).then(ud=>{this.PJg=ud}).catch(ud=>{da.Lt("SearchHelper - Failed to check if Feedback feature is enabled: "+
ud.toString(),15)})});Ab=bc();fc=m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(m.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")){this.Oq={};const kc=this.Ouj();if(kc&&0<kc.length)for(let ud=0;ud<kc.length;ud++){const zd=kc[ud],Td=this.Gvj(zd);switch(Td.toLowerCase()){case "true":this.Oq[zd]=!0;break;case "false":this.Oq[zd]=!1;break;default:this.Oq[zd]=
Td}}this.Oq.EnableInDocumentSearch=fc;this.Oq.EnableInDocumentSearchReplace=!0;this.Oq.EnableInDocumentParamLocalSearch=!0;this.Oq.EnableInDocumentQuerySuggest=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.Oq.EnableInDocumentQuestionGeneration=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.Oq.EnableInDocumentExperiment1=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Oq.EnableInDocumentExperiment2=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.Oq.EnableInDocumentExperiment3=
fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Oq.EnableZeroTermAutoRefresh=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Oq.EnableTap3SZeroTerm=m.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.Oq.EnableLocalSearch=!0;this.Oq.EnableInDocumentStickyFilters=!0;this.Oq.IntentServiceEndpoint=Ab;this.Oq.EnablePDFShredding=m.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Oq.FilterNonPPTFilesForReuseSlides=m.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides");this.Oq.UXBundleVersion=sb();this.Oq.SmartLookupServicePath=
Ya();this.Oq.EnableAcronymSearch=!0;this.Oq.UseAltAnswerEndpoint1=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Oq.UseAltAnswerEndpoint2=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Oq.UseAltAnswerEndpoint3=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.Oq.UseNextUXVersion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Oq.IgnoreNeighborhoodContext=m.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Oq.ShowDebugInfo="INT"===Db();this.Oq.DebugCommands=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.Oq.ChangeGates=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.Oq.QnaInMixSection=!0;this.Oq.EnableNoteSearch=m.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Oq.EnableWikiL2=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);
this.Oq.EnableFilteringOutRedundantKPE=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.Oq.EnableZeroTermEntitySuggestion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Oq.RankingModels=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Oq.EnableClientSideRendering=!0}else this.qh=new Lb,this.qh.EnableInDocumentSearch=
fc,this.qh.EnableInDocumentSearchReplace=!0,this.qh.EnableInDocumentParamLocalSearch=!0,this.qh.EnableInDocumentQuerySuggest=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.qh.EnableInDocumentQuestionGeneration=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.qh.EnableInDocumentExperiment1=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.qh.EnableInDocumentExperiment2=fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.qh.EnableInDocumentExperiment3=
fc&&m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.qh.EnableZeroTermAutoRefresh=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.qh.EnableTap3SZeroTerm=m.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.qh.EnableLocalSearch=!0,this.qh.EnableInDocumentStickyFilters=!0,this.qh.IntentServiceEndpoint=Ab,this.qh.EnablePDFShredding=m.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.qh.FilterNonPPTFilesForReuseSlides=m.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides"),this.qh.UXBundleVersion=sb(),this.qh.SmartLookupServicePath=
Ya(),this.qh.EnableAcronymSearch=!0,this.qh.UseAltAnswerEndpoint1=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.qh.UseAltAnswerEndpoint2=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.qh.UseAltAnswerEndpoint3=m.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.qh.UseNextUXVersion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.qh.IgnoreNeighborhoodContext=m.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.qh.ShowDebugInfo="INT"===Db(),this.qh.DebugCommands=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.qh.ChangeGates=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.qh.QnaInMixSection=!0,this.qh.EnableNoteSearch=m.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.qh.EnableWikiL2=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),
this.qh.EnableFilteringOutRedundantKPE=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.qh.EnableZeroTermEntitySuggestion=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.qh.RankingModels=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.qh.EnableClientSideRendering=!0,this.qh.SharedSerpletFeatureGate1=
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.qh.SharedSerpletFeatureGate2=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.qh.SharedSerpletFeatureGate3=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.qh.SharedSerpletFeatureGate4=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",
!1),this.qh.SharedSerpletFeatureGate5=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.qh.SharedSerpletFeatureGate6=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.qh.SharedSerpletFeatureGate7=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.qh.SharedSerpletFeatureGate8=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",
!1),this.qh.SharedSerpletFeatureGate9=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.qh.SharedSerpletFeatureGate10=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.qh.SharedSerpletFeatureGate11=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.qh.SharedSerpletFeatureGate12=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",
!1),this.qh.SharedSerpletFeatureGate13=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.qh.SharedSerpletFeatureGate14=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.qh.SharedSerpletFeatureGate15=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.qh.SharedSerpletFeatureGate16=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",
!1),this.qh.SharedSerpletFeatureGate17=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.qh.SharedSerpletFeatureGate18=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.qh.SharedSerpletFeatureGate19=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.qh.SharedSerpletFeatureGate20=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",
!1),this.qh.SharedSerpletFeatureGate21=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.qh.SharedSerpletFeatureGate22=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.qh.SharedSerpletFeatureGate23=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.qh.SharedSerpletFeatureGate24=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",
!1),this.qh.SharedSerpletFeatureGate25=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.qh.SharedSerpletFeatureGate26=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.qh.SharedSerpletFeatureGate27=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.qh.SharedSerpletFeatureGate28=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",
!1),this.qh.SharedSerpletFeatureGate29=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.qh.SharedSerpletFeatureGate30=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.qh.SharedSerpletFeatureGate31=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.qh.SharedSerpletFeatureGate32=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1),this.qh.SharedSerpletFeatureGate33=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.qh.SharedSerpletFeatureGate34=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.qh.SharedSerpletFeatureGate35=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.qh.SharedSerpletFeatureGate36=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",
!1),this.qh.SharedSerpletFeatureGate37=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.qh.SharedSerpletFeatureGate38=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.qh.SharedSerpletFeatureGate39=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.qh.SharedSerpletFeatureGate40=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",
!1);this.VWb=T.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.rhc=uc.isEnterpriseUser();this.ykc=m.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint");this.Fvk=Kb.a.jA(m.AFrameworkApplication.fa.Ha("AppCatalogUrl")||"");this.Awk=m.AFrameworkApplication.fa.Ha("UserPrincipalName");this.rhc&&this.$cg()}Gvj(Ab){return m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline."+Ab,"")}Ouj(){const Ab=m.AFrameworkApplication.fa.U6b,fc=m.AFrameworkApplication.fa.ty("SmartLookupFlightKeywordList"),
kc=[];if(Ab&&fc&&0<fc.length)for(let zd in Ab){var ud={key:zd,value:Ab[zd]};ud=ud&&ud.key?ud.key:"";for(let Td=0;Td<fc.length;Td++)if(-1<ud.toLowerCase().indexOf(fc[Td].toLowerCase())){const Me=ud.split(".");Me&&4===Me.length&&Array.add(kc,Me[Me.length-1])}}return kc}Z8b(Ab,fc,kc,ud){return new Promise(zd=>{this.D7j().then(Td=>{const Me=new Wa;Me.anid="";Me.applicationName=3===m.AFrameworkApplication.Aa.mb.Ti?"WORD":"POWERPNT";Me.applicationVersion=m.AFrameworkApplication.buildVersion;Me.appCorrelationId=
Ab?Ab:ha.L$a();Me.themePlatform="web";Me.lcid=m.AFrameworkApplication.lcid;Me.launchUtcTime=(new Date).toUTCString();m.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?Me.featureGates=H.c(this.Oq):Me.featureGates=H.c(this.qh);var tf=xb.a.He(m.AFrameworkApplication.lcid);tf=tf?tf.name:null;Me.market=zc(tf);Me.uiLanguage=tf;Me.sessionId=m.AFrameworkApplication.userSessionId;Me.themeId=kc;Me.parentalControl="yes";Me.processorOnlyMode=Td;Me.isEditingAllowed=fc.isEditingAllowed();Me.isFeedbackEnabled=
this.PJg;Me.isClientSideRendering=Xb(ud);Me.disableClipboard=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&m.AFrameworkApplication.Vx&&!m.AFrameworkApplication.YSa;Me.accessToken=this.rhc?this.$cg():"";Td=new ub;Td.CountryCode=zc(tf);Td.ServiceEndpoint=this.ykc;Td.IsGoLocal=m.AFrameworkApplication.fa.ka("IsGoLocalEnvironment");Td.IsEnabled=this.rhc;Td.IsEnterpriseEnabled=this.rhc;Td.TenantRoot=this.Fvk;Td.Upn=this.Awk;tf=Db();
Td.IsEUDB="PROD"===tf&&""!==m.AFrameworkApplication.fa.Ha("IntentServiceEndpoint");Me.enterpriseUserInfo=Td;Td=new db;Td.filePath=m.AFrameworkApplication.fa.Ha("EditDocInClientUrl");Td.docName=m.AFrameworkApplication.fa.Ha("FileName");Td.author=99!==ud?fc.author():null;Td.createdDate=99!==ud?fc.createdDate():null;Me.currentDocument=Td;zd(Me)})})}D7j(){return new Promise(Ab=>{this.JG?this.JG.execute(fc=>{fc.isFeatureEnabled(F.UDl,!0).then(kc=>{Ab(!kc)}).catch(kc=>{da.Lt("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+
kc.toString(),10);Ab(!0)})}):Ab(!0)})}Phh(Ab){this.VWb&&this.rhc&&this.AYc(this.ykc).then(fc=>{Ab(fc)})}$cg(){return"Dev Box"===m.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.VWb?this.VWb.$yj(this.s7,this.ykc):""}AYc(Ab){return"Dev Box"===m.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&
null!==window.SearchPaneShredderTokenOverride?new Promise(fc=>{fc(window.SearchPaneShredderTokenOverride)}):this.VWb?this.VWb.getToken(this.s7,Ab):Promise.resolve("")}Hab(){return this.f7a?this.f7a.getVersion():""}R8f(){return m.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?H.c(this.Oq):H.c(this.qh)}static isEnterpriseUser(){const Ab=m.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),fc=m.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");return(!Ab||!Ab.length)&&fc}}
Object(h.a)(uc,"SearchHelper",null,[1176]);class Yb{constructor(){Yb.La=""}getVersion(){return Yb.La}sul(Ab){Yb.La=Ab}}Yb.La=null;Object(h.a)(Yb,"SmartLookupVersion",null,[]);class Tc{}Object(h.a)(Tc,"ConfigurationProvider",null,[]);class sc{constructor(Ab){sc.La=Ab}Pbe(){return sc.La}}sc.La=null;Object(h.a)(sc,"SearchHostRuntime",null,[]);var Qb=d(135),kb=d(251),Ib=d(311),eb=d(254);class Rb{constructor(){this.WK=this.oob=this.Ea=null}get name(){return"Common.App.Insights"}Xb(Ab){this.Ea=Ab;const fc=
eb.a.Ot(T.a.instance.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>")),kc=m.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||m.AFrameworkApplication.fa.ka("SmartLookupIsEnabled");Ab.register(Za,"Common.App.Insights.InsightsActor").na().oa(()=>new Za(Ab.ue("Common.App.Insights.IInsightsManager"),m.AFrameworkApplication.Qa,n.a.instance,z.FocusManager.instance(),Ab.Ia("Common.App.SearchCommon.ISearchOAuthManager"),m.AFrameworkApplication.fa,Qb.a.instance,kc,new e.a(()=>fc.result)));Ab.register(1175,
"Common.App.Insights.IDocumentContentExtractionManager").na().oa(()=>new B(Ab));kc&&(Ab.register(Yb,"Common.App.Insights.SmartLookupVersion").na().oa(()=>new Yb),Ab.register(1176,"Common.App.SearchCommon.ISearchHelper").na().oa(()=>new uc(T.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ab.rb("Common.App.Insights.SmartLookupVersion"))))}init(){m.AFrameworkApplication.KFa&&(this.oob=this.Ea.rb("Common.App.Insights.InsightsActor"),this.oob.vb())}D6k(){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var Ab=m.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint");this.Ea.resolve("Common.App.SearchCommon.ISearchHelper").AYc(Ab).then(fc=>{var kc={};kc.Authorization="Bearer "+fc;fc=Mc();const ud=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);kc=new sa.a(fc+("?isTelemetryOnly="+ud),1,null,kc,!0,2,null);m.AFrameworkApplication.Je.send(kc).ckb(()=>{da.Lt("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
ud,50)},zd=>{da.Lt("InsightsPackage - Failed to send refreshmemory API request. Error: "+zd.toString(),10)})})}}VZi(){this.DUj();this.D6k()}DUj(){jb().then(Ab=>{if(""!==Ab){const fc=this.Ea.rb("Common.App.Insights.SmartLookupVersion");fc&&fc.sul(Ab)}this.vRc();this.oob=this.Ea.resolve("Common.App.Insights.InsightsActor");Ab=wb(Ab);Ab=Ib.a.create(Ab);Ab.sW((fc,kc)=>{kc.succeeded?this.gvl()&&this.prefetchZeroTerm():da.Lt("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
kc.ev,10);this.oob.vb()});kb.a.py(Ab)})}gvl(){const Ab=Object.assign(new Tc,{channelId:F.channelId,approvedOriginPattern:Tb()?"^(http)?://(localhost:8080)$":m.AFrameworkApplication.fa.Ha("SmartLookupApprovedOriginPattern")});var fc=this.Ea.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const kc=this.Ea.resolve("Common.App.SearchCommon.ISerpletExecutor"),ud=this.Ea.resolve("Common.App.SearchCommon.IInsertContentExecutor"),zd=new x.a;fc&&zd.add(fc);kc&&zd.add(kc);ud&&zd.add(ud);fc=bc();
try{const Td=new mb,Me=SmartLookupHostRuntime.setup(Ab,zd.toArray(),!0,fc,Td);this.Ea.register(sc,"Common.App.SearchCommon.SearchHostRuntime").na().oa(()=>new sc(Me));return!0}catch(Td){return da.Lt("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+Td,10),!1}}prefetchZeroTerm(){if(m.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var Ab=T.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime");if(Ab){const fc=this.Ea.resolve("Common.App.SearchCommon.ISearchHelper"),kc=this.Ea.resolve("Common.App.SearchCommon.IDocumentHelper");fc.Z8b(null,kc,0,99).then(ud=>{Ab.Pbe().prefetchZeroTerm(ud,m.AFrameworkApplication.userSessionId,Ya(),!0,"Indoc",null)})}else da.Lt("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}vRc(){var Ab=this.Ea.resolve("Common.App.SearchCommon.ISearchHelper");
const fc=oc(Ab.Hab());Ab=Ab.Hab();Ab=rc()+(""!==Ab?Ab:F.Zuc)+"/scripts/microsoft.office.smartlookup.ssr.js";const kc=Ka();Sa.a.Fx?this.UZi(fc,Ab):(this.SZi(fc,kc),this.TZi(Ab,kc))}SZi(Ab,fc){const kc=new Sys.Net.WebRequest;kc.set_httpVerb("GET");const ud={};ud.method=kc.get_httpVerb();kc.set_url(Ab);const zd=(new Date).getTime();try{window.fetch(kc.getResolvedUrl(),ud).then(()=>{""!==fc&&da.J_e(fc,Ab,(new Date).getTime()-zd);this.Ea.rb("Common.App.Insights.SmartLookupVersion")})}catch(Td){da.Lt("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
Td.toString(),10)}}TZi(Ab,fc){var kc=new Sys.Net.WebRequest;kc.set_httpVerb("GET");const ud={};ud.method=kc.get_httpVerb();kc.set_url(Ab);let zd=-1;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))kc=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Qb.a.instance.Hb(new ta.a(5,1,kc,()=>{const Td=Ib.a.create(Ab);Td.LAf(()=>{zd=Date.now()});Td.sW((Me,tf)=>{tf.succeeded?""!==
fc&&da.J_e(fc,Ab,Date.now()-zd):da.Lt("InsightsPackage - Failed to prefetch JS file.",10)});kb.a.py(Td)}));else{zd=Date.now();try{window.fetch(kc.getResolvedUrl(),ud).then(()=>{""!==fc&&da.J_e(fc,Ab,Date.now()-zd)})}catch(Td){da.Lt("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+Td.toString(),10)}}}UZi(Ab,fc){if(Sa.a.Fx){var kc=m.AFrameworkApplication.Je;Ab=new sa.a(Ab,1,null,null,!0,2,null);kc.send(Ab).ckb(ud=>{ud&&ud.data?ud.data.Wd?this.Ea.rb("Common.App.Insights.SmartLookupVersion"):
da.Lt("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+ud.data.Oe,10):da.Lt("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},ud=>{ud&&ud.data?da.Lt("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+ud.data.Oe,10):da.Lt("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});m.AFrameworkApplication.fa.ka("SmartLookupPrefetchJSIsEnabled")&&
(fc=new sa.a(fc,1,null,null,!0,2,null),kc.send(fc).ckb(ud=>{ud&&ud.data?ud.data.Wd||da.Lt("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+ud.data.Oe,10):da.Lt("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},ud=>{ud&&ud.data?da.Lt("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+ud.data.Oe,10):da.Lt("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",
10)}))}}dispose(){this.oob&&this.oob.dispose()}}Object(h.a)(Rb,"InsightsPackage",null,[2,3]);var pc=d(29),Wc=d(100),Ic=d(685),nd=d(1134),ob=d(549),$b=d(61),Hc=d(35);class Pb{constructor(Ab,fc,kc,ud=!0){this.streamUrl=Ab;this.objectType=fc;this.formatType=kc;this.renderAfterInsert=ud}}Object(h.a)(Pb,"InsertContentFromStreamData",null,[]);var Yc=d(389),Rd=d(30);class Gb{constructor(Ab,fc,kc){this.ia=Ab;this.pa=fc;this.ua=kc}insertOnlinePicture(Ab){const fc=Object(Na.a)(115,this.ua.Ba);Ab&&fc&&(Ab=Object.assign(new ob.a,
{Action:"Insert",Caption:Ab.caption,OriginalUrl:Ab.sourceUrl,Height:Ab.height,Width:Ab.width,LicenseDisplayName:Ab.licenseDisplayName,LicenseUrl:Ab.licenseUrl,ThumbnailUrl:Ab.thumbnailUrl,PageUrl:Ab.pageUrl}),this.ia.Ja(Rd.a.Sbb,2,Ab))}insertHtmlText(Ab){if(Ab)if(1===this.pa.Ud().length){const fc=new nd.DictionaryPropertySet;fc.setValue($b.a.aV,Ab.htmlText);fc.setValue($b.a.rmd,!1);8===this.ia.Ja(Hc.a.emd,2,fc)&&this.Amg(Ab)}else this.Amg(Ab)}Amg(Ab){Ab=Object.assign(new Yc.a,{Wlb:!1,zV:Ab.htmlText});
this.ia.Ja(Rd.a.Doa,2,Ab)}insertContentFromStreamUrl(Ab){Ab&&(Ab=new Pb(Ab.streamUrl,Ab.objectType,Ab.formatType,Ab.renderAfterInsert),this.ia.Ja(Rd.a.e0c,2,Ab))}getId(){return"InsertContentExecutor"}}Object(h.a)(Gb,"InsertContentExecutor",null,[1132,1173]);var Bb=d(1051),dc=d(195);class Xc{}Object(h.a)(Xc,"CommandMetadataResponse",null,[]);class Fb{constructor(){this.uie=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){dc.PrivacyDialogManager.gvd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(Ab){const fc=
new Xc;Ab.iconNames&&(fc.svgData=this.getCommandIconSvg(Ab.iconNames));if(!Ab.commandId||""===Ab.commandId)return fc.isVisible=!1,fc;try{fc.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),Ab.commandId);fc.isDisabled=appChrome.selectors.isControlDisabled(Ab.commandId);fc.label=appChrome.selectors.getControlLabel(Ab.commandId);if(fc.svgData&&""!==fc.svgData)return fc;const kc=appChrome.selectors.getControlIconSet(Ab.commandId),ud=Array(2);ud[0]=kc["default"];ud[1]=kc.icon32;fc.svgData=
this.getCommandIconSvg(ud)}catch(kc){return null}return fc}getCommandIconSvg(Ab){if(!this.uie)return"";for(let fc=0;fc<Ab.length;fc++){const kc=Ab[fc];if(kc in this.uie)return this.uie[kc]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(Ab){const fc={SourceControlId:"GiveFeedback"};fc.feedbackType="true"===Ab.IsPosFeedback?0:1;const kc={};kc.featureArea=Fb.v6i;fc.telemetryGroup=kc;fc.appData=Ab;return fc}}
Fb.eMj="FA000000012";Fb.K_k="AssetID=";Fb.v6i="SearchPane";Object(h.a)(Fb,"BaseSerpletExecutor",null,[1131,1173]);var kd=d(28);class od extends Fb{constructor(Ab,fc,kc){super();this.ia=Ab;this.vPg=fc;this.YEe=kc;if(!Ab)throw Error.argumentNull("m_actionManager");}openFeedbackPane(Ab){this.ia.Ja(Oa.a.lNb,2,this.createFeedbackPropertiesFromData(Ab))}openHelpTaskPane(Ab){const fc={};fc.query=Fb.K_k+Ab;Ab={};Ab.assetId=Fb.eMj;Ab.nonPersistedSettings=fc;this.ia.Ja(Rd.a.Sga,2,Ab)}browseFiles(){this.ia.Ja(Oa.a.Z0c,
2,null)}executeCommand(Ab){if(Ab)switch(Ab.CommandId){case 3:appChrome.api.executeCommand(Ab.Data.CommandId,Ab.Data.Payload);break;case 4:if(this.vPg&&this.YEe)try{this.vPg.FUj(Ab.Data.AST)}catch(fc){kd.a.J(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${fc}`)}}}}Object(h.a)(od,"PPTSerpletExecutor",Fb,[]);class Gd{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(h.a)(Gd,"BaseDocumentHelper",null,[1133]);
class Fd extends Gd{constructor(){super()}isEditingAllowed(){return pc.App.Mb.Ld.isEditingAllowed}}Object(h.a)(Fd,"PptDocumentHelper",Gd,[]);class ee{constructor(){this.lAc=this.AI=null}C1d(){return null}gUa(){return this.iab()}Cmj(){return this.iab()}aBl(Ab,fc,kc){this.AI||(this.AI=this.kPc());this.AI.kl(Ab,fc,kc)}bBl(Ab,fc,kc){this.AI||(this.AI=this.kPc());this.AI.a4e(Ab,fc,kc)}Bzl(Ab,fc){this.lAc||(this.lAc=this.C1d());this.lAc&&this.lAc.a4e(Ab,fc)}Nsd(Ab,fc){this.AI||(this.AI=this.kPc());this.AI.Nsd(Ab,
fc)}Yse(Ab){this.AI||(this.AI=this.kPc());this.AI.Yse(Ab)}aml(){this.AI&&this.AI.O_e()}E0e(){this.AI&&this.AI.Fpl()}Zyl(){var Ab=m.AFrameworkApplication.fa.uc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);Ab=window.performance.now()-ee.Cwg<=Ab;Ab||(ee.Cwg=window.performance.now());return Ab}dispose(){this.AI&&(this.AI.dispose(),this.AI=null)}get fcc(){return this.AI?this.AI.isVisible:!1}}ee.Cwg=0;Object(h.a)(ee,"InsightsManager",null,[529,108]);class Bf{constructor(Ab,fc,kc,ud,zd,Td=!0,
Me=null,tf=null){this.FK=this.Hp=this.jia=null;this.bPa=!1;this.WK=null;this.Pd=fc;this.qJd=Td;this.bUb=tf?tf:new Gd;this.JG=Me;this.QK=Ab;this.qJd&&(T.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime")&&(this.WK=T.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Pbe()),this.iW=T.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.f7a=this.iW.Hab())}wib(Ab){if(this.qJd){Ab=Ab.rawEvent;try{var fc=H.a(Ab.data)}catch(kc){D.ULS.sendTraceTag(595161728,1303,15,this.Fka("Message data from Serplet [{0}] failed to deserialize.",
Ab.data));return}switch(fc.actionType){case 101:Ab=0;this.Hp&&(Ab=this.Hp.entryPoint);this.iW.Z8b(this.FK,this.bUb,this.CUa(),Ab).then(kc=>{fc.data=kc;this.oKb(fc)});break;case 118:fc.data=this.Hp?this.Hp:Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:this.jia.neighborhood,mentionStart:this.jia.mentionStart,mentionLength:this.jia.mentionLength})});this.oKb(fc);break;case 103:Ab=H.a(Object(Na.a)(String,fc.data));da.sendTelemetryEvent(Ab);break;case 206:this.iW.AYc(fc.data).then(kc=>
{fc.data=kc;this.oKb(fc)});break;case 112:fc.data.shiftPressed?(Sa.a.mg&&document.activeElement.blur(),this.QK.jZc(0,null,2,null,null),D.ULS.sendTraceTag(592545156,1303,50,this.Fka("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.QK.KUa(0,null,2,null,null),D.ULS.sendTraceTag(592545155,1303,50,this.Fka("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Kq()}}}$kb(Ab){if(this.WK){var fc=0;this.Hp&&(fc=this.Hp.entryPoint);this.iW.Z8b(this.FK,this.bUb,this.CUa(),fc).then(kc=>{da.Lsd("SearchFromHost",
this.FK);this.Hp.launchData||(this.Hp.launchData=new Ea.a);const ud=Ya();try{this.WK.search(this.Hp,kc,m.AFrameworkApplication.userSessionId,ud,Ab),this.iW.Phh(zd=>{da.Lsd("SearchFromHostWithToken",this.FK);this.WK.searchAuthenticatedProviders(this.Hp,kc,m.AFrameworkApplication.userSessionId,ud,null,zd)})}catch(zd){da.Lt("BaseSmartLookupPane - Fail to search from host. Error: "+zd,10)}}).catch(kc=>{da.Lt("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+kc.toString(),
10)})}}etc(Ab){this.qJd&&da.etc(this.FK,Math.round(window.performance.now()-Ab),this.Hp?Y.a[this.Hp.entryPoint]:"",this.iW.Hab(),this.iW.R8f(),m.AFrameworkApplication.zKc,this.bPa,Xb(this.Hp?this.Hp.entryPoint:0))}}Object(h.a)(Bf,"BaseSmartLookupPane",null,[1232,108]);class be{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(h.a)(be,"SmartLookupTaskPaneProps",null,[]);var af=d(659);class Ue{}Object(h.a)(Ue,"ActionDescriptor",null,[]);var qf=d(99);class Xa extends Bf{constructor(Ab,fc,kc,
ud=null,zd=null,Td=null,Me=!0,tf=null,re=null){super(fc,kc,ud,zd,Td,Me,tf,re);this.YQd=!!m.AFrameworkApplication.Aa&&!!m.AFrameworkApplication.Aa.mb&&m.AFrameworkApplication.Aa.mb.Nre;this.sqb=this.dOd=!1;this.l5h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.k5h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.p5h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",
1366);this.o5h=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);Me||da.Lt("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.dra=Ab;this.jkf=oc(this.f7a)}get isVisible(){return this.sqb}Nsd(Ab,fc){this.Hp=Ab;this.jia=Ab=Object.assign(new L.a,{neighborhood:Ab.selection.neighborhood,mentionStart:Ab.selection.mentionStart,mentionLength:Ab.selection.mentionLength});this.bPa=!Ab.mentionLength;this.FK=fc;this.$kb(!1)}Yse(Ab){this.Hp=
Ab;this.qza(Object.assign(new L.a,{neighborhood:Ab.selection.neighborhood,mentionStart:Ab.selection.mentionStart,mentionLength:Ab.selection.mentionLength}),!1)}kl(Ab,fc){this.FK=fc;this.qza(Ab,!0)}a4e(Ab,fc,kc){this.Hp=Ab;this.kl(Object.assign(new L.a,{neighborhood:Ab.selection.neighborhood,mentionStart:Ab.selection.mentionStart,mentionLength:Ab.selection.mentionLength}),fc,kc)}Kq(){this.vtd();this.dra.hideTaskPane()}qza(Ab,fc){ka.SessionStatusManager.instance.o0&&this.WK?(this.jia=Ab,this.bPa=!Ab.mentionLength,
Ab=window.performance.now(),this.initialize(),this.isVisible?m.AFrameworkApplication.fa.ka("SmartLookupDisableRefreshPaneIsEnabled")?(this.dra.updateTaskPane(null),fc&&this.Bml()):(fc&&this.$kb(!1),this.dOd=!this.dOd,this.dra.updateTaskPane(this.rda())):(fc&&this.$kb(this.isVisible),this.dra.showTaskPane(this.rda())),this.etc(Ab)):(this.dra.showTaskPane(this.rda()),da.dml(ka.SessionStatusManager.instance.o0,!!this.WK,this.Hp?Y.a[this.Hp.entryPoint]:"",this.iW.Hab(),m.AFrameworkApplication.zKc,this.bPa))}Bml(){if(!this.Hp){const Ab=
Object.assign(new aa.a,{neighborhood:this.jia.neighborhood,mentionStart:this.jia.mentionStart,mentionLength:this.jia.mentionLength});this.Hp=Object.assign(new fa.a,{selection:Ab,userIntent:null,entryPoint:0,launchData:null})}this.$kb(this.isVisible)}mml(){const Ab=new Ue;Ab.transactionId=this.FK;Ab.actionType=15;Ab.channelId=F.channelId;this.oKb(Ab)}wib(Ab){const fc=Ab.rawEvent;document.getElementById(F.uZ)&&fc.source!==document.getElementById(F.uZ).contentWindow||this.Z3k(Ab)}Z3k(Ab){const fc=Ab.rawEvent;
let kc;try{kc=H.b(fc.data)}catch(ud){D.ULS.sendTraceTag(545604257,1303,15,this.Fka("Message data from Serplet [{0}] failed to deserialize.",fc.data));return}switch(kc.actionType){case 32:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(qf.a.MYc()>=this.l5h?this.dra.updateTaskPane(this.N2d(this.k5h)):qf.a.MYc()>=this.p5h&&this.dra.updateTaskPane(this.N2d(this.o5h)));break;case 33:m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",
!1)&&this.dra.updateTaskPane(this.N2d(kc.data));break;case 42:this.dra.updateTaskPane(this.ASi(kc.data));break;case 43:this.dra.updateTaskPane(this.rda());break;default:super.wib(Ab)}}dispose(){}initialize(){this.Llb()}Llb(){const Ab=this.Pd.Ic(F.uZ);Ab.parent=Fa.AFrame.$i;Ab.zJ=!0}LLa(){this.Pd.wf(F.uZ)}vtd(){this.Mre()&&this.Pd.wf(this.Pd.M8)}lWe(){$addHandler(window,"message",Object(w.a)(this,this.wib,"onIFrameMessage"))}x$e(){$removeHandler(window,"message",Object(w.a)(this,this.wib,"onIFrameMessage"))}Mre(){return!!this.Pd.Ee&&
this.Pd.Ee.name===F.uZ}oKb(Ab){Ab=H.c(Ab);document.getElementById(F.uZ)&&document.getElementById(F.uZ).contentWindow.postMessage(Ab,Kb.a.KQ(this.jkf))}Fka(Ab,...fc){const kc={};this.FK&&(kc[F.uKh]=this.FK);kc[F.vKh]=String.format.apply(null,[Ab].concat(fc));return H.c(kc)}CUa(){return pa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}Ceh(){if(this.WK)this.WK.onPaneThemeChanged(this.CUa());return pa.a("getTheme")?appChrome.api.getTheme():null}O_e(){}Fpl(){document.getElementById(F.uZ)&&
z.FocusManager.Zq(document.getElementById(F.uZ).contentWindow)}NNe(){da.Lt("ReactSmartLookupPane - Iframe component failed to load.",10)}oIk(){m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||da.Lt("ReactSmartLookupPane - Onload detected no network.",50)}tjj(){return this.Hp?10===this.Hp.entryPoint?2===m.AFrameworkApplication.Aa.mb.Ti?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:
18===this.Hp.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.Hp.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.Hp.entryPoint||38===this.Hp.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}rda(){var Ab=CommonUIStrings.L_SmartLookupPaneTitle;m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(Ab=this.tjj());const fc=new be;fc.src=this.jkf;fc.id=F.uZ;fc.refreshPane=
this.dOd;fc.onError=Object(w.a)(this,this.NNe,"onIFrameError");fc.onLoad=Object(w.a)(this,this.oIk,"onIFrameLoad");fc.title=Ab;ka.SessionStatusManager.instance.o0?this.WK||(fc.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,fc.errorType=1):(fc.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,fc.errorType=0);Ab=Object.assign(new af.a,{title:Ab,hideHeader:!1,width:F.width,location:F.FPk,contentProps:fc,isModernPane:!0,onOpen:()=>{this.LLa();this.sqb=!0;this.lWe();
pa.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(w.a)(this,this.Ceh,"onThemeIdChanged"));m.AFrameworkApplication.Aa.updateCommandUI();if(this.WK)this.WK.onPaneStateChanged(!0)},onClose:()=>{this.mml();this.vtd();this.sqb=!1;this.x$e();pa.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(w.a)(this,this.Ceh,"onThemeIdChanged"));m.AFrameworkApplication.Aa.updateCommandUI();if(this.WK)this.WK.onPaneStateChanged(!1)}});this.YQd&&
(Ab.enableResize=!0,Ab.minResizeWidth=320,Ab.maxResizeWidth=920);return Ab}ASi(Ab){const fc=this.rda();fc.title=Ab;fc.contentProps.title=Ab;return fc}N2d(Ab){const fc=this.rda();fc.resizeWidth=Ab;return fc}}Object(h.a)(Xa,"ReactSmartLookupPane",Bf,[]);var vb=d(143);class cc{constructor(){this.Bmf=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(Ab){vb.UISurfaces.Iq().then(fc=>{this.Bmf||(Ab.enableResize=!1);fc.showTaskPane(F.uZ,
Ab);return null})}updateTaskPane(Ab=null){vb.UISurfaces.Iq().then(fc=>{fc.setSelectedTaskPane(F.uZ);Ab&&(this.Bmf||(Ab.enableResize=!1),fc.updateTaskPane(F.uZ,Ab));return null})}hideTaskPane(){vb.UISurfaces.Iq().then(Ab=>{Ab.hideTaskPane(F.uZ,2);return null})}}Object(h.a)(cc,"PptReactSmartLookupPaneHandler",null,[1194]);class wc{static Eee(){switch(m.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":m.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")?
"PROD":m.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")?"INT":wc.Vjj()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";default:return"WAC.PROD.URL"}}static Vjj(){switch(Object(Na.a)(String,m.AFrameworkApplication.Md.AudienceGroup)||""){case "Dogfood":if(m.AFrameworkApplication.fa){let Ab=m.AFrameworkApplication.fa.Ha("UserPrincipalName");Ab=gc.a.ug(Ab);const fc=m.AFrameworkApplication.fa.gu("SmartLookupINTEnabledForSKITeam")?m.AFrameworkApplication.fa.ty("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(fc,Ab)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}}Object(h.a)(wc,"Utils",null,[]);class Ad{constructor(Ab,fc=null){this.FK=this.Hp=this.jia=null;this.bPa=!1;this.WK=null;this.QK=Ab;this.bUb=fc?fc:new Gd;T.a.instance.rb("Common.App.SearchCommon.SearchHostRuntime")&&(this.WK=T.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Pbe());this.iW=T.a.instance.resolve("Common.App.SearchCommon.ISearchHelper");this.f7a=this.iW.Hab()}$kb(Ab){if(this.WK){var fc=0;
this.Hp&&(fc=this.Hp.entryPoint);this.iW.Z8b(this.FK,this.bUb,this.CUa(),fc).then(kc=>{da.Lsd("SearchFromHost",this.FK);this.Hp.launchData||(this.Hp.launchData=new Ea.a);const ud=Ya();try{this.WK.search(this.Hp,kc,m.AFrameworkApplication.userSessionId,ud,Ab),this.iW.Phh(zd=>{da.Lsd("SearchFromHostWithToken",this.FK);this.WK.searchAuthenticatedProviders(this.Hp,kc,m.AFrameworkApplication.userSessionId,ud,null,zd)})}catch(zd){da.Lt("BaseSmartLookupPane - Fail to search from host. Error: "+zd,10)}}).catch(kc=>
{da.Lt("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+kc.toString(),10)})}}lWe(){$addHandler(window,"message",Object(w.a)(this,this.wib,"onIFrameMessage"))}x$e(){$removeHandler(window,"message",Object(w.a)(this,this.wib,"onIFrameMessage"))}oKb(Ab){Ab=H.c(Ab);document.getElementById(this.Myb())&&document.getElementById(this.Myb()).contentWindow.postMessage(Ab,Kb.a.KQ(rc()))}wib(Ab){let fc;Ab=Ab.rawEvent;try{fc=H.b(Ab.data)}catch(kc){D.ULS.sendTraceTag(509614105,
1303,15,this.Fka("Message data from Serplet [{0}] failed to deserialize.",Ab.data));return}switch(fc.actionType){case 103:Ab=H.b(Object(Na.a)(String,fc.data));da.sendTelemetryEvent(Ab);break;case 206:this.iW.AYc(fc.data).then(kc=>{fc.data=kc;this.oKb(fc)});break;case 112:fc.data.shiftPressed?(Sa.a.mg&&document.activeElement.blur(),this.QK.jZc(0,null,2,null,null),D.ULS.sendTraceTag(509614104,1303,50,this.Fka("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.QK.KUa(0,null,2,null,null),D.ULS.sendTraceTag(509614103,
1303,50,this.Fka("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Kq()}}Fka(Ab,...fc){const kc={};this.FK&&(kc[F.uKh]=this.FK);kc[F.vKh]=String.format.apply(null,[Ab].concat(fc));return H.c(kc)}etc(Ab){da.etc(this.FK,Math.round(window.performance.now()-Ab),this.Hp?Y.a[this.Hp.entryPoint]:"",this.iW.Hab(),this.iW.R8f(),m.AFrameworkApplication.zKc,this.bPa,Xb(this.Hp?this.Hp.entryPoint:0))}}Ad.$ni="AppProperties";Ad.QDl="SmartLookupApplicationInterface";Object(h.a)(Ad,"BaseCopilotAddin",
null,[1233,108]);class Md extends Ad{constructor(Ab,fc,kc,ud){if(!Ab)throw Error.argumentNull("actionManager");if(!fc)throw Error.argumentNull("appForOfficeManager");if(!ud)throw Error.argumentNull("f6Manager");super(ud,kc);this.Ab=!1;this.UJg=!0;this.vAg="FA000000006";this.ia=Ab;this.Oc=fc;this.Ns={};this.Nuk=wc.Eee();this.Ns.sourceLocationOverrideResourceId=this.Nuk;this.Ns.cB="Copilot";this.Ns.assetId=this.vAg}a4e(Ab,fc){this.Hp=Ab;const kc=Object.assign(new L.a,{neighborhood:Ab.selection.neighborhood,
mentionStart:Ab.selection.mentionStart,mentionLength:Ab.selection.mentionLength});this.FK=fc;this.jia=kc;this.bPa=!kc.mentionLength;ka.SessionStatusManager.instance.o0&&this.WK?(this.$kb(!1),this.iW.Z8b(this.FK,this.bUb,this.CUa(),Ab.entryPoint).then(ud=>{ud.isFirstLaunch=this.UJg;this.UJg=!1;const zd={};zd[Ad.QDl]=this.Hp;zd[Ad.$ni]=ud;this.Ns.nonPersistedSettings=zd;this.Ns.n6=Object(w.a)(this,this.zib,"onPaneRendered");this.ia.Ja(Rd.a.Sga,2,this.Ns);this.Ab=!0})):(this.ia.Ja(Rd.a.Sga,2,this.Ns),
this.Ab=!0)}zib(){this.lWe()}Kq(){const Ab=this.Myb();this.x$e();Ab&&this.ia&&this.ia.Ja(Rd.a.hvb,2,Ab);this.Ab=!1}Nsd(Ab,fc){this.Hp=Ab;this.jia=Ab=Object.assign(new L.a,{neighborhood:Ab.selection.neighborhood,mentionStart:Ab.selection.mentionStart,mentionLength:Ab.selection.mentionLength});this.bPa=!Ab.mentionLength;this.FK=fc;this.$kb(!1)}dispose(){}Myb(){if(this.Oc.instance){const Ab=this.Oc.instance.HQ(this.vAg+"."+this.Ns.sourceLocationOverrideResourceId);if(Ab)return Ab.instanceId;kd.a.J(509433935,
1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else kd.a.J(509433934,1313,15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");return null}CUa(){return pa.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.Ab}}Object(h.a)(Md,"PptCopilotAddin",Ad,[]);class Sd extends ee{constructor(Ab,fc,kc,ud,zd){super();this.P_g=Ab;this.Ib=kc;this.ia=ud;this.Oc=zd}kPc(){const Ab=this.Ib.ka("822");return new Xa(new cc,n.a.instance,z.FocusManager.instance(),
T.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),T.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),T.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Ab,T.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}C1d(){return this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?new Md(this.ia,this.Oc,null,n.a.instance):super.C1d()}iab(){return this.P_g.getSelectedText()}lrg(){return this.P_g.aZj()}}
Object(h.a)(Sd,"SmartLookupManager",ee,[]);var Le=d(134);class fe{constructor(Ab,fc,kc,ud,zd,Td,Me){this.pU=Ab;this.Fb=fc;this.Mvk=kc;this.$tk=ud;this.Huk=zd;this.Jmk=Td;this.m2g=Me;this.sHa=new Map;if(!Ab)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!fc)throw Error.argumentNull("m_transactionFactory");if(!kc)throw Error.argumentNull("m_textODSLEntity");if(!ud)throw Error.argumentNull("m_shapeODSLEntity");if(!zd)throw Error.argumentNull("m_slideODSLEntity");if(!Td)throw Error.argumentNull("m_imageODSLEntity");
if(!Me)throw Error.argumentNull("m_tablesODSLEntity");this.pU&&this.pU.execute(tf=>{this.Oc=tf});this.sHa=new Map;this.sHa.set("text",this.Mvk);this.sHa.set("shapes",this.$tk);this.sHa.set("slides",this.Huk);this.sHa.set("images",this.Jmk);this.sHa.set("tables",this.m2g);this.sHa.set("table",this.m2g)}LJi(Ab,fc){return Object.assign({},...Ab.map(kc=>fc.has(kc.value)?{[kc.name]:fc.get(kc.value)}:{[kc.name]:JSON.parse(kc.value)}))}FUj(Ab){Object(Le.a)(this,void 0,void 0,function*(){if(this.Oc){var fc=
this.Fb.ke(15);try{fc.jc(this.Oc.hO.presentation);const kc=new Map;for(const ud of Ab.statements){const zd=ud.name.split("_");if(2!==zd.length)throw Error.argumentOutOfRange("statement",zd,"Provided ODSL statement does not have expected format of action_entity.");const Td=zd[0],Me=zd[1];if(!this.sHa.has(Me))throw Error.argumentOutOfRange("entityName",Me,"Provided entity name in ODSL statement is not supported.");const tf=this.sHa.get(Me);if(!tf)throw Error.argumentOutOfRange("entity",tf,"Could not access entity for provided ODSL statement.");
const re=this.LJi(ud.arguments,kc);if(!re)throw Error.argumentOutOfRange("args",re,"Could not construct ODSL statement input from provided args.");let lh;switch(Td){case "select":lh=yield tf.select(re);break;case "format":lh=yield tf.format(re);break;case "insert":lh=yield tf.insert(re);break;case "delete":lh=yield tf.delete(re);break;case "default":throw Error.argumentOutOfRange("action",Td,"Provided action in ODSL statement is not supported.");}ud.returnVariable&&lh&&kc.set(ud.returnVariable,lh)}}catch(kc){kd.a.J(509440020,
1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${kc}`)}finally{fc&&fc.dispose()}}else kd.a.J(509440021,1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")})}}Object(h.a)(fe,"ODSLInterpreter",null,[1171]);var Vf=d(48),Cd;(function(Ab){Ab.Idle="Idle";Ab.TranscribingVoice="TranscribingVoice";Ab.EndPending="EndPending";Ab.EndPendingWithCancel="EndPendingWithCancel";Ab.CancelPending=
"CancelPending"})(Cd||(Cd={}));Object(h.b)("DictationState",Cd);class Sc{constructor(Ab,fc,kc,ud,zd){this.Ub=Ab;this.ia=fc;this.Gg=kc;this.Fa=ud;this.yAe=[];this.R6c=[];this.HJ=Cd.Idle;this.had=!1;this.heb=Vf.a.o1d;this.onAction=Td=>{if(Td)switch(Td.actionType){case "SubmitQuery":this.OJj(Td.query);break;case "ToggleDictation":this.eGj();break;case "CancelQuery":this.NJj()}};this.Iae=()=>[this.yAe.join(" "),this.R6c.join()].join(" ");if(!this.Ub)throw Error.argumentNull("m_workspace");if(!this.ia)throw Error.argumentNull("m_actionManager");
if(!this.Gg)throw Error.argumentNull("m_f6Manager");if(!this.Fa)throw Error.argumentNull("m_focusManager");if(!zd)throw Error.argumentNull("actorFuture");zd.execute(()=>{this.start().catch(Td=>{D.ULS.sendTraceTag(509440287,1313,10,`Unable to start Copilot UX, error: ${Td}`)})})}gfe(){this.MJj();return""}oeg(){return""}mvc(){this.xJj();return!0}gEa(){this.IEj()}tDf(Ab){this.QCj(Ab);return!0}zmg(Ab){this.UEj(Ab);return!0}K6g(){}IMb(Ab){var fc,kc;D.ULS.sendTraceTag(509113183,1313,15,`Unexpected "${Ab}" called for Dictation FSM state: "${this.HJ}". Listening: "${this.had}"`);
this.had?(this.HJ=Cd.EndPending,this.Txd()):(this.HJ=Cd.Idle,null===(kc=null===(fc=this.hHa)||void 0===fc?void 0:fc.setMicState)||void 0===kc?void 0:kc.call(fc,!1))}EQh(Ab){var fc,kc;null===(kc=null===(fc=this.hHa)||void 0===fc?void 0:fc.setMicState)||void 0===kc?void 0:kc.call(fc,Ab)}MJj(){this.HJ!==Cd.Idle&&this.HJ!==Cd.EndPending?this.IMb("handleTextBeforeSelection"):(this.HJ=Cd.TranscribingVoice,this.EQh(!0))}xJj(){this.HJ!==Cd.TranscribingVoice&&this.HJ!==Cd.EndPending?this.IMb("handleStartTurn"):
this.HJ=Cd.TranscribingVoice}IEj(){switch(this.HJ){case Cd.EndPending:case Cd.EndPendingWithCancel:this.EQh(!1);const Ab=this.Iae();0<Ab.length&&this.HJ===Cd.EndPending&&this.Nch(Ab);this.yAe=[];this.R6c=[];this.HJ=Cd.Idle;break;case Cd.CancelPending:this.HJ=Cd.EndPendingWithCancel;break;case Cd.TranscribingVoice:this.HJ=Cd.EndPending;break;case Cd.Idle:break;default:this.IMb("handleEndTurn")}}RJj(){this.HJ!==Cd.TranscribingVoice?this.IMb("handleTimeout"):this.HJ=Cd.CancelPending}QCj(Ab){var fc,kc;
this.HJ!==Cd.TranscribingVoice?this.IMb("handleAppendText"):this.hHa&&(this.R6c.push(Ab),null===(kc=(fc=this.hHa).setQuery)||void 0===kc?void 0:kc.call(fc,this.Iae()))}UEj(Ab){var fc,kc;this.HJ!==Cd.TranscribingVoice?this.IMb("handleFinalText"):(this.R6c=[],""===Ab?this.RJj():this.hHa&&(this.yAe.push(Ab),null===(kc=(fc=this.hHa).setQuery)||void 0===kc?void 0:kc.call(fc,this.Iae())))}OJj(Ab){this.HJ!=Cd.Idle?this.Txd():this.Nch(Ab)}NJj(){this.HJ!==Cd.Idle&&(this.Txd(),this.HJ=Cd.CancelPending)}eGj(){this.Txd()}Txd(){this.ia.Ja(Hc.a.Iwc,
2,{sVf:Sc.VUh});this.had=!this.had}Nch(Ab){Ab=Object.assign(new fa.a,{selection:Object.assign(new aa.a,{neighborhood:Ab,mentionStart:0,mentionLength:Ab.length}),launchData:Object.assign(new Ea.a,{landingTab:"Copilot"}),entryPoint:0});this.ia.Ja(Oa.a.Y0c,2,Ab)}ghj(){var Ab;this.Yeb||(this.Yeb=document.createElement("div"),this.Yeb.id="copilotHost",(null!==(Ab=document.getElementById(Sc.tyi))&&void 0!==Ab?Ab:document.body).appendChild(this.Yeb));return this.Yeb}fvl(){this.Fa.O_b(this.heb);const Ab=
this.Fa.Ic(this.heb);Ab.parent=Fa.AFrame.$i;Ab.zJ=!0;Ab.n8(()=>{var fc;null===(fc=this.hHa)||void 0===fc?void 0:fc.focus()});this.Gg.cja(this.heb);this.Gg.hL(this.heb);this.Yeb.addEventListener("focusin",fc=>{var kc;fc.preventDefault();fc.stopPropagation();(null===(kc=this.Fa.Ee)||void 0===kc?void 0:kc.name)!==this.heb&&this.Fa.cV(this.heb,!1)});this.Yeb.addEventListener("focusout",fc=>{var kc,ud,zd;fc.preventDefault();fc.stopPropagation();for(fc=null!==(kc=fc.relatedTarget)&&void 0!==kc?kc:document.activeElement;fc;){if(fc===
this.Yeb)return;fc=fc.parentElement}null===(zd=null===(ud=this.hHa)||void 0===ud?void 0:ud.collapse)||void 0===zd?void 0:zd.call(ud);this.Fa.J1(this.heb,!1)})}start(){return Object(Le.a)(this,void 0,void 0,function*(){const Ab=this.ghj();this.hHa=yield(yield vb.UISurfaces.fhj()).renderCopilot(Ab,{onAction:this.onAction});if(!this.hHa)throw Error("Copilot control interface is not returned.");this.fvl()})}}Sc.tyi="WACViewPanelContainer";Sc.VUh="PowerPointWebEditor.SmartLookup.FABDictationHost";Object(h.a)(Sc,
"PptCopilot",null,[663]);var jg=d(982),mg=d(978),Pa=d(981),bb=d(1078),Fc=d(977),yd=d(994),ge=d(340),rb=d(983);class gf extends Rb{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){m.AFrameworkApplication.vza&&this.VZi()}Xb(Ab){super.Xb(Ab);Ab.register(Ic.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").na().oa(()=>new Ic.a);Ab.register(Sd,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").na().oa(()=>
new Sd(Ab.resolve("Common.App.Insights.IInsightsSelection"),Ab,Ab.resolve("Common.IAppSettingsManager"),Ab.resolve("Common.IActionManagerExtended"),Ab.Ia("PowerPointWebEditor.IAppForOfficeManager")));Ab.register(1130,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").na().oa(()=>new Bb.a(new e.a(()=>pc.App.Mb?pc.App.Mb.Ld.Di:null),Wc.InteractiveViewManager.instance,Ab.resolve("Box4.ISelectionFactory"),Ab.resolve("PowerPointWebEditor.ISlideReader"),
Ab.resolve("PowerPointWebEditor.IPPTWorkspace"),Ab.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new r.a,Ab.resolve("Common.IActionManagerExtended"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("PowerPointWebEditor.IClipServiceManager"),Ab.resolve("PowerPointWebEditor.IPresentationReader")));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(Ab.register(ge.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").na().oa(()=>
new ge.a(Ab.resolve("Box4.Graph.IGraphIteratorFactory"),Ab.resolve("Box4.IOutlineEditor"),Ab.resolve("Box4.IOutlineElementNavigator"),Ab.resolve("Box4.ICharacterPropertiesEditor"))),Ab.register(Fc.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").na().oa(()=>new Fc.a(Ab.Ia("PowerPointWebEditor.AppForOfficeManager"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("Box4.IFormattingEditor"),Ab.resolve("Box4.IParagraphEditor"),
Ab.resolve("PowerPointWebEditor.IShapeReader"),Ab.resolve("Box4.List.IListEditor"),Ab.resolve("Box4.ICharacterPropertiesEditor"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Ab.register(mg.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").na().oa(()=>new mg.a(Ab.Ia("PowerPointWebEditor.AppForOfficeManager"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),
Ab.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),Ab.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),Ab.resolve("PowerPointWebEditor.IShapeReader"),Ab.resolve("PowerPointWebEditor.IShapeEditor"),Ab.resolve("PowerPointWebEditor.IPPTUnitConversion"),Ab.resolve("PowerPointWebEditor.View.IPPTPageView"),Ab.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Ab.resolve("PowerPointWebEditor.IRibbonChangeManager"))),Ab.register(Pa.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").na().oa(()=>
new Pa.a(Ab.Ia("PowerPointWebEditor.AppForOfficeManager"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Ab.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),Ab.register(jg.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").na().oa(()=>new jg.a(Ab.Ia("PowerPointWebEditor.AppForOfficeManager"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"))),
Ab.register(bb.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").na().oa(()=>new bb.a(Ab.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Ab.resolve("PowerPointWebEditor.IFocusManager"),Ab.resolve("PowerPointWebEditor.IShapeEditor"),Ab.resolve("PowerPointWebEditor.IRibbonChangeManager"),Ab.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
Ab.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Ab.resolve("Common.IActionManagerExtended"),Ab.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Ab.register(yd.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLContext").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext").na().oa(()=>new yd.a(Ab.Ia("PowerPointWebEditor.AppForOfficeManager"),Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),
Ab.resolve("PowerPointWebEditor.IShapeReader"))),Ab.register(fe,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter").na().oa(()=>new fe(Ab.Ia("PowerPointWebEditor.AppForOfficeManager"),Ab.resolve("Common.Transaction.ITransactionFactory"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),
Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"))),Ab.register(rb.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").na().oa(()=>new rb.a(Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ab.resolve("Common.Transaction.ITransactionFactory"),
Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),Ab.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));Ab.register(1131,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").na().oa(()=>new od(Ab.resolve("Common.IActionManagerExtended"),
Ab.rb("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter"),Ab.rb("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext")));Ab.register(1132,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").na().oa(()=>new Gb(m.AFrameworkApplication.Qa,Ab.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));Ab.register(1133,"Common.App.SearchCommon.IDocumentHelper").na().oa(()=>new Fd);
m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(Ab.register(Sc,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.FABDictationHost").na().oa(()=>new Sc(Ab.resolve("PowerPointWebEditor.IPPTWorkspace"),Ab.resolve("Common.IActionManagerExtended"),n.a.instance,z.FocusManager.instance(),Ab.Ia("Common.App.Insights.InsightsActor"))),Ab.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){t.a.instance.Ac(new gf)}}
Object(h.a)(gf,"PptSmartLookupPackage",Rb,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");gf.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.smartlookup.js.map