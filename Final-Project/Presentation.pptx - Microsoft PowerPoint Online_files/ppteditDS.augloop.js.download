'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1183:function(K,S,d){d.d(S,"b",function(){return h});d.d(S,"a",function(){return e});const {AugLoopTextEncoder:h,AugLoopTextDecoder:e}=(()=>{if("undefined"===typeof TextEncoder){d(1184);const r={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};TextDecoder=TextEncoder=void 0;return r}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},1184:function(K,S,d){(function(h,e){(function(r){function m(C,
O,U){if(C)throw Error("".concat("Failed to ").concat(O,": the '").concat(U,"' option is unsupported."));}function n(C){return e.from(C)}function z(C,O){var U;return C instanceof e?U=C:U=e.from(C.buffer,C.byteOffset,C.byteLength),U.toString(O)}function t(C){for(var O=0,U=Math.min(65536,C.length+1),T=new Uint16Array(U),ca=[],N=0;;){var da=O<C.length;if(!da||N>=U-1){if(ca.push(String.fromCharCode.apply(null,T.subarray(0,N))),!da)return ca.join("");C=C.subarray(O);N=O=0}da=C[O++];if(0===(da&128))T[N++]=
da;else if(192===(da&224)){var Y=C[O++]&63;T[N++]=(da&31)<<6|Y}else if(224===(da&240)){Y=C[O++]&63;var fa=C[O++]&63;T[N++]=(da&31)<<12|Y<<6|fa}else if(240===(da&248)){Y=C[O++]&63;fa=C[O++]&63;var aa=C[O++]&63;da=(da&7)<<18|Y<<12|fa<<6|aa;65535<da&&(da-=65536,T[N++]=da>>>10&1023|55296,da=56320|da&1023);T[N++]=da}}}function x(C){for(var O=0,U=C.length,T=0,ca=Math.max(32,U+(U>>>1)+7),N=new Uint8Array(ca>>>3<<3);O<U;){var da=C.charCodeAt(O++);if(55296<=da&&56319>=da){if(O<U){var Y=C.charCodeAt(O);56320===
(Y&64512)&&(++O,da=((da&1023)<<10)+(Y&1023)+65536)}if(55296<=da&&56319>=da)continue}T+4>N.length&&(ca+=8,ca*=1+O/C.length*2,ca=ca>>>3<<3,Y=new Uint8Array(ca),Y.set(N),N=Y);if(0===(da&4294967168))N[T++]=da;else{if(0===(da&4294965248))N[T++]=da>>>6&31|192;else if(0===(da&4294901760))N[T++]=da>>>12&15|224,N[T++]=da>>>6&63|128;else if(0===(da&4292870144))N[T++]=da>>>18&7|240,N[T++]=da>>>12&63|128,N[T++]=da>>>6&63|128;else continue;N[T++]=da&63|128}}return N.slice?N.slice(0,T):N.subarray(0,T)}function B(){this.encoding=
"utf-8"}function D(C,O){m(O&&O.fatal,"construct 'TextDecoder'","fatal");C=C||"utf-8";var U;if(w?U=e.Noe(C):U=-1!==L.indexOf(C.toLowerCase()),!U)throw new RangeError("".concat(Q," encoding label provided ('").concat(C,"') is invalid."));this.encoding=C;this.ignoreBOM=this.fatal=!1}var w="function"==typeof e&&e.from,J=w?n:x;B.prototype.encode=function(C,O){return m(O&&O.stream,"encode","stream"),J(C)};var F=!w&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,
L=["utf-8","utf8","unicode-1-1-utf-8"],M=t;w?M=z:F&&(M=function(C){try{a:{try{var O=URL.createObjectURL(new Blob([C],{type:"text/plain;charset=UTF-8"}));var U=new XMLHttpRequest;var T=(U.open("GET",O,!1),U.send(),U.responseText);break a}finally{O&&URL.revokeObjectURL(O)}T=void 0}return T}catch(ca){return t(C)}});var Q="".concat("Failed to "," ").concat("construct 'TextDecoder'",": the ");D.prototype.decode=function(C,O){m(O&&O.stream,"decode","stream");var U;return C instanceof Uint8Array?U=C:C.buffer instanceof
ArrayBuffer?U=new Uint8Array(C.buffer):U=new Uint8Array(C),M(U,this.encoding)};r.TextEncoder=r.TextEncoder||B;r.TextDecoder=r.TextDecoder||D})("undefined"!==typeof window?window:"undefined"!==typeof h?h:this)}).call(this,d(1E3),d(706).bBd)},1185:function(K,S){Object.defineProperty(S,"__esModule",{value:!0});S.RewriteCompletionStatus=S.ContentType=S.RewriteSuggestionType=void 0;(function(d){d[d.Bullet=0]="Bullet";d[d.Concise=1]="Concise";d[d.Paraphrase=2]="Paraphrase"})(S.RewriteSuggestionType||(S.RewriteSuggestionType=
{}));(function(d){d[d.PLAIN_TEXT=0]="PLAIN_TEXT";d[d.HTML=1]="HTML";d[d.JSON=2]="JSON"})(S.ContentType||(S.ContentType={}));(function(d){d[d.Success=0]="Success";d[d.OffensiveContentInput=1]="OffensiveContentInput";d[d.OffensiveContentOutput=2]="OffensiveContentOutput";d[d.EmptyResponse=3]="EmptyResponse";d[d.OpenAiModelError=4]="OpenAiModelError";d[d.UnsupportedLanguage=5]="UnsupportedLanguage";d[d.Timeout=6]="Timeout";d[d.BadRequest=7]="BadRequest";d[d.Unknown=8]="Unknown"})(S.RewriteCompletionStatus||
(S.RewriteCompletionStatus={}))},1186:function(K,S,d){Object.defineProperty(S,"__esModule",{value:!0});S.RewriteAnswer=void 0;const h=d(249);class e{constructor(r){h.SchemaObject.assign(e,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_Rewrite_RewriteAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return h.SchemaObject.matchesTypesFor(r,[e.getTypeName()])}}S.RewriteAnswer=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},
1187:function(K,S){Object.defineProperty(S,"__esModule",{value:!0});S.RewriteType=void 0;K=S.RewriteType||(S.RewriteType={});K[K.Title=0]="Title";K[K.Subtitle=1]="Subtitle";K[K.Content=2]="Content"},1188:function(K,S,d){Object.defineProperty(S,"__esModule",{value:!0});S.RewriteSignal=void 0;const h=d(249);class e{constructor(r){h.SchemaObject.assign(e,this,r)}static getTypeName(){return"AugLoop_Rewrite_RewriteSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(r){return h.SchemaObject.matchesTypesFor(r,
[e.getTypeName()])}}S.RewriteSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1293:function(K,S,d){(function(h){d.d(S,"a",function(){return r});var e=d(1183);class r{static deserialize(m,n=z=>z){if(m[0]!==r.IDENTIFIERBYTE)throw Error("Invalid Binary: Incorrect Identifier");let z=1;const t=[],x=new DataView(m.buffer,m.byteOffset,m.byteLength);for(;z<m.byteLength;){if(z+4>m.byteLength)throw Error("Invalid Binary: Error reading fragment length");const B=x.getUint32(z);if(z+B+4>m.byteLength)throw Error("Invalid Binary: Fragment out of range");
"undefined"!==typeof h&&h.from?t.push(h.from(m.buffer,m.byteOffset+z+4,B)):t.push(new Uint8Array(m.buffer,m.byteOffset+z+4,B));z+=4+B}if(1>t.length)throw Error("Invalid Binary: No fragments found");m=r.textDecoder.decode(t[0]);return JSON.parse(m,(B,D)=>{if("string"===typeof D){if(D.substring(0,r.BINARYKEYWORD.length)===r.BINARYKEYWORD){B=parseInt(D.substring(r.BINARYKEYWORD.length),10);if("number"!==typeof B||B>=t.length-1)throw Error("Invalid Binary: Binary index out of range");return n(t[B+1])}if(D.substring(0,
r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return D.substring(r.ESCAPEKEYWORD.length)}return D})}static serialize(m){const n=[void 0];m=JSON.stringify(m,(x,B)=>ArrayBuffer.isView(B)?(n.push(B),`${r.BINARYKEYWORD}${n.length-2}`):B&&"Buffer"===B.type&&Array.isArray(B.data)?(n.push(new Uint8Array(B.data)),`${r.BINARYKEYWORD}${n.length-2}`):"string"===typeof B&&B.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+B:B);n[0]=r.textEncoder.encode(m);m=n.reduce((x,B)=>x+4+B.byteLength,0);
m=new Uint8Array(m+1);m[0]=r.IDENTIFIERBYTE;let z=1;const t=new DataView(m.buffer,m.byteOffset,m.byteLength);for(const x of n)t.setUint32(z,x.byteLength),m.set(x,z+4),z+=4+x.byteLength;return m}}r.IDENTIFIERBYTE=3;r.BINARYKEYWORD=":b";r.ESCAPEKEYWORD=":";r.textDecoder=new e.a;r.textEncoder=new e.b}).call(this,d(706).bBd)},1298:function(K,S,d){d.r(S);var h=d(0),e=d(395),r=d(27),m=d(56),n=d(71),z=d(18),t=d(7);class x{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}
Object(h.a)(x,"AugmentationServiceRequest",null,[]);var B=d(36),D=d(72);class w{constructor(ma,ib,yb){this.vsb=this.Pra=null;this.RWh=yb;this.Ma=ib;this.ji=ma}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");const ma=this.Ma.Ha("AugmentationLoopWebServiceBase"),ib=this.Ma.Ha("WebServiceBase");this.Pra=(void 0===ma?ib:ma)+"proofing.ashx?"+r.AFrameworkApplication.Pg+"&apitype=AL";this.vsb=new D.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(ma,
ib){if(ma&&""!==ma)if(ib){if(!({value:yb}=this.vsb.vg(ma)).returnValue){var yb=new z.a;this.vsb.add(ma,yb)}yb.contains(ib)||yb.add(ib)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,306,15,"topic is empty or null")}removeEventHandler(ma,ib){ma&&""!==ma?ib?this.vsb.Gb(ma)?({value:ma}=this.vsb.vg(ma),ma&&ma.contains(ib)&&ma.remove(ib)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",ma):e.ULS.sendTraceTag(25747916,306,15,
"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}H_e(ma,ib,yb){this.csc(ma,ib,yb,Object(t.a)(this,this.pLa,"requestSucceeded"),Object(t.a)(this,this.nLa,"requestFailed"))}csc(ma,ib,yb,ac,Qc,me=null){ma=Object.assign(new x,{Topic:ma,Payload:ib,AppId:this.RWh,SessionId:this.ji.userSessionId,ContextId:yb});this.ji.qj(this.Pra,2,B.c(ma),{"Content-Type":"application/json; charset=utf-8"},!1,3,ac,Qc,me?me:ma,void 0,void 0,void 0,void 0,"18")}pLa(ma){!r.AFrameworkApplication.Yg&&
ma&&ma.data&&this.aFk(ma.data.Wd)}nLa(ma){!r.AFrameworkApplication.Yg&&ma&&ma.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",ma.data.Wd)}aFk(ma){if(ma){try{var ib=B.a(ma)}catch(yb){e.ULS.sendTraceTag(36284437,306,10,"Try parse aug response failed:{0}",yb.message);return}if(({value:ma}=this.vsb.vg(ib.Topic)).returnValue)for(let yb of ma)yb(ib.ContextId,ib.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",ib.Topic)}}}Object(h.a)(w,"AugmentationManager",null,[1169]);
var J=d(1253);class F{}Object(h.a)(F,"HostMetadata",null,[]);var L=d(709);class M{sendMessage(ma){e.ULS.sendTraceTag(508965922,306,100,"AL send SDX message");L.a.Sxh(ma)}registerMessageReceivedCallback(ma){e.ULS.sendTraceTag(508965921,306,50,"AL handle SDX message");L.a.uph(ma)}}Object(h.a)(M,"SdxMessageBridge",null,[1235]);class Q{}Object(h.a)(Q,"Lambda",null,[]);class C extends Q{constructor(){super()}}Object(h.a)(C,"WrapperLambda",Q,[]);var O=d(470),U=d(144),T=d(199),ca=d(146);class N{constructor(){this.handler=
this.schemaName=null}}Object(h.a)(N,"AddEventHandlerParameters",null,[]);var da=d(671);class Y{constructor(){this.lambda=this.name=null}}Object(h.a)(Y,"RegisterSimpleLocalWorkflowParameters",null,[]);class fa{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(fa,"RegisterSimpleRemoteWorkflowParameters",null,[]);var aa=d(1002);class ka{constructor(){this.bridge=null}}Object(h.a)(ka,"SetMessageBridgeParameters",null,[]);class H{constructor(){this.requestAuthTokenCallback=
null}}Object(h.a)(H,"SetRequestAuthTokenCallbackParameters",null,[]);class ra{constructor(){this.sendOTelEvent=null}}Object(h.a)(ra,"SetSendOTelEventCallbackParameters",null,[]);class ha{constructor(){this.ulsLogger=null}}Object(h.a)(ha,"SetULSLoggerParameters",null,[]);var Ma=d(672);class Ga{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(h.a)(Ga,"SubmitParameters",null,[]);var na=d(540);class wa{constructor(ma,ib=null){this.HZ=null;new D.a;new F;this.H9h=ma;this.DPa=
ib}initialize(ma){this.HZ?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(ma||(ma=new da.a),this.HZ=new Promise(ib=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const yb=r.AFrameworkApplication.Ji("al",2);this.H9h.TCb(yb).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const ac=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();ac.setRequestAuthTokenCallback(Object.assign(new H,{requestAuthTokenCallback:Object(t.a)(this,
this.Zel,"requestAuthToken")}));ac.setULSLogger(Object.assign(new ha,{ulsLogger:new O.a}));ac.setSendOTelEventCallback(Object.assign(new ra,{sendOTelEvent:Object(t.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let Qc=r.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";Qc=Qc.replace("Web","");ma.appName=ma.appName||Qc;ma.serviceUrl=ma.serviceUrl||r.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");ma.appVersion=ma.appVersion||r.AFrameworkApplication.fa.Ha("BuildVersion")||"";ma.releaseAudienceGroup=
ma.releaseAudienceGroup||(r.AFrameworkApplication.Md?Object(J.a)(String,r.AFrameworkApplication.Md.AudienceGroup)||"":"");ma.sessionId=ma.sessionId||r.AFrameworkApplication.fa.Ha("SessionId")||"";ma.uiLanguage=ma.uiLanguage||r.AFrameworkApplication.uiCulture;ma.flights=ma.flights||this.Gcj();ma.initSession=ma.initSession||!0;ma.downloadBaseUrl=ma.downloadBaseUrl||r.AFrameworkApplication.fa.Ha("AugLoopDownloadBaseUrl");ac.initialize(ma);ac.setMessageBridge(Object.assign(new ka,{bridge:new M}));ib({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,
306,50,"RegisterSchemas is a No-Op");return this.HZ}registerSimpleLocalWorkflow(ma,ib){return this.HZ.then(()=>{e.ULS.sendTraceTag(51185353,306,50,"Registering local workflow: {0} to AugLoop.",ma);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new Y,{name:ma,lambda:this.jyd(ib)}))})}registerSimpleRemoteWorkflow(ma,ib,yb,ac){return this.HZ.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",ma);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new fa,
{name:ma,lambdaBefore:this.jyd(ib),lambdaRemote:this.jyd(yb),lambdaAfter:this.jyd(ac)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.HZ}submit(ma,ib){this.HZ.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",ma);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new Ga,{inputSchema:ma,input:ib}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(ma){this.HZ.then(()=>
{e.ULS.sendTraceTag(51185358,306,100,"Submitting Operation: {0} to AugLoop.",ma);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ma.a,{operation:ma}))})}setSessionDataCallback(ma){this.HZ.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(ma)})}setInitSessionCallback(ma){this.HZ.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(ma)})}setSessionInitOverrideCallback(ma){this.HZ.then(()=>{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(ma)})}setAnnotationResultCallback(ma){this.HZ.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new aa.a,
{handler:ma}))})}activateAnnotation(ma){return this.HZ.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",ma.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(ma)})}releaseAnnotation(ma){return this.HZ.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",ma.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(ma)})}addEventHandler(ma,ib){ma&&""!==ma?ib?this.HZ.then(()=>{e.ULS.sendTraceTag(51185362,
306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new N,{schemaName:ma,handler:yb=>{yb&&ib(yb.inputSchema,yb.input,yb.outputSchema,yb.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}Zel(){const ma=r.AFrameworkApplication.fa.Ha("AugLoopOAuthResourceUriV2");if(this.DPa)return new Promise(ib=>
{this.DPa.execute(yb=>{yb.mI("AugLoop",ma).then(ac=>{ac.IsSuccess?ib(ac.Token):(e.ULS.sendTraceTag(51499467,306,15,ac.ErrorMessage),ib(r.AFrameworkApplication.fa.Ha("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(ma){ca.a.sendOtelEvent(Object.assign(new na.a,{otelEvent:ma}))}jyd(ma){if(ma){let ib=null;ma.func&&(ib=(yb,ac,Qc,me)=>{ma.func(yb,ac,me)});return Object.assign(new C,
{name:ma.name,inputSchema:ma.inputSchema,outputSchema:ma.outputSchema,func:ib})}return null}Gcj(){var ma=r.AFrameworkApplication.fa.Ha("FlightId");if(r.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ALFlightForwardingTreatmentVariablesFix")){var ib=r.AFrameworkApplication.fa.U6b,yb=r.AFrameworkApplication.fa.ty("AugLoopFlightKeywordList");ib=wa.E8d(ma,ib,Array.isArray(yb)?yb:null);yb="";ib&&0<ib.length&&(yb=ib.join(";"));return yb}ib=r.AFrameworkApplication.fa.ty("AugLoopFlightKeywordList");
yb=[];if(ma&&""!==ma&&ib&&0<ib.length){ma=ma.split(";");for(let ac=0;ac<ma.length;ac++)for(let Qc=0;Qc<ib.length;Qc++)-1<ma[ac].toLowerCase().indexOf(ib[Qc].toLowerCase())&&Array.add(yb,ma[ac])}return 0<yb.length?yb.join(";"):""}static E8d(ma,ib,yb){const ac=new z.a;if(yb&&0<yb.length){for(var Qc=0;Qc<yb.length;Qc++)yb[Qc]=yb[Qc].toLowerCase();if(ma&&""!==ma){ma=ma.toLowerCase().split(";");for(const me of ma)T.a.any(yb,Ge=>-1<me.indexOf(Ge))&&ac.add(me)}if(ib)for(let me in ib){Qc=(ma={key:me,value:ib[me]},
ma.key)?ma.key:"";const Ge=U.d(Qc);T.a.any(yb,sf=>-1<Ge.indexOf(sf))&&ac.add(String.format("{0}:{1}",Qc,ma.value))}}return ac.toArray()}}Object(h.a)(wa,"NewAugLoopRuntimeManager",null,[1168]);var Fa=d(134),pa=d(55),Ea=d(1285),ta=d(47);class ia{}Object(h.a)(ia,"Lambda",null,[1236]);var Ja=d(935);class ab{constructor(){this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null}}Object(h.a)(ab,"PowerPointParameters",null,[]);class Oa{constructor(){this.initSessionCallback=null}}Object(h.a)(Oa,
"SetInitSessionCallbackParameters",null,[]);class Za{constructor(){this.sessionDataCallback=this.handler=null}}Object(h.a)(Za,"SetSessionDataCallbackParameters",null,[]);class Na{constructor(){this.handler=null}}Object(h.a)(Na,"SetSessionInitOverrideCallbackParameters",null,[]);var sa=d(284),Sa=d(529),xb=d(138);class gc extends Sa.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new xb.a,{T_:gc.getTypeName(),B_:gc.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(h.a)(gc,"DeleteOperation",Sa.a,[]);var zc=d(708),Xb=d(324);class jb extends Xb.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new xb.a,{T_:jb.getTypeName(),B_:jb.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}Object(h.a)(jb,"Message",Xb.a,[]);class zb extends jb{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=
this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new xb.a,{T_:zb.getTypeName(),B_:zb.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}Object(h.a)(zb,"SessionInitMessage",jb,[]);class Tb extends zb{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new xb.a,
{T_:Tb.getTypeName(),B_:Tb.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(Tb,"PowerPointSessionInitMessage",zb,[]);var Ya=d(33);class sb{constructor(){this.authToken=this.origin=this.Xsd=null}}Object(h.a)(sb,"SessionData",null,[]);var oc=d(545),wb=d(996);class rc{constructor(){this.vMc=new Map}P5f(ma,ib){const yb=
this.vMc.get(ma);if(yb){var ac=yb.get(ib);yb.delete(ib);0===yb.size&&this.vMc.delete(ma);return ac}}hol(ma,ib,yb){let ac=this.vMc.get(ma);ac||(ac=new Map,this.vMc.set(ma,ac));ac.set(ib,yb)}}Object(h.a)(rc,"AugLoopSessionCallbackStorage",null,[]);var Ka=d(336);class Db{constructor(ma){Ka.a.assign(Db,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Db.getTypeName()])}}Db.H_={T_:Db.getTypeName(),
B_:Db.getBaseTypes()};class bc{constructor(ma){Ka.a.assign(bc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[bc.getTypeName()])}}bc.H_={T_:bc.getTypeName(),B_:bc.getBaseTypes()};class Mc{constructor(ma){Ka.a.assign(Mc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Mc.getTypeName()])}}Mc.H_={T_:Mc.getTypeName(),B_:Mc.getBaseTypes()};class mb{constructor(ma){Ka.a.assign(mb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[mb.getTypeName()])}}mb.H_={T_:mb.getTypeName(),B_:mb.getBaseTypes()};class Wa{constructor(ma){Ka.a.assign(Wa,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Wa.getTypeName()])}}Wa.H_={T_:Wa.getTypeName(),B_:Wa.getBaseTypes()};class db{constructor(ma){Ka.a.assign(db,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[db.getTypeName()])}}db.H_={T_:db.getTypeName(),B_:db.getBaseTypes()};class ub{constructor(ma){Ka.a.assign(ub,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[ub.getTypeName()])}}ub.H_={T_:ub.getTypeName(),B_:ub.getBaseTypes()};class Lb{constructor(ma){Ka.a.assign(Lb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Lb.getTypeName()])}}Lb.H_={T_:Lb.getTypeName(),B_:Lb.getBaseTypes()};class Kb{constructor(ma){Ka.a.assign(Kb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Kb.getTypeName()])}}Kb.H_={T_:Kb.getTypeName(),B_:Kb.getBaseTypes()};class uc{constructor(ma){Ka.a.assign(uc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[uc.getTypeName()])}}uc.H_={T_:uc.getTypeName(),B_:uc.getBaseTypes()};class Yb{constructor(ma){Ka.a.assign(Yb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Yb.getTypeName()])}}Yb.H_={T_:Yb.getTypeName(),B_:Yb.getBaseTypes()};class Tc{constructor(ma){Ka.a.assign(Tc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Tc.getTypeName()])}}Tc.H_={T_:Tc.getTypeName(),B_:Tc.getBaseTypes()};class sc{constructor(ma){Ka.a.assign(sc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[sc.getTypeName()])}}sc.H_={T_:sc.getTypeName(),B_:sc.getBaseTypes()};class Qb{constructor(ma){Ka.a.assign(Qb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Qb.getTypeName()])}}Qb.H_={T_:Qb.getTypeName(),B_:Qb.getBaseTypes()};class kb{constructor(ma){Ka.a.assign(kb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[kb.getTypeName()])}}kb.H_={T_:kb.getTypeName(),B_:kb.getBaseTypes()};class Ib{constructor(ma){Ka.a.assign(Ib,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Ib.getTypeName()])}}Ib.H_={T_:Ib.getTypeName(),B_:Ib.getBaseTypes()};class eb{constructor(ma){Ka.a.assign(eb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[eb.getTypeName()])}}eb.H_={T_:eb.getTypeName(),B_:eb.getBaseTypes()};class Rb{constructor(ma){Ka.a.assign(Rb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Rb.getTypeName()])}}Rb.H_={T_:Rb.getTypeName(),B_:Rb.getBaseTypes()};class pc{constructor(ma){Ka.a.assign(pc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[pc.getTypeName()])}}pc.H_={T_:pc.getTypeName(),B_:pc.getBaseTypes()};class Wc{constructor(ma){Ka.a.assign(Wc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Wc.getTypeName()])}}Wc.H_={T_:Wc.getTypeName(),B_:Wc.getBaseTypes()};class Ic{constructor(ma){Ka.a.assign(Ic,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Ic.getTypeName()])}}Ic.H_={T_:Ic.getTypeName(),B_:Ic.getBaseTypes()};class nd{constructor(ma){Ka.a.assign(nd,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[nd.getTypeName()])}}nd.H_={T_:nd.getTypeName(),B_:nd.getBaseTypes()};class ob{constructor(ma){Ka.a.assign(ob,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage",
"AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[ob.getTypeName()])}}ob.H_={T_:ob.getTypeName(),B_:ob.getBaseTypes()};class $b{constructor(ma){Ka.a.assign($b,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[$b.getTypeName()])}}$b.H_={T_:$b.getTypeName(),B_:$b.getBaseTypes()};class Hc{constructor(ma){Ka.a.assign(Hc,
this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Hc.getTypeName()])}}Hc.H_={T_:Hc.getTypeName(),B_:Hc.getBaseTypes()};class Pb{constructor(ma){Ka.a.assign(Pb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Pb.getTypeName()])}}Pb.H_={T_:Pb.getTypeName(),B_:Pb.getBaseTypes()};class Yc{constructor(ma){Ka.a.assign(Yc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Yc.getTypeName()])}}Yc.H_={T_:Yc.getTypeName(),B_:Yc.getBaseTypes()};class Rd{constructor(ma){Ka.a.assign(Rd,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Rd.getTypeName()])}}Rd.H_={T_:Rd.getTypeName(),B_:Rd.getBaseTypes()};class Gb{constructor(ma){Ka.a.assign(Gb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Gb.getTypeName()])}}Gb.H_={T_:Gb.getTypeName(),B_:Gb.getBaseTypes()};class Bb{constructor(ma){Ka.a.assign(Bb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Bb.getTypeName()])}}Bb.H_={T_:Bb.getTypeName(),B_:Bb.getBaseTypes()};class dc{constructor(ma){Ka.a.assign(dc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[dc.getTypeName()])}}dc.H_={T_:dc.getTypeName(),B_:dc.getBaseTypes()};class Xc{constructor(ma){Ka.a.assign(Xc,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Xc.getTypeName()])}}Xc.H_={T_:Xc.getTypeName(),B_:Xc.getBaseTypes()};class Fb{constructor(ma){Ka.a.assign(Fb,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Fb.getTypeName()])}}Fb.H_={T_:Fb.getTypeName(),B_:Fb.getBaseTypes()};class kd{constructor(ma){Ka.a.assign(kd,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[kd.getTypeName()])}}kd.H_={T_:kd.getTypeName(),B_:kd.getBaseTypes()};class od{constructor(ma){Ka.a.assign(od,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[od.getTypeName()])}}od.H_={T_:od.getTypeName(),B_:od.getBaseTypes()};class Gd{constructor(ma){Ka.a.assign(Gd,this,ma)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwitchMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Gd.getTypeName()])}}Gd.H_={T_:Gd.getTypeName(),B_:Gd.getBaseTypes()};var Fd=d(1293);class ee{constructor(ma,ib,yb){var ac;this.uec=new Map;this.Ndb=new Map;this.vec=new Map;this.cDb=new Map;this.RIa=this.Wwa=this.eEb=this.IO=null;this.xVd=new rc;this.XSd=new Map;this.Ms=ma;this.Da=ib;this.ei=yb;const Qc=new da.a;Qc.powerpoint=new ab;ma=new da.a;Ya.a("AL.SendNewInitParams")&&(ma.serviceUrl=null!==(ac=Object(wb.a)(ib))&&void 0!==ac?ac:void 0);if(Ya.a("AL.SendSlideTile"))if(Ya.a("AL.EnableRehydration"))this.Ms.initialize(ma),
this.Ms.setInitSessionCallback(Object.assign(new Oa,{initSessionCallback:Object(t.a)(this,this.OLk,"onSessionInit")})),this.Ms.setSessionInitOverrideCallback(Object.assign(new Na,{handler:Object(t.a)(this,this.PLk,"onSessionInitOverride")})),this.RIa=this.W_c(),this.Ms.setAnnotationResultCallback(Object(t.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.O0=Promise.resolve(null);else{ib=pa.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;ac=pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
ib=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",ac,ib);ac=pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").oab?pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").NWc:pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var me=String.format("{0}getitems.ashx",ac);ac=new Ea.a(r.AFrameworkApplication.Je);this.O0=oc.b(ac.S_e(ib));this.O0.then(Ge=>{try{const sf=JSON.parse(Ge),uf=sf.downloadUrl;ta.a.Xa(uf)?e.ULS.sendTraceTag(509112976,
306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",sf):(Qc.powerpoint.downloadUrl=uf,Qc.powerpoint.getItemsEndPoint=me,this.Da.J5b&&(Qc.powerpoint.documentOpenType=this.Rag()))}catch(sf){e.ULS.sendTraceTag(509112975,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",sf)}this.Ms.initialize(Qc);this.RIa=this.W_c();this.Ms.setAnnotationResultCallback(Object(t.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(Ge=>
{e.ULS.sendTraceTag(509112974,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Ge);this.Ms.initialize(Qc);this.RIa=this.W_c();this.Ms.setAnnotationResultCallback(Object(t.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.O0=new Promise(Ge=>{this.Ms.initialize(Qc);this.RIa=this.W_c();this.Ms.setAnnotationResultCallback(Object(t.a)(this,this.onAnnotationResult,"onAnnotationResult"));Ge("")})}kQ(ma){this.O0.then(ib=>{this.Ms.activateAnnotation(Object.assign(new Ja.a,
{annotationType:ma}));this.XSd.set(ma,ib);return ib})}releaseAnnotation(ma){return Object(Fa.a)(this,void 0,void 0,function*(){yield this.O0;var ib=this.XSd.get(ma);return ib?((ib=yield this.Ms.releaseAnnotation({token:ib}))&&this.XSd.delete(ma),ib):!1})}B6(ma,ib){if(ma)if(ib){if(this.uec.has(ma))var yb=this.uec.get(ma);else yb=new z.a,this.uec.set(ma,yb);yb&&!yb.contains(ib)&&yb.add(ib)}else e.ULS.sendTraceTag(509112972,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509112973,306,15,
"Annotation Type is null or empty")}Y6k(ma,ib){if(ma)if(ib){if(this.vec.has(ma))var yb=this.vec.get(ma);else yb=new z.a,this.vec.set(ma,yb);yb&&!yb.contains(ib)&&yb.add(ib)}else e.ULS.sendTraceTag(509116945,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(509116947,306,15,"Annotation Type is null or empty")}cph(ma,ib){if(ma)if(ib){if(this.Ndb.has(ma))var yb=this.Ndb.get(ma);else yb=new z.a,this.Ndb.set(ma,yb);yb&&!yb.contains(ib)&&yb.add(ib)}else e.ULS.sendTraceTag(509112970,306,15,"AnnotationHandler is null");
else e.ULS.sendTraceTag(509112971,306,15,"Annotation Type is null or empty")}addEventHandler(ma,ib){this.O0.then(()=>{this.Ms.addEventHandler(ma,ib);return null})}removeEventHandler(ma,ib){this.O0.then(()=>{this.Ms.removeEventHandler(ma,ib);return null})}registerSimpleLocalWorkflow(ma,ib){return this.O0.then(()=>this.Ms.registerSimpleLocalWorkflow(ma,this.kyd(ib)))}registerSimpleRemoteWorkflow(ma,ib,yb,ac){return this.O0.then(()=>this.Ms.registerSimpleRemoteWorkflow(ma,this.kyd(ib),this.kyd(yb),this.kyd(ac)))}submit(ma,
ib){this.Da.E4||this.O0.then(()=>{this.Ms.submit(ma,ib);return null})}submitOperation(ma){this.O0.then(()=>{this.Ms.submitOperation(ma);return null})}P6i(ma,ib){return this.RIa.then(()=>Object(Fa.a)(this,void 0,void 0,function*(){return yield fetch(this.Wwa.Xsd,{method:"POST",headers:{"Content-Type":"application/jsond","X-Origin":this.Wwa.origin,Authorization:`Bearer ${this.Wwa.authToken}`},body:Fd.a.serialize(ma),signal:ib.signal})}))}ZGl(ma,ib=1E4){return Object(Fa.a)(this,void 0,void 0,function*(){const yb=
new AbortController,ac=window.setTimeout(()=>{yb.abort()},ib);try{if(!(yield this.P6i(ma,yb)).ok)throw Error("Network response was not ok");}catch(Qc){if(Qc instanceof DOMException&&"AbortError"===Qc.name)throw Error("Request timed out");throw Qc;}finally{clearTimeout(ac)}})}submitBinarySignal(ma,ib,yb,ac,Qc=1E4){return Object(Fa.a)(this,void 0,void 0,function*(){this.RIa.then(()=>Object(Fa.a)(this,void 0,void 0,function*(){this.xVd.hol(ib,ac,yb);void 0!==this.pri&&clearInterval(this.pri);try{yield this.ZGl(new Wc({parentPath:["session",
"img"],item:{id:ac,body:ma}}),Qc)}catch(me){throw this.xVd.P5f(ib,ac),me;}}))})}G6i(ma){return this.RIa.then(()=>fetch(`${this.Wwa.Xsd}/blob/${ma}`,{headers:{"X-Origin":this.Wwa.origin,Authorization:`Bearer ${this.Wwa.authToken}`}}))}getBlob(ma,ib=1E4){return Object(Fa.a)(this,void 0,void 0,function*(){const yb=new AbortController,ac=window.setTimeout(()=>{yb.abort()},ib);yield this.O0;try{const Qc=yield this.G6i(ma);if(!Qc.ok)throw Error("Network response was not ok");return Qc.blob()}catch(Qc){if(Qc instanceof
DOMException&&"AbortError"===Qc.name)throw Error("Request timed out");throw Qc;}finally{clearTimeout(ac)}})}kWl(ma,ib,yb,ac,Qc){this.RIa&&this.RIa.then(()=>{this.ei.augmentImage(ma,ib,yb,!0,this.Wwa.Xsd,this.Wwa.origin,this.Wwa.authToken,ac,Qc);return null})}PLk(ma){e.ULS.sendTraceTag(509112969,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const ib=Object.assign(new Tb,{protocolVersion:ma.protocolVersion,clientMetadata:ma.clientMetadata,sessionKey:ma.sessionKey,origin:ma.origin,authToken:ma.authToken,
messageId:ma.messageId,cv:ma.cv});try{this.Da.J5b&&(ib.documentOpenType=this.Rag())}catch(yb){e.ULS.sendTraceTag(509112968,306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",yb)}this.Apl(ma);if(ta.a.Xa(this.IO)||ta.a.Xa(this.eEb))return e.ULS.sendTraceTag(509112967,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),ma;ib.downloadUrl=this.IO;ib.getItemsEndPoint=this.eEb;this.eEb=this.IO=null;return ib}OLk(){e.ULS.sendTraceTag(509112966,
306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var ma=pa.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const ib=pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var yb=pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").oab?pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").NWc:pa.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;ma=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
ib,ma);const ac=String.format("{0}getitems.ashx",yb);yb=new Ea.a(r.AFrameworkApplication.Je);return oc.b(yb.S_e(ma)).then(Qc=>{try{const me=JSON.parse(Qc),Ge=me.downloadUrl;ta.a.Xa(Ge)?e.ULS.sendTraceTag(509112965,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",me):(this.IO=Ge,this.eEb=ac)}catch(me){e.ULS.sendTraceTag(509112964,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",me)}return null}).catch(Qc=>{e.ULS.sendTraceTag(509112963,
306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Qc)})}W_c(){return new Promise(ma=>{this.Ms.setSessionDataCallback(Object.assign(new Za,{sessionDataCallback:(ib,yb,ac)=>{this.Wwa=Object.assign(new sb,{Xsd:ib,origin:yb,authToken:ac});ma(null)}}))})}OCj(ma,ib,yb){ma=this.xVd.P5f(ma,ib);void 0!==ma&&ma(yb)}onAnnotationResult(ma){if(ma&&ma.items)if(this.Da.E4&&this.Pll(ma),Xb.a.getTypeNameFor(ma)!==sa.a.getTypeName()&&Xb.a.getTypeNameFor(ma)!==zc.a.getTypeName())this.Da.oYf&&
Xb.a.getTypeNameFor(ma)===gc.getTypeName()&&this.vGk(ma);else for(const yb of ma.items){if(!yb||!yb.body)continue;const ac=Xb.a.getTypeNameFor(yb.body);if(!ac)continue;var ib=yb.body||{};ma.parentPath&&(ib.parentPath=ma.parentPath);let Qc;if(this.uec.has(ac)){if(Qc=this.uec.get(ac))for(let me of Qc)me(ib)}else e.ULS.sendTraceTag(509112962,306,50,"Cannot find handlers for annotation:{0};",ac);ac&&ma.parentPath&&this.OCj(ac,ma.parentPath[2],yb.body);if(this.Da.oYf){if(this.Ndb.has(ac)&&(ib=this.Ndb.get(ac)))for(let me of ib)me(yb,
!1);ta.a.Xa(yb.id)||this.cDb.set(yb.id,ac)}}}Pll(ma){const ib=new Map,yb=Xb.a.getTypeNameFor(ma)!==sa.a.getTypeName()&&Xb.a.getTypeNameFor(ma)!==zc.a.getTypeName();for(var ac of ma.items){ma=yb&&this.cDb.has(ac.id)?this.cDb.get(ac.id):Xb.a.getTypeNameFor(ac.body);let Qc;ib.has(ma)?Qc=ib.get(ma):(Qc=new z.a,ib.set(ma,Qc));Qc.add(ac)}for(const Qc of ib.keys())if(this.vec.has(Qc)){if(ac=this.vec.get(Qc))for(let me of ac)me(ib.get(Qc).toArray(),yb)}else e.ULS.sendTraceTag(509116952,306,50,"Cannot find handlers for annotation:{0};",
Qc)}vGk(ma){for(const ib of ma.items)if(ib&&ib.id&&this.cDb.has(ib.id)){ma=this.cDb.get(ib.id);if(this.Ndb.has(ma)&&(ma=this.Ndb.get(ma)))for(const yb of ma)yb(ib,!0);this.cDb.delete(ib.id)}}kyd(ma){return ma?Object.assign(new ia,{name:ma.name,inputSchema:ma.inputSchema,outputSchema:ma.outputSchema,func:ma.func}):null}Rag(){try{return this.Da.qJ?0:this.Da.EWa?2:1}catch(ma){return e.ULS.sendTraceTag(509112961,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",ma),2}}Apl(ma){try{ta.a.Xa(ma.clientMetadata.flights)?
ma.clientMetadata.flights=";":ma.clientMetadata.flights+=";",this.Da.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?ma.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":ma.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;",this.Da.ka("ChatPPTCIQDocMenuEnabled")&&(ma.clientMetadata.flights+="PPTOChatPPTCIQDocMenuEnabled;ciq.user-init.enabled:true;",
ma.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Da.ka("StorytellerCiqEnabled")&&(ma.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Da.sWa&&(ma.clientMetadata.flights+="StorytellerBypassLicenseCheckEnabled"),this.Da.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotRewrite",!1)&&Ya.a("RewriteBypassLicenseCheckEnabled")&&(ma.clientMetadata.flights+="RewriteBypassLicenseCheckEnabled")}catch(ib){e.ULS.sendTraceTag(509112960,306,50,
"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",ib)}}}Object(h.a)(ee,"PPTAugLoopRuntimeManager",null,[1163]);class Bf{constructor(ma){this.rU=ma;this.rU.initialize()}addEventHandler(ma,ib){this.rU.addEventHandler(ma,ib)}removeEventHandler(ma,ib){this.rU.removeEventHandler(ma,ib)}H_e(ma,ib,yb){this.rU.H_e(ma,ib,yb)}csc(ma,ib,yb,ac,Qc,me=null){this.rU.csc(ma,ib,yb,ac,Qc,me)}}Object(h.a)(Bf,"PPTAugmentationManager",null,[1162]);var be=d(317),af=d(103);class Ue{constructor(ma){Ka.a.assign(Ue,this,
ma)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};class qf{constructor(ma){Ka.a.assign(qf,this,ma)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[qf.getTypeName()])}}qf.H_={T_:qf.getTypeName(),B_:qf.getBaseTypes()};class Xa{constructor(ma){Ka.a.assign(Xa,
this,ma)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Xa.getTypeName()])}}Xa.H_={T_:Xa.getTypeName(),B_:Xa.getBaseTypes()};class vb{constructor(ma){Ka.a.assign(vb,this,ma)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[vb.getTypeName()])}}vb.H_={T_:vb.getTypeName(),B_:vb.getBaseTypes()};class cc{constructor(ma){Ka.a.assign(cc,
this,ma)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[cc.getTypeName()])}}cc.H_={T_:cc.getTypeName(),B_:cc.getBaseTypes()};var wc=d(28);class Ad{constructor(ma){this.MH=ma;ma.body&&(ma=ma.body,this.ID=ma.id,this.Status=ma.status,this.Text=ma.text,this.fBd=this.Luj())}Luj(){return this.MH.parentPath&&0<this.MH.parentPath.length?this.MH.parentPath[this.MH.parentPath.length-1]:""}}
Object(h.a)(Ad,"ALChatHelperResponse",null,[1222]);class Md{constructor(ma,ib){this.Vpk=0;this.LZg=new Map;this.Ms=ib;const yb=["session","chats"],ac=(new be.a(af.a.create(),1)).toString(),Qc=[...yb,ac];this.Apk=[...Qc,"messages"];this.Ms.execute(me=>{me.submitOperation(Md.E0d(yb,ac,ma.chat));me.submitOperation(Md.E0d(Qc,"messages",new Xa));me.kQ(ma.responseType);me.cph(ma.responseType,this.SQ.bind(this))})}SQ(ma){ma=new Ad(ma);if(ma.fBd){const ib=this.LZg.get(ma.fBd);if(ib){ib(ma);this.LZg.delete(ma.fBd);
return}}this.$jk?this.$jk(ma):wc.a.J(509366417,822,15,"No handler found")}send(ma){const ib=`${this.Vpk++}`;this.Ms.execute(yb=>{yb.submitOperation(Md.E0d(this.Apk,ib,ma))})}static E0d(ma,ib,yb){return Object.assign(new sa.a,{parentPath:ma,items:[{id:ib,body:yb}]})}}Object(h.a)(Md,"ALChatHelper",null,[1189]);class Sd{constructor(ma){this.U6c=ma}create(ma){return new Md(ma,this.U6c)}}Object(h.a)(Sd,"ALChatHelperFactory",null,[1167]);var Le=d(78);class fe{constructor(){this.e8e="TML";this.bWe="RTA";
this.Q4e="SR";this.va=new Le.a}Eli(ma){this.va.addHandler(this.e8e,ma)}Vcl(ma){this.va.removeHandler(this.e8e,ma)}r3k(ma){this.va.raiseEvent(this.e8e,ma)}Qji(ma){this.va.addHandler(this.bWe,ma)}Qbl(ma){this.va.removeHandler(this.bWe,ma)}Zmh(ma){this.va.raiseEvent(this.bWe,ma)}jki(ma){this.va.addHandler(this.Q4e,ma)}ccl(ma){this.va.removeHandler(this.Q4e,ma)}h3k(ma){this.va.raiseEvent(this.Q4e,ma)}}Object(h.a)(fe,"TilingEventSource",null,[1156,1157,1158]);class Vf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Xb(ma){this.K=
ma;this.K.register(Bf,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").na().oa(()=>new Bf(new w(r.AFrameworkApplication.Je,ma.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.K.register(ee,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").na().oa(()=>{const ib=m.a.i$j();e.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",
ib);r.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=ib.toString();return new ee(new wa(ma.resolve("Common.ISharedDependencyLoader"),ma.Ia("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))});Object(Ya.a)("EnableALChatHelper")&&this.K.register(Sd,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").na().oa(()=>new Sd(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")));
this.K.register(fe,"PowerPointWebEditor.AugmentationLoop.TilingEventSource").as("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").as("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers").as("PowerPointWebEditor.AugmentationLoop.ITilingEventSource").na().oa(()=>new fe)}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&(this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
Object(Ya.a)("EnableALChatHelper")&&this.K.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){n.a.instance.Ac(new Vf)}}Object(h.a)(Vf,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var Cd=d(1252),Sc=d(936),jg=d(934),mg=d(558),Pa=d(64),bb=d(34);class Fc{constructor(ma){if(!ma)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");this.t1=ma}U9b(ma){this.V8e(ma)}V8e(ma){if(ma){try{const Qc=
ma.parentPath;if(!Qc||4>Qc.length){wc.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const me=Qc[3];var ib=Qc[2];if(!me){wc.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var yb=this.t1.ymj(me);this.t1.J$k(me);const Ge=ma.predictions;if(!Ge||!Ge.length){wc.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const sf=Ge[0];if(!sf)return;var ac=sf.text;if(!ac||!ac.length){wc.a.J(590181641,820,50,"Text Predictions Null or Empty.");return}}catch(Qc){wc.a.J(590710030,
820,10,"Unable to parse output because of modified output type from Augloop");return}ac&&Fc.vYi(ac,yb,ib)}else wc.a.J(590181649,820,50,"Annotations returned from service is null.")}static vYi(ma,ib,yb){ma&&ma.length&&(ib=Fc.Jrj(ma,ib),-1!==ib&&(ib=ma.substring(ib,ma.length),yb=Object.assign(new jg.a,{text:ma,q9:ib,Ux:yb}),mg.a.gE.x6=yb,mg.a.YVd(ma,ib)))}static Jrj(ma,ib){var yb=Pa.a.instance.Pa.nb.jf.node;if(!yb||!ib)return-1;yb=bb.ParagraphReader.text(yb);if(!yb)return-1;if(yb!==ib)if(yb.length>
ib.length&&yb.substring(0,ib.length)===ib){if(!ma.startsWith(yb.substring(ib.length,yb.length-ib.length)))return-1;wc.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===yb.substring(yb.length-1,1)?0:Fc.B$f(yb)}static B$f(ma){return ma?ma.length-1-ma.lastIndexOf(" "):-1}}Object(h.a)(Fc,"TextPredictionAugLoopResponseManager",null,[]);var yd=d(300);class ge extends Sa.a{constructor(){super();this.H_=Object.assign(new xb.a,{T_:ge.getTypeName(),B_:ge.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(h.a)(ge,"SignalOperation",Sa.a,[]);var rb=d(1080);class gf{constructor(){this.QRe=!1}}Object(h.a)(gf,"PredictionSettings",null,[]);class Ab{constructor(ma,ib){this.Fed=null;this.oBe={};this.Ms=ma;this.Rb=ib;this.Rb.TJc(Object(t.a)(this,this.Phg,"handleResize"))}ymj(ma){return this.oBe[ma]}rql(ma,ib){this.oBe[ma]=ib}J$k(ma){ma&&delete this.oBe[ma]}get settings(){this.Fed||(this.Fed=Object.assign(new gf,{QRe:!1}));return this.Fed}set settings(ma){this.Fed=ma}vOl(ma){if(this.settings.QRe&&ma){var ib=
ma.id.toString(),yb=mg.a.gE.x6,ac=Pa.a.instance.Pa.nb;if(ac&&1===ac.length&&ac.jf){ac=ac.jf;var Qc=ac.node;if(bb.ParagraphReader.textLength(Qc)===ac.Ra){if(yb&&Qc&&ib===yb.Ux&&ib===Qc.id.toString()&&(ac=this.Hbe(yb,Qc))){yb.q9=ac;mg.a.YVd(yb.text,ac);return}mg.a.gE.x6=null;yb=af.a.create().toString();ac=bb.ParagraphReader.text(ma);this.rql(yb,ac);ma=["Signal",rb.a.getTypeName(),ib,yb];yb=Ab.xpj(ac);ib=[Object.assign(new yd.a,{id:ib,body:yb})];var me=Object.assign(new ge,{parentPath:ma,items:ib});
this.Ms.execute(Ge=>{Ge.submitOperation(me);wc.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}pMb(){mg.a.gE.x6=null;mg.a.lVa()}VIj(ma){!ma||1<ma.length?this.pMb():1>ma.length||((ma=ma[0])&&ma.context?(ma=ma.context,ma.Ra===ma.Lb&&bb.ParagraphReader.textLength(ma.node)===ma.Ra||this.pMb()):this.pMb())}Hbe(ma,ib){var yb=null;if(ma&&ib){ib=bb.ParagraphReader.text(ib);ma=ma.text;if(!ib||!ma)return yb;ib=ib.replace(RegExp("\\u00a0","g")," ");ma=ma.replace(RegExp("\\u00a0","g"),
" ");if(ib){if(ib.endsWith(ma))return this.pMb(),yb;yb=Ab.Bqj(ib,ma);yb=ma.substring(yb,ma.length)}}return yb}Phg(){mg.a.lVa()}dispose(){this.Rb.kqd(Object(t.a)(this,this.Phg,"handleResize"))}static xpj(ma){return Object.assign(new rb.a,{languageId:"en-US",startOfSentence:!0,text:ma})}static Bqj(ma,ib){for(let yb=ib.length;0<yb;yb--){const ac=ib.substring(0,yb);if(ma.endsWith(ac.trimStart()))return ac.length}return 0}}Ab.gWa=!1;Object(h.a)(Ab,"TextPredictionHandler",null,[1258]);var fc=d(52),kc=d(30);
class ud{constructor(ma,ib){this.ia=ma;this.ic=ib}vb(){this.ia.ya(kc.a.BWk,fc.a.application,Object(t.a)(this,this.EWk,"predictionHandler"))}EWk(ma,ib,yb){return r.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===yb?this.ic.rj()?32:2:8:8}}Object(h.a)(ud,"TextPredictorActor",null,[]);class zd{constructor(){this.yIe=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Xb(ma){this.K=ma;ma.register(ud,"PowerPointWebEditor.TextPrediction.TextPredictorActor").na().oa(()=>new ud(ma.resolve("Common.IActionManagerExtended"),
ma.resolve("PowerPointWebEditor.IPresentationReader")));ma.register(1258,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").na().oa(()=>new Ab(ma.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ma.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").vb();this.yIe=new Cd.a(()=>new Fc(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(ma=>
{ma.kQ(Sc.a.getTypeName());ma.B6(Sc.a.getTypeName(),Object(t.a)(this.yIe.value,this.yIe.value.U9b,"handleResponse"))})}dispose(){}static main(){n.a.instance.Ac(new zd)}}Object(h.a)(zd,"TextPredictionPackage",null,[2,3]);var Td=d(272),Me=d(29);class tf{}Object(h.a)(tf,"AugContextId",null,[]);class re{}Object(h.a)(re,"AugParagraph",null,[]);class lh{}Object(h.a)(lh,"AugShape",null,[]);class ze{}Object(h.a)(ze,"ShapeTextTile",null,[]);class Je{constructor(ma,ib,yb,ac){this.Ga=yb;this.Hh=ac;this.Tb=ma;
this.Yl=ib}V3b(ma,ib){return ma&&ma.isConnected&&this.Ga.wGa(ma)?(ma=Object(J.a)(4,ma))?Object.assign(new ze,{Topic:"ShapeText",ContextId:B.c(Je.DJi(ma,ib)),Data:B.c(this.EJi(ma))}):null:null}u3b(ma){return ma&&ma.get_shapeId()&&ma.hasText&&!ma.iq?ma.noe:!1}EJi(ma){const ib=[];ma=this.Tb.Lc(ma);for(ma=this.Yl.O3(ma,ma.currentNode);ma.moveNext();){var yb=ma.currentNode;const ac=yb;this.Hh.fe(ac)&&(yb=Object.assign(new re,{t:this.Hh.text(ac),l:this.Hh.Tib(yb)}),Array.add(ib,yb))}return Object.assign(new lh,
{p:ib,c:Td.a.He(r.AFrameworkApplication.lcid).Gxb})}static DJi(ma,ib){return Object.assign(new tf,{gid:ma.id,sid:ma.slideSid,cid:ma.slideCid,shapeId:ma.get_shapeId(),rid:(ma.l5c||ma.EGa||Me.App.tn).toString(),t:ib,c:(new Date).getTime()})}}Object(h.a)(Je,"ShapeTextTileManager",null,[1243,1304]);var Wh=d(106),Kg=d(1274),pd=d(82),Nc;(function(ma){ma[ma.none=0]="none";ma[ma.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";ma[ma.onSelectionFinished=2]="onSelectionFinished";ma[ma.onActiveSlideDomReady=
4]="onActiveSlideDomReady";ma[ma.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";ma[ma.onParagraphDisconnect=16]="onParagraphDisconnect";ma[ma.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";ma[ma.onNumberListDisconnect=64]="onNumberListDisconnect";ma[ma.onSlideConnected=128]="onSlideConnected";ma[ma.onSlideDisconnected=256]="onSlideDisconnected";ma[ma.onRefreshTileAnnotations=512]="onRefreshTileAnnotations";ma[ma.onSlideReorder=1024]="onSlideReorder"})(Nc||(Nc={}));Object(h.b)("EventNames",
Nc);class le{constructor(){this.$Ma=this.graphNode=null;this.GWa=0;this.d8e=null}}Object(h.a)(le,"TileGraphNode",null,[]);class Ye{constructor(){this.Pwh=this.a_e=this.ege=this.egg=0}}Object(h.a)(Ye,"TileTelemetry",null,[]);var Zc;(function(ma){ma[ma.unknown=0]="unknown";ma[ma.activeSlideChanged=1]="activeSlideChanged";ma[ma.shapeSelected=2]="shapeSelected";ma[ma.listLevelChanged=3]="listLevelChanged";ma[ma.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";ma[ma.shapeChildTopologyChanged=
5]="shapeChildTopologyChanged";ma[ma.paragraphDeleted=6]="paragraphDeleted";ma[ma.numberListDeleted=7]="numberListDeleted";ma[ma.numberListPropertyChanged=8]="numberListPropertyChanged";ma[ma.slideAdded=9]="slideAdded";ma[ma.slideDeleted=10]="slideDeleted";ma[ma.refreshTileAnnotations=11]="refreshTileAnnotations";ma[ma.slideReorder=12]="slideReorder"})(Zc||(Zc={}));Object(h.b)("TriggerName",Zc);var Jf=d(438);class pg{constructor(ma,ib,yb,ac){this.Heh=(Qc,me)=>{Qc=new Jf.a(!1,null,me.Ba);this.Kda(Qc,
4)};this.wb=ib;this.qlk=yb;this.Zvk=ma;this.BIe={};this.Kfc={};this.Rb=ac}initialize(){this.Jt()}dispose(){this.Ypa()}onParagraphPropertyChanged(ma,ib){this.Kda(ib,1)}tJb(ma,ib){this.Kda(ib,2)}onActiveSlideDomReady(ma,ib){this.Kda(ib,4)}onShapeChildTopologyChanged(ma,ib){this.Kda(ib,8)}QJa(ma,ib){this.Kda(ib,16)}get jv(){return this.Zvk}get wT(){return this.BIe}get hka(){return this.Kfc}Kda(ma,ib){try{if(2===this.Rb.mode&&Object(Kg.a)(Nc,ib)in this.BIe){var yb=Date.now();Object(J.a)(1317,this.BIe[Object(Kg.a)(Nc,
ib)]).bX(ma,(ac,Qc)=>{this.zGk(ac,Qc,yb)})}}catch(ac){wc.a.J(508879877,306,10,"Exception thrown at DetectTiles: "+ac)}}zGk(ma,ib,yb){if(!T.a.Xa(ma))try{for(const ac of ma){if(!Wh.a.count(this.Kfc)){const Ge=new pd.a(3,1,this.qlk,Object(t.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.wb.Hb(Ge)}let Qc;if(ac.id.toString()in this.Kfc)Qc=Object(J.a)(le,this.Kfc[ac.id.toString()]),Qc.GWa=ib;else{const Ge=new Ye;Qc=Object.assign(new le,{graphNode:ac,GWa:ib,$Ma:{},d8e:Ge});this.Kfc[ac.id.toString()]=
Qc;this.yEk(Ge,yb)}const me=Zc[ib];Qc.$Ma[me]=(me in Qc.$Ma?Qc.$Ma[me]:0)+1}}catch(ac){wc.a.J(508879876,306,10,"Exception thrown at FireTiles: "+ac)}}yEk(ma,ib){ma&&(ma.egg=ib,ma.ege=Date.now())}S9g(ma,ib){ma&&(ma.a_e=ib,ma.Pwh=Date.now())}k5f(ma){return ma?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",ma.ege-ma.egg,ma.a_e-ma.ege,ma.Pwh-ma.a_e):""}}Object(h.a)(pg,"TileTriggerControllerBase",null,[1320,108]);class gd extends pg{constructor(ma,ib,yb,ac,Qc,
me,Ge,sf,uf,xf,dg,df,If){super(Ge&31,sf,xf,df);this.GU=ma.zd(12);this.IM=ma.zd(10);this.pa=ib;this.od=yb;this.rU=ac;this.aP=Qc;this.NU=me;this.ua=uf;this.gP=dg;this.Cwk=If}Jt(){1===(this.jv&1)&&(this.GU.gk(Object(t.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.wT[Object(Kg.a)(Nc,1)]=this.gP.BRi());2===(this.jv&2)&&(this.pa.FC(Object(t.a)(this,this.tJb,"onProcessSetSelectionFinished")),this.wT[Object(Kg.a)(Nc,2)]=this.gP.CRi());4===(this.jv&4)&&(this.od.eT(Object(t.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.wT[Object(Kg.a)(Nc,4)]=this.gP.zRi());8===(this.jv&8)&&(this.IM.KF(Object(t.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.wT[Object(Kg.a)(Nc,8)]=this.gP.DRi());16===(this.jv&16)&&(this.GU.ACa(Object(t.a)(this,this.QJa,"onBeforeParagraphDisconnect")),this.wT[Object(Kg.a)(Nc,16)]=this.gP.ARi())}Ypa(){this.GU.Qm(Object(t.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.pa.Cga(Object(t.a)(this,
this.tJb,"onProcessSetSelectionFinished"));this.od.Voa(Object(t.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.IM.vP(Object(t.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.GU.iLa(Object(t.a)(this,this.QJa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ua&&this.ua.Ba){var ma=this.ua.Ba.yj();for(const ib of ma){const yb=ib.id.toString();yb in this.hka&&(this.J6b(Object(J.a)(le,this.hka[yb])),delete this.hka[yb])}Wh.a.forEach(this.hka,
ib=>{delete this.hka[ib]},null)}}catch(ib){wc.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+ib)}}J6b(ma){if(ma){var ib=Date.now(),yb=this.NU.V3b(ma.graphNode,Zc[ma.GWa]);if(yb){this.Cwk?this.aP.execute(Qc=>{Qc.submit("ShapeTextTile",yb)}):this.rU.execute(Qc=>{Qc.H_e(yb.Topic,yb.Data,yb.ContextId)});const ac=ma.d8e;this.S9g(ac,ib);wc.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",Zc[ma.GWa],ma.$Ma,this.k5f(ac))}}}}Object(h.a)(gd,"ShapeTextTileTriggerController",
pg,[]);var bd=d(19),Ne=d(75),rf=d(41),Fh=d(91),Ae=d(84),Kf=d(159),Mf=d(39);class vf{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(h.a)(vf,"TextSpan",null,[]);class eg{}Object(h.a)(eg,"AugCharFormat",null,[]);class zf{}Object(h.a)(zf,"AugCharFormatRun",null,[]);class Nd{}Object(h.a)(Nd,"AugDrawingElement",null,[]);class Se{}Object(h.a)(Se,"AugDrawingElementMoniker",null,[]);class Qe{}Object(h.a)(Qe,"AugPara",null,[]);class Ei{}Object(h.a)(Ei,"AugParaFormat",null,[]);class Ff{}
Object(h.a)(Ff,"AugParaFormatRun",null,[]);class Jh{}Object(h.a)(Jh,"AugSlide",null,[]);class Wf{}Object(h.a)(Wf,"AugSlideMoniker",null,[]);class md{}Object(h.a)(md,"AugText",null,[]);class Gf{}Object(h.a)(Gf,"AugTextTile",null,[]);class Hd{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf,xf,dg,df){this.Hh=ma;this.om=ib;this.hGe=yb;this.Tb=ac;this.uY=Qc;this.zc=me;this.Yl=Ge;this.NYa=dg;this.wbd=sf;this.zjc=uf;this.EA=xf;this.Ucd=df}V3b(ma){if(!ma||!ma.isConnected)return null;var ib=Object(J.a)(116,ma);if(!ib)return null;
let yb=ma=0;ib=({Kld:ma,QQc:yb}=this.XRi(ib)).returnValue;if(!ib)return null;ib=Object.assign(new Gf,{Id:af.a.create().toString(),Content:B.c(ib)});wc.a.J(508945997,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",ib.Id,ma,yb);return ib}XRi(ma){let ib=0,yb=0;const ac=[];var Qc=ma?ma.yj():[];for(me of Qc)if(!this.om.hGa(me)||this.NYa)if(me.xd){if(Qc=this.zc.eO(me))Qc=this.Tb.Lc(Qc),this.uY.gUc(Qc,Ge=>{(Ge=Object(J.a)(130,Ge.currentNode))&&!Ge.isGhostCell&&({Kld:ib,QQc:yb}=this.c5f(Ge,ib,
yb,ac));return!0})}else({Kld:ib,QQc:yb}=this.c5f(me,ib,yb,ac));var me=ib;Qc=yb;return{returnValue:Object.assign(new Jh,{id:ma.id.toString(),mk:Object.assign(new Wf,{sId:ma.sid,cId:ma.cid}),drawingElems:ac,isSlideCritiqueReady:ma.isSlideCritiqueReady,sourceTimestamp:Date.now()}),Kld:me,QQc:Qc}}c5f(ma,ib,yb,ac){const Qc=[];let me=0;var Ge=this.Tb.Lc(ma);for(Ge=this.Yl.O3(Ge,Ge.currentNode);Ge.moveNext();){var sf=Ge.currentNode;sf&&this.Hh.fe(sf)&&sf.Ta(rf.a.Oo)&&(sf=this.Abj(sf))&&(sf.pfRuns&&0<sf.pfRuns.length&&
sf.pfRuns[0].pf.proofingDirty&&me++,Array.add(Qc,sf))}0<Qc.length&&(ib+=Qc.length,yb+=me,ma=Object.assign(new Nd,{id:ma.id.toString(),mk:this.ybj(ma),text:Object.assign(new md,{paragraphs:Qc})}),Array.add(ac,ma));return{Kld:ib,QQc:yb}}ybj(ma){if(!ma)return null;var ib="";let yb=0,ac=0;if(Object(bd.a)(130,ma))ib=Object(J.a)(130,ma),ac=3,ib=ib.cellId.toString();else if(Object(bd.a)(4,ma))if(ma=Object(J.a)(4,ma),ib=ma.get_shapeId().toString(),yb=ma.get_cid(),ma.x0)ac=1;else if(ma.Wf)ac=2;else if(ma.Gw||
ma.Ik)ac=4;return Object.assign(new Se,{id:ib,cId:yb,type:ac})}Abj(ma){if(!ma)return null;ma=Object(J.a)(Ne.AParagraphNode,ma);if(!ma)return null;var ib=ma.sa(Mf.a.hU,!1);ib=Object.assign(new Qe,{id:ma.id.toString(),chars:ib?"":this.Hh.text(ma)});const yb=this.zbj(ma);yb&&0<yb.length&&(ib.pfRuns=yb);(ma=this.xbj(ma))&&0<ma.length&&(ib.cfRuns=ma);return ib}zbj(ma){const ib=[],yb=Object(J.a)(Ae.a,this.zjc.YWc(ma));let ac=16,Qc="",me=0,Ge=0;if(yb&&this.Ucd){const sf=this.EA.qab(yb);if(sf)if(ac=sf.listType,
1===ac)Qc=this.wbd.QCb(yb);else if(0===ac){me=yb.sa(Mf.a.autonumberBulletType,8);const uf=Object(J.a)(1305,this.wbd);uf&&(Ge=uf.Dnj(sf,yb))}}ma=Object.assign(new Ff,{pf:Object.assign(new Ei,{lvl:this.Hh.Tib(ma),proofingDirty:!ma.sa(Kf.a.O4,!1),revisionId:ma.sa(Kf.a.r5c,0).toString(),listType:ac,listTag:Qc,listNumeration:me,listElementIndex:Ge})});Array.add(ib,ma);return ib}xbj(ma){const ib=[];let yb=this.gnj(ma);if(0<yb.count){yb=this.yti(this.hGe.WVc(ma),yb);for(let ac of yb)ma=ac.end-ac.start,Array.add(ib,
Object.assign(new zf,{len:ma,cf:Object.assign(new eg,{lang:ac.lcid,noProof:ac.noProof})}))}return ib}gnj(ma){const ib=new z.a,yb=ma.characterData;let ac=-1,Qc=-1,me=0;for(let Ge=0;Ge<ma.Sa.length;Ge++){const sf=ma.Sa.ga(Ge).formatting;sf&&(Qc=Fh.a.language(sf),-1!==ac&&ac!==Qc&&(ib.add(Object.assign(new vf,{start:me,end:ma.Sa.ga(Ge).cp,lcid:ac,noProof:!1})),me=ma.Sa.ga(Ge).cp),ac=Qc)}ib.add(Object.assign(new vf,{start:me,end:yb.length,lcid:Qc,noProof:!1}));return ib}yti(ma,ib){if(!ma)return ib;for(const yb of ma){ma=
!1;for(let ac=0;ac<ib.count;ac++){if(!ma)if(ib.ga(ac).start===yb.begin)ma=!0,ib.ga(ac).noProof=!0;else if(yb.begin>ib.ga(ac).start&&yb.begin<ib.ga(ac).end){ib.insert(ac+1,Object.assign(new vf,{start:yb.begin,end:ib.ga(ac).end,lcid:ib.ga(ac).lcid,noProof:!0}));ma=!0;ib.ga(ac).end=yb.begin;continue}if(ma)if(yb.end>ib.ga(ac).end)ib.ga(ac).noProof=!0;else{if(yb.end===ib.ga(ac).end){ib.ga(ac).noProof=!0;break}if(yb.end<ib.ga(ac).end){ib.insert(ac+1,Object.assign(new vf,{start:yb.end,end:ib.ga(ac).end,
lcid:ib.ga(ac).lcid,noProof:!1}));ib.ga(ac).end=yb.end;ib.ga(ac).noProof=!0;break}}}}return ib}}Object(h.a)(Hd,"SlideTextTileManager",null,[1244,1304]);var Ee=d(446);class Ki extends pg{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf,xf,dg,df){super(ib&125,yb,ac,dg);this.od=ma;this.gP=Qc;this.Duk=me;this.GU=Ge.zd(12);this.IM=Ge.zd(10);this.aP=sf;this.ua=uf;this.shb=xf;this.ccd=Ge.zd(22);this.Da=df}Jt(){this.Da.E4||4!==(this.jv&4)||(this.od.eT(Object(t.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),
this.shb.Eli(this.Heh),this.wT[Object(Kg.a)(Nc,4)]=this.gP.RRi());16===(this.jv&16)&&(this.GU.ACa(Object(t.a)(this,this.QJa,"onBeforeParagraphDisconnect")),this.wT[Object(Kg.a)(Nc,16)]=this.gP.URi());1===(this.jv&1)&&(this.GU.gk(Object(t.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.wT[Object(Kg.a)(Nc,1)]=this.gP.VRi());8===(this.jv&8)&&(this.IM.KF(Object(t.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.wT[Object(Kg.a)(Nc,8)]=this.gP.WRi());
64===(this.jv&64)&&(this.ccd.ACa(Object(t.a)(this,this.p$g,"onBeforeNumberListDicsonnect")),this.wT[Object(Kg.a)(Nc,64)]=this.gP.SRi());32===(this.jv&32)&&(this.ccd.gk(Object(t.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),this.wT[Object(Kg.a)(Nc,32)]=this.gP.TRi())}Ypa(){this.Da.E4||this.od.Voa(Object(t.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.GU.Qm(Object(t.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.GU.iLa(Object(t.a)(this,
this.QJa,"onBeforeParagraphDisconnect"));this.shb.Vcl(this.Heh);this.ccd.iLa(Object(t.a)(this,this.p$g,"onBeforeNumberListDicsonnect"));this.ccd.Qm(Object(t.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}p$g(ma,ib){this.Kda(ib,64)}onNumberListPropertyChanged(ma,ib){this.Kda(ib,32)}fireTileEvents(){try{Wh.a.forEach(this.hka,ma=>{this.J6b(Object(J.a)(le,this.hka[ma]));delete this.hka[ma]},null)}catch(ma){wc.a.J(508944718,306,10,"Exception thrown at FireTileEvents: "+ma)}}J6b(ma){if(ma&&
this.ua.Ba&&ma.graphNode&&this.ua.Ba.id===ma.graphNode.id){var ib=Date.now(),yb=this.Duk.V3b(ma.graphNode,Zc[ma.GWa]);if(yb){Object(Ya.a)("PPTOAugLoopProofingTelemetry")&&wc.a.J(508944719,375,20,"ALv1: submitting proofing operation");this.aP.execute(Qc=>{Qc.submit(Ee.a.Wuc,yb)});const ac=ma.d8e;this.S9g(ac,ib);wc.a.J(508944717,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",Zc[ma.GWa],ma.$Ma,B.c(yb).length,yb.Id,this.k5f(ac))}}}}Object(h.a)(Ki,"SlideTextTileTriggerController",
pg,[]);class wf{constructor(ma){Ka.a.assign(wf,this,ma)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[wf.getTypeName()])}}wf.H_={T_:wf.getTypeName(),B_:wf.getBaseTypes()};class ag{constructor(ma){Ka.a.assign(ag,this,ma)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[ag.getTypeName()])}}ag.H_=
{T_:ag.getTypeName(),B_:ag.getBaseTypes()};class Og{constructor(ma){Ka.a.assign(Og,this,ma)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Og.getTypeName()])}}Og.H_={T_:Og.getTypeName(),B_:Og.getBaseTypes()};class Kh{constructor(ma){Ka.a.assign(Kh,this,ma)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Kh.getTypeName()])}}Kh.H_={T_:Kh.getTypeName(),B_:Kh.getBaseTypes()};class Xg{constructor(ma){Ka.a.assign(Xg,this,ma)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[Xg.getTypeName()])}}Xg.H_={T_:Xg.getTypeName(),B_:Xg.getBaseTypes()};class Yd{constructor(ma){Ka.a.assign(Yd,this,ma)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Yd.getTypeName()])}}Yd.H_={T_:Yd.getTypeName(),B_:Yd.getBaseTypes()};class ce{constructor(ma){Ka.a.assign(ce,this,ma)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};class Rh{constructor(ma){Ka.a.assign(Rh,this,ma)}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static getBaseTypes(){return[]}static typeGuard(ma){return Ka.a.matchesTypesFor(ma,
[Rh.getTypeName()])}}Rh.H_={T_:Rh.getTypeName(),B_:Rh.getBaseTypes()};var ng;(function(ma){ma[ma.Title=0]="Title";ma[ma.Subtitle=1]="Subtitle";ma[ma.Content=2]="Content";ma[ma.Note=3]="Note";ma[ma.SmartArt=4]="SmartArt";ma[ma.Image=5]="Image";ma[ma.TextBox=6]="TextBox";ma[ma.Table=7]="Table";ma[ma.Chart=8]="Chart";ma[ma.Other=9]="Other"})(ng||(ng={}));var Vi=d(58);class $h{constructor(ma,ib,yb,ac,Qc,me){this.Tb=ma;this.Yl=ib;this.Hh=ac;this.Da=yb;this.Pvk=Qc;this.ic=me}V3b(ma){if(!ma||!ma.isConnected)return null;
ma=Object(J.a)(116,ma);if(!ma)return null;var ib=null;const yb=new z.a;var ac=ma.yj();for(var Qc of ac)(ac=this.l5f(Qc,!1))&&yb.add(ac);(Qc=ma.nUa())&&Qc.isConnected&&(Qc=this.l5f(Qc,!0))&&yb.add(Qc);if(0<yb.count){let me,Ge;if(this.Da.J5b){ib=ma.Wm;Qc=this.CUa(ma);try{me=ma.cid.toString(),Ge=ma.sid.toString()}catch(sf){wc.a.J(509203980,822,50,"Exception message: "+sf.message)}ib=new Rh({shapes:yb.toArray(),isSlideHidden:ib,themeId:Qc,cid:me,sid:Ge})}}return ib}l5f(ma,ib){if(!ma)return null;var yb=
this.Tb.Lc(ma),ac=this.Yl.O3(yb,yb.currentNode);yb=null;const Qc=new z.a;for(;ac.moveNext();){var me=ac.currentNode;if(me&&this.Hh.fe(me)){me=Object(J.a)(Ne.AParagraphNode,me);let sf;sf=this.Da.E4?this.sDj(me,this.Hh.text(me)):this.Hh.text(me);let uf={};this.Da.J5b&&(uf=this.Pvk.bUk(me));sf&&(me=new ag({content:sf,listType:uf.listType,indentation:uf.indentation,outlineLevel:uf.outlineLevel}),Qc.add(me))}}let Ge;this.Da.J5b&&(Ge=this.Q6i(ma,ib));ac=null;this.Da.E4&&(ac=ib?"notesNode":ma.get_shapeId().toString());
0<Qc.count&&(yb=new ce({textTiles:Qc.toArray(),shapeType:Ge,shapeId:ac}));return yb}sDj(ma,ib){for(let ac=0;ac<ma.Sa.length;ac++){var yb=ma.Sa.ga(ac);yb&&yb.blob&&6==yb.blob.Cq&&(yb=yb.cp,ib=ib.substring(0,yb)+"\v"+ib.substring(yb+1,ib.length))}return ib}Q6i(ma,ib){if(ib)return ng.Note;if(!ma)return ng.Other;switch(ma.Cj){case 0:case 2:return ng.Title;case 3:return ng.Subtitle;case 10:return ng.Table;case 15:return ng.Image;case 9:case 12:return ng.Chart;case 8:return this.xvj(ma);case 1:return ng.Content}return ng.Other}xvj(ma){return ma?
0<ma.Cee().length?ng.SmartArt:ma.N9?ng.Other:ma.Gw?ng.TextBox:ng.Content:ng.Other}CUa(ma){if(!ma)return"";ma=ma.mj;let ib=null;const yb=this.ic.bJ();if(yb&&0<yb.length&&ma)for(const ac of yb)if(ac.Id===ma){ib=ac;break}return ib&&ib.ThemeFamilyId?ib.ThemeFamilyId:""}Nvj(ma){ma=ma.slideIndex;let ib,yb;if(0<ma){var ac=this.ic.zx(ma-1);ac?ib=Vi.a.ax(ac.sid,ac.cid).toString():wc.a.J(508851909,306,15,`Previous slide node for index:${ma}  is null. May result in wrong ordering`)}else ib="#head#";ac=this.ic.rj();
ma<ac-1?(ac=this.ic.zx(ma+1))?yb=Vi.a.ax(ac.sid,ac.cid).toString():wc.a.J(508851908,306,15,`Next slide node for index:${ma}  is null. May result in wrong ordering`):yb="#tail#";return[ib,yb]}}Object(h.a)($h,"SlideTileManager",null,[1303]);class fg extends pg{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf,xf){super(ib&1937,yb,ac,uf);this.onRefreshTileAnnotations=(dg,df)=>{this.Kda(df,512)};this.onSlideReorder=(dg,df)=>{this.Kda(df,1024)};this.afd=ma.zd(8);this.GU=ma.zd(12);this.gP=Qc;this.h1g=me;this.aP=Ge;
this.shb=sf;this.Da=xf}Jt(){16===(this.jv&16)&&(this.GU.ACa(Object(t.a)(this,this.QJa,"onBeforeParagraphDisconnect")),this.wT[Object(Kg.a)(Nc,16)]=this.gP.NRi());1===(this.jv&1)&&(this.GU.gk(Object(t.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.wT[Object(Kg.a)(Nc,1)]=this.gP.ORi());128===(this.jv&128)&&(this.afd.ija(Object(t.a)(this,this.onSlideConnected,"onSlideConnected")),this.wT[Object(Kg.a)(Nc,128)]=this.gP.LRi());256===(this.jv&256)&&(this.afd.p8(Object(t.a)(this,
this.onSlideDisconnected,"onSlideDisconnected")),this.wT[Object(Kg.a)(Nc,256)]=this.gP.MRi());this.Da.E4&&512===(this.jv&512)&&(this.shb.Qji(this.onRefreshTileAnnotations),this.wT[Object(Kg.a)(Nc,512)]=this.gP.PRi());this.F3c()&&1024===(this.jv&1024)&&(this.shb.jki(this.onSlideReorder),this.wT[Object(Kg.a)(Nc,1024)]=this.gP.QRi())}Ypa(){this.GU.Qm(Object(t.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.GU.iLa(Object(t.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.afd.Xoa(Object(t.a)(this,
this.onSlideConnected,"onSlideConnected"));this.afd.jLa(Object(t.a)(this,this.onSlideDisconnected,"onSlideDisconnected"));this.Da.E4&&this.shb.Qbl(this.onRefreshTileAnnotations);this.F3c()&&this.shb.ccl(this.onSlideReorder)}onSlideConnected(ma,ib){this.Kda(ib,128)}onSlideDisconnected(ma,ib){this.Kda(ib,256)}fireTileEvents(){try{Wh.a.forEach(this.hka,ma=>{this.J6b(Object(J.a)(le,this.hka[ma]));delete this.hka[ma]},null)}catch(ma){wc.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+ma)}}J6b(ma){if(ma&&
ma.graphNode){var ib=this.h1g.V3b(ma.graphNode,Zc[ma.GWa]),yb=null,ac=Object(J.a)(116,ma.graphNode);if(ac&&!ac.pO&&!ac.gCb){var Qc=(this.Da.E4||this.Da.e1c)&&Ya.a("ALSlideTileIdNewFormat")?ac.sid.toString()+"#"+ac.cid.toString():ac.sid.toString()+ac.cid.toString();var me=["session","doc"];ib=[Object.assign(new yd.a,{id:Qc,body:ib,sourceTimestamp:Date.now()})];this.F3c()&&"slideReorder"in ma.$Ma?this.Odl(ac,me,ib):(10===ma.GWa?"slideAdded"in ma.$Ma||(yb=Object.assign(new gc,{parentPath:me,items:ib})):
"slideAdded"in ma.$Ma?this.F3c()?(ac=this.h1g.Nvj(ac),ma=ac[0],ac=ac[1],yb=Object.assign(new sa.a,{parentPath:me,items:ib,prevId:ma,nextId:ac})):yb=Object.assign(new sa.a,{parentPath:me,items:ib}):yb=Object.assign(new zc.a,{parentPath:me,items:ib}),yb&&(Ya.a("PPTOAugLoopProofingTelemetry")&&wc.a.J(508953108,375,20,"ALv2: submitting operation {0}",yb.H_.T_),this.aP.execute(Ge=>{Ge.submitOperation(yb)})))}}}Odl(ma,ib,yb){const ac=Object.assign(new gc,{parentPath:ib,items:yb}),Qc=ma.gSe?Vi.a.ax(ma.gSe.sid,
ma.gSe.cid).toString():"#head#";ma=ma.uLe?Vi.a.ax(ma.uLe.sid,ma.uLe.cid).toString():"#tail#";const me=Object.assign(new sa.a,{parentPath:ib,items:yb,prevId:Qc,nextId:ma});this.aP.execute(Ge=>{Ge.submitOperation(ac);Ge.submitOperation(me)})}F3c(){return this.Da.e1c&&Ya.a("SlideReorderOnALEnabled")}}Object(h.a)(fg,"SlideTileTriggerController",pg,[]);var dk=d(1261),xi=d(32),yh;(function(ma){ma[ma.Unspecified=0]="Unspecified";ma[ma.Inline=1]="Inline";ma[ma.Floating=2]="Floating"})(yh||(yh={}));var Lg;
(function(ma){ma[ma.Undefined=0]="Undefined";ma[ma.Bullet=1]="Bullet";ma[ma.Numbered=2]="Numbered";ma[ma.Lim=3]="Lim";ma[ma.Nil=4]="Nil";ma[ma.Any=5]="Any";ma[ma.NoList=6]="NoList";ma[ma.Invalid=7]="Invalid"})(Lg||(Lg={}));var yi;(function(ma){ma[ma.DontCare=1]="DontCare";ma[ma.Thin=2]="Thin";ma[ma.ExtraLight=3]="ExtraLight";ma[ma.Light=4]="Light";ma[ma.Normal=5]="Normal";ma[ma.Medium=6]="Medium";ma[ma.SemiBold=7]="SemiBold";ma[ma.Bold=8]="Bold";ma[ma.ExtraBold=9]="ExtraBold";ma[ma.Heavy=10]="Heavy"})(yi||
(yi={}));var Vd;(function(ma){ma[ma.NoCaps=0]="NoCaps";ma[ma.SmallCaps=1]="SmallCaps";ma[ma.AllCaps=2]="AllCaps";ma[ma.AllPetiteCaps=3]="AllPetiteCaps";ma[ma.PetiteCaps=4]="PetiteCaps";ma[ma.Unicase=5]="Unicase";ma[ma.Titling=6]="Titling";ma[ma.Other=7]="Other"})(Vd||(Vd={}));var lf;(function(ma){ma[ma.None=0]="None";ma[ma.Words=1]="Words";ma[ma.SingleLine=2]="SingleLine";ma[ma.DoubleLine=3]="DoubleLine";ma[ma.HeavyLine=4]="HeavyLine";ma[ma.DottedLine=5]="DottedLine";ma[ma.DottedHeavyLine=6]="DottedHeavyLine";
ma[ma.DashLine=7]="DashLine";ma[ma.DashHeavyLine=8]="DashHeavyLine";ma[ma.DashLongLine=9]="DashLongLine";ma[ma.DashLongHeavyLine=10]="DashLongHeavyLine";ma[ma.DotDashLine=11]="DotDashLine";ma[ma.DotDashHeavyLine=12]="DotDashHeavyLine";ma[ma.DotDotDashLine=13]="DotDotDashLine";ma[ma.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";ma[ma.WavyLine=15]="WavyLine";ma[ma.WavyHeavyLine=16]="WavyHeavyLine";ma[ma.WavyDoubleLine=17]="WavyDoubleLine"})(lf||(lf={}));var Zj;(function(ma){ma[ma.Left=0]="Left";ma[ma.Right=
1]="Right";ma[ma.Center=2]="Center";ma[ma.Justified=3]="Justified";ma[ma.Other=4]="Other";ma[ma.None=5]="None";ma[ma.JustifyLow=6]="JustifyLow";ma[ma.Distributed=7]="Distributed";ma[ma.ThaiDistributed=8]="ThaiDistributed"})(Zj||(Zj={}));var Cj;(function(ma){ma[ma.Image=0]="Image";ma[ma.TextBox=1]="TextBox";ma[ma.Chart=2]="Chart";ma[ma.SmartArt=3]="SmartArt";ma[ma.Drawing=4]="Drawing";ma[ma.EquationObject=5]="EquationObject";ma[ma.Ink=6]="Ink";ma[ma.InkSpace=7]="InkSpace";ma[ma.InkEndOfLine=8]="InkEndOfLine";
ma[ma.LineBreak=9]="LineBreak";ma[ma.PageBreak=10]="PageBreak";ma[ma.PageNumbers=11]="PageNumbers";ma[ma.FootnoteEndnote=12]="FootnoteEndnote";ma[ma.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";ma[ma.Tab=14]="Tab";ma[ma.UnsupportedObject=15]="UnsupportedObject";ma[ma.Other=16]="Other"})(Cj||(Cj={}));var he;(function(ma){ma[ma.Initial=0]="Initial";ma[ma.FirstLine=1]="FirstLine";ma[ma.Hanging=2]="Hanging"})(he||(he={}));class ij{constructor(ma,ib){this.EA=ma;this.Q$=ib}bUk(ma){const ib=
{};try{ib.listType=this.Fyb(ma),ib.outlineLevel=bb.ParagraphReader.rXc(ma),ib.indentation=ij.rnj(this.Q$.k9(ma))}catch(yb){wc.a.J(509203979,822,50,"Exception message: "+yb.message)}return ib}Fyb(ma){const ib=new xi.GraphIterator;ib.set(ma);ib.rc(11);ib.Jg(11);return(ma=this.EA.Hv(ib))?ij.oLi(ma.listType):Lg.NoList}static oLi(ma){switch(ma){case 15:return Lg.Any;case 1:return Lg.Bullet;case 42:return Lg.Invalid;case 13:return Lg.Lim;case 14:return Lg.Nil;case 16:return Lg.NoList;case 0:return Lg.Numbered;
default:return Lg.Invalid}}static rnj(ma){return 2===ma.unit?Math.floor(dk.a.cLf(ma.value)/20):Math.floor(ma.value/20)}}Object(h.a)(ij,"TextTileFormatter",null,[1245]);class Rf{}Rf.Cvl="ShapeTextOnActiveSlideDomReady";Rf.Fvl="ShapeTextOnSelectionFinished";Rf.Evl="ShapeTextOnParagraphPropertyChanged";Rf.Gvl="ShapeTextOnShapeChildTopologyChanged";Rf.Dvl="ShapeTextOnParagraphDisconnect";Rf.rDl="SlideTextOnActiveSlideDomReady";Rf.vDl="SlideTextOnParagraphPropertyChanged";Rf.uDl="SlideTextOnParagraphDisconnect";
Rf.wDl="SlideTextOnShapeChildTopologyChanged";Rf.tDl="SlideTextOnNumberListPropertyChanged";Rf.sDl="SlideTextOnNumberListDisconnect";Rf.mDl="SlideOnParagraphPropertyChanged";Rf.lDl="SlideOnParagraphDisconnect";Rf.jDl="SlideOnConnect";Rf.kDl="SlideOnDisconnect";Rf.nDl="SlideOnRefreshTileAnnotations";Rf.oDl="SlideOnReorder";Object(h.a)(Rf,"DetectStrategyName",null,[]);class zh{constructor(ma){this.NU=ma}get jv(){return 4}bX(ma,ib){const yb=[];if((ma=Object(J.a)(Jf.a,ma))&&ma.Ba&&(ma=Object(J.a)(116,
ma.Ba))){ma=ma.yj();for(const ac of ma)this.NU.u3b(ac)&&Array.add(yb,ac);0<yb.length&&ib(yb,1)}}}Object(h.a)(zh,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[1317]);var Sh=d(256);class jj{constructor(ma,ib,yb){this.Ga=ma;this.NU=ib;this.pa=yb}get jv(){return 16}bX(ma,ib){if((ma=Object(J.a)(Sh.a,ma))&&ma.node&&12===ma.node.type&&(ma=this.Ga.An(ma.node))&&this.NU.u3b(ma)){var yb=this.pa.Y_();yb&&yb.id===ma.id&&(yb=[],Array.add(yb,ma),ib(yb,6))}}}Object(h.a)(jj,"ShapeTextOnParagraphDisconnectDetectStrategy",
null,[1317]);var Dj=d(42),Ah=d(364);class hf{constructor(ma,ib,yb){this.Ga=ma;this.NU=ib;this.pa=yb}get jv(){return 1}bX(ma,ib){if((ma=Object(J.a)(Ah.a,ma))&&ma.node&&12===ma.node.type){const ac=this.Ga.An(ma.node);if(ac&&this.NU.u3b(ac)){var yb=this.pa.Y_();yb&&yb.id===ac.id&&(ma.property===Dj.a.listLevel?this.owb(3,ac,ib):ma.property===rf.a.Oo&&this.owb(4,ac,ib))}}}owb(ma,ib,yb){if(ib){var ac=[];Array.add(ac,ib);yb(ac,ma)}}}Object(h.a)(hf,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,
[1317]);var rg=d(862);class Ej{constructor(ma,ib,yb,ac){this.pa=ma;this.NU=ib;this.t1=yb;this.Vkc=ac}get jv(){return 2}bX(ma,ib){const yb=[];if(ma=Object(J.a)(rg.a,ma))if(this.Vkc&&this.t1&&this.t1.VIj(ma.bF),!this.pa.F4())this.Vkc&&this.t1&&this.t1.pMb();else if(ma.VE&&ma.VE.length){this.Vkc&&this.t1&&this.t1.pMb();ma=this.pa.Ud();for(const ac of ma)this.NU.u3b(ac)&&Array.add(yb,ac);0<yb.length&&ib(yb,2)}}}Object(h.a)(Ej,"ShapeTextOnSelectionFinishedDetectStrategy",null,[1317]);var Li=d(596);class Gh{constructor(ma,
ib){this.pa=ma;this.NU=ib}get jv(){return 8}bX(ma,ib){const yb=[];if((ma=Object(J.a)(Li.a,ma))&&ma.node&&10===ma.node.type&&1===ma.HW&&(ma=Object(J.a)(4,ma.node))&&this.NU.u3b(ma)){var ac=this.pa.Y_();ac&&ac.get_shapeId()===ma.get_shapeId()&&(Array.add(yb,ma),ib(yb,5))}}}Object(h.a)(Gh,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[1317]);class hg{constructor(ma){this.xzg=ma}get jv(){return 1===this.xzg?128:256}bX(ma,ib){if((ma=Object(J.a)(Sh.a,ma))&&ma.node&&8===ma.node.type){const yb=
[];Array.add(yb,ma.node);1===this.xzg?ib(yb,9):ib(yb,10)}}}Object(h.a)(hg,"SlideOnConnectOrDisconnectDetectStrategy",null,[1317]);class Lh{constructor(ma){this.lc=ma}get jv(){return 16}bX(ma,ib){if((ma=Object(J.a)(Sh.a,ma))&&ma.node&&12===ma.node.type){const yb=this.lc.jg(ma.node);yb&&(ma=[],Array.add(ma,yb),ib(ma,6))}}}Object(h.a)(Lh,"SlideOnParagraphDisconnectDetectStrategy",null,[1317]);class La{constructor(ma){this.lc=ma}get jv(){return 1}bX(ma,ib){var yb=Object(J.a)(Ah.a,ma);if(yb&&yb.node&&
12===yb.node.type){const ac=this.lc.jg(yb.node);ac&&Object(J.a)(Ne.AParagraphNode,yb.node)&&(ma=0,yb.property===Dj.a.listLevel?ma=3:yb.property===rf.a.Oo&&(ma=4),yb=[],Array.add(yb,ac),ib(yb,ma))}}}Object(h.a)(La,"SlideOnParagraphPropertyChangedDetectStrategy",null,[1317]);class lb{get jv(){return 4}bX(ma,ib){if((ma=Object(J.a)(Jf.a,ma))&&ma.Ba&&(ma=Object(J.a)(116,ma.Ba))){var yb=ma.yj();for(var ac of yb)if(ac.hasText){ac=[];Array.add(ac,ma);ib(ac,1);break}}}}Object(h.a)(lb,"SlideTextOnActiveSlideDomReadyDetectStrategy",
null,[1317]);class Ob{constructor(ma,ib){this.lc=ma;this.ua=ib}get jv(){return 64}bX(ma,ib){if((ma=Object(J.a)(Sh.a,ma))&&this.ua.Ba&&ma.node&&22===ma.node.type&&(ma=this.lc.jg(ma.node))&&ma.id===this.ua.Ba.id){const yb=[];Array.add(yb,ma);ib(yb,7)}}}Object(h.a)(Ob,"SlideTextOnNumberListDisconnectDetectStrategy",null,[1317]);class mc{constructor(ma,ib){this.lc=ma;this.ua=ib}get jv(){return 32}bX(ma,ib){var yb=Object(J.a)(Ah.a,ma);yb&&yb.node&&22===yb.node.type&&(ma=this.lc.jg(yb.node))&&this.ua.Ba&&
ma.id===this.ua.Ba.id&&yb.property===rf.a.ej&&(yb=[],Array.add(yb,ma),ib(yb,8))}}Object(h.a)(mc,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[1317]);class Rc{constructor(ma,ib,yb,ac){this.ua=ma;this.om=ib;this.lc=yb;this.NYa=ac}get jv(){return 16}bX(ma,ib){if((ma=Object(J.a)(Sh.a,ma))&&ma.node&&this.ua.Ba&&12===ma.node.type){const yb=this.lc.jg(ma.node);!yb||yb.id!==this.ua.Ba.id||this.om.D9(ma.node)&&!this.NYa||(ma=[],Array.add(ma,this.ua.Ba),ib(ma,6))}}}Object(h.a)(Rc,"SlideTextOnParagraphDisconnectDetectStrategy",
null,[1317]);class Ud{constructor(ma,ib,yb,ac,Qc,me,Ge,sf){this.ua=ma;this.om=ib;this.lc=yb;this.Ga=ac;this.NYa=Qc;this.t1=Ge;this.Vkc=sf}get jv(){return 1}bX(ma,ib){if((ma=Object(J.a)(Ah.a,ma))&&ma.node&&this.ua.Ba&&12===ma.node.type){var yb=this.lc.jg(ma.node);if(yb&&yb.id===this.ua.Ba.id&&(yb=Object(J.a)(Ne.AParagraphNode,ma.node))&&(!this.om.D9(yb)||this.NYa)){var ac=this.Ga.An(yb);ac.Rla||ac.Gw||ac.Wf||ac.xd||!ac.Ik||!this.Vkc||(this.t1.settings.QRe=!0,this.t1.vOl(yb));ma.property===Dj.a.listLevel?
this.owb(3,this.ua.Ba,ib):ma.property===rf.a.Oo?this.owb(4,this.ua.Ba,ib):ma.property===Kf.a.O4&&(yb.sa(Kf.a.O4,!1)||this.owb(4,this.ua.Ba,ib))}}}owb(ma,ib,yb){if(ib){var ac=[];Array.add(ac,ib);yb(ac,ma)}}}Object(h.a)(Ud,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[1317]);class ue{constructor(ma,ib){this.ua=ma;this.lc=ib}get jv(){return 8}bX(ma,ib){ma=Object(J.a)(Li.a,ma);this.ua.Ba&&ma&&ma.node&&10===ma.node.type&&1===ma.HW&&(ma=Object(J.a)(4,ma.node))&&(ma=this.lc.jg(ma))&&ma.id===
this.ua.Ba.id&&(ma=[],Array.add(ma,this.ua.Ba),ib(ma,5))}}Object(h.a)(ue,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[1317]);class Xe{get jv(){return 512}bX(ma,ib){if(ma&&ma.Ba&&(ma=ma.Ba)){var yb=ma.yj();yb&&yb.some(ac=>this.Q9j(ac))&&ib([ma],11)}}Q9j(ma){if(!ma||!ma.hasText)return!1;switch(ma.Cj){case 0:case 2:case 3:case 15:case 1:return!0;case 8:return!ma.N9;default:return!1}}}Object(h.a)(Xe,"SlideOnRefreshTileAnnotationsDetectStrategy",null,[1317]);class pe{get jv(){return 1024}bX(ma,
ib){if(ma&&ma.l7g){var yb=ma.l7g;yb?(yb.gSe=ma.KXk,yb.uLe=ma.mCk,ib([yb],12)):wc.a.J(508851910,306,15,"Got null slide node for slide reorder strategy")}else wc.a.J(508851911,306,15,"Slide reorder strategy got blank args")}}Object(h.a)(pe,"SlideOnReorderDetectStrategy",null,[1317]);class gg{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf){this.lc=ma;this.Ga=ib;this.jb=yb;this.NU=ac;this.ua=Qc;this.om=me;this.Da=Ge;this.Ms=sf;this.t1=uf}Qjj(ma){if(T.a.Xa(ma))return 0;let ib=0;for(const yb of ma)ib|=this.Agl(yb);
return ib}Sjj(ma){if(T.a.Xa(ma))return 0;let ib=0;for(const yb of ma)ib|=this.Cgl(yb);return ib}Rjj(ma){if(T.a.Xa(ma))return 0;let ib=0;for(const yb of ma)ib|=this.Bgl(yb);return ib}BRi(){return new hf(this.Ga,this.NU,this.jb)}CRi(){return new Ej(this.jb,this.NU,this.t1,this.Da.Gpc)}zRi(){return new zh(this.NU)}DRi(){return new Gh(this.jb,this.NU)}ARi(){return new jj(this.Ga,this.NU,this.jb)}RRi(){return new lb}URi(){return new Rc(this.ua,this.om,this.lc,this.Da.pptNotesInSlideTextTileIsEnabled)}VRi(){return new Ud(this.ua,
this.om,this.lc,this.Ga,this.Da.pptNotesInSlideTextTileIsEnabled,this.Ms,this.t1,this.Da.Gpc)}WRi(){return new ue(this.ua,this.lc)}TRi(){return new mc(this.lc,this.ua)}SRi(){return new Ob(this.lc,this.ua)}NRi(){return new Lh(this.lc)}ORi(){return new La(this.lc)}MRi(){return new hg(2)}LRi(){return new hg(1)}PRi(){return new Xe}QRi(){return new pe}Agl(ma){return ma===Rf.Evl?1:ma===Rf.Fvl?2:ma===Rf.Cvl?4:ma===Rf.Gvl?8:ma===Rf.Dvl?16:0}Cgl(ma){return ma===Rf.rDl?4:ma===Rf.uDl?16:ma===Rf.vDl?1:ma===Rf.wDl?
8:ma===Rf.tDl?32:ma===Rf.sDl?64:0}Bgl(ma){return ma===Rf.lDl?16:ma===Rf.mDl?1:ma===Rf.jDl?128:ma===Rf.kDl?256:ma===Rf.nDl?512:ma===Rf.oDl?1024:0}}Object(h.a)(gg,"TilingFactory",null,[1246]);class cg extends Sys.EventArgs{constructor(ma){super();this.Ba=ma}}Object(h.a)(cg,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class Sg{constructor(){this.K=null;this.GHe=this.pve=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Xb(ma){this.K=ma;ma.register(1243,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").na().oa(()=>
new Je(ma.resolve("Box4.Graph.IGraphIteratorFactory"),ma.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),ma.resolve("PowerPointWebEditor.IShapeReader"),ma.resolve("Box4.IParagraphReader")));ma.register(1244,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").na().oa(()=>new Hd(ma.resolve("Box4.IParagraphReader"),ma.resolve("PowerPointWebEditor.Graph.INotesReader"),ma.resolve("Box4.Proofing.IProofingTextUtility"),ma.resolve("Box4.Graph.IGraphIteratorFactory"),ma.resolve("Box4.ITableNavigator"),
ma.resolve("PowerPointWebEditor.Graph.ITableReader"),ma.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),ma.resolve("Box4.IListMarkerUtility"),ma.resolve("PowerPointWebEditor.IPPTParagraphReader"),ma.resolve("Box4.List.IListReader"),ma.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));ma.register(1245,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").na().oa(()=>
new ij(ma.resolve("Box4.List.IListReader"),ma.resolve("Box4.IParagraphIndentationReader")));ma.register($h,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").na().oa(()=>new $h(ma.resolve("Box4.Graph.IGraphIteratorFactory"),ma.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),ma.resolve("PowerPointWebEditor.IApplicationSettings"),ma.resolve("Box4.IParagraphReader"),ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),ma.resolve("PowerPointWebEditor.IPresentationReader")));
ma.register(1246,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").na().oa(()=>new gg(ma.resolve("PowerPointWebEditor.ISlideReader"),ma.resolve("PowerPointWebEditor.IShapeReader"),ma.resolve("PowerPointWebEditor.IPptSelectionManager"),ma.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),ma.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ma.resolve("PowerPointWebEditor.Graph.INotesReader"),ma.resolve("PowerPointWebEditor.IApplicationSettings"),ma.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
ma.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));ma.register(gd,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").na().oa(()=>new gd(ma.resolve("Box4.Graph.IGraphInstance"),ma.resolve("PowerPointWebEditor.IPptSelectionManager"),ma.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ma.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),ma.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ma.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),
ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Qjj(ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),ma.resolve("Common.ITaskManager"),ma.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),ma.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),ma.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));
ma.register(Ki,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").na().oa(()=>new Ki(ma.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Sjj(ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),ma.resolve("Common.ITaskManager"),ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),
ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),ma.resolve("Box4.Graph.IGraphInstance"),ma.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),ma.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ma.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),ma.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),ma.resolve("PowerPointWebEditor.IApplicationSettings")));ma.register(fg,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").na().oa(()=>
new fg(ma.resolve("Box4.Graph.IGraphInstance"),ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Rjj(ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),ma.resolve("Common.ITaskManager"),ma.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,ma.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),ma.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),ma.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
ma.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),ma.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),ma.resolve("PowerPointWebEditor.IApplicationSettings")))}J0f(){return Ya.a("AL.SendSlideTile")}init(){const ma=this.K.resolve("Common.IAppSettingsManager");ma.$e(()=>{this.pve=ma.ka("497");this.GHe=ma.ka("810")||ma.ka("809");this.pve&&(ma.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.GHe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&
this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.J0f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.K.Ia("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").execute(ib=>ib.r3k(new cg(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)))})}dispose(){this.pve&&(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),
(this.GHe||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.J0f()&&(Ya.a("PPTOnline.BugFix-7758356")?this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").dispose():this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize()))}static main(){n.a.instance.Ac(new Sg)}}Object(h.a)(Sg,
"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Hh=d(1053),li=d(659),Oh=d(143),Wi=d(155),Xi=d(535),Fi=d(112),Mi=d(48);class mh{constructor(ma,ib,yb,ac,Qc,me,Ge,sf){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=ma;this.critiqueCountGrammar=
ib;this.critiqueCountFormality=yb;this.critiqueCountPunctuationConvention=ac;this.critiqueCountVocabulary=Qc;this.critiqueCountConciseness=me;this.critiqueCountClarity=Ge;this.critiqueCountInclusiveness=sf}}Object(h.a)(mh,"EditorPaneProps",null,[]);class ai{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf,xf,dg,df,If,Ai,nc){this.Ab=!1;this.wYd=320;this.eZa=!1;this.xba={};if(!ma)throw Error.argumentNull("pptSelectionManager");if(!ib)throw Error.argumentNull("appFrame");if(!yb)throw Error.argumentNull("actionManager");
if(!ac)throw Error.argumentNull("focusManager");if(!Qc)throw Error.argumentNull("editorPane");if(!Ge)throw Error.argumentNull("graphOperationEventHandler");if(!sf)throw Error.argumentNull("viewElementEventHandlers");if(!uf)throw Error.argumentNull("viewEventSource");if(!xf)throw Error.argumentNull("pageView");if(!df)throw Error.argumentNull("workspace");if(!If)throw Error.argumentNull("loadScript");if(!nc)throw Error.argumentNull("graphTopologyManager");If("powerpoint-editor-intl").then(()=>{this.eZa=
!0}).catch(hn=>{wc.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+hn.toString())});this.Rb=ib;this.ia=yb;this.bwe=Ai;this.Fa=ac;this.Rf=Ge;this.od=sf;this.Fc=uf;this.aP=dg;this.ua=nc;this.Rf.LI(this.TJa.bind(this));this.Rf.zCa(this.TJa.bind(this));this.Fc.SQa(this.TJa.bind(this));this.od.DCa(this.TJa.bind(this));this.Rb.MI(this.Eu.bind(this));this.initialize()}initialize(){this.aP.execute(ma=>{ma.addEventHandler(Xi.a.DNc,this.DEj.bind(this))})}dispose(){this.Rf.E6(this.TJa.bind(this));
this.Rf.G0a(this.TJa.bind(this));this.Fc.pkb(this.TJa.bind(this));this.od.rkb(this.TJa.bind(this));this.Rb.WY(this.TJa.bind(this))}vb(){this.ia.ra(kc.a.cmb,fc.a.application,this.cmb.bind(this),4);this.ia.ra(kc.a.Rnd,fc.a.application,this.Rnd.bind(this),96)}me(){}TJa(){this.Ab&&this.kl(!0)}Eu(ma){1===ma.mode&&this.Ab&&(this.Ab=!1,this.Kq(),this.Fa.wj(Mi.a.WW,this.Ab))}Rnd(ma,ib,yb,ac,Qc){(ma=Object(J.a)(Fi.a,Qc))&&ma.If(this.Ab);return 32}cmb(ma,ib,yb){return this.eZa?1===yb?32:2===yb?(this.Ab=!this.Ab,
Wi.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Ab.toString(),ma,()=>{this.Ab?this.kl():this.Kq();return 32})):8:8}kl(ma=!1){const ib=this.kA(),yb=Object.assign(new li.a,{title:"Editor Pane",hideHeader:!1,width:this.wYd,location:2,contentProps:ib,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Oh.UISurfaces.Iq().then(ac=>{ma?ac.updateTaskPane(Mi.a.WW,yb):ac.showTaskPane(Mi.a.WW,yb);return null}).catch(ac=>{wc.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+
ac.toString())})}Kq(){Oh.UISurfaces.Iq().then(ma=>{ma.hideTaskPane(Mi.a.WW,2);return null}).catch(ma=>{wc.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+ma.toString())})}kA(){let ma=0,ib=0,yb=0,ac=0,Qc=0,me=0,Ge=0,sf=0;const uf=this.ua.Ba?this.ua.Ba.cid:void 0;uf&&this.xba[uf]&&Object.keys(this.xba[uf]).forEach(xf=>{this.xba[uf][xf].forEach(dg=>{switch(dg.CategoryTitle){case "Spelling":ma+=1;break;case "Grammar":ib+=1;break;case "Conciseness":me+=1;break;
case "Formality":yb+=1;break;case "PunctuationConventions":ac+=1;break;case "Clarity":Ge+=1;break;case "Inclusiveness":sf+=1;break;case "Vocabulary":Qc+=1;break;default:wc.a.J(509727769,822,50,"Unknown Critique Type: "+dg.CategoryTitle)}})});return new mh(ma,ib,yb,ac,Qc,me,Ge,sf)}wSl(ma,ib){const yb={};Object.keys(ma).forEach(ac=>{this.xba[ib]?(Object.keys(this.xba[ib]).includes(ac),this.xba[ib][ac]=ma[ac]):(yb[ac]=ma[ac],this.xba[ib]=yb)})}DEj(ma,ib,yb,ac){ib&&ac&&(ma=JSON.parse(ib.Content),ac=this.bwe.wOc(ac.critiques),
ib=this.ua.Ba.cid,null!=ac&&0<ac.length?this.wSl(this.efj(ac),ib):0==ac.length&&this.xba[ib]&&this.F_i(ma.drawingElems,ib),this.xba[ib]&&this.sal(ma.drawingElems,ib),this.kl(!0))}sal(ma,ib){const yb=Object.keys(this.xba[ib]),ac=this.mzj(ma);yb.forEach(Qc=>{ac.includes(Qc)||delete this.xba[ib][Qc]})}mzj(ma){const ib=[];ma.forEach(yb=>{0<yb.text.paragraphs.length&&yb.text.paragraphs.forEach(ac=>{ib.push(ac.id)})});return ib}F_i(ma,ib){ma.forEach(yb=>{0<yb.text.paragraphs.length&&this.BCi(yb.text.paragraphs,
ib)})}BCi(ma,ib){ma.forEach(yb=>{this.xba[ib][yb.id]&&(yb.pfRuns[0].pf.proofingDirty||""==yb.chars)&&delete this.xba[ib][yb.id]})}efj(ma){const ib={};if(ma)for(const yb of ma)yb.TileId in ib?Array.add(ib[yb.TileId],yb):ib[yb.TileId]=[yb];return ib}}Object(h.a)(ai,"DexLitePaneActor",null,[108,268]);class Aa{constructor(){this.va=new Le.a}XUe(ma){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",ma)}XAf(ma){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",ma)}}Object(h.a)(Aa,
"EditorRuntimeEventSource",null,[1290,1291,1292]);var Ua=d(16),gb=d(51),Eb=d(705),Ub=d(35);class vc{constructor(ma,ib){this.paragraph=ma;this.critiqueId=ib}}Object(h.a)(vc,"CritiqueToHighlight",null,[]);class jd{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf,xf){this.hfa=ma;this.Pjk=ib;this.ua=yb;this.nD=ac;this.Fb=Qc;this.GJ=me;this.pa=Ge;this.Bwe=sf;this.Fa=uf;this.Alk=xf;this.hfa.kWe(this.Pjk)}f_c(ma){ma.length?(ma=this.Hqj(ma),ma.length&&(ma=Object.assign(new Eb.a,{action:0,type:2,kea:ma,xjb:this.hfa.ndb?
this.hfa.ndb.kea:null}),this.hfa.otd(ma))):this.mVi()}mVi(){var ma=this.hfa.ndb?this.hfa.ndb.kea:null;ma=Object.assign(new Eb.a,{action:1,type:2,kea:ma,xjb:ma});this.hfa.otd(ma)}Hqj(ma){const ib=[];if(!this.Bwe.isEnabled(2))return ib;var yb=this.ua.Ba;if(yb&&yb.isSlideCritiqueReady){var ac=yb.mMa;if(!ac.count)return this.Yte(2),ib;yb=0;for(let me of ac)if(ac=Object(J.a)(Ne.AParagraphNode,me)){var Qc=this.Wbe(ac);for(const Ge of Qc)Qc=Object(J.a)(344,Ge.Fh),Qc.UN&&Array.contains(ma,Qc.UN.TraceId)&&
(yb++,Qc=new vc(ac,Qc.UN.TraceId),Array.add(ib,Qc))}yb!==ma.length&&this.mue(2,yb,ma.length)}else this.iue(2,yb);return ib}cKh(ma){if(!this.Bwe.isEnabled(3))return!1;var ib=this.ua.Ba;if(ib&&ib.isSlideCritiqueReady){ib=ib.mMa;if(!ib.count)return this.Yte(3),!1;let yb=0;const ac=this.Fb.yd(15,void 0,()=>{this.Hjh()});try{let Qc=!1;ac.jc(ib.ga(0));ac.gd=Ub.a.cxd;for(let me of ib){const Ge=Object(J.a)(Ne.AParagraphNode,me);if(Ge){const sf=new z.a,uf=this.Wbe(Ge);for(const xf of uf){const dg=Object(J.a)(344,
xf.Fh);if(dg.UN&&ma.Gb(dg.UN.TraceId)){const df=ma.ga(dg.UN.TraceId);let If;try{If=dg.UN.Suggestions[df].Text;const Ai=new Ua.a(xf,If);sf.add(Ai);Qc||(dg.XMa(this.Yxk(df)),Qc=!0);yb++}catch(Ai){wc.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",Ai)}}}sf.count&&(sf.Sc((xf,dg)=>dg.key.begin-xf.key.begin),this.$dl(Ge,sf))}}yb!==ma.count&&this.mue(3,yb,ma.count)}finally{ac&&ac.dispose()}}else return this.iue(3,ib),!1;return!0}Yxk(ma){switch(ma){case 0:return Ub.a.Nza;case 1:return Ub.a.Oza;
case 2:return Ub.a.Pza;case 3:return Ub.a.EMa;case 4:return Ub.a.FMa;default:return 0}}$dl(ma,ib){for(let yb of ib)this.GJ.replaceTextRange(gb.a.createTextRange(ma,0<yb.key.begin?yb.key.begin:0,yb.key.end),yb.value,!0,!1)}ignoreCritiques(ma,ib){if(!this.Bwe.isEnabled(ib))return!1;var yb=this.ua.Ba;if(yb&&yb.isSlideCritiqueReady){var ac=yb.mMa;if(!ac.count)return this.Yte(ib),!1;this.Hjh();yb=!1;let Qc=0;for(let me of ac)if(ac=Object(J.a)(Ne.AParagraphNode,me)){ac=this.Wbe(ac);for(const Ge of ac)ac=
Object(J.a)(344,Ge.Fh),ac.UN&&Array.contains(ma,ac.UN.TraceId)&&(ac.uFa=!0,yb||(ac.XMa(Ub.a.xie),yb=!0),Qc++)}Qc!==ma.length&&this.mue(ib,Qc,ma.length)}else return this.iue(ib,yb),!1;return!0}Wbe(ma){return this.nD.VF(ma,ib=>{ib=Object(J.a)(344,ib.Fh);return!!ib&&5===ib.proofingType&&!ib.uFa})}Yte(ma){wc.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",ma)}mue(ma,ib,yb){wc.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",ma,ib,yb)}iue(ma,ib){wc.a.J(38843404,
375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",ma,!!ib)}Hjh(){this.pa.iu();this.pa.nj();this.Alk&&this.Fa.wf(Mi.a.qg,!0)}}Object(h.a)(jd,"ConsistencyCheckActor",null,[1247]);var Id=d(316),Od=d(99),ba=d(930),Da=d(702),Qa=d(50),nb=d(703),Wb=d(704);class Jb extends Da.a{constructor(ma,ib){super();this.I8c=[ba.a.yLe,ba.a.D5c,ba.a.qrd,ba.a.DLc];this.ua=ma;this.Znk=ib;this.hBe=[new nb.a("InconsistentCritiquesHighlight",null),new nb.a("InconsistentCritiquesLeftSidebar",
null),new nb.a("InconsistentCritiquesRightSidebar",null)]}get Wzb(){return this.Znk}get bie(){return this.hBe}Kac(ma,ib){ma=Object(bd.a)(Array,ma)?Array.isArray(ma)?ma:null:null;if(!ma||0<ma.length&&!Object(J.a)(vc,ma[0]))return ib;const yb=new Qa.GraphTransaction(3);try{yb.ld(this.ua.presentation);for(const ac of ma)Wb.b(ac.paragraph),ib.add(ac.paragraph)}finally{yb&&yb.dispose()}return ib}Anc(ma,ib){if(this.Wzb&&this.d0&&this.d0.Yja&&this.d0.Yja.kea&&2===this.d0.Yja.type){var yb=[],ac=[];this.Dih(this.d0.Yja.kea,
yb,ac);var Qc=[];this.Dih(this.d0.Yja.xjb,null,Qc);ib=ib.querySelectorAll("*");for(let me=0;me<ib.length;me++){let Ge="",sf="";const uf=ib[me];for(let xf=0;xf<this.I8c.length;xf++)Id.a.Be(uf,this.I8c[xf])&&(sf=this.I8c[xf],Ge=Id.a.Be(uf,this.I8c[xf]));Ge.length&&2===this.d0.Yja.type&&(0===this.d0.Yja.action?Array.contains(ac,ma)&&Array.contains(yb,Ge)?this.IMj(uf,sf):this.Spd(uf):1===this.d0.Yja.action&&Array.contains(Qc,ma)&&this.Spd(uf))}}}IMj(ma,ib){Od.a.WI(ma,"InconsistentCritiquesHighlight");
switch(ib){case ba.a.D5c:Od.a.WI(ma,"InconsistentCritiquesLeftSidebar");break;case ba.a.qrd:Od.a.WI(ma,"InconsistentCritiquesRightSidebar");break;case ba.a.DLc:Od.a.WI(ma,"InconsistentCritiquesLeftSidebar"),Od.a.WI(ma,"InconsistentCritiquesRightSidebar")}}Dih(ma,ib,yb){if(ma)for(const ac of ma)Array.add(yb,ac.paragraph),ib&&Array.add(ib,ac.critiqueId)}}Object(h.a)(Jb,"CritiquesHighlightActor",Da.a,[]);class Uc{}Object(h.a)(Uc,"Critique",null,[]);class Jd{}Object(h.a)(Jd,"Suggestion",null,[]);class ne{uPf(ma,
ib){if(!ma)return[];const yb=Array(ma.length);for(let ac=0;ac<ma.length;ac++)yb[ac]=ib(ma[ac]);return yb}VKi(ma){return Object.assign(new Uc,{critiqueId:ma.TraceId,typeId:ma.TypeId,tag:ma.Tag,bucketId:ma.BucketId,paragraphId:ma.TileId,start:ma.Start,length:ma.Length,categoryTitle:ma.CategoryTitle,explanationTitle:ma.ExplanationTitle,explanationLabel:ma.ExplanationLabel,explanation:ma.Explanation,suggestions:this.uPf(ma.Suggestions,Object(t.a)(this,this.WKi,"convertBox4Suggestion"))})}WKi(ma){return Object.assign(new Jd,
{text:ma.Text,description:ma.Description,bucketId:ma.BucketId,numberOfInstances:ma.NumberOfInstances})}}Object(h.a)(ne,"DataContractMapper",null,[1250]);class bf extends Sys.EventArgs{constructor(ma){super();this.instanceId=ma}}Object(h.a)(bf,"PaneClosedEventArgs",Sys.EventArgs,[]);var sd=d(192);class vd{constructor(ma,ib,yb,ac,Qc,me,Ge,sf){this.ia=ma;this.Oc=ib;this.Fc=yb;this.Fxe=ac;this.hGb=Qc;this.HEb=me;this.rBe=Ge;this.Fwk=sf;this.Me=0;this.Oc.execute(uf=>{uf.PJc(Object(t.a)(this,this.$Ja,"onPaneClosed"))})}get state(){return this.Me}pud(ma){this.Me!==
ma&&(this.Me=ma,this.Fc.Uy(new sd.a(1)))}tfh(ma){0===this.state&&(wc.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",ma,(new Date).getTime()),this.pud(1),ma={},ma.cB=ResourceStrings.L_EditorPaneTitle,ma.assetId=this.hGb.getAssetId(),ma.n6=Object(t.a)(this,this.zib,"onPaneRendered"),ma.nonPersistedSettings={},ma.nonPersistedSettings.IdeasEnabled=this.rBe.toString(),ma.Uaf=this.Fwk,32!==this.ia.Ja(kc.a.Sga,2,ma)&&(wc.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),
this.pud(0)))}eH(ma){if(2===this.state){var ib=this.hGb.hUa();ib&&(wc.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",ma),32!==this.ia.Ja(kc.a.hvb,2,ib)&&wc.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}$Ja(ma,ib){2===this.state&&ib&&(ma=ib.instanceId)&&ma.length&&(ib=this.hGb.hUa(),ib!==ma&&ib||(wc.a.J(37626588,375,50,"[EditorPane] Pane closed"),this.Fxe.e2k(new bf(ma)),this.pud(0),this.HEb.sessionEnd()))}zib(){const ma=this.hGb.hUa();1!==this.state?
wc.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",ma):(wc.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",ma),this.pud(2),this.HEb.pnl())}}Object(h.a)(vd,"EditorPane",null,[1252]);class $c{constructor(ma,ib){this.type=0;this.id=null;this.type=ma;this.id=ib}static unb(ma){return ma.id&&ma.id.toString().length&&Object(bd.a)(Number,ma.type)?new $c(ma.type,ma.id.toString()):null}}Object(h.a)($c,"Message",
null,[]);var hd=d(3);class Dd{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf,xf,dg,df,If,Ai,nc,hn){this.o7d=new Hh.a;this.ia=ma;this.P0=ib;this.bEb=yb;this.mEg=ac;this.Q0=Qc;this.qQg=me;this.pM=Ge;this.Fxe=sf;this.ua=uf;this.pna=xf;this.Yed=dg;this.Kk=df;this.Dkk=If;this.Fc=Ai;this.Klk=nc;this.ic=hn;this.zSc=new Hh.a(0);this.zSc.add(0,2001);this.zSc.add(1,2002);this.zSc.add(2,2003)}vb(){this.ia.ra(kc.a.pRe,fc.a.application,Object(t.a)(this,this.TXf,"editorPaneButtonClicked"),4);this.ia.ra(kc.a.WTe,fc.a.application,
Object(t.a)(this,this.Llh,"queryEditorPaneButton"),96);this.ia.ra(kc.a.ZUk,fc.a.application,Object(t.a)(this,this.TXf,"editorPaneButtonClicked"),4);this.ia.ra(kc.a.XTe,fc.a.application,Object(t.a)(this,this.Llh,"queryEditorPaneButton"),96);this.ia.ra(kc.a.oRe,fc.a.application,Object(t.a)(this,this.UXf,"editorPaneExtenal"),4);this.ia.ra(kc.a.djh,fc.a.application,Object(t.a)(this,this.UXf,"editorPaneExtenal"),4);this.mEg.oUd(Object(t.a)(this,this.cHk,"onEditorPaneMessageReceived"));this.pna.D7a(Object(t.a)(this,
this.D1,"onSlidePresenceChanged"));this.Yed.gk(Object(t.a)(this,this.woa,"onSlidePropertyChanged"));this.Kk.LI(Object(t.a)(this,this.aC,"onActiveSlideChanged"));this.Fxe.vki(Object(t.a)(this,this.$Ja,"onPaneClosed"))}me(){}UXf(ma,ib,yb){if(1===yb)return 32;switch(ma){case kc.a.oRe:this.P0.tfh(2);break;case kc.a.djh:this.P0.eH(2);break;default:return wc.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",ma),16}return 32}TXf(ma,ib,yb){if(1===yb)return this.ic.rj()?32:16;switch(this.P0.state){case 0:return this.P0.tfh(1),
32;case 2:return this.P0.eH(1),32;case 1:return wc.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Fc.Uy(new sd.a(1)),32;default:return wc.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}Llh(ma,ib,yb,ac,Qc){if(!Qc||!Object(bd.a)(Fi.a,Qc))return 8;Qc.If(2===this.P0.state||1===this.P0.state);return 32}cHk(ma,ib){this.dHk(ib)}dHk(ma){const ib=this.Q0.gWi(ma.message);if(ib){var yb;({value:yb}=this.qQg.vg(ib.type)).returnValue||
(yb=this.qQg.ga(0));var ac=yb.process(ma,ib);ac.continueWith(()=>{const Qc=ac.result,me=this.Q0.FYf(Qc);this.sendMessage(ma.instanceId,me);this.Efk(ma,ib,Qc)})}else wc.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),hd.Task.ut(!1)}YUe(ma){this.o7d.Gb(ma)||this.o7d.$(ma,this.Klk.Y1d(200,()=>{const ib=this.bEb.oxj(ma);if(ib.length){var yb=new $c(this.zSc.ga(ma),be.a.create().toString());yb=this.Q0.FYf(yb);this.iml(ib,yb)}this.Dkk.XUe(ma)}));this.o7d.ga(ma).perform()}iml(ma,
ib){for(const yb of ma)this.sendMessage(yb,ib)}sendMessage(ma,ib){this.mEg.sendMessage(ma,ib)}Efk(ma,ib,yb){const ac=new Date,Qc=+ac-+ma.coh;2E3<=Qc&&wc.a.J(39331167,375,1E4<=Qc?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",ma.instanceId,ma.jpe,ma.coh.toUTCString(),ac.getTime(),Qc.toString(),ib.id,ib.type,
yb.id,yb.type)}woa(ma,ib){ib.property===Kf.a.isSlideCritiqueReady&&this.YUe(1)}aC(){this.YUe(0)}D1(ma,ib){(ma=this.ua.Ba)&&ib.slideId.equals(ma.Cb)&&this.YUe(2)}$Ja(ma,ib){this.bEb.nRl(ib.instanceId);this.pM.visualizeCritiques([])}}Object(h.a)(Dd,"EditorPaneActor",null,[]);class Re{constructor(){this.va=new Le.a}vki(ma){this.va.addHandler("PaneClosed",ma)}e2k(ma){this.va.raiseEvent("PaneClosed",ma)}}Object(h.a)(Re,"EditorPaneEventSource",null,[1253,1288,1289]);var ml=d(4);class Mh{}Object(h.a)(Mh,
"Paragraph",null,[]);var we=d(217);class Yi{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf){this.ua=ma;this.nD=ib;this.rXa=yb;this.ia=ac;this.Ga=Qc;this.Hsk=me;this.Twe=Ge;this.Hh=sf;this.dok=uf}checkProofingDirty(ma){const ib=ma.includedTags;if(2===ma.critiqueSelection&&1===ib)return ma=(ma=this.ua.Ba)&&ma.isConnected?!ma.isSlideCritiqueReady:!0,this.ova(0,!0),ma;this.Xyg("CheckProofingDirty");return!0}getCritiques(ma){var ib=ma.includedTags;if(2===ma.critiqueSelection&&1===ib){ma=this.ua.Ba;if(!ma||!ma.isConnected||
!ma.isSlideCritiqueReady)return null;ib=ma.mMa;ma=[];for(let yb of ib)if((ib=yb)&&ib.isConnected){ib=this.nD.VF(ib,ac=>{ac=Object(J.a)(344,ac.Fh);return!!ac&&5===ac.proofingType&&!ac.uFa});for(const ac of ib)(ib=Object(J.a)(344,ac.Fh))&&ma.push(ib.UN)}this.ova(1,!0);return this.Twe.uPf(ma,Object(t.a)(this.Twe,this.Twe.VKi,"convertBox4Critique"))}this.Xyg("GetCritiques");return null}jbg(ma){var ib=this.ua.Ba;if(!ib||!ib.isConnected)return null;const yb=[];ma=Yi.OBk(ma);ib=ib.ada;for(const ac of ma)(ma=
Object(J.a)(Ae.a,ib.Be(be.a.Kf(ac))))&&ma.isConnected&&yb.push(Object.assign(new Mh,{paragraphId:ac,text:this.Hh.SXe(ma,"\n")}));return yb}getSupportedLanguages(ma){return this.Hsk.yhj(ma.includedTags).CWR(ib=>{const yb=[];if(ib=Object(J.a)(ml.a,ib)){ib=ib.result;for(let ac of ib)(ib=Td.a.He(ac))&&Array.add(yb,ib.name)}this.ova(6,!0);return yb})}getLanguagesOnCurrentSlide(){const ma=[],ib=[],yb=this.ua.Ba;let ac=[];yb&&(ac=yb.yj());for(const Qc of ac)this.Ga.vG(Qc,me=>{if(me&&Object(bd.a)(Ne.AParagraphNode,
me)){me=Object(J.a)(Ne.AParagraphNode,me);var Ge=me.characterData;if(Ge&&Ge.length){var sf=-1,uf;for(Ge=0;Ge<me.Sa.length;Ge++)if(uf=me.Sa.ga(Ge).formatting)uf=Fh.a.language(uf),sf===uf||Array.contains(ma,uf)||(Array.add(ma,uf),(sf=Td.a.He(uf))&&Array.add(ib,sf.name)),sf=uf}}});this.ova(7,!0);return ib}visualizeCritiques(ma){if(!ma)return this.ova(2,!1),1;const ib=Array(ma.length);if(!ma.length)return this.rXa.f_c(ib),this.ova(2,!0),0;for(let yb=0;yb<ma.length;yb++)ib[yb]=ma[yb].critiqueId;this.rXa.f_c(ib);
this.ova(2,!0);return 0}resolveCritiques(ma){if(!ma||!ma.length)return 1;const ib=new Hh.a(0);for(const yb of ma)ib.add(yb.critiqueId,yb.suggestionIndex);ma=this.rXa.cKh(ib);this.ova(3,ma);return ma?0:1}ignoreCritiques(ma){if(!ma||!ma.length)return 1;const ib=[];for(const yb of ma)Array.add(ib,yb.critiqueId);ma=this.rXa.ignoreCritiques(ib,4);this.ova(4,ma);return ma?0:1}openProofingSettingsDialog(){if(this.dok){const ma=this.ia.processAction(Ub.a.FJb,2);this.ova(5,32===ma)}}ova(ma,ib){wc.a.J(37266337,
375,50,"{0}: {1}",ma,ib?0:1)}Xyg(ma){wc.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",ma)}static OBk(ma){const ib=new we.a;for(var yb of ma)ib.contains(yb.paragraphId)||ib.add(yb.paragraphId);ma=Array(ib.count);yb=0;for(let ac of ib)ma[yb++]=ac;return ma}}Object(h.a)(Yi,"EditorPaneHost",null,[1249]);class nl{}Object(h.a)(nl,"EditorRuntimeNotificationData",null,[]);class Pj extends Sys.EventArgs{constructor(){super();this.A5b=this.rla=null}}Object(h.a)(Pj,"EditorRuntimeNotificationEventArgs",
Sys.EventArgs,[]);class ol{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(ol,"InfraredResultBase",null,[]);var mi=d(346),nk=d(536);class ek{constructor(ma,ib){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=ma;this.includedTags=ib}static lI(ma){return Object(bd.a)(Number,ma.critiqueSelection)&&Object(bd.a)(Number,ma.includedTags)?new ek(ma.critiqueSelection,ma.includedTags):null}}Object(h.a)(ek,"CritiqueFilter",
null,[]);class bj{constructor(ma,ib,yb,ac){this.ia=ma;this.pM=ib;this.ua=yb;this.oEg=ac}XUe(ma){if(this.oEg){var ib=new ek(2,1),yb=this.pM.checkProofingDirty(ib),ac=yb?[]:this.pM.getCritiques(ib),Qc=yb?[]:this.pM.jbg(ac);ib=this.YLe();ma=Object.assign(new nl,{isProofingDirty:yb,critiques:ac,paragraphs:Qc,numberOfCoAuthors:ib,contextChanged:0===ma});Qc=(ac=!!ac&&0<ac.length)?1:0;let me=mi.a.success;0<ib?me=mi.a.GJa:yb?me=mi.a.pending:ac||(me=mi.a.GJa);yb=Object.assign(new Pj,{rla:Object.assign(new ol,
{notificationConfidence:Qc,shouldRaiseNotification:!1,confidence:1,resultStatus:me}),A5b:ma});this.oEg.XUe(yb)}}YLe(){var ma=this.ua.Ba;if(!ma||!ma.isConnected)return 0;ma=Object.assign(new nk.a,{slideId:ma.Cb});this.ia.Ja(kc.a.q0a,2,ma);return ma.Vuc}}Object(h.a)(bj,"EditorRuntimeEventRaiser",null,[1248]);var Nk=d(551),Qj=d(716);class Nf{constructor(ma){this.Pmk=ma}pnl(){this.n1a(0,0)}sessionEnd(){this.n1a(1,0)}iHl(){this.n1a(2,4)}jHl(){this.n1a(2,3)}n1a(ma,ib){this.Pmk.execute(yb=>{const ac=Object.assign(new Qj.a,
{cardId:Nk.a.RXf,actionType:ma,actionEngagement:ib});yb.Hid(ac)})}}Object(h.a)(Nf,"InfraredTelemetryLogger",null,[1251]);class Bg extends $c{constructor(ma,ib,yb){super(ma,ib);this.payload=null;this.payload=yb}}Object(h.a)(Bg,"MessageWithPayload",$c,[]);class Xk extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}}Object(h.a)(Xk,"CheckProofingDirtyAndGetCritiquesResponse",Bg,[]);class Ni extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}}Object(h.a)(Ni,"ResponseMessage",Bg,[]);class nh{constructor(ma){this.statusCode=
0;this.logErrorMessage=null;this.statusCode=ma;this.logErrorMessage="";0!==ma&&(this.logErrorMessage=ma.toString())}}Object(h.a)(nh,"Response",null,[]);class ni extends nh{constructor(ma,ib,yb,ac){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=ma;this.critiques=ib;this.paragraphs=yb;this.languagesOnTheCurrentSlide=ac}}Object(h.a)(ni,"ProofingDirtyAndCritiques",nh,[]);class ye{constructor(ma,ib,yb){this.ua=ma;this.pM=ib;this.Q0=
yb}process(ma,ib){var yb=this.Q0.pUi(ma.message);if(!yb)return wc.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),ma=new nh(1),hd.Task.ut(new Ni(1003,ib.id,ma));ma=this.ua.Ba;if(!ma||!ma.isConnected)return wc.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),ma=new ni(!1,[],[],[]),ib=new Xk(1003,ib.id,ma),hd.Task.ut(ib);yb=(ma=this.pM.checkProofingDirty(yb.payload))?[]:this.pM.getCritiques(yb.payload);
if(!yb)return wc.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),ma=new nh(2),hd.Task.ut(new Ni(1003,ib.id,ma));const ac=ma?[]:this.pM.jbg(yb),Qc=ma?[]:this.pM.getLanguagesOnCurrentSlide();if(!Qc)return wc.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),ma=new nh(7),hd.Task.ut(new Ni(1003,ib.id,ma));ma=new ni(ma,yb,ac,Qc);ib=new Xk(1003,ib.id,ma);return hd.Task.ut(ib)}}Object(h.a)(ye,
"CheckProofingDirtyAndGetCritiquesProcessor",null,[1282]);class Dg{constructor(ma,ib,yb){this.pM=ma;this.Q0=ib;this.HEb=yb}process(ma,ib){var yb=this.Q0.rUi(ma.message);if(!yb)return wc.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),ma=new nh(1),hd.Task.ut(new Ni(1006,ib.id,ma));yb=this.pM.ignoreCritiques(yb.payload);0===yb&&ma.jpe&&this.HEb.jHl();ma=0===yb?new nh(0):new nh(6);return hd.Task.ut(new Ni(1006,ib.id,ma))}}Object(h.a)(Dg,"IgnoreProcessor",null,[1282]);class Fj extends Bg{constructor(ma,
ib,yb){super(ma,ib,yb)}}Object(h.a)(Fj,"NumberOfCoAuthorsResponse",Bg,[]);class Gj extends nh{constructor(ma){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=ma}}Object(h.a)(Gj,"NumberOfCoAuthorsModel",nh,[]);class xj{constructor(ma,ib){this.ia=ma;this.ua=ib}process(ma,ib){ma=this.YLe();ma=new Gj(ma);return hd.Task.ut(new Fj(1009,ib.id,ma))}YLe(){var ma=this.ua.Ba;if(!ma||!ma.isConnected)return 0;ma=Object.assign(new nk.a,{slideId:ma.Cb});this.ia.Ja(kc.a.q0a,2,ma);return ma.Vuc}}Object(h.a)(xj,
"NumberOfCoAuthorsProcessor",null,[1282]);class Rj{constructor(ma,ib,yb){this.ia=ma;this.P0=ib;this.rBe=yb}process(ma,ib){if(!this.rBe)return wc.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),ma=new nh(10),hd.Task.ut(new Ni(1011,ib.id,ma));this.P0.eH(3);ma=this.ia.processAction(kc.a.P3e,2);32!==ma&&wc.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");ma=new nh(32!==ma?9:0);return hd.Task.ut(new Ni(1011,
ib.id,ma))}}Object(h.a)(Rj,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[1282]);class Bl{constructor(ma){this.pM=ma}process(ma,ib){this.pM.openProofingSettingsDialog();ma=new nh(0);return hd.Task.ut(new Ni(1007,ib.id,ma))}}Object(h.a)(Bl,"OpenProofingSettingsProcessor",null,[1282]);class Cl{constructor(ma,ib,yb){this.pM=ma;this.Q0=ib;this.HEb=yb}process(ma,ib){var yb=this.Q0.sUi(ma.message);if(!yb)return wc.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),ma=new nh(1),hd.Task.ut(new Ni(1005,
ib.id,ma));yb=this.pM.resolveCritiques(yb.payload);0===yb&&ma.jpe&&this.HEb.iHl();ma=0===yb?new nh(0):new nh(5);return hd.Task.ut(new Ni(1005,ib.id,ma))}}Object(h.a)(Cl,"ResolveProcessor",null,[1282]);class Th extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}}Object(h.a)(Th,"SubscriptionResponse",Bg,[]);class hi extends nh{constructor(ma){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=ma}}Object(h.a)(hi,"SubscriptionModel",nh,[]);class Yk{constructor(ma,ib){this.bEb=ma;this.Q0=
ib}process(ma,ib){const yb=this.Q0.tUi(ma.message);if(!yb)return wc.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),ma=new nh(1),hd.Task.ut(new Ni(1001,ib.id,ma));wc.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",yb.payload.telemetryCorrelationId);this.bEb.subscribe(ma.instanceId,0);this.bEb.subscribe(ma.instanceId,1);this.bEb.subscribe(ma.instanceId,2);ma=new hi("not available");return hd.Task.ut(new Th(1001,ib.id,ma))}}Object(h.a)(Yk,"SubscribeProcessor",null,[1282]);
class cj extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}}Object(h.a)(cj,"SupportedLanguagesResponse",Bg,[]);class Am extends nh{constructor(ma){super(0);this.supportedLanguages=null;this.supportedLanguages=ma}}Object(h.a)(Am,"SupportedLanguagesModel",nh,[]);class Pl{constructor(ma,ib){this.pM=ma;this.Q0=ib}process(ma,ib){ma=this.Q0.uUi(ma.message);if(!ma)return wc.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),ma=new nh(1),hd.Task.ut(new Ni(1010,ib.id,ma));const yb=this.pM.getSupportedLanguages(ma.payload);
return yb.CWR(()=>{var ac=yb.result;if(!ac)return wc.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),ac=new nh(8),new Ni(1010,ib.id,ac);ac=new Am(ac);return new cj(1010,ib.id,ac)})}}Object(h.a)(Pl,"SupportedLanguagesProcessor",null,[1282]);class Dl{process(ma,ib){wc.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",ib.type);ma=new nh(3);return hd.Task.ut(new Ni(ib.type,ib.id,ma))}}Object(h.a)(Dl,"UnsupportedMessageProcessor",
null,[1282]);class ii{constructor(ma,ib){this.pM=ma;this.Q0=ib}process(ma,ib){ma=this.Q0.vUi(ma.message);if(!ma)return wc.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),ma=new nh(1),hd.Task.ut(new Ni(1004,ib.id,ma));ma=0===this.pM.visualizeCritiques(ma.payload)?new nh(0):new nh(4);return hd.Task.ut(new Ni(1004,ib.id,ma))}}Object(h.a)(ii,"VisualizeProcessor",null,[1282]);class oh extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}static lI(ma){const ib=$c.unb(ma);return ib&&ma.payload?
(ma=ek.lI(ma.payload))?new oh(ib.type,ib.id,ma):null:null}}Object(h.a)(oh,"CheckProofingDirtyAndGetCritiquesMessage",Bg,[]);class ok{constructor(ma){this.CTb=ma}get critiqueId(){return this.CTb}static lI(ma){return ma.critiqueId&&Object(J.a)(String,ma.critiqueId)?new ok(ma.critiqueId.toString()):null}}Object(h.a)(ok,"CritiqueIgnore",null,[]);class ya extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}static lI(ma){const ib=$c.unb(ma);if(!ib||!ma.payload||!Object(bd.a)(Array,ma.payload))return null;
ma=ma.payload;const yb=Array(ma.length);for(let ac=0;ac<ma.length;ac++){const Qc=ok.lI(ma[ac]);if(!yb)return null;yb[ac]=Qc}return new ya(ib.type,ib.id,yb)}}Object(h.a)(ya,"IgnoreCritiquesMessage",Bg,[]);class qd{constructor(ma,ib){this.CTb=ma;this.fai=ib}get critiqueId(){return this.CTb}get suggestionIndex(){return this.fai}static lI(ma){return ma.critiqueId&&Object(J.a)(String,ma.critiqueId)&&Object(bd.a)(Number,ma.suggestionIndex)?new qd(ma.critiqueId.toString(),ma.suggestionIndex):null}}Object(h.a)(qd,
"CritiqueResolution",null,[]);class ea extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}static lI(ma){const ib=$c.unb(ma);if(!ib||!ma.payload||!Object(bd.a)(Array,ma.payload))return null;ma=ma.payload;const yb=Array(ma.length);for(let ac=0;ac<ma.length;ac++){const Qc=qd.lI(ma[ac]);if(!yb)return null;yb[ac]=Qc}return new ea(ib.type,ib.id,yb)}}Object(h.a)(ea,"ResolveCritiquesMessage",Bg,[]);class Ok{constructor(ma){this.telemetryCorrelationId=null;this.telemetryCorrelationId=ma}static lI(ma){let ib=
"unavailable";ma.telemetryCorrelationId&&Object(J.a)(String,ma.telemetryCorrelationId)&&ma.telemetryCorrelationId.toString().length&&50>=ma.telemetryCorrelationId.toString().length&&(ib=ma.telemetryCorrelationId.toString());return new Ok(ib)}}Object(h.a)(Ok,"Subscription",null,[]);class kj extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}static lI(ma){const ib=$c.unb(ma);if(!ib)return null;ma.payload||(ma.payload={});return(ma=Ok.lI(ma.payload))?new kj(ib.type,ib.id,ma):null}}Object(h.a)(kj,"SubscribeMessage",
Bg,[]);class Ek extends Bg{constructor(ma,ib,yb){super(ma,ib,yb)}static lI(ma){const ib=$c.unb(ma);return ib&&ma.payload?(ma=ek.lI(ma.payload))?new Ek(ib.type,ib.id,ma):null:null}}Object(h.a)(Ek,"SupportedLanguagesMessage",Bg,[]);class Uf{constructor(ma){this.CTb=ma}get critiqueId(){return this.CTb}static lI(ma){return ma.critiqueId&&Object(J.a)(String,ma.critiqueId)&&ma.critiqueId.toString().length?new Uf(ma.critiqueId.toString()):null}}Object(h.a)(Uf,"CritiqueToVisualize",null,[]);class pl extends Bg{constructor(ma,
ib,yb){super(ma,ib,yb)}static lI(ma){const ib=$c.unb(ma);if(!ib||!ma.payload||!Object(bd.a)(Array,ma.payload))return null;ma=ma.payload;const yb=Array(ma.length);for(let ac=0;ac<ma.length;ac++){const Qc=Uf.lI(ma[ac]);if(!yb)return null;yb[ac]=Qc}return new pl(ib.type,ib.id,yb)}}Object(h.a)(pl,"VisualizeCritiquesMessage",Bg,[]);class Zk{gWi(ma){return this.tnb(ma,$c.unb)}tUi(ma){return this.tnb(ma,kj.lI)}pUi(ma){return this.tnb(ma,oh.lI)}vUi(ma){return this.tnb(ma,pl.lI)}sUi(ma){return this.tnb(ma,
ea.lI)}rUi(ma){return this.tnb(ma,ya.lI)}uUi(ma){return this.tnb(ma,Ek.lI)}tnb(ma,ib){try{let yb;return({Su:yb}=B.d(ma)).returnValue?ib(yb):null}catch(yb){return null}}FYf(ma){return B.c(ma)}}Object(h.a)(Zk,"MessageEncoder",null,[1257]);var Sf=d(77);class bi extends Sys.EventArgs{constructor(ma,ib,yb){super();this.instanceId=ma;this.message=ib;this.jpe=yb;this.coh=new Date}}Object(h.a)(bi,"MessageReceivedEventArgs",Sys.EventArgs,[]);class qc{constructor(ma,ib,yb){this.va=new Le.a;this.hGb=ma;this.Zzg=
ib;this.Bmk=new RegExp(yb,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(t.a)(this,this.$lc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(t.a)(this,this.$lc,"messageReceivedHandler")),!0;wc.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(ma){wc.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
ma.message,ma.stack)}return!1}oUd(ma){this.va.addHandler("MessageReceived",ma)}Zqh(ma){this.va.removeHandler("MessageReceived",ma)}sendMessage(ma,ib){if(ma&&ib){var yb={};yb.message=ib;yb.editorPaneWildCard=".";this.eml(ma,yb)}}eml(ma,ib){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(ma,"onCustomMessage",ib,yb=>{yb&&wc.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",yb)})}$lc(ma){const ib=ma.origin;if(this.bcc(ib)){var yb;({Su:yb}=B.d(ma.data)).returnValue&&
yb&&"."===yb.editorPaneWildCard&&yb.message&&this.va.raiseEvent("MessageReceived",new bi(this.hGb.hUa(),yb.message,ib===this.Zzg))}}bcc(ma){const ib=Sf.a.KQ(window.location.href);return!!ma&&0<ma.length&&"null"!==ma&&(ma===this.Zzg||ma===ib||this.Bmk.test(ma))}}Object(h.a)(qc,"Messenger",null,[1256]);class ql{constructor(ma,ib){this.Oc=ma;this.assetId=ib.ojh}hUa(){if(!this.Oc.instance)return wc.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const ma=this.Oc.instance.HQ(this.assetId);
return ma?ma.instanceId?ma.instanceId:(wc.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(wc.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(ql,"PaneIdsProvider",null,[1254]);class Kc{constructor(){this.Us=new Hh.a}subscribe(ma,ib){ma&&(this.Us.Gb(ib)||this.Us.add(ib,[]),Array.contains(this.Us.ga(ib),ma)||this.Us.ga(ib).push(ma))}unsubscribe(ma,ib){ma&&this.Us.Gb(ib)&&(ma=Array.indexOf(this.Us.ga(ib),
ma),-1!==ma&&Array.removeAt(this.Us.ga(ib),ma))}nRl(ma){ma&&(this.unsubscribe(ma,0),this.unsubscribe(ma,1),this.unsubscribe(ma,2))}oxj(ma){return this.Us.Gb(ma)?this.Us.ga(ma):[]}}Object(h.a)(Kc,"EditorPaneSubscriptionsManager",null,[1255]);var Of=d(193);class nj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Xb(ma){ma&&(this.K=ma,this.K.register(Jb,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").na().oa(()=>new Jb(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(1247,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").na().oa(()=>new jd(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(Dd,"PowerPointWebEditor.EditorPane.EditorPaneActor").na().oa(()=>new Dd(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.FPi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").zd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),nj.mZj&&this.K.register(ai,"PowerPointWebEditor.EditorPane.DexLitePaneActor").na().oa(()=>new ai(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),Of.a(this.K),this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(1248,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").na().oa(()=>new bj(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),
this.K.register(Aa,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").na().oa(()=>new Aa),this.K.register(1249,"PowerPointWebEditor.EditorPane.IEditorPaneHost").na().oa(()=>new Yi(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(1250,"PowerPointWebEditor.EditorPane.IDataContractMapper").na().oa(()=>new ne),this.K.register(1251,
"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").na().oa(()=>new Nf(this.K.Ia("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(1252,"PowerPointWebEditor.EditorPane.IEditorPane").na().oa(()=>new vd(this.K.resolve("Common.IActionManagerExtended"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(1253,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").na().oa(()=>new Re),this.K.register(1254,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").na().oa(()=>new ql(this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1255,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").na().oa(()=>
new Kc),this.K.register(1256,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").na().oa(()=>new qc(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").FVk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(1257,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").na().oa(()=>new Zk),this.K.register(Dl,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").na().oa(()=>
new Dl),this.K.register(Yk,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").na().oa(()=>new Yk(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Cl,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").na().oa(()=>new Cl(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Dg,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").na().oa(()=>new Dg(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Bl,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").na().oa(()=>
new Bl(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(ye,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").na().oa(()=>new ye(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(ii,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").na().oa(()=>
new ii(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(xj,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").na().oa(()=>new xj(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Pl,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").na().oa(()=>new Pl(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Rj,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").na().oa(()=>new Rj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").$e(()=>{var ma=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
nj.zxl(ma)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(ma=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),ma.vb(),ma.me(),ma=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),ma.vb(),ma.me())})}dispose(){}FPi(){const ma=new Hh.a;ma.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));ma.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
ma.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));ma.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));ma.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));ma.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));ma.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));ma.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));ma.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));ma.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return ma}static main(){n.a.instance.Ac(new nj)}static zxl(ma){return ma.pptEditorConsistencyCheckIsEnabled&&nj.MWj(ma.ojh)}static mZj(ma){return ma.hVf}static MWj(ma){return!!ma&&0<ma.length}}
Object(h.a)(nj,"PptWebEditorEditorPanePackage",null,[2,3]);class Hj{constructor(ma){this.Ab=!1;this.wYd=320;this.initialize();this.ia=ma}initialize(){}dispose(){}vb(){this.ia.ra(kc.a.cmb,fc.a.application,this.cmb,4)}me(){}cmb(ma,ib,yb){return 1===yb?32:2===yb?Wi.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Ab.toString(),ma,()=>{this.Ab?this.kl():this.Kq();return 32}):8}kl(ma=!1){const ib=this.kA();this.Ab=!0;const yb=Object.assign(new li.a,{title:ResourceStrings.L_DexLitePaneTitle,hideHeader:!1,
width:this.wYd,location:2,contentProps:ib,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Oh.UISurfaces.Iq().then(ac=>{ma?ac.updateTaskPane(Mi.a.WW,yb):ac.showTaskPane(Mi.a.WW,yb);return null}).catch(ac=>{wc.a.J(508883089,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+ac.toString())})}Kq(){this.Ab=!1;Oh.UISurfaces.Iq().then(ma=>{ma.hideTaskPane(Mi.a.WW,2);return null}).catch(ma=>{wc.a.J(508883088,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+
ma.toString())})}kA(){return new mh(0,0,0,0,0,0,0,0)}}Object(h.a)(Hj,"EditorPaneActor",null,[108,268]);var Xf=d(552);class $l{constructor(ma,ib,yb,ac,Qc,me,Ge){this.sIf=/[\n\t `'"]+/;this.Cxi=10;this.zxi=7;if(!ma)throw Error.argumentNull("shapeReader");if(!ib)throw Error.argumentNull("selectionManager");if(!yb)throw Error.argumentNull("graphTopologyManager");if(!ac)throw Error.argumentNull("pageView");if(!Qc)throw Error.argumentNull("activeSlideViewManager");if(!Ge)throw Error.argumentNull("shapeTargetBounds");
this.Ga=ma;this.pa=ib;this.ua=yb;this.Eb=ac;this.Kc=Qc;this.Dxi=me;this.m0g=Ge}dispose(){}get RPc(){const ma=this.pa.Ll();return ma?ma.qc(this.Eb.Na).getBounds():new Sys.UI.Bounds(0,0,0,0)}get USf(){const ma=this.Kc.Hc;return ma?ma.WA.getBoundingClientRect():new Sys.UI.Bounds(0,0,0,0)}BXc(){return this.m0g.DCi(this.RPc,this.USf)}tYc(){return this.m0g.ykj(this.BXc(),this.USf,this.RPc)}t3d(){const ma=this.qSa;switch(ma){case Xf.RewriteType.Title:const ib=this.mAj();return{Zvb:null!==ib&&void 0!==ib?
ib:this.Zyj(),inputType:ma,LRc:[Xf.RewriteSuggestionType.Concise]};case Xf.RewriteType.Content:return this.lAj()}}get qSa(){const ma=this.pa.Ll();if(!ma||ma.Ik)switch(ma.Cj){case 0:case 2:return Xf.RewriteType.Title;case 1:case 8:return Xf.RewriteType.Content}}get RFa(){const ma=this.pa.Ll();return ma&&ma.Ik&&this.t3d()?!0:!1}f_j(ma){const ib=this.pa.Ll(),yb=this.Ga.Qqj(ib);ma=null===ma||void 0===ma?void 0:ma.nb;ma=this.ALi(null===ma||void 0===ma?void 0:ma.toArray());this.D7i(ma,yb);if(!ma||yb.size!=
ma.size)return!1;let ac=!0;ma.forEach((Qc,me)=>{if(Qc){var Ge=Qc.Ra;Qc=Qc.Lb;0<=Ge&&0<=Qc&&Math.abs(Qc-Ge)!=yb.get(me)&&(ac=!1)}else ac=!1});return ac}D7i(ma,ib){ib.forEach((yb,ac)=>{0==yb&&(ma.delete(ac),ib.delete(ac))})}ALi(ma){const ib=new Map;ma.forEach(yb=>{const ac=yb.node;if(ib.has(ac.id)){const Qc=yb.Lb;-1!=yb.Ra&&-1!=Qc&&ib.set(ac.id,yb)}else ib.set(ac.id,yb)});return ib}mAj(){var ma=this.ua.Ba;if(ma){var ib=[];ma.yj().filter(yb=>yb&&yb.Ik&&!yb.x0).forEach(yb=>ib.push(this.Ga.WWc(yb)));ma=
ib.filter(yb=>yb&&0<yb.length).join("\n");return this.gpg(ma)?ma:void 0}wc.a.J(0,816,10,"Active slide node is null")}Zyj(){var ma=this.pa.Ll();if(ma&&!ma.mA)return(ma=(ma=this.Ga.WWc(ma))?ma.trim():void 0)&&0<ma.length?ma:void 0}lAj(){const ma=this.pa.Ll();if(ma){var ib=this.Ga.WWc(ma);if(this.gpg(ib))return{Zvb:ib,inputType:this.qSa,LRc:[Xf.RewriteSuggestionType.Concise,Xf.RewriteSuggestionType.Bullet,Xf.RewriteSuggestionType.Paraphrase]};var yb=[];this.CYj(ma)&&yb.push(Xf.RewriteSuggestionType.Concise);
if(0!=yb.length)return{Zvb:ib,inputType:this.qSa,LRc:yb}}}gpg(ma){return!ma||0>=ma.length?!1:ma.trim().split(this.sIf).length>=this.Dxi}CYj(ma){if(!ma||18===ma.z2a||0===ma.z2a)return!1;ma=this.Ga.WWc(ma);if(!ma)return!1;ma=ma.split("\n");if(ma.length>=this.zxi)return!0;for(const ib of ma){if(null===ib||void 0===ib||!ib.length)break;if(ib.trim().split(this.sIf).length>=this.Cxi)return!0}return!1}}Object(h.a)($l,"RewriteSelectionManager",null,[1160]);var kg=d(443),Rm=d(985);class oi{constructor(){this.completion=
new Promise((ma,ib)=>{this.resolve=ma;this.reject=ib})}}Object(h.a)(oi,"ControlledPromise",null,[]);class oj{static Shj(){const ma=[];this.Rwe.forEach((ib,yb)=>{(null===ib||void 0===ib?0:ib.text)&&ma.push({suggestionText:ib.text,suggestionType:yb})});return ma}static Qhj(ma){if(1!=ma.length)return 0;switch(ma[0]){case Xf.RewriteSuggestionType.Bullet:return this.qYd;case Xf.RewriteSuggestionType.Concise:return this.uYd;case Xf.RewriteSuggestionType.Paraphrase:return this.IYd;default:return 0}}static uPj(ma){switch(ma){case Xf.RewriteSuggestionType.Bullet:this.qYd++;
break;case Xf.RewriteSuggestionType.Concise:this.uYd++;break;case Xf.RewriteSuggestionType.Paraphrase:this.IYd++}}static amg(){this.Rwe.clear();this.IYd=this.uYd=this.qYd=0}static NPh(ma){var ib;0<(null===(ib=null===ma||void 0===ma?void 0:ma.rewriteSuggestions)||void 0===ib?void 0:ib.length)&&ma.rewriteSuggestions.forEach(yb=>{this.Rwe.set(yb.type,yb)})}}oj.Rwe=new Map;oj.qYd=0;oj.uYd=0;oj.IYd=0;Object(h.a)(oj,"CurrentShapeSelectionStore",null,[]);class zi{constructor(ma){this.B4e=new Map;this.isInitialized=
!1;this.aP=ma}initialize(){this.isInitialized||(this.aP.execute(ma=>{ma.kQ(Xf.RewriteAnswer.getTypeName());ma.B6(Xf.RewriteAnswer.getTypeName(),this.GIj.bind(this))}),this.isInitialized=!0)}LUc(ma,ib,yb,ac){return Object(Fa.a)(this,void 0,void 0,function*(){this.initialize();return yield this.ncj(ma,ib,ac,this.otj(yb))})}otj(ma){return{concise:this.Bgj(ma),bullet:{}}}Bgj(ma){return{makeBullet:ma}}ncj(ma,ib,yb,ac){return Object(Fa.a)(this,void 0,void 0,function*(){const Qc=be.a.create().toString(),
me=this.sMi(Qc,ma,ib,yb,ac,oj.Qhj(yb));this.aP.execute(sf=>{sf.submitOperation(me.operation)});const Ge=new oi;this.B4e.set(Qc,Ge);return Ge.completion})}sMi(ma,ib,yb,ac,Qc,me){ib=new Xf.RewriteSignal({input:ib,modelType:yb,requestedSuggestionTypes:ac,modelParams:Qc,regenSequence:me});ma=new Rm.a({parentPath:[kg.a.getTypeName(),Ka.a.getTypeNameFor(ib)],items:[{id:ma,body:ib}]});return Object.assign(new Ma.a,{operation:ma})}ayk(ma){return{rewriteSuggestions:ma.suggestions.map(ib=>({text:ib.content,
type:ib.type})),statusCode:ma.status}}GIj(ma){if(ma){var ib=this.Pvj(ma.parentPath),yb=this.B4e.get(ib);yb&&(this.B4e.delete(ib),yb.resolve(this.ayk(ma)))}}Pvj(ma){return ma[2]}}Object(h.a)(zi,"RewriteSuggestionGenerator",null,[1161]);var sh=d(389),Ij=d(975),Uh=d.n(Ij);class mf{constructor(ma){this.Efc=ma}cPb(ma,ib,yb){const ac=this.eqj(ib,ma);this.showDialog(ac,ma,ib,yb)}showDialog(ma,ib,yb,ac){function Qc(Ge){wc.a.J(508847713,811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",
Ge,yb,ib);ac&&ac(Ge,yb)}const me=this.Gr;Oh.UISurfaces.Zce().then(Ge=>{Ge.initializeFeedbackModal(ma,Qc,me)})}Gr(ma){wc.a.J(508847712,811,10,"Error in submitting feedback: "+ma)}eqj(ma,ib=!1){var yb={};r.AFrameworkApplication.fa.nJc(yb);yb=this.Efc.getContext(yb)||{};yb.uiType="Modal";yb.screenshot=!0;yb.showEmailAddress=!0;ib?yb.initialFeedbackType="Smile":(yb.scenarioConfig={isScenarioEnabled:!0,scenarioType:"ResponsibleAI"},yb.initialFeedbackType="Frown");ib=yb.telemetryGroup||{};ib.processSessionId=
yb.sessionId;ib.officeBuild=yb.build;ib.featureArea=ma;yb.telemetryGroup=ib;return yb}}Object(h.a)(mf,"RewriteFeedback",null,[]);class Ql{constructor(ma,ib,yb,ac,Qc,me,Ge,sf,uf){this.Xma=this.Rhc=!0;this.onShapeSelected=()=>{oj.amg();this.Rhc||this.Rzb();this.Xma||this.Uzb();this.NH.RFa&&this.WEh()};this.A_a=()=>{oj.amg();this.Rhc||this.Rzb();this.Xma||this.qWf()};this.Huh=(xf,dg)=>{dg.w4e&&this.NH.RFa?this.WEh():dg.w4e||this.Rzb()};this.onResize=()=>Object(Fa.a)(this,void 0,void 0,function*(){this.Rhc||
this.Rzb()});this.CD=(xf,dg)=>{if(dg&&dg.bF&&this.NH.RFa)if(this.NH.f_j(dg.jl))this.onShapeSelected(xf,dg);else this.A_a(xf,dg)};this.Guh=()=>Object(Fa.a)(this,void 0,void 0,function*(){this.Rzb();this.aFh();var xf=yield this.rcj();yield this.Uzb();if(this.NH.RFa){var dg=null===xf||void 0===xf?void 0:xf.statusCode;xf=this.Q4i(xf);Xf.RewriteCompletionStatus.Success===dg&&0<(null===xf||void 0===xf?void 0:xf.length)?yield this.sFh(xf,void 0):(wc.a.J(508866837,816,10,"No suggestions returned for selected shape with status code: ${statusCode}"),
yield this.kvd(dg))}});this.onLikeSuggestionClicked=xf=>{if(this.e_g)try{this.e_g.cPb(xf,"Copilot Rewrite",null)}catch(dg){wc.a.J(508851866,811,10,"Copilot Rewrite: Feedback dialog failed to open with error={0}; isLikeDialog={1}",dg.toString(),xf)}else wc.a.J(508851867,811,10,"Copilot Chat: ActionAIFeedback is received as null")};this.xEf=xf=>Object(Fa.a)(this,void 0,void 0,function*(){this.Xma||(yield this.qWf());var dg=xf.suggestionText;dg.startsWith('"')&&(dg=dg.replace(/(^")|("$)/g,""));dg=Uh.a.sanitize(dg);
if(Ya.a("EnableReplaceTextJsonCmd")){var df=this.jb.Ll();df?(dg={id:df.get_sid(),type:1,cId:df.get_cid(),shapeId:df.get_shapeId(),text:dg,textFormat:1},Ya.a("RewriteUseUpdatedApplyJOfcCommands")?JSON.parse(yield this.uU.applyJOfcCommands(JSON.stringify([{data:dg,name:"ReplaceTextCmd"}]),"","RewriteActor")).FSuccess||(wc.a.J(508834818,816,10,"Rewrite:: JOFC command execution failed"),yield this.kvd(Xf.RewriteCompletionStatus.Unknown)):(yield this.uU.D_f(JSON.stringify(dg),"ReplaceTextCmd"))||(wc.a.J(508846175,
816,10,"Rewrite:: JOFC command execution failed"),yield this.kvd(Xf.RewriteCompletionStatus.Unknown))):wc.a.J(508846176,816,10,"Selected Shape Not Found")}else df=new sh.a,df.Wlb=!0,df.zV=dg,this.ia.Ja(kc.a.Doa,2,df)});this.O6k=xf=>Object(Fa.a)(this,void 0,void 0,function*(){this.Rzb();this.aFh();var dg=yield this.N6k(xf);yield this.Uzb();if(this.NH.RFa){dg=null===dg||void 0===dg?void 0:dg.statusCode;var df=oj.Shj();Xf.RewriteCompletionStatus.Success===dg&&0<(null===df||void 0===df?void 0:df.length)?
yield this.sFh(df,xf):(wc.a.J(508866836,816,10,"No suggestions returned for selected type: ${currentTypeSelection} with status code: ${statusCode}"),yield this.kvd(dg))}});this.shl=()=>Object(Fa.a)(this,void 0,void 0,function*(){this.Guh()});if(!ma)throw Error.argumentNull("actionManager");if(!ib)throw Error.argumentNull("graphOperationEventSource");if(!yb)throw Error.argumentNull("viewElementEventSource");if(!ac)throw Error.argumentNull("rewriteSelectionManager");if(!Qc)throw Error.argumentNull("rewriteSuggestionGenerator");
if(!me)throw Error.argumentNull("pptSelectionManager");if(!Ge)throw Error.argumentNull("viewEventNotifier");if(!sf)throw Error.argumentNull("customerFeedbackUiWrapper");if(!uf)throw Error.argumentNull("copilotProxy");this.Sp=ib;this.Yv=yb;this.NH=ac;this.f_g=Qc;this.ia=ma;this.jb=me;this.$d=Ge;this.e_g=new mf(sf);this.wIg=this.DSj();this.Zec=this.CSj();this.uU=uf}vb(){this.Sp.OUd(this.onShapeSelected);this.Sp.EBf(this.A_a);this.Yv.$sb(this.A_a);this.jb.FC(this.CD);this.$d.Gli(this.Huh);r.AFrameworkApplication.Aa.q8(this.onResize)}dispose(){this.Sp.uXe(this.onShapeSelected);
this.Sp.Prh(this.A_a);this.Yv.Nrc(this.A_a);this.jb.Cga(this.CD);this.$d.Wcl(this.Huh)}me(){}DSj(){const ma=document.createElement("div");ma.id="RewriteIndicatorId";document.body.appendChild(ma);return ma}CSj(){const ma=document.createElement("div");ma.id="RewriteCardId";document.body.appendChild(ma);return ma}WEh(){Object(Fa.a)(this,void 0,void 0,function*(){const ma={onRewriteIndicatorClick:this.Guh,getTargetRect:this.NH.RPc,isIndicatorHidden:!1,targetPlaceholderType:this.NH.qSa};yield(yield Oh.UISurfaces.V$a()).renderContextualCard("RewriteIndicator",
this.wIg,ma);this.Rhc=!1})}Rzb(){Object(Fa.a)(this,void 0,void 0,function*(){const ma={getTargetRect:this.NH.RPc,isIndicatorHidden:!0};yield(yield Oh.UISurfaces.V$a()).renderContextualCard("RewriteIndicator",this.wIg,ma);this.Rhc=!0})}sFh(ma,ib){return Object(Fa.a)(this,void 0,void 0,function*(){this.Xma||(yield this.Uzb());if(this.NH.RFa){var yb={getTargetRect:this.NH.tYc(),placeholderOverflow:this.NH.BXc(),rewriteCardState:1,isCardHidden:!1,rewriteSuggestions:void 0,suggestionCount:0,targetPlaceholderType:this.NH.qSa,
currentRegeneratedSuggestionType:ib,onReplaceSuggestionClicked:this.xEf,onRegenerateSuggestionsClicked:this.O6k,onLikeSuggestionClicked:this.onLikeSuggestionClicked};ma&&0<ma.length&&(yb.rewriteSuggestions=ma,yb.suggestionCount=ma.length);yield(yield Oh.UISurfaces.V$a()).renderContextualCard("RewriteContextualCard",this.Zec,yb);this.Xma=!1}})}kvd(ma){return Object(Fa.a)(this,void 0,void 0,function*(){this.Xma||(yield this.Uzb());const ib={placeholderOverflow:this.NH.BXc(),targetPlaceholderType:this.NH.qSa,
getTargetRect:this.NH.tYc(),rewriteCardState:2,isCardHidden:!1,rewriteErrorState:this.rLi(ma),onRetryButtonClicked:this.shl};yield(yield Oh.UISurfaces.V$a()).renderContextualCard("RewriteContextualCard",this.Zec,ib);this.Xma=!1})}aFh(){Object(Fa.a)(this,void 0,void 0,function*(){this.Xma||(yield this.Uzb());const ma={placeholderOverflow:this.NH.BXc(),getTargetRect:this.NH.tYc(),targetPlaceholderType:this.NH.qSa,rewriteCardState:0,isCardHidden:!1};yield(yield Oh.UISurfaces.V$a()).renderContextualCard("RewriteContextualCard",
this.Zec,ma);this.Xma=!1})}Uzb(){return Object(Fa.a)(this,void 0,void 0,function*(){const ma={getTargetRect:this.NH.tYc(),isCardHidden:!0};yield(yield Oh.UISurfaces.V$a()).renderContextualCard("RewriteContextualCard",this.Zec,ma);this.Xma=!0})}qWf(){return Object(Fa.a)(this,void 0,void 0,function*(){yield(yield Oh.UISurfaces.V$a()).dispose(this.Zec);this.Xma=!0})}rcj(){return Object(Fa.a)(this,void 0,void 0,function*(){var ma=this.NH.t3d();if(null!==ma&&void 0!==ma&&ma.Zvb){var ib=-1!=ma.LRc.indexOf(Xf.RewriteSuggestionType.Bullet);
ma=yield this.f_g.LUc(ma.Zvb,ma.inputType,ib,ma.LRc);oj.NPh(ma);return ma}wc.a.J(508870787,816,50,"Ineligible shape selection for ALRewrite")})}N6k(ma){return Object(Fa.a)(this,void 0,void 0,function*(){var ib=this.NH.t3d();const yb=0==ma,ac=this.Hcj(ma);if(!(0>=ac.length))return oj.uPj(ac[0]),ib=yield this.f_g.LUc(ib.Zvb,ib.inputType,yb,ac),oj.NPh(ib),ib})}Hcj(ma){switch(ma){case 0:return[Xf.RewriteSuggestionType.Bullet];case 1:return[Xf.RewriteSuggestionType.Concise];case 2:return[Xf.RewriteSuggestionType.Paraphrase];
default:return[]}}Q4i(ma){var ib;const yb=[];null===(ib=null===ma||void 0===ma?void 0:ma.rewriteSuggestions)||void 0===ib?void 0:ib.filter(ac=>!!ac.text).forEach(ac=>{yb.push({suggestionText:ac.text,suggestionType:ac.type})});return yb}rLi(ma){switch(ma){case Xf.RewriteCompletionStatus.OffensiveContentInput:case Xf.RewriteCompletionStatus.OffensiveContentOutput:return 0;case Xf.RewriteCompletionStatus.UnsupportedLanguage:return 2;default:return 1}}}Object(h.a)(Ql,"RewriteActor",null,[268]);class Fk{constructor(){this.Dbd=
24}DCi(ma,ib){let yb={isPlaceholderOverflowing:!1,overflowDirection:void 0};ma&&ib&&(ma.y+ma.height>=ib.height+ib.y&&(yb.isPlaceholderOverflowing=!0,yb.overflowDirection=0),ma.x<ib.x&&(yb.isPlaceholderOverflowing=!0,yb.overflowDirection=1),ma.y+ma.height>=ib.height+ib.y&&ma.x<ib.x&&(yb.overflowDirection=2));return yb}ykj(ma,ib,yb){const ac=new Sys.UI.Bounds(0,0,0,0);if(ma.isPlaceholderOverflowing){switch(ma.overflowDirection){case 0:ac.x=yb.x;ac.width=yb.width;ac.y=ib.y;ac.height=ib.height;break;
case 1:ac.x=ib.x+this.Dbd;ac.width=ib.width-this.Dbd;ac.y=yb.y;ac.height=yb.height;break;case 2:ac.x=ib.x+this.Dbd,ac.width=ib.width-this.Dbd,ac.y=ib.y,ac.height=ib.height}return ac}return yb}}Object(h.a)(Fk,"ShapeTargetBounds",null,[1159]);class dj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.CopilotRewrite"}Xb(ma){if(ma){this.K=ma;var ib=this.K.resolve("PowerPointWebEditor.IApplicationSettings");ib.VXf&&this.K.register(Hj,"PowerPointWebEditor.CopilotRewrite.EditorPaneActor").na().oa(()=>
new Hj(this.K.resolve("Common.IActionManagerExtended")));this.roe(this.K)&&(this.K.register($l,"PowerPointWebEditor.CopilotRewrite.RewriteSelectionManager").as("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager").na().oa(()=>new $l(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
ib.xAk,this.K.resolve("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds"))),this.K.register(Fk,"PowerPointWebEditor.CopilotRewrite.ShapeTargetBounds").as("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds").na().oa(()=>new Fk),this.K.register(zi,"PowerPointWebEditor.CopilotRewrite.RewriteSuggestionGenerator").as("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator").na().oa(()=>new zi(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"))),this.K.register(Ql,
"PowerPointWebEditor.CopilotRewrite.RewriteActor").na().oa(()=>new Ql(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager"),this.K.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.K.resolve("PowerPointWebEditor.ICopilotProxy"))))}else wc.a.J(508883090,822,10,"PptWebEditorRewritePackage::Container object not available")}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").$e(()=>{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").VXf){var ma=this.K.resolve("PowerPointWebEditor.CopilotRewrite.EditorPaneActor");ma.vb();ma.me()}this.roe(this.K)&&(ma=this.K.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor"),
ma.vb(),ma.me())})}dispose(){this.K.resolve("Common.IAppSettingsManager").$e(()=>{this.roe(this.K)&&this.K.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor").dispose()})}roe(ma){ma=ma.resolve("PowerPointWebEditor.IApplicationSettings");return!(r.AFrameworkApplication.XE||r.AFrameworkApplication.Vx)&&(ma.fZe||ma.ka("RewriteFeatureLicenseCheckEnabled")&&r.AFrameworkApplication.BOc)}static main(){n.a.instance.Ac(new dj)}}Object(h.a)(dj,"PptWebEditorRewritePackage",null,[2,3]);var yj=d(13);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");Type.registerNamespace("PowerPointWebEditor.Proofing");
Type.registerNamespace("PowerPointWebEditor.EditorPaneV2");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Object(yj.c)("AugLoop");Vf.main();zd.main();Sg.main();nj.main();dj.main();Object(yj.b)("AugLoop")},552:function(K,S,d){var h=this&&this.Dcf||(Object.create?function(r,m,n,z){void 0===z&&(z=n);var t=Object.getOwnPropertyDescriptor(m,n);if(!t||("get"in t?!m.Pba:t.writable||t.configurable))t={enumerable:!0,get:function(){return m[n]}};Object.defineProperty(r,z,t)}:function(r,m,n,z){void 0===
z&&(z=n);r[z]=m[n]}),e=this&&this.__exportStar||function(r,m){for(var n in r)"default"===n||Object.prototype.hasOwnProperty.call(m,n)||h(m,r,n)};Object.defineProperty(S,"__esModule",{value:!0});e(d(1185),S);e(d(1186),S);e(d(1187),S);e(d(1188),S)},702:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(18),e=d(99),r=d(29),m=d(50);d(98);class n{constructor(){this.d0=null}get Wzb(){return!1}qMh(z,t){let x=new h.a;const B=new m.GraphTransaction(3);try{B.ld(r.App.Mb.Ld.Rn.Ag),this.kdc(t)&&(x=
this.Kac(t,x)),t!==z&&this.kdc(z)&&(x=this.Kac(z,x))}finally{B&&B.dispose()}return x.toArray()}kdc(z){return!!z}Spd(z){let t=!1;for(const x of this.bie)t||!Sys.UI.DomElement.containsCssClass(z,x.className)&&!Sys.UI.DomElement.containsCssClass(z,x.J9b)||(t=!0),e.a.gLa(z,x.className),e.a.gLa(z,x.J9b)}}Object(K.a)(n,"AHighlightActor",null,[1008])},703:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r){this.className=e;this.J9b=r}}Object(K.a)(h,"HighlightCssClassPair",null,
[])},704:function(K,S,d){d.d(S,"b",function(){return m});d.d(S,"a",function(){return n});var h=d(99);d(29);var e=d(50);d(34);d(95);var r=d(98);const m=z=>{const t=new e.GraphTransaction(3);try{t.ld(z),z.Kv(32,!0)}finally{t&&t.dispose()}},n=z=>{if(z){z=h.a.Lka(z);if(-1===z.indexOf(r.a.H8)&&-1!==z.indexOf(r.a.JN)&&-1===z.indexOf(r.a.d4b))return 2;if(-1===z.indexOf(r.a.H8)&&(-1!==z.indexOf(r.a.c4b)||-1!==z.indexOf(r.a.$N)||-1!==z.indexOf(r.a.d4b)||-1!==z.indexOf(r.a.XNc)||-1!==z.indexOf(r.a.MPc)||-1!==
z.indexOf(r.a.KPc)||-1!==z.indexOf(r.a.JPc)||-1!==z.indexOf(r.a.h3d)||-1!==z.indexOf(r.a.c3d)||-1!==z.indexOf(r.a.e3d)||-1!==z.indexOf(r.a.LPc)||-1!==z.indexOf(r.a.b3d)))return 1;if(-1!==z.indexOf("WACImageContainer"))return 3}return 0}},705:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.type=this.action=0;this.xjb=this.kea=null}}Object(K.a)(h,"HighlightOperation",null,[])},709:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(18);class e{static lph(r){e.F$b.add(r)}static Sxh(r){for(let m of e.F$b)m(r)}static uph(r){e.Ykb.add(r);
if(0<e.WKa.count){for(let m of e.WKa)r(m);e.WKa=new h.a}}static $xh(r){if(0<e.Ykb.count)for(let m of e.Ykb)m(r);else e.WKa.add(r)}}e.WKa=new h.a;e.Ykb=new h.a;e.F$b=new h.a;Object(K.a)(e,"AugLoopEventUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.augloop.js.map