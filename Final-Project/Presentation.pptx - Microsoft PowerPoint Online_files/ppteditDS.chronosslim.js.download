/*
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource>  The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1E3:function(K){var S=function(){return this}();try{S=S||(new Function("return this"))()}catch(d){"object"===typeof window&&(S=window)}K.exports=S},1001:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.message=this.title=null;this.ajg=!1;this.TKb=null;this.fjg=!1;this.asd=null;this.Kkl=this.OXk=0;this.Lkl=this.PXk=null;this.timeoutInSeconds=0;this.UKj=!1;this.CNj=null}}Object(K.a)(h,
"CalloutNotificationMessageAttributes",null,[])},1002:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.handler=null}}Object(K.a)(h,"SetAnnotationResultCallbackParameters",null,[])},1081:function(K,S,d){K=d(0);class h{constructor(r,m,n){this.iTc=r;this.OOh=m;this.lbf=n}}Object(K.a)(h,"ThemeData",null,[]);d.d(S,"a",function(){return e});class e{}e.Dza=[new h("2e142a2c-cd16-42d6-873a-c26d2a0506fa","OfficeTheme2023",4),new h("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",
4),new h("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new h("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new h("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new h("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new h("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new h("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new h("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new h("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new h("98dff888-2449-4d28-977c-6306c017633e",
"Banded",4),new h("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new h("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new h("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new h("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new h("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new h("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new h("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new h("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new h("4c5440d6-04d2-4954-96cf-f251137069b2",
"Metropolitan",8),new h("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new h("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new h("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new h("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(K.a)(e,"DesignManager_data",null,[])},1173:function(K,S,d){(function(h){d.d(S,"a",function(){return D});var e=d(134),r=d(0),m=d(30),n=d(40),z=d(28),t=d(1289),x=d(1290),B=d(33);class D{constructor(w,J,F,L,M,Q,C,O,U,T,ca){this.R5=this.xu=null;this.$pd=
(N,da,Y,fa,aa)=>{this.actionId=N;this.xu=this.pa.Ll();return this.ECh(!0)?1===Y?32:aa?2===Y&&(this.Dec.jlb(!0,!1),N={},z.a.J(508908313,t.a.msoulscat_Wac_PptView,x.a.info,"PictureBackgroundActor::removePictureBackground triggered."),this.v1i(N),this.cFj(this.xu,N))?32:16:16:8};this.Xqd=(N,da,Y,fa,aa)=>{let ka=this.pa.Ll();if(!this.ECh(!1))return 8;if(1===Y)return 32;if(!aa)return 16;this.Dec.jlb(!0,!1);this.R5=this.ua.Ba;da=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.Rq.oA=
ka;this.pa.selectShape(ka,!0)});try{this.xu=ka,da.jc(this.R5),da.gd=N,this.xu.Pcb=!1}finally{da&&da.dispose(),this.Dec.jlb(!1,!1)}return 32};if(!w)throw Error.argumentNull("actionManager");if(!J)throw Error.argumentNull("appOfflineSetter");if(!F)throw Error.argumentNull("selectionManager");if(!L)throw Error.argumentNull("imageManager");this.ia=w;this.Dec=J;this.pa=F;this.NB=L;this.Eb=M;this.ua=Q;this.Fb=O;this.Fa=C;this.Rq=U;this.FOj=T;this.CH=ca}vb(){this.ia.ra(m.a.$pd,n.a.application,this.$pd,4);
this.ia.ra(m.a.Xqd,n.a.application,this.Xqd,4)}me(){}cFj(w,J){return(w=this.rk(w))&&w.Dk&&(w=w.Dk)?w.Poc("RemoveBackgroundAction",J):!1}rk(w){return w?w.qc(this.Eb.Na):null}v1i(w){w.type="RemoveBackgroundPayload";w.useMask=!0;w.downsample=!0;var J=this.t1f(this.ua.Ba,this.xu,13,-1),F=500,L=500;J&&J.Base64Data&&(L=this.t1f(this.ua.Ba,this.xu,1,this.xu.Uf),F=new URL(J.Base64Data),w.originalUrl=F,F=L?L.Height:J.Height,L=L?L.Width:J.Width);J={};F=new URL(`data:image/svg+xml;base64, ${h.from(this.rrj(F,
L)).toString("base64")}`,window.location.origin);J.url=F;J.renderAsSvg=!0;J.overlay=!0;J.cropToGeometry=!0;w.placeholder=J;w.resultHandler=this.gYk.bind(this);w.updatePicture=!1}rrj(w,J){w=this.kRk(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" style="width:100%;" viewBox="0 0 ${J} ${w}">
    <defs>
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_1_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
       values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_0_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
      values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animate attributeType="XML" attributeName="opacity" dur="1s" from="0" to="1" xlink:href="#time_group" />
    </defs>
    <g id="_R_G">
      <rect width="100%" height="100%" fill="rgba(179,179,179,0.5)" filter='blur(12px)' />
      <g id="_R_G_L_1_G" transform=" translate(${J/2}, ${w/2})
     translate(0, 0)" />
      <g id="_R_G_L_0_G" transform=" translate(${J/2}, ${w/2})
     translate(-14, -14)">
        <g id="_R_G_L_0_G_L_1_G_N_2_T_0" transform=" translate(14, 14) scale(2, 2)">
          <g id="_R_G_L_0_G_L_1_G">
            <path id="_R_G_L_0_G_L_1_G_D_0_P_0" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="3" stroke-opacity="1"
             d=" M0 -12 C6.62,-12 12,-6.62 12,0 C12,6.62 6.62,12 0,12 C-6.62,
             12 -12,6.62 -12,0 C-12,-6.62 -6.62,-12 0,-12z " />
          </g>
        </g>
        <g id="_R_G_L_0_G_L_0_G_N_2_T_0" transform=" translate(14, 14)">
          <g id="_R_G_L_0_G_L_0_G" transform=" rotate(3.724)
      scale(0.2, 0.2)">
            <path id="_R_G_L_0_G_L_0_G_D_0_P_0" fill="#C43E1C" fill-opacity="1" fill-rule="nonzero"
            d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,-127.25 -55.5,-123 C-63.75,-118.75 -71.87,
            -114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,-100.25 -99,-92.5 C-105.62,-84.75 -110.5,
            -79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,-46.75 C-129.5,-39.87 -133.14,
            -27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,8.38 -134.87,12 -134.5,
            16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
            17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,
            -20.37 C-102.12,-26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,
            -55 C-86.12,-60.62 -83.12,-64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,
            -83.37 C-59.25,-86.62 -51.25,-91.87 -46,-94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,
            -99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
            <path id="_R_G_L_0_G_L_0_G_D_1_P_0" stroke="#C43E1C" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="1" stroke-opacity="1" d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,
             -127.25 -55.5,-123 C-63.75,-118.75 -71.87,-114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,
             -100.25 -99,-92.5 C-105.62,-84.75 -110.5,-79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,
             -46.75 C-129.5,-39.87 -133.14,-27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,
             8.38 -134.87,12 -134.5,16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
             17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,-20.37 C-102.12,
             -26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,-55 C-86.12,-60.62 -83.12,
             -64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,-83.37 C-59.25,-86.62 -51.25,-91.87 -46,
             -94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,-99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
          </g>
        </g>
      </g>
    </g>
    <g id="time_group" />
  </svg>`);return this.Yml(w)}kRk(w){w=(new DOMParser).parseFromString(w,"image/svg+xml");if(0!==w.querySelectorAll("parsererror").length)throw Error("The XML could not be read");return w.firstElementChild}Yml(w){return(new XMLSerializer).serializeToString(w)}gYk(w){return Object(e.a)(this,void 0,void 0,function*(){w.succeeded?(z.a.J(508921416,t.a.msoulscat_Wac_PptView,x.a.info,"PictureBackgroundActor::processBackgroundRemovalResults Success. Status: '{0}'",w.succeeded),this.Lri=w.result.picture.url,
yield this.eKj(this.actionId,this.Lri)):(this.Dec.jlb(!1,!1),this.nAl(),z.a.J(508921415,t.a.msoulscat_Wac_PptView,x.a.error,"PictureBackgroundActor::processBackgroundRemovalResults Failed. Status: '{0}'",w?w.message:"unknown"))})}eKj(w,J){return Object(e.a)(this,void 0,void 0,function*(){this.R5=this.ua.Ba;const F=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.Rq.oA=this.xu;this.pa.selectShape(this.xu,!0)});try{F.jc(this.R5),F.gd=w,B.a("PPTOImgSrcBgrAttr")?this.xu.nea=
J.href:this.xu.$$b=J.href,this.xu.Pcb=!0}finally{F&&F.dispose(),this.Dec.jlb(!1,!1)}})}ECh(w){var J,F,L;const M=this.pa.Ud();return M?1==M.length&&(null===(J=M[0])||void 0===J?void 0:J.tj)&&(null===(F=M[0])||void 0===F?void 0:F.xqe)&&(null===(L=M[0])||void 0===L?void 0:L.Pcb)!==w:!1}t1f(w,J,F,L){let M=w?w.Cb:null;J=J.get_shapeId();w=this.FOj.$Xc(M,J,F,w.Xp,w.Xk,L);z.a.J(508908312,t.a.msoulscat_Wac_PptView,x.a.info,"PictureBackgroundActor::fetchImageData fetching image data.");({data:w}=this.NB.W$b.usc(w));
if(w)return w;z.a.J(508923986,t.a.msoulscat_Wac_PptView,x.a.error,"PictureBackgroundActor::fetchImageData image data cannot be fetched for image id")}nAl(){this.CH.kba(ResourceStrings.l_UnexpectedBEHTitle,ResourceStrings.l_GenericErrorMessage,!1,null,!1,null,0,0,null,null,!0,D.ZLc,!1,null)}}D.ZLc=20;Object(r.a)(D,"PictureBackgroundActor",null,[268])}).call(this,d(706).bBd)},1174:function(K,S){function d(m){var n=m.length;if(0<n%4)throw Error("Invalid string. Length must be a multiple of 4");m=m.indexOf("=");
-1===m&&(m=n);return[m,m===n?0:4-m%4]}S.byteLength=function(m){m=d(m);var n=m[1];return 3*(m[0]+n)/4-n};S.dLl=function(m){var n=d(m);var z=n[0];n=n[1];var t=new r(3*(z+n)/4-n),x=0,B=0<n?z-4:z,D;for(D=0;D<B;D+=4)z=e[m.charCodeAt(D)]<<18|e[m.charCodeAt(D+1)]<<12|e[m.charCodeAt(D+2)]<<6|e[m.charCodeAt(D+3)],t[x++]=z>>16&255,t[x++]=z>>8&255,t[x++]=z&255;2===n&&(z=e[m.charCodeAt(D)]<<2|e[m.charCodeAt(D+1)]>>4,t[x++]=z&255);1===n&&(z=e[m.charCodeAt(D)]<<10|e[m.charCodeAt(D+1)]<<4|e[m.charCodeAt(D+2)]>>
2,t[x++]=z>>8&255,t[x++]=z&255);return t};S.y4f=function(m){for(var n=m.length,z=n%3,t=[],x=0,B=n-z;x<B;x+=16383){for(var D=t,w=D.push,J,F=m,L=x+16383>B?B:x+16383,M=[],Q=x;Q<L;Q+=3)J=(F[Q]<<16&16711680)+(F[Q+1]<<8&65280)+(F[Q+2]&255),M.push(h[J>>18&63]+h[J>>12&63]+h[J>>6&63]+h[J&63]);J=M.join("");w.call(D,J)}1===z?(m=m[n-1],t.push(h[m>>2]+h[m<<4&63]+"==")):2===z&&(m=(m[n-2]<<8)+m[n-1],t.push(h[m>>10]+h[m>>4&63]+h[m<<2&63]+"="));return t.join("")};var h=[],e=[],r="undefined"!==typeof Uint8Array?Uint8Array:
Array;for(K=0;64>K;++K)h[K]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[K],e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(K)]=K;e[45]=62;e[95]=63},1175:function(K,S){S.read=function(d,h,e,r,m){var n=8*m-r-1;var z=(1<<n)-1,t=z>>1,x=-7;m=e?m-1:0;var B=e?-1:1,D=d[h+m];m+=B;e=D&(1<<-x)-1;D>>=-x;for(x+=n;0<x;e=256*e+d[h+m],m+=B,x-=8);n=e&(1<<-x)-1;e>>=-x;for(x+=r;0<x;n=256*n+d[h+m],m+=B,x-=8);if(0===e)e=1-t;else{if(e===z)return n?NaN:Infinity*(D?
-1:1);n+=Math.pow(2,r);e-=t}return(D?-1:1)*n*Math.pow(2,e-r)};S.write=function(d,h,e,r,m,n){var z,t=8*n-m-1,x=(1<<t)-1,B=x>>1,D=23===m?Math.pow(2,-24)-Math.pow(2,-77):0;n=r?0:n-1;var w=r?1:-1,J=0>h||0===h&&0>1/h?1:0;h=Math.abs(h);isNaN(h)||Infinity===h?(h=isNaN(h)?1:0,r=x):(r=Math.floor(Math.log(h)/Math.LN2),1>h*(z=Math.pow(2,-r))&&(r--,z*=2),h=1<=r+B?h+D/z:h+D*Math.pow(2,1-B),2<=h*z&&(r++,z/=2),r+B>=x?(h=0,r=x):1<=r+B?(h=(h*z-1)*Math.pow(2,m),r+=B):(h=h*Math.pow(2,B-1)*Math.pow(2,m),r=0));for(;8<=
m;d[e+n]=h&255,n+=w,h/=256,m-=8);r=r<<m|h;for(t+=m;0<t;d[e+n]=r&255,n+=w,r/=256,t-=8);d[e+n-w]|=128*J}},1176:function(K){var S={}.toString;K.exports=Array.isArray||function(d){return"[object Array]"==S.call(d)}},1194:function(K,S,d){K=d(0);var h=d(7),e=d(1253),r=d(303),m=d(304),n=d(67),z=d(99);class t extends r.a{constructor(C,O){super(C);this.Dh=null;this.Cca=O.get(8,!1);this.Tha=O.get(6,0);this.element=C;this.element.className=t.b7b;this.Z6a=this.createElement("ul");this.element.appendChild(this.Z6a);
this.yq=O.get(10);this.yq.ub(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.bA=O.get(9);this.bA.ub(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut"));this.bA.ub(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"));this.RZ=O.get(13);this.RZ.ub(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"))}o8(C){this.addHandler(m.a.Cw,C)}Woa(C){this.removeHandler(m.a.Cw,C)}get Hba(){return this.Dh}dispose(){this.element&&
(this.yq.Bb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.bA.Bb(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.bA.Bb(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut")),this.RZ.Bb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(C,O,U){this.hide();!C||0>=C.length||(this.Cca?this.element.style.right=O+"px":this.element.style.left=
O+"px",this.element.style.top=U+"px",this.eUd(C),this.visible=!0)}eUd(C){this.Dh=C;z.a.yv(this.Z6a);for(let O=C.length-1;0<=O;O--)this.pB(C[O])}pB(C){const O=document.createElement("li");O.style.backgroundColor=C.color;O.style.height=this.Tha+"px";O.id="fly_"+C.clientId;O.style.lineHeight=this.Tha+"px";z.a.Rz(O,C.userName);O.setAttribute("dir","auto");this.Z6a.appendChild(O)}onClick(){this.hide();return!1}sG(C){this.raiseEvent(m.a.Cw,new m.a(3,C));return!1}}t.b7b="prFlyout UIFont";Object(K.a)(t,"PresenceTooltipFlyoutControl",
r.a,[]);var x=d(79);class B extends r.a{constructor(C,O,U){super(C);this.$Z=null;this.Dh=[];this.element.className="prGlyph";this.Yc=O;this.Y7=this.Yc.get(9);this.Ln=this.Yc.get(10);this.RZ=this.Yc.get(13);this.cie();this.pB(U);this.c5a=!1}get lP(){return this.Dh.length}get Hba(){return this.Dh}o8(C){this.addHandler(m.a.Cw,C)}Woa(C){this.removeHandler(m.a.Cw,C)}dispose(){this.r$e();super.dispose()}pB(C){Array.add(this.Dh,C);2===this.lP?this.Eba(!0):1===this.lP?this.Eba(!1):this.Eba(this.c5a)}uP(C){this.K8d(C)&&
(1<this.lP&&this.Eba(!0),1===this.lP?this.Eba(!1):1>this.lP&&this.hide())}show(){this.Eba(2<=this.lP);this.visible=!0}hide(){this.visible=!1}Vbe(C){return C?this.M7b(0,5):this.M7b(1,4)}K8d(C){for(let O=0;O<this.lP;O++)if(this.Dh[O].clientId===C)return C=this.Dh[O],Array.removeAt(this.Dh,O),C;return null}Eba(C){this.c5a!==C&&(this.$Z&&this.element.removeChild(this.$Z),this.$Z=this.Vbe(C),this.element.appendChild(this.$Z),this.c5a=C);this.$Z.childNodes[0].style.backgroundColor=this.Dh[this.Dh.length-
1].color}M7b(C,O){const U=this.Yc.get(6,0),T=this.Yc.get(14);return x.createClusteredImageFromClusterWithImageClass(U,U,this.Yc.get(C),this.Yc.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,T?T.cloneNode(!0):null)}SM(C){3!==C.kg&&this.raiseEvent(m.a.Cw,new m.a(2,C));return!1}onClick(C){this.raiseEvent(m.a.Cw,new m.a(1,C));return!0}sG(C){3!==C.kg&&this.raiseEvent(m.a.Cw,new m.a(3,C));return!1}r$e(){this.element&&(this.Y7.Bb(n.a.pointerDown,this.element,Object(h.a)(this,
this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Y7.Bb(n.a.pointerOver,this.element,Object(h.a)(this,this.SM,"onPointerOver")),this.Y7.Bb(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut")),this.Ln.Bb(n.a.doubleClick,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Ln.Bb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.RZ.Bb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")))}cie(){this.element&&
(this.Y7.ub(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Y7.ub(n.a.pointerOver,this.element,Object(h.a)(this,this.SM,"onPointerOver")),this.Y7.ub(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut")),this.Ln.ub(n.a.doubleClick,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Ln.ub(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.RZ.ub(this.element,Object(h.a)(this,
this.kF,"stopPropagationAndPreventDefaultBehavior")))}}Object(K.a)(B,"PresenceTooltipGlyph",r.a,[]);var D=d(121);d(65);var w=d(199);class J extends r.a{constructor(C,O,U){super(C);this.Dh=[];this.ym=[];this.DI=0;this.Nia=this.G7=!1;this.wSb=null;this.eia={};this.Yc=U;this.nl=U.get(8,!1);this.QG=U.get(11,!1);C=U.get(12,0);this.imageDimension=U.get(6,0);this.Srb=O;this.element.id=J.t7b();this.element.className=r.a.E2d(this.nl);C&&(this.zIndex=C);this.rtl=this.nl;this.ktc(O);this.Xz=this.createElement("div");
this.Xz.className=this.QG?"prContainerV":"prContainerHr";this.element.appendChild(this.Xz);this.OUb=Array(this.DI);for(O=0;O<this.DI;O++)this.ww[O]=new t(this.createElement("div"),this.Yc),this.ww[O].o8(Object(h.a)(this,this.GY,"onInteractivityChanged")),this.element.appendChild(this.ww[O].element)}get PKb(){return w.a.clone(this.Dh)}getGlyph(C){return this.eia[C]}get ww(){return this.OUb}get y_b(){return this.wSb}get qMa(){return this.imageDimension+2}get width(){return this.QG?this.qMa:this.Srb}get height(){return this.QG?
this.Srb:this.qMa}o8(C){this.addHandler(m.a.Cw,C)}Woa(C){this.removeHandler(m.a.Cw,C)}dispose(){if(this.ww)for(const C of this.ww)C.Woa(Object(h.a)(this,this.GY,"onInteractivityChanged")),D.a.Wy(C);D.a.Ord(this.ym);this.ym=this.OUb=null;super.dispose()}hMa(){this.hX();this.bmb();this.visible=!0;this.G7=!1}svd(){!this.ym||1>this.ym.length||(this.hX(),this.visible=!0,this.bmb(),this.yKa(this.ym[this.ym.length-1]),this.G7=!0)}dMa(){if(this.ym&&!(1>this.ym.length)){this.visible=!0;this.bmb();var C=0;
for(const O of this.ym)this.yKa(O,C++);this.G7=!1;this.Nia=!0}}hide(){this.visible=!1;this.hX();for(let C=0;C<this.ym.length;C++)this.ym[C].hide();this.G7=!1}g2b(){if(!this.Nia)return!1;let C=0;for(const O of this.ww)O.visible&&C++;return this.Nia=0<C&&(this.Dh.length<=this.DI?C===this.Dh.length:C===this.DI)}pB(C){if(!(0>=this.DI)){C.clientId||(C.clientId=(J.VOa++).toString());if(C.clientId in this.eia){var O=this.zka(C.clientId);if(0<=O){O=this.Dh[O];if(O.color===C.color&&O.userName===C.userName)return;
this.uP(C.clientId)}}O=this.g2b();var U=0;if(this.Dh.length<this.DI){var T=new B(this.createElement("div"),this.Yc,C);T.o8(Object(h.a)(this,this.GY,"onInteractivityChanged"));this.nl&&!this.QG&&0<this.Dh.length?this.Xz.insertBefore(T.element,this.Xz.firstChild):(this.Xz.appendChild(T.element),U=this.ym.length);Array.add(this.ym,T)}else this.nl&&!this.QG?T=this.ym[0]:(U=this.ym.length-1,T=this.ym[U]),T.pB(C);T.show();this.eia[C.clientId]=T;Array.add(this.Dh,C);this.Axc(T,U);O&&this.dMa()}}uP(C){const O=
this.g2b();O&&this.hX();this.F0a(C);this.Dh.length>=this.DI&&this.ym.length<this.DI&&this.zVe();0>=this.Dh.length?this.hide():O&&this.dMa()}Vhd(){}F0a(C){var O=this.zka(C);0>O||(C=this.Dh[O],Array.removeAt(this.Dh,O),O=this.eia[C.clientId],delete this.eia[C.clientId],O.uP(C.clientId),this.Axc(O),0>=O.lP&&(this.Xz.removeChild(O.element),Array.remove(this.ym,O),O.dispose()))}EOb(){}zVe(){var C=this.ede();!C||1>=C.Hba.length||(C=Array.clone(this.Dh),C.forEach(O=>{this.F0a(O.clientId)}),C.forEach(O=>
{this.pB(O)}))}zka(C){for(let O=0;O<this.Dh.length;O++)if(this.Dh[O].clientId===C)return O;return-1}ede(){return this.nl&&!this.QG?this.ym[0]:this.ym[this.ym.length-1]}position(C,O){this.element.style.top=O+"px";this.element.style.left=C+"px"}bmb(){for(let C=0;C<this.ym.length;C++)this.ym[C].show()}hX(){for(let C=0;C<this.DI;C++)this.ww[C].hide();this.Nia=!1}yKa(C,O=0){if(C)if(this.wSb=C,this.QG){const U=this.imageDimension;if(1<C.Hba.length)this.ww[O].show(C.Hba,U,this.height-this.imageDimension);
else{const T=this.Xz.children.length;for(let ca=0;ca<this.Xz.children.length;ca++)C.element===this.Xz.children[ca]&&this.ww[O].show(C.Hba,U,this.height-(T-ca)*this.qMa+2)}}else this.ww[O].show(C.Hba,this.width,0)}GY(C,O){var U=Object(e.a)(B,C);U=U?this.z6b(U):-1;if(2===O.type||1===O.type&&-1!==U&&!this.ww[U].visible)this.yKa(C);else if(1===O.type)this.hX(),this.G7=!1;else if(3===O.type){if(this.xSc(O.Fj))return;this.G7||this.hX()}this.raiseEvent(m.a.Cw,O)}xSc(C){C=J.E8b(C);let O=!1;for(const U of this.ww)if(z.a.NVa(U.element,
C)){O=!0;break}return this.Xz!==C&&z.a.NVa(this.Xz,C)||O}Axc(C,O=0){const U=this.Ene(C);U&&0>=C.lP?this.ww[O].hide():U?this.yKa(C):this.ww[O].hide()}z6b(C){let O=0;for(const U of this.ym){if(C===U)return O;O++}return-1}Ene(C){const O=this.z6b(C);return!!this.y_b&&C===this.y_b&&-1!==O&&this.ww[O].visible}ktc(C){this.DI=C===this.imageDimension?1:Math.floor(C/this.qMa);this.QG?(this.element.style.height=C+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=C+"px",this.element.style.height=
this.imageDimension+"px")}static t7b(){return String.format("{0}-{1}","presencetooltip",J.VOa++)}static E8b(C){C=C.nc.rawEvent;return C.relatedTarget||C.toElement}}J.VOa=0;Object(K.a)(J,"PresenceTooltipControl",r.a,[623,108]);var F=d(240),L=d(318),M=d(282);d.d(S,"a",function(){return Q});class Q{constructor(C){this.Yc=C;this.Yc.o_(10,F.a.instance);this.Yc.o_(9,M.a.instance);this.Yc.o_(6,16);this.Yc.o_(13,L.a.instance)}U1d(C,O){return new J(C,O,this.Yc)}C3b(C){return new J(C,16,this.Yc)}}Object(K.a)(Q,
"PresenceTooltipFactory",null,[602])},1209:function(K,S,d){K=d(0);class h{}h.taskPaneWidth=330;Object(K.a)(h,"AppsForOfficeConstants",null,[]);d.d(S,"a",function(){return e});class e{constructor(){this.Oja=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.I4b=this.dialogTop=this.K4b=this.dialogLeft=null;this.taskPaneWidth=h.taskPaneWidth;this.cB=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onExtensionLaunchCallback=this.onTaskPaneClose=
null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.LQc=this.HQc=!0}}Object(K.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1291:function(K,S,d){d.d(S,"a",function(){return z});K=d(0);var h=d(80),e=d(120),r=d(27),m=d(96),n=d(223);class z extends h.a{constructor(t,x=!1){super(t,!1,x)}get wBb(){return!1}get CL(){return n.a.J4b+"/modeless"}get GCb(){return null}set GCb(t){}get CCb(){return null}set CCb(t){}sj(t,x=null,B=null){this.gL&&
(B.isModal=!1);super.sj(t,x,B)}hide(){if(r.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Jb)this.vQh(),r.AFrameworkApplication.Aa.hx.Eo(e.AFrame.f6),super.hide()}Kei(){const t=r.AFrameworkApplication.Aa.hx,x=r.AFrameworkApplication.Aa.ks;t.r3(this.CL);t.cja(this.CL);x.Ic(this.CL).parent=e.AFrame.$i}Wra(){m.FocusManager.oN()&&(super.Wra(),this.Kei(),r.AFrameworkApplication.Aa.hx.hL(e.AFrame.f6))}mkb(){if(m.FocusManager.oN()&&
!r.AFrameworkApplication.Yg){const t=m.FocusManager.instance();t.J1(this.CL);const x=t.LQ(this.CL);x&&x.Gj.mF(null);t.rMb(this.CL)}}Maa(){"DL"===this.Qra||"DP"===this.Qra?super.Maa():r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?(this.vQh(),this.PFf()&&this.NFh(this.Jb.clientHeight,this.Jb.clientWidth)):this.ZA()}ZA(){this.NFh(h.a.Tff,h.a.Wff)}NFh(t,x){if(this.CCb&&this.GCb){let B,D;B=n.a.kpc+this.GCb;D=n.a.jpc+this.CCb;B+t>this.Tka()&&(B=this.Tka()-
t);D+x>this.eua()&&(D=this.eua()-x);this.Mvd(B,D)}else super.ZA()}Wce(t){if(!t)return null;t.endsWith("px")&&(t=t.substring(0,t.length-2));return n.a.DBb(t)?((t=parseInt(t))||(t=1),t):null}vQh(){if(this.Jb&&this.Jb.style){var t=this.Wce(this.Jb.style.top);t&&(this.GCb=t-n.a.kpc);if(t=r.AFrameworkApplication.isRtl?this.Wce(this.Jb.style.right):this.Wce(this.Jb.style.left))this.CCb=t-n.a.jpc}}}Object(K.a)(z,"ModelessCustomDialog",h.a,[])},1296:function(K,S,d){d.r(S);var h=d(0),e=d(395),r=d(1254),m=
d(1255),n=d(7),z=d(1253),t;(function(A){A[A.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";A[A.cloudPolicySettings=1]="cloudPolicySettings";A[A.alternateAuthToken=2]="alternateAuthToken"})(t||(t={}));Object(h.b)("ApplicationFeatureHelperRequestType",t);class x{constructor(){this.message=null;this.Iv=0}}Object(h.a)(x,"HttpRequstToPromiseRejectData",null,[]);var B=d(97),D=d(77),w=d(171),J=d(478);class F{constructor(A,W){this.Ma=A;this.ji=W}H3b(A,W,oa,xa=null,Ia=null,qb=null,Hb=
null,hc=null){const Jc=t[oa],ld=Jc+"RequestFailure";B.Health.instance.recordKpiUsage(ld,0,"jpittsdirects",null);return new Promise((wd,Bd)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Jc);const de=null!=Hb?Hb:this.Ma.uc("ApplicationFeatureHelperRequestQueueTimeout",15E3),oe=null!=hc?hc:this.Ma.uc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.ji.qW(A,1,null,this.Lbe(oa,xa),qb,1,Pc=>{e.ULS.sendTraceTag(50622689,
3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Jc);try{if(void 0===Pc||null===Pc||void 0===Pc.data||null===Pc.data||void 0===Pc.data.Wd||null===Pc.data.Wd){B.Health.instance.recordKpiFailure(ld,"Invalid RequestSucceededEventArgs",!1,!0,null);let id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",Jc);Bd(this.Wka(id,Pc))}else if(Pc.data.Oe!==w.a.mx){B.Health.instance.recordKpiFailure(ld,
"HttpStatusCode_"+Pc.data.Oe.toString(),!1,!0,null);let id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Pc.data.Oe,Jc);Bd(this.Wka(id,Pc))}else{void 0!==Ia&&null!==Ia&&void 0!==Pc.data.Dj&&null!==Pc.data.Dj&&Ia(Pc.data.Dj);var tc=W(Pc.data.Wd);if(tc)e.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",
Jc),wd(tc);else{B.Health.instance.recordKpiFailure(ld,"Parse Failure",!1,!0,null);let id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Jc);Bd(this.Wka(id,Pc))}}}catch(id){B.Health.instance.recordKpiFailure(ld,"Unexpected Failure",!1,!0,null),tc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",id,Jc),Bd(this.Wka(tc,Pc))}},Pc=>{if(Pc.data){B.Health.instance.recordKpiFailure(ld,"HttpStatusCode_"+
Pc.data.Oe.toString(),!1,!0,null);var tc=J.a.Zyb(Pc.data.Wd||"No Data");tc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Pc.data.Oe,tc,Jc)}else B.Health.instance.recordKpiFailure(ld,"Invalid RequestFailedEventArgs",!1,!0,null),tc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Jc);Bd(this.Wka(tc,Pc))},null,void 0,void 0,de,oe)})}Wka(A,
W){const oa=new x;oa.message=A;oa.Iv=W&&W.data?W.data.Oe:-1;return oa}Lbe(A,W){const oa={};oa["x-UserDataSignature"]=this.Ma.Ha("UserDataSignature");oa["x-LicensingIsEnabled"]=this.Ma.ka("LicensingIsEnabled").toString();oa["x-CacheIsEnabled"]=this.Ma.ka("LicensingRedisIsEnabled").toString();oa["x-OcpsIsEnabled"]=this.Ma.ka("OcpsIsEnabled").toString();oa["x-LicensingAADIdIsEnabled"]=this.Ma.ka("LicensingAadIdIsEnabled").toString();0===A&&(oa["x-LicenseCheckOnTenantEnabled"]="true",oa["x-SupportUserConsentDependentFeatures"]=
"true",oa["x-AFHUserConsentGroupValue"]="0",oa["x-UseShellServiceForUserConsentGroup"]="true",oa["x-SMBUserLicensingEnabled"]="true",oa["x-AFHPIPLComplianceEnabled"]=D.a.cO(window.location.href,"wd_afhpipl")||"false",oa["x-ConsumerLicensingSNICertIsEnabled"]=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),oa["x-MSGraphInLicensingIsEnabled"]=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());
if(W)for(let xa of W.keys)oa[xa]=W.ga(xa);return oa}}Object(h.a)(F,"HttpRequestToPromiseUtility",null,[]);var L=d(27),M;(function(A){A[A.loki=0]="loki";A[A.augloopACLP=1]="augloopACLP"})(M||(M={}));Object(h.b)("AlternateAuthSupportApp",M);var Q=d(218),C=d(36);class O{constructor(){this.Token=null;this.ExpirationTime=0}}Object(h.a)(O,"WacAlternateAuthToken",null,[]);class U{constructor(A,W){this.JLl=3E5;if(void 0===A||null===A||void 0===W||null===W)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ma=A;this.Xyc=new r.a(m.a.Gk());this.rVb=new F(A,W);void 0!==Q.OAuthManagerSettings.oue&&null!==Q.OAuthManagerSettings.oue&&void 0!==Q.OAuthManagerSettings.j6c&&null!==Q.OAuthManagerSettings.j6c&&0<Q.OAuthManagerSettings.j6c&&(A=new O,A.Token=Q.OAuthManagerSettings.oue,A.ExpirationTime=Q.OAuthManagerSettings.j6c,this.Xyc.$("loki",A))}Cdj(){let A=null;this.Xyc.Gb(M[0])&&(A=this.Xyc.ga(M[0]));return void 0===A||null===A||this.R8j(A)?this.K6i():Promise.resolve(A.Token)}R8j(A){return A.ExpirationTime-
Date.now()<this.JLl}K6i(){const A=new r.a(m.a.Gk());A.$("X-AlternateAuthApp",M[0]);return this.rVb.H3b(this.aUa("/afhs/AlternateAuthHelperHandler.ashx"),Object(n.a)(this,this.DQk,"parseAlternateAuthTokenResponse"),2,A).then(W=>{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",M[0]);this.Xyc.$(M[0],W);return W.Token},W=>{W=Object(z.a)(x,W);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
W.message,W.Iv);return null})}DQk(A){let W=null;({Su:W}=C.d(A));e.ULS.sendTraceTag(545821457,3004,W?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",A);return W}aUa(A){const W=this.Ma.ka("SuiteOriginForAFHSIsEnabled")?this.Ma.Ha("SuiteOrigin"):this.Ma.Ha("WebServiceBase");return String.format("{0}{1}?{2}",W,A,L.AFrameworkApplication.Pg)}}Object(h.a)(U,"AlternateAuthHelper",null,[593]);var T=d(1099);class ca{constructor(A,W,oa){this.featureName=null;this.isEnabled=!1;
this.tierName=0;this.featureName=A;this.isEnabled=W;this.tierName=oa}}Object(h.a)(ca,"FeatureStateChangeArgs",null,[]);var N=d(224),da=d(216),Y=d(56),fa=d(106),aa=d(103),ka;(function(A){A[A.Enabled=0]="Enabled";A[A.Disabled=1]="Disabled"})(ka||(ka={}));Object(h.b)("FeatureState",ka);var H=d(55),ra=d(37),ha=d(89);class Ma{constructor(A,W,oa=null,xa=null,Ia=null){this.sTa=this.fW=this.ftf=this.hPa=this.rHc=null;this.rVb=new F(A,W);this.Ma=A;this.B4h=A.uc("LicensingMaxRetryAttempts",0);this.gDc=A.ka("IsO365ConsumerHost");
this.YId=A.ka("IsO365CommercialHost");this.EId=A.ka("PremiumUpsellIsEnabled");this.jqb=!1;this.rKd=0;this.Vef=oa;this.oxf=xa;this.Ca=Ia;this.gPa=A.ka("LicensingIsEnabled");this.N5a=A.ka("OcpsIsEnabled")&&this.YId;this.lSd=A.ka("ShowPrivacyDialog")&&!!xa;this.$Hd=A.ka("IsAnonymousUser");this.gTc=new Promise(qb=>{qb(!1)});this.K2a=new Promise(qb=>{qb(!0)});this.rTa=new r.a(m.a.Gk());this.zIc=!0;this.aof=this.xnj();this.cqe()&&!this.$Hd?(void 0!==L.AFrameworkApplication.Aa&&null!==L.AFrameworkApplication.Aa&&
(this.rHc=L.AFrameworkApplication.Aa.BV,void 0!==this.rHc&&null!==this.rHc&&(this.hPa=this.rHc.hIb("WebServiceCall","ApplicationFeatureHelperService"))),this.sTa=this.H9e()):this.sTa=new Promise(qb=>{qb({})});this.sTa.catch(qb=>{qb=Object(z.a)(x,qb);e.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",qb?qb.Iv.toString():"Unknown")});this.zIc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(qb=>{this.jqb=qb;return null})}xnj(){const A=this.Ma.gu("AllLicensedFeatures")?
this.Ma.ty("AllLicensedFeatures"):[],W=new T.a;for(let oa=0;oa<A.length;oa++)W.add(A[oa]);return W}cqe(){return this.YId||this.gDc}H9e(A=0,W=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",W);const oa=N.a.fA();oa&&(oa.set("retryAttempt",A.toString()),oa.set("forceRefresh",W.toString()),oa.set("isO365ConsumerHost",this.gDc.toString()),oa.set("isO365CommercialHost",this.YId.toString()),oa.set("isFreemiumUpsellSettingEnabled",this.EId.toString()));
B.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",oa);B.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",oa);void 0!==this.hPa&&null!==this.hPa&&this.hPa.start();let xa=null;W&&(xa=new r.a(m.a.Gk()),xa.$("x-LicensingForceRefresh","true"));this.ftf=new Date;return(this.gPa?this.rVb.H3b(this.aUa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(n.a)(this,this.GQk,"parseApplicationFeatureHelperResponse"),0,xa,Object(n.a)(this,
this.fYk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Ia=>{const qb=Object.assign(new ha.a,{durationMs:this.QHh()});qb.extendedProperties=oa;qb.extendedProperties&&Ia&&(qb.extendedProperties.set("featureCount",fa.a.count(Ia).toString()),qb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Ia).toString()),qb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Ia).toString()),"FreemiumUpsell"in Ia&&qb.extendedProperties.set("isFreemiumUpsellEnabled",
Ia.FreemiumUpsell.toString()),this.fW&&qb.extendedProperties.set("fromCache",(this.fW<this.ftf).toString()));B.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",qb);return Ia},Ia=>{const qb=Object.assign(new ha.a,{durationMs:this.QHh()}),Hb=Object(z.a)(x,Ia);if(!Hb)return e.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),B.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,qb),new Promise((hc,Jc)=>{Jc(Ia)});qb.extendedProperties=oa;qb.extendedProperties&&qb.extendedProperties.set("status",Hb.Iv.toString());B.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,qb);return 408===Hb.Iv&&++A<=this.B4h?this.H9e(A):new Promise((hc,Jc)=>{Jc(Hb)})})}GQk(A){(A=C.b(A))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",A)):e.ULS.sendTraceTag(50436171,
3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return A.Features}aUa(A){var W=this.Ma.ka("SuiteOriginForAFHSIsEnabled")?this.Ma.Ha("SuiteOrigin"):this.Ma.Ha("WebServiceBase");W=String.format("{0}{1}",W,A);this.Ma.gu("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ma.ka("ApplicationFeatureHelperHttpCachingEnabled")&&(A=Ma.ZWc(this.Ma))&&0<A.length&&(this.zIc&&(A+="ucbf"),W=new da.QueryStringBuilder(W),W.xg("afhskey",A),W=W.toString());
return W}isFeatureEnabled(A,W){if(!this.N5a&&!this.lSd&&!this.gPa)return this.K2a;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",A);if("ConnectedServices"===A){var oa=this.N5a?this.Vef.l4("ControllerConnectedServicesEnabled"):this.K2a;const qb=this.lSd?this.oxf.getSettings().then(Hb=>2!==Hb.MC,()=>W):this.K2a;return oa.then(Hb=>Hb?qb:this.gTc)}if("FreemiumUpsell"===A&&(!this.EId||!this.gDc||this.$Hd))return this.gTc;
oa=null;oa=this.N5a?this.Vef.isFeatureEnabled(A):this.K2a;let xa=null;xa=this.gPa?this.p_j(A,W):this.K2a;let Ia=null;Ia=this.lSd?this.oxf.isFeatureEnabled(A):this.K2a;return oa.then(qb=>qb?Ia.then(Hb=>Hb?xa:this.gTc):this.gTc).then(qb=>{this.lyg(A,qb,!0);return qb},()=>{this.lyg(A,W,!1);return W})}lyg(A,W,oa){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",A,W,oa)}getFeatureTier(A,W){if(!this.gPa)return new Promise(oa=>{oa(2)});e.ULS.sendTraceTag(42804871,3004,
50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",A);return this.sTa.then(oa=>this.zYc(A,oa,W),()=>W)}isFreemiumUpsellEnabled(){if(this.EId&&this.gDc&&!this.$Hd){if(this.jqb&&2!==this.rKd||!this.jqb&&1!==this.rKd)e.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.jqb.toString()),this.rKd=this.jqb?2:1;return this.jqb}return!1}launchUpsellExperience(A,W=null){e.ULS.sendTraceTag(594564814,3004,
50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",A));var oa=N.a.fA();oa&&(oa.set("experienceId",A),W&&oa.set("campaignId",W));B.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",oa);if(oa=H.a.instance.rb("Common.IInProductMessagingUIManager")){const xa=Object(n.a)(this,this.qEj,"handleDimeTaskComplete");oa.Kwg(A,xa,W)}else e.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),B.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"InProductMessagingNotInitialized",!1,!0,null),this.Ca.Ja(ra.a.xUc,2,{["experience"]:A})}C0a(A,W){if(!this.gPa)return null;if(!A||!W)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const oa=aa.a.create().toString();this.rTa.Gb(A)||this.rTa.$(A,new r.a(m.a.Gk()));this.rTa.ga(A).add(oa,W);e.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",
oa,A));return oa}lkb(A,W){this.gPa&&(A&&this.rTa.Gb(A)?W&&aa.a.isValid(W)?this.rTa.ga(A).Gb(W)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",W,A)),this.rTa.ga(A).remove(W)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",W,A)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
W,A)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",A)))}zYc(A,W,oa){return this.zIc?A in W?W[A].LicenseTier:oa:A in W?this.qRk(W[A],oa):oa}qRk(A,W){switch(A.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return W}}qEj(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.sTa.then(A=>{this.Qoh(A)}).catch(()=>
{this.Qoh({})})}Qoh(A){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const W=this.H9e(0,!0);W.then(oa=>{this.sTa=W;fa.a.count(oa)>fa.a.count(A)?B.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):B.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let xa of this.rTa.keys)if(xa in oa){const Ia=this.zYc(xa,oa,0);xa in A?this.zYc(xa,A,0)!==Ia&&this.PLe(xa,!0,Ia):this.PLe(xa,
!0,Ia)}else xa in A&&this.PLe(xa,!1,this.zYc(xa,A,0))}).catch(oa=>{B.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(oa))})}PLe(A,W,oa){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",A,W,oa);W=new ca(A,W,oa);oa=this.rTa.ga(A);for(let xa of oa)try{xa.value(W)}catch(Ia){e.ULS.sendTraceTag(594051084,
3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",A,xa.key,Ia.message))}}o_j(A,W){if(this.gPa){const oa=this.aof.contains(A);let xa=!0,Ia="",qb=!1;return this.sTa.then(Hb=>{A in Hb?(Hb=Hb[A],Ia=ka[Hb.FeatureState],xa=1!==Hb.FeatureState):xa=!oa;this.vyg(A,oa,Ia,qb,W,xa);return xa},()=>{qb=!0;oa&&(xa=W);this.vyg(A,oa,Ia,qb,W,xa);return xa})}return this.K2a}vyg(A,W,oa,xa,Ia,qb){e.ULS.sendTraceTag(557389507,
3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",A,W,xa,oa,Ia,qb)}p_j(A,W){if(this.zIc)return this.o_j(A,W);if(this.gPa){if(this.aof.contains(A))return this.sTa.then(oa=>A in oa,()=>W);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",A)}return this.K2a}fYk(A){try{A&&"Date"in A&&(this.fW=new Date(A.Date),
e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.fW.toString()))}catch(W){e.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",W)}}QHh(){if(void 0!==this.hPa&&null!==this.hPa){const A=this.hPa.er;this.hPa.stop();return A}return null}static ZWc(A){try{if(Y.a.w6e){const W=A.Ha("UserDataSignature").split(".");if(1<W.length){const oa=window.self.atob(W[1]),xa=JSON.parse(oa).LocalStorageKey;if(void 0!==xa&&
null!==xa&&0<xa.length)return xa}}}catch(W){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",W.toString())}return null}}Object(h.a)(Ma,"ApplicationFeatureHelper",null,[594]);var Ga=d(18);class na{constructor(A,W){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=A.PolicySettings;A=new Date;A.setMinutes(A.getMinutes()+W);this.ExpirationTime=A.getTime()}}Object(h.a)(na,"CloudPolicySettingsCacheData",null,[]);var wa=d(379),Fa=d(251),pa=d(311);class Ea{static GFh(){return L.AFrameworkApplication.fa.ka("SideCarIsEnabled")?
Ea.Yrd&&Ea.T1c?new Promise(A=>{A(!0)}):new Promise((A,W)=>{Ea.Yrd=pa.a.create(L.AFrameworkApplication.fa.Ha("SideCarUrl"));Fa.a.py(Ea.Yrd);Ea.Yrd.sW((oa,xa)=>{(Ea.T1c=xa.succeeded)?A(xa.succeeded):W(xa.succeeded)})}):new Promise(A=>{A(!1)})}}Ea.T1c=!1;Ea.Yrd=null;Object(h.a)(Ea,"SideCarLoader",null,[]);class ta{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(h.a)(ta,"CloudPolicySettingsData",null,[]);class ia{constructor(A,W){this.zDd=0;this.ENc=null;this.rVb=
new F(A,W);this.Ma=A;W=A.Ha("HostAuthType");this.N5a=A.ka("OcpsIsEnabled")&&A.ka("IsO365CommercialHost")&&!(void 0===W||null===W)&&"aad"===W.toLowerCase();this.tqf=C.b(A.Ha("OcpsDefaultSettings")||"{}");this.MWb=this.ZWc();W=this.Ma.gu("ServicesControlsMicrosoftControllerServicesList")?this.Ma.ty("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.jAc=new T.a;for(let oa=0;oa<W.length;oa++)this.jAc.add(W[oa]);this.N5a&&!A.ka("IsAnonymousUser")&&A.ka("SideCarIsEnabled")?this.ENc=this.QOl():
this.ENc=this.G9e(this.N5a,this.aUa("/afhs/CloudPolicySettings.ashx"),Object(n.a)(this,this.NQk,"parseCloudPolicySettingsResponse"));this.ENc.then(()=>null).catch(oa=>{oa=Object(z.a)(x,oa);e.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",oa?oa.Iv.toString():"Unknown")})}l4(A,W=!0){if(!this.N5a){const qb=this;return new Promise(Hb=>{Hb(qb.r8b(A))})}let oa=this,xa=this;const Ia=this.ENc.then(qb=>{try{let Hb=null;qb.PolicySettings&&"unknown"in qb.PolicySettings&&
(Hb=qb.PolicySettings.unknown);if(Hb){if(A in Hb&&void 0!==Hb[A]&&null!==Hb[A])return new Promise(Jc=>{Jc("0"!==Hb[A])});const hc=A.toLowerCase();if(hc in Hb&&void 0!==Hb[hc]&&null!==Hb[hc])return new Promise(Jc=>{Jc("0"!==Hb[hc])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+A+" not found, using default");return new Promise(Jc=>{Jc(oa.r8b(A))})}return new Promise(hc=>{hc(oa.r8b(A))})}catch(Hb){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+A+" policy value. Error Message: {0}",Hb.message),
oa.handleError(Hb.toString(),W,oa.r8b(A))}},qb=>xa.handleError(qb,W,xa.r8b(A)));Ia.then(qb=>{e.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",A,qb);return null});return Ia}isFeatureEnabled(A,W=!0){if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.r_j(A,W);let oa=new Promise(Ia=>{Ia(!0)}),xa="";this.jAc.contains(A)&&(xa="ControllerConnectedServicesEnabled",
oa=this.l4(xa,W));oa.then(Ia=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",A,Ia,xa);return null});return oa}r_j(A,W=!0){let oa=new Promise(Ia=>{Ia(!0)}),xa="";"mso_sendASmile"===A?xa="Enabled":"Survey"===A||"FloodgateSurvey"===A?xa="SurveyEnabled":this.jAc.contains(A)&&(xa="ControllerConnectedServicesEnabled");""!==xa&&(oa=this.l4(xa,W));oa.then(Ia=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
A,Ia,xa);return null});return oa}handleError(A,W,oa){return W?new Promise(xa=>{xa(oa)}):new Promise((xa,Ia)=>{Ia(A)})}G9e(A,W,oa){if(!A)return Promise.resolve(new ta);let xa=!1,Ia=null;B.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let qb=this.F1d("GetCloudPolicySettings");return(new Promise((Hb,hc)=>{if(void 0!==this.MWb&&null!==this.MWb&&0<this.MWb.length){const Jc=this.xOl();if(void 0!==Jc&&null!==Jc){xa=!0;Hb(Jc);return}}this.rVb.H3b(W,oa,1,null,Object(n.a)(this,
this.nYk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ma.uc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ma.uc("CloudPolicySettingsRequestSentTimeout",3E4)).then(Jc=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.CPl(Jc);Hb(Jc);return Jc},Jc=>{hc(Jc);return null})})).then(Hb=>{({Zy:qb,returnValue:Ia}=this.kwd(qb));var hc=N.a.fA();hc&&hc.set("FromCache",xa.toString());hc=Object.assign(new ha.a,{durationMs:Ia,extendedProperties:hc});
B.Health.instance.recordKpiSuccess("GetCloudPolicySettings",hc);return Hb})}QOl(){return Ea.GFh().then(()=>{e.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}aUa(A){const W=this.Ma.ka("SuiteOriginForAFHSIsEnabled")?this.Ma.Ha("SuiteOrigin"):this.Ma.Ha("WebServiceBase");return String.format("{0}{1}",W,A)}NQk(A){let W=null;({Su:W}=C.d(A));A=!!W;e.ULS.sendTraceTag(50622687,
3004,A?50:10,"ParseCloudPolicySettingsResponse: Success={0}",A);return W}nYk(A){try{if(void 0!==A&&null!==A&&"CheckIn-Interval"in A){const W=parseInt(A["CheckIn-Interval"]);void 0!==W&&null!==W&&0<W&&(this.zDd=W)}}catch(W){e.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",W)}}r8b(A){return A in this.tqf?"0"!==this.tqf[A]:!0}xOl(){try{const A=wa.a.instance.getItem(this.MWb);if(void 0===A||null===A)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",A);const W=JSON.parse(A);if(void 0===W||null===W)return e.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===W.ExpirationTime||null===W.ExpirationTime)return e.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;
if((new Date(W.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const oa=new ta;oa.PolicySettings=W.PolicySettings;oa.ControllerConnectedServicesFeatureNames=new Ga.a;this.Ma.gu("ServicesControlsMicrosoftControllerServicesList")&&this.Ma.ty("ServicesControlsMicrosoftControllerServicesList");for(let xa of this.jAc)oa.ControllerConnectedServicesFeatureNames.add(xa);e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");
return oa}catch(A){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",A.toString()),null}}CPl(A){try{if(void 0===A||null===A||void 0===A.PolicySettings||null===A.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.zDd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const W=new na(A,this.zDd),oa=JSON.stringify(W);
e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",oa);wa.a.instance.setItem(this.MWb,oa);e.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(W){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",W.toString())}}ZWc(){const A=Ma.ZWc(this.Ma);return A&&0<A.length?"OCPS"+A:null}F1d(A){const W=H.a.instance.rb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==
W&&null!==W?W.Ii("WebServiceCall",A):null}kwd(A){if(void 0!==A&&null!==A){const W=A.er;A.stop();return{returnValue:W,Zy:null}}return{returnValue:null,Zy:A}}}Object(h.a)(ia,"CloudPolicySettingsHelper",null,[591]);class Ja{constructor(){this.XWf=this.hSh=this.MC=0;this.YWf=this.iSh=this.W8a="";this.jQd=this.nAa=2}clone(){const A=new Ja;A.MC=this.MC;A.hSh=this.hSh;A.XWf=this.XWf;A.W8a=this.W8a;A.iSh=this.iSh;A.YWf=this.YWf;A.nAa=this.nAa;A.jQd=this.src;return A}get src(){return this.jQd}serialize(A=
null){const W={};if(!A||A.contains(Ja.lib))W[Ja.lib]=this.MC;if(!A||A.contains(Ja.Tmc))W[Ja.Tmc]=this.W8a;if(!A||A.contains(Ja.Umc))W[Ja.Umc]=this.nAa;return JSON.stringify(W)}static create(A,W=null){const oa=new Ja;oa.jQd=A;void 0!==W&&null!==W&&(Ja.lib in W&&(oa.MC=W[Ja.lib]),Ja.Tmc in W&&(oa.W8a=W[Ja.Tmc]),Ja.Umc in W&&(oa.nAa=W[Ja.Umc]));return oa}static deserialize(A,W){try{const oa=JSON.parse(A);if(void 0!==oa&&null!==oa)return Ja.create(W,oa);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
A);throw Error.argument("settingsData");}catch(oa){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",oa.toString()),oa;}}}Ja.lib="CCS";Ja.Tmc="CCSTime";Ja.Umc="OfficePrivacyRoamedNoticeShown";Object(h.a)(Ja,"UserPrivacySettings",null,[]);var ab=d(203);class Oa{constructor(A,W){if(void 0===A||null===A||void 0===W||null===W)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=A;this.ji=W;this.APd=this.Yc=null}aUa(A){var W=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ma.appSettings.RoamingServiceHandlerWebServiceBase||"");W=new Sys.StringBuilder(W);W.append(A);W.append("&");W.append(L.AFrameworkApplication.Pg);return W.toString()}executeRequest(A,W,oa,xa=null){return this.ji.Psb(A,W,xa,null,2,oa,"33",!1,null,6E4)}saveSettings(A){return new Promise((W,oa)=>{try{if(void 0===this.Yc||null===this.Yc||void 0===A||null===A)e.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),oa("Can't determine setting changes to save");
else{var xa=this.Yc.MC!==A.MC;if(2===this.Yc.src&&xa)this.Kjl(A),W(!0);else{var Ia=this.Zml(A);if(void 0===Ia||null===Ia||!Ia.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),oa("No changes to save");else if(1===this.Yc.src)W(this.QNh(Ia));else if(0===this.Yc.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Ia);const qb=this.executeRequest(this.aUa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Ia);qb.continueWith(()=>{if(qb.jo||qb.Hm)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),W(!1);else{var Hb=qb.result;void 0!==Hb.xj&&null!==Hb.xj&&void 0!==Hb.xj.data&&null!==Hb.xj.data&&Hb.xj.data.Oe===w.a.mx?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),W(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),W(!1))}})}}}}catch(qb){e.ULS.sendTraceTag(50860930,3004,
10,"SaveUserPrivacySettings: Exception = {0}",qb.toString()),W(!1)}})}Zml(A){if(void 0===this.Yc||null===this.Yc||void 0===A||null===A)throw Error.invalidOperation("User Privacy settings have not been initialized");const W=new Ga.a;0===A.src?(this.Yc.MC!==A.MC&&(W.add(Ja.lib),W.add(Ja.Tmc)),this.Yc.nAa!==A.nAa&&W.add(Ja.Umc)):1===A.src&&this.Yc.MC!==A.MC&&W.add(Ja.lib);return W.count?A.serialize(W):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.APd){const A=
this;this.APd=new Promise(W=>{try{A.Yc?W(A.Yc.clone()):A.GOl().then(oa=>{A.Yc=oa;W(A.Yc.clone());return null},()=>{A.EOl().then(oa=>{A.Yc=oa;W(A.Yc.clone());return null},()=>{A.FOl().then(oa=>{A.Yc=oa;W(A.Yc.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");A.Yc=new Ja;W(A.Yc.clone());return null});return null});return null})}catch(oa){e.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
oa.toString()),A.Yc=new Ja,W(A.Yc.clone())}})}return this.APd}GOl(){return new Promise((A,W)=>{try{const xa=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ma.ka("PrivacyDialogShouldCheckRoaming")||xa){var oa=this.executeRequest(this.aUa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");oa.continueWith(()=>{try{if(oa.jo||oa.Hm)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Ia=oa.result;if(Ia&&Ia.xj&&Ia.xj.data)if(Ia.xj.data.Oe!==
w.a.mx)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ia.xj.data.Oe);else{if(Ia.xj.data.Wd){A(Oa.parse(Ia.xj.data.Wd,0));e.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ia.xj.data.Wd);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
W("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ia){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ia.toString()),W("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),W("Roaming should not be used")}catch(xa){e.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
xa.toString()),W("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}EOl(){return new Promise((A,W)=>{try{const oa=ab.a.get("WacUPToggleState");let xa=null;void 0!==oa&&null!==oa&&0<oa.length&&(xa=decodeURIComponent(oa));if(void 0!==xa&&null!==xa&&0<xa.length){const Ia=Oa.parse(xa,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ia.toString());A(Ia)}else{const Ia=Ja.create(1),qb=new Ga.a;qb.add(Ja.lib);const Hb=Ia.serialize(qb);
this.QNh(Hb)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Hb),A(Ia)):(e.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Hb),W("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(oa){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",oa.toString()),W("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}FOl(){return new Promise(A=>
{try{var W=-1!==window.location.href.indexOf("&wdccsoff=1");let oa=Ja.create(2);W?(oa.MC=2,L.AFrameworkApplication.IVf(),e.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",oa.toString())):(oa.MC=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",oa.toString()));A(oa)}catch(oa){e.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",oa.toString()),
W=Ja.create(2),W.MC=1,A(W)}})}Kjl(A){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===A.MC?L.AFrameworkApplication.IVf():L.AFrameworkApplication.A0i();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",A)}QNh(A){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",A);const W=this.Ma.Ha("PrivacyCookieDomain")||"";if(!W||!W.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",A);return ab.a.nBh("WacUPToggleState",A,ab.a.aK,W)}catch(W){return e.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",W.toString()),!1}}isFeatureEnabled(A){return this.getSettings().then(W=>{const oa=this.Ma.gu("ServicesControlsMicrosoftControllerServicesList")?this.Ma.ty("ServicesControlsMicrosoftControllerServicesList"):[],xa=new T.a;for(let Ia=0;Ia<oa.length;Ia++)xa.add(oa[Ia]);return xa.contains(A)?
2!==W.MC:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",A);return!0})}static parse(A,W){try{return e.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",A,W),Ja.deserialize(A,W)}catch(oa){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",oa.toString()),oa;}}}Object(h.a)(Oa,"UserPrivacySettingsHelper",null,[592]);var Za=d(71);class Na{constructor(){this.Ea=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Xb(A){this.Ea=
A;this.Ea.register(591,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").na().oa(()=>new ia(L.AFrameworkApplication.fa,L.AFrameworkApplication.Je));this.Ea.register(592,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").na().oa(()=>new Oa(L.AFrameworkApplication.fa,L.AFrameworkApplication.Je));this.Ea.register(593,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").na().oa(()=>new U(L.AFrameworkApplication.fa,L.AFrameworkApplication.Je));this.Ea.register(594,
"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").na().oa(()=>new Ma(L.AFrameworkApplication.fa,L.AFrameworkApplication.Je,this.Ea.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Ea.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),L.AFrameworkApplication.Qa))}init(){L.AFrameworkApplication.fa.$e(()=>{const A=this.Ea.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");L.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&
(A.isFeatureEnabled("LicensingTestFeature",!1).then(W=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",W,L.AFrameworkApplication.fa.Ha("IsAnonymousUser"));return null}),A.getFeatureTier("LicensingTestFeature",0).then(W=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",W,L.AFrameworkApplication.fa.Ha("IsAnonymousUser"));
return null}));this.Ea.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.KJl()})}dispose(){}KJl(){try{L.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Ea.GFh().then(A=>{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",A);return A})}catch(A){}}static main(){Za.a.instance.Ac(new Na)}}Object(h.a)(Na,"ApplicationFeatureHelperPackage",null,[2,3]);var sa=d(521),Sa=d(6);class xb{constructor(A,W){this.ji=A;this.ZD=W}Xx(A,W,oa,
xa=null){return this.iZi(A,xa,Ia=>this.ji.Psb(Ia,2,oa,W,2,void 0,void 0,void 0,void 0,void 0,"2"))}iZi(A,W,oa){const xa=!!W&&""!==W;let Ia=A;xa&&(Ia=D.a.JQa(A,"perfTag",W));const qb=new Date;return sa.a.then(oa(Ia),Hb=>{const hc=+new Date-+qb;if(!Hb||!Hb.xj||!Hb.xj.data)return Hb;xa&&Hb.xj.data.request&&this.oml(Hb.xj.data.request.getResolvedUrl(),W,hc);return Hb})}oml(A,W,oa){A=this.ZD.htj(A);if(A.count&&(A=Sa.last(A))){const xa={Message:"Request durations for activities calls."};xa.PerfTag=W;xa.CustomDuration=
oa;xa.PerformanceDuration=A.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(xa))}}}Object(h.a)(xb,"CatchUpNetworkingWrapper",null,[806]);var gc=d(386);class zc extends gc.a{constructor(A,W){super(A,W)}ul(){return 6}}Object(h.a)(zc,"GetActivityFeedRequest",gc.a,[]);class Xb extends gc.a{constructor(A,W,oa,xa,Ia,qb){super(A,W);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=oa;this.ActivityStatesToSet=xa;this.ActivityStatesToReset=
Ia;this.ResetUnseenCount=qb}ul(){return 7}}Object(h.a)(Xb,"UpdateActivityFeedStateRequest",gc.a,[]);var jb=d(537);class zb{constructor(A,W,oa){this.Ppf=A;this.M3a=W;this.W3a=oa}getActivityFeed(A){return sa.a.then(this.W3a.execute(new zc(this.M3a(),null),(W,oa,xa)=>this.Ppf.Xx(W,oa,xa,"ActivityFeed"),A),W=>{if(!W)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!W.xj)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;W=
W.xj.data;if(!W)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(W.Oe!==w.a.mx)return e.ULS.sendTraceTag(508929507,3012,10,"GetActivityFeed: Response status code {0}",W.Oe),null;if(!W.Wd)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;W=jb.a.t9a(W.Wd);return W?W:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}xRl(A,W,oa,xa,Ia){return sa.a.then(this.W3a.execute(new Xb(this.M3a(),
null,W,oa,xa,Ia),(qb,Hb,hc)=>this.Ppf.Xx(qb,Hb,hc,"UpdateActivityFeedState"),A),qb=>{try{return qb.succeeded}catch(Hb){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception {0}",Hb.message),!1}})}}Object(h.a)(zb,"CatchUpRequestHandler",null,[805]);var Tb=d(217);class Ya{constructor(A){this.Rrb=A;this.zof=new Tb.a}uek(){this.nfk()}nfk(){if(this.Rrb){var A=W=>{this.zof.contains("CatchUpChangesFeedback")||(this.zof.add("CatchUpChangesFeedback"),W.logActivity("CatchUpChangesFeedback",
null))};this.Rrb.execute(W=>{window.setTimeout(()=>{A(W)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(h.a)(Ya,"FloodgateEventLogger",null,[]);class sb{constructor(A){this.e7h=A}get duration(){return this.e7h.duration}}Object(h.a)(sb,"PerformanceResourceTimingWrapper",null,[]);class oc{constructor(A){this.ZD=A}htj(A){const W=new Ga.a;if(!this.ZD)return W;A=this.ZD.getEntriesByName(A,"resource");if(!A)return W;for(const oa of A)W.add(new sb(oa));
return W}}Object(h.a)(oc,"PerformanceWrapper",null,[]);class wb{constructor(){this.Ea=null}get name(){return"Common.App.CatchUpActivity"}Xb(A){this.Ea=A;this.Ea.register(xb,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").na().oa(()=>new xb(L.AFrameworkApplication.Je,new oc(window.performance)));this.Ea.register(zb,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").na().oa(()=>
new zb(this.Ea.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>L.AFrameworkApplication.Pg,new jb.a));this.Ea.register(Ya,"Common.App.CatchUpActivity.FloodgateEventLogger").na().oa(()=>new Ya(this.Ea.Ia("Common.ISystemInitiatedFeedback")))}init(){this.Ea.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Ea.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){Za.a.instance.Ac(new wb)}}Object(h.a)(wb,"CatchUpActivityPackage",null,
[2,3]);var rc=d(1252),Ka=d(107);class Db{constructor(A,W,oa){this.X3e=this.Y3e=this.Z3e=!1;this.k4e=!A&&!W;this.l4e=!A&&!oa;this.k4e||this.l4e||(this.Z3e=!A,this.Y3e=!W,this.X3e=!oa)}}Object(h.a)(Db,"RenameDisabledDialogInfo",null,[]);class bc extends Ka.StandardDialog{constructor(A,W,oa,xa,Ia){super();this.F7e=[];this.a3=new Db(A,W,oa);this.yQa=xa;this.$Oa=Ia;this.ig="RenameDisabledDialog";this.Ad=0;this.Le(1,CommonUIStrings.l_DialogClose);this.Jtl();this.zdl()}Jtl(){this.a3.k4e?this.Muc(this.yQa?
this.$Oa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.a3.l4e?this.Muc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.yfi();this.eJc(this.F7e)}Muc(A){Array.add(this.F7e,A)}yfi(){const A=[];this.a3.Z3e||Array.add(A,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.a3.Y3e||Array.add(A,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.a3.X3e||Array.add(A,
CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<A.length&&Array.add(this.F7e,A)}}Object(h.a)(bc,"ReactRenameDisabledDialogBase",Ka.StandardDialog,[]);class Mc extends bc{constructor(A,W,oa,xa,Ia){super(A,W,oa,xa,Ia)}zdl(){this.jIb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(h.a)(Mc,"ReactRenameDisabledDialog",bc,[]);var mb=d(80);class Wa{static get hg(){return mb.a.pz(Wa.Fo,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Wa.Fo="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(h.a)(Wa,"RenameDisabledDialogHtml",null,[]);class db extends mb.a{constructor(A,W,oa,xa,Ia){super();this.a3=new Db(A,W,oa);this.yQa=xa;this.$Oa=Ia;this.ig="RenameDisabledDialog";this.Ad=0;this.Le(1,CommonUIStrings.l_DialogClose);this.hg=Wa.hg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.J6("RenameRow")}Hxa(){if(this.a3.k4e){let A;A=this.yQa?this.$Oa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;db.Muc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),A)}else this.a3.l4e?db.Muc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.DMj()}DMj(){this.a3.Z3e&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.a3.Y3e&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.a3.X3e&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Muc(A,W,oa){A.style.display="none";W.innerText=oa}}Object(h.a)(db,"RenameDisabledDialog",mb.a,[]);var ub=d(47),Lb=d(73);class Kb{constructor(A,W){this.A5a=0;this.Ca=A;this.Cqa=W}initialize(A){if(!this.Ca||!this.Cqa)return!1;this.A5a=A;this.vb();return!0}vb(){this.Ca.ya(ra.a.aOc,Lb.a.frame,Object(n.a)(this,this.aOc,"commitNewDocumentTitle"))}aOc(A,W,oa,xa,Ia){if(1===oa)return this.Ca.processAction(ra.a.renameFile,
1);A=ub.a.mH(this.Cqa.rx);Ia=(0,Ia.getNewDocumentTitle)();Ia.length>this.A5a&&(Ia=Ia.substr(0,this.A5a));if(32!==this.Ca.Ja(ra.a.renameFile,2,Ia))return this.BRb(A),8;this.BRb(Ia);return 32}BRb(A){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(A))}static VC(){return new Kb(L.AFrameworkApplication.Qa,L.AFrameworkApplication.ju)}}Object(h.a)(Kb,"ReactRenameUIHandler",null,[862]);var uc=d(267),Yb=d(683),Tc=d(583),sc=d(67),Qb=d(183),kb=d(282),Ib=d(141),eb=d(65);class Rb{constructor(A,W,
oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd){this._initialized=!1;this._element=null;this.A5a=0;this.lPd=this.CHd=!1;this.Ca=A;this.JCd=W;this.Wg=oa;this.bA=xa;this.Cqa=Ia;this.euf=qb;this.KGc=Hb;this.GDd=hc;this.Nqa=Jc;this.cmf=ld;this.oj=wd;this.zId=Bd}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(A,W,oa){if(!(this.Ca&&this.Cqa&&this.euf&&this.KGc&&this.GDd&&W)||0>=A)return!1;this._element=W;this._element.title=oa;this._element.setAttribute(Ib.a.hf,Ib.a.Ou);this._element.setAttribute("Unselectable",
"on");this.A5a=A;this.rP();return this._initialized=!0}rP(){this.JCd&&(this.JCd.ub(sc.a.blur,this._element,Object(n.a)(this,this.onBlur,"onBlur")),this.JCd.ub(sc.a.paste,this._element,Object(n.a)(this,this.jKk,"onPaste")));this.Wg.ub(sc.a.Df,this._element,Object(n.a)(this,this.onKeyDown,"onKeyDown"));this.bA.ub(sc.a.pointerDown,this._element,Object(n.a)(this,this.Aib,"onPointerDown"));this.bA.ub(sc.a.aS,this._element,Object(n.a)(this,this.qOe,"onPointerUp"))}onBlur(){this.isActive&&!this.CHd&&(this.cmf||
this.GDd(this._element),this.gOf(),this.J3d(!1));return this.CHd=!1}jKk(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(A){return this.isActive?this.NIk(A):this.OIk(A)}NIk(A){let W=!1;switch(A.nc.keyCode){case Sys.UI.Key.enter:this.gOf();this.J3d(this.oj||this.zId);W=!0;break;case Sys.UI.Key.tab:this.cmf&&this.GDd(this._element);break;case Sys.UI.Key.esc:this.NYe(),this.J3d(this.oj||this.zId),W=!0}return W}OIk(A){let W=!1;switch(A.nc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.KMh(this.zId),
this.isActive&&this.KGc(this._element),W=!0}return W}Aib(){this.isActive||(this.KMh(!1),this.isActive&&(this._element.focus(),this.KGc(this._element),this.lPd=!0));return!1}qOe(){return this.lPd?(this.KGc(this._element),this.lPd=!1,!0):!1}RBb(){return 32===this.Ca.processAction(ra.a.renameFile,1)}gOf(){const A=ub.a.mH(this.Cqa.rx);let W=this._element.innerText.trim();W.length>this.A5a&&(W=W.substr(0,this.A5a));W!==A&&""!==W?32!==this.Ca.Ja(ra.a.renameFile,2,W)?this.NYe():this.BRb(W):this.NYe()}NYe(){this.BRb(ub.a.mH(this.Cqa.rx))}BRb(A){this._initialized&&
(this._element.innerText=A,this.euf())}KMh(A){this.RBb()?this.isActive||(A&&(this.CHd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ib.a.hf,Ib.a.dFf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,uc.CuiHelper.JXf),this.Nqa&&this.Nqa.execute(W=>{W.anh(!0)}),A&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(ra.a.kPb,
2)}J3d(A){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ib.a.hf,Ib.a.Ou);Sys.UI.DomElement.removeCssClass(this._element,uc.CuiHelper.JXf);this.Nqa&&this.Nqa.execute(W=>{W.anh(!1)});A&&(this._element.blur(),this._element.focus())}static c1a(){Yb.a.c1a(L.AFrameworkApplication.isRtl)}static VC(){return new Rb(L.AFrameworkApplication.Qa,Tc.a.instance,Qb.KeyInputManager.instance,kb.a.instance,L.AFrameworkApplication.ju,Rb.c1a,
eb.a.Ykl,eb.a.CMf,H.a.instance.Ia("Common.App.Header.HeaderEventSource"),Y.a.bG,Y.a.Yi,Y.a.mg)}}Object(h.a)(Rb,"RenameUIHandler",null,[862]);class pc{static get instance(){return L.AFrameworkApplication.Aa.mb.uO?pc.La||(pc.La=Kb.VC()):pc.La||(pc.La=Rb.VC())}}pc.La=null;Object(h.a)(pc,"RenameUIHandlerFactory",null,[]);class Wc{constructor(){this.qLe=this.UBk=this.ETi=null}}Object(h.a)(Wc,"RenameMruEntryProperties",null,[]);var Ic=d(178),nd=d(127),ob=d(444),$b;(function(A){A[A.unknown=-1]="unknown";
A[A.success=0]="success";A[A.renameInvalidFileName=1]="renameInvalidFileName";A[A.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";A[A.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";A[A.permissionDenied=4]="permissionDenied";A[A.serverCommunicationFailure=5]="serverCommunicationFailure";A[A.fileNameTooLong=6]="fileNameTooLong"})($b||($b={}));Object(h.b)("CommonOperationResult",$b);class Hc{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd){this.omf=A;this.Ca=W;this.Lha=oa;this.wF=
xa;this.q5a=Ia;this.cci=qb;this.yQa=Hb;this.Vwf=hc;this.y8h=Jc;this.$Oa=ld;this.Ma=wd;this.x8h=Bd}vb(){L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.uO||this.un.ya(ra.a.hac,Lb.a.frame,Object(n.a)(this,this.hac,"initializeRenameUIHandler"));this.un.ya(ra.a.kPb,Lb.a.frame,Object(n.a)(this,this.kPb,"showRenameDisabledDialog"));this.un.ya(ra.a.renameFile,Lb.a.frame,Object(n.a)(this,this.renameFile,"renameFile"));this.un.ra(ra.a.fileNameUpdate,Lb.a.frame,Object(n.a)(this,this.A6k,"refreshFilename"),
64);this.un.ra(ra.a.Rhd,Lb.a.frame,Object(n.a)(this,this.Rhd,"moveToFolderCompleteByHost"),64);this.un.ya(ra.a.$hb,Lb.a.frame,Object(n.a)(this,this.$hb,"moveToFolder"));(L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||L.AFrameworkApplication.Aa&&(L.AFrameworkApplication.fa.ka("PostMessageEmbedded")||L.AFrameworkApplication.fa.ka("IsJsApi"))&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&L.AFrameworkApplication.QT().execute(A=>{A.Nu(nd.a.f7g);A.fC(nd.a.f7g,Hc.H4k);A.Nu(nd.a.u8d);A.fC(nd.a.u8d,Hc.F4k)})}RBb(){return 0===this.x8h.acg()?32:8}KWl(){return this.oz?this.yQa?this.oz.x5d:this.oz.Lta:!0}hac(){return pc.instance.initialize(L.AFrameworkApplication.pTc,L.AFrameworkApplication.tRc,L.AFrameworkApplication.Xrh||CommonUIStrings.l_RenameFileTooltip)?32:8}kPb(){const A=this.KWl(),W=this.cci();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.q5a,W,A,this.yQa);L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.gD&&L.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new Mc(this.q5a,!W,!A,this.yQa,this.$Oa()):new db(this.q5a,!W,!A,this.yQa,this.$Oa());return 32}renameFile(A,W,oa,xa,Ia){if(1===oa)return this.RBb();if(!L.AFrameworkApplication.X9a)return 8;if(8===this.RBb())return this.un.processAction(ra.a.kPb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");L.AFrameworkApplication.X9a(Ia,Object(n.a)(this,
this.Enc,"onRenameFileSuccess"),Object(n.a)(this,this.aLk,"onRenameFileFailure"));L.AFrameworkApplication.adl=!0;return 32}Enc(A,W){A?0!==A.OperationResult?this.Tgg(A.OperationResult):(this.hml(W,A.NewName),this.KRl(A,Object(n.a)(L.AFrameworkApplication.Aa.mb,L.AFrameworkApplication.Aa.mb.NQh,"updateOpenInClientDocumentUrl")),L.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&L.AFrameworkApplication.Aa.updateCommandUI(),this.y8h.lPh()):this.Tgg(5)}hml(A,W){const oa={};oa[Ic.a.e7i]=
W;A.sendMessage(nd.a.u8d,oa)}KRl(A,W){this.VRl(A);L.AFrameworkApplication.OQc=A.DirectInvokeDavUrl;W=W(A.EditDocInClientUrl);const oa=new Wc;oa.qLe=this.wF.rx;oa.ETi=W;oa.UBk=A.EditDocInClientUrl;this.un.Ja(ra.a.Yrh,2,oa)}Tgg(A){switch(A){case 1:A=new Ka.StandardDialog,A.Ad=0,A.zP(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.muh()}}VRl(A){this.wF.rx=Hc.hoi(this.wF.rx,A.NewName);A.BreadcrumbFolderName&&(this.wF.breadcrumbFolderName=A.BreadcrumbFolderName);
A.BreadcrumbFolderUrl&&(this.wF.breadcrumbFolderUrl=A.BreadcrumbFolderUrl);this.Vwf(A.NewName)}aLk(A){const W=new Ka.StandardDialog;W.Ad=0;switch(A){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");W.dmb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");W.dmb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:A}),W.dmb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}L.AFrameworkApplication.QT().execute(oa=>{oa.sendMessage(nd.a.d7i,{["FailureMessage"]:$b[A]})});this.muh()}A6k(A,W,oa){if(1===oa)return this.RBb();if(!L.AFrameworkApplication.ota)return 8;L.AFrameworkApplication.ota(Object(n.a)(this,this.uJb,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Jkd,"onRefreshFilenameFailure"),
!1);return 32}$hb(A,W,oa,xa,Ia){if(1===oa)return L.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===oa){const qb={};A=L.AFrameworkApplication.cdb;W=L.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");A=(!A||A&&W)&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);qb[Ic.a.mHl]=A;Ia&&Ia.MoveButtonClickedTime&&(qb[Ic.a.WAk]=Ia.MoveButtonClickedTime.getTime());L.AFrameworkApplication.QT().execute(Hb=>{Hb.sendMessage(nd.a.$hb,
qb)});Ia&&Ia.MoveButtonClickedTime&&((A=N.a.fA())&&A.set("MovePostDuration",((new Date).getTime()-Ia.MoveButtonClickedTime.getTime()).toString()),B.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",A));return 32}return 8}Rhd(A,W,oa,xa,Ia){if(1===oa)return L.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.RBb():8;if(2===oa){if(!L.AFrameworkApplication.ctc)return B.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;
if(!Ia)return B.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Ia[Ic.a.ZYj])if(Ia[Ic.a.MRh])if(A=Ia[Ic.a.MRh].toLowerCase(),W=L.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),oa=L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),W&&L.AFrameworkApplication.cdb&&oa){const qb={};qb[Ic.a.XLb]="1";qb[Ic.a.documentUrl]=A;qb[Ic.a.reason]=ob.a.QZe;B.Health.instance.recordKpiSuccess("MoveToFolder",null);L.AFrameworkApplication.QT().execute(Hb=>
{Hb.sendMessage(nd.a.YDa,qb)})}else if(!L.AFrameworkApplication.cdb&&oa)B.Health.instance.recordKpiSuccess("MoveToFolder",null),eb.a.In(A,eb.a.Nba(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return B.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else B.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else L.AFrameworkApplication.ota(Object(n.a)(this,this.uJb,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Jkd,"onRefreshFilenameFailure"),
!1),L.AFrameworkApplication.ctc(),B.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}hzl(A,W){return A&&W?A!==this.wF.breadcrumbFolderName||W!==this.wF.breadcrumbFolderUrl:!1}uJb(A,W){A&&(A.NewName!==ub.a.mH(this.wF.rx)||this.hzl(A.BreadcrumbFolderName,A.BreadcrumbFolderUrl))&&this.Enc(A,W)}Jkd(){}muh(){this.Vwf(ub.a.mH(this.wF.rx))}get un(){return this.Ca.value}get oz(){return this.Lha.value}static get instance(){return Hc.La||(Hc.La=Hc.J$a())}static J$a(){return new Hc(L.AFrameworkApplication.ucc,
new rc.a(()=>L.AFrameworkApplication.Qa),new rc.a(()=>L.AFrameworkApplication.oz),L.AFrameworkApplication.ju,L.AFrameworkApplication.dR,()=>L.AFrameworkApplication.Vxc,L.AFrameworkApplication.Qrc,Object(n.a)(pc.instance,pc.instance.BRb,"updateTitle"),H.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>L.AFrameworkApplication.iU,L.AFrameworkApplication.fa,H.a.instance.resolve("Common.IRenameProps"))}static hoi(A,W){A=ub.a.IQ(A);return W+A}static H4k(A){const W=A.Values[Ic.a.G2j];e.ULS.sendTraceTag(560820289,
204,50,"Host_MoveToFolder Received IsSuccessful: {0}",W);W?L.AFrameworkApplication.Qa.Ja(ra.a.Rhd,2,A.Values):B.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static F4k(A){L.AFrameworkApplication.Qa.Ja(ra.a.renameFile,2,A.Values.NewName)}}Hc.La=null;Object(h.a)(Hc,"RenameActor",null,[]);var Pb=d(396),Yc=d(667),Rd=d(604),Gb=d(205);class Bb{constructor(A,W){this.Ca=A;this.LEd=W}vb(){this.Ca.ya(ra.a.f4e,Lb.a.frame,Object(n.a)(this,this.JBl,"showRenameDialogAction"))}JBl(A,
W,oa){A=32;if(1===oa)return Gb.SessionStatusManager.instance.jla||L.AFrameworkApplication.$Q?8:32;2===oa&&(32!==this.Ca.processAction(ra.a.renameFile,1)?(this.Ca.processAction(ra.a.kPb,2),Pb.a.instance.Yb(Yc.a.vka,{["Reason"]:Rd.a.$cl}),A=8):32===this.Ca.processAction(ra.a.Luc,1)?this.Ca.processAction(ra.a.Luc,2):this.LEd.value.create().Rga());return A}}Object(h.a)(Bb,"RenameDialogActor",null,[840]);class dc{constructor(A,W,oa){this.dialog=null;this.Ca=A;this.wF=W;this.zOa=oa}atj(){const A={};A.nameInputProps=
{["type"]:"AppInputProps",["id"]:dc.zwb,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:ub.a.mH(this.wF.rx),["maxLength"]:this.zOa};return A}Rga(){const A={["id"]:"RenameDialog",["bodyControls"]:this.atj()};this.dialog=new mb.a(!1,!1,!0);this.dialog.Ad=1;this.dialog.ig="RenameDialog";this.dialog.sj(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.BXe,"renameDialogHandler"),A)}BXe(A,W){if(W&&1===A){if(W[dc.zwb]&&(A=ub.a.mH(this.wF.rx),W=(W[dc.zwb]||"").trim(),W!==A&&""!==W)){this.Ca.Ja(ra.a.renameFile,
2,W);return}Pb.a.instance.Yb(Yc.a.Z4b,{["Reason"]:Rd.a.D1f})}}}dc.zwb="txtDocumentName";Object(h.a)(dc,"ReactRenameDialog",null,[866]);class Xc{static get hg(){return mb.a.pz(Xc.Fo,CommonUIStrings.l_RenameDialogLabel)}}Xc.Fo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(Xc,"RenameDialogHtml",null,[]);class Fb extends mb.a{constructor(A,
W,oa){super();this.Ca=A;this.wF=W;this.zOa=oa;this.ig="RenameDialog";this.hg=Xc.hg}Rga(){var A={["txtDocumentName"]:ub.a.mH(this.wF.rx)};this.sj(CommonUIStrings.l_RenameDialogTitle,Object(n.a)(this,this.BXe,"renameDialogHandler"),A);A=document.getElementById(Fb.zwb);0<this.zOa&&(A.maxLength=this.zOa);A.focus()}BXe(A,W){if(1===A&&(A=ub.a.mH(this.wF.rx),W=(W[Fb.zwb]||"").trim(),W!==A&&""!==W)){this.Ca.Ja(ra.a.renameFile,2,W);return}Pb.a.instance.Yb(Yc.a.Z4b,{["Reason"]:Rd.a.D1f})}}Fb.zwb="txtDocumentName";
Object(h.a)(Fb,"RenameDialog",mb.a,[866]);class kd{constructor(A){this.Cqa=null;this.zOa=0;this.Ca=A;this._initialized=!1}initialize(A,W){this.Cqa=A;this.zOa=W;this._initialized=!0}create(){return this._initialized?L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.gD&&L.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new dc(this.Ca,this.Cqa,this.zOa):new Fb(this.Ca,this.Cqa,this.zOa):null}}Object(h.a)(kd,"RenameDialogFactory",null,[837]);var od=d(120),Gd=d(93),Fd=d(69),ee=d(82),
Bf=d(135);class be{constructor(A,W){this.Ca=A;this.Pd=W}vb(){this.Ca.ya(ra.a.Luc,Lb.a.frame,Object(n.a)(this,this.KBl,"showRenameFlyoutAction"))}bAi(){return Fd.d("setDocumentTitleFlyoutOpened")&&L.AFrameworkApplication.Aa.mb.uO}KBl(A,W,oa){if(1===oa)return this.bAi()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}Ggi(){be.f7j&&L.AFrameworkApplication.Xua&&Bf.a.instance.Hb(new ee.a(5,1,5E3,()=>{32===this.Ca.processAction(ra.a.Luc,1)&&this.Pd&&this.Pd.Ee.name===
od.AFrame.SW&&(Gd.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Ca.processAction(ra.a.Luc,2))}))}static get f7j(){be.pDc&&null!=be.pDc||(L.AFrameworkApplication.Oea("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),be.pDc=L.AFrameworkApplication.fa?L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return be.pDc}}be.pDc=null;Object(h.a)(be,"RenameFlyoutActor",null,[836]);class af{constructor(A,
W,oa,xa,Ia){this.Q_d=null;this.Lha=Ia;this.pmf=oa;this.omf=xa;this.eci=A;this.$Oa=W}get oz(){return this.Lha.value}acg(){if(!this.omf())return 5;if(this.$Oa())return 1;if(this.oz){if(this.pmf&&!this.oz.x5d)return 3;if(!this.pmf&&!this.oz.Lta)return 4}return this.eci()?0:2}}Object(h.a)(af,"RenameProps",null,[835]);var Ue=d(72);class qf{constructor(A,W,oa,xa,Ia,qb){this.kB=!1;this.jKd=new Ue.a;this.spb=W;this.BAc=oa;this.Pzc=xa;this.Ma=Ia;this.Pia=qb}enable(){this.kB||(this.lPh(),this.z5e(),this.kB=
!0)}generateKey(A,W,oa){return String.format("{0}/{1}/{2}",oa,A,W)}Rmj(){const A=ub.a.mH(this.spb().rx);return this.generateKey(this.spb().breadcrumbFolderName,this.spb().breadcrumbFolderUrl,A)}Smj(A,W,oa){return A&&W?this.generateKey(A,W,oa):oa}BXi(A,W,oa){return A&&A!==this.spb().breadcrumbFolderName||W&&W!==this.spb().breadcrumbFolderUrl?!0:oa!==ub.a.mH(this.spb().rx)}lPh(){const A=this.Rmj();this.jKd.$(A,new Date)}tQe(A){this.Nxl(A)&&this.gyf(A)}Nxl(A){const W=this.Pzc();return W?this.Pia&&this.Pia.Gcb||
!W.Voe||!L.AFrameworkApplication.ota?(this.VHh(A),this.kB=!1):!0:!1}aeh(A,W,oa,xa){const Ia=this.BXi(A,W,oa);A=this.Smj(A,W,oa);W=this.jKd.vg(A).returnValue;Ia&&!W&&(this.Wgg(xa),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.pva));Ia||this.jKd.$(A,this.BAc())}}Object(h.a)(qf,"ARenamedFileChecker",null,[795]);class Xa extends qf{constructor(A,W,oa,xa,Ia,qb,Hb,hc){super(A,W,oa,xa,Ia,qb);this.Nsf=Ia;this.w8h=Hb;this.rHd=hc}get pva(){return"RenamedFileCheckerUsingSettingsRefresh"}z5e(){this.Nsf.CUd(Object(n.a)(this,
this.Zhg,"handleSettingsRefresh"))}Zhg(A,W){W&&W.Gmc&&W.eEk&&(W.bCb("BreadcrumbDocName")||W.bCb("BreadcrumbFolderName")||W.bCb("BreadcrumbFolderUrl")||W.bCb("DirectInvokeDAVUrl")||W.bCb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.pva),this.tQe(W))}VHh(){this.Nsf.wrh(Object(n.a)(this,this.Zhg,"handleSettingsRefresh"))}gyf(A){if(A&&A.Gmc){const W=A.Gmc;this.aeh(W.Ha("BreadcrumbFolderName"),W.Ha("BreadcrumbFolderUrl"),W.Ha("BreadcrumbDocName"),A)}}Wgg(A){const W=
{OperationResult:0,classId:1};A=A.Gmc;W.BreadcrumbFolderName=A.Ha("BreadcrumbFolderName");W.BreadcrumbFolderUrl=A.Ha("BreadcrumbFolderUrl");W.DirectInvokeDavUrl=A.Ha("DirectInvokeDAVUrl");W.EditDocInClientUrl=A.Ha("EditDocInClientUrl");A=A.Ha("BreadcrumbDocName");W.NewName=L.AFrameworkApplication.oRc?A:ub.a.mH(A);this.rHd.execute(oa=>{this.AVj(W,oa)})}AVj(A,W){this.w8h().Enc(A,W)}}Object(h.a)(Xa,"RenamedFileCheckerUsingSettingsRefresh",qf,[]);class vb extends qf{constructor(A,W,oa,xa,Ia,qb,Hb,hc,
Jc,ld){super(A,oa,xa,Ia,qb,Jc);this.qYb=this.IIc=null;this.j7h=W;this.Ca=Hb;this.ae=hc;ld&&ld.execute(wd=>{this.t9k(wd)})}get pva(){return"RenamedFileCheckerUsingTask"}t9k(A){this.IIc=A;this.IIc.YJc(Object(n.a)(this,this.c$b,"handleVisibilityChange"))}c$b(A,W){!this.kB||0!==W.newState&&1!==W.newState||this.qYb||(this.z5e(),this.tQe(this.qYb))}z5e(){this.qYb=new ee.a(3,2,this.j7h(),Object(n.a)(this,this.tQe,"performRenameFileCheckTick"),89);this.ae.Hb(this.qYb)}VHh(A){this.ae.Kg(A)}gyf(A){this.IIc&&
2===this.IIc.I7a?this.A$k(A):L.AFrameworkApplication.ota(Object(n.a)(this,this.uJb,"onRefreshFilenameSuccess"),Object(n.a)(this,this.Jkd,"onRefreshFilenameFailure"),!0)}A$k(A){this.ae.Kg(A);this.qYb=null}uJb(A){A&&this.aeh(A.BreadcrumbFolderName,A.BreadcrumbFolderUrl,A.NewName,null)}Wgg(){this.Ca.processAction(ra.a.fileNameUpdate,2)}Jkd(){}}Object(h.a)(vb,"RenamedFileCheckerUsingTask",qf,[]);var cc=d(96);class wc{constructor(){this.Ma=this.Ea=null}get name(){return"Common.App.RenameFile"}Xb(A){this.Ea=
A;this.Ma=L.AFrameworkApplication.fa;this.Ea.register(Bb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").oa(()=>new Bb(L.AFrameworkApplication.Qa,this.Ea.ue("Common.App.Rename.IRenameDialogFactory"))).na();this.Ea.register(kd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").oa(()=>new kd(L.AFrameworkApplication.Qa)).na();this.Ea.register(795,"Common.App.Rename.IRenamedFileChecker").oa(()=>this.SQi()).na();this.Ea.register(be,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").oa(()=>
new be(L.AFrameworkApplication.Qa,cc.FocusManager.instance())).na()}SQi(){if(this.Ma.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const A=this.Ea.rb("Common.IRefreshableAppSettings");if(A&&A.D5j)return new Xa(()=>A.uc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>L.AFrameworkApplication.ju,()=>new Date,()=>L.AFrameworkApplication.oz,A,this.Ea.rb("Common.ISessionStatus"),()=>Hc.instance,this.Ea.Ia("Postmessage.IHostPostmessenger"))}return new vb(()=>this.Ma.uc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Ma.uc("RenamedFileCheckerPingIntervalInMs",12E4),()=>L.AFrameworkApplication.ju,()=>new Date,()=>L.AFrameworkApplication.oz,L.AFrameworkApplication.fa,L.AFrameworkApplication.Qa,L.AFrameworkApplication.De,this.Ea.rb("Common.ISessionStatus"),this.Ea.Ia("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ma.$e(Object(n.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){const A=L.AFrameworkApplication.Aa.mb.uO;L.AFrameworkApplication.ucc()&&pc.instance.initialize(L.AFrameworkApplication.pTc,
A?null:L.AFrameworkApplication.tRc,A?null:L.AFrameworkApplication.Xrh||CommonUIStrings.l_RenameFileTooltip)&&(this.Ea.register(af,"Common.App.Rename.RenameProps").as("Common.IRenameProps").oa(()=>new af(()=>L.AFrameworkApplication.Vxc,()=>L.AFrameworkApplication.iU,L.AFrameworkApplication.Qrc,L.AFrameworkApplication.ucc,new rc.a(()=>L.AFrameworkApplication.oz))).na(),Hc.instance.vb(),this.Ma.ka("RenameDialogIsEnabled")&&(this.Ea.resolve("Common.App.Rename.RenameDialogFactory").initialize(L.AFrameworkApplication.ju,
L.AFrameworkApplication.pTc),this.Ea.resolve("Common.App.Rename.IRenameDialogActor").vb()),this.Ea.resolve("Common.App.Rename.IRenameFlyoutActor").vb(),L.AFrameworkApplication.Qrc&&this.Ea.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Ea.resolve("Common.App.Rename.IRenameFlyoutActor").Ggi())}dispose(){}}Object(h.a)(wc,"PackageManager",null,[2,3]);const Ad=A=>{try{return C.a(A)}catch(W){}return null};class Md{constructor(A,W,oa,xa,Ia,qb){this.X2=!1;this.SS=null;this.kNd=!1;this.Ca=
A;this.ji=W;this.Lha=oa;this.Ynf=xa;this.Ma=Ia;this.u4h=qb}init(A,W){W&&A.Ia("Common.Interface.IRtcBasicProvider").execute(Object(n.a)(this,this.kXd,"awaitRtc"))}kXd(A){const W=A.LM.task;W.continueWith(()=>{this.SS=W.result;this.kNd&&(this.SS.bba(2,null,!0),this.kNd=!1);this.SS.ECa((oa,xa)=>{2===xa.type&&this.un.processAction(ra.a.fileNameUpdate,2)});this.SS.A7a((oa,xa)=>{2===xa.newState&&this.un.processAction(ra.a.fileNameUpdate,2)});2===this.SS.connectionState&&this.un.processAction(ra.a.fileNameUpdate,
2)})}ota(A){this.L_f(A,!0)}L_f(A,W){const oa=this.Evi(A.PFh),xa={};xa[Md.fPf]=Md.gPf;this.sth.qj(oa,2,"",xa,!1,2,Object(n.a)(this,this.uJb,"onRefreshFilenameSuccess"),W?Object(n.a)(this,this.UKk,"onRefreshFilenameFailureRetry"):Object(n.a)(this,this.Tch,"onRefreshFilenameFailureNoRetry"),A)}uJb(A){this.X2=!1;const W=Ad(A.data.Wd);A.data.state.onSuccess(W,this.Ynf.value)}UKk(A){5!==A.data.status||this.X2?this.Tch(A):(this.X2=!0,this.L_f(A.data.state,!1))}Tch(A){A.data.state.Pz(-1)}X9a(A){this.M_f(A,
!0)}M_f(A,W){const oa=this.Fvi(),xa={};xa[Md.fPf]=Md.gPf;xa[Md.sKj]=ub.a.Ne(A.Bth);xa[Md.qKj]=this.u4h.value.Q_d;this.sth.qj(oa,2,"",xa,!1,2,Object(n.a)(this,this.Enc,"onRenameFileSuccess"),W?Object(n.a)(this,this.bLk,"onRenameFileFailureRetry"):Object(n.a)(this,this.Zch,"onRenameFileFailureNoRetry"),A)}Fvi(){return this.DHf()}Evi(A){let W=this.DHf();return W=D.a.Pi(W,Md.wKj,A?"2":"1")}DHf(){let A=(this.Ma.value.appSettings.RenameWebServiceBase||"")+Md.rKj;A=D.a.Pi(A,Md.tKj,ub.a.Ne(L.AFrameworkApplication.Pg));
this.oz&&this.oz.Voe&&(A=D.a.Pi(A,Md.vKj,"1"));return A}Enc(A){this.X2=!1;const W=Ad(A.data.Wd);A.data.state.onSuccess(W,this.Ynf.value);this.H8g()}H8g(){this.SS?this.SS.bba(2,null,!0):this.kNd=!0}bLk(A){5!==A.data.status||this.X2?this.Zch(A):(this.X2=!0,this.M_f(A.data.state,!1))}Zch(A){A.data.state.Pz(-1)}get un(){return this.Ca.value}get sth(){return this.ji.value}get oz(){return this.Lha.value}static get instance(){return Md.La||(Md.La=Md.J$a())}static J$a(){return new Md(new rc.a(()=>L.AFrameworkApplication.Qa),
new rc.a(()=>L.AFrameworkApplication.Je),new rc.a(()=>L.AFrameworkApplication.oz),new rc.a(()=>H.a.instance.resolve("Postmessage.IHostPostmessenger")),new rc.a(()=>L.AFrameworkApplication.fa),new rc.a(()=>H.a.instance.resolve("Common.IRenameProps")))}}Md.fPf="Content-Type";Md.gPf="application/json; charset=utf-8";Md.rKj="renamehandler.ashx";Md.tKj="qs";Md.sKj="n";Md.vKj="sl";Md.qKj="X-CoauthLockId";Md.wKj="u";Md.La=null;Object(h.a)(Md,"ExecuteRenameFileHandler",null,[]);class Sd{constructor(){this.Pz=
this.onSuccess=null;this.PFh=!1}}Object(h.a)(Sd,"ExecuteRefreshFilenameData",null,[]);class Le{constructor(){this.Pz=this.onSuccess=this.Bth=null}}Object(h.a)(Le,"ExecuteRenameFileData",null,[]);class fe{constructor(){this.Ea=null;this.MFd=Md.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Xb(A){this.Ea=A}init(){L.AFrameworkApplication.fa.$e(Object(n.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){L.AFrameworkApplication.ucc()&&(Md.instance.init(this.Ea,L.AFrameworkApplication.Qrc),
L.AFrameworkApplication.X9a=Object(n.a)(this,this.X9a,"executeRenameFile"),L.AFrameworkApplication.ota=Object(n.a)(this,this.ota,"executeRefreshFilename"),L.AFrameworkApplication.ctc=Object(n.a)(this,this.ctc,"sendFileNameAndLocationUpdateNotification"))}X9a(A,W,oa){const xa=new Le;xa.Bth=A;xa.onSuccess=W;xa.Pz=oa;this.MFd.X9a(xa)}ota(A,W,oa){const xa=new Sd;xa.onSuccess=A;xa.Pz=W;xa.PFh=oa;this.MFd.ota(xa)}ctc(){this.MFd.H8g()}dispose(){}}Object(h.a)(fe,"PackageManager",null,[2,3]);class Vf{constructor(A,
W,oa,xa,Ia,qb){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=A;this.WebAffinitizedUrl=W;this.PolicyCookie=oa;this.PolicyCookieTTL=xa;this.WasServiceDown=Ia;this.AffinitizedUrl=qb}}Object(h.a)(Vf,"SafeLinksData",null,[]);class Cd{constructor(A,W){this.dxd=A;this.Zy=W}}Object(h.a)(Cd,"SafeLinksGetUrlReputationRequestData",null,[]);class Sc{constructor(A,W,oa,xa){this.Ma=A;this.ji=W;
this.c1h=oa;Sc.ki=xa}Fyd(A,W,oa){try{var xa=null;Sc.ki&&(xa=Sc.ki.Ii("WebServiceCall","SafeLinksGetUrlReputation"));const Ia=new Cd(W,xa);xa={};xa.AffinitizedUrl=A;xa.TargetUrl=W;xa.PolicyCookie=oa;const qb=C.c(xa);this.ji.qj(this.c1h,2,qb,null,!1,2,Object(n.a)(this,this.ZHk,"onGetUrlReputationSuccessCallback"),Object(n.a)(this,this.YHk,"onGetUrlReputationFailureCallback"),Ia,void 0,void 0,3E3,3E3,"36");return!0}catch(Ia){e.ULS.sendTraceTag(588788033,378,10,Ia.message)}return!1}ZHk(A){let W="OnGetUrlReputationSuccessCallback: ",
oa=10;const xa=A.data.state;try{const Ia=C.b(A.data.Wd).reputationResults[0],qb=Ia.navigateUrl.length,Hb=xa.dxd.length,hc=Ia.navigateUrl===xa.dxd;Ia.navigateUrl&&0<Ia.navigateUrl.length&&(xa.dxd=Ia.navigateUrl);W+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",A.data.Oe,Ia.verdict,Hb.toString(),qb.toString(),hc.toString());oa=50}catch(Ia){W+=String.format("Exception {0}",Ia.message)}this.ahg(xa,W,oa)}YHk(A){let W="OnGetUrlReputationFailureCallback: ";
const oa=A.data.state;try{W+=String.format("HttpStatus {0}",A.data.Oe)}catch(xa){W+=String.format("Exception {0}",xa.message)}this.ahg(oa,W,10)}ahg(A,W,oa){A.Zy&&(A.Zy.stop(),A.Zy=null);e.ULS.sendTraceTag(588788034,378,oa,W);eb.a.In(A.dxd,void 0,"noopener,noreferrer","SafeLinksNav")}}Sc.ki=null;Object(h.a)(Sc,"SafeLinksNavigationHelper",null,[]);var jg;(function(A){A[A.enabledByPolicy=0]="enabledByPolicy";A[A.disabledByPolicy=1]="disabledByPolicy";A[A.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";
A[A.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(jg||(jg={}));Object(h.b)("SafeLinksNavigationState",jg);var mg=d(505);class Pa{constructor(A,W,oa,xa=!1,Ia=null,qb=null){this.H4a=this.G4a=0;this.zbc=this.$Bc=!1;this.NPa=null;this.rqb=!0;this.SGc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ma=A;this.ji=W;this.s7=oa;Pa.ki=qb;this.xci=xa?this.Ma.Ha("SafeLinksHandlerWebServiceBase"):this.Ma.Ha("WebServiceBase");this.fci=this.Ma.Ha("SafeLinksHashedUserId");
this.j_l=this.Ma.Ha("SafeLinksWorkloadIdHeaderValue");this.fEc=this.Ma.uc("SafeLinksMaxGetPolicyBootRetries",2);this.gEc=this.Ma.uc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.TCc=this.h6j();this.SCc=this.g6j();Pa.nxf=this.Ma.Ha("UserPrincipalName")||"";Pa.iwf=this.Ma.Ha("TenantId")||"";e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.TCc,this.SCc);if(this.TCc&&this.SCc){W=(A=this.RTa())?A.IsSafeLinksEnabled.toLowerCase():"";oa=this.zqe();
e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",W,oa);var Hb=!A||"unknown"===W||A.WasServiceDown||oa,hc=N.a.fA();hc&&(hc.set("shouldGetSafeLinksDataFromServer",Hb.toString()),hc.set("isSafeLinksEnabledCacheValue",W.toString()));Ia?(this.rqb=!1,Ia.execute(Jc=>{Jc.isFeatureEnabled("MsoUrlreputation",!0).then(ld=>{this.rqb=ld;hc.set("isUserLicensedForSafeLinks",this.rqb.toString());B.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",
hc);this.rqb&&Hb&&this.QXc(!0);return null})})):(B.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",hc),Hb&&this.QXc(!0))}}get appName(){return this.s7}get GAd(){return this.xci}get userId(){return this.fci}get afg(){try{if(""===Pa.IGd){const A={};A["X-AppName"]=this.appName;A["X-AppVersion"]=L.AFrameworkApplication.buildVersion;A.OS=this.Ma.Ha("PlatformNameAndVersion")||"";const W=JSON.stringify(A);Pa.IGd=window.self.btoa(W)}}catch(A){e.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",
A.message)}return Pa.IGd}get Arj(){const A=this.GAd?this.GAd+"/":"",W=new da.QueryStringBuilder("SafeLinksHandler.ashx");W.xg("app",this.appName);this.Ma.ka("SafeLinksUseDebugHeader")&&W.xg("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&W.xg("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&W.xg("s2se03","1");return String.format("{0}{1}&{2}",A,W.toString(),L.AFrameworkApplication.Pg)}get Pzj(){const A=
this.GAd?this.GAd+"/":"",W=new da.QueryStringBuilder("SafeLinksHandler.ashx");W.xg("app",this.appName);this.Ma.ka("SafeLinksUseDebugHeader")&&W.xg("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&W.xg("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&W.xg("s2saat","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&W.xg("s2se03","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",
!1)&&W.xg("sladpar",this.afg);W.xg("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",A,W.toString(),L.AFrameworkApplication.Pg)}get IBk(){Pa.WOd||(Pa.WOd=new Sc(this.Ma,this.ji,this.Pzj,Pa.ki));return Pa.WOd}Fyd(A){if(!A)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var W=this.T0j(A);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
W,this.TCc,this.SCc,this.rqb);if(!(W&&this.TCc&&this.SCc&&this.rqb))return!1;W=0;const oa=({state:W}=this.fzl()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",jg[W]);const xa=N.a.fA();xa&&xa.set("SafeLinksNavigationState",jg[W]);B.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",xa);if(!oa)return 2!==W&&3!==W||B.Health.instance.recordKpiFailure("SafeLinksNavigations",jg[W],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.tzl())return this.zqe()?!1:this.IBk.Fyd(this.kdj(),A,this.vbg());if(!this.zqe())return this.zNh(A),!0;this.NPa=A;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.zbc=!1;this.QXc();return!0}T0j(A){A=A.toLowerCase();const W=this.Ma.ty("SafeLinksUnsupportedProtocols");if(W)for(let oa=0;oa<W.length;oa++)if(A.startsWith(W[oa]))return!1;return!0}QXc(A=!1){var W=N.a.fA();W&&W.set("isOnBootRequest",A.toString());
B.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",W);B.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",W);W=this.F1d("SafeLinksGetPolicy");this.ji.qj(this.Arj,1,null,null,!0,2,Object(n.a)(this,this.Ytj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(n.a)(this,this.Xtj,"getSafeLinksDataFromServer_OnFailureCallback"),W,void 0,void 0,void 0,void 0,"23");this.zbc=A;this.$Bc=!0;A?this.G4a++:this.H4a++}Ytj(A){let W=w.a.KCk,
oa="";try{this.$Bc=this.zbc=!1;var xa=A.data.state;const Bd=({Zy:xa}=this.kwd(xa)).returnValue,de=Object.assign(new ha.a,{durationMs:Bd});B.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",de);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",A.data.Oe,A.data.Wd.length,Bd);if(A.data.Oe!==w.a.mx)oa="Unexpected httpStatus: "+A.data.Oe.toString();else{xa=null;try{xa=C.b(A.data.Wd)}catch(oe){oa="Exception:"+
oe.toString()+" deserializing response";return}if(xa){var Ia=xa.IsSafeLinksEnabled;if(void 0===Ia||null===Ia||0>=Ia.length)oa="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Ia);var qb=Pa.WPe(Ia);if(void 0===xa.WebAffinitizedUrl||null===xa.WebAffinitizedUrl||0>=xa.WebAffinitizedUrl.length)oa="Invalid WebAffinitizedUrl";else if(void 0===xa.PolicyCookie||null===xa.PolicyCookie||0>=xa.PolicyCookie.length)oa="Invalid PolicyCookie";else if(void 0===
xa.PolicyCookieTTL||null===xa.PolicyCookieTTL)oa="Invalid PolicyCookieTTL";else{var Hb=xa.WebAffinitizedUrl,hc=xa.PolicyCookie,Jc=xa.AffinitizedUrl,ld=new Date;ld.setMinutes(ld.getMinutes()+(5<xa.PolicyCookieTTL?xa.PolicyCookieTTL-5:0));var wd=new Vf(Ia,Hb,hc,ld.getTime(),!1,Jc);this.Fyh(wd);W=A.data.Oe;this.NPa&&(qb?(this.zNh(this.NPa),this.H4a=this.G4a=0):(e.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),B.Health.instance.recordKpiFailure("SafeLinksNavigations",
"disabledByPolicy",!0,!0,null),eb.a.aUc(this.NPa)),this.NPa=null)}}}else oa="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Bd){oa="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Bd.toString()}finally{W!==w.a.mx&&this.$gg(W,oa)}}Xtj(A){this.$Bc=!1;let W=500,oa="";try{let xa=A.data.state;const Ia=({Zy:xa}=this.kwd(xa)).returnValue,qb=Object.assign(new ha.a,{durationMs:Ia});W=A.data.Oe;B.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+W.toString(),!1,!0,qb);oa="Request Failed, Status="+mg.a[A.data.status]+" Duration: "+Ia}catch(xa){oa="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+xa.toString()}finally{this.$gg(W,oa)}}$gg(A,W=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",A,W),this.G4a<this.fEc&&this.H4a<this.gEc)this.QXc(this.zbc);else{this.zbc=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.G4a,this.H4a,A,W);W=null;const oa=N.a.fA();oa&&(oa.set("HttpStatus",A.toString()),W=Object.assign(new ha.a,{extendedProperties:oa}));B.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,W);const xa=new Vf("false","","",0,!0,"");this.Fyh(xa);this.NPa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),B.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),eb.a.aUc(this.NPa),this.NPa=null)}}catch(oa){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",oa.toString())}}zNh(A){const W=this.vbg(),oa=this.LAj(),xa={};xa.Url=A;xa.SafeLinksCookie=W;xa.CorrelationId=aa.a.create().toString();xa.WorkloadId=this.j_l;xa.UserAgentInfo=Y.a.mz+"|"+this.appName;this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(xa.User=Pa.nxf,xa.TenantId=Pa.iwf,xa.AdditionalProperties=this.afg);e.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",xa.CorrelationId);eb.a.Xmd(eb.a.Nba(4),oa,xa)}h6j(){const A=this.Ma.Ha("IsSafeLinksEnabledForUser");return A?Pa.WPe(A):!1}g6j(){const A=this.Ma.ty("SafeLinksDisabledBrowsers");if(Y.a.dU){if(this.Ma.gu("SafeLinksForTeamsIsEnabled")&&this.Ma.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(A,"Electron"))return!1}else if(Array.contains(A,Y.a.mz))return!1;return"officecomhwa"===(this.Ma.Ha(L.AFrameworkApplication.yK)||"").toLowerCase()?
!1:!0}tzl(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Y.a.Sbc?!0:Y.a.dU}fzl(){let A;A=0;const W=this.RTa(),oa=W?W.IsSafeLinksEnabled:"";if(""!==oa)return W.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===oa.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:Pa.WPe(oa),state:A};if(this.$Bc)return A=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:A};if(this.G4a>=this.fEc||this.H4a>=this.gEc)return A=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.G4a,this.fEc,this.H4a,this.gEc),{returnValue:!1,state:A};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.fEc+this.gEc-(this.G4a+this.H4a));return{returnValue:!0,state:A}}vbg(){const A=this.RTa();return A?A.PolicyCookie:""}LAj(){const A=this.RTa();return A?A.WebAffinitizedUrl:""}kdj(){const A=this.RTa();return A?A.AffinitizedUrl:""}ikj(){const A=new Date;try{const W=this.RTa();A.setTime(W?W.PolicyCookieTTL:0)}catch(W){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",W)}return A}zqe(){const A=this.ikj();return!!A&&A.getTime()<Date.now()}RTa(){if(!this.SGc){const A=
wa.a.instance.getItem(this.userId);if(!A||""===A)return null;this.SGc=JSON.parse(A)}return this.SGc}Fyh(A){if(void 0===A||null===A)throw Error.argumentNull("safeLinksData");if(void 0===A.IsSafeLinksEnabled||null===A.IsSafeLinksEnabled||0>=A.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.SGc=A;A.WasServiceDown||this.q_l(A)}q_l(A){A=JSON.stringify(A);wa.a.instance.setItem(this.userId,A)}F1d(A){return void 0!==Pa.ki&&null!==Pa.ki?Pa.ki.Ii("WebServiceCall",
A):null}kwd(A){if(void 0!==A&&null!==A){const W=A.er;A.stop();return{returnValue:W,Zy:null}}return{returnValue:null,Zy:A}}static WPe(A){return"false"!==A.toLowerCase()?!0:!1}}Pa.ki=null;Pa.WOd=null;Pa.iwf="";Pa.nxf="";Pa.IGd="";Object(h.a)(Pa,"SafeLinksManager",null,[747]);const bb=A=>{switch(A){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},Fc=A=>{switch(A){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var yd=
d(215);class ge{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}Xb(A){this.K=A}init(){L.AFrameworkApplication.fa.$e(Object(n.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){const A=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),W=A?A.yg:!1;A.pptSafeLinksIsEnabled&&(this.K.register(Pa,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").na().oa(()=>new Pa(L.AFrameworkApplication.fa,L.AFrameworkApplication.Je,String.format("{0}-{1}",bb(L.AFrameworkApplication.Aa.mb.Ti),
Fc(L.AFrameworkApplication.Aa.mb.LJa)),W)).na(),this.K.rb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){Za.a.instance.Ac(yd.a(new ge,0))}}Object(h.a)(ge,"SafeLinksPackage",null,[2,3]);var rb=d(354),gf=d(286),Ab=d(1258),fc=d(87),kc=d(29),ud=d(176),zd=d(94),Td=d(1071);class Me{constructor(A,W,oa,xa,Ia,qb){this.SG=A;this._id=W;this.$Ed=xa;this.h_h=Ia;this.i_h=qb;this.LAc=this.bwb;void 0!==oa&&null!==oa&&(this.bwb=oa)}get defaultValue(){return this.LAc}get lcid(){return this.SG}get id(){return this._id}get bwb(){return(this.h_h||
Me.ahf)(this.$Ed)}set bwb(A){(this.i_h||Me.bhf)(this.$Ed,A)}get Yf(){return this.$Ed}static Ar(){Me.ahf=()=>null;Me.bhf=()=>{}}}Me.ahf=null;Me.bhf=null;Object(h.a)(Me,"GrammarSettingOption",null,[1010]);Me.Ar();class tf{constructor(A,W,oa){this.e9d=A;this.j_e=W;this.$Bk=oa}}Object(h.a)(tf,"TwoLevelCacheKey",null,[]);var re=d(35),lh=d(220),ze=d(3);class Je extends mb.a{constructor(A,W,oa,xa){super();this.qOd=this.k8=this.Mif=this.ITb=null;this.Wo=xa;this.iEd=A;this.ig=Je.id;this.n6h=()=>{this.ITb=
oa?fa.a.Vtc(oa):{};this.Mif=oa?fa.a.Vtc(oa):{};const Ia=this.dui(),qb=Je.CNi(Ia,Je.Ssd(Object(n.a)(this,this.BNi,"createCritiqueTypeSettingsTracker"))(Je.cHi(hc=>this.ITb=hc)));qb(oa||{});var Hb=Je.Ssd(Je.ISi())(hc=>hc.cloneNode(!0));Je.DNi(Ia,Je.aNi(Je.WQi(W),Je.ANi(Hb))(oa))(A.toString());this.qOd=this.Hvi();Hb=hc=>{if("click"===hc.type||hc.keyCode===ud.a.jp||hc.keyCode===ud.a.ORb)this.ITb[A.toString()]={},Ia.reset(),Je.qfl(qb)};zd.a.addHandler(this.Q0a,sc.a.click,Hb);zd.a.addHandler(this.Q0a,sc.a.Df,
Hb)};this.hg=""}get Q0a(){return this.qOd}s9j(){var A=Je.HWe(this.ITb),W=Je.HWe(this.Mif);if(!A&&!W)return!1;let oa;try{oa=A?Object(z.a)(Object,A[this.iEd.toString()]):{};var xa=W?Object(z.a)(Object,W[this.iEd.toString()]):{}}catch(Hb){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!oa&&!xa)return!1;oa=oa?oa:{};xa=xa?xa:{};A=String.format("language: {0}",this.iEd.toString());W=!1;for(let Hb in oa){var Ia=Hb,qb=oa[Hb];Ia in xa&&xa[Ia]===qb||(W=!0,A=String.format("{0}, [{1}, {2}]",
A,Ia,qb))}for(let Hb in xa)xa=Hb,xa in oa||(W=!0,A=String.format("{0}, [{1}, default]",A,xa));W&&e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",A);return W}sj(A,W,oa){super.sj(A,W,oa);this.D4k()}YN(A){return A.Bc.id===Je.Ith?!1:super.YN(A)}gll(){this.Wo.Kl().Ihd();this.k8=this.Wo.Kl().Gj.G_}D4k(){this.Wo.Kl().scope.hw(cc.FocusManager.instance().Cra);this.Wo.Kl().scope.hw(cc.FocusManager.instance().Dra);this.Wo.Kl().scope.bindAction(cc.FocusManager.instance().Cra,re.a.G9b);this.Wo.Kl().scope.bindAction(cc.FocusManager.instance().Dra,
re.a.F9b);this.Wo.Kl().scope.bindAction(Qb.KeyInputManager.Va(ud.a.Jba,0),re.a.ZYc);this.Wo.Kl().scope.bindAction(Qb.KeyInputManager.Va(ud.a.wha,0),re.a.YYc);this.Wo.Kl().scope.bindAction(Qb.KeyInputManager.Va(ud.a.CZ,0),re.a.ZYc);this.Wo.Kl().scope.bindAction(Qb.KeyInputManager.Va(ud.a.o7,0),re.a.YYc)}get settings(){return Je.HWe(this.ITb)}Hxa(){super.Hxa();this.n6h()}dui(){const A=Je.Aui(),W=Je.h1b("WACDialogRow",A);this.iQ.insertBefore(W,this.iQ.firstChild);return A}BNi(A){const W=Td.a.merge(null,
A);return oa=>{oa.bwb===(A&&A[oa.lcid]?A[oa.lcid][oa.id]:null)||oa.bwb!==oa.defaultValue?Je.Wag(W,oa.lcid)[oa.id]=oa.bwb:delete Je.Wag(W,oa.lcid)[oa.id];this.k8=this.Tkj(oa.Yf);return W}}Tkj(A){return A?(A=A.getElementsByTagName(Sys.UI.DomElement.containsCssClass(A,Je.qak)?"select":"input"))?A[0]:null:null}dispose(){this.Q0a&&(zd.a.Tph(this.Q0a),this.qOd=null);super.dispose()}Hvi(){const A=document.createElement("input");A.id=Je.Ith;A.type="reset";A.setAttribute("form",Je.j4f);A.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";
A.value=CommonUIStrings.l_ResetAll;const W=Je.h1b("GrammarSettingsDialogResetButtonContainer",A),oa=document.getElementById("WACDialogButtonPanel");oa.parentNode.insertBefore(W,oa);return A}static get $3b(){return"CritiqueType"}static cHi(A){return W=>oa=>A(W(oa))}static Ssd(A){return W=>oa=>W(A(oa))}static HWe(A){const W={};fa.a.forEach(A,(oa,xa)=>{0<lh.a(xa).length&&(W[oa]=xa)},null);return W}static Aui(){const A=document.createElement("form");A.id=Je.j4f;Sys.UI.DomElement.addCssClass(A,"WACDialogList");
Sys.UI.DomElement.addCssClass(A,Je.dTi);return A}static CNi(A,W){const oa=Je.K3k(A,sc.a.change);return xa=>{const Ia=W(xa);oa(qb=>{qb=qb.target.parentNode;Sys.UI.DomElement.containsCssClass(qb,Je.$3b)&&Ia(qb[Je.uFf])})}}static K3k(A,W){let oa=null;return xa=>{oa&&zd.a.removeHandler(A,W,oa);zd.a.addHandler(A,W,xa);oa=xa}}static Wag(A,W){return A[W]=A[W]||{}}static qfl(A){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");A(null)}static WQi(A){let W=null;return oa=>{W=oa;return A.request(Number.parseInvariant(oa)).CWRCo(xa=>
W===oa?xa.result:null,Je.N3d)}}static DNi(A,W){const oa=Je.dej(xa=>Je.gLl(xa.children));return xa=>{const Ia=oa(xa,A);A.innerHTML="";(Ia?ze.Task.ut(Ia):W(xa)).continueWith(qb=>{qb=qb.result;for(let Hb=0;Hb<qb.length;Hb++)A.appendChild(qb[Hb])},Je.N3d)}}static aNi(A,W){return oa=>xa=>A(xa).CWRCo(Ia=>Sa.toArray(Sa.select(Sa.asEnumerable(Ia.result),qb=>W(oa,qb,xa))),Je.N3d)}static gLl(A){const W=[];for(let oa=0;oa<A.length;oa++)W.push(A[oa]);return W}static dej(A){const W={};let oa=null;return(xa,Ia)=>
{oa&&!W[oa]&&(Ia=A(Ia))&&(W[oa]=Ia);oa=xa;return W[xa]}}static ISi(){const A={};return W=>{A[W.e9d]=A[W.e9d]||{};const oa=A[W.e9d];oa[W.j_e]=oa[W.j_e]||W.$Bk();return oa[W.j_e]}}static ANi(A){return(W,oa,xa)=>{const Ia=A(new tf(xa,oa.Id,()=>Je.lui(oa)));Ia.setAttribute("role","group");const qb=Je.JKf+oa.Name;Ia.setAttribute("aria-labelledby",qb);for(const Hb of oa.CritiqueTypeInfoList){const hc=Je.Fbj(xa,Hb,W,A);Ia.appendChild(hc);hc.setAttribute("aria-labelledby",qb)}return Ia}}static Fbj(A,W,oa,
xa){xa=xa(new tf(A,W.Id,()=>W.IsBinaryCritiqueType?Je.jui(W):Je.rvi(W)));A=new Me(A,W.Id,oa&&oa[A]?oa[A][W.Id]:null,xa,W.IsBinaryCritiqueType?Ia=>Ia.children[0].checked:Ia=>Ia.children[1].selectedIndex,W.IsBinaryCritiqueType?(Ia,qb)=>{Ia.children[0].checked=qb}:(Ia,qb)=>{Ia.children[1].selectedIndex=qb});xa[Je.uFf]=A;return xa}static lui(A){A=Je.mui(A.Name);A.className="WACWritingStylesDialogCategoryTitle";return Je.h1b("CritiqueCategory",A)}static jui(A){const W=Je.nui();W.id=A.Id;0<A.DefaultCritiqueValue&&
W.setAttribute("checked","checked");A=Je.qHf(A.Name,A.Id);A.className="WACDialogLabel";const oa=Je.h1b(Je.$3b,W,A);oa.appendChild(W);oa.appendChild(A);return oa}static rvi(A){A=Je.bvi(A.Id,A.Name,Je.wvi(A.CritiqueTypeValues,A.DefaultCritiqueValue),A.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(A,Je.$3b);return A}static wvi(A,W){return Sa.toArray(Sa.Si(Sa.asEnumerable(A||[]),(oa,xa)=>{oa=Je.vvi(oa,xa.toString());xa===W&&oa.setAttribute("selected","selected");return oa}))}static bvi(A,W,oa,xa){W=
Je.qHf(W,A);const Ia=document.createElement("select");Ia.id=A;Ia.className="WACDialogList";oa=oa||[];for(A=0;A<oa.length;A++)Ia.appendChild(oa[A]),xa===A&&(oa[A].selected=!0);return Je.h1b("GrammarSettingsDialogLabeledInlineList",W,Ia)}static vvi(A,W){const oa=document.createElement("option");oa.text=A;oa.value=W;return oa}static nui(){const A=document.createElement("input");A.type="checkbox";A.className="WACDialogCheckBox";return A}static qHf(A,W){const oa=document.createElement("label");oa.innerText=
A;oa.setAttribute("for",W);return oa}static mui(A){const W=document.createElement("div");W.innerText=A;W.id=Je.JKf+A;return W}static h1b(A=null,...W){const oa=document.createElement("div");oa.className=A;for(const xa of W)oa.appendChild(xa);return oa}}Je.id="GrammarSettingsDialog";Je.j4f="CritiqueTypeSettings";Je.dTi="CritiquesList";Je.qak="GrammarSettingsDialogLabeledInlineList";Je.Ith="ResetButton";Je.JKf="WritingStylesCategory_";Je.N3d=11;Je.uFf="CritiqueType";Object(h.a)(Je,"GrammarSettingsDialog",
mb.a,[]);var Wh=d(143),Kg=d(319),pd=d(1163),Nc=d(40),le=d(356),Ye=d(63),Zc=d(155),Jf=d(48),pg=d(910),gd=d(28),bd=d(30);class Ne{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(h.a)(Ne,"EffectDataInfo",null,[]);var rf=d(872);class Fh{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(h.a)(Fh,"AddAnimationInfo",null,[]);class Ae{constructor(){this.TargetEffects=null}}Object(h.a)(Ae,"DeleteAnimationInfo",
null,[]);class Kf{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(h.a)(Kf,"TargetEffect",null,[]);class Mf{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(h.a)(Mf,"ReplaceAnimationInfo",null,[]);class vf{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(h.a)(vf,"ModifyAnimationInfo",null,[]);class eg{constructor(){this.StartType=0;this.TargetEffects=
null}}Object(h.a)(eg,"ChangeAnimationRelationshipInfo",null,[]);var zf=d(317),Nd=d(152),Se=d(90);class Qe{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(h.a)(Qe,"ChangeAnimationBuildTypeInfo",null,[]);class Ei{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(h.a)(Ei,"ReorderAnimationEffectsInfo",null,[]);var Ff=d(33),Jh=d(39),Wf=d(43),md=d(110);const Gf=(bd.a.Ww&65535^bd.a.Ww>>>16)<<16,Hd="SetAnimation SetAnimationDuration SetAnimationDelay AnimationStart MoveAnimationEarlier MoveAnimationLater SetAnimationColorEffect SetAnimationDirection SetAnimationEffectData SetAnimationSequenceAllAtOnce SetAnimationSequenceAsOneObject SetAnimationSequenceByParagraph SetAnimationSequenceOneByOne SetAnimationColor".split(" ");
class Ee{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd,de,oe){this.S6="Existing";this.oMa="ExistingInMenu";this.c5e="AnimationExisting";this.d5e="AnimationExistingInMenu";this.pfa=!1;this.P_a=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;tc=this.pa.Fk();if(!tc||!Pc||!Pc.length)return 8;if(1===id)return 32;id=this.Xka(Pc,tc);v.MenuItems=this.fui(Pc,tc,id);return 32};this.Koa=(Pc,tc,id,ie,v)=>{Pc=v.queryResult;v=v.SourceControlId;ie=tc=-1;v!==this.S6&&({effectType:ie,effectId:tc}=this.vk.ZVc(v));var Z=this.Zj.Iy;
if(!this.pa.Fk())return 8;if(1!==id)return 32;id=this.vk.$Vc(v);var ua=id.label;if(v===this.S6||v===this.oMa)ua=ResourceStrings.L_ExistingButtonDescription;this.E$a(v,id.image,id.label,Pc,ua);let Ra=ua=!1;const fb=0==Z.length?0:Z[0].EffectId,Mb=0==Z.length?0:Z[0].EffectType,xc=!this.vk.dBb(Z);Z=this.vk.pbc(Z);xc||Z||(ua=tc===fb&&ie===Mb,Ra=this.vk.W1c(Mb,fb));v===this.S6?(Ra=this.k_k(this.S6,Pc,Z,Ra,xc,id.image,Mb,fb),Pc.qV(xc||Z||Ra)):v===this.oMa?(Ra=Ee.i_k(Pc,Z,xc,Ra),Pc.qV(xc||Z||Ra)):Pc.qV(ua);
return 32};this.Ww=(Pc,tc,id,ie,v)=>{tc=this.Zj.Iy;var Z=this.pa.Fk();let ua=!0;var Ra=this.getSelectedShapes();if(!Ra||!Ra.length)if(ua=!1,Ra=this.Xka(tc,Z),!Ra||!Ra.length)return Ff.a("StopFalseLoggingSetAnimation")||gd.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;if(!Ee.D6j(Z,Ra)||this.uGa(Ra))return 8;if(1===id)return ie=0<tc.length&&!this.vk.dBb(tc),Z=Ee.B6j(Ra),ie&&Z?8:Pc===bd.a.RNb||Pc===bd.a.s1a?(Ra=0<tc.length&&this.vk.pbc(tc),Z=!1,ie||Ra||(Z=this.vk.W1c(0<
tc.length?tc[0].EffectType:-1,0<tc.length?tc[0].EffectId:-1)),Pc===bd.a.s1a&&(Z=ie?!0:!1),ie||Ra||Z?32:16):Pc===bd.a.ONb?Ee.C6j(Ra)?32:16:32;Pc=v.SourceControlId;if(!Pc)return 8;if(Pc===this.S6||Pc===this.oMa||Pc===this.c5e||Pc===this.d5e)return 32;Pc=this.vk.ZVc(Pc);(tc=Ee.Jdj(Ra,Pc.effectId,Pc.effectType,ua,tc))&&this.IT(Z,tc,!0);ie&&(ie.PC=Pc.effectId,ie.XN=Pc.effectType+100);return 32};this.T6g=(Pc,tc,id)=>{const ie=this.Zj.Iy;tc=this.pa.Fk();if(!tc||!ie||!ie.length)return 8;var v=this.Xka(ie,
tc);if(!v||!v.length)return gd.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),8;if(this.uGa(v))return 8;switch(Pc){case bd.a.imc:Pc=!1;break;case bd.a.jmc:Pc=!0;break;default:return 8}v=this.vk.dpj(tc,ie,Pc);if(1===id)return v.isEnabled?32:8;if(!v.zpd)return gd.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;id=Ee.$_(ie);id=Ee.A2d(id,v.zpd,Pc);this.IT(tc,id,!0);return 32};this.aza=(Pc,tc,id,ie,v)=>{tc=
this.Zj.Iy;Pc=this.pa.Fk();if(!Pc||!tc||!tc.length)return 8;var Z=this.Xka(tc,Pc);if(!Z||!Z.length)return gd.a.J(509677842,800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.uGa(Z))return 8;if(1===id)return 32;id=Nd.Box4ColorHelper.vS(v);if(!id)return gd.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;id=Nd.Box4ColorHelper.Dkb(id,Pc.Fd);if(!id)return gd.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;v=new rf.a;
v.AnimationAction=1;Z=new vf;Z.TargetEffects=Ee.$_(tc);Z.ModifyAnimPropType=3;tc=new Ne;tc.Color=[id.r,id.g,id.b];tc.EffectDataPropType=1;Z.EffectData=tc;v.ModifyAnimationInfo=Z;this.IT(Pc,v,!0);ie&&(ie.XN=1);return 32};this.tTe=()=>{const Pc=this.Zj.Iy;var tc=this.pa.Fk();if(!tc||!Pc||!Pc.length)return 8;tc=this.Xka(Pc,tc);return tc&&tc.length?this.vk.Gzi(tc,this.Ga,Pc)?32:16:(gd.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.q1a=(Pc,tc,id,ie,v)=>
{Pc=this.Zj.Iy;tc=this.pa.Fk();if(!tc||!Pc||!Pc.length)return 8;var Z=this.Xka(Pc,tc);if(!Z||!Z.length)return gd.a.J(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.uGa(Z))return 8;if(1===id)return 32;id=this.vk.U7b(v.MenuItemId);v=new rf.a;v.AnimationAction=1;Z=new vf;Z.TargetEffects=Ee.$_(Pc);Z.ModifyAnimPropType=2;Z.Direction=id;v.ModifyAnimationInfo=Z;this.IT(tc,v,!0);ie&&(ie.XN=1);return 32};this.g0a=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;if(!this.pa.Fk()||
!Pc||!Pc.length)return 8;tc=v.queryResult;v=this.vk.U7b(v.MenuItemId);Ee.oWj(Pc)&&tc.If(Pc[0].Direction===v);return 32};this.GLa=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;tc=this.pa.Fk();if(!tc||!Pc||!Pc.length)return 8;var Z=this.Xka(Pc,tc);if(!Z||!Z.length)return gd.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.uGa(Z))return 8;if(1===id)return 32;id=v.MenuItemId;v=new rf.a;v.AnimationAction=5;Z=new Qe;Z.TargetEffects=Ee.$_(Pc);Z.BuildType=Ee.Nej(id);
v.ChangeAnimationBuildTypeInfo=Z;this.IT(tc,v,!0);ie&&(ie.XN=1);return 32};this.Loa=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;if(!this.pa.Fk()||!Pc||!Pc.length)return 8;tc=v.queryResult;v=this.vk.cee(v.MenuItemId);Ee.mWj(Pc)&&tc.If(Pc[0].BuildType===v);return 32};this.r1a=(Pc,tc,id,ie,v)=>{tc=this.Zj.Iy;Pc=this.pa.Fk();if(!Pc||!tc||!tc.length)return 8;var Z=this.Xka(tc,Pc);if(!Z||!Z.length)return gd.a.J(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.uGa(Z))return 8;
if(1===id)return 32;Z=v.MenuItemId;id=new rf.a;id.AnimationAction=1;v=new vf;v.TargetEffects=Ee.$_(tc);v.ModifyAnimPropType=3;tc=this.Bjj(Z);if(!tc)return gd.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;v.EffectData=tc;id.ModifyAnimationInfo=v;this.IT(Pc,id,!0);ie&&(ie.XN=1);return 32};this.h0a=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;if(!this.pa.Fk()||!Pc||!Pc.length)return 8;v.queryResult.If(this.vk.kOf(Ee.Cjj(Pc[0].EffectData),v.MenuItemId));return 32};this.Jnl=
(Pc,tc,id,ie,v)=>{tc=this.Zj.Iy;Pc=this.pa.Fk();if(!Pc||!tc||!tc.length)return 8;ie=this.Xka(tc,Pc);if(!ie||!ie.length)return gd.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.uGa(ie))return 8;if(1===id)return 32;id=v.CommandValueId;if(!id||!id.trim().length)return gd.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;id=Ee.Nwj(id);if(3==id)return gd.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),
16;for(var Z of tc)Z.StartType=id;Z=Ee.$_(tc);Z=Ee.AQf(Z,id);this.IT(Pc,Z,!1);return 32};this.eLb=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;if(!this.pa.Fk()||!Pc||!Pc.length)return Ee.i0e(v,3),32;tc=Pc[0].StartType;id=!0;for(const Z of Pc)if(tc!=Z.StartType){id=!1;break}id?Ee.i0e(v,tc):Ee.i0e(v,3);return 32};this.Inl=(Pc,tc,id,ie,v)=>{Pc=this.pa.Fk();tc=this.Zj.Iy;if(!Pc||!tc||!tc.length)return 8;ie=this.Xka(tc,Pc);if(!ie||!ie.length)return gd.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),
8;if(this.uGa(ie))return 8;const Z=!this.vk.dBb(tc);if(Ee.Otg(ie)&&Z)return 8;if(1===id)return 32;(id=Math.floor(1E3*v.Number))||(id=10);for(var ua of tc)ua.Duration=id;ua=Ee.$_(tc);ua=Ee.bPc(ua,1,id);this.IT(Pc,ua,!1);return 32};this.NKa=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;if(!this.pa.Fk()||!Pc||!Pc.length)return this.SNb(v,"0.00"),32;tc=Pc[0].Duration;id=!0;for(const Z of Pc)if(tc!=Z.Duration){id=!1;break}id?this.SNb(v,Number(tc/1E3).toFixed(2)):this.SNb(v,"0.01");return 32};this.fJj=(Pc,tc,id)=>1==
id?32:Zc.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.pfa.toString(),Pc,()=>{(this.pfa=!this.pfa)?this.Cuc(!1):this.yjg();return 32});this.$pc=(Pc,tc,id,ie,v)=>{v&&v.If(this.pfa);return 32};this.Cuc=Pc=>{const tc=this.kA();var id=Object(n.a)(this,this.LCj,"applyAnimationAction");tc.onAnimationAction=id;id=Object(n.a)(this,this.NCj,"handleAnimationSelectionChangeFromPane");tc.onSelectionChange=id;id=this.getSelectedShapes();tc.isAddAnimationButtonDisabled=!id||!id.length;if(id=Ff.a("FixAnimationRibbonBugs")?
this.Zj.ru:this.pa.Fk()){tc.isZeroStateAnimationPane=!id.pFa;var ie=id.yj();ie=id.WUc(ie).sort((Z,ua)=>Z.EffectNodeId-ua.EffectNodeId);tc.animations=this.vk.jkj(ie);tc.selectedAnimationNodeIds=this.Zj.Iy.map(Z=>Z.EffectNodeId);tc.sequencesInfo=this.vk.Muj(id);var v={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:tc.paneWidth,location:2,contentProps:tc,onOpen:()=>{},onClose:()=>{this.pfa=!1},isModernPane:!0};Wh.UISurfaces.Iq().then(Z=>{Pc?this.pfa&&Z.updateTaskPane(Jf.a.ZQa,v):Z.showTaskPane(Jf.a.ZQa,
v);return null}).catch(Z=>{gd.a.J(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",Z.toString())})}else gd.a.J(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.onSelectionChange=()=>{if(this.Zj&&this.Zj.jM){var Pc=this.Zj.ru;Pc?(Pc=Pc.yj())&&Pc.length&&(this.Zj.oRh(),this.pfa&&this.Zj.Vhc&&this.Cuc(!0)):gd.a.J(509145116,800,10,"AnimationActor::onSelectionChange: current active slide is null")}};this.onActiveSlideDomReady=(Pc,tc)=>{tc&&this.Zj&&
((Pc=this.Zj.ru)?(tc=Object(z.a)(116,tc.Ba))&&Pc.Cb!==tc.Cb&&(this.Zj.TUl(tc),this.pfa&&this.Cuc(!0)):gd.a.J(509145115,800,10,"AnimationActor::onActiveSlideDomReady: current active slide is null"))};this.Pxa=(Pc,tc)=>{const id=this.ua.Ba;id&&id.vO&&(Pc=this.Zj.ru)&&id===Pc&&(tc=tc.$w)&&tc.shapeNode&&this.xGa(Pc.Cb,tc.shapeNode)&&this.Zj.xya(this.Zj.jM)};this.kga=(Pc,tc)=>{tc&&this.Zj&&(this.Zj.SUl(tc.Zfa),this.pfa&&(this.Zj.jM||this.yjg()))};this.$g=(Pc,tc)=>{if(tc&&tc.property===Jh.a.wVd&&this.Zj&&
this.Zj.jM){Pc=!1;if(Ff.a("FixAnimationSelectionCachingIssue"))for(var id of Hd){const ie=Wf.a.Zsj(id);if(ie&&0<ie.length){Pc=!0;break}}id=this.Zj.ru;id?this.lc.jg(tc.node)===id&&(this.Zj.DOb(!1),this.Zj.RUl(Pc),this.Zj.DOb(!0),this.pfa&&this.Cuc(!0)):gd.a.J(509145114,800,10,"AnimationActor::onPropertyChanged: current active slide is null")}};this.LCj=Pc=>{if(Ff.a("FixAnimationPaneActionContextNullIssue")){const tc=Wf.a.Jj("SetAnimation",1);tc.$p=!0;switch(Pc.actionType){case 0:Wf.a.qy(tc,()=>{this.sgg()});
break;case 2:Wf.a.qy(tc,()=>{this.Mhg(Pc)});break;case 1:Wf.a.qy(tc,()=>{this.Ngg(Pc)});break;case 3:this.phg(Pc);break;case 4:tc.actionName="AnimationStart";Wf.a.qy(tc,()=>{this.Dgg(Pc)});break;case 5:break;case 6:this.Lhg(Pc);break;default:gd.a.J(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}}else switch(Pc.actionType){case 0:this.sgg();break;case 2:this.Mhg(Pc);break;case 1:this.Ngg(Pc);break;case 3:this.phg(Pc);break;case 4:this.Dgg(Pc);break;
case 5:break;case 6:this.Lhg(Pc);break;default:gd.a.J(508829901,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};this.NCj=Pc=>{const tc=this.pa.Fk();tc&&Pc?(this.Zj.DOb(!1),this.Zj.eka(),this.Zj.QTd(Pc,tc),this.Zj.DOb(!0)):gd.a.J(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.gue=(Pc,tc,id)=>{Pc=[Object.assign(new md.a,{name:"CustomData1",int64:Gf+Pc}),Object.assign(new md.a,{name:"CustomData2",
int64:Gf+tc+100})];Gd.d(bd.a.Ww,!0,void 0,0,30,id,Pc)};this.sgg=()=>{var Pc=Date.now(),tc=this.getSelectedShapes();const id=this.pa.Fk();if(id&&tc&&tc.length){if(tc=Ee.E5f(tc,10,0,!1))this.IT(id,tc,!0),this.eYa&&(Pc=Date.now()-Pc,this.gue(10,0,Pc))}else gd.a.J(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};this.Mhg=Pc=>{var tc=Date.now();if(Pc&&Pc.replaceAnimationInfo){var id=Pc.replaceAnimationInfo.effectId;Pc=Pc.replaceAnimationInfo.effectType;var ie=
this.Zj.Iy,v=this.pa.Fk();if(v&&ie&&ie.length){if(ie=Ee.bcg(ie,id,Pc))this.IT(v,ie,!0),this.eYa&&(tc=Date.now()-tc,this.gue(id,Pc,tc))}else gd.a.J(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else gd.a.J(509642373,800,10,"AnimationActor::applyReplaceAnimation: replace animation info is null")};this.Ngg=Pc=>{var tc=Date.now();if(Pc&&Pc.deleteAnimationInfo){var id=this.pa.Fk();Pc=Pc.deleteAnimationInfo.animationIds;id&&Pc&&Pc.length?(Pc=Ee.eyj(Pc),Pc=Ee.MQf(Pc),
this.IT(id,Pc,!0),this.eYa&&(tc=Date.now()-tc,this.gue(0,0,tc))):gd.a.J(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else gd.a.J(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.kA=()=>({type:"AnimationPaneProps",paneWidth:pg.a,isPreviewAnimationButtonDisabled:!0});this.JRl=()=>{if(this.pfa)return this.Cuc(!0),32};this.yjg=()=>{Wh.UISurfaces.Iq().then(Pc=>{Pc.hideTaskPane(Jf.a.ZQa,2);return null}).catch(Pc=>
{gd.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",Pc.toString())})};this.Hnl=(Pc,tc,id,ie,v)=>{tc=this.Zj.Iy;Pc=this.pa.Fk();if(!Pc||!tc||!tc.length)return 8;ie=this.Xka(tc,Pc);if(!ie||!ie.length)return gd.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.uGa(ie))return 8;const Z=!this.vk.dBb(tc);if(Ee.Otg(ie)&&Z)return 8;if(1===id)return 32;id=Math.floor(1E3*v.Number);for(var ua of tc)ua.Delay=id;ua=Ee.$_(tc);ua=Ee.bPc(ua,
0,id);this.IT(Pc,ua,!1);return 32};this.MKa=(Pc,tc,id,ie,v)=>{Pc=this.Zj.Iy;if(!this.pa.Fk()||!Pc||!Pc.length)return this.SNb(v,"0.00"),32;tc=Pc[0].Delay;id=!0;for(const Z of Pc)if(tc!=Z.Delay){id=!1;break}id?this.SNb(v,Number(tc/1E3).toFixed(2)):this.SNb(v,"0.00");return 32};this.fui=(Pc,tc,id)=>{var ie;const v=new Kg.a;v.Id="AnimationMenuEffectOptions";v.UpdateDynamically=!0;v.Title=ResourceStrings.L_EffectOptions;v.MenuSectionList=[];if(!this.vk.pbc(Pc)){const Z=Pc[0];v.MenuSectionList.push(this.vk.KXc(Z.EffectId,
Z.EffectType,"Direction","2289594085","3782857737"));if(this.vk.Zre(Z))if(v.MenuSectionList.push(le.f(tc.Fd,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),v.MenuSectionList.push(le.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.nWj(Pc)){const ua=null===(ie=Z.EffectData)||void 0===ie?void 0:ie.Color;ie=new Se.a(Se.a.Juh(ua));le.h(v,ie,tc.Fd)}else le.h(v,null,tc.Fd);
v.MenuSectionList.push(this.vk.KXc(Z.EffectId,Z.EffectType,"EffectData","2949363495","4132852551"))}v.MenuSectionList.push(this.vk.Dsj(id,this.Ga,Pc));return v};this.Bjj=Pc=>{let tc=new Ne;const id=this.vk.Vae(Pc);return Pc.toLowerCase().startsWith("spin")?(tc.Degree=parseFloat(id),tc.EffectDataPropType=0,tc):Pc.toLowerCase().startsWith("transparency")?(tc.Transparency=parseFloat(id),tc.EffectDataPropType=2,tc):Pc.toLowerCase().startsWith("growshrink")?(tc.Scale=parseFloat(id),tc.EffectDataPropType=
3,tc):null};this.k_k=(Pc,tc,id,ie,v,Z,ua,Ra)=>{if(v)return!1;if(id)return this.E$a(Pc,Z,ResourceStrings.L_AnimationMultiple,tc,ResourceStrings.L_AnimationMultiple),ie;ie&&(Z=this.vk.iYc(ua,Ra),{image:Z,label:id}=this.vk.$Vc(Z),this.E$a(Pc,Z,id,tc,id));return ie};this.E$a=(Pc,tc,id,ie,v)=>{let Z;Z=Pc===this.S6?"298832323":Pc===this.oMa?"1264919631":"2676673376";tc=tc.substring((Ye.a.Noc+"_").length,tc.length-6);const ua=new pd.a;ua.Id=Pc;ua.ExternalId="Animation"+Pc;ua.Icon=tc;ua.Command=Z;ua.QueryCommand=
"1852964326";ua.LabelText=id;ua.FullIconStyle={root:{width:"32px",height:"32px"}};ua.PreviewIconStyle={root:{width:"24px",height:"24px"}};ua.Alt=v;ie.j4=ua};this.getSelectedShapes=()=>{let Pc=[];const tc=this.pa.Ud();if(!tc)return Pc;for(const id of tc)id.get_smartArtModelId()?Pc.push(this.Ga.Lr(id)):id.Ug?Pc.push(this.Ga.Fs(id)):Pc.push(id);return Pc};this.Xka=(Pc,tc)=>{const id=[];if(!Pc||!Pc.length||!tc)return id;const ie=tc.yj();if(!ie||!ie.length)return id;tc=new Map;for(const v of ie)tc.set(v.id.toString(),
v);for(const v of Pc){Pc=zf.a.Kf(v.ShapeId);Pc=tc.get(Pc.toString());if(!Pc)return[];id.push(Pc)}return id};this.IT=(Pc,tc,id)=>{Wf.a.yk("AnimationCommandType",String(tc.AnimationAction));const ie=this.Fb.yd(15,void 0,()=>{this.pa.nj();id&&this.Fa.Bd()});try{ie.jc(Pc),Pc.isa=tc}finally{ie&&ie.dispose()}};this.uGa=Pc=>{if(!Pc||0==Pc.length)return!1;for(const tc of Pc)if(this.fc.fd(tc))return!0;return!1};this.SNb=(Pc,tc)=>{Pc.queryResult.nba=tc};if(!A)throw Error.argumentNull("actionManager");if(!W)throw Error.argumentNull("selectionManager");
if(!oa)throw Error.argumentNull("focusManager");if(!xa)throw Error.argumentNull("transactionFactory");if(!Ia)throw Error.argumentNull("animationHelper");if(!qb)throw Error.argumentNull("graphActionBlockingManager");if(!Hb)throw Error.argumentNull("shapeReader");if(!hc)throw Error.argumentNull("pathManager");if(!Jc)throw Error.argumentNull("effectSelectionManager");if(!ld)throw Error.argumentNull("viewElementEventHandler");if(!wd)throw Error.argumentNull("graphNodeEventHandlers");if(!Bd)throw Error.argumentNull("viewEventNotifier");
if(!de)throw Error.argumentNull("slideReader");if(!oe)throw Error.argumentNull("graphTopologyManager");this.ia=A;this.pa=W;this.Fa=oa;this.Fb=xa;this.kjc=hc.qk(Ye.a.umd);this.vk=Ia;this.fc=qb;this.Ga=Hb;this.Zj=Jc;this.Ys=ld;this.Ur=wd;this.$d=Bd;this.lc=de;this.ua=oe;this.eYa=Ff.a("AnimationPaneTelemetryEnabled")}vb(){this.ia.ra(bd.a.k0b,Nc.a.application,this.Jnl,4);this.ia.ra(bd.a.eLb,Nc.a.application,this.eLb,97);this.ia.ra(bd.a.QNb,Nc.a.application,this.Inl,4);this.ia.ra(bd.a.NKa,Nc.a.application,
this.NKa,97);this.ia.ra(bd.a.JEh,Nc.a.application,this.fJj,4);this.ia.ra(bd.a.$pc,Nc.a.application,this.$pc,96);this.ia.ra(bd.a.PNb,Nc.a.application,this.Hnl,4);this.ia.ra(bd.a.MKa,Nc.a.application,this.MKa,97);this.ia.ra(bd.a.Koa,Nc.a.application,this.Koa,97);this.ia.ra(bd.a.Ww,Nc.a.application,this.Ww,13);this.ia.ra(bd.a.ONb,Nc.a.application,this.Ww,13);this.ia.ra(bd.a.RNb,Nc.a.application,this.Ww,5);this.ia.ra(bd.a.s1a,Nc.a.application,this.Ww,5);this.ia.ra(bd.a.Snd,Nc.a.application,this.tTe,100);
this.ia.ra(bd.a.q1a,Nc.a.application,this.q1a,13);this.ia.ra(bd.a.g0a,Nc.a.application,this.g0a,97);this.ia.ra(bd.a.r1a,Nc.a.application,this.r1a,12);this.ia.ra(bd.a.h0a,Nc.a.application,this.h0a,96);this.ia.ra(bd.a.ctd,Nc.a.application,this.GLa,13);this.ia.ra(bd.a.dtd,Nc.a.application,this.GLa,13);this.ia.ra(bd.a.etd,Nc.a.application,this.GLa,13);this.ia.ra(bd.a.ftd,Nc.a.application,this.GLa,13);this.ia.ra(bd.a.Loa,Nc.a.application,this.Loa,97);this.ia.ra(bd.a.P_a,Nc.a.application,this.P_a,96);this.ia.ra(bd.a.aza,
Nc.a.application,this.aza,12);this.ia.ra(bd.a.imc,Nc.a.application,this.T6g,4);this.ia.ra(bd.a.jmc,Nc.a.application,this.T6g,4);this.ia.ra(bd.a.hzd,Nc.a.application,this.JRl,4);this.pa.FC(this.onSelectionChange);this.Ys.PUd(this.onSelectionChange);this.Ys.eT(this.onActiveSlideDomReady);this.Ur.gk(this.$g);this.$d.B7a(this.kga);Ff.a("FixMarkersForShapeDeleteAndUndo")&&this.Ys.Zsb(this.Pxa)}me(){}xGa(A,W){return A&&W?A.equals(W.slideId):!1}Dgg(A){var W=Date.now();if(A&&A.changeAnimationRelationshipInfo){var oa=
this.Zj.Iy,xa=this.pa.Fk();xa&&oa&&oa.length?(A=A.changeAnimationRelationshipInfo,oa=Ee.$_(oa),oa=Ee.AQf(oa,A.startType),this.IT(xa,oa,!1),this.eYa&&(W=Date.now()-W,Gd.c(bd.a.k0b,!0,void 0,0,30,W))):gd.a.J(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else gd.a.J(509444174,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}phg(A){const W=Date.now();if(A&&A.modifyAnimationInfo){var oa=
this.Zj.Iy,xa=this.pa.Fk();if(xa&&oa&&oa.length)if(Ff.a("FixAnimationPaneActionContextNullIssue")){var Ia=Wf.a.Jj("SetAnimationDuration",1);0==A.modifyAnimationInfo.modifyAnimationType&&(Ia.actionName="SetAnimationDelay");Ia.$p=!0;Wf.a.qy(Ia,()=>{var qb=Ee.$_(oa);if(qb=Ee.o7f(A.modifyAnimationInfo,qb)){if(this.IT(xa,qb,!1),this.eYa){qb=null;switch(A.modifyAnimationInfo.modifyAnimationType){case 0:qb=bd.a.PNb;break;case 1:qb=bd.a.QNb}if(qb){const Hb=Date.now()-W;Gd.c(qb,!0,void 0,0,30,Hb)}}}else gd.a.J(509444170,
800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")})}else if(Ia=Ee.$_(oa),Ia=Ee.o7f(A.modifyAnimationInfo,Ia)){if(this.IT(xa,Ia,!1),this.eYa){Ia=null;switch(A.modifyAnimationInfo.modifyAnimationType){case 0:Ia=bd.a.PNb;break;case 1:Ia=bd.a.QNb}if(Ia){const qb=Date.now()-W;Gd.c(Ia,!0,void 0,0,30,qb)}}}else gd.a.J(508829900,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed");else gd.a.J(509444171,
800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else gd.a.J(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}Lhg(A){const W=Date.now(),oa=A.reorderAnimationInfo;if(A&&oa){var xa=this.Zj.Iy,Ia=A.reorderAnimationInfo.refAnimationId,qb=this.pa.Fk();if(qb&&xa&&xa.length&&Ia)if(Ff.a("FixAnimationPaneActionContextNullIssue"))A=Wf.a.Jj("MoveAnimationEarlier",1),A.$p=!0,A.actionName=Ia.effectNodeId<xa[0].EffectNodeId?"MoveAnimationEarlier":
"MoveAnimationLater",Wf.a.qy(A,()=>{var Hb=new Kf;Hb.EffectNodeId=Ia.effectNodeId;Hb.ShapeId=Ia.shapeId;const hc=Ee.$_(xa);Hb=Ee.A2d(hc,Hb,oa.isLater);this.IT(qb,Hb,!0);this.eYa&&(Hb=Date.now()-W,Gd.c(Ia.effectNodeId<xa[0].EffectNodeId?bd.a.imc:bd.a.jmc,!0,void 0,0,30,Hb))});else{A=new Kf;A.EffectNodeId=Ia.effectNodeId;A.ShapeId=Ia.shapeId;const Hb=Ee.$_(xa);A=Ee.A2d(Hb,A,oa.isLater);this.IT(qb,A,!0);this.eYa&&(A=Date.now()-W,Gd.c(Ia.effectNodeId<xa[0].EffectNodeId?bd.a.imc:bd.a.jmc,!0,void 0,0,30,
A))}else gd.a.J(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else gd.a.J(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static o7f(A,W){switch(A.modifyAnimationType){case 0:return Ee.bPc(W,0,A.delay);case 1:return Ee.bPc(W,1,A.duration);default:return null}}nWj(A){var W;if(!(A&&A.length&&!this.vk.pbc(A)&&this.vk.Zre(A[0])&&A[0].EffectData&&A[0].EffectData.Color))return!1;const oa=null===(W=A[0].EffectData)||
void 0===W?void 0:W.Color;for(const xa of A){if(!xa.EffectData||!xa.EffectData.Color)return!1;A=xa.EffectData.Color;if(A[0]!=oa[0]||A[1]!=oa[1]||A[2]!=oa[2])return!1}return!0}static AQf(A,W){const oa=new rf.a;oa.AnimationAction=4;const xa=new eg;xa.TargetEffects=A;xa.StartType=W;oa.ChangeAnimationRelationshipInfo=xa;return oa}static bPc(A,W,oa){const xa=new rf.a;xa.AnimationAction=1;const Ia=new vf;Ia.TargetEffects=A;Ia.ModifyAnimPropType=W;1===W?Ia.Duration=oa:Ia.Delay=oa;xa.ModifyAnimationInfo=
Ia;return xa}static A2d(A,W,oa){const xa=new rf.a;xa.AnimationAction=6;const Ia=new Ei;Ia.TargetEffects=A;Ia.IsLater=oa;Ia.RefEffect=W;xa.ReorderAnimationEffectsInfo=Ia;return xa}static i0e(A,W){let oa="";switch(W){case 0:oa=ResourceStrings.l_AnimationStartOptionOnClick;break;case 1:oa=ResourceStrings.l_AnimationStartOptionWithPrevious;break;case 2:oa=ResourceStrings.l_AnimationStartOptionAfterPrevious}A.C_=oa;A.jtc()}}Ee.eyj=A=>{const W=[];if(!A||!A.length)return W;for(const oa of A)A=new Kf,A.EffectNodeId=
oa.effectNodeId,A.ShapeId=oa.shapeId,W.push(A);return W};Ee.Nej=A=>{switch(A){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};Ee.Jdj=(A,W,oa,xa,Ia)=>0==W&&0==oa?Ee.Gij(Ia):xa?Ee.E5f(A,W,oa,!0):Ee.bcg(Ia,W,oa);Ee.bcg=(A,W,oa)=>{let xa=new rf.a;xa.AnimationAction=2;let Ia=new Mf;if(!A||!A.length)return gd.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;Ia.TargetEffects=
Ee.$_(A);Ia.EffectId=W;Ia.EffectType=oa;xa.ReplaceAnimationInfo=Ia;return xa};Ee.Gij=A=>A&&A.length?Ee.MQf(Ee.$_(A)):(gd.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null);Ee.E5f=(A,W,oa,xa)=>{let Ia=new rf.a;Ia.AnimationAction=0;let qb=new Fh;qb.EffectId=W;qb.EffectType=oa;qb.ShapeIds=[];qb.FRemoveExisting=xa;for(const Hb of A)qb.ShapeIds.push(Hb.id.toString());Ia.AddAnimationInfo=qb;return Ia};Ee.MQf=A=>{const W=new rf.a;W.AnimationAction=
3;const oa=new Ae;oa.TargetEffects=A;W.DeleteAnimationInfo=oa;return W};Ee.Nwj=A=>{switch(A.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};Ee.$_=A=>{if(!A||!A.length)return null;const W=[];for(const oa of A)A=new Kf,A.EffectNodeId=oa.EffectNodeId,A.ShapeId=oa.ShapeId,W.push(A);return W};Ee.B6j=A=>{if(!A||0==A.length)return!1;for(const W of A)if(W.D4)return!0;return!1};Ee.Otg=A=>{if(!A||0==A.length)return!1;for(const W of A)if(1===
W.mediaType||2===W.mediaType)return!0;return!1};Ee.D6j=(A,W)=>{if(!A||!W||!W.length)return!1;for(const oa of W)if(oa.mX||oa.nr||Ff.a("FixAnimationRibbonBugs")?0:oa.Pp)return!1;return!0};Ee.C6j=A=>{if(!A||!A.length)return!1;for(const W of A)if(W.xd||W.qr||Ff.a("FixAnimationRibbonBugs")?0:W.Pp)return!1;return!0};Ee.oWj=A=>{if(!A||!A.length)return!1;const W=A[0].Direction;for(let oa=1;oa<A.length;oa++)if(A[oa].Direction!=W)return!1;return!0};Ee.mWj=A=>{if(!A||!A.length)return!1;const W=A[0].BuildType;
for(let oa=1;oa<A.length;oa++)if(A[oa].BuildType!=W)return!1;return!0};Ee.Cjj=A=>{if(!A)return"";switch(A.EffectDataPropType){case 0:return A.Degree.toString();case 3:return A.Scale.toString();case 2:return A.Transparency.toString()}return""};Ee.i_k=(A,W,oa,xa)=>{oa?(A.C$a=ResourceStrings.L_AnimationExisting,xa&&(xa=!1)):W&&(A.C$a=ResourceStrings.L_AnimationMultiple);return xa};Object(h.a)(Ee,"AnimationActor",null,[268]);class Ki{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=
this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(h.a)(Ki,"EditAnimationInfo",null,[]);var wf;(function(A){A[A.invalid=0]="invalid";A[A.basicBlockList=1]="basicBlockList";A[A.alternatingHexagons=2]="alternatingHexagons";A[A.pictureCaptionList=3]="pictureCaptionList";
A[A.linedList=4]="linedList";A[A.verticalBulletList=5]="verticalBulletList";A[A.verticalBoxList=6]="verticalBoxList";A[A.verticalBracketList=7]="verticalBracketList";A[A.varyingWidthList=8]="varyingWidthList";A[A.tabList=9]="tabList";A[A.horizontalBulletList=10]="horizontalBulletList";A[A.squareAccentList=11]="squareAccentList";A[A.pictureAccentList=12]="pictureAccentList";A[A.bendingPictureAccentList=13]="bendingPictureAccentList";A[A.stackedList=14]="stackedList";A[A.increasingCircleProcess=15]=
"increasingCircleProcess";A[A.pieProcess=16]="pieProcess";A[A.detailedProcess=17]="detailedProcess";A[A.groupedList=18]="groupedList";A[A.horizontalPictureList=19]="horizontalPictureList";A[A.continuousPictureList=20]="continuousPictureList";A[A.pictureStrips=21]="pictureStrips";A[A.verticalPictureList=22]="verticalPictureList";A[A.alternatingPictureBlocks=23]="alternatingPictureBlocks";A[A.verticalPictureAccentList=24]="verticalPictureAccentList";A[A.titledPictureAccentList=25]="titledPictureAccentList";
A[A.verticalBlockList=26]="verticalBlockList";A[A.verticalChevronList=27]="verticalChevronList";A[A.verticalAccentList=28]="verticalAccentList";A[A.verticalArrowList=29]="verticalArrowList";A[A.trapezoidList=30]="trapezoidList";A[A.descendingBlockList=31]="descendingBlockList";A[A.tableList=32]="tableList";A[A.segmentedProcess=33]="segmentedProcess";A[A.verticalCurvedList=34]="verticalCurvedList";A[A.pyramidList=35]="pyramidList";A[A.targetList=36]="targetList";A[A.hierarchyList=37]="hierarchyList";
A[A.verticalCircleList=38]="verticalCircleList";A[A.tableHierarchy=39]="tableHierarchy";A[A.architectureLayout=40]="architectureLayout";A[A.basicProcess=41]="basicProcess";A[A.stepUpProcess=42]="stepUpProcess";A[A.stepDownProcess=43]="stepDownProcess";A[A.accentProcess=44]="accentProcess";A[A.pictureAccentProcess=45]="pictureAccentProcess";A[A.alternatingFlow=46]="alternatingFlow";A[A.continuousBlockProcess=47]="continuousBlockProcess";A[A.increasingArrowsProcess=48]="increasingArrowsProcess";A[A.interconnectedBlockProcess=
49]="interconnectedBlockProcess";A[A.continuousArrowProcess=50]="continuousArrowProcess";A[A.convergingText=51]="convergingText";A[A.processArrows=52]="processArrows";A[A.circleAccentTimeline=53]="circleAccentTimeline";A[A.basicTimeline=54]="basicTimeline";A[A.circleProcess=55]="circleProcess";A[A.basicChevronProcess=56]="basicChevronProcess";A[A.chevronAccentProcess=57]="chevronAccentProcess";A[A.closedChevronProcess=58]="closedChevronProcess";A[A.chevronList=59]="chevronList";A[A.subStepProcess=
60]="subStepProcess";A[A.phasedProcess=61]="phasedProcess";A[A.randomtoResultProcess=62]="randomtoResultProcess";A[A.verticalProcess=63]="verticalProcess";A[A.staggeredProcess=64]="staggeredProcess";A[A.processList=65]="processList";A[A.circleArrowProcess=66]="circleArrowProcess";A[A.basicBendingProcess=67]="basicBendingProcess";A[A.repeatingBendingProcess=68]="repeatingBendingProcess";A[A.verticalBendingProcess=69]="verticalBendingProcess";A[A.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";
A[A.upwardArrow=71]="upwardArrow";A[A.descendingProcess=72]="descendingProcess";A[A.circularBendingProcess=73]="circularBendingProcess";A[A.equation=74]="equation";A[A.verticalEquation=75]="verticalEquation";A[A.funnel=76]="funnel";A[A.gear=77]="gear";A[A.arrowRibbon=78]="arrowRibbon";A[A.opposingArrows=79]="opposingArrows";A[A.convergingArrows=80]="convergingArrows";A[A.divergingArrows=81]="divergingArrows";A[A.basicCycle=82]="basicCycle";A[A.textCycle=83]="textCycle";A[A.blockCycle=84]="blockCycle";
A[A.nondirectionalCycle=85]="nondirectionalCycle";A[A.continuousCycle=86]="continuousCycle";A[A.multidirectionalCycle=87]="multidirectionalCycle";A[A.segmentedCycle=88]="segmentedCycle";A[A.basicPie=89]="basicPie";A[A.hexagonRadial=90]="hexagonRadial";A[A.radialCycle=91]="radialCycle";A[A.basicRadial=92]="basicRadial";A[A.divergingRadial=93]="divergingRadial";A[A.radialVenn=94]="radialVenn";A[A.cycleMatrix=95]="cycleMatrix";A[A.radialCluster=96]="radialCluster";A[A.organizationChart=97]="organizationChart";
A[A.pictureOrganizationChart=98]="pictureOrganizationChart";A[A.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";A[A.halfCircleOrganizationChart=100]="halfCircleOrganizationChart";A[A.circlePictureHierarchy=101]="circlePictureHierarchy";A[A.hierarchy=102]="hierarchy";A[A.labeledHierarchy=103]="labeledHierarchy";A[A.horizontalOrganizationChart=104]="horizontalOrganizationChart";A[A.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";A[A.horizontalHierarchy=106]="horizontalHierarchy";
A[A.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";A[A.balance=108]="balance";A[A.circleRelationship=109]="circleRelationship";A[A.hexagonCluster=110]="hexagonCluster";A[A.opposingIdeas=111]="opposingIdeas";A[A.plusandMinus=112]="plusandMinus";A[A.reverseList=113]="reverseList";A[A.counterbalanceArrows=114]="counterbalanceArrows";A[A.segmentedPyramid=115]="segmentedPyramid";A[A.nestedTarget=116]="nestedTarget";A[A.convergingRadial=117]="convergingRadial";A[A.radialList=118]="radialList";
A[A.tabbedArc=119]="tabbedArc";A[A.basicTarget=120]="basicTarget";A[A.basicVenn=121]="basicVenn";A[A.linearVenn=122]="linearVenn";A[A.stackedVenn=123]="stackedVenn";A[A.interconnectedRings=124]="interconnectedRings";A[A.basicMatrix=125]="basicMatrix";A[A.titledMatrix=126]="titledMatrix";A[A.gridMatrix=127]="gridMatrix";A[A.basicPyramid=128]="basicPyramid";A[A.invertedPyramid=129]="invertedPyramid";A[A.accentedPicture=130]="accentedPicture";A[A.circularPictureCallout=131]="circularPictureCallout";
A[A.radialPictureList=132]="radialPictureList";A[A.snapshotPictureList=133]="snapshotPictureList";A[A.spiralPicture=134]="spiralPicture";A[A.captionedPictures=135]="captionedPictures";A[A.bendingPictureCaption=136]="bendingPictureCaption";A[A.pictureFrame=137]="pictureFrame";A[A.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";A[A.bendingPictureBlocks=139]="bendingPictureBlocks";A[A.bendingPictureCaptionList=140]="bendingPictureCaptionList";A[A.titledPictureBlocks=141]="titledPictureBlocks";
A[A.pictureGrid=142]="pictureGrid";A[A.pictureAccentBlocks=143]="pictureAccentBlocks";A[A.themePictureAccent=144]="themePictureAccent";A[A.themePictureGrid=145]="themePictureGrid";A[A.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";A[A.alternatingPictureCircles=147]="alternatingPictureCircles";A[A.titlePictureLineup=148]="titlePictureLineup";A[A.pictureLineup=149]="pictureLineup";A[A.framedTextPicture=150]="framedTextPicture";A[A.bubblePictureList=151]="bubblePictureList";A[A.linearArrowProcessNumbered=
152]="linearArrowProcessNumbered";A[A.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";A[A.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";A[A.accentHomeChevronProcess=155]="accentHomeChevronProcess";A[A.basicProcessNew=156]="basicProcessNew";A[A.basicTimelineNew=157]="basicTimelineNew";A[A.chevronBlockProcess=158]="chevronBlockProcess";A[A.hexagonTimeline=159]="hexagonTimeline";A[A.horizontalActionList=160]="horizontalActionList";A[A.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";
A[A.roundedRectangleTimeline=162]="roundedRectangleTimeline";A[A.verticalDownArrowProcess=163]="verticalDownArrowProcess";A[A.verticalHollowActionList=164]="verticalHollowActionList";A[A.verticalSolidActionList=165]="verticalSolidActionList";A[A.dropPinTimeline=166]="dropPinTimeline";A[A.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";A[A.horizontalPathTimeline=168]="horizontalPathTimeline";A[A.iconLabelList=169]="iconLabelList";A[A.iconCircleList=170]="iconCircleList";A[A.iconLabelDescriptionList=
171]="iconLabelDescriptionList";A[A.iconVerticalSolidList=172]="iconVerticalSolidList";A[A.iconCircleLabelList=173]="iconCircleLabelList";A[A.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";A[A.iconLeafLabelList=175]="iconLeafLabelList";A[A.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";A[A.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(wf||(wf={}));Object(h.b)("SmartArtLayout",wf);var ag;(function(A){A[A.title=0]="title";A[A.body=1]="body";A[A.centerTitle=
2]="centerTitle";A[A.subTitle=3]="subTitle";A[A.slideNum=5]="slideNum";A[A.footer=6]="footer";A[A.object=8]="object";A[A.graph=9]="graph";A[A.table=10]="table";A[A.clipArt=11]="clipArt";A[A.orgChart=12]="orgChart";A[A.media=13]="media";A[A.picture=15]="picture"})(ag||(ag={}));Object(h.b)("PlaceholderType",ag);class Og{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld){this.S6="Existing";this.oMa="ExistingInMenu";this.c5e="AnimationExisting";this.d5e="AnimationExistingInMenu";this.ia=A;this.qq=W;this.pa=oa;
this.kjc=ld.qk(Ye.a.umd);this.Fb=Ia;this.Fa=xa;this.vk=qb;this.fc=Hb;this.onk=hc.pptAnimationMarkersEnabled;this.Ga=Jc;this.eDe=Ff.a("SetAnimationTelemetryCustomDataEnabled")}vb(){this.ia.ra(bd.a.Koa,Nc.a.application,Object(n.a)(this,this.Koa,"queryAnimationGallery"),97);this.ia.ra(bd.a.RTe,Nc.a.application,Object(n.a)(this,this.RTe,"queryMoreAnimationGallery"),96);this.ia.ra(bd.a.Ww,Nc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),5|(this.eDe?8:0));this.ia.ra(bd.a.ONb,Nc.a.application,Object(n.a)(this,
this.Ww,"setAnimation"),5|(this.eDe?8:0));this.ia.ra(bd.a.RNb,Nc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),5);this.ia.ra(bd.a.s1a,Nc.a.application,Object(n.a)(this,this.Ww,"setAnimation"),5);this.ia.ra(bd.a.Snd,Nc.a.application,Object(n.a)(this,this.tTe,"queryEffectOptions"),100);this.ia.ra(bd.a.q1a,Nc.a.application,Object(n.a)(this,this.q1a,"setAnimationDirection"),5);this.ia.ra(bd.a.g0a,Nc.a.application,Object(n.a)(this,this.g0a,"queryAnimationDirection"),97);this.ia.ra(bd.a.r1a,Nc.a.application,
Object(n.a)(this,this.r1a,"setAnimationEffectData"),4);this.ia.ra(bd.a.h0a,Nc.a.application,Object(n.a)(this,this.h0a,"queryAnimationEffectData"),96);this.ia.ra(bd.a.ctd,Nc.a.application,Object(n.a)(this,this.GLa,"setAnimationSequence"),5);this.ia.ra(bd.a.dtd,Nc.a.application,Object(n.a)(this,this.GLa,"setAnimationSequence"),5);this.ia.ra(bd.a.etd,Nc.a.application,Object(n.a)(this,this.GLa,"setAnimationSequence"),5);this.ia.ra(bd.a.ftd,Nc.a.application,Object(n.a)(this,this.GLa,"setAnimationSequence"),
5);this.ia.ra(bd.a.Loa,Nc.a.application,Object(n.a)(this,this.Loa,"queryAnimationSequence"),97);this.ia.ra(bd.a.PXe,Nc.a.application,Object(n.a)(this,this.Taa,"reorderAnimation"),4);this.ia.ra(bd.a.QXe,Nc.a.application,Object(n.a)(this,this.Taa,"reorderAnimation"),4);this.ia.ra(bd.a.P_a,Nc.a.application,Object(n.a)(this,this.P_a,"populateAnimationEffectOptions"),96);this.ia.ra(bd.a.aza,Nc.a.application,Object(n.a)(this,this.aza,"setAnimationColor"),4)}me(){}P_a(A,W,oa,xa,Ia){A=this.PT();W=this.pa.Fk();
if(!W||!A)return 8;if(1===oa)return 32;oa=Og.s4(W,A);if(!oa||0===oa.EffectId)return 16;Ia.MenuItems=this.eui(oa,W,A);return 32}Koa(A,W,oa,xa,Ia){A=Ia.queryResult;Ia=Ia.SourceControlId;var qb=xa=-1;Ia!==this.S6&&({effectType:qb,effectId:xa}=this.vk.ZVc(Ia));W=this.PT();var Hb=this.pa.Fk();if(!Hb||!W)return 8;if(1!==oa)return 32;({image:oa,label:ld}=this.vk.$Vc(Ia));var hc=ld;if(Ia===this.S6||Ia===this.oMa)hc=ResourceStrings.L_ExistingButtonDescription;this.E$a(Ia,oa,ld,A,hc);var Jc=Og.s4(Hb,W);var ld=
Jc?Jc.EffectId:0;hc=Jc?Jc.EffectType:0;const wd=!this.vk.ncb(Jc,W);Jc=this.vk.$pe(Jc,W);this.onk&&(Hb=Hb?Hb.zUa(W):null,Jc=Jc&&!this.vk.k6j(Hb));xa=!wd&&!Jc&&xa===ld&&qb===hc;qb=wd?!1:this.vk.W1c(hc,ld);Ia===this.S6||Ia===this.oMa?(qb=Ia===this.S6?this.l_k(this.S6,A,Jc,qb,oa,hc,ld):Og.j_k(A,Jc,qb),A.qV(wd||Jc||qb)):W&&A.qV(xa);return 32}l_k(A,W,oa,xa,Ia,qb,Hb){oa?this.E$a(A,Ia,ResourceStrings.L_AnimationMultiple,W,ResourceStrings.L_AnimationMultiple):xa&&(Ia=this.vk.iYc(qb,Hb),{image:Ia,label:oa}=
this.vk.$Vc(Ia),this.E$a(A,Ia,oa,W,oa));return xa}E$a(A,W,oa,xa,Ia){let qb;qb=A===this.S6?"298832323":A===this.oMa?"1264919631":"2676673376";W=W.substring((Ye.a.Noc+"_").length,W.length-6);A=Object.assign(new pd.a,{Id:A,ExternalId:"Animation"+A,Icon:W,Command:qb,QueryCommand:"1852964326",LabelText:oa,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ia});xa.j4=A}RTe(A,W){if(W.contextId!==Nc.a.application)return 2;A=this.PT();return!this.pa.Fk()||
!A||A.mX||A.nr||A.Pp?8:this.fc.fd(A)?16:32}Ww(A,W,oa,xa,Ia){W=this.PT();var qb=this.pa.Fk();if(!qb||!W||W.mX||W.nr||W.Pp)return 8;if(this.fc.fd(W))return 16;var Hb=Og.s4(qb,W),hc=Hb?Hb.EffectId:-1,Jc=Hb?Hb.EffectType:-1;if(1===oa)return A===bd.a.RNb||A===bd.a.s1a?(xa=this.vk.W1c(Jc,hc),qb=!!Hb&&!this.vk.ncb(Hb,W),A===bd.a.s1a&&(xa=qb?!0:!1),W=!!Hb&&this.vk.$pe(Hb,W),W=qb||W,xa||W?32:16):A===bd.a.ONb?W.xd||W.qr||W.Pp?16:32:32;A=Ia.SourceControlId;if(!A)return 8;if(A===this.S6||A===this.oMa||A===this.c5e||
A===this.d5e)return 32;({effectType:Ia,effectId:oa}=this.vk.ZVc(A));hc=this.vk.qij(A);Jc=this.vk.nij(A);xa&&this.eDe&&(xa.PC=oa,xa.XN=Ia);Hb=W.$bb()?Og.O8b(qb,W):Hb;Hb||(Hb=new Ki,Hb.Id=W.id.toString(),Hb.BuildIds=[qb.q5b+1],Hb.HasTrigger=!1,Hb.BuildId=qb.q5b+1,Hb.SequenceIndex=0,Hb.IsTextRangeType=!1);Hb.HasExisting=!1;Hb.HasMultiple=!1;Hb.EffectType=Ia;Hb.SequenceId=1;Hb.EffectId=oa;Hb.Direction=hc;Hb.EffectData=Jc;Hb.IsTrigger=!1;this.g6b(qb,W,Hb);e.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",
A,qb.Cb.sid,W.id);this.Ugk(qb);return 32}aza(A,W,oa,xa,Ia){W=this.qq.presentation;if(!W)throw Error.argumentNull("Presentation is null");A=this.PT();if(!A)return 8;W=Object(z.a)(116,W.XC(A.slideId));if(!W)return 8;xa=Og.s4(W,A);if(!(xa&&Ia&&W&&A))return 8;if(this.fc.fd(A))return 16;if(1===oa)return 32;oa=Nd.Box4ColorHelper.vS(Ia);oa=Nd.Box4ColorHelper.Dkb(oa,W.Fd);if(!oa)return 8;xa.EffectData=String.format("{0},{1},{2}",oa.r.toString(16),oa.g.toString(16),oa.b.toString(16));this.g6b(W,A,xa);return 32}tTe(){const A=
this.PT();var W=this.pa.Fk();return W&&A?this.fc.fd(A)?16:(W=Og.s4(W,A))&&this.vk.Fzi(A,this.Ga,W)?32:16:8}Taa(A,W,oa){W=this.PT();const xa=this.pa.Fk();if(!xa||!W)return 8;if(this.fc.fd(W))return 16;const Ia=Og.O8b(xa,W);let qb;switch(A){case bd.a.PXe:qb=!1;break;case bd.a.QXe:qb=!0;break;default:return 8}let Hb=!1;if(W&&(Hb=!!Ia&&!Ia.HasTrigger&&1===Ia.BuildIds.length)){let hc=!1,Jc=!1;({H1b:hc,J1b:Jc}=Og.Kzi(xa,Ia));Hb=qb?Jc&&Hb:hc&&Hb}if(1===oa)return Hb?32:8;if(Hb){oa=this.Fb.yd(15,void 0,()=>
{this.pa.nj();this.Fa.Bd()});try{oa.jc(xa),oa.gd=A,xa.Taa(W,qb)}finally{oa&&oa.dispose()}}return 32}q1a(A,W,oa,xa,Ia){A=this.PT();W=this.pa.Fk();if(!W||!A)return 8;if(1===oa)return 32;if(this.fc.fd(A))return 16;oa=Og.O8b(W,A);if(!oa)return 8;Ia=Ia.MenuItemId;oa.Direction=this.vk.U7b(Ia);this.g6b(W,A,oa);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.vk.iYc(oa.EffectType,oa.EffectId),Ia,W.sid,A.id);
return 32}g0a(A,W,oa,xa,Ia){W=this.PT();xa=this.pa.Fk();if(!xa||!W)return 8;A=Ia.queryResult;Ia=this.vk.U7b(Ia.MenuItemId);W=Og.s4(xa,W);1===oa&&W&&A.If(W.Direction===Ia);return 32}GLa(A,W,oa,xa,Ia){A=Ia.MenuItemId;W=this.PT();xa=this.pa.Fk();if(!xa||!W)return 8;if(1===oa)return 32;if(this.fc.fd(W))return 16;oa=Og.O8b(xa,W);if(!oa)return 8;oa.SequenceId=this.vk.cee(A);this.g6b(xa,W,oa);return 32}Loa(A,W,oa,xa,Ia){A=this.PT();W=this.pa.Fk();if(!W||!A)return 8;A=Og.s4(W,A);W=Ia.queryResult;Ia=this.vk.cee(Ia.MenuItemId);
1===oa&&A&&W.If(A.SequenceId===Ia);return 32}r1a(A,W,oa,xa,Ia){A=this.PT();W=this.pa.Fk();if(!W||!A)return 8;if(1===oa)return 32;if(this.fc.fd(A))return 16;oa=Og.O8b(W,A);if(!oa)return 8;if(!Ia)return 2;oa.EffectData=this.vk.Vae(Ia.MenuItemId);this.g6b(W,A,oa);return 32}h0a(A,W,oa,xa,Ia){A=this.PT();W=this.pa.Fk();if(!W||!A)return 8;A=Og.s4(W,A);1===oa&&A&&Ia.queryResult.If(this.vk.kOf(A.EffectData,Ia.MenuItemId));return 32}g6b(A,W,oa){const xa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});
try{xa.jc(A),A.Ftc(W,oa)}finally{xa&&xa.dispose()}}eui(A,W,oa){const xa=Object.assign(new Kg.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});Array.add(xa.MenuSectionList,this.vk.KXc(A.EffectId,A.EffectType,"Direction","2289594085","3782857737"));this.vk.Wog(A)&&(Array.add(xa.MenuSectionList,le.f(W.Fd,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(xa.MenuSectionList,
le.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(xa.MenuSectionList,this.vk.KXc(A.EffectId,A.EffectType,"EffectData","2949363495","4132852551"));Array.add(xa.MenuSectionList,this.vk.Csj(oa,this.Ga,A));return xa}Ugk(A){if(A){var W=A.yj(),oa=String.format("{0}#{1}",A.sid,A.cid);if(W&&0<W.length)for(const xa of W)if(W=A.bFa(xa)){const Ia=W.EffectId,qb=W.EffectType,Hb=W.Direction,hc=this.vk.iYc(qb,Ia),Jc=this.Ga.D9f(xa),
ld=Og.rvj(xa,Jc);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",hc,Ia,qb,Hb,xa.vy().length,Jc,ld,W.SequenceId,oa,xa.id)}}}PT(){const A=this.pa.Ll();return A?A.get_smartArtModelId()?this.Ga.Lr(A):A.Ug?this.Ga.Fs(A):A:null}static j_k(A,W,oa){W?A.C$a=ResourceStrings.L_AnimationMultiple:(A.C$a=ResourceStrings.L_AnimationExisting,oa&&(oa=!1));return oa}static Kzi(A,
W){let oa,xa;if(!W)return{H1b:!1,J1b:!1};const Ia=A.Z5d,qb=A.q5b,Hb=W.BuildIds[0];xa=oa=!0;0===W.StartType?oa=Hb>Ia?!0:!1:xa=Hb<qb?!0:!1;if(Hb===Ia||Hb===qb){if(!Hb)return{H1b:!1,J1b:xa};for(const hc of A.CQ)if(hc.Id!==W.Id)for(const Jc of hc.BuildIds)if(0===W.StartType){if(Jc>=Hb)return xa=!0,{H1b:oa,J1b:xa}}else if(Jc===Hb)return oa=!0,{H1b:oa,J1b:xa};0===W.StartType?xa=!1:oa=!1}return{H1b:oa,J1b:xa}}static s4(A,W){return A&&W?A.s4(W):null}static O8b(A,W){return A&&W?A.bFa(W):null}static rvj(A,
W){return 24===W?wf[A.smartArtInfo.SmartArtLayout]:1===W?A.shapeType.toString():14===W?ag[A.Cj]:"Unknown"}}Object(h.a)(Og,"AnimationActorLegacy",null,[268]);class Kh{constructor(A,W,oa,xa){this.Ff=null;this.Ca=A;this.$ob=W;this.j1h=oa;this.FNd=xa;this.FNd.init();this.$ob.init()}vb(){this.Ca.ra(re.a.FJb,Nc.a.application,Object(n.a)(this,this.FJb,"openGrammarSettings"),1028);this.Ca.ya(re.a.G9b,Lb.a.frame,Object(n.a)(this,this.cgg,"grammarDialogTabFocusHandler"));this.Ca.ya(re.a.F9b,Lb.a.frame,Object(n.a)(this,
this.cgg,"grammarDialogTabFocusHandler"));this.Ca.ya(re.a.ZYc,Lb.a.frame,Object(n.a)(this,this.bgg,"grammarDialogOptionFocusHandler"));this.Ca.ya(re.a.YYc,Lb.a.frame,Object(n.a)(this,this.bgg,"grammarDialogOptionFocusHandler"))}FJb(A,W,oa,xa,Ia){A=this.P7f();if(1===oa)return this.FNd.request(A).result&&this.FNd.request(A).result.length?6===this.$ob.w5a.status?32:8:8;this.Ff=this.j1h(A,this.$ob.w5a.result);this.Ff.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,qb=>{e.ULS.sendTraceTag(36489285,
375,50,"User click button of {0}",1===qb?"OK":0===qb?"Cancel":"");1===qb&&(this.Ff.s9j()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.$ob.saveSettings(this.Ff.settings)):e.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});A=oa="";Ia&&(oa+=Ia.SourceControlId,A+=Ia.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+oa+", Alt: "+A);return 32}P7f(){return L.AFrameworkApplication.lcid}cgg(A){if(!this.Ff)return 2;
var W=this.Ff.Wo.Kl().Gj.G_;if(W===this.Ff.lw&&A===re.a.G9b||W===this.Ff.Q0a&&A===re.a.F9b)this.Ff.k8?this.Ff.Wo.Kl().Gj.mF(this.Ff.k8):this.Ff.gll();else if(Sys.UI.DomElement.containsCssClass(W,Je.$3b)||W.parentNode&&Sys.UI.DomElement.containsCssClass(W.parentNode,Je.$3b))W=null,A===re.a.G9b?W=this.Ff.Q0a:A===re.a.F9b&&(W=this.Ff.lw),this.Ff.Wo.Kl().Gj.mF(W);else if(A===re.a.G9b)this.Ff.Wo.Kl().uIb();else if(A===re.a.F9b)this.Ff.Wo.Kl().sIb();else return 2;return 32}bgg(A){if(!this.Ff)return 2;let W=
this.Ff.Wo.Kl().Gj.G_;if(W===this.Ff.lw||W===this.Ff.Q0a||W===this.Ff.QD)return 2;A===re.a.YYc&&this.Ff.Wo.Kl().uIb();A===re.a.ZYc&&this.Ff.Wo.Kl().sIb();W=this.Ff.Wo.Kl().Gj.G_;W===this.Ff.Q0a?this.Ff.Wo.Kl().sIb():W===this.Ff.lw?this.Ff.Wo.Kl().uIb():this.Ff.k8=W;return 32}}Object(h.a)(Kh,"GrammarSettingsActor",null,[]);class Xg extends Kh{constructor(A,W,oa,xa,Ia,qb,Hb){super(A,W,oa,xa);this.jb=Ia;this.zDe=qb;this.Ga=Hb}P7f(){let A=L.AFrameworkApplication.lcid;if(this.jb.u0(this.jb.Pa)){var W=
this.jb.Ud();W&&1===W.length&&(W=this.Ga.iUa(W[0]),0<W&&(A=W))}else this.jb.Pa.nb&&(W=this.zDe.SWc(this.jb.ak),0<W&&(A=W));return A}}Object(h.a)(Xg,"EditorSettingsActor",Kh,[]);var Yd=d(58),ce=d(330),Rh=d(232),ng=d(451);class Vi{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd){this.HZd=null;this.jJj=(de,oe,Pc)=>{var tc;oe=this.pa.Re();if(!oe||!oe.length)return gd.a.J(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const id of oe)if(!id||this.fc.fd(id))return gd.a.J(509362199,
822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.Qwl(oe))return gd.a.J(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),8;if(1===Pc)return 32;null===(tc=Wf.a.Kb)||void 0===tc?void 0:tc.Wa("SlideCount",oe.length.toString());Pc=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{Pc.jc(this.ua.Ba);Pc.gd=de;for(const id of oe)id.gsc=!0}finally{Pc&&Pc.dispose()}return 32};this.ia=
A;this.Fa=W;this.fc=oa;this.pa=xa;this.Fb=Ia;this.E5=qb;this.ua=Hb;this.QB=hc;this.BR=Jc;this.XDe=ld;this.Vd=wd;this.Da=Bd}vb(){this.ia.ra(bd.a.Gta,Nc.a.application,Object(n.a)(this,this.oJj,"handleSlidesSolidFill"),4);this.ia.ra(bd.a.U9d,Nc.a.application,Object(n.a)(this,this.mJj,"handleSlidesPicture"),4);this.ia.ra(bd.a.T9d,Nc.a.application,Object(n.a)(this,this.kJj,"handleSlidesFinalizePicture"),4);this.ia.ra(bd.a.nUc,Nc.a.application,Object(n.a)(this,this.RCj,"handleApplyAll"),4);this.ia.ra(bd.a.$Qe,
Nc.a.application,Object(n.a)(this,this.hHj,"handlePopulateFillMenu"),96);this.ia.ra(bd.a.P6g,Nc.a.application,Object(n.a)(this,this.kGj,"handleMoreFormatBackgroundColors"),96);this.ia.ra(bd.a.dnd,Nc.a.application,Object(n.a)(this,this.lGj,"handleMoreFormatBackgroundColorsResponse"),4);this.ia.ra(bd.a.oUc,Nc.a.application,this.jJj,4)}me(){}hHj(A,W,oa,xa,Ia){A=this.ua.Ba;if(!A||this.fc.fd(A))return 16;if(1===oa)return 32;if(!Ia)return gd.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),
8;oa=A.Fd;if(!oa)return gd.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;A=this.E5.Gf.fda;W=Object.assign(new Kg.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(W.MenuSectionList,le.f(oa,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(W.MenuSectionList,le.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));A&&0<A.length?
(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(W.MenuSectionList,le.c(A,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(W.MenuSectionList,le.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors",
"MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=W;return 32}oJj(A,W,oa,xa,Ia){W=this.pa.Re();if(!W||!W.length)return 16;for(const qb of W)if(!qb||this.fc.fd(qb))return 16;if(1===oa)return 32;oa=Vi.Uld(Ia);if(!oa)return 8;Wf.a.Kb&&Wf.a.Kb.Wa("SlideCount",W.length.toString());Ia=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{Ia.jc(this.ua.Ba);Ia.gd=A;for(const qb of W)qb.Stb=oa}finally{Ia&&Ia.dispose()}return 32}mJj(A,
W,oa){this.HZd=this.ua.Ba;A=this.pa.Re();if(!A||!A.length)return 16;for(const xa of A)if(!xa||this.fc.fd(xa)||Yd.a.Fw(xa.Cb))return 16;if(1===oa)return 32;this.Hvd(!1);return 32}RCj(A,W,oa){W=this.ua.Ba;if(!W||this.fc.fd(W))return 16;if(1===oa)return 32;oa=W.Cb;W=this.E5.Gf;if(!W)return 8;const xa=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()});try{xa.jc(W),xa.gd=A,W.ttb=oa}finally{xa&&xa.dispose()}return 32}Qwl(A){const W=this.E5.Gf;if(!W)return gd.a.J(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),
!1;for(const xa of A)if((A=xa.kT)&&-1==A.indexOf("/BgSource/ContentMaster")&&-1==A.indexOf("/BgSource/MainMaster")){var oa=W.B8i(xa.mj,xa.Qn);if(!oa)return gd.a.J(509362196,822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),!0;oa=oa.kT;if(!oa||!A.match(oa))return!0}return!1}kJj(A,W,oa,xa,Ia){W=this.pa.Re();if(!W||!W.length)return 16;for(const Hb of W)if(!Hb||!Hb.isConnected)return 16;if(1===oa)return 32;this.BR.cjb=new Date;const qb=Wf.a.Kb;this.QB.B5e(Ia,
Hb=>{Wf.a.YI(qb,()=>{this.nJj(Hb,A)})},Hb=>{this.b$b(Hb.error)});this.ua.Ba===this.HZd&&(this.Fa.Bd(),this.pa.nh());return 32}kGj(A,W,oa,xa,Ia){A=this.ua.Ba;if(!A||this.fc.fd(A))return gd.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Da.fD&&Ff.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.pa.Re().length:1!==this.pa.Re().length)return 16;if(1===oa)return this.ia.Ja(bd.a.renderColorPicker,1,Ia);oa=Rh.a.parse(A.kT);if(!oa)return 8;Ia=oa.UMa();oa=
null;Ia&&(oa=Nd.Box4ColorHelper.Ita(Ia));Ia={};Ia.currentColor=oa;Ia.handleCommand=bd.a.dnd;return this.ia.Ja(bd.a.renderColorPicker,2,Ia)}lGj(A,W,oa,xa,Ia){if(1===oa)return this.ia.Ja(bd.a.Gta,oa,Ia);if(!Ia)return gd.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;A=this.ia.Ja(bd.a.Gta,oa,Ia);32===A&&this.ia.Ja(bd.a.xCa,oa,Ia);return A}Hvd(A){this.XDe?ng.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.QB&&(this.QB.FRb=1,this.QB.nlh(A))}nJj(A,
W){this.BR.O_a=new Date;(A=A.result)?this.rBi(A,W):(W=Object.assign(new ce.a,{Code:94}),this.b$b(W))}rBi(A,W){const oa=this.pa.Re(),xa=this.Fb.yd(15);try{xa.jc(this.HZd);xa.gd=W;for(const Ia of oa)Ia.$C=A.ItemId}finally{xa&&xa.dispose()}if(A=Wf.a.Kb)A.actionName="FormatBackgroundPicture",A.Wa("PictureUploadStart",Wf.a.vf(this.BR.cjb)),A.Wa("PictureUploadDurationMS",(+this.BR.O_a-+this.BR.cjb).toString())}b$b(A){this.BR.O_a=new Date;this.Vd.rH(A.Code,W=>{W.JC=1;W.jTa=A.ExtraErrorParam;return!1})}static Uld(A){return Rh.a.parse(A.Color)}}
Object(h.a)(Vi,"FormatBackgroundActor",null,[268]);var $h=d(75),fg=d(34),dk=d(425),xi=d(32),yh=d(158);const Lg=A=>{let W=A.isBold?"b:1;":"";W+=A.isItalic?"i:1;":"";W+=A.uE?"u:1;":"";W+=A.cG?"s:1;":"";W+=A.isSuperscript?"sup:1;":"";return W+=A.dG?"sub:1;":""},yi=(A,W,oa)=>{let xa=null;for(var Ia,qb=fg.ParagraphReader.text(A),Hb=0;A.Sa&&Hb<A.Sa.length;){var hc=A.Sa.ga(Hb),Jc=hc.cp;Ia=Hb<A.Sa.length-1?A.Sa.ga(Hb+1).cp:fg.ParagraphReader.textLength(A);if(-1!==W&&Ia<=W)Hb++;else{if(-1!==oa&&Jc>oa)break;
var ld="";hc.formatting?ld=Lg(hc.formatting.cache):(hc=dk.c(A.Sa,hc.cp).m5c)&&(ld=Lg(hc.cache));hc=Jc;-1!==W&&(hc=Math.max(W,Jc));Jc=Ia;-1!==oa&&(Jc=Math.min(oa,Ia));Jc=ub.a.substring(qb,hc,Jc);0<Jc.length&&(Ia=document.createElement("span"),Ia.setAttribute("style",ld),Ia.innerText=Jc,xa||(xa=document.createElement("p")),xa.appendChild(Ia));Hb++}}if(xa&&fg.ParagraphReader.rX(A)){W=xa;oa=W.setAttribute;Hb=new xi.GraphIterator;Hb.set(A);Hb.rc(11);Hb.Jg(11);qb="";if(A.Vf.Hv(Hb))switch(Hb=A.Vf.Hv(Hb),
A=fg.ParagraphReader.Tib(A),ld=Hb.AX,Hb.listType){case 0:switch(Hb.listStyle){case 1:qb="decimal";break;case 2:qb="loweralpha";break;case 3:qb="lowerroman";break;case 4:qb="upperalpha";break;case 5:qb="upperroman";break;default:qb="decimal"}qb=String.format("lt:{0};in:{1};li:{2}",qb,A,ld);break;case 1:switch(Hb.listStyle){case 1:qb="disc";break;case 2:qb="circle";break;case 3:qb="square";break;default:qb="disc"}qb=String.format("lt:{0};in:{1}",qb,A)}oa.call(W,"style",qb)}return xa},Vd=A=>{if(A){var W;
(W=H.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?W=W.eO(A):(gd.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),W=null);if(W){A=null;W=W.Kab();for(let oa=0;oa<W.length;oa++){const xa=lf(Object(z.a)($h.AParagraphNode,W[oa].M6b));A=Zj(xa,A)}return A}A=Array.isArray(A.vy())?A.vy():null;return lf(A&&0<A.length?A[0]:null)}return null},lf=A=>{let W=null;for(;A;){const oa=yi(A,-1,-1);W=Zj(oa,W);A=fg.ParagraphReader.dua(A,!1,!0,!1)}return W},Zj=(A,W)=>{A&&(W||(W=document.createElement("div")),
W.appendChild(A));return W},Cj=A=>{const W=Object.assign(new yh.a,{Source:6});H.a.instance.resolve("PowerPointWebEditor.IErrorHandler").Gs(W,A,oa=>{oa.JC=1;oa.dDa=0;oa.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;oa.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class he{constructor(A,W,oa,xa){this.pIg=!1;this.ved="";this.ia=A;this.Fa=W;this.jb=oa;const Ia=new Date;xa("immersiveReader").then(()=>{this.pIg=!0;gd.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",
+new Date-+Ia)}).catch(qb=>{const Hb=+new Date-+Ia;gd.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",Hb,qb.toString());const hc=new Map;hc.set("JSLoadDurationInMs",Hb.toString());hc.set("Exception",qb.toString());B.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new ha.a,{extendedProperties:hc}))})}vb(){this.ia.ya(bd.a.immersiveReader,Nc.a.view,Object(n.a)(this,this.flg,"immersiveReaderHandler"));this.ia.ya(bd.a.Lie,
Nc.a.view,Object(n.a)(this,this.flg,"immersiveReaderHandler"))}me(){this.Fa.Ic(Jf.a.DQ).bindAction(Qb.KeyInputManager.Va(ud.a.Byc,Qb.KeyInputManager.Te|4),bd.a.immersiveReader)}udj(A){let W="";for(A=Object(z.a)($h.AParagraphNode,A.node);A;){const oa=fg.ParagraphReader.dua(A,!0,!0,!1);if(oa)A=oa;else break}for(;A;)W+="\n"+fg.ParagraphReader.text(A),A=fg.ParagraphReader.dua(A,!1,!0,!1);return W}Tui(){var A=this.jb.Re();let W=null;if(!A)return null;for(const oa of A)if(A=oa.AUa())for(const xa of A)A=
Vd(xa),W=Zj(A,W);return W}Sui(){let A=null;var W=this.jb.Pa;if(!W)return null;for(let Ia of W)if(Ia)for(W=0;W<Ia.length;W++){var oa=Ia.ga(W),xa=null;if(oa.contextId===Nc.a.outline||oa.contextId===Nc.a.Mf)if(fg.ParagraphReader.fe(oa.node)){for(oa=Object(z.a)($h.AParagraphNode,oa.node);oa;)if(xa=fg.ParagraphReader.dua(oa,!0,!0,!1))oa=xa;else break;xa=lf(oa)}else xa=Vd(Object(z.a)(4,oa.node));else oa.contextId!==Nc.a.endOfParagraph&&fg.ParagraphReader.fe(oa.node)&&(xa=yi(Object(z.a)($h.AParagraphNode,
oa.node),oa.Ra,oa.Lb));A=Zj(xa,A)}return A}Xui(){let A;return(A=this.jb.Js()?this.Tui():this.Sui())?A.innerHTML:""}tyj(){let A="";const W=this.jb.Pa.nb;if(W)for(let oa=0;oa<W.length;oa++){const xa=W.ga(oa),Ia=xa.Ra,qb=xa.Lb-Ia;let Hb;if(fg.ParagraphReader.fe(xa.node))switch(Hb=xa.node.characterData,xa.contextId){case Nc.a.paragraph:A+=Hb+"\r";break;case Nc.a.textRange:0<qb&&(A+=Hb.substr(Ia,qb));break;case Nc.a.endOfParagraph:A+="\r";break;case Nc.a.Mf:A+=this.udj(xa)}}return A}Owg(){const A=new XMLHttpRequest,
W=H.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var oa=H.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;oa=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",oa,W);A.open("GET",oa,!0);const xa=aa.a.create().toString();A.setRequestHeader("X-UserSessionId",L.AFrameworkApplication.userSessionId);A.setRequestHeader("X-CorrelationID",xa);A.setRequestHeader("X-WacCluster",H.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").Ck);
let Ia=null;const qb=new Map;A.onreadystatechange=()=>{if(4===A.readyState)if(200===A.status){var Hb=+new Date-+Ia;gd.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Hb);qb.set("AuthTokenDurationInMs",Hb.toString());Hb=A.responseText.replace('"',"");const hc=new Date,Jc=Ff.a("EnableSendingHTMLToIR")?[{["content"]:this.ved,["mimeType"]:"text/html"}]:[{["content"]:this.ved}];immersiveReader.launchAsync(Hb,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:Jc},
null).then(ld=>{ld=(ld=Object(z.a)(Object,ld))?ld.sessionId:"";const wd=+new Date-+hc,Bd=+new Date-+Ia;gd.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",wd,ld);qb.set("LaunchAsyncDurationInMs",wd.toString());qb.set("IRResponseSessionId",ld);qb.set("UserPerceivedDurationInMs",Bd.toString());B.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new ha.a,{extendedProperties:qb}))}).catch(ld=>
{Cj(W);const wd=+new Date-+hc,Bd=+new Date-+Ia;gd.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",wd,ld);qb.set("LaunchAsyncDurationInMs",wd.toString());qb.set("ErrorJson",ld.toString());qb.set("UserPerceivedDurationInMs",Bd.toString());B.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new ha.a,{extendedProperties:qb}))})}else Cj(W),Hb=+new Date-+Ia,gd.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",
Hb,A.status,xa),qb.set("CorrelationId",xa),qb.set("StatusCode",A.status.toString()),qb.set("UserPerceivedDurationInMs",Hb.toString()),B.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","RequestForAuthTokenFailed",!1,!0,Object.assign(new ha.a,{extendedProperties:qb}));else gd.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",xa,A.status)};Ia=new Date;gd.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",
Ia.getTime(),xa);oa=new Map;oa.set("CorrelationId",xa);oa.set("Info","RequestingAuthToken");B.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,oa);A.send(null)}flg(A,W,oa){if(1===oa||6===this.ia.Lp){if(!this.pIg)return 8;this.ved=Ff.a("EnableSendingHTMLToIR")?this.Xui():this.tyj();if(""===this.ved)return 8}2===oa&&this.Owg();return 32}}Object(h.a)(he,"ImmersiveReaderActor",null,[268]);var ij=d(592),Rf=d(807);class zh{constructor(A){this.customData=null;this.GQ=A}}Object(h.a)(zh,"PropertySetChangedState",
null,[]);class Sh{static kYk(A,W,oa){if(A&&W){var xa=new zh(W),Ia=(qb,Hb,hc)=>{oa.jYk(qb,Hb,hc,xa)};A=new Rf.a(W,A);A.fKc=Ia;A.WMc=Ia;A.qqd=Ia;A.wga()}}}Object(h.a)(Sh,"PropertySetChangedManager",null,[]);class jj{constructor(A){this.T7h=A}jYk(A,W,oa,xa){const Ia=this.T7h[A.id.toString()];Ia&&Ia(A,W,oa,xa)}}Object(h.a)(jj,"PropertyChangedProcessor",null,[]);var Dj=d(1134),Ah=d(447),hf=d(61),rg=d(591),Ej=d(408),Li=d(988);class Gh{constructor(){this.jTe=this.M5c=this.Q_c=null}}Object(h.a)(Gh,"ParagraphDialogResults",
null,[]);class hg extends mb.a{constructor(A,W,oa){super(void 0,void 0,!0);this.Rva=null;if(null===A)throw Error.argumentNull("properties");this.kfa=A.clone();this.L$=A.clone();this.OB=oa;this.ia=W;this.Isk=new rc.a(Object(n.a)(this,this.LQi,"createPropertyChangedHandlers"))}jvd(){this.ig="ParagraphDialog";const A={};A.bodyControls=this.W$d();this.sj(ResourceStrings.L_ParagraphDialogTitle,Object(n.a)(this,this.J4d,"dialogResultHandler"),A)}J4d(A,W){1===A&&(this.wUl(W),A=Object.assign(new Gh,{Q_c:this.kfa,
M5c:this.L$,jTe:this.Isk}),this.ia.Ja(bd.a.hOf,2,A));this.dispose()}W$d(){this.Rva=hg.Pae();const A={};this.BIi(A);this.PHi(A);var W=Li.a("Inch",3,0,56,.1);const oa=Li.a("Character",2,0,56,.1);W=[W,oa];this.dJi(A,W);this.UHi(A,W);W=[Li.a("Point",5,0,1584,1)];this.VHi(A,W);this.OHi(A,W);this.CIi(A);return A}wUl(A){this.DRl(A);this.pVl(A);this.SRl(A);this.TRl(A);this.BRl(A);this.JTl(A)}LQi(){const A={};A[hf.a.vE.id.toString()]=Object(n.a)(this.OB,this.OB.P$j,"justificationChangedHandler");A[hf.a.NJb.id.toString()]=
Object(n.a)(this.OB,this.OB.ogh,"paraIndentLeftChangedHandler");A[hf.a.OJb.id.toString()]=Object(n.a)(this.OB,this.OB.ogh,"paraIndentLeftChangedHandler");A[hf.a.Wga.id.toString()]=Object(n.a)(this.OB,this.OB.f5e,"specialIndentChangedHandler");A[hf.a.wPb.id.toString()]=Object(n.a)(this.OB,this.OB.f5e,"specialIndentChangedHandler");A[hf.a.xPb.id.toString()]=Object(n.a)(this.OB,this.OB.f5e,"specialIndentChangedHandler");A[hf.a.Jx.id.toString()]=Object(n.a)(this.OB,this.OB.Rbk,"lineSpacingChangedHandler");
A[hf.a.RJb.id.toString()]=Object(n.a)(this.OB,this.OB.rgh,"paraSpacingAfterChangedHandler");A[hf.a.QJb.id.toString()]=Object(n.a)(this.OB,this.OB.rgh,"paraSpacingAfterChangedHandler");A[hf.a.UJb.id.toString()]=Object(n.a)(this.OB,this.OB.tgh,"paraSpacingBeforeChangedHandler");A[hf.a.TJb.id.toString()]=Object(n.a)(this.OB,this.OB.tgh,"paraSpacingBeforeChangedHandler");return A}CIi(A){var W=hg.Bnj(this.kfa),oa="multiple"===W;A.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:Li.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:W,["allowFreeForm"]:!1};W=0;let xa=!1;this.kfa.Ta(hf.a.Jx)&&
oa&&(W=this.kfa.eb(hf.a.Jx),0<=W&&(xa=!0));oa=[Li.a("none",0,0,9.99,.5)];oa={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:oa,["numberFormatInfo"]:this.Rva,["validReservedValues"]:[""]};oa.value=xa?W:"";A.atSpinButtonProps=oa}OHi(A,W){A.afterSpacingSpinButtonProps=hg.kud(hg.k6f(this.kfa,hf.a.RJb,hf.a.QJb),{["type"]:"AppSpinButtonProps",
["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:rg.a.l3b(5),["validUnits"]:W,["numberFormatInfo"]:this.Rva,["validReservedValues"]:[""]})}VHi(A,W){A.beforeSpacingSpinButtonProps=hg.kud(hg.k6f(this.kfa,hf.a.UJb,hf.a.TJb),{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:rg.a.l3b(5),["validUnits"]:W,["numberFormatInfo"]:this.Rva,["validReservedValues"]:[""]})}UHi(A,W){let oa,xa;({Hfh:xa,Ifh:oa}=hg.Y9f(this.kfa,hf.a.OJb,hf.a.NJb,!1));W={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:rg.a.l3b(oa),["validUnits"]:W,["numberFormatInfo"]:this.Rva,["validReservedValues"]:[""]};W=hg.kud(xa,W);A.beforeTextSpinButtonProps=
W}dJi(A,W){var oa={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:Li.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},xa=this.kfa.Ta(hf.a.Wga)?this.kfa.eb(hf.a.Wga):-1;hg.hug(xa)?
oa.selectedKey=xa.toString():oa.defaultSelectedKey="";A.specialIndentationComboBoxProps=oa;({Hfh:oa,Ifh:xa}=hg.Y9f(this.kfa,hf.a.xPb,hf.a.wPb,1!==xa&&2!==xa));W={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:rg.a.l3b(xa),["validUnits"]:W,["numberFormatInfo"]:this.Rva};W=hg.kud(oa,W);A.bySpinButtonProps=W}PHi(A){const W={["type"]:"AppComboBoxProps",
["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:Li.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},oa=this.kfa.Ta(hf.a.vE)?this.kfa.eb(hf.a.vE):0;hg.M1j(oa)?W.selectedKey=
oa.toString():W.defaultSelectedKey="";A.alignmentComboBoxProps=W}BIi(A){A.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};A.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};A.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,
["forId"]:"SpacingGroup"}}JTl(A){if(A.lineSpacingComboBoxProps){var W=A.lineSpacingComboBoxProps;const oa=W.selectedKey?W.selectedKey.toString():"";W=Li.c(oa);"multiple"===oa&&(A=A.atSpinButtonProps)&&(W=parseFloat(A.value.toString()));this.L$.setValue(hf.a.Jx,W);this.L$.setValue(hf.a.CX,2)}}BRl(A){if(A.afterSpacingSpinButtonProps){A=A.afterSpacingSpinButtonProps;var W=rg.a.k3b(A.unitType.toString().toLowerCase());""!==A.value.toString()&&(W=4===W?2:4,this.L$.setValue(hf.a.RJb,parseInt(A.value.toString())),
this.L$.setValue(hf.a.QJb,W))}}TRl(A){if(A.beforeSpacingSpinButtonProps){A=A.beforeSpacingSpinButtonProps;var W=rg.a.k3b(A.unitType.toString().toLowerCase());""!==A.value.toString()&&(W=4===W?2:4,this.L$.setValue(hf.a.UJb,parseInt(A.value.toString())),this.L$.setValue(hf.a.TJb,W))}}SRl(A){if(A.beforeTextSpinButtonProps){var W=A.beforeTextSpinButtonProps;A=rg.a.k3b(W.unitType.toString().toLowerCase());if(""!==W.value.toString()){W=parseFloat(W.value.toString());let oa;2===A?oa=2:(oa=1,W=rg.a.hOh(W,
A));this.L$.setValue(hf.a.OJb,W);this.L$.setValue(hf.a.NJb,oa)}}}pVl(A){var W=A.bySpinButtonProps,oa=A.didChangeSpecialIndentationComboBoxValue;if(W&&""!==W.value.toString()||oa)if(A.specialIndentationComboBoxProps&&(A=A.specialIndentationComboBoxProps,oa=-1,A.selectedKey&&(A=A.selectedKey.toString(),oa=parseInt(A)),hg.hug(oa)&&this.L$.setValue(hf.a.Wga,oa)),W){A=parseFloat(W.value.toString());W=rg.a.k3b(W.unitType.toString().toLowerCase());if(0>A||isNaN(A))A=0;2===W?oa=2:(oa=1,A=rg.a.hOh(A,W));this.L$.setValue(hf.a.xPb,
A);this.L$.setValue(hf.a.wPb,oa)}}DRl(A){A.alignmentComboBoxProps&&(A=A.alignmentComboBoxProps,A.selectedKey&&(A=parseInt(A.selectedKey.toString()),0<=A&&this.L$.setValue(hf.a.vE,A)))}static k6f(A,W,oa){if(A.Ta(W)&&A.Ta(oa)){oa=A.eb(oa);if(2!==oa&&4!==oa)return Number.NaN;A=A.eb(W);2===oa&&(A*=hg.vTk);return A}return Number.NaN}static kud(A,W){W.value=isNaN(A)?"":A;return W}static Pae(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static Y9f(A,W,oa,xa){let Ia=3;Ff.a("BySpinButtonDefaultvalueFix")&&xa?W=0:A.Ta(W)&&A.Ta(oa)&&!xa?(W=A.eb(W),2===A.eb(oa)?Ia=2:W=rg.a.SXl(W,Ia)):W=Number.NaN;return{Hfh:W,Ifh:Ia}}static M1j(A){return 1===A||2===A||3===A||6===A}static hug(A){return 1===A||2===A||0===A}static Bnj(A){if(hg.aLj(A)){A=A.eb(hf.a.Jx);var W="multiple";Ej.a.vz(A,1)?W="1.00":Ej.a.vz(A,1.5)?W="1.50":Ej.a.vz(A,2)&&(W="2.00");return W}}static aLj(A){return A.Ta(hf.a.Jx)&&
A.Ta(hf.a.CX)&&2===A.eb(hf.a.CX)?!0:!1}}hg.vTk=72;Object(h.a)(hg,"ReactParagraphDialog",mb.a,[]);class Lh{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd){this.mxe=[];this.ia=A;this.pa=W;this.Dfa=oa;this.Q$=xa;this.Fb=Ia;this.Hh=qb;this.wIa=Hb;this.Ga=hc;this.OB=Jc;this.Afa=ld;this.u2g=wd}vb(){this.ia.ra(bd.a.KCb,Nc.a.application,Object(n.a)(this,this.PPk,"paragraphDialogHandler"),4);this.ia.ra(bd.a.hOf,Nc.a.application,Object(n.a)(this,this.QGi,"commitParagraphDialogHandler"),4);this.ia.ra(bd.a.Xlh,Nc.a.view,
Ah.a.P1,96);this.ia.ra(bd.a.Nlh,Nc.a.view,Ah.a.P1,96);this.ia.ra(bd.a.jmh,Nc.a.view,Ah.a.P1,96);this.ia.ra(bd.a.kmh,Nc.a.view,Ah.a.P1,96);this.ia.ra(bd.a.imh,Nc.a.view,Ah.a.P1,96);this.ia.ra(bd.a.hmh,Nc.a.view,Ah.a.P1,96);this.ia.ra(bd.a.Rlh,Nc.a.view,Ah.a.P1,96);this.ia.ra(bd.a.Slh,Nc.a.view,Ah.a.P1,96);this.ia.ya(bd.a.ufh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.UGh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.rlg,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.XGh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.WGh,Nc.a.view,Ah.a.sH);
this.ia.ya(bd.a.vfh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.wfh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.qfh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.VGh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.pfh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.yfh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.xfh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.YGh,Nc.a.view,Ah.a.sH);this.ia.ya(bd.a.eod,Nc.a.paragraph,Object(n.a)(this,this.gsj,"getPropertiesForParagraphDialog"));this.ia.ya(bd.a.eod,Nc.a.view,this.Afa);this.ia.ie(bd.a.eod,96)}me(){}PPk(A,W,oa){if(this.pa.Js()||
this.pa.J9())return 16;A=this.pa.Ud();if(!this.Ga.a0(A,!0).length&&!this.pa.Lla())return 16;if(1===oa)return 32;this.u2g&&gd.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.ia.Lp,"PptRibbon.Home"===this.ia.Gsa);Array.clear(this.mxe);this.ia.processAction(bd.a.eod,2);return(oa=ij.APropertySet.Hmj(this.mxe))?((new hg(oa,this.ia,this.OB)).jvd(),32):16}QGi(A,W,oa,xa,Ia){if(1===oa)return 32;if(!(Ia&&Ia.Q_c&&Ia.M5c&&Ia.jTe))return 16;W=this.pa.Fk();this.OB.jQj();
oa=this.Fb.ke(15);try{oa.jc(W),oa.gd=A,Ia.Q_c.equals(Ia.M5c)||this.rFi(),Sh.kYk(Ia.Q_c,Ia.M5c,new jj(Ia.jTe.value))}finally{oa&&oa.dispose()}if(this.u2g){let qb;({dVh:A,eVh:Ia,gVh:W,fVh:oa,cVh:xa,hVh:qb}=this.OB.xJl());gd.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",A,Ia,W,oa,xa,qb)}Wf.a.KP(!0,!0);return 32}gsj(A,W,oa){if(1===oa)return 32;W=W.node;A=new Dj.DictionaryPropertySet;
A.setValue(hf.a.vE,this.Hh.IL(W));oa=this.Dfa.qUa(W);A.setValue(hf.a.CX,oa.unit);A.setValue(hf.a.Jx,oa.value);oa=this.Dfa.fX(W);A.setValue(hf.a.TJb,oa.beforeSpacing.unit);A.setValue(hf.a.UJb,oa.beforeSpacing.value);A.setValue(hf.a.QJb,oa.afterSpacing.unit);A.setValue(hf.a.RJb,oa.afterSpacing.value);oa=this.Q$.k9(W);A.setValue(hf.a.NJb,1);A.setValue(hf.a.OJb,oa.qN);W=this.wIa.BUa(W);A.setValue(hf.a.Wga,W.specialIndentType);A.setValue(hf.a.wPb,W.unit);A.setValue(hf.a.xPb,W.value);this.mxe.push(A);return 32}rFi(){if(this.pa.vH()){var A=
this.pa.Ud();A=this.Ga.a0(A);for(const W of A)W.Fta()}}}Object(h.a)(Lh,"ParagraphDialogActor",null,[268]);var La;(function(A){A[A.unspecified=-1]="unspecified";A[A.none=0]="none";A[A.left=1]="left";A[A.center=2]="center";A[A.right=3]="right";A[A.inner=4]="inner";A[A.outer=5]="outer";A[A.both=6]="both";A[A.distribute=7]="distribute";A[A.margin=8]="margin";A[A.highKashida=9]="highKashida";A[A.lowKashida=10]="lowKashida";A[A.mediumKashida=11]="mediumKashida";A[A.numTab=12]="numTab";A[A.thaiDistribute=
13]="thaiDistribute";A[A.start=14]="start";A[A.end=15]="end"})(La||(La={}));Object(h.b)("Justification",La);var lb=d(588);class Ob{constructor(){this.value=this.unit=0}}Object(h.a)(Ob,"ParagraphSpacingCommandData",null,[]);class mc{constructor(){this.QGh=this.pgh=this.sgh=this.ugh=!1}}Object(h.a)(mc,"PptPropertySetChangedState",null,[]);class Rc{constructor(A){this.wre=this.Ape=this.ure=this.vre=this.Ppe=this.Hpe=!1;this.Whc={};this.ia=A;this.oQj()}P$j(A,W,oa){oa&&(A=this.Whc[La[oa]],void 0!==A&&
null!==A&&(this.ia.processAction(A,2),this.Hpe=!0))}Rbk(A,W,oa){void 0!==oa&&null!==oa&&(this.ia.Ja(bd.a.zoa,2,oa),this.Ppe=!0)}tgh(A,W,oa,xa){void 0!==oa&&null!==oa&&(A=Rc.eVc(xa),!A.ugh&&null!==xa&&xa.GQ.Ta(hf.a.TJb)&&xa.GQ.Ta(hf.a.UJb)&&(W=xa.GQ.eb(hf.a.UJb),xa=xa.GQ.eb(hf.a.TJb),A.ugh=!0,this.ia.Ja(bd.a.Flb,2,Object.assign(new Ob,{value:W,unit:xa})),this.vre=!0))}rgh(A,W,oa,xa){void 0!==oa&&null!==oa&&(A=Rc.eVc(xa),!A.sgh&&null!==xa&&xa.GQ.Ta(hf.a.QJb)&&xa.GQ.Ta(hf.a.RJb)&&(W=xa.GQ.eb(hf.a.RJb),
xa=xa.GQ.eb(hf.a.QJb),A.sgh=!0,this.ia.Ja(bd.a.Elb,2,Object.assign(new Ob,{value:W,unit:xa})),this.ure=!0))}ogh(A,W,oa,xa){void 0!==oa&&null!==oa&&(W=Rc.eVc(xa),!W.pgh&&null!==xa&&xa.GQ.Ta(hf.a.NJb)&&xa.GQ.Ta(hf.a.OJb)&&(A=xa.GQ.eb(hf.a.OJb),xa=xa.GQ.eb(hf.a.NJb),W.pgh=!0,W=new lb.a,W.unit=xa,W.value=A,this.ia.Ja(bd.a.qla,2,W),this.Ape=!0))}f5e(A,W,oa,xa){void 0!==oa&&null!==oa&&(oa=Rc.eVc(xa),!oa.QGh&&null!==xa&&xa.GQ.Ta(hf.a.wPb)&&xa.GQ.Ta(hf.a.xPb)&&(W=0,xa.GQ.Ta(hf.a.Wga)&&(W=xa.GQ.eb(hf.a.Wga)),
A=xa.GQ.eb(hf.a.xPb),xa=xa.GQ.eb(hf.a.wPb),oa.QGh=!0,oa=0,1===W?oa=bd.a.tOb:2===W?oa=bd.a.vOb:0===W&&(oa=bd.a.xOb),W=new lb.a,W.unit=xa,W.value=A,this.ia.Ja(oa,2,W),this.wre=!0))}xJl(){return{dVh:this.Hpe,eVh:this.Ppe,gVh:this.vre,fVh:this.ure,cVh:this.Ape,hVh:this.wre}}jQj(){this.wre=this.Ape=this.ure=this.vre=this.Ppe=this.Hpe=!1}oQj(){this.Whc.left=re.a.leftJustify;this.Whc.center=re.a.centerJustify;this.Whc.right=re.a.rightJustify;this.Whc.both=re.a.fullJustify}static eVc(A){A.customData||(A.customData=
new mc);return A.customData}}Object(h.a)(Rc,"ParagraphLevelPropertyChangedHandlers",null,[869]);var Ud=d(542),ue=d(199),Xe=d(272),pe=d(355),gg=d(41),cg=d(51),Sg=d(84),Hh=d(159);class li{constructor(A,W){this.Zwb=A;this.Fh=W}}Object(h.a)(li,"DoNotCheckCritiqueTypeActionData",null,[]);var Oh=d(19);class Wi{x8a(A){return(A=Object(z.a)(li,A))?Object(Oh.a)(pe.a,A.Fh):!1}POe(A,W){if(W=Object(z.a)(li,W)){const oa=W.Fh;oa&&(oa.XMa(A,W.Zwb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",
W.Zwb))}}}Object(h.a)(Wi,"DoNotCheckCritiqueTypeCallback",null,[936]);var Xi=d(473),Fi=d(50);class Mi extends Xi.a{constructor(A,W,oa,xa,Ia,qb,Hb){super();this.OIe=null;this.init(A);this.$l("WholePresentationOperation");this.yFa(L.AFrameworkApplication.Qa,W,oa,xa,Ia);this.bgb=0;this.x4g=Hb;this.iHg=qb;this.PGa=Ia;this.kec=W;this.x8a()?1===this.behavior&&(this.np=32,this.eZ()):(this.np=8,this.eZ())}run(){0===this.bgb&&this.i2e();1===this.bgb&&this.TSe();2===this.bgb&&this.k7e();3===this.bgb&&this.b9d()}x8a(){return this.x4g.x8a(this.PGa)}POe(){this.x4g.POe(this.kec,
this.PGa)}i2e(){this.OIe=new Fi.GraphTransaction(3);this.OIe.jc(this.iHg.node);this.bgb=1}TSe(){this.ux||this.plb(this.iHg.RE);1!==this.Ioa()&&(this.bgb=2)}k7e(){this.POe();this.OIe.dispose();this.bgb=3}b9d(){this.eZ()}}Object(h.a)(Mi,"WholePresentationOperation",Xi.a,[]);var mh=d(52);class ai{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd){this.tFa=!1;this.ia=A;this.uzg=W;this.pG=oa;this.Fb=xa;this.P7c=Ia;this.ua=qb;this.Ga=Hb;this.X$=wd;this.zDe=hc;this.nD=Jc;this.jb=Bd;this.Jed=ld.TBh;this.jok=
ld.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.Hnk=ld.pptHideProofingErrorIsEnabled;this.XRj()}get a4b(){return this.pG.hWa?this.P7c.instance:null}vb(){this.ia.ra(bd.a.jLb,mh.a.application,Object(n.a)(this,this.jLb,"queryLanguage"),96);this.ia.ra(bd.a.uld,mh.a.application,Object(n.a)(this,this.oOk,"openPPTLanguageDialogView"),4);this.pG.Vqg&&this.ia.ra(re.a.x_c,Nc.a.Mf,Object(n.a)(this,this.x_c,"ignoreProofingError"),4);this.pG.Doe&&(this.jok?(this.ia.ya(re.a.xwb,Nc.a.paragraph,Object(n.a)(this,
this.GWf,"doNotCheckThisCritiqueTypeForNode")),this.ia.ya(re.a.xwb,Nc.a.section,Object(n.a)(this,this.GWf,"doNotCheckThisCritiqueTypeForNode")),this.ia.bT(re.a.xwb,Nc.a.Mf,Object(n.a)(this,this.bZi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.ra(bd.a.X4b,Nc.a.Mf,Object(n.a)(this,this.X4b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.ra(re.a.xwb,Nc.a.Mf,Object(n.a)(this,this.X4b,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.Hnk&&(this.ia.ra(bd.a.Wnd,mh.a.application,Object(n.a)(this,
this.Wnd,"queryHideProofingErrors"),100),this.ia.ra(bd.a.Pjg,mh.a.application,Object(n.a)(this,this.vLl,"toggleHideProofingErrors"),4))}me(){}XRj(){this.tFa=ai.Vhe;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.tFa);this.tFa&&this.Mjg(this.tFa)}Wnd(A,W,oa,xa,Ia){if(1===oa)return 32;if(!Ia)return 8;Ia[Ud.a.On]=this.tFa;return 32}vLl(A,W,oa,xa,Ia){if(1===oa)return 32;if(!(Ia&&Ud.a.On in Ia))return 8;this.tFa=Ia[Ud.a.On];ai.Vhe=this.tFa;this.Mjg(this.tFa);e.ULS.sendTraceTag(37237071,
375,50,"User hide proofing errors: {0}",this.tFa);return 32}GWf(A,W,oa,xa,Ia){if(!W)return 8;A=W.node;if(!A)return 8;if(W.contextId===Nc.a.section&&!A.sa(Hh.a.Qoe,!1))return 32;if(W.contextId===Nc.a.paragraph&&A.sa(Hh.a.O4,!1)){W=Object(z.a)(li,Ia);if(!W)return 8;Ia=W.Fh;if(!Ia)return 8;W.Zwb+=this.yqh(A,Ia.typeId,Ia.lcid)}return 2}bZi(A,W,oa,xa,Ia){var qb=this.Rhj();qb=new li(0,qb);this.ia.ii(oa,bd.a.X4b,xa,!1,Ia,qb);oa=cg.a.create(Object(z.a)(Sg.a,this.ua.presentation));e.ULS.sendTraceTag(37012126,
375,50,"User click do not check this critique for whole doc with behavior: {0}",xa);return new Mi(A,W,xa,Ia,qb,oa,new Wi)}X4b(A,W,oa,xa,Ia){A=Object(z.a)(li,Ia);if(!A)return 8;xa=A.Fh;if(!xa)return 8;if(1===oa)return 32;if(!W.node)return 8;e.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",xa.lcid,xa.typeId);A.Zwb+=this.ial(xa.typeId,xa.lcid);this.a4b&&this.a4b.MXi(xa.lcid.toString(),xa.typeId);return 32}x_c(A,W,oa){if(1===oa)return 32;
e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");oa=this.nD.bUa(W);if(!oa||!oa.Fh)return 8;W=W.node;var xa=this.ua.Ba;if(!W||!xa)return 8;xa=this.Fb.ke(ai.rzj(oa));try{xa.jc(W),this.nD.hLa(W,[oa],!0),W.setValue(gg.a.SOf,!0)}finally{xa&&xa.dispose()}oa.Fh.XMa(A,1);this.jb.rWa()||Wf.a.KP(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}Mjg(A){this.X$.W2e=A}Rhj(){var A=this.jb.Pa.nb;if(!A)return null;A=this.nD.bUa(A.Ua);if(!A||!A.Fh)return null;
A=Object(z.a)(pe.a,A.Fh);return!A||0>=A.lcid?null:A}ial(A,W){const oa=new Date;if(!this.ua.Ba)return 0;const xa=this.ua.Ba.yj();if(!xa)return 0;let Ia=0,qb=0;const Hb=this.Fb.ke(3);try{Hb.jc(this.ua.Ba);for(const hc of xa)this.Ga.vG(hc,Jc=>{++qb;Jc.Ta(gg.a.Oo)&&Jc.sa(Hh.a.O4,!1)&&(Ia+=this.yqh(Jc,A,W))})}finally{Hb&&Hb.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-
+oa,qb,xa.length,Ia);return Ia}yqh(A,W,oa){const xa=this.nD.VF(A,Ia=>{Ia=Object(z.a)(pe.a,Ia.Fh);return!!Ia&&Ia.typeId===W&&Ia.lcid===oa});if(ue.a.Xa(xa))return 0;this.nD.hLa(A,xa);return xa.length}jLb(A,W,oa,xa,Ia){Ia.TLc=this.dnj();return 32}dnj(){let A=L.AFrameworkApplication.lcid;if(this.jb.u0(this.jb.Pa)){var W=this.jb.Ud();if(1<W.length||1!==W.length)return"";W=this.Ga.iUa(W[0]);0<W&&(A=W)}else this.jb.Pa.nb&&(W=this.zDe.SWc(this.jb.ak),0<W&&(A=W));return Xe.a.He(A)?Xe.a.He(A).displayName:Xe.a.He(L.AFrameworkApplication.lcid).displayName}U6j(){const A=
this.jb.Ud();return 1===A.length&&A[0].z3c}oOk(A,W,oa){if(2!==oa)return 32;this.Jed&&this.jb.u0(this.jb.Pa)&&this.U6j()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.uzg.value.getInstance(!0).Kuc()):this.jb.Pa.nb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.uzg.value.getInstance(!1).Kuc());return 32}static get Vhe(){const A=ab.a.get("PowerPointHideProofingErrors");return A?"true"===A.toLowerCase():!1}static set Vhe(A){ab.a.qK("PowerPointHideProofingErrors",
A.toString(),30)||e.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",A.toString())}static rzj(A){return 1===A.Fh.proofingType?15:3}}Object(h.a)(ai,"ProofingActor",null,[268]);var Aa=d(275),Ua=d(593);class gb{constructor(A,W){this.Fd=A.toLowerCase();this.variant=W}}Object(h.a)(gb,"ThemeVariant",null,[]);var Eb=d(1081);class Ub{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd,de){this.z8c=null;this.A8c=0;this.rFg=this.y8c=!1;this.dOg=null;this.pub=new gb("",0);this.AIe=
{["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",
["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",
["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=A;this.Fa=W;this.fc=oa;this.pa=Ia;this.Fb=xa;this.Ub=Hb;this.ua=hc;this.ic=Jc;this.Svk=ld;this.lad=wd;this.eJg=Bd;de&&(this.AIe.ThemesOfficeTheme2023="2e142a2c-cd16-42d6-873a-c26d2a0506fa")}vb(){this.ia.ra(bd.a.xv,
mh.a.application,Object(n.a)(this,this.jig,"handleThemeChange"),4);this.ia.ra(bd.a.YCa,mh.a.application,Object(n.a)(this,this.jig,"handleThemeChange"),4);this.ia.ra(bd.a.$nd,mh.a.application,Object(n.a)(this,this.$nd,"queryMoreThemeGallery"),96);this.ia.ra(bd.a.STe,mh.a.application,Object(n.a)(this,this.STe,"queryMoreVariantGallery"),96);this.ia.ra(bd.a.Ty,mh.a.application,Object(n.a)(this,this.Ty,"queryThemes"),97);this.ia.ra(bd.a.Wqc,mh.a.application,Object(n.a)(this,this.Wqc,"queryThemeVariants"),
97);this.ia.ra(bd.a.Wmd,mh.a.application,Object(n.a)(this,this.Wmd,"populateVariantGallery"),96)}me(){}Ty(A,W,oa,xa,Ia){Ia&&Ia.sV&&(A=this.AIe[Ia.sV]===this.MEa().Fd,Ia.p0a.If(A));return 32}Wqc(A,W,oa,xa,Ia){if(Ia&&Ia.sV){A=this.MEa();W=A.Fd;oa=Ia.sV;try{var qb=Number.parseInvariant(oa.substring(oa.length-1,oa.length))}catch(Hb){qb=0}Ia=Ia.p0a;Ia.If(A.variant===qb);qb=Ub.w5f(oa,qb,W);Ia.j4=qb}return 32}$nd(A,W,oa){if(W.contextId!==Nc.a.application)return 2;A=this.pa.Fk();var xa=this.MEa();W=Ub.nzb(xa.Fd);
xa=xa.variant-1;return this.fc.fd(A)?16:1!==oa||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",W,xa),this.ic.rj())?32:8}STe(A,W,oa){if(W.contextId!==Nc.a.application)return 2;var xa=this.pa.Fk();W=this.MEa();A=Ub.nzb(W.Fd);W=W.variant-1;if(this.fc.fd(xa))return 16;if(1===oa)if(oa=Ub.s9b(this.MEa().Fd),xa=this.Svk.Z9j(oa),oa&&xa)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
A,W);else return 16;return 32}jig(A,W,oa,xa,Ia){W=this.pa.Re();xa=this.ua.Ba;if(!xa||A===bd.a.YCa&&this.MEa()===this.pub||this.fc.fd(xa))return 16;if(1===oa)return 32;oa=Object(z.a)(String,Ia);if(null===oa)return 8;Ia=this.AIe[oa];return A===bd.a.xv?this.zSk(xa,Ia,W):A===bd.a.YCa?this.ASk(xa,oa):8}zSk(A,W,oa){if(!A)return 16;1>=this.cQf()||this.eJg&&oa&&1<oa.length?(this.nWd(A,W,0,!1,oa),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",
Ub.nzb(W),0,A.Cb.sid)):(this.z8c=W,this.A8c=0,this.y8c=!1,A=new Ka.StandardDialog,A.Ad=1,A.zP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(n.a)(this,this.ZKf,"changeThemeHandler")));return 32}ASk(A,W){if(!A)return 16;const oa=this.MEa();let xa;try{if(xa=Number.parseInvariant(W.substring(7,W.length))-1,0>xa||xa>Ub.s9b(oa.Fd))xa=-1}catch(Ia){xa=-1}1>=this.cQf()?(this.nWd(A,oa.Fd,xa,!0,null),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",
Ub.nzb(oa.Fd),xa,A.Cb.sid)):(this.z8c=oa.Fd,this.A8c=xa,this.y8c=!0,A=new Ka.StandardDialog,A.Ad=1,A.zP(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(n.a)(this,this.ZKf,"changeThemeHandler")));return 32}MEa(){let A=null;var W=this.ua.Ba;if(W){W=W.mj;const xa=this.ic.bJ();if(xa&&W)for(var oa of xa)if(oa.Id===W){A=oa;break}}if(!A)return this.rFg?this.dOg:this.pub;if(Object(Ff.a)("EnableNonEmptyGuidFixForThemeActor")){if(!A.ThemeFamilyId||Ub.nzb(A.ThemeFamilyId)===
Ub.XIf)return this.pub}else if(!A.ThemeFamilyId||A.ThemeFamilyId===Ub.Lxi)return this.pub;oa="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===A.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===A.ThemeFamilyId;return!this.lad&&oa?this.pub:new gb(A.ThemeFamilyId,A.VariantIndex+1)}cQf(){const A=this.ic.bJ();let W=0;if(A)for(const oa of A)oa.InContent&&(W+=1);return W}ZKf(A){const W=this.ua.Ba;if(W){var oa=this.z8c,xa=this.A8c,Ia=this.y8c;this.z8c=null;this.A8c=-1;this.y8c=!1;1===A&&(this.nWd(W,oa,xa,
Ia,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Ub.nzb(oa),xa,W.Cb.sid))}}nWd(A,W,oa,xa,Ia){this.dOg=(this.rFg=xa)?new gb(W,0):this.pub;const qb=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},void 0,!0);try{if(qb.jc(A),qb.gd=xa?bd.a.YCa:bd.a.xv,this.eJg&&Ia)for(const Hb of Ia)Hb.setValue(Jh.a.a8e,W),Hb.setValue(Jh.a.Kba,oa),Hb.setValue(Jh.a.ypi,1<Ia.length);else A.setValue(Jh.a.a8e,W),A.setValue(Jh.a.Kba,oa)}finally{qb&&
qb.dispose()}this.fc.c1b(this.Ub.Gf,A,"ChangeTheme")}Wmd(A,W,oa,xa,Ia){if(1===oa)return 32;A=Math.max(Ub.s9b(this.MEa().Fd),4);W=this.MEa().Fd;Ia.MenuItems=Ub.Fsj(A,W);return 32}static s9b(A){for(let W=0;W<Eb.a.Dza.length;++W)if(Eb.a.Dza[W].iTc===A)return Eb.a.Dza[W].lbf;return 0}static nzb(A){for(let W=0;W<Eb.a.Dza.length;++W)if(Eb.a.Dza[W].iTc===A)return Eb.a.Dza[W].OOh;return Ub.XIf}static j6i(A){let W="";for(let oa=0;oa<Eb.a.Dza.length;++oa)Eb.a.Dza[oa].iTc===A&&(W=Eb.a.Dza[oa].OOh.replace(" ",
""));return W}static Fsj(A,W){const oa=Object.assign(new Kg.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var xa=Object.assign(new Aa.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(oa.MenuSectionList,xa);const Ia=Object.assign(new Ua.a,{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(xa.ControlList,
Ia);for(xa=1;xa<=A;++xa)Array.add(Ia.GalleryItems,Ub.w5f("Variant"+xa,xa,W));return oa}static w5f(A,W,oa){oa=!Ub.s9b(oa)||W>Ub.s9b(oa)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",Ub.j6i(oa),W);return Object.assign(new pd.a,{Id:A,ExternalId:A,Icon:oa,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,W),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}
Ub.Lxi="00000000-0000-0000-0000-000000000000";Ub.XIf="Unsupported Theme";Object(h.a)(Ub,"ThemeActor",null,[268]);var vc=d(482);class jd{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd){this.ia=A;this.Ub=W;this.ua=oa;this.pa=Ia;this.Fa=qb;this.Fb=xa;this.Gn=Hb;this.fc=hc;this.bMg=Jc.R3j;this.En=Jc.fD;this.tad=Jc.V4j;this.kjc=ld.qk(Ye.a.umd);this.Eb=wd}vb(){this.tad?(this.bMg?(this.ia.ra(bd.a.kk,Nc.a.application,Object(n.a)(this,this.htl,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.ra(bd.a.Sj,
Nc.a.application,Object(n.a)(this,this.Y_k,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.ra(bd.a.vpa,Nc.a.application,Object(n.a)(this,this.itl,"setSlidesTransitionGalleryExisting"),5),this.ia.ra(bd.a.iza,Nc.a.application,Object(n.a)(this,this.jtl,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.ra(bd.a.Moa,Nc.a.application,Object(n.a)(this,this.Z_k,"querySlidesTransitionGalleryExisting"),97),this.ia.ra(bd.a.uya,Nc.a.application,Object(n.a)(this,this.$_k,"querySlidesTransitionGalleryExistingInMenu"),
97)):(this.ia.ra(bd.a.kk,Nc.a.application,Object(n.a)(this,this.B1e,"setSlidesTransitionGallery"),5),this.ia.ra(bd.a.Sj,Nc.a.application,Object(n.a)(this,this.iUe,"querySlidesTransitionGallery"),97),this.ia.ra(bd.a.vpa,Nc.a.application,Object(n.a)(this,this.B1e,"setSlidesTransitionGallery"),5),this.ia.ra(bd.a.iza,Nc.a.application,Object(n.a)(this,this.B1e,"setSlidesTransitionGallery"),5),this.ia.ra(bd.a.Moa,Nc.a.application,Object(n.a)(this,this.iUe,"querySlidesTransitionGallery"),97),this.ia.ra(bd.a.uya,
Nc.a.application,Object(n.a)(this,this.iUe,"querySlidesTransitionGallery"),97)),this.ia.ra(bd.a.Ptc,Nc.a.application,Object(n.a)(this,this.gtl,"setSlidesTransitionEffectOption"),5),this.ia.ra(bd.a.Pod,Nc.a.application,Object(n.a)(this,this.W_k,"querySlidesTransitionEffectOption"),97),this.ia.ra(bd.a.Tjb,Nc.a.application,Object(n.a)(this,this.X_k,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.ra(bd.a.nKb,Nc.a.application,Object(n.a)(this,this.wUk,"populateSlidesTransitionEffectOptions"),
96),this.ia.ra(bd.a.tya,Nc.a.application,Object(n.a)(this,this.V_k,"querySlidesTransitionDuration"),97),this.ia.ra(bd.a.Ilb,Nc.a.application,Object(n.a)(this,this.ftl,"setSlidesTransitionDuration"),5)):(this.bMg?(this.ia.ra(bd.a.kk,Nc.a.application,Object(n.a)(this,this.cul,"setTransitionGalleryExceptExisting"),5),this.ia.ra(bd.a.Sj,Nc.a.application,Object(n.a)(this,this.p0k,"queryTransitionGalleryExceptExisting"),97),this.ia.ra(bd.a.vpa,Nc.a.application,Object(n.a)(this,this.dul,"setTransitionGalleryExisting"),
5),this.ia.ra(bd.a.iza,Nc.a.application,Object(n.a)(this,this.eul,"setTransitionGalleryExistingInMenu"),5),this.ia.ra(bd.a.Moa,Nc.a.application,Object(n.a)(this,this.Moa,"queryTransitionGalleryExisting"),97),this.ia.ra(bd.a.uya,Nc.a.application,Object(n.a)(this,this.uya,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.ra(bd.a.kk,Nc.a.application,Object(n.a)(this,this.P1e,"setTransitionGallery"),5),this.ia.ra(bd.a.Sj,Nc.a.application,Object(n.a)(this,this.Sj,"queryTransitionGallery"),97),this.ia.ra(bd.a.vpa,
Nc.a.application,Object(n.a)(this,this.P1e,"setTransitionGallery"),5),this.ia.ra(bd.a.iza,Nc.a.application,Object(n.a)(this,this.P1e,"setTransitionGallery"),5),this.ia.ra(bd.a.Moa,Nc.a.application,Object(n.a)(this,this.Sj,"queryTransitionGallery"),97),this.ia.ra(bd.a.uya,Nc.a.application,Object(n.a)(this,this.Sj,"queryTransitionGallery"),97)),this.ia.ra(bd.a.Ptc,Nc.a.application,Object(n.a)(this,this.bul,"setTransitionEffectOption"),5),this.ia.ra(bd.a.Pod,Nc.a.application,Object(n.a)(this,this.o0k,
"queryTransitionEffectOption"),97),this.ia.ra(bd.a.Tjb,Nc.a.application,Object(n.a)(this,this.Tjb,"queryTransitionEffectOptionsAnchor"),100),this.ia.ra(bd.a.nKb,Nc.a.application,Object(n.a)(this,this.nKb,"populateTransitionEffectOptions"),96),this.ia.ra(bd.a.tya,Nc.a.application,Object(n.a)(this,this.tya,"queryTransitionDuration"),97),this.ia.ra(bd.a.Ilb,Nc.a.application,Object(n.a)(this,this.Ilb,"setTransitionDuration"),5));this.ia.ra(bd.a.Hlb,Nc.a.application,Object(n.a)(this,this.Hlb,"setTransitionApplyAll"),
4);this.ia.ra(bd.a.QLb,Nc.a.application,Object(n.a)(this,this.QLb,"queryTransitionApplyAll"),96)}me(){}nKb(A,W,oa,xa,Ia){if(this.En&&1!==this.pa.Re().length)return 16;if(1===oa)return 32;A=(A=this.ua.Ba)?A.gp:null;if(!A)return 16;if(!Ia)return 8;A=this.Gn.pzb(A);A.next&&(Ia.MenuItems=this.IHf(A));return 32}Sj(A,W,oa,xa,Ia){if(!Ia)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;W=this.Gn.PQ(Ia);if(!W)return 8;A.CEa=jd.l$d(W.wc,W.sc,this.kjc);W=this.ua.Ba;if(!W)return 16;1===oa&&((oa=W.gp)?(oa=this.Gn.FUa(oa),
A.qV(!oa&&"TransitionExisting"===Ia||oa===Ia)):A.qV("TransitionNone"===Ia));return 32}p0k(A,W,oa,xa,Ia){if(!Ia||A!==bd.a.Sj)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;W=this.Gn.PQ(Ia);if(!W)return 8;xa=W.wc.split("_")[1]+"_24";W=jd.JTa(Ia,Ia,xa,"2024601249","149145197",W.sc,W.sc);A.j4=W;W=this.ua.Ba;if(!W)return 16;1===oa&&((oa=W.gp)?(oa=this.Gn.FUa(oa),A.qV(oa===Ia)):A.qV("TransitionNone"===Ia));return 32}Moa(A,W,oa,xa,Ia){if(!Ia||A!==bd.a.Moa)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;
if(!Ia||"TransitionExisting"!==Ia)return 16;W=this.Gn.PQ(Ia);if(!W)return 8;xa=W.wc.split("_")[1]+"_24";W=jd.JTa(Ia,Ia,xa,"3752636652","3476251476",W.sc,W.sc);A.j4=W;W=this.ua.Ba;if(!W)return 16;if(1===oa&&(oa=W.gp)){oa=this.Gn.FUa(oa);W=this.Gn.v4c(oa,this.Gn.yyb());if(oa&&!W){xa=this.Gn.PQ(oa);if(!xa)return 8;const qb=xa.wc.split("_")[1]+"_24";Ia=jd.JTa(Ia,Ia,qb,"3752636652","3476251476",xa.sc,xa.sc);A.j4=Ia}A.qV(!oa||!!oa&&!W)}return 32}uya(A,W,oa,xa,Ia){if(!Ia||A!==bd.a.uya)return 8;A=Ia.queryResult;
Ia=Ia.SourceControlId;if(!Ia||"TransitionExistingInMenu"!==Ia)return 16;W=this.Gn.PQ(Ia);if(!W)return 8;xa=W.wc.split("_")[1]+"_24";Ia=jd.JTa(Ia,Ia,xa,"4036532528","2831233208",W.sc,W.sc);A.j4=Ia;Ia=this.ua.Ba;if(!Ia)return 16;1===oa&&(oa=Ia.gp)&&(oa=this.Gn.FUa(oa),A.qV(!oa));return 32}Tjb(A,W,oa){A=this.ua.Ba;if(!A)return 16;A=this.Gn.pzb(A.gp);return!A||!A.next||this.En&&1!==this.pa.Re().length?16:1===oa?32:8}P1e(A,W,oa,xa,Ia){if(!Ia)return 8;W=Ia.SourceControlId;Ia=A===bd.a.vpa||A===bd.a.iza;
xa=this.ua.Ba;if(!xa||this.fc.fd(xa)||this.En&&1!==this.pa.Re().length)return 16;var qb=xa.gp;const Hb=!!this.Gn.EUa(qb);if(Ia&&(!qb||Hb))return 16;if(1===oa)return 32;qb=this.Gn.PQ(W);if(!qb)return 8;if(!Ia&&2===oa&&W){Wf.a.yk("SlideCount","1");oa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{oa.jc(xa),oa.gd=A,xa.gp=qb.tc}finally{oa&&oa.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
W,qb.next||"null",xa.Cb.sid)}return 32}cul(A,W,oa,xa,Ia){if(!Ia)return 8;W=Ia.SourceControlId;xa=this.ua.Ba;if(!xa)return 16;if(A!==bd.a.kk)return 8;if(this.fc.fd(xa)||this.En&&1!==this.pa.Re().length)return 16;if(1===oa)return 32;Ia=this.Gn.PQ(W);if(!Ia)return 8;if(2===oa&&W){Wf.a.yk("SlideCount","1");oa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{oa.jc(xa),oa.gd=A,xa.gp=Ia.tc}finally{oa&&oa.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
W,Ia.next||"null",xa.Cb.sid)}return 32}dul(A,W,oa,xa,Ia){if(!Ia)return 8;W=this.ua.Ba;if(!W)return 16;if(A!==bd.a.vpa)return 8;if(this.En&&1!==this.pa.Re().length)return 16;if(1!==oa)return 8;A=W.gp;oa=!!this.Gn.EUa(A);W=this.Gn.pzb(A);W=this.Gn.v4c(W?W.parent:null,this.Gn.yyb());return A&&!oa||!W?32:16}eul(A,W,oa,xa,Ia){if(!Ia)return 8;W=this.ua.Ba;if(!W)return 16;if(A!==bd.a.iza)return 8;if(this.En&&1!==this.pa.Re().length)return 16;if(1!==oa)return 8;A=W.gp;oa=!!this.Gn.EUa(A);return!A||oa?16:
32}Hlb(A,W,oa){W=this.ua.Ba;if(!W||this.fc.fd(W)||this.En&&1!==this.pa.Re().length)return 16;if(1===oa)return 32;Wf.a.yk("SlideCount","1");oa=this.Ub.Gf;const xa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{xa.jc(oa),xa.gd=A,oa.utb=W.Cb}finally{xa&&xa.dispose()}e.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}QLb(A,W,oa,xa,Ia){A=this.ua.Ba?!0:!1;if(!Ia)return 8;Ia=Ia.queryResult;Ia.CEa=jd.l$d("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,
this.kjc);Ia.qV(A);return A?32:16}bul(A,W,oa,xa,Ia){if(!Ia)return 8;W=Ia.MenuItemId;if(this.En&&1!==this.pa.Re().length)return 16;if(1===oa)return 32;oa=this.ua.Ba;if(!oa||this.fc.fd(oa))return 16;xa=oa?oa.gp:null;Ia=this.Gn.PQ(W);if(!xa||!Ia||!Ia.tc)return 16;xa.TransitionType=Ia.tc.TransitionType;xa.Direction=Ia.tc.Direction;xa.Duration=Ia.tc.Duration;Wf.a.yk("SlideCount","1");const qb=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{qb.jc(oa),qb.gd=A,oa.gp=xa}finally{qb&&qb.dispose()}e.ULS.sendTraceTag(512499932,
801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Ia.parent,W,oa.Cb.sid);return 32}o0k(A,W,oa,xa,Ia){if(!Ia)return 8;A=Ia.queryResult;Ia=Ia.MenuItemId;W=this.ua.Ba;if(!W)return 16;1===oa&&A.If(this.Gn.EUa(W.gp)===Ia);return 32}tya(A,W,oa,xa,Ia){A=this.ua.Ba;if(!A)return 16;if(!Ia)return 8;A=A.gp;if(Ia=Ia.queryResult)Ia.nba=A?(A.Duration/1E3).toString():"0";return 32}Ilb(A,W,oa,xa,Ia){W=this.ua.Ba;if(!W||this.fc.fd(W))return 16;
if(!Ia)return 8;if(this.En&&1!==this.pa.Re().length)return 16;xa=Math.floor(1E3*Ia.Number);Ia=W.gp;if(!Ia)return 16;Wf.a.Kb&&(Wf.a.Kb.actionName="SetTransitionDuration");if(1===oa)return"TransitionNone"===this.Gn.FUa(Ia)?16:32;if(2===oa){Ia.Duration=xa;const qb=this.Fa.Ee;Wf.a.yk("SlideCount","1");oa=this.Fb.yd(15,void 0,()=>{this.pa.nj();!qb||qb.name!==Jf.a.qg&&qb.name!==Jf.a.Qz||this.Fa.Bd()});try{oa.jc(W),oa.gd=A,W.gp=Ia}finally{oa&&oa.dispose()}}return 32}wUk(A,W,oa,xa,Ia){if(1===oa)return 32;
if(!Ia)return 8;W=this.pa.Re();if(!W||!W.length)return 16;A=W[0].gp;if(!A)return 16;A=this.Gn.pzb(A);if(1<W.length)for(const qb of W){W=qb.gp;if(!W)return 16;W=this.Gn.pzb(W);if(A.parent!==W.parent)return 16}A.next&&(Ia.MenuItems=this.IHf(A));return 32}iUe(A,W,oa,xa,Ia){if(!Ia)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;W=this.Gn.PQ(Ia);if(!W)return 8;A.CEa=jd.l$d(W.wc,W.sc,this.kjc);W=this.pa.Re();if(!W||!W.length)return 16;1===oa&&(oa="",({Upa:oa}=this.HSa(W)).returnValue&&A.qV(!oa&&"TransitionExisting"===
Ia||oa===Ia));return 32}Y_k(A,W,oa,xa,Ia){if(!Ia||A!==bd.a.Sj)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;W=this.Gn.PQ(Ia);if(!W)return 8;xa=W.wc.split("_")[1]+"_24";W=jd.JTa(Ia,Ia,xa,"2024601249","149145197",W.sc,W.sc);A.j4=W;W=this.pa.Re();if(!W||!W.length)return 16;1===oa&&(oa="",({Upa:oa}=this.HSa(W)).returnValue&&A.qV(oa===Ia));return 32}Z_k(A,W,oa,xa,Ia){if(!Ia||A!==bd.a.Moa)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExisting"!==Ia)return 16;W=this.Gn.PQ(Ia);if(!W)return 8;
xa=W.wc.split("_")[1]+"_24";W=jd.JTa(Ia,Ia,xa,"3752636652","3476251476",W.sc,W.sc);A.j4=W;W=this.pa.Re();if(!W||!W.length)return 16;if(1===oa&&(oa="",({Upa:oa}=this.HSa(W)).returnValue)){W=this.Gn.v4c(oa,this.Gn.yyb());if(oa&&!W){xa=this.Gn.PQ(oa);if(!xa)return 8;const qb=xa.wc.split("_")[1]+"_24";Ia=jd.JTa(Ia,Ia,qb,"3752636652","3476251476",xa.sc,xa.sc);A.j4=Ia}A.qV(!oa||!!oa&&!W)}return 32}$_k(A,W,oa,xa,Ia){if(!Ia||A!==bd.a.uya)return 8;A=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExistingInMenu"!==
Ia)return 16;W=this.Gn.PQ(Ia);if(!W)return 8;xa=W.wc.split("_")[1]+"_24";Ia=jd.JTa(Ia,Ia,xa,"4036532528","2831233208",W.sc,W.sc);A.j4=Ia;Ia=this.pa.Re();if(!Ia||!Ia.length)return 16;1===oa&&(oa="",({Upa:oa}=this.HSa(Ia)).returnValue&&A.qV(!oa));return 32}X_k(A,W,oa){A=this.pa.Re();if(!A||!A.length)return 16;W=this.Gn.pzb(A[0].gp);return!W||!W.next||1<A.length&&!this.HSa(A).returnValue?16:1===oa?32:8}B1e(A,W,oa,xa,Ia){if(!Ia)return 8;W=Ia.SourceControlId;Ia=A===bd.a.vpa||A===bd.a.iza;xa=this.pa.Re();
if(!xa||!xa.length)return 16;for(var qb of xa)if(this.fc.fd(qb))return 16;qb="";const Hb=({Upa:qb}=this.HSa(xa)).returnValue;if(Ia&&(!Hb||qb))return 16;if(1===oa)return 32;qb=this.Gn.PQ(W);if(!qb)return 8;if(!Ia&&2===oa&&W){Wf.a.yk("SlideCount",xa.length.toString());oa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{oa.jc(this.Ub.Gf);oa.gd=A;for(const hc of xa)hc.gp=qb.tc}finally{oa&&oa.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
W,qb.next||"null")}return 32}htl(A,W,oa,xa,Ia){if(!Ia)return 8;W=Ia.SourceControlId;if(A!==bd.a.kk)return 8;xa=this.pa.Re();if(!xa||!xa.length)return 16;for(var qb of xa)if(this.fc.fd(qb))return 16;if(1===oa)return 32;qb=this.Gn.PQ(W);if(!qb)return 8;if(2===oa&&W){Wf.a.yk("SlideCount",xa.length.toString());oa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()},()=>{1===this.Eb.al&&this.Fa.wj(Jf.a.nC,!0)});try{oa.jc(this.Ub.Gf);oa.gd=A;for(const Hb of xa)Hb.gp=qb.tc}finally{oa&&oa.dispose()}e.ULS.sendTraceTag(512499930,
801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",W,qb.next||"null")}return 32}itl(A,W,oa,xa,Ia){if(!Ia)return 8;W=this.pa.Re();if(!W||!W.length)return 16;if(A!==bd.a.vpa||1!==oa)return 8;xa="";A=({Upa:xa}=this.HSa(W)).returnValue;oa=!!xa;W=xa&&0<xa.length?this.Gn.PQ(xa):null;W=this.Gn.v4c(W?W.parent:null,this.Gn.yyb());return!A||oa&&W?16:32}jtl(A,W,oa,xa,Ia){if(!Ia)return 8;W=this.pa.Re();if(!W||!W.length)return 16;if(A!==bd.a.iza||1!==oa)return 8;
A="";return!({Upa:A}=this.HSa(W)).returnValue||A?16:32}gtl(A,W,oa,xa,Ia){if(!Ia)return 8;W=Ia.MenuItemId;if(1===oa)return 32;oa=this.pa.Re();if(!oa||!oa.length)return 16;for(var qb of oa)if(this.fc.fd(qb)||!qb.gp)return 16;qb=this.Gn.PQ(W);if(!qb||!qb.tc)return 16;Wf.a.yk("SlideCount",oa.length.toString());xa=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{xa.jc(this.Ub.Gf);xa.gd=A;for(const Hb of oa){let hc=Hb.gp;hc.TransitionType=qb.tc.TransitionType;hc.Direction=qb.tc.Direction;hc.Duration=
qb.tc.Duration;Hb.gp=hc}}finally{xa&&xa.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",qb.parent,W);return 32}W_k(A,W,oa,xa,Ia){if(!Ia)return 8;A=Ia.queryResult;Ia=Ia.MenuItemId;W=this.pa.Re();if(!W||!W.length)return 16;1===oa&&(oa="",({Upa:oa}=this.jZi(W)).returnValue&&A.If(oa===Ia));return 32}V_k(A,W,oa,xa,Ia){if(!Ia)return 8;A=this.pa.Re();if(!A||!A.length)return 16;if(Ia=Ia.queryResult)A=jd.pwj(A),
Ia.nba=A;return 32}ftl(A,W,oa,xa,Ia){if(!Ia)return 8;W=this.pa.Re();if(!W||!W.length)return 16;for(const qb of W)if(this.fc.fd(qb))return 16;Ia=Math.floor(1E3*Ia.Number);for(const qb of W)if(!qb.gp)return 16;Wf.a.Kb&&(Wf.a.Kb.actionName="SetTransitionDuration");if(1===oa){for(const qb of W)if("TransitionNone"===this.Gn.FUa(qb.gp))return 16;return 32}if(2===oa){const qb=this.Fa.Ee;Wf.a.yk("SlideCount",W.length.toString());oa=this.Fb.yd(15,void 0,()=>{this.pa.nj();!qb||qb.name!==Jf.a.qg&&qb.name!==
Jf.a.Qz||this.Fa.Bd()});try{oa.jc(this.Ub.Gf);oa.gd=A;for(const Hb of W){const hc=Hb.gp;hc.Duration=Ia;Hb.gp=hc}}finally{oa&&oa.dispose()}}return 32}HSa(A){let W;W="";if(!A||!A.length)return{returnValue:!1,Upa:W};W=this.Gn.FUa(A[0].gp);let oa=!0;if(1<A.length)for(const xa of A)if(A=this.Gn.FUa(xa?xa.gp:null),W!==A){oa=!1;break}oa||(W="");return{returnValue:oa,Upa:W}}jZi(A){let W;W="";if(!A||!A.length)return{returnValue:!1,Upa:W};W=this.Gn.EUa(A[0].gp);let oa=!0;if(1<A.length)for(const xa of A)if(A=
this.Gn.EUa(xa?xa.gp:null),W!==A){oa=!1;break}oa||(W="");return{returnValue:oa,Upa:W}}IHf(A){const W=Object.assign(new Kg.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),oa=Object.assign(new Aa.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(W.MenuSectionList,oa);let xa=null;for(A=({key:xa}=this.Gn.Cag(A)).returnValue;A;)Array.add(oa.ControlList,
Object.assign(new vc.a,{Command:"961566706",Id:xa,ExternalId:"TransitionEffectOptions"+xa,QueryCommand:"3535869262"})),{key:xa,returnValue:A}=this.Gn.Cag(A);return W}static pwj(A){let W;if(!A||!A.length)return"0";const oa=A[0].gp;W=oa?(oa.Duration/1E3).toString():"0";let xa=!0;if(1<A.length)for(const Ia of A)if((A=Ia?Ia.gp:null)||oa){if(!A&&oa||A&&!oa){xa=!1;break}if(W!==(A.Duration/1E3).toString()){xa=!1;break}}xa||(W="0");return W}static l$d(A,W,oa){A=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',
A,oa);W=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',W);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',A,W)}static JTa(A,W,oa,xa,Ia,qb,Hb){return Object.assign(new pd.a,{Id:A,ExternalId:W,Icon:oa,Command:xa,QueryCommand:Ia,LabelText:qb,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Hb})}}Object(h.a)(jd,"TransitionActor",null,[268]);var Id=d(1053);class Od{constructor(){this.effectId=
this.effectType=0;this.labelText=this.Ue=this.effectData=this.io=null}}Object(h.a)(Od,"AnimInfo",null,[]);class ba{constructor(){this.Rj=this.labelText=this.Ue=this.id=null}}Object(h.a)(ba,"EffectOption",null,[]);class Da extends ba{constructor(){super();this.value=null}}Object(h.a)(Da,"EffectData",ba,[]);class Qa{constructor(A){this.fXa=A;Qa.Rl||(Qa.Rl=new Id.a,Qa.Rl.add("FromBottom",Object.assign(new ba,{id:"FromBottom",Ue:Qa.nf("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,
Rj:CommonUIStrings.l_AnimationFromBottomKeytip})),Qa.Rl.add("FromBottomLeft",Object.assign(new ba,{id:"FromBottomLeft",Ue:Qa.nf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,Rj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Qa.Rl.add("FromLeft",Object.assign(new ba,{id:"FromLeft",Ue:Qa.nf("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Rj:CommonUIStrings.l_AnimationFromLeftKeytip})),Qa.Rl.add("FromTopLeft",
Object.assign(new ba,{id:"FromTopLeft",Ue:Qa.nf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Rj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Qa.Rl.add("FromTop",Object.assign(new ba,{id:"FromTop",Ue:Qa.nf("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Rj:CommonUIStrings.l_AnimationFromTopKeytip})),Qa.Rl.add("FromTopRight",Object.assign(new ba,{id:"FromTopRight",Ue:Qa.nf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,
Rj:CommonUIStrings.l_AnimationFromTopRightKeytip})),Qa.Rl.add("FromRight",Object.assign(new ba,{id:"FromRight",Ue:Qa.nf("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,Rj:CommonUIStrings.l_AnimationFromRightKeytip})),Qa.Rl.add("FromBottomRight",Object.assign(new ba,{id:"FromBottomRight",Ue:Qa.nf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Rj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Qa.Rl.add("ToBottom",
Object.assign(new ba,{id:"ToBottom",Ue:Qa.nf("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Rj:CommonUIStrings.l_AnimationFromBottomKeytip})),Qa.Rl.add("ToBottomLeft",Object.assign(new ba,{id:"ToBottomLeft",Ue:Qa.nf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Rj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Qa.Rl.add("ToLeft",Object.assign(new ba,{id:"ToLeft",Ue:Qa.nf("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,
Rj:CommonUIStrings.l_AnimationFromLeftKeytip})),Qa.Rl.add("ToTopLeft",Object.assign(new ba,{id:"ToTopLeft",Ue:Qa.nf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,Rj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Qa.Rl.add("ToTop",Object.assign(new ba,{id:"ToTop",Ue:Qa.nf("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Rj:CommonUIStrings.l_AnimationFromTopKeytip})),Qa.Rl.add("ToTopRight",Object.assign(new ba,{id:"ToTopRight",
Ue:Qa.nf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Rj:CommonUIStrings.l_AnimationFromTopRightKeytip})),Qa.Rl.add("ToRight",Object.assign(new ba,{id:"ToRight",Ue:Qa.nf("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,Rj:CommonUIStrings.l_AnimationFromRightKeytip})),Qa.Rl.add("ToBottomRight",Object.assign(new ba,{id:"ToBottomRight",Ue:Qa.nf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,
Rj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Qa.Rl.add("Horizontal",Object.assign(new ba,{id:"Horizontal",Ue:Qa.nf("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Rj:CommonUIStrings.l_AnimationHorizontalKeytip})),Qa.Rl.add("HorizontalIn",Object.assign(new ba,{id:"HorizontalIn",Ue:Qa.nf("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Rj:CommonUIStrings.l_AnimationHorizontalInKeytip})),Qa.Rl.add("HorizontalOut",
Object.assign(new ba,{id:"HorizontalOut",Ue:Qa.nf("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,Rj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),Qa.Rl.add("Vertical",Object.assign(new ba,{id:"Vertical",Ue:Qa.nf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Rj:CommonUIStrings.l_AnimationVerticalKeytip})),Qa.Rl.add("VerticalIn",Object.assign(new ba,{id:"VerticalIn",Ue:Qa.nf("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,
Rj:CommonUIStrings.l_AnimationVerticalInKeytip})),Qa.Rl.add("VerticalOut",Object.assign(new ba,{id:"VerticalOut",Ue:Qa.nf("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,Rj:CommonUIStrings.l_AnimationVerticalOutKeytip})),Qa.Rl.add("LeftDown",Object.assign(new ba,{id:"LeftDown",Ue:Qa.nf("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Rj:CommonUIStrings.l_AnimationLeftDownKeytip})),Qa.Rl.add("LeftUp",Object.assign(new ba,
{id:"LeftUp",Ue:Qa.nf("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,Rj:CommonUIStrings.l_AnimationLeftUpKeytip})),Qa.Rl.add("RightDown",Object.assign(new ba,{id:"RightDown",Ue:Qa.nf("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,Rj:CommonUIStrings.l_AnimationRightDownKeytip})),Qa.Rl.add("RightUp",Object.assign(new ba,{id:"RightUp",Ue:Qa.nf("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,
Rj:CommonUIStrings.l_AnimationRightUpKeytip})),Qa.Rl.add("In",Object.assign(new ba,{id:"In",Ue:Qa.nf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,Rj:CommonUIStrings.l_AnimationInKeytip})),Qa.Rl.add("InBottom",Object.assign(new ba,{id:"InBottom",Ue:Qa.nf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Rj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),Qa.Rl.add("InCenter",Object.assign(new ba,{id:"InCenter",Ue:Qa.nf("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Rj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Qa.Rl.add("InSlightly",Object.assign(new ba,{id:"InSlightly",Ue:Qa.nf("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Rj:CommonUIStrings.l_AnimationInSlightlyKeytip})),Qa.Rl.add("Out",Object.assign(new ba,{id:"Out",Ue:Qa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Rj:CommonUIStrings.l_AnimationOutKeytip})),Qa.Rl.add("OutBottom",
Object.assign(new ba,{id:"OutBottom",Ue:Qa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,Rj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),Qa.Rl.add("OutCenter",Object.assign(new ba,{id:"OutCenter",Ue:Qa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,Rj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Qa.Rl.add("OutSlightly",Object.assign(new ba,{id:"OutSlightly",Ue:Qa.nf("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,
Rj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),Qa.Rl.add("FloatUp",Object.assign(new ba,{id:"FloatUp",Ue:Qa.nf("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,Rj:CommonUIStrings.l_AnimationOutKeytip})),Qa.Rl.add("FloatDown",Object.assign(new ba,{id:"FloatDown",Ue:Qa.nf("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Rj:CommonUIStrings.l_AnimationDownKeytip})),Qa.Rl.add("ObjectCenter",Object.assign(new ba,{id:"ObjectCenter",
Ue:Qa.nf("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Rj:CommonUIStrings.l_AnimationObjectCenterKeytip})),Qa.Rl.add("SlideCenter",Object.assign(new ba,{id:"SlideCenter",Ue:Qa.nf("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Rj:CommonUIStrings.l_AnimationSlideCenterKeytip})),Qa.Rl.add("ObjectCenterOut",Object.assign(new ba,{id:"ObjectCenterOut",Ue:Qa.nf("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
Rj:CommonUIStrings.l_AnimationObjectCenterKeytip})),Qa.Rl.add("SlideCenterOut",Object.assign(new ba,{id:"SlideCenterOut",Ue:Qa.nf("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Rj:CommonUIStrings.l_AnimationSlideCenterKeytip})),Qa.Rl.add("Clockwise",Object.assign(new ba,{id:"Clockwise",Ue:Qa.nf("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Rj:CommonUIStrings.l_AnimationClockWiseKeytip})),Qa.Rl.add("CounterClockwise",
Object.assign(new ba,{id:"CounterClockwise",Ue:Qa.nf("AnimEffectPropCounterclockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Rj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),Qa.Rl.add("Across",Object.assign(new ba,{id:"Across",Ue:Qa.nf("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Rj:CommonUIStrings.l_AnimationAcrossKeytip})),Qa.Rl.add("Up",Object.assign(new ba,{id:"Up",Ue:Qa.nf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,
Rj:CommonUIStrings.l_AnimationUpKeytip})),Qa.Rl.add("Down",Object.assign(new ba,{id:"Down",Ue:Qa.nf("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,Rj:CommonUIStrings.l_AnimationDownKeytip})),Qa.Rl.add("GrowShrinkHorizontal",Object.assign(new ba,{id:"GrowShrinkHorizontal",Ue:Qa.nf("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Rj:CommonUIStrings.l_AnimationHorizontalKeytip})),Qa.Rl.add("GrowShrinkVertical",Object.assign(new ba,
{id:"GrowShrinkVertical",Ue:Qa.nf("AnimEffectPropGrowShrinkVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Rj:CommonUIStrings.l_AnimationVerticalKeytip})),Qa.Rl.add("GrowShrinkBoth",Object.assign(new ba,{id:"GrowShrinkBoth",Ue:Qa.nf("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Rj:CommonUIStrings.l_AnimationBothKeytip})));Qa.zT||(Qa.zT=new Id.a,Qa.zT.add("Spin_Quarter",Object.assign(new Da,{id:"Spin_Quarter",Ue:Qa.nf("AnimEffectPropQuarterSpin"),
labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Rj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),Qa.zT.add("Spin_Half",Object.assign(new Da,{id:"Spin_Half",Ue:Qa.nf("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Rj:CommonUIStrings.l_AnimationHalfSpinKeytip})),Qa.zT.add("Spin_Full",Object.assign(new Da,{id:"Spin_Full",Ue:Qa.nf("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Rj:CommonUIStrings.l_AnimationFullSpinKeytip})),
Qa.zT.add("Spin_Two",Object.assign(new Da,{id:"Spin_Two",Ue:Qa.nf("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,value:"720",Rj:CommonUIStrings.l_AnimationTwoSpinKeytip})),Qa.zT.add("Transparency_25",Object.assign(new Da,{id:"Transparency_25",Ue:Qa.nf("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Rj:CommonUIStrings.l_Animation25PerKeytip})),Qa.zT.add("Transparency_50",Object.assign(new Da,{id:"Transparency_50",
Ue:Qa.nf("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Rj:CommonUIStrings.l_Animation50PerKeytip})),Qa.zT.add("Transparency_75",Object.assign(new Da,{id:"Transparency_75",Ue:Qa.nf("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",Rj:CommonUIStrings.l_Animation75PerKeytip})),Qa.zT.add("Transparency_100",Object.assign(new Da,{id:"Transparency_100",Ue:Qa.nf("AnimEffectPropTransparent100"),
labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Rj:CommonUIStrings.l_Animation100PerKeytip})),Qa.zT.add("GrowShrink_Tiny",Object.assign(new Da,{id:"GrowShrink_Tiny",Ue:Qa.nf("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Rj:CommonUIStrings.l_AnimationTinyKeytip})),Qa.zT.add("GrowShrink_Smaller",Object.assign(new Da,{id:"GrowShrink_Smaller",Ue:Qa.nf("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,
value:"50",Rj:CommonUIStrings.l_AnimationSmallerKeytip})),Qa.zT.add("GrowShrink_Larger",Object.assign(new Da,{id:"GrowShrink_Larger",Ue:Qa.nf("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,value:"150",Rj:CommonUIStrings.l_AnimationLargerKeytip})),Qa.zT.add("GrowShrink_Huge",Object.assign(new Da,{id:"GrowShrink_Huge",Ue:Qa.nf("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Rj:CommonUIStrings.l_AnimationHugeKeytip})));if(!Qa.Am)if(Qa.Am=
new Id.a,Qa.Am.add("Existing",Object.assign(new Od,{effectType:-1,effectId:-1,Ue:Qa.nf("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,io:[],effectData:[]})),Qa.Am.add("None",Object.assign(new Od,{effectType:0,effectId:0,Ue:Qa.nf("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,io:[],effectData:[]})),Qa.Am.add("Appear",Object.assign(new Od,{effectType:0,effectId:1,Ue:Qa.nf("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,io:[],effectData:[]})),Qa.Am.add("FadeIn",
Object.assign(new Od,{effectType:0,effectId:10,Ue:Qa.nf("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,io:[],effectData:[]})),this.fXa){Qa.Am.add("FlyIn",Object.assign(new Od,{effectType:0,effectId:2,Ue:Qa.nf("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,io:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),effectData:[]}));Qa.Am.add("Wipe",Object.assign(new Od,{effectType:0,effectId:22,Ue:Qa.nf("AnimFxEntranceWipeIn"),
labelText:ResourceStrings.L_AnimationWipe,io:["FromBottom","FromLeft","FromRight","FromTop"],effectData:[]}));Qa.Am.add("Zoom",Object.assign(new Od,{effectType:0,effectId:53,Ue:Qa.nf("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,io:["ObjectCenter","SlideCenter"],effectData:[]}));Qa.Am.add("Checkerboard",Object.assign(new Od,{effectType:0,effectId:5,Ue:Qa.nf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,io:["Across","Down"],effectData:[]}));Qa.Am.add("BasicZoom",
Object.assign(new Od,{effectType:0,effectId:23,Ue:Qa.nf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,io:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),effectData:[]}));Qa.Am.add("Blinds",Object.assign(new Od,{effectType:0,effectId:3,Ue:Qa.nf("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,io:["Horizontal","Vertical"],effectData:[]}));let W;Qa.Am.add("Box",(W=new Od,W.effectType=0,W.effectId=4,W.Ue=Qa.nf("AnimFxEntranceShape"),W.labelText=
ResourceStrings.L_AnimationBox,W.io=["In","Out"],W.effectData=[],W));let oa;Qa.Am.add("PeekIn",(oa=new Od,oa.effectType=0,oa.effectId=12,oa.Ue=Qa.nf("AnimFxEntranceGeneric"),oa.labelText=ResourceStrings.L_AnimationPeekIn,oa.io=["FromBottom","FromLeft","FromRight","FromTop"],oa.effectData=[],oa));let xa;Qa.Am.add("Expand",(xa=new Od,xa.effectType=0,xa.effectId=55,xa.Ue=Qa.nf("AnimFxEntranceGeneric"),xa.labelText=ResourceStrings.L_AnimationExpand,xa.io=[],xa.effectData=[],xa));let Ia;Qa.Am.add("GrowAndTurn",
(Ia=new Od,Ia.effectType=0,Ia.effectId=31,Ia.Ue=Qa.nf("AnimFxEntranceGrowAndTurn"),Ia.labelText=ResourceStrings.L_AnimationGrowAndTurn,Ia.io=[],Ia.effectData=[],Ia));let qb;Qa.Am.add("RandomBars",(qb=new Od,qb.effectType=0,qb.effectId=14,qb.Ue=Qa.nf("AnimFxEntranceRandomBars"),qb.labelText=ResourceStrings.L_AnimationRandomBars,qb.io=["Horizontal","Vertical"],qb.effectData=[],qb));let Hb;Qa.Am.add("RiseUp",(Hb=new Od,Hb.effectType=0,Hb.effectId=37,Hb.Ue=Qa.nf("AnimFxEntranceGeneric"),Hb.labelText=
ResourceStrings.L_AnimationRiseUp,Hb.io=[],Hb.effectData=[],Hb));let hc;Qa.Am.add("Split",(hc=new Od,hc.effectType=0,hc.effectId=16,hc.Ue=Qa.nf("AnimFxEntranceSplit"),hc.labelText=ResourceStrings.L_AnimationSplit,hc.io=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],hc.effectData=[],hc));let Jc;Qa.Am.add("Strips",(Jc=new Od,Jc.effectType=0,Jc.effectId=18,Jc.Ue=Qa.nf("AnimFxEntranceGeneric"),Jc.labelText=ResourceStrings.L_AnimationStrips,Jc.io=["LeftDown","LeftUp","RightDown","RightUp"],
Jc.effectData=[],Jc));let ld;Qa.Am.add("Stretch",(ld=new Od,ld.effectType=0,ld.effectId=17,ld.Ue=Qa.nf("AnimFxEntranceGeneric"),ld.labelText=ResourceStrings.L_AnimationStretch,ld.io=["Across","FromBottom","FromLeft","FromRight","FromTop"],ld.effectData=[],ld));let wd;Qa.Am.add("Exit_Disappear",(wd=new Od,wd.effectType=1,wd.effectId=1,wd.Ue=Qa.nf("AnimFxExitDisappear"),wd.labelText=ResourceStrings.L_AnimationDisappear,wd.io=[],wd.effectData=[],wd));let Bd;Qa.Am.add("Exit_Fade",(Bd=new Od,Bd.effectType=
1,Bd.effectId=10,Bd.Ue=Qa.nf("AnimFxExitFadeOut"),Bd.labelText=ResourceStrings.L_AnimationFade,Bd.io=[],Bd.effectData=[],Bd));let de;Qa.Am.add("Exit_FlyOut",(de=new Od,de.effectType=1,de.effectId=2,de.Ue=Qa.nf("AnimFxExitFlyOut"),de.labelText=ResourceStrings.L_AnimationFlyOut,de.io="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),de.effectData=[],de));let oe;Qa.Am.add("Exit_Wipe",(oe=new Od,oe.effectType=1,oe.effectId=22,oe.Ue=Qa.nf("AnimFxExitWipe"),oe.labelText=
ResourceStrings.L_AnimationWipe,oe.io=["FromBottom","FromLeft","FromRight","FromTop"],oe.effectData=[],oe));let Pc;Qa.Am.add("Exit_Zoom",(Pc=new Od,Pc.effectType=1,Pc.effectId=53,Pc.Ue=Qa.nf("AnimFxExitFadedZoom"),Pc.labelText=ResourceStrings.L_AnimationZoom,Pc.io=["ObjectCenterOut","SlideCenterOut"],Pc.effectData=[],Pc));let tc;Qa.Am.add("Exit_Checkerboard",(tc=new Od,tc.effectType=1,tc.effectId=5,tc.Ue=Qa.nf("AnimFxExitGeneric"),tc.labelText=ResourceStrings.L_AnimationCheckerboard,tc.io=["Across",
"Up"],tc.effectData=[],tc));let id;Qa.Am.add("Exit_BasicZoom",(id=new Od,id.effectType=1,id.effectId=23,id.Ue=Qa.nf("AnimFxExitGeneric"),id.labelText=ResourceStrings.L_AnimationBasicZoom,id.io="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),id.effectData=[],id));let ie;Qa.Am.add("Exit_Blinds",(ie=new Od,ie.effectType=1,ie.effectId=3,ie.Ue=Qa.nf("AnimFxExitGeneric"),ie.labelText=ResourceStrings.L_AnimationBlinds,ie.io=["Horizontal","Vertical"],ie.effectData=[],ie));let v;Qa.Am.add("Exit_Box",
(v=new Od,v.effectType=1,v.effectId=4,v.Ue=Qa.nf("AnimFxExitShape"),v.labelText=ResourceStrings.L_AnimationBox,v.io=["In","Out"],v.effectData=[],v));let Z;Qa.Am.add("Exit_PeekOut",(Z=new Od,Z.effectType=1,Z.effectId=12,Z.Ue=Qa.nf("AnimFxExitGeneric"),Z.labelText=ResourceStrings.L_AnimationPeekOut,Z.io=["ToBottom","ToLeft","ToRight","ToTop"],Z.effectData=[],Z));let ua;Qa.Am.add("Exit_RandomBars",(ua=new Od,ua.effectType=1,ua.effectId=14,ua.Ue=Qa.nf("AnimFxExitRandomBars"),ua.labelText=ResourceStrings.L_AnimationRandomBars,
ua.io=["Horizontal","Vertical"],ua.effectData=[],ua));let Ra;Qa.Am.add("Exit_Split",(Ra=new Od,Ra.effectType=1,Ra.effectId=16,Ra.Ue=Qa.nf("AnimFxExitSplit"),Ra.labelText=ResourceStrings.L_AnimationSplit,Ra.io=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Ra.effectData=[],Ra));let fb;Qa.Am.add("Exit_Strips",(fb=new Od,fb.effectType=1,fb.effectId=18,fb.Ue=Qa.nf("AnimFxExitGeneric"),fb.labelText=ResourceStrings.L_AnimationStrips,fb.io=["LeftDown","LeftUp","RightDown","RightUp"],fb.effectData=
[],fb));let Mb;Qa.Am.add("Exit_Stretchy",(Mb=new Od,Mb.effectType=1,Mb.effectId=17,Mb.Ue=Qa.nf("AnimFxExitGeneric"),Mb.labelText=ResourceStrings.L_AnimationStretchy,Mb.io=[],Mb.effectData=[],Mb));let xc;Qa.Am.add("Exit_Zoom",(xc=new Od,xc.effectType=1,xc.effectId=53,xc.Ue=Qa.nf("AnimFxExitFadedZoom"),xc.labelText=ResourceStrings.L_AnimationZoom,xc.io=["ObjectCenterOut","SlideCenterOut"],xc.effectData=[],xc));let Dc;Qa.Am.add("Emphasis_Spin",(Dc=new Od,Dc.effectType=2,Dc.effectId=8,Dc.Ue=Qa.nf("AnimFxEmphasisSpin"),
Dc.labelText=ResourceStrings.L_AnimationSpin,Dc.io=["Clockwise","CounterClockwise"],Dc.effectData=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],Dc));let Vb;Qa.Am.add("Emphasis_Transparency",(Vb=new Od,Vb.effectType=2,Vb.effectId=9,Vb.Ue=Qa.nf("AnimFxEmphasisTransparency"),Vb.labelText=ResourceStrings.L_AnimationTransparency,Vb.io=[],Vb.effectData=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],Vb));let Lc;Qa.Am.add("Emphasis_GrowShrink",(Lc=new Od,Lc.effectType=2,
Lc.effectId=6,Lc.Ue=Qa.nf("AnimFxEmphasisGrowShrink"),Lc.labelText=ResourceStrings.L_AnimationGrowShrink,Lc.io=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],Lc.effectData=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],Lc));let dd;Qa.Am.add("Emphasis_FillColor",(dd=new Od,dd.effectType=2,dd.effectId=1,dd.Ue=Qa.nf("AnimFxEmphasisChangeFillColor"),dd.labelText=ResourceStrings.L_AnimationFillColor,dd.io=[],dd.effectData=[],dd));let Ed;Qa.Am.add("Emphasis_FontColor",
(Ed=new Od,Ed.effectType=2,Ed.effectId=3,Ed.Ue=Qa.nf("AnimFxEmphasisChangeFontColor"),Ed.labelText=ResourceStrings.L_AnimationFontColor,Ed.io=[],Ed.effectData=[],Ed));let te;Qa.Am.add("Emphasis_LineColor",(te=new Od,te.effectType=2,te.effectId=7,te.Ue=Qa.nf("AnimFxEmphasisChangeLineColor"),te.labelText=ResourceStrings.L_AnimationLineColor,te.io=[],te.effectData=[],te))}else Qa.Am.add("FlyIn",Object.assign(new Od,{effectType:0,effectId:2,Ue:Qa.nf("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,
io:["FromBottom","FromLeft","FromTop","FromRight"],effectData:[]}))}y7b(A,W){let oa=null;Qa.Am.forEach((xa,Ia)=>{Ia.effectType===A&&Ia.effectId===W&&(oa=Ia);return!0});return oa}iYc(A,W){let oa=null;Qa.Am.forEach((xa,Ia)=>{Ia.effectType===A&&Ia.effectId===W&&(oa=xa);return!0});return oa}KXc(A,W,oa,xa,Ia){const qb=Object.assign(new Aa.a,{Id:"MenuSectionEffectOptions"+oa,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});A=this.y7b(W,A);if(!A)return qb;if((A=
Qa.Djj(A,oa))&&A.length)for(W=0;W<A.length;W++){const Hb=Qa.Ejj(A[W],oa),hc="AnimationEffectOptions"+("Direction"===oa?"Direction":"Data")+Hb.id;Array.add(qb.ControlList,Object.assign(new vc.a,{Command:xa,Id:Hb.id,ExternalId:hc,QueryCommand:Ia}))}return qb}ZVc(A){var W;return(W=Qa.Am.ga(A))?(A=W.effectType,W=W.effectId,{returnValue:!0,effectType:A,effectId:W}):{returnValue:!1,effectType:-1,effectId:-1}}$Vc(A){let W,oa;W=Qa.nf("AnimFxMultiple");oa=ResourceStrings.L_AnimationExisting;if(A=Qa.Am.ga(A))W=
A.Ue,oa=A.labelText;return{image:W,label:oa}}W1c(A,W){if(0===A){if(0!==W&&1!==W&&2!==W&&10!==W)return!0}else if(0<A)return!0;return!1}ncb(A,W){return A&&W?this.fXa?(W=W.$bb()?A.IsTrigger:A.HasTrigger,!!this.y7b(A.EffectType,A.EffectId)&&!W):!A.HasExisting:!0}R3c(A){return A?this.dBb(Array(A)):!0}dBb(A){if(!A||!A.length)return!0;for(const W of A)if(null==this.y7b(W.EffectType,W.EffectId))return!1;return!0}$pe(A,W){return W&&A&&this.fXa?W.$bb()?!1:A.HasMultiple:!1}pbc(A){if(!A||!A.length)return!1;const W=
A[0].EffectId,oa=A[0].EffectType;for(let xa=1;xa<A.length;xa++){const Ia=A[xa];if(Ia.EffectId!=W||Ia.EffectType!=oa)return!0}return!1}Wog(A){if(A&&this.fXa&&2===A.EffectType)switch(A.EffectId){case 1:case 3:case 7:return!0}return!1}Zre(A){if(!A)return!1;if(2===A.EffectType)switch(A.EffectId){case 1:case 3:case 7:return!0}return!1}qij(A){A=Qa.Am.ga(A);return this.U7b(A.io[0])}nij(A){return(A=Qa.Am.ga(A))&&A.effectData.length?this.Vae(A.effectData[0]):""}U7b(A){switch(A){case "FromBottom":case "ToBottom":return 3;
case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;
case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;
case "GrowShrinkBoth":return 29;default:return 0}}Vae(A){return(A=Qa.zT.ga(A))?A.value:""}kOf(A,W){return(W=Qa.zT.ga(W))&&parseFloat(A)===parseFloat(W.value)?!0:!1}cee(A){switch(A){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}Dzi(A){if(null===A)throw Error.argumentNull("animation");const W=this.y7b(A.EffectType,A.EffectId);return!!W&&(0<W.io.length||0<W.effectData.length||this.Wog(A))}Ezi(A){if(!A)return!1;const W=this.y7b(A.EffectType,
A.EffectId);return!!W&&(0<W.io.length||0<W.effectData.length||this.Zre(A))}Fzi(A,W,oa){return this.ncb(oa,A)&&!this.$pe(oa,A)&&(this.Dzi(oa)||this.FJf(A,W,oa)||this.bZd(A,W,oa)||this.DJf(A,W,oa)||this.cZd(A,oa))}Gzi(A,W,oa){if(!(A&&W&&oa&&oa.length&&this.dBb(oa)))return!1;A=Qa.rQf(A,oa);W=this.GJf(W,A)||this.IJf(W,A)||this.EJf(W,A)||this.KJf(A);let xa;this.pbc(oa)||(xa=this.Ezi(oa[0]));return xa||W}Csj(A,W,oa){const xa=Object.assign(new Aa.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",
DisplayMode:"Menu32",ControlList:[]});this.FJf(A,W,oa)&&Array.add(xa.ControlList,Object.assign(new vc.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.DJf(A,W,oa)&&this.fXa&&Array.add(xa.ControlList,Object.assign(new vc.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.bZd(A,W,oa)&&Array.add(xa.ControlList,Object.assign(new vc.a,{Command:"3467781846",
Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.cZd(A,oa)&&Array.add(xa.ControlList,Object.assign(new vc.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return xa}Dsj(A,W,oa){const xa=new Aa.a;xa.Id="MenuSectionEffectOptionsSequence";xa.ControlsId="MenuSectionEffectOptionsSequence.Controls";xa.DisplayMode="Menu32";xa.ControlList=[];if(!(A&&A.length&&W&&oa&&oa.length))return xa;
A=Qa.rQf(A,oa);this.GJf(W,A)&&(oa=new vc.a,oa.Command="1850236812",oa.Id="AsOneObject",oa.ExternalId="AnimationEffectOptionsSequenceAsOneObject",oa.QueryCommand="1125291975",xa.ControlList.push(oa));this.EJf(W,A)&&(oa=new vc.a,oa.Command="2048458448",oa.Id="AllAtOnce",oa.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",oa.QueryCommand="1125291975",xa.ControlList.push(oa));this.IJf(W,A)&&(W=new vc.a,W.Command="3467781846",W.Id="ByParagraph",W.ExternalId="AnimationEffectOptionsSequenceByParagraph",
W.QueryCommand="1125291975",xa.ControlList.push(W));this.KJf(A)&&(W=new vc.a,W.Command="1486892994",W.Id="OneByOne",W.ExternalId="AnimationEffectOptionsSequenceOneByOne",W.QueryCommand="1125291975",xa.ControlList.push(W));return xa}k6j(A){let W=!0,oa=0;if(!A)return!1;for(const xa of A)if(W)oa=xa.EffectId,W=!1;else if(xa.EffectId!==oa)return!1;return!0}dpj(A,W,oa){const xa={isEnabled:!1,zpd:null};if(!A||!W||!W.length)return xa;for(var Ia of W)if(Ia.IsTrigger)return xa;A=Qa.moj(A);if(!A.length||Qa.pWj(A,
W))return xa;Ia=A.map(qb=>qb.EffectNodeId);W=W.map(qb=>qb.EffectNodeId).sort((qb,Hb)=>qb-Hb);if(!Qa.z6j(W,Ia))return xa;if(oa){oa=Ia.indexOf(W[W.length-1]);if(-1==oa||oa==Ia.length-1)return xa;xa.isEnabled=!0;xa.zpd=Qa.jeg(A[oa+1])}else{oa=Ia.indexOf(W[0]);if(-1==oa||0==oa)return xa;xa.isEnabled=!0;xa.zpd=Qa.jeg(A[oa-1])}return xa}Muj(A){const W=[];if(!A||!A.animations||!A.animations.Sequences)return W;let oa=0;for(const xa of A.animations.Sequences)xa.Effects&&(W.push({isTriggerSequence:xa.IsTriggerSeq,
sequenceIndex:xa.SequenceIndex,description:xa.Description,animationCount:xa.Effects.length,sequenceStartIndex:oa}),oa+=xa.Effects.length);return W}jkj(A){const W=[];if(!A||!A.length)return W;const oa=new Map;for(var xa of A.filter(Hb=>!Hb.IsTrigger&&-1!==Hb.GroupId)){var Ia=`${xa.ShapeId}${","}${xa.GroupId}`;if(oa.has(Ia)){var qb=oa.get(Ia);oa.set(Ia,qb+1)}else oa.set(Ia,1)}xa=new Set;for(const Hb of A)A=Qa.aOi(Hb),Hb.IsTrigger||(-1===Hb.GroupId?A.IsGroupAnimation=0<xa.size:(A.IsGroupAnimation=!0,
Ia=`${Hb.ShapeId}${","}${Hb.GroupId}`,0===xa.size&&(A.IsFirstGroupAnimation=!0),xa.has(Ia)||xa.add(Ia),qb=oa.get(Ia),qb--,oa.set(Ia,qb),0===qb&&xa.delete(Ia),0===xa.size&&(A.IsLastGroupAnimation=!0)),A.IsDraggable=!A.IsGroupAnimation||A.IsFirstGroupAnimation&&A.IsLastGroupAnimation),W.push(A);return W}static aOi(A){return Object.assign(Object.assign({},A),{IsDraggable:!1,IsFirstGroupAnimation:!1,IsGroupAnimation:!1,IsLastGroupAnimation:!1})}static rQf(A,W){const oa=new Map;for(const xa of A)oa.set(xa.id.toString(),
xa);A=new Map;for(const xa of W)W=zf.a.Kf(xa.ShapeId),W=oa.get(W.toString()),A.set(xa,W);return A}static jeg(A){const W=new Kf;W.EffectNodeId=A.EffectNodeId;W.ShapeId=A.ShapeId;return W}static z6j(A,W){if(!(A&&A.length&&W&&W.length)||A.length>W.length)return!1;const oa=A[A.length-1],xa=W.indexOf(A[0]);return W.indexOf(oa)-xa+1==A.length}static moj(A){const W=[];if(!A)return W;A=A.animations;if(!A||!A.Sequences)return W;for(const oa of A.Sequences[0].Effects)W.push(oa);return W.sort((oa,xa)=>oa.EffectNodeId-
xa.EffectNodeId)}static pWj(A,W){if(!A||!W)return!1;const oa=new Map;for(const xa of A.filter(Ia=>-1!==Ia.GroupId))if(A=`${xa.ShapeId}${","}${xa.GroupId}`,oa.has(A)){const Ia=oa.get(A);oa.set(A,Ia+1)}else oa.set(A,1);for(const xa of W.filter(Ia=>-1!==Ia.GroupId))if(W=`${xa.ShapeId}${","}${xa.GroupId}`,oa.has(W)&&1<oa.get(W))return!0;return!1}FJf(A,W,oa){return 0!==oa.SequenceId&&0!==oa.EffectId&&this.ncb(oa,A)&&(A.Wf||2!==oa.EffectType||1!==oa.EffectId&&7!==oa.EffectId)&&(A.x0||this.cZd(A,oa)||this.bZd(A,
W,oa))}Izi(A,W,oa){return A&&0!==oa.BuildType&&0!==oa.EffectId&&this.R3c(oa)&&(A.Wf||2!==oa.EffectType||1!==oa.EffectId&&7!==oa.EffectId)&&(A.x0||this.JJf(A,oa)||this.HJf(A,W,oa))}GJf(A,W){for(let [oa,xa]of W)if(!this.Izi(xa,A,oa))return!1;return!0}DJf(A,W,oa){return 0!==oa.SequenceId&&!A.x0&&!A.xd&&0!==oa.EffectId&&this.ncb(oa,A)&&(A.Wf||2!==oa.EffectType||1!==oa.EffectId&&7!==oa.EffectId)&&(A.Ik||A.Wf||A.isEditable&&0<W.p9(A).length)}Hzi(A,W,oa){return A&&0!==oa.BuildType&&!A.x0&&!A.xd&&0!==oa.EffectId&&
this.R3c(oa)&&(A.Wf||2!==oa.EffectType||1!==oa.EffectId&&7!==oa.EffectId)&&(A.Ik||A.Wf||A.isEditable&&0<W.p9(A).length)}EJf(A,W){for(let [oa,xa]of W)if(!this.Hzi(xa,A,oa))return!1;return!0}bZd(A,W,oa){return 0!==oa.SequenceId&&!A.Wf&&!A.x0&&!A.xd&&0!==oa.EffectId&&this.ncb(oa,A)&&(2!==oa.EffectType||1!==oa.EffectId&&7!==oa.EffectId)&&(A.Ik||A.isEditable&&0<W.p9(A).length)}HJf(A,W,oa){return A&&0!==oa.BuildType&&!A.Wf&&!A.x0&&!A.xd&&0!==oa.EffectId&&this.R3c(oa)&&(2!==oa.EffectType||1!==oa.EffectId&&
7!==oa.EffectId)&&(A.Ik||A.isEditable&&0<W.p9(A).length)}IJf(A,W){for(let [oa,xa]of W)if(!this.HJf(xa,A,oa))return!1;return!0}cZd(A,W){return 0!==W.SequenceId&&A.Wf&&0!==W.EffectId&&this.ncb(W,A)}JJf(A,W){return A&&0!==W.BuildType&&A.Wf&&0!==W.EffectId&&this.R3c(W)}KJf(A){for(let [W,oa]of A)if(!this.JJf(oa,W))return!1;return!0}static nf(A){return Ye.a.Noc+"_"+A+"_32x32x32"}static Djj(A,W){switch(W){case "Direction":return A.io;case "EffectData":return A.effectData;default:return null}}static Ejj(A,
W){switch(W){case "Direction":return Qa.Rl.ga(A);case "EffectData":return Qa.zT.ga(A);default:return null}}}Qa.Rl=null;Qa.zT=null;Qa.Am=null;Object(h.a)(Qa,"AnimationHelper",null,[899]);class nb{constructor(A,W,oa,xa,Ia,qb,Hb){this.xE=null;this.R6e=!1;this.mIa=oa;this.pa=A;(this.dwa=xa)&&Ia.execute(hc=>{this.xE=hc});this.ta=Hb;this.ia=W;this.Rma=qb}selectShape(){this.pa&&!this.pa.yX(this.ta)&&this.pa.selectShape(this.ta,!0)}onVolumeChanged(A){const W={ActionFromPlayer:!0};.2>=A?(W.SourceControlId=
"SetVolumeLow",this.ia.Ja(bd.a.mud,2,W)):.2<A&&.8>A?(W.SourceControlId="SetVolumeMedium",this.ia.Ja(bd.a.nud,2,W)):.8<=A&&(W.SourceControlId="SetVolumeHigh",this.ia.Ja(bd.a.lud,2,W));this.selectShape()}onPlayToggled(A){const W={ActionFromPlayer:!0};A?this.ia.Ja(bd.a.kLc,2,W):this.ia.Ja(bd.a.O0b,2,W);this.selectShape()}onMuteToggled(A){if(A)this.ia.Ja(bd.a.oud,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(A){A&&
appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(A){A||this.pa.mre(this.ta)||(A=this.EL())&&A.showHidePlayer(!1)}onPlayerClicked(){this.dwa&&this.ia.processAction(bd.a.gRb,2)}onPlayerError(A){gd.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",A);A&&-1<A.indexOf("PIPELINE_ERROR_READ")&&this.mIa.Gce(this.Rma.podSessionId,this.ta).then(W=>{const oa=this.EL();oa&&oa.setAudioSrc(W)})}onKeyDown(A){A===ud.a.qNa?
(A=this.EL())&&A.removeFocusFromPlayer():A===ud.a.$q&&(this.R6e=!0)}onBlur(){const A=this.EL();A&&(this.R6e?A.setFocusOnPlayer():A.removeFocusFromPlayer());this.R6e=!1}EL(){return this.dwa&&this.xE?this.xE.EL(this.ta):null}}Object(h.a)(nb,"AudioLibraryCallback",null,[937]);class Wb{constructor(A,W,oa,xa,Ia,qb){this.mIa=A;this.pa=W;this.ia=oa;this.dwa=xa;this.Tdb=qb;this.Rma=Ia}PMi(A){return new nb(this.pa,this.ia,this.mIa,this.dwa,this.Tdb,this.Rma,A)}}Object(h.a)(Wb,"AudioLibraryCallbackFactory",
null,[871]);class Jb{constructor(A,W,oa,xa){this.volume=A;this.mute=W;this.repeat=oa;this.rewind=xa}}Object(h.a)(Jb,"MediaProperties",null,[]);class Uc{constructor(A,W,oa,xa){this.Kik=A;this.cEe=W;this.mIa=oa;this.Rma=xa}createAudioManager(A,W,oa){return new Promise((xa,Ia)=>{this.cEe("audioPlayback").then(()=>{window.self.audioPlayback?(gd.a.J(512497818,801,50,"audio script is loaded successfully"),xa(this.QMi(A,W,oa))):(gd.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),
Ia("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(qb=>{gd.a.J(512497817,801,10,"Failed to load audio script "+qb.toString());Ia("Failed to load audio script ")})})}QMi(A,W,oa){const xa=W.media;let Ia=null;xa&&(Ia=new Jb(xa.vlmField,xa.mteField,xa.repeatField,xa.rewindField));const qb=audioPlayback.pptAudioFactoryGlobal.createAudioManager(A,oa,this.Kik.PMi(W),Ia);this.mIa.Gce(this.Rma.podSessionId,W).then(Hb=>{qb&&qb.setAudioSrc(Hb)});return qb}}Object(h.a)(Uc,
"AudioManagerFactory",null,[872]);var Jd=d(1312);class ne{constructor(){this.rDb=new Jd.a}c7k(A,W){W&&this.rDb.$(W.id,A)}UOh(A){A&&this.rDb.Gb(A.id)&&(this.rDb.ga(A.id).dispose(),this.rDb.remove(A.id))}EL(A){return A&&this.rDb.Gb(A.id)?this.rDb.ga(A.id):null}}Object(h.a)(ne,"AudioManagerStore",null,[870]);class bf{Z9j(A){return!bf.yyb(bf.TXl)||A>bf.lbf?!0:!1}static yyb(A){return(A=document.getElementById(A))?A:null}}bf.TXl="PptRibbon.Design.ThemeVariants-MaxSize";bf.lbf=4;Object(h.a)(bf,"ThemeHelper",
null,[898]);class sd{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=0}}Object(h.a)(sd,"EditTransitionInfo",null,[]);class vd{constructor(){this.next=this.parent=this.tc=this.Wx=this.wc=this.sc=null}}Object(h.a)(vd,"Transition",null,[]);class $c{}$c.none=0;$c.k$i=5;$c.l$i=4;$c.BKl=1;$c.ZBj=1;$c.vsi=2;$c.Z8=0;$c.DTa=1;$c.AEa=2;$c.Lxb=3;$c.AUc=4;$c.zUc=5;$c.DUc=6;$c.CUc=7;$c.VYc=2;$c.BVa=1;$c.OBj=1;$c.$Hf=0;$c.swi=1;$c.rwi=2;$c.QBj=0;$c.PBj=1;$c.Wfg=2;$c.$Bj=
3;$c.Zfe=0;$c.y9b=1;$c.UYc=0;$c.Wab=1;$c.Osi=1;$c.tGf=0;$c.BGh=2;$c.VDl=0;$c.DKl=3;$c.CKl=1;$c.wheel=1;$c.Tuh=29;$c.H4f=0;$c.Gaj=1;$c.Paj=2;$c.Zaj=3;$c.G4f=8;$c.Faj=9;$c.Oaj=10;$c.Yaj=11;$c.I4f=12;$c.Jaj=13;$c.Raj=14;$c.bbj=15;$c.J4f=4;$c.Kaj=5;$c.Saj=6;$c.cbj=7;$c.Qaj=0;$c.$aj=1;$c.Uaj=2;$c.Haj=3;$c.C4f=4;$c.abj=5;$c.Vaj=6;$c.Iaj=7;Object(h.a)($c,"TransitionEffectOptions",null,[]);class hd{}hd.none=0;hd.cut=0;hd.random=1;hd.blinds=2;hd.YZd=3;hd.rDa=4;hd.dissolve=5;hd.fade=6;hd.dNa=7;hd.pVe=8;hd.IAd=
9;hd.wipe=10;hd.QBh=11;hd.split=13;hd.tvl=17;hd.yvl=18;hd.wedge=19;hd.push=20;hd.W_d=21;hd.BCf=23;hd.wheel=26;hd.NBh=27;hd.gyc=28;hd.ZMb=29;hd.mFa=30;hd.xsc=39;hd.G6e=42;hd.flip=43;hd.aN=44;hd.nZl=47;hd.d8d=48;hd.L5d=49;hd.RTi=50;hd.Cbf=51;hd.vXk=52;hd.oaj=53;hd.gTi=54;hd.iQe=55;hd.$fh=56;hd.DPe=57;hd.mVd=58;hd.qPe=59;hd.morph=60;hd.pan=36;hd.h$d=38;hd.n1d=37;hd.D5d=33;hd.window=34;hd.$6b=32;hd.zoom=31;hd.D_l=22;Object(h.a)(hd,"TransitionTypes",null,[]);class Dd{constructor(A){let W=0;this.Ec=new Id.a;
this.Ec.$("TransitionExisting",Object.assign(new vd,{sc:ResourceStrings.L_TransitionExisting,wc:Dd.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Ec.$("TransitionExistingInMenu",Object.assign(new vd,{sc:ResourceStrings.L_TransitionExisting,wc:Dd.Gc("TransitionFlash"),parent:"TransitionExisting"}));this.Ec.$("TransitionNone",Object.assign(new vd,{sc:ResourceStrings.L_TransitionNone,wc:Dd.Gc("TransitionNone"),tc:Object.assign(new sd,{TransitionType:hd.none,Direction:$c.vsi,Duration:0,IsManualAdvance:!0}),
parent:"TransitionNone"}));this.Ec.$("TransitionFade",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFade,wc:Dd.Gc("TransitionFadeSmoothly"),tc:Object.assign(new sd,{TransitionType:hd.BCf,Direction:$c.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Ec.$("TransitionFadeSmoothly",Object.assign(new vd,{sc:ResourceStrings.L_TransitionSmoothly,Wx:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,wc:Dd.Gc("TransitionFadeSmoothly"),tc:Object.assign(new sd,
{TransitionType:hd.BCf,Direction:$c.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Ec.$("TransitionFadeThroughBlack",Object.assign(new vd,{sc:ResourceStrings.L_TransitionThroughBlack,Wx:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,wc:Dd.Gc("TransitionFadeThroughBlack"),tc:Object.assign(new sd,{TransitionType:hd.fade,Direction:$c.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let oa=[];if(A){oa=A.toLowerCase().split(",");
for(let xa=0;xa<oa.length;xa++)oa[xa]=oa[xa].trim()}Array.contains(oa,"push")||(this.Ec.$("TransitionPush",Object.assign(new vd,{sc:ResourceStrings.L_TransitionPush,wc:Dd.Gc("TransitionPushUp"),tc:Object.assign(new sd,{TransitionType:hd.push,Direction:$c.DTa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Ec.$("TransitionPushFromBottom",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottom,Wx:CommonUIStrings.l_TransitionPushFromBottomKeytip,
wc:Dd.Gc("TransitionPushUp"),tc:Object.assign(new sd,{TransitionType:hd.push,Direction:$c.DTa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Ec.$("TransitionPushFromLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromLeft,Wx:CommonUIStrings.l_TransitionPushFromLeftKeytip,wc:Dd.Gc("TransitionPushRight"),tc:Object.assign(new sd,{TransitionType:hd.push,Direction:$c.AEa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),
this.Ec.$("TransitionPushFromRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromRight,Wx:CommonUIStrings.l_TransitionPushFromRightKeytip,wc:Dd.Gc("TransitionPushLeft"),tc:Object.assign(new sd,{TransitionType:hd.push,Direction:$c.Z8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Ec.$("TransitionPushFromTop",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTop,Wx:CommonUIStrings.l_TransitionPushFromTopKeytip,wc:Dd.Gc("TransitionPushDown"),
tc:Object.assign(new sd,{TransitionType:hd.push,Direction:$c.Lxb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(oa,"cut")||(this.Ec.$("TransitionCut",Object.assign(new vd,{sc:ResourceStrings.L_TransitionCut,wc:Dd.Gc("TransitionCut"),tc:Object.assign(new sd,{TransitionType:hd.cut,Direction:$c.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Ec.$("TransitionCutNone",Object.assign(new vd,{sc:ResourceStrings.L_TransitionNone,
Wx:CommonUIStrings.l_TransitionCutNoneKeytip,wc:Dd.Gc("TransitionCut"),tc:Object.assign(new sd,{TransitionType:hd.cut,Direction:$c.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.Ec.$("TransitionCutThroughBlack",Object.assign(new vd,{sc:ResourceStrings.L_TransitionThroughBlack,Wx:CommonUIStrings.l_TransitionCutThroughBlackKeytip,wc:Dd.Gc("TransitionCutThroughBlack"),tc:Object.assign(new sd,{TransitionType:hd.cut,Direction:$c.BKl,Duration:500,
IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(oa,"wipe")||(this.Ec.$("TransitionWipe",Object.assign(new vd,{sc:ResourceStrings.L_TransitionWipe,wc:Dd.Gc("TransitionWipeLeft"),tc:Object.assign(new sd,{TransitionType:hd.wipe,Direction:$c.Z8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Ec.$("TransitionWipeFromRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromRight,Wx:CommonUIStrings.l_TransitionWipeFromRightKeytip,wc:Dd.Gc("TransitionWipeLeft"),
tc:Object.assign(new sd,{TransitionType:hd.wipe,Direction:$c.Z8,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Ec.$("TransitionWipeFromTop",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTop,Wx:CommonUIStrings.l_TransitionWipeFromTopKeytip,wc:Dd.Gc("TransitionWipeDown"),tc:Object.assign(new sd,{TransitionType:hd.wipe,Direction:$c.Lxb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Ec.$("TransitionWipeFromLeft",
Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromLeft,Wx:CommonUIStrings.l_TransitionWipeFromLeftKeytip,wc:Dd.Gc("TransitionWipeRight"),tc:Object.assign(new sd,{TransitionType:hd.wipe,Direction:$c.AEa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Ec.$("TransitionWipeFromBottom",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottom,Wx:CommonUIStrings.l_TransitionWipeFromBottomKeytip,wc:Dd.Gc("TransitionWipeUp"),tc:Object.assign(new sd,
{TransitionType:hd.wipe,Direction:$c.DTa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Ec.$("TransitionWipeFromTopRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTopRight,Wx:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,wc:Dd.Gc("TransitionStripsLeftDown"),tc:Object.assign(new sd,{TransitionType:hd.IAd,Direction:$c.DUc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Ec.$("TransitionWipeFromBottomRight",
Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottomRight,Wx:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,wc:Dd.Gc("TransitionStripsLeftUp"),tc:Object.assign(new sd,{TransitionType:hd.IAd,Direction:$c.AUc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Ec.$("TransitionWipeFromTopLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTopLeft,Wx:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,wc:Dd.Gc("TransitionStripsRightDown"),
tc:Object.assign(new sd,{TransitionType:hd.IAd,Direction:$c.CUc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Ec.$("TransitionWipeFromBottomLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottomLeft,Wx:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,wc:Dd.Gc("TransitionStripsRightUp"),tc:Object.assign(new sd,{TransitionType:hd.IAd,Direction:$c.zUc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(oa,
"morph")||(this.Ec.$("TransitionMorph",Object.assign(new vd,{sc:ResourceStrings.L_TransitionMorph,wc:Dd.Gc("TransitionByObject"),tc:Object.assign(new sd,{TransitionType:hd.morph,Direction:$c.$Hf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Ec.$("TransitionMorphByObject",Object.assign(new vd,{sc:ResourceStrings.L_TransitionByObject,Wx:CommonUIStrings.l_TransitionMorphObjectsKeytip,wc:Dd.Gc("TransitionByObject"),tc:Object.assign(new sd,{TransitionType:hd.morph,
Direction:$c.$Hf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Ec.$("TransitionMorphByWord",Object.assign(new vd,{sc:ResourceStrings.L_TransitionByWord,Wx:CommonUIStrings.l_TransitionMorphWordsKeytip,wc:Dd.Gc("TransitionByWord"),tc:Object.assign(new sd,{TransitionType:hd.morph,Direction:$c.swi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Ec.$("TransitionMorphByChar",Object.assign(new vd,{sc:ResourceStrings.L_TransitionByChar,
Wx:CommonUIStrings.l_TransitionMorphCharactersKeytip,wc:Dd.Gc("TransitionByChar"),tc:Object.assign(new sd,{TransitionType:hd.morph,Direction:$c.rwi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(oa,"split")||(this.Ec.$("TransitionSplit",Object.assign(new vd,{sc:ResourceStrings.L_TransitionSplit,wc:Dd.Gc("TransitionSplitOutVertical"),tc:Object.assign(new sd,{TransitionType:hd.split,Direction:$c.Wfg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),
this.Ec.$("TransitionSplitVerticalOut",Object.assign(new vd,{sc:ResourceStrings.L_TransitionVerticalOut,Wx:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,wc:Dd.Gc("TransitionSplitOutVertical"),tc:Object.assign(new sd,{TransitionType:hd.split,Direction:$c.Wfg,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Ec.$("TransitionSplitHorizontalIn",Object.assign(new vd,{sc:ResourceStrings.L_TransitionHorizontalIn,Wx:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,
wc:Dd.Gc("TransitionSplitInHorizontal"),tc:Object.assign(new sd,{TransitionType:hd.split,Direction:$c.PBj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Ec.$("TransitionSplitHorizontalOut",Object.assign(new vd,{sc:ResourceStrings.L_TransitionHorizontalOut,Wx:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,wc:Dd.Gc("TransitionSplitOutHorizontal"),tc:Object.assign(new sd,{TransitionType:hd.split,Direction:$c.QBj,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Ec.$("TransitionSplitVerticalIn",Object.assign(new vd,{sc:ResourceStrings.L_TransitionVerticalIn,Wx:CommonUIStrings.l_TransitionSplitVerticalInKeytip,wc:Dd.Gc("TransitionSplitInVertical"),tc:Object.assign(new sd,{TransitionType:hd.split,Direction:$c.$Bj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(oa,"randombars")){this.Ec.$("TransitionRandomBars",Object.assign(new vd,{sc:ResourceStrings.L_TransitionRandomBars,
wc:Dd.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new sd,{TransitionType:hd.pVe,Direction:$c.Wab,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.Ec.$("TransitionRandomBarsVertical",Object.assign(new vd,{sc:ResourceStrings.L_TransitionVertical,Wx:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,wc:Dd.Gc("TransitionRandomBarsVertical"),tc:Object.assign(new sd,{TransitionType:hd.pVe,Direction:$c.Wab,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let xa,Ia;this.Ec.$("TransitionRandomBarsHorizontal",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionHorizontal,Ia.Wx=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Ia.wc=Dd.Gc("TransitionRandomBarsHorizontal"),Ia.tc=(xa=new sd,xa.TransitionType=hd.pVe,xa.Direction=$c.UYc,xa.Duration=1E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionRandomBars",Ia))}if(!Array.contains(oa,"shape")){let xa,Ia;this.Ec.$("TransitionShape",(Ia=
new vd,Ia.sc=ResourceStrings.L_TransitionShape,Ia.wc=Dd.Gc("TransitionShapeCircle"),Ia.tc=(xa=new sd,xa.TransitionType=hd.NBh,xa.Direction=$c.none,xa.Duration=800,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionShape",Ia.next="TransitionShapeCircle",Ia));let qb,Hb;this.Ec.$("TransitionShapeCircle",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionCircle,Hb.Wx=CommonUIStrings.l_TransitionShapeCircleKeytip,Hb.wc=Dd.Gc("TransitionShapeCircle"),Hb.tc=(qb=new sd,qb.TransitionType=hd.NBh,qb.Direction=$c.none,
qb.Duration=800,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionShape",Hb.next="TransitionShapeDiamond",Hb));let hc,Jc;this.Ec.$("TransitionShapeDiamond",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionDiamond,Jc.Wx=CommonUIStrings.l_TransitionShapeDiamondKeytip,Jc.wc=Dd.Gc("TransitionShapeDiamond"),Jc.tc=(hc=new sd,hc.TransitionType=hd.tvl,hc.Direction=$c.none,hc.Duration=800,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionShape",Jc.next="TransitionShapePlus",Jc));let ld,wd;this.Ec.$("TransitionShapePlus",
(wd=new vd,wd.sc=ResourceStrings.L_TransitionPlus,wd.Wx=CommonUIStrings.l_TransitionShapePlusKeytip,wd.wc=Dd.Gc("TransitionShapePlus"),wd.tc=(ld=new sd,ld.TransitionType=hd.yvl,ld.Direction=$c.none,ld.Duration=1E3,ld.IsManualAdvance=!0,ld),wd.parent="TransitionShape",wd.next="TransitionShapeIn",wd));let Bd,de;this.Ec.$("TransitionShapeIn",(de=new vd,de.sc=ResourceStrings.L_TransitionIn,de.Wx=CommonUIStrings.l_TransitionShapeInKeytip,de.wc=Dd.Gc("TransitionBoxIn"),de.tc=(Bd=new sd,Bd.TransitionType=
hd.QBh,Bd.Direction=$c.y9b,Bd.Duration=1200,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionShape",de.next="TransitionShapeOut",de));let oe,Pc;this.Ec.$("TransitionShapeOut",(Pc=new vd,Pc.sc=ResourceStrings.L_TransitionOut,Pc.Wx=CommonUIStrings.l_TransitionShapeOutKeytip,Pc.wc=Dd.Gc("TransitionBoxOut"),Pc.tc=(oe=new sd,oe.TransitionType=hd.QBh,oe.Direction=$c.Zfe,oe.Duration=1200,oe.IsManualAdvance=!0,oe),Pc.parent="TransitionShape",Pc))}if(!Array.contains(oa,"reveal")){let xa,Ia;this.Ec.$("TransitionReveal",
(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionReveal,Ia.wc=Dd.Gc("TransitionRevealSmoothlyFromRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.xsc,xa.Direction=$c.BGh,xa.Duration=3400,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionReveal",Ia.next="TransitionRevealSmoothlyFromRight",Ia));let qb,Hb;this.Ec.$("TransitionRevealSmoothlyFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionSmoothlyFromRight,Hb.wc=Dd.Gc("TransitionRevealSmoothlyFromRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.xsc,qb.Direction=
$c.BGh,qb.Duration=3400,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionReveal",Hb.next="TransitionRevealSmoothlyFromLeft",Hb));let hc,Jc;this.Ec.$("TransitionRevealSmoothlyFromLeft",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionSmoothlyFromLeft,Jc.wc=Dd.Gc("TransitionRevealSmoothlyFromLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.xsc,hc.Direction=$c.VDl,hc.Duration=3400,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionReveal",Jc.next="TransitionRevealFromRight",Jc));let ld,wd;this.Ec.$("TransitionRevealFromRight",
(wd=new vd,wd.sc=ResourceStrings.L_TransitionThroughBlackFromRight,wd.wc=Dd.Gc("TransitionRevealFromRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.xsc,ld.Direction=$c.DKl,ld.Duration=3400,ld.IsManualAdvance=!0,ld),wd.parent="TransitionReveal",wd.next="TransitionRevealFromLeft",wd));let Bd,de;this.Ec.$("TransitionRevealFromLeft",(de=new vd,de.sc=ResourceStrings.L_TransitionThroughBlackFromLeft,de.wc=Dd.Gc("TransitionRevealFromLeft"),de.tc=(Bd=new sd,Bd.TransitionType=hd.xsc,Bd.Direction=$c.CKl,Bd.Duration=
3400,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionReveal",de))}if(!Array.contains(oa,"cover")){let xa,Ia;this.Ec.$("TransitionCover",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionCover,Ia.wc=Dd.Gc("TransitionCoverLeft"),Ia.tc=(xa=new sd,xa.TransitionType=hd.rDa,xa.Direction=$c.Z8,xa.Duration=1E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionCover",Ia.next="TransitionCoverFromRight",Ia));let qb,Hb;this.Ec.$("TransitionCoverFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionCoverLeft"),
Hb.tc=(qb=new sd,qb.TransitionType=hd.rDa,qb.Direction=$c.Z8,qb.Duration=1E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionCover",Hb.next="TransitionCoverFromTop",Hb));let hc,Jc;this.Ec.$("TransitionCoverFromTop",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromTop,Jc.wc=Dd.Gc("TransitionCoverDown"),Jc.tc=(hc=new sd,hc.TransitionType=hd.rDa,hc.Direction=$c.Lxb,hc.Duration=1E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionCover",Jc.next="TransitionCoverFromLeft",Jc));let ld,wd;this.Ec.$("TransitionCoverFromLeft",
(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromLeft,wd.wc=Dd.Gc("TransitionCoverRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.rDa,ld.Direction=$c.AEa,ld.Duration=1E3,ld.IsManualAdvance=!0,ld),wd.parent="TransitionCover",wd.next="TransitionCoverFromBottom",wd));let Bd,de;this.Ec.$("TransitionCoverFromBottom",(de=new vd,de.sc=ResourceStrings.L_TransitionFromBottom,de.wc=Dd.Gc("TransitionCoverUp"),de.tc=(Bd=new sd,Bd.TransitionType=hd.rDa,Bd.Direction=$c.DTa,Bd.Duration=1E3,Bd.IsManualAdvance=!0,Bd),
de.parent="TransitionCover",de.next="TransitionCoverFromTopRight",de));let oe,Pc;this.Ec.$("TransitionCoverFromTopRight",(Pc=new vd,Pc.sc=ResourceStrings.L_TransitionFromTopRight,Pc.wc=Dd.Gc("TransitionCoverLeftDown"),Pc.tc=(oe=new sd,oe.TransitionType=hd.rDa,oe.Direction=$c.DUc,oe.Duration=1E3,oe.IsManualAdvance=!0,oe),Pc.parent="TransitionCover",Pc.next="TransitionCoverFromBottomRight",Pc));let tc,id;this.Ec.$("TransitionCoverFromBottomRight",(id=new vd,id.sc=ResourceStrings.L_TransitionFromBottomRight,
id.wc=Dd.Gc("TransitionCoverLeftUp"),id.tc=(tc=new sd,tc.TransitionType=hd.rDa,tc.Direction=$c.AUc,tc.Duration=1E3,tc.IsManualAdvance=!0,tc),id.parent="TransitionCover",id.next="TransitionCoverFromTopLeft",id));let ie,v;this.Ec.$("TransitionCoverFromTopLeft",(v=new vd,v.sc=ResourceStrings.L_TransitionFromTopLeft,v.wc=Dd.Gc("TransitionCoverRightDown"),v.tc=(ie=new sd,ie.TransitionType=hd.rDa,ie.Direction=$c.CUc,ie.Duration=1E3,ie.IsManualAdvance=!0,ie),v.parent="TransitionCover",v.next="TransitionCoverFromBottomLeft",
v));let Z,ua;this.Ec.$("TransitionCoverFromBottomLeft",(ua=new vd,ua.sc=ResourceStrings.L_TransitionFromBottomLeft,ua.wc=Dd.Gc("TransitionCoverRightUp"),ua.tc=(Z=new sd,Z.TransitionType=hd.rDa,Z.Direction=$c.zUc,Z.Duration=1E3,Z.IsManualAdvance=!0,Z),ua.parent="TransitionCover",ua))}if(!Array.contains(oa,"uncover")){let xa,Ia;this.Ec.$("TransitionUncover",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionUncover,Ia.wc=Dd.Gc("TransitionUncoverLeft"),Ia.tc=(xa=new sd,xa.TransitionType=hd.dNa,xa.Direction=
$c.Z8,xa.Duration=750,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionUncover",Ia.next="TransitionUncoverFromRight",Ia));let qb,Hb;this.Ec.$("TransitionUncoverFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionUncoverLeft"),Hb.tc=(qb=new sd,qb.TransitionType=hd.dNa,qb.Direction=$c.Z8,qb.Duration=750,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionUncover",Hb.next="TransitionUncoverFromTop",Hb));let hc,Jc;this.Ec.$("TransitionUncoverFromTop",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromTop,
Jc.wc=Dd.Gc("TransitionUncoverDown"),Jc.tc=(hc=new sd,hc.TransitionType=hd.dNa,hc.Direction=$c.Lxb,hc.Duration=750,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionUncover",Jc.next="TransitionUncoverFromLeft",Jc));let ld,wd;this.Ec.$("TransitionUncoverFromLeft",(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromLeft,wd.wc=Dd.Gc("TransitionUncoverRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.dNa,ld.Direction=$c.AEa,ld.Duration=750,ld.IsManualAdvance=!0,ld),wd.parent="TransitionUncover",wd.next="TransitionUncoverFromBottom",
wd));let Bd,de;this.Ec.$("TransitionUncoverFromBottom",(de=new vd,de.sc=ResourceStrings.L_TransitionFromBottom,de.wc=Dd.Gc("TransitionUncoverUp"),de.tc=(Bd=new sd,Bd.TransitionType=hd.dNa,Bd.Direction=$c.DTa,Bd.Duration=750,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionUncover",de.next="TransitionUncoverFromTopRight",de));this.Ec.$("TransitionUncoverFromTopRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTopRight,wc:Dd.Gc("TransitionUncoverLeftDown"),tc:Object.assign(new sd,{TransitionType:hd.dNa,
Direction:$c.DUc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Ec.$("TransitionUncoverFromBottomRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottomRight,wc:Dd.Gc("TransitionUncoverLeftUp"),tc:Object.assign(new sd,{TransitionType:hd.dNa,Direction:$c.AUc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.Ec.$("TransitionUncoverFromTopLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTopLeft,
wc:Dd.Gc("TransitionUncoverRightDown"),tc:Object.assign(new sd,{TransitionType:hd.dNa,Direction:$c.CUc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Ec.$("TransitionUncoverFromBottomLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottomLeft,wc:Dd.Gc("TransitionUncoverRightUp"),tc:Object.assign(new sd,{TransitionType:hd.dNa,Direction:$c.zUc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(oa,
"menusectionexciting")){if(!Array.contains(oa,"fallover")){this.Ec.$("TransitionFallOver",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFallOver,wc:Dd.Gc("TransitionFallOverLeft"),tc:Object.assign(new sd,{TransitionType:hd.d8d,Direction:$c.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let xa,Ia;this.Ec.$("TransitionFallOverLeft",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionGoLeft,Ia.wc=Dd.Gc("TransitionFallOverLeft"),Ia.tc=(xa=new sd,xa.TransitionType=
hd.d8d,xa.Direction=$c.none,xa.Duration=2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionFallOver",Ia.next="TransitionFallOverRight",Ia));let qb,Hb;this.Ec.$("TransitionFallOverRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionGoRight,Hb.wc=Dd.Gc("TransitionFallOverRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.d8d,qb.Direction=$c.BVa,qb.Duration=2E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionFallOver",Hb))}if(!Array.contains(oa,"drape")){let xa,Ia;this.Ec.$("TransitionDrape",(Ia=new vd,Ia.sc=
ResourceStrings.L_TransitionDrape,Ia.wc=Dd.Gc("TransitionDrapeLeft"),Ia.tc=(xa=new sd,xa.TransitionType=hd.L5d,xa.Direction=$c.none,xa.Duration=2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionDrape",Ia.next="TransitionDrapeLeft",Ia));let qb,Hb;this.Ec.$("TransitionDrapeLeft",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionGoLeft,Hb.wc=Dd.Gc("TransitionDrapeLeft"),Hb.tc=(qb=new sd,qb.TransitionType=hd.L5d,qb.Direction=$c.none,qb.Duration=2E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionDrape",Hb.next=
"TransitionDrapeRight",Hb));let hc,Jc;this.Ec.$("TransitionDrapeRight",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionGoRight,Jc.wc=Dd.Gc("TransitionDrapeRight"),Jc.tc=(hc=new sd,hc.TransitionType=hd.L5d,hc.Direction=$c.BVa,hc.Duration=2E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionDrape",Jc))}if(!Array.contains(oa,"curtains")){let xa,Ia;this.Ec.$("TransitionCurtains",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionCurtains,Ia.wc=Dd.Gc("TransitionCurtains"),Ia.tc=(xa=new sd,xa.TransitionType=hd.RTi,
xa.Direction=$c.none,xa.Duration=6E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionCurtains",Ia))}if(!Array.contains(oa,"wind")){let xa,Ia;this.Ec.$("TransitionWind",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionWind,Ia.wc=Dd.Gc("TransitionWindRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.Cbf,xa.Direction=$c.none,xa.Duration=2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionWind",Ia.next="TransitionWindRight",Ia));let qb,Hb;this.Ec.$("TransitionWindRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionGoRight,
Hb.wc=Dd.Gc("TransitionWindRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.Cbf,qb.Direction=$c.none,qb.Duration=2E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionWind",Hb.next="TransitionWindLeft",Hb));let hc,Jc;this.Ec.$("TransitionWindLeft",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionGoLeft,Jc.wc=Dd.Gc("TransitionWindLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.Cbf,hc.Direction=$c.BVa,hc.Duration=2E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionWind",Jc))}if(!Array.contains(oa,"prestige")){let xa,
Ia;this.Ec.$("TransitionPrestige",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionPrestige,Ia.wc=Dd.Gc("TransitionPrestige"),Ia.tc=(xa=new sd,xa.TransitionType=hd.vXk,xa.Direction=$c.none,xa.Duration=2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionPrestige",Ia))}if(!Array.contains(oa,"fracture")){let xa,Ia;this.Ec.$("TransitionFracture",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionFracture,Ia.wc=Dd.Gc("TransitionFracture"),Ia.tc=(xa=new sd,xa.TransitionType=hd.oaj,xa.Direction=$c.none,xa.Duration=
2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionFracture",Ia))}if(!Array.contains(oa,"crush")){let xa,Ia;this.Ec.$("TransitionCrush",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionCrush,Ia.wc=Dd.Gc("TransitionCrush"),Ia.tc=(xa=new sd,xa.TransitionType=hd.gTi,xa.Direction=$c.none,xa.Duration=2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionCrush",Ia))}if(!Array.contains(oa,"peeloff")){let xa,Ia;this.Ec.$("TransitionPeelOff",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionPeelOff,Ia.wc=Dd.Gc("TransitionPeelOffLeft"),
Ia.tc=(xa=new sd,xa.TransitionType=hd.iQe,xa.Direction=$c.none,xa.Duration=1250,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionPeelOff",Ia.next="TransitionPeelOffLeft",Ia));let qb,Hb;this.Ec.$("TransitionPeelOffLeft",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionGoLeft,Hb.wc=Dd.Gc("TransitionPeelOffLeft"),Hb.tc=(qb=new sd,qb.TransitionType=hd.iQe,qb.Direction=$c.none,qb.Duration=1250,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionPeelOff",Hb.next="TransitionPeelOffRight",Hb));let hc,Jc;this.Ec.$("TransitionPeelOffRight",
(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionGoRight,Jc.wc=Dd.Gc("TransitionPeelOffRight"),Jc.tc=(hc=new sd,hc.TransitionType=hd.iQe,hc.Direction=$c.BVa,hc.Duration=1250,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionPeelOff",Jc))}if(!Array.contains(oa,"pagecurl")){let xa,Ia;this.Ec.$("TransitionPageCurl",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionPageCurl,Ia.wc=Dd.Gc("TransitionTwoPageCurlFromRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.DPe,xa.Direction=$c.none,xa.Duration=1250,xa.IsManualAdvance=
!0,xa),Ia.parent="TransitionPageCurl",Ia.next="TransitionPageCurlDoubleLeft",Ia));let qb,Hb;this.Ec.$("TransitionPageCurlDoubleLeft",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,Hb.wc=Dd.Gc("TransitionTwoPageCurlFromRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.DPe,qb.Direction=$c.none,qb.Duration=1250,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionPageCurl",Hb.next="TransitionPageCurlDoubleRight",Hb));let hc,Jc;this.Ec.$("TransitionPageCurlDoubleRight",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionEffectOptionDoubleRight,
Jc.wc=Dd.Gc("TransitionTwoPageCurlFromLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.DPe,hc.Direction=$c.BVa,hc.Duration=1250,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionPageCurl",Jc.next="TransitionPageCurlSingleLeft",Jc));let ld,wd;this.Ec.$("TransitionPageCurlSingleLeft",(wd=new vd,wd.sc=ResourceStrings.L_TransitionEffectOptionSingleLeft,wd.wc=Dd.Gc("TransitionPageCurlFromRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.$fh,ld.Direction=$c.none,ld.Duration=1250,ld.IsManualAdvance=!0,ld),wd.parent=
"TransitionPageCurl",wd.next="TransitionPageCurlSingleRight",wd));let Bd,de;this.Ec.$("TransitionPageCurlSingleRight",(de=new vd,de.sc=ResourceStrings.L_TransitionEffectOptionSingleRight,de.wc=Dd.Gc("TransitionPageCurlFromLeft"),de.tc=(Bd=new sd,Bd.TransitionType=hd.$fh,Bd.Direction=$c.BVa,Bd.Duration=1250,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionPageCurl",de))}if(!Array.contains(oa,"airplane")){let xa,Ia;this.Ec.$("TransitionAirplane",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionAirplane,Ia.wc=
Dd.Gc("TransitionAirplaneRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.mVd,xa.Direction=$c.none,xa.Duration=1250,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionAirplane",Ia.next="TransitionAirplaneRight",Ia));let qb,Hb;this.Ec.$("TransitionAirplaneRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionGoRight,Hb.wc=Dd.Gc("TransitionAirplaneRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.mVd,qb.Direction=$c.none,qb.Duration=1250,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionAirplane",Hb.next="TransitionAirplaneLeft",
Hb));let hc,Jc;this.Ec.$("TransitionAirplaneLeft",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionGoLeft,Jc.wc=Dd.Gc("TransitionAirplaneLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.mVd,hc.Direction=$c.BVa,hc.Duration=1250,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionAirplane",Jc))}if(!Array.contains(oa,"origami")){let xa,Ia;this.Ec.$("TransitionOrigami",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionOrigami,Ia.wc=Dd.Gc("TransitionOrigamiRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.qPe,xa.Direction=
$c.none,xa.Duration=3250,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionOrigami",Ia.next="TransitionOrigamiRight",Ia));let qb,Hb;this.Ec.$("TransitionOrigamiRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionGoRight,Hb.wc=Dd.Gc("TransitionOrigamiRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.qPe,qb.Direction=$c.none,qb.Duration=3250,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionOrigami",Hb.next="TransitionOrigamiLeft",Hb));let hc,Jc;this.Ec.$("TransitionOrigamiLeft",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionGoLeft,
Jc.wc=Dd.Gc("TransitionOrigamiLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.qPe,hc.Direction=$c.BVa,hc.Duration=3250,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionOrigami",Jc))}Array.contains(oa,"dissolve")||this.Ec.$("TransitionDissolve",Object.assign(new vd,{sc:ResourceStrings.L_TransitionDissolve,wc:Dd.Gc("TransitionDissolve"),tc:Object.assign(new sd,{TransitionType:hd.dissolve,Direction:$c.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(oa,"checker")||(this.Ec.$("TransitionChecker",
Object.assign(new vd,{sc:ResourceStrings.L_TransitionChecker,wc:Dd.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new sd,{TransitionType:hd.YZd,Direction:$c.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Ec.$("TransitionCheckerFromLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromLeft,wc:Dd.Gc("TransitionCheckerboardAcross"),tc:Object.assign(new sd,{TransitionType:hd.YZd,Direction:$c.none,Duration:2500,IsManualAdvance:!0}),
parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Ec.$("TransitionCheckerFromTop",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTop,wc:Dd.Gc("TransitionCheckerboardDown"),tc:Object.assign(new sd,{TransitionType:hd.YZd,Direction:$c.OBj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(oa,"blinds")){this.Ec.$("TransitionBlinds",Object.assign(new vd,{sc:ResourceStrings.L_TransitionBlinds,wc:Dd.Gc("TransitionBlindsVertical"),tc:Object.assign(new sd,
{TransitionType:hd.blinds,Direction:$c.tGf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let xa,Ia;this.Ec.$("TransitionBlindsVertical",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionVertical,Ia.wc=Dd.Gc("TransitionBlindsVertical"),Ia.tc=(xa=new sd,xa.TransitionType=hd.blinds,xa.Direction=$c.tGf,xa.Duration=1600,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionBlinds",Ia.next="TransitionBlindsHorizontal",Ia));let qb,Hb;this.Ec.$("TransitionBlindsHorizontal",
(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionHorizontal,Hb.wc=Dd.Gc("TransitionBlindsHorizontal"),Hb.tc=(qb=new sd,qb.TransitionType=hd.blinds,qb.Direction=$c.Osi,qb.Duration=1600,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionBlinds",Hb))}if(!Array.contains(oa,"wheel")){let xa,Ia;this.Ec.$("TransitionWheel",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionWheel,Ia.wc=Dd.Gc("TransitionWheelClockwise1"),Ia.tc=(xa=new sd,xa.TransitionType=hd.wheel,xa.Direction=$c.wheel,xa.Duration=1E3,xa.IsManualAdvance=
!0,xa),Ia.parent="TransitionWheel",Ia.next="TransitionWheelClockwise",Ia));let qb,Hb;this.Ec.$("TransitionWheelClockwise",(Hb=new vd,Hb.sc=ResourceStrings.l_TransitionWheelClockWise,Hb.wc=Dd.Gc("TransitionWheelClockwise1"),Hb.tc=(qb=new sd,qb.TransitionType=hd.wheel,qb.Direction=$c.wheel,qb.Duration=1E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionWheel",Hb.next="TransitionWheelCounterclockwise",Hb));let hc,Jc;this.Ec.$("TransitionWheelCounterclockwise",(Jc=new vd,Jc.sc=ResourceStrings.l_TransitionWheelCounterClockWise,
Jc.wc=Dd.Gc("TransitionWheelCounterclockwise1"),Jc.tc=(hc=new sd,hc.TransitionType=hd.nZl,hc.Direction=$c.wheel,hc.Duration=1E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionWheel",Jc.next="TransitionWheelWedge",Jc));let ld,wd;this.Ec.$("TransitionWheelWedge",(wd=new vd,wd.sc=ResourceStrings.l_TransitionWheelWedge,wd.wc=Dd.Gc("TransitionWedge"),wd.tc=(ld=new sd,ld.TransitionType=hd.wedge,ld.Direction=$c.none,ld.Duration=1E3,ld.IsManualAdvance=!0,ld),wd.parent="TransitionWheel",wd))}if(!Array.contains(oa,
"ripple")){let xa,Ia;this.Ec.$("TransitionRipple",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionRipple,Ia.wc=Dd.Gc("TransitionRipple"),Ia.tc=(xa=new sd,xa.TransitionType=hd.ZMb,xa.Direction=$c.Tuh,xa.Duration=1400,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionRipple",Ia.next="TransitionRippleCenter",Ia));let qb,Hb;this.Ec.$("TransitionRippleCenter",(Hb=new vd,Hb.sc=ResourceStrings.L_EffectOptionsDirectionCenter,Hb.wc=Dd.Gc("TransitionRipple"),Hb.tc=(qb=new sd,qb.TransitionType=hd.ZMb,qb.Direction=
$c.Tuh,qb.Duration=1400,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionRipple",Hb.next="TransitionRippleBottomLeft",Hb));let hc,Jc;this.Ec.$("TransitionRippleBottomLeft",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromBottomLeft,Jc.wc=Dd.Gc("TransitionRippleBottomLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.ZMb,hc.Direction=$c.zUc,hc.Duration=1500,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionRipple",Jc.next="TransitionRippleBottomRight",Jc));let ld,wd;this.Ec.$("TransitionRippleBottomRight",(wd=
new vd,wd.sc=ResourceStrings.L_TransitionFromBottomRight,wd.wc=Dd.Gc("TransitionRippleBottomRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.ZMb,ld.Direction=$c.AUc,ld.Duration=1500,ld.IsManualAdvance=!0,ld),wd.parent="TransitionRipple",wd.next="TransitionRippleTopRight",wd));let Bd,de;this.Ec.$("TransitionRippleTopRight",(de=new vd,de.sc=ResourceStrings.L_TransitionFromTopRight,de.wc=Dd.Gc("TransitionRippleTopRight"),de.tc=(Bd=new sd,Bd.TransitionType=hd.ZMb,Bd.Direction=$c.DUc,Bd.Duration=1500,Bd.IsManualAdvance=
!0,Bd),de.parent="TransitionRipple",de.next="TransitionRippleTopLeft",de));let oe,Pc;this.Ec.$("TransitionRippleTopLeft",(Pc=new vd,Pc.sc=ResourceStrings.L_TransitionFromTopLeft,Pc.wc=Dd.Gc("TransitionRippleTopLeft"),Pc.tc=(oe=new sd,oe.TransitionType=hd.ZMb,oe.Direction=$c.CUc,oe.Duration=1500,oe.IsManualAdvance=!0,oe),Pc.parent="TransitionRipple",Pc))}if(!Array.contains(oa,"glitter")){let xa,Ia;this.Ec.$("TransitionGlitter",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionGlitter,Ia.wc=Dd.Gc("TransitionGlitterHexagonLeft"),
Ia.tc=(xa=new sd,xa.TransitionType=hd.mFa,xa.Direction=$c.C4f,xa.Duration=3900,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionGlitter",Ia.next="TransitionGlitterHexagonLeft",Ia));let qb,Hb;this.Ec.$("TransitionGlitterHexagonLeft",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionHexagonsFromLeft,Hb.wc=Dd.Gc("TransitionGlitterHexagonLeft"),Hb.tc=(qb=new sd,qb.TransitionType=hd.mFa,qb.Direction=$c.C4f,qb.Duration=3900,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionGlitter",Hb.next="TransitionGlitterHexagonTop",
Hb));let hc,Jc;this.Ec.$("TransitionGlitterHexagonTop",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionHexagonsFromTop,Jc.wc=Dd.Gc("TransitionGlitterHexagonTop"),Jc.tc=(hc=new sd,hc.TransitionType=hd.mFa,hc.Direction=$c.abj,hc.Duration=3900,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionGlitter",Jc.next="TransitionGlitterHexagonRight",Jc));let ld,wd;this.Ec.$("TransitionGlitterHexagonRight",(wd=new vd,wd.sc=ResourceStrings.L_TransitionHexagonsFromRight,wd.wc=Dd.Gc("TransitionGlitterHexagonRight"),wd.tc=
(ld=new sd,ld.TransitionType=hd.mFa,ld.Direction=$c.Vaj,ld.Duration=3900,ld.IsManualAdvance=!0,ld),wd.parent="TransitionGlitter",wd.next="TransitionGlitterHexagonBottom",wd));let Bd,de;this.Ec.$("TransitionGlitterHexagonBottom",(de=new vd,de.sc=ResourceStrings.L_TransitionHexagonsFromBottom,de.wc=Dd.Gc("TransitionGlitterHexagonBottom"),de.tc=(Bd=new sd,Bd.TransitionType=hd.mFa,Bd.Direction=$c.Iaj,Bd.Duration=3900,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionGlitter",de.next="TransitionGlitterDiamondLeft",
de));let oe,Pc;this.Ec.$("TransitionGlitterDiamondLeft",(Pc=new vd,Pc.sc=ResourceStrings.L_TransitionDiamondsFromLeft,Pc.wc=Dd.Gc("TransitionGlitterDiamondLeft"),Pc.tc=(oe=new sd,oe.TransitionType=hd.mFa,oe.Direction=$c.Qaj,oe.Duration=3900,oe.IsManualAdvance=!0,oe),Pc.parent="TransitionGlitter",Pc.next="TransitionGlitterDiamondTop",Pc));let tc,id;this.Ec.$("TransitionGlitterDiamondTop",(id=new vd,id.sc=ResourceStrings.L_TransitionDiamondsFromTop,id.wc=Dd.Gc("TransitionGlitterDiamondTop"),id.tc=(tc=
new sd,tc.TransitionType=hd.mFa,tc.Direction=$c.$aj,tc.Duration=3900,tc.IsManualAdvance=!0,tc),id.parent="TransitionGlitter",id.next="TransitionGlitterDiamondRight",id));let ie,v;this.Ec.$("TransitionGlitterDiamondRight",(v=new vd,v.sc=ResourceStrings.L_TransitionDiamondsFromRight,v.wc=Dd.Gc("TransitionGlitterDiamondRight"),v.tc=(ie=new sd,ie.TransitionType=hd.mFa,ie.Direction=$c.Uaj,ie.Duration=3900,ie.IsManualAdvance=!0,ie),v.parent="TransitionGlitter",v.next="TransitionGlitterDiamondBottom",v));
let Z,ua;this.Ec.$("TransitionGlitterDiamondBottom",(ua=new vd,ua.sc=ResourceStrings.L_TransitionDiamondsFromBottom,ua.wc=Dd.Gc("TransitionGlitterDiamondBottom"),ua.tc=(Z=new sd,Z.TransitionType=hd.mFa,Z.Direction=$c.Haj,Z.Duration=3900,Z.IsManualAdvance=!0,Z),ua.parent="TransitionGlitter",ua))}if(!Array.contains(oa,"vortex")){let xa,Ia;this.Ec.$("TransitionVortex",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionVortex,Ia.wc=Dd.Gc("TransitionVortexFromLeft"),Ia.tc=(xa=new sd,xa.TransitionType=hd.gyc,
xa.Direction=$c.AEa,xa.Duration=4E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionVortex",Ia.next="TransitionVortexFromLeft",Ia));let qb,Hb;this.Ec.$("TransitionVortexFromLeft",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromLeft,Hb.wc=Dd.Gc("TransitionVortexFromLeft"),Hb.tc=(qb=new sd,qb.TransitionType=hd.gyc,qb.Direction=$c.AEa,qb.Duration=4E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionVortex",Hb.next="TransitionVortexFromTop",Hb));let hc,Jc;this.Ec.$("TransitionVortexFromTop",(Jc=new vd,
Jc.sc=ResourceStrings.L_TransitionFromTop,Jc.wc=Dd.Gc("TransitionVortexFromTop"),Jc.tc=(hc=new sd,hc.TransitionType=hd.gyc,hc.Direction=$c.Lxb,hc.Duration=4E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionVortex",Jc.next="TransitionVortexFromRight",Jc));let ld,wd;this.Ec.$("TransitionVortexFromRight",(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromRight,wd.wc=Dd.Gc("TransitionVortexFromRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.gyc,ld.Direction=$c.Z8,ld.Duration=4E3,ld.IsManualAdvance=!0,ld),
wd.parent="TransitionVortex",wd.next="TransitionVortexFromBottom",wd));let Bd,de;this.Ec.$("TransitionVortexFromBottom",(de=new vd,de.sc=ResourceStrings.L_TransitionFromBottom,de.wc=Dd.Gc("TransitionVortexFromBottom"),de.tc=(Bd=new sd,Bd.TransitionType=hd.gyc,Bd.Direction=$c.DTa,Bd.Duration=4E3,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionVortex",de))}Array.contains(oa,"switch")||(this.Ec.$("TransitionSwitch",Object.assign(new vd,{sc:ResourceStrings.L_TransitionSwitch,wc:Dd.Gc("TransitionSwitchRight"),
tc:Object.assign(new sd,{TransitionType:hd.G6e,Direction:$c.VYc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Ec.$("TransitionSwitchRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionGoRight,wc:Dd.Gc("TransitionSwitchRight"),tc:Object.assign(new sd,{TransitionType:hd.G6e,Direction:$c.VYc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Ec.$("TransitionSwitchLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionGoLeft,
wc:Dd.Gc("TransitionSwitchLeft"),tc:Object.assign(new sd,{TransitionType:hd.G6e,Direction:$c.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(oa,"flip")){this.Ec.$("TransitionFlip",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFlip,wc:Dd.Gc("TransitionFlipRight"),tc:Object.assign(new sd,{TransitionType:hd.flip,Direction:$c.VYc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Ec.$("TransitionFlipRight",Object.assign(new vd,
{sc:ResourceStrings.L_TransitionGoRight,wc:Dd.Gc("TransitionFlipRight"),tc:Object.assign(new sd,{TransitionType:hd.flip,Direction:$c.VYc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let xa,Ia;this.Ec.$("TransitionFlipLeft",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionGoLeft,Ia.wc=Dd.Gc("TransitionFlipLeft"),Ia.tc=(xa=new sd,xa.TransitionType=hd.flip,xa.Direction=$c.none,xa.Duration=1250,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionFlip",Ia))}if(!Array.contains(oa,
"galleryicon")){let xa,Ia;this.Ec.$("TransitionGalleryIcon",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionGallery,Ia.wc=Dd.Gc("TransitionGalleryRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.h$d,xa.Direction=$c.Z8,xa.Duration=1600,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionGalleryIcon",Ia.next="TransitionGalleryIconFromRight",Ia));let qb,Hb;this.Ec.$("TransitionGalleryIconFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionGalleryRight"),Hb.tc=(qb=new sd,qb.TransitionType=
hd.h$d,qb.Direction=$c.Z8,qb.Duration=1600,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionGalleryIcon",Hb.next="TransitionGalleryIconFromLeft",Hb));let hc,Jc;this.Ec.$("TransitionGalleryIconFromLeft",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromLeft,Jc.wc=Dd.Gc("TransitionGalleryLeft"),Jc.tc=(hc=new sd,hc.TransitionType=hd.h$d,hc.Direction=$c.AEa,hc.Duration=1600,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionGalleryIcon",Jc))}if(!Array.contains(oa,"cube")){let xa,Ia;this.Ec.$("TransitionCube",
(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionCube,Ia.wc=Dd.Gc("TransitionCubeFromRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.aN,xa.Direction=$c.H4f,xa.Duration=1200,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionCube",Ia.next="TransitionCubeFromRight",Ia));let qb,Hb;this.Ec.$("TransitionCubeFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionCubeFromRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.aN,qb.Direction=$c.H4f,qb.Duration=1200,qb.IsManualAdvance=!0,qb),
Hb.parent="TransitionCube",Hb.next="TransitionCubeFromBottom",Hb));let hc,Jc;this.Ec.$("TransitionCubeFromBottom",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromBottom,Jc.wc=Dd.Gc("TransitionCubeFromBottom"),Jc.tc=(hc=new sd,hc.TransitionType=hd.aN,hc.Direction=$c.Gaj,hc.Duration=1200,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionCube",Jc.next="TransitionCubeFromLeft",Jc));let ld,wd;this.Ec.$("TransitionCubeFromLeft",(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromLeft,wd.wc=Dd.Gc("TransitionCubeFromLeft"),
wd.tc=(ld=new sd,ld.TransitionType=hd.aN,ld.Direction=$c.Paj,ld.Duration=1200,ld.IsManualAdvance=!0,ld),wd.parent="TransitionCube",wd.next="TransitionCubeFromTop",wd));let Bd,de;this.Ec.$("TransitionCubeFromTop",(de=new vd,de.sc=ResourceStrings.L_TransitionFromTop,de.wc=Dd.Gc("TransitionCubeFromTop"),de.tc=(Bd=new sd,Bd.TransitionType=hd.aN,Bd.Direction=$c.Zaj,Bd.Duration=1200,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionCube",de))}if(!Array.contains(oa,"doors")){let xa,Ia;this.Ec.$("TransitionDoors",
(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionDoors,Ia.wc=Dd.Gc("TransitionDoorsVertical"),Ia.tc=(xa=new sd,xa.TransitionType=hd.D5d,xa.Direction=$c.Wab,xa.Duration=1400,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionDoors",Ia.next="TransitionDoorsVertical",Ia));let qb,Hb;this.Ec.$("TransitionDoorsVertical",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionVertical,Hb.wc=Dd.Gc("TransitionDoorsVertical"),Hb.tc=(qb=new sd,qb.TransitionType=hd.D5d,qb.Direction=$c.Wab,qb.Duration=1400,qb.IsManualAdvance=!0,
qb),Hb.parent="TransitionDoors",Hb.next="TransitionDoorsHorizontal",Hb));let hc,Jc;this.Ec.$("TransitionDoorsHorizontal",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionHorizontal,Jc.wc=Dd.Gc("TransitionDoorsHorizontal"),Jc.tc=(hc=new sd,hc.TransitionType=hd.D5d,hc.Direction=$c.UYc,hc.Duration=1400,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionDoors",Jc))}if(!Array.contains(oa,"box")){let xa,Ia;this.Ec.$("TransitionBox",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionBox,Ia.wc=Dd.Gc("TransitionBoxFromRight"),
Ia.tc=(xa=new sd,xa.TransitionType=hd.aN,xa.Direction=$c.G4f,xa.Duration=1600,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionBox",Ia.next="TransitionBoxFromRight",Ia));let qb,Hb;this.Ec.$("TransitionBoxFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionBoxFromRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.aN,qb.Direction=$c.G4f,qb.Duration=1600,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionBox",Hb.next="TransitionBoxFromBottom",Hb));let hc,Jc;this.Ec.$("TransitionBoxFromBottom",
(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromBottom,Jc.wc=Dd.Gc("TransitionBoxFromBottom"),Jc.tc=(hc=new sd,hc.TransitionType=hd.aN,hc.Direction=$c.Faj,hc.Duration=1600,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionBox",Jc.next="TransitionBoxFromLeft",Jc));let ld,wd;this.Ec.$("TransitionBoxFromLeft",(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromLeft,wd.wc=Dd.Gc("TransitionBoxFromLeft"),wd.tc=(ld=new sd,ld.TransitionType=hd.aN,ld.Direction=$c.Oaj,ld.Duration=1600,ld.IsManualAdvance=!0,ld),
wd.parent="TransitionBox",wd.next="TransitionBoxFromTop",wd));let Bd,de;this.Ec.$("TransitionBoxFromTop",(de=new vd,de.sc=ResourceStrings.L_TransitionFromTop,de.wc=Dd.Gc("TransitionBoxFromTop"),de.tc=(Bd=new sd,Bd.TransitionType=hd.aN,Bd.Direction=$c.Yaj,Bd.Duration=1600,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionBox",de))}if(!Array.contains(oa,"comb")){let xa,Ia;this.Ec.$("TransitionComb",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionComb,Ia.wc=Dd.Gc("TransitionCombHorizontal"),Ia.tc=(xa=new sd,
xa.TransitionType=hd.W_d,xa.Direction=$c.none,xa.Duration=1E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionComb",Ia.next="TransitionCombHorizontal",Ia));let qb,Hb;this.Ec.$("TransitionCombHorizontal",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionHorizontal,Hb.wc=Dd.Gc("TransitionCombHorizontal"),Hb.tc=(qb=new sd,qb.TransitionType=hd.W_d,qb.Direction=$c.UYc,qb.Duration=1E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionComb",Hb.next="TransitionCombVertical",Hb));let hc,Jc;this.Ec.$("TransitionCombVertical",
(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionVertical,Jc.wc=Dd.Gc("TransitionCombVertical"),Jc.tc=(hc=new sd,hc.TransitionType=hd.W_d,hc.Direction=$c.Wab,hc.Duration=1E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionComb",Jc))}if(!Array.contains(oa,"zoom")){let xa,Ia;this.Ec.$("TransitionZoom",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionZoom,Ia.wc=Dd.Gc("TransitionZoomIn"),Ia.tc=(xa=new sd,xa.TransitionType=hd.zoom,xa.Direction=$c.y9b,xa.Duration=900,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionZoom",
Ia.next="TransitionZoomIn",Ia));let qb,Hb;this.Ec.$("TransitionZoomIn",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionIn,Hb.wc=Dd.Gc("TransitionZoomIn"),Hb.tc=(qb=new sd,qb.TransitionType=hd.zoom,qb.Direction=$c.y9b,qb.Duration=900,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionZoom",Hb.next="TransitionZoomOut",Hb));let hc,Jc;this.Ec.$("TransitionZoomOut",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionOut,Jc.wc=Dd.Gc("TransitionZoomOut"),Jc.tc=(hc=new sd,hc.TransitionType=hd.zoom,hc.Direction=$c.Zfe,
hc.Duration=900,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionZoom",Jc.next="TransitionZoomAndRotate",Jc));let ld,wd;this.Ec.$("TransitionZoomAndRotate",(wd=new vd,wd.sc=ResourceStrings.L_TransitionZoomAndRotate,wd.wc=Dd.Gc("TransitionNewsFlash"),wd.tc=(ld=new sd,ld.TransitionType=hd.D_l,ld.Direction=$c.none,ld.Duration=1500,ld.IsManualAdvance=!0,ld),wd.parent="TransitionZoom",wd))}if(!Array.contains(oa,"random")){let xa,Ia;this.Ec.$("TransitionRandom",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionRandom,
Ia.wc=Dd.Gc("TransitionRandom"),Ia.tc=(xa=new sd,xa.TransitionType=hd.random,xa.Direction=$c.ZBj,xa.Duration=1500,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionRandom",Ia))}}if(!Array.contains(oa,"menusectiondynamiccontent")){if(!Array.contains(oa,"pan")){let xa,Ia;this.Ec.$("TransitionPan",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionPan,Ia.wc=Dd.Gc("TransitionPanFromBottom"),Ia.tc=(xa=new sd,xa.TransitionType=hd.pan,xa.Direction=$c.DTa,xa.Duration=1300,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionPan",
Ia.next="TransitionPanFromBottom",Ia));this.Ec.$("TransitionPanFromBottom",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromBottom,wc:Dd.Gc("TransitionPanFromBottom"),tc:Object.assign(new sd,{TransitionType:hd.pan,Direction:$c.DTa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Ec.$("TransitionPanFromLeft",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromLeft,wc:Dd.Gc("TransitionPanFromLeft"),tc:Object.assign(new sd,{TransitionType:hd.pan,
Direction:$c.AEa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Ec.$("TransitionPanFromRight",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromRight,wc:Dd.Gc("TransitionPanFromRight"),tc:Object.assign(new sd,{TransitionType:hd.pan,Direction:$c.Z8,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Ec.$("TransitionPanFromTop",Object.assign(new vd,{sc:ResourceStrings.L_TransitionFromTop,wc:Dd.Gc("TransitionPanFromTop"),
tc:Object.assign(new sd,{TransitionType:hd.pan,Direction:$c.Lxb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(oa,"conveyor")){this.Ec.$("TransitionConveyor",Object.assign(new vd,{sc:ResourceStrings.L_TransitionConveyor,wc:Dd.Gc("TransitionConveyorRight"),tc:Object.assign(new sd,{TransitionType:hd.n1d,Direction:$c.Z8,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let xa,Ia;this.Ec.$("TransitionConveyorFromRight",
(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionFromRight,Ia.wc=Dd.Gc("TransitionConveyorRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.n1d,xa.Direction=$c.Z8,xa.Duration=1600,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionConveyor",Ia.next="TransitionConveyorFromLeft",Ia));let qb,Hb;this.Ec.$("TransitionConveyorFromLeft",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromLeft,Hb.wc=Dd.Gc("TransitionConveyorLeft"),Hb.tc=(qb=new sd,qb.TransitionType=hd.n1d,qb.Direction=$c.AEa,qb.Duration=1600,qb.IsManualAdvance=
!0,qb),Hb.parent="TransitionConveyor",Hb))}if(!Array.contains(oa,"rotate")){let xa,Ia;this.Ec.$("TransitionRotate",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionRotate,Ia.wc=Dd.Gc("TransitionRotateLeft"),Ia.tc=(xa=new sd,xa.TransitionType=hd.aN,xa.Direction=$c.J4f,xa.Duration=2E3,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionRotate",Ia.next="TransitionRotateFromRight",Ia));let qb,Hb;this.Ec.$("TransitionRotateFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionRotateLeft"),
Hb.tc=(qb=new sd,qb.TransitionType=hd.aN,qb.Direction=$c.J4f,qb.Duration=2E3,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionRotate",Hb.next="TransitionRotateFromBottom",Hb));let hc,Jc;this.Ec.$("TransitionRotateFromBottom",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromBottom,Jc.wc=Dd.Gc("TransitionRotateTop"),Jc.tc=(hc=new sd,hc.TransitionType=hd.aN,hc.Direction=$c.Kaj,hc.Duration=2E3,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionRotate",Jc.next="TransitionRotateFromLeft",Jc));let ld,wd;this.Ec.$("TransitionRotateFromLeft",
(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromLeft,wd.wc=Dd.Gc("TransitionRotateRight"),wd.tc=(ld=new sd,ld.TransitionType=hd.aN,ld.Direction=$c.Saj,ld.Duration=2E3,ld.IsManualAdvance=!0,ld),wd.parent="TransitionRotate",wd.next="TransitionRotateFromTop",wd));let Bd,de;this.Ec.$("TransitionRotateFromTop",(de=new vd,de.sc=ResourceStrings.L_TransitionFromTop,de.wc=Dd.Gc("TransitionRotateBottom"),de.tc=(Bd=new sd,Bd.TransitionType=hd.aN,Bd.Direction=$c.cbj,Bd.Duration=2E3,Bd.IsManualAdvance=!0,Bd),
de.parent="TransitionRotate",de))}if(!Array.contains(oa,"window")){let xa,Ia;this.Ec.$("TransitionWindow",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionWindow,Ia.wc=Dd.Gc("TransitionWindowVertical"),Ia.tc=(xa=new sd,xa.TransitionType=hd.window,xa.Direction=$c.Wab,xa.Duration=1500,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionWindow",Ia.next="TransitionWindowVertical",Ia));let qb,Hb;this.Ec.$("TransitionWindowVertical",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionVertical,Hb.wc=Dd.Gc("TransitionWindowVertical"),
Hb.tc=(qb=new sd,qb.TransitionType=hd.window,qb.Direction=$c.Wab,qb.Duration=1500,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionWindow",Hb.next="TransitionWindowHorizontal",Hb));let hc,Jc;this.Ec.$("TransitionWindowHorizontal",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionHorizontal,Jc.wc=Dd.Gc("TransitionWindowHorizontal"),Jc.tc=(hc=new sd,hc.TransitionType=hd.window,hc.Direction=$c.UYc,hc.Duration=1500,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionWindow",Jc))}if(!Array.contains(oa,"orbit")){let xa,
Ia;this.Ec.$("TransitionOrbit",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionOrbit,Ia.wc=Dd.Gc("TransitionOrbitFromRight"),Ia.tc=(xa=new sd,xa.TransitionType=hd.aN,xa.Direction=$c.I4f,xa.Duration=1600,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionOrbit",Ia.next="TransitionOrbitFromRight",Ia));let qb,Hb;this.Ec.$("TransitionOrbitFromRight",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionFromRight,Hb.wc=Dd.Gc("TransitionOrbitFromRight"),Hb.tc=(qb=new sd,qb.TransitionType=hd.aN,qb.Direction=$c.I4f,qb.Duration=
1600,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionOrbit",Hb.next="TransitionOrbitFromBottom",Hb));let hc,Jc;this.Ec.$("TransitionOrbitFromBottom",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionFromBottom,Jc.wc=Dd.Gc("TransitionOrbitFromBottom"),Jc.tc=(hc=new sd,hc.TransitionType=hd.aN,hc.Direction=$c.Jaj,hc.Duration=1600,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionOrbit",Jc.next="TransitionOrbitFromLeft",Jc));let ld,wd;this.Ec.$("TransitionOrbitFromLeft",(wd=new vd,wd.sc=ResourceStrings.L_TransitionFromLeft,
wd.wc=Dd.Gc("TransitionOrbitFromLeft"),wd.tc=(ld=new sd,ld.TransitionType=hd.aN,ld.Direction=$c.Raj,ld.Duration=1600,ld.IsManualAdvance=!0,ld),wd.parent="TransitionOrbit",wd.next="TransitionOrbitFromTop",wd));let Bd,de;this.Ec.$("TransitionOrbitFromTop",(de=new vd,de.sc=ResourceStrings.L_TransitionFromTop,de.wc=Dd.Gc("TransitionOrbitFromTop"),de.tc=(Bd=new sd,Bd.TransitionType=hd.aN,Bd.Direction=$c.bbj,Bd.Duration=1600,Bd.IsManualAdvance=!0,Bd),de.parent="TransitionOrbit",de))}if(!Array.contains(oa,
"flythrough")){let xa,Ia;this.Ec.$("TransitionFlyThrough",(Ia=new vd,Ia.sc=ResourceStrings.L_TransitionFlyThrough,Ia.wc=Dd.Gc("TransitionFlyThroughIn"),Ia.tc=(xa=new sd,xa.TransitionType=hd.$6b,xa.Direction=$c.y9b,xa.Duration=800,xa.IsManualAdvance=!0,xa),Ia.parent="TransitionFlyThrough",Ia.next="TransitionFlyThroughIn",Ia));let qb,Hb;this.Ec.$("TransitionFlyThroughIn",(Hb=new vd,Hb.sc=ResourceStrings.L_TransitionIn,Hb.wc=Dd.Gc("TransitionFlyThroughIn"),Hb.tc=(qb=new sd,qb.TransitionType=hd.$6b,qb.Direction=
$c.y9b,qb.Duration=800,qb.IsManualAdvance=!0,qb),Hb.parent="TransitionFlyThrough",Hb.next="TransitionFlyThroughOut",Hb));let hc,Jc;this.Ec.$("TransitionFlyThroughOut",(Jc=new vd,Jc.sc=ResourceStrings.L_TransitionOut,Jc.wc=Dd.Gc("TransitionFlyThroughOut"),Jc.tc=(hc=new sd,hc.TransitionType=hd.$6b,hc.Direction=$c.Zfe,hc.Duration=800,hc.IsManualAdvance=!0,hc),Jc.parent="TransitionFlyThrough",Jc.next="TransitionFlyThroughInWithBounce",Jc));let ld,wd;this.Ec.$("TransitionFlyThroughInWithBounce",(wd=new vd,
wd.sc=ResourceStrings.L_TransitionInWithBounce,wd.wc=Dd.Gc("TransitionFlyThroughIn"),wd.tc=(ld=new sd,ld.TransitionType=hd.$6b,ld.Direction=$c.k$i,ld.Duration=900,ld.IsManualAdvance=!0,ld),wd.parent="TransitionFlyThrough",wd.next="TransitionFlyThroughOutWithBounce",wd));let Bd,de;this.Ec.$("TransitionFlyThroughOutWithBounce",(de=new vd,de.sc=ResourceStrings.L_TransitionOutWithBounce,de.wc=Dd.Gc("TransitionFlyThroughOut"),de.tc=(Bd=new sd,Bd.TransitionType=hd.$6b,Bd.Direction=$c.l$i,Bd.Duration=900,
Bd.IsManualAdvance=!0,Bd),de.parent="TransitionFlyThrough",de))}}this.Ec.forEach((xa,Ia)=>{xa===Ia.parent&&++W;return!0})}EUa(A){let W=null;A?this.Ec.forEach((oa,xa)=>{xa.tc&&xa.tc.TransitionType===A.TransitionType&&xa.tc.Direction===A.Direction&&(W=oa);return!0}):W="TransitionNone";return W}PQ(A){return this.Ec.ga(A)}pzb(A){return(A=this.EUa(A))?this.Ec.ga(this.Ec.ga(A).parent):null}FUa(A){return(A=this.EUa(A))?this.Ec.ga(A).parent:null}Cag(A){let W,oa=null;W=null;A&&A.next&&(W=A.next,oa=this.PQ(W));
return{returnValue:oa,key:W}}yyb(){var A=[Dd.nbj,Dd.S3k,Dd.T3k];for(const W of A)if(A=document.getElementById(W))return A;return null}v4c(A,W){return A&&W&&W.childNodes?A.startsWith(Dd.obj)?W.contains(document.getElementById(A)):!1:!W&&A?"TransitionExisting"===A||"TransitionNone"===A||"TransitionMorph"===A||"TransitionCut"===A||"TransitionFade"===A||"TransitionPush"===A||"TransitionWipe"===A:!1}static Gc(A){return Ye.a.Noc+"_"+A+"_32x32x32"}}Dd.nbj="PptRibbon.Transition.Gallery-MaxSize-1-0";Dd.S3k=
"Transitions";Dd.T3k="Transitions-previewWrapper";Dd.obj="Transition";Object(h.a)(Dd,"TransitionHelper",null,[893]);var Re=d(193);class ml{constructor(A){this.paf=(W,oa,xa,Ia,qb)=>1===xa?32:qb?32:16;this.ia=A}vb(){this.ia.ra(bd.a.wPh,Nc.a.application,this.paf,4);this.ia.ra(bd.a.KPh,Nc.a.application,this.paf,4);this.ia.ra(bd.a.jRh,Nc.a.application,this.paf,4)}me(){}}Object(h.a)(ml,"PictureEnhancementActor",null,[268]);var Mh=d(1173);class we{constructor(){this.jh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}Xb(A){this.K=
A;this.jh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").WEa(0,this.name);this.K.register(869,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").na().oa(()=>new Rc(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").sQ){const W=Re.a(this.K);this.K.register(870,"PowerPointWebEditor.IAudioManagerStore").na().oa(()=>new ne);this.K.register(871,"PowerPointWebEditor.IAudioLibraryCallbackFactory").na().oa(()=>new Wb(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").sQ,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Ia("PowerPointWebEditor.IAudioManagerStore")));this.K.register(872,"PowerPointWebEditor.IAudioManagerFactory").na().oa(()=>new Uc(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),W,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let A=this.jh.du("resolve");var W=this.K.resolve("Common.AFrameworkApplication");const oa=this.K.resolve("PowerPointWebEditor.IApplicationContext"),xa=oa.rd;W=W.To;const Ia=this.K.resolve("Common.IActionManagerExtended"),qb=this.K.resolve("PowerPointWebEditor.IFocusManager");W=W.Ld;const Hb=this.K.resolve("Common.Transaction.ITransactionFactory"),hc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
Jc=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),ld=this.K.resolve("PowerPointWebEditor.PictureContext"),wd=this.K.resolve("PowerPoint.IPathManager");var Bd=this.K.resolve("PowerPointWebEditor.IPresentationReader");const de=this.K.resolve("PowerPointWebEditor.IShapeReader"),oe=this.K.resolve("PowerPointWebEditor.IPictureUploader"),Pc=this.K.ue("PowerPointWebEditor.IPPTLanguageDialogFactory"),tc=this.K.resolve("Box4.IParagraphReader");this.jh.lu(A);A=this.jh.du("regactors");
Bd=[new Lh(Ia,hc,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),tc,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),de,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),kc.App.NMa.ZOc(12),xa.telemetryForPptParagraphSettingEnabled),new Ub(Ia,qb,Jc,Hb,hc,wd,W,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Bd,new bf,xa.Xrg,
this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled"),this.K.resolve("Common.IAppSettingsManager").ka("EnableDefaultThemeRefresh")),new jd(Ia,W,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Hb,hc,qb,new Dd(xa.ZMa),Jc,xa,wd,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];xa.ntb?Bd.push(new Ee(Ia,hc,qb,Hb,new Qa(xa.sWd),Jc,de,wd,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").zd(8),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))):Bd.push(new Og(Ia,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),hc,qb,Hb,new Qa(xa.sWd),Jc,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),de,wd));xa.powerPointFormatBackgroundEnabled&&Bd.push(new Vi(Ia,qb,Jc,hc,Hb,W,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
oe,ld,L.AFrameworkApplication.dR,this.K.resolve("PowerPointWebEditor.IErrorHandler"),xa));xa.Exb&&Bd.push(new ml(Ia));xa.Nxb&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureBGREnabled",!1)&&Bd.push(new Mh.a(Ia,this.K.resolve("PowerPointWebEditor.Core.IAppOfflineSetter"),hc,this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),this.K.resolve("PowerPointWebEditor.IImageIdHelper"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));for(const id of Bd)id.vb(),id.me();this.jh.lu(A);L.AFrameworkApplication.fa.$e(()=>{A=this.jh.du("regfullactors");const id=[],ie=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");ie.hWa=this.K.resolve("Common.IAppSettingsManager").ka("299");
oa.rd.$Kb&&id.push(new ai(Ia,Pc,ie,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.Ia("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),hc));this.K.resolve("PowerPointWebEditor.IApplicationSettings").aac&&
id.push(new he(Ia,qb,hc,Re.a(this.K)));for(const v of id)v.vb(),v.me();ie.hWa&&(new Xg(Ia,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(v,Z)=>new Je(v,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),Z,this.K.resolve("Common.IFocusManager")),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),hc,this.K.resolve("Box4.ILanguageReader"),de)).vb();this.jh.lu(A)})}dispose(){}}Object(h.a)(we,"AdvancedPackage",null,[2,3]);class Yi{get container(){return H.a.instance.resolve("PowerPointWebEditor.IRibbonPane").xa}}
Object(h.a)(Yi,"PPTFloatPaneContainer",null,[689]);class nl{constructor(A,W,oa=null){this.xhb=new Id.a(0);this.O_a=null;this.cjb=this.O_a=kc.App.tn;this.Cze=A;this.Q3g=1E3*W;this.aHg=oa||(()=>(new Date).getTime())}tsi(A){this.Cze&&this.xhb.add(A,(new Date).getTime())}$Yf(A){this.Cze&&(this.xhb.remove(A),this.WLl(this.aHg()-this.Q3g))}WLl(A){if(this.xhb.count){var W=[];this.xhb.forEach((oa,xa)=>{xa<A&&W.push(oa);return!0});for(const oa of W)this.xhb.remove(oa)}}get qqg(){return this.cjb<=this.O_a}xKj(){if(!this.Cze||
!this.xhb.count)return!1;let A=!1;const W=this.aHg();this.xhb.forEach((oa,xa)=>W-xa<this.Q3g?(A=!0,!1):!0);return A}}Object(h.a)(nl,"PictureContext",null,[873]);var Pj=d(923),ol=d(525);class mi{constructor(){this.Bfb=this.kEe=this.zOg=this.AOg=!1;this.jh=this.G5=this.oGb=this.WOg=this.K=null;this.Ffc=[new we];this.kY=[]}get name(){return"PowerPointWebEditor.Chronos"}Xb(A){this.K=A;this.G5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.G5.WEa(0,this.name);for(let W=0;W<
this.Ffc.length;++W)Array.add(this.kY,yd.a(this.Ffc[W],0));for(const W of this.kY)W.Xb(A);mi.kIi(A);this.K.register(nl,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").na().oa(()=>new nl(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}Fnc(A,W){A=rb.a.instance;for(let xa=0;xa<W.entries.length;xa++){var oa=
W.entries[xa];oa.url=D.a.removeParameter(oa.url,L.AFrameworkApplication.HN);const Ia=D.a.Paa(oa.url);let qb=!1;if("about:blank"===oa.url||Ia.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Ia&&"2"===D.a.cO(oa.url,"u")||this.Bfb&&(qb=Ia.endsWith("PowerPoint.ashx"))&&oa.url.endsWith("ib=1"))oa.behavior=1;else{if(qb||Ia.endsWith("PowerPoint.ashx")||Ia.endsWith("GetUpdates")||Ia.endsWith("images.ashx")||Ia.endsWith("GetThumb"))oa.behavior=2;if(!this.AOg&&Ia.endsWith("PowerPoint.ashx")&&"true"===D.a.cO(oa.url,
fc.a.lQk))oa=oa.oC,A.$b(gf.a.R0d,parseInt(String(oa.fetchStart))),A.$b(gf.a.zKi,parseInt(String(oa.responseStart))),A.$b(gf.a.rKi,parseInt(String(oa.responseEnd-oa.responseStart))),this.AOg=!0;else if(!this.zOg&&Ia.endsWith("PowerPoint.ashx")&&"true"===D.a.cO(oa.url,"dSlide")){this.zOg=!0;oa=oa.oC;A.$b("SlideImageFetchStart",parseInt(String(oa.fetchStart)));A.$b("SlideImageResponseStart",parseInt(String(oa.responseStart)));A.$b("SlideImageDownloadDuration",parseInt(String(oa.responseEnd-oa.responseStart)));
let Hb;({transferSize:Hb}=mi.ZNh(oa)).returnValue&&A.$b("SlideImageSize",Hb)}else if(!this.kEe&&Ia.endsWith("images.ashx")&&"true"===D.a.cO(oa.url,"minimalboot")&&D.a.cO(oa.url,"index")===this.WOg){this.kEe=!0;oa=oa.oC;A.$b("MBootFetchStart",parseInt(String(oa.fetchStart)));A.$b("MBootResponseStart",parseInt(String(oa.responseStart)));A.$b("MBootDownload",parseInt(String(oa.responseEnd-oa.responseStart)));let Hb;({transferSize:Hb}=mi.ZNh(oa)).returnValue&&A.$b("MBootSize",Hb)}}}}Vql(){const A=window.self.FirstSlideRequestIndex;
void 0===A||null===A?this.kEe=!0:this.WOg=A.toString()}init(){gd.a.J(512497358,809,50,"ChronosPackage::Init");const A=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),W=this.K.resolve("Common.ITaskManager");for(var oa of this.kY)this.jh.du(oa.name),oa.init(),this.jh.lu(oa.name);this.K.resolve("Common.IAppSettingsManager").$e(()=>{if(A.podsAnimationSuggestionEnabled){const xa=this.jh.du("animationpreview");this.nRj();this.jh.lu(xa)}});this.K.resolve("Common.IActionManagerExtended").Oaa(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));
oa=H.a.instance.resolve("Box4.IProofingManager");if(null!==oa){let xa=this.jh.du("proofingresume");oa.resume();this.jh.lu(xa)}if(A.Yua||!A.pWa)oa=this.jh.du("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").rHh(),this.jh.lu(oa);this.Vql();this.Bfb=A.podsUseRealtimeCoauthReplicationTimerForInbound;oa=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");oa.Xb(30,0);oa.GAf(Object(n.a)(this,this.Fnc,"onResourceTimingEntriesAvailable"));oa.activate();A.aWa&&
(this.oGb=window.self.PerfMeterData,void 0!==this.oGb&&null!==this.oGb&&(W.Hb(new ee.a(3,2,6E4,Object(n.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),gd.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").GC(()=>{this.collectPerfMeterData(null)})));A.ka("IsPasteTextFloatieEnabled")&&this.K.resolve("Common.IActionManagerExtended").Oaa(this.K.resolve("Box4.ITextPasteFloatieManager"));this.yck(A)}yck(A){gd.a.J(512497356,
809,50,"Start to download chronos1 js file");if(A.rxc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1300)));else{A=Ab.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1300)));const W=this.K.resolve("PowerPointWebEditor.ISessionState");A.sW(()=>{W&&W.A6("Chronos1DownloadFinished")});Fa.a.py(A)}}collectPerfMeterData(){if(0<this.oGb.length){const A=[];for(const W of this.oGb)A.push({["Id"]:W.Id,["Value"]:W.Value.toFixed(2),
["Start"]:W.Start.toFixed(2),["Duration"]:W.Duration.toFixed(2)});gd.a.J(512497355,813,50,JSON.stringify(A));this.oGb.length=0}}dispose(){for(var A of this.kY)A.dispose();A=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");A.deactivate(!0);A.Wqh(Object(n.a)(this,this.Fnc,"onResourceTimingEntriesAvailable"))}nRj(){const A=Ab.a.create("pptedit.animationpreview",null,()=>d.e(19).then(d.bind(null,1316)));try{Fa.a.py(A)}catch(W){gd.a.J(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",
W.toString())}}static kIi(A){A.register(689,"Common.IFloatPaneContainer").na().oa(()=>new Yi)}static ZNh(A){A=parseInt(String(Pj.a(A,"transferSize")));return{returnValue:!A.toString().startsWith("NaN"),transferSize:A}}static main(){L.AFrameworkApplication.Yg&&Y.a.mg?gd.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(rb.a.instance.$b(ol.a.$Zd,(new Date).getTime()),Za.a.instance.Ac(yd.a(new mi,0)))}}Object(h.a)(mi,"ChronosPackage",null,[2,3]);class nk{constructor(A,
W,oa,xa,Ia,qb,Hb){this.jHb=this.jM=!1;this.ua=A;this.lc=W;this.Ur=oa;this.Ys=xa;this.Mdb=qb;this.$d=Ia;this.ru=this.ua.Ba;this.Kc=Hb}initialize(){this.Ur.gk(Object(n.a)(this,this.$g,"onPropertyChanged"));this.$d.B7a(Object(n.a)(this,this.kga,"onRibbonTabSwitched"));this.Ys.eT(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Ys.Zsb(Object(n.a)(this,this.Pxa,"onShapeViewElementAdded"));this.Ys.eli(Object(n.a)(this,this.Hdh,"onShapesAllSelected"))}dispose(){this.Ur.Qm(Object(n.a)(this,
this.$g,"onPropertyChanged"));this.$d.Lrc(Object(n.a)(this,this.kga,"onRibbonTabSwitched"));this.Ys.Voa(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Ys.pqd(Object(n.a)(this,this.Pxa,"onShapeViewElementAdded"));this.Ys.Ecl(Object(n.a)(this,this.Hdh,"onShapesAllSelected"))}$g(A,W){W.property===Jh.a.EUc&&this.jM&&this.lc.jg(W.node)===this.ru&&this.xya(this.jM)}kga(A,W){if(this.jM=!!W.Zfa&&0<=W.Zfa.indexOf("Animation"))this.jHb=!0;this.xya(this.jM)}Pxa(A,W){(A=this.ua.Ba)&&
A.vO&&A===this.ru&&(W=W.$w)&&W.shapeNode&&this.ru&&this.xGa(this.ru.Cb,W.shapeNode)&&this.xya(this.jM)}xGa(A,W){return A&&W?A.equals(W.slideId):!1}onActiveSlideDomReady(A,W){(A=Object(z.a)(116,W.Ba))&&this.ru&&this.ru.Cb!==A.Cb&&(this.ru=A,this.xya(this.jM))}Hdh(){this.aba()}aba(){if(this.jM&&this.ru&&this.ru.pFa&&this.jHb){var A=this.ru.yj();if(A&&0<A.length)for(const W of A)W&&W.$bb()&&(A=this.Mdb.dJ(W))&&(A.l2b(),A.aba(!0))}}xya(A){if(this.jHb&&this.ru&&this.ru.vO&&this.Kc.Hc&&this.Kc.Hc.DKc){var W=
this.ru.yj();if(W&&0<W.length)for(const oa of W)oa&&(W=this.Mdb.dJ(oa))&&(W.visible=A,W.bkb())}}}Object(h.a)(nk,"AnimationMarkerManagerLegacy",null,[108]);var ek=d(78),bj=d(59);class Nk{constructor(A,W){this.height=A;this.top=W}}Object(h.a)(Nk,"ParagraphProperties",null,[]);var Qj=d(49),Nf=d(68),Bg=d(139),Xk=d(167),Ni=d(190),nh=d(191);class ni{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd,de,oe,Pc){this.Dic=this.AA=this.dHb=this.Tk=this.Ab=!1;this.va=new ek.a;this.Vic=this.nd=1;this.hn=this.en=this.kh=
this.yb=this.ob=null;this.Bm=tc=>{tc&&this.WO?(this.ob=new Bg.a,this.ob.Fr("AnimationMarkerView"),this.WO.appendChild(this.ob.xa),this.yb=new nh.a,this.yb.ek(0),this.ob.appendChild(this.yb.viewport),this.kh=new Xk.a,this.kh.ek(1),this.kh.setVisibility(!1),this.yb.appendChild(this.kh),this.en=new Bg.a,this.en.Fr("ShapeAnimationMarkerContainer"),this.en.xa.id=this.ta.id.toString(),this.en.ah(20,this.ob.xa.clientHeight),this.en.ek(1),this.ob.appendChild(this.en),this.hn=new Bg.a,this.hn.Fr("TextAnimationMarkerContainer"),
this.hn.xa.id=this.ta.id.toString(),this.hn.ah(20,this.ob.xa.clientHeight),this.hn.ek(1),this.ob.appendChild(this.hn),this.$f.ub(sc.a.tq,this.en.xa,this.BD),this.$f.ub(sc.a.Zs,this.en.xa,this.BD),this.$f.ub(sc.a.tq,this.hn.xa,this.BD),this.$f.ub(sc.a.Zs,this.hn.xa,this.BD),this.$f.ub(sc.a.bK,this.en.xa,this.JUa),this.$f.ub(sc.a.bK,this.hn.xa,this.JUa),this.$f.ub(sc.a.mouseDown,this.en.xa,this.JUa),this.$f.ub(sc.a.mouseDown,this.hn.xa,this.JUa),this.Rc.ub(sc.a.click,this.hn.xa,this.hZc),this.Rc.ub(sc.a.click,
this.en.xa,this.hZc),this.setVisibility()):gd.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",tc?"m_markerViewParentElement":"parent")};this.PL=()=>!0;this.JUa=tc=>{if(!tc&&!tc.Bc.id.startsWith(Ye.a.H7a)&&!tc.Bc.id.startsWith("overlappedMarker"))return gd.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;tc.eventName==sc.a.bK&&this.cOe(tc);tc=tc.nc;tc.preventDefault();tc.stopPropagation();return!0};this.hZc=tc=>{tc=tc.nc;tc.preventDefault();
tc.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let tc=this.Ab&&!this.AA;this.ta&&this.ta.isHiddenShape&&(tc=!1);this.ob&&this.ob.Sd(tc);this.en&&this.en.Sd(tc);this.hn&&this.hn.Sd(tc)};this.aba=tc=>{if(this.L9()){this.dHb=tc;tc=[this.en.xa.childNodes,this.hn.xa.childNodes];for(const id of tc)for(tc=0;id&&tc<id.length;tc++)this.Xsc(id[tc],this.dHb)}};this.jll=tc=>{if(this.L9()){var id=[this.en.xa.childNodes,this.hn.xa.childNodes];for(const ie of id)for(id=0;ie&&id<
ie.length;id++){const v=this.Uxb(ie[id]);if(!Ff.a("FixAnimationMarkerAttributeNullCrash")||v)for(const Z of tc)v.includes(Z)&&this.Xsc(ie[id],!0)}}};this.Uxb=tc=>{if(!tc||!this.ta)return null;tc=tc.getAttribute("AnimProps");if(!tc||!tc.toString()||!tc.toString().trim().length)return null;tc=tc.toString().split(" ");if(!tc||!tc.length)return null;const id=[];for(const ie of tc){if(!ie||!ie.trim().length)return null;id.push(Number.parseInvariant(ie.trim()))}return id};this.L9=()=>{const tc=!!this.ta&&
!!this.WO&&!!this.en&&!!this.hn;tc||gd.a.J(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return tc};this.NRa=()=>{this.Gja(!0);this.Gja(!1)};this.Gja=tc=>{if(this.$f&&this.Rc&&this.L9()&&(tc=tc?this.hn.xa:this.en.xa)&&tc.childNodes&&0<tc.childNodes.length){const id=tc.childNodes;for(const ie=0;ie<id.length;)tc.removeChild(id[ie])}};this.eTd=()=>{if(this.L9()){var tc=this.lc.jg(this.ta);if(tc){var id=tc.xyb(this.ta);if(id&&id.length){var ie=!1;tc=!1;var v=[];for(var Z of id)Z.IsTextRangeType?
tc=!0:(ie=!0,v.push(Z));this.Dic=ie&&tc;this.gNa(!0);this.gNa(!1);this.Gja(!1);0<v.length&&(Z=0,v.sort((ua,Ra)=>ua.EffectNodeId-Ra.EffectNodeId),(Z=Ff.a("FixOverlappedAnimationMarkers")?this.n5b(v,this.oi.cI(this.ta.Nn.mc,this.nd),this.oi.cI(this.ta.Nn.Zb-this.ta.Nn.mc,this.nd),!1,-1):this.mXf(v,this.oi.cI(this.ta.Nn.mc,this.nd),this.oi.cI(this.ta.Nn.Zb-this.ta.Nn.mc,this.nd),!1))||gd.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));tc?this.Z6d():this.Gja(!0)}else this.NRa()}else gd.a.J(509682578,
800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.Z6d=()=>{const tc=new ee.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.wb.Hb(tc)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.Tk||(this.Jxe(),this.o5b())};this.o5b=()=>{this.Gja(!0);if(this.Che()){var tc=this.oee();if(tc&&tc.length){var id;if(({top:id}=this.xee()).returnValue){var ie=0;for(let Z=0;Z<tc.length;Z++){var v=this.lc.jg(this.ta);if(!v){gd.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");
return}(v=v.gde(this.ta,Z))&&0<v.length&&tc[Z]&&(v.sort((ua,Ra)=>ua.EffectNodeId-Ra.EffectNodeId),ie=Ff.a("FixOverlappedAnimationMarkers")?ie+this.n5b(v,tc[Z].top-id,tc[Z].height,!0,Z):ie+this.mXf(v,tc[Z].top-id,tc[Z].height,!0))}ie||gd.a.J(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else gd.a.J(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else gd.a.J(509682576,800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.oee=
()=>{const tc=[];var id=xi.GraphIterator.pb(this.ta);id=this.Yl.O3(id,id.currentNode);for(var ie;id.moveNext();)(ie=id.currentNode)&&this.Hh.fe(ie)&&ie&&(ie=ie.qc(this.Nz))&&ie.htmlElement&&(ie=this.fua(ie.htmlElement))&&ie.height&&tc.push(ie);return tc};this.fua=tc=>{if(!tc)return gd.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;tc=tc.querySelectorAll(".TextRun");if(!tc||!tc.length)return null;let id=0,ie=0;let v,Z=!1;for(let Ra=0;Ra<tc.length&&tc[Ra];Ra++){var ua=
tc[Ra].getClientRects();({top:ua,bottom:v}=this.L8d(ua)).returnValue&&(Ra?(id=id>ua?ua:id,ie=ie<v?v:ie):(id=ua,ie=v),Z=!0)}if(Z)return new Nk(ie-id,id);gd.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.uK=()=>{this.oIe(this.ob.xa,!0)};this.Che=()=>{var tc=this.lc.jg(this.ta);if(!tc)return gd.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;tc=tc.xyb(this.ta);if(!tc||!tc.length)return!1;for(const id of tc)if(id.IsTextRangeType)return!0;
return!1};this.gNa=tc=>{if(this.L9()){var id=tc?this.en.xa:this.hn.xa,ie,v;id&&({x:ie,y:v}=this.Dce(tc)).returnValue&&(id.style.position=Nf.a.absolute,id.style.left=Qj.a.Pc(ie),id.style.zIndex="20000",tc?id.style.top=Qj.a.Pc(v):this.o5b())}};this.cOe=tc=>{if(this.va&&tc&&this.Fa&&tc.Bc){var id=Ff.a("FixOverlappedAnimationMarkers")?tc.Bc.id.startsWith("overlappedMarker")&&tc.Bc.parentElement?tc.Bc.parentElement:tc.Bc:tc.Bc.id.startsWith("overlappedMarker")&&tc.Bc.offsetParent?tc.Bc.offsetParent:tc.Bc;
(id=this.Uxb(id))?(tc.ctrlKey?this.Zj.MCj(id,this.lc.jg(this.ta)):(this.Zj.DOb(!1),this.Zj.eka(),this.Zj.DOb(!0),this.Zj.QTd(id,this.lc.jg(this.ta))),this.va.raiseEvent("OnMarkerClick",tc),this.Fa.Bd()):gd.a.J(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.em=()=>{this.yb&&(this.yRb(),this.yb.em())};this.yRb=()=>{if(this.ta&&this.kh){var tc=this.ta.Nn.points;tc=ni.dsa(tc,this.dzb());this.kh.Mt(tc)}};this.dzb=()=>{let tc=Ye.a.zNb;this.ta.Wf||!this.ta.eva&&
!this.ta.Ik||(tc+=6);return tc};this.Mp=()=>{this.yb&&this.Vic!==this.nd&&this.bkb();return null};this.wq=()=>{};this.Ju=()=>{};this.Kj=tc=>{this.Vic=this.nd;this.nd=tc};this.setZIndex=tc=>{this.yb&&this.yb.lC(tc)};this.draw=()=>{this.bkb()};this.bkb=()=>{this.ob&&this.WO&&this.Ab&&!this.AA&&(this.NRa(),this.eTd());this.setVisibility()};this.BD=tc=>{if(!this.va||!tc)return!1;this.va.raiseEvent("OnSelectionAreaHover",tc);tc.eventName===sc.a.tq?this.d2(tc.Bc,"animMarkerHovered",1):tc.eventName===sc.a.Zs&&
this.d2(tc.Bc,"animMarkerHovered",2);return!0};this.Xsc=(tc,id)=>{tc?id?(this.d2(tc,"animMarkerUnselected",2),this.d2(tc,"animMarkerSelected",1)):(this.d2(tc,"animMarkerSelected",2),this.d2(tc,"animMarkerUnselected",1)):gd.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.d2=(tc,id,ie)=>{const v=this.DZc(tc);switch(ie){case 0:tc.setAttribute(Nf.a.D8,id);v&&tc.lastChild.setAttribute(Nf.a.D8,id);break;case 1:Sys.UI.DomElement.addCssClass(tc,id);v&&Sys.UI.DomElement.addCssClass(tc.lastChild,
id);break;case 2:Sys.UI.DomElement.removeCssClass(tc,id),v&&Sys.UI.DomElement.removeCssClass(tc.lastChild,id)}};this.DZc=tc=>!!tc&&!!tc.lastChild&&!!tc.lastChild.id&&"overlappedMarker"===tc.lastChild.id;this.setPosition=()=>{};this.JD=tc=>{this.AA=tc;this.AA||(this.ls(),this.aba(!0));this.setVisibility()};this.ZC=()=>null;this.Xw=()=>{};this.TA=()=>[];this.ny=()=>{};this.kC=()=>{};this.ls=()=>{!this.Tk&&this.WO&&(this.gNa(!0),this.gNa(!1))};this.DPc=()=>{const tc=new Ni.a;tc.ah(10,10);tc.xa.setAttribute(Nf.a.D8,
"pointer-events-none");tc.ypa("0 0 2048 2048");const id=new Xk.a;id.dZ("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");id.dF("#E67E22");id.fv("#FFFF00");id.xr(5);tc.appendChild(id);return tc.xa};if(!A)throw Error.argumentNull("shapeNode");if(!W)throw Error.argumentNull("slideReader");if(!oa)throw Error.argumentNull("traverserFactory");
if(!xa)throw Error.argumentNull("paragraphReader");if(!Hb)throw Error.argumentNull("activeSlideViewManager");if(!hc)throw Error.argumentNull("mouseInputManager");if(!Jc)throw Error.argumentNull("clickInputManager");if(!ld)throw Error.argumentNull("focusManagers");if(!Pc)throw Error.argumentNull("effectSelectionManager");if(!Bd)throw Error.argumentNull("pptUnitConversion");this.ta=A;this.lc=W;this.Yl=oa;this.Hh=xa;this.Nz=qb;this.oIe=Ia;this.WO=Hb.Hc?Hb.Hc.DKc:null;this.wHe=Hb.Hc?Hb.Hc.pPb:null;this.$f=
hc;this.Rc=Jc;this.Fa=ld;this.wb=wd;this.o$=de;this.Jxe=oe;this.oi=Bd;this.Zj=Pc}dispose(){this.Tk||(this.o$(),this.Tk=!0,this.Ab=!1,this.NRa(),this.Rc&&this.en&&this.Rc.Bb(sc.a.click,this.en.xa,this.hZc),this.$f&&this.en&&(this.$f.Bb(sc.a.tq,this.en.xa,this.BD),this.$f.Bb(sc.a.Zs,this.en.xa,this.BD),this.$f.Bb(sc.a.bK,this.en.xa,this.JUa),this.$f.Bb(sc.a.mouseDown,this.en.xa,this.JUa)),this.en=null,this.Rc&&this.hn&&this.Rc.Bb(sc.a.click,this.hn.xa,this.hZc),this.$f&&this.hn&&(this.$f.Bb(sc.a.tq,
this.hn.xa,this.BD),this.$f.Bb(sc.a.Zs,this.hn.xa,this.BD),this.$f.Bb(sc.a.bK,this.hn.xa,this.JUa),this.$f.Bb(sc.a.mouseDown,this.hn.xa,this.JUa)),this.Fa=this.Hh=this.ta=this.Yl=this.lc=this.oi=this.Zj=this.yb=this.kh=this.WO=this.ob=this.hn=null)}get visible(){return this.Ab}set visible(A){this.Ab=A}get WA(){return this.yb}get vq(){return this.kh}get ye(){return this.ob}xee(){return this.getClientRects(this.wHe)}getClientRects(A){let W,oa;W=oa=0;if(!A)return gd.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),
{returnValue:!1,left:W,top:oa};A=A.getClientRects();if(!A||!A.length||!A[0])return gd.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:W,top:oa};oa=Math.round(A[0].top);W=Math.round(A[0].left);return{returnValue:!0,left:W,top:oa}}L8d(A){let W,oa;W=oa=0;if(!A||!A.length||!A[0])return gd.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:W,bottom:oa};W=A[0].top;oa=A[0].bottom;for(let xa=1;xa<A.length&&A[xa];xa++)W=
A[xa].top>W?W:A[xa].top,oa=A[xa].bottom<oa?oa:A[xa].bottom;return{returnValue:!0,top:W,bottom:oa}}mXf(A,W,oa,xa){if(!this.L9()||!A||!A.length)return 0;const Ia=xa?this.hn.xa:this.en.xa;oa=(oa=Math.floor(this.oi.vm(oa)/21))?oa:1;let qb=0,Hb=null,hc=null,Jc=!0,ld=!1;for(let de=0;de<A.length;de++){const oe=A[de];var wd=new Bg.a;wd.xa.id=Ye.a.H7a+oe.ClickOrder;wd.ah(20,16);wd.ek(1);if(oe.IsTrigger){var Bd=this.DPc();wd.xa.appendChild(Bd)}else wd.xa.innerText=oe.ClickOrder.toString();let Pc=Bd=!1;de<oa?
(xa&&(wd.xa.style.position=Nf.a.absolute,wd.xa.style.top=Qj.a.Pc(this.oi.vm(W)+21*qb)),ld=this.Zj.xvb(oe.EffectNodeId),wd.xa.setAttribute(Nf.a.D8,ld?"animMarkerSelected":"animMarkerUnselected"),Ia.appendChild(wd.xa),qb++):de===oa?(Jc=Jc&&oe.EffectId===Hb.EffectId,Bd=!0,Pc=Hb.IsTrigger):Jc=Jc&&oe.EffectId===Hb.EffectId;Bd&&hc.xa.appendChild(this.OLc(Pc,Jc,ld));Hb=oe;hc||(hc=wd);xa?(wd=[],(Bd=this.Uxb(hc.xa))&&wd.push(...Bd),wd.push(oe.EffectNodeId),hc.xa.setAttribute("AnimProps",wd.join(" "))):wd.xa.setAttribute("AnimProps",
oe.EffectNodeId)}this.uK();return qb}n5b(A,W,oa,xa){var Ia;if(!this.L9()||!A||!A.length)return 0;const qb=xa?this.hn.xa:this.en.xa;oa=(oa=Math.floor(this.oi.vm(oa)/21))?oa:1;let Hb=0,hc=null,Jc=new Bg.a,ld=!0,wd=!1,Bd=!1;for(let tc=0;tc<A.length;tc++){var de=A[tc],oe=new Bg.a;oe.xa.id=Ye.a.H7a+de.ClickOrder;oe.ah(20,16);oe.ek(1);if(de.IsTrigger){var Pc=this.DPc();oe.xa.appendChild(Pc)}else oe.xa.innerText=de.ClickOrder.toString();tc<oa?(xa&&(oe.xa.style.position=Nf.a.absolute,oe.xa.style.top=Qj.a.Pc(this.oi.vm(W)+
21*Hb)),oe.xa.setAttribute("AnimProps",de.EffectNodeId),wd=this.Zj.xvb(de.EffectNodeId),oe.xa.setAttribute(Nf.a.D8,wd?"animMarkerSelected":"animMarkerUnselected"),qb.appendChild(oe.xa),Hb++):tc===oa&&Jc.xa?(ld=ld&&de.EffectId===hc.EffectId,Bd=!0,Pc=hc.IsTrigger,Bd&&Jc.xa.appendChild(this.OLc(Pc,ld,wd))):ld=ld&&de.EffectId===hc.EffectId;if(Bd){oe=[];(Pc=this.Uxb(Jc.xa))&&oe.push(...Pc);oe.push(de.EffectNodeId);Jc.xa.setAttribute("AnimProps",oe.join(" "));if(Ff.a("FixAnimationMarkerOverlapSelectionIssue"))for(const id of oe){if(wd=
this.Zj.xvb(id))break}else wd=this.Zj.xvb(de.EffectNodeId);Jc.xa.setAttribute(Nf.a.D8,wd?"animMarkerSelected":"animMarkerUnselected");(de=Jc.xa.lastElementChild)&&(null===(Ia=null===de||void 0===de?void 0:de.id)||void 0===Ia?0:Ia.startsWith("overlappedMarker"))&&de.setAttribute(Nf.a.D8,"overlappedMarker "+(wd?"animMarkerSelected":"animMarkerUnselected"))}else Jc=oe,hc=de}this.uK();return Hb}OLc(A,W,oa){const xa=new Bg.a;xa.xa.id="overlappedMarker";Ff.a("FixOverlappedAnimationMarkers")?xa.xa.style.marginTop=
"-13px":xa.xa.style.marginTop=A?"3px":"-13px";xa.xa.setAttribute(Nf.a.D8,"overlappedMarker "+(oa?"animMarkerSelected":"animMarkerUnselected"));W&&this.d2(xa.xa,"SameEffectOverlapped",1);return xa.xa}Dce(A){let W,oa;W=oa=0;if(!this.ta)return{returnValue:!1,x:W,y:oa};var xa=Object(z.a)(117,this.ta.qc(this.Nz));if(!xa)return{returnValue:!1,x:W,y:oa};xa=xa.Bs();if(!xa)return{returnValue:!1,x:W,y:oa};W=A?xa.kc-(this.Dic?61:35):xa.kc-20-15;oa=xa.mc;return{returnValue:!0,x:W,y:oa}}}ni.dsa=(A,W)=>[new bj.a(A[0]._x-
W,A[0]._y-W),new bj.a(A[1]._x+W,A[1]._y-W),new bj.a(A[2]._x+W,A[2]._y+W),new bj.a(A[3]._x-W,A[3]._y+W)];Object(h.a)(ni,"AnimationMarkerView",null,[770,282,283,108]);class ye{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd,de,oe){this.jad=this.dHb=this.Tk=this.Ab=!1;this.nXa=this.dfc=-1;this.Dic=this.AA=!1;this.va=new ek.a;this.Vic=this.nd=1;this.hn=this.en=this.kh=this.yb=this.ob=null;this.ta=A;this.lc=W;this.Yl=oa;this.Hh=xa;this.Nz=qb;this.oIe=Ia;this.WO=Hb.Hc?Hb.Hc.DKc:null;this.wHe=Hb.Hc?Hb.Hc.pPb:
null;this.$f=hc;this.Rc=Jc;this.Fa=ld;this.wb=wd;this.o$=de;this.Jxe=oe;this.oi=Bd}dispose(){this.Tk||(this.o$(),this.Tk=!0,this.Ab=!1,this.l2b(),this.NRa(),this.$f&&this.en&&(this.$f.Bb(sc.a.tq,this.en.xa,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.Bb(sc.a.Zs,this.en.xa,Object(n.a)(this,this.BD,"onSelectionAreaHover"))),this.en=null,this.$f&&this.hn&&(this.$f.Bb(sc.a.tq,this.hn.xa,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.Bb(sc.a.Zs,this.hn.xa,Object(n.a)(this,this.BD,
"onSelectionAreaHover"))),this.yb=this.kh=this.WO=this.ob=this.hn=null)}get visible(){return this.Ab}set visible(A){this.Ab=A}get WA(){return this.yb}get vq(){return this.kh}get ye(){return this.ob}Bm(A){A&&this.WO?(this.ob=new Bg.a,this.ob.Fr("AnimationMarkerView"),this.WO.appendChild(this.ob.xa),this.yb=new nh.a,this.yb.ek(0),this.ob.appendChild(this.yb.viewport),this.kh=new Xk.a,this.kh.ek(1),this.kh.setVisibility(!1),this.yb.appendChild(this.kh),this.en=new Bg.a,this.en.Fr("ShapeAnimationMarkerContainer"),
this.en.xa.id=this.ta.id.toString(),this.en.ah(20,this.ob.xa.clientHeight),this.en.ek(1),this.ob.appendChild(this.en),this.hn=new Bg.a,this.hn.Fr("TextAnimationMarkerContainer"),this.hn.xa.id=this.ta.id.toString(),this.hn.ah(20,this.ob.xa.clientHeight),this.hn.ek(1),this.ob.appendChild(this.hn),this.$f.ub(sc.a.tq,this.en.xa,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.ub(sc.a.Zs,this.en.xa,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.$f.ub(sc.a.tq,this.hn.xa,Object(n.a)(this,
this.BD,"onSelectionAreaHover")),this.$f.ub(sc.a.Zs,this.hn.xa,Object(n.a)(this,this.BD,"onSelectionAreaHover")),this.setVisibility()):gd.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",A?"m_markerViewParentElement":"parent")}PL(A){let W=!1;A&&A.Bc.id.startsWith(Ye.a.H7a)||A.Bc.id.startsWith("overlappedMarker")?(this.cOe(A),W=!0):(this.l2b(),this.aba(!0));return W}setSelection(A){if(A&&!this.jad||!A)this.aba(A),this.l2b()}setVisibility(){let A=this.Ab&&!this.AA;this.ta&&this.ta.isHiddenShape&&
(A=!1);this.ob&&this.ob.Sd(A);this.en&&this.en.Sd(A);this.hn&&this.hn.Sd(A)}aba(A){if(this.L9()){this.dHb=A;A=[this.en.xa.childNodes,this.hn.xa.childNodes];for(const W of A)for(A=0;W&&A<W.length;A++)this.Xsc(W[A],this.dHb)}}Uxb(A){if(!A||!this.ta)return null;A=A.getAttribute("AnimProps");if(!A||!A.toString()||!A.toString().trim().length)return null;A=A.toString().split(" ");if(!A||4!==A.length)return null;const W=[];for(const oa of A){if(!oa||!oa.trim().length)return null;W.push(Number.parseInvariant(oa.trim()))}return W}L9(){const A=
!!this.ta&&!!this.WO&&!!this.en&&!!this.hn;A||gd.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return A}NRa(){this.Gja(!0);this.Gja(!1)}Gja(A){if(this.$f&&this.Rc&&this.L9()&&(A=A?this.hn.xa:this.en.xa)&&A.childNodes&&0<A.childNodes.length){const W=A.childNodes;for(const oa=0;oa<W.length;)A.removeChild(W[oa])}}eTd(){if(this.L9()){var A=this.Q5f(this.ta);if(A&&A.length){var W=!1,oa=!1,xa=[];for(const Ia of A)Ia.IsTextRangeType?oa=!0:(W=!0,xa.push(Ia));this.Dic=W&&oa;this.gNa(!0);
this.gNa(!1);this.Gja(!1);0<xa.length&&(gd.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.n5b(xa,this.oi.cI(this.ta.Nn.mc,this.nd),this.oi.cI(this.ta.Nn.Zb-this.ta.Nn.mc,this.nd),!1,-1)||gd.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));oa?this.Z6d():this.Gja(!0);if(!oa&&-1!==this.nXa||-1!==this.nXa&&-1===this.nXa&&!W)this.q_d(),this.aba(!0)}else this.NRa()}}Z6d(){const A=new ee.a(2,1,0,Object(n.a)(this,this.ensureTextIsRenderedAndDrawMarkers,
"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.wb.Hb(A)}ensureTextIsRenderedAndDrawMarkers(){this.Tk||(this.Jxe(),this.o5b())}o5b(){this.Gja(!0);if(this.Che(this.ta)){var A=this.oee();if(A&&A.length){var W;if(({top:W}=this.xee()).returnValue){var oa=0;gd.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let Ia=0;Ia<A.length;Ia++){var xa=this.lc.jg(this.ta);if(!xa)return;(xa=xa.uXc(this.ta,Ia))&&0<xa.length&&A[Ia]&&(oa+=this.n5b(xa,A[Ia].top-W,A[Ia].height,!0,
Ia))}oa||gd.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else gd.a.J(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else gd.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}oee(){const A=[];var W=xi.GraphIterator.pb(this.ta);W=this.Yl.O3(W,W.currentNode);for(var oa;W.moveNext();)(oa=W.currentNode)&&this.Hh.fe(oa)&&oa&&(oa=oa.qc(this.Nz))&&oa.htmlElement&&(oa=this.fua(oa.htmlElement))&&oa.height&&A.push(oa);
return A}xee(){return this.getClientRects(this.wHe)}getClientRects(A){let W,oa;W=oa=0;if(!A)return gd.a.J(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:W,top:oa};A=A.getClientRects();if(!A||!A.length||!A[0])return gd.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:W,top:oa};oa=Math.round(A[0].top);W=Math.round(A[0].left);return{returnValue:!0,left:W,top:oa}}fua(A){if(!A)return gd.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),
null;A=A.querySelectorAll(".TextRun");if(!A||!A.length)return null;let W=0,oa=0;let xa,Ia=!1;for(let Hb=0;Hb<A.length&&A[Hb];Hb++){var qb=A[Hb].getClientRects();({top:qb,bottom:xa}=this.L8d(qb)).returnValue&&(Hb?(W=W>qb?qb:W,oa=oa<xa?xa:oa):(W=qb,oa=xa),Ia=!0)}if(Ia)return new Nk(oa-W,W);gd.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}L8d(A){let W,oa;W=oa=0;if(!A||!A.length||!A[0])return gd.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:W,bottom:oa};W=A[0].top;oa=A[0].bottom;for(let xa=1;xa<A.length&&A[xa];xa++)W=A[xa].top>W?W:A[xa].top,oa=A[xa].bottom<oa?oa:A[xa].bottom;return{returnValue:!0,top:W,bottom:oa}}n5b(A,W,oa,xa,Ia){if(!this.L9()||!A||!A.length)return 0;const qb=xa?this.hn.xa:this.en.xa;oa=(oa=Math.floor(this.oi.vm(oa)/21))?oa:1;let Hb=0,hc=null,Jc=new Bg.a,ld=!1,wd=!1;const Bd=Ia===this.nXa&&A.length<this.dfc+1;for(let oe=0;oe<A.length;oe++){const Pc=A[oe],tc=new Bg.a;tc.xa.id=Ye.a.H7a+Pc.BuildId;
tc.ah(20,16);tc.ek(1);if(Pc.IsTrigger){var de=this.DPc();tc.xa.appendChild(de)}else tc.xa.innerText=Pc.BuildId.toString();let id=de=!1;oe<oa?(xa&&(tc.xa.style.position=Nf.a.absolute,tc.xa.style.top=Qj.a.Pc(this.oi.vm(W)+21*Hb)),tc.xa.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",oe,Ia,Pc.BuildId,Pc.EffectId)),wd=this.dHb||Bd&&A.length-1===oe||this.jad&&this.dfc===oe&&this.nXa===Ia,tc.xa.setAttribute(Nf.a.D8,wd?"animMarkerSelected":"animMarkerUnselected"),qb.appendChild(tc.xa),Hb++):oe===
oa&&Jc.xa?(ld=ld&&Pc.EffectId===hc.EffectId,de=!0,id=hc.IsTrigger):ld=ld&&Pc.EffectId===hc.EffectId;de&&Jc.xa.appendChild(this.OLc(id,ld,wd));Jc=tc;hc=Pc}this.uK();return Hb}OLc(A,W,oa){const xa=new Bg.a;xa.xa.id="overlappedMarker";xa.xa.style.marginTop=A?"3px":"-13px";xa.xa.setAttribute(Nf.a.D8,"overlappedMarker "+(oa?"animMarkerSelected":"animMarkerUnselected"));W&&this.d2(xa.xa,"SameEffectOverlapped",1);return xa.xa}uK(){this.oIe(this.ob.xa,!0)}Q5f(A){if(!A)return null;const W=this.lc.jg(A);return W?
W.zUa(A):null}Che(A){A=this.Q5f(A);if(!A||!A.length)return!1;for(const W of A)if(W.IsTextRangeType)return!0;return!1}gNa(A){if(this.L9()){var W=A?this.en.xa:this.hn.xa,oa,xa;W&&({x:oa,y:xa}=this.Dce(A)).returnValue&&(W.style.position=Nf.a.absolute,W.style.left=Qj.a.Pc(oa),W.style.zIndex="20000",A?W.style.top=Qj.a.Pc(xa):this.o5b())}}Dce(A){let W,oa;W=oa=0;if(!this.ta)return{returnValue:!1,x:W,y:oa};var xa=Object(z.a)(117,this.ta.qc(this.Nz));if(!xa)return{returnValue:!1,x:W,y:oa};xa=xa.Bs();if(!xa)return{returnValue:!1,
x:W,y:oa};W=A?xa.kc-(this.Dic?61:35):xa.kc-20-15;oa=xa.mc;return{returnValue:!0,x:W,y:oa}}cOe(A){if(this.va&&A&&this.Fa&&A.Bc){var W=A.Bc.id.startsWith("overlappedMarker")&&A.Bc.offsetParent?A.Bc.offsetParent:A.Bc;this.uol(W);this.DZc(W)&&!this.l6j(W)&&this.q_d();this.aba(!1);this.Xsc(W,!0);this.va.raiseEvent("OnMarkerClick",A);this.Fa.Bd()}}l2b(){this.jad=!1;this.nXa=this.dfc=-1;this.q_d()}uol(A){(A=this.Uxb(A))?(this.jad=!0,this.dfc=A[0],this.nXa=A[1],this.ta.Wya=this.dfc,this.ta.BLa=this.nXa):
gd.a.J(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}q_d(){this.ta&&(this.ta.Wya=-1,this.ta.BLa=-1)}em(){this.yb&&(this.yRb(),this.yb.em())}yRb(){if(this.ta&&this.kh){var A=this.ta.Nn.points;A=ye.dsa(A,this.dzb());this.kh.Mt(A)}}dzb(){let A=Ye.a.zNb;this.ta.Wf||!this.ta.eva&&!this.ta.Ik||(A+=6);return A}Mp(){this.yb&&this.Vic!==this.nd&&this.bkb();return null}wq(){}Ju(){}Kj(A){this.Vic=this.nd;this.nd=A}setZIndex(A){this.yb&&this.yb.lC(A)}draw(){this.bkb()}bkb(){this.ob&&
this.WO&&this.Ab&&!this.AA&&this.eTd();this.setVisibility()}BD(A){if(!this.va||!A)return!1;this.va.raiseEvent("OnSelectionAreaHover",A);A.eventName===sc.a.tq?this.d2(A.Bc,"animMarkerHovered",1):A.eventName===sc.a.Zs&&this.d2(A.Bc,"animMarkerHovered",2);return!0}Xsc(A,W){A&&(W?(this.d2(A,"animMarkerUnselected",2),this.d2(A,"animMarkerSelected",1)):(this.d2(A,"animMarkerSelected",2),this.d2(A,"animMarkerUnselected",1)))}d2(A,W,oa){const xa=this.DZc(A);switch(oa){case 0:A.setAttribute(Nf.a.D8,W);xa&&
A.lastChild.setAttribute(Nf.a.D8,W);break;case 1:Sys.UI.DomElement.addCssClass(A,W);xa&&Sys.UI.DomElement.addCssClass(A.lastChild,W);break;case 2:Sys.UI.DomElement.removeCssClass(A,W),xa&&Sys.UI.DomElement.removeCssClass(A.lastChild,W)}}DZc(A){return!!A&&!!A.lastChild&&!!A.lastChild.id&&"overlappedMarker"===A.lastChild.id}l6j(A){return!!A&&!!A.lastChild&&!!A.lastChild.id&&0<=A.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}JD(A){(this.AA=A)?this.l2b():(this.ls(),this.aba(!0));
this.setVisibility()}ZC(){return null}Xw(){}TA(){return[]}ny(){}kC(){}ls(){!this.Tk&&this.WO&&(this.gNa(!0),this.gNa(!1))}DPc(){const A=new Ni.a;A.ah(10,10);A.xa.setAttribute(Nf.a.D8,"pointer-events-none");A.ypa("0 0 2048 2048");const W=new Xk.a;W.dZ("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");W.dF("#E67E22");W.fv("#FFFF00");
W.xr(5);A.appendChild(W);return A.xa}static dsa(A,W){return[new bj.a(A[0]._x-W,A[0]._y-W),new bj.a(A[1]._x+W,A[1]._y-W),new bj.a(A[2]._x+W,A[2]._y+W),new bj.a(A[3]._x-W,A[3]._y+W)]}}Object(h.a)(ye,"AnimationMarkerViewLegacy",null,[768,282,283,108]);var Dg=d(343),Fj=d(1288),Gj;(function(A){A.None="None";A.ButtonModel="ButtonModel";A.CheckboxModel="CheckboxModel";A.ColorPickerModel="ColorPickerModel";A.ComboBoxModel="ComboBoxModel";A.CompoundButtonModel="CompoundButtonModel";A.ErrorViewModel="ErrorViewModel";
A.GalleryModel="GalleryModel";A.FileMenu="FileMenu";A.FlyoutAnchorModel="FlyoutAnchorModel";A.IconGalleryButtonModel="IconGalleryButtonModel";A.InkButtonModel="InkButtonModel";A.InkFlyoutAnchorModel="InkFlyoutAnchorModel";A.InsertTableModel="InsertTableModel";A.InputBoxModel="InputBoxModel";A.LabelModel="LabelModel";A.PageNumberGalleryButtonModel="PageNumberGalleryButtonModel";A.ListGalleryButtonModel="ListGalleryButtonModel";A.CharacterCodeGalleryButtonModel="CharacterCodeGalleryButtonModel";A.FontStyleGalleryButtonModel=
"FontStyleGalleryButtonModel";A.InkThicknessGalleryButtonModel="InkThicknessGalleryButtonModel";A.TableStyleGalleryButtonModel="TableStyleGalleryButtonModel";A.ChangeColorsGalleryButtonModel="ChangeColorsGalleryButtonModel";A.PeopleWell="PeopleWell";A.PreviewGalleryModel="PreviewGalleryModel";A.SliderModel="SliderModel";A.SpinButtonModel="SpinButtonModel";A.SplitButtonModel="SplitButtonModel";A.TellMe="TellMe";A.ToggleButtonModel="ToggleButtonModel";A.StatefulSplitButtonModel="StatefulSplitButtonModel";
A.DocumentTitleModel="DocumentTitleModel";A.MRUCompoundButtonModel="MRUCompoundButtonModel";A.NewBlankDocumentModel="NewBlankDocumentModel";A.CustomTemplateModel="CustomTemplateModel";A.CoauthorGallery="CoauthorGallery";A.SyncStatus="SyncStatus";A.PersonaButtonModel="PersonaButtonModel";A.FontPickerModel="FontPickerModel";A.MultiActionButtonModel="MultiActionButtonModel"})(Gj||(Gj={}));Object(h.b)("ModelType",Gj);var xj=d(192);class Rj{constructor(A,W,oa,xa,Ia,qb,Hb,hc){this.jHb=this.jM=!1;this.Iy=
[];this.ued=new Set;this.Vhc=!0;if(!A)throw Error.argumentNull("actionManager");if(!W)throw Error.argumentNull("graphTopologyManager");if(!oa)throw Error.argumentNull("slideReader");if(!xa)throw Error.argumentNull("viewEventNotifier");if(!Ia)throw Error.argumentNull("animationMarkerViewManager");if(!qb)throw Error.argumentNull("activeSlideViewManager");if(!Hb)throw Error.argumentNull("selectionManager");if(!hc)throw Error.argumentNull("activeAppFrame");this.ia=A;this.ua=W;this.lc=oa;this.Mdb=Ia;this.$d=
xa;this.ru=this.ua.Ba;this.Kc=qb;this.pa=Hb;this.uhc=Ff.a("FixAnimationRibbonCrashIssue");this.Rb=hc}initialize(){}dispose(){this.ia=this.ued=this.Iy=this.ru=this.lc=this.pa=this.$d=null}DOb(A){this.Vhc=A}oRh(){if(!this.uhc||this.ru){var A=this.pa.Ud();this.LRa();var W=this.ru.yj(),oa=new Set;if(this.uhc){if(!W)return;if(A)for(const xa of A)oa.add(xa.id)}else for(const xa of A)oa.add(xa.id);for(const xa of W)oa.has(xa.id)?this.TTd(xa):this.WWe(xa)}}RUl(A){this.xya(this.jM);Ff.a("FixAnimationSelectionCachingIssue")?
this.WUl(A):this.qRh();Ff.a("OptimizeAnimationRibbonControlsRefresh")?this.UVe():this.$d.Uy(new xj.a(7))}MCj(A,W){if(W&&A&&A.length){var oa=this.xvb(A[0]);this.Vhc=!1;oa?(W=this.Iy.filter(xa=>!A.includes(xa.EffectNodeId)),this.LRa(),this.eka(),this.RTd(W)):(W=this.lc.R5f(A,W),this.sTd(W),W=Object.assign([],this.Iy),this.LRa(),this.eka(),this.RTd(W));this.Vhc=!0;this.ia.Ja(bd.a.hzd,Fj.a.execute,null)}}eka(){const A=this.pa.Ud();this.pa.eka(A)}QTd(A,W){W&&A&&(this.LRa(),A=this.lc.R5f(A,W),this.RTd(A),
Ff.a("FixRedundantSelectionChange")?this.Vhc&&this.ia.Ja(bd.a.hzd,Fj.a.execute,null):this.ia.Ja(bd.a.hzd,Fj.a.execute,null))}xvb(A){return this.ued.has(A)}SUl(A){if(this.jM=!!A&&0<=A.indexOf("Animation"))this.jHb=!0;this.xya(this.jM);this.jM?(this.oRh(),Ff.a("OptimizeAnimationRibbonControlsRefresh")?this.UVe():this.$d.Uy(new xj.a(7))):this.LRa()}TUl(A){this.ru=A;this.LRa();this.xya(this.jM)}WUl(A){if(!this.uhc||this.ru)if(A)this.qRh();else if((A=this.pa.Ud())&&A.length){var W=this.ru.yj();if(W&&W.length){this.LRa();
var oa=new Set;for(const xa of A)oa.add(xa.id);for(const xa of W)oa.has(xa.id)?this.TTd(xa):this.WWe(xa)}}}qRh(){if(!this.uhc||this.ru){var A=this.pa.Ud();this.LRa();var W=this.ru.yj();if(W&&W.length)if(A&&A.length){var oa=new Set;for(const xa of A)oa.add(xa.id);for(const xa of W)oa.has(xa.id)?this.TTd(xa):this.WWe(xa)}else A=this.ru.WUc(W),A.length&&(A=A.filter(xa=>xa.IsModifiedPreviously).map(xa=>xa.EffectNodeId),this.QTd(A,this.ru))}}RTd(A){if(A&&this.ru){this.sTd(A);if(Ff.a("RefreshMarkersInsteadOfComputeEffectSelection"))this.xya(this.jM);
else{var W=this.ru.yj();if(!W||!W.length)return;A=new Map;for(var oa of this.Iy){var xa=zf.a.Kf(oa.ShapeId);if(!xa){gd.a.J(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");return}xa=xa.toString();A.has(xa)||A.set(xa,new Set);xa=A.get(xa);null===xa||void 0===xa?void 0:xa.add(oa.EffectNodeId)}for(const Ia of W)if(oa=this.Mdb.dJ(Ia))oa.aba(!1),W=Ia.id.toString(),(W=A.has(W)?A.get(W):null)&&W.size&&oa.jll(Array.from(W))}Ff.a("OptimizeAnimationRibbonControlsRefresh")?
this.UVe():this.$d.Uy(new xj.a(7))}}UVe(){const A={};A.SetAnimationDuration=Gj.SpinButtonModel;A.SetAnimationDurationMLR=Gj.SpinButtonModel;A.SetAnimationDelay=Gj.SpinButtonModel;A.SetAnimationDelayMLR=Gj.SpinButtonModel;A.AnimationStart=Gj.ComboBoxModel;A.AnimationStartMLR=Gj.ComboBoxModel;A.MoveEarlier=Gj.ButtonModel;A.MoveLater=Gj.ButtonModel;A.AnimationEffectOptions=Gj.FlyoutAnchorModel;A.AnimationEffectOptionsMLR=Gj.FlyoutAnchorModel;A.Animations=Gj.PreviewGalleryModel;A.AnimationGallery=Gj.GalleryModel;
this.Rb.pF(A)}TTd(A){if(A){var W=this.lc.jg(A);W&&(W=W.xyb(A),this.sTd(W),A=this.Mdb.dJ(A),this.uhc&&!A||A.aba(!0))}}WWe(A){A&&(A=this.Mdb.dJ(A))&&A.aba(!1)}sTd(A){if(A&&A.length)for(const W of A)this.xvb(W.EffectNodeId)||(this.Iy.push(W),this.ued.add(W.EffectNodeId))}xya(A){if(this.jHb&&this.ru&&this.ru.vO&&this.Kc.Hc&&this.Kc.Hc.DKc){var W=this.ru.yj();if(W&&W.length)for(const oa of W)if(W=this.Mdb.dJ(oa))W.visible=A,W.bkb()}}LRa(){this.ued.clear();this.Iy.length=0}}Object(h.a)(Rj,"EffectSelectionManager",
null,[746,108]);class Bl{constructor(){this.K=null;this.REb=!1}get name(){return"PowerPointWebEditor.Animations"}Xb(A){this.K=A;(this.REb=this.K.resolve("PowerPointWebEditor.IApplicationContext").rd.ntb)?(this.K.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").na().oa(()=>new Dg.a((W,oa)=>{let xa=null;const Ia=Object(z.a)(117,W.qc(this.K.resolve("Box4.IPageView").Na));Ia&&!Ia.Ml&&Ia.xa&&(xa=new ni(W,this.K.resolve("PowerPointWebEditor.ISlideReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),Object(n.a)(Ia,Ia.uK,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),L.AFrameworkApplication.De,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),oa,()=>{Ia.iEa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),
xa.Bm(Ia.xa),xa.setZIndex(4),xa.visible=!1,Ia.uK(xa.ye.xa,!0),Ia.$ra(xa,4));return xa})),this.K.register(Rj,"PowerPointWebEditor.Animations.IEffectSelectionManager").na().oa(()=>new Rj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IAppFrame")))):(this.K.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").na().oa(()=>new Dg.a((W,oa)=>{let xa=null;const Ia=Object(z.a)(117,W.qc(this.K.resolve("Box4.IPageView").Na));Ia&&!Ia.Ml&&Ia.xa&&(xa=new ye(W,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
this.K.resolve("Box4.IParagraphReader"),Object(n.a)(Ia,Ia.uK,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),L.AFrameworkApplication.De,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),oa,()=>{Ia.iEa()}),xa.Bm(Ia.xa),xa.setZIndex(4),xa.visible=!1,Ia.uK(xa.ye.xa,!0),Ia.$ra(xa,4));
return xa})),this.K.register(nk,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").na().oa(()=>new nk(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").zd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.REb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.REb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){Za.a.instance.Ac(yd.a(new Bl,0))}}Object(h.a)(Bl,
"PPTWebEditorAnimationsPackage",null,[2,3]);var Cl=d(1076),Th=d(125);class hi{constructor(A,W,oa,xa){this.ia=A;this.Fa=W;this.CAe=oa;this.ic=xa}vb(){this.ia.ya(bd.a.find,Nc.a.view,Object(n.a)(this,this.findText,"findText"));this.ia.ya(bd.a.find,Nc.a.notes,Object(n.a)(this,this.findText,"findText"));this.ia.ya(bd.a.find,Nc.a.Mf,Object(n.a)(this,this.findText,"findText"));this.ia.ya(ra.a.findInDocument,Nc.a.view,Object(n.a)(this,this.findInDocument,"findInDocument"));this.ia.ie(bd.a.find,0);this.ia.ya(bd.a.S1,
Nc.a.view,Object(n.a)(this,this.S1,"replaceText"));this.ia.ya(bd.a.S1,Nc.a.notes,Object(n.a)(this,this.S1,"replaceText"));this.ia.ya(bd.a.S1,Nc.a.Mf,Object(n.a)(this,this.S1,"replaceText"));this.ia.ie(bd.a.S1,4)}me(){const A=[this.Fa.Ic(Th.a.fE),this.Fa.Ic(Th.a.D3),this.Fa.Ic(Jf.a.qg),this.Fa.Ic(Jf.a.DQ)];for(const W of A)W.bindAction(Qb.KeyInputManager.Va(ud.a.CNa,Qb.KeyInputManager.Te),bd.a.find),W.bindAction(Qb.KeyInputManager.Va(ud.a.dob,Qb.KeyInputManager.Te),bd.a.S1)}findText(A,W,oa){return W.contextId!==
Nc.a.view&&W.contextId!==Nc.a.notes&&W.contextId!==Nc.a.Mf?2:1===oa?this.ic.rj()?32:8:2===oa?(this.CAe.oHh(W),gd.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}S1(A,W,oa){return W.contextId!==Nc.a.view&&W.contextId!==Nc.a.notes&&W.contextId!==Nc.a.Mf?2:1===oa?this.ic.rj()?32:8:2===oa?(this.CAe.LFl(W),gd.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(A,W,oa,xa,Ia){if(W.contextId!==Nc.a.view&&W.contextId!==Nc.a.notes&&W.contextId!==Nc.a.Mf)return 2;if(1===
oa)return 32;if(2===oa){if(!Ia)return 8;A=Ia.CommandValueId||"";gd.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",A.length);this.CAe.tFl(W,A);gd.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(h.a)(hi,"FindReplaceTextActor",null,[268]);var Yk=d(1291);class cj extends Yk.a{constructor(A,W,oa){super(!1,!0);this.cye=!1;this.ped=null;this.NFb=!1;this.OEg=this.ZFg=null;this.BAe=!0;this.MAe=this.NAe=this.LAe=!1;this.wna=null;this.Idd=!1;this.wGe=
!0;this.K0g=this.UCe=!1;this.kZg=this.mZg=null;this.ROg=0;this.Fa=A;this.m$=W;this.Hvk="FindReplaceTextDialog";this.pR=ResourceStrings.l_FindTextTitle;oa&&(this.pR=ResourceStrings.l_ReplaceTextTitle);this.YCe=oa;this.ZV=!1}Rga(){this.sj(this.pR,this.m$,this.f9());this.cye=!1}dispose(){super.dispose();this.cye=!0}OXi(){this.LAe=this.BAe=!1;this.l7(this.pR,this.m$,this.f9())}tYf(A){A&&(this.Fa.wf(od.AFrame.f6),this.LAe=!0);this.BAe=!0;this.l7(this.pR,this.m$,this.f9())}x$b(){this.hide()}Hol(A){this.ped=
A.searchString;this.NFb=A.matchCase;this.wna=A.replaceString}Ml(){return this.cye}C1a(A,W){this.OEg=A;this.ROg=W;this.K0g=0===W;this.l7(this.pR,this.m$,this.f9())}ttd(A){this.ZFg=A;this.l7(this.pR,this.m$,this.f9())}Ntd(A){this.mZg=A;this.l7(this.pR,this.m$,this.f9())}p1e(A){this.kZg=A;this.l7(this.pR,this.m$,this.f9())}get g1a(){return this.ped}set g1a(A){this.ped=A}get matchCase(){return this.NFb}set matchCase(A){this.NFb=A}get VXe(){return this.wna}set VXe(A){this.wna=A}Q0i(A){A&&(this.Fa.wf(od.AFrame.f6),
this.NAe=!0);this.Idd=!0;this.l7(this.pR,this.m$,this.f9())}S4d(){this.NAe=this.Idd=!1;this.l7(this.pR,this.m$,this.f9())}P0i(A){A&&(this.Fa.wf(od.AFrame.f6),this.MAe=!0);this.wGe=!0;this.l7(this.pR,this.m$,this.f9())}QXi(){this.MAe=this.wGe=!1;this.l7(this.pR,this.m$,this.f9())}OHl(){this.pR=ResourceStrings.l_ReplaceTextTitle;this.YCe=!0;this.Idd=!1;this.l7(this.pR,this.m$,this.f9());this.Fa.wf(od.AFrame.f6)}O0i(){this.UCe=!0;this.l7(this.pR,this.m$,this.f9())}xej(){return{["searchString"]:this.ped,
["findNextButtonAriaLabel"]:this.ZFg,["errorMessage"]:this.OEg,["findNextButtonIsEnabled"]:this.BAe,["focusFindNextButton"]:this.LAe,["focusDialog"]:Object(n.a)(this,this.s$i,"focusDialog"),["isReplaceActive"]:this.YCe,["replaceButtonIsEnabled"]:this.Idd,["replaceAllButtonIsEnabled"]:this.wGe,["showMessageAsError"]:this.K0g,["messageStatus"]:this.ROg,["focusReplaceButton"]:this.NAe,["focusReplaceAllButton"]:this.MAe,["replaceButtonAriaLabel"]:this.mZg,["replaceAllButtonAriaLabel"]:this.kZg,["readOnlyModeEnabled"]:this.UCe}}f9(){return{["id"]:this.Hvk,
["bodyControls"]:this.xej(),["isModal"]:!1}}s$i(){this.Fa.wf(od.AFrame.f6)}}Object(h.a)(cj,"ReactFindReplaceTextDialog",Yk.a,[808]);class Am{constructor(A){this.Fa=A}getInstance(A,W){return new cj(this.Fa.value,A,W)}}Object(h.a)(Am,"FindReplaceTextDialogFactory",null,[699]);class Pl{constructor(){this.b7=this.iha=this.paragraphIndex=this.mS=this.slideIndex=0}reset(){this.slideIndex=this.mS=this.paragraphIndex=0;this.iha=this.b7=-1}clone(){const A=new Pl;A.slideIndex=this.slideIndex;A.mS=this.mS;A.paragraphIndex=
this.paragraphIndex;A.iha=this.iha;A.b7=this.b7;return A}}Object(h.a)(Pl,"TextPosition",null,[]);class Dl{constructor(){this.EDe=this.U7c=null;this.AP=new Pl;this.Dm=new Pl;this.state=this.Gpa=0;this.Cub=this.p7d=!1;this.pattern=this.i4b=this.k4b=null;this.matchCase=!1;this.reset()}reset(){this.Gpa=0;this.AP.reset();this.Dm.reset();this.state=0;this.Cub=this.p7d=!1;this.EDe=this.pSa=this.i4b=this.k4b=null}get pSa(){return this.U7c}set pSa(A){if(this.U7c=A)this.EDe=this.U7c}get xak(){return this.EDe}}
Object(h.a)(Dl,"FindContext",null,[]);var ii=d(53),oh=d(95);class ok{constructor(){this.ShouldMatchCase=!1}}Object(h.a)(ok,"MatchTextInfo",null,[]);class ya{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(h.a)(ya,"ReplaceAllTextInfo",null,[]);var qd=d(986),ea=d(166),Ok=d(1001),kj=d(332);class Ek{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd,de,oe,Pc,tc,id,ie,v,Z,ua,Ra,fb){this.CIa=this.Lm=this.BE=null;this.Cd=new Dl;this.wna=this.nG="";
this.tic=!1;this.QGb=this.cgb=0;this.PGb=Date.now();this.Hdd=-1;this.AAe=0;this.idd=-1;this.ia=A;this.wgc=W;this.Fa=oa;this.Vq=xa;this.ic=Ia;this.Ga=qb;this.om=Hb;this.swa=hc;this.Eb=Jc;this.wb=ld;this.Ub=wd;this.ua=Bd;this.Tb=de;this.Fb=tc;this.$d=oe;this.Pq=Pc;this.GJ=id;this.ZIa=ie;this.lOg=v;this.Dgb=Z;this.isk=ua;this.CH=fb;this.lZg=Ra}oHh(A){this.BE=A;this.Lm=this.lOg.value.getInstance(Object(n.a)(this,this.p2f,"findReplaceTextDialogResultHandler"),!1);this.nG&&(this.Lm.g1a=this.nG,this.idd=
-1);this.Lm.Rga();3!=this.ia.mode&&this.Lm.O0i();this.jWa()&&this.P4d()}tFl(A,W){this.jWa()||(this.nG=W);this.oHh(A);this.jWa()||(this.Lm.g1a=this.nG,this.Lm.Rga(),this.e9e(W,!1))}LFl(A){this.BE=A;this.Lm=this.lOg.value.getInstance(Object(n.a)(this,this.p2f,"findReplaceTextDialogResultHandler"),!0);this.nG&&(this.Lm.g1a=this.nG);this.Lm.Rga();this.jWa()&&this.P4d()}p2f(A,W){if(W)switch(this.Lm.Hol(W),A){case 1:this.JFk();break;case 2:this.KFk();break;case 3:this.LFk(this.Lm.VXe);break;default:this.Nzl(),
this.clearSelection(),this.Cd.reset(),this.Lm.x$b()}else gd.a.J(512496416,820,10,"Got null control value for findreplace dialog")}rig(){return this.Cd.k4b&&this.aTd!==this.Cd.k4b.qe}e9e(A,W){this.KVf();if(0===this.Cd.state||3===this.Cd.state||A!==this.nG||W!==this.tic||this.rig())this.kQj(A,W),this.idd=-1;this.Cd.Cub=!1;this.Gjd()}get aTd(){return this.ua.Ba?this.ua.Ba.qe:0}kQj(A,W){const oa=A===this.nG&&3===this.Cd.state&&!this.rig(),xa=this.Cd.AP.clone();this.Cd.reset();this.nG=A;this.tic=W;oa?
this.Cd.AP=xa.clone():(this.Cd.AP.slideIndex=this.aTd,this.Nkj());this.Cd.Dm=this.Cd.AP.clone()}Gjd(){this.I8i(this.nG,this.tic)?4!==this.Cd.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.M5b())}I8i(A,W){var oa=this.ua.presentation;if(!oa)throw Error.argumentNull("Presentation is null");if(oa=oa.slides||[],oa.length){this.Cd.Gpa=oa.length;const xa=oa.length+this.Cd.AP.slideIndex;for(;this.Cd.Dm.slideIndex<=xa;){const Ia=this.Cd.Dm.slideIndex%oa.length,qb=this.K8i(oa[Ia],
A,W,this.Cd.Dm.slideIndex===xa?this.Cd.AP.mS:Ek.VJe);if(qb&&(this.Cd.k4b=this.ic.Qk(qb.Cb)))return!0;if(7===this.Cd.state)return this.Cd.Cub&&(gd.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.Cd.state=0),this.ySk(oa[Ia]?oa[Ia].Cb:null,A,W);if(3===this.Cd.state)break;let Hb;(Hb=this.Cd.Dm).slideIndex=Hb.slideIndex+1;this.Cd.Dm.mS=0}}else this.Cd.state=1;return!1}K8i(A,W,oa,xa){if(!A)return null;var Ia=this.ic.Qk(A.Cb),qb=this.Tb.Lc(Ia);Ia=Ia.AUa()||[];(qb=qb.Db(27))&&Ia.push(qb);
if(!Ia.length)return this.Cd.state=7,null;for(;this.Cd.Dm.mS<=Math.min(Ia.length-1,xa);){if(this.Cd.i4b=this.J8i(Ia[this.Cd.Dm.mS],W,oa,this.Cd.Dm.mS===xa?this.Cd.AP.paragraphIndex:Ek.VJe))return A;let Hb;(Hb=this.Cd.Dm).mS=Hb.mS+1;this.Cd.Dm.paragraphIndex=0}return null}J8i(A,W,oa,xa){if(!this.om.hGa(A)&&A.mA)return null;const Ia=oh.a.createInstance(A);let qb=0;for(;Ia.moveNext()&&this.Cd.Dm.paragraphIndex<=xa;){const Hb=Ia.currentNode;if(fg.ParagraphReader.fe(Hb)&&qb++===this.Cd.Dm.paragraphIndex){if(this.Cd.pSa=
this.G8i(Hb,W,oa,this.Cd.Dm.paragraphIndex===xa?this.Cd.AP.iha:Ek.VJe))return A;let hc;(hc=this.Cd.Dm).paragraphIndex=hc.paragraphIndex+1;this.Cd.Dm.iha=this.Cd.Dm.b7=-1}}return null}G8i(A,W,oa,xa){if(!fg.ParagraphReader.fe(A))return null;let Ia=A.ryb();if(!Ia.length)return null;Ia=Ia.substring(0,Math.min(Ia.length,xa));return this.L8i(Ia,Math.max(0,this.Cd.Dm.b7),W,oa)?A:null}L8i(A,W,oa,xa){let Ia=A,qb=oa;xa||(Ia=A.toLowerCase(),qb=oa.toLowerCase());A=Ia.indexOf(qb,-1===W?0:W);if(-1!==A)return this.Cd.Dm.iha=
A,this.Cd.Dm.b7=A+qb.length,this.Cd.state=2,this.Cd.p7d=!0;this.Cd.state=1;return!1}Nkj(){var A=ea.b(this.BE);A=A?A.Nb:null;if(!A||!A.Pa)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(A.Pa.nb){var W=A.Pa.nb.Ua;if(fg.ParagraphReader.fe(W.node)){A=Object(z.a)(5,W.node);this.Cd.AP.iha=W.Ra;this.Cd.AP.b7=W.Ra;const oa=this.Ga.Xda(W.node);oa?(this.Cd.AP.mS=oa.get_zIndex()-1,this.Cd.AP.paragraphIndex=this.gbg(A)):this.om.Qyb(W.node)&&(W=this.ua.Ba?this.ua.Ba.AUa():null,this.Cd.AP.mS=
W?W.length:0,this.Cd.AP.paragraphIndex=this.gbg(A))}else this.Ga.wGa(W.node)&&(this.Cd.AP.mS=W.node.get_zIndex()-1)}}gbg(A){A=this.Tb.Lc(A);if(!A.h7(oa=>10===oa.type||60===oa.type||16===oa.type))return 0;A.Cc();const W=A.Dq;A.Cc();return Math.max(0,A.TTa(W))}L7g(){const A=this.ua.presentation;if(!A)throw Error.argumentNull("Presentation is null");return this.Cd.AP.slideIndex||this.Cd.AP.mS?this.Cd.Dm.slideIndex<(A.slides||[]).length:!1}Yfg(){const A=this.ua.presentation;if(!A)throw Error.argumentNull("Presentation is null");
this.Cd.Dm.slideIndex=A.slides?A.slides.length:0;this.Cd.Cub=!1;this.Gjd()}N1c(){return this.Lm.Ml()}eFk(A){if(!this.N1c()){gd.a.J(512496409,820,50,"OnBackendFindSucceeded");var W=Yd.a.empty;({slideId:W}=Yd.a.hNh(A));(A=this.ic.Yka(W))?(W=A.slideIndex,W>this.Cd.AP.slideIndex&&W<this.Cd.Dm.slideIndex?this.M5b():this.Ub.Ba!==A?(this.Vq.eT(Object(n.a)(this,this.aJb,"onActiveSlideDomChanged")),this.Ub.Ba=A):(this.Cd.state=5,this.Cd.Cub=!0,this.Cd.Dm.slideIndex=this.Cd.Dm.slideIndex>W?W+this.Cd.Gpa:W,
this.Cd.Dm.mS=0,this.Cd.Dm.paragraphIndex=0,this.Cd.Dm.iha=-1,this.Cd.Dm.b7=-1,this.Gjd())):this.L7g()?this.Yfg():this.M5b()}}aJb(){gd.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.Vq.Voa(Object(n.a)(this,this.aJb,"onActiveSlideDomChanged"));this.N1c()||this.CIa||(this.CIa=new ee.a(3,1,0,Object(n.a)(this,this.sOe,"onPostActiveSlideDomChangedTask"),90,"30"),this.wb.Hb(this.CIa))}sOe(){gd.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.CIa=null;if(!this.N1c())if(4===this.Cd.state){const A=
this.aTd;this.Cd.Dm.slideIndex=this.Cd.Dm.slideIndex>A?A+this.Cd.Gpa:A;this.Cd.state=5;this.Cd.Cub=!0;this.Gjd()}else 2===this.Cd.state?this.setSelection():this.M5b()}dFk(){this.N1c()||(gd.a.J(512496406,820,50,"OnBackendFindFailed"),this.L7g()?this.Yfg():this.M5b())}ySk(A,W,oa){gd.a.J(512496405,820,50,"PerformBackendFind");this.wgc.findText(W,oa,A.toString(),Object(n.a)(this,this.eFk,"onBackendFindSucceeded"),Object(n.a)(this,this.dFk,"onBackendFindFailed"));this.Cd.state=4;return!0}M5b(){this.Cd.state=
this.Cd.p7d?3:1;gd.a.J(512496404,820,50,"End of Find: {0}",this.Cd.state);this.clearSelection();this.C1a(0,"")}getShapeType(A){return A.Gw?ResourceStrings.L_TextBox:A.qr?ResourceStrings.l_Chart:A.xd?ResourceStrings.L_Table:A.Wf?ResourceStrings.L_SmartArt:A.Pp?ResourceStrings.L_Media:A.tj?ResourceStrings.l_Picture:A.Ik?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var A=this.Cd.pSa,W=this.Cd.k4b;if(this.Ub.Ba!==W)this.Vq.eT(Object(n.a)(this,this.aJb,"onActiveSlideDomChanged")),
this.Ub.Ba=W;else{A=ii.SelectionFactory.R3(A,this.Cd.Dm.iha,this.Cd.Dm.b7);if(this.om.hGa(this.Cd.i4b))this.ia.Ja(bd.a.gMa,2,new qd.a(!0)),this.Fa.wf(Th.a.D3),this.swa.setSelection(A),this.C1a(this.Cd.Dm.slideIndex%this.ic.rj()+1,ResourceStrings.l_NotesPaneType);else{W=this.Cd.i4b;const oa=this.Cd.i4b.rg(this.Eb.Na);if(oa)if(oa.iq){let xa;(xa=this.Cd.Dm).mS=xa.mS+1;this.Cd.Dm.paragraphIndex=0;this.Cd.Dm.iha=0;this.Cd.Dm.b7=0;oa.yvd()}else this.isk&&W.Wf?(this.$d.pnh(new kj.a(W)),this.ZIa.setSelection(A)):
(this.Fa.wf(Jf.a.qg),this.Eb.setSelection(A));this.C1a(this.Cd.Dm.slideIndex%this.ic.rj()+1,this.getShapeType(W))}gd.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.Cd.Dm.slideIndex,this.Cd.Dm.mS,this.Cd.Dm.paragraphIndex,this.Cd.Dm.iha,this.Cd.Dm.b7);this.o6d()}}clearSelection(){var A=ea.b(this.BE);if(A=A?A.Nb:null){var W=this.Cd.xak;W&&(W=ii.SelectionFactory.Qg(W,0),A.setSelection(W))}else gd.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}C1a(A,
W){const oa=new Sys.StringBuilder,xa=new Sys.StringBuilder;let Ia=!1;A!=this.idd?(this.idd=A,this.AAe=1):this.AAe++;switch(this.Cd.state){case 1:Ia=!0;oa.append(ResourceStrings.l_FindTextNotFound);break;case 3:oa.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ia=!0;oa.append(ResourceStrings.l_FindTextFindAgain);break;case 2:xa.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.AAe,A,W));break;default:gd.a.J(512496400,820,50,"Find Text: {0}",this.Cd.state)}this.Uql(oa.toString(),
Ia,xa.toString());this.o6d()}sNl(A){A=this.Ydl(A);32===A&&this.e9e(this.nG,this.tic);16===A&&(this.Lm.C1a(ResourceStrings.l_ReplaceTextErrorMessage,0),this.Lm.S4d(),this.Lm.tYf(!0))}Ydl(A){return Wf.a.v7d("SingleReplaceAction",bd.a.S1,()=>{A||(A="",gd.a.J(512496399,820,50,"Replacing with empty string"));var W=this.Cd.pSa;if(!W)return gd.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var oa=this.Cd.Dm.iha;const xa=this.Cd.Dm.b7;if(-1===oa||-1===xa)return gd.a.J(512496397,820,10,"Invalid start or end position of current text selection."),
16;const Ia=this.Pq.ke(15);Ia.ld(W);this.GJ.replaceTextRange(cg.a.createTextRange(W,oa,xa),A,!0,!1,bd.a.S1);W=oa+A.length;oa=W!==this.Cd.Dm.b7;this.Cd.Dm.b7=W;Ia.dispose();oa&&this.setSelection();return 32})}o6d(){this.Lm.tYf(1===this.cgb);this.yYf();this.Lm.P0i(3===this.cgb)}yYf(){this.Cd.pSa?this.Lm.Q0i(2===this.cgb):this.Lm.S4d()}KVf(){this.Lm.OXi();this.Lm.S4d();this.Lm.QXi()}Uql(A,W,oa){2===this.cgb?(this.Lm.Ntd(ResourceStrings.l_ReplaceTextReplaced+". "+oa),this.Lm.ttd("")):(this.Lm.ttd(oa),
this.Lm.Ntd(""));this.Lm.p1e("");this.Lm.C1a(A,W?0:1)}M3i(A,W){const oa=Wf.a.Jj("FindNext");oa.Wa("CommandId",A.toString());oa.Wa("IsReadOnlyModeEnabled",this.Lm.UCe.toString());try{W()}finally{oa.finish(!0)}}JFk(){ub.a.Xa(this.Lm.g1a)||this.M3i(bd.a.find,()=>{gd.a.J(512496396,820,50,"Find Text Started");this.cgb=1;this.e9e(this.Lm.g1a,this.Lm.matchCase);return 32})}KFk(){this.Lm.YCe?(gd.a.J(512496394,820,50,"Replace Text Started"),this.cgb=2,this.sNl(this.Lm.VXe)):(this.Lm.OHl(),gd.a.J(512496395,
820,50,"Find dialog switched to replace dialog"),this.yYf())}LFk(A){this.jWa()?gd.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.QGb,Date.now()-this.QGb):ub.a.Xa(this.Lm.g1a)||(Ff.a("FixReplaceAllTimeOutError")&&(this.ua.presentation.Dga=-16),this.nG=this.Lm.g1a,this.wna=A?A:"",this.QGb=Date.now(),this.cgb=3,this.P4d(),this.G7i(this.ua.Ba,this.nG,this.wna,this.tic),0<this.lZg&&(this.Hdd=window.setTimeout(()=>{this.$ch()},this.lZg)),16===this.replaceAll()&&
(this.PGb=Date.now(),this.zMf(),this.$ch()))}replaceAll(){return Wf.a.v7d("ReplaceAllAction",bd.a.S1,()=>{gd.a.J(512496392,820,50,"ReplaceAll Text Started");const A=this.ua.presentation;if(A){const W=this.Fb.yd(15);try{W.jc(A),this.Dgb.gk(Object(n.a)(this,this.Cib,"onPresentationPropertyChange")),A.AMb=Object.assign(new ya,{NewStr:this.wna,OldStr:this.nG,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,MatchTxtInfo:Object.assign(new ok,{ShouldMatchCase:this.Lm.matchCase})})}finally{W&&
W.dispose()}return 32}return 16})}G7i(A,W,oa,xa){if(A){A=this.ic.Qk(A.Cb);var Ia=this.Tb.Lc(A);A=A.AUa()||[];(Ia=Ia.Db(27))&&A.push(Ia);if(A.length)for(Ia=0;Ia<=A.length-1;)this.P8i(A[Ia],W,oa,xa),Ia++}else gd.a.J(512496391,820,50,"slide must not be null.")}P8i(A,W,oa,xa){if(this.om.hGa(A)||!A.mA)for(A=oh.a.createInstance(A);A.moveNext();){const Ia=A.currentNode;if(!fg.ParagraphReader.fe(Ia))continue;let qb=null;(qb=this.H8i(Ia,W,xa))&&qb.characterData.replace(W,oa)}}H8i(A,W,oa){if(!fg.ParagraphReader.fe(A))return gd.a.J(512496390,
820,50,"node must be ParagraphNode"),null;const xa=A.ryb();return xa.length?this.M8i(xa,W,oa)?A:null:null}M8i(A,W,oa){let xa=A,Ia=W;oa||(xa=A.toLowerCase(),Ia=W.toLowerCase());return-1!==xa.indexOf(Ia,0)?!0:!1}Cib(A,W){if(!this.jWa())gd.a.J(512496389,820,50,"ReplaceAll Not Iniitated");else if(W.property===Jh.a.RXe){this.zMf();A=Object(z.a)(347,W.node);if(-1!==A.Dga){var oa=2;if(0===A.Dga){W=ResourceStrings.l_FindTextNotFound;var xa=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;oa=
0;var Ia=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===A.Dga?(W=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,A.Dga,this.nG,this.wna),xa=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,A.Dga,this.nG,this.wna)):(W=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,A.Dga,this.nG,this.wna),xa=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,A.Dga,this.nG,this.wna)),Ia=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Ia=
ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,W=xa=ResourceStrings.l_ReplaceAllErrorMessage,oa=0,gd.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.PGb=Date.now();gd.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.PGb-this.QGb);this.sYf(W,oa);this.Dgb.Qm(Object(n.a)(this,this.Cib,"onPresentationPropertyChange"));this.Lm.Ml()&&this.y3e(Ia,xa,10);A.Dga=-16}}jWa(){return this.QGb>this.PGb}P4d(){var A=String.format(ResourceStrings.l_ReplaceAllInProgress,
this.nG);this.Lm.C1a(A,3);A=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.nG);this.Lm.p1e(A);A=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.nG);this.Lm.Ntd(A);A=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.nG);this.Lm.ttd(A);this.KVf()}sYf(A,W){this.Lm.C1a(A,W);this.Lm.p1e(A);this.Lm.Ntd("");
this.Lm.ttd("");this.o6d()}Nzl(){if(this.jWa()){var A=String.format(ResourceStrings.l_ReplaceAllInProgress,this.nG);this.y3e(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,A,1024)}}y3e(A,W,oa){this.CH?(this.CH.W4d(),gd.a.J(512496385,820,50,"Callout notification called for Replace All operation"),A=Object.assign(new Ok.a,{title:A,message:W,timeoutInSeconds:oa}),A=this.CH.kEh(A),A.QVa&&gd.a.J(512496384,820,10,"Error in callout notification: Error:{0}",A.message)):gd.a.J(512496386,820,
10,"Find Replace Text: m_calloutNotification adapter is null.")}$ch(){let A=!1;this.jWa()&&(A=!0,this.PGb=Date.now());gd.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",A,this.PGb-this.QGb);this.sYf(ResourceStrings.l_ReplaceAllErrorMessage,0);this.Dgb.Qm(Object(n.a)(this,this.Cib,"onPresentationPropertyChange"));this.Lm.Ml()&&this.y3e(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);
this.ua.presentation.Dga=-16}zMf(){-1!==this.Hdd&&(window.clearTimeout(this.Hdd),this.Hdd=-1)}}Ek.VJe=1024;Object(h.a)(Ek,"FindReplaceTextHandler",null,[700]);class Uf{constructor(A){this.GOg=this.A1g=null;this.NFb=!1;this.H5=A}findText(A,W,oa,xa,Ia){this.GOg=A;this.NFb=W;this.A1g=oa;this.H5.SF(xa,Ia,null)}get OFl(){return this.A1g}get matchCase(){return this.NFb}get Ygd(){return this.GOg}}Object(h.a)(Uf,"FindTextManager",null,[698]);var pl=d(397),Zk=d(111);class Sf extends Zk.a{constructor(){super();
this.MatchText=null;this.MatchCase=!1;this.SlideID=null}ul(){return 54}static F0d(A,W,oa){const xa=new Sf;xa.SlideID=oa;xa.MatchText=A;xa.MatchCase=W;return xa}}Object(h.a)(Sf,"FindTextRequest",Zk.a,[]);class bi extends pl.a{constructor(A,W,oa,xa){super();this.vHa=this.fJa=null;this.PO=this.c5=!1;this.yfc=null;this.Vd=oa;this.D6c=!1;this.wgc=W;this.Ya=xa;this.$m=A;this.enabled=2;this.$m.register(this)}SF(A,W){this.D6c=!0;this.fJa=A;this.vHa=W;this.$m.Zaa()}forceOutbound(){}ila(){return this.D6c&&
!this.c5}jO(){return!1}ZUa(){return this.Xd&&2===this.Xd.status?!0:this.ila()}EMb(){if(1===this._state)this.yfc=this.Ya.podSessionId,this.Xd.XH=Sf.F0d(this.wgc.value.Ygd,this.wgc.value.matchCase,this.wgc.value.OFl),this.Xd.status=1,this._state=3;else if(3===this._state&&this.Xd&&2===this.Xd.status){if(2!==this.Xd.statusCode)this.UH();else{if(!this.Xd.es||1!==this.Xd.es.length){this.UH();return}const A=this.Xd.es[0];0===A.StatusCode?(this.C1(),this.fJa&&this.fJa(A.SlideID)):(this.UH(A),124===A.StatusCode&&
this.Vd.Gs(A.ServerError,this.yfc))}this.yfc=null}}UH(A=null){this.D6c=!1;this._state=1;gd.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",A?A.StatusCode:-1,this.Xd?mg.a[this.Xd.statusCode]:"NULL",this.Xd?this.Xd.Iv:-1,this.PO,this.yfc||"NULL");this.PO=!0;this.vHa&&this.vHa(-1,-1)}C1(){this.D6c=!1;this._state=1;gd.a.J(25012056,818,this.PO?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",
this.PO,this.yfc||"NULL");this.PO=!1}dispose(){this.c5||(1===this._state&&this.$m.unregister(this),this.c5=!0)}}Object(h.a)(bi,"FindTextReplicator",pl.a,[108]);class qc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Xb(A){this.K=A;this.K.register(698,"PowerPointWebEditor.IFindTextManager").na().oa(()=>new Uf(new bi(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.ue("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(699,"PowerPointWebEditor.IFindReplaceTextDialogFactory").na().oa(()=>new Am(this.K.ue("PowerPointWebEditor.IFocusManager")));const W=new Cl.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.K.resolve("PowerPointWebEditor.IRibbonPane").xa);this.K.register(700,"PowerPointWebEditor.IFindReplaceTextHandler").na().oa(()=>new Ek(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.ue("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").zd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
this.K.resolve("Common.IAppSettingsManager").uc("ReplaceAllClientTimeoutMS",0),W))}init(){let A=new hi(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.K.resolve("PowerPointWebEditor.IPresentationReader"));A.vb();A.me()}dispose(){}static main(){Za.a.instance.Ac(yd.a(new qc,0))}}Object(h.a)(qc,"PPTWebEditorFindTextPackage",null,[2,3]);class ql{constructor(A){this.Da=A}get CVd(){return"PowerPoint"}get CJf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get iZj(){return this.Da.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get sCb(){return this.Da.powerPointEditorFirstRunExperienceUIIsEnabled}get Oug(){return this.Da.powerPointEditorFirstRunExperienceTestIsEnabled}get R9i(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get n6g(){return 24}get Vuh(){return 4E3}get Asc(){return this.Da.roamingServiceHandlerWebServiceBase||
""}}Object(h.a)(ql,"FirstRunExperienceLauncherSettings",null,[771]);class Kc{constructor(A){this.cGg=A}yAl(A){this.cGg&&this.cGg.E3e(A)}}Object(h.a)(Kc,"FirstRunExperienceManager",null,[697]);class Of{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Xb(A){if(!A)throw Error.argumentNull("container");this.K=A;this.K.register(697,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").na().oa(()=>new Kc(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").$e(()=>
{this.E3e()})}dispose(){}E3e(){var A=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!A)throw Error.argumentNull("appSettings");const W=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");W&&(A=new ql(A),W.yAl(A))}static main(){Za.a.instance.Ac(new Of)}}Object(h.a)(Of,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var nj=d(182),Hj=d(470);class Xf{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(h.a)(Xf,"CatchUpConfiguration",null,[]);class $l{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(h.a)($l,"SharedControllerFactoryParameters",null,[]);const kg=(A,W)=>{if(!A)throw Error.create(String.format("Argument {0} is null.",W));},Rm=A=>{if(!A.navigationId)return gd.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const W=window.atob(A.navigationId);return W&&""!==W?{["NavigationId"]:W}:null}catch(W){return gd.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",W),null}};class oi{constructor(A){kg(A,"ActivityContentManager.IActionManagerExtended");
this.ia=A}doesContentExist(A){if(!A)return gd.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(A.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(A=Rm(A))?32===this.ia.Ja(ra.a.Bwb,2,A):!1;default:return!1}}}Object(h.a)(oi,"ActivityContentManager",null,[693]);class oj{constructor(A){this.un=A}shouldShowEmptyExperienceButton(){return L.AFrameworkApplication.G4c()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.un.Ja(ra.a.Puc,
2,null)}onInviteOthersButtonClick(){this.un.Ja(ra.a.Jda,2,null)}}Object(h.a)(oj,"EmptyCatchUpBehaviorManager",null,[696]);class zi{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(h.a)(zi,"Person",null,[]);var sh=d(661),Ij=d(234),Uh=d(172);class mf extends Zk.a{constructor(A){super();this.StartTime=null;this.StartTime=A}ul(){return 93}}Object(h.a)(mf,"GetFileRevisionHistoryRequest",Zk.a,[]);class Ql{constructor(A,W,oa){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=A;this.UserId=W;this.ProviderId=oa}}Object(h.a)(Ql,"Author",null,[]);const Fk=(A,W)=>A&&W?A.providerIdField===W.ProviderId?A.userIdField===W.UserId:A.userNameField===W.UserName:!1;var dj=d(246);class yj{constructor(A,W,oa){this.J9c=this.Udb=null;this.ei=A;this.ieb=oa;this.ieb.vji(Object(n.a)(this,this.Tah,"onFileRevisionHistoryReady"));W.$e(()=>{this.Udb=new Ql(W.Ha("UserName"),W.Ha("387"),W.Ha("388"))})}dispose(){this.ieb.Dbl(Object(n.a)(this,this.Tah,
"onFileRevisionHistoryReady"));this.Udb=null}ukj(A,W,oa){A&&oa&&(this.J9c=oa,A=new dj.a(new mf(A),xa=>{this.Iyg(xa,W);this.Kkd(xa)},xa=>{this.Iyg(xa,W);return this.Eib(xa)}),this.ei.Hb(A))}Tah(A,W){A=null;const oa=[];ub.a.Xa(W.rTc)||(({rTc:W}=this.cPl(W.rTc)).returnValue?Uh.b(W.fileRevisionEntriesField,xa=>this.C3j(xa.changesDataField),xa=>{oa.push(xa.changesDataField)}):A="ErrorGetFileRevisionHistoryParseJsonException");this.yNe(oa,A)}Kkd(A){let W=null;A.ServerError&&0!==A.ServerError.Code?W=Ij.a[A.ServerError.Code]:
0!==A.StatusCode&&(W=sh.a[A.StatusCode]);W&&this.yNe(null,W)}Eib(A){gd.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+A.toString());this.yNe(null,"ErrorGetFileRevisionHistoryFailed");return!0}yNe(A,W){this.J9c&&(A=this.Ycj(A),this.J9c(A,W),this.J9c=null)}cPl(A){let W;W=null;try{W=Sys.Serialization.JavaScriptSerializer.deserialize(A)}catch(oa){gd.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+oa)}return{returnValue:!!W,rTc:W}}C3j(A){return!Fk(A,this.Udb)}Iyg(A,W){A.Hya&&
W.zm("GetAuthorNamesRequestInvokedTime",A.Hya);W.Wa("GetAuthorNamesRequestCorrelationId",A.Qh)}Ycj(A){if(!A)return[];const W=Array(A.length);for(let xa=0;xa<A.length;xa++){var oa=A[xa];oa=Object.assign(new zi,{displayName:oa.userNameField,id:oa.userIdField,provider:oa.providerIdField});W[xa]=oa}return W}}Object(h.a)(yj,"FileRevisionHistoryService",null,[784,108]);class ma{constructor(A,W){kg(A,"FlyoutFocus.IF6Manager");kg(W,"FlyoutFocus.IFocusManagerHelper");this.Gg=A;this.LB=W}initialize(){this.LB.C4(Jf.a.s8a,
Jf.a.$i,null,Object(n.a)(this,this.t$i,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.Gg.hL(Jf.a.s8a)}disableF6Focus(){this.Gg.Eo(Jf.a.s8a)}t$i(){const A=document.getElementById("flyoutItem0");A&&(gd.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),A.focus())}}Object(h.a)(ma,"FlyoutFocus",null,[783]);class ib{constructor(A,W,oa,xa){this.i7c=null;this.ZAg=this.uHg=this.$Eb=this.U$c=!1;kg(W,"FlyoutRibbonButton.IActionManagerExtended");kg(oa,"FlyoutRibbonButton.IFocusManager");
kg(xa,"FlyoutRibbonButton.FloodgateEventLogger");this.Rb=A;this.ia=W;this.Fa=oa;this.vlk=xa;this.zlk=new Date}initialize(){L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ff.a("DelayRegisterCatchUpActions")||this.vb()}registerButtonClickedEvent(A){this.i7c&&gd.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.i7c=A.buttonClickedCallback}onFlyoutInitialized(){this.U$c&&gd.a.J(571532948,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const A=(new Date).getTime()-this.zlk.getTime();gd.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",A);this.U$c=!0;Gd.c(ra.a.JAi,!0,Gd.e,0,0,A);L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ff.a("DelayRegisterCatchUpActions")&&this.vb();this.Rb&&this.Rb.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(A){this.$Eb!==A.flyoutIsVisible&&
(this.$Eb=A.flyoutIsVisible,this.Rb&&this.Rb.updateCommandUI(!0),this.$Eb&&this.ZAg?this.Fa.wf(Jf.a.s8a):this.$Eb||this.Fa.wf(Jf.a.$i),this.$Eb||this.vlk.uek())}vb(){this.ia.ya(ra.a.y8e,Lb.a.frame,Object(n.a)(this,this.XMk,"onToggleCatchUpFlyout"));this.ia.ra(ra.a.omh,Lb.a.frame,Object(n.a)(this,this.HKk,"onQueryToggleCatchUpFlyout"),96)}XMk(A,W,oa){if(1===oa)return this.U$c?(this.uHg||(this.uHg=!0,gd.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.i7c)return 8;this.ZAg=!0;this.i7c();
return 32}HKk(A,W,oa,xa,Ia){Ia[Ud.a.Visible]=!0;Ia[Ud.a.On]=this.$Eb&&this.U$c;return 32}}Object(h.a)(ib,"FlyoutRibbonButton",null,[775]);const yb=A=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+A)};class ac{constructor(A,W,oa,xa,Ia,qb){kg(A,"PowerPointActivityNavigationManager.IActionManagerExtended");kg(W,"PowerPointActivityNavigationManager.IPresentationReader");kg(oa,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");
kg(xa,"PowerPointActivityNavigationManager.IRibbonUser");kg(qb,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=A;this.ic=W;this.xe=oa;this.Vv=xa;this.utk=Ia;this.lik=qb}navigateToActivity(A){if(A.fromSummaryString)return this.Tpl(),this.YBj(),this.VBj(),this.Qzl(),Promise.resolve(1);A=A.activity;if(!A)return gd.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!A.navigationId)return gd.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),
Promise.resolve(4);if(!this.lik.doesContentExist(A))return Promise.resolve(2);switch(A.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:A=Rm(A);if(!A)return Promise.resolve(5);A=this.ia.Ja(ra.a.L2b,2,A);return Promise.resolve(32===A?1:6);default:return Promise.resolve(7)}}Tpl(){const A=this.ic.yn;A?A.oEa=!0:gd.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}YBj(){this.Vv.selectRibbonTabById(this.utk)}VBj(){var A=this.ic.yn;if(A&&A.slides){var W=
null;for(const oa of A.slides)if(oa&&(A=this.ic.Qk(oa.Cb))&&A.isUnread){W=A;break}W?(this.xe.utd(),this.xe.dK(W.qe)):gd.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else gd.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Qzl(){this.ia.Ja(bd.a.W1a,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(h.a)(ac,"PowerPointActivityNavigationManager",null,[694]);var Qc=d(678);class me{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(me,"ActivityFeedEntry",null,[]);const Ge=(A,W)=>W.A4c?Sa.toArray(Sa.select(Sa.asEnumerable(A),oa=>{if(!oa||!oa.activityFeedItemPayload)return oa;const xa=JSON.parse(oa.activityFeedItemPayload);var Ia=xa.actor;if(!Ia||Ia.pictureUrl)return oa;const qb=Ia.userPrincipalName||Ia.email;if(!qb)return oa;Ia=W.Tvb(qb,Ia.provider,L.AFrameworkApplication.Pg,0);if(!Ia)return oa;xa.actor.pictureUrl=Ia;return Object.assign(new me,
{id:oa.id,type:oa.type,collectionId:oa.collectionId,activityState:oa.activityState,activityFeedItemPayload:JSON.stringify(xa),timestamp:oa.timestamp})})):A,sf=(A,W)=>{const oa=new Map,xa=new Map;for(const Ia of A){if(!Ia||!Ia.activityFeedItemPayload)continue;A=JSON.parse(Ia.activityFeedItemPayload).actor;if(!A)continue;const qb=A.email||A.userPrincipalName;qb&&!xa.has(qb)&&xa.set(qb,new Qc.a(qb,null,A.name))}xa.forEach(Ia=>{const qb=W.nua(Ia,6);oa.set(Ia.UserId,qb)});return oa};class uf{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(uf,"ActivityFeedItem",null,[]);class xf{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(h.a)(xf,"ActivityFeedPayload",null,[]);class dg{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(h.a)(dg,"ActivityRequestPayload",null,[]);var df=d(545);class If{constructor(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(h.a)(If,"Activity",null,[]);class Ai{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld){this.Ve=this.QDe=null;kg(A,"PowerPointActivityRequestManager.IJsonpHelperManager");kg(W,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");kg(oa,"PowerPointActivityRequestManager.IFileRevisionHistoryService");kg(xa,"PowerPointActivityRequestManager.IAppSettingsManager");
kg(Ia,"PowerPointActivityRequestManager.IApplicationSettings");kg(qb,"PowerPointActivityRequestManager.IActionManagerExtended");kg(Hb,"PowerPointActivityRequestManager.ICatchUpRequestHandler");kg(hc,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");kg(Jc,"PowerPointActivityRequestManager.IPeopleColorUtils");this.vfa=A;this.hxk=W;this.nlk=oa;this.Ib=xa;this.ia=qb;this.q7c=Hb;this.zsk=hc;this.Dcd=Jc;this.a0g=ld}requestWYWAActivities(){return new Promise((A,W)=>{this.Ve=Wf.a.Jj("ShowWYWACallout",
2);this.hxk.phl(oa=>{oa=this.XYk(oa);Ai.isExpectedError(oa)?A(Ai.hQc):oa?(gd.a.J(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",oa),W(oa)):this.nlk.ukj(this.QDe,this.Ve,(xa,Ia)=>{Ia&&(gd.a.J(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Ia),W(Ia));A(Ai.SKi(xa))})},oa=>{const xa=!!oa.data&&Ai.l_j(oa.data.Oe);oa=this.vfa.j9(oa);gd.a.J(509223007,3012,xa?50:10,"OnReadRoamingFailed() - Error: {0}",oa);xa?A(Ai.hQc):W(oa)})})}requestActivities(){return Promise.resolve(Ai.hQc)}requestRelevantActivities(){return Promise.resolve(Ai.hQc)}requestActivityFeed(){return this.q7c?
df.b(this.q7c.getActivityFeed(this.a0g)).then(A=>{A=Ai.JMl(A);return{activityFeedItems:Ge(A,this.zsk),personaColorMap:sf(A,this.Dcd)}}):Promise.resolve(Object.assign(new xf,{activityFeedItems:[]}))}updateActivityState(A){return this.q7c?df.b(this.q7c.xRl(this.a0g,A.itemIds,A.activityStatesToSet||0,A.activityStatesToReset||0,A.resetUnseenCount)):Promise.resolve(!1)}XYk(A){A=A.data.Wd;if(!A)return"ErrorReadRoamingEmptyResponseBody";let W;try{W=JSON.parse(A)}catch(oa){return oa.toString()}A=null;if(!W.Error){if(!W.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");
A=W.Timestamp}this.QDe=this.OVl(A);gd.a.J(509223006,3012,100,"Timestamp for retrieving activities: "+this.QDe);return W.Error}OVl(A){const W={};var oa=this.Ib.uc("AppWaterlineOverrideTimestampValue",0);return oa?(A=new Date(1E3*oa),W.timestamp=A,this.ia.Ja(bd.a.Dvd,2,W),A.format("yyyy-MM-ddTHH:mm:ssZ")):A?(oa=this.Ib.uc("AppWaterlineOverrideDaysValue",0))?(A=new Date(+new Date(A)-+new Date(864E5*oa)),W.timestamp=A,this.ia.Ja(bd.a.Dvd,2,W),A.format("yyyy-MM-ddTHH:mm:ssZ")):A:null}static SKi(A){return A?
Object.assign(new dg,{actors:A}):null}static JMl(A){const W=[];if(!A)return W;for(const oa of A)W.push(Object.assign(new uf,{id:oa.id,type:oa.type,collectionId:oa.collectionId,activityState:oa.activityState,activityFeedItemPayload:oa.activityFeedItemPayload,timestamp:oa.timestamp}));return W}static isExpectedError(A){return"ErrorDocNotInRoamingList"===A||"ErrorLastViewedDocListIsEmpty"===A}static l_j(A){return 403===A}}Ai.hQc=Object.assign(new dg,{activities:[],actors:[],hasMore:!1,highWaterline:"",
lowWaterline:"",wywaWaterline:""});Object.assign(new dg,{activities:[Object.assign(new If,{activityId:"activityId1",type:3,actors:[Object.assign(new zi,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new If,{activityId:"activityId2",type:4,actors:[Object.assign(new zi,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,
relevancy:2,navigationId:"navigationId2"})]});Object.assign(new xf,{activityFeedItems:[Object.assign(new uf,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new uf,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(h.a)(Ai,"PowerPointActivityRequestManager",null,[695]);var nc=d(248);class hn{constructor(A,W,oa,xa,Ia,qb){this.wfb=!1;this.gOg=null;this.Mc=A;this.Qr=W;this.Etk=oa;this.vfa=xa;this.wb=Ia;this.hHb=qb}initialize(){this.Mc&&(this.Mc.CCa(Object(n.a)(this,this.RJa,"onBeforeSessionEnd")),this.Mc.GC(Object(n.a)(this,this.TM,"onSessionClosed")));this.lkl()}phl(A,W){const oa=this.lcg("getPPTDocLastViewedTimestamp");this.Xx(oa,1,A,W)}RJa(){this.KTh()}TM(){this.wfb=
!0}lkl(){if(this.wb){var A=new ee.a(3,2,3E4,Object(n.a)(this,this.lfl,"requestWriteWaterline"),90,"29");this.wb.Hb(A)}}lfl(){!this.wfb&&3E4<+Wf.a.Adc-+this.gOg&&(this.KTh(),this.gOg=Wf.a.Adc)}KTh(){const A=this.lcg("savePPTDocLastViewedTimestamp");this.hHb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.Qr.mpa(A,""):this.Xx(A,2,Object(n.a)(this,this.GNk,"onWriteWaterlineSucceeded"),Object(n.a)(this,this.FNk,"onWriteWaterlineFailed"))}GNk(A){let W=null;try{const oa=A.data.Wd;W=oa?JSON.parse(oa).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(oa){W="ErrorWriteRoamingParseJsonResponseException",gd.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+oa)}finally{W&&this.Zyg(W)}gd.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+A.data.fu-+A.data.PF,+A.data.Is-+A.data.PF)}FNk(A){this.Zyg("ErrorReadRoamingFailed");gd.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.vfa.j9(A))}lcg(A){return this.Etk+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
A,L.AFrameworkApplication.Pg)}Xx(A,W,oa,xa){const Ia={};Ia["X-StatelessPopsAffinityRoutingEnabled"]=this.hHb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Qr.qj(A,W,null,Ia,!1,1,oa,xa,null,void 0,void 0,void 0,void 0,nc.a("5"))}Zyg(A){gd.a.J(572555924,811,50,A)}}Object(h.a)(hn,"PowerPointWaterlineUpdater",null,[]);class yn{get name(){return"PowerPointWebEditor.Activity"}get Gne(){return L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").$e(Object(n.a)(this,this.wVi,"delayedInit"))}Xb(A){this.K=A}dispose(){this.K=this.p7c=null}Lwl(A){return!A||A.ka("IsAnonymousUser")?!1:A.ka("PPTCatchUpFlyoutIsEnabled")}wVi(){const A=this.K.resolve("Common.IAppSettingsManager");this.Lwl(A)&&(yb("Begin"),this.OZi(),this.cfk())}OZi(){nj.a.get_instance().Vj(7,()=>{yb("ScriptDownload");Re.a(this.K)("catchUpActivity").catch(()=>{gd.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.ZPj()).catch(()=>{gd.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}cfk(){gd.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Gne&&gd.a.J(526718752,3012,50,"ActivityFeedData is enabled")}ZPj(){const A=new yj(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),W=this.K.resolve("Common.AFrameworkApplication");this.K.register(hn,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").na().oa(()=>new hn(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),L.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(693,"Common.App.CatchUpActivity.IActivityContentManager").na().oa(()=>new oi(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(694,"Common.App.CatchUpActivity.IActivityNavigationManager").na().oa(()=>new ac(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Ye.a.g4k,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let oa=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").yg&&
(oa=this.K.resolve("Common.IAppSettingsManager").Ha("368")+"p");this.K.register(695,"Common.App.CatchUpActivity.IActivityRequestManager").na().oa(()=>new Ai(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),A,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
this.K.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.K.resolve("Common.App.People.IPeopleColorUtils"),oa));this.K.register(ib,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").na().oa(()=>new ib(W.To,L.AFrameworkApplication.Qa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(ma,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").na().oa(()=>
new ma(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));this.K.register(696,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").na().oa(()=>new oj(this.K.resolve("Common.IActionManagerExtended")));this.p7c=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new $l,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:L.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.Gne?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:L.AFrameworkApplication.uiCulture,ulsLogger:new Hj.a}));if(!this.p7c)return Promise.reject("Failure to create CatchUpApp");
this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.p7c.setWebpackPublicPath(L.AFrameworkApplication.Kpa);yb("InitializeCatchUpApp");return this.p7c.initialize(Object.assign(new Xf,{activityFeedDataEnabled:this.Gne,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){Za.a.instance.Ac(yd.a(new yn,
0))}}Object(h.a)(yn,"PPTWebEditorActivityPackage",null,[2,3]);var Bm=d(750);class gh extends Sys.EventArgs{constructor(A,W){super();this.shape=A;this.oEa=W}}Object(h.a)(gh,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class pj{constructor(A,W,oa,xa,Ia,qb,Hb){this.Ve=null;this.ia=A;this.ua=W;this.GR=oa;this.$dd=xa;this.Sb=Ia;this.Fc=qb;this.Ngb=Hb}dispose(){this.Ve&&(this.Ve=null)}me(){}vb(){this.ia.ya(bd.a.JJe,mh.a.application,Object(n.a)(this,this.bGj,"handleMarkAsRead"));this.ia.ya(bd.a.W1a,
mh.a.application,Object(n.a)(this,this.gJj,"handleShowHideChanges"));this.ia.ra(bd.a.eUe,Nc.a.application,Object(n.a)(this,this.JHj,"handleQueryShowHideChanges"),96);this.ia.ra(bd.a.Dvd,mh.a.application,Object(n.a)(this,this.hJj,"handleShowRevisionTrackingWithUrlOverrides"),96)}bGj(A,W,oa,xa,Ia){if(1===oa)return this.Sb.rj()?32:8;A=new Date;if(!Ia)throw Error.argumentNull("actionData is null");if(Ia.SlideNode){if(Ia=Object(z.a)(116,Ia.SlideNode))gd.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",
Ia.slideIndex+1)),this.GR.pdc?this.GR.Tgd(Ia,!0):(Ia.BX=A,this.GR.$Ve(Ia))}else this.KJe(A);return 32}KJe(A){const W=this.ua.presentation;if(!W)throw Error.argumentNull("Presentation is null");this.Ve=Wf.a.Jj("MarkActivitiesAsRead",1);gd.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.GR.pdc?this.GR.KJe():(Uh.b(W.slides||[],null,oa=>{if(oa=Object(z.a)(116,oa))oa.BX=A}),this.GR.Noh())}gJj(A,W,oa,xa,Ia){if(1===oa)return this.Sb.rj()?32:8;const qb=this.Sb.yn;
A=this.ua.Ba;if(!(qb&&A&&A.isConnected&&Ia))return 16;oa=W=!1;switch(Ia.ShowRevisionTrackingStatus){case 0:oa=W=!1;break;case 2:W=!0;oa=!1;break;case 3:oa=W=!0;break;case 1:W=qb.oEa&&!this.GR.x_d?!0:!qb.oEa;oa=!0;break;default:return 8}if(this.GR.x_d&&!oa)return 32;Ia=Ia.InvokeSource;qb.oEa=W;this.GR.x_d=W&&oa;oa&&this.Ngb.Ggk(Ia,W);Ia=A.yj();Uh.b(Ia,null,Hb=>{this.$dd.d3k(new gh(Hb,qb.oEa))});this.Fc.Uy(new xj.a(1));return 32}JHj(A,W,oa,xa,Ia){A=this.Sb.yn;if(!A)return 16;Ia.If(A.oEa);return 32}hJj(A,
W,oa,xa,Ia){A=this.ua.presentation;if(!Ia||!A||!A.slides)return 8;Ia=Ia.timestamp;if(!Ia)return 8;for(const qb of A.slides)Object(z.a)(116,qb).BX=Ia;this.GR.aWe(A.slides);return 32}}Object(h.a)(pj,"RevisionTrackingActor",null,[268,108]);class Rl{constructor(A){this.backgroundColor=this.foregroundColor=null;A&&A.isInHighContrastMode&&A.highContrastColors?(this.foregroundColor=A.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=A.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=
this.foregroundColor="#006BFF"}}Object(h.a)(Rl,"RevisionTrackingColorProvider",null,[]);class Yg{constructor(){this.va=new ek.a}i3k(A){this.va.raiseEvent("SlideUSC",A)}bKc(A){this.va.addHandler("SlideUSC",A)}xXe(A){this.va.removeHandler("SlideUSC",A)}L2k(A){this.va.raiseEvent("ShapeUSC",A)}Xki(A){this.va.addHandler("ShapeUSC",A)}ycl(A){this.va.removeHandler("ShapeUSC",A)}d3k(A){this.va.raiseEvent("ShowHideSC",A)}hli(A){this.va.addHandler("ShowHideSC",A)}Fcl(A){this.va.removeHandler("ShowHideSC",A)}}
Object(h.a)(Yg,"RevisionTrackingEventSource",null,[863,864,865]);class va extends Sys.EventArgs{constructor(A,W){super();this.shape=A;this.slide=W}}Object(h.a)(va,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class zn{constructor(){this.cid=this.sid=0}}Object(h.a)(zn,"Slide",null,[]);class jh{constructor(A,W){this.dt=this.mk=null;this.mk=Object.assign(new zn,{sid:A.sid,cid:A.cid});this.dt=W}}Object(h.a)(jh,"SlideLastViewedVersion",null,[]);class Qg{constructor(){this.v=0;this.lv=this.defLv=
null;this.v=1}}Object(h.a)(Qg,"SlideLastViewedVersions",null,[]);class Pk extends Sys.EventArgs{constructor(A){super();this.slide=A}}Object(h.a)(Pk,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Sj{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd,de,oe,Pc,tc){this.peb=this.Udb=null;this.bGg=!1;this.ABe=null;this.abd=0;this.FFb=this.bic=null;this.CFe=[];this.ldd=null;this.zed=!1;this.nya=null;this.Yge=this.Xge=this.x_d=!1;gd.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");
this.NGe=A;this.ua=W;this.wb=oa;this.lc=xa;this.Sb=Ia;this.od=qb;this.mlc=Hb;this.Mc=hc;this.Kk=Jc;this.$dd=wd;this.i0g=ld;this.Ib=de;this.nxk=Bd.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.mMg=Bd.V5j;this.B0g=!0;this.OH=!1;this.LIa=new Id.a;this.Mc.$Jc(Object(n.a)(this,this.voa,"onSessionAccessTokenExpired"));L.AFrameworkApplication.zz&&this.Mc.eKc(Object(n.a)(this,this.nga,"onWopiTokenRefreshed"));this.Ib.$e(()=>{this.Xge=!0;this.initialize();this.Noh();this.Xge=!1});this.Ngb=oe;
this.Eb=Pc;this.Auk=tc}get pdc(){return Ff.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.Udb&&(this.od.Voa(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.od.pqd(Object(n.a)(this,this.Pxa,"onShapeViewElementAdded")),this.mlc.eXe(Object(n.a)(this,this.xib,"onMarkedUndo")),this.Mc.oqd(Object(n.a)(this,this.RJa,"onBeforeSessionEnd")),this.Mc.Qaa(Object(n.a)(this,this.TM,"onSessionClosed")),this.Mc.Raa(Object(n.a)(this,this.Hn,"onSessionRehydrated")),this.Kk.Jcl(Object(n.a)(this,
this.Ndh,"onSlideChangesDataChanged")),this.Kk.pcl(Object(n.a)(this,this.Mch,"onPresentationLastModifiedTimeReceived")),this.mMg&&this.i0g.Qm(Object(n.a)(this,this.Adh,"onShapePropertyChanged")),this.Mc.Lrh(Object(n.a)(this,this.voa,"onSessionAccessTokenExpired")))}initialize(){gd.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.ABe=new Date;this.abd=this.ABe.getTime();this.Snl();this.od.eT(Object(n.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.od.Zsb(Object(n.a)(this,
this.Pxa,"onShapeViewElementAdded"));this.mlc.V_b(Object(n.a)(this,this.xib,"onMarkedUndo"));this.Mc.CCa(Object(n.a)(this,this.RJa,"onBeforeSessionEnd"));this.Mc.GC(Object(n.a)(this,this.TM,"onSessionClosed"));this.Mc.qB(Object(n.a)(this,this.Hn,"onSessionRehydrated"));this.Kk.nli(Object(n.a)(this,this.Ndh,"onSlideChangesDataChanged"));this.Kk.Fki(Object(n.a)(this,this.Mch,"onPresentationLastModifiedTimeReceived"));this.mMg&&this.i0g.gk(Object(n.a)(this,this.Adh,"onShapePropertyChanged"));this.nya=
this.ua.Ba;this.peb=this.uij();this.getSlideLastViewedVersions();const A=new ee.a(3,2,this.nxk,()=>{this.getSlideLastViewedVersions()},90,"12");this.wb.Hb(A)}onActiveSlideDomReady(A,W){A=Object(z.a)(116,W.Ba);this.nya&&A!==this.nya&&this.O2e()&&(this.nya.isConnected&&(this.nya.isUnread&&this.Tgd(this.nya,!0),!this.pdc&&this.nya.changesData&&(this.nya.BX=this.nya.changesData.dtField)),A&&A.isUnread&&this.Xoh(A));this.nya=A;this.abd=Date.now()}xib(A,W){W.actionId!==re.a.tVa&&W.uBb&&(A=this.ua.Ba)&&
A.isConnected&&A.isUnread&&this.O2e()&&this.Tgd(A,!0)}RJa(){this.O2e()&&this.wRl();this.VAd()}TM(){this.Ngb.log();this.OH=!0}Hn(){this.OH=!1;this.bic&&this.oPh(this.bic)}oPh(A){var W=this.ua.presentation;if(!W)throw Error.argumentNull("Presentation is null");W=W.slides||[];0<W.length&&(this.iVl(W,A),this.aWe(W))}OKk(A){this.Yge=!0;gd.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");A&&(this.LIa=new Id.a,this.forEach(A.lv,xa=>{const Ia=xa.mk.sid;(!this.LIa.Gb(Ia)||this.LIa.ga(Ia).dt<xa.dt)&&
this.LIa.$(Ia,xa)}));const W=Wf.a.Adc;let oa=!1;this.FFb&&this.NGe.Cvg&&W!==this.FFb&&(this.bic&&C.c(this.p5f())===C.c(this.bic)||(oa=!0));A&&A.defLv&&(this.peb=A.defLv,this.B0g=!1,A.lv&&0<A.lv.length&&this.oPh(A));oa&&this.VAd();this.FFb=Wf.a.Adc;this.Yge=!1}Ndh(A,W){this.forEach(W.slides,oa=>{this.aoe(oa.changesData)||(this.ua.Ba&&oa.Cb!==this.ua.Ba.Cb||this.KLj(Object(z.a)(116,oa)))&&this.$Ve(Object(z.a)(116,oa))})}Mch(A,W){this.B0g&&(this.peb=W.tXk)}Adh(A,W){A=W.property;W=Object(z.a)(4,W.node);
A===Jh.a.XMb&&(A=this.lc.jg(W),A===this.ua.Ba&&A.isUnread&&W.changesData.dtField<=A.changesData.dtField&&(gd.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.abd),this.ZVe(this.ua.Ba,W)))}Pxa(A,W){A=W.$w.shapeNode;this.ua.Ba.isUnread&&this.xGa(this.ua.Ba.Cb,A)&&!this.aoe(A.changesData)&&(this.CFe.push(A),this.ldd||(this.ldd=new ee.a(2,1,0,Object(n.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),
90,"13"),this.wb.Hb(this.ldd)))}getSlideLastViewedVersions(){this.OH||this.zed||this.NGe.getSlideLastViewedVersionInfo(Object(n.a)(this,this.OKk,"onReceiveLastViewedVersionInfo"))}VAd(){if(!this.OH&&!this.zed){var A=this.p5f();this.NGe.putSlideLastViewedVersionInfo(A);this.bic=A}}p5f(){const A=this.ua.presentation;if(!A)throw Error.argumentNull("Presentation is null");const W=Object.assign(new Qg,{defLv:this.peb}),oa=[];this.forEach(A.slides||[],xa=>{xa=xa.Cb;const Ia=this.Sb.Qk(xa);Ia&&Ia.BX&&(!xa.cid&&
this.LIa.Gb(xa.sid)?xa=Yd.a.ax(xa.sid,this.LIa.ga(xa.sid).mk.cid):xa.cid&&this.LIa.Gb(xa.sid)&&xa.cid!==this.LIa.ga(xa.sid).mk.cid&&gd.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",xa.sid,this.LIa.ga(xa.sid),xa.cid),oa.push(new jh(xa,Ia.BX)))});W.lv=oa;return W}iVl(A,W){const oa=W.lv;this.forEach(A,xa=>{const Ia=Object(z.a)(116,xa);this.forEach(oa,qb=>{Ia&&this.dqi(Ia,qb.mk)&&(!Ia.BX||Ia.BX<qb.dt)&&(Ia.BX=qb.dt)})})}dqi(A,W){return A.cid&&W.cid?A.sid===
W.sid&&A.cid===W.cid:A.sid===W.sid}aWe(A){this.forEach(A,W=>{this.$Ve(Object(z.a)(116,W))})}Noh(){var A=this.ua.presentation;if(!A)throw Error.argumentNull("Presentation is null");A=A.slides||[];0<A.length&&this.aWe(A)}Xoh(A){this.cTh(A,W=>{this.ZVe(A,W)})}$Ve(A){if(A&&A.isConnected&&A.changesData){const W=this.r1c(A.changesData,this.UWc(A));W!==A.isUnread&&(this.o5g(A,W),this.oPl(),A===this.ua.Ba&&this.Xoh(A))}}ZVe(A,W){if(W&&W.isConnected&&W.Ta(Jh.a.XMb)){const oa=this.r1c(W.changesData,this.UWc(A));
this.m5g(A,W,oa)}}m5g(A,W,oa){oa!==W.isUnread&&(gd.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",W.isUnread,oa),W.isUnread=oa,this.$dd.L2k(new va(W,A)))}o5g(A,W){W!==A.isUnread&&(gd.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",A.isUnread,W,A.Cb.toString()),A.isUnread=W,this.$dd.i3k(new Pk(A)))}Tgd(A,W){if(this.pdc){if(!A)throw Error.argumentNull("ISlideNode is null");this.hVl(A);gd.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",
A.Cb.toString(),A.isUnread,W);if(!A.isUnread)return!1}this.cTh(A,oa=>{this.m5g(A,oa,!1)});this.o5g(A,!1);this.pdc&&W&&this.VAd();return!0}KJe(){const A=this.ua.presentation;if(!A)throw Error.argumentNull("Presentation is null");let W=!1;this.forEach(A.slides,oa=>{oa=this.Tgd(Object(z.a)(116,oa),!1);W||(W=oa)});gd.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",W);W&&this.VAd()}cTh(A,W){A&&(A=A.yj(),this.forEach(A,oa=>{W(oa)}))}forEach(A,W){Uh.b(A,null,W)}aoe(A){return Fk(A,
this.Udb)}r1c(A,W){return!!A&&!!A.dtField&&!this.aoe(A)&&A.dtField>W}uij(){const A=this.Sb.yn;if(A&&A.WRe)return A.WRe;gd.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}Xog(A){const W=Object(z.a)(116,this.Auk.fdg(A));return W&&W.isUnread&&A&&this.r1c(A.changesData,this.UWc(W))}Snl(){this.Udb=new Ql(this.Ib.Ha("UserName"),this.Ib.Ha("387"),this.Ib.Ha("388"))}hVl(A){A.BX=A&&A.changesData?A.changesData.dtField:this.peb}wRl(){const A=this.ua.Ba;A&&(A.BX=A.changesData?
A.changesData.dtField:this.peb)}UWc(A){return A.BX||this.peb}oPl(){this.bGg||(this.bGg=!0,gd.a.J(512262741,804,50,"First revision tracking view render completed!"))}KLj(A){return A.isConnected&&A.changesData&&A.changesData.dtField?A.changesData.dtField<=this.ABe&&this.r1c(A.changesData,this.UWc(A)):!1}xGa(A,W){return A.equals(W.slideId)}tryHighlightInsertedShapes(){gd.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-
this.abd);this.ldd=null;const A=this.ua.Ba;if(A&&A.isUnread){const W=A.Cb;for(const oa of this.CFe)this.xGa(W,oa)&&this.ZVe(A,oa)}Array.clear(this.CFe)}voa(){this.zed=!0}nga(A,W){try{W.s4c?(gd.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),this.zed=!1):gd.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(oa){gd.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",oa)}}O2e(){return 1!==
this.Eb.al}}Object(h.a)(Sj,"RevisionTrackingManager",null,[]);class fk{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd){this.ua=A;this.Sb=W;this.KGe=oa;this.od=xa;this.k1=Ia;this.Ga=qb;this.z7c=Hb;this.qhb=hc;this.We=Jc;this.THa=ld;this.Nnk=wd;this.tQg=!1;this.od.atb(Object(n.a)(this,this.Ueh,"onVisibleThumbnailRangeChanged"));this.od.cKc(Object(n.a)(this,this.Rxa,"onThumbnailRefresh"));this.od.ali(Object(n.a)(this,this.zdh,"onShapePresenceStateChanged"));this.od.Ali(Object(n.a)(this,this.Deh,"onThumbnailPresenceStateChanged"));
this.od.hki(Object(n.a)(this,this.gMk,"onShapeViewElementShowRevisionTrackingHint"));this.od.eki(Object(n.a)(this,this.$Lk,"onShapeViewElementHideRevisionTrackingHint"));this.k1.bKc(Object(n.a)(this,this.aKa,"onSlideUnreadStateChanged"));this.k1.Xki(Object(n.a)(this,this.Fdh,"onShapeUnreadStateChanged"));this.k1.hli(Object(n.a)(this,this.Idh,"onShowHideStateChanged"))}dispose(){this.od.Vrh(Object(n.a)(this,this.Ueh,"onVisibleThumbnailRangeChanged"));this.od.zXe(Object(n.a)(this,this.Rxa,"onThumbnailRefresh"));
this.od.Bcl(Object(n.a)(this,this.zdh,"onShapePresenceStateChanged"));this.od.Rcl(Object(n.a)(this,this.Deh,"onThumbnailPresenceStateChanged"));this.k1.xXe(Object(n.a)(this,this.aKa,"onSlideUnreadStateChanged"));this.k1.ycl(Object(n.a)(this,this.Fdh,"onShapeUnreadStateChanged"));this.k1.Fcl(Object(n.a)(this,this.Idh,"onShowHideStateChanged"))}Ueh(){const A=this.ua.presentation;if(!A)throw Error.argumentNull("Presentation is null");Uh.b(A.slides||[],null,W=>{(W=this.Sb.Qk(W.Cb))&&W.isUnread&&this.m4e(W)})}Rxa(A,
W){A=this.Sb.Qk(W.lLh);A.isUnread&&this.m4e(A)}aKa(A,W){A=W.slide;A.isUnread?this.m4e(A):this.qal(A)}Fdh(A,W){A=W.shape;W=W.slide;A&&(A.isUnread?W===this.ua.Ba&&this.i4e(A):this.XWe(A))}zdh(A,W){A=W.shape;A.Hs?this.XWe(A):A.isUnread&&this.i4e(A,!0)}Deh(A,W){A=W.slide;A.Hs&&!this.k3e?this.yal(A):A.isUnread&&this.hCl(A)}Idh(A,W){A=W.shape;W.oEa&&A.isUnread?this.i4e(A):this.XWe(A)}get k3e(){return this.Nnk}m4e(A){A&&A.isConnected&&this.Uzd(A,W=>{W.oFh();A.Hs&&!this.k3e||this.aAf(W)})}qal(A){A&&A.isConnected&&
this.Uzd(A,W=>{W.Fqh();W.TWe()})}hCl(A){A.Hs&&!this.k3e||this.Uzd(A,Object(n.a)(this,this.aAf,"addRevisionTrackingPawnForThumbnail"))}yal(A){this.Uzd(A,W=>{W.TWe()})}CDh(){const A=this.Sb.yn;return!this.THa||this.THa&&A.oEa}i4e(A,W=!1){this.CDh()&&!A.Hs&&A.Ta(Jh.a.XMb)&&(Object(z.a)(117,A.qc(this.We))?(this.KGe.dJ(A).display(()=>this.Ga.NXc(A)),this.TOl(),gd.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",W)):gd.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}XWe(A){const W=
this.KGe.hJ(A);W?W.dismiss():this.CDh()&&A.isUnread&&gd.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}Uzd(A,W){A&&((A=Object(z.a)(861,A.rg(this.qhb)))?W(A):gd.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}aAf(A){A.NTd(this.z7c.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}gMk(A,W){this.tRh(W.$w.shapeNode,!0)}$Lk(A,W){this.tRh(W.$w.shapeNode,!1)}tRh(A,
W){(A=this.KGe.hJ(A))&&(W?A.V1a():A.jea())}TOl(){this.tQg||(this.tQg=!0,Gd.c(ra.a.KAi))}}Object(h.a)(fk,"RevisionTrackingPresenter",null,[]);class km{zRf(){const A=new Ni.a;A.ah(10,10);A.ypa("0 0 10 10");A.xa.setAttribute("class","ModernRevisionTrackingIconSVG");const W=new Xk.a;W.dZ("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");W.xa.setAttribute("class","ModernRevisionTrackingIconPath");A.appendChild(W);return A.xa}}Object(h.a)(km,"RevisionTrackingSVGProvider",null,[692]);class jn{constructor(){this.aed=
this.Pfd=this.Ofd=this.PEe=0}hhk(){this.Pfd+=1}Ggk(A,W){switch(A){case 2:W&&(this.Ofd+=1);break;case 0:W?(this.aed+=1,gd.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):gd.a.J(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:W&&(this.PEe+=1)}}log(){gd.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",
this.PEe,this.Ofd,this.Pfd,this.aed);0<this.Ofd+this.Pfd+this.aed&&Gd.c(ra.a.FKf)}}Object(h.a)(jn,"RevisionTrackingTelemetry",null,[]);var wk=d(1315),rl=d(1194),Oi=d(79),Qk=d(586);class gk{constructor(A,W,oa,xa,Ia){this.Rdb=null;this.KIa=A;this.Ngb=W;this.oc=Ia;this.Ub=oa;this.pa=xa;this.KIa.o8(Object(n.a)(this,this.GY,"onInteractivityChanged"))}dispose(){this.KIa&&this.KIa.dispose();this.Rdb=this.KIa=null}display(A,W){this.Rdb||(this.Rdb=new Qk.a);this.Rdb.color=A;this.Rdb.userName=W;this.KIa.pB(this.Rdb)}dismiss(){this.KIa.uP(this.Rdb.clientId)}V1a(){this.KIa.dMa()}jea(){this.KIa.hMa()}get OWd(){const A=
this.KIa.PKb;return 0<A.length?A[0]:null}GY(A,W){A={InvokeSource:2,ShowRevisionTrackingStatus:null};1===W.type?(this.Ub.Ba!==this.oc?(this.oc&&(this.Ub.Ba=this.oc,this.pa.iu()),A.ShowRevisionTrackingStatus=3):A.ShowRevisionTrackingStatus=1,L.AFrameworkApplication.Qa.Ja(bd.a.W1a,2,A)):2===W.type?this.oc&&this.Ub.Ba===this.oc&&(A.ShowRevisionTrackingStatus=2,L.AFrameworkApplication.Qa.Ja(bd.a.W1a,2,A),this.Ngb.hhk()):3===W.type&&this.oc&&this.Ub.Ba===this.oc&&(A.ShowRevisionTrackingStatus=0,L.AFrameworkApplication.Qa.Ja(bd.a.W1a,
2,A))}}Object(h.a)(gk,"ThumbnailRevisionTrackingPawn",null,[889,108]);d(297);class Lf{constructor(A,W,oa,xa,Ia,qb){this.af=A;A=Oi.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");W=W.qk("pegal.png");oa=oa.zRf();this.usk=this.FSi(L.AFrameworkApplication.isRtl,A,W,oa);this.Ngb=xa;this.Ub=Ia;this.pa=qb}qQi(A,W){return new gk(this.usk.C3b(A),this.Ngb,this.Ub,this.pa,W)}Pc(A){return this.af.Pc(A)}FSi(A,W,oa,xa){const Ia=new wk.a;Ia.add(1,W);Ia.add(4,oa);Ia.add(6,16);Ia.add(8,A);Ia.add(12,
2);Ia.add(11,!1);Ia.add(14,xa);return new rl.a(Ia)}}Object(h.a)(Lf,"RevisionTrackingThumbnailGadgetsFactory",null,[691]);class am{constructor(A,W,oa){this.PHa=this.Zma=!0;this.Qr=A;this.vfa=W;this.la=oa}get Cvg(){return this.Zma}getSlideLastViewedVersionInfo(A){if(this.PHa){gd.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var W=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
"getPPTSlideLastViewedMetadata",L.AFrameworkApplication.Pg),oa={};oa["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Qr.qj(W,1,null,oa,!1,2,Object(n.a)(this,this.cIk,"onGetVersionInfoSucceeded"),Object(n.a)(this,this.bIk,"onGetVersionInfoFailed"),A,void 0,void 0,void 0,void 0,nc.a("12"));this.PHa=!1}else gd.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(A){if(this.Zma){gd.a.J(25203106,
824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var W=C.c(A),oa=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;if(W.length>oa)gd.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",A.lv.length,W.length,oa);else{oa=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",L.AFrameworkApplication.Pg);
if(L.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Qr.mpa(oa,W);else{const xa={};xa["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Qr.qj(oa,2,W,xa,!1,2,Object(n.a)(this,this.GKk,"onPutVersionInfoSucceeded"),Object(n.a)(this,this.FKk,"onPutVersionInfoFailed"),A.lv.length,void 0,void 0,void 0,void 0,nc.a("13"))}this.Zma=!1}}else gd.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}cIk(A){this.PHa=
!0;let W=0;try{let oa=null;A.data.Wd&&0<A.data.Wd.trim().length&&(W=A.data.Wd.length,oa=JSON.parse(A.data.Wd,Object(n.a)(this,this.K$j,"jsonDateReviver")));const xa=A.data.state;xa(oa)}catch(oa){gd.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",oa.toString())}A=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",W,JSON.stringify(A.data.PF),JSON.stringify(A.data.Is),JSON.stringify(A.data.fu));gd.a.J(25203139,824,50,
A)}bIk(A){this.PHa=!0;A=this.vfa.j9(A);gd.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",A)}GKk(A){this.Zma=!0;gd.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+A.data.fu-+A.data.PF,+A.data.Is-+A.data.PF)}FKk(A){this.Zma=!0;const W=this.vfa.j9(A);gd.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",W,A.data.state)}K$j(A,W){return"dt"===A||"defLv"===A?new Date(W):W}}Object(h.a)(am,"RoamingCacheProxy",
null,[690,108]);var jo=d(998),Rk=d(124);class ve{constructor(A,W,oa){this.Dg=A;this.UJ=Object(z.a)(jo.a,this.Dg.SBh);this.z7c=W;this.cvk=oa;this.Dg.Srg=!0}display(A){let W;W=this.cvk.zRf();this.UJ.vgi(this.z7c.backgroundColor,A,W);this.Dg.kRb(this.z7c.foregroundColor);this.Dg.setVisibility()}dismiss(){this.UJ.clear();this.Dg.kRb(Rk.a.none);this.Dg.setVisibility()}Bm(A){this.Dg.Bm(A)}kC(A){this.Dg.kC(A)}Mp(){return this.Dg.Mp()}PL(A){return this.Dg.UAb(A)}Xw(A){this.Dg.Xw(A)}dispose(){this.Dg.dispose()}ny(){this.Dg.ny()}ZC(A){return this.Dg.ZC(A)}TA(A){return this.Dg.TA(A)}draw(A,
W){this.Dg.draw(A,W)}get visible(){return this.Dg.visible}set visible(A){this.Dg.visible=A}setPosition(A,W){this.Dg.setPosition(A,W)}Kj(A){this.Dg.Kj(A)}wq(A){this.Dg.wq(A)}Ju(A){this.Dg.Ju(A)}setZIndex(A){this.Dg.setZIndex(A)}JD(A,W){this.Dg.JD(A,W)}V1a(){this.UJ.V1a()}jea(){this.UJ.jea()}setSelection(){}}Object(h.a)(ve,"ShapeRevisionTrackingView",null,[745,282,283,108]);class I{constructor(){this.K=null;this.THa=this.gFb=this.TO=this.r5=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Xb(A){this.K=
A;A.resolve("Common.IAppSettingsManager").$e(()=>{this.TO=A.resolve("PowerPointWebEditor.IApplicationContext").rd.yg;this.gFb=A.resolve("PowerPointWebEditor.IApplicationContext").rd.F4j;this.r5=A.resolve("PowerPointWebEditor.IApplicationContext").rd.kre;this.THa=A.resolve("PowerPointWebEditor.IApplicationContext").rd.hqe;this.register();this.resolve()})}dispose(){this.r5&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const A=this.K;this.TO&&this.gFb&&A.register(Bm.a,"PowerPointWebEditor.PodsInfoSender").na().oa(()=>new Bm.a(L.AFrameworkApplication.Je,A.resolve("PowerPointWebEditor.ISessionInfoOwner"),A.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),A.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),A.resolve("PowerPointWebEditor.IErrorHandler"),A.resolve("Common.ITaskManager"),A.resolve("Common.IAppSettingsManager")));
this.r5&&(A.register(jn,"RevisionTrackingTelemetry").na().oa(()=>new jn),A.register(Sj,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").na().oa(()=>new Sj(A.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),A.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.resolve("Common.ITaskManager"),A.resolve("PowerPointWebEditor.ISlideReader"),A.resolve("PowerPointWebEditor.IPresentationReader"),A.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
A.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),A.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),A.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),A.resolve("Box4.Graph.IGraphInstance").zd(10),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),A.resolve("PowerPointWebEditor.IApplicationSettings"),A.resolve("Common.IAppSettingsManager"),A.resolve("RevisionTrackingTelemetry"),A.resolve("PowerPointWebEditor.View.IPPTPageView"),A.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),
A.register(fk,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").na().oa(()=>new fk(A.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.resolve("PowerPointWebEditor.IPresentationReader"),A.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),A.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),A.resolve("PowerPointWebEditor.IShapeReader"),
A.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),A.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,A.resolve("Box4.IPageView").Na,A.resolve("PowerPointWebEditor.IApplicationSettings").hqe,A.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),A.register(690,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").na().oa(()=>new am(L.AFrameworkApplication.Je,A.resolve("PowerPointWebEditor.IJsonpHelperManager"),A.resolve("PowerPointWebEditor.IApplicationSettings"))),
A.register(691,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").na().oa(()=>new Lf(A.resolve("PowerPoint.IBrowserHelperManager"),A.resolve("PowerPoint.IPathManager"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),A.resolve("RevisionTrackingTelemetry"),A.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),A.resolve("PowerPointWebEditor.IPptSelectionManager"))),A.register(Yg,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").na().oa(()=>
new Yg),A.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").na().oa(()=>new Dg.a((W,oa)=>{let xa=null;const Ia=Object(z.a)(117,W.qc(A.resolve("Box4.IPageView").Na));Ia&&!Ia.Ml&&(W=A.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").H2d(A.resolve("PowerPointWebEditor.IPptSelectionManager"),(qb,Hb,hc)=>A.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").yRi(qb,Hb,hc,A.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
W,oa,Ia.nV),xa=new ve(W,A.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),xa.Bm(Ia.nV),Ia.$ra(xa,1),xa.visible=Ia.TQ||Ia.lo);return xa})),A.register(Rl,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").na().oa(()=>new Rl(A.resolve("Common.Utils.IHighContrastDetector"))),A.register(692,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").na().oa(()=>new km),
this.TO&&this.THa&&A.register(pj,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").na().oa(()=>new pj(A.resolve("Common.IActionManagerExtended"),A.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),A.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),A.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),A.resolve("PowerPointWebEditor.IPresentationReader"),A.resolve("PowerPointWebEditor.View.IViewEventSource"),A.resolve("RevisionTrackingTelemetry"))))}resolve(){this.TO&&
this.gFb&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.r5&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.THa)){const A=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");A.vb();A.me()}}static main(){Za.a.instance.Ac(yd.a(new I,0))}}Object(h.a)(I,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var V=d(414),Ba=d(210),cb=d(131);class Nb{constructor(A){this.nQa=[re.a.Qvc,re.a.Rvc,re.a.Svc,re.a.Tvc,re.a.Uvc];this.tgf=A}p8f(A){return this.tgf?this.tgf.UVc(A.Ua):null}create(A){return A?(A=this.N3b(A))?cb.m(A):"":""}ONi(A){A=A.suggestions;if(!A||!A.count)return null;A=({wUf:W}=this.oSi(A)).returnValue;var W=Nb.ROi(W);const oa=Object.assign(new V.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,
Image16by16Class:Oi.getImageClassWithCluster(L.AFrameworkApplication.lO,Nb.xXi),Image16by16:L.AFrameworkApplication.km,Menu:Object.assign(new Kg.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});A&&Array.add(oa.Menu.MenuSectionList,A);Array.add(oa.Menu.MenuSectionList,W);return oa}oSi(A){let W;const oa=Object.assign(new Aa.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});
W=null;for(let xa=0,Ia=Math.min(this.nQa.length,A.count);xa<Ia;++xa){if(!W&&""===A.ga(xa).suggestion){W=this.nQa[xa].toString();continue}const qb=Object.assign(new Ba.a,{ExternalId:"btnDictationCorrectionSuggestion"+xa,Command:this.nQa[xa].toString(),LabelText:A.ga(xa).suggestion});Array.add(oa.ControlList,qb)}return oa.ControlList.length?{returnValue:oa,wUf:W}:{returnValue:null,wUf:W}}N3b(A){if(A=this.ONi(A)){const W=Object.assign(new Aa.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});
Array.add(W.ControlList,A);return W}return null}static ROi(A){const W=Object.assign(new Aa.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),oa=Object.assign(new Ba.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(W.ControlList,oa);A&&(A=Object.assign(new Ba.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",
Command:A,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(W.ControlList,A));return W}}Nb.xXi="Insertaudio_16x16x32";Object(h.a)(Nb,"DictationCorrectionContextMenuManager",null,[743]);var Ec=d(448);class Oc{constructor(A,W){this.uAc=null;this.Er=A;this.WZ=W}get key(){return"DICTATIONCORRECTION"}get E8(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(A){this.Er.fe(A.node)?this.uAc=A.node:this.uAc=null}cxc(A){let W;W=null;if(!this.uAc)return{returnValue:!1,
pCa:W};A=this.WZ.Tij(this.uAc,A);if(!A)return{returnValue:!1,pCa:W};W=Object.assign(new Ec.a,{N1:this.key,vQ:A,description:this.yae()});return{returnValue:!0,pCa:W}}yae(){return L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(h.a)(Oc,"DictationCorrectionDetailsProvider",null,[703,328]);var je=d(624),De=d(146);class Pd{constructor(A,W,oa=-1){this.TriggerType="click";this.TreatedInUX=
"true";this.PhraseId=A.OSk;this.CorrectionId=A.id;switch(W){case 0:this.EditType="alternate";this.AlternateId=oa;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(h.a)(Pd,"CorrectionEvent",null,[]);class Ke{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(h.a)(Ke,"CorrectionTelemetry",null,[]);class xg{constructor(){this.Id=
"Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(h.a)(xg,"CorrectionsSessionTelemetry",null,[]);class Gg{constructor(){this.KS=!1;this.xBd=this.mKd=0}start(){this.KS||(this.KS=!0,this.mKd=this.getTime())}stop(){this.KS&&(this.xBd+=this.getTime()-this.mKd,this.KS=!1)}get er(){return this.xBd+(this.KS?this.getTime()-this.mKd:0)}getTime(){return(new Date).getTime()}}Object(h.a)(Gg,"DictationCorrectionsSessionTimer",null,[]);class ph{constructor(){this.StartTime=
"";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(h.a)(ph,"SessionInfo",null,[]);class qg{constructor(){this.FinalText="";this.PhraseIds=null}}Object(h.a)(qg,"TextInfo",null,[]);var th=d(184);class ci{constructor(A){this.fqf=this.VLd=this.WLd=0;this.WVh="Office.Voice.Online.DictationCorrectionsSession";this.v6a=null;this.Hrb=Object.assign(new ph,{TextInfo:[new qg]});this.Yif=A}startSession(){this.v6a||(this.Hrb.StartTime=(new Date).toISOString(),this.v6a=new Gg);
this.v6a.start()}pauseSession(){this.v6a.stop()}endSession(){this.v6a.stop();var A=new th.a;A.name=this.WVh;A.samplingPolicy=2;A.durationMs=this.v6a.er;A.dataFields=[];Array.add(A.dataFields,Object.assign(new md.a,{name:"CorrectionSessionId",string:this.Zya}));Array.add(A.dataFields,Object.assign(new md.a,{name:"StartTime",string:this.Hrb.StartTime}));Array.add(A.dataFields,Object.assign(new md.a,{name:"NumberOfCorrectionsMarked",int64:this.WLd}));Array.add(A.dataFields,Object.assign(new md.a,{name:"NumberOfCorrectionsMade",
int64:this.VLd}));Array.add(A.dataFields,Object.assign(new md.a,{name:"NumberOfCorrectionsDismissed",int64:this.fqf}));De.a.sendActivityEvent(A);if(kc.App.J_&&0<kc.App.J_.Yhh.length){this.Hrb.AlternateEditCount=this.VLd;this.Hrb.Duration=Math.floor(this.v6a.er/1E3);this.Hrb.TextInfo[0].PhraseIds=kc.App.J_.Yhh;var W=new xg;W.ClientSessionId=this.Zya;W.SessionInfo=this.Hrb;if(A=this.Yif())W=C.c(W),A.hyg(W)}}GGk(A){this.WLd+=A}kah(A,W,oa=-1){0===W?this.VLd++:1===W&&this.fqf++;var xa=new Ke;xa.ClientSessionId=
this.Zya;xa.CorrectionEvents=[new Pd(A,W,oa)];if(A=this.Yif())xa=C.c(xa),A.hyg(xa)}get Zya(){return kc.App.J_?kc.App.J_.Zya:""}}Object(h.a)(ci,"DictationCorrectionsTelemetry",null,[]);var Hf=d(44),Xh=d(42);class bm{constructor(A,W,oa){this.RN=A;this.Lb=W;this.gH=oa}}Object(h.a)(bm,"DictationCorrectionRange",null,[]);var Qn=d(368);class Sm{constructor(A,W,oa){this.YS=this.dr=null;this.Xob=A;this.LAa=W;this.qFc=new Qn.a(new je.a);this.mAc=oa;this.cLa()}gne(A){this.LAa.RDa&&fg.ParagraphReader.fe(A)&&
this.qFc.contains(A.id)&&this.Xob.gne(A)}qFl(){this.LAa.RDa=!0;this.dr=new ci(()=>this.YS);this.dr.startSession()}gGl(){this.LAa.RDa=!1;var A=kc.App.Mb.Ld.Rn.Ag;if(A){A=A.Nh;for(let W of this.qFc){const oa=A.Be(W);oa&&fg.ParagraphReader.fe(oa)&&this.Xob.VDi(oa)}}this.mAc.clear();this.qFc.clear();this.dr.endSession()}Ugl(A){if(this.LAa.RDa){var W=A.sa(Xh.a.K4d,null);if(!ue.a.Xa(W)){var oa=new Ga.a,xa=Math.min(W.length,A.Sa.length);for(let Ia=0;Ia<xa;Ia++){const qb=this.mAc.lhj(W[Ia]);if(qb){const Hb=
A.Sa.ga(Ia).cp;oa.add(new bm(Hb,Hb+qb.source.length,qb))}}this.Xob.dyk(A,oa)}}}M$e(A,W){if(!W)return!1;if(!this.LAa.RDa||!A)return W.add(null),!1;W.add(A.Av?A.Av.gH.key:null);return!!A.Av}zjl(A,W){this.LAa.RDa&&W&&Sa.AT(W,oa=>!!oa)?A.Ae(Xh.a.K4d,W.toArray()):A.removeProperty(Xh.a.K4d)}pph(A){this.YS=A}cLa(){this.Xob.hii(Object(n.a)(this,this.DGk,"onDictationCorrectionMarkerAdded"));zd.a.addHandler(window.self,sc.a.blur,()=>{this.dr&&this.LAa.RDa&&this.dr.pauseSession()});zd.a.addHandler(window.self,
sc.a.focus,()=>{this.dr&&this.LAa.RDa&&this.dr.startSession()});this.Xob.iii(Object(n.a)(this,this.EGk,"onDictationCorrectionMarkerRemoved"))}EGk(A,W){this.mAc.n$k(W.aQf)}DGk(A,W){this.qFc.add(W.TPk);this.dr&&this.dr.GGk(W.Iyk);this.mAc.yei(W.aQf)}CGk(A,W){this.dr&&this.dr.kah(A,0,W)}FGk(A){this.dr&&this.dr.kah(A,1)}Tij(A,W){if(!this.LAa.RDa)return null;A=cg.a.Oj(A,W);return this.Xob.UVc(A)}}Object(h.a)(Sm,"DictationCorrectionManager",null,[742]);class lg extends Sys.EventArgs{constructor(A,W){super();
this.TPk=A;this.Iyk=W?W.count:0;this.aQf=W}}Object(h.a)(lg,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Cm{constructor(A,W,oa,xa,Ia){this.g7h=A;this._id=W;this.MYh=xa;this.yZb=Ia;this.Zt=oa;this.mWb=String.format("{0}_{1}",A,W)}get OSk(){return this.g7h}get id(){return this._id}get source(){return this.Zt}get confidence(){return this.MYh}get suggestions(){return this.yZb}get key(){return this.mWb}Qzk(A){this.suggestions.addRange(A.suggestions)}}Object(h.a)(Cm,"DictationCorrectionDetails",
null,[]);class Eg{constructor(A,W,oa){this.$n=A;this.lZh=W;this.m6h=oa}get gH(){return this.lZh}get kbh(){return this.m6h}get Ke(){return this.$n}ge(A){return new Eg(A||this.Ke,this.gH,this.kbh)}}Object(h.a)(Eg,"DictationCorrectionObject",null,[147]);class qe{constructor(A,W){this.source=A;this.suggestion=W}}Object(h.a)(qe,"DictationCorrectionSuggestion",null,[]);class Bi{constructor(A){this.mh=A;this.Oa=new ek.a}hii(A){this.Oa.addHandler("ADCM",A)}iii(A){this.Oa.addHandler("RDCM",A)}dyk(A,W){this.nyk(A,
W)}nyk(A,W){if(A&&W&&W.count&&(W=Bi.EXl(A,W))&&W.count){this.gEi(A,W);var oa=new Ga.a;for(var xa of W)oa.add(xa.RN),oa.add(xa.Lb);A.J6d(oa);for(let Ia of W)xa=A.Sa.NT(Ia.RN),xa.Av=new Eg(xa,Ia.gH,Object(n.a)(this,this.JGj,"handleParagraphSplit")),xa.isFromErrorRangeSplit=!0,xa=A.Sa.NT(Ia.Lb),xa.isDictationCorrectionEnd=!0,xa.isFromErrorRangeSplit=!0;0<W.count&&this.Oa.raiseEvent("ADCM",new lg(A.id,W))}}o8f(A){const W=new Ga.a;if(A){let oa=null,xa=-1;for(let Ia=0;Ia<A.Sa.length;Ia++){const qb=A.Sa.ga(Ia);
qb.Av?(xa=qb.cp,oa=qb.Av.gH):qb.isDictationCorrectionEnd&&(oa?W.add(new bm(xa,qb.cp,oa)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),oa=null)}}return W}Frc(A,W){if(A&&W&&W.count){for(let oa of W){let xa=A.Sa.NT(oa.RN);xa&&(xa.Av=null);if(xa=A.Sa.NT(oa.Lb))xa.isDictationCorrectionEnd=!1}this.Oa.raiseEvent("RDCM",new lg(A.id,W))}}VDi(A){if(A)for(let W=0;W<A.Sa.length;W++){const oa=A.Sa.ga(W);oa.Av&&(oa.Av=null);oa.isDictationCorrectionEnd&&(oa.isDictationCorrectionEnd=
!1)}}UVc(A){if(!A||!Hf.SelectionEditor.tk(A)&&!Hf.SelectionEditor.Xg(A))return null;const W=A.node;let oa=A.Ra;A=A.Lb;let xa=0,Ia=null;for(let qb=0;qb<W.Sa.length;qb++){const Hb=W.Sa.ga(qb);if(Hb.Av&&oa>=Hb.cp)Ia=Hb.Av,xa=Hb.cp;else if(Ia&&Hb.isDictationCorrectionEnd){if(A<=Hb.cp)return new bm(xa,Hb.cp,Ia.gH);Ia=null}}return null}FXl(A,W,oa){if(!A)return!1;A=fg.ParagraphReader.text(A);return Bi.CSh(A,W.source,oa)}gne(A){if(A){var W=this.o8f(A);if(W&&0<W.count){const oa=new Ga.a,xa=fg.ParagraphReader.text(A);
for(let Ia of W)Bi.BSh(xa,Ia)||oa.add(Ia);this.Frc(A,oa)}}}gEi(A,W){W.ga(0);W.ga(W.count-1);const oa=this.o8f(A);let xa=0,Ia=0;const qb=new Ga.a;for(;Ia<W.count&&xa<oa.count;){const Hb=W.ga(Ia),hc=oa.ga(xa);Hb.Lb<hc.RN?Ia++:(hc.Lb>Hb.RN&&qb.add(hc),xa++)}this.Frc(A,qb)}JGj(A,W){const oa=W.Ke;for(var xa=A.Sa.Cyb(oa.cp)+1;xa<A.Sa.length;xa++){const Ia=A.Sa.ga(xa);if(Ia.isDictationCorrectionEnd){let qb;this.Frc(A,(qb=new Ga.a,qb.add(new bm(oa.cp,Ia.cp,W.gH)),qb));break}}}EMk(A,W){(A=kc.App.Mb.Ld.Rn.Ag)&&
(W=A.Nh.Be(zf.a.Kf(W.nodeId)))&&fg.ParagraphReader.fe(W)&&this.o$k(W)}o$k(A){if(A){var W=0,oa=!1,xa=!1,Ia=new Ga.a;for(let qb=0;qb<A.Sa.length;qb++){const Hb=A.Sa.ga(qb);Hb.Av&&(W=qb,oa=!0);oa&&(Hb.aq||Hb.eM)&&(xa=!0);Hb.isDictationCorrectionEnd&&oa&&(oa=!1,xa&&(xa=A.Sa.ga(W),xa.Av&&xa.Av.gH&&Ia.add(new bm(xa.cp,Hb.cp,xa.Av.gH)),xa.Av=null,xa=Hb.isDictationCorrectionEnd=!1))}this.Oa.raiseEvent("RDCM",new lg(A.id,Ia))}}static EXl(A,W){if(!W.count)return W;W.Sc((xa,Ia)=>xa.RN!==Ia.RN?xa.RN-Ia.RN:xa.Lb-
Ia.Lb);A=fg.ParagraphReader.text(A);const oa=new Ga.a;for(let xa=0;xa<W.count;xa++){const Ia=W.ga(xa);if(Ia.RN>A.length||Ia.Lb>A.length)break;if(!Bi.BSh(A,Ia))continue;if(!oa.count){oa.add(Ia);continue}const qb=oa.ga(oa.count-1);Ia.RN>qb.Lb?oa.add(Ia):qb.RN===Ia.RN&&qb.Lb===Ia.Lb&&qb.gH.Qzk(Ia.gH)}return oa}static CSh(A,W,oa){if(oa+W.length<=A.length){for(let xa=0;xa<W.length;xa++)if(W.charAt(xa)!==A.charAt(xa+oa))return!1;return!0}return!1}static BSh(A,W){return!A||W.RN>A.length||W.Lb>A.length||
!W.gH||!W.gH.source?!1:Bi.CSh(A,W.gH.source,W.RN)}}Object(h.a)(Bi,"DictationCorrectionRangeEditor",null,[741]);class kn{constructor(){this.RDa=!1}}Object(h.a)(kn,"DictationCorrectionSettings",null,[]);var Tm=d(15);class hk{constructor(){this.vZb=new Tm.ScriptSharpLegacyMap}yei(A){if(A&&A.count)for(let W of A)W.gH?(A=W.gH.key,this.vZb.Gb(A)||this.vZb.add(A,W.gH)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}n$k(A){if(A&&A.count)for(let W of A)W.gH?this.vZb.remove(W.gH.key):e.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}lhj(A){if(!A)return null;let W;return({value:W}=this.vZb.vg(A)).returnValue?W:null}clear(){this.vZb=new Tm.ScriptSharpLegacyMap}}Object(h.a)(hk,"DictationCorrectionStorage",null,[807]);class Dm{constructor(A,W,oa,xa,Ia,qb,Hb){this.mh=A;this.WTb=W;this.WZ=oa;this.Ca=xa;this.Uc=Ia;this.rf=qb;this.Mk=Hb}vb(){this.Ca.ya(re.a.Qvc,Nc.a.Mf,Object(n.a)(this,this.Vvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(re.a.Rvc,Nc.a.Mf,Object(n.a)(this,this.Vvc,"takeSuggestedDictationCorrectionAction"));
this.Ca.ya(re.a.Svc,Nc.a.Mf,Object(n.a)(this,this.Vvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(re.a.Tvc,Nc.a.Mf,Object(n.a)(this,this.Vvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(re.a.Uvc,Nc.a.Mf,Object(n.a)(this,this.Vvc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(re.a.Pvc,Nc.a.Mf,Object(n.a)(this,this.Pvc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.ya(re.a.Qvc,Nc.a.view,Object(n.a)(this,this.kvb,"collapseIpThenExecuteAction"));this.Ca.ya(re.a.Rvc,Nc.a.view,
Object(n.a)(this,this.kvb,"collapseIpThenExecuteAction"));this.Ca.ya(re.a.Svc,Nc.a.view,Object(n.a)(this,this.kvb,"collapseIpThenExecuteAction"));this.Ca.ya(re.a.Tvc,Nc.a.view,Object(n.a)(this,this.kvb,"collapseIpThenExecuteAction"));this.Ca.ya(re.a.Uvc,Nc.a.view,Object(n.a)(this,this.kvb,"collapseIpThenExecuteAction"));this.Ca.ya(re.a.Pvc,Nc.a.view,Object(n.a)(this,this.kvb,"collapseIpThenExecuteAction"));this.Ca.ie(re.a.Qvc,96);this.Ca.ie(re.a.Rvc,96);this.Ca.ie(re.a.Svc,96);this.Ca.ie(re.a.Tvc,
96);this.Ca.ie(re.a.Uvc,96);this.Ca.ie(re.a.Pvc,96)}Foi(A,W,oa){const xa=this.Mk.ke(15);try{xa.ld(A);let Ia;this.WTb.Frc(A,(Ia=new Ga.a,Ia.add(W),Ia));const qb=W.gH.suggestions.ga(oa);if(this.WTb.FXl(A,qb,W.RN)){const Hb=cg.a.createTextRange(A,W.RN,W.RN+qb.source.length);this.mh.replaceTextRange(Hb,qb.suggestion);this.WZ.CGk(W.gH,oa)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{xa&&xa.dispose()}}Vvc(A,W,oa){2===oa&&W.Rk&&(oa=this.WTb.UVc(W))&&this.Foi(W.node,oa,this.nhj(A));
return 32}kvb(A,W,oa,xa,Ia){if(2===oa){W=this.Uc.Pa.nb;if(!W)return 2;W=this.rf.im(W,!0,!1);return this.Ca.ii(W.Ua,A,oa,!1,xa,Ia)}return 32}Pvc(A,W,oa){if(2===oa&&W.Rk&&(A=this.WTb.UVc(W))){let xa;this.WTb.Frc(W.node,(xa=new Ga.a,xa.add(A),xa));this.WZ.FGk(A.gH)}return 32}nhj(A){switch(A){case re.a.Qvc:return 0;case re.a.Rvc:return 1;case re.a.Svc:return 2;case re.a.Tvc:return 3;case re.a.Uvc:return 4;default:return-1}}}Object(h.a)(Dm,"DictationCorrectionsActor",null,[790]);var Rn=d(325),ak=d(64);
class Ho{constructor(){this.ugf=this.Ea=null}get name(){return"Box4.DictationCorrections"}Xb(A){this.Ea=A;this.Ea.register(741,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").na().oa(()=>new Bi(this.Ea.resolve("Box4.ICharacterPropertiesEditor")));this.Ea.register(742,"Box4.DictationCorrections.IDictationCorrectionManager").na().oa(()=>new Sm(this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new kn,new hk));this.Ea.register(743,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").na().oa(()=>
new Nb(this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.ugf=new Dm(this.Ea.resolve("Box4.ICharacterPropertiesEditor"),this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),L.AFrameworkApplication.Qa,ak.a.instance,Rn.a.instance,this.Ea.resolve("Box4.Graph.IGraphTransactionFactory"));this.ugf.vb();
this.w7k(this.Ea.Ia("Box4.Accessibility.IAccessibilityContextManager"),this.Ea.resolve("Box4.IParagraphReader"),this.Ea.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const A=this.Ea.rb("Box4.Proofing.IErrorRangeEditor"),W=this.Ea.rb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");L.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&A&&W&&A.rji(Object(n.a)(W,W.EMk,"onSpellingErrorRangesChangedEventHandler"));kc.App.Mb.updateCommandUI()}dispose(){}w7k(A,
W,oa){A&&A.execute(xa=>{xa.z0a(new Oc(W,oa))})}}Object(h.a)(Ho,"DictationCorrectionsPackageManager",null,[2,3]);d(1266);d(735);var Em=d(492);class ik{constructor(A,W,oa,xa=null,Ia=null){this.$n=A;this.ZG=W;this.C3h=oa;this._id=xa;this.VHd=Ia}get Ke(){return this.$n}get type(){return this.ZG}get Jk(){return this.C3h}get id(){return this._id}get Zmg(){return this.VHd}ge(A){return new ik(A,this.type,this.Jk,this.id,this.Zmg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.Jk,this.id?this.id.toString():"<null>")}}Object(h.a)(ik,"IntentObject",null,[147]);d(611);class Gk{constructor(A,W,oa,xa=null,Ia=null){Em.a(A);this.ZG=A;this.LCd=W;this.uFd=oa;this._id=xa;this.VHd=Ia}get type(){return this.ZG}get begin(){return this.LCd}get end(){return this.uFd}get id(){return this._id}get Zmg(){return this.VHd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(h.a)(Gk,"IntentRange",
null,[270]);d(367);d(153);d(198);class An{constructor(A){this.mh=A}}Object(h.a)(An,"IntentRangeEditor",null,[744]);class Io{constructor(){this.Ea=null}get name(){return"Box4.Intent"}Xb(A){this.Ea=A;this.Ea.register(An,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").na().oa(()=>new An(this.Ea.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Ea.resolve("Box4.IProofingManager")}dispose(){}static main(){Za.a.instance.Ac(new Io)}}Object(h.a)(Io,"PackageManager",null,[2,3]);
var pk=d(1209),Sn=d(1157),ej=d(301),qk=d(1158),$k=d(947),qj=d(813);class kh{}kh.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");kh.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");kh.KYl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
kh.Bri=["en-US","en-CA","en-GB","en-AU","en-IN"];kh.Cri="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");kh.KUi="en-US";kh.nXi="btnStartDictation";kh.yXi="btnDictationFloatieToggle";kh.sXi="Dictation";kh.zXi="DictationFloatieToggle";kh.uVf="Insertaudio_32x32x32";kh.tVf=
"Insertaudio_16x16x32";kh.rXi="JotInsertAudioRecordingShort_32x32x32";kh.qXi="JotInsertAudioRecordingShort_16x16x32";kh.tEl="speechOn.wav";kh.sEl="speechOff.wav";Object(h.a)(kh,"DictationConstants",null,[]);class lm{constructor(A){this.inf=A;this.oOa=(A=Xe.a.He(A))?A.displayName:this.inf;this.SG=A?A.LCID:lm.vbk}get f5c(){return this.inf}get displayName(){return this.oOa}get LCID(){return this.SG}}lm.vbk=1033;Object(h.a)(lm,"DictationLanguage",null,[]);class xk{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc){this.KDc=
null;this.ojf=!1;this.$ba=null;this.tsb=!1;this.Pnd=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;oe&&(ld=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.Rp,this.$ba?oe[ld?Ud.a.On:Sn.a.On]=this.$ba.isVisible():(Bd=this.U2.aJ(),Bd=(wd=2===Bd)||1===Bd,ld?(oe[Ud.a.On]=Bd,oe[ej.a.IconSet]=wd?(new qk.a("JotInsertAudioRecordingShort_20")).iconSet:L.AFrameworkApplication.Aa.mb.lza?(new qk.a("InsertAudio_32")).iconSet:(new qk.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(oe[Sn.a.On]=Bd,wd?
(oe[Sn.a.Image32by32Class]=Oi.getImageClass(kh.rXi),oe[Sn.a.Image16by16Class]=Oi.getImageClass(kh.qXi)):(oe[Sn.a.Image32by32Class]=Oi.getImageClass(kh.uVf),oe[Sn.a.Image16by16Class]=Oi.getImageClass(kh.tVf)))));return 32};this.Iwc=(ld,wd,Bd,de,oe)=>{if(2===Bd){if(!this.$ba||(null===oe||void 0===oe?0:oe.sVf))return this.t7d(oe);this.DLh()}return 32};this.Uxd=(ld,wd,Bd)=>2!==Bd?32:this.t7d(void 0);this.dpc=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;this.UTk(oe,ld===re.a.Fih);return 32};this.aUe=(ld,wd,
Bd,de,oe)=>{if(1===Bd)return 32;oe&&((ld=oe.MenuItemId)&&ld===this.wg.uT?(oe[Ud.a.On]=!0,this.KDc=oe.SourceControlId):oe[Ud.a.On]=!1);return 32};this.rTe=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;oe&&(oe[$k.a.Value]=(new lm(this.wg.uT)).displayName);return 32};this.w0e=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;oe&&(ld=oe.SourceControlId,this.KDc!==ld&&(this.wg.uT=oe.MenuItemId,this.tQh(this.KDc),this.tQh(ld),this.KDc=ld,2===this.U2.aJ()&&this.vV()));return 32};this.x0e=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;
if(oe){ld=oe.MenuItemId;if(this.wg.uT!==ld){this.wg.uT=ld;if(this.$ba)this.$ba.onDictationLanguageChanged(ld);2===this.U2.aJ()&&this.vV()}this.P$e()}return 32};this.showHelpPane=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;ld=this.VWh.value;if(!ld)return 0;oe&&(oe={},oe.query="AssetID="+(this.wg.pWl?xk.q1h:xk.gHd),oe=Object.assign(new pk.a,{nonPersistedSettings:oe}),ld.Sga(xk.fHd,oe));return 32};this.tLl=(ld,wd,Bd,de,oe)=>{if(1===Bd)return this.wg.Rne?32:8;oe&&this.wg&&(this.wg.useAutoPunctuation=oe[Ud.a.On]);
2===this.U2.aJ()&&this.vV();this.P$e();return 32};this.FLl=(ld,wd,Bd,de,oe)=>{if(1===Bd)return this.wg.hse?32:8;oe&&this.wg&&(this.wg.LRb=oe[Ud.a.On]);2===this.U2.aJ()&&(this.U2.vV(),this.qRb());this.RPh();return 32};this.m0k=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;oe&&this.wg&&(oe[Ud.a.On]=this.wg.useAutoPunctuation);return 32};this.n0k=(ld,wd,Bd,de,oe)=>{if(1===Bd)return 32;oe&&this.wg&&(oe[Ud.a.On]=this.wg.LRb);return 32};this.HGk=(ld,wd,Bd)=>{2===Bd&&this.ZRc();return 32};this.kKk=(ld,wd,Bd)=>
{2===Bd&&this.wg.VL&&2===this.U2.aJ()&&this.vV();return 32};this.iHk=(ld,wd,Bd)=>{2===Bd&&this.wg.VL&&this.ZRc();return 32};this.eJb=(ld,wd,Bd)=>{2===Bd&&(this.wg.VL?this.ZRc():this.vV());return 32};this.kHk=(ld,wd,Bd)=>{2===Bd&&this.vV();return 32};this.KGk=(ld,wd,Bd)=>{2===Bd&&this.qRb();return 32};this.LGk=(ld,wd,Bd)=>{2===Bd&&(this.U2.vV(),this.qRb());return 32};this.JGk=(ld,wd,Bd,de,oe)=>{2===Bd&&oe&&(ld=Xe.a.He(this.wg.uT),this.Jf.ttc(this.VP.Es(oe),ld.LCID,oe.Lb));return 32};this.IGk=(ld,wd,
Bd)=>{2===Bd&&this.vV();return 32};this.NGk=(ld,wd,Bd)=>{2===Bd&&this.vV();return 32};this.MGk=(ld,wd,Bd)=>2===Bd&&this.wg&&this.wg.rZj?this.wg.VL&&this.$ba&&!this.$ba.isVisible()?(this.DLh(),32):this.t7d(void 0):32;this.Ca=A;this.WZ=kc.App.C2a;this.QAc=kc.App.J_;this.U2=oa;this.vGc=W;this.Jf=xa;this.VP=Ia;this.wg=Hb;this.Pd=Jc;this.wg.VL&&(this.$ba=qb);this.VWh=hc}vb(){this.Ca.ra(re.a.dpc,Nc.a.view,this.dpc,96);this.Ca.ra(re.a.w0e,Nc.a.view,this.w0e,1028);this.Ca.ra(re.a.aUe,Nc.a.view,this.aUe,96);
this.Ca.ra(re.a.Iwc,Nc.a.view,this.Iwc,1028);this.Ca.ra(re.a.Pnd,Nc.a.view,this.Pnd,96);this.Ca.ra(re.a.pVf,Nc.a.view,this.eJb,64);this.Ca.ra(re.a.vVf,Nc.a.view,this.eJb,64);this.Ca.ra(re.a.yVf,Nc.a.view,this.KGk,64);this.Ca.ra(re.a.zVf,Nc.a.view,this.LGk,64);this.Ca.ra(re.a.wVf,Nc.a.view,this.JGk,64);this.Ca.ra(re.a.rVf,Nc.a.view,this.IGk,64);this.Ca.ra(re.a.BVf,Nc.a.view,this.kHk,64);this.Ca.ra(re.a.xVf,Nc.a.view,this.NGk,64);this.Ca.ra(re.a.Fih,Nc.a.view,this.dpc,96);this.Ca.ra(re.a.x0e,Nc.a.view,
this.x0e,1028);this.Ca.ra(re.a.rTe,Nc.a.view,this.rTe,96);this.Ca.ra(re.a.uXi,Nc.a.view,this.showHelpPane,96);this.Ca.ra(re.a.vXi,Nc.a.view,this.showHelpPane,96);this.Ca.ra(re.a.tXi,Nc.a.view,this.tLl,96);this.Ca.ra(re.a.c_k,Nc.a.view,this.m0k,96);this.Ca.ra(re.a.wXi,Nc.a.view,this.FLl,96);this.Ca.ra(re.a.d_k,Nc.a.view,this.n0k,96);this.Ca.ra(re.a.Uxd,Nc.a.view,this.Uxd,1028);this.Ca.ra(re.a.qVf,Nc.a.view,this.HGk,1028);this.Ca.ra(re.a.pXi,Nc.a.view,this.kKk,96);this.Ca.ra(re.a.oXi,Nc.a.view,this.iHk,
96);const A=Qb.KeyInputManager.Va(ud.a.oSh,1);this.Pd.Ic(od.AFrame.$i).bindAction(A,re.a.AVf);this.Ca.ra(re.a.AVf,Nc.a.view,this.MGk,1028)}TVc(){return L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.Rp?this.wg.VL?kh.zXi:kh.sXi:this.wg.VL?kh.yXi:kh.nXi}xei(){const A=Object.assign(new Aa.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),W=Object.assign(new vc.a,{Id:"DictationLanguageList_"+this.TVc(),ExternalId:"DictationLanguageList_"+
this.TVc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.TVc(),QueryCommand:"2417470717",Image16by16Class:Oi.getImageClass(kh.tVf),Image32by32Class:Oi.getImageClass(kh.uVf),Visible:!0,AriaLabel:Ib.a.tqi});Array.add(A.ControlList,W);return A}UTk(A,W){A.MenuItems=Object.assign(new Kg.a,{Id:W?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!W){var oa=this.xei();Array.add(A.MenuItems.MenuSectionList,oa)}oa=
this.wg.jlh;0<oa.length&&(oa=xk.pPc(oa,"dictationProdcutionLanguages","",W),Array.add(A.MenuItems.MenuSectionList,oa));oa=this.wg.ikh;0<oa.length&&(W=xk.pPc(oa,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,W),Array.add(A.MenuItems.MenuSectionList,W));A.PopulationXML=cb.l(A.MenuItems);this.ojf=!0}qRb(){const A=this.vGc.value;if(A){const W=this.TVc();if(L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.Rp){const oa={};oa[W]=this.wg.VL?"ToggleButtonModel":"SplitButtonModel";
this.ojf&&!this.wg.VL&&(oa["DictationLanguageList_"+W]="ToggleButtonModel");A.oRb(oa)}this.P$e();this.RPh()}}P$e(){if(this.wg.VL){const A=this.vGc.value;L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.Rp&&A.oRb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}RPh(){if(this.wg.VL){const A=this.vGc.value;L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.Rp&&A.oRb({DictationSettingsVoiceCommands:"CheckboxModel"})}}tQh(A){const W=this.vGc.value;if(W&&L.AFrameworkApplication.Aa&&
L.AFrameworkApplication.Aa.mb.Rp){const oa={};oa[A]="ToggleButtonModel";W.oRb(oa)}}DLh(){this.tsb||(this.tsb=!0,this.$ba.isVisible()?(this.ZRc(),this.tsb=!1):this.showFloatie(),this.qRb())}showFloatie(){this.$ba.showFloatie((new lm(this.wg.uT)).displayName).then(()=>{0===this.U2.aJ()&&this.U2.rmb(void 0).then(()=>{this.tsb=!1}).catch(A=>{this.tsb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",A)});this.wg.lbc&&this.WZ&&this.WZ.qFl();this.QAc&&this.QAc.startSession()}).catch(()=>
{this.tsb=!1})}t7d(A){const W=this.U2.aJ();if(1===W||3===W)return 1;0===W?this.rmb(null===A||void 0===A?void 0:A.sVf):this.vV();return 32}ZRc(){const A=this.U2.aJ();1!==A&&(this.$ba&&this.$ba.hideFloatie(),this.WZ&&this.WZ.gGl(),0!==A&&this.vV(),this.QAc&&this.QAc.endSession(),this.qRb())}vV(){this.U2.vV();this.qRb()}rmb(A){this.U2.rmb(A).then(()=>{}).catch(W=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",W)})}static createInstance(A,W,oa,xa,Ia,qb,Hb,hc){return xk.La||(xk.La=
new xk(L.AFrameworkApplication.Qa,A,W,oa,xa,Ia,qb,Hb,hc))}static pPc(A,W,oa,xa){oa=Object.assign(new Aa.a,{DisplayMode:"Menu",Title:oa,Id:W,ControlsId:"ctr"+W,ControlList:[]});for(const Ia of A){A=W+"_"+Ia.f5c;const qb=Ia.displayName,Hb=Ia.f5c;xa?(A=Object.assign(new qj.a,{Id:A,ExternalId:A,LabelText:qb,Command:"3662249320",MenuItemId:Hb,Visible:!0}),Array.add(oa.ControlList,A)):(A=Object.assign(new vc.a,{Id:A,ExternalId:A,LabelText:qb,Command:"2863762275",MenuItemId:Hb,QueryCommand:"2739750502",
Visible:!0,AriaLabel:Ib.a.Gtb}),Array.add(oa.ControlList,A))}return oa}}xk.La=null;xk.fHd="FA000000012";xk.gHd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";xk.q1h="78766431-0933-4603-abf5-5bcc1dee9dda";Object(h.a)(xk,"DictationActor",null,[730]);var Jo=d(273),xp=d(1155),Um=d(161);class sl{constructor(A,W){this.XZ=null;this.ica=!1;this.hOa=null;this.XZh=A;this.wg=W}isVisible(){return this.ica}f1c(){return this.ica&&!!this.XZ}Q1i(){if(this.XZ)return!0;this.XZ=this.XZh.value;if(!this.XZ)return!1;this.XZ.y2l(re.a.Uxd);
this.XZ.s2l(re.a.qVf);zd.a.addHandler(window.self,sc.a.resize,()=>{this.lKj()});const A=cc.FocusManager.instance().Ic(Um.AppFrame.w9a);A.n8(W=>{this.X9i(W)});A.vCa((W,oa)=>{this.W9i(oa)});A.zJ=!0;A.MYe=!0;Jo.a.instance.r3(Um.AppFrame.w9a,!0);Jo.a.instance.Eo(Um.AppFrame.w9a);return!0}X9i(A){this.f1c()&&A.name!==od.AFrame.qP&&this.XZ.focus()}W9i(A){this.f1c()&&A.name!==od.AFrame.qP&&this.XZ.blur()}showFloatie(A){return this.ica?Promise.resolve(null):this.Q1i()?new Promise((W,oa)=>{this.XZ.q1l().then(()=>
{this.XZ.showDictationFloatie(this.vyb(),!1,A,this.wg.useAutoPunctuation);this.hOa=A;this.ica=!0;Jo.a.instance.hL(Um.AppFrame.w9a);W(null)}).catch(()=>{oa("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.f1c()&&(this.XZ.dismissDictationFloatie(),Jo.a.instance.Eo(Um.AppFrame.w9a),this.ica=!1)}showDictationWarning(A){this.f1c()&&this.XZ.showDictationWarning(A)}onDictationLanguageChanged(A){this.hOa=A}vyb(){var A=kc.App.Mb.D9a.getBoundingClientRect();
const W=A.left+A.width/2-44;A=A.top+A.height-70;return Object.assign(new xp.a,{x:W,y:A})}lKj(){this.ica&&this.XZ&&(this.XZ.dismissDictationFloatie(),this.XZ.showDictationFloatie(this.vyb(),!1,this.hOa,this.wg.useAutoPunctuation))}}Object(h.a)(sl,"DictationFloatieManager",null,[]);class Wd{constructor(){this.wia=this.rBa=0;this.pBc=null;this.lca=!0;this.Hyc="";this.wg=this.Kh=null;this.sBa=this.sca=this.DOa=this.St=this.Nj=0;this.xFd=this.PZ="";this.mYb=this.uTb=0;this.TFd=this.kGd=this.jGd=!1;this.gQd=
"";this.VXb=this.XUb=this.ki=this.T2=null;this.hEd=this.lEc=this.kEc=this.JRd=this.zwf=this.R6a=this.P6a=0}set yJi(A){this.PZ=A}get Zya(){return kc.App.J_?kc.App.J_.Zya:""}get P2a(){return kc.App.J_?kc.App.J_.P2a:""}set P2a(A){kc.App.J_&&(kc.App.J_.P2a=A)}onFragment(A){this.DOa||(this.DOa=(new Date).getTime());this.XUb&&(this.XUb.stop(),this.P6a+=this.XUb.er,this.XUb.start());this.rBa++;this.sBa+=A.split(" ").length}onFinalPhrase(A){this.DOa||(this.DOa=(new Date).getTime());this.VXb&&(this.VXb.stop(),
this.R6a+=this.VXb.er,this.VXb.start());this.sBa=0;this.wia++;this.sca+=A.split(" ").length}onConnectionStarted(A){this.uTb=(new Date).getTime();this.yJi=A;this.ki&&(this.XUb=this.ki.Ii("WebServiceCall","FragmentResponse"),this.VXb=this.ki.Ii("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.mYb=(new Date).getTime()}onMicrophoneError(A){this.onCustomError("MicrophoneError",A)}onCustomError(A,W=null){this.lca=!1;this.pBc=A;this.setEndReason(W||A)}setEndReason(A){this.xFd=A}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(A,
W){this.hEd=W;A?(this.JRd+=W,W>this.lEc&&(this.lEc=W)):(this.zwf=W,W>this.kEc&&(this.kEc=W))}onFocusLost(){this.jGd=!0}onFocusLostWhileStarting(){this.kGd=!0}onFailedToStartTurn(){this.TFd=!0}onSpeechSessionStarted(A){this.gQd=A}setDictationLatency(A){this.T2=A}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(h.a)(Wd,"AbstractDictationSessionTelemetry",null,[812]);class Bh{}Bh.seen="Seen";Bh.tried="Tried";Bh.kept="Kept";Object(h.a)(Bh,"FunnelStatus",null,[]);class Ce{constructor(){this.dataFields=this.name=null}}Object(h.a)(Ce,"Contract",null,[]);class rd extends Wd{constructor(A,W){super();this.eff=this.dff=this.xdf=!1;this.aLd=this.WKd=this.aOd=0;this.kLd=this.jLd=2147483647;this.IRd=this.GRd=0;this.wg=A;this.Nj=(new Date).getTime();this.ki=W;this.P2a=aa.a.create().toString();this.Kh=new th.a;
this.Kh.dataFields=[];this.Hyc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(A,W,oa){A=A+this.hEd-(this.aOd+(W+oa)/1E4);this.GRd+=A;this.WKd<A&&(this.WKd=A);this.jLd>A&&(this.jLd=A)}onPartialResultAnnotationResponse(A,W,oa){A=A+this.hEd-(this.aOd+(W+oa)/1E4);this.IRd+=A;this.aLd<A&&(this.aLd=A);this.kLd>A&&(this.kLd=A)}setRecordingStartTime(A){this.aOd=A}onCommandCalled(){this.dff=!0}onAugloopError(A){this.lca=!1;this.xdf=!0;this.pBc=A}onCommandError(){this.eff=!0}endActivity(){this.sca+=
this.sBa;this.St=(new Date).getTime();this.Kh.succeeded=this.lca;this.Kh.durationMs=this.St-this.Nj;Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"Success",bool:this.lca}));this.lca||Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"error",string:this.pBc}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"SessionID",string:this.Zya}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"SpeechSessionID",string:this.gQd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,
{name:"TurnID",string:this.P2a}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"NumberOfWords",int64:0<this.sBa?this.sBa+this.sca:this.sca}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"NumberOfFragments",int64:this.rBa}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"NumberOfFinalPhrases",int64:this.wia}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"Language",string:this.wg.uT}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"connectionID",
string:this.PZ}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"IsUsingFloatie",bool:this.wg.VL}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"UseAutoPunctuation",bool:this.wg.useAutoPunctuation}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"EndReason",string:this.xFd}));this.DOa&&Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TimeToGetFirstResult",int64:this.DOa-
this.uTb}));this.lca&&(Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TimeToStartRecording",int64:this.mYb-this.Nj})),Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TimeToOpenConnection",int64:this.uTb-this.mYb})));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"FocusLost",bool:this.jGd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"FocusLostWhileStarting",bool:this.kGd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"FailedToStartTurn",
bool:this.TFd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MaxTimeToInsertFragment",int64:this.kEc}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MaxTimeToInsertPhrase",int64:this.lEc}));var A=Bh.seen;this.lca&&0<this.sca&&(A=0<this.wia?Bh.kept:Bh.tried);Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"DictationFunnel",contract:Object.assign(new Ce,{name:"Office.System.Funnel",dataFields:[Object.assign(new md.a,{name:"Name",string:"Dictation"}),Object.assign(new md.a,
{name:"State",string:A})]})}));this.Kh.name=this.Hyc;this.Kh.samplingPolicy=2;Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"AugloopFailed",bool:this.xdf}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"CommandsUsed",bool:this.dff}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"CommandsFailed",bool:this.eff}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.WKd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.jLd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.aLd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.kLd}));A=0<this.wia?this.GRd/this.wia:0;const W=0<this.rBa?this.IRd/this.rBa:0;Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"AverageFinalResultUserPerceivedLatency",double:A}));Array.add(this.Kh.dataFields,
Object.assign(new md.a,{name:"AveragePartialResultUserPerceivedLatency",double:W}));De.a.sendActivityEvent(this.Kh)}}Object(h.a)(rd,"AugloopDictationTelemetry",Wd,[]);var Gi=d(221);class cd{constructor(A){this.t7=A}play(){this.t7.play()}pause(){this.t7.pause()}get paused(){return this.t7.paused}get currentTime(){return this.t7.currentTime}set currentTime(A){this.t7.currentTime=A}get duration(){return this.t7.duration}get error(){const A=this.t7.error;return A?A.code:0}get readyState(){return this.t7.readyState}get src(){return this.t7.getAttribute("src")}set src(A){this.t7.setAttribute("src",
A)}get preload(){return this.t7.getAttribute("preload")}set preload(A){this.t7.setAttribute("preload",A)}get Yf(){return this.t7}}Object(h.a)(cd,"AudioElement",null,[]);class vg{constructor(){this.bMd=this.aMd=this.R6a=this.P6a=this.VEd=0}onAudioData(){this.VEd||(this.VEd=(new Date).getTime())}onFragment(A){this.P6a+=this.Eeg(A);this.aMd++}mKk(A){this.R6a+=this.Eeg(A);this.bMd++}g6f(){return this.bMd?this.R6a/this.bMd:0}fej(){return this.aMd?this.P6a/this.aMd:this.g6f()}Eeg(A){if(!A)return 0;const W=
(new Date).getTime();let oa=null;return({Su:oa}=C.d(A)).returnValue?W-this.VEd-(oa.Offset+oa.Duration)/1E4:0}}Object(h.a)(vg,"DictationLatency",null,[]);class yg{constructor(A,W){this.E7=0;this.eQd=this.fQd=null;this.iWb=!1;this.rEc=null;this.WCc=!1;this.T2=this.dr=null;this.NG=W;this.dca=A}onFinalText(A,W){if(2===this.E7){var oa=A.size;if(1!==oa&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",oa),!oa))return;W=W.get("JsonResult");this.T2&&this.T2.mKk(W);this.NG.onFinalPhrase(A.values().next().value,
W)}}onFragmentText(A,W){if(2===this.E7){var oa=A.size;if(1!==oa&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",oa),!oa))return;W=W.get("JsonResult");if(this.T2)this.T2.onFragment(W);this.NG.onFragment(A.values().next().value)}}onError(A){if(0!==this.E7&&3!==this.E7&&"ErrorNone"!==A){this.E7=3;switch(A){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.NG.jEk(A);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.NG.fGk(A);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.NG.UM(A);break;case "ErrorInitialSilenceTimeout":this.NG.vIk(A);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.NG.onMicrophoneError(A);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.NG.HNe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.NG.HNe("NotFoundError");break;case "ErrorAudioNotReadableError":this.NG.HNe("NotReadableError");break;default:this.NG.jNk(A)}this.E7=0}}onSpeechRecognitionStarted(A){window.self.document.hasFocus()?(this.E7=2,this.iWb=!1,this.NG.onRecordingStarted(),this.NG.onConnectionStarted(A),this.fQd||
(this.fQd=Object.assign(new cd(document.createElement("audio")),{src:Gi.a.box4Image(kh.tEl)})),this.fQd.play()):(this.v$e(),this.NG.onFocusLost())}onSpeechEnd(){this.v$e();0!==this.aJ()&&(this.E7=3,this.NG.SKk(),this.E7=0,this.eQd||(this.eQd=Object.assign(new cd(document.createElement("audio")),{src:Gi.a.box4Image(kh.sEl)})),this.eQd.play())}onAudioData(A){if(this.T2)this.T2.onAudioData();if(this.dca){var W=0;for(const oa of A)W+=Math.pow(oa,2);A=Math.sqrt(W/A.length)>yg.gEl;!this.iWb&&A?(this.iWb=
!0,this.rEc=null):this.iWb&&!A&&(this.rEc?(new Date).getTime()>=this.rEc+yg.oAk&&(this.iWb=!1):this.rEc=(new Date).getTime())}}onSpeechSessionStarted(A){this.NG.onSpeechSessionStarted(A)}onEventUpdate(A){if(this.dca&&"QualityStatusUpdate"===A.eventName)switch(A.shortCode){case 13:case 2:this.dca.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.dca.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.dca.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}i2a(A,
W){this.NG.gEa(!1);this.NG.Yx=A;this.NG.kog=W;this.L7k();this.dr=A;this.E7=1;this.T2=new vg;this.dr&&this.dr.setDictationLatency(this.T2)}aJ(){return this.E7}L7k(){this.WCc||(zd.a.addHandler(window.self,sc.a.blur,Object(n.a)(this,this.bbh,"onFocusLostEventHandler")),this.WCc=!0)}v$e(){this.WCc&&(zd.a.removeHandler(window.self,sc.a.blur,Object(n.a)(this,this.bbh,"onFocusLostEventHandler")),this.WCc=!1)}bbh(){if(1===this.E7){if(this.dr)this.dr.onFocusLostWhileStarting()}else 2===this.E7&&(this.v$e(),
this.NG.onFocusLost())}}yg.gEl=350;yg.oAk=350;Object(h.a)(yg,"FrontdoorSpeechClientObserver",null,[813]);class Bn extends yg{constructor(A,W){super(A,W);this.FOa=new yg(A,W)}onFinalText(A,W){this.FOa.onFinalText(A,W)}onFragmentText(A,W){this.FOa.onFragmentText(A,W)}onError(A){this.FOa.onError(A)}onSpeechRecognitionStarted(A){this.FOa.onSpeechRecognitionStarted(A)}onSpeechEnd(){this.FOa.onSpeechEnd()}onAudioData(A){this.FOa.onAudioData(A)}i2a(A,W){this.FOa.i2a(A,W)}aJ(){return this.FOa.aJ()}}Object(h.a)(Bn,
"AugloopFrontdoorSpeechObserverAbstractDecorator",yg,[]);class yp extends Bn{constructor(A,W,oa){super(A,W);this.Uc=oa}onFinalText(A,W){super.onFinalText(A,W)}onFragmentText(A,W){if(this.ere())super.onFragmentText(A,W)}onError(A){super.onError(A)}onSpeechRecognitionStarted(A=null){const W=aa.a.create().toString();super.onSpeechRecognitionStarted(A?A:W)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(A){super.onAudioData(A)}i2a(A,W){super.i2a(A,W)}aJ(){return super.aJ()}ere(){const A=this.Uc.Pa.nb.Ua;
return A.Lb!==A.Ra?!1:!0}}Object(h.a)(yp,"AugloopFrontdoorSpeechObserverDecorator",Bn,[]);class cm{constructor(A){this.Axf=A}onVoiceCommand(A){this.Axf.onVoiceCommand(A)}setDictationSessionTelemetry(A){this.Axf.setDictationSessionTelemetry(A)}}Object(h.a)(cm,"AugloopVoiceCommandObserverAbstractDecorator",null,[867]);class Zo extends cm{constructor(A,W,oa){super(A);this.P2=W;this.Uc=oa}onVoiceCommand(A){this.ere()&&this.P2.N2l();super.onVoiceCommand(A)}setDictationSessionTelemetry(A){super.setDictationSessionTelemetry(A)}ere(){const A=
this.Uc.Pa.nb.Ua;return A.Lb!==A.Ra?!1:!0}}Object(h.a)(Zo,"AugloopVoiceCommandObserverDecorator",cm,[]);class Hi{constructor(A){this.wg=A}hyg(A){const W=L.AFrameworkApplication.Je;if(W){var oa=this.wg.M4f;oa&&""!==oa&&W.qj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",oa),2,A,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(h.a)(Hi,"FrontdoorCorrectionsTelemetryLogger",null,[814]);class rk{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(h.a)(rk,"SpeechDictationSettings",null,[]);class Hk{constructor(A,W,oa,xa){this.UEd=this.fz=null;this.P2=A;this.dca=W;this.NG=oa;this.Uob=xa;this.initializeCommandsDictionary()}onVoiceCommand(A){if(this.UEd)this.UEd.onCommandCalled();var W=4;if(({value:W}=this.fz.vg(A.commandId,0)).returnValue&&4!==W){let oa=null;A.commandValue&&(oa=new r.a(m.a.Gk()),oa.add("commandValue",A.commandValue));this.NG.gEa(!1);W=this.P2.executeCommand(W,oa);if(A.offset&&
A.duration)this.Uob.onCommandFinished(A.commandId,W,A.offset,A.duration)}}setDictationSessionTelemetry(A){this.UEd=A}initializeCommandsDictionary(){this.fz=new r.a(m.a.Gk());this.fz.add("Word.Editing.Undo",2);this.fz.add("Word.Editing.Bold",5);this.fz.add("Word.Editing.Italics",6);this.fz.add("Word.Editing.Underline",10);this.fz.add("Word.Editing.StrikeThrough",20);this.fz.add("Word.Editing.Subscript",19);this.fz.add("Word.Editing.Superscript",18);this.fz.add("Word.Editing.RemoveBold",11);this.fz.add("Word.Editing.RemoveUnderline",
13);this.fz.add("Word.Editing.RemoveItalics",12);this.fz.add("Word.Editing.RemoveStrikeThrough",21);this.fz.add("Word.Editing.RemoveSubscript",22);this.fz.add("Word.Editing.RemoveSuperscript",24);this.fz.add("Word.Editing.Paste",7);this.fz.add("Word.Editing.InsertTable",8);this.fz.add("Word.Editing.InsertComment",9);this.fz.add("Word.Editing.InsertBullet",23);this.fz.add("Word.Editing.FullJustify",14);this.fz.add("Word.Editing.CenterJustify",15);this.fz.add("Word.Editing.LeftJustify",16);this.fz.add("Word.Editing.RightJustify",
17);this.fz.add("Command.Exit",1);this.fz.add("Command.Pause",0);this.fz.add("Command.ShowHelp",26);this.fz.add("Command.ShowCommand",27);this.fz.add("Word.Editing.RemoveFormatting",28)}}Object(h.a)(Hk,"VoiceCommandObserver",null,[867]);var dm=d(1002);class Ko{constructor(A,W,oa,xa,Ia,qb,Hb){this.dr=this.g_b=null;this.hOj=0;this.Uob=Ia;this.wg=Hb;Ia=new rk;Ia.dictationLanguage=Hb.uT;Ia.useAutoPunctuation=Hb.useAutoPunctuation?"Intelligent":"Explicit";Ia.useCorrections=Hb.lbc.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
Ia;this.e8=new yp(A,qb,xa);this.Bxf=new Zo(new Hk(W,A,qb,this.Uob),W,xa);this.czc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.ddf=Array(oa);this.czc.setAnnotationResultCallback(Object.assign(new dm.a,{handler:hc=>{for(const Jc of this.ddf)Jc.onAnnotationResult(hc)}}));this.pZb=new alVoiceClient.SpeechToTextClient(this.czc,this.e8,Hb.Knb||Hb.aAd,!1);this.Hyf(this.pZb.getAnnotationObserver());this.f_b=new alVoiceClient.VoiceCommandingClient(this.czc,this.Bxf,this.e8);this.Hyf(this.f_b.getAnnotationObserver());
Hb.lbc&&(A=new Hi(Hb),(W=kc.App.C2a)&&W.pph(A))}Tlg(A,W){return new Promise(oa=>{const xa=new rk;xa.dictationLanguage=A;xa.useAutoPunctuation=this.wg.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=xa;this.dr=W;oa(this.yRj())})}rmb(A){if(!this.pZb)return 3;this.g_b.startVoiceSessionFromMicrophoneInput();this.e8.i2a(this.dr,A);A=this.wg.LRb;this.pZb.initializeAsync(A?[1]:[1,0],this.dr);A&&this.VFl();return 0}vV(A){if(A&&this.e8)this.e8.onSpeechEnd();
this.pZb&&this.pZb.uninitializeAsync();this.g_b&&(this.g_b.stopVoiceSession(),this.g_b=null);this.dr=null;this.wg.LRb&&this.tGl()}aJ(){return this.e8.aJ()}yRj(){this.wg.LRb&&this.Bxf.setDictationSessionTelemetry(this.dr);this.g_b=new alVoiceClient.VoiceSession(this.czc,this.e8,this.wg.Knb,this.Uob,this.dr);return 0}VFl(){this.f_b&&this.f_b.initializeAsync(this.dr)}tGl(){this.f_b&&this.f_b.uninitializeAsync()}Hyf(A){this.ddf[this.hOj++]=A}}Object(h.a)(Ko,"AugloopSpeechClientProxy",null,[773]);class Vm extends Wd{constructor(A,
W){super();this.wg=A;this.Nj=(new Date).getTime();this.ki=W;this.P2a=aa.a.create().toString();this.Kh=new th.a;this.Kh.dataFields=[];this.Hyc="Office.Voice.Online.DictationSession"}endActivity(){this.sca+=this.sBa;this.St=(new Date).getTime();this.Kh.succeeded=this.lca;this.Kh.durationMs=this.St-this.Nj;Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"Success",bool:this.lca}));this.lca||Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"error",string:this.pBc}));Array.add(this.Kh.dataFields,
Object.assign(new md.a,{name:"SessionID",string:this.Zya}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"SpeechSessionID",string:this.gQd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TurnID",string:this.P2a}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"NumberOfWords",int64:0<this.sBa?this.sBa+this.sca:this.sca}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"NumberOfFragments",int64:this.rBa}));Array.add(this.Kh.dataFields,Object.assign(new md.a,
{name:"NumberOfFinalPhrases",int64:this.wia}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"Language",string:this.wg.uT}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"connectionID",string:this.PZ}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"IsUsingFloatie",bool:this.wg.VL}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"UseAutoPunctuation",bool:this.wg.useAutoPunctuation}));
Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"EndReason",string:this.xFd}));this.DOa&&Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TimeToGetFirstResult",int64:this.DOa-this.uTb}));this.lca&&(Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TimeToStartRecording",int64:this.mYb-this.Nj})),Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"TimeToOpenConnection",int64:this.uTb-this.mYb})));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"FocusLost",
bool:this.jGd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"FocusLostWhileStarting",bool:this.kGd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"FailedToStartTurn",bool:this.TFd}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"AverageFragmentLatency",double:this.T2?this.T2.fej():0<this.rBa?this.P6a/this.rBa:0}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"AveragePhraseLatency",double:this.T2?this.T2.g6f():0<this.wia?this.R6a/this.wia:0}));
Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"AveragePhraseInsertionLatency",double:0<this.wia?this.JRd/this.wia:0}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"AverageFragmentInsertionLatency",double:0<this.rBa?this.zwf/this.rBa:0}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MaxTimeToInsertFragment",int64:this.kEc}));Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"MaxTimeToInsertPhrase",int64:this.lEc}));let A=Bh.seen;this.lca&&0<this.sca&&
(A=0<this.wia?Bh.kept:Bh.tried);Array.add(this.Kh.dataFields,Object.assign(new md.a,{name:"DictationFunnel",contract:Object.assign(new Ce,{name:"Office.System.Funnel",dataFields:[Object.assign(new md.a,{name:"Name",string:"Dictation"}),Object.assign(new md.a,{name:"State",string:A})]})}));this.Kh.name=this.Hyc;this.Kh.samplingPolicy=2;De.a.sendActivityEvent(this.Kh)}}Object(h.a)(Vm,"DictationSessionTelemetry",Wd,[]);var ln=d(1203);class em{constructor(A,W){this.CPa=A;this.y2h=W}getAccessToken(A){this.y2h&&
this.CPa?this.CPa.mI("OfficeDictation",L.AFrameworkApplication.fa.Ha("DictationResourceID")).then(W=>{W.IsSuccess?A(W.Token):A(em.N5d)}).catch(()=>{A(em.N5d)}):A(em.N5d)}}em.N5d="dictation access token";Object(h.a)(em,"AuthenticationProvider",null,[]);class zp{constructor(A){this.G2h=A;this.iIc=new Hj.a}debugAssertTag(A,W,oa,xa){this.UAd(xa);this.iIc.debugAssertTag(A,W,oa,xa)}debugTraceTag(A,W,oa,xa){this.UAd(xa);this.iIc.debugTraceTag(A,W,oa,xa)}sendTraceTag(A,W,oa,xa){this.UAd(xa);this.iIc.sendTraceTag(A,
W,oa,xa)}shipAssertTag(A,W,oa,xa){this.UAd(xa);this.iIc.shipAssertTag(A,W,oa,xa)}UAd(A){if(this.G2h){const W=window.console;W&&W.log(String.format("FDSpeechService: {0}",A))}}}Object(h.a)(zp,"FrontdoorExternalLogger",null,[193]);class $o{constructor(){this.accessToken=null}}Object(h.a)($o,"IAuthenticationProvider",null,[]);class Fm{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(h.a)(Fm,"ISpeechConfig",null,[]);class Tn{constructor(A,W,oa,xa,Ia){this.dr=this.Xrb=null;this.wQd=!1;this.e8=new yg(oa,xa);this.RV=A;this.wg=W;this.oXh=new em(Ia,W.qZj);this.wg.lbc&&(A=new Hi(W),(W=kc.App.C2a)&&W.pph(A))}Tlg(A,W){return new Promise(oa=>{this.oXh.getAccessToken(xa=>{oa(this.bRj(A,W,xa))})})}bRj(A,W,oa){this.dr=W;A=this.P1d(A);oa=Object.assign(new $o,
{accessToken:oa});W=new zp(this.wg.P1c);this.Xrb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(A,this.e8,oa,null,W);return this.Xrb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}rmb(A){if(!this.Xrb)return 3;this.e8.i2a(this.dr,A);this.Xrb.startSpeechRecognition();return 0}vV(A){if(!this.wQd){this.wQd=!0;if(this.Xrb)try{this.Xrb.stopSpeechRecognition()}catch(W){e.ULS.shipAssertTag(593277727,394,!1,W.message)}if(A&&this.e8)this.e8.onSpeechEnd();
this.dr=null;this.wQd=!1}}aJ(){return this.e8.aJ()}P1d(A){const W=new Fm;W.speechMode="Dictation";W.sourceLanguage=A;(A=this.wg.M4f)&&""!==A&&(W.speechFDBase=String.format("wss://{0}/",A));W.properties=new Map;this.RV&&(W.properties.set("DictationInsertionPointLeft",this.RV.gfe()),W.properties.set("DictationInsertionPointRight",this.RV.oeg()));W.properties.set("Corrections","true");W.properties.set("punctuation",this.wg&&this.wg.useAutoPunctuation?"Intelligent":"Explicit");this.wg.P1c&&W.properties.set("EnableAudioLogging",
this.wg.P1c.toString());switch(ln.a.NVd){case "Word":W.clientApp=1;break;case "PowerPoint":W.clientApp=0;break;case "OneNote":W.clientApp=2}return W}}Object(h.a)(Tn,"FrontdoorSpeechClientProxy",null,[773]);class al{static wzl(){al.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static Uzl(){al.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static iBl(A){al.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
A)}static qCl(){al.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(A,W){al.Ff||(al.Ff=new Ka.StandardDialog,al.Ff.Mr=L.AFrameworkApplication.uea,al.Ff.Ad=0,al.Ff.Le(1,CommonUIStrings.l_DialogClose),al.Ff.zP(A,W,()=>{al.Ff=null}))}}al.Ff=null;Object(h.a)(al,"Dialogs",null,[]);class mn{constructor(A,W,oa,xa,Ia,qb,Hb,hc){this.Nqb=this.ysb=!1;this.Yx=null;this.RV=A;this.kog=W;this.Ca=oa;this.WNa=xa;this.wg=Ia;this.P2=qb;
this.rTb=Hb;this.dca=hc;this.xsf=new T.a;for(A=0;A<mn.wsf.length;A++)this.xsf.add(mn.wsf.charAt(A).toString())}onFinalPhrase(A,W=null){let oa=!0;if(this.Yx)this.Yx.onFinalPhrase(A);if(this.rTb&&this.P2){var xa=this.rTb.O1l(A);if(xa){this.gEa(!1);this.P2.executeCommand(xa.commandId,null);return}}xa=(new Date).getTime();if(1===A.length&&"\n"===A)this.uge("",null),this.F_f();else{let Ia=A.indexOf("\n");for(0<Ia&&Ia!==A.length-1&&(oa=!1);0<=Ia;)this.uge(A.substr(0,Ia),oa?W:null),this.F_f(),A=A.substr(Ia+
1),Ia=A.indexOf("\n"),oa=!1;this.uge(A,oa?W:null)}A=(new Date).getTime();if(this.Yx)this.Yx.onTextInserted(!0,A-xa)}onFragment(A){if(this.ysb)var W=this.wYc(A);else{if(!this.mvc())return;W=this.Nqb?this.wYc(A):A}if(this.Yx)this.Yx.onFragment(A);A=!0;const oa=(new Date).getTime();this.RV&&!this.RV.tDf(W)&&(this.Ugg(),A=!1);W=(new Date).getTime();if(this.Yx)this.Yx.onTextInserted(!1,W-oa);A&&this.P2&&this.P2.H1l()}onRecordingStarted(){this.Ca.processAction(re.a.yVf,2);if(this.Yx)this.Yx.onRecordingStarted()}onMicrophoneError(A=
""){this.nhg(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,A)}eJb(A){if(this.Yx)this.Yx.onCustomError(A);this.Ca.Ja(re.a.pVf,2,A)}jEk(A){this.eJb(A);al.wzl()}fGk(A){this.eJb(A);al.Uzl()}jNk(A){this.eJb(A);al.qCl()}UM(A){this.Yx&&this.Yx.setEndReason(A);this.Ca.Ja(re.a.xVf,2,A)}vIk(A){this.UM(A);this.UBl()}SKk(){this.gEa(!1);this.Ca.processAction(re.a.zVf,2)}onConnectionStarted(A){if(this.Yx)this.Yx.onConnectionStarted(A)}HNe(A){this.nhg(this.Goj(A),A)}onFocusLost(){if(this.Yx)this.Yx.onFocusLost();
this.Ca.processAction(re.a.rVf,2)}G7j(A){return this.kog&&!ub.a.jse(A)&&!this.xsf.contains(A.toString())}wYc(A){return 0<A.length&&this.G7j(A.charAt(0))?" "+A:A}mvc(){if(this.ysb)return!0;if(this.RV){const A=this.RV.gfe();this.Nqb=!1;A&&0<A.length&&(this.Nqb=!ub.a.jse(A.charAt(A.length-1))&&!A.endsWith("\u201c"));return this.ysb=this.RV.mvc()}if(this.Yx)this.Yx.onFailedToStartTurn();this.P2&&this.P2.J1l();return!1}gEa(A){this.Nqb=this.ysb=!1;this.RV&&(A&&this.RV.K6g(),this.RV.gEa())}onSpeechSessionStarted(A){if(this.Yx)this.Yx.onSpeechSessionStarted(A);
this.wg.P1c&&this.C3e(A)}nhg(A,W=""){if(this.Yx)this.Yx.onMicrophoneError(W);this.Ca.processAction(re.a.vVf,2);al.iBl(A)}Goj(A){A=A.trimStart();return A.startsWith("NotAllowedError")||A.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:A.startsWith("NotFoundError")||A.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:A.startsWith("NotReadableError")||A.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}UBl(){this.WNa&&this.WNa.execute(A=>{A.iAl()})}C3e(A){this.WNa&&this.WNa.execute(W=>{W.C3e(String.format("ServiceSessionID:{0} ClientSessionId: {1}",A,this.NEi))})}uge(A,W){if(this.ysb||this.mvc()){if(this.RV){const oa=this.Nqb?this.wYc(A):A;(this.wg.lbc&&Object(Oh.a)(772,this.RV)?this.RV.s1l(oa,W,0<A.length&&A.charAt(0)!==oa.charAt(0)):this.RV.zmg(this.Nqb?this.wYc(A):A))||this.Ugg()}this.gEa(!0)}}Ugg(){if(this.Yx)this.Yx.onTextInsertionError();
this.Ca.processAction(re.a.BVf,2)}F_f(){this.Ca.processAction(re.a.$B,2)}get NEi(){return kc.App.J_?kc.App.J_.Zya:""}}mn.wsf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(h.a)(mn,"SpeechClientObserverController",null,[]);class Un{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd){this.UBa=null;this.dQd=new Map;this.rTb=this.P2=this.dca=this.dr=null;this.xI=A;this.YZh=W;this.Uc=oa;this.WNa=xa;this.ki=Ia;this.wg=qb;this.CPa=wd;this.Quf=Bd;this.wg.VL&&(this.dca=Hb);if(this.wg.Ipg||
this.wg.Knb)this.P2=hc;this.wg.Ipg&&(this.rTb=Jc);this.Uob=ld}rmb(A){this.WNa&&this.WNa.execute(xa=>{xa.nMj()});const W=this.YZh.value,oa=null!==A&&void 0!==A?A:"Box4.Dictation.IDictationHost";return new Promise((xa,Ia)=>{this.dQd.has(oa)?(this.UBa=this.dQd.get(oa),this.Q_f(xa,Ia)):this.odk().then(()=>{if(W){const qb=W.NNi(oa);this.UBa=this.cSi(qb);this.dQd.set(oa,this.UBa);this.Q_f(xa,Ia)}else Ia(4)}).catch(()=>{Ia(2)})})}Q_f(A,W){this.i2a().then(oa=>{0===oa?A(0):W(oa)}).catch(oa=>{W(oa)})}i2a(){return new Promise((A,
W)=>{this.dr=new Vm(this.wg,this.ki);if(this.wg.aAd||this.wg.Knb)this.dr=new rd(this.wg,this.ki);this.UBa.Tlg(this.wg.uT,this.dr).then(oa=>{0!==oa?A(oa):A(this.UBa.rmb(this.yvg()))}).catch(oa=>{W(oa)})})}odk(){return this.wg.aAd||this.wg.Knb?this.Hxg("alVoiceClient",!0):this.Hxg("PPTSpeechClient")}Hxg(A,W=!1){return!W&&this.Quf&&L.AFrameworkApplication.Aa.mb.hqg?(W=L.AFrameworkApplication.Ji(A,2),df.a(this.Quf.TCb(W))):this.xI?this.xI.loadScript(A):new Promise((oa,xa)=>{xa("Unable to load speech client "+
A)})}vV(A=!0){0!==this.aJ()&&(this.UBa&&this.UBa.vV(A),this.dr&&(this.dr.endActivity(),this.dr=null))}aJ(){return this.UBa?this.UBa.aJ():0}yvg(){return"zh-CN"!==this.wg.uT&&"ja-JP"!==this.wg.uT}cSi(A){const W=new mn(A,this.yvg(),L.AFrameworkApplication.Qa,this.WNa,this.wg,this.P2,this.rTb,this.dca);return this.wg.aAd||this.wg.Knb?new Ko(this.dca,this.P2,2,this.Uc,this.Uob,W,this.wg):new Tn(A,this.wg,this.dca,W,this.CPa)}}Object(h.a)(Un,"DictationManager",null,[]);class ap{constructor(){this.Mrf=[];
this.P2a=this.vPd=""}startSession(){this.vPd=aa.a.create().toString();this.Mrf=[]}endSession(){this.vPd=""}get Zya(){return this.vPd}get Yhh(){return this.Mrf}}Object(h.a)(ap,"DictationSessionInfo",null,[664]);class ko{constructor(A,W,oa){this.iSd=this.d_b=this.gSd=this.c_b=!1;this.hOa="";this.Ma=A?A:L.AFrameworkApplication.fa;this.l5a=W;this.Uc=oa}get useAutoPunctuation(){if(!this.VL||!this.Rne)return!1;if(this.gSd)return this.c_b;const A=wa.a.instance.getItem("WACDictationFUseAutoPunctuation");
this.c_b=void 0===A||null===A?this.Ma.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(kh.Bri,this.uT):!1:Boolean.parse(A);this.gSd=!0;return this.c_b}set useAutoPunctuation(A){this.VL&&this.Rne&&(this.c_b=A,this.gSd=!0,wa.a.instance.setItem("WACDictationFUseAutoPunctuation",this.c_b.toString()))}get LRb(){if(!this.VL||!this.hse)return!1;if(this.iSd)return this.d_b;const A=wa.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.d_b=void 0===A||null===A?!0:Boolean.parse(A);
this.iSd=!0;return this.d_b}set LRb(A){this.VL&&this.hse&&(this.d_b=A,this.iSd=!0,wa.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.d_b.toString()))}get Rne(){return Array.contains(kh.Cri,this.uT)}get hse(){return this.Knb&&Array.contains(kh.KYl,this.uT)}get uT(){""===this.hOa&&(this.hOa=this.pij());return this.hOa}set uT(A){A&&(this.hOa=A)}get lbc(){return this.VL}get VL(){return this.Ma.ka("WacBox4DictationFloatieIsEnabled")}get pWl(){return this.Ma.ka("WacBox4DictationInternalArticle")}get M4f(){return this.Ma.Ha("DictationFrontdoorDomain")}get aAd(){return this.Ma.ka("WacBox4DictationUseAugloopService")}get Ipg(){return this.Ma.ka("WacBox4DictationCommandsIsEnabled")&&
this.VL}get Knb(){return this.Ma.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get qZj(){return this.Ma.ka("WacDictationAuthenticationEnabled")}get P1c(){return this.Ma.ka("DictationDebugModeEnabled")}get jlh(){return this.getSupportedLanguages(0)}get ikh(){return this.getSupportedLanguages(1)}get rZj(){return Y.a.LIh&&this.Ma.ka("UserCanUseDictation")}getSupportedLanguages(A){const W=[];A=0===A?kh.productionLanguages:kh.previewLanguages;for(const oa of A)Array.add(W,new lm(oa));W.sort((oa,
xa)=>oa.displayName.localeCompare(xa.displayName));return W}pij(){if(this.l5a&&this.Uc){const A=this.l5a.SWc(this.Uc.ak);for(const W of this.jlh)if(W.LCID===A)return W.f5c;for(const W of this.ikh)if(W.LCID===A)return W.f5c}return kh.KUi}}Object(h.a)(ko,"DictationSettings",null,[]);class lo{constructor(){this.sgf=this.Ea=null}get name(){return"Box4.Dictation"}Xb(A){this.Ea=A;const W=H.a.instance.rb("Common.IDynamicScriptLoaderProvider");let oa=null;W&&(oa=W.xI);const xa=H.a.instance.ue("Box4.Dictation.IDictationHostFactory");
this.Ea.register(ko,"Box4.Dictation.DictationSettings").na().oa(()=>new ko(this.Ea.resolve("Common.IAppSettingsManager"),this.Ea.resolve("Box4.ILanguageReader"),this.Ea.resolve("Box4.ISelectionManager")));const Ia=H.a.instance.ue("Common.IDictationFloatieController");this.Ea.register(sl,"Box4.Dictation.DictationFloatieManager").na().oa(()=>new sl(Ia,this.Ea.resolve("Box4.Dictation.DictationSettings")));this.Ea.register(Un,"Box4.Dictation.DictationManager").na().oa(()=>new Un(oa,xa,this.Ea.resolve("Box4.ISelectionManager"),
A.Ia("Box4.IBusinessBarController"),A.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Ea.resolve("Box4.Dictation.DictationSettings"),this.Ea.resolve("Box4.Dictation.DictationFloatieManager"),this.Ea.rb("Box4.DictationCommands.IDictationCommandManager"),this.Ea.rb("Box4.DictationCommands.IDictationCommandParser"),this.Ea.rb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Ea.resolve("Common.App.OAuth.IOAuthManager"),this.Ea.resolve("Common.ISharedDependencyLoader")));this.Ea.register(664,
"Box4.Dictation.IDictationSessionInfo").na().oa(()=>new ap)}init(){this.Ea.resolve("Box4.Dictation.IDictationSessionInfo");this.sgf=xk.createInstance(this.Ea.ue("Common.IRibbonButtonUpdater"),this.Ea.resolve("Box4.Dictation.DictationManager"),this.Ea.resolve("Box4.IFormattingEditor"),this.Ea.resolve("Box4.IFormattingReader"),this.Ea.resolve("Box4.Dictation.DictationFloatieManager"),this.Ea.resolve("Box4.Dictation.DictationSettings"),this.Ea.ue("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),
cc.FocusManager.instance());this.sgf.vb();kc.App.Mb.updateCommandUI()}dispose(){}}Object(h.a)(lo,"DictationPackageManager",null,[2,3]);class Vn{constructor(A){this.K=A}NNi(A){return this.K.resolve(A)}}Object(h.a)(Vn,"DictationHostFactory",null,[665]);class Ik{constructor(A,W,oa){this.lY=null;this.gG=this.RX=-1;this.tEb=!1;this.GJ=A;this.pa=W;this.ia=oa}gfe(){return this.seg(!1)}oeg(){return this.seg(!0)}mvc(){this.lY&&this.gEa();const A=this.pa.Pa.nb;if(A){const W=A.Ua;if(W&&fg.ParagraphReader.fe(W.node))return this.lY=
W.node,this.gG=A.Ua.CQa,this.RX=A.Ua.Isb,this.tEb=!0}return!1}gEa(){this.lY=null;this.tEb=!1;this.RX=this.gG=-1}tDf(A){if(this.lY){const W=new Fi.GraphTransaction(15);try{W.ld(this.lY);const oa=this.tEb&&this.gG!==this.RX?cg.a.createTextRange(this.lY,this.gG,this.RX):cg.a.Oj(this.lY,this.RX);this.GJ.replaceTextRange(oa,A);this.RX=this.tEb?this.gG+A.length:this.RX+A.length;const xa=ii.SelectionFactory.Qg(this.lY,this.RX);this.pa.setSelection(xa);this.tEb=!1;return!0}finally{W&&W.dispose()}}return!1}zmg(A){if(this.lY){const W=
new Fi.GraphTransaction(15);try{W.ld(this.lY);const oa=this.gG!==this.RX?cg.a.createTextRange(this.lY,this.gG,this.RX):cg.a.Oj(this.lY,this.RX);this.GJ.replaceTextRange(oa,A);this.RX=this.gG+A.length;const xa=ii.SelectionFactory.Qg(this.lY,this.RX);this.pa.setSelection(xa);this.tEb=!1;return!0}finally{W&&W.dispose()}}return!1}K6g(){var A=this.Uij();this.ia&&A&&A.CQa!==A.Isb&&0<=A.CQa&&(A=cg.a.createTextRange(A.node,A.CQa,A.Isb),this.ia.Ja(re.a.wVf,2,A))}Uij(){return this.lY?this.gG!==this.RX?cg.a.createTextRange(this.lY,
this.gG,this.RX):cg.a.Oj(this.lY,this.RX):null}seg(A){var W=this.pa.Pa.nb;if(W){var oa=W.Ua;if(oa&&(W=oa.node,fg.ParagraphReader.fe(W)&&(oa=A?oa.Isb:oa.CQa,W=fg.ParagraphReader.text(W),oa<=W.length)))return A?W.substring(oa,W.length):W.substring(0,oa)}return""}}Object(h.a)(Ik,"DictationHost",null,[663]);class Sk{get name(){return"PowerPointWebEditor.Dictation"}Xb(A){A.register(Vn,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").na().oa(()=>new Vn(A));
A.register(Ik,"PowerPointWebEditor.Dictation.DictationHost").as("Box4.Dictation.IDictationHost").na().oa(()=>new Ik(A.resolve("Box4.ICharacterPropertiesEditor"),A.resolve("Box4.ISelectionManager"),L.AFrameworkApplication.Qa))}init(){}dispose(){}static main(){Za.a.instance.Ac(new Sk)}}Object(h.a)(Sk,"PPTWebEditorDictationPackage",null,[2,3]);var fm=d(463);class $g{constructor(A,W,oa=null){this.id=A.Id;oa||(oa="");this.L4k=oa;this.sensitivityLabel=A}}Object(h.a)($g,"AutoPolicyLabelData",null,[]);class mm{constructor(A,
W){this.v8=A;this.displayName=W}}Object(h.a)(mm,"PolicyLabelRequestState",null,[]);class tl{constructor(){this.o_e=this.ALe=""}}Object(h.a)(tl,"PolicyStrings",null,[]);class El{static get tse(){return El.R$j}}El.R$j="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(h.a)(El,"JustificationDialogHtml",null,[]);class Pi extends mb.a{constructor(A,W){super(!1,!1,Pi.w2);this.cPa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.ZFc=null;this.YFc=!1;this.LGc=A;this.RD=W;this.hg=this.Dui();this.Ad=1;this.ig=Pi.id;this.Le(1,CommonUIStrings.l_DialogChange);this.cF(1,!1);this.cza(0)}U3e(){if(Pi.w2)this.sj(CommonUIStrings.l_SensitivityJustificationTitle,
Object(n.a)(this,this.Mnh,"reactJustificationDialogHandler"),this.Ubg(this.YFc));else{const A={};for(let W=0;W<this.cPa.length;W++)A[Pi.SUe+W]=!1;A[Pi.hwc]="";this.sj(CommonUIStrings.l_SensitivityJustificationTitle,Object(n.a)(this,this.Q$j,"justificationDialogHandler"),A);this.jWe();zd.a.addHandler($get(Pi.hwc),sc.a.input,Object(n.a)(this,this.RJl,"textAreaHandler"))}}validate(){if(Pi.w2)return this.ESh(this.ZFc);const A=$get(Pi.hwc);return A.disabled?!0:this.ESh(A.value)}ESh(A){const W=2>A.length,
oa=500<A.length,xa=RegExp("[{|}|;|\\\\]").test(A);A=""===ub.a.FWe(A);return!W&&!oa&&!xa&&!A}Q$j(A,W){let oa="";if(1===A)for(let xa=0;xa<this.cPa.length;xa++)if(W[Pi.SUe+xa]){oa=xa===this.cPa.length-1?W[Pi.hwc]:this.cPa[xa];break}this.RD(A,this.LGc,oa)}Mnh(A){let W="";1===A&&this.ZFc&&(W=this.ZFc);this.RD(A,this.LGc,W)}LIk(A){this.ZFc=A;A=this.validate();this.YFc!==A&&(this.YFc=A,this.l7(CommonUIStrings.l_SensitivityJustificationTitle,Object(n.a)(this,this.Mnh,"reactJustificationDialogHandler"),this.Ubg(this.YFc)))}Ubg(A){return{["id"]:this.ig,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!A},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(n.a)(this,this.LIk,"onJustificationUpdated")}}RJl(A){A.target&&this.cF(1,this.validate())}Dui(){return mb.a.pz(Pi.tse,L.AFrameworkApplication.km,Oi.getImageClass(Pi.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.cPa[0],this.cPa[1],this.cPa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}jWe(){const A=document.getElementsByName(Pi.lck);for(let W=0;W<A.length;W++)zd.a.addHandler(A[W],sc.a.focus,Object(n.a)(this,this.Qod,"radioButtonFocusHandler")),
zd.a.addHandler(A[W],sc.a.click,Object(n.a)(this,this.Qod,"radioButtonFocusHandler"))}Qod(A){if(A=A.target){A.checked=!0;var W=$get(Pi.hwc);A.id===Pi.SUe+(this.cPa.length-1)?(W.disabled=!1,Sys.UI.DomElement.setVisible(W,!0),W.focus()):(W.disabled=!0,A.focus());this.cF(1,this.validate())}}static get w2(){return L.AFrameworkApplication.Aa.mb.gD&&L.AFrameworkApplication.Aa.mb.Kqe}}Pi.tse=El.tse;Pi.lck="ListRadioBox";Pi.SUe="radiobox";Pi.hwc="txtJustification";Pi.iconName="Info_32x32x32";Pi.id="JustificationDialog";
Object(h.a)(Pi,"JustificationDialog",mb.a,[]);class Lo extends mb.a{constructor(A,W,oa){super(!1,!1,!0);if(A&&oa){var xa={["id"]:"MandatoryLabellingDialog"};this.UZh=oa;this.vKd=W;if(!L.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.vKd&&""!==this.vKd)xa.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.vKd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
W={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(W.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:A});xa.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:W};A={["id"]:"MandatoryLabellingDialog",["bodyControls"]:xa};xa.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;xa.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.sj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(n.a)(this,this.Uxk,"mandatoryLabellingDialogHandler"),A)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}Uxk(A,W){1===A&&W.selectedLabel&&(A=W.selectedLabel,""!==A&&this.UZh(A))}}Object(h.a)(Lo,"MandatoryLabellingDialog",mb.a,[]);class yk{constructor(){this.Rqa=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.mb.gD}wPi(A,W,oa){this.Rqa&&new Lo(A,W,oa)}static get instance(){return yk.La||
(yk.La=new yk)}}yk.La=null;Object(h.a)(yk,"MandatoryLabellingDialogFactory",null,[852]);class Ve{}Ve.$Fl="sbProtectForm14";Ve.bGl="SBStatusBarMarkAsReadOnly14";Ve.xbk="Info_16x16x32";Ve.tLf="QuickSearchCompletedToday_16x16x32";Ve.qVe="CommonControlCheckboxCheck_16";Ve.ALh="On";Ve.visible="Visible";Ve.m$i="ImageIsVisible";Ve.sV="SourceControlId";Ve.menuItemId="MenuItemId";Ve.menu="Menu";Ve.ZCf="AppLockId";Ve.value="Value";Ve.labelText="LabelText";Ve.alt="Alt";Ve.Okg="Image16by16";Ve.eAb="Image16by16Class";
Ve.ZFl="SBProtectForm_16";Ve.aGl="SBStatusBarMarkAsReadOnly_16";Ve.icon="Icon";Ve.iconColor="IconColor";Ve.customTooltip="CustomTooltip";Ve.l4k="MipTagDynamicFillWithOutline_20";Ve.m4k="MipTagLockDynamicFillWithOutline_20";Ve.k4k="MipTagErrorOutline_20";Ve.n4k="MipTagQuestionOutline_20";Ve.nyd="transparent";Ve.dQl="UILocation";Object(h.a)(Ve,"PolicyConstants",null,[]);class rj extends mb.a{constructor(A,W,oa){super(!1,!1,rj.w2);this.LGc=A;this.f3=W;this.RD=oa;this.Ad=1;this.ig=rj.id;this.cza(1);this.cza(0)}v4e(){const A=
{["id"]:"UserDefinedPermissionsDialog"};rj.w2&&this.sj("Defined Permissions",Object(n.a)(this,this.OWl,"userDefinedPermissionsDialogHandler"),A)}OWl(A){1!==A&&this.RD(A,this.LGc,"",this.f3)}static get w2(){return L.AFrameworkApplication.Aa.mb.gD&&L.AFrameworkApplication.Aa.mb.Kqe}}rj.id="UserDefinedPermissionsDialog";Object(h.a)(rj,"UserDefinedPermissionsDialog",mb.a,[]);var lj=d(594),Mo=d(144);class Sl{constructor(A,W,oa,xa){this.pWb=this.k5a=null;this.Llf=this.gJd=this.GJd=this.ZVb=this.dnf=this.Oof=
this.yEd=!1;this.apb=this.QAa=this.FBa=this.QNa=this.f3=this.rv=this.Eia=this.Lh=null;this.eZh=this.BCd=0;this.XFd=this.Lmf=this.Mdf=this.qNd=null;this.Ca=A;this.Yh=W;this.Ma=oa;this.Mj=xa;this.aXb={};this.Qrf={};this.Qof={};this.m1c=oa.ka("WacApplyManualPolicyLabelIsEnabled");this.Mj.value.NUd(Object(n.a)(this,this.wSe,"processAutoSensitivityLabel"));this.Mj.value.DBf(Object(n.a)(this,this.wSe,"processAutoSensitivityLabel"));this.Mj.value.mUd(Object(n.a)(this,this.lNk,"onUpdateLabelInfo"));L.AFrameworkApplication.Aa&&
L.AFrameworkApplication.Aa.MI(Object(n.a)(this,this.y6k,"refreshDocumentPolicyLabelsOnModeChange"));oa.ka("SupportsPolicies")&&oa.Ha("AppliedPolicyId")&&(this.k5a=oa.Ha("IrmPolicyTitle"),this.pWb=oa.Ha("IrmPolicyDescription"));this.rXh=this.Ma.uc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.sXh=this.Ma.uc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get Xua(){return L.AFrameworkApplication.Xua||!!this.Lmf&&this.Lmf()}vb(){this.Ca.ya(ra.a.gPe,Lb.a.frame,Object(n.a)(this,this.pRc,
"documentLabelPaneHandler"));this.Ca.ra(ra.a.oLb,Lb.a.frame,Object(n.a)(this,this.oLb,"queryPolicyLabel"),96);this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Ca.ya(ra.a.efh,Lb.a.frame,Object(n.a)(this,this.pRc,"documentLabelPaneHandler")),this.Ca.ra(ra.a.vqc,Lb.a.frame,Object(n.a)(this,this.vqc,"queryPolicyShortLabel"),96));this.Ca.ya(ra.a.inb,Lb.a.frame,Object(n.a)(this,this.inb,"toggleSensitivity"));this.Ca.ya(ra.a.fjb,Lb.a.frame,Object(n.a)(this,
this.fjb,"populateSensitivityFlyout"));this.Ca.ya(ra.a.Alb,Lb.a.frame,Object(n.a)(this,this.Alb,"setSensitivity"));this.Ca.ra(ra.a.Aqc,Lb.a.frame,Object(n.a)(this,this.Aqc,"querySensitivity"),96);this.Ca.ya(ra.a.Mjb,Lb.a.frame,Object(n.a)(this,this.Mjb,"querySensitivityToggleButton"));this.Ca.ya(ra.a.Ljb,Lb.a.frame,Object(n.a)(this,this.Ljb,"querySensitivitySubFlyout"));this.v_b(ra.a.inb)||this.Ca.ie(ra.a.inb,4);this.v_b(ra.a.fjb)||this.Ca.ie(ra.a.fjb,4);this.v_b(ra.a.Alb)||this.Ca.ie(ra.a.Alb,4);
this.v_b(ra.a.Mjb)||this.Ca.ie(ra.a.Mjb,4);this.v_b(ra.a.Ljb)||this.Ca.ie(ra.a.Ljb,4);this.Yh.updateCommandUI();L.AFrameworkApplication.fa&&Fd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Mj.value.bbl(Object(n.a)(this,this.bph,"registerActionsHandler"))}bph(){this.vb()}TOh(){this.Ca.kK(ra.a.gPe,Lb.a.frame,Object(n.a)(this,this.pRc,"documentLabelPaneHandler"));this.Ca.kK(ra.a.oLb,Lb.a.frame,Object(n.a)(this,this.oLb,
"queryPolicyLabel"));this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Ca.kK(ra.a.efh,Lb.a.frame,Object(n.a)(this,this.pRc,"documentLabelPaneHandler")),this.Ca.kK(ra.a.vqc,Lb.a.frame,Object(n.a)(this,this.vqc,"queryPolicyShortLabel")));this.Ca.kK(ra.a.inb,Lb.a.frame,Object(n.a)(this,this.inb,"toggleSensitivity"));this.Ca.kK(ra.a.fjb,Lb.a.frame,Object(n.a)(this,this.fjb,"populateSensitivityFlyout"));this.Ca.kK(ra.a.Alb,Lb.a.frame,Object(n.a)(this,this.Alb,
"setSensitivity"));this.Ca.kK(ra.a.Aqc,Lb.a.frame,Object(n.a)(this,this.Aqc,"querySensitivity"));this.Ca.kK(ra.a.Mjb,Lb.a.frame,Object(n.a)(this,this.Mjb,"querySensitivityToggleButton"));this.Ca.kK(ra.a.Ljb,Lb.a.frame,Object(n.a)(this,this.Ljb,"querySensitivitySubFlyout"))}inb(){return 32}X5f(A){const W="mandatoryLabelling_"+A.Id;this.Qof[W]=A.Id;return{["type"]:"AppToggleButtonProps",["id"]:W,["label"]:A.DisplayName,["hideLabel"]:!1,["customTooltip"]:A.Tooltip}}bdb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",
!1)}Spe(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)}ooj(){const A=[],W=this.Eia;for(let xa in W){var oa=W[xa];const Ia=this.rv[xa];if(Ia&&Ia.Enabled&&!Ia.HasUserDefinedPermissions)if(oa.count){const qb={["sections"]:[],["shouldAutoOpen"]:!1},Hb={["id"]:"mandatoryLabelling_flyoutMenuSection_"+Ia.Id,["controls"]:[]};for(let hc of oa)(oa=this.rv[hc])&&oa.Enabled&&!oa.HasUserDefinedPermissions&&Array.add(Hb.controls,this.X5f(oa));Array.add(qb.sections,
Hb);Array.add(A,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ia.Id,["label"]:Ia.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:qb})}else Array.add(A,this.X5f(Ia))}return A}fjb(A,W,oa,xa,Ia){if(1===oa||!this.Mj.value.Ftb(!0))return 32;Ia.MenuItems=Object.assign(new Kg.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ia.MenuItems.MenuSectionList,this.pPc(!this.isReactRibbonEnabled()));this.Lh.CustomUrl&&Array.add(Ia.MenuItems.MenuSectionList,
this.cPi(this.isReactRibbonEnabled()?this.Lh.CustomUrl:ub.a.ze(this.Lh.CustomUrl)));this.isReactRibbonEnabled()||(Ia.PopulationXML=cb.l(Ia.MenuItems));return 32}Aqc(A,W,oa,xa,Ia){if(1===oa||!Ia||!this.m1c)return 32;this.Lh=this.Mj.value.tv;if(this.Mj.value.Ftb(!0)&&(Ia[Ve.visible]=!0,this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.dnf||(Gd.a("MipLabelsAvailable"),this.dnf=!0):Gd.a("MipLabelsAvailable"),this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",
!1)&&this.Lh&&this.Lh.AreLabelsAvailable&&(A=H.a.instance.Ia("Common.ISystemInitiatedFeedback")))){const qb=Sl.Xa(this.Lh.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";A.execute(Hb=>{Hb.logActivity(qb,null)})}return 32}Mjb(A,W,oa,xa,Ia){if(1===oa||!Ia)return 32;let qb,Hb;Ia[Ve.ALh]=!!(qb=Ia[Ve.menuItemId])&&!!(Hb=this.aXb[qb])&&Hb===this.Lh.AppliedPolicyId;return 32}Ljb(A,W,oa,xa,Ia){if(1===oa||!Ia)return 32;let qb,Hb,hc;A=!!(qb=Ia[Ve.sV])&&!!(Hb=
this.aXb[qb])&&!!(hc=this.Eia[Hb])&&hc.contains(this.Lh.AppliedPolicyId);Ia[Ve.m$i]=A;Ia[Ve.ALh]=A;return 32}Alb(A,W,oa,xa,Ia){if(1===oa||!Ia)return 32;A=this.aXb[Ia[Ve.sV]];W=this.eQl(Ia[Ve.dQl]);oa=new md.a;oa.name="SensitivityPickerLocation";oa.int64=W;Gd.a("SensitivityPickerUsage",void 0,void 0,[oa]);return this.WLa(A,Ia,2)}S1c(){return!!L.AFrameworkApplication.Aa&&1===L.AFrameworkApplication.Aa.mode}y6k(){this.gJd&&!this.S1c()&&(this.gJd=!1,this.Mj.value.x6k())}XMl(){this.Lh.DefaultLabelId&&
this.Lh.MandatoryLabelingEnforced?this.yEd||this.S1c()?this.Lh.AppliedPolicyId?this.h7d(""):(this.Mj.value.R5j(this.Mj.value.Ddc)||this.S1c())&&this.aZf():this.Uyh():this.Lh.DefaultLabelId?this.Uyh():this.Lh.MandatoryLabelingEnforced&&(this.Lh.AppliedPolicyId?this.h7d(""):this.aZf())}Mrg(){return this.Lh.MandatoryLabelingEnforced?this.Lh&&this.Lh.AreLabelsAvailable?this.Ma.ka("TestOverrideIsReactDialogEnabled")||this.Yh&&this.Yh.mb&&this.Yh.mb.gD?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),
!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}aZf(){!this.Mrg()||L.AFrameworkApplication.$Q||this.Oof||(this.Oof=L.AFrameworkApplication.$Q=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.Mj.value.Jmh("",1),this.Mj.value.GTd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,
CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,()=>{this.Sxk()}))}h7d(A){this.Mrg()&&L.AFrameworkApplication.$Q&&(L.AFrameworkApplication.$Q=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.Mj.value.OWe(),this.Mj.value.Jmh(A,2))}Sxk(){yk.instance.wPi(this.ooj(),this.Lh.CustomUrl,Object(n.a)(this,this.Txk,"mandatoryLabellingDialogCallback"))}Txk(A){this.h7d(this.Qof[A])}YFf(){return this.Ma.ka("CoAuthForProtectedFilesEnabled")&&
this.Ma.ka("SupportsOfficeClientCoauthoring")&&this.Ma.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.XFd&&this.Xua}WLa(A,W,oa,xa=null){this.Mj.value.J2k(oa);let Ia=32,qb=!1,Hb=!0;const hc=2===oa||8===oa||16===oa,Jc=A===this.Lh.AppliedPolicyId;if(this.Mdf&&this.Mdf(A,hc))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",oa),this.Yh.updateCommandUI();else if(W&&Ve.ZCf in W&&this.Mj.value.X0e(W[Ve.ZCf]),
A)if(this.Mj.value.Vtg()||this.YFf()&&this.GJd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",oa),this.Yh.updateCommandUI(),hc&&this.wKc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.Ma.ka("HasDocumentEditRights"))if(this.Mj.value.eAi(A))if(!this.bdb()&&this.rv[A]&&this.rv[A].HasUserDefinedPermissions&&!Jc)e.ULS.sendTraceTag(540608323,
306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",oa),1!==oa&&4!==oa&&this.rni();else if(hc&&this.Lh.MandatoryLabelingEnforced&&Jc)e.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",oa),this.wKc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(hc&&this.Ma.ka("WacLabelingJustificationDialogIsEnabled")&&
this.Lh.RequiredDowngradeJustification&&(Jc||this.rv[A].RequiredDowngradeJustification)&&(this.bdb()?!this.Llf&&!xa:!this.f3))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",oa),this.U3e(A),Ia;if(this.bdb()&&this.rv[A].HasUserDefinedPermissions&&!Jc)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",oa),this.v4e(A,xa),Ia;if(this.YFf()&&!this.XFd())this.BCd<this.rXh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",
this.BCd,oa),this.GJd=!0,this.BCd++,ze.Task.delay(this.sXh).continueWith(()=>{this.GJd=!1;this.WLa(A,W,oa)})):(e.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",oa),qb=1!==oa,Hb=!1,Ia=8);else{if(this.d4j(A)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",oa),1===oa||8===oa||4===oa))return Ia;e.ULS.sendTraceTag(570972056,
306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",oa);this.setPolicyLabel(Jc?"":A,this.bdb()?xa:this.f3,"",oa);return Ia}}else e.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",oa),this.Yh.updateCommandUI(),hc&&this.wKc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
oa),this.Yh.updateCommandUI(),hc&&this.wKc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",oa),this.Yh.updateCommandUI(),qb=hc,Hb=!1,Ia=8;this.Mj.value.jnh(0,oa,qb,Hb);return Ia}bEf(A,W,oa=null,xa=!1){B.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.Ma.ka("SupportsOfficeClientCoauthoring")&&
this.Ma.ka("CoAuthForProtectedFilesIsEnabled")?(this.ZVb=!1,(this.Lh=this.Mj.value.tv)&&!this.Lh.AppliedPolicyId?this.ZVb=!0:this.Lh&&this.Lh.PolicyLabelAssignmentMethod&&(this.ZVb=Mo.e(this.Lh.PolicyLabelAssignmentMethod)===Mo.e("standard"))):this.ZVb=xa;A=Sl.Xa(A)?null:this.rv[A];(W=Sl.Xa(W)?null:this.rv[W])?this.FBa=new $g(W,!0,oa):(this.Mj.value.Dya(29),this.QAa=null);A?this.QNa=new $g(A,!1):this.apb=null;this.wSe(null,null)}Zoi(A){this.WLa(A,null,16)}bql(){this.rv={};if(this.Lh=this.Mj.value.tv)for(const A of this.Lh.SensitivityLabels)this.rv[A.Id]=
A}d4j(A){if(this.Eia&&A in this.Eia){A=this.Eia[A];for(let W of A)if((A=this.rv[W])&&A.Enabled)return!0}return!1}Crl(){this.Eia={};if(this.Lh=this.Mj.value.tv){for(const A of this.Lh.SensitivityLabels)A.ParentId||(this.Eia[A.Id]=new Ga.a);for(const A of this.Lh.SensitivityLabels){if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RemoveDisabledLabelsFromChildLabel",!1)){if(!(A.ParentId&&A.ParentId in this.Eia&&A.Enabled))continue}else if(!(A.ParentId&&A.ParentId in this.Eia))continue;
this.Eia[A.ParentId].add(A.Id)}}}P_k(){this.Lh=this.Mj.value.tv;const A=this.m1c&&this.isReactRibbonEnabled()&&this.Mj.value.Ftb();Sl.Fqd(A)}H7k(A){this.XFd=A}Uyh(){if(this.Ma.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.S1c())this.gJd=!0;else if(!this.yEd)if(this.yEd=!0,this.Lh=this.Mj.value.tv,this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.Lh&&this.Lh.DefaultLabelId)if(!this.Lh.AppliedPolicyId)e.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",
this.Lh.DefaultLabelType),this.WLa(this.Lh.DefaultLabelId,null,1);else if(m.a.Gk().equals(this.Lh.DefaultLabelType,"documentLibraryDefault")){const A=this.rv[this.Lh.AppliedPolicyId],W=this.rv[this.Lh.DefaultLabelId];this.Lh.AppliedPolicyId!==this.Lh.DefaultLabelId&&m.a.Gk().equals(this.Lh.PolicyLabelAssignmentMethod,"standard")&&A.Order<W.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.Lh.DefaultLabelType),this.WLa(this.Lh.DefaultLabelId,null,
1))}}else this.Lh&&this.Lh.DefaultLabelId&&!this.Lh.AppliedPolicyId&&(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Lh.DefaultLabelId),this.WLa(this.Lh.DefaultLabelId,null,1))}wSe(){if(!this.Mj.value.Vtg()){var A=this.rv[this.Lh.AppliedPolicyId];this.ZVb&&this.QNa&&this.apb!==this.QNa.id&&(!A||A.Order<this.QNa.sensitivityLabel.Order)&&(A=this.WLa(this.QNa.id,{},4),32!==A?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+
A):(this.apb=this.QNa.id,this.QAa&&(A=this.rv[this.QAa])&&A.Order<=this.QNa.sensitivityLabel.Order&&(this.Mj.value.Dya(29),this.QAa=null)));A=this.rv[this.Mj.value.tv.AppliedPolicyId];if(this.FBa&&this.QAa!==this.FBa.id&&(!A||A.Order<this.FBa.sensitivityLabel.Order)){const W=this.FBa.id;this.Mj.value.Dya(29);this.Mj.value.gJc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.yXc(this.FBa.sensitivityLabel))+" "+this.FBa.L4k,CommonUIStrings.l_PolicyLabelRecommendationButton,
()=>{this.WLa(W,{},8)});this.QAa=this.FBa.id}this.FBa=this.QNa=null}}setPolicyLabel(A,W,oa,xa=2){this.bdb()?W&&(this.Llf=!0):this.f3=W;this.Mj.value.setPolicyLabel(A);this.Yh.updateCommandUI();oa=new mm(xa,this.yXc(this.rv[A]));this.Mj.value.l1e(A,this.bdb()?W:this.f3,oa)}NKi(A,W,oa,xa){1===A&&this.setPolicyLabel(W,xa,oa)}MKi(A,W,oa){1===A?this.bdb()?this.WLa(W,null,2,oa):this.setPolicyLabel(W===this.Lh.AppliedPolicyId?"":W,oa,""):this.Yh.updateCommandUI()}U3e(A){(new Pi(A,Object(n.a)(this,this.MKi,
"continueToSetPolicyLabelFromJustificationDialog"))).U3e()}v4e(A,W){(new rj(A,W,Object(n.a)(this,this.NKi,"continueToSetPolicyLabelFromUDPDialog"))).v4e()}wKc(A="",W=""){const oa=new Ka.StandardDialog;oa.Mr=L.AFrameworkApplication.uea;oa.Ad=0;oa.Le(1,CommonUIStrings.l_DialogClose);oa.zP(A,W,null)}Xsi(A){1===A&&this.Mj.value.t3k()}rni(){const A=new Ka.StandardDialog;A.Mr=L.AFrameworkApplication.uea;A.Ad=1;A.Le(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);A.Le(0,CommonUIStrings.l_DialogClose);
A.zP(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(n.a)(this,this.Xsi,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Yh&&!!this.Yh.mb&&this.Yh.mb.Qp}MBb(){return this.Yh&&this.Yh.mb?this.Yh.mb.MBb:!1}pRc(){return 32}Zrl(A,W,oa,xa){A?(xa[Ve.value]=A,xa[Ve.labelText]=A,xa[Ve.customTooltip]=W,this.zzh(oa,L.AFrameworkApplication.Vx,xa)):(xa[Ve.iconColor]=Ve.nyd,this.Lh.MandatoryLabelingEnforced?(xa[Ve.value]=xa[Ve.labelText]=
this.DXc().o_e,xa[Ve.icon]=Ve.k4k):(xa[Ve.value]=xa[Ve.labelText]=this.DXc().ALe,xa[Ve.icon]=Ve.n4k));xa[Ve.visible]=!0}yql(A){let W="",oa="",xa="";if(this.Lh.AreLabelsAvailable){let Ia=null;this.rv&&(Ia=this.rv[this.Lh.AppliedPolicyId]);Ia&&(W=this.yXc(Ia),oa=Ia.Tooltip,L.AFrameworkApplication.Vx=this.Mj.value.KBb(Ia),xa=this.qae(Ia));if(!this.Mj.value.Ftb()&&!Ia)return}else{if(!this.k5a)return;W=this.k5a;xa=Ve.nyd;oa=this.pWb?this.pWb:""}this.Zrl(W,oa,xa,A)}oLb(A,W,oa,xa,Ia){if(1===oa)return 32;
this.Lh=this.Mj.value.tv;if(!this.Lh||!Ia)return 32;Ia[Ve.value]="";Ia[Ve.labelText]="";Ia[Ve.alt]=null;Ia[Ve.Okg]=null;Ia[Ve.eAb]=null;Ia[Ve.customTooltip]="";Ia[Ve.visible]=!1;Ia[Ve.iconColor]="";Ia[Ve.icon]="";if(this.Spe())this.yql(Ia);else{oa=W=A="";if(!this.Lh.AreLabelsAvailable){if(!this.k5a)return 32;A=this.k5a;oa=Ve.nyd;this.pWb&&(W=this.pWb)}else if(this.Lh.AppliedPolicyId){xa=null;for(const qb of this.Lh.SensitivityLabels)if(qb.Id.toLowerCase()===this.Lh.AppliedPolicyId.toLowerCase()){xa=
qb;break}xa&&(A=this.yXc(xa),W=xa.Tooltip,L.AFrameworkApplication.Vx=this.Mj.value.KBb(xa),oa=this.qae(xa))}A&&(Ia[Ve.value]=A,Ia[Ve.labelText]=A,this.MBb()?Ia[Ve.customTooltip]=W:Ia[Ve.alt]=W,this.zzh(oa,L.AFrameworkApplication.Vx,Ia),Ia[Ve.visible]=!0)}return 32}vqc(A,W,oa,xa,Ia){if(1===oa)return 32;this.Lh=this.Mj.value.tv;if(!this.Lh||!Ia)return 32;Ia[Ve.labelText]="";if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.Lh.HideBarByDefault)return 32;
A="";if(this.Lh.AreLabelsAvailable)if(this.Lh.AppliedPolicyId){if(!this.rv)return 32;(W=this.rv[this.Mj.value.tv.AppliedPolicyId])&&(A=W.ParentId&&this.rv[W.ParentId]?this.rv[W.ParentId].DisplayName:W.DisplayName)}else A=this.Lh.MandatoryLabelingEnforced?this.DXc().o_e:this.DXc().ALe;else{if(!this.k5a)return 32;A=this.k5a}Ia[Ve.labelText]=A;return 32}yXc(A){return A?this.rv?A.ParentId&&this.rv[A.ParentId]?this.rv[A.ParentId].DisplayName+"\\"+A.DisplayName:A.DisplayName:(e.ULS.sendTraceTag(4282E4,
306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),A.DisplayName):""}zzh(A,W,oa){this.Spe()?(oa[Ve.icon]=this.heg(W),oa[Ve.iconColor]=this.ieg(A)):this.MBb()?oa[Ve.icon]=W?Ve.ZFl:Ve.aGl:(oa[Ve.Okg]=L.AFrameworkApplication.km,oa[Ve.eAb]=W?Oi.getImageClass(Ve.$Fl):Oi.getImageClass(Ve.bGl))}cPi(A){const W=this.hu("LearnMoreSection",!0);A=Object.assign(new Ba.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:A,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",
Image16by16:L.AFrameworkApplication.km,Image16by16Class:Oi.getImageClass(Ve.xbk),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(W.ControlList,A);return W}vSf(A,W,oa=!1){let xa;xa="Toggle_"+A.Id;xa="Sensitivity_"+xa;const Ia=A.DisplayName,qb=A.Tooltip;var Hb=A.Id===this.Lh.AppliedPolicyId,hc=oa?ub.a.ze(xa):xa;this.Spe()?(Hb=this.qae(A),W=Object.assign(new vc.a,{Id:hc,ExternalId:hc,LabelText:oa?ub.a.ze(Ia):Ia,Command:"2935633379",MenuItemId:hc,QueryCommand:"991261903",Visible:!0,
Alt:oa?ub.a.ze(qb):qb,AriaLabel:Ib.a.Gtb,IconColor:this.ieg(Hb),KeyTip:W}),W.ExternalImageId=this.heg(this.Mj.value.KBb(A))):(hc=Object.assign(new lj.a,{Id:hc,ExternalId:hc,LabelText:oa?ub.a.ze(Ia):Ia,Command:"2935633379",MenuItemId:hc,QueryCommand:"991261903",CheckedImage:L.AFrameworkApplication.km,Visible:!0,Alt:oa?ub.a.ze(qb):qb,IsChecked:Hb,AriaLabel:Ib.a.Gtb,KeyTip:W}),this.isReactRibbonEnabled()?(hc.CheckedImageClass=Oi.getImageClass(Ve.qVe),hc.ExternalImageId=Ve.qVe):hc.CheckedImageClass=Oi.getImageClass(Ve.tLf),
W=hc);hc=xa;this.aXb[hc]=A.Id;this.Qrf[A.Id]=hc;return W}hu(A,W=!1){return Object.assign(new Aa.a,{Title:"",Id:A,DisplayMode:Ve.menu,ShowMenuSectionSeparator:W,ControlsId:"Ctrl_"+A,ControlList:[]})}jSi(A,W,oa){A=this.hu(A+"Sub");let xa=1;for(let Ia of W)(W=this.rv[Ia])&&W.Enabled&&(Array.add(A.ControlList,this.vSf(W,xa.toString(),oa)),xa++);return A}pPc(A=!1){const W=this.hu("SensitivitySection");let oa=1;const xa=this.Eia;for(let qb in xa){const Hb=xa[qb],hc=this.rv[qb];if(hc&&hc.Enabled){if(Hb.count){var Ia=
"Sensitivity_"+hc.Name;A&&ub.a.ze(Ia);Ia="Label"+this.eZh++;const Jc=Object.assign(new V.a,{Id:Ia,ExternalId:Ia,LabelText:A?ub.a.ze(hc.DisplayName):hc.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new Kg.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Ib.a.Gtb,KeyTip:oa.toString(),Alt:A?ub.a.ze(hc.Tooltip):hc.Tooltip});this.isReactRibbonEnabled()?Jc.ExternalImageId=Ve.qVe:(Jc.Image16by16=L.AFrameworkApplication.km,
Jc.Image16by16Class=Oi.getImageClass(Ve.tLf));Array.add(Jc.Menu.MenuSectionList,this.jSi(Ia,Hb,A));Array.add(W.ControlList,Jc);this.aXb[Jc.Id]=hc.Id;this.Qrf[hc.Id]=Jc.Id}else Array.add(W.ControlList,this.vSf(hc,oa.toString(),A));oa++}}return W}v_b(A){return!!this.Ca.MT(A)&&!!this.Ca.MT(A).flags&&!!this.Ca.MT(A).flags.length}lNk(A,W){W.onSuccess&&this.rv&&(A=this.rv[this.Mj.value.tv.AppliedPolicyId])&&(this.QAa&&(W=this.rv[this.QAa])&&W.Order<=A.Order&&(this.Mj.value.Dya(29),this.QAa=null),this.apb&&
this.apb!==A.Id&&(this.Mj.value.Dya(28),this.apb=null))}heg(A){return A?Ve.m4k:Ve.l4k}ieg(A){return A?A:Ve.nyd}qae(A){if(A.Color||!A.ParentId)return A.Color;const W=this.rv[A.ParentId];return W?W.Color:A.Color}eQl(A){switch(A){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}DXc(){this.qNd||(this.qNd=Object.assign(new tl,{ALe:HeaderStrings.NoSensitivityLabel,o_e:HeaderStrings.SelectASensitivityLabel}));return this.qNd}static XUl(){L.AFrameworkApplication.fa&&!L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)||!Fd.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",!0))}static Fqd(A){Fd.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!A))}static Xa(A){return A&&A.length?!1:!0}}Object(h.a)(Sl,"PolicyActor",null,[729]);var Qi=d(1256),Wn;(function(A){A[A.unknown=0]="unknown";A[A.boot=1]="boot";A[A.refresh=2]="refresh";A[A.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(Wn||(Wn={}));Object(h.b)("GetPolicyLabelsReason",Wn);class No extends Sys.EventArgs{constructor(A,
W,oa,xa,Ia,qb){super();this.nub=A;this.title=W;this.message=oa;this.buttonText=xa;this.q1b=Ia;this.D3c=qb}}Object(h.a)(No,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Oo extends Sys.EventArgs{constructor(A,W,oa,xa,Ia){super();this.nub=A;this.title=W;this.message=oa;this.buttonText=xa;this.q1b=Ia}}Object(h.a)(Oo,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var zk;(function(A){A[A.none=0]="none";A[A.reasonDefaultLabel=1]="reasonDefaultLabel";A[A.reasonManual=
2]="reasonManual";A[A.reasonAutomatic=4]="reasonAutomatic";A[A.reasonRecommended=8]="reasonRecommended";A[A.reasonMandatory=16]="reasonMandatory"})(zk||(zk={}));Object(h.b)("ApplyLabelFlags",zk);class nm extends Sys.EventArgs{constructor(A,W,oa){super();this.kNf=A;this.jNf=W;this.existingLabelPriority=oa}}Object(h.a)(nm,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Fl extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Fl,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class bp extends Sys.EventArgs{constructor(){super()}}
Object(h.a)(bp,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class nn{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=this.HideBarByDefault=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=
this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl="";this.HideBarByDefault=!1}}Object(h.a)(nn,"GetPolicyLabelsData",null,[]);class mo extends Sys.EventArgs{constructor(A=!1){super();this.onSuccess=A}}Object(h.a)(mo,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Ii extends Sys.EventArgs{constructor(A,W){super();this.W4g=A;this.BVd=W}}Object(h.a)(Ii,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Tl extends Sys.EventArgs{constructor(A,
W,oa,xa){super();this.title=A;this.ATk=W;this.buttonText=oa;this.uFk=xa}}Object(h.a)(Tl,"PolicyTipEventArgs",Sys.EventArgs,[]);class sj extends Sys.EventArgs{constructor(A,W){super();this.nub=A;this.D3c=W}}Object(h.a)(sj,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Bc extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Bc,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Wm extends Sys.EventArgs{constructor(A,W){super();this.xih=A;this.v8=W}}Object(h.a)(Wm,
"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class Cn extends Sys.EventArgs{constructor(A,W,oa,xa=null,Ia=null,qb=null,Hb=null){super();this.errorType=A;this.gBl=oa;this.title=xa;this.message=Ia;this.buttonText=qb;this.q1b=Hb}}Object(h.a)(Cn,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Gm extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Gm,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Gl extends Sys.EventArgs{constructor(A){super();this.Ixl=A}}Object(h.a)(Gl,"UDPLabelingAppHandlerEventArgs",
Sys.EventArgs,[]);var jf=d(707),bl=d(457);class sk{static rpl(A,W){if(!A||!W||A.count!==W.count)return!1;for(let oa of A)if(!W.contains(oa))return!1;return!0}static toArray(A){if(!A)return null;const W=Array(A.count);let oa=0;for(let xa of A)W[oa]=xa,oa++;return W}}Object(h.a)(sk,"HashSetUtils",null,[]);var xe=d(585);class Hg{constructor(A,W,oa,xa=0,Ia=null){this.uEd=this.khf=null;this.hQa=this.dVb=this.eVb=0;this.Uba="";this.u6a=this.cnf=this.rCd=this.gId=this.AAa=this.JKd=null;this.Nlf=!1;this.I3a=
null;this.nHd=0;this.EFc=this.x6a=this.E4a=this.DFc=null;this.Oa=new ek.a;this.ytc=this.v8b=this.SS=null;this.aId=!1;this.Ddc=null;this.Ma=A;this.ji=W;this.ki=oa;this.iEc=xa;this.tv=new nn;this.Prf=this.Ma.Ha("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.JG=Ia;this.m1c=A.ka("WacApplyManualPolicyLabelIsEnabled");this.dbc=A.ka("CoAuthForProtectedFilesIsEnabled");this.Emb=A.ka("SupportsOfficeClientCoauthoring");this.T6j=!1;this.Jrl=3E4;this.ae=Bf.a.instance;A.ka("SupportsPolicies")&&Gd.a("MipSupportsPolicies");
this.dbc&&this.Emb&&Gd.a("MipSupportsOfficeClientCoauthoring")}get Qne(){return this.aId}zki(A){this.Oa.addHandler("PolicyTipEvent",A)}mUd(A){this.Oa.addHandler("LabelInfoUpdateEvent",A)}bbl(A){this.Oa.removeHandler("LabelInfoUpdateEvent",A)}NUd(A){this.Oa.addHandler("SetPolicyLabelEventKey",A)}Orh(A){this.Oa.removeHandler("SetPolicyLabelEventKey",A)}DBf(A){this.Oa.addHandler("SetPolicyLabelFailureEventKey",A)}vii(A){this.Oa.addHandler("GetAutoPolicyLabelEventKey",A);this.Qne&&(e.ULS.sendTraceTag(51668058,
306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.$Ue(new Fl(0)))}eii(A){this.Oa.addHandler("CreateAutoCLPSecurityNodesEventKey",A)}Kli(A){this.Oa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",A)}Lli(A){this.Oa.addHandler("UpdateAutoCLPSITNodesEventKey",A)}Jhi(A){this.Oa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",A)}Lki(A){this.Oa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",A)}Khi(A){this.Oa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",
A)}Mki(A){this.Oa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",A)}Oii(A){this.Oa.addHandler("MandatoryLabellingAppHandlerEventKey",A)}Ili(A){this.Oa.addHandler("UDPLabelingAppHandlerEventKey",A)}get j_j(){if(!this.khf)return!1;for(const A of this.khf.D$d())if(!A.Capabilities||!A.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get Btg(){return!!this.SS}FQj(A){A&&this.dbc&&this.Emb&&A.execute(Object(n.a)(this,this.kXd,"awaitRtc"))}m8k(A){this.gId=A}qCi(){return this.gId?this.gId():
!1}b7k(A){this.rCd=A}TF(){return(new Date).getTime()}kXd(A){if(!this.Btg){var W=A.LM.task;W.continueWith(()=>{this.SS=W.result;this.SS.ECa(Object(n.a)(this,this.RIk,"onLabelChangeUpdateOverRtc"))})}}RIk(A,W){12===W.type&&(this.cnf?this.cnf():this.XTa(this.Uba,2,this.AAa,!0))}Sae(){this.ki&&(this.DFc=this.ki.Ii("WebServiceCall","Call Get Policy Endpoint On Server"));var A=xe.a.xDa(1,1);this.Ma.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(A=new jf.a(this.Syb("datalosspolicy"),1,null,null,!0,
2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,A),this.ji.send(A).ckb(Object(n.a)(this,this.bah,"onDataLossPolicySuccessCallback"),Object(n.a)(this,this.aah,"onDataLossPolicyFailureCallback"))):this.ji.qj(this.Syb("datalosspolicy"),1,null,null,!0,2,Object(n.a)(this,this.bah,"onDataLossPolicySuccessCallback"),Object(n.a)(this,this.aah,"onDataLossPolicyFailureCallback"),null);this.eVb++;e.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",
this.Prf,this.eVb)}x6k(){this.XTa(this.Uba,2,this.AAa)}XTa(A,W=0,oa=null,xa=!1){B.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.bbe(void 0,W));this.v8b=this.TF();const Ia=this.a2d(W);this.XVc(A,Ia,oa,xa,W);this.cYe(!0)}bah(A){this.wih();let W="";({data:W}=this.C9e(A)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.eVb=0,this.ki&&(this.EFc=this.ki.Ii("Task","Parse and Handle Get Policy Response")),this.FQk(W),
this.EFc&&(this.EFc.stop(),this.EFc=null))}aah(A){this.wih();this.eVb<=this.iEc?this.Sae():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",A?A.data?A.data.OMb:null:null),this.eVb=0)}Vtg(){return 0<this.hQa}setPolicyLabel(A){this.tv.AppliedPolicyId=A}l1e(A,W,oa=null){const xa=this.KOi(oa);this.Irl(A,W,xa,oa)}qdh(A){this.x6a&&(this.x6a.stop(),this.x6a=null);let W,oa;({xxh:W,bAh:oa}=this.Ncg(A));const xa=A.data.state,Ia=xa?xa.v8:2;let qb=
"";({data:qb}=this.C9e(A)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Ia),this.hQa=0,this.lRk(qb,W,oa,xa)):this.cZe(Ia)}J2k(A){B.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.bbe(A));this.ytc=this.TF();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Oa.raiseEvent("SetPolicyLabelTriggeredEventKey",new Gm(A))}hDk(){this.dbc&&this.Emb&&this.Btg&&this.SS.bba(12,null,
!0)}pdh(A){this.x6a&&(this.x6a.stop(),this.x6a=null);let W;({xxh:oa,bAh:W}=this.Ncg(A));if(this.hQa<=this.iEc)this.l1e(oa,W);else{var oa=(oa=A.data.state)?oa.v8:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",A?A.data?A.data.OMb:null:null,oa);this.Ddc="WACServerConnectionFailed";this.hQa=0;this.cZe(oa)}}R5j(A){if(A&&("LabelNotSupported"===A||"LabelErrorRetryLater"===A||"CoherencyFailure"===A||"LabelIdNotFound"===A||"LabelDisabled"===
A))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",A),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",A);return!1}KBb(A){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPAsProtectedLabelEnabled",!1)?A.IsEndpointProtectionEnabled||A.HasUserDefinedPermissions:A.IsEndpointProtectionEnabled}eAi(A){if(!A)return!1;let W=null,oa=null;for(const xa of this.tv.SensitivityLabels)xa.Id===A&&(W=xa),xa.Id===this.Uba&&(oa=xa);if(!W)return!1;
if(this.dbc&&this.Emb){if(this.rCd&&this.rCd()||this.j_j)return!0}else if(L.AFrameworkApplication.oz&&L.AFrameworkApplication.oz.Lta||this.AAa&&this.AAa())return!0;return this.KBb(W)===(!!oa&&this.KBb(oa))}gJc(A,W,oa,xa,Ia){28===A?this.umh(new No(A,W,oa,xa,Ia,!1)):this.umh(new No(A,W,oa,xa,Ia,!0))}Dya(A){28===A?this.$mh(new sj(A,!1)):this.$mh(new sj(A,!0))}c1k(A,W,oa){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.Oa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",
new nm(A,W,oa))}w3k(A){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Oa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new nm(null,null,A))}x3k(A,W){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Oa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new nm(A,W,null))}Jmh(A,W){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===W?"Reading":"Edit")+" switch event.");this.Oa.raiseEvent("MandatoryLabellingAppHandlerEventKey",
new Ii(A,W))}GTd(A,W,oa,xa,Ia){37===A&&this.G0k(new Oo(37,W,oa,xa,Ia))}OWe(){this.s2k(new Bc)}t3k(){e.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Oa.raiseEvent("UDPLabelingAppHandlerEventKey",new Gl(!0))}Ftb(A=!1){const W=!!this.tv&&this.tv.AreLabelsAvailable&&!!this.tv.SensitivityLabels&&0<this.tv.SensitivityLabels.length&&ue.a.any(this.tv.SensitivityLabels,oa=>!!oa&&oa.Enabled);W||A||Sl.Fqd(!1);return W}gbh(A){this.E4a&&(this.E4a.stop(),this.E4a=null);var W="";this.cYe(!1);
({data:W}=this.C9e(A)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.dVb=0,W=this.WQk(W),A=this.wbg(A.data),B.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.QUc(void 0,A,this.v8b)),this.v8b=null,A=new Fl(A),this.x1k(A),this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?W&&this.lwl()?this.Qne?this.PRl():(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",
!1)||this.QOc(),this.$Ue(A),this.aId=!0):W||this.dpd():!this.Qne&&W&&this.Ma.ka("WacApplyManualPolicyLabelIsEnabled")&&this.MEf()?(this.$Ue(A),this.aId=!0):W||this.dpd()):this.dpd()}lwl(){if(!this.Ma.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.MEf())return!1;if(""===this.Uba)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),
!0;if(this.I3a===this.nHd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}QOc(){this.sPh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.u6a.count,this.I3a);const A=sk.toArray(this.u6a);this.c1k(A,
A,this.I3a)}PRl(){var A=this.u6a;this.sPh();sk.rpl(A,this.u6a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.u6a.count),A=sk.toArray(this.u6a),this.x3k(A,A));this.Nlf&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.I3a),this.w3k(this.I3a))}sPh(){const A=new Qi.a(m.a.Gk());for(const W of this.tv.SensitivityLabels)if(W&&W.AutoLabelingSensitiveTypeIds&&0<W.AutoLabelingSensitiveTypeIds.length)for(const oa of W.AutoLabelingSensitiveTypeIds)oa&&
A.add(oa);this.u6a=A}fbh(A){const W=this.wbg(A.data);B.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.QUc(void 0,W,this.v8b));this.v8b=null;this.E4a&&(this.E4a.stop(),this.E4a=null);if(this.dVb<=this.iEc){if(this.Ma.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const oa=A.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in oa&&oa[xe.a.Urd]&&"HostAttributionInfo.ScenarioTypeParamName"in oa&&oa[xe.a.Vrd]){A.data.request.get_headers();
A.data.request.get_headers();A=this.a2d(W);this.XVc(this.Uba,A,this.AAa,void 0,W);return}}this.XTa(this.Uba,W,this.AAa)}else e.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",A?A.data?A.data.OMb:null:null),this.dpd(),this.dVb=0,this.cYe(!1)}wbg(A){return A.state?A.state:0}Syb(A,W=!1){let oa=String.format("{0}{1}?action={2}&{3}",this.Ma.Ha("PolicyHandlerWebServiceBase")||L.AFrameworkApplication.Aa.mb.aoa,this.Prf,A,L.AFrameworkApplication.Pg);"setpolicylabel"===
A&&L.AFrameworkApplication.oz&&L.AFrameworkApplication.oz.Voe&&(oa=D.a.Pi(oa,"sl","1"));W&&(oa=D.a.Pi(oa,"cbd","1"));return oa}Ncg(A){let W,oa;W=oa=null;A&&A.data&&A.data.request&&A.data.request.get_headers()&&(W=A.data.request.get_headers()[bl.a.E_e],oa=A.data.request.get_headers()[bl.a.k1e]);return{xxh:W,bAh:oa}}C9e(A){A=A?A.data?A.data.Wd:null:null;return A&&A.length&&!this.P6j(A)?{returnValue:!0,data:A}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,
data:A})}FQk(A){let W;try{W=C.b(A)}catch(oa){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(W)if(W.IsPolicyTipAvailable)switch(W.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.uEd=W.NavigateUrl;this.xBl(W.GeneralText,Object(n.a)(this,
this.sGk,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",W.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else e.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}yLi(A){switch(A){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;
case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}lRk(A,W,oa,xa){var Ia=xa?xa.v8:2;let qb=0,Hb="",hc;if(({Su:hc}=C.d(A)).returnValue)if(hc){Hb=
"Success";A=this.a2d(3);if(hc.IsSuccessful){B.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.QUc(Ia,void 0,this.ytc));this.Ddc=this.ytc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);2===Ia&&this.Dya(29);this.Gsl(W,Ia);this.hDk();this.Dya(28);xa&&4===Ia&&this.gJc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,xa.displayName),
CommonUIStrings.l_DialogOk,()=>{});Gd.a("MipAppliedLabels",void 0,void 0,[Object.assign(new md.a,{name:"SetPolicyLabelApplyFlag",string:zk[Ia]})]);this.XVc(W,A,this.AAa,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",Ia,hc.FailureReason);this.Ddc=hc.FailureReason;this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?qb=this.yLi(hc.FailureReason):
"FileTooLarge"===hc.FailureReason?qb=7:"LabelNotSupported"===hc.FailureReason?qb=13:"LabelDisabled"===hc.FailureReason?qb=9:"MinorVersionLimitExceeded"===hc.FailureReason&&(qb=15);this.T6j&&0<=hc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(xa=new ee.a(2,1,this.Jrl,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.hQa);this.hQa<=this.iEc&&this.l1e(W,oa)}),this.ae.Hb(xa));this.dbc&&this.Emb&&
this.XVc(this.tv.AppliedPolicyId,A,this.AAa,!0,3)}else Hb="setPolicyLabelData null.",e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);else Hb="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);this.cZe(Ia,qb);Ia=this.QUc(Ia,void 0,this.ytc);this.ytc=null;Ia.extendedProperties.set("SetPolicyLabelDataFailureReason",this.Ddc);
Ia.extendedProperties.set("SetPolicyLabelDataParseStatus",Hb.toString());B.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Ia)}cZe(A,W=0){const oa=2===A||8===A||16===A;this.setPolicyLabel(this.Uba);this.Hmh(new mo);this.jnh(W,A,oa,!1)}Gsl(A,W){this.setPolicyLabel(this.Uba=A);if(""===A)L.AFrameworkApplication.Vx=!1,L.AFrameworkApplication.I5b=!1;else for(const oa of this.tv.SensitivityLabels)if(oa.Id===A){L.AFrameworkApplication.Vx=this.KBb(oa);break}this.I2k(new Wm(A,
W))}DTl(){for(const A of this.tv.SensitivityLabels)A&&A.Enabled&&(A.Id===this.Uba&&(this.Nlf=this.I3a!==A.Order,this.I3a=A.Order),A.Order>this.nHd&&(this.nHd=A.Order))}WQk(A){if(!({Su:A}=C.d(A)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!A)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!A.AreLabelsAvailable)return!1;this.tv=A;this.Uba=A.AppliedPolicyId;this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePdfProtectionUsageTelemetry",
!1)&&this.Ma.appSettings&&(this.Ma.appSettings.AppliedPolicyId=this.Uba);this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.DTl();this.Ftb()&&e.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.Hmh(new mo(!0));return!0}MEf(){if(!this.Ftb())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const A of this.tv.SensitivityLabels)if(A&&
A.AutoLabelingSensitiveTypeIds&&0<A.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}Hmh(A){e.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Oa.raiseEvent("LabelInfoUpdateEvent",A)}x1k(A){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Oa.raiseEvent("GetPolicyLabelEventKey",A)}dpd(){Sl.Fqd(!1);this.Oa.raiseEvent("GetPolicyLabelFailureEventKey",
new bp)}$Ue(A){this.JG&&this.JG.execute(W=>{W=[W.isFeatureEnabled("MsoClpSpTwo",!0),W.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(W).then(oa=>{ue.a.any(oa,xa=>xa)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Oa.raiseEvent("GetAutoPolicyLabelEventKey",A),this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.QOc(),Gd.a("MipAutoClassificationEnabled"));return null})})}bbe(A=null,W=null){const oa=new Map;
oa.set("ClpCoauth",this.Emb.toString());null!=A&&oa.set("ApplyLabelFlags",zk[A]);null!=W&&oa.set("GetPolicyLabelsReason",Wn[W]);return oa}QUc(A=null,W=null,oa=null){const xa=new ha.a;xa.extendedProperties=this.bbe(A,W);null!=oa&&(xa.durationMs=this.TF()-oa);return xa}I2k(A){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Oa.raiseEvent("SetPolicyLabelEventKey",A)}umh(A){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");A&&A.D3c&&Gd.a("MipRecommendations");
this.Oa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",A)}$mh(A){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Oa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",A)}G0k(A){e.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Oa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",A)}s2k(A){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");
this.Oa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",A)}xBl(A,W=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Oa.raiseEvent("PolicyTipEvent",new Tl(CommonUIStrings.l_PolicyBusinessBarTitle,A,CommonUIStrings.l_PolicyOverrideButton,W))}jnh(A,W,oa,xa=!0){e.ULS.sendTraceTag(42074656,306,xa?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",W);xa=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let Ia=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,
qb=null,Hb=null;switch(A){case 2:xa=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:Ia=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:xa=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:xa=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:xa=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:xa=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Ia=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:xa=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Ia=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,qb=CommonUIStrings.l_LearnMore,Hb=()=>{this.Krl()}}A=new Cn(A,W,oa,xa,Ia,qb,Hb);this.Oa.raiseEvent("SetPolicyLabelFailureEventKey",A)}X0e(A){this.JKd=A}sGk(){this.uEd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),eb.a.aUc(this.uEd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}P6j(A){if(!A.startsWith("<")||
-1===A.indexOf("Error")&&-1===A.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}wih(){this.DFc&&(this.DFc.stop(),this.DFc=null)}Qcj(A){if(!A)return"manual";switch(A.v8){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}Ydj(A){if(!A)return"privileged";
A=A.v8;let W="privileged";if(4===A||1===A)W="standard";return W}XVc(A,W,oa=null,xa=!1,Ia=0){this.Ma.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.Uba=A,this.AAa=oa,this.ki&&(this.E4a=this.ki.Ii("WebServiceCall","Call Get Policy Endpoint On Server")),oa={},oa[bl.a.YDf]=A,this.Ma.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(A=new jf.a(this.Syb("getpolicylabels",xa),1,null,oa,!0,2,Ia,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,W),this.ji.send(A).ckb(Object(n.a)(this,
this.gbh,"onGetPolicyLabelsSuccessCallback"),Object(n.a)(this,this.fbh,"onGetPolicyLabelsFailureCallback"))):this.ji.qj(this.Syb("getpolicylabels",xa),1,null,oa,!0,2,Object(n.a)(this,this.gbh,"onGetPolicyLabelsSuccessCallback"),Object(n.a)(this,this.fbh,"onGetPolicyLabelsFailureCallback"),Ia,void 0,void 0,void 0,void 0,"22"),this.dVb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.dVb))}Irl(A,W,oa,xa=null){if(this.m1c){this.ki&&(this.x6a=this.ki.Ii("WebServiceCall",
"Call Set Policy Endpoint On Server"));var Ia={};Ia[bl.a.E_e]=A;W&&(Ia[bl.a.k1e]=encodeURIComponent(W));this.JKd&&(Ia[bl.a.$Cf]=this.JKd);xa?(Ia[bl.a.i1e]=this.Qcj(xa),Ia[bl.a.j1e]=this.Ydj(xa),this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===xa.v8&&this.tv.DefaultLabelType&&(Ia[bl.a.aAh]=this.tv.DefaultLabelType)):(Ia[bl.a.i1e]="manual",Ia[bl.a.j1e]="privileged");this.Emb&&this.tv&&(Ia[bl.a.yih]=this.tv.PolicyLabelVersionToken);this.Ma.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(A=new jf.a(this.Syb("setpolicylabel",!0),1,null,Ia,!0,2,xa,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,oa),this.ji.send(A).ckb(Object(n.a)(this,this.qdh,"onSetPolicyLabelSuccessCallback"),Object(n.a)(this,this.pdh,"onSetPolicyLabelFailureCallback"))):this.ji.qj(this.Syb("setpolicylabel",!0),1,null,Ia,!0,2,Object(n.a)(this,this.qdh,"onSetPolicyLabelSuccessCallback"),Object(n.a)(this,this.pdh,"onSetPolicyLabelFailureCallback"),xa,void 0,void 0,void 0,void 0,
"32");this.hQa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.hQa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}Krl(){const A=new Ka.StandardDialog,W=this.Ma.Ha("BreadcrumbFolderUrl");W?(A.Ad=11,A.Le(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),A.Le(2,CommonUIStrings.l_DialogOk)):(A.Ad=0,A.Le(1,CommonUIStrings.l_DialogOk));
A.BTd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");A.u$k();A.zP(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,oa=>{1===oa&&W&&eb.a.In(W,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}a2d(A){switch(A){case 1:return xe.a.xDa(1,1);case 2:return xe.a.xDa(7,1);case 3:return xe.a.xDa(8,
1);default:return xe.a.xDa(7,0)}}KOi(A=null){if(!A)return xe.a.xDa(8,0);switch(A.v8){case 1:case 16:return xe.a.xDa(1,1);case 4:case 2:case 8:return xe.a.xDa(8,1);default:return xe.a.xDa(8,0)}}cYe(A){Fd.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",A)}}Object(h.a)(Hg,"PolicyManager",null,[666]);class Dn{constructor(){this.yPd=this.rNd=this.Pof=this.Lsf=this.Cdf=this.Kn=this.PPa=this.Ea=this.Mj=null}get name(){return"Common.App.Policy"}init(){L.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&
(L.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&L.AFrameworkApplication.Aa&&(this.Mj=this.Ea.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Mj.zki(Object(n.a)(this,this.wBl,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?nj.a.get_instance().Vj(5,()=>{this.Mj.Sae()}):nj.a.get_instance().Vj(6,()=>
{this.Mj.Sae()})),L.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&L.AFrameworkApplication.fa.ka("SupportsPolicies")?L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?nj.a.get_instance().Vj(5,Object(n.a)(this,this.R9g,"onAfterRibbonBehaviorAttached")):nj.a.get_instance().Vj(6,Object(n.a)(this,this.R9g,"onAfterRibbonBehaviorAttached")):(Sl.XUl(),Sl.Fqd(!1)))}dispose(){}Xb(A){A.register(666,"Common.App.Policy.Contracts.IPolicyManager").na().oa(()=>
new Hg(L.AFrameworkApplication.fa,L.AFrameworkApplication.Je,L.AFrameworkApplication.Aa.BV,L.AFrameworkApplication.fa.uc("MaxGetPolicyRetries",1),A.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),L.AFrameworkApplication.Aa.mb.Ti));A.register(Sl,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").na().oa(()=>new Sl(L.AFrameworkApplication.Qa,L.AFrameworkApplication.Aa,L.AFrameworkApplication.fa,A.ue("Common.App.Policy.Contracts.IPolicyManager")));this.Ea=
A}R9g(){this.Kn=this.Ea.rb("CommonUI.BusinessBar");this.Mj||(this.Mj=this.Ea.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.PPa=this.Ea.resolve("Common.App.Policy.PolicyActor");Fd.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Mj.mUd(Object(n.a)(this.PPa,this.PPa.bph,"registerActionsHandler")):this.PPa.vb();this.Mj.mUd(Object(n.a)(this,this.CTl,"updateLabelInfo"));L.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&
(this.Mj.DBf(Object(n.a)(this,this.$Ij,"handleSetPolicyLabelFailure")),this.Mj.Jhi(Object(n.a)(this,this.gJc,"addAutoPolicyBusinessBarEntry")),this.Mj.Lki(Object(n.a)(this,this.Dya,"removeAutoPolicyBusinessBarEntry")),this.Mj.Khi(Object(n.a)(this,this.GTd,"addMandatoryLabellingBusinessBarEntry")),this.Mj.Mki(Object(n.a)(this,this.OWe,"removeMandatoryLabellingBusinessBarEntry")))}CTl(){this.PPa.Crl();this.PPa.bql();this.PPa.P_k();const A=this.Mj.qCi();L.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&
!A?this.PPa.XMl():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",L.AFrameworkApplication.fa.ka("HasDocumentEditRights"),A);L.AFrameworkApplication.Aa.updateCommandUI()}wBl(A,W){this.rNd&&this.Kn.wea(38)&&this.Kn.removeEntry(this.rNd);A=this.ubg(W.title,W.ATk,38,W.uFk,W.buttonText);L.AFrameworkApplication.Aa.mb.hJc(A,!0)?(this.rNd=A,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):
e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}$Ij(A,W){W.gBl&&(this.yPd&&this.Kn.wea(21)&&this.Kn.removeEntry(this.yPd),A=this.ubg(W.title,W.message,21,null,null,W.q1b,W.buttonText),L.AFrameworkApplication.Aa.mb.hJc(A,!0)?(this.yPd=A,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Dya(A,
W){(A=W.D3c?this.Lsf:this.Cdf)&&this.Kn&&this.Kn.wea(W.nub)&&this.Kn.removeEntry(A)}gJc(A,W){this.Kn&&(this.Mj.Dya(W.nub),A=new fm.a(W.title,W.message,null),A.id=W.nub,A.closeable=!0,A.image=3,A.addButton(W.buttonText,W.q1b,W.buttonText,!0),this.Kn.li(A,!1),W.D3c?this.Lsf=A:this.Cdf=A)}GTd(A,W){this.Kn&&(A=new fm.a(W.title,W.message,null),A.id=W.nub,A.closeable=!1,A.image=3,A.addButton(W.buttonText,W.q1b,W.buttonText,!1),this.Kn.li(A,!1),this.Pof=A)}OWe(){const A=this.Pof;A&&this.Kn&&this.Kn.wea(A.id)&&
this.Kn.removeEntry(A)}ubg(A,W,oa,xa=null,Ia=null,qb=null,Hb=null){A=new fm.a(A,W,null);A.id=oa;A.closeable=!0;xa&&A.Gzf(Ia,xa);qb&&A.addButton(Hb,qb,Hb);return A}static main(){Za.a.instance.Ac(new Dn)}}Object(h.a)(Dn,"PackageManager",null,[2,3]);var Ul=d(254),Ji=d(324),Ap=d(138);class on extends Ji.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new Ap.a,{T_:on.getTypeName(),B_:on.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}
Object(h.a)(on,"SecurityShared",Ji.a,[]);class Xm extends on{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Ap.a,{T_:Xm.getTypeName(),B_:Xm.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(h.a)(Xm,"CLP",on,[]);var om=d(284),Xn=d(300),Bp=d(708);class cp extends Zk.a{constructor(A){super();this.TenantId=null;this.TenantId=A}ul(){return 103}}Object(h.a)(cp,"GetAppliedPolicyIdRequest",
Zk.a,[]);class Cp extends Sys.EventArgs{constructor(A){super();this.mja=A}}Object(h.a)(Cp,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class pn{constructor(A,W,oa){this.s1=this.UAe=this.I9c=null;this.va=new ek.a;this.Qbc=!1;this.ei=A;this.ieb=W;this.Ib=oa;this.ieb.Uii(Object(n.a)(this,this.c$g,"onAppliedPolicyIdReady"));this.ieb.Fji(Object(n.a)(this,this.Bbh,"onIsManuallyAppliedReady"))}Vii(A){this.va.addHandler("AppliedPolicyEventReceivedKey",A)}dispose(){this.ieb.nbl(Object(n.a)(this,this.c$g,
"onAppliedPolicyIdReady"));this.ieb.Kbl(Object(n.a)(this,this.Bbh,"onIsManuallyAppliedReady"))}Y5f(A,W){A?(this.s1=A,this.I9c=W,A=new dj.a(new cp(A),oa=>{this.Kkd(oa)},oa=>this.Eib(oa)),this.ei.Hb(A)):gd.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}Kmj(A,W){!W||ub.a.Xa(A)?gd.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.s1=A,this.UAe=W,A=new dj.a(new cp(A),oa=>{this.Kkd(oa)},oa=>this.Eib(oa)),this.ei.Hb(A))}c$g(A,W){A="";
ub.a.Xa(W.mja)||(A=W.mja);"00000000-0000-0000-0000-000000000000"===A?(W=ub.a.Xa(this.s1)?this.Ib.Ha("TenantId"):this.s1,this.Y5f(W,this.I9c)):this.tMe(A,null)}Bbh(A,W){this.IIk(W.Qbc)}Kkd(A){let W=null;A.ServerError&&0!==A.ServerError.Code?W=Ij.a[A.ServerError.Code]:0!==A.StatusCode&&(W=sh.a[A.StatusCode]);W&&this.tMe("",W)}Eib(){gd.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.tMe("","ErrorGetAppliedPolicyIdFailed");return!0}tMe(A,W){W&&gd.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+
W);this.I9c?this.I9c(A,W):gd.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");gd.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");A=new Cp(A);this.va.raiseEvent("AppliedPolicyEventReceivedKey",A)}IIk(A){this.UAe?this.UAe(A,null):gd.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(h.a)(pn,"AppliedPolicyIdService",null,[625,108]);class qn{constructor(A,W,oa,xa){this.tGb=A;this.SGa=W;this.IU=oa;this.la=xa}SQ(A){var W=A.automatic||
{},oa=W.sensitivityLabel||{};W=this.Pne()?W.id:oa.id;oa=A.recommended||{};const xa=oa.sensitivityLabel||{};A=this.Pne()?oa.id:xa.id;oa=this.Pne()?oa.policyTip:xa.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?this.tGb.bEf(W,A,oa,!this.IU.tv.AppliedPolicyId||!this.SGa.Qbc):this.tGb.bEf(W,A,oa,!this.IU.tv.AppliedPolicyId)}Pne(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(h.a)(qn,"AutoClpAnnotationEventHandler",null,[]);class gm{constructor(){this.ApplyLabelType=
0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(h.a)(gm,"PolicyInfo",null,[]);var Jk=d(1038);class pm{constructor(){this.gKb=this.startTime=null}}Object(h.a)(pm,"PollingData",null,[]);class Hm{constructor(A,W,oa,xa,Ia,qb,Hb,hc,Jc,ld,wd,Bd){this.v0g=this.cFb=!1;this.r8c=null;this.KKg=!1;this.ia=A;this.tGb=W;this.IU=oa;this.s1=xa;this.uCg=new Ga.a;this.Mlk=Ia;this.SGa=qb;this.wb=Hb;this.s0g=hc;this.Mq=Jc;
this.yE=ld;this.Uv=wd;this.pc=Bd;this.BSg=L.AFrameworkApplication.fa.uc("ClpLabelPollingIntervalMs",3E4);this.PFe=L.AFrameworkApplication.fa.uc("ClpLabelPollingTimeoutMs",3E5);this.Pna=L.AFrameworkApplication.fa.Ha("UserName");this.Hwk=L.AFrameworkApplication.fa.Ha("UserPrincipalName");this.qkk=this.gjj()}gjj(){let A;if(L.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(A=L.AFrameworkApplication.fa.Ha("EditDocInClientUrl"))return gd.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),
A;gd.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(A=L.AFrameworkApplication.fa.Ha("WOPISrc"))||gd.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");gd.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return A}dispose(){this.tGb=null;if(this.cFb){this.IU.Orh(Object(n.a)(this,this.odh,"onSetLabelSucceeded"));for(let A of this.uCg)this.IU.Orh(A)}}init(){this.tGb.vb();this.tGb.me();if(L.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&
L.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const A=Object(z.a)(Jk.a,kc.App.Oh);A&&this.IU.b7k(Object(n.a)(A,A.Hpi,"areAllCoauthorsInSessionClientMipTrusted"));this.IU.FQj(this.Mlk);0<this.BSg&&0<this.PFe&&this.SGa.Vii(Object(n.a)(this,this.UGk,"onDocumentContentPolicyChanged"));L.AFrameworkApplication.Xua&&this.s0g.H7k(()=>this.Mq.WTh);this.Mq.R4&&(gd.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.Mq.R4),this.IU.X0e(this.Mq.R4));this.yE.Jii(()=>{gd.a.J(512263629,
822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.Mq.R4);this.IU.X0e(this.Mq.R4)})}this.IU.Ili(Object(n.a)(this,this.Epi,"applyUdpLabeling"));this.IU.m8k(Object(n.a)(this,this.jYj,"isClpBlockedByAppSpecificScenario"));this.IU.Oii(Object(n.a)(this,this.Yoi,"applyMandatoryLabeling"));this.IU.NUd(Object(n.a)(this,this.odh,"onSetLabelSucceeded"));this.cFb=!0}Epi(A,W){W.Ixl&&L.AFrameworkApplication.Qa.processAction(bd.a.openInClient,2)}jYj(){const A=!this.pc.getState(2)&&!this.pc.dsg;
this.v0g!==A&&(this.pc.Pyg(),gd.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",A),this.v0g=A);return A}get mja(){return this.IU.tv.AppliedPolicyId}z8k(A){this.IU.NUd(A);this.uCg.add(A)}KSk(A,W,oa){const xa=new gm;xa.TenantId=this.s1;xa.LabelId=A;xa.ApplyLabelType=W;xa.LabelJson=Hm.q9i(C.c(oa));xa.SkipContentMarking=!1;xa.UserName=this.Pna;xa.UserPrincipalName=this.Hwk;xa.DocLocation=this.qkk;gd.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");
this.ia.Ja(bd.a.Zih,2,xa)}Yoi(A,W){if(W&&0!==W.BVd){(A=1===W.BVd)?this.Uv.aJh():(this.Uv.YIh(),""!==W.W4g&&this.s0g.Zoi(W.W4g));W=A?1:3;var oa=L.AFrameworkApplication.Qa.mode;W!==oa?gd.a.J(512263625,822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",W,oa):this.KKg=A}else gd.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}odh(A,W){this.KSk(W.xih,W.v8,this.IU.tv);gd.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}U7d(A){A&&
this.mja?A=this.mja.toLowerCase()===A.toLowerCase():(gd.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",!A,!this.mja),A=A===this.mja);gd.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",A);return A}ETk(A){const W=Object(z.a)(pm,A.customData);if(W){var oa=+new Date-+W.startTime;gd.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",
oa);this.U7d(W.gKb)||oa>this.PFe||W.gKb!==this.r8c?(gd.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.U7d(W.gKb),oa>this.PFe,W.gKb!==this.r8c),this.wb.Kg(A)):(gd.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.IU.XTa(W.gKb,void 0,Hm.XQa,!0))}else gd.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.wb.Kg(A)}XGl(A){gd.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");
const W=new ee.a(2,2,this.BSg,Object(n.a)(this,this.ETk,"pollingTaskCallback"),90,"113");W.customData=Object.assign(new pm,{startTime:new Date,gKb:A});this.wb.Hb(W)}UGk(A,W){gd.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");W.mja||gd.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.r8c=W.mja;this.U7d(this.r8c)?gd.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):
this.XGl(W.mja)}static XQa(){const A=kc.App.Oh.amIAlone,W=kc.App.Oh.XQa;let oa=!1;const xa=Object(z.a)(Jk.a,kc.App.Oh);xa&&(oa=xa.Ipi());gd.a.J(512263585,822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",A,W,oa);return A||W&&oa}static q9i(A){A=A.replace(RegExp(":null","gi"),':""');return A=A.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(h.a)(Hm,"PptPolicyManager",null,[108]);class dp{constructor(A,W,oa,xa){this.jik=
A;this.ic=W;this.Fb=oa;this.la=xa}vb(){this.jik.ra(bd.a.Zih,mh.a.application,Object(n.a)(this,this.aDj,"handleApplySensitivity"),4)}me(){}aDj(A,W,oa,xa,Ia){if(!(L.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&L.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&L.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(W.contextId!==mh.a.application)return 2;if(!Ia||!Object(Oh.a)(gm,
Ia))return 8;A=Object(z.a)(gm,Ia);if(ub.a.Xa(A.TenantId))return gd.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),8;if(ub.a.Xa(A.LabelJson))return gd.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===oa)return 32;oa=this.ic.yn;W=this.Fb.yd(7);try{W.jc(oa),oa.hKb=A}finally{W&&W.dispose()}return 32}}Object(h.a)(dp,"SetPolicyActor",null,[268]);class Im{constructor(){this.Jec=this.Wcd=this.Ib=this.SGa=this.K=null;this.$Yg=!0}get name(){return"PowerPointWebEditor.Policy"}Xb(A){this.K=
A;this.K.register(625,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").na().oa(()=>new pn(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.Ib=this.K.resolve("Common.IAppSettingsManager");this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.Ib.Ybb(Object(n.a)(this,this.jn,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").$e(Object(n.a)(this,
this.jn,"onFullAppSettingsReady"))}dispose(){}jn(){this.Ib.ka("WacLabelingPoliciesIsEnabled")&&this.Ib.ka("SupportsPolicies")&&this.Ib.ka("890")&&(this.SGa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),nj.a.get_instance().Vj(10,Object(n.a)(this,this.BEk,"onAfterRibbonDisplayed")),Ul.a.Ot(this.K.Ia("Common.App.Policy.Contracts.IPolicyManager")).continueWith(A=>{const W=new dp(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));A=A.result;this.Wcd=new Hm(this.K.resolve("Common.IActionManagerExtended"),W,A,this.Ib.Ha("TenantId"),this.K.Ia("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.Wcd.init()}))}BEk(){Ul.a.Ot(this.K.Ia("Common.App.Policy.Contracts.IPolicyManager")).continueWith(A=>{const W=A.result;L.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(gd.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.Jec=new rc.a(()=>new qn(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),
W,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.Ib.Ha("TenantId"))),W.vii(Object(n.a)(this,this.d7k,"registerAutoClpAnnotationEventHandler")),L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(W.eii(Object(n.a)(this,this.QOc,"createAutoCLPSecurityNodes")),W.Kli(Object(n.a)(this,this.NRl,"updateAutoCLPLabelPriorityNode")),W.Lli(Object(n.a)(this,this.ORl,"updateAutoCLPSITNodes"))));(A=this.Ib.Ha("AppliedPolicyId"))||L.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&
L.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?L.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?W.XTa(A,void 0,Hm.XQa):W.XTa(A):(A=this.Ib.Ha("TenantId"),ub.a.Xa(A)?gd.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(gd.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.SGa.Y5f(A,(oa,xa)=>{xa&&gd.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+
xa);ub.a.Xa(oa)&&(oa="",gd.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));L.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?W.XTa(oa,void 0,Hm.XQa):W.XTa(oa)}),this.SGa.Kmj(A,(oa,xa)=>{xa?gd.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+xa):this.SGa.Qbc=oa}),this.Wcd.z8k(Object(n.a)(this,this.ATl,"updateIsManuallyApplied"))))})}d7k(){const A=
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.$Yg&&(A.Ho||this.Wcd.KKg&&A.rcc)&&(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(W=>{gd.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?(W.kQ("AugLoop_SecurityClp_LabellingAnnotation"),W.B6("AugLoop_SecurityClp_LabellingAnnotation",Object(n.a)(this.Jec.value,
this.Jec.value.SQ,"handleAnnotationEvent"))):(W.kQ("AugLoop_Automatic_Clp_LabellingAnnotation"),W.B6("AugLoop_Automatic_Clp_LabellingAnnotation",Object(n.a)(this.Jec.value,this.Jec.value.SQ,"handleAnnotationEvent")))}),this.$Yg=!1)}QOc(A,W){A=[Object.assign(new Xn.a,{id:"clp",body:Object.assign(new Xm,{existingLabelPriority:W.existingLabelPriority,partialDocSITs:W.kNf,fullDocSITs:W.jNf})})];const oa=Object.assign(new om.a,{parentPath:["session","doc","security"],items:A});this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(xa=>
{gd.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");xa.submitOperation(oa)})}NRl(A,W){A=[Object.assign(new Xn.a,{id:"clp",body:Object.assign(new Xm,{existingLabelPriority:W.existingLabelPriority})})];const oa=Object.assign(new Bp.a,{parentPath:["session","doc","security"],items:A});this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(xa=>{gd.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");
xa.submitOperation(oa)})}ORl(A,W){A=[Object.assign(new Xn.a,{id:"clp",body:Object.assign(new Xm,{partialDocSITs:W.kNf,fullDocSITs:W.jNf})})];const oa=Object.assign(new Bp.a,{parentPath:["session","doc","security"],items:A});this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(xa=>{gd.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");xa.submitOperation(oa)})}ATl(A,W){W&&(this.SGa.Qbc=W.xih&&0!==W.v8?2===W.v8||8===W.v8||16===
W.v8?!0:!1:!1)}static main(){Za.a.instance.Ac(new Im)}}Object(h.a)(Im,"PPTWebEditorPolicyPackage",null,[2,3]);var tk=d(13);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");
Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Object(tk.c)("Chronosslim");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
Na.main();Type.registerNamespace("Common.App.CatchUpActivity");wb.main();Type.registerNamespace("Common.App.Rename");Za.a.instance.Ac(new wc,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");Za.a.instance.Ac(new fe);Type.registerNamespace("Common.App.SafeLinks");ge.main();mi.main();Bl.main();qc.main();Of.main();yn.main();I.main();Za.a.instance.Ac(new Ho);Io.main();Za.a.instance.Ac(new lo);Sk.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");
Type.registerNamespace("Common.App.Policy");Dn.main();Im.main();Object(tk.b)("Chronosslim")},215:function(K,S,d){K=d(0);var h=d(55);class e{constructor(n,z,t,x,B){this.QHa=!1;this.JEb=n;this.ODb=z;this.Rec=t;this.Cnk=B;this.fGb=x.WEa(t,z.name)}get RHf(){return this.Rec}Xb(n){this.fGb.iGf();this.ODb.Xb(n);this.fGb.OYf()}init(){this.fGb.du(this.ODb.name+"_d");this.Cnk?this.JEb.DQj(this,this.Rec):this.JEb.CQj(this,this.Rec)}BQj(){this.fGb.lu(this.ODb.name+"_d");this.fGb.kGf();this.ODb.init();this.QHa=
!0;this.fGb.RYf()}dispose(){this.QHa&&this.ODb.dispose()}get name(){return this.ODb.name}}Object(K.a)(e,"DelayLoadedPackage",null,[823,2,3]);class r{constructor(n,z){this.JEb=null;n.execute(t=>{this.JEb=t});this.Zik=z}create(n,z,t){return this.JEb?new e(this.JEb,n,z,this.Zik.value,t):n}static get instance(){return r.La||(r.La=new r(h.a.instance.Ia("PowerPointWebEditor.DelayLoadedPackageInitializer"),h.a.instance.ue("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}r.La=null;Object(K.a)(r,"DelayLoadedPackageFactory",
null,[]);d.d(S,"a",function(){return m});const m=(n,z)=>r.instance.create(n,z,!1)},706:function(K,S,d){(function(h){function e(){try{var Y=new Uint8Array(1);Y.__proto__={__proto__:Uint8Array.prototype,Y0l:function(){return 42}};return"function"===typeof Y.subarray&&0===Y.subarray(1,1).byteLength}catch(fa){return!1}}function r(Y,fa){if((m.F2?2147483647:1073741823)<fa)throw new RangeError("Invalid typed array length");m.F2?(Y=new Uint8Array(fa),Y.__proto__=m.prototype):(null===Y&&(Y=new m(fa)),Y.length=
fa);return Y}function m(Y,fa,aa){if(!(m.F2||this instanceof m))return new m(Y,fa,aa);if("number"===typeof Y){if("string"===typeof fa)throw Error("If encoding is specified then the first argument must be a string");return t(this,Y)}return n(this,Y,fa,aa)}function n(Y,fa,aa,ka){if("number"===typeof fa)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&fa instanceof ArrayBuffer){fa.byteLength;if(0>aa||fa.byteLength<aa)throw new RangeError("'offset' is out of bounds");
if(fa.byteLength<aa+(ka||0))throw new RangeError("'length' is out of bounds");fa=void 0===aa&&void 0===ka?new Uint8Array(fa):void 0===ka?new Uint8Array(fa,aa):new Uint8Array(fa,aa,ka);m.F2?(Y=fa,Y.__proto__=m.prototype):Y=x(Y,fa);fa=Y}else if("string"===typeof fa){ka=Y;Y=aa;if("string"!==typeof Y||""===Y)Y="utf8";if(!m.Noe(Y))throw new TypeError('"encoding" must be a valid string encoding');aa=w(fa,Y)|0;ka=r(ka,aa);fa=ka.write(fa,Y);fa!==aa&&(ka=ka.slice(0,fa));fa=ka}else fa=B(Y,fa);return fa}function z(Y){if("number"!==
typeof Y)throw new TypeError('"size" argument must be a number');if(0>Y)throw new RangeError('"size" argument must not be negative');}function t(Y,fa){z(fa);Y=r(Y,0>fa?0:D(fa)|0);if(!m.F2)for(var aa=0;aa<fa;++aa)Y[aa]=0;return Y}function x(Y,fa){var aa=0>fa.length?0:D(fa.length)|0;Y=r(Y,aa);for(var ka=0;ka<aa;ka+=1)Y[ka]=fa[ka]&255;return Y}function B(Y,fa){if(m.isBuffer(fa)){var aa=D(fa.length)|0;Y=r(Y,aa);if(0===Y.length)return Y;fa.copy(Y,0,0,aa);return Y}if(fa){if("undefined"!==typeof ArrayBuffer&&
fa.buffer instanceof ArrayBuffer||"length"in fa)return(aa="number"!==typeof fa.length)||(aa=fa.length,aa=aa!==aa),aa?r(Y,0):x(Y,fa);if("Buffer"===fa.type&&ca(fa.data))return x(Y,fa.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function D(Y){if(Y>=(m.F2?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(m.F2?2147483647:1073741823).toString(16)+" bytes");return Y|0}function w(Y,fa){if(m.isBuffer(Y))return Y.length;
if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(Y)||Y instanceof ArrayBuffer))return Y.byteLength;"string"!==typeof Y&&(Y=""+Y);var aa=Y.length;if(0===aa)return 0;for(var ka=!1;;)switch(fa){case "ascii":case "latin1":case "binary":return aa;case "utf8":case "utf-8":case void 0:return Q(Y).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*aa;case "hex":return aa>>>1;case "base64":return O(Y).length;default:if(ka)return Q(Y).length;
fa=(""+fa).toLowerCase();ka=!0}}function J(Y,fa,aa){var ka=!1;if(void 0===fa||0>fa)fa=0;if(fa>this.length)return"";if(void 0===aa||aa>this.length)aa=this.length;if(0>=aa)return"";aa>>>=0;fa>>>=0;if(aa<=fa)return"";for(Y||(Y="utf8");;)switch(Y){case "hex":Y=fa;fa=aa;aa=this.length;if(!Y||0>Y)Y=0;if(!fa||0>fa||fa>aa)fa=aa;ka="";for(aa=Y;aa<fa;++aa)Y=ka,ka=this[aa],ka=16>ka?"0"+ka.toString(16):ka.toString(16),ka=Y+ka;return ka;case "utf8":case "utf-8":return M(this,fa,aa);case "ascii":Y="";for(aa=Math.min(this.length,
aa);fa<aa;++fa)Y+=String.fromCharCode(this[fa]&127);return Y;case "latin1":case "binary":Y="";for(aa=Math.min(this.length,aa);fa<aa;++fa)Y+=String.fromCharCode(this[fa]);return Y;case "base64":return 0===fa&&aa===this.length?T.y4f(this):T.y4f(this.slice(fa,aa));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":fa=this.slice(fa,aa);aa="";for(Y=0;Y<fa.length;Y+=2)aa+=String.fromCharCode(fa[Y]+256*fa[Y+1]);return aa;default:if(ka)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase();
ka=!0}}function F(Y,fa,aa,ka,H){if(0===Y.length)return-1;"string"===typeof aa?(ka=aa,aa=0):2147483647<aa?aa=2147483647:-2147483648>aa&&(aa=-2147483648);aa=+aa;isNaN(aa)&&(aa=H?0:Y.length-1);0>aa&&(aa=Y.length+aa);if(aa>=Y.length){if(H)return-1;aa=Y.length-1}else if(0>aa)if(H)aa=0;else return-1;"string"===typeof fa&&(fa=m.from(fa,ka));if(m.isBuffer(fa))return 0===fa.length?-1:L(Y,fa,aa,ka,H);if("number"===typeof fa)return fa&=255,m.F2&&"function"===typeof Uint8Array.prototype.indexOf?H?Uint8Array.prototype.indexOf.call(Y,
fa,aa):Uint8Array.prototype.lastIndexOf.call(Y,fa,aa):L(Y,[fa],aa,ka,H);throw new TypeError("val must be string, number or Buffer");}function L(Y,fa,aa,ka,H){function ra(na,wa){return 1===ha?na[wa]:na.x4k(wa*ha)}var ha=1,Ma=Y.length,Ga=fa.length;if(void 0!==ka&&(ka=String(ka).toLowerCase(),"ucs2"===ka||"ucs-2"===ka||"utf16le"===ka||"utf-16le"===ka)){if(2>Y.length||2>fa.length)return-1;ha=2;Ma/=2;Ga/=2;aa/=2}if(H)for(ka=-1;aa<Ma;aa++)if(ra(Y,aa)===ra(fa,-1===ka?0:aa-ka)){if(-1===ka&&(ka=aa),aa-ka+
1===Ga)return ka*ha}else-1!==ka&&(aa-=aa-ka),ka=-1;else for(aa+Ga>Ma&&(aa=Ma-Ga);0<=aa;aa--){Ma=!0;for(ka=0;ka<Ga;ka++)if(ra(Y,aa+ka)!==ra(fa,ka)){Ma=!1;break}if(Ma)return aa}return-1}function M(Y,fa,aa){aa=Math.min(Y.length,aa);for(var ka=[];fa<aa;){var H=Y[fa],ra=null,ha=239<H?4:223<H?3:191<H?2:1;if(fa+ha<=aa)switch(ha){case 1:128>H&&(ra=H);break;case 2:var Ma=Y[fa+1];128===(Ma&192)&&(H=(H&31)<<6|Ma&63,127<H&&(ra=H));break;case 3:Ma=Y[fa+1];var Ga=Y[fa+2];128===(Ma&192)&&128===(Ga&192)&&(H=(H&15)<<
12|(Ma&63)<<6|Ga&63,2047<H&&(55296>H||57343<H)&&(ra=H));break;case 4:Ma=Y[fa+1];Ga=Y[fa+2];var na=Y[fa+3];128===(Ma&192)&&128===(Ga&192)&&128===(na&192)&&(H=(H&15)<<18|(Ma&63)<<12|(Ga&63)<<6|na&63,65535<H&&1114112>H&&(ra=H))}null===ra?(ra=65533,ha=1):65535<ra&&(ra-=65536,ka.push(ra>>>10&1023|55296),ra=56320|ra&1023);ka.push(ra);fa+=ha}Y=ka.length;if(Y<=N)ka=String.fromCharCode.apply(String,ka);else{aa="";for(fa=0;fa<Y;)aa+=String.fromCharCode.apply(String,ka.slice(fa,fa+=N));ka=aa}return ka}function Q(Y,
fa){fa=fa||Infinity;for(var aa,ka=Y.length,H=null,ra=[],ha=0;ha<ka;++ha){aa=Y.charCodeAt(ha);if(55295<aa&&57344>aa){if(!H){if(56319<aa){-1<(fa-=3)&&ra.push(239,191,189);continue}else if(ha+1===ka){-1<(fa-=3)&&ra.push(239,191,189);continue}H=aa;continue}if(56320>aa){-1<(fa-=3)&&ra.push(239,191,189);H=aa;continue}aa=(H-55296<<10|aa-56320)+65536}else H&&-1<(fa-=3)&&ra.push(239,191,189);H=null;if(128>aa){if(0>--fa)break;ra.push(aa)}else if(2048>aa){if(0>(fa-=2))break;ra.push(aa>>6|192,aa&63|128)}else if(65536>
aa){if(0>(fa-=3))break;ra.push(aa>>12|224,aa>>6&63|128,aa&63|128)}else if(1114112>aa){if(0>(fa-=4))break;ra.push(aa>>18|240,aa>>12&63|128,aa>>6&63|128,aa&63|128)}else throw Error("Invalid code point");}return ra}function C(Y){for(var fa=[],aa=0;aa<Y.length;++aa)fa.push(Y.charCodeAt(aa)&255);return fa}function O(Y){var fa=T,aa=fa.dLl;Y=(Y.trim?Y.trim():Y.replace(/^\s+|\s+$/g,"")).replace(da,"");if(2>Y.length)Y="";else for(;0!==Y.length%4;)Y+="=";return aa.call(fa,Y)}function U(Y,fa,aa,ka){for(var H=
0;H<ka&&!(H+aa>=fa.length||H>=Y.length);++H)fa[H+aa]=Y[H];return H}var T=d(1174);d(1175);var ca=d(1176);S.bBd=m;S.m0l=function(Y){+Y!=Y&&(Y=0);return m.yCf(+Y)};S.Z_l=50;m.F2=void 0!==h.F2?h.F2:e();S.v1l=m.F2?2147483647:1073741823;m.from=function(Y,fa,aa){return n(null,Y,fa,aa)};m.F2&&(m.prototype.__proto__=Uint8Array.prototype,m.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&m[Symbol.species]===m&&Object.defineProperty(m,Symbol.species,{value:null,configurable:!0}));m.yCf=function(Y){z(Y);
return r(null,Y)};m.uni=function(Y){return t(null,Y)};m.isBuffer=function(Y){return!(null==Y||!Y.C2h)};m.compare=function(Y,fa){if(!m.isBuffer(Y)||!m.isBuffer(fa))throw new TypeError("Arguments must be Buffers");if(Y===fa)return 0;for(var aa=Y.length,ka=fa.length,H=0,ra=Math.min(aa,ka);H<ra;++H)if(Y[H]!==fa[H]){aa=Y[H];ka=fa[H];break}return aa<ka?-1:ka<aa?1:0};m.Noe=function(Y){switch(String(Y).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};m.concat=function(Y,fa){if(!ca(Y))throw new TypeError('"list" argument must be an Array of Buffers');if(0===Y.length)return m.yCf(0);var aa;if(void 0===fa)for(aa=fa=0;aa<Y.length;++aa)fa+=Y[aa].length;fa=m.uni(fa);var ka=0;for(aa=0;aa<Y.length;++aa){var H=Y[aa];if(!m.isBuffer(H))throw new TypeError('"list" argument must be an Array of Buffers');H.copy(fa,ka);ka+=H.length}return fa};m.byteLength=w;m.prototype.C2h=!0;m.prototype.toString=function(){var Y=this.length|0;return 0===
Y?"":0===arguments.length?M(this,0,Y):J.apply(this,arguments)};m.prototype.equals=function(Y){if(!m.isBuffer(Y))throw new TypeError("Argument must be a Buffer");return this===Y?!0:0===m.compare(this,Y)};m.prototype.compare=function(Y,fa,aa,ka,H){if(!m.isBuffer(Y))throw new TypeError("Argument must be a Buffer");void 0===fa&&(fa=0);void 0===aa&&(aa=Y?Y.length:0);void 0===ka&&(ka=0);void 0===H&&(H=this.length);if(0>fa||aa>Y.length||0>ka||H>this.length)throw new RangeError("out of range index");if(ka>=
H&&fa>=aa)return 0;if(ka>=H)return-1;if(fa>=aa)return 1;fa>>>=0;aa>>>=0;ka>>>=0;H>>>=0;if(this===Y)return 0;var ra=H-ka,ha=aa-fa,Ma=Math.min(ra,ha);ka=this.slice(ka,H);Y=Y.slice(fa,aa);for(fa=0;fa<Ma;++fa)if(ka[fa]!==Y[fa]){ra=ka[fa];ha=Y[fa];break}return ra<ha?-1:ha<ra?1:0};m.prototype.includes=function(Y,fa,aa){return-1!==this.indexOf(Y,fa,aa)};m.prototype.indexOf=function(Y,fa,aa){return F(this,Y,fa,aa,!0)};m.prototype.lastIndexOf=function(Y,fa,aa){return F(this,Y,fa,aa,!1)};m.prototype.write=
function(Y,fa,aa,ka){if(void 0===fa)ka="utf8",aa=this.length,fa=0;else if(void 0===aa&&"string"===typeof fa)ka=fa,aa=this.length,fa=0;else if(isFinite(fa))fa|=0,isFinite(aa)?(aa|=0,void 0===ka&&(ka="utf8")):(ka=aa,aa=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var H=this.length-fa;if(void 0===aa||aa>H)aa=H;if(0<Y.length&&(0>aa||0>fa)||fa>this.length)throw new RangeError("Attempt to write outside buffer bounds");ka||(ka="utf8");for(H=!1;;)switch(ka){case "hex":fa=
Number(fa)||0;ka=this.length-fa;aa?(aa=Number(aa),aa>ka&&(aa=ka)):aa=ka;ka=Y.length;if(0!==ka%2)throw new TypeError("Invalid hex string");aa>ka/2&&(aa=ka/2);for(ka=0;ka<aa;++ka){H=parseInt(Y.substr(2*ka,2),16);if(isNaN(H))break;this[fa+ka]=H}return ka;case "utf8":case "utf-8":return U(Q(Y,this.length-fa),this,fa,aa);case "ascii":return U(C(Y),this,fa,aa);case "latin1":case "binary":return U(C(Y),this,fa,aa);case "base64":return U(O(Y),this,fa,aa);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":ka=
Y;H=this.length-fa;for(var ra=[],ha=0;ha<ka.length&&!(0>(H-=2));++ha){var Ma=ka.charCodeAt(ha);Y=Ma>>8;Ma%=256;ra.push(Ma);ra.push(Y)}return U(ra,this,fa,aa);default:if(H)throw new TypeError("Unknown encoding: "+ka);ka=(""+ka).toLowerCase();H=!0}};m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.q0l||this,0)}};var N=4096;m.prototype.slice=function(Y,fa){var aa=this.length;Y=~~Y;fa=void 0===fa?aa:~~fa;0>Y?(Y+=aa,0>Y&&(Y=0)):Y>aa&&(Y=aa);0>fa?(fa+=aa,0>fa&&(fa=
0)):fa>aa&&(fa=aa);fa<Y&&(fa=Y);if(m.F2)fa=this.subarray(Y,fa),fa.__proto__=m.prototype;else{aa=fa-Y;fa=new m(aa,void 0);for(var ka=0;ka<aa;++ka)fa[ka]=this[ka+Y]}return fa};m.prototype.x4k=function(Y){if(0!==Y%1||0>Y)throw new RangeError("offset is not uint");if(Y+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[Y]<<8|this[Y+1]};m.prototype.copy=function(Y,fa,aa,ka){aa||(aa=0);ka||0===ka||(ka=this.length);fa>=Y.length&&(fa=Y.length);fa||(fa=0);0<ka&&ka<aa&&
(ka=aa);if(ka===aa||0===Y.length||0===this.length)return 0;if(0>fa)throw new RangeError("targetStart out of bounds");if(0>aa||aa>=this.length)throw new RangeError("sourceStart out of bounds");if(0>ka)throw new RangeError("sourceEnd out of bounds");ka>this.length&&(ka=this.length);Y.length-fa<ka-aa&&(ka=Y.length-fa+aa);var H=ka-aa;if(this===Y&&aa<fa&&fa<ka)for(ka=H-1;0<=ka;--ka)Y[ka+fa]=this[ka+aa];else if(1E3>H||!m.F2)for(ka=0;ka<H;++ka)Y[ka+fa]=this[ka+aa];else Uint8Array.prototype.set.call(Y,this.subarray(aa,
aa+H),fa);return H};m.prototype.fill=function(Y,fa,aa,ka){if("string"===typeof Y){"string"===typeof fa?(ka=fa,fa=0,aa=this.length):"string"===typeof aa&&(ka=aa,aa=this.length);if(1===Y.length){var H=Y.charCodeAt(0);256>H&&(Y=H)}if(void 0!==ka&&"string"!==typeof ka)throw new TypeError("encoding must be a string");if("string"===typeof ka&&!m.Noe(ka))throw new TypeError("Unknown encoding: "+ka);}else"number"===typeof Y&&(Y&=255);if(0>fa||this.length<fa||this.length<aa)throw new RangeError("Out of range index");
if(aa<=fa)return this;fa>>>=0;aa=void 0===aa?this.length:aa>>>0;Y||(Y=0);if("number"===typeof Y)for(ka=fa;ka<aa;++ka)this[ka]=Y;else for(Y=m.isBuffer(Y)?Y:Q((new m(Y,ka)).toString()),H=Y.length,ka=0;ka<aa-fa;++ka)this[ka+fa]=Y[ka%H];return this};var da=/[^+\/0-9A-Za-z-_]/g}).call(this,d(1E3))},707:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r,m,n,z,t,x,B=null,D=null,w=!1,J=null,F=null,L=null,M=null,Q=!1,C=null,O=null,U=null,T=null,ca=null,N=null){this.url=e;this.VXl=
r;this.body=m;this.headers=n;this.j3e=z;this.priority=t;this.state=x;this.lTh=B;this.dsc=D;this.Zi=w;this.z0k=J;this.Qml=F;this.name=L;this.Qib=M;this.R9d=Q;this.Dld=C;this.ry=O;this.KAb=U;this.NMb=T;this.PMj=ca;this.responseType=N}}Object(K.a)(h,"ClientRequest",null,[])},708:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);S=d(529);var h=d(138);class e extends S.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}
Object(K.a)(e,"UpdateOperation",S.a,[])},750:function(K,S,d){K=d(0);var h=d(27),e=d(103),r=d(82),m=d(7),n=d(36),z=d(87),t=d(28),x=d(248);class B{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(K.a)(B,"PodsInfo",null,[]);d.d(S,"a",function(){return D});
class D{constructor(w,J,F,L,M,Q,C){t.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Ib=C;this.Qr=w;this.Ya=J;this.Mc=F;this.Hz=L;this.Vd=M;this.wb=Q;this.cFb=!1;this.ZYa=0;this.Ib.$e(Object(m.a)(this,this.initialize,"initialize"))}initialize(){t.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.Mc.qB(Object(m.a)(this,this.Hn,"onSessionRehydrated"));this.Hz.Ysb(Object(m.a)(this,this.hga,"onPodSessionRefreshed"));this.cFb=!0}dispose(){this.cFb&&
(this.Mc.Raa(Object(m.a)(this,this.Hn,"onSessionRehydrated")),this.Hz.qkb(Object(m.a)(this,this.hga,"onPodSessionRefreshed")),this.cFb=!1)}sendInfoToPods(){var w=this.Ib.Ha("361"),J=this.Ya.podSessionId;const F=this.Ya.Ck,L=h.AFrameworkApplication.userSessionId,M=e.a.create().toString();t.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",M);w=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",w,J);J={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};J["X-UserSessionId"]=L;J["X-CorrelationID"]=M;J["X-WacCluster"]=F;try{const Q=Object.assign(new B,{UserName:this.Ib.Ha(z.a.uQk),UserId:this.Ib.Ha("387"),ProviderId:this.Ib.Ha("388"),FileSource:this.Ib.Ha("FileSource"),LoggableUserId:this.Ib.Ha("LoggableUserId"),TenantId:this.Ib.Ha("TenantId"),BrowserCacheAllowed:this.Ib.ka("535")&&this.Ib.ka("431"),EnableMacrosForProtectedFile:h.AFrameworkApplication.I5b,ServerDocId:this.Ib.Ha("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ha("ComplianceDomainPrefix"),
IsO365CommercialHost:this.Ib.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.Ib.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Ib.ka("PPTClpSwitchEnabled")&&this.Ib.ka("SupportsOfficeClientCoauthoring")}),C=n.c(Q);this.Qr.qj(w,2,C,J,!1,1,Object(m.a)(this,this.LLk,"onSendUserInfoSucceeded"),Object(m.a)(this,this.KLk,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,x.a("6"))}catch(Q){t.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",Q)}}LLk(){t.a.J(512262869,
804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.ZYa=0}KLk(){t.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.ZYa?this.uhl():this.KBj()}uhl(){this.ZYa++;t.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.ZYa);const w=new r.a(1,1,5E3,Object(m.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.wb.Hb(w)}KBj(){t.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",
this.ZYa);this.Vd.rH(307,null);this.ZYa=0}Hn(){this.ZYa=0;t.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}hga(){this.ZYa=0;t.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(K.a)(D,"PodsInfoSender",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.chronosslim.js.map