'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1017:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(h||(h={}));Object(K.b)("ChannelConnectionState",h)},1018:function(K,S,d){d.r(S);d.d(S,"MaxOutstandingThrottler",function(){return m});K=d(0);var h=d(7),e=d(78);S=d(1019);var r=d(746);class m extends S.a{constructor(n,z=""){super(n,z);this.Phb=
this.TMa=0;this.Oa=new e.a;this.pqb=!1;this.MEc=this.nAc=this.Wzc=this.qRd=0;this.ZHc=[];this.clearTimeout=m.P3d}add(n){this.qqb||this.init(m.TTf,m.ITf);this.Q6a++;const z=new r.a;this.vBb?this.eud(n,z):this.MEc<this.Phb?this.dtc(n,z):(this.eud(n,z),this.pqb=!1);return z}dtc(n,z){n=this.Auf(n);const t=this.setTimeout(Object(h.a)(this,this.oJk,"onMessageWaitTimeExpired"),this.TMa);++this.MEc;Array.add(this.ZHc,t);const x=this.Wzc;n.hkd(B=>{z.Hlc(B)});n.gkd(B=>{this.Wzc===x&&(this.nJk(x,t),z.SZa(B))})}nJk(n,
z){this.Wzc===n&&(--this.MEc,this.clearTimeout(z),Array.remove(this.ZHc,z),this.vBb&&this.Iml())}Iml(){this.vBb&&!this.pqb&&(this.qRd=this.setTimeout(Object(h.a)(this,this.Jml,"sendThrottledMessageFromTimer"),0),this.pqb=!0)}Jml(){this.pqb=!1;if(this.vBb){const n=this.VHc,z=this.qsb;this.s2b(!1);this.dtc(n,z)}}oJk(){++this.nAc;this.nAc>Math.floor(this.Phb/2)&&(this.nAc=-1E9,this.Oa.raiseEvent("TMUDM"))}dKc(n){this.Oa.addHandler("TMUDM",n)}reset(){this.Q6a=this.KZb=this.jUb=this.nAc=0;++this.Wzc;for(const n of this.ZHc)this.clearTimeout(n);
this.MEc=0;this.ZHc=[];this.s2b(!0);this.pqb&&(this.clearTimeout(this.qRd),this.qRd=0,this.pqb=!1)}init(n,z){this.qqb||(this.TMa=n,this.Phb=z,this.qqb=!0)}static createInstance(n,z=""){return new m(n,z)}static P3d(n){window.clearTimeout(n)}}m.TTf=15E3;m.ITf=5;Object(K.a)(m,"MaxOutstandingThrottler",S.a,[1224,1225])},1019:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(395);class e{constructor(r,m=""){this.jUb=this.KZb=0;this.VId=!1;this.qsb=this.VHc=null;this.qqb=!1;this.Auf=r;this.fLh=
m;this.setTimeout=e.Z3d;this.Q6a=this.KZb=this.jUb=0}NVe(){0<this.Q6a&&0<this.jUb&&h.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.fLh,this.jUb,this.Q6a);0<this.Q6a&&0<this.KZb&&h.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.fLh,this.KZb,this.Q6a)}get vBb(){return this.VId}eud(r,m){this.KZb++;this.s2b(!0);this.VId=!0;this.VHc=r;this.qsb=m}s2b(r){this.VId=!1;this.qsb&&r&&(this.jUb++,this.qsb.MJe());this.qsb=
this.VHc=null}static Z3d(r,m){return window.setTimeout(r,m)}}Object(K.a)(e,"ThrottlerBase",null,[])},1020:function(K,S,d){d.r(S);d.d(S,"MaxRateThrottler",function(){return r});K=d(0);var h=d(7);S=d(1019);var e=d(746);class r extends S.a{constructor(m,n=""){super(m,n);this.Rhb=0;this.AWb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(m){this.qqb||(this.Rhb=m,this.qqb=!0)}add(m){this.qqb||this.init(r.CTf);this.Q6a++;const n=this.currentTime(),z=new e.a;this.AWb>n&&(this.AWb=
n);this.vBb?(this.s2b(!0),this.eud(m,z)):this.AWb+this.Rhb<=n?this.dtc(m,z):(this.eud(m,z),this.setTimeout(Object(h.a)(this,this.Hml,"sendThrottledMessage"),this.AWb+this.Rhb-n));return z}Hml(){if(this.vBb){const m=this.VHc,n=this.qsb;this.s2b(!1);this.dtc(m,n)}}dtc(m,n){this.AWb=this.currentTime();m=this.Auf(m);m.hkd(z=>{n.Hlc(z)});m.gkd(z=>{n.SZa(z)})}static createInstance(m,n=""){return new r(m,n)}}r.CTf=200;Object(K.a)(r,"MaxRateThrottler",S.a,[1226,1225])},1021:function(K,S,d){d.d(S,"a",function(){return h});
K=d(0);class h extends Sys.EventArgs{constructor(e,r,m,n){super();this.type=e;this.iAa=r;this.RVi=m;this.IMa=n}}Object(K.a)(h,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1022:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.tZe="rr";h.dil="rd";h.$hl="rbp";h.G_e="sa";Object(K.a)(h,"RtcReconnectParams",null,[])},1023:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Rhb="throttling_messageDelay";h.JBb="enabled";h.TMa="throttling_timeToWaitForResponse";h.Phb=
"throttling_maxNumberOfOutstandingMessages";h.Yfe="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.C4e="url";h.z6="queryString";h.wB="connectionString";Object(K.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[])},1024:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.TYc=this.bhd=this.chd=this.fhd=0;this.Bcc=!1;this.correlationId=this.wB=this.z6=this.Y2b=this.errorMessage=null}get nOf(){return this.Y2b+"?"+this.z6}}Object(K.a)(h,
"FindSessionResponse",null,[])},1069:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=d(7),r=d(1098),m=d(317),n=d(18);class z{constructor(x){this.messageId=x;this.Kml=(new Date).getTime();this.Sse=new n.a}}Object(K.a)(z,"MessageLatencyDetails",null,[]);d.d(S,"ClientToClientMessageTelemetry",function(){return t});class t{constructor(x,B,D){this.Xqa=null;this.QKd=this.rPd=0;this.Yc=B;this.npf=D;this.VYb=!1;this.pl=x;this.pl.ECa(Object(e.a)(this,this.G4k,"receiveMessage"))}start(){if(this.npf&&!this.VYb){const x=
this.Yc.rvh;this.QKd=this.Yc.ovh;x<=this.QKd?(h.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Yc.rvh,this.Yc.ovh),this.npf=!1):(this.VYb=!0,this.rPd=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),x))}}sendMessage(){if(this.VYb){const x=m.a.create().toString();this.Xqa=new z(x);this.pl.gVe(16,x,!1,new r.a);
window.setTimeout(()=>{this.Yfk(x)},this.QKd)}}Yfk(x){this.Xqa&&this.Xqa.messageId===x&&(0<this.Xqa.Sse.count?(x=this.Xqa.Sse.toArray().join(","),h.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",x)):h.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.Xqa=null)}stop(){this.rPd&&(window.clearInterval(this.rPd),this.VYb=!1)}G4k(x,B){16===B.type?this.pl.gVe(17,B.iAa,!1,new r.a):17===B.type&&this.VYb&&B.iAa&&this.processMessage(B.iAa)}processMessage(x){x&&
this.Xqa&&x.toString()===this.Xqa.messageId&&this.Xqa.Sse.add((new Date).getTime()-this.Xqa.Kml)}static get instance(){return t.La}static rqj(x,B,D){return t.instance||(t.La=new t(x,B,D))}}t.La=null;Object(K.a)(t,"ClientToClientMessageTelemetry",null,[])},1180:function(K,S,d){d.r(S);d.d(S,"RealtimeChannelMetrics",function(){return n});K=d(0);var h=d(395),e=d(171),r=d(106),m=d(194);class n{constructor(){this.pqf=this.qqf=this.rqf=this.nqf=this.mqf=this.oqf=this.pXb=this.$Ld=0;this.EBc=this.nKd=this.BWb=
this.dKd=this.eKd=this.WJd=this.fPa=this.uWb=this.xqb=this.VJd=this.CBc=this.Gpb=null;this.VKd=this.ZWb=this.Duf=this.Lef=0;this.ppf=!1;this.wpd=this.BVe;this.EVe=this.FVe;this.xpd=this.DVe;this.frc=this.HVe;this.moh=this.GVe;this.OVe=this.PVe;this.LVe=this.MVe;this.Wjb=this.JVe;this.hrc=this.KVe;this.hoh=this.CVe;this.EIb=this.mLe;this.Emc=this.nLe}BVe(){this.$Ld++;this.VJd=new Date;this.Gpb||(this.Gpb=new Date)}FVe(){this.pXb++;this.fPa=new Date;this.CBc||(this.CBc=this.fPa);this.BWb=this.fPa;this.uHi()}DVe(){this.oqf++;
this.WJd=new Date}HVe(){this.mqf++;this.xqb=new Date}GVe(){this.nqf++;this.uWb=new Date}MVe(){this.eKd=new Date;this.rqf++}KVe(){this.EBc||(this.EBc=new Date);this.qqf++}JVe(){this.dKd=new Date;this.pqf++}PVe(){if(!this.ppf&&this.$Ld){var z=this.KNc();h.ULS.sendTraceTag(39321871,500,15,r.a.toJSON(z));this.ppf=!0}}CVe(z){let t,x;({qie:z,rie:t,hj:x}=m.RtcUtils.n0f(z));z&&z!==e.a.mx&&(h.ULS.sendTraceTag(40157596,500,15,r.a.toJSON({["HttpErrorCode"]:z,["HttpErrorStatus"]:t,["Exception"]:x})),e.a.Rog(z)&&
this.Lef++,e.a.Stg(z)&&this.Duf++)}mLe(){this.nKd=new Date}nLe(){this.xqb=this.BWb=new Date}KNc(){return{["numberOfConnectionAttempts"]:this.$Ld,["numberOfSuccessfulConnections"]:this.pXb,["numberOfFailedConnections"]:this.oqf,["numberOfDisconnectedConnections"]:this.mqf,["numberOfExplicitDisconnectedConnections"]:this.nqf,["numberOfSentMessages"]:this.rqf,["numberOfReceivedMessages"]:this.qqf,["numberOfLostMessages"]:this.pqf,["firstConnectionAttempt"]:this.Gpb?this.Gpb:null,["firstMessageReceived"]:this.EBc?
this.EBc:null,["firstConnectionSuccess"]:this.CBc?this.CBc:null,["lastConnectionAttempt"]:this.VJd?this.VJd:null,["lastConnectionSuccess"]:this.fPa?this.fPa:null,["lastConnectionFailure"]:this.WJd?this.WJd:null,["lastMessageSent"]:this.eKd?this.eKd:null,["lastMessageLost"]:this.dKd?this.dKd:null,["lastDisconnect"]:this.xqb?this.xqb:null,["lastExplicitDisconnect"]:this.uWb?this.uWb:null,["lastTimeOnline"]:this.BWb?this.BWb:null,["lastTimeOffline"]:this.nKd?this.nKd:null,["maxDisconnectedTimeMs"]:this.ZWb,
["maxExplicitDisconnectedTimeMs"]:this.VKd,["clientConnectionErrors"]:this.Lef,["serverConnectionErrors"]:this.Duf}}uHi(){this.Gpb&&1===this.pXb&&(this.ZWb=Math.max(this.ZWb,this.fPa.getTime()-this.Gpb.getTime()));this.xqb&&1<this.pXb&&(this.ZWb=Math.max(this.ZWb,this.fPa.getTime()-this.xqb.getTime()));this.uWb&&1<this.pXb&&(this.VKd=Math.max(this.VKd,this.fPa.getTime()-this.uWb.getTime()))}static createInstance(z){n.La||(n.La=new n,h.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",
z));return n.La}}n.La=null;Object(K.a)(n,"RealtimeChannelMetrics",null,[1193,355])},1181:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.DRb=e;this.$Vf=r}}Object(K.a)(h,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1182:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]=
"wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";e[e.last=10]="last"})(h||(h={}));Object(K.b)("RtcClientAppName",h)},1194:function(K,S,d){K=d(0);var h=d(7),e=d(1253),r=d(303),m=d(304),n=d(67),z=d(99);class t extends r.a{constructor(C,O){super(C);this.Dh=null;this.Cca=O.get(8,!1);this.Tha=O.get(6,0);this.element=C;this.element.className=t.b7b;this.Z6a=this.createElement("ul");this.element.appendChild(this.Z6a);
this.yq=O.get(10);this.yq.ub(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.bA=O.get(9);this.bA.ub(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut"));this.bA.ub(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"));this.RZ=O.get(13);this.RZ.ub(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"))}o8(C){this.addHandler(m.a.Cw,C)}Woa(C){this.removeHandler(m.a.Cw,C)}get Hba(){return this.Dh}dispose(){this.element&&
(this.yq.Bb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.bA.Bb(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.bA.Bb(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut")),this.RZ.Bb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(C,O,U){this.hide();!C||0>=C.length||(this.Cca?this.element.style.right=O+"px":this.element.style.left=
O+"px",this.element.style.top=U+"px",this.eUd(C),this.visible=!0)}eUd(C){this.Dh=C;z.a.yv(this.Z6a);for(let O=C.length-1;0<=O;O--)this.pB(C[O])}pB(C){const O=document.createElement("li");O.style.backgroundColor=C.color;O.style.height=this.Tha+"px";O.id="fly_"+C.clientId;O.style.lineHeight=this.Tha+"px";z.a.Rz(O,C.userName);O.setAttribute("dir","auto");this.Z6a.appendChild(O)}onClick(){this.hide();return!1}sG(C){this.raiseEvent(m.a.Cw,new m.a(3,C));return!1}}t.b7b="prFlyout UIFont";Object(K.a)(t,"PresenceTooltipFlyoutControl",
r.a,[]);var x=d(79);class B extends r.a{constructor(C,O,U){super(C);this.$Z=null;this.Dh=[];this.element.className="prGlyph";this.Yc=O;this.Y7=this.Yc.get(9);this.Ln=this.Yc.get(10);this.RZ=this.Yc.get(13);this.cie();this.pB(U);this.c5a=!1}get lP(){return this.Dh.length}get Hba(){return this.Dh}o8(C){this.addHandler(m.a.Cw,C)}Woa(C){this.removeHandler(m.a.Cw,C)}dispose(){this.r$e();super.dispose()}pB(C){Array.add(this.Dh,C);2===this.lP?this.Eba(!0):1===this.lP?this.Eba(!1):this.Eba(this.c5a)}uP(C){this.K8d(C)&&
(1<this.lP&&this.Eba(!0),1===this.lP?this.Eba(!1):1>this.lP&&this.hide())}show(){this.Eba(2<=this.lP);this.visible=!0}hide(){this.visible=!1}Vbe(C){return C?this.M7b(0,5):this.M7b(1,4)}K8d(C){for(let O=0;O<this.lP;O++)if(this.Dh[O].clientId===C)return C=this.Dh[O],Array.removeAt(this.Dh,O),C;return null}Eba(C){this.c5a!==C&&(this.$Z&&this.element.removeChild(this.$Z),this.$Z=this.Vbe(C),this.element.appendChild(this.$Z),this.c5a=C);this.$Z.childNodes[0].style.backgroundColor=this.Dh[this.Dh.length-
1].color}M7b(C,O){const U=this.Yc.get(6,0),T=this.Yc.get(14);return x.createClusteredImageFromClusterWithImageClass(U,U,this.Yc.get(C),this.Yc.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,T?T.cloneNode(!0):null)}SM(C){3!==C.kg&&this.raiseEvent(m.a.Cw,new m.a(2,C));return!1}onClick(C){this.raiseEvent(m.a.Cw,new m.a(1,C));return!0}sG(C){3!==C.kg&&this.raiseEvent(m.a.Cw,new m.a(3,C));return!1}r$e(){this.element&&(this.Y7.Bb(n.a.pointerDown,this.element,Object(h.a)(this,
this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Y7.Bb(n.a.pointerOver,this.element,Object(h.a)(this,this.SM,"onPointerOver")),this.Y7.Bb(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut")),this.Ln.Bb(n.a.doubleClick,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Ln.Bb(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.RZ.Bb(this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")))}cie(){this.element&&
(this.Y7.ub(n.a.pointerDown,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Y7.ub(n.a.pointerOver,this.element,Object(h.a)(this,this.SM,"onPointerOver")),this.Y7.ub(n.a.pointerOut,this.element,Object(h.a)(this,this.sG,"onPointerOut")),this.Ln.ub(n.a.doubleClick,this.element,Object(h.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.Ln.ub(n.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.RZ.ub(this.element,Object(h.a)(this,
this.kF,"stopPropagationAndPreventDefaultBehavior")))}}Object(K.a)(B,"PresenceTooltipGlyph",r.a,[]);var D=d(121);d(65);var w=d(199);class J extends r.a{constructor(C,O,U){super(C);this.Dh=[];this.ym=[];this.DI=0;this.Nia=this.G7=!1;this.wSb=null;this.eia={};this.Yc=U;this.nl=U.get(8,!1);this.QG=U.get(11,!1);C=U.get(12,0);this.imageDimension=U.get(6,0);this.Srb=O;this.element.id=J.t7b();this.element.className=r.a.E2d(this.nl);C&&(this.zIndex=C);this.rtl=this.nl;this.ktc(O);this.Xz=this.createElement("div");
this.Xz.className=this.QG?"prContainerV":"prContainerHr";this.element.appendChild(this.Xz);this.OUb=Array(this.DI);for(O=0;O<this.DI;O++)this.ww[O]=new t(this.createElement("div"),this.Yc),this.ww[O].o8(Object(h.a)(this,this.GY,"onInteractivityChanged")),this.element.appendChild(this.ww[O].element)}get PKb(){return w.a.clone(this.Dh)}getGlyph(C){return this.eia[C]}get ww(){return this.OUb}get y_b(){return this.wSb}get qMa(){return this.imageDimension+2}get width(){return this.QG?this.qMa:this.Srb}get height(){return this.QG?
this.Srb:this.qMa}o8(C){this.addHandler(m.a.Cw,C)}Woa(C){this.removeHandler(m.a.Cw,C)}dispose(){if(this.ww)for(const C of this.ww)C.Woa(Object(h.a)(this,this.GY,"onInteractivityChanged")),D.a.Wy(C);D.a.Ord(this.ym);this.ym=this.OUb=null;super.dispose()}hMa(){this.hX();this.bmb();this.visible=!0;this.G7=!1}svd(){!this.ym||1>this.ym.length||(this.hX(),this.visible=!0,this.bmb(),this.yKa(this.ym[this.ym.length-1]),this.G7=!0)}dMa(){if(this.ym&&!(1>this.ym.length)){this.visible=!0;this.bmb();var C=0;
for(const O of this.ym)this.yKa(O,C++);this.G7=!1;this.Nia=!0}}hide(){this.visible=!1;this.hX();for(let C=0;C<this.ym.length;C++)this.ym[C].hide();this.G7=!1}g2b(){if(!this.Nia)return!1;let C=0;for(const O of this.ww)O.visible&&C++;return this.Nia=0<C&&(this.Dh.length<=this.DI?C===this.Dh.length:C===this.DI)}pB(C){if(!(0>=this.DI)){C.clientId||(C.clientId=(J.VOa++).toString());if(C.clientId in this.eia){var O=this.zka(C.clientId);if(0<=O){O=this.Dh[O];if(O.color===C.color&&O.userName===C.userName)return;
this.uP(C.clientId)}}O=this.g2b();var U=0;if(this.Dh.length<this.DI){var T=new B(this.createElement("div"),this.Yc,C);T.o8(Object(h.a)(this,this.GY,"onInteractivityChanged"));this.nl&&!this.QG&&0<this.Dh.length?this.Xz.insertBefore(T.element,this.Xz.firstChild):(this.Xz.appendChild(T.element),U=this.ym.length);Array.add(this.ym,T)}else this.nl&&!this.QG?T=this.ym[0]:(U=this.ym.length-1,T=this.ym[U]),T.pB(C);T.show();this.eia[C.clientId]=T;Array.add(this.Dh,C);this.Axc(T,U);O&&this.dMa()}}uP(C){const O=
this.g2b();O&&this.hX();this.F0a(C);this.Dh.length>=this.DI&&this.ym.length<this.DI&&this.zVe();0>=this.Dh.length?this.hide():O&&this.dMa()}Vhd(){}F0a(C){var O=this.zka(C);0>O||(C=this.Dh[O],Array.removeAt(this.Dh,O),O=this.eia[C.clientId],delete this.eia[C.clientId],O.uP(C.clientId),this.Axc(O),0>=O.lP&&(this.Xz.removeChild(O.element),Array.remove(this.ym,O),O.dispose()))}EOb(){}zVe(){var C=this.ede();!C||1>=C.Hba.length||(C=Array.clone(this.Dh),C.forEach(O=>{this.F0a(O.clientId)}),C.forEach(O=>
{this.pB(O)}))}zka(C){for(let O=0;O<this.Dh.length;O++)if(this.Dh[O].clientId===C)return O;return-1}ede(){return this.nl&&!this.QG?this.ym[0]:this.ym[this.ym.length-1]}position(C,O){this.element.style.top=O+"px";this.element.style.left=C+"px"}bmb(){for(let C=0;C<this.ym.length;C++)this.ym[C].show()}hX(){for(let C=0;C<this.DI;C++)this.ww[C].hide();this.Nia=!1}yKa(C,O=0){if(C)if(this.wSb=C,this.QG){const U=this.imageDimension;if(1<C.Hba.length)this.ww[O].show(C.Hba,U,this.height-this.imageDimension);
else{const T=this.Xz.children.length;for(let ca=0;ca<this.Xz.children.length;ca++)C.element===this.Xz.children[ca]&&this.ww[O].show(C.Hba,U,this.height-(T-ca)*this.qMa+2)}}else this.ww[O].show(C.Hba,this.width,0)}GY(C,O){var U=Object(e.a)(B,C);U=U?this.z6b(U):-1;if(2===O.type||1===O.type&&-1!==U&&!this.ww[U].visible)this.yKa(C);else if(1===O.type)this.hX(),this.G7=!1;else if(3===O.type){if(this.xSc(O.Fj))return;this.G7||this.hX()}this.raiseEvent(m.a.Cw,O)}xSc(C){C=J.E8b(C);let O=!1;for(const U of this.ww)if(z.a.NVa(U.element,
C)){O=!0;break}return this.Xz!==C&&z.a.NVa(this.Xz,C)||O}Axc(C,O=0){const U=this.Ene(C);U&&0>=C.lP?this.ww[O].hide():U?this.yKa(C):this.ww[O].hide()}z6b(C){let O=0;for(const U of this.ym){if(C===U)return O;O++}return-1}Ene(C){const O=this.z6b(C);return!!this.y_b&&C===this.y_b&&-1!==O&&this.ww[O].visible}ktc(C){this.DI=C===this.imageDimension?1:Math.floor(C/this.qMa);this.QG?(this.element.style.height=C+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=C+"px",this.element.style.height=
this.imageDimension+"px")}static t7b(){return String.format("{0}-{1}","presencetooltip",J.VOa++)}static E8b(C){C=C.nc.rawEvent;return C.relatedTarget||C.toElement}}J.VOa=0;Object(K.a)(J,"PresenceTooltipControl",r.a,[623,108]);var F=d(240),L=d(318),M=d(282);d.d(S,"a",function(){return Q});class Q{constructor(C){this.Yc=C;this.Yc.o_(10,F.a.instance);this.Yc.o_(9,M.a.instance);this.Yc.o_(6,16);this.Yc.o_(13,L.a.instance)}U1d(C,O){return new J(C,O,this.Yc)}C3b(C){return new J(C,16,this.Yc)}}Object(K.a)(Q,
"PresenceTooltipFactory",null,[602])},1302:function(K,S,d){d.r(S);var h=d(0),e=d(395),r=d(7),m=d(18),n=d(78),z=d(82),t=d(37),x=d(3);class B{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe=!1){this.INa=null;this.cGd=!0;this.xNd=this.SS=this.DCd=null;this.Oa=new n.a;this.F5h=Xa;this.Qtf=vb;this.$rf=cc;this.Zrf=wc;this.Gdf=Md;B.ae=Ad;this.D7h=Sd;this.zPa=Le;this.v8h=fe;x.Task.WAA(vb,cc).continueWith(Object(r.a)(this,this.yQj,"initOnTaskReady"))}Enh(){this.Oa.raiseEvent("u",null,this)}yQj(){this.Qtf.result&&this.$rf.result&&
(this.SS=this.Qtf.result,this.xNd=this.$rf.result,this.SS.ZJc(Object(r.a)(this,this.Bnc,"onPresenceUpdated")),this.DCd=new z.a(2,2,this.Gdf,Object(r.a)(this,this.RRl,"updateAwayClientsTask"),88),B.ae.Hb(this.DCd))}Bnc(Xa,vb){(this.cGd||this.J4k(vb.DRb))&&B.ae.U1(this.DCd,0)}J4k(Xa){for(let cc in Xa){var vb=this.Zrf.Ebg({key:cc,value:Xa[cc]});if(vb&&vb.clientId&&(vb=vb.clientId.toLowerCase(),(vb=this.INa[vb]||this.INa[vb.toUpperCase()])&&2===vb.status))return!0}return!1}RRl(Xa){var vb=this.SS.zdj();
if(vb){var cc=new Date,wc=!1;if(this.cGd){this.INa=vb;this.cGd=!1;var Ad=this.INa;for(var Md in Ad){vb=Md;var Sd=Ad[Md];Sd.FCb<cc&&(cc=Sd.FCb);2===Sd.status&&(wc=!0,this.xNd.cqd(vb))}wc&&this.Enh();B.ae.U1(Xa,this.Aag(cc))}else{Sd=new m.a;Md=!1;var Le=this.INa;for(Ad in Le){Le=Ad;if(!(Le in this.INa)||this.F5h.clientId===Le)continue;var fe=this.INa[Le];const Vf=vb[Le];if(fe&&Vf){fe=fe.status;const Cd=Vf.status;2===fe&&1===Cd?(Sd.add(Le),e.ULS.sendTraceTag(38052609,392,50,Le+" returned from away")):
1===fe&&2===Cd&&(Md=wc=!0,this.xNd.cqd(Le),e.ULS.sendTraceTag(38052610,392,50,Le+" went away"));1===Cd&&Vf.FCb<cc&&(cc=Vf.FCb)}}this.INa=vb;B.ae.U1(Xa,this.Aag(cc));(0<Sd.count||wc)&&this.Enh();0<Sd.count&&!this.v8h?(Xa=this.Vfj(Sd),this.pLl(Xa)):Xa=new m.a;(Md||0<Xa.count)&&this.D7h(t.a.J8a,2)}}}pLl(Xa){if(Xa.count)for(let vb of Xa)Xa=this.zPa.wDa(String.format(CommonUIStrings.l_EditorsToastArriving,vb),!1),Xa.image=5,Xa.mea="CoAuth_AuthorStatus_16x16x32",this.zPa.li(Xa)}Vfj(Xa){const vb=this.SS.SUc(),
cc=new m.a;for(let wc in vb){const Ad={key:wc,value:vb[wc]};if(Xa.contains(Ad.key)){const Md=this.Zrf.Ebg(Ad);Md&&(cc.add(Md.userName),Xa.remove(Ad.key))}}cc.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return cc}Aag(Xa){return Math.max(Xa.getTime()+this.Gdf-(new Date).getTime(),0)}}B.ae=null;Object(h.a)(B,"AwayManager",null,[]);var D=d(586),w=d(27),J=d(55),F=d(254),L=d(347),M=d(71),Q=d(1182),C=d(1098),O=d(1024),U=d(720),T=d(718),ca=d(194),N=d(1023),da=d(29),Y=d(461),
fa=d(202),aa=d(28),ka=d(799),H=d(47),ra=d(1253),ha=d(19),Ma=d(968),Ga=d(385),na=d(41),wa=d(58);class Fa{constructor(Xa,vb){this.shapeNode=Xa;this.mHh=vb}}Object(h.a)(Fa,"ShapeNodeStartEditingNotificationTracking",null,[]);class pa{constructor(Xa,vb,cc,wc,Ad="",Md=""){if(!Xa||!vb||0>cc)throw Error.argumentNull("LockEntry");this.Lx=Xa;this.VB=vb;this.Kfa=cc;this.cpk=wc;this.i2g=Ad;this.$1g=Md;this.fOg=new Date}get clientId(){return this.Lx}get Nvd(){return this.VB}get shapeId(){return this.Kfa}get lockType(){return this.cpk}get WJh(){return this.i2g}get IJh(){return this.$1g}get yug(){return!H.a.Xa(this.$1g)&&
!H.a.Xa(this.i2g)}get Dwg(){return this.fOg}set Dwg(Xa){this.fOg=Xa}}Object(h.a)(pa,"LockEntry",null,[]);class Ea{constructor(Xa,vb,cc,wc,Ad="",Md=""){this.clientId=Xa;this.slideId=vb;this.shapeId=cc;this.lockType=wc;this.rowId=Ad;this.cellId=Md}}Object(h.a)(Ea,"SerializableLockData",null,[]);var ta=d(189),ia=d(220);class Ja{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd,Sc,jg,mg,Pa,bb,Fc,yd,ge,rb,gf,Ab){this.GBj=new D.a("",ResourceStrings.L_GhostUserName,Ma.a.PTf,new ka.a(1));this.KFb={};this.LFb=
{};this.JFb={};this.LNg=da.App.tn;this.FDe=null;this.XGe={};this.H6c={};this.K6c={};this.MNg=da.App.tn;this.R1g=!0;this.bQg=this.dPg=0;this.Vbd=(new Date(0)).getTime();this.Wbd=(new Date(0)).getTime();this.Wic=(new Date(0)).getTime();this.jFe=(new Date(0)).getTime();this.Q1g=!1;this.oXa=Xa;this.JE=vb;this.UFb=cc;this.Njc=wc;this.Ub=Ad;this.wb=Md;this.pa=Sd;this.Ejk=Le;this.ur=fe;this.Ga=Vf;this.zc=Cd;this.ejc=Sc;this.Wwe=jg.xpg;this.Ss=mg;this.zY=Pa;this.ua=bb;this.k0g=Fc;this.od=yd;this.od.bli(Object(r.a)(this,
this.dMk,"onShapeViewElementRequestUpdateAuthorInfo"));(this.Rv=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.pa.FC(Object(r.a)(this,this.CD,"onSelectionChanged"));this.Njc.ECa(Object(r.a)(this,this.Ync,"onUpdateNotificationReceived"));this.owk=ge;this.We=rb;this.kvk=gf;this.Da=jg;this.nZa=Ab;this.GQj()}GQj(){aa.a.J(509219588,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.Wwe,this.Ss.Ygk());this.Ss.T4d||(0<this.Ss.kkb?
this.wb.Hb(new z.a(2,2,this.Ss.kkb,Object(r.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):aa.a.J(509219587,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.Ss.aQb?(this.wb.Hb(new z.a(2,2,this.Ss.aQb/2,Object(r.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.R1g=!1):aa.a.J(509219586,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.Ss.Z$b?this.wb.Hb(new z.a(2,2,this.Ss.Z$b,Object(r.a)(this,
this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):aa.a.J(509219585,804,50,"IME typing lock notification disabled"),0<this.Ss.Ohb?this.wb.Hb(new z.a(2,2,this.Ss.Ohb,Object(r.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):aa.a.J(509219584,804,50,"Lock leack detection is disabled"),this.Ejk.addHandler(Ga.a.wOf,(Xa,vb)=>{this.mHi(vb)}),this.Ss.TQc||this.Evc||(this.ejc.BCa(Object(r.a)(this,this.r$g,"onBeforeParagraphNodePropertyChanged")),0<this.Ss.Anb?this.wb.Hb(new z.a(2,2,this.Ss.Anb,
Object(r.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):aa.a.J(509219555,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.Evc&&(this.kvk.BCa(Object(r.a)(this,this.eld,"onTableCellNodePropertyChanged")),this.ejc.BCa(Object(r.a)(this,this.r$g,"onBeforeParagraphNodePropertyChanged")),this.owk.initialize(),0<this.Ss.Anb&&this.wb.Hb(new z.a(2,2,this.Ss.Anb,Object(r.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),
90,"76")),0<this.Ss.kkb&&this.wb.Hb(new z.a(2,2,this.Ss.kkb,Object(r.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get Evc(){return this.Ss.r6d&&this.Ss.zYf}removeExpiredLock(){var Xa=ia.a(this.KFb);for(const vb of Xa){Xa=Object(ra.a)(117,this.KFb[vb]);if(!Xa){delete this.KFb[vb];continue}const cc=Xa.shapeNode;cc&&cc.isConnected?this.zY.B8f(cc)||this.Znd(vb)||(delete this.KFb[vb],this.zY.V7b(cc)||Xa.Ml?aa.a.J(509219554,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.QOh(Xa)):delete this.KFb[vb]}}removeExpiredTableCellLock(){var Xa=ia.a(this.LFb);for(const vb of Xa){Xa=Object(ra.a)(713,this.LFb[vb]);if(!Xa){delete this.LFb[vb];continue}const cc=Xa.tableCellNode;cc&&cc.isConnected?H.a.Xa(this.zY.J7b(cc))&&!this.Znd(vb)&&(delete this.LFb[vb],this.ROh(Xa)):delete this.LFb[vb]}}detectLockLeak(){const Xa=[],vb=new Date,cc=this.ffg();for(const wc of cc)wc.iq&&+vb-+wc.V5c>this.Ss.Ohb&&Xa.push(wc.shapeNode.Xm);0<Xa.length&&aa.a.J(509219553,828,15,"Following objects are locked longer than {0} : {1}",
this.Ss.Ohb,Xa.join(";"))}switchPendingSveToFidelity(){const Xa=new Date,vb=this.ffg();for(const cc of vb)cc.iq||cc.shapeNode.xd&&this.Evc||!cc.lo||cc.yy||!(+Xa-+cc.Tdk>this.Ss.aQb)||cc.GB||cc.$Pb()}updateLockIfImeActive(){if(this.LNg>=this.MNg&&this.FDe){const Xa=this.y8i(this.FDe);this.rAd(Xa)&&this.ftc(Xa.slideId,Xa.get_shapeId(),2)}this.MNg=new Date}updateLockForActiveShapeNodes(){var Xa=ia.a(this.H6c);for(const vb of Xa)Xa=Object(ra.a)(4,this.H6c[vb]),this.rAd(Xa)&&this.ftc(Xa.slideId,Xa.get_shapeId(),
3);this.H6c={}}updateLockForActiveTableCellNodes(){var Xa=ia.a(this.K6c);for(const vb of Xa)if(Xa=Object(ra.a)(130,this.K6c[vb]),this.rAd(Xa)){const cc=this.Ga.An(Xa);this.ftc(cc.slideId,cc.get_shapeId(),3,Xa.rowId.toString(),Xa.cellId.toString())}this.K6c={}}y8i(Xa){return(Xa=this.ur.eJ(Xa))?this.Ga.An(Xa.gb):null}r$g(Xa,vb){vb&&vb.node?(Xa=Object(ra.a)(5,vb.node),Xa)?Xa.loading||Xa.Vpc||vb.property.id!==na.a.Oo.id||(vb=this.Ga.Xda(Xa),Xa=this.zc.fFa(Xa),vb&&(Xa?(vb=this.jVc(vb.slideId,vb.get_shapeId(),
Xa.rowId.toString(),Xa.cellId.toString()),this.K6c[vb]=Xa):(Xa=this.gzb(vb.slideId,vb.get_shapeId()),this.H6c[Xa]=vb))):aa.a.J(509219551,828,10,"Invalid argument."):aa.a.J(509219552,828,10,"Invalid argument.")}gkl(Xa){const vb=new z.a(2,1,this.Ss.bwd,Object(r.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");vb.customData=new Fa(Xa,!1);this.wb.Hb(vb);this.XGe[this.gzb(Xa.slideId,Xa.get_shapeId())]=vb}rtcNotifyStartEditing(Xa){Xa=Object(ra.a)(Fa,Xa.customData);const vb=Xa.shapeNode;
this.rAd(vb)&&this.J7j(vb)&&this.ftc(vb.slideId,vb.get_shapeId(),1);Xa.mHh=!0}rAd(Xa){return Xa?Xa.isConnected:!1}J7j(Xa){return(Xa=this.rk(Xa))?Xa.fM:!1}rk(Xa){return Object(ra.a)(117,Xa.rg(this.Ub.Rn.Na))}ffg(){const Xa=[];if(!this.ua.Ba)return Xa;var vb=this.ua.Ba.yj();if(!vb)return Xa;for(const cc of vb)(vb=this.rk(cc))&&!vb.Ml?Xa.push(vb):aa.a.J(509219549,828,50,"Shape {0} on active slide doesn't have valid view element",cc.Xm);return Xa}ULk(Xa){this.ADh(Xa)&&(this.oXa.amIAlone||this.gkl(Xa))}CD(Xa,
vb){for(Xa=0;Xa<vb.VE.length;Xa++){const wc=vb.VE[Xa];var cc=Object(ra.a)(4,wc.context.node);cc&&cc.isConnected&&(cc=Object(ra.a)(117,cc.qc(this.We)))&&(cc=this.k0g.hJ(cc.shapeNode))&&(1===wc.wda?cc.kmc():0===wc.wda&&cc.SKe())}}TLk(Xa){if(this.ADh(Xa)&&!this.Ss.RQc){var vb=this.gzb(Xa.slideId,Xa.get_shapeId()),cc=Object(ra.a)(z.a,this.XGe[vb]);if(cc){const wc=Object(ra.a)(Fa,cc.customData);this.wb.Kg(cc);wc&&wc.mHh&&this.ftc(Xa.slideId,Xa.get_shapeId(),4);this.XGe[vb]=null}}}dMk(Xa,vb){this.Oeh(vb.$w)}Oeh(Xa){Xa.mJ()||
Xa.shapeNode.icb?this.Afi(Xa):this.Peh(Xa)}eld(Xa,vb){if((vb=Object(ra.a)(ta.TableCellNode,vb.node))&&(Xa=Object(ra.a)(713,vb.rg(this.We)))&&vb.isConnected){vb=this.zY.J7b(vb);const cc=this.QTe(Xa.tableCellNode);H.a.Xa(vb)?cc?(this.Ete(Xa,this.Vka(cc.clientId,Ja.d6d)),this.haf(Xa)):H.a.Xa(vb)&&(this.QTe(Xa.tableCellNode)||this.ROh(Xa)):(this.Ete(Xa,this.Vka(vb,Ja.d6d)),this.haf(Xa))}}Ete(Xa,vb){Xa.lock(vb)}ROh(Xa){Xa.unlock()}ftc(Xa,vb,cc,wc="",Ad=""){try{const Md=new Ea(this.UFb,Xa.lyc,vb,cc,wc,
Ad);this.Njc.bba(7,Md)}catch(Md){aa.a.J(509219548,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.UFb,Md.stack)}}Ync(Xa,vb){this.Da.pptCoauthSurveyFloodgateEnabled&&!this.Q1g&&8===vb.type&&this.nZa&&this.czl(vb)&&(aa.a.J(509219547,814,50,"Log coauth activity"),this.Q1g=!0,this.nZa.continueWith(()=>{this.nZa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===vb.type&&((Xa=vb.iAa)?Xa.clientId===this.UFb?aa.a.J(509219545,828,15,"Lock notification : lock notification from myself recieved"):
(aa.a.J(509219544,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Xa.clientId,this.UFb),Xa=new pa(Xa.clientId,Xa.slideId,Xa.shapeId,Xa.lockType,Xa.rowId,Xa.cellId),this.Qfi(Xa),this.UYk(Xa)):aa.a.J(509219546,828,10,"Lock notification: invalid lock data recieved"))}Peh(Xa){if(!Xa||Xa.Ml)aa.a.J(509219543,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Xa);else{var vb=Xa.shapeNode;if(!(vb.Wf||this.Wwe&&vb.xd&&(this.Ss.swb||this.Evc))){var cc=this.zY.V7b(vb);cc?this.U5c(Xa,
this.Vka(cc,Ja.d6d)):(vb=this.zY.B8f(vb))?(this.U5c(Xa,this.Vka(vb,Ja.O_i)),this.gaf(Xa)):(vb=this.QTe(Xa.shapeNode))?(this.U5c(Xa,this.Vka(vb.clientId,this.wce(vb.lockType))),this.gaf(Xa)):Xa.iq&&this.QOh(Xa)}}}QOh(Xa){const vb=this.k0g.hJ(Xa.shapeNode);vb&&(vb.Ozd(null),Xa.unlock(this.R1g||!vb.vhe))}U5c(Xa,vb){Xa.lock(vb);Xa.mJ()&&this.pa.nh()}czl(Xa){if(!Xa||null===Xa.iAa)return!1;Xa=this.rRk(Xa.iAa);for(const vb of Xa)vb&&vb.clientId&&(vb.clientId.toLowerCase()===this.UFb.toLowerCase()?(this.dPg++,
this.Vbd=this.Vbd===(new Date(0)).getTime()?(new Date).getTime():this.Vbd,this.Wbd=(new Date).getTime()):this.K2j(vb.clientId)||(this.bQg++,this.Wic=this.Wic===(new Date(0)).getTime()?(new Date).getTime():this.Wic,this.jFe=(new Date).getTime()));return 5<=this.dPg&&5<=this.bQg&&(this.jFe>=this.Vbd&&this.Wic<=this.Wbd||this.Wbd>=this.Wic&&this.Wbd<=this.jFe)&&1<=this.JE.Tyb()?!0:!1}rRk(Xa){let vb=null;try{vb=Xa}catch(cc){}if(null===vb||!vb.length){let cc=null;try{cc=Xa}catch(wc){aa.a.J(509219541,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==cc)return[cc]}return vb}K2j(Xa){Xa=this.Vka(Xa);const vb=this.Vka(this.UFb);return Xa&&vb&&Xa.userName===vb.userName&&Xa.email===vb.email?!0:!1}wce(Xa){switch(Xa){case 1:return Ja.sFl;case 2:return Ja.aPj;case 3:return Ja.WPl;case 4:return Ja.d1i}aa.a.J(509219539,828,10,"Unknown lock type");return"Unknown lock type"}Qfi(Xa){if(Xa&&Xa.Nvd){var vb=Xa.yug?this.jVc(new wa.a(Xa.Nvd),Xa.shapeId,Xa.WJh,Xa.IJh):this.gzb(new wa.a(Xa.Nvd),Xa.shapeId);
if(4===Xa.lockType)this.JFb[vb]=Xa;else{var cc=Object(ra.a)(pa,this.JFb[vb]);cc?(cc=this.vce(cc),this.vce(Xa)>cc&&(this.JFb[vb]=Xa)):this.JFb[vb]=Xa}}}vce(Xa){return this.$nj(Xa.lockType)-(+new Date-+Xa.Dwg)}$nj(Xa){switch(Xa){case 1:return this.Ss.awd;case 2:return this.Ss.C_c;case 3:return this.Ss.Uyd;case 4:return this.Ss.Rwb}aa.a.J(509219536,828,10,"Unknown lock type");return 0}QTe(Xa){if(Object(ha.a)(4,Xa)){Xa=Object(ra.a)(4,Xa);if(!Xa.slideId)return null;Xa=this.gzb(Xa.slideId,Xa.get_shapeId());
return this.Znd(Xa)}if(Object(ha.a)(130,Xa)){Xa=Object(ra.a)(130,Xa);let vb=this.Ga.Xda(Xa);if(!vb.slideId)return null;Xa=this.jVc(vb.slideId,vb.get_shapeId(),Xa.rowId.toString(),Xa.cellId.toString());return this.Znd(Xa)}return null}Znd(Xa){if(!Xa)return null;const vb=Object(ra.a)(pa,this.JFb[Xa]);return vb?0>=this.vce(vb)?this.JFb[Xa]=null:vb:null}gaf(Xa){const vb=this.gvj(Xa);vb&&(this.KFb[vb]=Xa)}haf(Xa){const vb=this.Qxj(Xa);vb&&(this.LFb[vb]=Xa)}gvj(Xa){return Xa?this.gzb(Xa.shapeNode.slideId,
Xa.shapeNode.get_shapeId()):null}Qxj(Xa){if(!Xa)return null;Xa=Xa.tableCellNode;const vb=this.Ga.Xda(Xa);return this.jVc(vb.slideId,vb.get_shapeId(),Xa.rowId.toString(),Xa.cellId.toString())}gzb(Xa,vb){return String.format("{0}#{1}#{2}",Xa.sid,Xa.cid,vb)}jVc(Xa,vb,cc,wc){return String.format("{0}#{1}#{2}#{3}#{4}",Xa.sid,Xa.cid,vb,cc,wc)}o2j(Xa){const vb=Object(ra.a)(116,this.ua.Ba);return vb&&wa.a.WFh(Xa.Nvd,vb.Cb.lyc)?!0:!1}UYk(Xa){if(this.o2j(Xa)){var vb=Xa.shapeId,cc=Xa.clientId;this.ua.Ba&&(vb=
this.ua.Ba.MQ(vb))&&(Xa.yug&&this.Ss.r6d?this.gZk(Xa,cc,vb):this.aZk(Xa,cc,vb))}}aZk(Xa,vb,cc){cc.Wf||this.Wwe&&cc.xd&&(this.Ss.swb||this.Evc)||!(cc=this.rk(cc))||(this.U5c(cc,this.Vka(vb,this.wce(Xa.lockType))),this.gaf(cc))}gZk(Xa,vb,cc){if((cc=this.Sxj(cc,Xa.WJh,Xa.IJh))&&cc.isConnected){var wc=Object(ra.a)(713,cc.rg(this.We));wc&&H.a.Xa(this.zY.J7b(cc))&&(this.Ete(wc,this.Vka(vb,this.wce(Xa.lockType))),this.haf(wc))}}Sxj(Xa,vb,cc){Xa=this.zc.eO(Object(ra.a)(4,Xa));if(!Xa)return null;var wc=this.zc.ala(Xa);
Xa=null;for(const Ad of wc){wc=this.zc.Jab(Ad);for(const Md of wc)if(Md.rowId.toString()===vb&&Md.cellId.toString()===cc){Xa=Md;break}}return Xa}Afi(Xa){const vb=new z.a(0,1,0,()=>{this.Peh(Xa)},90,"79");this.wb.Hb(vb)}mHi(Xa){this.LNg=new Date;this.FDe=this.H7i(Xa.Bc)}H7i(Xa){return Xa?Xa.querySelector(".Paragraph"):null}Vka(Xa,vb=""){const cc=this.JE.Vka(Xa);if(cc)return cc;aa.a.J(509219531,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Xa,vb);return this.GBj}ADh(Xa){return!this.Ss.T4d&&
!(this.Ss.swb&&Xa.xd)&&!Xa.Wf}}Ja.d6d="EditingBy";Ja.O_i="EditingByInSameWorker";Ja.sFl="StartEditing";Ja.d1i="EndEditing";Ja.aPj="ImeTyping";Ja.WPl="Typing";Object(h.a)(Ja,"CoauthStateChangesHandler",null,[1097]);class ab{constructor(Xa){this.qva={};this.Lx=Xa.AD;this.init(Xa)}init(Xa){if(Xa=Xa.K_)for(const vb of Xa)vb.ID!==this.Lx&&(this.qva[vb.ID]=new Date)}Dei(Xa){for(let vb=0;vb<Xa.length;vb++)Xa[vb]in this.qva||Xa[vb]===this.Lx||(this.qva[Xa[vb]]=new Date)}sGl(Xa){const vb=this.qva[Xa];vb&&
(aa.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Lx,Xa,(new Date).getTime()-vb.getTime()),delete this.qva[Xa])}rGl(Xa){const vb=this.qva[Xa];vb&&(aa.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Lx,Xa,(new Date).getTime()-vb.getTime()),delete this.qva[Xa])}qGl(){for(const Xa of Object.keys(this.qva))aa.a.J(37590345,
814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.Lx,Xa,(new Date).getTime()-this.qva[Xa].getTime());this.qva={}}}Object(h.a)(ab,"EditorPresenceTracker",null,[1095]);class Oa{constructor(Xa){this.Rsk=Xa;this.LM=new C.a;this.LM.Ng(this.Rsk)}}Object(h.a)(Oa,"PPTRtcProvider",null,[1094]);var Za=d(103),Na=d(1252),sa=d(715);class Sa{constructor(Xa,vb,cc,wc,Ad){this.efa=null;this.CU=!1;this.xwe=this.nEe=null;this.Ljk=
Za.a.create();this.a9c=!1;this.G6b=0;this.nY=Ad;cc.yg&&(this.findSessionResponse=Xa,wc.CBf(Object(r.a)(this,this.nnl,"sessionPropertiesChanged")));this.xHa=new Na.a(()=>vb())}get findSessionResponse(){return this.efa}set findSessionResponse(Xa){if(this.CU)aa.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.efa=Xa)this.CU=!0,this.nEe=this.efa.nOf,this.xwe=this.efa.wB}get Tna(){return this.CU?this.nEe:
this.xHa.value.Tna}set Tna(Xa){this.CU?this.nEe=Xa:this.xHa.value.Tna=Xa}s1e(Xa){this.xHa.value.s1e(Xa)}get wB(){return this.CU?this.xwe:this.xHa.value.wB}set wB(Xa){this.CU?this.xwe=Xa:this.xHa.value.wB=Xa}lWc(){let Xa;aa.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.CU,this.a9c);return this.CU?(Xa=this.efa.correlationId||this.Ljk.toString(),aa.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",
Xa),{returnValue:String.format("{0}&{1}={2}",this.efa.z6,w.AFrameworkApplication.u1d,H.a.Ne(Xa)),correlationId:Xa}):this.a9c?this.xHa.value.lWc():(aa.a.J(51140183,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}Vde(Xa,vb,cc,wc,Ad){aa.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.CU);this.CU?(Xa(this.efa.Y2b),cc(new sa.a(this.efa.fhd,this.efa.chd,this.efa.bhd,
this.efa.TYc))):(this.xHa.value.Vde(Xa,vb,cc,wc,Ad),this.a9c=!0);this.nY&&this.nY.li(26,!this.a9c)}n5d(){aa.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.CU);this.CU?this.CU=!1:this.xHa.value.n5d()}joa(Xa,vb){aa.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.CU);this.CU||this.xHa.value.joa(Xa,vb)}nnl(){aa.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",
this.CU);this.CU=!1}}Object(h.a)(Sa,"PptAssignRtcMachineStrategy",null,[1093]);var xb=d(1207);class gc{constructor(){this.ao=null}b0b(Xa,vb){this.ao||(this.ao={});this.ao[vb]||(this.ao[vb]=0);this.ao[vb]+=Xa}getData(){return this.ao}reset(){this.ao=null}}Object(h.a)(gc,"MultiSumDataAggregator",null,[1546]);class zc{constructor(Xa,vb){this.bCd=xb.a.ZW(Xa,vb,new gc,!0)}Lf(Xa){this.bCd.track(1,Xa)}}Object(h.a)(zc,"MultiCounter",null,[1579]);class Xb{constructor(Xa,vb,cc,wc){this.Kz=Xa;this.H5=vb;this.Uvk=
cc;this.Mmk=wc;this.Kz.ECa(Object(r.a)(this,this.hil,"rtcOnUpdateNotificationReceived"))}hil(Xa,vb){0===vb.type&&(this.Mmk.Lf("CU"),this.Uvk||this.SF())}SF(){!w.AFrameworkApplication.Yg&&this.H5.zX&&this.H5.SF(null,null,null)}}Object(h.a)(Xb,"ContentNotificationManager",null,[]);class jb extends Xb{constructor(Xa,vb,cc,wc){super(Xa,vb,cc,wc)}static init(){if(da.App.Mb){var Xa=da.App.Mb.Ld;if(Xa&&(Xa.BAf(jb.a$g),Xa=Xa.Di)&&(Xa=Xa.contentReplicator)){var vb=da.App.Oh;if(vb&&vb.Ew&&(vb=J.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var cc=
w.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),wc=new zc(11,1);jb.w7c=jb.w7c||new jb(vb,Xa,cc,wc);jb.w7c.SF()}}}}static a$g(Xa){jb.w7c||(Xa.Tqh(jb.a$g),jb.init())}}jb.w7c=null;Object(h.a)(jb,"PptContentNotificationManager",Xb,[]);var zb=d(106),Tb=d(354),Ya=d(97),sb;(function(Xa){Xa[Xa.signalRConnectFailed=0]="signalRConnectFailed";Xa[Xa.findSessionFailed=1]="findSessionFailed"})(sb||(sb={}));Object(h.b)("RtcConnectFailureType",sb);var oc=d(262),wb=d(33);class rc{constructor(Xa,vb,cc,
wc,Ad,Md){this.dcd=this.qPg=this.Vfb=this.Ufb=0;this.Efb=this.aIa=this.$ma=this.$hc=this.u9c=this.R0=null;this.V9c=this.X9c=this.Y9c=this.T9c=this.U9c=!1;this.s_g=Xa;this.uj=vb;this.iY=cc;this.iY.qUd(Object(r.a)(this,this.mJb,"onNetworkHealthStateChanged"));this.jk=wc;this.TGe=Md;$addHandler(window,"visibilitychange",Object(r.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.Htk=Ad;this.Htk.Tki(Object(r.a)(this,this.pLk,"onRtcConnectFailed"))}mJb(Xa,vb){vb.aqe||(this.X9c=this.Y9c=!0)}onVisibilityChange(){window.document.hidden&&
(this.T9c=this.U9c=!0)}pLk(Xa,vb){Xa=vb.f6i;if(vb=vb.errorMessage){if(0===Xa){let wc,Ad;({qie:cc,rie:wc,hj:Ad}=ca.RtcUtils.n0f(vb.ErrorDetails));vb.HttpErrorCode=cc;vb.HttpErrorStatus=wc;vb.Exception=Ad;delete vb.ErrorDetails;if(!cc&&this.TGe&&0<this.TGe.length)try{var cc=!0;const Md=window.location.hostname.toLowerCase();for(const Sd of this.TGe.split(";"))if(Md.endsWith(Sd)){cc=!1;break}vb.IsCORS=cc.toString()}catch(Md){vb.Unexpected=Md.message}}aa.a.J(508946247,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",
this.uj.amIAlone,window.document.hidden,this.jk.ZQ,sb[Xa],zb.a.toJSON(vb));this.V9c||(this.V9c=this.O6j(Xa,vb))}}O6j(Xa,vb){const cc=oc.c(vb,"HttpErrorCode",-1);return 500<=cc&&599>=cc||1===Xa&&"FindSessionRequestFailed"!==vb.FindSessionFailureReason?!0:!1}Zig(){return this.R0&&1===this.Vfb?this.U9c||this.Y9c:this.$ma&&1<this.Vfb?this.T9c||this.X9c:!1}Yig(){return this.$ma&&0<this.dcd?this.T9c||this.X9c:this.R0&&0<this.Ufb?this.U9c||this.Y9c:!1}wpd(){this.Ufb++;this.$hc=new Date;this.R0||(this.R0=
new Date,this.U9c=window.document.hidden,this.Y9c=!this.jk.ZQ)}EVe(){this.ioh(0)}ioh(Xa){this.Vfb++;this.aIa=new Date;this.u9c?this.iOc>this.s_g.lvh&&(Xa={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.Vfb,["numberOfConnectionAttempts"]:this.Ufb,["firstConnectionAttempt"]:this.R0?this.R0.toISOString():"",["lastConnectionSuccess"]:this.aIa?this.aIa.toISOString():"",["lastUnexpectedDisconnect"]:this.$ma?this.$ma.toISOString():"",["lastExplicitDisconnect"]:this.Efb?this.Efb.toISOString():
"",["reconnectDurationInMs"]:this.iOc,["hasPageHiddenOrNetworkIssue"]:this.Zig()},aa.a.J(36804373,500,15,zb.a.toJSON(Xa))):(this.u9c=this.aIa,Tb.a.instance.$b("FirstPresenceUpdated",(new Date).getTime().toString()),this.iOc>this.s_g.lvh&&(Xa={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.Ufb,["firstConnectionAttempt"]:this.R0?this.R0.toISOString():"",["firstConnectionSuccess"]:this.u9c?this.u9c.toISOString():"",["lastExplicitDisconnect"]:this.Efb?this.Efb.toISOString():
"",["connectDurationInMs"]:this.iOc,["connectionDurationFromStopWatchInMs"]:Xa,["hasPageHiddenOrNetworkIssue"]:this.Zig()},aa.a.J(36804373,500,15,zb.a.toJSON(Xa))))}xpd(){this.qPg++;const Xa={["numberOfFailedConnections"]:this.qPg,["numberOfConnectionAttempts"]:this.Ufb,["firstConnectionAttempt"]:this.R0?this.R0.toISOString():"",["lastConnectionAttempt"]:this.$hc?this.$hc.toISOString():"",["lastExplicitDisconnect"]:this.Efb?this.Efb.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),
["disconnectedDurationMs"]:this.aWf,["hasPageHiddenOrNetworkIssue"]:this.Yig()};this.V9c?(e.ULS.sendTraceTag(508946246,500,15,zb.a.toJSON(Xa)),this.toh("ClientRTCSetupFailureDueToServerError")):(e.ULS.sendTraceTag(36804375,500,15,zb.a.toJSON(Xa)),this.toh("ClientRTCSetupFailureDueToClientError"))}toh(Xa){!this.Yig()&&5E3<this.aWf&&wb.a("ClientRTCSetupFailureQoSErrorEnabled")&&Ya.Health.instance.recordQosError(Xa,["PresenceExperienceDegraded"],!1,!0,!0,!1,null)}frc(){this.dcd++;this.$ma=new Date;this.T9c=
window.document.hidden;this.X9c=!this.jk.ZQ}p5k(){this.Txl()&&this.xpd();this.Efb=new Date;this.jEi()}jEi(){this.dcd=this.Vfb=this.Ufb=0;this.aIa=this.$ma=this.$hc=this.R0=null;this.V9c=!1}Txl(){return!!this.$hc&&!this.aIa&&!this.$ma}get iOc(){if(this.aIa){if(this.R0&&1===this.Vfb)return this.uj.sVc(this.R0,this.aIa);if(this.$ma&&1<this.Vfb)return this.uj.sVc(this.$ma,this.aIa)}return 0}get aWf(){return this.$ma&&0<this.dcd?this.uj.sVc(this.$ma,new Date):this.R0&&0<this.Ufb?this.uj.sVc(this.R0,new Date):
0}}Object(h.a)(rc,"PptRealtimeChannelMetrics",null,[1092]);var Ka=d(75),Db=d(34),bc=d(39);class Mc{constructor(Xa,vb,cc,wc,Ad){this.Ppk=Xa.toLowerCase();this.hIa=vb;this.Yl=cc;this.Ur=wc;this.Vq=Ad;this.Ur.kja(Object(r.a)(this,this.Knc,"onShapeNodeLoaded"));this.Vq.HBf(Object(r.a)(this,this.Mnc,"onShapeViewElementUnlocked"))}dispose(){this.Ur.H0a(Object(r.a)(this,this.Knc,"onShapeNodeLoaded"));this.Vq.Qrh(Object(r.a)(this,this.Mnc,"onShapeViewElementUnlocked"))}KC(Xa){return this.fKi(Xa)||this.$Of(Xa)}$Of(Xa){if(!Xa||
Xa.Wf)return!1;const vb=Xa.sa(bc.a.c6d,"");return+new Date-+Xa.V5c<this.hIa&&!!vb&&vb.toLowerCase()!==this.Ppk}fKi(Xa){return!!this.V7b(Xa)}B8f(Xa){let vb="";Xa&&this.$Of(Xa)&&(vb=Xa.eb(bc.a.c6d));return vb}V7b(Xa){return Xa?Xa.sa(bc.a.LXf,""):""}J7b(Xa){return Xa?Xa.sa(bc.a.QAi,""):""}ZUl(Xa){if(Xa&&(Xa.KC=this.KC(Xa),Xa.anchor)){const cc=this.Yl.Osa(Xa);for(;cc.moveNext();){var vb=cc.currentNode;Db.ParagraphReader.fe(vb)&&(vb=Object(ra.a)(Ka.AParagraphNode,vb))&&(vb.KC=Xa.KC)}}}Mnc(Xa,vb){this.ZUl(vb.$w.shapeNode)}Knc(Xa,
vb){Xa=vb.node;Xa.RTl();Xa.KC=this.KC(Xa)}}Object(h.a)(Mc,"PptWetChangeHandler",null,[1087,108]);class mb{constructor(Xa){this.tsk=Xa}k4(){return this.tsk.k4()}}Object(h.a)(mb,"PresenceCache",null,[]);var Wa=d(678),db=d(1181),ub=d(1277),Lb=d(1053),Kb=d(1265);class uc extends n.a{constructor(){super();this.edd=[]}gja(Xa){Xa&&(aa.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Xa.clientId,Xa.presence.toString()),Array.add(this.edd,Xa))}cqd(Xa){(Xa=this.Rab(Xa))&&
this.qMb(Xa);return Xa}qMb(Xa){Xa&&(aa.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Xa.clientId,Xa.presence.toString()),Array.remove(this.edd,Xa))}Rab(Xa){for(const vb of this.edd)if(vb.clientId===Xa)return vb;return null}k4(){return this.edd}}Object(h.a)(uc,"PresenceDataManager",n.a,[]);var Yb=d(40),Tc=d(751);class sc{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd){this.clientId=Xa;this.data=Sd;this.chatThreadId=vb;this.chatThreadDiscoveryUri=cc;this.inChat=
wc;this.email=Ad;this.capabilities=Md;this.userName=Le;this.clientType=fe;this.fHasClientEverExperiencedNetworkLoss=Vf;this.isAnonymous=Cd}}Object(h.a)(sc,"SerializablePresenceInfo",null,[]);class Qb{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd){this.Djc=null;this.Lx=Xa.toLowerCase();this.VB=vb;this.$Fe=cc;this.FBg=wc;this.EBg=Ad;this.qIg=Md;this.Yfc=Sd;this.rBg=Le;this.Pna=fe;this.p_g=Vf;this.pFg=Cd}dee(){return new sc(this.Lx,this.FBg,this.EBg,this.qIg,this.Yfc,this.rBg.capabilities,this.$Fe?this.$Fe.dee():
null,this.Pna,this.p_g,this.pFg,w.AFrameworkApplication.Mnb||w.AFrameworkApplication.dR)}ALj(Xa){if(!(Xa&&this.pk.equals(Xa.slideId)&&this.presence&&this.presence.lV))return!1;for(const vb of this.presence.lV)if(vb===Xa.get_shapeId())return!0;return!1}get presence(){return this.$Fe}get clientId(){return this.Lx}get chatThreadId(){return this.FBg}get chatThreadDiscoveryUri(){return this.EBg}get inChat(){return this.qIg}get email(){return this.Yfc}get capabilities(){return this.rBg}get pk(){return this.VB}get userName(){return this.Pna}get clientType(){return this.p_g}get fHasClientEverExperiencedNetworkLoss(){return this.pFg}get presenceUser(){return this.Djc}set presenceUser(Xa){this.Djc&&
(Xa?!this.Djc.client||0===this.Djc.client||Xa.client&&0!==Xa.client||aa.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.Lx):aa.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.Lx));this.Djc=Xa}static dPc(Xa){if(!Xa||!Xa.clientId)return aa.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const vb=Tc.a.dPc(Xa.data);let cc=0;Xa.clientType&&8>=Xa.clientType&&(cc=Xa.clientType);
return new Qb(Xa.clientId,vb.pk,vb,Xa.chatThreadId,Xa.chatThreadDiscoveryUri,Xa.inChat,Xa.email,new ka.a(Xa.capabilities),Xa.userName,cc,Xa.fHasClientEverExperiencedNetworkLoss)}}Object(h.a)(Qb,"PresenceEntry",null,[]);class kb extends Sys.EventArgs{constructor(Xa,vb,cc,wc,Ad,Md){super();this.VB=Xa;this.Gwk=cc;this.Led=vb;this.p2h=wc;this.Euk=Ad;this.xsk=Md}get slideId(){return this.VB}get user(){return this.Gwk}get shapes(){return this.Led}get A9(){return this.p2h}get jGh(){return this.Euk}get bkh(){return this.xsk}}
Object(h.a)(kb,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var Ib=d(30);class eb extends n.a{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd,Sc,jg,mg,Pa,bb,Fc,yd,ge,rb,gf,Ab,fc,kc,ud,zd,Td){super();this.ER=new uc;this.$o=null;this.wCg=[];this.xCg=null;this.VDb=!0;this.hfb=!1;this.ZNg=new Date;this.xZa=null;this.zFg=this.Wkk=this.FHg=!1;this.ddd=null;this.O$=Xa;Xa.userName||(Xa.userName=kc);this.Ib=vb;this.Kz=cc;this.Lx=wc.clientId;this.iaa=wc.gx;this.Ce=Ad;this.pc=gf;this.Ajc=rb;this.nY=Ab;this.Rma=
Td;fc.execute(Me=>{this.$o=Me});this.LMj();this.uj=jg;this.Mq=mg;this.Shc=Pa.X6j;this.nhc=Pa.podsDefaultToRtcForPresenceEnabled;this.Pnk=Pa.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.rNg=w.AFrameworkApplication.zz;this.HCe=Pa.yg&&Pa.pptNoRtcConnectWhenReadOnlyEnabled;this.pa=Md;this.pa.FC(Object(r.a)(this,this.CD,"onSelectionChanged"));this.Sp=Sd;this.Sp.Qli(Object(r.a)(this,this.uNk,"onValidShapeIdLoaded"));this.od=Le;this.od.eT(Object(r.a)(this,this.oEk,"onActiveSlideDOMReady"));this.yE=
fe;this.yE.jUd(Object(r.a)(this,this.zjd,"onEditorTableUpdate"));this.ih=bb;this.ih.GC(Object(r.a)(this,this.UE,"onSessionEnd"));this.ih.qB(Object(r.a)(this,this.Hn,"onSessionRehydrated"));this.ih.PQa(Object(r.a)(this,this.znc,"onOutboundReplication"));this.Pik=Pa.pptAwayStatusTimeGapForPresenceUpdateInMs;this.ia=Cd;this.ua=Vf;this.fdd=Sc;this.G8c=Fc;this.Agb=yd;this.cEb=ge;Pa.yg&&(this.ih.BBf(Object(r.a)(this,this.Gnc,"onSessionAccessTokenExpiring")),this.ih.$Jc(Object(r.a)(this,this.voa,"onSessionAccessTokenExpired")),
this.ih.LUd(Object(r.a)(this,this.Pkd,"onSessionExpired")),this.Ib.$e(()=>{this.O$.userName=this.Ib.appSettings.UserName;this.O$.email||(this.O$.email=w.AFrameworkApplication.fa.Ha("UserPrincipalName"));this.pc.YL||(aa.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.HCe&&this.ih.Qca(Object(r.a)(this,this.Oy,"onUnifiedAppStateChanged"))}),this.rNg&&this.ih.eKc(Object(r.a)(this,this.nga,"onWopiTokenRefreshed")));aa.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",
this.rNg)}vb(){this.ia.ra(Ib.a.q0a,Yb.a.application,Object(r.a)(this,this.q0a,"querySlidePresenceUsers"),96)}q0a(Xa,vb,cc,wc,Ad){Ad.Vuc=this.X8b(Ad.slideId);Ad.akh=this.Tyb();return 32}X8b(Xa){return(Xa=this.mdg(Xa))?Xa.length:0}LMj(){this.Kz.A7a(Object(r.a)(this,this.zJi,"connectionStateChanged"));this.Kz.ZJc(Object(r.a)(this,this.presenceUpdated,"presenceUpdated"));w.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&this.Kz.ECa(Object(r.a)(this,this.$Tl,"updateNotificationReceived"));
T.a.getInstance().wii(Object(r.a)(this,this.jbh,"onGotCompletePersistentStateWithMetadata"));this.xZa=this.iaa.Ii("WebServiceCall","RtcConnection");this.nY.n2i();this.Kz.connect()}Moh(){const Xa=this.Kz.SUc();this.XQh(new db.a(Xa,null));this.btc()}jbh(Xa,vb){this.nY.q2i(vb.oXk);T.a.getInstance().Yal(Object(r.a)(this,this.jbh,"onGotCompletePersistentStateWithMetadata"))}zJi(Xa,vb){aa.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",eb.wae(vb.oldState),
eb.wae(vb.newState),this.Lx);switch(vb.newState){case 2:this.xZa.stop();Xa=this.xZa.er;this.nY.m2i();this.Moh();this.Ajc.ioh(Xa);break;case 1:2===vb.oldState&&this.Ajc.frc();this.Ajc.wpd();break;case 0:this.VDb?this.nEi():2===vb.oldState&&(window.setTimeout(()=>{this.Kz.connect()},0),aa.a.J(512360714,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.Ce.N8b().getTime()),this.Ajc.frc())}}getSelectedShapes(){if(!this.Shc)return null;const Xa=[],vb=this.pa.Ud();for(let cc=0;cc<vb.length;++cc)Array.add(Xa,
vb[cc].get_shapeId());0<Xa.length&&Xa.sort();return Xa}nEi(){var Xa=this.ER.k4();if(Xa&&Xa.length){Xa=Array.clone(Xa);for(const vb of Xa)this.qMb(vb);this.raiseEvent("PresenceChanged")}}R_e(Xa,vb){try{this.O$.email||(this.O$.email=w.AFrameworkApplication.fa.Ha("UserPrincipalName"));const cc=new Tc.a(Xa,vb),wc=new Qb(this.O$.clientId,Xa,cc,this.O$.chatThreadId,this.O$.chatThreadDiscoveryUri,this.O$.inChat,this.O$.email,this.O$.capabilities,this.O$.userName,1,this.Wkk);this.O$.email||aa.a.J(512360713,
814,15,"PresenceManager : SendPresence; empty email for user");this.Kz.R_e(wc.dee()).continueWith(()=>{aa.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Lx,cc.toString(),this.Ce.N8b().getTime())});this.ZNg=new Date;this.nY.jfk();this.m5k(Xa,vb);aa.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.Lx,cc.toString(),this.Ce.N8b().getTime());
this.N5k(cc)}catch(cc){aa.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",cc.toString(),this.Lx)}}presenceUpdated(Xa,vb){Xa=!!this.$o&&this.$o.P_;aa.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.Lx,Xa);if(!Xa){this.nY.lfk(vb.DRb);Xa=null;this.iaa&&(Xa=this.iaa.Ii("ServerNotification","Presence Updated"));try{this.XQh(vb)}finally{Xa&&Xa.stop()}}}$Tl(Xa,vb){aa.a.J(512360711,
814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",vb.type,this.Lx)}XQh(Xa){this.Rfi(Xa.DRb);this.E0a(Xa.$Vf);aa.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}btc(){this.ua.pk?this.R_e(this.ua.pk,this.getSelectedShapes()):aa.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}CD(){if(this.ua.pk){var Xa=this.getSelectedShapes();
(eb.ELj(this.xCg,this.ua.pk)||eb.yhe(Xa,this.wCg))&&this.btc()}else aa.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}oEk(Xa,vb){vb.Ba?this.ua.pk?this.btc():aa.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):aa.a.J(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}uNk(Xa,vb){this.ua.pk?Array.contains(this.getSelectedShapes(),vb.shapeNode.get_shapeId())&&
this.btc():aa.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}kCl(Xa,vb,cc){vb=this.h7f(vb);Xa=this.h7f(Xa);this.Ce.Wfj().nwc.raiseEvent(eb.g6d,new ub.a(this.uj.AD,null,vb,Xa,null,0,0,cc))}h7f(Xa){const vb=new Lb.a;for(let cc=0;cc<Xa.length;cc++){const wc=Xa[cc];if(!wc)continue;if(wc.ID===this.uj.AD)continue;if(!wc.EmailAddress){vb.$(wc.ID,this.g7f(wc));continue}const Ad=this.ER.Rab(this.uj.AD);Ad&&Ad.email&&wc.EmailAddress&&Ad.email.toUpperCase()===
wc.EmailAddress.toUpperCase()||vb.$(wc.EmailAddress.toUpperCase(),this.g7f(wc))}return vb.values}g7f(Xa){const vb=new Kb.a;vb.EmailAddress=Xa.EmailAddress;vb.Id=Xa.ID;vb.Name=Xa.Name;return vb}zjd(Xa,vb){this.kCl(vb.Zwg,vb.gFf,vb.C_j);if(Xa=this.uj.K_){var cc=vb.Zwg;for(var wc=0;wc<cc.length;wc++)this.G8c.sGl(cc[wc].ID);cc=[];vb=vb.gFf;for(wc=0;wc<vb.length;wc++){let Md=vb[wc];const Sd=Md.ID;if(Sd!==this.uj.AD){const Le=this.ER.Rab(Sd);Le?this.cEb.yHf(Le.email,Md.EmailAddress):Array.add(cc,Sd)}}this.G8c.Dei(cc);
2<=Xa.length&&aa.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.Lx,Xa.length);cc=[];vb=[];for(var Ad of Xa)Array.add(cc,Ad.ID),Ad.ID===this.uj.AD||this.ER.Rab(Ad.ID)||Array.add(vb,Ad.ID);aa.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",this.Lx,Xa.length,cc.join(","),vb.join(","));for(const Md of this.ER.k4())({editor:Ad}=
this.uj.xnb(Md.clientId)).returnValue?(this.J5k(Md),Xa=this.Agb.nua(new Wa.a(Ad.EmailAddress,void 0,Ad.Name),Ad.ID,0),Md.presenceUser=new D.a(Md.clientId,Ad.Name,Xa,new ka.a(1),null,null,Md.clientType),this.fdd.ipd(new kb(Md.pk,Md.presence.lV,Md.presenceUser,!0,this.X8b(Md.pk),this.Tyb())),aa.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",Md.clientId,Md.presence.toString(),Md.presenceUser.color,
this.Lx)):aa.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",Md.clientId,Md.presence.toString(),Md.presenceUser?Md.presenceUser.color:"",this.Lx);this.raiseEvent("PresenceChanged")}else aa.a.J(512360675,814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.Lx)}UE(Xa,vb){this.G8c.qGl();5!==vb.iC&&(aa.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),
this.disconnect())}Gnc(){aa.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.hfb||(aa.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.hfb=!0)}voa(){aa.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");this.hfb||(aa.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.hfb=!0)}Pkd(){aa.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");
this.disconnect()}nga(Xa,vb){aa.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{vb.s4c?(aa.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",eb.wae(this.Kz.connectionState)),this.hfb=!1,this.HCe&&!this.pc.YL?aa.a.J(512360661,814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.VDb||2!==this.Kz.connectionState?this.connect():(Xa={},Xa.qs=this.Rma.presentationId.string,aa.a.J(512360660,
814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.Kz.Dnb(Xa))):aa.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(cc){aa.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",cc)}}Hn(Xa,vb){this.Pnk&&this.hfb||this.HCe&&!this.pc.YL?aa.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.hfb,this.pc.YL):4!==
vb.Bya||this.VDb?this.connect():(aa.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.Moh())}Oy(Xa,vb){vb.zpe&&!this.pc.YL&&(aa.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){aa.a.J(512360654,814,50,"PresenceManager : Connect");this.VDb=!1;this.Kz.connect()}znc(){this.hyl()&&(aa.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),
this.btc())}hyl(){const Xa=this.Kz.npj();return Xa?2===Xa.status||+new Date-+this.ZNg>this.Pik?!0:!1:!1}d5j(){const Xa=this.ER.k4();if(0<Xa.length)for(const vb of Xa)if(vb.presence&&vb.presence.pk)return!0;return!1}Gxl(){return!this.FHg&&this.nhc&&2!==this.uj.sda}Rfi(Xa){for(let cc in Xa){var vb=Xa[cc];try{const wc=Qb.dPc(vb);if(!wc||wc.clientId===this.Lx)continue;const Ad=wc.clientId;this.Gxl()&&(this.FHg=!0,this.Mq.wxc(2),aa.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));
aa.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",Ad,wc.presence.toString());const Md=wc.email;if(!this.cEb.Uae(Md)){let Sd;({editor:Sd}=this.uj.xnb(Ad)).returnValue&&this.cEb.yHf(Md,Sd.EmailAddress)}this.Tfi(wc);this.nY.l2i()}catch(wc){aa.a.J(512360651,814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",wc.toString(),this.Lx)}}this.nY.kfk(Xa)}Tfi(Xa){this.i1i(Xa);const vb=this.Kz.u4(Xa.clientId);vb&&2===
vb.status?aa.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Xa.clientId):this.Sfi(Xa)}Sfi(Xa){const vb=this.ER.Rab(Xa.clientId);if(vb){if(!this.tLj(vb,Xa))return;aa.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",Xa.clientId,vb.presence.toString(),Xa.presence.toString(),this.Lx);this.qMb(vb)}this.jgi(Xa)}qMb(Xa){Xa&&
(this.ER.qMb(Xa),Xa.presenceUser&&this.fdd.ipd(new kb(Xa.pk,Xa.presence.lV,Xa.presenceUser,!1,this.X8b(Xa.pk),this.Tyb())))}HZf(Xa){if(Xa)if(Xa.presenceUser)aa.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Xa.clientId);else{const vb=this.Dbg(Xa.clientId);vb?Xa.presenceUser=vb:aa.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Xa.clientId)}}jgi(Xa){Xa&&(this.ER.gja(Xa),this.G8c.rGl(Xa.clientId),
this.HZf(Xa),Xa.presenceUser?this.fdd.ipd(new kb(Xa.pk,Xa.presence.lV,Xa.presenceUser,!0,this.X8b(Xa.pk),this.Tyb())):aa.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Xa.clientId))}tLj(Xa,vb){let cc;(cc=!Xa.pk.equals(vb.pk))&&aa.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Xa.pk,vb.pk);(Xa=this.Shc&&eb.zvl(Xa,vb))&&aa.a.J(512360646,814,50,"Shape Presence Changed");return cc||Xa}E0a(Xa){if(Xa){for(let vb=0;vb<Xa.length;vb++)Xa[vb]=
Xa[vb].toLowerCase();for(const vb of Xa)aa.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",vb),(Xa=this.ER.cqd(vb))?Xa.presenceUser?this.fdd.ipd(new kb(Xa.pk,Xa.presence.lV,Xa.presenceUser,!1,this.X8b(Xa.pk),this.Tyb())):aa.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):aa.a.J(512360644,814,15,"PresenceManager : RemovePresence; entry did not exist")}}mdg(Xa){const vb=[];for(const cc of this.ER.k4())cc.pk.equals(Xa)&&
cc.presenceUser&&Array.add(vb,cc.presenceUser);return vb}Ucg(Xa){const vb=[];for(const cc of this.ER.k4())cc.presence&&cc.ALj(Xa)&&cc.presenceUser&&Array.add(vb,cc.presenceUser);return vb}w7b(){const Xa=[];for(const vb of this.ER.k4())vb.presenceUser&&Array.add(Xa,vb.presenceUser);return Xa}Tyb(){const Xa=this.w7b();return Xa?Xa.length:0}Vka(Xa){if(!Xa)return null;Xa=Xa.toLocaleLowerCase();for(const vb of this.ER.k4())if(vb.presenceUser&&vb.presenceUser.clientId===Xa)return vb.presenceUser;return this.Dbg(Xa)}cqd(Xa){const vb=
this.ER.Rab(Xa);this.qMb(vb);aa.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",vb?vb.clientId:Xa+" not found",this.Lx)}Eki(Xa){this.addHandler("PresenceChanged",Xa)}k4(){return this.ER.k4()}connectionState(){return this.Kz.connectionState}disconnect(){try{aa.a.J(512360640,814,50,"PresenceManager : Disconnect"),this.VDb||this.Ajc.p5k(),this.VDb=!0,this.Kz.disconnect()}catch(Xa){aa.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",
Xa.message,Xa.stack)}}m5k(Xa,vb){this.xCg=Xa;this.wCg=vb}Dbg(Xa){let vb;const cc=({editor:vb}=this.uj.xnb(Xa)).returnValue;var wc=this.Kz.oua(Xa),Ad=!!wc;if(!cc&&!Ad)return aa.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Xa),null;wc=Ad?wc:null;cc||aa.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Xa);Ad||aa.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Xa);Ad&&cc&&aa.a.J(512360607,
814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Xa,wc.clientId!==vb.ID,wc.email!==vb.EmailAddress);var Md=cc?new Wa.a(vb.EmailAddress,void 0,vb.Name):new Wa.a(this.cEb.Uae(wc.email)||wc.email,void 0,wc.userName);Md=this.Agb.nua(Md,cc?vb.ID:wc.clientId,0);Ad=Ad?wc.clientType:0;return new D.a(Xa,cc?vb.Name:wc.userName,Md,new ka.a(1),null,null,Ad)}J5k(Xa){this.ua.pk.equals(Xa.pk)&&Xa.presence.lV&&Xa.presence.lV.length&&aa.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Xa.clientId,Xa.presence.toString(),this.Lx,this.Ce.N8b().getTime());aa.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Xa.clientId,Xa.presence.toString(),this.Lx,this.Ce.N8b().getTime())}N5k(Xa){const vb=[this.uj.userName];let cc=0;for(var wc of this.ER.k4())wc.presence.pk.equals(Xa.pk)&&!eb.yhe(wc.presence.lV,Xa.lV)&&(cc++,wc.presenceUser&&Array.add(vb,wc.presenceUser.userName));
if(0<cc){wc={};let Ad=0,Md=0;for(let Sd=0;Sd<vb.length;++Sd){let Le=vb[Sd];Le&&Le.length||(Le="anonymous",Md++);Le in wc||(wc[Le]=!0,Ad++)}aa.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",cc+1,Xa.lV&&0<Xa.lV.length?"shape":"slide",Ad,Md)}}i1i(Xa){try{this.nY.R5i()&&!this.ER.Rab(Xa.clientId)&&(this.HZf(Xa),this.j1i(Xa.presenceUser))}catch(vb){aa.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",
vb.toString())}}j1i(Xa){Xa&&Xa.clientId&&(this.zFg||this.ddd||(this.zFg=!0,this.ddd=J.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.ddd&&this.ddd.m1i(Xa.clientId,eb.Mtj(Xa)))}static wae(Xa){let vb="";switch(Xa){case 2:vb="Connected";break;case 1:vb="Connecting";break;case 0:vb="Disconnected"}return vb}static yhe(Xa,vb){if(!Xa&&!vb)return!1;if(!Xa&&vb||Xa&&!vb||Xa.length!==vb.length)return!0;for(let cc=0;cc<Xa.length;cc++)if(Xa[cc]!==vb[cc])return!0;return!1}static ELj(Xa,
vb){return!wa.a.mba(Xa,vb)}static zvl(Xa,vb){return Xa.pk.equals(vb.pk)&&eb.yhe(Xa.presence.lV,vb.presence.lV)}static Mtj(Xa){return Xa&&1===Xa.client?1:0}}eb.g6d="ETU";Object(h.a)(eb,"PresenceManager",n.a,[1088,1089,1090,1091]);var Rb=d(1306),pc=d(1194),Wc=d(1315),Ic=d(79),nd=d(49),ob=d(297);class $b{constructor(Xa,vb,cc,wc,Ad){this.yu=null;this.Rv=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled");vb=this.Nrj(vb,wc,Ad);this.yu=this.Rv?(new Rb.a(vb)).C3b(Xa):(new pc.a(vb)).U1d(Xa,
cc)}dispose(){this.yu.dispose()}ZRe(){return nd.a.mi(document.getElementById(ob.a.w1b))}Nrj(Xa,vb,cc){const wc=new Wc.a;wc.add(0,Ic.getImageClassWithCluster(w.AFrameworkApplication.lO,"MoreUsersGlyph_16x16x32"));wc.add(5,w.AFrameworkApplication.km);wc.add(1,Ic.getImageClassWithCluster(w.AFrameworkApplication.lO,this.Rv?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));wc.add(4,w.AFrameworkApplication.km);wc.add(6,cc);wc.add(8,w.AFrameworkApplication.isRtl);wc.add(12,Xa);wc.add(11,vb);
this.Rv&&(wc.add(16,Object(r.a)(this,this.ZRe,"presenceViewportBoundsCallback")),wc.add(17,!0));return wc}pB(Xa){this.yu?(aa.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Xa.clientId),this.yu.pB(Xa)):aa.a.J(509219530,814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Xa.clientId)}uP(Xa){this.yu?(aa.a.J(509219528,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Xa.clientId),this.yu.uP(Xa.clientId)):aa.a.J(509219529,
814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Xa.clientId)}clear(){if(this.yu)if(aa.a.J(509219526,814,50,"PresencePawn:Clear at PresencePawn "),this.m9())for(const Xa of this.m9())this.uP(Xa);else aa.a.J(509219525,814,50,"PresencePawn:Clear - Pawn has no users");else aa.a.J(509219527,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}m9(){return this.yu?this.yu.PKb:null}d4e(){this.yu&&(this.Rv&&this.yu.hMa(),this.yu.dMa())}She(){this.yu&&
this.yu.hMa()}}Object(h.a)($b,"PresencePawn",null,[313,108]);class Hc{uSf(Xa,vb,cc){return new $b(Xa,2,vb,!0,cc)}}Object(h.a)(Hc,"PresencePawnFactory",null,[1059]);var Pb=d(32);class Yc{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd){this.BFe=[];this.nZa=null;this.kGg=this.jGg=this.sAe=0;this.R9c=this.S9c=null;this.zcd=[];if(!vb)throw Error.argumentNull("graphTopologyManager");if(!cc)throw Error.argumentNull("presenceManager");if(!wc)throw Error.argumentNull("dragInputManager");if(!Ad)throw Error.argumentNull("coauthStateChangesHandler");
this.od=Xa;this.ua=vb;this.JE=cc;this.su=wc;this.jwe=Ad;this.qna=Md;this.Sb=Sd;this.We=Le;this.qhb=fe;this.pna=Vf;this.wR=Cd;this.pna.D7a(Object(r.a)(this,this.Rvd,"slidePresenceChanged"));this.od.eT(Object(r.a)(this,this.B_a,"onSlideNavigation"));this.od.cKc(Object(r.a)(this,this.Rxa,"onThumbnailRefresh"));this.od.atb(Object(r.a)(this,this.TOe,"onThumbnailVisibleRangeChanged"));this.mJg=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceFloodGateSurveyEnabled");(this.Rv=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&
this.mJg&&(this.jGg=w.AFrameworkApplication.fa.uc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.kGg=w.AFrameworkApplication.fa.uc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",3),this.sAe=0,this.nZa=F.a.Ot(J.a.instance.Ia("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.od.Zsb(Object(r.a)(this,this.Ivl,"shapeViewElementAdded"));this.od.FBf(Object(r.a)(this,this.Jvl,"shapeViewElementLocked"));this.od.fki(Object(r.a)(this,this.eMk,"onShapeViewElementShowLockHint"));this.od.gki(Object(r.a)(this,
this.fMk,"onShapeViewElementShowPresenceHint"));this.od.dki(Object(r.a)(this,this.ZLk,"onShapeViewElementHidePresenceHint"))}B_a(){this.ua.pk&&(aa.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",this.ua.pk),this.J6k(this.ua.pk))}J6k(Xa){if(this.ua.pk&&this.ua.pk.equals(Xa)&&(aa.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Xa),Xa=new Pb.GraphIterator,Xa.set(this.ua.Ba),Xa.Db(1))){do if(0<
Xa.currentNode.eb(bc.a.shapeId)){const vb=Object(ra.a)(4,Xa.currentNode);vb&&this.Woh(vb)}while(Xa.Hf(1))}}Rvd(Xa,vb){this.su.$Fa?(aa.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.R9c||(this.R9c=new z.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(vb)},90,"68"),w.AFrameworkApplication.De.Hb(this.R9c)),vb&&this.zcd.push(vb)):(this.dZk(vb),this.bZk(vb))}handlePendingPresenceChangedEvent(){this.R9c=null;this.H6k();if(this.ua.pk&&0<this.zcd.length){const cc=
{},wc={};var Xa=this.ua.pk;for(var vb of this.zcd){if(!Xa.equals(vb.slideId))continue;if(!vb.shapes||!vb.user)continue;vb.user.clientId in wc||(cc[vb.user.clientId]=vb.user,wc[vb.user.clientId]=new Lb.a(0));const Ad=wc[vb.user.clientId];for(const Md of vb.shapes){const Sd=vb.A9?1:0;Ad.Gb(Md)?0<(Ad.ga(Md)^Sd)&&Ad.$(Md,Sd):Ad.add(Md,Sd)}}for(let Ad in cc){Xa=cc[Ad];vb=Ad;if(!(vb in wc))continue;const Md=[],Sd=[];wc[vb].forEach((Le,fe)=>{0<fe?Sd.push(Le):Md.push(Le);return!0});0<Md.length&&this.Kqh(Md,
Xa);0<Sd.length&&this.gAf(Sd,Xa)}this.zcd=[]}}dZk(Xa){Xa.A9?this.gja(Xa.slideId,Xa.user):this.E0a(Xa.slideId,Xa.user)}Rxa(Xa,vb){this.Uoh([vb.lLh])}TOe(Xa,vb){this.Uoh(vb.kha)}Uoh(Xa){const vb=[];for(const cc of Xa)Xa=this.wR?this.Sb.gYc(cc):this.Sb.Yka(cc),this.wR&&0>=Xa.EV||Xa&&Array.add(vb,Xa);this.Toh(vb)}gja(Xa,vb){const cc=this.zeg(Xa);cc?(cc.gja(vb),this.Gte(),aa.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Xa.toString())):aa.a.J(21770506,
814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Xa.toString())}E0a(Xa,vb){const cc=this.zeg(Xa);cc?cc.E0a(vb):aa.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Xa.toString())}zeg(Xa){const vb=this.Sb.Yka(Xa);return vb?Object(ra.a)(861,vb.rg(this.qhb)):(aa.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Xa.toString()),null)}H6k(){const Xa=this.ua.presentation;if(!Xa)throw Error.argumentNull("Presentation is null");
this.Toh(Xa.slides||[])}Toh(Xa){for(const cc of Xa){var vb=Object(ra.a)(116,cc);vb?(Xa=vb.Cb,(vb=Object(ra.a)(861,vb.rg(this.qhb)))?(aa.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",Xa.toString()),vb.a3a(this.JE.mdg(Xa))):aa.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Xa.toString())):aa.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",
cc.Cb.toString())}}Gte(){this.Rv&&this.mJg&&(this.zNl()||this.nZa&&this.nZa.continueWith(()=>{this.nZa.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",this.jGg)&&this.sAe++}))}zNl(){return this.sAe>=this.kGg}bZk(Xa){this.ua.pk&&this.ua.pk.equals(Xa.slideId)&&Xa.shapes&&(Xa.A9?this.gAf(Xa.shapes,Xa.user):this.Kqh(Xa.shapes,Xa.user))}Ivl(Xa,vb){Xa=vb.$w;this.Xtg(Xa.shapeNode)&&(this.BFe.push(Xa),this.S9c||(this.S9c=new z.a(2,1,0,Object(r.a)(this,this.handlePendingShapePresenceUpdate,
"handlePendingShapePresenceUpdate"),90,"69"),w.AFrameworkApplication.De.Hb(this.S9c)))}handlePendingShapePresenceUpdate(){this.S9c=null;for(const Xa of this.BFe){if(!this.Xtg(Xa.shapeNode))return;this.Woh(Xa.shapeNode)}Array.clear(this.BFe)}Woh(Xa){const vb=Object(ra.a)(117,Xa.qc(this.We));if(vb&&!Xa.get_smartArtModelId()){var cc=this.JE.Ucg(Xa);if(cc)if(cc.length){Xa=this.qna.dJ(Xa);Xa.yMf();for(const wc of cc)Xa.gja(wc),this.Gte()}else(cc=this.qna.hJ(Xa))&&cc.yMf();this.jwe.Oeh(vb)}}gAf(Xa,vb){var cc=
this.Ycg();let wc=!1;for(const Ad of cc){if(!Array.contains(Xa,Ad.get_shapeId())||Ad.get_smartArtModelId())continue;cc=Object(ra.a)(117,Ad.qc(this.We));if(!cc||Ad.get_smartArtModelId())continue;const Md=this.qna.dJ(Ad);Md?(cc.isSelected&&(Md.aub=!1),Md.gja(vb),this.Gte(),cc.isSelected&&Md.kmc()):wc=!0}wc||aa.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}Kqh(Xa,vb){var cc=this.Ycg();for(const wc of cc)Array.contains(Xa,wc.get_shapeId())&&(cc=this.qna.dJ(wc))&&cc.E0a(vb)}Ycg(){let Xa=
null;this.ua.Ba&&(Xa=this.ua.Ba.yj());return Xa||[]}Xtg(Xa){return!!this.ua.Ba&&this.ua.Ba.Cb.equals(Xa.slideId)}Jvl(Xa,vb){this.qna.dJ(vb.$w.shapeNode).Ozd(vb.presenceUser)}eMk(Xa,vb){(vb.$w.iq||vb.$w.Wud)&&(Xa=this.qna.hJ(vb.$w.shapeNode))&&Xa.D3e()}fMk(Xa,vb){(Xa=this.qna.hJ(vb.$w.shapeNode))&&Xa.Dzl()}ZLk(Xa,vb){(Xa=this.qna.hJ(vb.$w.shapeNode))&&Xa.jea()}}Object(h.a)(Yc,"PresencePresenter",null,[]);class Rd{constructor(Xa){this.Njc=Xa}oua(Xa){return this.Njc.oua(Xa)}u4(Xa){return this.Njc.u4(Xa)}}
Object(h.a)(Rd,"PresenceUserInfoGetter",null,[1061,964]);class Gb{constructor(Xa=null){this.uj=Xa}Ebg(Xa){if(!Xa||!Xa.value)return null;Xa=Xa.value;let vb=Xa.userName;if(!vb&&this.uj){let cc;({editor:cc}=this.uj.xnb(Xa.clientId)).returnValue&&(vb=cc.Name)}return Object.assign(new D.a,{clientId:Xa.clientId,chatThreadId:Xa.chatThreadId,chatThreadDiscoveryUri:Xa.chatThreadDiscoveryUri,inChat:Xa.inChat,email:Xa.email,capabilities:new ka.a(Xa.capabilities),userName:vb})}}Object(h.a)(Gb,"PresenceUtils",
null,[1086]);var Bb;(function(Xa){Xa[Xa.coauthHandlerResponse=0]="coauthHandlerResponse";Xa[Xa.popSessionResponse=1]="popSessionResponse";Xa[Xa.defaultFallback=2]="defaultFallback"})(Bb||(Bb={}));Object(h.b)("RtcDiscoverType",Bb);class dc{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd,Sc,jg,mg,Pa,bb){this.T4d=Xa;this.bwd=vb;this.awd=cc;this.Rwb=wc;this.Z$b=Ad;this.C_c=Md;this.Anb=Sd;this.Uyd=Le;this.kkb=fe;this.TQc=Vf;this.RQc=Cd;this.aQb=Sc;this.Ohb=jg;this.swb=mg;this.zYf=Pa;this.r6d=bb}Ygk(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",
this.T4d,this.bwd,this.awd,this.Rwb,this.Z$b,this.C_c,this.Anb,this.Uyd,this.kkb,this.TQc,this.RQc,this.aQb,this.Ohb,this.swb,this.zYf,this.r6d)}}Object(h.a)(dc,"RttLockSettings",null,[]);var Xc=d(349);class Fb{constructor(Xa,vb,cc,wc){this.hic=this.gic=null;this.Pmf=!1;this.Ouk=Xa;this.Ga=vb;this.Hh=cc;this.zY=wc;this.xHb=new Date;this.hIa=-1}get gb(){return this.Ouk}get z4c(){return this.Pmf}set z4c(Xa){this.Pmf=Xa}l5i(){return 0<this.hIa&&Date.now()>=this.hIa}Lzh(Xa){this.hIa=Xa}n9b(){return""}o9b(){return""}YLb(Xa){this.gic=
Xa?this.n9b():this.o9b();this.hic=new Date}VZd(){}XZd(){return!1}kwh(Xa,vb){Xa=Xa||"";vb=vb||"";if(Xa.length!==vb.length)return null;const cc=[];for(let wc=0;wc<Xa.length;wc+=1)Xa.charAt(wc)!==vb.charAt(wc)&&cc.push(wc);return 0<cc.length?zb.a.kI("Length",Xa.length,"FirstDiffPos",cc[0],"DiffCount",cc.length):null}mUa(Xa){return H.a.replaceAll(Xa,"\u00a0"," ").trim()}}Object(h.a)(Fb,"ATextContentRecord",null,[]);var kd=d(36),od=d(43);class Gd extends Fb{constructor(Xa,vb,cc,wc){super(Xa,vb,cc,wc);
this.o4g=Xa.mA}get shapeNode(){return Object(ra.a)(4,this.gb)}xul(){this.o4g=this.shapeNode.mA}n9b(){const Xa=new m.a;var vb=this.shapeNode.vy();for(const cc of vb)(vb=this.Hh.text(cc))&&0<vb.length&&Xa.add(vb);return Xa.toArray().join(" ")}o9b(){return this.Ga.p9(this.shapeNode)}VZd(){try{const Xa=this.n9b()||"",vb=this.gic||"";if(Xa!==vb){const cc=this.mUa(Xa)===this.mUa(vb),wc=this.o4g||this.shapeNode.mA;if(!cc&&!wc&&!this.shapeNode.xd){const Ad=zb.a.kI("Shape",this.shapeNode.Xm,"Start",od.a.vf(this.xHb),
"LastSnapshotTime",od.a.vf(this.hic),"EverEdit",this.z4c,"Type",this.getShapeType());Ad.Expiration=-1<this.hIa?(+new Date(this.hIa)-+this.xHb).toString():null;const Md=Xa.length-vb.length;Md?Ad.TextLengthDelta=Md:Ad.SameLengthDiffDetails=this.kwh(Xa,vb);aa.a.J(25539747,814,15,kd.c(Ad))}}}catch(Xa){aa.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Xa)}}XZd(){try{const Xa=this.zY.V7b(this.shapeNode);if(Xa&&0<Xa.length)return!1;const vb=this.o9b()||"",cc=this.gic||"";if(vb!==cc&&
0>vb.indexOf(cc)&&!(0<=this.mUa(vb).indexOf(this.mUa(cc))||this.shapeNode.xd)){const wc=zb.a.kI("Shape",this.shapeNode.Xm,"Start",od.a.vf(this.xHb),"LastSnapshotTime",od.a.vf(this.hic),"TextLengthDelta",vb.length-cc.length,"Type",this.getShapeType());aa.a.J(25981903,814,15,kd.c(wc))}}catch(Xa){aa.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Xa)}return!0}getShapeType(){return this.shapeNode.xd?"Table":this.shapeNode.Wf?"SmartArt":this.shapeNode.Gw?"TextBox":this.shapeNode.Ik?
"PlaceHolder":this.shapeNode.Rla?"Shape":"Unknown"}}Object(h.a)(Gd,"ShapeContentRecord",Fb,[]);class Fd{constructor(Xa,vb,cc,wc,Ad,Md,Sd,Le,fe,Vf,Cd,Sc,jg){this.lhb=this.BHb=null;this.hP={};this.vJa={};this.pa=Le;this.yE=fe;this.Mc=Xa;this.Ys=vb;this.gmk=cc;this.Ur=wc;this.ua=Ad;this.Rf=Md;this.zY=Sd;this.Ga=Vf;this.zc=Cd;this.wIe=Sc;this.Ss=jg;this.pa.uBf(Object(r.a)(this,this.uKk,"onPreSelectionChanged"));this.pa.FC(Object(r.a)(this,this.xJb,"onSetSelectionFinished"));this.yE.yli(Object(r.a)(this,
this.NMk,"onTableCellViewElementLocked"));this.Mc.yii(Object(r.a)(this,this.esi,"beforeProcessInboundResponse"));this.Ys.$sb(Object(r.a)(this,this.bMk,"onShapeViewElementOpenTextEditView"));this.Ys.aKc(Object(r.a)(this,this.WLk,"onShapeViewElementCloseTextEditView"));this.Ys.FBf(Object(r.a)(this,this.aMk,"onShapeViewElementLocked"));this.gmk.DUd(Object(r.a)(this,this.JMk,"onSuccessfulInbound"));this.Ur.gk(Object(r.a)(this,this.$g,"onPropertyChanged"));this.Rf.LI(Object(r.a)(this,this.aC,"onActiveSlideChanged"))}bMk(Xa,
vb){Xa=Object(ra.a)(4,Object(ra.a)(Xc.a,vb.$w).gb);vb=this.wIe.O2d(Xa);this.hP[Xa.id.toString()]=vb;vb.YLb(!0)}WLk(Xa,vb){Xa=Object(ra.a)(4,Object(ra.a)(Xc.a,vb.$w).gb).id.toString();Xa in this.hP&&this.hP[Xa].Lzh(Date.now()+this.Ss.Rwb)}aMk(Xa,vb){Xa=Object(ra.a)(4,Object(ra.a)(Xc.a,vb.$w).gb).id.toString();Xa in this.hP&&delete this.hP[Xa]}uKk(){this.BHb=this.QSf}xJb(){this.lhb=this.QSf;if(!(!this.BHb&&!this.lhb||this.BHb&&this.lhb&&this.lhb.id.equals(this.BHb.id))){if(this.BHb){var Xa=this.BHb.id.toString();
Xa in this.hP&&this.hP[Xa].Lzh(Date.now()+this.Ss.Rwb)}this.lhb&&(Xa=this.wIe.O2d(this.lhb),this.hP[this.lhb.id.toString()]=Xa,Xa.YLb(!0))}}get QSf(){var Xa=this.pa.Pa;if(!Xa||!Xa.nb||Xa.nb.Sl)return null;Xa=Xa.nb;return Xa.Ua.node&&Xa.Ua.node.isConnected?this.zc.fFa(Xa.Ua.node):null}NMk(Xa,vb){Xa=vb.tableCellNode.id.toString();Xa in this.hP&&delete this.hP[Xa]}esi(){this.dqh();for(const Xa of Object.keys(this.hP))this.hP[Xa].YLb(!0)}JMk(){this.dqh();for(const Xa of Object.keys(this.hP))this.hP[Xa].VZd();
for(const Xa of Object.keys(this.vJa))this.vJa[Xa].XZd()&&delete this.vJa[Xa]}$g(Xa,vb){if(vb&&vb.node&&vb.property.id===na.a.Oo.id){Xa=Object(ra.a)(5,vb.node);vb=!vb.node.loading;const cc=this.zc.fFa(Xa);if(cc)this.L6g(cc,vb),this.M6g(cc,vb);else if(Xa=this.Ga.Xda(Xa))this.L6g(Xa,vb),this.M6g(Xa,vb)}}aC(){this.vJa={}}dqh(){for(const Xa of Object.keys(this.hP))this.hP[Xa].l5i()&&delete this.hP[Xa]}L6g(Xa,vb){Xa=Xa.id.toString();if(Xa in this.hP){Xa=this.hP[Xa];const cc=Object(ra.a)(Gd,Xa);cc&&cc.xul();
Xa.YLb(!0);vb&&(Xa.z4c=!0)}}M6g(Xa,vb){var cc=this.Ga.An(Xa);cc&&this.ua.Ba&&this.ua.Ba.sid===cc.get_sid()&&this.ua.Ba.cid===cc.get_cid()&&(cc=Xa.id.toString(),vb?cc in this.vJa&&delete this.vJa[cc]:(vb=Object(ha.a)(130,Xa)?this.zY.J7b(Object(ra.a)(130,Xa)):this.zY.V7b(Object(ra.a)(4,Xa)))&&0<vb.length&&(cc in this.vJa?this.vJa[cc].YLb(!1):(Xa=this.wIe.O2d(Xa),this.vJa[cc]=Xa,Xa.YLb(!1))))}}Object(h.a)(Fd,"TextContentMonitor",null,[]);class ee extends Fb{constructor(Xa,vb,cc,wc,Ad){super(Xa,vb,wc,
Ad);this.zc=cc}get tableCellNode(){return Object(ra.a)(130,this.gb)}n9b(){const Xa=new m.a;this.zc.Hpc(this.tableCellNode,vb=>{(vb=this.Hh.text(vb))&&0<vb.length&&Xa.add(vb)});return Xa.toArray().join(" ")}o9b(){const Xa=new m.a;this.zc.Hpc(this.tableCellNode,vb=>{vb.Ta(na.a.Oo)&&(vb=vb.eb(na.a.Oo))&&0<vb.length&&Xa.add(vb)});return Xa.toArray().join(" ")}VZd(){try{const Xa=this.n9b()||"",vb=this.gic||"";if(Xa!==vb&&this.mUa(Xa)!==this.mUa(vb)){const cc=zb.a.kI("TableCellNode",this.RBh+"/"+this.tableCellNode.Xm,
"Start",od.a.vf(this.xHb),"LastSnapshotTime",od.a.vf(this.hic),"EverEdit",this.z4c);cc.Expiration=-1<this.hIa?(+new Date(this.hIa)-+this.xHb).toString():null;const wc=Xa.length-vb.length;wc?cc.TextLengthDelta=wc:cc.SameLengthDiffDetails=this.kwh(Xa,vb);aa.a.J(37748808,814,15,kd.c(cc))}}catch(Xa){aa.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Xa)}}XZd(){try{const Xa=this.zY.J7b(this.tableCellNode);if(Xa&&0<Xa.length)return!1;const vb=this.o9b()||"",cc=this.gic||"";if(vb!==
cc&&0>vb.indexOf(cc)&&!(0<=this.mUa(vb).indexOf(this.mUa(cc)))){const wc=zb.a.kI("TableCellNode",this.RBh+"/"+this.tableCellNode.Xm,"Start",od.a.vf(this.xHb),"LastSnapshotTime",od.a.vf(this.hic),"TextLengthDelta",vb.length-cc.length);aa.a.J(37748812,814,15,kd.c(wc))}}catch(Xa){aa.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Xa)}return!0}get RBh(){const Xa=this.Ga.An(this.tableCellNode);return Xa?Xa.Xm:"UnknownShape"}}Object(h.a)(ee,"TableCellContentRecord",Fb,[]);class Bf{constructor(Xa,
vb,cc,wc){this.Ga=Xa;this.zc=vb;this.Hh=cc;this.zY=wc}O2d(Xa){return Object(ha.a)(4,Xa)?new Gd(Object(ra.a)(4,Xa),this.Ga,this.Hh,this.zY):Object(ha.a)(130,Xa)?new ee(Object(ra.a)(130,Xa),this.Ga,this.zc,this.Hh,this.zY):null}}Object(h.a)(Bf,"TextContentRecordFactory",null,[1060]);var be=d(640);class af{constructor(Xa,vb,cc,wc,Ad){this.Eb=Xa;this.qna=vb;this.pa=cc;this.yE=wc;this.Yv=Ad;this.E8c=!1}initialize(){this.pa.FC(Object(r.a)(this,this.xJb,"onSetSelectionFinished"));this.yE.Hli(Object(r.a)(this,
this.Keh,"onTypingLockStatusChanged"))}dispose(){this.pa.sXe(Object(r.a)(this,this.xJb,"onSetSelectionFinished"));this.yE.Xcl(Object(r.a)(this,this.Keh,"onTypingLockStatusChanged"))}xJb(){var Xa=this.pa.Fv();let vb=null;for(const cc of Xa)if(Xa=Object(ra.a)(ta.TableCellNode,cc))if(Xa=Object(ra.a)(713,Xa.rg(this.Eb.Na)))if(vb=Xa.T5c)break;this.GRh(vb)}Keh(Xa,vb){this.GRh(vb.NTi)}GRh(Xa=null){this.pa.J9()?this.DHl(Xa):this.khl()}DHl(Xa=null){if(this.Eb.editingView&&this.Eb.editingView.lm){const vb=
this.R7f();vb&&(this.qna.dJ(vb.shapeNode).Ozd(Xa),Xa&&(vb.Wud=!0,this.Yv.onh(new be.a(vb)),vb.Wud=!1));this.E8c||aa.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Eb.editingView.disable(!1,14);this.E8c=!0}}khl(){if(this.Eb.editingView&&this.Eb.editingView.lm){const Xa=this.R7f();Xa&&Xa.shapeNode.xd&&(this.qna.dJ(Xa.shapeNode).Ozd(null),Xa.The());this.E8c&&aa.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");
this.Eb.editingView.u2a();this.E8c=!1}}R7f(){let Xa=null;const vb=this.pa.Ud();1===vb.length&&(Xa=Object(ra.a)(117,vb[0].qc(this.Eb.Na)));return Xa}}Object(h.a)(af,"TypingLockHandler",null,[1085,108]);var Ue=d(925);class qf{constructor(){this.k$c=this.jh=this.G5=this.t9c=this.JE=this.K=this.BH=null;this.mfc=0;this.hed=null;this.Wxe=!1;this.r6c=null;this.fAe=!1;this.i9c=!0;this.Pjc=wb.a("PresencePackage.RefactorInit");this.gjk=wb.a("PresencePackage.CheckSignalRLoadedBeforeRTC")}get name(){return"Presence"}SIi(){this.K.register(D.a,
"Common.PresenceUser").as("Common.IPresenceUser").na();this.K.register(Gb,"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").na().oa(()=>new Gb(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.Wxe=!0}Xb(Xa){try{aa.a.J(509100485,814,50,"PresencePackage::configure");this.mfc=(new Date).getTime();this.K!==Xa&&(this.K=Xa,this.G5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.jh=this.G5.WEa(1,this.name),this.Wxe=!1,this.fAe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);
this.BH=this.K.resolve("Common.AFrameworkApplication");const vb=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.i9c=!w.AFrameworkApplication.fa.ka("PPTODeprecateRtcFallback");this.Wxe||this.SIi();if(this.gjk){aa.a.J(508864333,814,50,"PresencePackage::configure; Check SignalR loaded");const Ad=this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener");if(Ad.$3c)aa.a.J(508864332,814,50,"PresencePackage::configure; SignalR loaded early");else{aa.a.J(508864331,814,15,"PresencePackage::configure; SignalR not loaded");
Ad.vVj(()=>{aa.a.J(508864330,814,50,"PresencePackage::configure; SignalR loaded");this.Xb(J.a.instance)});return}}const cc=vb.QBi&&vb.KRb?!1:vb.yg,wc=this.kRi(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),cc,vb["368"]);wc?(this.K.register(1057,"Common.IRealtimeChannelBasic").na().oa(()=>wc),this.K.register(1058,"AppRealtimeChannel.IRealtimeChannel").na().oa(()=>wc),this.PIi(vb),this.Pjc&&this.init()):aa.a.J(509100484,814,15,"PresencePackage::configure could not create rtc")}catch(vb){aa.a.J(508929377,
814,10,"PresencePackage::configure; Initializing Presence failed: {0}",vb)}}PIi(Xa){this.K.register(Oa,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").na().oa(()=>new Oa(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(ab,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").na().oa(()=>new ab(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(rc,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").na().oa(()=>
new rc(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkState"),T.a.getInstance(),Xa.rtcAllowCrossDomainAccessOrigins));this.K.register(eb,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").na().oa(()=>
new eb(this.K.resolve("Common.IPresenceUser"),w.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),this.BH.hT,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Xa,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").HYc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(mb,"PowerpointPresence.PresenceCache").na().oa(()=>new mb(this.K.resolve("PowerpointPresence.IPresenceManager")));
this.K.register(Yc,"PowerpointPresence.PresencePresenter").na().oa(()=>new Yc(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Xa.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(Mc,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").na().oa(()=>new Mc(this.K.resolve("Common.IPresenceUser").clientId,Xa.awl,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").zd(10),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const vb=new dc(Xa.TXi,Xa.bwd,Xa.awd,Xa.Rwb,Xa.Z$b,Xa.C_c,Xa.Anb,Xa.Uyd,Xa.kkb,Xa.TQc,Xa.RQc,Xa.aQb,Xa.Ohb,Xa.swb,Xa.podsTableRTTEnabled,Xa.podsTableCellLockEnabled);this.K.register(af,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").na().oa(()=>new af(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Ja,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").na().oa(()=>new Ja(da.App.Oh,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").zd(12),Xa,vb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na,this.K.resolve("Box4.Graph.IGraphInstance").zd(16),F.a.Ot(J.a.instance.Ia("Common.ISystemInitiatedFeedback"))));this.K.register(1059,"PowerpointPresence.IPresencePawnFactory").na().oa(()=>new Hc);
this.K.register(1060,"PowerpointPresence.ITextContentRecordFactory").na().oa(()=>new Bf(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(Fd,"PowerpointPresence.TextContentMonitor").na().oa(()=>new Fd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
Y.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").zd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),
vb));this.K.register(B,"Common.App.Presence.AwayManager").na().oa(()=>this.VMi(this.K.resolve("Common.IPresenceUser"),this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Xa.ka("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(1061,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").na().oa(()=>new Rd(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));aa.a.J(509100483,814,50,"PresencePackage::configurePostRTC; Setting Rtc configured");
this.lSc().olb("RTCConfigured")}usj(Xa){let vb;var cc=Xa;vb=0;if(Xa=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Ntj())return cc=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Kud(),{sZe:Xa,qZe:vb,N7d:cc};vb=1;if(Xa=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").mvh)return cc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Kud,{sZe:Xa,qZe:vb,N7d:cc};if(this.i9c)return{sZe:cc,qZe:2,N7d:!0}}jRi(){const Xa=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;
0<Xa&&(this.hed=new z.a(2,1,Xa,()=>{this.i9c?this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").T0f=!0:this.K.rb("AppRealtimeChannel.IRealtimeChannel")||aa.a.J(509670485,828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Xa);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Erh(Object(r.a)(this,this.rOe,"onPopsRtcEndpointUrlReady"));this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.Xb(J.a.instance),this.Pjc||
this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Hb(this.hed))}kRi(Xa,vb,cc,wc){aa.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",cc);vb.clientId=Xa.clientId;var Ad=null;vb=null;const Md=T.a.getInstance();if(cc){vb=wc+"rtc2";({sZe:vb,qZe:cc,N7d:wc}=this.usj(vb));Ad=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const Sd=this.i9c&&this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").T0f,Le=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Ssg;
aa.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",Bb[cc],Ad,wc,Sd,Le);if(2===cc&&!Sd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Aki(Object(r.a)(this,this.rOe,"onPopsRtcEndpointUrlReady")),this.jRi(),null;if(!wc&&!Ad)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").LJc(Object(r.a)(this,this.UJa,"onCoauthStatusChanged")),
null;Ad=this.OMi(Xa,vb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Md)}return L.RealtimeChannel.createInstance(Xa.clientId,Xa.userSessionId,Xa.Brd,Xa.eda,Xa.myh,3,Xa.gx,vb,Ad,Md)}VMi(Xa,vb,cc,wc,Ad){const Md=new C.a;Md.Ng(cc);cc=new C.a;cc.Ng(vb);return new B(Xa,cc.task,Md.task,wc,this.K.resolve("Common.ITaskManager"),this.BH.hT.rd.lXd?6E4:this.BH.hT.rd.awayCoauthorThresholdMs,Object(r.a)(this.BH.hT.kH(),this.BH.hT.kH().processAction,"processAction"),fa.App.p7a.notificationBar,Ad)}init(){aa.a.J(509100482,
814,50,"PresencePackage::init; initing presence");const Xa=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Xa.li(21,qf.Qjc);Xa.li(22,this.mfc);Xa.li(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?(aa.a.J(509100481,814,50,"PresencePackage::init; Setting Presentation Id ready"),this.lSc().olb("PresentationId")):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").sBf(Object(r.a)(this,this.Cnc,"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").JAb(()=>
{aa.a.J(509100480,814,50,"PresencePackage::init; Setting B2I Finished");this.lSc().olb("B2IFinished")})}Cnc(){aa.a.J(509100451,814,50,"PresencePackage::onPresentationIdReady; Setting Presentation Id ready");this.lSc().olb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").Frh(Object(r.a)(this,this.Cnc,"onPresentationIdReady"))}rOe(){this.hed&&this.K.resolve("Common.ITaskManager").Kg(this.hed);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Erh(Object(r.a)(this,
this.rOe,"onPopsRtcEndpointUrlReady"));this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.Xb(J.a.instance),this.Pjc||this.init())}UJa(Xa,vb){2!==vb.tLe||this.K.rb("AppRealtimeChannel.IRealtimeChannel")||(this.Xb(J.a.instance),this.Pjc||this.init());this.K.rb("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").fqd(Object(r.a)(this,this.UJa,"onCoauthStatusChanged"))}lSc(){this.k$c||(this.k$c=new Ue.a(Object(r.a)(this,this.pAb,"initInternal"),
["PresentationId","B2IFinished","RTCConfigured"]));return this.k$c}pAb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").li(4,this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").dVe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").li(23,(new Date).getTime());this.BRj();this.vSj();this.k$c=null}vSj(){try{let Xa="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Xa=this.jh.du("presencemanager");this.wSj();this.jh.lu(Xa);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").y3c=
!0;aa.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");da.App.T0d&&(Xa=this.jh.du("contentnotification"),jb.init(),this.jh.lu(Xa));Xa=this.jh.du("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").E2i();this.JE=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.BH.hT.rd.o4i&&(aa.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.BH.hT.kH().processAction(t.a.J8a,
2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.BH.hT.rd.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.jh.lu(Xa);this.K.resolve("PowerpointPresence.IPresencePerfLogger").p2i();
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").ogk()}catch(Xa){aa.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Xa)}}dispose(){this.JE?this.JE.disconnect():aa.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}wSj(){this.K.resolve("PowerpointPresence.PresenceManager").vb();aa.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}OMi(Xa,
vb,cc,wc){let Ad=vb;Ad=Ad.endsWith("/")?Ad+"findsession":Ad+"/findsession";aa.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",Ad,Xa.eda.zha);vb=()=>U.FindSessionStrategy.YOi(Xa.userSessionId,Xa.eda,Ad,Xa.gx,w.AFrameworkApplication.buildVersion,Xa.clientId,qf.Cbj(w.AFrameworkApplication.buildVersion),wc,Xa.myh,()=>{if(w.AFrameworkApplication.Pg)return w.AFrameworkApplication.Pg;const Sd=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;
Sd||aa.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return Sd},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Ltj());const Md=!!this.t9c;return this.fAe||Md?this.r6c=new Sa(this.t9c,vb,cc,wc,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):vb()}BRj(){var Xa;if(Xa=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():
this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").Z8d)Xa=ca.RtcUtils.deserialize(Xa,"PresencePackage","Deserialize existing FindSession response",!0),this.Xld(Xa)}Xld(Xa){if(Xa)try{this.t9c=Object.assign(new O.a,{Bcc:Xa[N.a.JBb],errorMessage:Xa[N.a.errorMessage],Y2b:Xa[N.a.C4e],z6:Xa[N.a.z6],wB:Xa[N.a.wB],TYc:Xa[N.a.Yfe],bhd:Xa[N.a.Phb],chd:Xa[N.a.TMa],fhd:Xa[N.a.Rhb]}),this.fAe&&this.r6c&&(this.r6c.findSessionResponse=this.t9c)}catch(vb){aa.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",
vb)}}static main(){qf.Qjc=(new Date).getTime();const Xa=new qf;w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Xa.Xb(J.a.instance),Xa.K.rb("AppRealtimeChannel.IRealtimeChannel")&&!Xa.Pjc&&Xa.init()):M.a.instance.Ac(Xa)}static Cbj(Xa){return String.format("{0}, {1}, {2}",qf.BKf(Q.a[3]),qf.BKf("browser"),Xa)}static BKf(Xa){return Xa?Xa.charAt(0).toLocaleUpperCase()+Xa.substring(1,Xa.length):Xa}}qf.Qjc=0;Object(h.a)(qf,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");qf.main()},194:function(K,S,d){d.r(S);d.d(S,"RtcUtils",function(){return m});K=d(0);var h=d(395),e=d(347),r=d(36);class m{static MZd(n,z=e.RealtimeChannel.WJe){let t;try{t=r.c(n)}catch(x){throw n=String.format("Failed to JSON-serialize payload : {0}",x),h.ULS.sendTraceTag(18637072,500,10,n),Error.argument("payload",n);}if(t.length>
z)throw n=String.format("Payload exceeds maximum length: {0} > {1}.",t.length,z),h.ULS.sendTraceTag(18637074,500,10,n),Error.argument("payload",n);return t}static deserialize(n,z,t){if(!n)return null;if(Object.getType(n)!==String){var x=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",z,Object.getType(n).getName(),t);h.ULS.sendTraceTag(18637075,500,10,x);return null}x=null;try{x=r.a(n)}catch(B){n=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
z,B,t),h.ULS.sendTraceTag(18637077,500,10,n)}return x}static VIb(n){if(!n)return"";if("string"===typeof n)return n.toString();try{return r.c(n)}catch(z){return n.toString()}}static n0f(n){let z,t,x;z=0;x=t=null;if(!n)return{qie:z,rie:t,hj:x};try{const B=n.source;B&&Object.getType(B)===String&&(x=B);const D=n.context;D&&(n=D,z=n.status?n.status:0,t=n.statusText?n.statusText:null)}catch(B){}return{qie:z,rie:t,hj:x}}}Object(K.a)(m,"RtcUtils",null,[])},309:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=
d(7),r=d(106),m;(function(x){x[x.SendNotification=0]="SendNotification";x[x.SendPersistentState=1]="SendPersistentState";x[x.FindSession=2]="FindSession";x[x.Last=3]="Last"})(m||(m={}));Object(K.b)("ApiType",m);var n;(function(x){x[x.AttemptCount=0]="AttemptCount";x[x.SuccessCount=1]="SuccessCount";x[x.DropCount=2]="DropCount";x[x.FailedCount=3]="FailedCount";x[x.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";x[x.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";x[x.ThrottledCount=
6]="ThrottledCount";x[x.Last=7]="Last"})(n||(n={}));Object(K.b)("EventCountType",n);var z=d(714);d.d(S,"FrequentLoggingMetrics",function(){return t});class t{constructor(x){this.GOf=this.r2f=null;this.H5g=this.N4f=0;this.Vt=null;this.Iof=this.PKd=0;this.ji=x;this.iSj();this.NFd=this.sif=this.gLd=!1;this.KKd=0}get q4i(){return this.NFd}AFl(x){this.Iof=x;window.setInterval(Object(e.a)(this,this.Wte,"logMetricsBatchAndReset"),x);this.PKd=(new Date).getTime()}uH(x,B){this.mwl(x)&&!this.sif||this.q4i||
!window.navigator.onLine||this.ji.fGa||(this.Vt[x][B]++,this.gLd=!0)}iSj(){this.Vt=Array(3);for(let x=0;3>x;x++){this.Vt[x]=Array(7);for(let B=0;7>B;B++)this.Vt[x][B]=0}}ivi(){const x={};for(let B=0;3>B;B++)for(let D=0;7>D;D++)this.M9j(B,D)&&(x[m[B]+n[D]]=this.Vt[B][D]);x.FSDomain=this.r2f;x.ConnectionDomain=this.GOf;x.FSRetryInterval=this.N4f;x.MaxPayloadSize=this.H5g;x.LogNumber=this.KKd;1===this.KKd&&(x.FSLatencies=z.a.instance.Bkj(),x.ConLatencies=z.a.instance.Cgj());return x}M9j(x,B){return 2===
x&&3!==B&&0!==B?!1:!0}mwl(x){return 2===x?!1:!0}Wte(){if(this.gLd){this.KKd++;if((new Date).getTime()-this.PKd<5E3+this.Iof){var x=r.a.toJSON(this.ivi());h.ULS.sendTraceTag(50644352,500,15,x)}this.PKd=(new Date).getTime();for(x=0;3>x;x++)for(let B=0;7>B;B++)this.Vt[x][B]=0;this.gLd=!1}}jyk(){this.sif=!0}static get instance(){return t.La}static create(x){t.instance||(t.La=new t(x));return t.instance}}t.La=null;Object(K.a)(t,"FrequentLoggingMetrics",null,[1136])},347:function(K,S,d){d.r(S);K=d(0);var h=
d(395),e=d(7),r=d(1098),m=d(1017),n=d(72),z=d(27);class t{constructor(Na,sa){this.status=Na;this.FCb=sa}}Object(K.a)(t,"UserStatusInfo",null,[]);var x=d(77),B=d(714);class D{constructor(Na,sa){this.data=Na;this.timeStamp=sa}}Object(K.a)(D,"PresenceData",null,[]);class w{constructor(Na){this.Ira=!1;this.rsb=0;this.YDd=!1;this.setTimeout=w.Z3d;this.clearTimeout=w.P3d;this.vhk=Object(e.a)(this,this.Jgk,"logRtcConnectingUsageStatement");this.Cr=Na}dGk(){this.Ira||(this.rsb=this.setTimeout(()=>{this.Ira=
!1;this.Lyg()},8E3),this.Ira=!0,this.YDd=!1)}OGk(){this.LN()}IMk(){this.Lyg()}Lyg(){this.LN();this.YDd||(this.YDd=!0,this.vhk())}Jgk(){h.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Cr)}LN(){this.Ira&&this.clearTimeout(this.rsb);this.rsb=0;this.Ira=!1}static Z3d(Na,sa){return window.setTimeout(Na,sa)}static P3d(Na){window.clearTimeout(Na)}}Object(K.a)(w,"ConnectedUsageKpiLogger",null,[1202]);class J{constructor(){this.wpd=this.BVe;this.EVe=this.FVe;
this.xpd=this.DVe;this.frc=this.HVe;this.moh=this.GVe;this.OVe=this.PVe;this.LVe=this.MVe;this.Wjb=this.JVe;this.hrc=this.KVe;this.hoh=this.CVe;this.EIb=this.mLe;this.Emc=this.nLe}BVe(){}FVe(){}DVe(){}HVe(){}GVe(){}MVe(){}KVe(){}JVe(){}PVe(){}CVe(){}mLe(){}nLe(){}}Object(K.a)(J,"NoopRealtimeChannelMetrics",null,[1193,355]);class F{}F.a3a="presenceUpdated";F.updateNotification="updateNotification";F.Whh="persistentStateCleared";F.updatePersistentState="persistentStateUpdated";Object(K.a)(F,"RtcClientMethodNames",
null,[]);class L{}L.sNj="realtimeChannelHub";L.a3a="UpdatePresence";L.bba="SendUpdateNotification";L.vae="GetCompletePersistentStateWithMetadata";L.updatePersistentState="UpdatePersistentState";L.Dnb="UpdateClientInfo";Object(K.a)(L,"RtcHubMethodNames",null,[]);class M{constructor(Na){this.cA=Na}N8k(Na){this.cA.on(F.a3a,Na)}p9k(Na){this.cA.on(F.updateNotification,Na)}K8k(Na){this.cA.on(F.updatePersistentState,Na)}J8k(Na){this.cA.on(F.Whh,Na)}aRl(Na){this.cA.off(F.a3a,Na)}fRl(Na){this.cA.off(F.updateNotification,
Na)}$Ql(Na){this.cA.off(F.updatePersistentState,Na)}ZQl(Na){this.cA.off(F.Whh,Na)}a3a(Na){return this.cA.invoke(L.a3a,Na)}Dnb(Na){return this.cA.invoke(L.Dnb,Na)}bba(Na,sa){return this.cA.invoke(L.bba,Na,sa)}vae(Na){return this.cA.invoke(L.vae,Na)}updatePersistentState(Na,sa){return this.cA.invoke(L.updatePersistentState,Na,sa)}}Object(K.a)(M,"RealtimeChannelProxy",null,[1198,1199,1200]);class Q{constructor(){this.ECd=this.Fdf=!1;this.CCd=0;this.IDd=this.JPd=this.IPd=this.eCd=!1;this.aGd=0;this.Otf=
!1;this.Ntf=this.Mtf=0;this.KOd=!1;this.OOd=this.MOd=this.POd=this.LOd=0;this.NOd=!1}get lXd(){return this.ECd}get awayCoauthorThresholdMs(){return this.CCd}get wni(){return this.eCd}get xxl(){return this.IPd}get yxl(){return this.JPd}get KEi(){return this.IDd}get G6b(){return this.aGd}get gil(){return this.Otf}get nvh(){return this.Mtf}get fil(){return this.Ntf}get ail(){return this.KOd}get bil(){return this.LOd}get rvh(){return this.POd}get ovh(){return this.MOd}get qvh(){return this.OOd}get pvh(){return this.NOd}static createInstance(Na){const {RealtimeChannel:sa}=
d(347);return Na?Object.assign(new Q,{Fdf:Na.ka("AwayStatusManagerIsEnabled"),ECd:Na.ka("AwayStatusOneMinuteTimeoutIsEnabled"),CCd:Na.uc("AwayCoauthorThresholdMs",9E5),eCd:Na.ka("RtcAllowCrossDomainAccessEnabled"),IPd:Na.ka("ShouldLogOnContentNotification"),JPd:Na.ka("ShouldLogOnHostSubscriptionNotification"),IDd:Na.ka("RtcClientMetricsEnabled"),aGd:Na.uc("RtcFindSessionRequestTimeoutInMS",6E4),Otf:Na.ka("RtcJsClientFrequentlyLogsMetrics"),Mtf:Na.uc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),Ntf:Na.uc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),KOd:Na.ka("RtcClientMessageTelemetryEnabled"),LOd:Na.uc("RtcClientMessageTelemetrySampleSize",5),POd:Na.uc("RtcSendTelemetryMessageIntervalInMS",3E5),MOd:Na.uc("RtcLogClientMessageMetricsTimeOutInMs",2E4),OOd:Na.uc("RtcMaxPayloadSizeInCharactersOverride",sa.WJe),NOd:Na.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new Q,{Fdf:!1,ECd:!1,CCd:9E5,eCd:!1,IPd:!1,JPd:!0,IDd:!1,aGd:9E4,
KOd:!1,LOd:5,POd:3E5,MOd:2E4,OOd:sa.WJe,NOd:!1})}}Object(K.a)(Q,"RealtimeChannelSettings",null,[1197]);var C=d(718),O=d(1253),U=d(153);class T{constructor(Na){this.LZb=null;this.Oya=0;this.Z9a=!1;this.pl=Na;this.pl.A7a(Object(e.a)(this,this.joa,"onConnectionStateChanged"))}joa(Na,sa){this.Oya=sa.newState}ZMk(){h.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.pl.gpd()}YQj(Na){this.LZb.init(Na)}}Object(K.a)(T,"ARtcMessageHandler",null,[]);var ca=d(721);
class N{constructor(){this.Presence=null;this.TimeStamp=0}}Object(K.a)(N,"PresenceDataEntryForClients",null,[]);var da=d(106);class Y{constructor(Na,sa=""){this.x9h=Na;this.pBa=sa}send(){return this.x9h()}get messageId(){return this.pBa}}Object(K.a)(Y,"MessageHandler",null,[1228]);var fa=d(746);class aa extends Sys.EventArgs{constructor(Na,sa,Sa,xb){super();this.YXe=Na;this.reconnectDelay=sa;this.reason=Sa;this.G_e=xb}}Object(K.a)(aa,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ka=d(1021);
class H{constructor(){this.tQd=this.Nj=null}get er(){return this.Nj?this.tQd?this.tQd.getTime()-this.Nj.getTime():(new Date).getTime()-this.Nj.getTime():0}start(){this.Nj=new Date}stop(){this.tQd=new Date}}Object(K.a)(H,"SimpleStopwatch",null,[]);var ra=d(1022),ha;(function(Na){Na[Na.contentUpdate=0]="contentUpdate";Na[Na.editorsTableUpdate=1]="editorsTableUpdate";Na[Na.fileNameUpdate=2]="fileNameUpdate";Na[Na.wetContentUpdate=3]="wetContentUpdate";Na[Na.persistedContentUpdate=4]="persistedContentUpdate";
Na[Na.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Na[Na.replicationTelemetry=6]="replicationTelemetry";Na[Na.lockUpdate=7]="lockUpdate";Na[Na.collabServiceContentUpdate=8]="collabServiceContentUpdate";Na[Na.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Na[Na.saveTargetUpdate=10]="saveTargetUpdate";Na[Na.uploadToOcsUpdate=11]="uploadToOcsUpdate";Na[Na.labelUpdate=12]="labelUpdate";Na[Na.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Na[Na.subscribeOrExtend=
14]="subscribeOrExtend";Na[Na.elapsedBootTelemetry=15]="elapsedBootTelemetry";Na[Na.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Na[Na.clientToClientResponseMessage=17]="clientToClientResponseMessage";Na[Na.verifyNotificationPipeline=18]="verifyNotificationPipeline";Na[Na.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Na[Na.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Na[Na.last=21]="last"})(ha||(ha={}));Object(K.b)("UpdateNotificationType",ha);var Ma=d(580),
Ga=d(790),na=d(791);class wa extends T{constructor(Na,sa,Sa,xb,gc,zc,Xb,jb,zb,Tb){super(Xb);this.cA=null;this.Aof=this.Bof=!1;this.pBa=0;this.iNd=new U.a;this.g4h=wa.Pgj();this.MMd=z.AFrameworkApplication.fa.Ha("OwningFeatureCrewForRtcNotificationKpis");this.Yc=Na;this.iqf=this.hqf=0;this.LZb=sa;this.LZb.dKc(Object(e.a)(this,this.ZMk,"onTooManyUndeliveredMessages"));this._clientId=Sa;this.$7h=gc;this.pl.Kki(Object(e.a)(this,this.VKk,"onRefreshProxyRequired"));this.pl.Iki(Object(e.a)(this,this.TKk,
"onRefreshAllPersistentStateRequest"));this.pl.Wki(Object(e.a)(this,this.bba,"sendUpdateNotification"));this.pl.Dii(Object(e.a)(this,this.FIk,"onInternalPresenceUpdated"));this.pl.Eii(Object(e.a)(this,this.GIk,"onInternalUpdateNotificationReceived"));this.pl.Cii(Object(e.a)(this,this.EIk,"onInternalPersistentStateUpdated"));this.pl.Bii(Object(e.a)(this,this.DIk,"onInternalPersistentStateCleared"));this.pl.Vki(Object(e.a)(this,this.Q_e,"sendPersistentState"));this.pl.Nli(Object(e.a)(this,this.Dnb,
"updateClientInfo"));this.ki=zc;this.Cr=xb;this.Vt=jb;this.zN=zb;this.$Wb=Tb;this.LNa=Object(O.a)(String,z.AFrameworkApplication.Md.Application)||""}VKk(Na,sa){this.cA=this.$7h(sa.hubConnection);this.LZb.reset();this.cA.N8k(Object(e.a)(this,this.Bnc,"onPresenceUpdated"));this.cA.K8k(Object(e.a)(this,this.zkd,"onPersistentStateUpdated"));this.cA.J8k(Object(e.a)(this,this.pOe,"onPersistentStateCleared"));this.cA.p9k(Object(e.a)(this,this.Ync,"onUpdateNotificationReceived"))}joa(Na,sa){this.Oya=sa.newState;
2===sa.newState&&this.nml()}nml(){for(let Na of this.iNd)this.bba(null,new ka.a(Na.key,Na.value,!1,new r.a));this.iNd=new U.a}TKk(Na,sa){sa.g_d();for(Na=0;3>Na;++Na)this.Yll(Na,sa)}Yll(Na,sa){try{this.cA.vae(Na).done(Sa=>{sa.QRb(sa.B0d,"GetCompletePresenceSuccess")&&(sa.xJi.IMk(),h.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}] of type [{1}]",this.Cr,Na),this.pl.w2k(),this.lKk(Na,Sa),this.pl.y1k(Sa),sa.R_f.Gb(Na)&&this.pl.hnh(Na,sa.R_f.ga(Na),new r.a))}).fail(Sa=>
{const {RtcUtils:xb}=d(194);sa.QRb(sa.B0d,"GetCompletePresenceFail")&&(h.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}] of type [{2}]",xb.VIb(Sa),this.Cr,Na),this.pl.gpd())}).always(()=>{sa.Zy&&sa.Zy.stop()})}catch(Sa){h.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",sa.B0d,Sa.message)}}Q_e(Na,sa){var {RtcUtils:Sa}=
d(194);Na=sa.presence;let xb;const gc=sa.IMa;this.zN.uH(1,0);try{xb=Sa.MZd(Na,this.$Wb)}catch(Xb){this.zN.uH(1,3);h.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Xb.message);gc.setException(Xb);return}Sa=new n.a;Sa.$(this._clientId,Object.assign(new N,{Presence:Na,TimeStamp:(new Date).getTime()}));this.pl.Dnh(sa.type,Sa);if(2!==this.Oya)this.Vt.Wjb(),this.zN.uH(1,2),gc.Ng(null);else{var zc=this.pBa.toString();++this.pBa;Na=new Y(()=>
this.pml(sa.type,xb,zc),zc);Na=this.eLh(0,sa.type).add(Na);Na.hkd(Xb=>{2===Xb&&this.zN.uH(1,6);gc.Ng(null)});Na.gkd(()=>{})}}pml(Na,sa,Sa){let xb=null;const gc=new H,zc=new fa.a;h.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}] of type [{1}]",this.Cr,Na);if(2!==this.Oya)return this.Vt.Wjb(),this.zN.uH(1,2),h.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}] of type [{1}]",this.Cr,Na),zc.MJe(),zc;this.ki&&20>this.hqf&&(xb=this.ki.Ii("WebServiceCall",
"Send Presence Message"),this.hqf++);gc.start();zc.Hlc(1);try{this.cA.updatePersistentState(Na,sa).done(()=>{this.Vt.LVe();this.zN.uH(1,1);h.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}] of type [{2}]",Sa,this.Cr,Na);zc.SZa(1);gc&&(gc.stop(),gc.er>this.Yc.nvh?this.zN.uH(1,4):this.zN.uH(1,5))}).fail(Xb=>{const {RtcUtils:jb}=d(194);this.Z9a||(this.Vt.Wjb(),this.zN.uH(1,3),h.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",
Sa,jb.VIb(Xb),this.Cr));zc.SZa(2)}).always(()=>{xb&&xb.stop()})}catch(Xb){h.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",Xb.message),this.zN.uH(1,3),zc.SZa(2)}return zc}Dnb(Na,sa){({RtcUtils:Na}=d(194));const Sa=sa.JEi,xb=sa.IMa;let gc;try{gc=Na.MZd(Sa,this.$Wb)}catch(zc){h.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",zc.message);xb.setException(zc);return}try{this.cA.Dnb(gc).done(()=>
{h.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(zc=>{const {RtcUtils:Xb}=d(194);this.Z9a||h.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",Xb.VIb(zc));xb.Ng(null)})}catch(zc){h.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",zc.message),xb.Ng(null)}}bba(Na,sa){({RtcUtils:Na}=d(194));const Sa=sa.type,xb=sa.iAa,gc=sa.RVi,zc=sa.IMa;let Xb;this.zN.uH(0,0);try{Xb=Na.MZd(xb,this.$Wb)}catch(zb){this.zN.uH(0,
3);h.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",zb.message);zc.setException(zb);return}if(2!==this.Oya)gc?this.iNd.$(Sa,xb):(this.Vt.Wjb(),this.zN.uH(0,2)),zc.Ng(null);else{var jb=this.pBa.toString();++this.pBa;sa=new Y(()=>this.Nml(Sa,Xb,jb),jb);sa=this.eLh(1,Sa).add(sa);sa.hkd(zb=>{2===zb&&this.zN.uH(0,6);zc.Ng(null)});sa.gkd(()=>{})}}Nml(Na,sa,Sa){let xb=null;const gc=new H,zc=new fa.a;h.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}] of type [{1}]",
this.Cr,Na);if(2!==this.Oya)return this.Vt.Wjb(),this.zN.uH(0,2),h.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Cr),zc.MJe(),zc;this.ki&&3===Na&&20>this.iqf&&(xb=this.ki.Ii("WebServiceCall","Send WetContent Update"),this.iqf++);gc.start();zc.Hlc(1);this.cA.bba(Na,sa).done(()=>{this.Vt.LVe();this.zN.uH(0,1);h.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}] of type [{2}]",Sa,this.Cr,Na);zc.SZa(1);
gc&&(gc.stop(),gc.er>this.Yc.nvh?this.zN.uH(0,4):this.zN.uH(0,5))}).fail(Xb=>{const {RtcUtils:jb}=d(194);this.Z9a||(this.Vt.Wjb(),this.zN.uH(0,3),h.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Sa,jb.VIb(Xb),this.Cr));zc.SZa(2)}).always(()=>{xb&&xb.stop()});return zc}hAa(){this.cA.aRl(Object(e.a)(this,this.Bnc,"onPresenceUpdated"));this.cA.$Ql(Object(e.a)(this,this.zkd,"onPersistentStateUpdated"));this.cA.ZQl(Object(e.a)(this,this.pOe,
"onPersistentStateCleared"));this.cA.fRl(Object(e.a)(this,this.Ync,"onUpdateNotificationReceived"))}FIk(Na,sa){this.Bnc(sa.DRb,sa.$Vf)}Bnc(Na){this.Vt.hrc();this.zkd(0,Na)}EIk(Na,sa){this.zkd(sa.type,sa.DRb)}lKk(Na,sa){const Sa={};for(let xb in sa)Sa[xb]=sa[xb].Presence;this.Bch(Na,Sa,sa)}zkd(Na,sa){this.Vt.hrc();this.Bch(Na,sa)}Bch(Na,sa,Sa=null){var {RtcUtils:xb}=d(194);if(h.ULS.nza(500,100))for(var gc in sa);delete sa[this._clientId];if(!da.a.isEmpty(sa)){for(var zc in sa)gc=zc,sa[gc]=xb.deserialize(sa[zc],
"Presence",gc,!1,this.$Wb);xb=new n.a;zc=(new Date).getTime();for(let Xb in sa){gc=sa[Xb];let jb=Xb,zb;Sa?(zb=Sa[jb],zb.Presence=gc):zb=Object.assign(new N,{Presence:gc,TimeStamp:zc});xb.$(jb,zb)}this.pl.Dnh(Na,xb);switch(Na){case 0:this.Bof||(h.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Cr),this.Bof=!0,z.AFrameworkApplication.Rg&&z.AFrameworkApplication.Rg.fyk());this.pl.Wmh(sa,[]);break;case 2:this.Aof||(h.ULS.sendTraceTag(508867081,500,50,"Raising first live meeting update notification for [{0}]",
this.Cr),this.Aof=!0);this.pl.Smh(Na,sa);break;default:this.pl.Smh(Na,sa)}}}DIk(Na,sa){this.pOe(sa.A_d)}pOe(Na){this.Vt.hrc();if(h.ULS.nza(500,100))for(let sa=0;sa<Na.length;++sa);Na.length&&(this.pl.A3k(Na),this.pl.h2k(Na),this.pl.Wmh({},Na))}GIk(Na,sa){this.Ync(sa.type,sa.iAa)}Ync(Na,sa=null){this.Yc.xxl&&0===Na&&h.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Na&&this.MMd&&0<this.MMd.length){var Sa=Object.assign(new Ma.a,{topLevelKpiName:"ContentUpdateNotificationReceived",
featureName:"RtcNotification",crewAlias:this.MMd,vetoPillar:"RealTimeCoauth"});(Sa=ca.a.getInstance(Sa))&&Sa.logKpiUsage(this.g4h)}this.Yc.yxl&&13===Na&&h.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",sa||"<none>"));this.Vt.hrc();5===Na?(sa=(Na=this.iRk(sa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Na.reason,Na.reconnectDelay):"Received client reconnection request from the server without params.",
h.ULS.sendTraceTag(18637071,500,50,sa),this.pl.gpd(Na)):(sa=d(194).RtcUtils.deserialize(sa,String.format("UpdateNotification-{0}",ha[Na]),null,!1,this.$Wb),this.pl.z3k(Na,sa))}iRk(Na){try{if(!Na||""===Na)return null;const sa=JSON.parse(Na);return new aa(sa[ra.a.tZe],sa[ra.a.$hl],sa[ra.a.dil],sa[ra.a.G_e])}catch(sa){return h.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",sa.message),null}}eLh(Na,sa){return this.LZb.Nyj(this.Oyj(Na,sa))}Oyj(Na,sa){return Na+","+sa}static Pgj(){var Na=
new Map;Na.set("SkipAria","True");Na=Object.assign(new Ga.a,{extendedProperties:Na});return Object.assign(new na.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Na,blockFutureEmissionDurationInMs:3E5})}}Object(K.a)(wa,"RtcMessageHandler",T,[]);class Fa{yRf(Na,sa=""){const {MaxOutstandingThrottler:Sa}=d(1018);return Sa.createInstance(Na,sa)}xPi(Na,sa=""){const {MaxRateThrottler:Sa}=d(1020);return Sa.createInstance(Na,sa)}}Object(K.a)(Fa,"ThrottlerFactory",null,[1196]);var pa=
d(78),Ea=d(715);class ta{constructor(Na){this.Yc=null;this.ZP=!1;this.Oa=new pa.a;this.bLd=new n.a;this.$Kd=new n.a;this.rRd=Na;this.Opb=this.rRd.yRf(sa=>sa.send(),"GlobalMaxOustandingThrottler");this.Opb.dKc(()=>{this.Oa.raiseEvent("TMUDM")})}init(Na){this.ZP||(this.Yc=Na,this.Opb.init(this.Yc.TMa,this.Yc.MBj),this.ZP=!0)}Nyj(Na){var {MaxRateThrottler:sa}=d(1020),{MaxOutstandingThrottler:Sa}=d(1018);this.ZP||this.init(new Ea.a(sa.CTf,Sa.TTf,Sa.ITf,ta.nzk));({value:sa}=this.bLd.vg(Na)).returnValue||
(({value:sa}=this.$Kd.vg(Na)).returnValue||(sa="MaxOutstandingThrottler-"+Na,sa=this.rRd.yRf(Object(e.a)(this.Opb,this.Opb.add,"add"),sa),sa.init(this.Yc.TMa,this.Yc.mzk),sa.dKc(()=>{this.Oa.raiseEvent("TMUDM")}),this.$Kd.add(Na,sa)),Sa="MaxRateThrottler-"+Na,sa=this.rRd.xPi(Object(e.a)(sa,sa.add,"add"),Sa),sa.init(this.Yc.hAk),this.bLd.add(Na,sa));return sa}reset(){for(let Na of this.bLd)Na.value.NVe();for(let Na of this.$Kd)Na.value.NVe(),Na.value.reset();this.Opb.NVe();this.Opb.reset()}dKc(Na){this.Oa.addHandler("TMUDM",
Na)}}ta.nzk=1E3;Object(K.a)(ta,"ThrottlerManager",null,[1195]);var ia=d(1182);const Ja=(Na,sa,Sa,xb,gc,zc,Xb,jb,zb=null,Tb=null,Ya=null,sb=null)=>{const oc=Q.createInstance(z.AFrameworkApplication.fa),wb=z.AFrameworkApplication.buildVersion?z.AFrameworkApplication.buildVersion:"1.0",rc=ab(Na,sa,Xb,wb),Ka=oc.KEi?d(1180).RealtimeChannelMetrics.createInstance(rc):new J;var Db=d(309).FrequentLoggingMetrics.create(gc);oc.gil&&Db.AFl(oc.fil);var bc="";bc=zb&&""!==zb?zb:"/rtc2/";Db.r2f=x.a.jA(bc);const Mc=
bc+"signalr";zb=bc+"findsession";const mb=L.sNj;bc=new Fa;Ya=Ya||C.a.getInstance();h.ULS.shipAssertTag(556867617,500,oc.qvh<=d(347).RealtimeChannel.I5g,"Client attempting to override max payload size beyond absolute limit");const Wa=Math.min(oc.qvh,d(347).RealtimeChannel.I5g);Db.H5g=Wa;Db=new wa(oc,new ta(bc),Na,rc,db=>new M(db.createHubProxy(mb)),jb,Ya,Ka,Db,Wa);Tb||(Tb=d(720).FindSessionStrategy.createInstance(sa,gc,zb,jb,wb,Xb,Na,rc,Ya,zc,xb,sb));Tb.G6b=oc.G6b;sa=new w(rc);Sa=Sa?Sa.split(","):
null;Na=new (d(347).RealtimeChannel)(Na,Sa,rc,jb,()=>$.hubConnection(Mc),Tb,Db,sa,Ya,Ka,oc,gc);Na.init();return Na},ab=(Na,sa,Sa)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Na,Oa(ia.a[Sa]),Oa("browser"),sa),Oa=Na=>Na?Na.charAt(0).toLocaleUpperCase()+Na.substring(1,Na.length):Na;d.d(S,"RealtimeChannel",function(){return Za});class Za{constructor(Na,sa,Sa,xb,gc,zc,Xb,jb,zb,Tb,Ya,sb){this.rQd=!1;this.PZ=null;this.NS=new n.a;this.vTb=1;this.Q2=null;this.NK=!1;this.XJd=(new Date(0)).getTime();
this.kvf=0;this._clientId=Na;this.fIc=sa;this.QZ=0;this.ki=xb;this.XDd=jb;this.i9h=Xb;this.aWh=zb;this.OYh=gc;this.PNa=zc;this.Cr=Sa;this.Vt=Tb;this.Yc=Ya;this.ji=sb;this.A$h=1>100*Math.random()}get Tna(){return this.PNa.Tna}set Tna(Na){this.PNa.Tna=Na}get Z0a(){return this.i9h}get pl(){return this.aWh}init(){this.pl.Jki(Object(e.a)(this,this.UQc,"disconnectAndCreateNewConnection"));this.pl.Pli(Object(e.a)(this,this.nNk,"onUpdatePersistentStateRequestReceivedInternal"));this.pl.Oli(Object(e.a)(this,
this.mNk,"onUpdatePersistentStateClearedRequestReceived"));this.ji.uJc(this.Vt);z.AFrameworkApplication.$ga(()=>{const {FrequentLoggingMetrics:Na}=d(309);this.Vt.OVe();Na.instance&&Na.instance.Wte()});this.FRf();this.SXi();this.pl.CBf(Object(e.a)(this,this.qSl,"updateConnectionQueryString"))}SXi(){try{const Sa=$.signalR;if(!Sa)throw Error.invalidOperation("Failed to retrieve Signalr object");const xb=Sa.version;if(!xb)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===
xb){var Na=Sa.transports;if(!Na)throw Error.invalidOperation("Failed to retrieve transports object");var sa=Na.longPolling;if(!sa)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!sa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");sa.supportsKeepAlive=this.GRi()}}catch(Sa){h.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",Sa.message)}}GRi(){return()=>!1}FRf(){const Na=++this.vTb;
this.XJd=(new Date(0)).getTime();this.Q2=this.OYh();this.pl.r2k(this.Q2);this.Q2.stateChanged(sa=>{this.hGk(sa,Na)});this.Q2.connectionSlow(Object(e.a)(this,this.AMk,"onSlowConnection"));this.Q2.error(Object(e.a)(this,this.lMk,"onSignalRError"));this.Q2.log=Object(e.a)(this,this.mMk,"onSignalRLog")}QRb(Na,sa){return Na!==this.vTb?(h.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",sa),!1):!0}connect(){2!==this.QZ&&1!==this.QZ&&(h.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",
this.Cr),this.XDd.dGk(),B.a.instance.BFl(),this.joa(1,this.QZ),this.jHh())}jHh(){const Na=this.vTb;this.rQd=!1;this.Vt.wpd();this.PNa.Vde(Object(e.a)(this,this.wJi,"connectSignalrConnection"),Object(e.a)(this,this.Kah,"onFailureToConnect"),Object(e.a)(this.Z0a,this.Z0a.YQj,"initThrottlerManager"),Object(e.a)(this,this.QRb,"verifyConnectionToken"),Na)}Kah(Na=null){this.Vt.xpd();let sa=null;!Na||"documentsessiondeleted"!==(sa=Na.toLowerCase())&&"documentsessionexpired"!==sa?this.UQc():(h.ULS.sendTraceTag(41788292,
500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Cr,Na),this.disconnect())}UQc(Na,sa=null){h.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.PZ);Na=(Na=2===this.QZ||1===this.QZ)&&!this.Z0a.Z9a;let Sa=!0,xb=0;sa&&Object.getType(sa)!==Object.getType(Sys.EventArgs.Empty)&&sa.YXe&&""!==sa.YXe&&(Na=!0,this.PNa.s1e(sa.YXe),Sa=sa.G_e,xb=sa.reconnectDelay);Na&&this.joa(1,this.QZ);++this.vTb;this.Z0a.hAa();
this.oGl(Sa);this.PNa.n5d();this.FRf();Na&&window.setTimeout(Object(e.a)(this,this.jHh,"startConnecting"),Math.min(xb,3E4))}qSl(){let Na=null;const sa=({correlationId:Na}=this.PNa.lWc()).returnValue;this.Q2.qs=sa;h.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Cr,Na)}wJi(Na){const {FrequentLoggingMetrics:sa}=d(309);this.XJd=(new Date).getTime();let Sa=null;this.Q2.qs=({correlationId:Sa}=this.PNa.lWc()).returnValue;this.Yc.wni&&(this.Q2.url=
Na,sa.instance&&(sa.instance.GOf=x.a.jA(Na)));let xb=null;this.ki&&(xb=this.ki.Ii("WebServiceCall","ConnectToServer"));h.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Cr);Na={};this.fIc&&(Na.transport=1===this.fIc.length?this.fIc[0]:this.fIc);Na.pingInterval=null;B.a.instance.grc(1,0);Na.waitForPageLoad=!1;this.Q2.start(Na,null).done(gc=>{this.Vt.EVe();B.a.instance.grc(1,1,!0);h.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",
gc.id,Sa)}).fail(gc=>{h.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.PNa.wB,Sa,this.Cr);this.Kah();this.Vt.hoh(gc);B.a.instance.grc(1,1,!1);this.pl.enh(0,{["CorrelationId"]:Sa,["ErrorDetails"]:gc,["ConnectionState"]:m.a[this.QZ]})}).always(()=>{const {FrequentLoggingMetrics:gc}=d(309);xb&&xb.stop();gc.instance&&(gc.instance.NFd=!1)})}disconnect(){const {FrequentLoggingMetrics:Na}=d(309);0===this.QZ?h.ULS.sendTraceTag(36545632,
500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Cr):(this.Vt.moh(),Na.instance&&(Na.instance.NFd=!0),h.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Cr),this.Z0a.Z9a=!0,this.XDd.OGk(),this.joa(0,this.QZ),this.UQc(),this.Z0a.Z9a=!1)}oGl(Na){const sa=this.kzi(),Sa=this.Q2,xb=this.PZ,gc=()=>{if(this.rQd)h.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.rQd=!0,Sa.stop(!0,
Na)}catch(zc){h.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",zc.message)}};0<sa?(h.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",xb,sa),window.setTimeout(gc,sa)):(h.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",xb),gc())}kzi(){let Na=0;0===this.Q2.state&&(Na=this.XJd+Za.VYl-(new Date).getTime(),0>Na&&(Na=0));return Na}get connectionState(){return this.QZ}A7a(Na){this.pl.A7a(Na)}R_e(Na){return this.Q_e(0,Na)}Q_e(Na,sa){const Sa=
new r.a;this.pl.hnh(Na,sa,Sa);return Sa.task}ZJc(Na){this.pl.ZJc(Na)}oua(Na){return this.Yzj(Na)}SUc(){return this.qdj()}qdj(){const Na={};for(let sa of this.NS)sa.value.Gb(0)&&(Na[sa.key]=sa.value.ga(0).data);return Na}Yzj(Na){return this.NS.Gb(Na)&&this.NS.ga(Na).Gb(0)?this.NS.ga(Na).ga(0).data:null}nNk(Na,sa){for(let Sa of sa.cWl)this.NS.Gb(Sa.key)||this.NS.$(Sa.key,new U.a),Na=Sa.value,this.NS.ga(Sa.key).$(sa.type,new D(Na.Presence,new Date(Na.TimeStamp))),Sa.key===this._clientId&&0===sa.type&&
this.pl.Q1k(Na.Presence)}mNk(Na,sa){for(const Sa of sa.A_d)this.NS.remove(Sa)}pdj(){const Na=new U.a;if(!this.NS.Gb(this._clientId))return Na;for(let sa of this.NS.ga(this._clientId))Na.$(sa.key,sa.value.data);return Na}bba(Na,sa=null,Sa=!1){const xb=new r.a;this.pl.gVe(Na,sa,Sa,xb);return xb.task}ECa(Na){this.pl.ECa(Na)}npj(){return this.u4(this._clientId)}u4(Na){let sa,Sa;return({value:sa}=this.NS.vg(Na)).returnValue&&({value:Sa}=sa.vg(0)).returnValue?new t(this.bAj(Sa),Sa.timeStamp):null}zdj(){const Na=
{};for(let sa of this.NS)sa.value.vg(0).returnValue&&(Na[sa.key]=this.u4(sa.key));return Na}Dnb(Na){const sa=new r.a;this.pl.y3k(Na,sa);return sa.task}get clientId(){return this._clientId}get ACl(){return this.A$h}dispose(){const {FrequentLoggingMetrics:Na}=d(309);this.NK||(this.Z0a.hAa(),this.ji.Ypd(this.Vt),this.Vt.OVe(),Na.instance&&Na.instance.Wte(),this.NK=!0)}hGk(Na,sa){this.QRb(sa,"StateChangedSignalR")&&this.joa(this.DPf(Na.newState),this.DPf(Na.oldState))}joa(Na,sa){var {FrequentLoggingMetrics:Sa}=
d(309),{ClientToClientMessageTelemetry:xb}=d(1069);if((1!==this.QZ||0!==sa||1!==Na)&&this.QZ!==sa){const gc=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.QZ,sa,Na]));h.ULS.sendTraceTag(3290053,500,10,gc)}if(this.QZ!==Na){switch(Na){case 2:Sa.instance&&Sa.instance.jyk();this.PZ=this.Q2.id;h.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.PZ,this.Cr);this.lhk(this.Q2);
h.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Sa=null;this.ki&&(Sa=this.ki.Ii("WebServiceCall","Receive First Presence"));xb=this.vTb;this.pl.q2k(Object(e.a)(this,this.QRb,"verifyConnectionToken"),xb,this.XDd,Object(e.a)(this,this.g_d,"clearExistingPersistentState"),this.pdj(),Sa);this.Yc.ail&&(Sa=100*Math.random()<=this.Yc.bil,d(1069).ClientToClientMessageTelemetry.rqj(this.pl,this.Yc,Sa).start());break;case 1:2===sa&&h.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",
this.PZ);break;case 0:if(xb.instance&&xb.instance.stop(),this.Z0a.Z9a)h.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.PZ);else{1===sa&&(h.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.PZ),this.Vt.frc());2===sa&&h.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.PZ);this.UQc();return}}this.QZ=Na;this.pl.$0k(Na,sa)}}lhk(Na){if(Na&&Na.transport&&Na.transport.name){Na=Na.transport.name;var sa=Na.toLowerCase();"websockets"===sa?h.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Na,this.Cr):"serversentevents"===sa?h.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",Na,this.Cr):"foreverframe"===sa?h.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Na,this.Cr):"longpolling"===sa?h.ULS.sendTraceTag(4290754,500,
50,"Transport name - {0} for [{1}]",Na,this.Cr):"mocktransport"!==sa&&h.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Na)}else h.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}AMk(){if(this.Yc.pvh){const Na=x.a.cO(this.Tna,"mid");h.ULS.sendTraceTag(3249544,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.PZ,Na)}else h.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.PZ)}lMk(){h.ULS.sendTraceTag(3249545,
600,15,"SignalR ERROR for connection [{0}];",this.PZ)}mMk(Na){Na=d(194).RtcUtils.VIb(Na);if(this.Yc.pvh&&Na.startsWith("Keep alive timed out.")){const sa=x.a.cO(this.Tna,"mid");h.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",Na,sa)}else this.ACl&&2E3>this.kvf&&!Na.startsWith("Invok")&&!Na.startsWith("Trigger")&&(h.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Na),this.kvf++)}g_d(){let Na;const sa=[];({value:Na}=this.NS.vg(this._clientId)).returnValue&&this.NS.remove(this._clientId);
for(let Sa of this.NS.keys)Array.add(sa,Sa);for(const Sa of sa)this.NS.remove(Sa);Na&&this.NS.$(this._clientId,Na);this.pl.H1k(sa)}DPf(Na){switch(Na){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Na,"Unknown SignalR state");}}bAj(Na){return Na&&Na.timeStamp?(new Date).getTime()-Na.timeStamp.getTime()>(this.Yc.lXd?6E4:this.Yc.awayCoauthorThresholdMs)?2:1:1}static createInstance(Na,sa,Sa,xb,gc,zc,Xb,jb=null,zb=null,Tb=null,Ya=null,sb=
null,oc=null){return Ja(Na,sa,Sa,oc,xb,gc,zc,Xb,jb,zb,Tb,sb,Ya)}}Za.I5g=31E3;Za.WJe=8E3;Za.VYl=15E3;Object(K.a)(Za,"RealtimeChannel",null,[1058,1057])},714:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.Ovf=!1;this.DNd=null;this.Bff=0;this.$Fd=this.xSf();this.Vzc=this.xSf();this.Y3a=this.Lpb=0;this.TF=()=>new Date}get fHl(){return this.Ovf}xSf(){const e=Array(6);for(let r=0;r<e.length;r++)e[r]=0;return e}Bkj(){return this.$Fd.toString()}Cgj(){return this.Vzc.toString()}BFl(){this.DNd=
this.TF()}grc(e,r,m=!1){this.fHl||(m&&(this.Ovf=!0),m=this.TF(),0===e&&5<this.Lpb||1===e&&5<this.Y3a||(this.Bff<e?(1===this.Lpb%2&&(this.$Fd[this.Lpb]=-1,this.Lpb++),this.Bff=e,1===r&&(this.Vzc[this.Y3a]=-1,this.Y3a++),this.Vzc[this.Y3a]=this.M5e(m),this.Y3a++):0===e?(this.$Fd[this.Lpb]=this.M5e(m),this.Lpb++):(this.Vzc[this.Y3a]=this.M5e(m),this.Y3a++)))}M5e(e){const r=e.getTime()-this.DNd.getTime();this.DNd=e;return r}static get instance(){h.La||(h.La=new h);return h.La}static set instance(e){h.La=
e}}h.La=null;Object(K.a)(h,"LatencyMetrics",null,[])},715:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r,m,n){this.hAk=e;this.TMa=r;this.mzk=m;this.MBj=n}}Object(K.a)(h,"ThrottlerManagerSettings",null,[])},718:function(K,S,d){K=d(0);class h extends Sys.EventArgs{constructor(U,T){super();this.newState=U;this.oldState=T}}Object(K.a)(h,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(U,T){super();this.JEi=U;this.IMa=T}}Object(K.a)(e,
"ClientInfoEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(U){super();this.presence=U}}Object(K.a)(r,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class m extends Sys.EventArgs{constructor(U){super();this.A_d=U}}Object(K.a)(m,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);class n extends Sys.EventArgs{constructor(U,T){super();this.type=U;this.DRb=T}}Object(K.a)(n,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var z=d(1181);class t extends Sys.EventArgs{constructor(U,
T=null){super();this.ZG=U;this.Rbi=T}get type(){return this.ZG}get iAa(){return this.Rbi}}Object(K.a)(t,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class x extends Sys.EventArgs{constructor(U){super();this.oXk=U}}Object(K.a)(x,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);class B extends Sys.EventArgs{constructor(U,T,ca,N,da,Y){super();this.QRb=U;this.B0d=T;this.xJi=ca;this.R_f=da;this.g_d=N;this.Zy=Y}}Object(K.a)(B,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);
class D extends Sys.EventArgs{constructor(U){super();this.hubConnection=U}}Object(K.a)(D,"RefreshProxyEventArgs",Sys.EventArgs,[]);class w extends Sys.EventArgs{constructor(U,T){super();this.f6i=U;this.errorMessage=T}}Object(K.a)(w,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class J extends Sys.EventArgs{constructor(U,T,ca){super();this.type=U;this.presence=T;this.IMa=ca}}Object(K.a)(J,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var F=d(1021);class L extends Sys.EventArgs{constructor(){super()}}
Object(K.a)(L,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class M extends Sys.EventArgs{constructor(U){super();this.A_d=U}}Object(K.a)(M,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class Q extends Sys.EventArgs{constructor(U,T){super();this.type=U;this.cWl=T}}Object(K.a)(Q,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var C=d(78);d.d(S,"a",function(){return O});class O{constructor(){this.Oa=new C.a}$0k(U,T){this.Oa.raiseEvent("CSC",new h(U,T))}r2k(U){this.Oa.raiseEvent("RP",
new D(U))}gpd(U){this.Oa.raiseEvent("RC",U)}w2k(){this.Oa.raiseEvent("RMID")}q2k(U,T,ca,N,da,Y){this.Oa.raiseEvent("RPS",new B(U,T,ca,N,da,Y))}Dnh(U,T){this.Oa.raiseEvent("UPSR",new Q(U,T))}Wmh(U,T){this.Oa.raiseEvent("PU",new z.a(U,T))}Q1k(U){this.Oa.raiseEvent("MPU",new r(U))}gVe(U,T,ca,N){this.Oa.raiseEvent("SUN",new F.a(U,T,ca,N))}z3k(U,T){this.Oa.raiseEvent("UNR",new t(U,T))}hnh(U,T,ca){this.Oa.raiseEvent("SP",new J(U,T,ca))}Smh(U,T){this.Oa.raiseEvent("PSU",new n(U,T))}h2k(U){this.Oa.raiseEvent("PSC",
new m(U))}H1k(U){this.Oa.raiseEvent("IPSC",new m(U))}A3k(U){this.Oa.raiseEvent("UPSC",new M(U))}F2k(U,T){this.Oa.raiseEvent("SPC",new L(U,T))}enh(U,T){this.Oa.raiseEvent("RCF",new w(U,T))}y1k(U){this.Oa.raiseEvent("CPSWM",new x(U))}y3k(U,T){this.Oa.raiseEvent("UCI",new e(U,T))}A7a(U){this.Oa.addHandler("CSC",U)}Kki(U){this.Oa.addHandler("RP",U)}Jki(U){this.Oa.addHandler("RC",U)}Pki(U){this.Oa.addHandler("RMID",U)}Iki(U){this.Oa.addHandler("RPS",U)}Pli(U){this.Oa.addHandler("UPSR",U)}ZJc(U){this.Oa.addHandler("PU",
U)}Dii(U){this.Oa.addHandler("IPU",U)}Nli(U){this.Oa.addHandler("UCI",U)}Wki(U){this.Oa.addHandler("SUN",U)}Eii(U){this.Oa.addHandler("IUNR",U)}ECa(U){this.Oa.addHandler("UNR",U)}Cii(U){this.Oa.addHandler("IPSU",U)}Bii(U){this.Oa.addHandler("IPSC",U)}Oli(U){this.Oa.addHandler("UPSC",U)}Vki(U){this.Oa.addHandler("SP",U)}CBf(U){this.Oa.addHandler("SPC",U)}Tki(U){this.Oa.addHandler("RCF",U)}wii(U){this.Oa.addHandler("CPSWM",U)}Yal(U){this.Oa.removeHandler("CPSWM",U)}static getInstance(){return O.La||
(O.La=new O)}}O.La=null;Object(K.a)(O,"RtcEventHub",null,[1106])},720:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=d(7),r=d(18),m=d(1017),n=d(1023),z=d(27),t=d(77),x=d(65),B=d(457),D=d(505),w=d(106),J=d(47),F=d(103),L=d(1024);class M{}M.clientId="ClientId";M.GWl="UserApp";M.userSessionId="usid";M.userType="UserType";M.TWl="UserVersion";M.Lqc="qs";M.MEi="clientProtocol";M.nCk="NoAuth";Object(K.a)(M,"RtcFindSessionInputQueryParamConstants",null,[]);class Q{constructor(aa,ka,H,ra,ha,Ma){this.b6a=null;
const {FindSessionStrategy:Ga}=d(720);this.d8h=aa;aa=String.format("{0}={1}",M.clientId,J.a.Ne(ra));aa=String.format("{0}&{1}={2}",aa,M.userSessionId,J.a.Ne(ha));aa=String.format("{0}&{1}={2}",aa,M.GWl,J.a.Ne(H.toString()));aa=String.format("{0}&{1}={2}",aa,M.userType,J.a.Ne("1"));aa=String.format("{0}&{1}={2}",aa,M.TWl,J.a.Ne(ka));aa=String.format("{0}&{1}={2}",aa,M.MEi,J.a.Ne(Ga.LEi));(ka=Q.aej(H,Ma))&&(aa=String.format("{0}&{1}",aa,ka));this.QYh=aa}Voh(){this.b6a=this.d8h()}LUc(){this.b6a&&""!==
this.b6a||(this.Voh(),h.ULS.sendTraceTag(575784194,500,this.b6a&&""!==this.b6a?50:15,"Query signature delegate called for refresh returned: {0} ",this.b6a));const aa=String.format("{0}={1}",M.Lqc,J.a.Ne(this.b6a));return String.format("{0}&{1}",aa,this.QYh)}static aej(aa,ka){return 4===aa?String.format("{0}={1}",M.nCk,"1"):ka?ka.fAj():null}}Object(K.a)(Q,"FindSessionQueryStringGenerator",null,[]);var C=d(309),O=d(714),U=d(194),T=d(715);class ca{}ca.x8i="FSType";Object(K.a)(ca,"RtcFindSessionRequestHeaders",
null,[]);class N{}N.u4k="polling";Object(K.a)(N,"RtcFindSessionTypes",null,[]);var da=d(1022);class Y{}Y.QXl="RTC-TokenProofkey";Y.g$j="RTC-IsWacJsBootFsRequest";Object(K.a)(Y,"RtcRequestHeaders",null,[]);d.d(S,"FindSessionStrategy",function(){return fa});class fa{constructor(aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa,Ea,ta=null){this.wnf=(new Date(0)).getTime();this.Lof=0;this.bEc=!1;this.Euf=null;this.YVe=36E5;this.bpb=fa.Llg;this.zUb=0;this.Ekb=null;this.Oya=0;this.bNb=this.HOf=null;this.L8h=[n.a.JBb,n.a.errorMessage,
n.a.C4e,n.a.wB,n.a.z6,n.a.Yfe,n.a.Phb,n.a.TMa,n.a.Rhb];this.K8h=[n.a.JBb,n.a.errorMessage];this.wB=this.Tna=null;this.mif=new Q(pa?pa:()=>z.AFrameworkApplication.Pg,ha,Ma,Ga,aa,ka);this.cTb=Ea;this.ki=ra;this.ji=ka;this.s0h=H;this.Cr=na;this.pl=wa;this.KUb=ta;this.nif=!1;this.G6b=9E4;Fa&&Fa.execute(ia=>{ia.WJc(()=>{h.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.Cr);this.mif.Voh()})});2>=100*Math.random()&&(this.YVe=3E5);C.FrequentLoggingMetrics.instance&&
(C.FrequentLoggingMetrics.instance.N4f=this.YVe)}s1e(aa){this.bNb=aa}init(){this.pl.Pki(Object(e.a)(this,this.Efl,"resetGetMachineIdDelay"));this.pl.A7a(Object(e.a)(this,this.joa,"onConnectionStateChanged"))}joa(aa,ka){this.Oya=ka.newState;2===ka.newState&&(this.zUb=0)}lWc(){let aa;aa=this.Ekb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Ekb.z6,fa.u1d,J.a.Ne(aa)),correlationId:aa}}Vde(aa,ka,H,ra,ha){this.Xll(()=>{ra(ha,"GetMachineIdSuccess")&&(h.ULS.sendTraceTag(17956951,500,
50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.wB,this.Cr),aa(this.Euf),H(this.Pyj()))},Ma=>{ra(ha,"GetMachineIdFailure")&&(h.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.Cr),ka(Ma))},ra,ha)}n5d(){this.rMf();this.vPj()}Xll(aa,ka,H,ra){h.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.wB);this.wB?aa():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(aa,
ka,H,ra)},this.Ryi())}sendFindSessionRequestToServerInternal(aa,ka,H,ra){H(ra,"RequestMachineId")&&(this.wnf=(new Date).getTime(),H=x.a.zj(),this.V8f(ha=>{const Ma=x.a.zj();this.Xld(ha);this.Y0e();aa();ha=x.a.zj()-Ma;h.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ha)},ha=>{const Ma=x.a.zj();this.rMf();C.FrequentLoggingMetrics.instance&&C.FrequentLoggingMetrics.instance.uH(2,3);ka(ha);ha=x.a.zj()-Ma;h.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ha)},
!1),H=x.a.zj()-H,h.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",H))}vPj(){this.bpb+=fa.loj;this.bpb=Math.min(this.bpb,fa.fzk)}Ryi(){let aa=this.wnf+this.bpb-(new Date).getTime();0>aa&&(aa=0);return aa}Xld(aa){try{this.Ekb=aa,this.Tna=aa.nOf,this.wB=aa.wB,this.HOf=aa.z6,this.Euf=aa.Y2b}catch(ka){h.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",ka.toString())}}rMf(){this.wB=null;this.sMf()}Y0e(){this.sMf();this.bEc=!0;this.Lof=
window.setTimeout(Object(e.a)(this,this.C6k,"refreshMachineId"),this.YVe)}sMf(){this.bEc&&(window.clearTimeout(this.Lof),this.bEc=!1)}C6k(){this.bEc=!1;this.V8f(aa=>{const ka=this.HOf!==aa.z6,H=this.wB!==aa.wB,ra=this.wB;this.Xld(aa);0!==this.Oya&&(H?(h.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",ra||"null",aa.wB),this.pl.gpd()):(this.pl.F2k(ka,H),this.Y0e()))},()=>{C.FrequentLoggingMetrics.instance&&C.FrequentLoggingMetrics.instance.uH(2,
3);this.Y0e()},!0)}Efl(){this.bpb=fa.Llg}Pyj(){return new T.a(this.Ekb.fhd,this.Ekb.chd,this.Ekb.bhd,this.Ekb.TYc)}PMl(aa){if(Object.getType(aa)!==Object)return null;for(let ka in aa);return this.hOi(aa)}hOi(aa){if(!(n.a.JBb in aa))return null;const ka=aa[n.a.JBb];var H=ka?this.L8h:this.K8h;for(const ra of H)if(!(ra in aa))return null;H=Object.assign(new L.a,{Bcc:aa[n.a.JBb],errorMessage:aa[n.a.errorMessage],correlationId:F.a.create().toString()});ka&&(H.Y2b=aa[n.a.C4e],H.z6=aa[n.a.z6],H.wB=aa[n.a.wB],
H.TYc=aa[n.a.Yfe],H.bhd=aa[n.a.Phb],H.chd=aa[n.a.TMa],H.fhd=aa[n.a.Rhb]);return H}Ckj(aa,ka){h.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.KUb.v8i.continueWith(()=>{this.KUb.v8i.result?(h.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),aa(this.KUb.w8i)):(h.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),ka(this.KUb.w8i))})}xth(aa,ka,H,ra,ha=!1){return Ma=>{O.a.instance.grc(0,1);aa&&
aa.stop();this.cTb=this.bNb=null;this.Hyg(Ma.data,!0,ka);var Ga=U.RtcUtils.deserialize(Ma.data.Wd,"FindSession",null);if(Ga)if(Ga=this.PMl(Ga)){if(Ga.Bcc&&Ga.z6&&Ga.wB){h.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.Cr);this.Pek(Ma.data);H(Ga);return}ka.FindSessionFailureReason="FindSessionInvalidResponse";ka.IsRtcEnabled=Ga.Bcc;ka.IsQueryStringEmpty=!Ga.z6;ka.IsConnectionStringEmpty=!Ga.wB;h.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
this.Cr,Ga.Bcc,!Ga.z6,!Ga.wB)}else ka.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",h.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Cr);else ka.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",h.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.Cr);this.fnh(ka,ha);ra(null)}}nth(aa,ka,H,ra=!1){return ha=>{O.a.instance.grc(0,1);aa&&aa.stop();this.cTb=this.bNb=
null;this.Hyg(ha.data,!1,ka);let Ma=null;var Ga="unknown";let na="unknown";ha.data&&((Ga=ha.data.Dj)&&fa.Hsc in Ga&&(Ma=Ga[fa.Hsc].toString()),Ga=D.a[ha.data.status],na=ha.data.Oe.toString());ka.FindSessionFailureReason="FindSessionRequestFailed";ka.HttpErrorCode=na;ka.HttpErrorStatus=Ga;ka[fa.Hsc]=Ma;h.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",Ga,na,this.Cr,Ma,ra);this.fnh(ka,ra);H(na)}}V8f(aa,
ka,H=!1){let ra=null;h.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Cr);const ha={};var Ma=this.mif.LUc();ha[B.a.M3]=F.a.create().toString();this.bNb&&""!==this.bNb?Ma=String.format("{0}&{1}={2}",Ma,da.a.tZe,this.bNb):this.cTb&&""!==this.cTb&&(Ma=String.format("{0}&{1}={2}",Ma,da.a.tZe,this.cTb),ha[Y.QXl]="True",ha[Y.g$j]="True");Ma=this.s0h+"?"+Ma;H&&(ha[ca.x8i]=N.u4k);const Ga={};Ga.IsNetworkOfflineBeforeSendRequest=this.ji.fGa;Ga.HasAvailableConnectionsBeforeSendRequest=
this.ji.tig;Ga.MaxConnectionsAllowed=this.ji.D5g;Ga.IsRefreshMachineId=H;this.KUb&&!this.nif?(this.Ckj(this.xth(null,Ga,aa,ka,H),this.nth(null,Ga,ka,H)),this.nif=!0):(this.ki&&(ra=this.ki.Ii("WebServiceCall","GetMachineIdFromTheServer")),C.FrequentLoggingMetrics.instance&&C.FrequentLoggingMetrics.instance.uH(2,0),0>this.ji.qW(Ma,1,null,ha,[fa.KOc,fa.Hsc,fa.Rmc,fa.rZe,fa.s7g,fa.m9g,fa.l9g],1,this.xth(ra,Ga,aa,ka,H),this.nth(ra,Ga,ka,H),null,null,!1,null,this.G6b,"3",null,!0)&&(5<this.zUb&&200>this.zUb&&
h.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.zUb),window.setTimeout(()=>{this.zUb++;ka("-1")},1E3)))}Hyg(aa,ka,H){H||(H={});H.IsNetworkOfflineAfterRequestComplete=this.ji.fGa;H.IsRequestSucceeded=ka;aa&&(H.EnqueueTime=aa.PF,H.InvokedTime=aa.Is,H.CompletedTime=aa.fu,aa.Dj&&(fa.KOc in aa.Dj&&(H.CorrelationId=aa.Dj[fa.KOc]),fa.Rmc in aa.Dj&&(H[fa.Rmc]=aa.Dj[fa.Rmc])));h.ULS.sendTraceTag(38633565,500,
ka?50:15,U.RtcUtils.VIb(H))}fnh(aa,ka){aa||(aa={});aa.ConnectionState=m.a[this.Oya];ka||this.pl.enh(1,aa)}Pek(aa){try{var ka=!1,H=!1,ra=aa.Dj,ha=t.a.jA(aa.request.get_url());if(ra&&fa.rZe in ra){const Fa=ra[fa.rZe].toString().toLocaleLowerCase();H="true"===Fa;ka="false"===Fa}ra=!1;const wa=0<=ha.toLocaleLowerCase().indexOf("collab");H&&!wa?ra=!0:ka&&wa&&(ra=!0);if(ra){ka={};ka.HostName=ha;ka.Status=D.a[aa.status];ka.HttpStatus=aa.Oe.toString();var Ma=aa.request.get_headers();for(let Fa in Ma){var Ga=
Ma[Fa];(ha=Fa)&&0<ha.length&&(H=0,Ga&&(H=Ga.toString().length),ka["r_"+ha]=H)}if(aa.Dj){const Fa=new r.a;Fa.add(fa.KOc);Fa.add(fa.Rmc);Fa.add(fa.Hsc);Fa.add(fa.m9g);Fa.add(fa.l9g);Fa.add(fa.s7g);fa.sgi(ka,aa.Dj,Fa)}fa.ngi(aa.request.get_url(),ka);var na=w.a.toJSON(ka);h.ULS.sendTraceTag(559437006,500,15,na)}}catch(wa){h.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",wa.toString())}}static createInstance(aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa,Ea=null){return fa.lPc(aa,ka,H,ra,
ha,Ma,Ga,na,wa,Fa,null,pa,Ea)}static YOi(aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa=null){return fa.lPc(aa,ka,H,ra,ha,3,Ma,Ga,na,wa,Fa,pa,null)}static lPc(aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa,Ea,ta=null){aa=aa||F.a.create().toString();aa=new fa(aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa,Ea,ta);aa.init();return aa}static sgi(aa,ka,H){for(let ra of H)ra in ka&&(aa[ra]=ka[ra])}static ngi(aa,ka){if(aa){var H=aa.indexOf("?");if(-1!==H)for(aa=aa.substr(H+1).split("&"),H=0;H<aa.length;++H){var ra=aa[H].split("=");if(2===ra.length){const ha=
ra[0];if(ha&&0<ha.length){let Ma=0;if(ra=ra[1])Ma=ra.length;ka["q_"+ha]=Ma}}}}}}fa.loj=3E3;fa.fzk=3E5;fa.LEi="1.0";fa.Llg=1E3;fa.KOc="X-CorrelationId";fa.u1d="corrid";fa.Hsc="RtcErrorCode";fa.Rmc="X-OfficeCluster";fa.rZe="X-NewEnv";fa.s7g="X-MSEdge-Ref";fa.l9g="X-OFFICEFD";fa.m9g="X-OfficeFE";Object(K.a)(fa,"FindSessionStrategy",null,[1093])},746:function(K,S,d){K=d(0);class h{constructor(){this.ief=this.UDd=!1;this.callback=null}cnc(r){this.callback=r;this.jMh()}Z4g(r){this.UDd||(this.UDd=!0,this.LYh=
r,this.jMh())}jMh(){this.UDd&&this.callback&&!this.ief&&(this.ief=!0,this.callback(this.LYh))}}Object(K.a)(h,"CompletionTask",null,[]);d.d(S,"a",function(){return e});class e{constructor(){this.mpf=new h;this.kpf=new h}hkd(r){this.mpf.cnc(r)}gkd(r){this.kpf.cnc(r)}Hlc(r){this.mpf.Z4g(r)}SZa(r){this.kpf.Z4g(r)}MJe(){this.Hlc(2);this.SZa(2)}}Object(K.a)(e,"MessageStatus",null,[1227])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.presence1.js.map