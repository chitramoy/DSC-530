'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1303:function(K,S,d){d.r(S);K=d(0);var h=d(7);class e{constructor(kb,Ib){this.TPa=null;this.SXb=kb;this.k7h=Ib}init(){this.SXb.continueWith(()=>{this.TPa=this.SXb.result;this.TPa.btb(Object(h.a)(this,this.F1,"onUsersUpdated"))})}F1(){e.UEf(this.TPa.I$a())&&(this.TPa.AXe(Object(h.a)(this,this.F1,"onUsersUpdated")),this.k7h.IsRealCoauthSession=!0)}static UEf(kb){let Ib=null;for(const eb of kb)if(eb)if(kb=eb.isAnonymous||
!eb.email?eb.clientId:eb.email.toUpperCase(),!Ib)Ib=kb;else if(Ib!==kb)return!0;return!1}}Object(K.a)(e,"CoauthTelemetry",null,[1056]);var r=d(395),m=d(1098),n=d(1253),z=d(27),t;(function(kb){kb[kb.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";kb[kb.notImplemented=1]="notImplemented";kb[kb.renderHandled=2]="renderHandled";kb[kb.renderHandledWithVeto=3]="renderHandledWithVeto"})(t||(t={}));Object(K.b)("CoauthorGalleryTelemetryEndResult",t);var x=d(97),B=d(106),D=d(3);class w{constructor(kb,
Ib,eb,Rb,pc,Wc,Ic,nd,ob){this.Frf=this.$ef=this.$K=null;this.iqa=kb;this.nHc=new m.a;this.Ma=eb;this.PDd=Ib;this.r7=Rb;this.ri=pc;this.mNd=Wc;this.OPa=Ic;this.XWh=nd;this.Fjf=this.Cjf=!1;this.XHc=0;this.Xef=1;this.P3a=ob;this.e_b=this.Ma.ka("PeoplesWellExtraButtonInfoIsEnabled");this.LNa=Object(n.a)(String,z.AFrameworkApplication.Md.Application)||""}get HHh(){return this.nHc.task}init(){D.Task.WAA.call(null,this.OPa,this.PDd,this.mNd).continueWith(()=>{this.$K=this.OPa.result;this.$ef=this.PDd.result;
this.Frf=this.mNd.result;D.Task.WAA.call(null,this.PDd.result.kDa,this.mNd.result.Hxd).continueWith(()=>{this.Xef=this.$ef.kDa.result;this.XHc=this.Frf.Hxd.result;this.$K.btb(Object(h.a)(this,this.pld,"onUsersUpdatedEventListener"));this.$K.I$a().length&&this.F1()})})}pld(){this.F1()}F1(){this.XWh(this.$K.I$a())?(this.$K.AXe(Object(h.a)(this,this.pld,"onUsersUpdatedEventListener")),this.sHk(this.Cjf)):this.nHc.wK(1);this.Cjf=!0}sHk(kb){this.Fjf?this.HHh.continueWith(()=>{r.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",t[this.HHh.result])}):(this.Fjf=!0,this.iZk(0===this.Xef&&!kb))}iZk(kb){kb?this.r7.Vj(4,Object(h.a)(this,this.WNe,"onInteractiveReady")):this.nHc.wK(1)}WNe(){const kb=this.ri.Tg("AppInitStatus_interactivityReady");r.ULS.shipAssertTag(42259235,325,!!this.XHc);const Ib=this.XHc-kb,eb={};eb.InteractiveTime=kb;eb.ReactRenderComplete=this.XHc;eb.HadTabSwitch=this.P3a();eb.IsModernGallery=this.e_b;r.ULS.sendTraceTag(594883104,325,50,
B.a.toJSON(eb));this.e_b?(r.ULS.sendTraceTag(42062997,325,15,Ib.toString()),this.nHc.wK(this.cYl(Ib)?3:2)):r.ULS.sendTraceTag(594883103,325,15,Ib.toString())}cYl(kb){const Ib=kb>this.Ma.uc("CoauthorGalleryTimeToRenderDurationMs",1E4),eb="Word"===this.LNa;if(this.P3a())return r.ULS.sendTraceTag(50455714,325,50,Ib.toString()),!1;eb&&x.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Ib&&(eb&&x.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),r.ULS.sendTraceTag(42062998,325,15,kb.toString()));return Ib}}Object(K.a)(w,"CoauthorGalleryTelemetry",null,[1055]);class J{constructor(kb){this.$K=null;this.Ozc={};this.xFc={};this.CVb=null;this.OPa=kb}GXc(kb){const Ib=new m.a;this.init().continueWith(()=>{kb in this.Ozc?Ib.wK(this.Ozc[kb]):this.xFc[kb]=Ib});return Ib.task}init(){if(this.CVb)return this.CVb.task;this.CVb=new m.a;this.OPa.continueWith(()=>{this.$K=this.OPa.result;this.$K.btb(Object(h.a)(this,
this.F1,"onUsersUpdated"));this.WQh();this.CVb.Ng(null)});return this.CVb.task}WQh(){const kb=this.$K.I$a();kb.sort(Object(h.a)(this,this.UGi,"comparePresenceUsers"));this.Ozc={};for(let Ib=0;Ib<kb.length&&kb[Ib]&&kb[Ib].AGa;Ib++)this.hgi(this.Ozc,kb[Ib].clientId,Ib)}hgi(kb,Ib,eb){kb[Ib]=eb;Ib in this.xFc&&(this.xFc[Ib].wK(eb),delete this.xFc[Ib])}F1(){this.WQh()}UGi(kb,Ib){return kb.AGa>Ib.AGa?1:kb.AGa<Ib.AGa?-1:0}}Object(K.a)(J,"CoauthorPositionFinder",null,[1053]);var F=d(1256),L=d(1255),M=d(1254),
Q=d(18),C=d(103);class O{constructor(){this.Uia=null;this.USb=Array(32)}xor(kb){if(!kb)throw Error.argumentNull("Guid argument cannot be null");const Ib=new O,eb=new Sys.StringBuilder;for(let Rb=0;Rb<kb.USb.length;Rb++){const pc=this.USb[Rb]^kb.USb[Rb];Ib.USb[Rb]=pc;eb.append(pc.toString(16));7!==Rb&&11!==Rb&&15!==Rb&&19!==Rb||eb.append("-")}Ib.Uia=C.a.Kf(eb.toString());return Ib}toString(){return this.Uia.toString()}equals(kb){if(!kb)throw Error.argumentNull("Guid argument cannot be null");return this.Uia.equals(kb.Uia)}static BUc(kb){if(!kb)throw Error.argumentNull("String input cannot be null");
const Ib=new O;Ib.Uia=C.a.Kf(kb);const eb=Ib.Uia.toString();let Rb=0;for(let Wc=0;Wc<eb.length;Wc++){var pc=kb.charAt(Wc);if(O.L0j(pc))pc=O.hMj(pc,kb.charCodeAt(Wc)),Ib.USb[Rb++]=pc;else if(!O.c0j(pc))throw Error.argument("String contains characters not valid in Guids");}return Ib}static L0j(kb){return"0"<=kb&&"9">=kb||"A"<=kb&&"F">=kb||"a"<=kb&&"f">=kb}static c0j(kb){return"{"===kb||"}"===kb||"-"===kb}static hMj(kb,Ib){if("0"<=kb&&"9">=kb)return Ib-48;if("A"<=kb&&"F">=kb)return Ib-65+10;if("a"<=
kb&&"f">=kb)return Ib-97+10;throw Error.argument("Char is not valid hex digit");}}Object(K.a)(O,"Guid",null,[]);class U{constructor(kb,Ib,eb,Rb){this.TPa=null;this.Sff=this.Hpf=!1;this.Snf=0;this.SXb=kb;this.NQd=Ib;this.Ma=eb;this.zLd=Rb;this.FWh=z.AFrameworkApplication.Mnb||z.AFrameworkApplication.dR;this.Dof=new F.a(L.a.Gk())}get z3d(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.SXb.continueWith(()=>{this.TPa=this.SXb.result;
this.TPa.btb(Object(h.a)(this,this.F1,"onUsersUpdated"))})}F1(){this.XFi(this.TPa.I$a())}XFi(kb){var Ib=0;const eb=new M.a(L.a.Gk());for(const Rb of kb)if(Rb&&Rb.isAnonymous){z.AFrameworkApplication.Oea("70eb6120;2gfeb930");if(eb.Gb(Rb.userName))eb.ga(Rb.userName).add(Rb.clientId);else{let pc;eb.add(Rb.userName,(pc=new Q.a,pc.add(Rb.clientId),pc))}Rb.clientId!==this.zLd?(Ib++,2<=Ib&&!this.Hpf&&this.cgk()):!this.Sff&&this.z3d&&"Guest"===Rb.userName&&(r.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.Sff=!0)}if(this.z3d&&this.Snf!==Ib){r.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",Ib+(this.FWh?1:0));this.Snf=Ib;for(let Rb of eb.keys)2<=eb.ga(Rb).count&&(kb=this.rjj(eb.ga(Rb)),this.Dof.contains(kb)||(Ib={},Ib.guestsWithSameName=eb.ga(Rb).count,Ib.identifier=kb,r.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",Ib),this.Dof.add(kb)))}}cgk(){r.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.Hpf=!0;this.z3d&&
this.NQd&&this.NQd.continueWith(()=>{window.setTimeout(()=>{this.NQd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}rjj(kb){if(!kb||1>=kb.count)return"";let Ib=O.BUc(kb.ga(0));for(let eb=1;eb<kb.count;eb++)Ib=Ib.xor(O.BUc(kb.ga(eb)));return Ib.toString()}}Object(K.a)(U,"GuestCoauthTelemetry",null,[]);var T=d(1252);class ca{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(K.a)(ca,"PL",null,[]);var N=d(36);class da{constructor(){this.ct=
this.vt=this.d=0}static gyh(kb,Ib,eb){const Rb=new da;Rb.d=kb;Rb.vt=Ib;Rb.ct=eb;return N.c(Rb)}}Object(K.a)(da,"VD",null,[]);var Y=d(89);class fa{constructor(kb,Ib,eb,Rb,pc,Wc,Ic,nd,ob,$b,Hc){this.Kuf=!1;this._id=kb;this.Nj=Ib;this.Bvf=eb;this.St=Rb;this.ALd=pc;this.pRd=Wc;this.g7a=Ic;this.i4a=nd;this.pYh=ob;this.P3a=$b;this.Zwf=Hc;this.LNa=Object(n.a)(String,z.AFrameworkApplication.Md.Application)||""}xAd(kb){const Ib=[this.ALd,this.pRd];this.Zwf&&Ib.push(this.Bvf);D.Task.WAA.apply(null,Ib).continueWith(()=>
{if(this.ALd.result<=this.pRd.result)kb.wK(!1);else{this.Zwf&&(this.Nj=this.Bvf.result);var eb=this.St-this.Nj,Rb=new ca;Rb.id=this._id;Rb.et=this.St;Rb.st=this.Nj;Rb.d=this.St-this.Nj;Rb.mp=this.ALd.result;Rb.tp=this.pRd.result;Rb.ct=this.Efj(this.pYh);Rb.vc=this.P3a();var pc=N.c(Rb),Wc="Word"===this.LNa,Ic="PowerPoint"===this.LNa;r.ULS.sendTraceTag(42078597,302,15,pc);if(Wc){const nd=new Map;nd.set("data",pc);x.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",nd)}eb>
this.g7a.value&&!this.Kuf&&!Rb.vc&&(this.Kuf=!0,kb.wK(!0),Rb=Object.assign(new Y.a,{inStaging:!0,extendedProperties:new Map}),Rb.extendedProperties.set("data",pc),Wc&&x.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Rb),eb<this.i4a.value&&(r.ULS.sendTraceTag(42078598,302,15,da.gyh(eb,this.g7a.value,this.i4a.value)),eb=z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientThumbnailPresenceRenderLatencyQoSError"),
Ic&&eb&&x.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],!1,!0,!0,!1,Rb)));kb.task.isCompleted||kb.wK(!1)}})}Efj(kb){switch(kb){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(K.a)(fa,"PresenceLatencyActivityLogger",null,[]);class aa{constructor(kb,Ib,eb){this.vef=this.Wef=this.Czc=this.Nzc=this.qob=0;this._id=kb;this.g7a=Ib;this.i4a=eb;this.LNa=Object(n.a)(String,z.AFrameworkApplication.Md.Application)||
""}get nCf(){return this.qob}set nCf(kb){this.qob=kb;this.LZd()}get mNf(){return this.Nzc}set mNf(kb){this.Nzc=kb;this.LZd()}get yKf(){return this.Czc}set yKf(kb){this.Czc=kb;this.LZd()}get nNf(){return 0!==this.Wef}get zKf(){return 0!==this.vef}LZd(){!this.nNf&&this.qob&&this.Nzc&&(this.Wef=this.xAd(this.Nzc,"CoauthGalleryLightupDurationTooLong"));!this.zKf&&this.qob&&this.Czc&&(this.vef=this.xAd(this.Czc,"CanvasPresenceLightupDurationTooLong"))}xAd(kb,Ib){const eb=kb-this.qob;var Rb=new ca;Rb.id=
this._id;Rb.et=kb;Rb.st=this.qob;Rb.d=eb;var pc=N.c(Rb),Wc="Word"===this.LNa;kb="PowerPoint"===this.LNa;Rb="CanvasPresenceLightupDurationTooLong"===Ib?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Ib?r.ULS.sendTraceTag(572289499,302,15,pc):r.ULS.sendTraceTag(571524118,302,15,pc);if(Wc){var Ic=new Map;Ic.set("data",pc);x.Health.instance.recordKpiUsage(Rb,0,"wordcollabrel",Ic)}return eb>this.g7a.value?(Ic=Object.assign(new Y.a,{inStaging:!0,
extendedProperties:new Map}),Ic.extendedProperties.set("data",pc),pc=eb<this.i4a.value,Ic.extendedProperties.set("cash",pc?"true":"false"),Wc&&x.Health.instance.recordKpiFailure(Rb,Ib,!1,!0,Ic),Wc=z.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientRenderLatencyQoSError"),kb&&Wc&&x.Health.instance.recordQosError(Ib,[Rb],!1,!0,!0,!1,Ic),r.ULS.sendTraceTag(572289500,302,15,da.gyh(eb,this.g7a.value,this.i4a.value)),pc?2:1):3}}Object(K.a)(aa,"PresenceLightupLatencyLogger",
null,[]);var ka=d(286),H=d(280);class ra{constructor(kb,Ib,eb,Rb,pc,Wc,Ic,nd=null,ob=null,$b=null){this.msf={};this.ODd={};this.Vmf=new Q.a;this.lzc=this.DVb=this.$K=this.FYb=null;this.oQd=this.nQd=0;this.g7a=new T.a(()=>nd.eX("PresenceBootLatencyThreshold",1E4));this.i4a=new T.a(()=>nd.eX("PresenceBootLatencyCutoffThreshold",6E4));this.nci=new T.a(()=>nd.eX("PresenceLightupLatencyThreshold",2E3));this.zZh=new T.a(()=>nd.eX("PresenceLightupLatencyCutoffThreshold",1E4));this.r7=Rb;this.Ma=nd;this.n7h=
pc;this.Yef=kb;this.Ptf=Ib;this.OPa=eb;this.ri=Wc;this.zLd=ob;this.P3a=Ic;this.Hjf=$b;this.RCd=!1;this.init()}m1i(kb,Ib=0){var eb=new Date;const Rb=new m.a;this.init().continueWith(()=>{this.wKk(kb);this.n1i(Rb,kb,eb,Ib)})}get eLe(){return this.zLd||"{"+z.AFrameworkApplication.userSessionId+"}"}init(){if(this.DVb)return this.DVb.task;this.DVb=new m.a;this.P3a()&&r.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.Yef.continueWith(()=>{const kb=this.Yef.result,Ib=kb.kDa,eb=kb.Ehd;eb.continueWith(()=>
{Ib.continueWith(()=>{this.Hjf&&this.Hjf.addQosPillar("RealTimeCoauth");this.RFl(Ib.result,eb.result);this.DVb.Ng(null)})})});this.Ptf.continueWith(()=>{this.FYb=this.Ptf.result;this.FYb.A7a(Object(h.a)(this,this.qLk,"onRtcConnection"));this.FYb.ECa(Object(h.a)(this,this.UFk,"onCoauthorBootReceived"))});this.OPa.continueWith(()=>{this.$K=this.OPa.result;this.$K.btb(Object(h.a)(this,this.pld,"onUsersUpdatedEventListener"));0<this.$K.I$a().length&&this.F1()});return this.DVb.task}a7f(){return this.ri.xn(ka.a.Lnb)?
this.ri.Tg(ka.a.Lnb):H.a.SCa?window.performance.timing.fetchStart:-1}n$f(){this.lzc||(this.lzc=new m.a,this.r7.Vj(4,()=>{this.lzc.wK(this.ri.Tg("AppInitStatus_interactivityReady"))}));return this.lzc.task}qLk(kb,Ib){if(!this.RCd&&2===Ib.newState)if(this.$zd){const eb=this.n$f();eb.continueWith(()=>{var Rb=eb.result;Rb=Date.now()-Rb;const pc={};pc.clientId=this.eLe;pc.bootTime=Rb;this.RCd=!0;this.FYb.bba(15,pc)})}else kb=this.a7f(),kb=Date.now()-kb,Ib={},Ib.clientId=this.eLe,Ib.bootTime=kb,this.RCd=
!0,this.FYb.bba(15,Ib)}UFk(kb,Ib){if(15===Ib.type){kb=Date.now();Ib=Ib.iAa;var eb=Ib.bootTime;this.fce(Ib.clientId).nCf=kb-eb}}pld(){this.F1()}F1(){const kb=Date.now();var Ib=this.$K.I$a();const eb=new Q.a;for(const Rb of Ib)this.Vmf.contains(Rb.clientId)||(this.Vmf.add(Rb.clientId),eb.add(Rb.clientId));if(0<eb.count)for(let Rb of eb)Ib=this.fce(Rb),Ib.nNf||(Ib.mNf=kb)}wKk(kb){kb=this.fce(kb);kb.zKf||(kb.yKf=Date.now())}fce(kb){return kb in this.ODd?this.ODd[kb]:this.ODd[kb]=new aa(kb,this.nci,this.zZh)}RFl(kb,
Ib=0){this.nQd=kb;this.oQd=Ib?Ib:(new Date).getTime()}n1i(kb,Ib,eb,Rb){eb=eb?eb.getTime():(new Date).getTime();if(Ib in this.msf)kb.r2();else{const pc=this.$zd?0:this.Lwj(),Wc=this.$zd?this.Mwj():null;Rb=new fa(Ib,pc,Wc,eb,this.GXc(this.eLe),this.GXc(Ib),this.g7a,this.i4a,Rb,this.P3a,this.$zd);this.msf[Ib]=Rb;Rb.xAd(kb)}}Lwj(){return 1===this.nQd?this.oQd:this.a7f()}Mwj(){return 1===this.nQd?D.Task.ut(this.oQd):this.n$f()}GXc(kb){return this.n7h.GXc(kb)}get $zd(){return this.Ma.ka("UseAppInteractiveBootTimeForPresenceTelemetry")}}
Object(K.a)(ra,"PresenceBootTelemetry",null,[1054]);var ha=d(182),Ma=d(71),Ga=d(354),na=d(55),wa=d(254);class Fa{get name(){return"Common.App.CoauthTelemetry"}Xb(kb){kb.register(e,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").na().oa(()=>new e(wa.a.Ot(kb.Ia("Common.IPeopleInfoProvider")),z.AFrameworkApplication.Rg));kb.register(w,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").na().oa(()=>new w(z.AFrameworkApplication.Qa,
wa.a.Ot(kb.Ia("Common.ICoauthoringTelemeryInfoProvider")),z.AFrameworkApplication.fa,ha.a.get_instance(),Ga.a.instance,wa.a.Ot(kb.Ia("Common.IPeoplesWell")),wa.a.Ot(kb.Ia("Common.IPeopleInfoProvider")),e.UEf,()=>this.bHf()));kb.register(ra,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").na().oa(()=>new ra(wa.a.Ot(kb.Ia("Common.ICoauthoringTelemeryInfoProvider")),wa.a.Ot(kb.Ia("Common.IRealtimeChannelBasic")),wa.a.Ot(kb.Ia("Common.IPeopleInfoProvider")),
ha.a.get_instance(),kb.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Ga.a.instance,()=>this.bHf(),z.AFrameworkApplication.fa,null,x.Health.instance));kb.register(J,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").na().oa(()=>new J(wa.a.Ot(kb.Ia("Common.IPeopleInfoProvider"))));kb.register(U,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").na().oa(()=>new U(wa.a.Ot(kb.Ia("Common.IPeopleInfoProvider")),wa.a.Ot(kb.Ia("Common.ISystemInitiatedFeedback")),
z.AFrameworkApplication.fa,"{"+z.AFrameworkApplication.userSessionId+"}"))}init(){z.AFrameworkApplication.fa.$e(()=>{na.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();na.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();z.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&na.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();z.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&(na.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),
na.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}bHf(){return H.a.SCa&&Ga.a.instance.xn(ka.a.Uxc)?0<Ga.a.instance.Tg(ka.a.Uxc)[ka.a.BAd]:!1}static main(){Ma.a.instance.Ac(new Fa)}}Object(K.a)(Fa,"CoauthTelemetryPackage",null,[2,3]);var pa=d(267),Ea=d(1258),ta=d(251),ia=d(798);class Ja{constructor(kb,Ib,eb,Rb,pc){this.Yc=kb;this._clientId=Ib;this.b_h=pc;this.d1h=eb||(()=>null);this.e1h=Rb||(()=>null)}get id(){return this.Yc.id}get SIc(){return this.Yc.SIc}get WIc(){return this.Yc.WIc}get VIc(){return this.Yc.VIc}get UIc(){return this.Yc.UIc}get TIc(){return this.Yc.TIc}get YIc(){return this.Yc.YIc}get VSd(){return this.Yc.VSd}get oPb(){return this.Yc.oPb}get Lvd(){return this.Yc.Lvd}get Yhd(){return this.Yc.Yhd}get clientId(){return this._clientId}get oua(){return this.d1h}get u4(){return this.e1h}get tYi(){return this.b_h}static createInstance(kb,
Ib,eb,Rb,pc=!1){return new Ja(kb,Ib,eb,Rb,pc)}}Object(K.a)(Ja,"PeoplesWellSettings",null,[]);var ab=d(28);class Oa{constructor(kb){this.uj=kb}get kDa(){return this.uj.kDa}get Ehd(){return this.uj.Ehd}}Object(K.a)(Oa,"CoauthoringTelemetryInfoProvider",null,[789]);var Za=d(678),Na=d(78),sa=d(121),Sa=d(799),xb=d(586);class gc{constructor(kb,Ib,eb,Rb,pc){this.XHb=new Na.a;this.Kz=null;this.uj=kb;this.Agb=eb;this.yE=Rb;this.yE.jUd(Object(h.a)(this,this.zjd,"onEditorTableUpdate"));this.Zkk=z.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.bGe=pc;Ib&&Ib.execute(Wc=>{this.Kz=Wc})}dispose(){this.XHb&&(sa.a.Ord([this.XHb]),this.XHb=null);this.yE.Vqh(Object(h.a)(this,this.zjd,"onEditorTableUpdate"))}btb(kb){this.XHb.addHandler("UsersUpdatedEvent",kb)}AXe(kb){this.XHb.removeHandler("UsersUpdatedEvent",kb)}I$a(){return this.M5f(!1)}vdj(){return this.M5f(!0)}M5f(kb){const Ib=[];this.uj.xnb(this.uj.AD).returnValue||ab.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.uj.AD);var eb=
null;this.Kz&&(eb=this.Kz.SUc());const Rb=this.bGe.F8f();let pc=!1;for(const Wc of this.uj.K_)kb&&gc.cLc(Rb,Wc.EmailAddress)?pc=!0:Array.add(Ib,this.HQi(Wc,eb));eb={};eb.fExcludeCurrent=kb;eb.fCurrentExcluded=pc;eb.CurrentID=this.uj.AD;eb.EditorCount=this.uj.K_.length;eb.IsRtcNull=!this.Kz;eb.UserCount=Ib.length;ab.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",N.c(eb));return Ib}HQi(kb,Ib){const eb=this.Agb.nua(new Za.a(kb.EmailAddress,void 0,kb.Name),kb.ID,1),Rb=new Sa.a;Rb.w1a(0);let pc=
0,Wc=!1,Ic=!1;if(Ib&&kb.ID in Ib){Rb.w1a(1);if(this.Zkk){const nd=Ib[kb.ID];nd&&nd.capabilities&4&&Rb.w1a(4);Wc=!0;nd&&(pc=nd.capabilities,Ic=nd.isAnonymous)}delete Ib[kb.ID]}ab.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",kb.ID,eb,Rb.hea(1),Rb.hea(4),this.uj.AD,!kb.EmailAddress,
pc,Wc,Ic);return new xb.a(kb.ID,kb.Name,eb,Rb,null,kb.EmailAddress,void 0,void 0,Ic,void 0,void 0,kb.JoinCoauthTime)}zjd(){ab.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.XHb.raiseEvent("UsersUpdatedEvent",this)}static cLc(kb,Ib){return!!kb&&!!Ib&&kb.toLowerCase()===Ib.toLowerCase()}}Object(K.a)(gc,"PeopleInfoProvider",null,[1007]);var zc=d(82),Xb=d(210),jb=d(131),zb=d(319),Tb=d(275);class Ya extends Xb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=!1;this.ImageUrl=
null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(K.a)(Ya,"PeopleButtonProps",Xb.a,[]);var sb=d(782),oc=d(47),wb=d(72);class rc{constructor(kb){this.Xxc=new wb.a;this.x3d=null;this.clientId=kb}qul(kb){this.V9k();this.Mol(kb);for(const Ib of kb)Ib.clientId!==this.clientId&&this.xAf(Ib)}get gAd(){const kb=[];for(let Ib of this.Xxc.values){const eb=this.vxh(Ib);Array.add(kb,eb)}return kb}get Cxa(){return this.Xxc.count}dUd(kb,Ib){kb=kb.toUpperCase();let eb;({value:eb}=
this.Xxc.vg(kb)).returnValue||(eb=[],this.Xxc.$(kb,eb));Array.add(eb,Ib)}V9k(){this.Xxc=new wb.a}Mol(kb){for(const Ib of kb)if(Ib.clientId===this.clientId){this.x3d=Ib;break}}}Object(K.a)(rc,"UserTracker",null,[1714]);class Ka extends rc{constructor(kb,Ib){super(kb);this.f1h=Ib}xAf(kb){kb.isAnonymous||!kb.email?this.dUd(kb.clientId,kb):this.x3d&&L.a.Gk().equals(this.x3d.email,kb.email)||this.dUd(kb.email,kb)}vxh(kb){let Ib=new Date(0),eb=0<kb.length?kb[0]:null;for(const Rb of kb)(kb=this.f1h(Rb.clientId))&&
Ib.getTime()<kb.FCb.getTime()&&(Ib=kb.FCb,eb=Rb);return eb}}Object(K.a)(Ka,"UniqueUserTracker",rc,[]);class Db extends rc{constructor(kb){super(kb)}xAf(kb){this.dUd(kb.clientId,kb)}vxh(kb){return kb[0]}}Object(K.a)(Db,"UserInstanceTracker",rc,[]);const bc=(kb,Ib,eb)=>eb?new Ka(kb,Ib):new Db(kb);var Mc=d(73),mb=d(682),Wa=d(37);class db{constructor(kb,Ib=null,eb=null){this.$K=null;this.tRd=new m.a;this.Yc=kb;this.vmd=Ib;eb&&eb.continueWith(()=>{this.$K=eb.result;this.$K.btb(Object(h.a)(this,this.F1,
"onUsersUpdated"));this.Cpd()});new xb.a(this.settings.clientId,"Anonymous user","#cccccc",new Sa.a(7));this.ipe=this.BJd=!0;this.$Gd=this.lNd=!1;this.z2=bc(this.settings.clientId,this.settings.u4,kb.tYi)}get settings(){return this.Yc}get nYj(){return z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get lYj(){return z.AFrameworkApplication.fa?z.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):!1}ahj(){let kb;let Ib,eb,Rb,pc;var Wc=this.bhj();
this.z2.Cxa?1===this.z2.Cxa?(Ib=!0,eb=this.settings.oPb.cluster,Rb=this.settings.oPb.IPc,pc=this.z2.gAd[0].color):(Ib=!0,eb=this.settings.Yhd.cluster,Rb=this.settings.Yhd.IPc,pc=""):(Ib=!1,pc=Rb=eb="");kb=Wc[0];Wc=Wc.slice(1);return{NOk:kb,OOk:Wc,JOk:Ib,K1l:eb,LOk:Rb,KOk:pc}}bhj(){if(2<=this.z2.Cxa)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.z2.Cxa)];if(1===this.z2.Cxa){const kb=this.z2.gAd[0],Ib=this.settings.u4(kb.clientId);return Ib&&2===Ib.status?
[CommonUIStrings.l_PeoplesWellStateUserIsInactive,kb.userName]:[kb.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,kb.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}cAj(kb){return this.dAj(kb)}TJf(kb,Ib,eb){return Ib?this.$zi(Ib)?(kb=this.settings.u4(kb))&&2===kb.status?!1:!0:(eb&&r.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(eb&&r.ULS.sendTraceTag(4482393,325,50,"User does not have any presence data"),
!1)}Rwj(kb){return kb.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}dAj(kb){if(!kb.capabilities.hea(1))return this.Rwj(kb);const Ib=kb.isReadOnly,eb=this.settings.u4(kb.clientId);kb=this.settings.oua(kb.clientId);if(!eb)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(eb.status){case 1:return kb?Ib?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.CLi(kb)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}imj(kb){if(this.vmd.A4c)return this.vmd.Tvb(kb.email,"O365",z.AFrameworkApplication.Pg,0)}Rzj(kb){kb=this.settings.u4(kb.clientId);return!kb||kb&&1===kb.status?!0:!1}Szj(kb){var Ib=String.format("buttonPeoplesWellUser-{0}",kb.clientId),eb=kb.clientId,Rb=this.cAj(kb);const pc=kb.userName,Wc=kb.color;var Ic=Object,
nd=Ic.assign,ob=new Ya,$b=this.settings.YIc.toString(),Hc=this.settings.Lvd.cluster,Pb=this.settings.Lvd.IPc,Yc=this.s8f(),Rd=kb.isAnonymous,Gb;if(Gb=[pc],Gb.length){var Bb=new Sys.StringBuilder("STRARRY@");for(const dc of Gb)Bb.append(dc?dc.length:0),Bb.append(","),Bb.append(dc),Bb.append(",");Gb=Bb.toString().slice(0,-1)}else Gb=null;Ib=nd.call(Ic,ob,{Id:Ib,Command:$b,LabelText:"{0}",Image32by32:Hc,Image32by32Class:Pb,MenuItemId:eb,CommandValueId:eb,Alt:pc,DisplayMode:Yc,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",
Description:Rb,ImageBackColor:Wc,IsAnonymous:Rd,LabelTextUserGeneratedPlaceholderReplacements:Gb,Upn:kb.email});z.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.vmd&&(eb=this.imj(kb),Rb=this.Rzj(kb),Ib.ImageUrl=eb,Ib.ActiveStatus=Rb,Ib.JoinTimeInMS=kb.AGa,kb=this.TJf(kb.clientId,this.settings.oua(kb.clientId),!1),Ib.CanJump=kb,""===eb&&r.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));return Ib}tlj(){return Object.assign(new Xb.a,{Id:"BasicChat",Command:"2288458806",
LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}s8f(){return this.nYj?"Initials":"Menu32"}Tzj(kb){const Ib=[];for(const eb of kb)kb=this.Szj(eb),Array.add(Ib,kb);return Ib}ooe(){return 0<this.z2.Cxa}q0k(kb){if(!this.BJd)return!0;this.ipe||(kb[mb.a.Visible]=!0);let Ib,eb,Rb,pc,Wc;({NOk:Ib,OOk:eb,JOk:Rb,LOk:pc,KOk:Wc}=this.ahj());kb[mb.a.LabelText]=Ib;eb&&eb.length&&(kb[mb.a.LabelTextUserGeneratedPlaceholderReplacements]=
eb);kb[mb.a.ImageIsVisible]=Rb;kb[mb.a.Image16by16Class]=pc;kb[mb.a.ImageBackColor]=Wc;this.BJd=!1;return!0}ZTk(kb){if(0>=this.z2.Cxa)return!1;var Ib=this.fEl(this.z2.gAd),eb=this.Tzj(Ib);Ib=Object.assign(new zb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});eb=Object.assign(new Tb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.s8f(),ControlList:eb});z.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.vmd&&(eb.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,
eb.TitleId="menuCoauthorsTitle",eb.Theme="Light");Array.add(Ib.MenuSectionList,eb);z.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&z.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.mb.Qp&&(eb=[],Array.add(eb,this.tlj()),eb=Object.assign(new Tb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:eb}),Array.add(Ib.MenuSectionList,eb));z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.mb.Qp?kb.MenuItems=Ib:
kb.PopulationXML=jb.l(Ib);return!0}HWl(kb){r.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");kb=kb.MenuItemId;if(!kb)return!1;const Ib=this.settings.oua(kb);if(!this.TJf(kb,Ib,!0))return!1;this.N$j(kb,Ib);return!0}v6k(){const kb=this.ydj();this.z2.qul(kb);this.ipe&&1<=this.z2.Cxa&&(r.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.ipe=!1);this.BJd=!0}F1(){this.$Gd||(window.setTimeout(()=>{this.Cpd();this.$Gd=!1},3E3),this.$Gd=!0)}ydj(){let kb;
kb=this.wdj()||[];for(const Ib of kb)this.kjl(Ib);return kb}kjl(kb){kb.clientId||(kb.clientId=C.a.create().toString());kb.userName||(kb.userName="Anonymous user");kb.capabilities||(kb.capabilities=new Sa.a);kb.color||(kb.color="#cccccc");kb.AGa||(kb.AGa=0)}fEl(kb){const Ib=[];Array.addRange(Ib,kb);Ib.sort(db.yOk);return Ib}G8k(){z.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&!this.lNd&&(z.AFrameworkApplication.Qa.MT(Wa.a.qNf)&&sb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||
z.AFrameworkApplication.Qa.ra(Wa.a.qNf,Mc.a.frame,Object(h.a)(this,this.VFk,"onCoauthorGalleryFirstRender"),96));this.H8k();this.lNd=!0;this.Cpd()}VFk(kb,Ib,eb,Rb,pc){this.tRd.wK(pc.RenderTime);return 32}get Hxd(){return this.tRd.task}Cpd(){if(!this.lNd&&(this.tRd.wK((new Date).getTime()),r.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.lYj))return;this.v6k();this.w6k()}dispose(){this.$K&&(this.$K.AXe(Object(h.a)(this,
this.F1,"onUsersUpdated")),this.$K=null)}static yOk(kb,Ib){return kb.capabilities.hea(1)&&Ib.capabilities.hea(1)||!kb.capabilities.hea(1)&&!Ib.capabilities.hea(1)?oc.a.localeCompare(kb.userName,Ib.userName):kb.capabilities.hea(1)?-1:1}}Object(K.a)(db,"APeoplesWell",null,[1600,108]);var ub=d(40);class Lb extends db{constructor(kb,Ib,eb=null,Rb=null){super(kb,eb,Rb);this.WAa=()=>!0;this.Ca=Ib}s0k(kb){return this.q0k(kb)}aUk(kb){return this.ZTk(kb)}JWl(kb){return this.HWl(kb)}RQ(kb,Ib,eb,Rb,pc,Wc){kb=
!1;switch(eb){case 1:kb=pc(Rb);break;case 2:kb=Wc(Rb)}return Lb.cti(kb)}OYj(kb,Ib,eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,()=>this.ooe(),this.WAa)}r0k(kb,Ib,eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,Object(h.a)(this,this.s0k,"queryUsersProxy"),this.WAa)}$Tk(kb,Ib,eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,this.WAa,Object(h.a)(this,this.aUk,"populateFlyoutContentsProxy"))}qGi(kb,Ib,eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,this.WAa,this.WAa)}pGi(kb,Ib,eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,this.WAa,this.WAa)}IWl(kb,Ib,
eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,this.WAa,Object(h.a)(this,this.JWl,"userButtonClickProxy"))}wSk(kb,Ib,eb,Rb,pc){return this.RQ(kb,Ib,eb,pc,this.WAa,()=>{this.Cpd();return!0})}H8k(){this.Ca.ya(this.settings.SIc,ub.a.application,Object(h.a)(this,this.OYj,"isControlEnabledHandler"));this.Ca.ra(this.settings.WIc,ub.a.application,Object(h.a)(this,this.r0k,"queryUsersHandler"),96);this.Ca.ra(this.settings.UIc,ub.a.application,Object(h.a)(this,this.qGi,"commandMenuOpenHandler"),96);this.Ca.ra(this.settings.TIc,
ub.a.application,Object(h.a)(this,this.pGi,"commandMenuCloseHandler"),96);this.Ca.ra(this.settings.VIc,ub.a.application,Object(h.a)(this,this.$Tk,"populateFlyoutContentsHandler"),96);this.Ca.ya(this.settings.YIc,ub.a.application,Object(h.a)(this,this.IWl,"userButtonClickHandler"));this.Ca.ra(this.settings.VSd,ub.a.application,Object(h.a)(this,this.wSk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static cti(kb){return kb?32:8}}Object(K.a)(Lb,"ABox4PeoplesWell",db,[]);var Kb=d(751);
class uc extends Sys.EventArgs{constructor(kb){super();this.controlId=kb}}Object(K.a)(uc,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class Yb extends Lb{constructor(kb,Ib,eb,Rb,pc,Wc,Ic,nd,ob,$b,Hc,Pb,Yc,Rd,Gb,Bb,dc,Xc){super(kb,Ib,Bb,Xc?D.Task.ut(Xc):null);this.Kz=null;this.aBe=!1;if(!pc)throw Error.argumentNull("coauthStateGetter");if(!Wc)throw Error.argumentNull("appFrame");if(!Ic)throw Error.argumentNull("taskManager");this.uj=pc;this.Rb=Wc;this.wb=Ic;Rb&&Rb.execute(Fb=>{this.Kz=Fb});
eb&&eb.execute(Fb=>{Fb.Eki(Object(h.a)(this,this.nXk,"presenceChanged"))});this.ic=nd;this.xe=ob;this.$d=$b;this.nhc=Yc;this.Vik=Hc;this.Agb=Pb;this.cEb=Rd;this.nY=Gb;this.bGe=dc;this.EQg=Xc;this.Hxd.continueWith(()=>{this.nY.k2i(this.Hxd.result)})}N$j(kb,Ib){let eb=null;({data:eb}=this.B9e(Ib)).returnValue&&eb&&eb.pk&&(ab.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",kb,eb.pk,this.uj.AD),(kb=this.ic.Yka(eb.pk))?(this.xe.utd(),this.xe.dK(kb.qe)):
ab.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",eb.pk))}B9e(kb){let Ib;Ib=null;if(!kb)throw ab.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.uj.AD),Error.argumentNull("presence");return kb?(Ib=Kb.a.dPc(kb.data))?{returnValue:!0,data:Ib}:{returnValue:!1,data:Ib}:{returnValue:!1,data:Ib}}$zi(kb){let Ib=null;return({data:Ib}=this.B9e(kb)).returnValue&&Ib&&Ib.pk?!0:!1}wdj(){if(this.EQg)return this.EQg.vdj();
ab.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const kb=this.xdj();0<kb.length&&ab.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",kb.length);return kb}xdj(){const kb=[],Ib=this.bGe.F8f();this.uj.xnb(this.uj.AD).returnValue||ab.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.uj.AD);let eb=null;this.Kz&&(eb=this.Kz.SUc());var Rb=z.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var pc of this.uj.K_){var Wc=this.Agb.nua(new Za.a(pc.EmailAddress,void 0,pc.Name),pc.ID,1),Ic=new Sa.a;Ic.w1a(0);let nd=0,ob=!1;if(Yb.u9j(pc.ID,eb)){Ic.w1a(1);if(Rb){let $b=eb[pc.ID];$b&&(nd=$b.capabilities);ob=!0;$b&&$b.capabilities&4&&Ic.w1a(4)}delete eb[pc.ID]}Yb.cLc(Ib,pc.EmailAddress)||(Array.add(kb,new xb.a(pc.ID,pc.Name,Wc,Ic,null,pc.EmailAddress)),ab.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
pc.ID,Wc,Ic.hea(1),Ic.hea(4),this.uj.AD,!pc.EmailAddress,nd,ob))}if(!Rb&&this.nhc&&eb)for(let nd in eb)Rb=eb[nd],!Yb.cLc(Ib,Rb.email)&&Rb&&Rb.userName&&(pc=new Sa.a,pc.w1a(1),Rb.capabilities&4&&pc.w1a(4),Wc=this.cEb.Uae(Rb.email)||Rb.email,Ic=this.Agb.nua(new Za.a(Wc,void 0,Rb.userName),Rb.clientId,1),Array.add(kb,new xb.a(Rb.clientId,Rb.userName,Ic,pc,null,Wc)),ab.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
Rb.clientId,Ic,pc.hea(1),pc.hea(4),this.Kz.clientId,!Rb.email,Rb.capabilities));return kb}CLi(kb){let Ib=null,eb=" ";({data:Ib}=this.B9e(kb)).returnValue&&Ib&&Ib.pk&&(kb=this.ic.Yka(Ib.pk))&&(eb=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,kb.qe+1));return eb}nXk(){this.Rb.ku.$Fa?this.aBe||(this.wb.Hb(new zc.a(2,1,0,Object(h.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.aBe=!0):this.Ca.processAction(Wa.a.J8a,2)}w6k(){this.$d.y2k(new uc(this.settings.id,
!0));const kb=1<this.z2.Cxa||1===this.z2.Cxa&&this.z2.gAd[0].clientId!==this.settings.clientId;this.Vik.execute(Ib=>{kb&&this.nY&&this.nY.qgk();Ib.vRb()});kb&&this.nY.li(14,Date.now())}handlePendingRefresh(){this.aBe=!1;this.Ca.processAction(Wa.a.J8a,2)}dispose(){super.dispose()}static u9j(kb,Ib){return Ib&&kb in Ib?!0:!1}static cLc(kb,Ib){return!!kb&&!!Ib&&kb.toLowerCase()===Ib.toLowerCase()}}Object(K.a)(Yb,"PowerPointPeoplesWell",Lb,[]);class Tc{constructor(kb){this.Ejc=null;kb.execute(Ib=>{this.Ejc=
Ib})}oua(kb){return this.Ejc?this.Ejc.oua(kb):null}u4(kb){return this.Ejc?this.Ejc.u4(kb):null}}Object(K.a)(Tc,"PresenceUserInfoGetterProxy",null,[964]);var sc=d(33);class Qb{constructor(){this.G5=this.yE=this.jh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}Xb(kb){Qb.mfc=Date.now();this.K=kb;this.G5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.G5.WEa(6,this.name);this.K.register(964,"PowerPointWebEditor.IPresenceUserInfoGetter").na().oa(()=>new Tc(this.K.Ia("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(789,"Common.ICoauthoringTelemeryInfoProvider").na().oa(()=>new Oa(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(gc,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").na().oa(()=>new gc(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Ia("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(sc.a("PeoplesBaseUlrConfiguredForPods")&&(kb=this.K.resolve("Common.App.People.IExternalPeopleAPI"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").yg)){const Ib=this.K.resolve("Common.IAppSettingsManager").Ha("368");kb.Sfh(Ib+"p")}ab.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.presence1",
null,()=>d.e(4).then(d.bind(null,1302)));else{const kb=Ea.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1302)));ta.a.py(kb)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");z.AFrameworkApplication.oz.Lta?(this.yE=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),ia.a.Jid("ribbon","coauthorGallery"),this.yE.LJc(Object(h.a)(this,this.Wlg,"initializePeoplesWellHandler"))):this.Vlg()}Wlg(){try{z.AFrameworkApplication.oz.Lta||
(this.Vlg(),this.yE.fqd(Object(h.a)(this,this.Wlg,"initializePeoplesWellHandler")))}catch(kb){ab.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",kb)}}Vlg(){const kb=this.jh.du("peoplewell");this.rSj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);
this.jh.lu(kb)}rSj(kb,Ib,eb,Rb,pc,Wc){var Ic=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Ic.li(10,Qb.mfc);Ic.li(9,Qb.Qjc);Ic.li(11,(new Date).getTime());Ic=Date.now();const nd=pa.CuiHelper.mrj(z.AFrameworkApplication.km,z.AFrameworkApplication.km,z.AFrameworkApplication.km);kb=Ja.createInstance(nd,Wc,Object(h.a)(kb,kb.oua,"getUserPresence"),Object(h.a)(kb,kb.u4,"getUserStatusInfo"),!0);(Wc=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||ab.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
ab.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const ob=new Yb(kb,Ib,this.K.Ia("PowerpointPresence.IPresenceManager"),this.K.Ia("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),eb,Rb,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ia("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),
pc.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),Wc);ob.G8k();this.K.register(Yb,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").na().oa(()=>ob);this.K.resolve("Common.IPeoplesWell");this.K.Ia("Box4.IBox4BridgeCommandUi").execute($b=>{$b.vRb()});ab.a.J(8958615,
814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-Ic);this.K.resolve("PowerpointPresence.IPresencePerfLogger").o2i()}dispose(){}static main(){Qb.Qjc=Date.now();if(z.AFrameworkApplication.fa&&z.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const kb=new Qb;kb.Xb(na.a.instance);kb.init()}else Ma.a.instance.Ac(new Qb)}}Qb.Qjc=0;Qb.mfc=0;Object(K.a)(Qb,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");Fa.main();Type.registerNamespace("RealtimePresenceUI");Qb.main()},751:function(K,S,d){K=d(0);var h=d(58);class e{constructor(m,n,z){this.slideId=m;this.shapes=n;this.sn=z}}Object(K.a)(e,"SerializablePresenceData",null,[]);d.d(S,"a",function(){return r});class r{constructor(m,
n,z=0){if(!r.isValid(m))throw Error.create("Invalid Presence Data");this.VB=m;this.Led=n;this.X_g=z?z:++r.LTi}get pk(){return this.VB}get lV(){return this.Led}toString(){return this.VB.toString()+" : "+(this.lV&&this.lV.length?this.lV[0].toString():"")+" : "+this.X_g}dee(){return new e(this.VB.lyc,this.Led,this.X_g)}static isValid(m){return!!m}static dPc(m){return new r(new h.a(m.slideId),m.shapes,m.sn)}}r.LTi=0;Object(K.a)(r,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.presence.js.map