'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1299:function(K,S,d){d.r(S);var h=d(0),e=d(395),r=d(18),m=d(19),n=d(27);class z{}z.beginDraftingAsync="OSC:BDA";z.g$i="OSC:FEQ";z.selectComment="OSC:SC";Object(h.a)(z,"CommentTaskNames",null,[]);class t{constructor(ba){this.yHa=ba;this.Okk=[]}get handler(){return this.yHa}get T8(){return this.Okk}}Object(h.a)(t,"RegisteredListener",null,[]);class x{constructor(ba,Da){this.type=0;this.payload=null;this.type=ba;
this.payload=Da}}Object(h.a)(x,"OfficeSharedCommentsEvent",null,[1535]);class B{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(B,"ViewContainerEvent",null,[1535]);var D=d(679);class w{constructor(ba){this.JAe=!1;this.fY=new r.a;this.wb=ba}Y7k(ba){ba=new t(ba);this.fY.add(ba)}WOh(ba){for(let Da=0;Da<this.fY.count;++Da)if(this.fY.ga(Da).handler===ba){this.fY.removeAt(Da);break}}jpa(ba=!1){const Da=()=>{if(n.AFrameworkApplication.Yg)e.ULS.sendTraceTag(40420181,
201,50,"Skipped processing comment pane events since app is shutting down.");else for(let Wb=0;Wb<this.fY.count;++Wb){const Jb=this.fY.ga(Wb);for(;0<Jb.T8.length;){var Qa=Array.dequeue(Jb.T8);if(Object(m.a)(B,Qa)){var nb=Jb.handler;nb(Qa)}else Object(m.a)(x,Qa)&&(nb=Jb.handler,nb(Qa.type,Qa.payload))}}};ba?Da():this.JAe||(this.JAe=!0,D.a.z7a(this.wb,()=>{Da();this.JAe=!1},z.g$i))}}Object(h.a)(w,"GenericEventHost",null,[]);class J extends w{constructor(ba){super(ba)}s9k(ba){this.Y7k(ba)}iRl(ba){this.WOh(ba)}jBh(ba){ba=
this.pNi(ba);for(let Da=0;Da<this.fY.count;++Da)Array.enqueue(this.fY.ga(Da).T8,ba);this.jpa(!0)}pNi(ba){const Da=new B;Da.eventType=3;Da.viewContainerVisibilityState=ba;return Da}v$i(){const ba=this.TSi();for(let Da=0;Da<this.fY.count;++Da)Array.enqueue(this.fY.ga(Da).T8,ba);this.jpa(!0)}TSi(){const ba=new B;ba.eventType=2;return ba}}Object(h.a)(J,"ViewContainerEventHost",w,[1521]);class F{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=
this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(F,"BasicEventPayload",null,[1576]);class L{constructor(ba){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=ba}}Object(h.a)(L,"CommentContextDetails",null,[]);class M{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(M,"ContextChangeWithSelectedThreadIndex",null,[1576]);class Q{constructor(){this.tasks=this.comments=null}}Object(h.a)(Q,"LoadCommentsNoVirtualization",null,[1576]);class C extends w{constructor(ba){super(ba);this.a9h=0}q8k(ba,Da,Qa,nb,Wb,Jb,Uc=0){ba=new t(ba);Jb&&Array.enqueue(ba.T8,this.$Mi(Jb,this.a9h));Jb=Da?Da.length:0;Array.enqueue(ba.T8,
this.EQf(Jb,Qa,nb,Uc,null));Jb&&Array.enqueue(ba.T8,this.rRf(Da,Wb));this.fY.add(ba);this.jpa()}y$e(ba){this.WOh(ba)}L_e(ba,Da,Qa,nb=0,Wb=null){this.vVa(this.EQf(ba,Da,Qa,nb,Wb));this.jpa()}Tll(ba,Da,Qa,nb,Wb=null){this.vVa(this.tNi(ba,Da,Qa,nb,Wb));this.jpa()}Nxh(ba,Da,Qa){this.vVa(this.wNi(ba,Da,Qa));this.jpa()}P_e(ba,Da){this.vVa(this.rRf(ba,Da));this.jpa()}selectComment(ba){this.vVa(this.YRf(ba,6));this.jpa()}highlightComment(ba){this.vVa(this.YRf(ba,7));this.jpa()}Z2a(ba,Da){this.vVa(this.PPi(ba,
Da));this.jpa()}yUk(ba,Da){this.vVa(this.$Ri(ba,Da));this.jpa()}$Mi(ba,Da=0){const Qa=new F;Qa.modelCapabilityFlags=ba;Qa.richTextCapabilityFlags=Da;return new x(12,Qa)}EQf(ba,Da,Qa,nb,Wb=null){const Jb=new F;Jb.numberOfComments=ba;Jb.numberOfThreads=Da;Jb.contextDetails=Object.assign(new L(Qa),{nextPopulatedContextDetails:nb});Jb.contextDrafts=Wb;Jb.rehydrationDrafts=null;return new x(0,Jb)}tNi(ba,Da,Qa,nb,Wb=null){const Jb=new M;Jb.numberOfComments=ba;Jb.numberOfThreads=Da;Jb.selectedThreadIndex=
Qa;Jb.contextDetails=Object.assign(new L(nb),{nextPopulatedContextDetails:0});Jb.contextDrafts=Wb;Jb.rehydrationDrafts=null;return new x(0,Jb)}wNi(ba,Da,Qa){const nb=new F;nb.comments=ba;nb.numberOfThreads=Da;nb.tasks=Qa;return new x(2,nb)}rRf(ba,Da){const Qa=new Q;Qa.comments=ba;Qa.tasks=Da;return new x(1,Qa)}YRf(ba,Da){const Qa=new F;Qa.commentId="";ba&&(Qa.commentId=ba);return new x(Da,Qa)}PPi(ba,Da){const Qa=new F;Qa.changes=[];Qa.contextDetails=Object.assign(new L(Da),{nextPopulatedContextDetails:ba});
return new x(10,Qa)}$Ri(ba,Da){const Qa=new F;Qa.commentId=ba;Qa.smartReplies=Da;return new x(15,Qa)}vVa(ba){for(let Da=0;Da<this.fY.count;++Da)Array.enqueue(this.fY.ga(Da).T8,ba)}}Object(h.a)(C,"OfficeSharedCommentsEventHost",w,[1570]);var O=d(1252);class U{constructor(){this.Muf=this.Qvf=!1;this.mbi=[]}get PQb(){return this.mbi}get Cmb(){return this.Qvf}set Cmb(ba){this.Qvf=ba;for(const Da of this.PQb)Da.Cmb=ba}get vlb(){return this.Muf}set vlb(ba){this.Muf=ba;for(const Da of this.PQb)Da.vlb=ba}YMa(ba){for(const Da of this.PQb)ba=
Da.YMa(ba);return ba}}Object(h.a)(U,"AggregateCommentTaskPersonTransformer",null,[1598]);var T=d(103);class ca{constructor(ba,Da,Qa,nb,Wb=!1){this.priority=this.completion=-1;this.type=ba;this.user=Da;this.time=Qa;this.recordId=nb;this.isLossy=Wb}}Object(h.a)(ca,"HistoryRecord",null,[]);class N{constructor(ba,Da){this.n4h=new O.a(()=>Da.YMa(ba.value))}gij(){return new Date}tDa(ba,Da,Qa){if(0===ba)throw e.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),
Error.argument("recordType");const nb=T.a.create().toString();Qa=new ca(ba,this.n4h.value,Qa,nb,!1);Qa.commentId=Da;e.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",ba);return Qa}}Object(h.a)(N,"HistoryRecordFactory",null,[1599]);class da{constructor(){this.endDate=this.startDate=null}}Object(h.a)(da,"CommentTaskSchedule",null,[]);class Y{constructor(ba,Da,Qa,nb,Wb,Jb){this.isLossy=ba;this.title=Da;this.assignees=Qa;this.schedule=nb;this.completion=Wb;this.priority=
Jb}}Object(h.a)(Y,"CommentTaskState",null,[]);class fa{constructor(){this.commentId=null}}Object(h.a)(fa,"HistoryItem",null,[]);class aa{constructor(ba,Da,Qa,nb,Wb,Jb,Uc){this.lId=!1;if(1!==Da.type)throw Error.argument("createRecord");this.PTb=Qa;this.MTb=nb;this.NTb=Wb;this.Wpf=1;this.xCc=ba;this.E5h=Jb;this._state=new Y(!1,this.PTb,Uc,new da,this.NTb,this.MTb);this._history=[];this.CRf(Da)}Rvb(ba,Da){if(1!==ba.type)throw Error.argument("createRecordTemplate");const Qa=aa.Jxj(ba,this.Wpf);this.Wpf++;
return Object.assign(new ca(Da,ba.user,ba.time,Qa),{commentId:ba.commentId})}get swg(){return this.history[this.history.length-1]}get Fig(){return this.state.completion===this.NTb}get Eig(){return this.state.priority===this.MTb}get Gig(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get Hig(){return this.state.title===this.PTb}CRf(ba){ba=Object.assign(new fa,{commentId:ba.commentId,records:[ba]});
this.history.push(ba)}Z5f(ba){let Da=-1;for(let Qa=0;Qa<this.state.assignees.length;Qa++)if(this.xCc.equals(this.state.assignees[Qa],ba)){Da=Qa;break}return Da}iwl(ba){const Da=this.swg,Qa=Da.records[Da.records.length-1];return this.xCc.equals(Qa.user,ba.user)&&Da.commentId===ba.commentId&&Qa.time.getTime()===ba.time.getTime()?!0:!1}$Vl(ba){switch(ba.type){case 2:-1===this.Z5f(ba.assignee)&&this.state.assignees.push(ba.assignee);break;case 3:const Da=this.Z5f(ba.assignee);0<=Da&&this.state.assignees.splice(Da,
1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=ba.schedule;break;case 6:this.state.completion=ba.completion;break;case 9:this.state.title=ba.title;break;case 10:this.state.priority=ba.priority;break;case 0:this.state.isLossy=!0;break;case 1:e.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.lId=!0;break;case 8:this.lId=!1;break;case -1:e.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;
default:this.state.isLossy=!0}ba.isLossy&&(this.state.isLossy=!0);this.iwl(ba)?this.swg.records.push(ba):this.CRf(ba)}get isDeleted(){return this.lId}get state(){return this._state}get history(){return this._history}Ilj(ba){if(!ba)return this.history;const Da=Array.clone(this.history),Qa=Da[0],nb=Qa.records.shift();if(!this.E5h){var Wb=this.Rvb(nb,4);Qa.records.unshift(Wb)}!ba.Fig&&this.Fig&&(Wb=this.Rvb(nb,6),Wb.completion=this.NTb,Qa.records.unshift(Wb));!ba.Eig&&this.Eig&&(Wb=this.Rvb(nb,10),Wb.priority=
this.MTb,Qa.records.unshift(Wb));!ba.Gig&&this.Gig&&(Wb=this.Rvb(nb,5),Wb.schedule=new da,Qa.records.unshift(Wb));!ba.Hig&&this.Hig&&(Wb=this.Rvb(nb,9),Wb.title=this.PTb,Qa.records.unshift(Wb));ba.isDeleted&&(ba=this.Rvb(nb,8),Qa.records.unshift(ba));return Da}static Jxj(ba,Da){return"Synthesized-"+ba.recordId+"-"+Da}}Object(h.a)(aa,"CommentTaskStateBuilder",null,[]);var ka=d(735);class H{constructor(ba,Da,Qa,nb){this.id=ba;this.commentId=Da;this.currentState=Qa;this.history=nb}}Object(h.a)(H,"CommentTaskItem",
null,[]);class ra{constructor(ba,Da="",Qa="",nb=""){this.IsCurrentUser=!1;this.UserId=ba;this.Provider=Da;this.DisplayName=Qa;this.Email=nb}}Object(h.a)(ra,"CommentTaskPerson",null,[1593]);const ha=ba=>{const Da=new ra(ba.UserId,ba.Provider,ba.DisplayName,ba.Email);Da.IsCurrentUser=ba.IsCurrentUser;return Da};var Ma=d(1053);d(285);class Ga{constructor(ba){this.extensions=ba}}Object(h.a)(Ga,"ExtensionList",null,[]);class na{static clone(ba){ba=na.bFi(ba.extensions);return new Ga(ba)}static VMf(ba){return ba?
na.clone(ba):null}static isEmpty(ba){return!ba.extensions||!ba.extensions.count}static Xa(ba){return!ba||na.isEmpty(ba)}static bFi(ba){if(!ba)return null;const Da=new Ma.a;ba.forEach((Qa,nb)=>{Da.add(Qa,nb);return!0});return Da}}Object(h.a)(na,"ExtensionListExtensions",null,[]);class wa{static clone(ba){var Da=ha(ba.user);Da=new ca(ba.type,Da,ba.time,ba.recordId,ba.isLossy);Da.commentId=ba.commentId;Da.anchorExtensionList=na.VMf(ba.anchorExtensionList);Da.recordExtensionList=na.VMf(ba.recordExtensionList);
ba.assignee&&(Da.assignee=ha(ba.assignee));if(ba.schedule){var Qa=ba.schedule;const nb=new da;nb.startDate=Qa.startDate;nb.endDate=Qa.endDate;Da.schedule=nb}Da.completion=ba.completion;Da.title=ba.title;Da.priority=ba.priority;Da.undoId=ba.undoId;return Da}}Object(h.a)(wa,"HistoryRecordExtensions",null,[]);class Fa{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd=!1){this.xCc=ba;this.zFc=Da;this.mra=Qa;this.YYh=nb;this.PTb=Wb;this.MTb=Jb;this.NTb=Uc;this.fDc=Jd}ySi(ba,Da,Qa,nb=null){if(!ba)throw e.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Da)throw e.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Qa||!Qa.length)throw e.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Qa[0].type)throw e.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Wb=[],Jb=null,Uc=this.lZk(Qa);for(var Jd of Qa)if(!Uc.contains(Jd.recordId))if(Qa=
this.Reg(Jd.commentId,nb),Qa=this.zcj(Jd,Qa),1===Qa.type){let bf=[];this.fDc&&Jb&&Jb.state&&(bf=Jb.state.assignees);Jb=new aa(this.xCc,Qa,this.PTb,this.MTb,this.NTb,this.fDc,bf);Wb.push(Jb)}else if(Jb)Jb.$Vl(Qa);else throw e.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Uc=null;Jd=[];if(Jb){Jb.isDeleted||
(Uc=Jb.state);Jb=null;for(var ne of Wb)Wb=ne.Ilj(Jb),Array.addRange(Jd,Wb),Jb=ne}ne=this.Reg(Da,nb);Uc&&(Uc.completion=this.sHi(Da,nb,Uc.completion));return new H(ba,ne,Uc,Jd)}Sbj(ba,Da,Qa,nb=null){if(!Da)throw e.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Qa&&!ba)throw e.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Wb=[],Jb=this.mra.gij();if(Qa){var Uc=this.mra.tDa(1,ba,Jb);Wb.push(Uc)}Uc=
null;if(Da.assigneeUpdate){if(!Da.assigneeUpdate.assigneesToAdd||!Da.assigneeUpdate.assigneesToRemove)throw e.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Jd=0;Jd<Da.assigneeUpdate.assigneesToAdd.length;Jd++){var ne=this.DRf(2,Da.assigneeUpdate.assigneesToAdd[Jd],ba,Jb);ne&&Wb.push(ne)}for(Jd=0;Jd<Da.assigneeUpdate.assigneesToRemove.length;Jd++)(ne=this.DRf(3,Da.assigneeUpdate.assigneesToRemove[Jd],ba,Jb))&&Wb.push(ne)}else Da.assignee&&
(Qa||(Uc=this.mra.tDa(4,ba,Jb),Wb.push(Uc)),Jd=this.mra.tDa(2,ba,Jb),Uc=this.zFc.YMa(Da.assignee),Jd.assignee=Uc,Wb.push(Jd));Da.title?(nb=this.mra.tDa(9,ba,Jb),nb.title=Da.title,Wb.push(nb)):Qa&&nb&&(Jd=this.mra.tDa(9,ba,Jb),Jd.title=this.YYh.yzj(nb,Uc),Wb.push(Jd));if(Da.schedule){if(Da.schedule.startDate>Da.schedule.endDate)throw e.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");nb=this.mra.tDa(5,ba,Jb);nb.schedule=Da.schedule;Wb.push(nb)}if(void 0!==
Da.completion&&null!==Da.completion){nb=Da.completion;if(0>nb||100<nb)throw e.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Qa||e.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",nb);Qa=this.mra.tDa(6,ba,Jb);Qa.completion=nb;Wb.push(Qa)}if(void 0!==Da.priority&&null!==Da.priority){Da=Da.priority;if(0>Da||10<Da)throw e.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");ba=this.mra.tDa(10,
ba,Jb);ba.priority=Da;Wb.push(ba)}return Wb}DRf(ba,Da,Qa,nb){if(2!==ba&&3!==ba)return e.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;ba=this.mra.tDa(ba,Qa,nb);ba.assignee=this.zFc.YMa(Da);return ba}lZk(ba){const Da=new ka.a,Qa=new ka.a;for(let nb=ba.length-1;0<=nb;nb--){const Wb=ba[nb],Jb=Qa.contains(Wb.recordId);Jb||-1!==Wb.type||(Qa.contains(Wb.undoId)?e.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Qa.add(Wb.undoId));if(Jb||-1===Wb.type)Da.contains(Wb.recordId)?e.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Da.add(Wb.recordId)}return Da}zcj(ba,Da){const Qa=wa.clone(ba);Qa.commentId=Da;Qa.user=this.zFc.YMa(ba.user);Qa.assignee=this.zFc.YMa(ba.assignee);return Qa}sHi(ba,Da,Qa){let nb=Qa;ba&&Da&&(({value:Da}=Da.vg(ba)).returnValue?(nb=Da.ResolveState?100:100===Qa?0:Qa,nb!==Qa&&e.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",ba)):e.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",ba));return nb}Reg(ba,Da){let Qa=ba;ba&&Da&&(({value:Da}=Da.vg(ba)).returnValue?Qa=Da.CommentId:(e.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",ba),Qa=ba));return Qa}}Object(h.a)(Fa,"CommentTaskTranslatorImpl",null,[932]);class pa{constructor(){this.n4a=
{};this.n4a.ops=[]}XTj(ba){const Da=this.n4a.ops;if(Da.length){var Qa=Da.length-1;const nb=Da[Qa];if(!nb.attributes){nb.insert+=ba;Da[Qa]=nb;this.n4a.ops=Da;return}}Qa={};Qa.insert=ba;Array.add(Da,Qa)}xTj(ba,Da,Qa){var nb={};nb.fullName=Da.fullName;nb.email=Da.email;nb.resolveState=Da.resolveState;Da={};Da.atmention=nb;ba=this.J3b(ba,Da);Qa&&(nb={},nb.contentId=Qa.contentId,Qa={},Qa.atmention=nb,ba.optional=Qa);Array.add(this.n4a.ops,ba)}insertImage(ba,Da){ba=this.J3b(ba,{});const Qa={};Qa.base64=
Da.base64;Da={};Da.image=Qa;ba.optional=Da;Array.add(this.n4a.ops,ba)}insertHyperLink(ba,Da){const Qa={};Qa.link=Da.link;this.tsl(Qa,Da);Array.add(this.n4a.ops,this.J3b(ba,Qa))}Jij(){return Sys.Serialization.JavaScriptSerializer.serialize(this.n4a)}J3b(ba,Da){const Qa={};Qa.insert=ba;Qa.attributes=Da;return Qa}tsl(ba,Da){this.llb(Da.weight>=pa.sAk,ba,"weight",Da.weight);this.llb(Da.italic,ba,"italic",!0);this.llb(Da.underline,ba,"underline",!0);this.llb(Da.strikethrough,ba,"strikethrough",!0);this.llb(!!Da.highlight,
ba,"highlight",Da.highlight);this.llb(!!Da.color,ba,"color",Da.color);this.llb(!!Da.paragraph,ba,"paragraph",Da.paragraph)}llb(ba,Da,Qa,nb){ba&&(Da[Qa]=nb)}static j8f(ba){return Sys.Serialization.JavaScriptSerializer.deserialize(ba,!0)}}pa.sAk=700;Object(h.a)(pa,"DeltaFormatCreator",null,[1561]);var Ea=d(538),ta=d(1197);class ia{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}yzj(ba,Da){if(!ba)throw e.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Qa=pa.j8f(ba)}catch(ne){throw e.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var nb=ba=0,Wb=0;const Jb=RegExp("\\s+","g"),Uc=new Sys.StringBuilder;for(var Jd of Qa.ops)Jd.attributes&&Jd.attributes.atmention&&Jd.attributes.atmention.email&&Da&&(Qa=Jd.attributes.atmention.email,0<Qa.length&&(Qa===Da.UserId||Qa===Da.Email||Qa===Ea.a.e$a(Da.UserId))&&(nb=ba,Wb=nb+Jd.insert.length)),Qa=Jd.insert.replace(Jb,
" "),ba+=Qa.length,Uc.append(Qa);!Wb&&Da&&e.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Da.Provider);Da=Uc.toString().trimEnd();ba=Da.length;255<ba?(Jd=(255-(Wb-nb))/2,0>nb-Jd?(ba=ta.a.instance.T$d(Da,255-this.ellipsis.length),Wb=Da.substring(0,ba)+this.ellipsis,ba="Trimmed End"):Wb+Jd>ba?(nb=ta.a.instance.tWc(Da,ba-255+this.ellipsis.length),Wb=this.ellipsis+Da.substring(nb,ba),ba="Trimmed Start"):(nb=ta.a.instance.tWc(Da,nb-Jd+this.ellipsis.length),ba=ta.a.instance.T$d(Da,
Wb+Jd-this.ellipsis.length),Wb=this.ellipsis+Da.substring(nb,ba)+this.ellipsis,ba="Trimmed Both")):(ba="No Trim",Wb=Da);e.ULS.sendTraceTag(592998804,327,50,ba);return Wb}}Object(h.a)(ia,"ContentExtractor",null,[]);class Ja{constructor(ba,Da){this.J1h=ba;this.o4h=Da;this.vlb=this.Cmb=!1}YMa(ba){if(!ba)return null;if(void 0===ba.UserId||null===ba.UserId)throw e.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(ba.IsCurrentUser||!this.J1h.equals(this.o4h.value,
ba))return ba;ba=ha(ba);ba.IsCurrentUser=!0;return ba}}Object(h.a)(Ja,"EnsureIsCurrentUserSetTransformer",null,[1598]);class ab{constructor(){this.vlb=this.Cmb=!1}YMa(ba){if(!ba)return null;if(void 0===ba.UserId||null===ba.UserId)return ba;if(!ba.Email||""===ba.Email){let Da;if(Da=Ea.a.e$a(ba.UserId))return ba=ha(ba),ba.Email=Da,ba}return ba}}Object(h.a)(ab,"RestoreEmailTransformer",null,[1598]);class Oa{constructor(){this.vlb=this.Cmb=!1}YMa(ba){if(!ba)return null;if(void 0!==ba.UserId&&null!==ba.UserId)return ba;
switch(this.Cmb?this.vlb?2:1:0){case 0:if(void 0===ba.UserId||null===ba.UserId)throw e.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");ba=ha(ba);break;case 1:if(void 0===ba.Id||null===ba.Id)throw e.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===ba.Email||null===ba.Email)throw e.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Da=Oa.Zgh(ba.Id,ba.Email,null);
if(!Da||""===Da)throw e.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Qa=n.AFrameworkApplication.fa.Ha("HostAuthType")||"";if("aad"!==Qa.toLowerCase()||Da.startsWith("S::")){if("msa"===Qa.toLowerCase())throw e.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");e.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Qa)}else throw e.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");ba=new ra(Da,"AD",ba.DisplayName,ba.Email);break;case 2:if(void 0===ba.UserPrincipalName||null===ba.UserPrincipalName)throw e.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==ba.SuggestionSubtype&&null!==ba.SuggestionSubtype)if("OrganizationUser"===ba.SuggestionSubtype)Da="AD";else throw e.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
ba.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw e.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Qa=Oa.Zgh(ba.Id,ba.UserPrincipalName,ba.AadObjectId);if(!Qa||""===Qa)throw e.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Da&&!Qa.startsWith("S::"))throw e.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
ba=new ra(Qa,Da,ba.Name,ba.UserPrincipalName);break;default:throw e.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return ba}static Zgh(ba,Da,Qa){if(!Da||""===Da)return e.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),ba;if(Qa&&""!==Qa)return"S::"+Da+"::"+Qa;if(!ba||""===ba)return e.ULS.sendTraceTag(593368217,327,50,"Missing ID"),ba;if(ba.startsWith("S::"))return ba;if(-1!==ba.indexOf("@")){Qa=ba.split("@");if(T.a.isValid(Qa[0]))return"S::"+Da+"::"+
Qa[0];e.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return ba}}Object(h.a)(Oa,"UserIdCanonicalizationTransformer",null,[1598]);class Za{constructor(ba,Da,Qa=!1,nb=!1){this.K_h=ba;this.uef=Da;this.H4h=Qa;this.fDc=nb}nNi(){const ba=new Ea.a;var Da=new O.a(Za.Thj);const Qa=new U;this.uef&&(Qa.PQb.push(new Oa),Qa.PQb.push(new ab));this.K_h&&Qa.PQb.push(new Ja(ba,Da));Qa.Cmb=this.uef;Qa.vlb=this.H4h;Da=new N(Da,Qa);const nb=new ia;return new Fa(ba,Qa,Da,nb,Za.iVi,Za.VUi,
Za.WUi,this.fDc)}static Thj(){const ba=new ra(n.AFrameworkApplication.fa.Ha("PresenceUserId")||"",n.AFrameworkApplication.fa.Ha("PresenceProvider")||"",n.AFrameworkApplication.userName||"");ba.IsCurrentUser=!0;return ba}}Za.iVi="";Za.VUi=5;Za.WUi=0;Object(h.a)(Za,"CommentTaskTranslatorFactory",null,[1592]);class Na{constructor(){this.CPd=this.Ncf=!1;this.Rrb=this.nx=this.Hkf=this.rof=this.sxf=this.Erf=this.fwf=this.iff=this.xI=this.ZYb=null}initialize(ba,Da,Qa,nb=null,Wb=null,Jb=null,Uc=null,Jd=null,
ne=null,bf=null){this.xI=ba;this.iff=Da;this.fwf=Qa;this.Erf=nb;this.sxf=Wb;this.rof=Jb;this.Hkf=Uc;this.nx=Jd;this.Ncf=!0;this.Rrb=ne;this.ZYb=bf}Fac(ba=null,Da=null){if(!this.Ncf)return e.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((Qa,nb)=>{nb(D.a.qt(-2130915313))});if(this.CPd)return e.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>
{});this.ZYb||(n.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.ZYb=appResourceLoader.loadChunk("sharedComments"):this.ZYb=this.xI.loadScript("sharedComments"));return this.ZYb.then(()=>{ba&&ba();this.CPd||(this.Rrb&&this.Rrb.execute(Qa=>{Qa.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),Da&&Da(),sharedComments.instantiate(this.iff,this.fwf,this.Erf,this.sxf,this.rof,this.Hkf,this.nx));this.CPd=!0})}}Object(h.a)(Na,"CommentActivationManager",
null,[1594]);var sa=d(7);class Sa{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(Sa,"CommentUIActionPayload",null,[]);var xb=d(261);class gc{constructor(ba,Da){this.Ca=ba;this.x3a=Da;this.CBd=new xb.a;for(let Qa of this.x3a)this.CBd.$(Qa.value.canvasActionId,Qa.key),ba=Qa.value,ba.delayActionsUntilRegistration||this.ya(ba)}ya(ba){ba.withFlags?this.Ca.ra(ba.canvasActionId,ba.canvasContextId,Object(sa.a)(this,this.u_b,"actionHandler"),97):this.Ca.ya(ba.canvasActionId,ba.canvasContextId,
Object(sa.a)(this,this.u_b,"actionHandler"))}zya(ba,Da){this.x3a.Gb(ba)&&(this.x3a.ga(ba).delayActionsUntilRegistration&&this.ya(this.x3a.ga(ba)),this.x3a.ga(ba).registeredCallback=Da)}u_b(ba,Da,Qa,nb,Wb){if(this.CBd.Gb(ba)){var Jb=this.CBd.ga(ba);if(!this.x3a.Gb(Jb))return 8;const Uc=this.x3a.ga(Jb);if(Uc.preCallback){const Jd=Uc.preCallback(ba,Da,Qa,nb,Wb);if(2!==Jd)return Jd}if(!Uc.registeredCallback)return 1===Qa?8:2;Jb=Object.assign(new Sa,{actionType:Jb});1===Qa&&(Jb.actionBehavior=1);Jb=Uc.registeredCallback(Jb);
return Uc.postCallback?Uc.postCallback(Jb,ba,Da,Qa,nb,Wb):Jb?32:8}return 2}}Object(h.a)(gc,"OfficeSharedCommentsActionHost",null,[1572]);var zc=d(354),Xb=d(37),jb=d(196);class zb{}Object(h.a)(zb,"CommentActivityData",null,[]);var Tb=d(146),Ya=d(73);class sb{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne,bf=null,sd=null){this.Cyf={["CancelCommentCreateThreadAction"]:Xb.a.gCh,["CommitComment"]:Xb.a.hCh,["CommitDraftAction"]:Xb.a.iCh,["CommitDraftCreateAction"]:Xb.a.u2e,["CommitDraftEditAction"]:Xb.a.w2e,["CommitDraftReplyAction"]:Xb.a.t2e,
["CreateReplyAction"]:Xb.a.t2e,["CreateReplyWithMentions"]:Xb.a.jCh,["CreateReplyWithTaskAssigned"]:Xb.a.kCh,["CreateThreadAction"]:Xb.a.u2e,["CreateThreadWithMentions"]:Xb.a.lCh,["CreateThreadWithTaskAssigned"]:Xb.a.mCh,["DeletePostAction"]:Xb.a.nCh,["DeleteThreadAction"]:Xb.a.oCh,["DeleteThreadWithTask"]:Xb.a.pCh,["DiscardDraftAsync"]:Xb.a.qCh,["PresentLinkToCommentAction"]:Xb.a.rCh,["ResolveThreadAction"]:Xb.a.vCh,["ResolveThreadWithTask"]:Xb.a.wCh,["ReopenThreadAction"]:Xb.a.sCh,["ReopenThreadWithTask"]:Xb.a.tCh,
["RequestInitCommentSession"]:Xb.a.uCh,["SelectCommentAction"]:Xb.a.xCh,["UpdateCommentBodyAction"]:Xb.a.w2e};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=ba;this.appVersion=Da;this.releaseAudience=Qa;this.releaseChannel=nb;this.sessionId=Wb;this.ring=Jb;this.dataCenter=Uc;this.disableUpload=Jd;this.sovereignEnvironmentName=sd;this.Ca=ne;this.Grf=bf;this.ZSj()}ZSj(){this.Ca.ya(Xb.a.gCh,
Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.hCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.iCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.t2e,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.jCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.kCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.u2e,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.lCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.mCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.nCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.oCh,
Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.pCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.qCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.rCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.vCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.wCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.sCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.tCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.uCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.xCh,Ya.a.frame,jb.ActionManager.Sg);this.Ca.ya(Xb.a.w2e,
Ya.a.frame,jb.ActionManager.Sg)}sendULSTrace(ba,Da,Qa,nb){e.ULS.sendTraceTag(ba,Da,Qa,nb)}recordActivity(ba){this.Cyf[ba]&&this.Ca.processAction(this.Cyf[ba],2)}sendOtelEvent(ba){Tb.a.sendOtelEvent(ba)}recordPerfData(ba,Da){this.Grf&&(ba=Object.assign(new zb,{durationMs:Da,name:ba}),this.Grf.Noa(ba))}}Object(h.a)(sb,"OfficeSharedCommentsTelemetry",null,[]);var oc=d(272);class wb{constructor(ba,Da,Qa,nb){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=ba;
this.appLocale=Da;this.uiCulture=Qa;this.dataCulture=nb}}Object(h.a)(wb,"LocalizationDetails",null,[]);var rc=d(254),Ka=d(67),Db=d(94);class bc{constructor(ba,Da){this.pci=ba;this.Jhf=Da}getViewContainer(){return this.pci}registerForViewContainerEvents(ba){this.Jhf.s9k(ba)}unregisterForViewContainerEvents(ba){this.Jhf.iRl(ba)}}Object(h.a)(bc,"ViewContainerProvider",null,[1520]);var Mc=d(71),mb=d(1253),Wa=d(36),db=d(29),ub=d(250),Lb=d(202),Kb=d(28),uc=d(193),Yb=d(648);class Tc{static g$f(ba){return ba===
Tc.create?0:ba===Tc.reply?1:ba===Tc.edit?2:ba===Tc.metadata?3:null}}Tc.create="CREATE";Tc.reply="REPLY";Tc.edit="EDIT";Tc.metadata="METADATA";Object(h.a)(Tc,"CommentSessionType",null,[]);class sc{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)(sc,"InitCommentSessionResult",null,[]);class Qb extends sc{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(Qb,"BeginDraftingHostResult",
sc,[]);class kb{constructor(ba,Da="",Qa="",nb="",Wb=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=ba;this.Provider=Da;this.DisplayName=Qa;this.Email=nb;this.IsCurrentUser=Wb}}Object(h.a)(kb,"OfficeSharedCommentUser",null,[]);var Ib=d(47),eb=d(55),Rb=d(144),pc=d(33);class Wc{constructor(ba,Da,Qa){this.Tq=ba;this.wkk=Da;this.zjk=Qa;this.aFg=null;this.kMg=!1}get VRa(){return this.Tq}get TC(){return this.wkk}get commentId(){return this.zjk}get W8(){return this.aFg}set W8(ba){this.aFg=
ba}get O3c(){return this.kMg}set O3c(ba){this.kMg=ba}}Object(h.a)(Wc,"ActiveCommentSession",null,[]);var Ic=d(697);class nd{static get kzk(){return 50}static Gdj(ba){return nd.ugj(ba)}static srj(ba){if(""===ba)return"";let Da=0,Qa="";try{const nb=pa.j8f(ba);for(const Wb of nb.ops)if(nd.Jua(Wb))Da||(Qa+=nd.Ikj(Wb.attributes.atmention.fullName)),Da+=1;else{const Jb=Wb.insert?Wb.insert:"";" "!==Jb&&0<Jb.length&&(Da=0,Qa+=Jb)}}catch(nb){e.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Qa}static ugj(ba){ba=
nd.srj(ba);return 0<ba.length&&ba.split(" ").length<=nd.kzk?ba:null}static Ikj(ba){let Da="";ba&&(ba=ba.split(" "),0<ba.length&&(Da=ba[0]));return Da}static Jua(ba){return!!ba.attributes&&!!ba.attributes.atmention}}Object(h.a)(nd,"BaseCommentSmartReplyHelpers",null,[]);class ob{constructor(ba){this.swe=ba}yXl(ba,Da,Qa,nb){-1===Qa||Da||(Da=nb[Qa],Qa=Da.author?Da.author.IsCurrentUser:!1,Da&&Da.commentBody&&!Qa&&(Da=nd.Gdj(Da.commentBody))&&this.swe.invoke(ba,Da))}}Object(h.a)(ob,"CommentSmartReplyHelpers",
null,[]);var $b=d(56),Hc=d(75),Pb=d(34),Yc=d(90),Rd=d(91),Gb=d(51);class Bb{constructor(){this.wFd=this.mQd=this.LPa=null;this.Dig=!1;this.pxd=this.qxd=this.endPos=this.startPos=0}get paragraphs(){return this.LPa}get uV(){return this.mQd}set uV(ba){this.mQd=ba;this.LPa=[];this.LPa.push(this.mQd)}get a4(){return this.wFd}set a4(ba){this.wFd=ba;this.LPa&&this.Pcc&&this.LPa.push(this.wFd)}M5i(){for(const ba of this.LPa){const Da=Object(mb.a)(5,ba);if(Da&&-1!==Da.ryb().indexOf("\ufffc"))return!0}return!1}Pug(ba){const Da=
(this.pxd&4294967295)>>>0;ba.TextBodyLength!==this.qxd||Da===ba.TextBodyHash||Bb.bwh.contains(this.pxd)||(Bb.bwh.add(this.pxd),Kb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.M5i()));return ba.TextBodyLength===this.qxd}get Inh(){let ba=0;if(this.isValid)if(this.Pcc){ba+=Pb.ParagraphReader.textLength(this.uV)-this.startPos;ba+=this.endPos;for(let Da=1;Da<this.paragraphs.length-1;Da++){const Qa=this.paragraphs[Da];Qa&&
(ba+=Pb.ParagraphReader.textLength(Qa)+1)}}else ba=this.endPos-this.startPos;return ba}get LMa(){if(!this.isValid)return Yc.a.auto;var ba=Gb.a.Oj(this.uV,this.startPos+1);if(!ba)return Yc.a.auto;ba=Rd.a.Es(ba);return ba?(ba=ba.cache)&&ba.w4?ba.fontColor:Yc.a.auto:Yc.a.auto}get isValid(){return!!this.uV&&!!this.a4&&!!this.paragraphs}get Pcc(){return!this.uV.equals(this.a4)}Xfi(ba){this.LPa&&ba&&this.LPa.push(ba)}aVj(){if(this.isValid&&(this.uV.Kv(16,!0),this.Pcc))for(let ba=1;ba<this.paragraphs.length;ba++){const Da=
this.paragraphs[ba];Da&&Da.Kv(16,!0)}}JYj(ba,Da){if(!this.isValid)return!1;const Qa=Object(mb.a)(Hc.AParagraphNode,ba.node),nb=Object(mb.a)(Hc.AParagraphNode,Da.node);return!(Qa&&nb&&Array.contains(this.paragraphs,Qa)&&Array.contains(this.paragraphs,nb))||Qa.equals(this.uV)&&(0>ba.Ra||ba.Ra<this.startPos)||nb.equals(this.a4)&&(0>Da.Lb||Da.Lb>this.endPos)?!1:!0}z8f(ba){let Da=3;ba&&(!this.Pcc&&this.uV.equals(ba)?Da=2:this.uV.equals(ba)?Da=0:this.a4.equals(ba)&&(Da=1));return Da}}Bb.bwh=new ka.a;Object(h.a)(Bb,
"TextAnchorParagraphInfo",null,[]);class dc{static mxb(ba,Da){return ba||Da?ba&&Da?ba.commentId===Da.commentId:!1:!0}static USc(ba){return!!ba.Children&&0<ba.Children.length}static Kqj(ba,Da){ba=ba.ryb()+"\r";for(let Qa=0;Qa<ba.length;Qa++){let nb=ba.charCodeAt(Qa);160===nb&&(nb=32);Da=(Da<<5>>>0)+Da+nb}return Da}static bO(ba){return!!ba&&!!ba.textAnchoringInfo&&ba.textAnchoringInfo.EndPos>ba.textAnchoringInfo.StartPos&&0<ba.textAnchoringInfo.TextBodyLength}static l9b(ba,Da){if(!dc.bO(ba))return null;
if(!Da||1>Da.vy().length)return Kb.a.J(509220243,805,Da?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!Da),null;let Qa=null,nb=null,Wb=null;ba.textAnchoringInfo.AnchoringShape&&(ba.textAnchoringInfo.AnchoringShape.TableCell?(Qa=T.a.Kf(ba.textAnchoringInfo.AnchoringShape.TableCell.RowId),nb=T.a.Kf(ba.textAnchoringInfo.AnchoringShape.TableCell.ColId)):ba.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Wb=ba.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
Wb.startsWith("{")||(Wb="{"+Wb),Wb.endsWith("}")||(Wb+="}")));let Jb=ba.textAnchoringInfo.StartPos;ba=ba.textAnchoringInfo.EndPos;let Uc=0,Jd=0;const ne=new Bb;Da=Da.vy();for(let sd=0;sd<Da.length;sd++){const vd=Da[sd],$c=Pb.ParagraphReader.textLength(Object(mb.a)(Hc.AParagraphNode,vd));if(Qa&&nb){var bf=vd.GL();if(!bf||!Qa.equals(bf.rowId)||!nb.equals(bf.cellId))continue}else if(Wb&&(!vd.get_smartArtModelId()||Wb!==vd.get_smartArtModelId()))continue;if(!ne.isValid&&($c>Jb||ne.uV)){if(!ne.uV&&(ne.uV=
Object(mb.a)(Hc.AParagraphNode,vd),ne.startPos=Jb,!ne.uV))return null;bf=sd===Da.length-1||!!Wb&&dc.V2j(Wb,Da[sd+1])||!!Qa&&!!nb&&dc.U2j(Qa,nb,Da[sd+1]);bf=$c<ba&&0<$c&&bf;if(($c>=ba||bf)&&!ne.a4){if(bf&&(ba=$c),ne.a4=Object(mb.a)(Hc.AParagraphNode,vd),ne.endPos=ba,!ne.a4)return null}else vd.equals(ne.uV)||ne.Xfi(Object(mb.a)(Hc.AParagraphNode,vd))}Uc+=$c+1;Jd=dc.Kqj(vd,Jd);ne.uV||(Jb-=$c+1);ba-=$c+1}ne.qxd=Uc;ne.pxd=Jd;return ne}static V2j(ba,Da){return Da.get_smartArtModelId()&&Da.get_smartArtModelId()===
ba?!1:!0}static U2j(ba,Da,Qa){return(Qa=Qa.GL())&&ba.equals(Qa.rowId)&&Da.equals(Qa.cellId)?!1:!0}static myj(ba,Da,Qa,nb){Qa=nb=-1;if(!ba)return Kb.a.J(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,tMa:Qa,eEa:nb};let Wb=Object(mb.a)(5,Da.Ua.node);const Jb=Object(mb.a)(5,Da.jf.node);if(!Wb||!Jb)return Kb.a.J(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!Wb,!Jb),{returnValue:null,tMa:Qa,eEa:nb};const Uc=Da.Ua.CQa,Jd=Da.jf.Isb;var ne=Pb.ParagraphReader.textLength(Da.Ua.node);Da=Pb.ParagraphReader.textLength(Da.jf.node);if(0>Uc||0>=Jd||Uc===Jd&&Wb===Jb||Uc>ne||Jd>Da)return Kb.a.J(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",Uc,Jd,ne,Da),{returnValue:null,tMa:Qa,eEa:nb};ba=ba.vy();if(!ba)return Kb.a.J(509220239,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,tMa:Qa,eEa:nb};ne=0;for(const bf of ba){if(Jb.get_smartArtModelId()){if(bf.get_smartArtModelId()!==Jb.get_smartArtModelId())continue;Wb.get_smartArtModelId()!==Jb.get_smartArtModelId()&&(Wb=bf)}if(Jb.Ks()){if(bf.GL()!==Jb.GL())continue;Wb.GL()!==Jb.GL()&&(Wb=bf)}Wb===bf&&(Qa=Uc+ne);Jb===bf&&(nb=Jd+ne);if(0<=Qa&&0<=nb)return{returnValue:Wb,tMa:Qa,eEa:nb};ne+=bf.ryb().length+1}0<=
Qa&&-1===nb&&(Wb.get_smartArtModelId()||Wb.Ks())&&(nb=ne-1);return{returnValue:Wb,tMa:Qa,eEa:nb}}static get ILc(){return $b.a.mg||$b.a.VVa}static get YSc(){return!$b.a.Yi}}Object(h.a)(dc,"CommentUtilities",null,[]);const Xc=(ba,Da)=>{var Qa,nb;if(null===ba||void 0===ba||!ba.ReactionList)return ba;for(const Wb in ba.ReactionList)ba.ReactionList[Wb].ReactionInstances=null===(nb=null===(Qa=ba.ReactionList[Wb])||void 0===Qa?void 0:Qa.ReactionInstances)||void 0===nb?void 0:nb.filter(Jb=>Jb.User.UserId!=
Da.UserId);ba.ReactionList=ba.ReactionList.filter(Wb=>0!=Wb.ReactionInstances.length);0==ba.ReactionList.length&&(ba.ReactionList=void 0);return ba},Fb=ba=>ba.ka("PPTOCommentReactionsUIEnabled");class kd{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne,bf,sd,vd,$c,hd,Dd,Re){this.$bd=!1;this.kb=ba;this.jIa=Da;this.Lxe=Qa;this.gik=nb;this.wb=Wb;this.Ib=Jb;this.Zfd=Uc;this.Fjk=Jd;this.Awa=ne;this.swe=sd;this.Tkk=vd;this.Uva=$c;this.Rcd=hd;this.xjk=Dd;this.ia=Re}beginDraftingAsync(ba){if(!ba)return new Promise((Qa,
nb)=>{nb(D.a.qt(-2130915327))});const Da=Tc.g$f(ba.sessionType);return void 0===Da||null===Da?new Promise((Qa,nb)=>{nb(D.a.qt(-2130915317))}):2===Da&&ba.commentId===kd.GIb?new Promise((Qa,nb)=>{nb(D.a.qt(-2130915324))}):new Promise((Qa,nb)=>{D.a.z7a(this.wb,()=>{var Wb=this.kb.ade(),Jb=null;let Uc=-1;Kb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",Da);try{switch(Da){case 0:if(this.Rcd)try{Uc=this.kb.a$f(!0)}catch(sd){Kb.a.J(512496832,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",
sd),Uc=Wb.length}else Uc=Wb.length;Jb=new Wc(Da,ba,"");this.$bd=!0;break;case 1:if(!ba.threadId||!ba.threadId.length)throw D.a.qt(-2130915324);Uc=kd.omj(Wb,ba.threadId);if(-1===Uc)throw D.a.qt(-2130915323);if(this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Jd=ba.threadId;(new ob(this.swe)).yXl(Jd,kd.DKj(Wb,Jd),kd.Xbe(Wb,Jd),Wb)}Jb=new Wc(Da,ba,ba.threadId);break;case 2:if(!ba.commentId||!ba.commentId.length)throw D.a.qt(-2130915324);Uc=kd.Xbe(Wb,ba.commentId);
if(-1===Uc)throw D.a.qt(-2130915323);Jb=new Wc(Da,ba,ba.commentId);break;case 3:Uc=kd.Xbe(Wb,ba.threadId);Jb=new Wc(Da,ba,ba.threadId);break;default:throw D.a.qt(-2130915322);}if(!Jb)throw D.a.qt(-2130915322);var ne=this.kb.aQj(Jb);if(ne)throw ne;}catch(sd){nb(sd);return}Wb=new Qb;Jb=this.Ib.Ha("UserName");ne=this.Ib.Ha("387");Jd=this.Ib.Ha("388");const bf=pc.a("PPTPlumbEmailThroughCG")?Ea.a.e$a(ne||""):"";ne=new kb(ne,Jd,Jb,bf,!0);Wb.author=ne;Wb.insertIndex=Uc;Wb.authorName=Jb;Wb.authorIdentity=
new String;Qa(Wb)})})}commit(ba,Da,Qa){if(!this.kb.OPc)throw Kb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.kb.IGi),D.a.qt(-2130915320);var nb=this.kb.OPc.TC;if(!nb)throw Kb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),D.a.qt(-2130915320);const Wb=Tc.g$f(nb.sessionType);if(void 0===Wb||null===Wb)throw D.a.qt(-2130915317);if(ba!==nb.draftId)throw D.a.qt(-2130915327);const Jb=this.Uva?Rb.e(T.a.create().toString()):
"";this.kb.NVf();switch(Wb){case 0:return Kb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",Jb),nb={},this.kb.Tdl(Jb),nb.commentId=Jb,this.$bd=!1,this.kb.X7g=Jb,kd.DMh(Qa),kd.CMh(),this.createComment(Da,nb,Qa);case 1:return Kb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",nb.threadId,Jb),ba={},ba.parentId=nb.threadId,ba.commentId=Jb,kd.DMh(Qa),kd.CMh(),this.createComment(Da,ba,Qa);case 2:return Kb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",nb.commentId),
Qa={},Qa.commentBody=Da,this.jSl(nb.commentId,Qa),ba;case 3:return Kb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",nb.threadId),Fb(this.Ib)?this.kSl(nb.threadId,Qa):this.FPh(nb.threadId,Qa),nb.threadId;default:throw D.a.qt(-2130915322);}}endCommentSession(ba){Kb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",ba);this.kb.endCommentSession(ba,this.$bd?9:1);this.$bd=!1}createComment(ba,Da,Qa){const nb=this.Zfd.myd(ba,new Date);let Wb="";this.Uva&&(Wb=Ib.a.Xa(Da.commentId)?
T.a.create().toString():Da.commentId);let Jb=null;void 0!==Qa&&null!==Qa&&(Jb=this.Zfd.RMl(Wb,Qa.Task,ba));ba=this.kb.Asd;if(Qa=Da.parentId?null:this.kb.nyj())ba=this.kb.wll;this.jIa.lei(Wb,nb.plainText,Da.parentId,ba,this.kb.anchorNode,nb.T7g,Jb,Qa);return Ib.a.Xa(Wb)?kd.GIb:Wb}deleteComment(ba){if(ba===kd.GIb)throw D.a.qt(-2130915327);Kb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",ba);this.jIa.deleteComment(ba)}selectComment(ba){ba!==kd.GIb&&this.kb.Jga(ba,0,!1)}highlightComment(ba){ba!==
kd.GIb&&this.kb.kdi(ba)}EPh(ba,Da,Qa){const nb=Array.clone(this.kb.ade());var Wb=null;for(var Jb of nb)if(Jb.commentId===ba){Wb=Jb;break}if(!Wb)throw Kb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),D.a.qt(-2130915323);(Jb=n.AFrameworkApplication.userName)&&0<Jb.length&&Jb!==Wb.author.DisplayName&&Kb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",n.AFrameworkApplication.Mnb||n.AFrameworkApplication.dR);Jb=new Date;
Wb=this.Zfd.myd(Wb.commentBody,null).plainText;Da=this.Zfd.myd(Da.commentBody,Jb);this.jIa.E_i(Da.plainText,ba,Da.T7g);Qa||Wb!==Da.plainText||this.Lxe.Nxh(nb,this.kb.$8g,Array.clone(this.kb.Oag()))}jSl(ba,Da){if(ba===kd.GIb)throw D.a.qt(-2130915327);Da.commentBody&&(this.Ib.ka("896")?this.EPh(ba,Da,!0):D.a.z7a(this.wb,()=>{this.EPh(ba,Da,!1)}))}kSl(ba,Da){if(!((null===Da||void 0===Da?0:Da.Resolve)||(null===Da||void 0===Da?0:Da.Reaction)))throw D.a.qt(-2130915327);(null===Da||void 0===Da?0:Da.Resolve)&&
this.FPh(ba,Da);(null===Da||void 0===Da?0:Da.Reaction)&&this.mSl(ba,Da)}FPh(ba,Da){if(void 0===Da.Resolve||null===Da.Resolve)throw D.a.qt(-2130915327);const Qa=Da.Resolve.isResolved;let nb=Qa?100:0;void 0!==Da.Task&&null!==Da.Task&&(nb=Da.Task.completion);this.jIa.GPh(ba,Qa?1:0,nb);Qa&&this.kb.yol()}mSl(ba,Da){if(Fb(this.Ib)){if(null==(null===Da||void 0===Da?void 0:Da.Reaction))throw D.a.qt(-2130915327);a:{switch(Da.Reaction.reactionType){case 1:var Qa="\ud83d\udc4d";break a;default:Kb.a.J(509220244,
805,50,"Unsupported reaction type")}Qa=void 0}void 0!==Qa&&(this.jIa.nSl(ba,Qa,Da.Reaction.isActive),this.kb.$Fk())}}setThreadResolvedState(ba,Da){this.jIa.GPh(ba,Da?1:0,Da?100:0);Da&&this.kb.UUf(ba)}selectFirstThreadInNextCommentContext(){this.kb.fll()}selectLastThreadInPreviousCommentContext(){this.kb.ill()}presentLinkToComment(ba){if(ba=this.jIa.awj(ba)){ba=JSON.stringify({["sId"]:ba.sid,["cId"]:ba.cid});var Da={};Da.nav=Ic.a(ba);Da.mode="copy";Kb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",
ba);this.ia.Ja(Xb.a.Jda,2,Da)}else Kb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(ba){this.xjk.Roj().then(Da=>{this.Lxe.q8k(ba,this.kb.ade(),this.kb.$8g,this.kb.isReadOnly,this.kb.Oag(),Da,this.Fjk.j5c)})}unregisterForCommentEvents(ba){this.Lxe.y$e(ba)}registerForAction(ba,Da){this.gik.zya(ba,Da);this.kb.E6k()}unregisterForAction(){}loadThreads(){Kb.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(ba=>{n.AFrameworkApplication.fa.$e(()=>
{this.Awa?this.Awa.atMentionsEnabledAsync().then(Da=>{ba(Da);return null}):ba(!1)})})}resolveSupported(){return this.Tkk}static omj(ba,Da){let Qa=!1;for(let nb=0;nb<ba.length;nb++){if(Qa&&ba[nb].commentId!==Da&&ba[nb].parentId!==Da)return nb;ba[nb].commentId===Da&&(Qa=!0)}return Qa?ba.length:-1}static DKj(ba,Da){let Qa=!1;for(let nb=0;nb<ba.length;nb++)if(ba[nb].commentId===Da&&(Qa=!0),Qa&&ba[nb].parentId===Da)return!0;return!1}static Xbe(ba,Da){for(let Qa=0;Qa<ba.length;Qa++)if(ba[Qa].commentId===
Da)return Qa;return-1}static CMh(){if(pc.a("CommentsFpsIsEnabled"))try{const ba=eb.a.instance.Ia("Common.ISystemInitiatedFeedback");ba&&ba.execute(Da=>{Da.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(ba){Kb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",ba)}}static DMh(ba){if(pc.a("CommentsTasksFpsIsEnabled")&&ba&&ba.Task)try{const Da=eb.a.instance.Ia("Common.ISystemInitiatedFeedback");Da&&Da.execute(Qa=>{Qa.logActivity("PPTWebCommitTaskActivity",
"CommentsTasksFpsIsEnabledBRS")})}catch(Da){Kb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",Da)}}}kd.GIb="temp-id";Object(h.a)(kd,"CommentAPI",null,[1001,1002]);var od=d(199),Gd=d(317),Fd=d(705);class ee{constructor(ba,Da,Qa){this.woc=ba;this.commentId=Da;this.state=Qa}}Object(h.a)(ee,"CommentTextAnchorToHighlight",null,[]);class Bf extends Sys.EventArgs{constructor(ba){super();this.xvl=ba}}Object(h.a)(Bf,"CommentsVisibilityOnSmartArtChangeEventArgs",
Sys.EventArgs,[]);class be{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne,bf){this.p0g=[];this.Ugd=null;this.Mud=!1;if(!bf)throw Error.argumentNull("viewElementEventNotifier");this.Kc=Da;this.vHe=this.Ckc=!1;this.E7c=ba;this.Utk=Qa;this.jeb=this.wXa=null;this.xl=nb;this.pa=Wb;this.gXa=Jb;this.dHa=Uc;this.hfa=Jd;this.Ajk=ne;this.$J=bf;this.hfa.kWe(this.Ajk)}get RW(){return this.wXa&&this.wXa.isConnected?this.wXa:null}get cGh(){return this.Ckc}Etc(ba,Da,Qa=!1,nb=!1){const Wb=this.Utk.dJ(ba);if(Wb)switch(Da){case 0:Wb.display(Qa,
nb);this.wXa=ba;break;case 1:Wb.activate();this.jeb=ba;break;case 2:Wb.dismiss();this.wXa=null;break;case 3:this.RW&&this.RW===ba&&this.g9a&&this.$7d(this.g9a,ba)?Wb.display(dc.bO(this.g9a),nb):Wb.dismiss();this.jeb=null;break;case 4:Wb.rYi(Qa),this.wXa=ba}}Xtd(ba){if(this.Kc&&this.Kc.Hc)switch(ba){case 0:this.Kc.Hc.highlight();this.Ckc=!0;break;case 2:this.Kc.Hc.KOh();this.Ckc=!1;break;case 1:this.Kc.Hc.highlight();this.vHe=!0;break;case 3:this.Kc.Hc.KOh(),this.vHe=!1}}yQc(){this.E7c&&(this.Ckc?
this.Xtd(2):this.RW&&this.Etc(this.RW,2),this.pwb(null))}$7d(ba,Da){if(!dc.bO(ba))return!0;ba=this.xl.qz();return od.a.any(ba,Qa=>!dc.bO(Qa)&&Qa.anchorShape===Da.get_shapeId())}u_e(ba,Da,Qa,nb=!1,Wb=!1){if(this.E7c&&ba&&(!nb||be.Bwb(this.xl.qz(),ba))){nb=this.a9(ba);var Jb=this.RW!==nb&&!!this.RW;Jb&&this.pa.O8(this.RW);this.yQc();if(nb){const Uc=dc.bO(ba);this.jeb===nb?this.$7d(ba,nb)?this.Etc(nb,4,Uc,Uc&&Jb):this.wXa=nb:this.$7d(ba,nb)?this.Etc(nb,0,Uc,Qa&&Jb):this.wXa=nb;Da=!!Da&&Da===ba.commentId;
(Uc||Da)&&Wb||this.Rll(nb,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,ba.authorName,ba.dt.toDateString(),ba.dt.toLocaleTimeString()))}else this.Xtd(0),this.Kc&&this.Kc.Hc&&this.Kc.Hc.$c&&this.Hsd(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Kc.Hc.$c.qe+1).toString(),this.Kc.Hc.$c.title));!Wb&&Jb&&this.pa.selectShape(this.RW,!0,!1);this.pwb(null)}}jdi(ba){if(this.E7c){var Da=this.a9(ba);Da?dc.bO(ba)?this.jeb=Da:this.Etc(Da,1):this.Xtd(1);this.pwb(ba)}}aQc(){this.jeb&&
this.Etc(this.jeb,3);this.vHe&&!this.Ckc&&this.Xtd(3);this.pwb(null)}a9(ba){if(!ba)return null;try{return this.dHa.UUc(ba)}catch(Da){return Kb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",Da),null}}pwb(ba){const Da=[];var Qa=this.jeb;ba&&!Qa&&(Qa=this.RW);const nb=this.RW?this.RW:this.pa.Ll();nb||ba&&Qa||this.BMh(Da);let Wb=null;const Jb=[];var Uc=!1;if(dc.bO(ba)&&Qa&&0<Qa.vy().length&&(!this.g9a||ba.commentId!==this.g9a.commentId)){var Jd=dc.l9b(ba,
Qa);Jd&&Jd.isValid&&(Uc=Gd.a.Kf("{"+ba.commentId+"}{1}"),Da.push(new ee(Jd,Uc,1)),Uc=!0,Qa=this.dHa.rk(Qa))&&(Jb.push(Qa),(Qa=Qa.shapeNode)&&Qa.Wf&&(Wb=Qa))}if(this.Mud||nb&&0<nb.vy().length)if(Qa=this.xl.qz())for(var ne of Qa){if(!dc.bO(ne)||!this.Mud&&ne.anchorShape!==nb.get_shapeId()||Uc&&ne.commentId===ba.commentId)continue;Jd=this.Mud?this.a9(ne):nb;if(!Jd)continue;let bf=dc.l9b(ne,Jd);if(!bf||!bf.isValid)continue;let sd=5;(Qa=!!this.g9a&&ne.commentId===this.g9a.commentId)&&(sd=0);const vd=Gd.a.Kf("{"+
ne.commentId+"}{1}");Da.push(new ee(bf,vd,sd));if(Jd=this.dHa.rk(Jd))Jb.push(Jd),Jd=Jd.shapeNode,!Wb&&Jd&&Qa&&Jd.Wf&&(Wb=Jd)}for(const bf of this.p0g)!bf||Array.contains(Jb,bf)||bf.shapeNode&&bf.shapeNode.Wf||(bf.Uoe=!1,bf.iq||!bf.lo||bf.yy||bf.$Pb());ba=null;for(const bf of Jb)(ne=bf.shapeNode)&&ne.Wf?(ba||(ba=ne),Wb||nb!==ne||(Wb=ne)):(bf.Uoe=!0,bf.lo||(Kb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),bf.Jwd()));Wb||this.pa.dM()||
!ba||(Wb=ba);this.p0g=Jb;this.$J.Z0k(new Bf(Wb));this.BMh(Da)}BMh(ba){ba=Object.assign(new Fd.a,{action:0,type:0,kea:ba,xjb:this.hfa.ndb?this.hfa.ndb.kea:null});this.hfa.otd(ba)}Hsd(ba){this.gXa.yga(ba)}Rll(ba,Da){this.gXa.Znh(ba,Da)}p0e(ba){this.E7c=ba}get g9a(){return this.Ugd&&this.Ugd.yNb?this.Ugd.yNb.comment:null}static Bwb(ba,Da){if(ba)for(const Qa of ba)if(Da.commentId===Qa.commentId)return!0;return!1}}Object(h.a)(be,"CommentAnchoringHighlightsHelper",null,[]);var af=d(43);class Ue{constructor(ba,
Da,Qa,nb,Wb,Jb,Uc){this.ic=ba;this.ua=Da;this.s9c=Qa;this.GO=nb;this.buk=Wb;this.Rb=Jb;this.wb=Uc;this.pnf=0}Z2a(ba,Da){if(ba||1!==this.j5c)if(2>this.ic.rj())this.qdi?this.$0e(5):this.$0e(1);else{const Qa=af.a.Jj("UpdateNextPopulatedContextDetails",2);this.s9c.S8d((nb,Wb,Jb)=>{this.pHk(nb,Wb,Jb,Qa,Da)},Qa)}}get j5c(){return this.pnf}pHk(ba,Da,Qa,nb,Wb){let Jb=1;if(this.ua.Ba){const Uc=this.ua.Ba.qe;let Jd=!1,ne=!1,bf=!1;Da&&ba&&(ba=ba.qe,ba<Uc?Jd=!0:ba===Uc?ne=!0:(bf=!0,Qa||(Jd=!0)));0<=Wb&&(Wb<Uc?
Jd=!0:Wb===Uc?ne=!0:bf=!0);bf?Jb=Jd||ne?3:2:Jd?Jb=4:ne&&(Jb=5)}this.$0e(Jb);nb.finish();D.a.z7a(this.wb,()=>{this.Rb.updateCommandUI()})}$0e(ba){this.pnf=ba;this.buk.Z2a(ba,1===this.Rb.mode)}get qdi(){return!!this.ua.Ba&&this.GO.EZi(this.ua.Ba)}}Object(h.a)(Ue,"CommentContextDetailsUpdateHelper",null,[934]);var qf=d(39);class Xa{zol(ba){if(null===ba)throw Error.argumentNull("comment");ba.setValue(qf.a.commentId,"")}vol(ba,Da){if(null===ba)throw Error.argumentNull("comment");ba.setValue(qf.a.y_d,Da)}xol(ba){if(null===
ba)throw Error.argumentNull("comment");if(ba=Object(mb.a)(555,ba))ba.mvb=ResourceStrings.anonymousCommentAuthor}hOb(ba){if(null===ba)throw Error.argumentNull("comment");ba.setValue(qf.a.P2b,!0)}Pyh(ba,Da,Qa,nb){if(null===ba)throw Error.argumentNull("comment");if(ba=Object(mb.a)(555,ba))ba.authorName=Da,ba.Q0b=Qa,ba.nLc=nb}Bol(ba,Da){if(null===ba)throw Error.argumentNull("comment");ba.setValue(qf.a.Q2b,Da)}Aol(ba,Da){if(!ba)throw Error.argumentNull("comment");Da=Wa.c(Da);ba.setValue(qf.a.reactions,
Da)}}Object(h.a)(Xa,"CommentEditor",null,[973]);var vb=d(32),cc=d(84),wc=d(59);class Ad{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(Ad,"Comment",null,[]);var Md=d(295),Sd=d(918),Le=d(281),fe=d(30);class Vf{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne,bf,sd,vd,$c,hd,Dd){this.Qea=null;this.EDb=
nb;this.Fb=Wb;this.ua=Jb;this.KB=Uc;this.h$=Jd;this.Ib=ne;this.Tb=bf;this.pa=sd;this.zE=vd;this.Uwe=$c;this.lc=hd;this.GR=Dd;this.LR=ba;this.yjk=Qa;this.Skk=0===Da;this.iPh();this.Kte()}dispose(){}get userName(){return this.Ib.appSettings.UserName}get userId(){return this.Ib.appSettings["387"]}get providerId(){return this.Ib.appSettings["388"]}get isTasksHistoryEnabled(){return this.Ib.ka("TasksHistoryEnabled")}get Yac(){return this.Ib.ka("PPTOBlueDotsForComments")}get Hrg(){return pc.a("Comments.LogTasksTelemetry")}get pEa(){return this.Ib.ka("SlideResizePerfImprovementEnabled")}addComment(ba,
Da,Qa){this.Tyf("",ba,Da,Qa,null,null,null,null)}lei(ba,Da,Qa,nb,Wb,Jb,Uc,Jd){this.Tyf(ba,Da,Qa,nb,Wb,Jb,Uc,Jd)}Tyf(ba,Da,Qa,nb,Wb,Jb,Uc,Jd){const ne=this.LR.Ii("UserAction","AddComment");n.AFrameworkApplication.fa.fU?this.Vyf(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne):this.Ib.$e(()=>{this.Vyf(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne)})}Vyf(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne){this.yjk.Nvb().then(bf=>{Vf.Rvh&&(Kb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.Skk,bf),this.zE.Iek(bf),
Vf.Rvh=!1);this.kei(ba,Da,Qa,nb,Wb,Jb,Uc,Jd);ne&&ne.stop();return bf}).catch(bf=>{Kb.a.J(512262930,805,10,JSON.stringify(bf));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}kei(ba,Da,Qa,nb,Wb,Jb,Uc,Jd){if(this.YAb()){var ne=!1,bf=0,sd=0;nb&&(ne=!0,bf=nb.x,sd=nb.y);nb=this.Fb.ke(15);try{var vd=this.Qea;nb.jc(vd);const $c=vb.GraphIterator.pb(vd),hd=Object(mb.a)(cc.a,this.EDb.createInstance(1074135127));this.h$.hOb(hd);this.h$.zol(hd);this.h$.vol(hd,ba);vd=
null;const Dd=Object(mb.a)(555,hd);if(Dd){if(Dd.ovb=ne)Dd.gda=Object.assign(new Sd.a,{X:bf,Y:sd});Dd.pLh=this.Uwe.Yyj();Dd.iLc=Jb;if(vd=Object(mb.a)(4,Wb))Dd.M2b=vd.get_shapeId();Qa&&(Dd.bya=Qa);Uc&&(Dd.taskInfo=Uc);Jd&&(Dd.textAnchoringInfo=Jd);Dd.Hsa=Da}let Re=this.userId;Wb=!Re;const ml=!this.providerId,Mh=!this.userName;(Wb||ml)&&Kb.a.J(512262928,805,Wb&&!ml?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Wb,ml,Mh);pc.a("Comments.UseNameInPlaceOfUserId")&&Wb&&
!ml&&(Re=Mh?ResourceStrings.anonymousCommentAuthor:this.userName);this.h$.Pyh(hd,this.userName,Re,this.providerId);Mh&&this.h$.xol(hd);$c.Gl(hd,1);Kb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",ba,!!Uc,!!Jd,!!vd)}finally{nb&&nb.dispose()}this.$dk(ba,Qa,Da,Jd,Uc)}else Kb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}$dk(ba,Da,
Qa,nb,Wb){this.Hrg?Da?(Da=this.Xta(Da))?(Da=this.Sta(Da))?this.zE.aek(ba,Qa.length-1,!!nb,Da.taskInfo,Wb):Kb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Kb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.zE.bek(ba,Qa.length-1,!!nb,!!Wb):this.zE.Hte(ba,Qa.length-1,!!nb,!!Wb)}deleteComment(ba){this.zE.Tgk();if(this.YAb()){var Da=this.Fb.yd(15);try{Da.jc(this.Qea),this.i4d(ba,this.Qea),
Da.gd=fe.a.deleteComment}finally{Da&&Da.dispose()}}else Kb.a.J(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}i4d(ba,Da){pc.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.pa.i0()&&(Kb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.pa.nh());const Qa=this.rgj(ba,Da);if(Qa&&0<Qa.count){this.h$.hOb(Da);for(let nb of Qa)Da=vb.GraphIterator.pb(nb),Da.rc(39),Da.Qi();Kb.a.J(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",ba)}else Kb.a.J(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",ba);this.zE.V5k()}ASa(){const ba=Date.now();this.zE.Mek();const Da=this.qz();if(Da){var Qa=this.Fb.yd(15);try{Qa.jc(this.ua.Ba);for(const nb of Da)this.i4d(nb.commentId,this.Qea);Qa.gd=fe.a.ASa}finally{Qa&&Qa.dispose()}Kb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-ba)}else Kb.a.J(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}B4b(ba){const Da=Date.now();ba?this.zE.Nek():this.zE.Lek();const Qa=this.ua.presentation;if(Qa){var nb=Qa.slides;if(nb){var Wb=this.Fb.yd(15);try{Wb.jc(Qa);for(const Jb of nb){const Uc=Object(mb.a)(116,Jb);if(!Uc||!Uc.nE()){Kb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",Uc);continue}const Jd=vb.GraphIterator.pb(Uc).Db(16);for(const ne of this.Tta(Uc.nE()))(ba?
1===ne.status:1)&&this.i4d(ne.commentId,Jd)}Wb.gd=ba?fe.a.jwb:fe.a.iwb}finally{Wb&&Wb.dispose()}Kb.a.J(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-Da,ba)}}}editComment(ba,Da){this.zXf(ba,Da,null)}E_i(ba,Da,Qa){this.zXf(ba,Da,Qa)}zXf(ba,Da,Qa){if(this.YAb()){var nb=this.Xta(Da);if(nb){const Wb=this.Fb.ke(15);try{Wb.jc(nb);this.h$.hOb(nb);const Jb=Object(mb.a)(555,nb);Jb&&(Jb.Hsa=ba,Jb.iLc=Qa)}finally{Wb&&Wb.dispose()}Kb.a.J(512262915,
805,50,"CommentManager::EditCommentInternal - Edited comment {0}",Da)}else Kb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",Da);this.zE.Rek()}else Kb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}tIb(ba,Da){if(this.YAb()){var Qa=this.Xta(ba);if(Qa){if(null===Da)throw Error.argumentNull("pos");const nb=this.Fb.ke(15);try{nb.jc(Qa),this.h$.hOb(Qa),Object(mb.a)(555,Qa).gda=Object.assign(new Sd.a,{X:Da.x,
Y:Da.y})}finally{nb&&nb.dispose()}Kb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",ba)}else Kb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",ba);this.zE.agk(ba)}else Kb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}nSl(ba,Da,Qa){this.Ib.$e(()=>{this.oSl(ba,Da,Qa)})}oSl(ba,Da,Qa){if(this.YAb()){var nb=this.Xta(ba);if(nb){var Wb=this.Fb.ke(15);try{Wb.jc(nb);this.h$.hOb(nb);const bf=Object(mb.a)(555,
nb);if(bf){var Jb=bf.reactions,Uc={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,UserId:this.userId};if(Qa){let sd;sd=Xc(Jb,Uc);a:{ba=sd;var Jd;let vd={Time:new Date,User:Uc};if(ba&&ba.ReactionList){for(const [$c,hd]of ba.ReactionList.entries())if(hd.Type===Da){null===(Jd=ba.ReactionList[$c].ReactionInstances)||void 0===Jd?void 0:Jd.push(vd);sd=ba;break a}ba.ReactionList.push({Type:Da,ReactionInstances:[vd]})}else ba={ReactionList:[{Type:Da,ReactionInstances:[vd]}]};
sd=ba}var ne=sd}else ne=Xc(Jb,Uc);this.h$.Aol(nb,ne)}else Kb.a.J(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",ba)}finally{null===Wb||void 0===Wb?void 0:Wb.dispose()}}else Kb.a.J(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",ba)}else Kb.a.J(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}GPh(ba,Da,Qa){if(this.YAb()){var nb=this.Xta(ba);
if(nb){const Wb=this.Fb.ke(15);try{Wb.jc(nb),this.h$.hOb(nb),this.h$.Bol(nb,Da),Object(mb.a)(555,nb).Qmb=Qa,this.isTasksHistoryEnabled&&this.h$.Pyh(nb,this.userName,this.userId,this.providerId)}finally{Wb&&Wb.dispose()}if(this.Hrg){Qa=this.Sta(nb);if(!Qa){Kb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===Da?this.zE.Cgk(!!Qa.taskInfo):0===Da&&this.zE.rhk(!!Qa.taskInfo)}else 1===Da&&this.zE.Dgk();Kb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",
ba,Da)}else Kb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",ba)}else Kb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}qz(){return this.Tta(this.Qea)}Tta(ba){const Da=[];if(!ba||39!==ba.type)return Da;ba=vb.GraphIterator.pb(ba);for(var Qa=ba.Ri();Qa;){if(40===Qa.type){const nb=Object(mb.a)(555,Qa).bya;Qa=this.Sta(Qa);if(nb)for(const Wb of Da)Wb.commentId===nb&&(Wb.Children||(Wb.Children=[]),Wb.Children.push(Qa));
else Da.push(Qa)}Qa=ba.xp()}return Da}iPh(){const ba=this.ua.Ba;this.Qea=ba?vb.GraphIterator.pb(ba).Db(16):null}mlj(){if(!this.Qea)return!1;const ba=vb.GraphIterator.pb(this.Qea);if(this.KB.s7f(this.Qea))return!0;let Da=ba.Ri();for(;Da;){if(this.KB.s7f(Da))return!0;Da=ba.xp()}return!1}Q7i(ba,Da){return this.V1f(ba,Da,!1)}b8i(ba,Da){return this.V1f(ba,Da,!0)}V1f(ba,Da,Qa){if(!ba)return null;if(ba=ba.nE()){ba=this.Tb.Lc(ba);let nb=Qa?ba.B9b():ba.Ri();for(;nb;){if(!(this.KB.G3c(nb)||Da&&0!==this.KB.zVc(nb)))return this.Sta(nb);
nb=Qa?ba.pua():ba.xp()}}return null}EZi(ba){return ba?(ba=ba.nE())?!!this.Tb.Lc(ba).Ri():!1:!1}AVc(ba){if(!ba)return 0;var Da=ba.nE();ba=0;if(Da){Da=this.Tb.Lc(Da);let Qa=Da.Ri();for(;Qa;)this.KB.G3c(Qa)||ba++,Qa=Da.xp()}return ba}YAb(){return!!this.Qea&&this.Qea.isConnected}rgj(ba,Da){Da=vb.GraphIterator.pb(Da);var Qa=Da.Ri();const nb=new r.a;for(;Qa;){const Wb=this.KB.xVc(Qa),Jb=Object(mb.a)(555,Qa).bya;ba!==Wb&&ba!==Jb||nb.add(Qa);Qa=Da.xp()}return nb}Xta(ba){const Da=vb.GraphIterator.pb(this.Qea);
let Qa=Da.Ri();for(;Qa;){const nb=this.KB.xVc(Qa);if(ba===nb)return Qa;Qa=Da.xp()}return null}Sde(ba){ba=this.Xta(ba);if(!ba)return null;const Da=Object(mb.a)(555,ba).bya;return Ib.a.Xa(Da)?ba:this.Xta(Da)}Sta(ba){if(pc.a("GetCommentFromGraphNodeNullSafety")){var Da=Object(mb.a)(555,ba);if(!Da)return null;var Qa=new Ad;Qa.dt=Da.Z3b;Qa.text=Da.Hsa;Qa.status=this.KB.zVc(ba);Qa.userId=Da.Q0b;Qa.commentId=this.KB.xVc(ba);Qa.authorName=Da.authorName;Qa.providerId=Da.nLc;Qa.anchorShape=Da.M2b;Qa.pos=Object.assign(new Md.a,
{X:Da.gda.X,Y:Da.gda.Y});Qa.taskInfo=Da.taskInfo;Qa.textAnchoringInfo=Da.textAnchoringInfo;this.Yac&&(Qa.changesData=Da.changesData,Qa.isUnread=this.GR.instance&&this.GR.instance.Xog(Da));Fb(this.Ib)&&(Qa.reactions=Da.reactions);return Qa}if(ba){Da=this.KB.xVc(ba);Qa=new Ad;const nb=Object(mb.a)(555,ba);if(nb){Qa.dt=nb.Z3b;Qa.anchorShape=nb.M2b;const Wb=nb.gda;Qa.pos=Object.assign(new Md.a,{X:Wb.X,Y:Wb.Y});Qa.text=nb.Hsa;Qa.authorName=nb.authorName;Qa.userId=nb.Q0b;Qa.providerId=nb.nLc;this.Yac&&
(Qa.changesData=nb.changesData,Qa.isUnread=this.GR.instance&&this.GR.instance.Xog(nb));Fb(this.Ib)&&(Qa.reactions=nb.reactions)}Qa.status=this.KB.zVc(ba);Qa.commentId=Da;Qa.taskInfo=Object(mb.a)(555,nb).taskInfo;Qa.textAnchoringInfo=Object(mb.a)(555,nb).textAnchoringInfo;return Qa}return null}T$a(ba){if(!ba)return[];const Da=this.Tta(ba.nE());if(!Da||this.pEa&&!Da.length){if(!Da)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return Da}Da.sort((Qa,nb)=>{var Wb=
this.lc.mee(ba,Qa.anchorShape);Wb=Wb?Wb.mC:new wc.a(0,0);var Jb=this.lc.mee(ba,nb.anchorShape);Jb=Jb?Jb.mC:new wc.a(0,0);Wb.y+=Qa.pos.Y;Jb.y+=nb.pos.Y;Wb.x+=Qa.pos.X;Jb.x+=nb.pos.X;let Uc=Wb.y-Jb.y;Uc||(Uc=Wb.x-Jb.x)||(Uc=+Qa.dt-+nb.dt);return Uc});return Da}awj(ba){var Da=this.ua.presentation;if(!Da)return null;Da=Da.slides;if(!Da)return null;for(const Qa of Da)if(Da=Object(mb.a)(Le.a,Qa))for(const nb of this.Tta(Da.nE())){if(ba===nb.commentId)return Qa;if(nb.Children)for(const Wb of nb.Children)if(ba===
Wb.commentId)return Qa}return null}Kte(){let ba=0,Da=0;var Qa=this.ua.presentation;if(Qa){var nb=Qa.slides;if(nb){Qa=new r.a;for(const Wb of nb)if((nb=Object(mb.a)(Le.a,Wb))&&nb.nE())for(const Jb of this.Tta(nb.nE()))dc.bO(Jb)?Da+=1:Jb.textAnchoringInfo&&Qa.add(Jb.commentId),ba+=1;this.zE.Kte(ba,Da,Qa)}}}}Vf.Rvh=!0;Object(h.a)(Vf,"CommentManager",null,[974,975,108]);var Cd=d(133);class Sc{constructor(ba,Da,Qa,nb){this.GO=ba;this.Kc=Da;this.Eb=Qa;this.zc=nb}fvj(ba){if(null===ba)throw Error.argumentNull("comment");
if(ba=this.UUc(ba))if(ba=this.rk(ba))return ba.xa.xa;return null}Edj(ba){if(null===ba)throw Error.argumentNull("comment");if(ba=this.UUc(ba)){if(ba.xd){var Da=this.zc.eO(ba);if(!Da)return Kb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",ba.get_shapeId()),null;Da=Da.qc(this.Eb.Na);return Da&&Da.htmlElement?Cd.a.Pda(new Sys.UI.Bounds(Da.htmlElement.clientLeft,Da.htmlElement.clientTop,Da.htmlElement.clientWidth,Da.htmlElement.clientHeight)):(Kb.a.J(595133521,
805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",ba.get_shapeId()),null)}if(ba=this.rk(ba))return ba=ba.xa.xa,Cd.a.Pda(new Sys.UI.Bounds(ba.clientLeft,ba.clientTop,ba.clientWidth,ba.clientHeight))}return null}UUc(ba){if(null===ba)throw Error.argumentNull("comment");if(!ba.anchorShape)return null;ba=this.GO.Sde(ba.commentId);ba=this.GO.Sta(ba);if(!ba)return null;const Da=this.Kc.Hc?this.Kc.Hc.$c:null;return Da?Da.WC(ba.anchorShape):(Kb.a.J(557090388,805,50,"ActiveSlide is null"),
null)}Fdj(ba){if(null===ba)throw Error.argumentNull("comment");if(!ba.anchorShape)return 0;if(ba=this.UUc(ba))if(ba=this.rk(ba))return ba.rotation;return 0}rk(ba){if(null===ba)throw Error.argumentNull("shapeNode");return Object(mb.a)(117,ba.qc(this.Eb.Na))}}Object(h.a)(Sc,"CommentMarkerAnchorHelper",null,[928]);var jg=d(591),mg=d(116);class Pa{constructor(ba,Da,Qa){this.n$=ba;this.Kc=Da;this.qwe=Qa}DZi(ba){const Da=Object(mb.a)(555,this.qwe.Xta(ba.commentId));if(!Da)throw e.ULS.sendTraceTag(595203538,
805,10,"There is no graph node for comment {0}",ba.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!Da.gda}dtj(ba,Da){if(!ba)throw Error.argumentNull("commentMarkerViewElement");if(!Da)throw Error.argumentNull("comment");if(!this.qwe.Xta(Da.commentId))return e.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",Da.commentId),new wc.a(0,Number.MIN_VALUE);const Qa=ba.Nn;ba=ba.Tld;if(!this.DZi(Da)||!Da.pos.X&&!Da.pos.Y){if(Qa)return Da=
new wc.a(Qa.hc-Qa.kc-Pa.Lrd.width-Pa.Nvh.width,Pa.Nvh.height),Pa.Uhg(Da,Qa,ba),Da;if(this.Kc.Hc&&this.Kc.Hc.WA)return new wc.a(this.Kc.Hc.WA.clientWidth-Pa.Lrd.width,0);e.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new wc.a(0,0)}Da=new wc.a(this.n$.Pe(Da.pos.X,0),this.n$.Pe(Da.pos.Y,1));Da=new wc.a(Da._x-Pa.a1a._x,Da._y-Pa.a1a._y);Qa&&(Da._x=Math.max(0,Da._x),Da._y=Math.max(0,Da._y),Da._x=
Math.min(Da._x,Qa.hc-Qa.kc-Pa.Lrd.width),Da._y=Math.min(Da._y,Qa.Zb-Qa.mc-Pa.Lrd.height),Pa.Uhg(Da,Qa,ba));return Da}lSl(ba,Da){var Qa=new wc.a(ba.element.offsetLeft,ba.element.offsetTop);Qa=new wc.a(Qa._x+Pa.a1a._x,Qa._y+Pa.a1a._y);const nb=ba.Nn;nb&&ba.Tld%360&&Pa.nEf(Qa,0-ba.Tld,nb.Zf());Da.pos.X=this.n$.gf(Qa._x,0);Da.pos.Y=this.n$.gf(Qa._y,1);this.qwe.tIb(Da.commentId,new wc.a(Da.pos.X,Da.pos.Y))}static Uhg(ba,Da,Qa){if(Da&&Qa%360){var nb=new wc.a(ba._x+Pa.a1a._x,ba._y+Pa.a1a._y);Pa.nEf(nb,Qa,
Da.Zf());ba.update(nb._x-Pa.a1a._x,nb._y-Pa.a1a._y)}}static nEf(ba,Da,Qa){ba.NM(0-Qa._x,0-Qa._y);Da=jg.a.c4d(Da);ba.update(ba._x*Math.cos(Da)-ba._y*Math.sin(Da)+Qa._x,ba._x*Math.sin(Da)+ba._y*Math.cos(Da)+Qa._y)}}Pa.Lrd=new mg.a(20,20);Pa.Nvh=new mg.a(4,4);Pa.a1a=new wc.a(4,20);Object(h.a)(Pa,"CommentMarkerPositionHelper",null,[929]);var bb=d(141),Fc=d(79),yd=d(49);class ge{constructor(ba,Da){this.cJa=this.tIa=this.iFe=null;this.hfc=ba;this.Uq=Da}Mv(){return!0}av(ba){if(!ba)return!1;this.cJa=this.hfc.element.style;
this.iFe=new wc.a(ba.clientPoint.x,ba.clientPoint.y);this.tIa=new wc.a(parseInt(this.cJa.left),parseInt(this.cJa.top));this.Sw(ba);return!0}Sw(ba){if(!ba)return!1;ba=this.sag(new wc.a(ba.clientPoint.x,ba.clientPoint.y),this.iFe);this.cJa.left=yd.a.Pc(this.tIa._x+ba._x);this.cJa.top=yd.a.Pc(this.tIa._y+ba._y);return!0}vo(ba){if(ba){ba=this.sag(new wc.a(ba.clientPoint.x,ba.clientPoint.y),this.iFe);var Da=this.tIa._x+ba._x,Qa=this.tIa._y+ba._y,nb=this.hfc.Nn;nb&&(Da=Math.max(nb.kc,Da),Da=Math.min(nb.hc-
this.hfc.element.clientWidth,Da),Qa=Math.max(nb.mc,Qa),Qa=Math.min(nb.Zb-this.hfc.element.clientHeight,Qa),ba._x=Da-this.tIa._x,ba._y=Qa-this.tIa._y);this.cJa.left=yd.a.Pc(Da);this.cJa.top=yd.a.Pc(Qa);this.hfc.Z6g(ba)}}Fu(){this.cJa.left=yd.a.Pc(this.tIa._x);this.cJa.top=yd.a.Pc(this.tIa._y)}sag(ba,Da){ba=wc.a.xV(ba,Da);return new wc.a(this.Uq.vm(ba.x),this.Uq.vm(ba.y))}}Object(h.a)(ge,"CommentMarkerDragAdapter",null,[235]);class rb{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd){this.q$=null;this.FXa=this.GXa=
!1;if(!Da)throw Error.argumentNull("parentElement");this.kEb=Jd;this.g$=ba;this.rq=Qa;this.Gma=nb;this.kD=Wb;this.e9c=Uc;this.Nm=document.createElement("div");this.Nm.className=dc.USc(ba)?this.kD.s5g:this.kD.r5g;this.Nm.title=ResourceStrings.L_CommentMarkerTooltip;this.Nm.style.display=this.e9c||this.kEb?"none":"block";this.Nm.setAttribute("data-pptcommentid",String.format("{0}",ba.commentId));this.xA=document.createElement("img");this.xA.alt=ResourceStrings.L_CommentMarkerTooltip;this.xA.src=Qa.frame.qk(Qa.frame.qT+
".png");this.xA.setAttribute(bb.a.hf,bb.a.Ou);this.Nm.appendChild(this.xA);this.T2a();this.frame.Rc.ub(Ka.a.click,this.Nm,Object(sa.a)(this,this.IC,"clickHandler"));dc.YSc&&(Db.a.addHandler(this.Nm,Ka.a.tq,Object(sa.a)(this,this.wxa,"mouseOverHandler")),Db.a.addHandler(this.Nm,Ka.a.Zs,Object(sa.a)(this,this.fmc,"mouseOutHandler")));dc.ILc&&Db.a.addHandler(this.xA,Ka.a.mouseDown,Object(sa.a)(this,this.Opc,"preventNativeDragMouseDownHandler"));Da.appendChild(this.Nm);Jb||this.T1d()}dispose(){this.xA&&
(dc.ILc&&Db.a.removeHandler(this.xA,Ka.a.mouseDown,Object(sa.a)(this,this.Opc,"preventNativeDragMouseDownHandler")),this.frame.Rc.Bb(Ka.a.click,this.Nm,Object(sa.a)(this,this.IC,"clickHandler")),this.xA.parentNode&&this.xA.parentNode.removeChild(this.xA),this.xA=null);this.Nm&&(dc.YSc&&(Db.a.removeHandler(this.Nm,Ka.a.tq,Object(sa.a)(this,this.wxa,"mouseOverHandler")),Db.a.removeHandler(this.Nm,Ka.a.Zs,Object(sa.a)(this,this.fmc,"mouseOutHandler"))),this.Gma&&(this.Gma.mZd(),this.Gma.oF(this.Nm,this.q$)),
this.Nm.parentNode&&this.Nm.parentNode.removeChild(this.Nm));this.rq=this.g$=null}get comment(){return this.g$}get element(){return this.Nm}get frame(){return this.rq.frame}T1d(){this.Gma&&(this.q$=new ge(this,eb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Gma.jK(this.Nm,this.q$))}updatePosition(ba){this.Nm.style.left=yd.a.Pc(ba._x-(this.rq.isRightToLeft?this.kD.RJe:0));this.Nm.style.top=yd.a.Pc(ba._y)}Z6g(ba){this.rq.tIb(this.g$,ba)}select(ba){this.GXa=ba;this.T2a()}activate(ba){this.FXa=
ba;this.T2a()}GEh(){}setVisibility(ba){this.Nm.style.display=ba&&!this.kEb?"block":"none"}T2a(){this.kEb||(this.xA.className=dc.USc(this.g$)?this.GXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.v5g):this.FXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.t5g):Fc.getImageClassWithCluster(this.frame.qT,this.kD.u5g):this.GXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.q5g):this.FXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.QJe):Fc.getImageClassWithCluster(this.frame.qT,this.kD.Jlc))}get Nn(){return null}get Tld(){return 0}IC(ba){if(ba.OA!==
Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.g$,null,!1,!0,ba.kg,1,!1);ba=ba.nc;ba.preventDefault();ba.stopPropagation();return!0}wxa(){this.frame.Gsb(this.g$,1)}fmc(){this.frame.Gsb(null,1)}Opc(ba){ba.preventDefault()}}Object(h.a)(rb,"LegacyCommentMarkerViewElement",null,[1011]);var gf=d(99),Ab=d(653);class fc{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne){this.q$=null;this.uFg=this.FXa=this.GXa=!1;if(!Da)throw Error.argumentNull("parentElement");this.g$=ba;this.rq=Qa;this.Gma=nb;
this.kD=Wb;this.dHa=Jb;this.C7c=Uc;this.e9c=ne;this.Nm=document.createElement("div");this.Nm.className=dc.USc(ba)?this.kD.s5g:this.kD.r5g;Sys.UI.DomElement.addCssClass(this.Nm,"CommentMarker");this.Nm.title=ResourceStrings.L_CommentMarkerTooltip;this.Nm.style.display="none";this.Nm.setAttribute("data-pptcommentid",String.format("{0}",ba.commentId));this.xA=document.createElement("img");this.xA.alt=ResourceStrings.L_CommentMarkerTooltip;this.xA.src=Qa.frame.qk(Qa.frame.qT+".png");this.xA.setAttribute(bb.a.hf,
bb.a.Ou);this.Nm.appendChild(this.xA);this.T2a();this.frame.Rc.ub(Ka.a.click,this.Nm,Object(sa.a)(this,this.IC,"clickHandler"));dc.YSc&&(Db.a.addHandler(this.Nm,Ka.a.tq,Object(sa.a)(this,this.wxa,"mouseOverHandler")),Db.a.addHandler(this.Nm,Ka.a.Zs,Object(sa.a)(this,this.fmc,"mouseOutHandler")));dc.ILc&&Db.a.addHandler(this.xA,Ka.a.mouseDown,Object(sa.a)(this,this.Opc,"preventNativeDragMouseDownHandler"));Da.appendChild(this.Nm);Jd||this.T1d()}dispose(){this.xA&&(dc.ILc&&Db.a.removeHandler(this.xA,
Ka.a.mouseDown,Object(sa.a)(this,this.Opc,"preventNativeDragMouseDownHandler")),this.frame.Rc.Bb(Ka.a.click,this.Nm,Object(sa.a)(this,this.IC,"clickHandler")),this.xA.parentNode&&this.xA.parentNode.removeChild(this.xA),this.xA=null);this.Nm&&(dc.YSc&&(Db.a.removeHandler(this.Nm,Ka.a.tq,Object(sa.a)(this,this.wxa,"mouseOverHandler")),Db.a.removeHandler(this.Nm,Ka.a.Zs,Object(sa.a)(this,this.fmc,"mouseOutHandler"))),this.Gma&&(this.Gma.mZd(),this.Gma.oF(this.Nm,this.q$)),this.Nm.parentNode&&this.Nm.parentNode.removeChild(this.Nm));
this.rq=this.g$=null}get comment(){return this.g$}get element(){return this.Nm}get frame(){return this.rq.frame}T1d(){this.Gma&&(this.q$=new ge(this,eb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Gma.jK(this.Nm,this.q$))}updatePosition(){const ba=this.C7c.dtj(this,this.comment);this.Nm.style.left=ba._x+"px";this.Nm.style.top=ba._y+"px"}Z6g(){this.C7c.lSl(this,this.comment)}select(ba){this.GXa=ba;this.T2a();this.onVisibilityChange()}activate(ba){this.FXa=ba;this.T2a();this.onVisibilityChange()}GEh(ba){this.uFg=
ba;this.T2a();this.onVisibilityChange()}setVisibility(ba){this.e9c=!ba;this.onVisibilityChange()}onVisibilityChange(){!this.e9c&&(this.GXa||this.FXa||this.uFg)?(this.updatePosition(this.frame.pDa(this.comment.pos.X,this.comment.pos.Y)),this.Nm.style.display="block",gf.a.WI(this.Nm,Ab.a.ZNc)):(this.Nm.style.display="none",gf.a.gLa(this.Nm,Ab.a.ZNc))}get Nn(){return this.dHa.Edj(this.g$)}get Tld(){return this.dHa.Fdj(this.g$)}T2a(){this.xA.className=dc.USc(this.g$)?this.GXa?Fc.getImageClassWithCluster(this.frame.qT,
this.kD.v5g):this.FXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.t5g):Fc.getImageClassWithCluster(this.frame.qT,this.kD.u5g):this.GXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.q5g):this.FXa?Fc.getImageClassWithCluster(this.frame.qT,this.kD.QJe):Fc.getImageClassWithCluster(this.frame.qT,this.kD.Jlc)}IC(ba){if(ba.OA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.g$,null,!1,!0,ba.kg,1,!1);ba=ba.nc;ba.preventDefault();ba.stopPropagation();return!0}wxa(){this.xA.className=
Fc.getImageClassWithCluster(this.frame.qT,this.kD.QJe)}fmc(){this.xA.className=Fc.getImageClassWithCluster(this.frame.qT,this.kD.Jlc)}Opc(ba){ba.preventDefault()}}Object(h.a)(fc,"ModernCommentMarkerViewElement",null,[1011]);class kc{constructor(ba,Da,Qa,nb,Wb,Jb){this.dHa=ba;this.C7c=Da;this.kD=Qa;this.mgc=Wb;this.kEb=Jb;nb.Nvb().then(Uc=>{Uc||this.S1e(!1)})}dispose(){this.kD=null}create(ba,Da,Qa,nb,Wb,Jb){if(this.mgc){const Uc=this.dHa.fvj(ba);return new fc(ba,Uc||Da,Qa,nb,this.kD,this.dHa,this.C7c,
Wb,Jb)}return new rb(ba,Da,Qa,nb,this.kD,Wb,Jb,this.kEb)}S1e(ba){this.kEb=this.mgc=ba;this.kD.S1e(ba)}}Object(h.a)(kc,"CommentMarkerViewElementFactory",null,[930,108]);var ud=d(78);class zd extends ud.a{constructor(){super()}vli(ba){this.addHandler(zd.GHh,ba)}F8g(){this.raiseEvent(zd.GHh)}}zd.GHh="S";Object(h.a)(zd,"ATransactionCompletedProcessor",ud.a,[1013]);var Td=d(41);class Me extends zd{constructor(ba,Da,Qa){super();this.twk=ba;this.L9c=Da;this.YX=Qa}get index(){return 0}run(){this.twk()}eOf(ba,
Da){Da.property!==qf.a.gda&&Da.property!==qf.a.Hsa&&Da.property!==qf.a.commentId&&Da.property!==qf.a.P2b&&Da.property!==qf.a.Q2b&&Da.property!==qf.a.ewc&&Da.property!==qf.a.dwc&&Da.property!==qf.a.reactions||this.F8g()}QNf(ba,Da){Da.property!==Td.a.yB&&Da.property!==qf.a.P2b||this.F8g()}KMj(){this.L9c.zd(39).gk(Object(sa.a)(this,this.QNf,"commentContentPropertyChanged"));this.L9c.zd(40).gk(Object(sa.a)(this,this.eOf,"commentPropertyChanged"));this.YX.Wnl(this)}hQl(){this.L9c.zd(40).Qm(Object(sa.a)(this,
this.eOf,"commentPropertyChanged"));this.L9c.zd(39).Qm(Object(sa.a)(this,this.QNf,"commentContentPropertyChanged"))}}Object(h.a)(Me,"CommentPropertyTracker",zd,[]);var tf=d(443),re=d(138);class lh extends tf.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new re.a,{T_:lh.getTypeName(),B_:lh.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(h.a)(lh,"CommentSmartReplySignal",
tf.a,[]);var ze=d(619);class Je extends ze.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new re.a,{T_:Je.getTypeName(),B_:Je.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(h.a)(Je,"SmartReply",ze.a,[]);var Wh=d(284),Kg=d(300);class pd{constructor(ba,Da){this.HYh=ba;this.wdf=Da}initialize(){this.wdf.execute(ba=>
{const Da=Je.getTypeName();ba.kQ(Da);ba.B6(Da,Object(sa.a)(this,this.SQ,"handleAnnotationEvent"))})}invoke(ba,Da){const Qa=Object.assign(new Wh.a,{parentPath:["Signal",lh.getTypeName()],items:[Object.assign(new Kg.a,{body:Object.assign(new lh,{commentId:ba,comment:Da})})]});this.wdf.execute(nb=>{nb.submitOperation(Qa)})}SQ(ba){if(ba){var Da=new r.a;if(ba&&ba.CommentId&&ba.ResultSets&&0<ba.ResultSets.length&&ba.ResultSets[0].Documents&&0<ba.ResultSets[0].Documents.length){for(const Qa of ba.ResultSets[0].Documents)Da.add(Qa.Caption);
0<Da.count&&this.HYh.yUk(ba.CommentId,Da.toArray())}else Kb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Kb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(pd,"CommentSmartReplyProvider",null,[]);var Nc=d(316),le=d(286),Ye=d(280),Zc=d(98),Jf=d(184),pg=d(110),gd=d(58),bd=d(525);class Ne{constructor(ba,Da,Qa,nb,Wb){this.twe=this.gxe=this.Exe=this.L6c=0;this.bCg=new r.a;this.vIe=this.pCg=this.vwe=this.$jc=this.IEe=0;this.kGe=new r.a;this.Nue=
this.Mue=this.Oue=this.Lue=0;this.aAg=new r.a;this.Bed=new r.a;this.exe=this.cxe=this.dxe=this.fxe=this.IBe=this.HBe=this.JBe=this.KBe=0;this.O6c=this.HAe=this.F7c=db.App.tn;this.xYa=null;this.qIe=this.rIe=this.Gfd=this.ggd=this.Pdd=this.Kue=0;if(!ba)throw Error.argumentNull("coreEventHandler");if(!Da)throw Error.argumentNull("appSettingsManager");this.Mc=ba;this.Ib=Da;this.ua=Qa;this.KB=nb;this.owe=Wb;this.Mc.qB(Object(sa.a)(this,this.Hn,"onSessionRehydrated"));this.Mc.GC(Object(sa.a)(this,this.UE,
"onSessionEnd"))}get j0d(){return this.Ib.ka("CommentTextAnchoringCreateNewEnabled")}get pJl(){return this.Ib.ka("TasksForCommentsEnabled")}Hte(ba,Da,Qa,nb){this.L6c+=1;this.twe+=Da;Qa&&(this.Lue+=1,this.kGe.add(ba));nb&&(this.Kue+=1)}bek(ba,Da,Qa,nb){this.Gfd=nb?this.Gfd+1:this.Gfd;this.Hte(ba,Da,Qa,nb)}aek(ba,Da,Qa,nb,Wb){(Wb=!!Wb)&&nb?this.rIe+=1:Wb&&(this.qIe+=1);this.Hte(ba,Da,Qa,Wb)}dhk(){this.Oue+=1}ahk(){this.Mue+=1}bhk(){this.Nue+=1}chk(ba,Da,Qa,nb){this.rrg(ba.commentId)||(Qa&&!this.C8j(Da,
Qa.vy(),nb)?this.Tyg(ba,Qa,!0):this.Tyg(ba,Qa,!1))}V5k(){this.gxe+=1}Tgk(){this.fxe+=1}Mek(){this.dxe+=1}Lek(){this.cxe+=1}Nek(){this.exe+=1}Rek(){this.Exe+=1}agk(ba){this.bCg.contains(ba)||(this.IEe+=1,this.bCg.add(ba))}Cgk(ba){this.Pdd=ba?this.Pdd+1:this.Pdd;this.$jc+=1}rhk(ba){this.ggd=ba?this.ggd+1:this.ggd}Dgk(){this.$jc+=1}Kte(ba,Da,Qa){this.vwe=ba;this.vIe=Da;this.aAg=Qa;this.Cyg()}Iek(ba){this.pCg=ba?1:2}WFk(ba){this.F7c===db.App.tn&&(this.F7c=new Date,this.MGa("OnCollabCornerCommentsEnabled",
this.F7c,ba),this.K_e("CollabCornerCommentsEnabled",this.F7c))}tHk(ba){this.HAe===db.App.tn&&(this.HAe=new Date,this.MGa("OnFloatingCommentsRendered",this.HAe,ba))}REk(ba){this.O6c===db.App.tn&&(this.O6c=new Date,this.MGa("OnAllFloatingContainersVisible",this.O6c,ba),this.K_e("AllFloatingContainersVisible",this.O6c))}tGk(ba){const Da=new Date;this.MGa("OnDeepLinkedCommentSelected",Da,ba);this.K_e("DeepLinkedCommentSelected",Da)}rrg(ba){return this.aAg.contains(ba)||this.Bed.contains(ba)}C8j(ba,Da,
Qa){let nb=0;for(const Jb of Da)if(Da=Object(mb.a)(646,Jb.qc(Qa))){Da=Da.htmlElement.getElementsByClassName(Zc.a.c4b);for(let Uc=0;Uc<Da.length;Uc++){var Wb=Da[Uc];const Jd=Nc.a.Be(Wb,Zc.a.h0d);Jd&&(nb+=od.a.contains(Jd,ba)?1:0);(Wb=Nc.a.Be(Wb,Zc.a.d0d))&&(nb+=od.a.contains(Wb,ba)?1:0);if(2===nb)return!0}}return!1}Tyg(ba,Da,Qa){if(ba&&ba.textAnchoringInfo&&!this.rrg(ba.commentId))if(ba.textAnchoringInfo.EndPos<=ba.textAnchoringInfo.StartPos){if(Da){if(Qa){this.IBe+=1;this.Bed.add(ba.commentId);return}this.JBe+=
1}else this.KBe+=1;this.Bed.add(ba.commentId)}else 0>=ba.textAnchoringInfo.TextBodyLength&&(this.kGe.contains(ba.commentId)?this.kGe.remove(ba.commentId):(this.HBe+=1,this.Bed.add(ba.commentId)))}MGa(ba,Da,Qa){const nb={};nb.Event=ba;nb.Time=Da.getTime();nb.SlideId=Qa.toString();nb.LandingSlide=this.bnj();nb.SessionDimensions=this.eee();nb.PerfMetrics=this.Tdj();nb.CommentPerfMetrics=this.tgj();nb.CommentFileType=this.owe;nb.CommentDeepLinkedOpen=!!this.Ib.Ha("CurrentCommentId");nb.StandaloneCommentJsEnabled=
!0;nb.LoadSharedCommentsEarly=!0;nb.FetchFullAppSettingsOnBoot=this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);nb.PrefetchCommentCloudPolicy=this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",!1);Kb.a.J(509703831,805,15,Wa.c(nb))}Cyg(){Kb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.vwe,this.owe);Kb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.vIe);Kb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",
this.j0d,this.pJl)}log(){Kb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.L6c,this.Exe,this.gxe,this.twe/this.L6c,this.IEe,this.$jc,this.vwe,this.owe,this.pCg);Kb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.vIe,this.Lue,this.Oue,
this.Mue,this.Nue,this.JBe,this.HBe,this.KBe,this.IBe);Kb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.fxe,this.dxe,this.cxe,this.exe);this.$gk()}$gk(){Kb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.Kue);const ba={};ba.ResolvedTasksCount=this.Pdd;ba.UnresolvedTasksCount=this.ggd;ba.TasksCreatedNewThreadCount=this.Gfd;ba.TasksReassignedInReplyCount=this.rIe;ba.TasksCreatedInReplyCount=this.qIe;Kb.a.J(509703823,845,15,Wa.c(ba))}Hn(){this.Cyg()}UE(){this.log()}bnj(){if(this.xYa)return this.xYa;
this.xYa={};var ba=parseInt(this.Ib.Ha("CurrentSlideId"));ba=ba!==gd.a.empty.sid?gd.a.ax(ba,0):this.ua.presentation.hzb(0);if(!ba)return this.xYa;this.xYa.SlideId=ba.toString();if(ba=this.ua.presentation.wee(ba.sid))ba=Object(mb.a)(116,ba).nE(),this.xYa.HasComments=this.KB.Aig(ba),this.xYa.HasActiveComments=this.KB.qig(ba);return this.xYa}eee(){const ba={};ba.Ring=n.AFrameworkApplication.Md.Ring;ba.Host=n.AFrameworkApplication.Md.Host;ba.UiHost=n.AFrameworkApplication.Md.UiHost;ba.SessionOrigin=n.AFrameworkApplication.Md.SessionOrigin;
ba.ApplicationMode=n.AFrameworkApplication.Md.ApplicationMode;ba.Browser=n.AFrameworkApplication.Md.Browser;ba.Os=n.AFrameworkApplication.Md.Os;return ba}Tdj(){const ba={};ba[le.a.MRb]=zc.a.instance.Tg(le.a.MRb);ba.DocPageNavigationStart=zc.a.instance.Tg("DocPageNavigationStart");ba[le.a.m7b]=zc.a.instance.Tg(le.a.m7b);ba[bd.a.qYe]=zc.a.instance.Tg(bd.a.qYe);ba[bd.a.pYe]=zc.a.instance.Tg(bd.a.pYe);ba[bd.a.uth]=zc.a.instance.Tg(bd.a.uth);ba[bd.a.c0f]=zc.a.instance.Tg(bd.a.c0f);ba[bd.a.D7d]=zc.a.instance.Tg(bd.a.D7d);
ba[bd.a.C7d]=zc.a.instance.Tg(bd.a.C7d);ba[bd.a.$Zd]=zc.a.instance.Tg(bd.a.$Zd);ba[le.a.BAd]=0<Ye.a.instance.Boh();return ba}tgj(){const ba={};ba[Yb.a.g0d]=zc.a.instance.Tg(Yb.a.g0d);ba[Yb.a.l0d]=zc.a.instance.Tg(Yb.a.l0d);ba[Yb.a.gac]=zc.a.instance.Tg(Yb.a.gac);ba[Yb.a.pje]=zc.a.instance.Tg(Yb.a.pje);ba[Yb.a.v2e]=zc.a.instance.Tg(Yb.a.v2e);ba[Yb.a.Fac]=zc.a.instance.Tg(Yb.a.Fac);ba[Yb.a.qje]=zc.a.instance.Tg(Yb.a.qje);ba[Yb.a.tte]=zc.a.instance.Tg(Yb.a.tte);ba[Yb.a.m9d]=zc.a.instance.Tg(Yb.a.m9d);
ba[Yb.a.n9d]=zc.a.instance.Tg(Yb.a.n9d);ba[Yb.a.Eud]=zc.a.instance.Tg(Yb.a.Eud);ba[Yb.a.n2d]=zc.a.instance.Tg(Yb.a.n2d);ba[Yb.a.m2d]=zc.a.instance.Tg(Yb.a.m2d);return ba}Xuj(){const ba=zc.a.instance.Tg("DocPageNavigationStart");if(!zc.a.instance.Tg(le.a.MRb))return ba;const Da=zc.a.instance.Tg(le.a.MRb);return 6E4>ba-Da?Da:ba}K_e(ba,Da){const Qa=[];Array.add(Qa,Object.assign(new pg.a,{name:"EventName",string:ba}));Tb.a.sendActivityEvent(Object.assign(new Jf.a,{name:"CommentsBootEvents",durationMs:Da.getTime()-
this.Xuj(),dataFields:Qa}))}}Object(h.a)(Ne,"CommentTelemetryManager",null,[970]);var rf=d(702),Fh=d(703),Ae=d(704);class Kf extends rf.a{constructor(ba,Da){super();this.unk=ba;this.Hi=Da;this.hBe=[new Fh.a(Zc.a.SNf,null),new Fh.a(Zc.a.TNf,null),new Fh.a(Zc.a.UNf,null),new Fh.a(Zc.a.XNf,null),new Fh.a(Zc.a.aOf,null),new Fh.a(Zc.a.bOf,null),new Fh.a(Zc.a.$Nf,null),new Fh.a(Zc.a.VNf,null),new Fh.a(Zc.a.WNf,null),new Fh.a(Zc.a.YNf,null),new Fh.a(Zc.a.ZNf,null)]}get isInHighContrastMode(){return!!this.Hi&&
this.Hi.isInHighContrastMode}get Wzb(){return this.unk}get bie(){return this.hBe}Anc(ba,Da){var Qa=this.d0.Yja;if(Qa&&0===Qa.type&&(Qa=this.d0.Yja.kea,Qa=Object(m.a)(Array,Qa)?Qa:null)){var nb=null,Wb=null,Jb=new Ma.a;for(const Uc of Qa)Uc.woc.isValid&&Array.contains(Uc.woc.paragraphs,ba)&&(0===Uc.state?nb=Uc.commentId:1===Uc.state&&(Wb=Uc.commentId),Jb.$(Uc.commentId,Uc.woc));this.Noi(Da.querySelectorAll("*"),Jb,ba,nb,Wb)}}Kac(ba,Da){ba=Object(m.a)(Array,ba)?Array.isArray(ba)?ba:null:null;if(!ba||
0<ba.length&&!Object(mb.a)(ee,ba[0]))return Da;for(const Qa of ba)if(Qa.woc.isValid)for(const nb of Qa.woc.paragraphs)nb&&(Ae.b(nb),Da.add(nb));return Da}I5i(ba,Da){ba=ba.LMa;const Qa=Da?Kf.Vjk:Kf.Wjk;Da=Yc.a.j7f(ba,Da?Kf.Qok:Kf.Rok);ba=Yc.a.j7f(ba,Qa);return Da<ba}Noi(ba,Da,Qa,nb,Wb){const Jb=new ka.a,Uc=new ka.a;for(let bf=0;bf<ba.length;bf++){const sd=ba[bf];this.Spd(sd);if(!sd.parentNode)continue;var Jd=Nc.a.Be(sd,Zc.a.h0d),ne=Nc.a.Be(sd,Zc.a.d0d);const vd=[!1,!1,!1];if(Jd)for(const $c of Jd)if(Da.Gb($c)){Jd=
Da.ga($c).z8f(Qa);if(Da.ga($c).Dig||(2===Jd||0===Jd)&&!this.isInHighContrastMode&&this.I5i(Da.ga($c),$c===Wb))Da.ga($c).Dig=!0,Jb.add($c);Uc.add($c);this.gVf(Da,Qa,$c,nb,Wb,vd,!0)}if(ne)for(const $c of ne)Uc.contains($c)&&(Uc.remove($c),Jb.remove($c),this.gVf(Da,Qa,$c,nb,Wb,vd,!1));if(0!==Ae.a(sd)){ne=(Jd=0<Jb.count)&&!!Wb&&Jb.contains(Wb);const $c=!!nb&&Uc.contains(nb),hd=!!Wb&&Uc.contains(Wb);0<Uc.count&&!this.isInHighContrastMode&&0<=sd.parentNode.className.indexOf(Zc.a.MMa)&&(gf.a.WI(sd.parentNode,
Zc.a.SNf),hd?gf.a.WI(sd.parentNode,ne?Zc.a.WNf:Zc.a.VNf):$c?(gf.a.WI(sd.parentNode,Zc.a.TNf),Jd=sd.parentNode.className.match(new RegExp("\\b"+Zc.a.Wjg+"\\b")),(!Jd||1>Jd.length)&&gf.a.WI(sd.parentNode,Zc.a.UNf)):gf.a.WI(sd.parentNode,Jd?Zc.a.bOf:Zc.a.aOf));vd[1]?gf.a.WI(sd,ne?Zc.a.ZNf:Zc.a.YNf):vd[0]?gf.a.WI(sd,Zc.a.XNf):vd[2]&&gf.a.WI(sd,Zc.a.$Nf)}}}gVf(ba,Da,Qa,nb,Wb,Jb,Uc){ba=ba.ga(Qa).z8f(Da);if(2===ba||(Uc?0===ba:1===ba))nb&&nb.equals(Qa)&&(Jb[0]=!0),Wb&&Wb.equals(Qa)&&(Jb[1]=!0),Jb[2]=!0}}
Kf.Rok="#F5E7F6";Kf.Wjk="#503355";Kf.Qok="#F2E1F4";Kf.Vjk="#4C3050";Object(h.a)(Kf,"CommentTextAnchorHighlightActor",rf.a,[]);class Mf{constructor(ba){let Da;this.b5h=20;Da=ba?ba="SharedCommentBubble":ba="SharedCommentBubbleSelected";this.X4h=this.BTa("SharedCommentBubble");this.W4h=this.BTa("SharedCommentBubbleHover");this.Sof=this.BTa(ba);this.a5h=this.BTa("SharedCommentBubble");this.$4h=this.BTa("SharedCommentBubbleHover");this.Tof=this.BTa(Da);this.Y4h="ModernCommentMarkerElementSingle cui-img-cont-float";
this.Z4h="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get r5g(){return this.Y4h}get s5g(){return this.Z4h}get RJe(){return this.b5h}get Jlc(){return this.X4h}get QJe(){return this.W4h}get q5g(){return this.Sof}get u5g(){return this.a5h}get t5g(){return this.$4h}get v5g(){return this.Tof}S1e(ba){const Da=ba?this.Jlc:"SharedCommentBubbleSelected";ba=ba?this.Jlc:Da;this.Sof=this.BTa(Da);this.Tof=this.BTa(ba)}BTa(ba){return String.format("{0}_{1}x{2}x32",ba,this.RJe,this.RJe)}}Object(h.a)(Mf,
"CommentViewHelper",null,[]);class vf{constructor(ba,Da,Qa,nb,Wb,Jb){this.Mc=ba;this.ua=Da;this.wb=Qa;this.uYg=nb;this.kb=Jb;this.uYg.KF(Object(sa.a)(this,this.Vkd,"onSlideOrderChanged"));this.Mc.cii(Object(sa.a)(this,this.S$g,"onCommentsChanged"))}dispose(){this.Mc.Lal(Object(sa.a)(this,this.S$g,"onCommentsChanged"));this.uYg.vP(Object(sa.a)(this,this.Vkd,"onSlideOrderChanged"))}S$g(){const ba=this.ua.Ba;D.a.z7a(this.wb,()=>{this.PUk(ba)})}Vkd(ba,Da){if(2===Da.HW){const Qa=this.ua.Ba;D.a.z7a(this.wb,
()=>{this.Wih(Qa)})}}Wih(ba){this.ua.Ba===ba&&ba&&this.kb.Z2a(!0)}PUk(ba){this.Wih(ba)}}Object(h.a)(vf,"CommentsChangeListener",null,[108]);var eg=d(143),zf=d(278),Nd=d(48);class Se{constructor(ba,Da,Qa,nb,Wb){this.Pgc=this.aZa=null;new zf.a(0,0,0,0);this.dCg=null;this.kDh=!1;this.LJ=Wb;this.Rb=Da;this.LJ||(this.aZa=document.createElement("div"),this.aZa.className="CommentPanel",this.aZa.style.position="absolute");this.Ab=!1;this.xR=Qa;this.q2g=nb}dispose(){}layout(ba){return ba}nie(ba){this.Pgc=
ba}Dol(ba){this.dCg=ba}Zp(ba){this.Ab=ba;this.LJ?this.sK(this.Ab):this.q2g.sK(this,this.Ab,ResourceStrings.L_Comments,Nd.a.hr)}sK(ba){eg.UISurfaces.Iq().then(Da=>{ba?Da.showTaskPane(Nd.a.hr,this.dCg):Da.hideTaskPane(Nd.a.hr,2);return null}).catch(Da=>{Kb.a.J(508887565,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",Da.toString(),ba.toString())})}A_e(){eg.UISurfaces.Iq().then(ba=>{ba.setSelectedTaskPane(Nd.a.hr);return null}).catch(ba=>{Kb.a.J(508887564,833,10,"CommentsPane::SelectPane exception: {0}",
ba.toString())})}bll(){try{this.LJ?this.A_e():this.q2g.A_e(Nd.a.hr)}catch(ba){Kb.a.J(508887563,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",ba)}}SIb(ba){this.Rb.SIb(this.xR&&ba?1:2)}get isVisible(){return this.Ab}get xa(){return this.aZa}get order(){return 18}}Object(h.a)(Se,"CommentsPane",null,[935,654,108,955]);class Qe{constructor(){this.O0a=this.uMa=0;this.Vc=this.o1a=this.Jja=null}}Object(h.a)(Qe,"FindCommentContext",null,[]);var Ei;(function(ba){ba[ba.findNextComment=
0]="findNextComment";ba[ba.findPreviousComment=1]="findPreviousComment";ba[ba.findNextActiveComment=2]="findNextActiveComment";ba[ba.findPreviousActiveComment=3]="findPreviousActiveComment"})(Ei||(Ei={}));Object(h.b)("FindCommentRequestType",Ei);class Ff{constructor(ba,Da,Qa,nb,Wb,Jb){this.ic=ba;this.ua=Da;this.zAe=Qa;this.GO=nb;this.SJg=Wb;this.Cd=new Qe;this.Ilk=Jb}get lDa(){return this.Ilk.value}dispose(){this.zAe.dispose();this.Cd=this.zAe=null}R8d(ba,Da,Qa){this.N8d(0,!1,ba,Da,Qa)}Y8d(ba,Da,
Qa){this.N8d(1,!1,ba,Da,Qa)}S8d(ba,Da){this.N8d(0,!0,ba,Da,!1)}N8d(ba,Da,Qa,nb,Wb){var Jb=this.ua.presentation;if(!Jb)throw Error.argumentNull("Presentation is null");nb||(nb=af.a.Jj("FindComment",0),nb.Wa("FindCommentRequestType",Ei[ba]));nb.Wa(Ff.AYd,"true");if(this.SJg&&this.ua.Ba){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const Uc=this.ua.Ba.qe;Jb=Jb.slides||[];this.Cd.Jja=Qa;this.Cd.O0a=Ff.zkj(ba,Wb);this.Cd.Vc=nb;Da?this.O8d(Jb[Uc>=Jb.length-1?0:Uc+1]):1===ba?this.j2f(Jb,
Uc-1,Wb):this.g2f(Jb,Uc+1,Wb)}else nb.Wa(Ff.oxi,this.SJg.toString()),Qa(null,null,!1,!1)}g2f(ba,Da,Qa){this.Cd.o1a=null;this.Cd.uMa=Da;for(let nb=Da;nb<ba.length;nb++)if(ba[nb]&&this.dug(ba[nb])){const Wb=this.Ekj(ba[nb],Qa);if(Wb){this.Cd.Jja(ba[nb],Wb,!1,!1);return}}else{this.O8d(ba[nb]);return}0<Da?this.e8i(Qa):this.notFound()}j2f(ba,Da,Qa){this.Cd.o1a=null;this.Cd.uMa=Da;for(let nb=Da;-1<nb;nb--)if(ba[nb]&&this.dug(ba[nb])){const Wb=this.inj(ba[nb],Qa);if(Wb){this.Cd.Jja(ba[nb],Wb,!1,!1);return}}else{this.O8d(ba[nb]);
return}Da<ba.length-1?this.m8i(Qa):this.notFound()}O8d(ba){this.Cd.Vc.zm(Ff.ayi,new Date);ba&&this.zAe.find(ba.Cb,this.Cd.O0a,Object(sa.a)(this,this.NLk,"onServerFindSucceeded"),Object(sa.a)(this,this.MLk,"onServerFindFailed"))}NLk(ba){this.Cd.Vc.qC(Ff.AYd,"false");this.Cd.Vc.zm(Ff.TIf,new Date);this.Cd.Vc.Wa(Ff.BIf,"true");ba?(this.Cd.o1a=ba,-1===this.U8b(this.Cd.o1a.TargetSlideId)?this.notFound():this.Cd.Jja(this.nLl(this.Cd.o1a.TargetSlideId),this.Cd.o1a.TargetComment,this.Cd.o1a.IsFirstComment,
this.Cd.o1a.IsLastComment)):this.notFound()}MLk(){this.Cd.Vc.qC(Ff.AYd,"false");this.Cd.Vc.zm(Ff.TIf,new Date);this.Cd.Vc.Wa(Ff.BIf,"false");Kb.a.J(512496786,805,50,"OnServerFindFailed");this.notFound()}e8i(ba){var Da=this.ua.presentation;if(!Da)throw Error.argumentNull("Presentation is null");Da=Da.slides||[];od.a.Xa(Da)?this.notFound():this.g2f(Da,0,ba)}m8i(ba){var Da=this.ua.presentation;if(!Da)throw Error.argumentNull("Presentation is null");Da=Da.slides||[];od.a.Xa(Da)?this.notFound():this.j2f(Da,
Da.length-1,ba)}Ekj(ba,Da){ba=this.ic.Qk(ba.Cb);if(this.lDa){const Qa=(ba=this.GO.T$a(ba))?ba.length:0;for(let nb=0;nb<Qa;nb++){const Wb=ba[nb];if(Ff.nvg(Wb,Da))return Wb}return null}return this.GO.Q7i(ba,Da)}inj(ba,Da){ba=this.ic.Qk(ba.Cb);if(this.lDa){var Qa=(ba=this.GO.T$a(ba))?ba.length:0;for(--Qa;0<=Qa;Qa--){const nb=ba[Qa];if(Ff.nvg(nb,Da))return nb}return null}return this.GO.b8i(ba,Da)}dug(ba){return ba.rE}U8b(ba){var Da=this.ua.presentation;if(!Da)throw Error.argumentNull("Presentation is null");
if(ba){Da=Da.slides||[];ba=new gd.a(ba);for(let Qa=0;Qa<Da.length;Qa++)if(Da[Qa]&&gd.a.R2b(Da[Qa].Cb,ba))return Qa}return-1}nLl(ba){return ba?this.ic.Yka(new gd.a(ba)):null}notFound(){this.Cd.Jja&&this.Cd.Jja(null,null,!1,!1)}static zkj(ba,Da){if(Da)switch(ba){case 0:return 2;case 1:return 3}return ba}static nvg(ba,Da){return!Da||0===ba.status}}Ff.AYd="IsCompletedSearchInClient";Ff.ayi="ServerSearchStartTime";Ff.TIf="ServerSearchEndTime";Ff.BIf="IsServerSearchSucceeded";Ff.oxi="IsBRSOn";Object(h.a)(Ff,
"FindCommentLogic",null,[933,108]);var Jh=d(82);class Wf{constructor(){this.type=0;this.Jja=this.Vc=null;this.ZSd=!1}}Object(h.a)(Wf,"Entry",null,[]);class md{constructor(ba,Da){this.R8c=null;this.Up=ba;this.wb=Da;this.sna=[];this.BEe=0}dispose(){this.Up.dispose();this.sna=this.Up=null;Kb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.BEe)}R8d(ba,Da,Qa){this.enqueue(1,ba,Da,Qa)}Y8d(ba,Da,Qa){this.enqueue(0,ba,Da,Qa)}S8d(ba,Da){this.enqueue(2,ba,Da,!1)}enqueue(ba,Da,Qa,nb){Qa.Wa("AlreadyQueuedEntryCount",
this.sna.length.toString());ba=Object.assign(new Wf,{type:ba,Jja:(Wb,Jb,Uc,Jd)=>{Da(Wb,Jb,Uc,Jd);this.R8c=null;this.Ehh()},Vc:Qa,ZSd:nb});Array.enqueue(this.sna,ba);this.BEe=Math.max(this.BEe,this.sna.length);this.Ehh()}Ehh(){0<this.sna.length&&!this.R8c&&(this.R8c=new Jh.a(2,1,0,Object(sa.a)(this,this.MYk,"processOneEntry"),90,"49"),this.wb.Hb(this.R8c))}MYk(){const ba=Array.dequeue(this.sna);1===ba.type?this.Up.R8d(ba.Jja,ba.Vc,ba.ZSd):0===ba.type?this.Up.Y8d(ba.Jja,ba.Vc,ba.ZSd):this.Up.S8d(ba.Jja,
ba.Vc)}}Object(h.a)(md,"FindCommentLogicDecorator",null,[933,108]);var Gf=d(397),Hd=d(111);class Ee extends Hd.a{constructor(ba,Da){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===ba)throw Error.argumentNull("slideId");this.RequestType=Da;this.StartSlideId=ba.toString();this.FFindModernComments=!0}ul(){return 88}}Object(h.a)(Ee,"FindCommentRequest",Hd.a,[]);class Ki extends Gf.a{constructor(ba){super();this.gxa=null;this.DZg=0;this.fJa=this.vHa=null;this.enabled=
2;this.ZFb=0;this.Tk=!1;this.$m=ba;this.$m.register(this)}dispose(){this.Tk||(1===this._state&&this.$m.unregister(this),this.Tk=!0,this.ZFb=0)}find(ba,Da,Qa,nb){0<this.ZFb&&null!==Qa&&(Kb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.ZFb),Qa(null));this.gxa=ba;this.DZg=Da;this.SF(Qa,nb,null)}ila(){return 0<this.ZFb&&!this.Tk}jO(){return!1}ZUa(){return this.xtg||this.ila()}EMb(){if(1===this._state)this.Xd.XH=new Ee(this.gxa,this.DZg),this.Xd.status=1,this._state=
3;else if(3===this._state&&this.xtg)if(Kb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.Xd.Jqd,this.Xd.Is,this.Xd.fu),2===this.Xd.statusCode&&this.Xd.es&&1===this.Xd.es.length){const ba=this.Xd.es[0];0!==ba.StatusCode?this.UH(ba):this.C1(ba)}else this.UH()}SF(ba,Da){this.ZFb++;this.fJa=ba;this.vHa=Da;this.$m.Zaa()}forceOutbound(){}UH(ba=null){Kb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",
this.Xd.Iv,this.Xd.statusCode,ba?ba.StatusCode:-1);this.ubh(ba,!1)}C1(ba){this.ubh(ba,!0)}get xtg(){return!!this.Xd&&2===this.Xd.status}ubh(ba,Da){this.ZFb--;this._state=1;if(Da){Da=null;try{Da=Sys.Serialization.JavaScriptSerializer.deserialize(ba.FindCommentResult)}catch(Qa){Kb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",Qa)}this.fJa(Da)}else this.vHa(null,-1)}}Object(h.a)(Ki,"FindCommentReplicator",Gf.a,[108]);class wf{constructor(){this.nx=null;this.bzc=this.asf=this.vdf=this.DZb=
this.zxf=this.Upf=this.itf=!1}Cvj(){this.nx||(e.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.FAh());return this.nx}Roj(){return new Promise((ba,Da)=>{this.bzc?ba(this.lag()):this.Ayh().then(()=>{ba(this.lag())}).catch(Qa=>{Da(Qa)})})}lag(){this.bzc||e.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let ba;ba=33;this.vdf&&
(ba|=2);this.itf&&(ba|=8);this.zxf&&(ba|=16);this.Upf&&(ba|=4);this.DZb&&(ba|=64);this.asf&&(ba|=128);return ba}}Object(h.a)(wf,"OfficeSharedCommentsAppCapabilities",null,[1571]);class ag extends wf{constructor(ba,Da,Qa,nb,Wb,Jb){super();this.Ib=ba;this.Da=Da;this.DQg=Qa;this.Ubd=Jb;this.xtl(nb,Wb);this.FAh();this.Ayh()}xtl(ba,Da){pc.a("CheckTaskHostIsEnabledForOneDriveConsumer")&&this.pyl(ba)?this.DZb=!0:this.DZb=this.Ib.ka("TasksForCommentsEnabled")&&!ba;this.zxf=!1;this.itf=Da;this.asf=this.Upf=
!0}pyl(ba){return this.Ib.ka("TasksForCommentsEnabled")&&!ba&&this.Ib.ka("TasksHostIsEnabled")}FAh(){this.nx={};const ba=this.DZb&&this.Da.v8j;this.nx.CommentsFluentUI="true";this.nx.CommentTasks=this.DZb.toString();this.nx.DisabledChangeGates=this.Ib.Ha("DisabledChangeGatesInSharedComments");this.nx.DiscreteHostedComments="true";this.nx.CommentReactions=Fb(this.Ib).toString();this.nx.NewCommentButton="true";this.nx.PersonaColor="true";this.nx.LivePersonaPicker="true";this.nx.AtMentionFloodgateSurvey=
n.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.nx.CommentTasksFromReply=ba.toString();this.nx.LogDraftCommentIdPair=this.Ubd.toString();this.nx.HyperlinksInComments="true";this.nx.SmartReplies=this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.nx.TaskPaneWithNewInfrastructure=this.Da.m0d.toString();this.nx.NewSelectionInteractions="true";this.nx.ExtendedDrafting="true";this.nx.LinkToComment="true";this.nx.WebThemeIntegration=
"true";this.nx.TaskHistoryRecordIDs=this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()}Ayh(){return new Promise((ba,Da)=>{this.DQg?this.DQg.atMentionsEnabledAsync().then(Qa=>{this.vdf=Qa;this.bzc=!0;ba(this.bzc)}):(e.ULS.sendTraceTag(509645712,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),Da(D.a.qt(-2130915320)))})}}Object(h.a)(ag,"PPTSharedCommentAppCapabilities",
wf,[]);class Og{constructor(ba){this.Dg=ba}display(ba,Da){this.Dg.G$e(ba?0:2,Da);this.Dg.setVisibility()}dismiss(){this.Dg.KDi();this.Dg.setVisibility()}activate(){this.Dg.G$e(1);this.Dg.setVisibility()}rYi(ba){this.Dg.G$e(ba?0:2)}Bm(ba){this.Dg.Bm(ba)}kC(ba){this.Dg.kC(ba)}Mp(){return this.Dg.Mp()}PL(ba){return this.Dg.UAb(ba)}Xw(ba){this.Dg.Xw(ba)}dispose(){this.Dg.dispose()}ny(){this.Dg.ny()}ZC(ba){return this.Dg.ZC(ba)}TA(ba){return this.Dg.TA(ba)}draw(ba,Da){this.Dg.draw(ba,Da)}get visible(){return this.Dg.visible}set visible(ba){this.Dg.visible=
ba}setPosition(ba,Da){this.Dg.setPosition(ba,Da)}Kj(ba){this.Dg.Kj(ba)}wq(ba){this.Dg.wq(ba)}Ju(ba){this.Dg.Ju(ba)}setZIndex(ba){this.Dg.setZIndex(ba)}JD(ba,Da){this.Dg.JD(ba,Da)}setSelection(){}}Object(h.a)(Og,"ShapeCommentsAnchoredSelectionView",null,[965,282,283,108]);class Kh{constructor(ba,Da){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=ba;this.canvasContextId=
Da}}Object(h.a)(Kh,"CommentUIAction",null,[]);var Xg=d(65),Yd=d(659),ce=d(120),Rh=d(183),ng=d(176),Vi=d(1157),$h=d(542);class fg{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(h.a)(fg,"CurrentContextDraft",null,[]);class dk{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(dk,"IContentAnchorPosition",null,[]);class xi{constructor(){this.y=this.x=this.height=this.width=
0}}Object(h.a)(xi,"IViewportInfo",null,[]);class yh{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=null}}Object(h.a)(yh,"FloatingContainerManagerCreationParams",null,[]);var Lg=d(142),yi=d(53),Vd=d(840),lf=d(424),Zj=d(393),Cj=d(921),he;(function(ba){ba[ba.line=0]="line";ba[ba.lineInv=1]="lineInv";ba[ba.triangle=2]="triangle";ba[ba.rtTriangle=3]="rtTriangle";ba[ba.rect=4]="rect";
ba[ba.diamond=5]="diamond";ba[ba.parallelogram=6]="parallelogram";ba[ba.trapezoid=7]="trapezoid";ba[ba.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";ba[ba.pentagon=9]="pentagon";ba[ba.hexagon=10]="hexagon";ba[ba.heptagon=11]="heptagon";ba[ba.octagon=12]="octagon";ba[ba.decagon=13]="decagon";ba[ba.dodecagon=14]="dodecagon";ba[ba.star4=15]="star4";ba[ba.star5=16]="star5";ba[ba.star6=17]="star6";ba[ba.star7=18]="star7";ba[ba.star8=19]="star8";ba[ba.star10=20]="star10";ba[ba.star12=21]="star12";ba[ba.star16=
22]="star16";ba[ba.star24=23]="star24";ba[ba.star32=24]="star32";ba[ba.roundRect=25]="roundRect";ba[ba.round1Rect=26]="round1Rect";ba[ba.round2SameRect=27]="round2SameRect";ba[ba.round2DiagRect=28]="round2DiagRect";ba[ba.snipRoundRect=29]="snipRoundRect";ba[ba.snip1Rect=30]="snip1Rect";ba[ba.snip2SameRect=31]="snip2SameRect";ba[ba.snip2DiagRect=32]="snip2DiagRect";ba[ba.plaque=33]="plaque";ba[ba.ellipse=34]="ellipse";ba[ba.teardrop=35]="teardrop";ba[ba.homePlate=36]="homePlate";ba[ba.chevron=37]=
"chevron";ba[ba.pieWedge=38]="pieWedge";ba[ba.pie=39]="pie";ba[ba.blockArc=40]="blockArc";ba[ba.donut=41]="donut";ba[ba.noSmoking=42]="noSmoking";ba[ba.rightArrow=43]="rightArrow";ba[ba.leftArrow=44]="leftArrow";ba[ba.upArrow=45]="upArrow";ba[ba.downArrow=46]="downArrow";ba[ba.stripedRightArrow=47]="stripedRightArrow";ba[ba.notchedRightArrow=48]="notchedRightArrow";ba[ba.bentUpArrow=49]="bentUpArrow";ba[ba.leftRightArrow=50]="leftRightArrow";ba[ba.upDownArrow=51]="upDownArrow";ba[ba.leftUpArrow=52]=
"leftUpArrow";ba[ba.leftRightUpArrow=53]="leftRightUpArrow";ba[ba.quadArrow=54]="quadArrow";ba[ba.leftArrowCallout=55]="leftArrowCallout";ba[ba.rightArrowCallout=56]="rightArrowCallout";ba[ba.upArrowCallout=57]="upArrowCallout";ba[ba.downArrowCallout=58]="downArrowCallout";ba[ba.leftRightArrowCallout=59]="leftRightArrowCallout";ba[ba.upDownArrowCallout=60]="upDownArrowCallout";ba[ba.quadArrowCallout=61]="quadArrowCallout";ba[ba.bentArrow=62]="bentArrow";ba[ba.uturnArrow=63]="uturnArrow";ba[ba.circularArrow=
64]="circularArrow";ba[ba.leftCircularArrow=65]="leftCircularArrow";ba[ba.leftRightCircularArrow=66]="leftRightCircularArrow";ba[ba.curvedRightArrow=67]="curvedRightArrow";ba[ba.curvedLeftArrow=68]="curvedLeftArrow";ba[ba.curvedUpArrow=69]="curvedUpArrow";ba[ba.curvedDownArrow=70]="curvedDownArrow";ba[ba.swooshArrow=71]="swooshArrow";ba[ba.cube=72]="cube";ba[ba.can=73]="can";ba[ba.lightningBolt=74]="lightningBolt";ba[ba.heart=75]="heart";ba[ba.sun=76]="sun";ba[ba.moon=77]="moon";ba[ba.smileyFace=
78]="smileyFace";ba[ba.irregularSeal1=79]="irregularSeal1";ba[ba.irregularSeal2=80]="irregularSeal2";ba[ba.foldedCorner=81]="foldedCorner";ba[ba.bevel=82]="bevel";ba[ba.frame=83]="frame";ba[ba.halfFrame=84]="halfFrame";ba[ba.corner=85]="corner";ba[ba.diagStripe=86]="diagStripe";ba[ba.chord=87]="chord";ba[ba.arc=88]="arc";ba[ba.leftBracket=89]="leftBracket";ba[ba.rightBracket=90]="rightBracket";ba[ba.leftBrace=91]="leftBrace";ba[ba.rightBrace=92]="rightBrace";ba[ba.bracketPair=93]="bracketPair";ba[ba.bracePair=
94]="bracePair";ba[ba.straightConnector1=95]="straightConnector1";ba[ba.bentConnector2=96]="bentConnector2";ba[ba.bentConnector3=97]="bentConnector3";ba[ba.bentConnector4=98]="bentConnector4";ba[ba.bentConnector5=99]="bentConnector5";ba[ba.curvedConnector2=100]="curvedConnector2";ba[ba.curvedConnector3=101]="curvedConnector3";ba[ba.curvedConnector4=102]="curvedConnector4";ba[ba.curvedConnector5=103]="curvedConnector5";ba[ba.callout1=104]="callout1";ba[ba.callout2=105]="callout2";ba[ba.callout3=106]=
"callout3";ba[ba.accentCallout1=107]="accentCallout1";ba[ba.accentCallout2=108]="accentCallout2";ba[ba.accentCallout3=109]="accentCallout3";ba[ba.borderCallout1=110]="borderCallout1";ba[ba.borderCallout2=111]="borderCallout2";ba[ba.borderCallout3=112]="borderCallout3";ba[ba.accentBorderCallout1=113]="accentBorderCallout1";ba[ba.accentBorderCallout2=114]="accentBorderCallout2";ba[ba.accentBorderCallout3=115]="accentBorderCallout3";ba[ba.wedgeRectCallout=116]="wedgeRectCallout";ba[ba.wedgeRoundRectCallout=
117]="wedgeRoundRectCallout";ba[ba.wedgeEllipseCallout=118]="wedgeEllipseCallout";ba[ba.cloudCallout=119]="cloudCallout";ba[ba.cloud=120]="cloud";ba[ba.ribbon=121]="ribbon";ba[ba.ribbon2=122]="ribbon2";ba[ba.ellipseRibbon=123]="ellipseRibbon";ba[ba.ellipseRibbon2=124]="ellipseRibbon2";ba[ba.leftRightRibbon=125]="leftRightRibbon";ba[ba.verticalScroll=126]="verticalScroll";ba[ba.horizontalScroll=127]="horizontalScroll";ba[ba.wave=128]="wave";ba[ba.doubleWave=129]="doubleWave";ba[ba.plus=130]="plus";
ba[ba.flowChartProcess=131]="flowChartProcess";ba[ba.flowChartDecision=132]="flowChartDecision";ba[ba.flowChartInputOutput=133]="flowChartInputOutput";ba[ba.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";ba[ba.flowChartInternalStorage=135]="flowChartInternalStorage";ba[ba.flowChartDocument=136]="flowChartDocument";ba[ba.flowChartMultidocument=137]="flowChartMultidocument";ba[ba.flowChartTerminator=138]="flowChartTerminator";ba[ba.flowChartPreparation=139]="flowChartPreparation";ba[ba.flowChartManualInput=
140]="flowChartManualInput";ba[ba.flowChartManualOperation=141]="flowChartManualOperation";ba[ba.flowChartConnector=142]="flowChartConnector";ba[ba.flowChartPunchedCard=143]="flowChartPunchedCard";ba[ba.flowChartPunchedTape=144]="flowChartPunchedTape";ba[ba.flowChartSummingJunction=145]="flowChartSummingJunction";ba[ba.flowChartOr=146]="flowChartOr";ba[ba.flowChartCollate=147]="flowChartCollate";ba[ba.flowChartSort=148]="flowChartSort";ba[ba.flowChartExtract=149]="flowChartExtract";ba[ba.flowChartMerge=
150]="flowChartMerge";ba[ba.flowChartOfflineStorage=151]="flowChartOfflineStorage";ba[ba.flowChartOnlineStorage=152]="flowChartOnlineStorage";ba[ba.flowChartMagneticTape=153]="flowChartMagneticTape";ba[ba.flowChartMagneticDisk=154]="flowChartMagneticDisk";ba[ba.flowChartMagneticDrum=155]="flowChartMagneticDrum";ba[ba.flowChartDisplay=156]="flowChartDisplay";ba[ba.flowChartDelay=157]="flowChartDelay";ba[ba.flowChartAlternateProcess=158]="flowChartAlternateProcess";ba[ba.flowChartOffpageConnector=159]=
"flowChartOffpageConnector";ba[ba.actionButtonBlank=160]="actionButtonBlank";ba[ba.actionButtonHome=161]="actionButtonHome";ba[ba.actionButtonHelp=162]="actionButtonHelp";ba[ba.actionButtonInformation=163]="actionButtonInformation";ba[ba.actionButtonForwardNext=164]="actionButtonForwardNext";ba[ba.actionButtonBackPrevious=165]="actionButtonBackPrevious";ba[ba.actionButtonEnd=166]="actionButtonEnd";ba[ba.actionButtonBeginning=167]="actionButtonBeginning";ba[ba.actionButtonReturn=168]="actionButtonReturn";
ba[ba.actionButtonDocument=169]="actionButtonDocument";ba[ba.actionButtonSound=170]="actionButtonSound";ba[ba.actionButtonMovie=171]="actionButtonMovie";ba[ba.gear6=172]="gear6";ba[ba.gear9=173]="gear9";ba[ba.funnel=174]="funnel";ba[ba.mathPlus=175]="mathPlus";ba[ba.mathMinus=176]="mathMinus";ba[ba.mathMultiply=177]="mathMultiply";ba[ba.mathDivide=178]="mathDivide";ba[ba.mathEqual=179]="mathEqual";ba[ba.mathNotEqual=180]="mathNotEqual";ba[ba.cornerTabs=181]="cornerTabs";ba[ba.squareTabs=182]="squareTabs";
ba[ba.plaqueTabs=183]="plaqueTabs";ba[ba.chartX=184]="chartX";ba[ba.chartStar=185]="chartStar";ba[ba.chartPlus=186]="chartPlus"})(he||(he={}));Object(h.b)("ST_ShapeType",he);var ij=d(158);class Rf{constructor(){this.RowId=this.ColId=null}}Object(h.a)(Rf,"TableCellInfo",null,[]);var zh=d(920),Sh=d(52),jj=d(189),Dj=d(125),Ah=d(172),hf=d(1154),rg=d(945),Ej=d(946),Li=d(358),Gh=d(107);class hg{constructor(ba,Da){this.Rwa=this.PDb=null;this.AMg=!1;this.gHe=ba;this.Gg=Da}get K7j(){return this.AMg}mMb(ba,
Da){Da&&ba.removeNotification(Da);return Da}f$k(ba){this.PDb=this.mMb(ba,this.PDb);this.mMb(ba,this.Rwa);this.Rwa=this.PDb=null}LBl(ba,Da,Qa){ba?this.gHe.Om.isVisible&&1===ba.dN.length&&Da.Ba&&gd.a.mba(ba.s$a.Cb,Da.Ba.Cb)||eg.UISurfaces.KL().then(nb=>{this.Rwa=this.mMb(nb,this.Rwa);this.Rwa=null;var Wb=Object.assign(new hf.a,{label:ba.TKb,onExecute:()=>{ba.primaryButtonAction(this.gHe,Da);Da.Ba.qe!==ba.s$a.qe&&Qa.dK(ba.s$a.qe);this.mMb(nb,this.Rwa);this.Rwa=null}}),Jb=Object.assign(new hf.a,{label:ba.asd,
onExecute:()=>{this.AMg=!0;this.mMb(nb,this.Rwa);this.Rwa=null}});Jb=Object.assign(new rg.a,{target:".EditingRibbonPanel",title:ba.title,content:ba.content,primaryButtonProps:Wb,secondaryButtonProps:Jb,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new Ej.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.Gg.Eo(Nd.a.O1a)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Wb=Object.assign(new Li.a,{onShow:()=>{this.Gg.hL(Nd.a.O1a)}});Jb=nb.callout(Jb);this.Rwa=
nb.addNotification(Jb,Wb)}):Kb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}rEh(ba,Da){const Qa=new Gh.StandardDialog;Qa.Ad=4;Qa.Tx(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,Da?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,nb=>{1===nb?(ba.B4b(Da),this.gHe.W7d(Da)?this.sEh():this.qEh(Da?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:
ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Kb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Da)):Kb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",Da)})}sEh(){const ba=new Gh.StandardDialog;ba.Ad=0;ba.Tx(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,
null)}qEh(ba){const Da=()=>{this.Gg.hL(Nd.a.O1a)},Qa=()=>{this.Gg.Eo(Nd.a.O1a)};eg.UISurfaces.KL().then(nb=>{this.mMb(nb,this.PDb);this.PDb=null;var Wb=Object.assign(new rg.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:ba,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new Ej.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Qa,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const Jb=Object.assign(new Li.a,{onShow:Da});Wb=nb.callout(Wb);
this.PDb=nb.addNotification(Wb,Jb)})}}Object(h.a)(hg,"CommentCalloutDialogManager",null,[]);var Lh=d(987);class La{constructor(ba){this.jIa=ba;this.sna=[];this.bxe=new Lh.a(1E3,Object(sa.a)(this,this.perform,"perform"))}MUk(ba){Array.contains(this.sna,ba)||Array.add(this.sna,ba);this.bxe.perform()}perform(){const ba=this.sna;this.sna=[];for(let Da=0;Da<ba.length;Da++){const Qa=ba[Da];this.jIa.tIb(Qa.commentId,new wc.a(Qa.pos.X,Qa.pos.Y))}}}Object(h.a)(La,"CommentKeyboardMoveController",null,[]);class lb{constructor(ba,
Da,Qa,nb,Wb){this.QGa=this.Uwa=null;this.xfa=[];if(!ba)throw Error.argumentNull("parentElement");if(!Da)throw Error.argumentNull("frame");this.MFb=Qa;this.Uk=ba;this.kb=Da;this.DFg=nb;this.LFg=Wb}dispose(){this.DWe();this.kb=this.Uk=null}DWe(){this.QGa=this.Uwa=null;if(this.xfa&&0<this.xfa.length){for(const ba of this.xfa)ba&&ba.dispose();Array.clear(this.xfa)}}O_(ba){if(!this.pEa)return!0;if(!ba||!ba.length)return!1;ba=Ah.e(ba,Da=>0===Da.status);return!!ba&&0<ba.length}Bpd(ba){this.DWe();if(ba&&
this.Uk){var Da=this.kb.isReadOnly?null:this.kb.su;for(const Qa of ba)this.xfa.push(this.MFb.create(Qa,this.Uk,this,Da,this.kb.isReadOnly,dc.bO(Qa)||!this.LFg));this.O_(ba)&&this.iaf()}}selectComment(ba,Da){if(!(!ba&&!this.Uwa||this.Uwa&&dc.mxb(ba,this.Uwa.comment))&&(this.Uwa&&this.Uwa.select(!1),this.Uwa=null,ba))for(const Qa of this.xfa){if(dc.mxb(Qa.comment,ba)){this.Uwa=Qa;Qa.select(!0);break}if(Da&&Qa.comment.Children)for(const nb of Qa.comment.Children)if(dc.mxb(nb,ba)){this.Uwa=Qa;Qa.select(!0);
return}}}Gsb(ba,Da){if(!(!ba&&!this.QGa||this.QGa&&dc.mxb(ba,this.QGa.comment))&&(this.QGa&&this.QGa.activate(!1),this.QGa=null,ba))for(const Qa of this.xfa){if(dc.mxb(Qa.comment,ba)){this.QGa=Qa;Qa.activate(!0);break}if(Da&&Qa.comment.Children)for(const nb of Qa.comment.Children)if(dc.mxb(nb,ba)){this.QGa=Qa;Qa.activate(!0);return}}}HEh(ba){for(const Da of this.xfa)Da.GEh(ba)}iaf(){for(const ba of this.xfa)ba.updatePosition(this.kb.pDa(ba.comment.pos.X,ba.comment.pos.Y))}tIb(ba,Da){Da=this.kb.KPf(Da._x,
Da._y);ba.pos.X+=Da._x;ba.pos.Y+=Da._y;Da=new wc.a(ba.pos.X,ba.pos.Y);this.kb.selectComment(ba,null,!0,!1,0,1,!1);this.kb.manager.tIb(ba.commentId,Da)}STl(ba){for(const Da of this.xfa)if(Da.comment===ba){Da.updatePosition(this.kb.pDa(Da.comment.pos.X,Da.comment.pos.Y));break}}TTl(ba){for(const Da of ba)for(const Qa of this.xfa)Qa.comment.commentId===Da.commentId&&Qa.updatePosition(this.kb.pDa(Qa.comment.pos.X,Qa.comment.pos.Y))}setVisibility(ba){this.LFg=ba;for(const Da of this.xfa)Da.setVisibility(!dc.bO(Da.comment)&&
ba)}get frame(){return this.kb}get isRightToLeft(){return this.DFg}set isRightToLeft(ba){this.DFg=ba}get parentElement(){return this.Uk}set parentElement(ba){this.Uk=ba}get yNb(){return this.Uwa}get pEa(){return!!n.AFrameworkApplication.fa&&n.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(lb,"CommentMarkerView",null,[]);class Ob{static uDa(ba,Da,Qa,nb,Wb,Jb,Uc){const Jd=yd.a.xB();Jd.alt=Jb;Jd.className=Fc.getImageClassWithCluster(Da,Wb);Jd.setAttribute(bb.a.hf,bb.a.Ou);
Jd.src=ba.qk(Da+".png");Jd.setAttribute("Unselectable","on");ba=yd.a.Hl();ba.className=Qa+" cui-img-cont-float";ba.setAttribute(bb.a.hf,bb.a.Ou);ba.appendChild(Jd);Qa=yd.a.Hl();Qa.className=nb;Qa.setAttribute("Unselectable","on");Qa.setAttribute(bb.a.hf,bb.a.Ou);Qa.appendChild(ba);nb=yd.a.mda();nb.className=Ob.vil+" cui-ctl";nb.title=Jb;nb.setAttribute(bb.a.hf,bb.a.Ou);nb.setAttribute(bb.a.fr,Jb);nb.appendChild(Qa);Uc&&(Jb=yd.a.Hl(),Jb.className="cui-ctl-mediumlabel",Jb.setAttribute("Unselectable",
"on"),Jb.setAttribute(bb.a.hf,bb.a.Ou),Jb.innerText=Uc,nb.appendChild(Jb));return nb}static vDa(ba,Da){return Ob.uDa(ba,ba.qT,"cui-img-16by16","cui-ctl-iconContainer",Da,CommonUIStrings.l_DialogClose,null)}}Ob.til="CommentPaneLTR";Ob.uil="CommentPaneRTL";Ob.vil="CommentPaneWithBorderButton";Object(h.a)(Ob,"CommentPaneHelper",null,[]);class mc{constructor(){this.comment=this.slide=null;this.direction=0;this.t_e=null}}Object(h.a)(mc,"CommentSelectContext",null,[]);var Rc;(function(ba){ba[ba.previous=
0]="previous";ba[ba.next=1]="next"})(Rc||(Rc={}));Object(h.b)("CommentSelectDirection",Rc);class Ud{constructor(ba,Da){if(!ba||1>ba.length)throw Error.argument("ISlideNode[] slides");if(!Da)throw Error.argumentNull("ICommentGraphManager graphManager");this.Guk=ba;this.xl=Da;this.EGe=[];this.init()}get oKa(){return this.Guk}get dN(){return this.EGe}get s$a(){return this.dN[this.dN.length-1]}get TKb(){return 1<this.dN.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get asd(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.iDl()}init(){for(const ba of this.oKa)for(const Da of this.xl.Tta(ba.nE()))if(1===
Da.status){this.EGe.push(ba);break}if(1>this.EGe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}iDl(){switch(this.dN.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.dN[1].qe+1,this.dN[0].qe+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.dN[2].qe+1,this.dN[1].qe+1,this.dN[0].qe+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.dN[3].qe+1,this.dN[2].qe+1,this.dN[1].qe+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.dN[this.dN.length-1].qe+1,this.dN[this.dN.length-2].qe+1,this.dN[this.dN.length-3].qe+1,this.dN.length-3)}}Mkj(){for(const ba of this.xl.T$a(this.s$a))if(1===ba.status)return ba;return null}primaryButtonAction(ba,Da){if(!Da.presentation||!Da.presentation.slides)return Kb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
Da.presentation?"Presentation.Slides":"Presentation"),null;const Qa=this.Mkj();if(!Qa)return null;ba.Om.isVisible||ba.fvd();if(Da.Ba&&gd.a.mba(Da.Ba.Cb,this.s$a.Cb))ba.Jga(Qa.commentId,1,!0);else for(const nb of Da.presentation.slides)if(gd.a.mba(nb.Cb,this.s$a.Cb))return Object.assign(new mc,{slide:this.s$a,comment:Qa,direction:1,t_e:af.a.Jj("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(Ud,"ResolvedCommentsCalloutParams",null,[]);class ue{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(h.a)(ue,"SharedCommentsTaskPaneProps",null,[]);var Xe=d(997),pe=d(380),gg=d(153);class cg{constructor(ba,Da,Qa,nb,Wb,Jb,Uc,Jd,ne,bf,sd,vd,$c,hd,Dd,Re,ml,Mh,we,Yi,nl,Pj,ol,mi,nk,ek,bj,Nk,Qj,Nf,Bg,Xk,Ni,nh,ni,ye,Dg,Fj,Gj,xj,Rj,Bl,Cl,Th,hi,Yk,cj,Am,Pl,Dl,ii,oh,ok,ya,qd,ea,Ok,kj){this.ZGe=this.Fn=null;this.Ieb=!0;this.Vn=this.Xye=this.pgc=this.Eye=this.Keb=!1;this.Wfb=0;this.sed=this.VGb=!1;this.eHa=this.ydd=this.ni=this.dXa=this.Zgb=this.daa=this.cAg=null;this.FFg=this.jYa=
!1;this.Sr=null;this.mHe=this.oye=!1;this.JZg=null;this.rIf=[Nd.a.Qz,Nd.a.hr,Nd.a.LW,Nd.a.wGi];this.$nb=2147483647;this.bDb=0;this.aOg=-1;this.ZBg=0;this.Gic=null;this.Acd=this.kdd=this.mwe=!1;this.aKa=(Ek,Uf)=>{Uf.slide===this.ua.Ba&&(Ek=this.GR.instance.Xge||this.GR.instance.Yge,!Uf.slide.isUnread||Ek)&&(Uf=this.xl.qz(),this.bMb(Uf,n.AFrameworkApplication.isRtl,!0))};if(!ye)throw Error.argumentNull("appSettingsManager");if(!Pj)throw Error.argumentNull("commentEventHost");if(!Da)throw Error.argumentNull("commentTelemetryManager");
if(ok.Xn&&!kj)throw Error.argumentNull("sorterViewActorLazy");this.LJ=ii;this.ia=Qa;this.Rb=nb;this.Om=Wb;this.su=Jb;this.Rc=Uc;this.Fa=Jd;this.Gg=ne;this.le=bf;this.pa=sd;this.Kc=$c;this.Yv=hd;this.Ys=Dd;this.xl=ba;this.zE=Da;this.Eok=new La(ba);this.E5=Re;this.ua=ml;this.Jfd=Mh.zd(40);this.mQg=pc.a("PreventCommentDraftDeletionOnPageContentChange")?Mh.zd(7):Mh.zd(8);this.jGb=vd;this.WO=$c.Hc?$c.Hc.f0d:null;this.jwa=nk;this.wb=Yi;this.K0=Pj;this.Ghb=ol;this.$Og=nl;this.jed=mi;this.nwe=ek;this.s9c=
bj;this.xe=Nf;this.tcd=Nk;this.Vq=Qj;this.N7c=Bg;this.Xs=Xk;this.MFb=Ni;this.LR=nh;this.qo=ni;this.Ib=ye;this.Sp=Fj;this.iFg=Gj;this.W4=new r.a;this.Vd=xj;this.Ya=Rj;this.Vgb=Cl;this.Uva=Bl;this.Fc=Th;this.Ga=cj;this.Jtk=Am;this.GJ=Pl;this.tgc=Dl;this.Da=ok;this.qm=ya;this.QX=qd;this.mgc=Yk;this.ZHa=!1;this.ia.Oaa(this);this.feb=new hg(this,this.Gg);this.GR=ea;this.k1=Ok;this.Ina=kj;if(!Dg)throw Error.argumentNull("InteractiveViewManagerFuture");this.TIg=Dg;this.kik=this.rMi();this.LJ&&this.Om.Dol(this.Fqj());
this.Tb=oh;hi.Nvb().then(Ek=>{Ek||this.p0e(!1)})}get SSc(){return this.iFg}get a8d(){return this.Ib.ka("195")}get F0f(){return this.Uva}get v4b(){return this.Ib.Ha("CurrentCommentId")}get M3d(){return this.Ib.Ha("CurrentSlideId")}get gWk(){return this.Ib.ka("PPTSafeLinksIsEnabledForModernComments")}get KGi(){return this.Ib.ka("CommentTextAnchoringReadWriteEnabled")}get j0d(){return this.Ib.ka("CommentTextAnchoringCreateNewEnabled")}get qYf(){return this.Ib.ka("EnableDeleteAllComments")}get pEa(){return this.Ib.ka("SlideResizePerfImprovementEnabled")}get Qwb(){return pc.a("CompactingDHCsEnabled")}get v0f(){return pc.a("CanvasToCommentFocusFixV2")}get Yac(){return this.Ib.ka("PPTOBlueDotsForComments")}initialize(){this.Vn=
1===this.Rb.mode;this.LJ||(this.jwa?Sys.UI.DomElement.addCssClass(this.jGb,Ob.uil):Sys.UI.DomElement.addCssClass(this.jGb,Ob.til));const ba=this.Fa.Ic(Nd.a.hr);ba.zJ=!0;ba.h3a=!0;ba.Oca(Qa=>{const nb=!pc.a("FixAltF12KeboardingInCommentPane")||!Qa||Qa.name!==Nd.a.sS;this.jnc(!0,!Qa||Qa.name!==Nd.a.Qz&&nb,!0)});ba.vCa((Qa,nb)=>{Qa=(nb.name===Nd.a.qP||nb.name===Nd.a.Waa)&&Qa.name===Nd.a.hr;this.jnc(!1,!1,nb.name===Nd.a.hr||nb.name===Nd.a.qg||nb.name===Nd.a.Qz||nb.name===Nd.a.LW||nb.name===Nd.a.sS||Qa)});
const Da=this.Fa.Ic(Nd.a.Qz);Da.Oca((Qa,nb)=>{this.LKk(Qa,nb)});Da.vCa(()=>{this.KKk()});this.LJ||this.Rc.hMb(Ka.a.click,this.jGb,Object(sa.a)(this,this.dJb,"onCommentPaneParentDivClick"),null,ba.h3a);this.vb();this.Yv.rUd(Object(sa.a)(this,this.SJa,"onBeforeSlideSwitched"));this.Yv.eT(Object(sa.a)(this,this.J$e,"updateCommentsWhenNavigateSlide"));this.Ys.NQa(Object(sa.a)(this,this.zyf,"activeSlideDOMDisplayed"));this.Vq.uki(Object(sa.a)(this,this.tch,"onPageViewZoomChanged"));this.Sp.OUd(Object(sa.a)(this,
this.onShapeSelected,"onShapeSelected"));this.Sp.EBf(Object(sa.a)(this,this.A_a,"onShapeDeselected"));this.Yv.$sb(Object(sa.a)(this,this.Ddh,"onShapeTextSelected"));this.Yv.PUd(Object(sa.a)(this,this.Pnc,"onSlideBackgroundClicked"));this.mgc&&(this.Yv.Z_b(Object(sa.a)(this,this.rMk,"onSlideSizeUpdated")),this.Yv.cli(Object(sa.a)(this,this.Bdh,"onShapeRotatedOrBoundsUpdated")),this.Yv.Zki(Object(sa.a)(this,this.Bdh,"onShapeRotatedOrBoundsUpdated")));this.Jfd.gk(Object(sa.a)(this,this.yeh,"onTextAnchorPropertyChanged"));
this.mQg.KF(Object(sa.a)(this,this.cC,"onChildTopologyChanged"));this.Jfd.ACa(Object(sa.a)(this,this.u$g,"onBeforeTextAnchorDisconnect"));this.Vgb.gk(Object(sa.a)(this,this.Lnc,"onShapePropertyChange"));this.Vgb.rki(Object(sa.a)(this,this.wdh,"onShapeInvalidation"));this.Fc.oii(Object(sa.a)(this,this.Fah,"onF6FocusDocument"));this.Fc.SJc(Object(sa.a)(this,this.Gib,"onSetFocus"));this.Yac&&this.k1.execute(Qa=>{Qa.bKc(this.aKa)});this.N7c.LUd(Object(sa.a)(this,this.Pkd,"onSessionExpired"));this.N7c.GC(Object(sa.a)(this,
this.Oxa,"onSessionEnded"));this.Kc.Hc&&this.Kc.Hc.f0d&&(this.SJa(this,null),this.J$e(this,null));this.Rb.MI(Object(sa.a)(this,this.b$g,"onAppModeSwitched"));this.Rb.QQa(Object(sa.a)(this,this.HY,"onSetOffline"));this.Ys.Zsb(Object(sa.a)(this,this.Rkd,"onShapeViewElementAddedOrRemoved"));this.Ys.GBf(Object(sa.a)(this,this.Rkd,"onShapeViewElementAddedOrRemoved"));this.pa.FC(Object(sa.a)(this,this.CD,"onSelectionChanged"))}Rkd(ba,Da){this.Fn&&(ba=Da.$w)&&ba.shapeNode&&this.W6j(ba.shapeNode.slideId)&&
this.Fn.Bpd(this.xl.qz())}W6j(ba){return!!this.ua&&!!this.ua.pk&&this.ua.pk.equals(ba)}p0e(ba){this.Uva=this.iFg=ba;this.qo.p0e(ba)}rMk(){this.Fn&&this.Fn.iaf()}Bdh(ba,Da){if(this.Fn){const Qa=Da.$w.shapeNode;if(Qa){if((ba=this.xl.qz())&&ba.length){Da=[];for(const nb of ba)nb.anchorShape===Qa.get_shapeId()&&Da.push(nb);this.Fn.TTl(Da)}}else Kb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}rTl(){try{if(this.Om){const ba=Object(mb.a)(955,this.Om);ba&&(ba.kDh=
!!this.ni)}}catch(ba){Kb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",ba)}}A0f(){return this.ni&&this.ni.W8&&this.ua.Ba?!gd.a.mba(this.ni.W8,this.ua.Ba.Cb):!1}fxb(){return this.ni&&this.ua.Ba?!this.ni.W8||gd.a.mba(this.ni.W8,this.ua.Ba.Cb):!1}ish(){if(this.Sr&&this.Sr.isIntegratedExtensionEnabled()){const ba=this.xl.qz(),Da=!this.pEa||!this.ZHa;ba&&0<ba.length&&(this.hS(!0,!0,Da),this.uqd());this.fxb()&&this.hsh(this.ni)}}dKk(){if(this.Sr){this.rTl();
this.ish();const ba=this.vNb;ba&&0!==ba.status&&this.fNa(1)}}eKk(){this.F4b();const ba=!this.pEa||!(this.O_()&&this.ZHa);this.hS(!1,!1,ba)}rKk(ba){this.bDb!==ba&&(this.bDb=ba,this.Kc&&this.Kc.Hc&&this.Kc.Hc.KQh(2,!1,this.bDb))}Elg(){const ba=Object.assign(new yh,{paneClosedCallback:Object(sa.a)(this,this.dKk,"onPaneClosedCallback"),paneOpenedCallback:Object(sa.a)(this,this.eKk,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(sa.a)(this,this.rKk,"onPositionUpdatedScrollHeightCallback")});
ba.allContainersVisibleCallback=Object(sa.a)(this,this.QEk,"onAllContainersVisible");this.Sr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(ba)}GSj(){this.gWk&&this.Jtk.execute(ba=>{const Da=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();Da?Da.registerSafelinksNavigator(Object(sa.a)(ba,ba.Fyd,"tryNavigate")):Kb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}lQj(){this.Elg();
this.hS(!0,!1,!0);this.oye=!0;const ba=this.O7b();Db.a.Hpd(ba,[Ka.a.contextMenu]);if(this.Sr){this.Sr.setDhcContainerPanel(ba,this.jwa);var Da=Object.assign(new xi,{width:parseFloat(ba.style.width),height:this.$nb,x:0,y:0});this.Sr.updateViewport(Da);this.Sr.setCompactContainers(this.Qwb)}this.uqd();this.zE.tHk(this.ua.pk);Da=this.Fa.Ic(Nd.a.LW);Da.zJ=!0;Da.h3a=!0;Da.Oca(Qa=>{this.jnc(!0,!Qa||Qa.name!==Nd.a.Qz,!0)});Da.vCa((Qa,nb)=>{Qa=(nb.name===Nd.a.qP||nb.name===Nd.a.Waa)&&Qa.name===Nd.a.LW;this.jnc(!1,
!1,nb.name===Nd.a.hr||nb.name===Nd.a.qg||nb.name===Nd.a.Qz||nb.name===Nd.a.LW||nb.name===Nd.a.sS||Qa)});this.Fa.S_c(Nd.a.LW,Nd.a.$i,ba);this.kph();this.ia.ya(fe.a.j2,Ya.a.frame,Object(sa.a)(this,this.j2,"showHideComments"))}uqd(){const ba=this.xl.qz();this.esh(ba)}kph(){if(this.Sr){const ba=this.O7b();if(ba){const Da=this.Fa.Ic(Nd.a.LW);this.Rc.hMb(Ka.a.click,ba,Object(sa.a)(this,this.dJb,"onCommentPaneParentDivClick"),null,Da.h3a)}}}ZOh(){if(this.Sr){const ba=this.O7b();ba&&this.Rc.Bb(Ka.a.click,
ba,Object(sa.a)(this,this.dJb,"onCommentPaneParentDivClick"))}}O7b(){const ba=this.Kc&&this.Kc.Hc?this.Kc.Hc.hda:null;return ba?ba.xa:null}esh(ba){if(this.Kc.Hc&&this.oye){if(!this.Sr)try{this.Elg(),Kb.a.J(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.Sr)}catch(nb){Kb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",nb);return}var Da=Date.now();if((ba=this.VUf(ba))&&
ba.length){var Qa=this.O7b();Qa.setAttribute(bb.a.hf,"group");if(Qa){this.W4=this.Kgj(ba);Kb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.W4.count);if(!this.W4.count&&!this.OVa){this.hS(!1,!1,!0);Kb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-Da);return}this.Sr.setDhcContainerPanel(Qa,this.jwa);this.Sr.attachContainers(this.W4.toArray());this.hS(!0,!1,!0)}Kb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",
Date.now()-Da)}}}VUf(ba){if(!ba||!ba.length)return ba;const Da=new r.a;for(const Qa of ba)0!==Qa.status?this.UUf(Qa.commentId):Da.add(Qa);return Da.toArray()}UUl(){this.mwe=!1;if(!this.qo.cGh&&!this.qo.RW&&this.Kc.Hc){var ba=this.xl.T$a(this.Kc.Hc.$c);for(const Da of ba)if(0===Da.status){this.selectComment(Da,null,!0,!0,0,0,!1);break}}}cwj(){if(!this.Kc||!this.Kc.Hc||!this.Kc.Hc.$c)return this.$nb;var ba=this.Kc.Hc.$c;if(isNaN(ba.Xk))return this.$nb;ba=ba.Xk;return 0>ba?this.$nb:ba}O5f(ba){var Da=
this.qo.a9(ba);ba=ba.pos.Y;Da&&(ba+=Da.mC.y,Da.Ug&&(Da=this.Ga.Fs(Da),ba+=Da&&Da.mC?Da.mC.y:0));return this.pDa(0,ba).y}N$e(){if(this.Sr){const ba=this.cwj();ba!==this.aOg&&(this.aOg=ba,this.Sr.setSlideHeight(ba))}}hsh(ba){if(ba&&0===ba.VRa){var Da=0;if(this.Qwb)Da=-this.$nb,this.N$e();else{const Qa=this.pa.Ll();Qa&&(Da=this.pDa(0,Qa.mC.y).y)}Da=Object.assign(new dk,{contentId:ba.TC.draftId,containerContentType:0,anchorTop:Da,anchorLeft:0});this.hS(!0,!0,!0);this.Sr.setDhcContainerPanel(this.O7b(),
this.jwa);this.Sr.updateDrafting(Da,!0);this.Sr.selectContainer(ba.TC.draftId,!0)}}Tdl(ba){if(this.W4){var Da=0,Qa="";if(this.Qwb){var nb=this.pa.Ll();nb&&(Da=this.pDa(0,nb.mC.y).y);if(nb=this.xl.qz())for(const Wb of nb)Ib.a.Xa(Wb.commentId)||this.O5f(Wb)!==Da||(Qa=Wb.commentId)}Da=Object.assign(new dk,{contentId:ba,containerContentType:0,anchorTop:Da,anchorLeft:0});this.Qwb?this.Sr.updateDraftingAndPosition(Da,!1,Qa):this.Sr.updateDrafting(Da,!1);this.Sr.selectContainer(ba,!0)}}UUf(ba){if(this.Sr&&
this.W4){for(let Da of this.W4)cg.x5g(Da,ba)&&(this.Sr.detachContainers([Da]),this.W4.remove(Da));this.O_()||this.OVa||this.hS(!1,!1,!0)}}yol(){this.mwe=!0}eSc(){this.Om&&this.Om.isVisible&&this.Om.bll()}j5i(){var ba=this.ua.presentation;if(!ba)return!1;ba=ba.slides;if(!ba)return!1;for(const Da of ba)if(ba=Object(mb.a)(Le.a,Da))for(const Qa of this.xl.Tta(ba.nE()))if(dc.bO(Qa))return!0;return!1}yee(ba){var Da=this.ua.presentation;if(!Da)return null;Da=Da.slides;if(!Da)return null;for(const Qa of Da)if(Da=
Object(mb.a)(Le.a,Qa),gd.a.mba(Da.Cb,ba))return Da;return null}a5i(){return this.j0d||this.KGi&&this.j5i()}aeg(){const ba=this.pa.Pa.nb,Da=this.pa.Pa.Y6;if(!ba||!Da)return null;var Qa=Object(mb.a)(5,ba.Ua.node),nb=Object(mb.a)(5,Da.Ua.node);if(!Qa||!nb)return null;Qa=Object(mb.a)(jj.TableCellNode,Qa.GL());nb=Object(mb.a)(jj.TableCellNode,nb.GL());return Qa&&nb?Qa.rowIndex>nb.rowIndex?ba:Da:null}nyj(){if(!this.a5i()||!this.pa.i0())return null;Kb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");
var ba=0,Da=0;if(this.pa.Pa.Sl){var Qa=this.aeg();if(!Qa)return Kb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var nb=Qa}else nb=this.pa.Pa.nb;if(!nb)return Kb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const Wb=({tMa:ba,eEa:Da}=dc.myj(this.pa.Y_(),nb,ba,Da)).returnValue;if(!Wb||0>ba||0>Da||0>=Da-ba)return Kb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",
!Wb,Da,ba),null;Qa=new zh.a;Qa.StartPos=ba;Qa.EndPos=Da;if(this.pa.rWa()&&Wb.get_smartArtModelId()){Kb.a.J(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Qa.AnchoringShape=new Cj.a;ba=T.a.Kf(Wb.get_smartArtModelId()).toString();if(!ba||!T.a.isValid(ba))return Kb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!ba),null;Qa.AnchoringShape.SmartArtNodeId=ba;
this.zE.ahk()}else if(Wb.Ks()){Kb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");Da=Object(mb.a)(jj.TableCellNode,Wb.GL());if(!Da)return Kb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;ba=Da.rowId.toString();Da=Da.cellId.toString();if(!(ba&&Da&&T.a.isValid(ba)&&T.a.isValid(Da)))return Kb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",
!ba,!Da),null;Qa.AnchoringShape=new Cj.a;Qa.AnchoringShape.TableCell=new Rf;Qa.AnchoringShape.TableCell.RowId=ba;Qa.AnchoringShape.TableCell.ColId=Da;this.zE.bhk()}ba=Object(mb.a)(5,nb.Ua.node);nb=Object(mb.a)(5,nb.jf.node);ba!==nb&&this.zE.dhk();Kb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Qa}BWi(ba){if(this.Sr&&ba){for(const Da of this.W4.toArray()){let Qa=!1;for(const nb of ba)if(cg.x5g(Da,nb.commentId)){Qa=!0;break}Qa||(this.Sr.detachContainers([Da]),
this.W4.remove(Da),Kb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",Da.contentId))}this.O_()||this.OVa||this.hS(!1,!1,!0)}}F4b(){if(this.Sr){for(const ba of this.W4.toArray())this.Sr.detachContainers([ba]);this.W4.clear()}this.O_()||this.OVa||(this.pEa&&!this.ZHa?this.hS(!1,!1,!1):this.hS(!1,!1,!0))}Z4e(ba){if(!ba)return null;ba.sort((Da,Qa)=>{var nb=this.qo.a9(Da);nb=nb?nb.mC:new wc.a(0,0);var Wb=this.qo.a9(Qa);Wb=Wb?Wb.mC:new wc.a(0,0);nb.y+=Da.pos.Y;Wb.y+=Qa.pos.Y;
nb.x+=Da.pos.X;Wb.x+=Qa.pos.X;let Jb=nb.y-Wb.y;Jb||(Jb=nb.x-Wb.x)||(Jb=+Da.dt-+Qa.dt);return Jb});return ba}Kgj(ba){const Da=new r.a;if(ba){this.Qwb&&this.N$e();for(const Qa of ba)Ib.a.Xa(Qa.commentId)||(ba=this.O5f(Qa),ba=Object.assign(new dk,{contentId:Qa.commentId,containerContentType:0,anchorTop:ba,anchorLeft:0}),Da.add(ba))}return Da}HY(ba){this.Cbh(ba)}Yph(ba,Da){for(let Qa=0;Qa<ba.Sa.length;Qa++){const nb=ba.Sa.ga(Qa);if(!nb.Bg)continue;const Wb=[];for(let Jb=0;Jb<nb.Bg.length;Jb++){const Uc=
nb.Bg.ga(Jb);Uc.RI.equals(Da)&&Wb.push(Uc)}if(!(1>Wb.length))try{ba.Npa=!0;for(const Jb of Wb)nb.Bg.remove(Jb)}catch(Jb){Kb.a.J(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",Jb.toString())}finally{ba.Npa=!1}}}Uyf(ba,Da,Qa){ba.Bg||(ba.Bg=new lf.a(ba));const nb=ba.Bg.Ke.paragraph;Da=new Vd.a(ba.Bg.Ke,null,Da,Qa);ba.Bg.add(Da);nb.nv()}XOc(ba){return Gd.a.Kf("{"+ba+"}{1}")}E_b(ba,Da,Qa,nb){let Wb=null;for(let Jb=0;Jb<ba.Sa.length;Jb++){let Uc=
ba.Sa.ga(Jb);if(Uc.cp>=Qa){try{ba.Npa=!0;if(Uc.cp>Qa||!Uc.formatting)this.GJ.Xga(ba,Jb,Qa,Wb),Uc=ba.Sa.ga(Jb);this.Uyf(Uc,Da,nb)}catch(Jd){Kb.a.J(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Jd.toString())}finally{ba.Npa=!1}return}Uc.formatting&&(Wb=Uc.formatting)}if(Pb.ParagraphReader.textLength(ba)>=Qa)try{ba.Npa=!0;this.GJ.Xga(ba,ba.Sa.length,Qa,Wb);const Jb=ba.Sa.ga(ba.Sa.length-1);this.Uyf(Jb,Da,nb)}catch(Jb){Kb.a.J(512496736,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Jb.toString())}finally{ba.Npa=!1}}t5b(){var ba=this.xl.qz();if(ba){var Da=Date.now(),Qa=!1,nb=new Ma.a;for(var Wb of ba){var Jb=dc.l9b(Wb,this.qo.a9(Wb));nb.$(Wb.commentId,Jb)}for(var Uc of ba)if(Uc.textAnchoringInfo&&(Wb=this.qo.a9(Uc))&&(Jb=nb.ga(Uc.commentId),!Jb||!Jb.isValid||Jb.Pug(Uc.textAnchoringInfo)))for(var Jd of Wb.vy())this.Yph(Object(mb.a)(Hc.AParagraphNode,Jd),this.XOc(Uc.commentId));
for(const ne of ba)if((ba=nb.ga(ne.commentId))&&ba.isValid&&ba.Pug(ne.textAnchoringInfo)&&(this.Om.isVisible||0===ne.status)){Qa=this.XOc(ne.commentId);this.E_b(ba.uV,Qa,ba.startPos,!0);if(ba.Pcc)for(Uc=1;Uc<ba.paragraphs.length;Uc++){if(Jd=ba.paragraphs[Uc])this.E_b(Jd,Qa,0,!0),ba.a4.equals(Jd)?this.E_b(ba.a4,Qa,ba.endPos,!1):this.E_b(Jd,Qa,Pb.ParagraphReader.textLength(Jd),!1)}else this.E_b(ba.a4,Qa,ba.endPos,!1);ba.aVj();Qa=!0}Qa&&Kb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",
Date.now()-Da)}}yeh(ba,Da){if((ba=this.xl.Sta(Da.node))&&(Da.property===qf.a.ewc||Da.property===qf.a.dwc||Da.property===qf.a.nxd||Da.property===qf.a.oxd)){const Qa=dc.bO(ba);Qa&&this.t5b();!ba.textAnchoringInfo||Qa||Da.property!==qf.a.oxd&&Da.property!==qf.a.nxd||this.zE.chk(ba,this.XOc(ba.commentId),this.qo.a9(ba),this.Kc.Hc.Na)}}NYf(){this.ni&&this.daa&&(this.K0.L_e(this.daa.length,this.Wfb,this.Vn,this.nwe.j5c),this.K0.P_e(Array.clone(this.daa),Array.clone(this.Zgb)),this.nLf(2))}B7j(ba,Da){Da=
this.Tb.Lc(Da);for(var Qa=Da.Db(2);Qa;Qa=Da.Hf(2))if((Qa=Object(mb.a)(115,Qa))&&gd.a.mba(Qa.Cb,ba))return!0;return!1}cC(ba,Da){Da&&(ba=Object(mb.a)(347,Da.node),Da=Da.HW,ba&&2===Da&&((Da=this.E5.Gf)&&Da.slides&&0>=Da.slides.length&&this.Om.isVisible&&this.prc(!1,!1),this.ni&&(Da=this.ni.W8,!Da&&this.ua.Ba&&(Da=this.ua.Ba.Cb),this.B7j(Da,ba)||this.NYf())))}u$g(ba,Da){if((ba=this.xl.Sta(Da.node))&&dc.bO(ba)&&(Da=this.qo.a9(ba)))for(const Qa of Da.vy())this.Yph(Object(mb.a)(Hc.AParagraphNode,Qa),this.XOc(ba.commentId))}wdh(ba,
Da){(ba=Object(mb.a)(4,Da.node))&&0<ba.vy().length&&(Da.qng&192||Da.qng&4)&&this.t5b()}Lnc(ba,Da){ba=Da.property;Da=Da.node;if(ba===Td.a.My||ba===Td.a.Ny)if(ba=this.xl.qz()){for(const Qa of ba)Qa.pos.Y=Da.mC.y,Qa.pos.X=Da.mC.x;this.uqd()}}Pkd(){Kb.a.J(512496734,805,this.fbb?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.fbb)}Oxa(ba,Da){Kb.a.J(512496733,805,this.fbb?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",pe.a[Da.iC],this.fbb)}dispose(){this.Fn&&
(this.Fn.dispose(),this.Fn=null);this.MFb&&(this.MFb.dispose(),this.MFb=null);this.Yv.crh(Object(sa.a)(this,this.SJa,"onBeforeSlideSwitched"));this.Yv.Voa(Object(sa.a)(this,this.J$e,"updateCommentsWhenNavigateSlide"));this.Yv.uMb(Object(sa.a)(this,this.zyf,"activeSlideDOMDisplayed"));this.Vq.kcl(Object(sa.a)(this,this.tch,"onPageViewZoomChanged"));this.Sp.uXe(Object(sa.a)(this,this.onShapeSelected,"onShapeSelected"));this.Sp.Prh(Object(sa.a)(this,this.A_a,"onShapeDeselected"));this.Yv.Nrc(Object(sa.a)(this,
this.Ddh,"onShapeTextSelected"));this.Yv.Srh(Object(sa.a)(this,this.Pnc,"onSlideBackgroundClicked"));this.Vgb.Qm(Object(sa.a)(this,this.Lnc,"onShapePropertyChange"));this.Vgb.hcl(Object(sa.a)(this,this.wdh,"onShapeInvalidation"));this.Fc.Sal(Object(sa.a)(this,this.Fah,"onF6FocusDocument"));this.Fc.nXe(Object(sa.a)(this,this.Gib,"onSetFocus"));this.Yac&&this.k1.execute(ba=>{ba.xXe(this.aKa)});this.Jfd.Qm(Object(sa.a)(this,this.yeh,"onTextAnchorPropertyChanged"));this.mQg.vP(Object(sa.a)(this,this.cC,
"onChildTopologyChanged"));this.Jfd.iLa(Object(sa.a)(this,this.u$g,"onBeforeTextAnchorDisconnect"));this.Rb.WY(Object(sa.a)(this,this.b$g,"onAppModeSwitched"));this.N7c.Mrh(Object(sa.a)(this,this.Pkd,"onSessionExpired"));this.N7c.Qaa(Object(sa.a)(this,this.Oxa,"onSessionEnded"));this.Rb.xMb(Object(sa.a)(this,this.HY,"onSetOffline"));this.LJ||this.Rc.Bb(Ka.a.click,this.jGb,Object(sa.a)(this,this.dJb,"onCommentPaneParentDivClick"));this.ZOh();this.WO=this.jGb=null;this.Ys.pqd(Object(sa.a)(this,this.Rkd,
"onShapeViewElementAddedOrRemoved"));this.Ys.Ccl(Object(sa.a)(this,this.Rkd,"onShapeViewElementAddedOrRemoved"));this.pa.Cga(Object(sa.a)(this,this.CD,"onSelectionChanged"))}get isReadOnly(){return this.Vn}get OVa(){return!!this.ni}get hasFocus(){return this.Eye}rMi(){const ba=new gg.a;var Da=new Kh(fe.a.uAb,Sh.a.application);Da.preCallback=Object(sa.a)(this,this.gNc,"claimFocus");Da.postCallback=Object(sa.a)(this,this.MVf,"disableOnEmptyDeckAndReadOnly");ba.$(0,Da);Da=new Kh(fe.a.deleteComment,Sh.a.application);
Da.preCallback=Object(sa.a)(this,this.gNc,"claimFocus");Da.postCallback=Object(sa.a)(this,this.MVf,"disableOnEmptyDeckAndReadOnly");ba.$(3,Da);Da=new Kh(fe.a.hSe,Sh.a.application);Da.preCallback=Object(sa.a)(this,this.gNc,"claimFocus");Da.postCallback=Object(sa.a)(this,this.Oih,"postCommentAction");ba.$(2,Da);Da=new Kh(fe.a.vLe,Sh.a.application);Da.preCallback=Object(sa.a)(this,this.gNc,"claimFocus");Da.postCallback=Object(sa.a)(this,this.Oih,"postCommentAction");ba.$(1,Da);Da=new Kh(Xb.a.Sxd,Sh.a.application);
Da.preCallback=Object(sa.a)(this,this.LAl,"showHideActionPreCallback");Da.postCallback=Object(sa.a)(this,this.KAl,"showHideActionPostCallback");Da.delayActionsUntilRegistration=this.Da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&pc.a("DelayCommentsShowHideAction");ba.$(6,Da);return ba}LAl(ba,Da,Qa,nb,Wb){if(1===Qa)return!this.ua.Ba||this.isDisabled?8:2;Kb.a.J(36983504,805,50,"New Comment Pane opened.");this.Om.SIb(!!Wb&&Wb.AutoShowHide);return 2}KAl(ba,Da,Qa,nb,
Wb,Jb){if(1===nb)return ba&&this.zE.WFk(this.ua.pk),ba?32:8;this.dCf(this.Om.isVisible,!!Jb&&Jb.AutoShowHide);return ba?32:8}gNc(ba,Da,Qa,nb,Wb){if(1===Qa&&this.pa.GVa())return 8;1!==Qa&&((this.pgc=!!Wb&&Wb.ShouldCanvasTakeFocus)||this.mta(),this.pa.iu(),this.Xye=!0);return 2}Oih(ba,Da,Qa,nb){if(1===nb&&(this.jYa||!this.daa))return 8;this.pgc=!1;return ba?32:8}MVf(ba,Da,Qa,nb){return(1!==nb||!this.Vn&&this.daa)&&this.Kc.Hc?ba?32:8:8}pDa(ba,Da){return new wc.a(this.tcd.Pe(ba,0),this.tcd.Pe(Da,1))}KPf(ba,
Da){return new wc.a(this.tcd.gf(ba,0),this.tcd.gf(Da,1))}eyb(ba){ba=this.xl.Xta(ba);return this.xl.Sta(ba)}Jga(ba,Da,Qa){!this.A0f()||ba!==this.ni.TC.draftId&&ba!==this.ni.commentId?this.fxb()&&ba===this.ni.TC.draftId?(this.K0.selectComment(ba),this.Sr&&this.Sr.selectContainer(ba,!0),this.v0f&&!this.hasFocus&&1!==Da&&this.mta()):this.selectComment(this.eyb(ba),null,!0,!0,0,Da,Qa):(ba=this.yee(this.ni.W8),ba)?1!==Da&&(this.ni.O3c=!0,this.Da.Xn?this.Ina.instance&&this.Ina.instance.dK(ba.qe):this.xe.dK(ba.qe)):
(Kb.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.ni.TC.draftId,0))}selectComment(ba,Da,Qa,nb,Wb,Jb,Uc){this.pa.iu();Da=this.vNb?this.vNb.commentId:null;Uc||this.eSc();0!==Jb?ba?this.K0.selectComment(ba.commentId):this.K0.selectComment(null):0===Jb&&(Jb=this.qo.a9(ba))&&Jb.mL&&this.qo.Hsd(he[Jb.mL]);this.Fn&&this.Fn.selectComment(ba,!0);!this.Om.isVisible&&this.Sr&&ba&&ba!==this.dXa&&(Jb=this.xl.Sde(ba.commentId))&&
(Jb=this.xl.Sta(Jb),this.Sr.selectContainer(Jb.commentId,!this.pgc&&!Uc&&!this.Xye),this.Xye=!1,this.Kc&&this.Kc.Hc&&this.Kc.Hc.Ezd(5,!1,this.bDb));Uc||this.pgc||this.mta();!this.qo||!this.Om.isVisible&&this.Om.isVisible||(this.qo.u_e(ba,Da,!0,!1,Uc),dc.bO(ba)&&!Uc&&this.t5b());this.Rb.updateCommandUI()}get vNb(){return this.Fn&&this.Fn.yNb?this.Fn.yNb.comment:null}fll(){if(!this.jYa){const ba=af.a.Jj("SelectNextCommentCrossSlide",1),Da=!this.Om.isVisible;this.jYa=!0;this.s9c.R8d((Qa,nb)=>{this.Vah(Qa,
nb,1,ba)},ba,Da)}}ill(){if(!this.jYa){const ba=af.a.Jj("SelectPreviousCommentCrossSlide",1),Da=!this.Om.isVisible;this.jYa=!0;this.s9c.Y8d((Qa,nb)=>{this.Vah(Qa,nb,0,ba)},ba,Da)}}Vah(ba,Da,Qa,nb){nb.zm("FindCommentEndTime",new Date);this.wb.Hb(new Jh.a(2,1,100,()=>{this.jYa&&(this.jYa=!1,this.Exl(ba,Da,Qa)?this.Jga(this.ni.commentId||this.ni.TC.draftId,0,!1):Da&&ba&&this.Kc.Hc.$c?ba.Cb.equals(this.Kc.Hc.$c.Cb)?(this.selectComment(Da,null,!0,!0,2,1,!1),nb.Wa("CircularSelectCommentInSingleSlide",Rc[Qa]),
nb.finish()):(this.eHa=Object.assign(new mc,{slide:ba,comment:Da,direction:Qa,t_e:nb}),this.Da.Xn?this.Ina.instance&&this.Ina.instance.dK(ba.qe):this.xe.dK(ba.qe)):(this.Rb.updateCommandUI(),nb.Wa("NoCommentFound",Rc[Qa]),nb.finish()))},90,"47"))}e$f(){let ba=-1;if(!this.ni)return ba;if(this.ni.W8){const Da=this.yee(this.ni.W8);Da&&(ba=Da.qe)}else this.Kc.Hc&&this.Kc.Hc.$c&&(ba=this.Kc.Hc.$c.qe);return ba}Exl(ba,Da,Qa){if(!this.ni||this.ni.TC.sessionType!==Tc.create)return!1;const nb=this.e$f();if(0>
nb)return!1;if(!Da||!ba)return!0;Da=this.Kc.Hc.$c.qe;if(1===Qa)return Qa=nb<=Da&&Da<ba.qe,Da=ba.qe<=Da&&Da<nb,nb<=ba.qe&&!Qa||Da;Qa=nb>=Da&&Da>ba.qe;Da=ba.qe>=Da&&Da>nb;return nb>ba.qe&&!Qa||Da}fNa(ba){0!==ba&&this.K0.selectComment(null);this.Fn&&this.Fn.selectComment(null,!1);if(this.Sr&&(this.Sr.deselectContainer(),this.Kc&&this.Kc.Hc)){let Da=5;const Qa=this.pa.Ll();Qa&&Qa.Wf&&(Da=2);this.Kc.Hc.Ezd(Da,!1,this.bDb)}this.qo&&0!==ba&&(this.qo.yQc(),this.qo.aQc());this.Rb.updateCommandUI()}kdi(ba){this.Gsb(this.eyb(ba),
0)}Gsb(ba,Da){this.dXa!==ba&&(this.qo&&(ba?this.qo.jdi(ba):this.qo.aQc()),this.dXa=ba,0!==Da&&(this.dXa?this.K0.highlightComment(this.dXa.commentId):this.K0.highlightComment(null)),this.Fn&&this.Fn.Gsb(this.dXa,!0))}dll(){if(this.v4b){var ba=this.eyb(this.v4b),Da=this.Kc.Hc.$c.sid,Qa=Da===parseInt(this.M3d);ba?(1!==ba.status&&2!==ba.status||this.fvd(),this.selectComment(ba,null,!0,!0,0,1,!1),this.zE.tGk(this.ua.pk),Kb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
this.v4b,this.M3d)):(Qa&&this.Vd.Gs(Object.assign(new ij.a,{Code:389,Source:4}),this.Ya.podSessionId),Kb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.v4b,this.M3d,parseInt(Da)))}}get manager(){return this.xl}get qT(){return"per"}get w5g(){return this.WO}set w5g(ba){this.WO=ba;this.Fn&&(this.Fn.parentElement=ba)}get X7g(){return this.Gic}set X7g(ba){this.Gic=ba}Bpd(ba){this.bMb(ba,void 0,!0)}XU(ba,Da){Da=!pc.a("FixAltF12KeboardingInCommentPane")||
Da;this.jnc(ba,Da,!0)}cWe(){!this.LJ&&this.Om&&(this.jGb.style.display=this.Om.isVisible?"flex":"none");this.Fn&&(this.Fn.setVisibility(this.Ieb),this.Fn.HEh(this.Keb),this.qo.pwb(this.dXa))}prc(ba,Da){this.UNh(ba,Da);this.cWe();this.dCf(ba,Da)}tch(){this.Fn&&!this.mgc&&this.Fn.iaf();this.uqd();this.Qwb&&this.N$e()}Tjh(){this.jYa=!1;this.fZf();this.Fn&&this.Fn.DWe();this.VGb=!1;this.ZOh()}fZf(){this.xl.iPh()}SJa(){this.ZHa=this.O_()||this.fxb();this.qo&&this.ZHa&&(this.qo.yQc(),this.qo.aQc());this.a8d&&
(this.Tjh(),this.WFf())}fyl(){return this.ni&&this.ni.W8&&this.ua.Ba?this.ni.O3c&&gd.a.mba(this.ni.W8,this.ua.Ba.Cb):!1}J$e(){this.a8d||this.Tjh();this.ua.Ba||this.SJa(this,null);this.fZf();this.Kc.Hc&&(this.w5g=this.Kc.Hc.f0d);const ba=this.Kc&&this.Kc.Hc?this.xl.T$a(this.Kc.Hc.$c):this.xl.qz(),Da=this.pmj(ba),Qa=this.O_()||this.fxb();this.kdd||Qa||(this.qm.Jid(this.qm.qZd,this.qm.i0d),this.kdd=!0);this.Om.isVisible||(Qa?(this.F4b(),this.ish()):this.O_()?(this.F4b(),this.hS(!0,!1,!0)):this.pEa&&
!this.ZHa?this.hS(!1,!1,!1):this.hS(!1,!1,!0),this.kph());this.bMb(ba,n.AFrameworkApplication.isRtl,!1,Da);this.fyl()?(this.Jga(this.ni.commentId||this.ni.TC.draftId,0,!1),this.ni.O3c=!1):-1<Da&&this.Jga(ba[Da].commentId,0,!1);this.eHa&&(this.eHa.t_e.finish(),this.eHa=null);this.Z2a(!1);-1!==Da&&this.Fn&&(this.Fn.Gsb(null,!1),this.Fn.selectComment(ba[Da],!1));this.a8d||this.WFf()}zyf(){if(this.mHe){try{this.feb.LBl(this.JZg,this.ua,this.xe)}catch(ba){Kb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",
ba)}this.mHe=!1}}Z2a(ba){const Da=this.e$f();this.nwe.Z2a(ba,Da)}KSl(ba){this.ni&&!this.ni.W8&&(this.ni.W8=ba)}onShapeSelected(ba,Da){this.SSc&&(ba=Da.shapeNode,this.p2e(ba),ba&&0<ba.vy().length&&this.t5b())}Ddh(ba,Da){this.SSc&&(this.p2e(Da.$w.shapeNode),this.t5b())}CD(ba,Da){if(Da&&Da.jl&&this.pa.i0()&&(ba=this.xl.qz())){Da=!1;for(var Qa of ba)if(dc.bO(Qa)){Da=!0;break}Da&&((Qa=this.pa.Y_())?this.p2e(Qa):Kb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}p2e(ba){ba.get_shapeId()&&
(this.qo&&ba!==this.qo.RW&&this.fNa(1),this.pxh(ba.get_shapeId(),!0))}pxh(ba,Da){var Qa=this.xl.qz();if(Qa){var nb=null,Wb=null,Jb=0,Uc=null;for(const Jd of Qa)if((this.Om.isVisible||0===Jd.status)&&Jd.anchorShape===ba)if(this.pa.i0()&&dc.bO(Jd)){Qa=this.pa.Pa.nb.Ua;const ne=this.pa.Pa.nb.jf,bf=dc.l9b(Jd,this.qo.a9(Jd));bf&&bf.isValid?(this.vNb&&this.vNb.commentId===Jd.commentId||bf.qxd===Jd.textAnchoringInfo.TextBodyLength)&&bf.JYj(Qa,ne)&&(Wb?(Qa=bf.Inh,Qa<Jb&&(Wb=Jd,Jb=Qa)):(Wb=Jd,Jb=bf.Inh)):
(nb=Jd,Kb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else Wb||Uc||dc.bO(Jd)||(Uc=Jd);Wb?this.Jga(Wb.commentId,1,Da):Uc?this.Jga(Uc.commentId,1,Da):this.pa.i0()&&!nb?this.qo&&this.fNa(1):nb&&this.Jga(nb.commentId,1,Da)}}A_a(){if(this.SSc){var ba=this.Jae();this.qo.Hsd(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,ba.toString()));this.fNa(1)}}Jae(){const ba=this.xl.qz();let Da=[];ba&&(Da=Ah.e(ba,Qa=>0===Qa.status));
return Da.length}Pnc(){this.SSc&&this.fNa(1)}Fah(ba,Da){Da.fib===Nd.a.qg&&this.qo.Hsd(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.Jae().toString()));Da.QKb===Nd.a.qg&&this.fNa(1)}Gib(ba,Da){this.v0f&&Da.fib!==Nd.a.LW&&(Da.QKb===Nd.a.LW||Nd.a.Qz)&&this.fbb&&this.fNa(1)}pmj(ba){let Da=-1;if(this.eHa&&this.Kc.Hc)if(this.eHa.slide!==this.Kc.Hc.$c)Kb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");
else if(ba&&0<ba.length){if(this.Om.isVisible)Da=1===this.eHa.direction?0:ba.length-1;else if(1===this.eHa.direction)for(var Qa=0;Qa<ba.length;Qa++){if(0===ba[Qa].status){Da=Qa;break}}else for(Qa=ba.length-1;0<=Qa;Qa--)if(0===ba[Qa].status){Da=Qa;break}0<=Da&&Da<ba.length&&(ba=ba[Da],Qa=this.eHa.comment,Qa.dt===ba.dt&&Qa.commentId===ba.commentId&&Qa.authorName===ba.authorName||Kb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return Da}cNe(){!this.xl.mlj()||
this.Acd?(this.bMb(this.xl.qz(),n.AFrameworkApplication.isRtl,!0),this.Acd&&(this.Acd=!1)):this.ni&&(0===this.ni.VRa||1===this.ni.VRa?(this.F0f&&this.bMb(this.xl.qz(),n.AFrameworkApplication.isRtl,!0),0===this.ni.VRa&&(this.sed=!0)):this.ni&&2===this.ni.VRa&&this.F0f&&this.bMb(this.xl.qz(),n.AFrameworkApplication.isRtl,!0))}$Fk(){Fb(this.Ib)&&(this.Acd=!0,this.cNe())}get Asd(){const ba=this.pa.Ll();if(ba){const Da=ba.mC;this.ZGe=new wc.a(n.AFrameworkApplication.isRtl?Da.x:Da.x+ba.Ix,Da.y)}else this.ZGe=
null;return this.ZGe}get wll(){if(!this.pa.i0())return null;var ba=Object(mb.a)(5,this.pa.Pa.nb.jf.node);if(!ba)return null;const Da=Object(mb.a)(646,ba.qc(this.Kc.Hc.Na));if(!Da)return null;var Qa=null,nb=Da.htmlElement.getElementsByClassName("Selected");if(0<nb.length)Qa=nb[nb.length-1];else if(this.pa.Pa.Sl){if(nb=this.aeg())if(nb=Object(mb.a)(5,nb.jf.node))if(nb!==ba){if(ba=Object(mb.a)(646,nb.qc(this.Kc.Hc.Na)))Qa=ba.htmlElement}else Qa=Da.htmlElement}else return null;ba=this.pa.Ll();if(!ba||
!Qa)return null;ba=Object(mb.a)(117,ba.qc(this.Kc.Hc.Na));if(!ba)return null;Qa=Xg.a.mi(Qa);ba=Xg.a.mi(ba.vq);if(0>=Qa.width+Qa.height&&0>=ba.width+ba.height)return null;ba=wc.a.xV(new wc.a(Qa.x,Qa.y),new wc.a(ba.x,ba.y));return this.KPf(ba.x+Qa.width-5,ba.y+10)}get anchorNode(){const ba=this.pa.Ll();return this.cAg=ba?ba:this.Kc.Hc.$c}UNh(ba,Da){this.Om&&(Da||this.Qyh(),this.Ghb.jBh(ba?3:1),!this.isDisabled&&ba&&pc.a("CommentShimmerBugFix")&&this.QX&&this.QX.isVisible&&(this.QX.Rjg(),this.Rb.SIb(1)),
this.hS(!ba,!1,!0),this.Om.Zp(!this.isDisabled&&ba,Da),this.Om.isVisible&&(this.Ieb=!0))}hS(ba,Da,Qa){const nb=this.O_();Qa&&(!nb&&!this.ZHa||nb&&this.ZHa)&&Kb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");!this.O_()&&!this.OVa&&ba&&!Da||this.Om.isVisible&&ba&&!Da||this.O_()&&this.QX&&this.QX.isVisible&&!ba&&!Da||!this.Kc.Hc||!(Da=this.Kc.Hc.hda)||(Da.setVisibility(ba),ba=new Xe.a(ba),
this.Yv.ymh(ba),Qa?this.Rb.SIb(1):Kb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Kc.Hc.Ezd(5,!1,this.bDb))}EPl(ba){this.Om&&(this.Ieb=!this.isDisabled&&ba,this.Ieb||(this.Ghb.jBh(1),this.Om.Zp(!1,!1),this.Fa.wj(Nd.a.hr,!1)))}Fqj(){const ba=new ue;ba.focusCallback=Object(sa.a)(this,this.ZTc,"focusFirstPaneElement");return Object.assign(new Yd.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.N1l?
300:320),contentProps:ba,location:2,onOpen:Da=>{Db.a.Hpd(Da,[Ka.a.contextMenu]);const Qa=this.Fa.Ic(Nd.a.hr);this.Rc.hMb(Ka.a.click,Da,Object(sa.a)(this,this.dJb,"onCommentPaneParentDivClick"),null,Qa.h3a)},onClose:Da=>{this.prc(!1,!1);this.Rc.Bb(Ka.a.click,Da,Object(sa.a)(this,this.dJb,"onCommentPaneParentDivClick"))},isModernPane:!0})}WFf(){if(!this.FFg){var ba=this.xl.qz();ba=!!ba&&0<ba.length;Kb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",ba);ba?this.O_()&&
this.hS(!0,!1,!0):(this.F4b(),this.pEa&&!this.ZHa?this.hS(!1,!1,!1):this.hS(!1,!1,!0))}}fvd(){this.Om.isVisible||this.ia.processAction(fe.a.j2,2);this.eSc()}lMj(){this.Om.isVisible&&this.ia.processAction(fe.a.j2,2)}qk(ba){return this.le.qk(ba)}get isDisabled(){const ba=this.E5.Gf;return ba?ba.ibb:!0}Szf(){this.ydd||(this.ydd=new Jh.a(0,1,0,Object(sa.a)(this,this.u6k,"refreshCommentsTask"),90,"48"),this.wb.Hb(this.ydd))}b$g(ba){this.Cbh(1===ba.mode)}Cbh(ba){this.Vn=ba;this.Szf();pc.a("PreventCommentPaneCloseOnReadOnlyChanged")?
this.NYf():this.Om.isVisible&&this.Vn&&this.lMj()}ade(){return this.daa?this.daa:[]}Oag(){return this.Zgb?this.Zgb:[]}get $8g(){return this.Wfb}get OPc(){return this.ni}a$f(ba){const Da=this.Kc&&this.Kc.Hc?this.xl.T$a(this.Kc.Hc.$c):this.Z4e(this.xl.qz());if(!Da||!Da.length)return 0;let Qa=null;this.Asd&&(Qa=this.pDa(this.Asd.x,this.Asd.y));let nb=-1,Wb=0;for(let ne=0;ne<Da.length;ne++){var Jb=this.qo.a9(Da[ne]);if(!Qa&&Jb)break;if(Jb&&Qa){var Uc=Jb.mC.x,Jd=Jb.mC.y;Uc+=Da[ne].pos.X;Jd+=Da[ne].pos.Y;
Jb.Ug&&(Jb=this.Ga.Fs(Jb),Uc+=Jb&&Jb.mC?Jb.mC.x:0,Jd+=Jb&&Jb.mC?Jb.mC.y:0);Jd=this.pDa(Uc,Jd);Uc=Jd.y;Jd=Jd.x;if(Qa.y<Uc)break;if(Qa.y>Uc||Qa.y===Uc&&Qa.x>=Jd)nb=ne,Da[ne].Children&&ba&&(Wb+=Da[ne].Children.length)}else Jb||(nb=ne,Da[ne].Children&&ba&&(Wb+=Da[ne].Children.length))}return nb+Wb+1}aQj(ba){if(!this.oye)throw Kb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),D.a.qt(-2130915320);if(this.ni)return Kb.a.J(512496720,
805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),D.a.qt(-2130915319);if(null===ba)throw Error.argumentNull("session");if(!ba.commentId.length&&0!==ba.VRa)return D.a.qt(-2130915327);this.ni=ba;this.Z2a(!0);0===ba.VRa&&(this.fNa(0),this.Om.isVisible||this.hsh(ba));if(this.Om.isVisible||!this.Om.isVisible)this.mta(),this.N0i();let Da="";ba.TC&&(Da=ba.TC.draftId);Kb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",Da);return null}endCommentSession(ba,
Da){if(this.ni){if(this.ni.TC&&this.ni.TC.draftId!==ba)throw Kb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",ba,this.ni.TC.draftId),D.a.qt(-2130915327);this.ZBg=Da}9!==Da||this.Om.isVisible||this.Fa.hC(Nd.a.qg);this.ni=null;this.Rb.updateCommandUI();if(this.Sr&&!this.Om.isVisible){const Qa=[Object.assign(new dk,{contentId:ba,containerContentType:0,anchorTop:0,anchorLeft:0})];this.Sr.detachContainers(Qa);this.O_()||this.hS(!1,
!1,!0)}this.jed.Ctg&&this.NVf();Kb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",ba,Da)}get IGi(){return this.ZBg}L6(){this.mta()}cVf(ba){if(this.Da.ka("CommentCopyPasteEnabled")&&!this.feb.K7j)for(const Da of ba)for(const Qa of this.xl.Tta(Da.nE()))if(1===Qa.status){this.JZg=new Ud(ba,this.xl);this.mHe=!0;return}}vb(){1!==this.tgc.Mja&&(this.ia.ya(fe.a.Guc,Sh.a.application,Object(sa.a)(this,this.j2,"showHideComments")),this.ia.ra(fe.a.dUe,Sh.a.application,
Object(sa.a)(this,this.VKa,"queryShowHideComments"),97));this.qYf&&(this.ia.ya(fe.a.ASa,Sh.a.application,Object(sa.a)(this,this.B4b,"deleteAllComments")),this.ia.ya(fe.a.iwb,Sh.a.application,Object(sa.a)(this,this.B4b,"deleteAllComments")),this.ia.ya(fe.a.jwb,Sh.a.application,Object(sa.a)(this,this.B4b,"deleteAllComments")));this.ia.ya(fe.a.ePb,Sh.a.application,Object(sa.a)(this,this.j2,"showHideComments"));this.ia.ra(Xb.a.KUe,Ya.a.frame,Object(sa.a)(this,this.VKa,"queryShowHideComments"),97);this.ia.ra(fe.a.VKa,
Sh.a.application,Object(sa.a)(this,this.VKa,"queryShowHideComments"),97);this.ia.ra(fe.a.FLb,Sh.a.application,Object(sa.a)(this,this.VKa,"queryShowHideComments"),97);this.ia.ra(fe.a.Dod,Sh.a.application,Object(sa.a)(this,this.VKa,"queryShowHideComments"),97);this.ia.ya(fe.a.HKe,Sh.a.application,Object(sa.a)(this,this.Kid,"nudgeCommentMarker"));this.ia.ya(fe.a.IKe,Sh.a.application,Object(sa.a)(this,this.Kid,"nudgeCommentMarker"));this.ia.ya(fe.a.JKe,Sh.a.application,Object(sa.a)(this,this.Kid,"nudgeCommentMarker"));
this.ia.ya(fe.a.KKe,Sh.a.application,Object(sa.a)(this,this.Kid,"nudgeCommentMarker"));this.ia.ya(fe.a.zQb,Sh.a.application,Object(sa.a)(this,this.zQb,"toggleCommentAnchoringFocus"));this.Da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.ya(Xb.a.Bwb,Sh.a.application,Object(sa.a)(this,this.Bwb,"doesCommentExist")),this.ia.ya(Xb.a.L2b,Sh.a.application,Object(sa.a)(this,this.L2b,"commentActivitySelected")));this.me()}me(){var ba=this.Fa.Ic(ce.AFrame.$i),Da=
this.Fa.Ic(Nd.a.Qz);const Qa=this.Fa.Ic(Nd.a.nS);ba.bindAction(Rh.KeyInputManager.Va(ng.a.uAa,1),fe.a.zQb);Da.bindAction(Rh.KeyInputManager.Va(ng.a.uAa,1),fe.a.zQb);Qa.bindAction(Rh.KeyInputManager.Va(ng.a.uAa,1),fe.a.zQb);ba=this.Fa.Ic(Nd.a.hr);Da=[ba,this.Fa.Ic(Dj.a.fE),this.Fa.Ic(Dj.a.D3),this.Fa.Ic(Nd.a.qg),this.Fa.Ic(Nd.a.DQ)];for(const nb of Da)nb.bindAction(Rh.KeyInputManager.Va(ng.a.vAa,Rh.KeyInputManager.Te|($b.a.fl?4:1)),fe.a.uAb);ba.bindAction(Rh.KeyInputManager.Va(ng.a.q3a,1),fe.a.uAb)}bMb(ba,
Da,Qa,nb=-1){this.jwa=Da;!this.Fn&&this.WO&&(this.Fn=new lb(this.WO,this,this.MFb,this.jwa,this.Ieb),this.qo.Ugd=this.Fn);if(ba){cg.Bek(ba);Da=null;this.pa.i0()&&(Da=this.pa.Pa);var Wb=0<ba.length?ba[ba.length-1]:null;if(this.Fn){var Jb=this.Fn.yNb?this.Fn.yNb.comment:null;const Uc=Jb?Jb.commentId:null;this.Fn.isRightToLeft=this.jwa;this.Fn.Bpd(ba);this.qo&&(this.O_()||this.fxb())&&(this.qo.yQc(),this.qo.aQc());this.Fn.selectComment(null,!1);if(this.ni)Jb=this.eyb(this.ni.commentId),this.qo&&this.qo.u_e(Jb,
Uc,!1),this.Fn.selectComment(Jb,!0);else if(Qa&&Jb){const Jd=this.eyb(Jb.commentId);this.qo&&(this.Om.isVisible||!Jd||1!==Jd.status&&2!==Jd.status)&&(this.Fn.selectComment(Jb,!1),this.qo.u_e(Jb,Uc,!1,!0))}else this.sed&&Wb&&(this.Jga(Wb.commentId,1,!1),this.Fn.selectComment(Wb,!1));this.Fn.HEh(this.Keb);this.Keb&&this.qo.pwb(this.dXa)}this.Wfb=ba.length;ba=this.Z4e(ba);this.daa=this.$Og.MMl(ba,this.Vn);this.Zgb=this.$Og.LMl(ba);Qa?(this.Z2a(!0),this.K0.Nxh(Array.clone(this.daa),this.Wfb,Array.clone(this.Zgb)),
this.sed&&Wb&&this.K0.selectComment(Wb.commentId)):(Qa=[],this.fxb()&&(Qa=this.a$f(!1),Qa=[Object.assign(new fg,{draftId:this.ni.TC.draftId,insertIndex:0>nb?0:Qa})]),0>nb?this.K0.L_e(this.daa.length,this.Wfb,this.Vn,this.nwe.j5c,Qa):this.K0.Tll(this.daa.length,this.Wfb,nb,this.Vn,Qa),this.K0.P_e(Array.clone(this.daa),Array.clone(this.Zgb)));if(this.Gic){if(nb=this.eyb(this.Gic))this.selectComment(nb,null,!0,!0,0,1,!1),this.Gic=null}else Da&&this.pa.gF(Da);ba=this.VUf(ba);this.W4&&ba&&this.W4.count>
ba.length&&this.BWi(ba);this.esh(ba);this.mwe&&this.UUl();this.sed=!1}else this.K0.L_e(0,0,this.Vn,1),this.K0.P_e([],[]),this.Wfb=0,this.Fn&&(this.Fn.isRightToLeft=this.jwa,this.Fn.Bpd(null)),this.Zgb=this.daa=null,this.UNh(!1,!1),this.F4b()}mta(){this.eSc();this.hasFocus?this.ni&&this.jed.Ctg&&!this.A0f()&&this.Fa.hC(Nd.a.Qz):this.Fa.hC(this.Om.isVisible?Nd.a.hr:Nd.a.LW)}u6k(){this.ydd=null;this.cNe()}dJb(){this.mta();this.pa.iu();return!1}nLf(ba){if(this.ni){if(!this.ni.TC)throw Kb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",ba),D.a.qt(-2130915320);this.endCommentSession(this.ni.TC.draftId,ba)}else Kb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",ba),this.endCommentSession("",ba)}N0i(){this.VGb=this.Fa.Ee.name===(this.Om.isVisible?Nd.a.hr:Nd.a.LW);this.jed.ZBf(!0)}NVf(){this.jed.ZBf(!1);this.VGb&&(this.Fa.hC(this.Om.isVisible?Nd.a.hr:Nd.a.LW),
this.VGb=!1)}LKk(ba,Da){if(ba&&ba.name!==Nd.a.hr&&ba.name!==Nd.a.LW&&Da.name===Nd.a.Qz)if(this.Om.isVisible)this.ZTc();else if(this.ni){ba="";switch(this.ni.VRa){case 0:ba=this.ni.TC?this.ni.TC.draftId:"";break;case 1:case 2:if(Da=this.xl.Sde(this.ni.commentId))ba=this.xl.Sta(Da).commentId}this.Sr.selectContainer(ba,!0)}this.VGb=!0}KKk(){this.VGb=!1}ZTc(){this.Om.isVisible&&this.Ghb.v$i()}jnc(ba,Da,Qa){this.Eye=ba;this.Rb.updateCommandUI();(pc.a("FixAltF12KeboardingInCommentPane")||!this.LJ)&&this.Eye&&
Da&&this.ZTc();ba||Qa||this.fNa(1)}W7d(ba){var Da=this.ua.presentation;if(!Da)return!1;Da=Da.slides;if(!Da)return!1;for(const Qa of Da)if(Da=Object(mb.a)(Le.a,Qa))if(Da=this.xl.Tta(Da.nE()),ba)for(const nb of Da){if(1===nb.status)return!0}else{if(Da&&0<Da.length)return!0}else Kb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}AVi(){this.xl.ASa();const ba=this.xl.qz();ba&&ba.length?this.feb.sEh():this.feb.qEh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}Kid(ba,
Da,Qa){if(1===Qa)return 32;if(null!==this.zxh){Da=this.zxh;switch(ba){case fe.a.HKe:Da.pos.Y+=20;break;case fe.a.IKe:Da.pos.X-=20;break;case fe.a.JKe:Da.pos.X+=20;break;case fe.a.KKe:Da.pos.Y-=20}this.Fn.STl(Da);this.Eok.MUk(Da)}return 32}B4b(ba,Da,Qa){return!this.qYf||this.Vn||this.ni&&this.ni.TC?8:1===Qa?this.Fij(ba):this.yVi(ba)}Fij(ba){switch(ba){case fe.a.ASa:return this.xl.qz()&&this.xl.qz().length?32:8;case fe.a.iwb:return this.W7d(!1)?32:8;case fe.a.jwb:return 1!==this.tgc.Mja&&this.W7d(!0)?
32:8;default:return Kb.a.J(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",ba),2}}yVi(ba){switch(ba){case fe.a.ASa:this.AVi();break;case fe.a.iwb:this.feb.rEh(this.xl,!1);break;case fe.a.jwb:this.feb.rEh(this.xl,!0);break;default:return Kb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",ba),2}return 32}j2(ba,Da,Qa,nb,Wb){if(1===Qa)return!this.ua.Ba||this.isDisabled?8:32;Da=!this.Om.isVisible;
Qa=this.LR.Ii("UserAction",String.format("ShowHideComments: {0}",Da?"ShowPane":"HidePane"));Kb.a.J(36983504,805,50,"New Comment Pane opened.");ba===fe.a.ePb?(this.EPl(!this.Ieb),this.cWe()):ba===fe.a.Guc?(this.Keb=!this.Keb,this.qo.Mud=this.Keb,this.cWe()):this.prc(Da,!!Wb&&Wb.AutoShowHide);Qa&&Qa.stop();return 32}D1i(){this.Om.isVisible&&this.Jga(this.ni.TC.draftId,1,!1)}zQb(){var ba=this.Fa.Ee.name;if(this.ni&&this.ni.TC)return ba===Nd.a.qg?(this.mta(),pc.a("FixAltF12KeboardingInCommentPane")||
pc.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.D1i()):this.Fa.wf(Nd.a.qg),32;if(this.qo.cGh||this.qo.RW){if(ba===Nd.a.qg||ba===Nd.a.nS){var Da=this.qo.RW;this.Om.isVisible||(ba=0,Da&&(ba=Da.get_shapeId()),this.pxh(ba,!1));this.mta();return 32}if(od.a.contains(this.rIf,ba)){if((Da=this.vNb)&&dc.bO(Da)){if(ba=dc.l9b(Da,this.qo.RW),ba.isValid){const Qa=[];for(let Wb=0;Wb<ba.paragraphs.length;Wb++){const Jb=ba.paragraphs[Wb];Jb&&Qa.push(yi.SelectionFactory.R3(Jb,ba.uV.equals(Jb)?ba.startPos:
0,ba.a4.equals(Jb)?ba.endPos:Pb.ParagraphReader.textLength(Jb)))}const nb=new Lg.SelectionCollection(Qa,0);Da.textAnchoringInfo.AnchoringShape&&Da.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.wf(Nd.a.nS),this.TIg.execute(Wb=>{(Wb=Object(mb.a)(376,Wb.Rd))&&this.TIg.instance.iBh(Object(mb.a)(Zj.a,Wb),nb)})):(this.Fa.wf(Nd.a.qg),this.pa.gF(nb))}}else this.Fa.wf(Nd.a.qg);return 32}}else{if(od.a.contains(this.rIf,ba))this.Fa.wf(Nd.a.qg);else{ba=null;ba=this.Kc&&this.Kc.Hc?this.xl.T$a(this.Kc.Hc.$c):
this.Z4e(this.xl.qz());if(!od.a.Xa(ba))for(Da of ba)if(this.Om.isVisible||0===Da.status){this.Jga(Da.commentId,1,!1);break}this.mta()}return 32}return 8}dCf(ba,Da){ba&&!Da?this.LJ?this.eSc():(this.Fa.wj(Nd.a.hr,!0),this.mta(),this.ZTc()):Da?ba&&this.Fa.C4(Nd.a.hr,Nd.a.$i,this.Om,!1):0<this.Jae()||this.ni&&this.ni.TC?this.Fa.wj(Nd.a.LW,!0):this.Fa.wj(Nd.a.hr,!1);Da||this.Qyh()}QEk(){this.kdd||(this.qm.WU(this.qm.qZd,this.qm.i0d),this.qm.hoa(this.qm.qZd,this.qm.i0d),this.kdd=!0,this.zE.REk(this.ua.pk));
this.QX&&this.QX.$5i()}Qyh(){const ba=this.xl.qz();ba&&0<ba.length&&(this.FFg=!0)}O_(){var ba=this.xl.qz();if(!ba||!ba.length)return!1;ba=Ah.e(ba,Da=>0===Da.status);return!!ba&&0<ba.length}VKa(ba,Da,Qa,nb,Wb){ba===fe.a.VKa?Wb[Vi.a.On]=this.Om.isVisible:ba===fe.a.FLb||ba===Xb.a.KUe?Wb[$h.a.On]=this.Om.isVisible:ba===fe.a.Dod?Wb[$h.a.On]=this.Ieb:ba===fe.a.dUe&&(Wb[$h.a.On]=this.Keb);return!this.ua.Ba||this.isDisabled?16:32}Bwb(ba,Da,Qa,nb,Wb){return 2!==Qa?32:(ba=this.r0f(Wb))&&this.findComment(ba)?
32:8}L2b(ba,Da,Qa,nb,Wb){return 2!==Qa?32:(ba=this.r0f(Wb))&&this.FBk(ba)?32:8}r0f(ba){if(!ba)return null;ba=ba.NavigationId;if(!ba)return null;try{return JSON.parse(ba)}catch(Da){return Kb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",Da),null}}FBk(ba){if(this.npg(this.Kc.Hc.$c,ba))return this.oxh(ba);var Da=gd.a.ax(ba.sId,ba.cId);Da=this.yee(Da);if(!Da)return!1;this.Da.Xn?this.Ina.instance&&this.Ina.instance.dK(Da.qe):this.xe.dK(Da.qe);D.a.z7a(this.wb,()=>{this.oxh(ba)});
return!0}oxh(ba){const Da=this.findComment(ba);if(!Da)return!1;1!==Da.status&&2!==Da.status||this.fvd();this.Jga(ba.commentId,1,!1);return!0}findComment(ba){var Da=this.ua.presentation;if(!Da)return null;Da=Da.slides;if(!Da)return null;for(const Qa of Da)if((Da=Object(mb.a)(Le.a,Qa))&&this.npg(Da,ba)){Da=this.xl.Tta(Da.nE());for(const nb of Da){if(nb.commentId===ba.commentId)return nb;if(nb.Children&&nb.Children.length)for(const Wb of nb.Children)if(Wb.commentId===ba.commentId)return Wb}}return null}npg(ba,
Da){return ba.cid&&Da.cId?ba.cid===Da.cId:ba.sid===Da.sId}isCollapsed(){return!1}get zxh(){return null}clearSelection(){}E6k(){this.Rb.updateCommandUI()}get fbb(){return!!this.ni}IDi(){this.ni&&this.nLf(8)}m6(ba){2===ba.behavior&&ba.actionId===fe.a.$_a&&(ba=this.Xs.OVc(!0),ba!==fe.a.jmd&&ba!==fe.a.BQ&&ba!==fe.a.ASa&&ba!==fe.a.iwb&&ba!==fe.a.jwb||eg.UISurfaces.KL().then(Da=>{this.feb.f$k(Da)}))}l6(){}static x5g(ba,Da){return ba.contentId===Da}static Bek(ba){let Da="";if(ba){for(const Qa of ba)if(Da+=
Qa.commentId+";",Qa.Children)for(const nb of Qa.Children)Da+=nb.commentId+";";Kb.a.J(512496659,805,15,"LogCommentIds() - {0}",Da)}}}Object(h.a)(cg,"SharedCommentFrame",null,[956,108,957,144]);class Sg{constructor(ba,Da,Qa,nb,Wb,Jb,Uc=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=ba;this.parentId=Da;this.commentBody=Qa;this.author=nb;this.date=Wb;this.commentFlags=Jb;this.usersByReactionType=Uc}}Object(h.a)(Sg,
"OfficeSharedCommentModel",null,[]);class Hh{constructor(ba,Da){this.CommentId=ba;this.ResolveState=Da}}Object(h.a)(Hh,"CommentProperties",null,[]);class li{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(h.a)(li,"AtMentionAttributes",null,[]);class Oh{constructor(){this.contentId=""}}Object(h.a)(Oh,"AtMentionOptionalAttributes",null,[]);class Wi{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=
0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(Wi,"DeltaAttributes",null,[]);var Xi;(function(ba){ba[ba.Undo=-1]="Undo";ba[ba.Unknown=0]="Unknown";ba[ba.Create=1]="Create";ba[ba.Assign=2]="Assign";ba[ba.Unassign=3]="Unassign";ba[ba.UnassignAll=4]="UnassignAll";ba[ba.Schedule=5]="Schedule";ba[ba.Progress=6]="Progress";ba[ba.Delete=7]="Delete";ba[ba.Restore=8]="Restore";ba[ba.SetTitle=9]="SetTitle";ba[ba.Priority=10]="Priority"})(Xi||(Xi={}));Object(h.b)("HistoryRecordType",Xi);class Fi{constructor(){this.Id=
this.FullName=this.Email=this.DispName=null}}Object(h.a)(Fi,"CommentAtMention",null,[]);var Mi=d(919);class mh{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(mh,"UserInfo",null,[]);class ai{constructor(ba,Da){this.plainText=ba;this.T7g=Da}}Object(h.a)(ai,"TextTranslationResult",null,[]);var Aa=d(72);class Ua{constructor(ba,Da,Qa){this.Ggl="[";this.Lqi=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.Zbk=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");
this.Mqi=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.bzg=!1;this.NSi=nb=>{if(!nb)return null;let Wb={};for(const Jb of nb){a:{switch(Jb.Type){case "\ud83d\udc4d":nb=1;break a;default:Kb.a.J(509220245,805,50,"Unsupported reaction type")}nb=void 0}void 0!==nb&&(Wb[nb.toString()]=this.VYk(Jb.ReactionInstances))}return Wb};this.VYk=nb=>{let Wb=[];for(const Jb of nb)nb=Jb.User,Wb.push({DateUtc:Jb.Time,DisplayName:nb.DisplayName,Email:nb.Email,Provider:nb.ProviderId,
UserId:nb.UserId,IsCurrentUser:this.isCurrentUser(Jb.User.UserId,Jb.User.ProviderId)});return Wb};this.Ib=ba;this.hHe=Da;this.qDe=Qa}get userId(){return this.Ib.appSettings["387"]}get providerId(){return this.Ib.appSettings["388"]}Bvj(ba,Da){let Qa=0;if(1===ba.status||2===ba.status)Qa|=8;Da&&(Qa|=1);this.$xl(ba)&&(Qa|=16);this.Ib.ka("PPTOBlueDotsForComments")&&ba.isUnread&&(Qa|=32);return Qa}isCurrentUser(ba,Da){return ba?"Author"===ba||this.userId===ba&&Da===Da?!0:!1:!1}oYj(ba){return this.isCurrentUser(ba.userId,
ba.providerId)}$xl(ba){return""===ba.userId||"Author"===ba.userId||!this.XXl(ba.userId)||this.userId===ba.userId&&this.providerId===ba.providerId?!1:!0}XXl(ba){return 3===ba.split("::").length}dMh(ba,Da,Qa){var nb;if(null===ba)throw Error.argumentNull("comment");const Wb=this.OMl(ba.text);var Jb=ba.authorName,Uc=pc.a("PPTPlumbEmailThroughCG")?Ea.a.e$a(ba.userId||""):"";const Jd=ba.dt;Qa=this.Bvj(ba,Qa);Jb=new kb(ba.userId,ba.providerId,Jb,Uc,this.oYj(ba));return Fb(this.Ib)&&(null===ba||void 0===
ba?0:ba.reactions)?(Uc=this.NSi(null===(nb=ba.reactions)||void 0===nb?void 0:nb.ReactionList),new Sg(ba.commentId,Da,Wb,Jb,Jd,Qa,Uc)):new Sg(ba.commentId,Da,Wb,Jb,Jd,Qa)}MMl(ba,Da){if(null===ba)throw Error.argumentNull("comments");const Qa=new r.a;for(const nb of ba)if(Qa.add(this.dMh(nb,"",Da)),nb.Children&&0<nb.Children.length)for(const Wb of nb.Children)Qa.add(this.dMh(Wb,nb.commentId,Da));return Qa.toArray()}SMl(ba,Da,Qa,nb){const Wb=Object.assign(new Mi.a,{Asignees:[]});ba=this.hHe.Sbj(ba,Da,
!Da.taskId,Qa);for(const Jb of ba)2===Jb.type?Jb.assignee?(ba=Object.assign(new mh,{DisplayName:Jb.assignee.DisplayName,FullName:Jb.assignee.DisplayName,UserId:Jb.assignee.UserId,ProviderId:Jb.assignee.Provider,Email:Jb.assignee.Email}),Wb.Asignees.push(ba)):Kb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===Jb.type&&(Wb.Title=Jb.title);if(!Wb.Asignees)return Kb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),
null;Wb.Title||(Kb.a.J(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Wb.Title=nb);return Wb}QMl(ba,Da){const Qa=new Mi.a;if(ba.assignee){const nb=new mh,Wb=ba.assignee;nb.DisplayName=Wb.Name;nb.FullName=Wb.Name;nb.UserId=Wb.UserPrincipalName;nb.ProviderId="O365";nb.Email=Wb.UserPrincipalName;Qa.Asignees=[nb]}Qa.Title=ba.title?ba.title:Da;return Qa}RMl(ba,Da,Qa){if(!Da)return null;try{const nb=this.myd(Qa,new Date).plainText,Wb=this.qDe?this.SMl(ba,
Da,Qa,nb):this.QMl(Da,nb);if(!Wb)return null;Wb.CompletionPercentage=Da.completion?Da.completion:0;return Wb}catch(nb){Kb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",nb)}return null}LMl(ba){if(null===ba)throw Error.argumentNull("comments");const Da=new r.a;for(const Qa of ba)Qa.taskInfo&&Qa.taskInfo.Asignees&&0<Qa.taskInfo.Asignees.length&&(ba=this.KMl(Qa))&&Da.add(ba);return Da.toArray()}KMl(ba){if(this.qDe&&this.hHe&&0<ba.taskInfo.TaskHistoryRecords.length)try{const Da=
Ua.bLi(ba.taskInfo.TaskHistoryRecords),Qa=new Aa.a;Qa.add(ba.commentId,new Hh(ba.commentId,100===ba.taskInfo.CompletionPercentage));const nb=this.hHe.ySi(ba.commentId,ba.commentId,Da,Qa);Ua.JBi(ba,nb,this.qDe);return nb}catch(Da){return Kb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",Da.message),this.cMh(ba)}else return this.cMh(ba)}cMh(ba){var Da=new da;Da.startDate=ba.taskInfo.StartDate;Da.endDate=ba.taskInfo.DueDate;const Qa=new ra(ba.taskInfo.Asignees[0].UserId);
Qa.DisplayName=ba.taskInfo.Asignees[0].DisplayName;Qa.Provider=ba.taskInfo.Asignees[0].ProviderId;Qa.Email=ba.taskInfo.Asignees[0].Email;const nb=Array(1);nb[0]=Qa;Da=new Y(!1,ba.taskInfo.Title,nb,Da,ba.taskInfo.CompletionPercentage,0);return new H(ba.commentId,ba.commentId,Da,[])}OMl(ba){if(null===ba)throw Error.argumentNull("nativeText");const Da=new pa;ba=ba.split(this.Mqi);for(const nb of ba){var Qa=this.Lqi.exec(nb);Qa&&3===Qa.length?(ba=new li,Qa[0].substring(0,1)===this.Ggl?(ba.fullName=Qa[2],
ba.resolveState=1):(ba.fullName=Qa[1],ba.resolveState=0),ba.email="UnknownEmail",Qa=new Oh,Qa.contentId="Pre-existing Mention",Da.xTj("@"+ba.fullName,ba,Qa),this.bzg||(this.bzg=!0,Kb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(ba=this.Zbk.exec(nb))&&1===ba.length?(ba=ba[0],Da.insertHyperLink(ba,Object.assign(new Wi,{link:ba}))):Da.XTj(nb)}return Da.Jij()}myd(ba,Da){var Qa=Sys.Serialization.JavaScriptSerializer.deserialize(ba);ba=[];Da||(Da=new Date);const nb=new Sys.StringBuilder;
for(const Wb of Qa.ops)if(Wb.attributes){if(Wb.attributes.atmention){const Jb=1<Wb.insert.length?Wb.insert.substring(1,Wb.insert.length):"";if(Wb.optional&&Wb.optional.atmention&&Wb.optional.atmention.contentId)Qa=Ua.m$f(Jb,1===Wb.attributes.atmention.resolveState);else{Qa=Ua.m$f(Jb,1===Wb.attributes.atmention.resolveState);const Uc=Ua.wpj(Da,1===Wb.attributes.atmention.resolveState);Array.add(ba,Object.assign(new Fi,{FullName:Wb.attributes.atmention.fullName,DispName:Jb,Id:Uc,Email:Wb.attributes.atmention.email}));
Da=new Date(Da.getTime()+1)}}else Wb.attributes.link||Kb.a.J(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Qa=Wb.insert;nb.append(Qa)}else nb.append(Wb.insert);return new ai(nb.toString(),ba)}static zLi(ba){switch(ba){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static wLi(ba){var Da=null;ba.User&&(Da=new ra(ba.User.UserId,
ba.User.ProviderId,ba.User.DisplayName));Da=new ca(Ua.zLi(ba.HistoryRecordType),Da,ba.DtTime,ba.RecordId);Da.commentId=ba.CommentId;ba.Assignee&&(Da.assignee=new ra(ba.Assignee.UserId,ba.Assignee.ProviderId,ba.Assignee.DisplayName));ba.StartDate&&ba.DueDate?(Da.schedule=new da,Da.schedule.startDate=ba.StartDate?ba.StartDate:null,Da.schedule.endDate=ba.DueDate?ba.DueDate:null):ba.StartDate&&!ba.DueDate?Kb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):
!ba.StartDate&&ba.DueDate&&Kb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Qa=ba.Priority;0<Qa?Da.priority=Qa:Kb.a.J(512496649,845,10,"Priority is negative");Qa=ba.CompletionPercentage;0<=Qa?Da.completion=Qa:Kb.a.J(512496648,845,10,"Percent complete is negative");Da.title=ba.Title;Da.undoId=ba.UndoId;return Da}static bLi(ba){const Da=ba.length,Qa=Array(Da);for(let nb=0;nb<Da;++nb)Qa[nb]=Ua.wLi(ba[nb]);return Qa}static JBi(ba,Da,Qa){const nb=
Da.currentState,Wb=ba.taskInfo;let Jb=!1;const Uc=pc.a("SetTaskFromTaskStateInsteadOfHistory");Wb.StartDate.toString()!==nb.schedule.startDate.toString()&&(Uc&&(nb.schedule.startDate=Wb.StartDate),Jb=!0,Kb.a.J(512496647,845,10,"Start Date does not match."));Wb.DueDate.toString()!==nb.schedule.endDate.toString()&&(Uc&&(nb.schedule.endDate=Wb.DueDate),Jb=!0,Kb.a.J(512496646,845,10,"End Date does not match."));Wb.CompletionPercentage!==nb.completion&&(Uc&&(nb.completion=Wb.CompletionPercentage),Jb=!0,
Kb.a.J(512496645,845,10,"Completion percentage does not match."));Wb.Title!==nb.title&&(Uc&&(nb.title=Wb.Title),Jb=!0,Kb.a.J(512496644,845,10,"Title does not match."));Wb.Asignees[0].UserId!==nb.assignees[0].UserId&&(Uc&&(nb.assignees[0].UserId=Wb.Asignees[0].UserId),Jb=!0,Kb.a.J(512496643,845,10,"Assigned to user id does not match."));Wb.Asignees[0].DisplayName!==nb.assignees[0].DisplayName&&(Uc&&(nb.assignees[0].DisplayName=Wb.Asignees[0].DisplayName),Jb=!0,Kb.a.J(512496642,845,10,"Assigned to display name does not match."));
Wb.Asignees[0].ProviderId!==nb.assignees[0].Provider&&(Uc&&(nb.assignees[0].Provider=Wb.Asignees[0].ProviderId),Jb=!0,Kb.a.J(512496641,845,10,"Assigned to provider id does not match."));Wb.Asignees[0].Email!==nb.assignees[0].Email&&(Uc&&(nb.assignees[0].Email=Wb.Asignees[0].Email),Qa||(Jb=!0,Kb.a.J(512496640,845,10,"Assigned to email does not match.")));if(Jb&&Qa&&(Ua.Zgk(ba,Da),pc.a("IsThrowForTaskStateMismatchEnabled")))throw Kb.a.J(0,845,10,"There was a mismatch between the state and state as determined by history"),
Error.create("TaskStateMismatch");}static Zgk(ba,Da){const Qa=new r.a;for(const nb of Da.history)for(const Wb of nb.records)Qa.add(Xi[Wb.type]);if(Qa.count!==ba.taskInfo.TaskHistoryRecords.length){Da=new r.a;for(const nb of ba.taskInfo.TaskHistoryRecords)Da.add(Xi[nb.HistoryRecordType]);Kb.a.J(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static wpj(ba,Da){ba=ba._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return Da?ba+"_Z":ba}static m$f(ba,Da){return Da?
"[@"+ba+"]":"<@"+ba+">"}}Object(h.a)(Ua,"SharedCommentModelTranslator",null,[954]);class gb{constructor(ba,Da,Qa){this.tmf=!1;this.Fa=ba;this.Gg=Da;this.ifc=Qa}ZBf(ba){ba?(this.ifc&&this.ifc.isVisible||this.Gg.hL(Nd.a.Qz),this.Gg.Eo(Nd.a.hr),this.Fa.hC(Nd.a.Qz)):this.Gg.Eo(Nd.a.Qz);this.tmf=ba}get Ctg(){return this.tmf}}Object(h.a)(gb,"SharedCommentsRTEFocusActionHelper",null,[931]);class Eb{constructor(ba,Da,Qa,nb){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=ba;this.body=
Da;this.confirmButton=Qa;this.cancelButton=nb}}Object(h.a)(Eb,"ViewContainerModalDialogStrings",null,[]);class Ub{constructor(ba,Da,Qa){this.containerType="full-pane";this.identifier=null;this.kb=ba;this.Fa=Da;this.identifier=Qa}closeView(){this.kb.prc(!1,!1)}openView(){this.kb.prc(!0,!1)}invokeModalConfirmationDialog(ba,Da,Qa){const nb=new Gh.StandardDialog;Qa&&Qa.title&&Qa.body&&Qa.confirmButton&&Qa.cancelButton||(Kb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),
Qa=new Eb("","","",""));nb.Ad=1;nb.Le(1,Qa.confirmButton);nb.Le(0,Qa.cancelButton);nb.x9a=this.Fa.Ee.name;nb.Mmc=!0;nb.Tx(Qa.title,Qa.body,1,Wb=>{1===Wb?(ba(),nb.x9a=null):Da()})}}Object(h.a)(Ub,"ViewContainerAPI",null,[951,952]);class vc extends Sys.EventArgs{constructor(){super()}}Object(h.a)(vc,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var jd=d(343);class Id{constructor(){this.tOg=this.t2g=this.Ghb=this.e4g=this.Awa=this.B7c=this.aZa=this.D7c=this.mR=this.K=null;this.Geb=this.Uva=this.lEb=
!1;this.LR=this.uwe=null;this.oQg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.GO=null;this.LJ=!1}Xb(ba){this.K=ba;this.LJ=this.K.resolve("PowerPointWebEditor.IApplicationSettings").m0d;this.LR=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.Ghb=new J(n.AFrameworkApplication.De,"CommentPane");ba.register(Xa,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").na().oa(()=>new Xa);const Da=this.K.resolve("PowerPointWebEditor.IFileInfo").Mja,Qa=2===Da||
3===Da;this.lEb=Qa;this.Geb=1===Da;ba.register(Ne,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").na().oa(()=>new Ne(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),Da));ba.register(Vf,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").na().oa(()=>
new Vf(this.LR,Da,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ia("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));const nb=this.lEb||!this.Geb;this.GO=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");nb&&ba.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").na().oa(()=>new jd.a((ne,bf)=>
{let sd=null;const vd=Object(mb.a)(117,ne.qc(ba.resolve("Box4.IPageView").Na));vd&&!vd.Ml&&(ne=ba.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").H2d(ba.resolve("PowerPointWebEditor.IPptSelectionManager"),null,ne,bf,vd.nV),sd=new Og(ne),sd.Bm(vd.nV),vd.$ra(sd,5),sd.visible=vd.TQ||vd.lo);return sd}));this.K.register(928,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").na().oa(()=>new Sc(this.GO,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),
ba.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(929,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").na().oa(()=>new Pa(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Nd,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.GO));const Wb=this.lEb||!this.Geb;this.K.register(930,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").na().oa(()=>new kc(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),
new Mf(Wb),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Wb,Wb));this.K.register(Kf,"PowerPointWebEditor.CommentTextAnchorHighlightActor").na().oa(()=>new Kf(!this.Geb,this.K.resolve("Common.Utils.IHighContrastDetector")));const Jb=new be(nb,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),nb?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.GO,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));ba.register(931,"PowerPointWebEditor.IRTEFocusActionHelper").na().oa(()=>new gb(ba.resolve("Common.IFocusManager"),ba.resolve("Common.IF6Manager"),ba.resolve("PowerPointWebEditor.ICommentsPane")));
this.K.register(C,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").na().oa(()=>new C(this.K.resolve("Common.ITaskManager")));const Uc=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");Uc&&this.K.register(932,"Common.Comments.ICommentTaskTranslator").na().oa(()=>(new Za(!0,Uc,!0)).nNi());this.K.register(Ua,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").na().oa(()=>
new Ua(this.K.resolve("Common.IAppSettingsManager"),Uc?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,Uc));this.K.register(Na,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").na().oa(()=>new Na);this.Uva=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(Qa||!this.Geb);this.K.register(cg,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").na().oa(()=>new cg(this.GO,
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").xa,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),
this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Ghb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),n.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Nd,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.LR,Jb,this.K.resolve("Common.IAppSettingsManager"),this.K.Ia("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),nb,ba.resolve("PowerPointWebEditor.IErrorHandler"),ba.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Uva,ba.resolve("Box4.Graph.IGraphInstance").zd(10),ba.resolve("PowerPointWebEditor.View.IViewEventSource"),
ba.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Wb,ba.resolve("PowerPointWebEditor.IShapeReader"),ba.Ia("Common.App.SafeLinks.ISafeLinksManager"),ba.resolve("Box4.ICharacterPropertiesEditor"),ba.resolve("PowerPointWebEditor.IFileInfo"),this.LJ,ba.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").AJa?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):
null,this.K.Ia("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ia("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xn?this.K.Ia("PowerPointWebEditor.ISorterViewActorLazy"):null));this.K.register(gc,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").na().oa(()=>new gc(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").kik));
this.K.register(Ub,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").na().oa(()=>new Ub(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.oQg));const Jd=new Ff(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new Ki(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.GO,this.K.resolve("Common.IAppSettingsManager").ka("459"),
this.K.ue("PowerPointWeb.Comments.ICommentFrame"));this.K.register(933,"PowerPointWebEditor.IFindCommentLogic").na().oa(()=>new md(Jd,this.K.resolve("Common.ITaskManager")));this.K.register(vf,"PowerPointWebEditor.CommentsChangeListener").na().oa(()=>new vf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").zd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(934,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").na().oa(()=>new Ue(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.GO,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));
this.K.register(Me,"PowerPointWebEditor.CommentPropertyTracker").na().oa(()=>new Me(Object(sa.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").cNe,"onCommentPropertiesUpdated"),db.App.IP.AV,ub.GraphTransactionManager.instance));this.K.register(935,"PowerPointWebEditor.ICommentsPane").na().oa(()=>new Se(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cva,
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.LJ));this.K.register(pd,"PowerPointWebEditor.CommentSmartReplyProvider").na().oa(()=>new pd(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){zc.a.instance.$b(Yb.a.l0d,(new Date).getTime());const ba=this.LR.Ii("UserAction","InitCommentsPackage"),Da={};this.LJ||(this.aZa=this.K.resolve("PowerPointWebEditor.ICommentsPane").xa);this.mR=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");
this.mR.initialize();var Qa=ba.er;Da.CommentFrameInitMS=Qa;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");this.D7c=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");this.D7c.KMj();const nb=ba.er;Da.CommentPropertyTrackerInitMS=nb-Qa;this.uwe=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.e4g=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Wb=Wa.b(n.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Qa=Wb.Ring||"Unknown";
Wb=Wb.WACDatacenter||"Unknown";const Jb=this.K.resolve("PowerPointWebEditor.IApplicationSettings").GWj;var Uc=n.AFrameworkApplication.fa.Ha("LokiComplianceEnvironment");Uc=Uc&&""!==Uc?Uc:n.AFrameworkApplication.fa.Ha("SovereignEnvironmentName");this.t2g=new sb("PowerPoint",n.AFrameworkApplication.buildVersion,null,null,n.AFrameworkApplication.userSessionId,Qa,Wb,!Jb,this.K.resolve("Common.IActionManagerExtended"),null,Uc);Qa=oc.a.He(n.AFrameworkApplication.lcid);this.tOg=new wb(n.AFrameworkApplication.isRtl,
Qa?Qa.name:Sys.CultureInfo.CurrentCulture.name,n.AFrameworkApplication.uiCulture,n.AFrameworkApplication.dataCulture);this.LJ||(this.aZa.id=this.oQg);this.gac();n.AFrameworkApplication.fa.$e(Object(sa.a)(this,this.jn,"onFullAppSettingsReady"));(Qa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Qa.Y0k(new vc);Qa=ba.er;Da.CommentReactPaneInitMS=Qa-nb;this.bQj();Da.CommentPaneInitMS=ba.er-Qa;n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",
!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();ba.stop();Kb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",Da,this.K.resolve("Common.IAppSettingsManager").ka("896"))}bQj(){const ba=this.K.resolve("PowerPointWebEditor.ICommentsPane"),Da=this.K.resolve("PowerPointWebEditor.IPaneManager");this.LJ||document.getElementsByClassName("CommentPanel").length||Da.m_(ba);Da.LCb(2);this.K.resolve("PowerPointWebEditor.IFocusManager").C4(Nd.a.hr,
Nd.a.$i,ba,!ba.isVisible)}gac(){zc.a.instance.$b(Yb.a.gac,(new Date).getTime());const ba=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").Nvb().then(Da=>{zc.a.instance.$b(Yb.a.pje,(new Date).getTime());rc.a.Ot(ba.K.Ia("Common.App.People.IExternalPeopleAPI")).continueWith(Qa=>{ba.Awa=Qa.result;ba.Awa||Kb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");ba.K.resolve("PowerPointWebEditor.IApplicationSettings").yg&&(Qa=ba.K.resolve("Common.IAppSettingsManager").Ha("368"),
ba.Awa.Sfh(Qa+"p"));Qa=[Ka.a.contextMenu];ba.LJ||Db.a.Hpd(ba.aZa,Qa);const nb=Da&&(ba.lEb||!ba.Geb),Wb=ba.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");ba.K.register(ag,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").na().oa(()=>new ag(ba.K.resolve("Common.IAppSettingsManager"),ba.K.resolve("PowerPointWebEditor.IApplicationSettings"),ba.Awa,ba.Geb,nb,ba.Uva));ba.K.register(kd,
"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").na().oa(()=>new kd(ba.K.resolve("PowerPointWeb.Comments.ICommentFrame"),ba.GO,ba.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),ba.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),ba.K.resolve("Common.ITaskManager"),ba.K.resolve("Common.IAppSettingsManager"),ba.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),ba.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
ba.Awa,ba.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),ba.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),nb,ba.Uva,Wb,ba.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),ba.K.resolve("Common.IActionManagerExtended"),ba.K.resolve("PowerPointWebEditor.IApplicationSettings")));ba.B7c=ba.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{ba.B7c&&ba.B7c.checkAtMentionCapability().then(Qa=>{Qa&&((Qa=ba.K.Ia("Common.ISystemInitiatedFeedback"))?
Qa.execute(nb=>{nb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Kb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});ba.$Pj()})})}$Pj(){zc.a.instance.$b(Yb.a.v2e,(new Date).getTime());const ba=this.K.resolve("Common.IDynamicScriptLoaderProvider").xI,Da=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Qa=this.K.resolve("Common.Comments.ICommentActivationManager");
zc.a.instance.$b("CommentActivationManagerInitStart",(new Date).getTime());Qa.initialize(ba,this.B7c,this.t2g,this.Awa,new bc(this.e4g,this.Ghb),this.tOg,null,Da.Cvj());zc.a.instance.$b(Yb.a.Fac,(new Date).getTime());Qa.Fac().then(()=>{zc.a.instance.$b(Yb.a.qje,(new Date).getTime());this.mR.GSj();zc.a.instance.$b(Yb.a.tte,(new Date).getTime());uc.a(this.K)("floatingContainerManager").then(()=>{zc.a.instance.$b(Yb.a.m9d,(new Date).getTime());this.mR.lQj();zc.a.instance.$b(Yb.a.n9d,(new Date).getTime());
if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rpi){const nb=this.GO.qz();nb&&0<nb.length?(this.mR.dll(),zc.a.instance.$b(Yb.a.Eud,(new Date).getTime()),Lb.App.ENb(null,Yb.a.Eud)):Kb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(nb=>{Kb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+nb.toString())})})}jn(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.D7c&&
this.D7c.hQl();this.mR&&this.mR.dispose();this.uwe&&this.uwe.dispose();this.Awa=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){zc.a.instance.$b(Yb.a.g0d,(new Date).getTime());n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CommentTTVRImprovementIsEnabled",!1)?Mc.a.instance.Ac(new Id,0,!0):Mc.a.instance.Ac(new Id)}}Object(h.a)(Id,"CommentsPackage",null,[2,3]);var Od=d(13);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");
Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Type.registerNamespace("Common.Comments");Object(Od.c)("Comment");Id.main();Object(Od.b)("Comment")},702:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(18),e=d(99),r=d(29),m=d(50);d(98);class n{constructor(){this.d0=null}get Wzb(){return!1}qMh(z,t){let x=new h.a;const B=new m.GraphTransaction(3);
try{B.ld(r.App.Mb.Ld.Rn.Ag),this.kdc(t)&&(x=this.Kac(t,x)),t!==z&&this.kdc(z)&&(x=this.Kac(z,x))}finally{B&&B.dispose()}return x.toArray()}kdc(z){return!!z}Spd(z){let t=!1;for(const x of this.bie)t||!Sys.UI.DomElement.containsCssClass(z,x.className)&&!Sys.UI.DomElement.containsCssClass(z,x.J9b)||(t=!0),e.a.gLa(z,x.className),e.a.gLa(z,x.J9b)}}Object(K.a)(n,"AHighlightActor",null,[1008])},703:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r){this.className=e;this.J9b=
r}}Object(K.a)(h,"HighlightCssClassPair",null,[])},704:function(K,S,d){d.d(S,"b",function(){return m});d.d(S,"a",function(){return n});var h=d(99);d(29);var e=d(50);d(34);d(95);var r=d(98);const m=z=>{const t=new e.GraphTransaction(3);try{t.ld(z),z.Kv(32,!0)}finally{t&&t.dispose()}},n=z=>{if(z){z=h.a.Lka(z);if(-1===z.indexOf(r.a.H8)&&-1!==z.indexOf(r.a.JN)&&-1===z.indexOf(r.a.d4b))return 2;if(-1===z.indexOf(r.a.H8)&&(-1!==z.indexOf(r.a.c4b)||-1!==z.indexOf(r.a.$N)||-1!==z.indexOf(r.a.d4b)||-1!==z.indexOf(r.a.XNc)||
-1!==z.indexOf(r.a.MPc)||-1!==z.indexOf(r.a.KPc)||-1!==z.indexOf(r.a.JPc)||-1!==z.indexOf(r.a.h3d)||-1!==z.indexOf(r.a.c3d)||-1!==z.indexOf(r.a.e3d)||-1!==z.indexOf(r.a.LPc)||-1!==z.indexOf(r.a.b3d)))return 1;if(-1!==z.indexOf("WACImageContainer"))return 3}return 0}},705:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.type=this.action=0;this.xjb=this.kea=null}}Object(K.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.comment.js.map