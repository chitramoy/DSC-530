'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1304:function(K,S,d){d.r(S);K=d(0);var h=d(71),e=d(28),r=d(196),m=d(52),n=d(30);class z{constructor(wa,Fa){this.ia=wa;this.ia.ra(n.a.$Nj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.aOj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.bOj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.cOj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.dOj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.eOj,
m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.fOj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.LNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.MNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.NNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.ONj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.PNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.QNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.RNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.KNj,
m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.SNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.TNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.VNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.WNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.XNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.YNj,m.a.application,r.ActionManager.Cv,4);this.ia.ra(n.a.ZNj,m.a.application,r.ActionManager.Cv,4);this.BCg=JSON.parse(Fa.Ha("674"));for(const pa of this.BCg)pa.regex=
new RegExp(pa.pattern)}trackAction(wa){for(const Fa of this.BCg)Fa.regex.test(wa)&&this.ia.processAction(Fa.actionId,2)}}Object(K.a)(z,"IdeasActionTracker",null,[1152]);class t{constructor(){this.$eb=this.zIe=this.FHe=null;this.W0j=this.z2l}addSlideSuggestionsListener(wa){this.FHe=wa}addTextToSmartArtSuggestionListener(wa){this.zIe=wa}CTd(wa){this.$eb=wa}notifySlideSuggestion(wa,Fa){this.FHe&&(this.FHe(wa,Fa),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",Fa?Fa.suggestions.length:0,Fa?
Fa.correlationId:"0"))}notifyTextToSmartArtSuggestion(wa,Fa){this.zIe&&(this.zIe(wa,Fa),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",Fa?Fa.suggestions.length:0,Fa?Fa.correlationId:"0"))}Hid(wa){this.$eb&&this.$eb(wa)}}Object(K.a)(t,"InfraredDesignerServiceProvider",null,[1153]);class x{constructor(){this.$eb=null}CTd(wa){this.$eb=wa}Hid(wa){this.$eb&&this.$eb(wa)}}Object(K.a)(x,"InfraredTelemetryListener",null,[1154]);var B=d(199),D=d(1053),w=d(47),J=d(7),F=d(36);class L{}Object(K.a)(L,
"EntityGroup",null,[]);class M extends L{}Object(K.a)(M,"Idea",L,[]);var Q=d(551);class C{}Object(K.a)(C,"ProviderResult",null,[]);var O=d(346),U=d(446),T=d(445),ca=d(345),N=d(550),da=d(27),Y=d(272);class fa{}fa.VUk="PowerPoint";fa.SYl="WAC";Object(K.a)(fa,"ApplicationPropertiesConstants",null,[]);class aa{}Object(K.a)(aa,"EnterpriseUserInfo",null,[]);class ka{}Object(K.a)(ka,"Message",null,[]);class H extends ka{}H.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(K.a)(H,"PowerPointTextTileChangedMessage",
ka,[]);class ra{}Object(K.a)(ra,"RankerConfiguration",null,[]);class ha{constructor(wa){this.A4g=wa}Kcj(wa,Fa){return new Promise((pa,Ea)=>{this.A4g&&wa&&Fa||Ea("wopiIdentityManager or tokenParameter or clientWoipId is null");this.A4g.getAccessToken(wa,Fa).then(ta=>{ta?pa(ta.accessToken):Ea("auth token is null")},ta=>{Ea(ta)})})}}Object(K.a)(ha,"AuthenticationProvider",null,[1192]);class Ma{constructor(wa,Fa,pa,Ea,ta=""){this.resource=wa;this.scope=Fa;this.silentLogin=pa;this.options=Ea;this.correlationId=
ta}}Object(K.a)(Ma,"InfraredTokenParameters",null,[482]);class Ga{constructor(wa,Fa,pa,Ea,ta,ia,Ja,ab,Oa){this.yIg=this.qve=this.mkf=null;this.hIg=!1;this.NDe=null;this.kHe=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.hHb=wa;this.Amk=Ja;this.qBe=Oa;this.lpk=wa.ka("659");this.pHb=wa.Ha("750");Ja=window.location.hostname;Oa=wa.Ha("816");Ja&&0<Ja.length&&Oa&&0<Oa.length&&0<=Oa.toLowerCase().indexOf(Ja.toLowerCase())&&(this.pHb="");this.VXa=Fa;this.Xfc=ia;if(this.kxk=
wa.ka("688"))this.yIg=wa.Ha("689"),this.qve=new ha(ab);this.VXa.addSlideSuggestionsListener(Object(J.a)(this,this.tMk,"onSlideSuggestion"));this.VXa.addTextToSmartArtSuggestionListener(Object(J.a)(this,this.TMk,"onTextToSmartArtSuggestion"));this.VXa.CTd(Object(J.a)(this,this.pbh,"onIdeasSessionTelemetry"));pa.CTd(Object(J.a)(this,this.pbh,"onIdeasSessionTelemetry"));this.Xfc&&this.Xfc.execute(Za=>{Za.XAf(Object(J.a)(this,this.sNe,"onEditorCritiques"))});this.ia=Ea;(this.rU=ta)&&this.rU.execute(Za=>
{Za.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new T.a,{name:"InfraredSlideTextTileLambda",inputSchema:U.a.Wuc,outputSchema:U.a.Wuc,func:(Na,sa,Sa)=>{this.uMk(Na);Sa(null)}}))});this.hvl()}get bAb(){return this.mkf}hvl(){var wa=JSON.parse(this.hHb.Ha("612"));wa=Object.assign(new ra,{rankingOrder:wa});var Fa=IdeasInfraredConnector,pa=Fa.setup,Ea=e.a.J,ta=Object(J.a)(this,this.gOj,"ideasPaneVisibilityStatusCallback"),ia=this.hHb;const Ja={};Ja.appName=2===da.AFrameworkApplication.Aa.mb.Ti?
fa.VUk:"unknown";Ja.appVersion=da.AFrameworkApplication.buildVersion;Ja.appPlatform=fa.SYl;Ja.lcid=da.AFrameworkApplication.lcid;var ab=Y.a.He(da.AFrameworkApplication.lcid);ab=ab?ab.name:null;const Oa=ab.split("-");Ja.market=Oa[Oa.length-1];Ja.uiLanguage=ab;Ja.sessionId=da.AFrameworkApplication.userSessionId;Ja.tenantRoot=ia.Ha("748");Ja.shredderServiceEndpoint=ia.Ha("749");this.mkf=pa.call(Fa,wa,Ea,ta,Ja,this.Amk,Object(J.a)(this,this.Zcg,"getShredderServiceAuthTokenPromise"))}gOj(wa){this.hIg=
wa;(this.VXa.W0j=wa)?(this.ia.processAction(n.a.r6b,2),this.Ikh()):this.ia.Ja(n.a.$oa,2,new N.a(!0,ca.a.vie))}tMk(wa,Fa){const pa=[];pa.push(Object.assign(new M,{providerId:Q.a.iGh,groupTypeId:Q.a.hGh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Fa}));try{this.bAb.pushProviderResult(Object.assign(new C,{providerId:Q.a.iGh,resultStatus:wa,entityGroups:pa}))}catch(Ea){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Ea)}"Success"===wa&&(B.a.Xa(Fa.suggestions)||this.qBe.byd(0))}TMk(wa,Fa){const pa=[];pa.push(Object.assign(new M,{providerId:Q.a.sGh,groupTypeId:Q.a.rGh,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Fa}));try{this.bAb.pushProviderResult(Object.assign(new C,{providerId:Q.a.sGh,resultStatus:wa,entityGroups:pa}))}catch(Ea){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Ea)}}pbh(wa){try{this.bAb.trackIdeasProviderAction(wa.cardId,
wa.actionType,wa.actionEngagement)}catch(Fa){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",Fa)}}uMk(wa){if(this.lpk)if(wa)if(wa){try{const Fa=F.a(wa.Content);this.ori(this.NDe,Fa)&&(this.NDe=Fa,this.kHe=!0)}catch(Fa){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.hIg&&this.Ikh()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}ori(wa,
Fa){if(!wa&&Fa||wa&&!Fa)return!0;if(!wa&&!Fa)return!1;if(!wa.drawingElems&&Fa.drawingElems||wa.drawingElems&&!Fa.drawingElems)return!0;const pa=new D.a;for(const Ea of wa.drawingElems)if(wa=Ea.text)for(const ta of wa.paragraphs)ta&&(w.a.Xa(ta.id)||w.a.Xa(ta.chars)||pa.$(ta.id,ta.chars));for(const Ea of Fa.drawingElems)if(Fa=Ea.text)for(const ta of Fa.paragraphs)if(ta&&!(w.a.Xa(ta.id)||w.a.Xa(ta.chars)||pa.Gb(ta.id)&&pa.ga(ta.id)===ta.chars))return!0;return!1}Ikh(){if(this.kHe){try{this.bAb.postMessage(Object.assign(new H,
{messageType:H.PowerPointTextTileChangedMessageType,data:this.NDe}))}catch(wa){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",wa)}this.qBe.byd(1);this.kHe=!1}}sNe(wa,Fa){try{wa=[],wa.push(Object.assign(new M,{groupTypeId:Q.a.RXf,providerId:Q.a.YXf,notificationConfidence:Fa.rla?Fa.rla.notificationConfidence:0,shouldRaiseNotification:Fa.rla?Fa.rla.shouldRaiseNotification:!1,confidence:Fa.rla?Fa.rla.confidence:0,data:Fa.A5b})),this.bAb.pushProviderResult(Object.assign(new C,
{providerId:Q.a.YXf,resultStatus:Fa.rla?Fa.rla.resultStatus:O.a.invalid,entityGroups:wa}))}catch(pa){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",pa)}Fa.rla&&"Success"===Fa.rla.resultStatus&&Fa.A5b&&!B.a.Xa(Fa.A5b.critiques)&&this.qBe.byd(2)}Zcg(){if(!this.qve)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.pHb&&0<this.pHb.length)return this.qve.Kcj(new Ma(this.pHb,"user_impersonation",!0,
{}),this.yIg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(wa){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",wa),null}}Yjj(){return new Promise(wa=>{const Fa=this.hHb.Ha("749"),pa=this.Zcg();Fa&&Fa.length&&pa?pa.then(Ea=>{Ea&&Ea.length?(Ea=new aa,Ea.CountryCode="US",Ea.IsEnabled=!1,Ea.IsEnterpriseEnabled=!0,Ea.IsGoLocal=!1,Ea.ServiceEndpoint=Fa,Ea.TenantRoot="",wa(Ea)):wa(null)},()=>{wa(null)}):
wa(null)})}}Object(K.a)(Ga,"PPTWebEditorInfraredRuntimeManager",null,[1155]);class na{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Xb(wa){this.K=wa;this.K.register(t,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").na().oa(()=>new t);this.K.register(x,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").na().oa(()=>new x);this.K.register(z,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").na().oa(()=>
new z(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(Ga,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").na().oa(()=>new Ga(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ia("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const wa=this.K.resolve("Common.IAppSettingsManager");wa.$e(()=>{wa.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Ac(new na)}}Object(K.a)(na,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");na.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.infrared.js.map