/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1034:function(K,S,d){d.r(S);K=d(0);var h=d(78),e=d(47),r=d(94),m=d(67),n=d(27),z=d(1252),t=d(7),x=d(18),B=d(87),D=d(313),w=d(28),J=d(33);class F{constructor(Sa){this.ApiType=0;this.ApiType=Sa}}Object(K.a)(F,"SlideshowApiMessage",null,[]);class L extends F{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(K.a)(L,"DockSlideshowViewMessage",F,[]);class M extends F{constructor(){super(6);
this.AnimStep=this.SlideIndex=0}}Object(K.a)(M,"GoToSlideApiMessage",F,[]);class Q extends F{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(K.a)(Q,"GoToSlideWithTimeLinesApiMessage",F,[]);class C extends F{constructor(){super(19);this.Color=this.Item=null}}Object(K.a)(C,"InkManagerMessage",F,[]);class O{constructor(Sa){this.LH=Sa.origin;this.r1g=Sa.source;this.Pva=Sa.data}}Object(K.a)(O,"MessageEvent",null,[]);var U=d(958),T=d(956),ca=d(959),N=d(960);class da extends Sys.EventArgs{constructor(Sa){super();
this.Rcc=Sa.IsStartTranscription;this.gw=Sa.SubtitlesPosition}}Object(K.a)(da,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class Y extends Sys.EventArgs{constructor(Sa){super();this.Yx=Sa.SessionTelemetry}}Object(K.a)(Y,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var fa=d(963),aa=d(964),ka=d(961);class H extends Sys.EventArgs{constructor(Sa,xb){super();this.yWj=Sa;this.category=xb.Category;this.code=xb.Code;this.message=xb.Message;this.ry=xb.ExtraInfo;this.correlationId=
xb.CorrelationId;this.sessionId=xb.SessionId}}Object(K.a)(H,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var ra=d(957);class ha extends Sys.EventArgs{constructor(Sa){super();this.isFinal=Sa.IsFinal;this.ZLh=Sa.Transcripts}}Object(K.a)(ha,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ma=d(965),Ga=d(962);class na extends Sys.EventArgs{constructor(Sa){super();this.errorName=Sa.ErrorName;this.vetoName=Sa.VetoName;this.isIntentional=Sa.IsIntentional;this.isInternal=Sa.IsInternal;this.alertOnPillar=
Sa.AlertOnPillar;this.isSessionEndingError=Sa.IsSessionEndingError;this.durationMs=Sa.DurationMs}}Object(K.a)(na,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class wa extends F{constructor(){super(11);this.StartSlideShowTime=0}}Object(K.a)(wa,"RecordStartedSlideShowTimestampApiMessage",F,[]);class Fa extends F{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(K.a)(Fa,"RefreshPodSessionApiMessage",F,[]);class pa extends F{constructor(){super(21);this.IsMute=!1}}Object(K.a)(pa,"SetMicrophoneStateMessage",
F,[]);class Ea extends F{constructor(){super(12);this.OsfLocalStorageData=null}}Object(K.a)(Ea,"SetOsfLocalStorageApiMessage",F,[]);class ta{constructor(){this.Rcc=this.Erg=!1;this.gw=null}}Object(K.a)(ta,"SlideShowViewDockingState",null,[]);var ia=d(1037);class Ja extends F{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=
null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(K.a)(Ja,"StartSlideShowApiMessage",F,[]);class ab extends F{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(K.a)(ab,"ToggleTranscriberLiveBroadcastModeMessage",
F,[]);class Oa extends F{constructor(){super(18);this.HideUI=!1}}Object(K.a)(Oa,"ToggleTranscriberUIVisibilityMessage",F,[]);class Za extends F{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(K.a)(Za,"TranscribeApiMessage",F,[]);var Na=d(70);d.d(S,"SlideshowFrame",function(){return sa});class sa{constructor(Sa,xb,gc,zc,Xb,jb,zb,Tb){this.kb=this.DYa=this.CYa=
this.$va=null;this.va=new h.a;this.qHa=null;this.THe=this.v1g=!1;this.tf=xb;this.la=gc;this.Jc=zc;this.Vb=Xb;this.EO=jb;this.Xl=zb;this.$Db=Tb;this.Lok=new z.a(Object(t.a)(Sa,Sa.Wti,"browserSupportsRenderingSVGInWebGL"))}init(Sa,xb,gc){if(!this.kb){this.$va=document.getElementById("HiddenFocusTrapAnchor");this.kb=document.createElement("iframe");this.kb.id="SlideShowHostFrame";this.kb.className="SlideShowHostFrame";this.kb.style.display=Na.a.Qe;this.kb.setAttribute("allow","microphone; autoplay");
this.qHa=new ta;gc=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Ne(ResourceStrings.l_EndOfSlideShowMessage),e.a.Ne(gc),e.a.Ne(xb)):"";gc+=String.format(gc?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Ne(this.la.hostSupportsSessionRefreshEnabled.toString()));gc+=String.format(gc?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.Ne(this.la.isInkingInSlideShowEnabled.toString()));gc+=String.format(gc?
"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Ne(this.la.c$j.toString()));gc+=String.format(gc?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Ne(this.la.rcb.toString()));gc+=String.format(gc?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Ne(this.la.mCb.toString()));gc+=String.format(gc?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Ne(this.la.h1c.toString()));gc+=String.format(gc?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",
e.a.Ne(this.la.Wbc.toString()));gc+=String.format("&ImageCachingEnabled={0}",e.a.Ne(this.la.pDl.toString()));gc+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Ne(this.la.pTk.toString()));gc+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Ne(this.la.podsLoadSlideShowFrameFromCdn.toString()));gc+=String.format("&PodsBase={0}",e.a.Ne(this.la.podsWebServiceBase));var zc=this.la.Haa;this.la.mWa&&(zc=new D.a(zc),zc.Txc=this.la.mWa,zc.auc=this.la.MBh,zc.$tc=this.la.LBh,zc=zc.toString());
var Xb=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Xa(this.la.podsBaseSlideShowFramePath);this.kb.src=Xb?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.kb.src=String.format(this.kb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Sa,e.a.Ne(xb),e.a.Ne(this.la.pptEditorSlideShowWrsEndpoint),B.a.Foc,zc);w.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",Xb,this.la.Vla));if(this.la.Vla||this.la.ddc)this.kb.src=String.format(this.kb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",
e.a.Ne(this.la.pptEditorTranscriberJsUri),e.a.Ne(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Ne(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Ne(this.la.pptEditorSpeechHandlerBaseUri)),this.kb.src=String.format(this.kb.src+"&SpeechResponseMessageJS={0}",e.a.Ne(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.ug(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.kb.src=String.format(this.kb.src+"&QualityStatusMessageJS={0}",
e.a.Ne(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.ddc&&e.a.ug(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.kb.src=String.format(this.kb.src+"&RehearsalResultMessageJS={0}",e.a.Ne(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.ug(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.kb.src=String.format(this.kb.src+"&AgentCommandMessageJS={0}",
e.a.Ne(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.kb.src+="&wdLiveBroadcast=true");this.kb.src=String.format(this.kb.src+"#{0}",gc);J.a("PresenterCoachTabFix")&&this.$va?this.tf.insertBefore(this.kb,this.$va):this.tf.appendChild(this.kb);r.a.addHandler(window,m.a.message,Object(t.a)(this,this.wMk,"onSlideshowMessage"));this.Jc.hxb&&this.la.jnd&&this.ndk();J.a("PresenterCoachTabFix")&&(this.CYa=document.getElementById("legacySlideshowBeginningFocusTrap"),
this.DYa=document.getElementById("legacySlideshowEndFocusTrap"),this.CYa||this.DYa||(this.CYa=document.createElement("div"),this.CYa.id="legacySlideshowBeginningFocusTrap",this.CYa.className="FocusTrap",this.CYa.tabIndex=0,r.a.addHandler(this.CYa,m.a.focus,Object(t.a)(this,this.Qnc,"onSlideShowContainerDivFocusHandler")),this.DYa=document.createElement("div"),this.DYa.id="legacySlideshowEndFocusTrap",this.DYa.className="FocusTrap",this.DYa.tabIndex=0,r.a.addHandler(this.DYa,m.a.focus,Object(t.a)(this,
this.Qnc,"onSlideShowContainerDivFocusHandler")),this.tf.insertBefore(this.CYa,this.tf.firstChild),this.tf.insertBefore(this.DYa,this.$va.nextSibling)))}}h$a(){return this.la.jnd&&this.THe}CMk(){w.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.v1g=!0;return null}ndk(){const Sa=new x.a;Sa.add(this.$Db.loadScript("PPTSpeechClient"));Promise.all(Sa.toArray()).then(()=>this.CMk()).catch(xb=>{w.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",
xb)})}cwd(Sa,xb,gc,zc,Xb,jb,zb,Tb,Ya){this.qHa=new ta;zb&&w.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",Tb));this.uG(Object.assign(new Ja,{WacCluster:gc,PodSessionId:zc,UserId:Xb,WacUserSessionId:jb,SlideId:Sa,SlideIndex:xb,FPrerenderSS:zb,PrerenderCid:Tb,SlideShowClickTime:Ya,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.Lok.value?"1":"0",RenderShapeBuilder:this.la.mWa?"1":"0",FileHost:n.AFrameworkApplication.fa.Ha("FileHost"),
VetoAppSettingsStr:this.zAj(),DisabledTransitionsList:this.la.ZMa,CustomTransitionResourceUrl:this.la.dTf,StreamVideoUseThinEmbed:n.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:n.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:n.AFrameworkApplication.Tca,AllowExternalMarketplace:n.AFrameworkApplication.fa.ka("51")}))}prev(){this.uG(new F(2))}next(){this.uG(new F(1))}transcribe(Sa,xb,gc,zc,Xb,jb,zb){var Tb=!!this.Vb&&!!this.Vb.instance&&
(this.Vb.instance.oTa||this.Vb.instance.lr);(this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&this.Vb.instance.mEa||Tb)&&!this.Vb.instance.lxb()?w.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.h$a()?(ia.a.instance.transcribe(Sa,xb,gc,zc,Xb,jb,zb),this.mRc(this.Jc.Rh&&5!==Xb,this.Jc.gw)):(Tb={},Tb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",Tb.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.la.powerPointLiveBroadcastEnabled?
!0:!1,this.uG(Object.assign(new Za,{SubtitlesAppSettingsStr:this.txj(Sa,gc,xb,zc,Xb,jb),SubtitlesContextStr:this.Jc.dHl,SubtitlesResourceStr:this.uxj(),RehearsalContextStr:zb?zb.w9k:"",LiveBroadcastContextStr:JSON.stringify(Tb),MicrophoneDeviceId:this.EO.microphoneDeviceId})))}setMicrophoneState(Sa){this.h$a()?ia.a.instance.setMicrophoneState(Sa):(this.uG(Object.assign(new pa,{IsMute:Sa})),this.Vb&&this.Vb.instance&&(Sa?this.Vb.instance.Jzh():this.Vb.instance.Kzh()))}Iyh(){}zPh(){}GQb(Sa,xb=""){this.qHa.Erg=
Sa;w.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.h$a()?(ia.a.instance.FLh(Sa,xb),this.mRc(this.Jc.Rh,this.Jc.gw)):this.uG(Object.assign(new ab,{IsToggleOn:Sa,PragueSessionInfo:xb}));this.mah()}toggleTranscriberUIVisibility(Sa){w.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.h$a()?(Sa=Sa?Sa?!1:!0:!ia.a.instance.isVisible(),ia.a.instance.setVisibility(Sa),ia.a.instance.pKc(),this.mRc(this.Jc.Rh,this.Jc.gw)):this.uG(Object.assign(new Oa,
{HideUI:Sa}))}mRc(Sa,xb){this.qHa.Rcc=Sa;this.qHa.gw=xb;this.mah()}setOsfLocalStorage(){const Sa={};let xb=!1;try{const gc=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let zc=0;zc<localStorage.length;++zc){const Xb=localStorage.key(zc);if(gc.test(Xb)){const jb=localStorage.getItem(Xb);Sa[Xb]=jb;xb=!0}}}catch(gc){w.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",gc.toString())}xb&&this.uG(Object.assign(new Ea,{OsfLocalStorageData:Sa}))}show(){w.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.kb){this.kb.style.display=Na.a.Tj;var Sa=(new Date).getTime();w.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Sa);this.uG(Object.assign(new wa,{StartSlideShowTime:Sa}))}else w.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}qWa(){return this.kb&&this.kb.style.display!==Na.a.Qe?!0:!1}n9(){return"Legacy"}Jwc(Sa){this.kb.style.display=Sa?Na.a.Tj:
Na.a.Qe;this.h$a()&&ia.a.instance.setVisibility(Sa&&this.Jc.Rh)}FUc(){w.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.uG(new F(3))}exit(){this.kb.style.display===Na.a.Qe?this.va.raiseEvent("OnExit",new T.a({SlideId:0,IsBeforeReady:!0})):(w.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.kb.style.display=Na.a.Qe,this.uG(new F(3)));this.h$a()&&ia.a.instance.K5e()}restoreFocus(){this.kb.style.display===Na.a.Qe||this.Ioe()||(this.kb.focus(),this.uG(new F(4)))}pausePresentation(){this.uG(new F(15))}z8e(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.uG(new F(5))}getCurrentPositionWithTimeLines(){this.uG(new F(17))}getCurrentSlideDimensions(){this.uG(new F(20))}HUa(Sa){this.uG(Object.assign(new M,{SlideIndex:Sa,AnimStep:0}))}lRe(Sa){this.uG(Object.assign(new C,{Item:Sa.item,Color:Sa.color}))}T_e(Sa){this.va.raiseEvent("OnSpecialKey",new ra.a({["Key"]:Sa.keyCode,["ShiftKey"]:Sa.shiftKey}))}Zxh(){this.uG(new F(22))}Ufg(Sa,xb){this.uG(Object.assign(new Q,{SlideIndex:Sa,TimeLineMappings:xb}))}refreshPodSession(Sa,
xb){this.uG(Object.assign(new Fa,{PodSessionId:Sa,WacCluster:xb}))}setVisibility(Sa){this.kb.style.visibility=Sa?Na.a.Tz:Na.a.ft}Tga(Sa){this.uG(new F(Sa?9:10));this.h$a()&&ia.a.instance.Tga(Sa)}UJc(Sa){this.va.addHandler("OnSlideshowReady",Sa)}lqd(Sa){this.va.removeHandler("OnSlideshowReady",Sa)}tUd(Sa){this.va.addHandler("OnBrowserEvent",Sa)}gXe(Sa){this.va.removeHandler("OnBrowserEvent",Sa)}aBf(Sa){this.va.addHandler("OnFullscreenClick",Sa)}nrh(Sa){this.va.removeHandler("OnFullscreenClick",Sa)}vUd(Sa){this.va.addHandler("OnSlideshowContextMenu",
Sa)}iXe(Sa){this.va.removeHandler("OnSlideshowContextMenu",Sa)}AUd(Sa){this.va.addHandler("OnPodSessionExpired",Sa)}mXe(Sa){this.va.removeHandler("OnPodSessionExpired",Sa)}RQa(Sa){this.va.addHandler("OnPositionChangeEventId",Sa)}okb(Sa){this.va.removeHandler("OnPositionChangeEventId",Sa)}jja(Sa){this.va.addHandler("OnExit",Sa)}Bga(Sa){this.va.removeHandler("OnExit",Sa)}YAf(Sa){this.va.addHandler("OnSlideshowError",Sa)}krh(Sa){this.va.removeHandler("OnSlideshowError",Sa)}Y_b(Sa){this.va.addHandler("OnGetCurrentPosition",
Sa)}nkb(Sa){this.va.removeHandler("OnGetCurrentPosition",Sa)}QJc(Sa){this.va.addHandler("OnGetCurrentSlideDimensions",Sa)}jqd(Sa){this.va.removeHandler("OnGetCurrentSlideDimensions",Sa)}VJc(Sa){this.va.addHandler("OnSpecialKey",Sa)}mqd(Sa){this.va.removeHandler("OnSpecialKey",Sa)}oBf(Sa){this.va.addHandler("OnVisibilityChangeEventId",Sa)}qXe(Sa){this.va.removeHandler("OnVisibilityChangeEventId",Sa)}dBf(Sa){this.va.addHandler("OnLogEndOfTranscriptionSession",Sa)}prh(Sa){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Sa)}cBf(Sa){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Sa)}orh(Sa){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Sa)}xUd(Sa){this.va.addHandler("OnEnterEndOfShowEventId",Sa)}jXe(Sa){this.va.removeHandler("OnEnterEndOfShowEventId",Sa)}zUd(Sa){this.va.addHandler("OnLeaveEndOfShowEventId",Sa)}lXe(Sa){this.va.removeHandler("OnLeaveEndOfShowEventId",Sa)}lBf(Sa){this.va.addHandler("OnSubtitleUpdatedEventId",Sa)}yrh(Sa){this.va.removeHandler("OnSubtitleUpdatedEventId",Sa)}mBf(Sa){this.va.addHandler("OnTranscriberStartedEventId",
Sa)}Arh(Sa){this.va.removeHandler("OnTranscriberStartedEventId",Sa)}vBf(Sa){this.va.addHandler("RecordQosErrorEventId",Sa)}Hrh(Sa){this.va.removeHandler("RecordQosErrorEventId",Sa)}wMk(Sa){Sa=new O(Sa.rawEvent);if(this.R9j(Sa)){var xb=this.mhl(Sa.Pva),gc=xb.EventType;28===gc&&w.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Sa.Pva);switch(gc){case 23:this.Ejd(xb);break;case 18:this.oib(xb);break;case 6:this.yKk();break;case 11:this.Xdh(!1,xb);break;case 13:this.Xdh(!0,
xb);break;case 2:this.gga(xb);break;case 7:this.Gxa(xb);break;case 12:this.Qxa(xb);break;case 24:this.vMk(xb);break;case 26:this.E_a(xb);break;case 27:this.Ckd(xb);break;case 29:this.dkd(xb);break;case 5:this.Ekd(xb);break;case 30:this.HMk(xb);break;case 32:this.lld(xb);break;case 31:this.ckd(xb);break;case 19:this.Bjd(xb);break;case 20:this.$jd(xb);break;case 33:this.ypd(xb)}}}R9j(Sa){try{if(Sa.r1g!==this.kb.contentWindow)return w.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Sa.r1g.location.href),!1}catch(xb){return w.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",xb.toString()),!1}return!0}mhl(Sa){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Sa)}catch(xb){let gc=xb.toString();J.a("DisableLogPostMsgData")&&(Sa="<redacted>");J.a("DisableLogPostMsgEx")&&(gc="<redacted>");w.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Sa,gc)}return{}}yKk(){if(this.la.jnd&&this.v1g&&!this.THe)try{const Sa=(new Date).getTime();ia.a.instance.init(this.la,this.kb.contentDocument.body,this.Jc,this,this.Xl,this.Vb,this.EO);this.THe=!0;w.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Sa)}catch(Sa){w.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Sa.toString())}w.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}oib(Sa){this.va.raiseEvent("OnBrowserEvent",new U.a(Sa))}Ejd(Sa){w.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");w.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.kb.style.display=Na.a.Qe;this.va.raiseEvent("OnExit",new T.a(Sa))}gga(Sa){w.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new ca.a(Sa))}Gxa(Sa){w.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new N.a(Sa))}Xdh(Sa,xb){this.va.raiseEvent("OnSlideshowError",new H(Sa,xb))}Qxa(Sa){Sa=new ra.a(Sa);w.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Sa.key);this.va.raiseEvent("OnSpecialKey",Sa)}vMk(Sa){w.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new ka.a(Sa))}E_a(Sa){w.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new Ga.a(Sa))}Ckd(Sa){w.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new fa.a(Sa))}dkd(Sa){w.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new Y(Sa));this.Jc.nxb=!1}Ekd(Sa){w.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new aa.a(Sa))}HMk(Sa){w.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new ha(Sa))}lld(Sa){w.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new Ma.a(Sa));this.Jc.nxb=!0}Qnc(){this.restoreFocus()}ckd(Sa){w.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const xb=new da(Sa);this.mRc(xb.Rcc,xb.gw);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",xb)}catch(xb){w.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
xb.toString())}}Bjd(){w.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}$jd(){w.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}ypd(Sa){w.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new na(Sa))}uG(Sa){this.kb&&this.kb.contentWindow&&this.kb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Sa),
"*")}mah(){var Sa=0,xb=100;this.qHa.Rcc&&("BelowSlide"===this.qHa.gw?(Sa=0,xb=85):"AboveSlide"===this.qHa.gw&&(Sa=15,xb=85));Sa=Sa.toString()+"%";xb=xb.toString()+"%";this.qHa.Erg&&(Sa=String.format("calc({0} + {1})",Sa,"26px"),xb=String.format("calc({0} - {1})",xb,"26px"));this.uG(Object.assign(new L,{TopValue:Sa,HeightValue:xb}))}zAj(){const Sa={};Sa.AnimTranstionMinDurationMs=n.AFrameworkApplication.fa.uc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Sa.AnimTranstionWorstFrameIndex=n.AFrameworkApplication.fa.uc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Sa.AnimTranstionMaxFrameDurationMs=n.AFrameworkApplication.fa.uc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Sa.AnimTranstionMinFPS=n.AFrameworkApplication.fa.uc("PodSlideShowVetoAnimTranstionMinFPS",24);Sa.NavDurationMs=n.AFrameworkApplication.fa.uc("PodSlideShowVetoNavDurationMs",1250);Sa.SlideShowEUPLThresholdInMs=n.AFrameworkApplication.fa.uc("SlideShowEUPLThresholdInMs",6E3);Sa.SlideShowNavigationThresholdInMs=n.AFrameworkApplication.fa.uc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Sa)}txj(Sa,xb,gc,zc,Xb,jb){const zb=this.la.IVk&&e.a.ug(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),Tb={};Tb.WacUserSessionId=Sa;Tb.WacUserDatacenterCluster=xb;Tb.PodSessionId=gc;Tb.DocId=zc;Tb.EntryPoint=Xb;Tb.StartTime=jb;Tb.PodsWebServiceBase=this.la.podsWebServiceBase;Tb.TranscriberLoggingIntervalInMS=this.la.xMl;Tb.TranscribeRealTimeFactorLowerThreshold=this.la.tMl;Tb.TranscribeRealTimeFactorUpperThreshold=this.la.uMl;Tb.IsTranscriberLogEachTranscriptMessage=
this.la.Z8j;Tb.IsTranscriberContentLoggingEnabled=this.la.W8j;Tb.FUseEndpointInWebapp=this.la.b9j;Tb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;Tb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;Tb.HeartbeatInterval=5E3;Tb.RoundtripLatencyThreshold=1E6;Tb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;Tb.FragmentLatencyWarnThreshold=1E6;Tb.FragmentLatencyErrorThreshold=1E6;Tb.MessageType=this.la.pptEditorTransciberMessageType;
Tb.MaxAllowedFragmentLatencyMS=this.la.sTk;Tb.DynamicBufferEnabled=this.la.X8j;Tb.DefaultBufferSize=this.la.wMl;Tb.MaxAllowedFinalFragmentLatencyMS=this.la.rTk;Tb.FSupportSpeechResponseMessage=zb;Tb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&zb&&e.a.ug(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");Tb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;Tb.TranscriberShowListeningDetectionTextInMS=this.la.HVk;
Tb.PodTranscriberAudioContextSampleRate=this.la.qTk;Tb.RehearsalGrammarIsEnabled=this.la.CRe;Tb.PodRehearsalMonotoneEnabled=this.la.QQe;return JSON.stringify(Tb)}uxj(){const Sa={};Sa.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Sa.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Sa.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Sa.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Sa.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Sa.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Sa.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Sa.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Sa.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Sa.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Sa.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Sa.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Sa.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Sa.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Sa.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Sa.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Sa.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Sa.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Sa.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Sa.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Sa.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Sa.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Sa.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Sa.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Sa.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Sa.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Sa)}Ioe(){return!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.D0f}}Object(K.a)(sa,"SlideshowFrame",null,[403])},1035:function(K,S,d){K=d(0);var h=d(395),e=d(990),r=d(146),m=d(175),n=d(27),z=d(7),t=d(18),x=d(699);class B{constructor(Ka){this.Frb=Ka}next(Ka){this.Frb=(9301*this.Frb+49297)%233280;return Math.floor(this.Frb/233280*Ka)}}Object(K.a)(B,
"Random",null,[]);var D=d(210);class w extends D.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(K.a)(w,"CuiButtonPropsExtended",D.a,[]);var J=d(949),F=d(593),L=d(1170),M=d(1163),Q=d(595);class C{constructor(){this.text=this.href=null}}Object(K.a)(C,"LinkProps",null,[]);class O{constructor(){this.icon=this.text=this.href=null}}Object(K.a)(O,"LinkWithLabelProps",null,[]);var U=d(319),T=d(275),ca=d(950),N=d(144),da=d(47);class Y{constructor(Ka,Db,bc,Mc,mb,Wa=null,db=null){this.vGd=
{};this.jof={};this.VBc={};this.Rif=0;this.Srf=!1;this.BSb=0;this.rjf=!1;this.sOa=this.yWb=0;this.B3a=Db;this.UG=null;this.i4h=bc;this.k4h=Mc;this.s9h=mb;this.Rcf=db;this.Ma=Wa||n.AFrameworkApplication.fa;this.B3a.nWe(Object(z.a)(this,this.o_a,"onAddinDetailsRefreshed"));appChrome.addInApi.loadOfficeAddInIcons()}get qPf(){return this.VBc}j8k(Ka){if(Ka.tW)for(let Db=0;Db<Ka.tW.length;Db++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+Ka.tW[Db].solutionId,Ka.tW[Db].iconUrl);else 0===Ka.errorCode&&
h.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get rBb(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get Npe(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewDownloadV2Enabled",!1)}get Q2c(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",
!1)}get K3c(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScrollableFlyoutEnable",!1)}get u6j(){return!!this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScrollableFlyout10ItemsEnable",!1)}Mwl(Ka){0===Ka.p_&&(this.BSb|=1);1===Ka.p_&&(this.BSb|=2);return!!this.BSb}o_a(Ka,Db){this.j8k(Db);this.Rcf&&this.Rcf.o_a(Ka,Db);this.Mwl(Db)&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutOverflowTelemetryEnabled",!1)&&this.ngk()}gLf(){let Ka=
this.B3a.H$a(0);if(1!==Ka.errorCode)return!0;Ka=this.B3a.H$a(1);return 1!==Ka.errorCode}USk(Ka){const Db=[];var bc=new B((new Date).getDate());for(var Mc=0;8>Mc;Mc++)Array.add(Db,bc.next(Ka.count));bc=0;for(let mb of Ka){Mc=!1;for(const Wa of Db)if(bc===Wa){Mc=!0;break}bc++;if(Mc){let Wa;(Wa=mb.addinInfo).AUP=20*Wa.AUP}else if(1===mb.addinInfo.priority){let Wa;(Wa=mb.addinInfo).AUP=4*Wa.AUP}else if(2===mb.addinInfo.priority){let Wa;(Wa=mb.addinInfo).AUP=2*Wa.AUP}}Ka.Sc((mb,Wa)=>mb.addinInfo.AUP<Wa.addinInfo.AUP?
1:-1);return Ka}VSk(Ka){for(let Db of Ka)if(1===Db.addinInfo.priority){let bc;(bc=Db.addinInfo).AUP=4*bc.AUP}else if(2===Db.addinInfo.priority){let bc;(bc=Db.addinInfo).AUP=2*bc.AUP}Ka.Sc((Db,bc)=>Db.addinInfo.AUP<bc.addinInfo.AUP?1:-1);return Ka}C2d(Ka,Db){const bc={};bc.width=Ka;bc.height=Db;bc.backgroundColor="transparent";return bc}h2d(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",
"white-space":"normal","word-break":"break-word","text-overflow":"ellipsis"}}uWc(){const Ka={},Db={},bc={};Db.root={marginTop:"12px",marginLeft:"16px",marginRight:"16px",marginBottom:"20px",width:"100%",padding:0};Db.inner={margin:"-4px"};bc.root=this.C2d(100,100);bc.flexContainer={flexDirection:"column"};bc.label=this.rBb?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.h2d();Ka.galleryButtonInExpanded=bc;Ka.galleryStack=Db;return Ka}ocj(){return Object.assign(new M.a,
{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",Icon:"AllApps_16",Command:this.s9h,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid #E0E0E0","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}Rxb(Ka,Db,bc){const Mc={},mb={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",
padding:"7px",border:"1px solid #E0E0E0"};n.AFrameworkApplication.isRtl&&(mb.direction="ltr");Mc.root=mb;return Object.assign(new M.a,{Id:bc,ExternalId:bc,Icon:"AddinFlyoutControl"+Db.solutionId,Command:Ka===CommonUIStrings.l_PopularAddins?this.i4h:this.k4h,LabelText:Db.displayName,FullIconStyle:Mc,Alt:Db.description})}dUk(Ka,Db,bc){const Mc=Object.assign(new L.a,{SectionId:Ka,Title:Ka,GalleryButtons:[]});for(let mb=0;mb<bc;mb++)Array.add(Mc.GalleryButtons,this.Rxb(Ka,Db[mb],this.vGd[Db[mb].solutionId]));
return Mc}B8b(){var Ka=[];const Db=this.B3a.H$a(0);Array.addRange(Ka,Db.tW);const bc=this.B3a.H$a(1);Array.addRange(Ka,bc.tW);let Mc=Ka.length;this.sOa=0<Mc?5:6;n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&h.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",Mc,x.a[Db.errorCode],Db.tW.length,x.a[bc.errorCode],bc.tW.length);Ka.sort((uc,Yb)=>{uc=N.d(uc.displayName);Yb=N.d(Yb.displayName);
return da.a.localeCompare(uc,Yb)});var mb=this.K3c?3:6;const Wa=Mc>mb;Wa&&(Mc=mb-1);for(mb=0;mb<Mc;mb++)this.mHf(Ka[mb]);let db=[];mb=null;this.UG?db=this.UG:(mb=this.B3a.H$a(2),0===mb.errorCode&&mb.tW.forEach(uc=>{-1!==uc.addinInfo.priority&&(this.mHf(uc),db.push(uc))}));mb=!0;db.length||(mb=!1);let ub=0;if(mb&&(ub=Ka.length?3>=Ka.length?9:6:12,db=this.rBb?this.lpi(db,Ka):this.kpi(db,Ka),ub>db.length&&(ub=db.length),this.K3c&&(this.sOa=this.u6j?10:db.length),n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",
!0)&&!this.Srf&&!this.rBb)){var Lb="",Kb="";for(let uc=0;uc<db.length&&uc<ub;uc++)Lb+=db[uc].displayName,Lb+=",",Kb+=db[uc].solutionId,Kb+=",";h.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",ub,Lb,Kb);this.Srf=!0}Lb=Object.assign(new T.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Kb=Object.assign(new D.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});
Array.add(Lb.ControlList,Kb);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));Lb=Object.assign(new U.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:Lb,UpdateDynamically:!0,IsFlexLayout:this.K3c});2!==Db.errorCode||Ka.length?3===Db.errorCode&&3===bc.errorCode?(h.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),Ka=this.g5f("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(Lb.MenuSectionList,
Ka)):(0<Mc?this.jQf(Lb,Ka,Mc,"MRUAddins",CommonUIStrings.l_MyAddinSection,Wa):this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(Ka=this.Bbj(),Array.add(Lb.MenuSectionList,Ka),h.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),mb&&(this.rBb?(Array.add(Lb.MenuSectionList,this.kcj(db,this.sOa)),Ka=[],this.wQh(Ka),appChrome.api.dispatch(Ka),this.yWb=this.UG.length<this.sOa?this.UG.length:this.sOa):this.jQf(Lb,db,ub,"PopularAddins",CommonUIStrings.l_PopularAddins))):
(h.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),Ka=this.g5f("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(Lb.MenuSectionList,Ka));return Lb}JHl(){if(!(this.sOa>=this.UG.length)){var Ka=[];for(let Db=0;Db<this.sOa;Db++)this.jof["PopularAddInsListItem"+Db]=this.UG[Db].solutionId,this.ARl(Ka,Db.toString(),this.UG[this.yWb]),this.yWb===this.UG.length-1?this.yWb=0:this.yWb++;this.wQh(Ka);appChrome.api.dispatch(Ka)}}wQh(Ka){6>this.sOa?Ka.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",
!0)):Ka.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}kcj(Ka,Db){const bc=Object.assign(new T.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let Mc=0;Mc<0+Db&&Mc<Ka.length;Mc++)this.jof.PopularAddInsListItem0=Ka[Mc].solutionId,this.tbj(bc.ControlList,Mc.toString(),Ka[Mc]);this.K3c||(Ka=Object.assign(new w,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"RefreshGreen_20",
Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1}),Array.add(bc.ControlList,Ka));return bc}tbj(Ka,Db,bc){Db=this.oRf(Db,bc);Array.add(Ka,Db)}ARl(Ka,Db,bc){bc=this.oRf(Db,bc);const Mc={};Mc.label=bc.Label;Mc.secondaryLabel=bc.SecondaryLabel;Mc.description=bc.Description;Mc.iconSet=bc.iconSet;Mc.links=bc.Links;this.Npe&&(Mc.details=bc.Details);Mc.commandValueId=bc.CommandValueId;Mc.actionCommandValueId=bc.ActionCommandValueId;Ka.push(appChrome.actions.updateMultiActionButton("PopularAddInsListItem"+
Db,Mc))}oRf(Ka,Db){var bc="";if(this.Npe){var Mc=Db.addinInfo.downloadNumber;5E6<=Mc?bc=(5E6).toLocaleString()+"+":1E3<=Mc?(Mc=1E3*Math.round(Mc/1E3),bc=Mc.toLocaleString()+"+"):bc=500<=Mc?(500).toLocaleString()+"+":100<=Mc?(100).toLocaleString()+"+":0<Mc?Mc.toLocaleString():CommonUIStrings.l_AddinDownloadNewText}Mc=[];const mb=[];this.Npe?(bc=Object.assign(new O,{icon:bc===CommonUIStrings.l_AddinDownloadNewText?null:"download",text:bc}),Array.add(mb,bc),bc=Object.assign(new O,{text:this.Ma.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinListStoreLabel",
CommonUIStrings.l_AddinListStore2),href:"https://appsource.microsoft.com/en-us/product/office/"+Db.solutionId}),Array.add(mb,bc)):(bc=Object.assign(new C,{text:CommonUIStrings.l_AddinListPrivacy,href:Db.privacyUrl}),Array.add(Mc,bc),bc=Object.assign(new C,{text:CommonUIStrings.l_AddinListLicense,href:Db.licenseUrl}),Array.add(Mc,bc),bc=Object.assign(new C,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Db.solutionId}),Array.add(Mc,bc));bc={};bc["default"]=
"AddinFlyoutControl"+Db.solutionId;const Wa=this.a5f(Db);return Object.assign(new ca.a,{Id:"PopularAddInsListItem"+Ka,ExternalId:"PopularAddInsListItem"+Ka,CommandId:"PopularAddInsListItem"+Ka,CommandIdMapped:"1497204054",iconSet:bc,SecondaryLabel:null,Details:mb,Label:Db.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:Db.description,Links:Mc,ActionId:"PopularAddInsListItemAdd"+Ka,ActionIdMapped:"2882601901",ActionCommandValueId:Wa,CommandValueId:Wa})}a5f(Ka){return this.Q2c?String.format("{0}#{1}",
Ka.solutionId,Ka.storeId):Ka.solutionId}z$d(Ka){if(!Ka)return null;var Db=Ka.split("#");if(1!==Db.length&&2!==Db.length)return h.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;Ka=Db[0].trim();Db=2===Db.length?Db[1].trim():n.AFrameworkApplication.uiCulture;return this.B3a.v7b(Ka,Db)}mHf(Ka){if(!(Ka.solutionId in this.vGd)){const Db="AddinGalleryButton"+this.Rif.toString();this.vGd[Ka.solutionId]=Db;Ka=this.a5f(Ka);this.VBc[Db]=Ka;this.VBc[Db+"Add"]=Ka;
this.Rif++}}Veg(Ka){return Ka?this.VBc[Ka]:null}Bbj(){const Ka=Object.assign(new T.a,{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),Db=Object.assign(new Q.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",LabelText:this.Ma.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(Ka.ControlList,Db);return Ka}g5f(Ka,Db){const bc=Object.assign(new T.a,{Id:"ErrorSection",
ControlsId:"ErrorSection.Controls",ControlList:[]});Ka=Object.assign(new J.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:Ka,Label:Db,RetryButtonTitle:CommonUIStrings.l_AddinPickerTryAgain,OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===Ka?Db:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(bc.ControlList,Ka);return bc}kpi(Ka,Db){var bc=new t.a;for(let Mc=0;Mc<Ka.length;Mc++)bc.add(Ka[Mc]);this.UG||(8<bc.count&&(bc=this.USk(bc)),this.UG=bc.toArray());for(Ka=
0;Ka<this.UG.length;Ka++)for(bc=0;bc<Db.length;bc++)if(this.UG[Ka].solutionId.toLowerCase()===Db[bc].solutionId.toLowerCase()){Array.remove(this.UG,this.UG[Ka--]);break}return this.UG}lpi(Ka,Db){var bc=new t.a;for(let Mc=0;Mc<Ka.length;Mc++)bc.add(Ka[Mc]);this.UG||(8<bc.count&&(bc=this.VSk(bc)),this.UG=bc.toArray());for(Ka=0;Ka<this.UG.length;Ka++)for(bc=0;bc<Db.length;bc++)if(this.UG[Ka].solutionId.toLowerCase()===Db[bc].solutionId.toLowerCase()){Array.remove(this.UG,this.UG[Ka--]);break}return this.UG}jQf(Ka,
Db,bc,Mc,mb,Wa=!1){const db=Object.assign(new T.a,{Id:Mc+"Section",ControlsId:Mc+"Section.Controls",ControlList:[]});Mc=Object.assign(new F.a,{Id:Mc+"GalleryControl",ExternalId:Mc+"GalleryControl",GalleryStyle:this.uWc(),Width:3,Type:4,GallerySections:[]});Array.add(Ka.MenuSectionList,db);Array.add(db.ControlList,Mc);Ka=this.dUk(mb,Db,bc);Wa&&Array.add(Ka.GalleryButtons,this.ocj());Mc.GallerySections.push(Ka)}Tmd(Ka){if(Ka)try{Ka.MenuItems=this.B8b()}catch(Db){h.ULS.sendTraceTag(509687425,220,10,
"GetReactGalleryMenu hit exception "+(Db?Db.toString():""))}else h.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}ngk(){if(!this.rjf&&this.Fsd){var Ka=appChrome.selectors.getSelectedTabId();Ka&&N.a(Ka,"Home")&&((Ka=document.getElementById("InsertAddInFlyout"))&&"none"!==window.getComputedStyle(Ka,"").display||h.ULS.sendTraceTag(509368032,344,15,"Addin button is in overflow"),this.rjf=!0)}}get Fsd(){return!!window.appChrome&&!!appChrome.selectors}}Object(K.a)(Y,"AppsFlyoutGenerator",
null,[108]);var fa=d(379),aa=d(55),ka=d(227),H=d(1172),ra=d(201),ha=d(177),Ma=d(1253),Ga=d(698),na=d(37),wa=d(42),Fa=d(84),pa=d(39);class Ea{constructor(){this.idField=null;this.stateField=0}}Object(K.a)(Ea,"CT_OsfBackgroundAppData",null,[]);class ta{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=
this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(K.a)(ta,"CT_OsfInsertionInfo",null,[]);var ia=d(52),Ja=d(989),ab=d(991),Oa=d(341),Za=d(33),Na=d(30),sa=d(134),Sa=d(944),xb=d(541);class gc extends xb.a{constructor(Ka){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ka.paragraphs;this.image=Ka.image;this.imageWidth=Ka.imageWidth;this.imageHeight=Ka.imageHeight}}Object(K.a)(gc,"TextAboveImage",xb.a,[]);class zc{constructor(Ka,Db){this.imageHeight=
this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ka;this.image=Db}}Object(K.a)(zc,"TextAboveImageCustomProps",null,[]);var Xb=d(143),jb=d(1154),zb=d(946),Tb=d(945),Ya=d(358),sb=d(82),oc=d(135);class wb{constructor(){this.Iok="ClickOnLaunch";this.okk="ClickOnDismiss";this.ouk="Show";this.Wlk="BetterEntryPoint_InsertTab";this.yvk=500;this.Imk=280;this.Emk=192;this.Umk="InsertAddInFlyout";this.ztk="RibbonOverflowMenu-overflow";this.ytk="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";
this.omk="[data-unique-id=Home]";this.Vmk="InsertAddinTransitionEntry"}BMi(){Object(sa.a)(this,void 0,void 0,function*(){try{let Ka=yield Xb.UISurfaces.KL();wb.IGb&&(Ka.removeNotification(wb.IGb),wb.IGb=null);let Db=this.ytk,bc=document.getElementById(this.Vmk);const Mc=bc?window.getComputedStyle(bc,null):null;if(null==bc||Mc&&"none"===Mc.display)Db=this.omk;const mb=CommonUIStrings.l_BetterEntryPointTUI_Title,Wa=CommonUIStrings.l_BetterEntryPointTUI_Content,db=new Sa.a("https://iriscoremetadataprod.blob.core.windows.net/assets/add-ins_powerpoint_1677568738672.svg"),
ub=new zc(Wa,db),Lb=new gc(ub);Lb.imageWidth=this.Imk;Lb.imageHeight=this.Emk;const Kb=new jb.a;Kb.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;Kb.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText1;Kb.onExecute=()=>{this.uHj();this.Nea(this.Iok)};const uc=new jb.a;uc.label=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;uc.ariaDescription=CommonUIStrings.l_BetterEntryPointTUI_ButtonText2;uc.onExecute=()=>{Ka.removeNotification(wb.IGb);this.Nea(this.okk)};const Yb=new zb.a;
Yb.onDismiss=()=>{Ka.removeNotification(wb.IGb)};Yb.setInitialFocus=!0;const Tc=new Tb.a;Tc.target=Db;Tc.title=mb;Tc.content=Lb;Tc.showCloseIcon=!0;Tc.hasDynamicSizing=!1;Tc.preventLightDismiss=!1;Tc.useTeachingStyles=!0;Tc.primaryButtonProps=Kb;Tc.secondaryButtonProps=uc;Tc.calloutProps=Yb;const sc=Ka.callout(Tc),Qb=new Ya.a;Qb.onShow=()=>{this.Nea(this.ouk)};wb.IGb=Ka.addNotification(sc,Qb);return null}catch(Ka){return h.ULS.sendTraceTag(509207556,220,15,"Failed to GetNotificationsAPIAsync: {0}",
Ka),null}})}uHj(){appChrome.api.dispatch(appChrome.actions.setCurrentTab("Home"));const Ka=new sb.a(0,1,this.yvk,()=>{this.Sak()});oc.a.instance.Hb(Ka)}Sak(){const Ka=document.getElementById(this.Umk),Db=Ka?window.getComputedStyle(Ka,null):null;if(null==Ka||Db&&"none"===Db.display){const bc=document.getElementById(this.ztk);null!=bc?(bc.onclick=function(){const Mc=new sb.a(0,1,500,()=>{const mb=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=mb?(mb.click(),h.ULS.sendTraceTag(509207555,
220,50,"Launch flyout in overflow")):h.ULS.sendTraceTag(509207554,220,10,"Neither ribbon nor overflow can launch flyout")});oc.a.instance.Hb(Mc);bc.onclick=function(){}},bc.click()):h.ULS.sendTraceTag(509207553,220,10,"Neither ribbon nor overflow can launch flyout")}else Ka.click(),h.ULS.sendTraceTag(509207552,220,50,"Launch flyout in ribbon button")}Nea(Ka){Ka={["AppTeachingUICalloutAction"]:Ka,["AppTeachingUICalloutGoal"]:this.Wlk};r.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:m.a.VI(Ka)}))}}wb.IGb=null;Object(K.a)(wb,"PPTBetterEntryTeachingCallout",null,[]);d.d(S,"a",function(){return rc});class rc{constructor(Ka,Db,bc,Mc,mb,Wa,db,ub,Lb,Kb,uc,Yb,Tc){this.YJg=this.nHe=!1;this.fxi=1E3;this.gxi="AddinFlyoutFeedbackSurvey";this.hxi=15E3;this.lHe=!0;this.qDb=0;this.sHg=!1;this.nik="g_InstallOrigin";this.t1g=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],
["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"]]);this.VTg=null;this.AHj=()=>this.AWd&&!this.Ib.ka("AppsForOfficeThirdPartyIsDisabled")&&this.oQ&&this.oQ.gLf()?32:8;this.eHj=(sc,Qb,kb,Ib,eb)=>{if(2!==kb)return this.oQ&&this.oQ.gLf()?32:8;if(!this.oQ)return 8;this.oQ.Tmd(eb);this.nHe&&(this.Irc(),this.Kak());return 32};this.BJj=(sc,Qb,kb)=>{if(2!==kb)return 32;this.eve.JHl();this.Irc();return 32};this.BCj=(sc,Qb)=>{if(2!==sc)return 32;this.Irc();sc=Qb.Href;if(Qb=this.F5f(Qb.CommandValueId))Qb=
{["solutionId"]:rc.r4(Qb.solutionId,Qb.storeType,Qb.assetId,Qb.storeId)},Qb.href=sc,r.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:m.a.VI(Qb)}));return 32};this.TFj=(sc,Qb,kb,Ib,eb)=>{this.Irc();return"LinkClickedPayload"===eb.Type?this.BCj(kb,eb):this.jhg(sc,Qb,kb,Ib,eb)};this.NFj=(sc,Qb,kb,Ib,eb)=>{if(2!==kb)return 32;this.Irc();Qb={};if(eb=this.F5f(eb.CommandValueId))Qb.solutionId=eb.solutionId,Qb.version=eb.version,Qb.storeType=
eb.storeType,Qb.storeId=eb.storeId,Qb.assetId=eb.assetId,Qb.assetStoreId=eb.assetStoreId,Qb.targetType=eb.targetType,Qb.displayName=eb.displayName,Qb.width=eb.width,Qb.height=eb.height,this.Hd.kJb("handleInsertAppForOffice",Qb),this.Bge(sc,Qb),sc={["solutionId"]:rc.r4(eb.solutionId,eb.storeType,eb.assetId,eb.storeId)},r.a.sendTelemetryEvent(Object.assign(new ha.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:m.a.VI(sc)}));else return h.ULS.sendTraceTag(509109065,
344,10,"No add-in details."),8;return 32};this.UFj=(sc,Qb,kb,Ib,eb)=>{var Rb;if(!this.q5||!eb)return 8;if(1===kb)return this.Hd?32:8;if(!this.Hd)return this.qDb||(this.qDb=window.performance.now()),this.kM.Fja(),this.kM.FQa(sc,eb),8;sc=eb[Ga.a.cxb];eb=eb[Ga.a.Mib];Qb=eb.optionalProperties;kb={};kb.cB=Qb.TaskPaneTitle;kb.assetId=sc.getId();kb.n6=Qb.OnRenderedCallback;kb.nonPersistedSettings=eb.qwb;kb.HQc=Qb.DialogIsModal;kb.LQc=Qb.DialogShowTitleBar;kb.dialogWidth=Qb.DialogWidth;kb.dialogHeight=Qb.DialogHeight;
kb.dialogLeft=Qb.DialogLeft;kb.K4b=Qb.DialogRight;kb.dialogTop=Qb.DialogTop;kb.I4b=Qb.DialogBottom;kb.jka=null!==(Rb=Qb.DialogTitle)&&void 0!==Rb?Rb:"";kb.sourceLocationOverrideResourceId=Qb.SourceLocationOverrideResourceId;kb.I4d=Qb.DialogParentId;this.Hd.Ddl(kb);return 32};this.ZIj=(sc,Qb,kb,Ib,eb)=>{if(2!==kb)return 32;if(!this.Hd)return 8;Qb=eb[Ga.a.cxb];kb=eb[Ga.a.Mib].optionalProperties;sc={};sc.cB=kb.TaskPaneTitle;sc.assetId=Qb.getId();sc.sourceLocationOverrideResourceId=kb.SourceLocationOverrideResourceId;
sc.n6=kb.e0l;sc.nonPersistedSettings=kb.qwb;Qb=this.Hd.Qxb(sc);Qb=this.Hd.HQ(Qb);eb=eb[Ga.a.svb];return Qb&&"taskpane"==eb.toLowerCase()?(this.Hd.xpl(Qb.instanceId,sc),32):8};this.ECj=(sc,Qb,kb,Ib,eb)=>{if(2!==kb)return 32;if(eb.SourceControlId)return this.VTg=new wb,this.VTg.BMi(),32;h.ULS.sendTraceTag(509207557,220,10,"Control id is null.")};this.VFj=(sc,Qb,kb,Ib,eb)=>{if(2!==kb)return 32;if(!this.oQ)return 8;kb=Qb=void 0;Ib=eb.SourceControlId;this.oQ.Q2c?(Ib=this.oQ.z$d(this.oQ.Veg(Ib)),null!=
Ib&&(Qb=Ib.solutionId,kb=Ib.storeId)):Qb=this.oQ.qPf[Ib];if(!Qb)return h.ULS.sendTraceTag(509383066,220,10,"SourceControlId (solutionId) is empty in handleLaunchUserInstalledAddIn"),8;this.Hd?this.Hd.Hak(Qb,kb):(this.kM.Fja(),this.kM.FQa(sc,eb));return 32};this.jhg=(sc,Qb,kb,Ib,eb)=>{if(2!==kb)return 32;if(!this.oQ)return 8;Qb=this.xwj(eb);if(!Qb)return h.ULS.sendTraceTag(509383065,220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Hd?this.Hd.x5c(Qb):(this.kM.Fja(),
this.kM.FQa(sc,eb));return 32};this.khg=(sc,Qb,kb,Ib,eb)=>{Qb=this.ua.Ba;Ib=this.Ub.Gf;if(!(this.q5&&Qb&&Ib)||this.qf.fd(Qb))return 8;if(!this.AWd)return h.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===kb)return 32;Za.a("LogAddinInstallOriginEnabledForPPT")&&(kb=eb?eb.SourceControlId:void 0,window[this.nik]=this.t1g.get(kb)?this.t1g.get(kb):"Unknown");this.Hd?Za.a("UpdateLaunchInsertDialog")?(sc=eb?eb.SourceControlId:void 0,eb=eb?eb.CommandValueId:null,"InsertMoreAddInsFromFooter"===
sc?this.Hd.Pwg("{98143890-AC66-440E-A448-ED8771A02D52}"):"AddinFlyoutMoreButton"===sc?this.Hd.Pwg("0"):"LaunchAddinDialogFromTellMe"==sc&&eb?this.Hd.Vak(eb):this.Hd.launchInsertDialog()):this.Hd.launchInsertDialog():(this.kM.Fja(),this.kM.FQa(sc,eb));return 32};this.fhg=(sc,Qb,kb,Ib,eb)=>{if(!eb)return 8;null!=this.Hd&&this.Ib.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&this.Hd.kJb("handleInsertAppForOffice",eb);return this.Bge(sc,eb)};this.zFj=(sc,Qb,kb,Ib,eb)=>eb?this.Bge(sc,eb):8;this.Bge=
(sc,Qb)=>{if(!this.AWd)return h.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(0===Qb.targetType)return this.STj(Qb,sc);if(1===Qb.targetType){if(this.qf.fd(this.Ub.Gf))return 16;this.nnk?Qb.isAddinCommands?Za.a("AddinCommandsActionTypeUndefinedCheck")?void 0===Qb.addinCommandsActionType||null===Qb.addinCommandsActionType||0===Qb.addinCommandsActionType?this.SQb(Qb):1===Qb.addinCommandsActionType?this.n0c(Qb):h.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+
Qb.addinCommandsActionType.toString()):0===Qb.addinCommandsActionType?this.SQb(Qb):1===Qb.addinCommandsActionType&&this.n0c(Qb):(sc={},sc.solutionId=Qb.solutionId,sc.version=Qb.version,sc.storeType=Qb.storeType,sc.storeId=Qb.storeId,sc.targetData=Qb,this.Hd.Xi.isAddinCommandsAsync(sc,(kb,Ib,eb)=>{Ib?this.SQb(eb.targetData):this.n0c(eb.targetData);kb||(kb=eb.targetData,h.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(kb.solutionId,
kb.storeType,kb.assetId,null,null,kb.storeId),kb.storeType))})):this.n0c(Qb);Ja.a.add(Qb.solutionId,Qb.targetType,Qb.storeId,Qb.storeType,Qb.version);return 32}return 8};this.la=Ka;this.Ib=Db;this.q5=this.la.pptEditInsertAppsForOfficeEnabled;this.nnk=this.la.Gua;this.sr=bc;this.ia=Mc;this.Ub=mb;this.ua=Wa;this.rbd=ub;this.Fb=db;this.kM=Lb;this.Oc=Kb;this.Tb=uc;this.qf=Yb;this.kj=Tc}get AWd(){return this.q5&&n.AFrameworkApplication.Tca}vb(){this.ia.ra(Na.a.sAb,ia.a.application,this.khg,516);this.ia.ra(Na.a.$_c,
ia.a.application,this.zFj,4);this.ia.ya(Na.a.WZc,ia.a.application,Object(z.a)(this,this.iFj,"handleHideAppForOfficeTaskPane"));this.ia.ra(Na.a.tkb,ia.a.application,Object(z.a)(this,this.sIj,"handleRenderAppForOfficeTaskPane"),4);this.ia.ra(Na.a.i0a,ia.a.application,Object(z.a)(this,this.i0a,"queryEntitledAppsForOffice"),96);this.ia.ya(Na.a.Sga,ia.a.application,Object(z.a)(this,this.dig,"handleShowFirstPartyTaskPane"));this.ia.ya(Na.a.hvb,ia.a.application,Object(z.a)(this,this.NDj,"handleCloseAppsForOfficeTaskPane"));
this.ia.ya(na.a.zEh,ia.a.application,Object(z.a)(this,this.eJj,"handleShowExtensionTaskPane"));this.ia.ya(na.a.$Mf,ia.a.application,Object(z.a)(this,this.ODj,"handleCloseExtensionTaskPane"));this.ia.ya(na.a.luh,ia.a.application,Object(z.a)(this,this.CIj,"handleRestartExtensionTaskPane"));this.ia.ya(Na.a.tPh,ia.a.application,Object(z.a)(this,this.aKj,"handleUpdateBackgroundAppData"));this.ia.ya(na.a.Swg,ia.a.application,this.UFj);Za.a("EnabledTellMeAddinOnPPTO")&&(this.ia.ra(na.a.Gmg,ia.a.application,
this.fhg,4),this.ia.ra(na.a.Vse,ia.a.application,this.khg,4));this.OBf&&(this.ia.ya(na.a.x5c,ia.a.application,this.jhg),this.ia.ya(na.a.Yje,ia.a.application,this.fhg),this.ia.ya(na.a.Vwg,ia.a.application,this.VFj),this.ia.ra(na.a.VZk,ia.a.application,this.AHj,4),this.ia.ya(na.a.JTk,ia.a.application,this.eHj),PowerPointWebEditor.AppChromeSettingsLoadedHandler.RegisterOrInvokeOnAppChromeSettingsLoad(Object(z.a)(this,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("InsertAddInFlyout",
!1))},"insertAddInFlyoutUpdateStateCallback")),this.rBb&&(this.ia.ya(na.a.LHl,ia.a.application,this.BJj),this.ia.ya(na.a.Jak,ia.a.application,this.TFj),this.ia.ya(na.a.wUj,ia.a.application,this.NFj)));Za.a("EnableSetTitleExtensionTaskPane")&&this.ia.ya(na.a.dBh,ia.a.application,this.ZIj);this.cmi&&this.ia.ra(na.a.umg,ia.a.application,this.ECj,516)}get oQ(){if(!this.OBf)return null;if(!this.Hd)return this.kM.Fja(),null;this.eve||(this.Hd.lKc?(this.eve=new Y(this.ia,this.Hd.lKc,na.a.x5c.toString(),
na.a.Vwg.toString(),Na.a.sAb.toString(),this.Ib),this.nHe=n.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)):h.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null"));return this.eve}get OBf(){return this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get rBb(){return this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",
!1)}get cmi(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinTransitionEntranceEnabled",!1)}xwj(Ka){if(Ka)if(this.oQ.Q2c){if(Ka=this.oQ.z$d(this.Fzj(Ka)))return Ka.solutionId}else{const Db=Ka.CommandValueId;return null!=Db?Db:this.oQ.qPf[Ka.SourceControlId]}}Fzj(Ka){var Db;return null!==(Db=Ka.CommandValueId)&&void 0!==Db?Db:this.oQ.Veg(Ka.SourceControlId)}me(){}get Hd(){return this.Oc.instance}F5f(Ka){return this.oQ.Q2c?this.oQ.z$d(Ka):this.Hd.lKc.v7b(Ka)}static r4(Ka,
Db,bc,Mc){return Telemetry.PrivacyRules.GetPrivacyCompliantId(Ka,Db,bc,null,null,Mc)}Kak(){fa.a.instance.getItem("AddinFlyoutSurveyShowedInPPT")&&(this.lHe=!1);this.lHe&&(window.setTimeout(()=>{let Ka=this.i9f();Ka&&"hidden"!==Ka.visibility&&(this.YJg=!0)},this.fxi),this.$sk=window.setTimeout(()=>{this.W1g=aa.a.instance.Ia("Common.ISystemInitiatedFeedback");this.YJg&&this.W1g&&this.W1g.execute(Ka=>{let Db=this.i9f();Db&&"hidden"===Db.visibility&&(Ka.hmb(this.gxi,null),this.lHe=!1,fa.a.instance.setItem("AddinFlyoutSurveyShowedInPPT",
"1"))})},this.hxi))}i9f(){let Ka=null;try{const Db=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");Db&&(Ka=ka.a.wt(Db.parentNode.parentNode.parentNode))}catch(Db){h.ULS.sendTraceTag(508900309,220,10,"AddinFlyout get parent and parent get exception "+(Db?Db.toString():""))}return Ka}Irc(){this.nHe&&window.clearTimeout(this.$sk)}eJj(Ka,Db,bc,Mc,mb){if(2!==bc)return 32;const Wa=mb[Ga.a.cxb];mb=mb[Ga.a.Mib];const db={};db.cB=mb.optionalProperties[e.a.cB];db.assetId=Wa.getId();db.n6=mb.optionalProperties[e.a.n6];
db.nonPersistedSettings=mb.qwb;return this.dig(Ka,Db,bc,Mc,db)}ODj(Ka,Db,bc,Mc,mb){if(2!==bc)return 32;Ka=mb[Ga.a.cxb];mb=mb[Ga.a.Mib];Db={};Db.cB=mb.optionalProperties[e.a.cB];Db.assetId=Ka.getId();Db.sourceLocationOverrideResourceId=mb.optionalProperties[e.a.sourceLocationOverrideResourceId];Db.n6=mb.optionalProperties[e.a.n6];Db.nonPersistedSettings=mb.qwb;mb=this.Hd.Qxb(Db);return(mb=this.Hd.HQ(mb))&&this.Hd.G_d(mb.instanceId)?32:8}CIj(Ka,Db,bc,Mc,mb){if(2!==bc)return 32;Ka=mb[Ga.a.cxb];Db=mb[Ga.a.Mib];
mb={};mb.cB=Db.optionalProperties[e.a.cB];mb.assetId=Ka.getId();mb.sourceLocationOverrideResourceId=Db.optionalProperties[e.a.sourceLocationOverrideResourceId];mb.n6=Db.optionalProperties[e.a.n6];mb.nonPersistedSettings=Db.qwb;Ka=this.Hd.Qxb(mb);return(Ka=this.Hd.HQ(Ka))?(this.Hd.Poh(Ka.instanceId,mb),32):8}iFj(Ka,Db,bc,Mc,mb){if(!this.q5)return 16;if(!mb)return 8;if(1===bc)return 32;Ka=Object(Ma.a)(String,mb);if(!Ka||!Ka.length)return 8;if((Db=this.Hd.HTc(Ka))&&Db.taskpane){if(this.Hd.Oua(Ka))return this.Hd.MNb(Ka,
!1),32;if(Db.qp&&OSF.OsfControl.isFirstPartyStoreString(Db.qp.storeType))return this.Hd.cRc(Ka),this.Hd.s1k(Ka),32;Db=Db.taskpane.ownerAddinSolutionId;if(this.Hd.VVj(Ka)||Db)this.Hd.cRc(Ka);else if(Db=this.Hd.$Uc(),bc=this.Tb.Lc(Db),Ka=this.Hd.v2f(Ka)){bc.el(Object(Ma.a)(Fa.a,Ka));Ka=this.Fb.yd(4,void 0,void 0,void 0,!0);try{Ka.jc(Db),bc.Qi()}finally{Ka&&Ka.dispose()}}}return 32}sIj(Ka,Db,bc,Mc,mb){if(!this.q5)return 16;if(!mb)return 8;if(1===bc)return 32;Db=Object(Ma.a)(String,mb);if(!Db||!Db.length)return 8;
this.Hd?this.Hd.tkb(Db):this.kM.FQa(Ka,mb);return 32}dig(Ka,Db,bc,Mc,mb){if(!this.q5)return 16;if(!mb)return 8;if(1===bc)return 32;if(this.Hd){if(!mb||!mb.assetId||!n.AFrameworkApplication.L3c(mb.assetId))return 8;mb.nonPersistedSettings||(mb.nonPersistedSettings={});mb.nonPersistedSettings.ShowFeedback=n.AFrameworkApplication.iF;!this.sHg&&this.qDb&&(this.sHg=!0,Ka=window.performance.now()-this.qDb,h.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",Ka));Ka=this.Hd.Qxb(mb);if(Ka=
this.Hd.HQ(Ka))return this.Hd.Poh(Ka.instanceId,mb),32;this.Hd.odl(mb)}else this.qDb||(this.qDb=window.performance.now()),this.kM.Fja(),this.kM.FQa(Ka,mb);return 32}aKj(Ka,Db,bc,Mc,mb){if(1===bc)return this.q5?32:8;if(!this.q5)return 16;if(!(mb&&mb.tw&&-1!==mb.tw.state&&mb.tw.Pya&&this.Hd))return 8;Ka=this.Hd.tEa(mb.qp.id);if(!Ka)return 8;Db=this.Fb.yd(4,void 0,void 0,void 0,!0);try{Db.jc(Ka),Ka.setValue(pa.a.Qtb,mb.tw.state),Ka.setValue(pa.a.V7a,mb.tw.Pya),Ka.setValue(wa.a.o0b,mb.qp.storeType)}finally{Db&&
Db.dispose()}return 32}NDj(Ka,Db,bc,Mc,mb){return this.q5?mb?1===bc?32:this.Hd&&mb&&mb.length?this.Hd.G_d(mb)?32:8:8:8:16}i0a(Ka,Db,bc,Mc,mb){var Wa;if(2===bc){Db=mb.callback;if(!Db)return 16;Za.a("AllowQueryAddinsForStoreTypes")?this.Hd?this.g_k(Db,null!==(Wa=mb.storeType)&&void 0!==Wa?Wa:OSF.StoreTypeEnum.MarketPlace):(mb=Object.assign({},mb),this.kM.FQa(Ka,mb)):this.f_k(Db)}return 32}g_k(Ka,Db){const bc=new H.a;bc.callbackFunc=Ka;bc.storeType=Db;bc.fromInsertDialog=!1;bc.refresh="true"===fa.a.instance.getItem(ra.a.TUd);
this.Hd.Xi.queryEntitlementDetails(bc)}f_k(Ka){const Db=new H.a;Db.callbackFunc=Ka;Db.storeType=OSF.StoreTypeEnum.MarketPlace;Db.fromInsertDialog=!1;Db.refresh="true"===fa.a.instance.getItem(ra.a.TUd);this.Hd.Xi.queryEntitlementDetails(Db)}SQb(Ka){const Db=new t.a;Db.add(Ka);Ka={};Ka[ra.a.gKc]=Db;Ka[ra.a.bsa]=3;this.ia.Ja(na.a.v5c,2,Ka)}STj(Ka,Db){const bc=this.ua.Ba;if(!bc||this.qf.fd(bc))return 16;if(!this.kj.hD(bc,1))return this.kj.KD(bc),16;try{return this.Jmg(Ka,bc,bc.Cb,Db)}catch(Mc){return 8}}Jmg(Ka,
Db,bc,Mc){bc=Db.bQi(Ka.width,Ka.height,Db.Cs()+1);ab.a.Ozf(bc,Ka,this.Hd);this.sr.HT([Object(Ma.a)(4,bc)],Db,Mc);Ja.a.add(Ka.solutionId,Ka.targetType,Ka.storeId,Ka.storeType,Ka.version);return 32}n0c(Ka){if(!this.Hd.HQ(Ka.solutionId)){var Db=this.Hd.tEa(Ka.solutionId),bc=this.Hd.$Uc();if(Db){bc=new Oa.a(Db);if(!bc.visibility){let Mc=this.Fb.yd(4,void 0,void 0,void 0,!0);try{Mc.jc(Db),Db.setValue(wa.a.q0b,!0),Db.setValue(wa.a.o0b,Ka.storeType)}finally{Mc&&Mc.dispose()}}this.Hd.tkb(bc.id)}else{Db=ab.a.JMi(this.rbd.value,
Ka,this.Hd);Ka=this.Fb.yd(4,void 0,void 0,void 0,!0);try{Ka.jc(bc),ab.a.Jdi(bc,Db)}finally{Ka&&Ka.dispose()}}}}}Object(K.a)(rc,"AppForOfficeActor",null,[268])},1037:function(K,S,d){K=d(0);var h=d(318),e=d(27),r=d(47),m=d(7),n=d(19),z=d(1253),t=d(36),x=d(28);class B{}B.speechMode="Subtitles";B.XSf=[B.speechMode];B.sourceLanguage=null;B.targetLanguages=null;B.speechFDBase=null;B.podSessionId=null;B.fTh=null;B.docId=null;B.webServiceBase=null;B.userSessionId=e.AFrameworkApplication.userSessionId;Object(K.a)(B,
"PPTSpeechClientConfig",null,[]);var D=d(78);class w{constructor(){this.va=new D.a}onFinalRecognitionText(da){this.va.raiseEvent("OnFinalRecognitionText",da)}onPartialRecognitionText(da){this.va.raiseEvent("OnPartialRecognitionText",da)}onError(da){this.va.raiseEvent("OnError",da)}onSpeechRecognitionStarted(da){this.va.raiseEvent("OnSpeechRecognitionStarted",da)}onEventUpdate(da){this.va.raiseEvent("OnEventUpdate",da)}rii(da){this.va.addHandler("OnFinalRecognitionText",da)}Ual(da){this.va.removeHandler("OnFinalRecognitionText",
da)}xki(da){this.va.addHandler("OnPartialRecognitionText",da)}lcl(da){this.va.removeHandler("OnPartialRecognitionText",da)}lii(da){this.va.addHandler("OnError",da)}Pal(da){this.va.removeHandler("OnError",da)}tli(da){this.va.addHandler("OnSpeechRecognitionStarted",da)}Pcl(da){this.va.removeHandler("OnSpeechRecognitionStarted",da)}nii(da){this.va.addHandler("OnEventUpdate",da)}Ral(da){this.va.removeHandler("OnEventUpdate",da)}}Object(K.a)(w,"PPTSpeechClientObserverController",null,[]);var J=d(395),
F=d(470);class L{constructor(){this.accessToken=null}}Object(K.a)(L,"IAuthenticationProvider",null,[]);class M{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(K.a)(M,"IDocumentDownloadConfig",null,[]);class Q{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=
this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(K.a)(Q,"ISpeechConfig",null,[]);class C{constructor(da){this.U5=da}onFinalText(){}onFragmentText(){}onFinalRecognitionText(da,Y){this.U5.onFinalRecognitionText(da,Y)}onPartialRecognitionText(da,Y){this.U5.onPartialRecognitionText(da,Y)}onError(da){if("ErrorNone"!==da)switch(da){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.U5.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.U5.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.U5.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.U5.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.U5.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.U5.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.U5.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.U5.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.U5.onError("NotReadableError");break;default:this.U5.onError("CustomError-"+da)}}onSpeechRecognitionStarted(da){J.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",da);this.U5.onSpeechRecognitionStarted(da)}onEventUpdate(da){this.U5.onEventUpdate(da)}}Object(K.a)(C,"PPTSpeechClientObserver",null,[705]);class O{constructor(da){this.haa=null;this.aJa=0;this.microphoneDeviceId="";this.Puk=new C(da)}H7j(){return 2===this.aJa}PSj(){const da=this.P1d(),Y=Object.assign(new L,{accessToken:""});this.haa&&0!==this.aJa&&(this.haa.stopSpeechRecognition(),this.aJa=0);this.haa=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(da,
this.Puk,Y,null,new F.a);return this.haa?!0:(J.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}BHh(){this.haa&&(0===this.aJa?(this.haa.startSpeechRecognition(),this.aJa=2):1===this.aJa&&(this.haa.resumeSpeechRecognition(),this.aJa=2))}pGl(){this.haa&&(this.haa.stopSpeechRecognition(),this.aJa=0)}oSk(){this.haa&&(this.haa.pauseSpeechRecognition(),this.aJa=1)}setCustomSetting(da,Y){this.haa&&this.haa.setCustomSetting(da,Y)}P1d(){return Object.assign(new Q,{speechMode:B.speechMode,
sourceLanguage:B.sourceLanguage,targetLanguages:B.targetLanguages,speechFDBase:B.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new M,{docId:B.docId,podsSessionId:B.podSessionId,userDataCenterClusterId:B.fTh,webServiceBase:B.webServiceBase}),userSessionId:B.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(K.a)(O,"PPTSpeechClientProxy",null,[]);var U;(function(da){da[da.none=0]="none";da[da.singleLineRibbon=1]="singleLineRibbon";
da[da.multipleLineRibbon=2]="multipleLineRibbon";da[da.slideShowToolbar=3]="slideShowToolbar";da[da.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";da[da.liveBroadcast=5]="liveBroadcast"})(U||(U={}));Object(K.b)("TranscriptionEntryPoint",U);var T=d(687),ca=d(70);d.d(S,"a",function(){return N});class N{constructor(){this.tf=this.jaa=this.tD=this.jhb=this.$r=this.kb=this.la=this.Vb=this.Jc=null;this.dFb=!1;this.Xl=null;this.thb=this.dlc=0;this.OKg=!1;this.eJa=this.dJa="";this.g9c=!1;this.fIe=
"";this.Qwe=0;this.BEb=this.s1=this.WHb="";this.EO=null;this.ixa={};this.ona=new w;this.V$=new O(this.ona);N.TSj()}init(da,Y,fa,aa,ka,H,ra){x.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.tf=Y;this.la=da;this.Jc=fa;this.kb=aa;this.Xl=ka;this.Vb=H;this.EO=ra;this.$r=document.createElement("div");this.$r.id="SubtitleContainer";this.$r.className="SubtitleContainer";this.$r.style.display=ca.a.Qe;this.$r.style.visibility=ca.a.ft;this.jhb=document.createElement("div");this.jhb.id="SubtitleResultDiv";
this.jhb.className="SubtitleResultDiv";this.Jc.k5i&&(this.jhb.style.direction="rtl");this.tD=document.createElement("span");this.tD.id="SubtitleResultSpan";this.tD.className="SubtitleResultSpan";this.tD.setAttribute("aria-hidden","true");this.jaa=document.createElement("span");this.jaa.id="SubtitleAccessibilitySpan";this.jaa.className="SubtitleAccessibilitySpan";this.jaa.innerText="";this.jaa.setAttribute("lang",this.Jc.aAa);this.jaa.setAttribute("aria-live","assertive");this.jaa.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.jaa.setAttribute("aria-atomic","true");this.jhb.appendChild(this.tD);this.jhb.appendChild(this.jaa);this.$r.appendChild(this.jhb);this.tf.appendChild(this.$r);h.a.instance.ub(this.tD,()=>!1);e.AFrameworkApplication.fa.fU?this.jn():e.AFrameworkApplication.fa.$e(Object(m.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){this.WHb=this.getUserId();this.s1=e.AFrameworkApplication.fa.Ha("TenantId");this.BEb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ha("HostAuthType")||
"Unknown"}getUserId(){let da=e.AFrameworkApplication.fa.Ha("PptEditingUserId");r.a.Xa(da)&&(da=e.AFrameworkApplication.fa.Ha("LoggableUserId"),x.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",r.a.Xa(da)));return da}wal(){this.$r.style.display=ca.a.Qe;this.$r.style.visibility=ca.a.ft}transcribe(da,Y,fa,aa,ka,H){this.hCb()&&(this.Xl.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,T.a.Gid),this.dlc=window.setTimeout(Object(m.a)(this,this.Yhe,
"hideSoundReminderNotification"),3E3));this.dUl(Y,fa,aa,this.Jc);this.V$&&(this.V$.microphoneDeviceId=this.EO.microphoneDeviceId);this.Jc.Rh&&this.V$.PSj()?(this.ixa.StartTime=H,this.ixa.LastError="ErrorNone",this.ixa.EntryPoint=U[ka],this.ona.rii(Object(m.a)(this,this.Uah,"onFinalRecognitionTextHandler")),this.ona.xki(Object(m.a)(this,this.xch,"onPartialRecognitionTextHandler")),this.ona.lii(Object(m.a)(this,this.feh,"onSpeechProxyErrorHandler")),this.ona.nii(Object(m.a)(this,this.geh,"onSpeechProxyEventUpdateHandler")),
this.ona.tli(Object(m.a)(this,this.heh,"onSpeechRecognitionStartedHandler")),this.V$.BHh(),this.V$.setCustomSetting("clientMetadata",JSON.stringify(this.a8f())),this.tD.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.tD.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==ka),this.pKc(),this.kb.QJc(Object(m.a)(this,this.Gxa,"onGetCurrentSlideDimensionsHandler")),this.kb.RQa(Object(m.a)(this,this.Tkd,"onSlideChangedHandler"))):this.K5e()}a8f(da=""){const Y=t.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
fa={};fa.userID=this.WHb;fa.tenantId=this.s1;fa.identityProvider=this.BEb;fa.audienceChannel="";fa.audienceGroup=Y.Ring||"Unknown";fa.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";fa.locale=this.la.vKa||"Unknown";fa.wacHost=Y.Host||"Unknown";fa.wacDatacenter=Y.WACDatacenter||"Unknown";fa.livePragueSessionInfo=da;return fa}K5e(){this.$r.style.display=ca.a.Qe;this.$r.style.visibility=ca.a.ft;this.V$.pGl();this.ona.Ual(Object(m.a)(this,this.Uah,"onFinalRecognitionTextHandler"));this.ona.lcl(Object(m.a)(this,
this.xch,"onPartialRecognitionTextHandler"));this.ona.Pal(Object(m.a)(this,this.feh,"onSpeechProxyErrorHandler"));this.ona.Ral(Object(m.a)(this,this.geh,"onSpeechProxyEventUpdateHandler"));this.ona.Pcl(Object(m.a)(this,this.heh,"onSpeechRecognitionStartedHandler"));this.kb.jqd(Object(m.a)(this,this.Gxa,"onGetCurrentSlideDimensionsHandler"));this.kb.okb(Object(m.a)(this,this.Tkd,"onSlideChangedHandler"));this.hCb()&&this.Xl.instance.hide();this.ixa.EndTime=Date.now();x.a.J(512495705,817,15,JSON.stringify(this.ixa,
N.oQl));this.ixa={};this.Jc.nxb=!1}pKc(){let da=3;this.ixa.LastPosition=this.Jc.gw;"AboveSlide"===this.Jc.gw&&this.$r.style.visibility===ca.a.Tz?(this.$r.style.display=ca.a.sba,this.$r.style.backgroundColor="black",this.$r.style.bottom="auto"):"BelowSlide"===this.Jc.gw&&this.$r.style.visibility===ca.a.Tz?(this.$r.style.display=ca.a.sba,this.$r.style.backgroundColor="black",this.$r.style.bottom="3%",da=-1):"TopOverlay"===this.Jc.gw?(this.$r.style.display=ca.a.sba,this.$r.style.backgroundColor="transparent",
this.$r.style.bottom="auto",da=5):"BottomOverlay"===this.Jc.gw&&(this.$r.style.display=ca.a.sba,this.$r.style.backgroundColor="transparent",this.$r.style.bottom="5%",da=-1);this.dFb&&document.getElementById("LiveURLBarLayerHost")?this.$r.style.top=-1<da?String.format("calc({0}% + {1})",da.toString(),"26px"):"auto":(this.$r.style.top=-1<da?da.toString()+"%":"auto",this.iCf())}isVisible(){return this.$r.style.visibility===ca.a.Tz}FLh(da,Y=""){B.XSf=da?["Live","Subtitles"]:["Subtitles"];this.dFb=da;
this.setVisibility(this.$r.style.visibility===ca.a.Tz);this.pKc();this.V$.setCustomSetting("clientMetadata",JSON.stringify(this.a8f(Y)));this.V$.setCustomSetting("slideIndex",this.Qwe);this.V$.setCustomSetting("currentSpeechModes",JSON.stringify(B.XSf))}Tga(da){this.$r.style.cursor=da?"default":"none"}iCf(){this.tD.style.fontSize=Math.floor(this.$r.clientHeight/2/1.5).toString()+"px";this.fIe=Math.floor(this.$r.clientHeight/12-2)+"px";this.tD.style.display="inline"}setVisibility(da){this.$r?(null===
da&&(da=this.$r.style.visibility===ca.a.ft),this.$r.style.visibility=da?ca.a.Tz:ca.a.ft):x.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}Gxa(){this.iCf()}Tkd(da,Y){this.Qwe=Y.slideIndex;this.V$.H7j()&&this.dFb&&(this.V$.setCustomSetting("currentSlideIndex",this.Qwe),x.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(da){da?(this.V$.oSk(),this.jsc(),this.g9c=!0,this.Vb&&this.Vb.instance&&
this.Vb.instance.Jzh()):(this.V$.BHh(),this.Vb&&this.Vb.instance&&this.Vb.instance.Kzh())}Yhe(){this.hCb()&&(window.clearTimeout(this.dlc),this.Xl.instance.hide())}dUl(da,Y,fa,aa){B.sourceLanguage=aa.Ipa;B.targetLanguages=aa.onb;B.podSessionId=da;B.fTh=Y;B.docId=fa;B.webServiceBase=this.la.podsWebServiceBase;B.speechFDBase=e.AFrameworkApplication.fa.Ha("715");da=!!this.Vb&&!!this.Vb.instance&&(this.Vb.instance.oTa||this.Vb.instance.lr);B.speechMode=this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&
this.Vb.instance.mEa||da?"Live":"Subtitles"}pWf(da,Y){this.OKg||(this.tD.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.thb),this.tD.innerText=this.szj(da,Y),this.tD.scrollTop=this.tD.scrollHeight,this.thb=window.setTimeout(Object(m.a)(this,this.jsc,"resetSubtitlesToEmpty"),1E4),Y&&(this.jaa.innerText=da,this.jaa.focus()),this.tD.style.padding=r.a.Xa(da)?"0px":this.fIe)}Bv(da){this.OKg||(this.tD.style.color="rgba( 255, 255, 0, 1 )",r.a.Xa(da)&&(da=ResourceStrings.L_SubtitleGenericErrorMessage),
window.clearTimeout(this.thb),this.tD.innerText="["+da+"]",this.tD.scrollTop=this.tD.scrollHeight,this.thb=window.setTimeout(Object(m.a)(this,this.jsc,"resetSubtitlesToEmpty"),1E4),this.tD.style.padding=this.fIe,this.jaa.innerText="",this.jaa.focus())}uJj(da){if(null!==da)switch(da){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.Bv(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.ixa.LastError="MicrophoneError";break;case "FailedToConnect":this.Bv(ResourceStrings.L_SubtitleRetryErrorMessage);
this.ixa.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.Bv(ResourceStrings.L_SubtitleGenericErrorMessage);this.ixa.LastError="FailedToCreateSpeechSession";break;default:x.a.J(512495703,830,15,"HandleSpeechProxyError {0}",da)}}Uah(da,Y){this.$r.style.visibility!==ca.a.ft&&this.pWf(Y[this.Jc.onb],!0)}xch(da,Y){this.$r.style.visibility!==ca.a.ft&&this.pWf(Y[this.Jc.onb],!1)}feh(da,Y){x.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",Y);(da=Y.toString())&&
(-1<da.indexOf("NotAllowedError")||-1<da.indexOf("NotFoundError")||-1<da.indexOf("NotReadableError")||-1<da.indexOf("MicrophoneError"))&&this.hCb()&&this.Xl.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,T.a.i_a);this.uJj(da)}heh(da,Y){({SlideShowCoreFrame:da}=d(745));const {SlideshowFrame:fa}=d(1034);x.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",Y.toString());Object(n.a)(da,this.kb)?Object(z.a)(da,this.kb).lld(Y.toString()):Object(n.a)(fa,this.kb)&&this.la.jnd&&Object(z.a)(fa,
this.kb).lld(Y.toString());this.jsc();this.hCb()&&this.Xl.instance.hide()}geh(da,Y){if(this.hCb())switch(da=Y.eventName,da){case "MediaEvent":"AudioDeviceConnected"===Y.mediaStatus&&this.Xl.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,T.a.Gid);break;case "ConnectionRetry":this.Xl.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,T.a.i_a);this.Bv(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const fa=Y.shortCode;da=Y.longCode;const aa=Y.shortString,
ka=Y.longString;switch(Y.severity){case 0:this.Xl.instance.hide();break;case 1:(Y=0<fa?N.UY[fa]:aa)&&this.Xl.instance.show(Y,T.a.RIb);break;case 2:(Y=0<fa?N.UY[fa]:aa)&&this.Xl.instance.show(Y,T.a.i_a),Y=null===da?ka:N.UY[da],r.a.Xa(Y)||(window.clearTimeout(this.thb),this.Bv(Y),this.thb=window.setTimeout(Object(m.a)(this,this.jsc,"resetSubtitlesToEmpty"),3E4))}break;default:x.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",da)}}hCb(){return this.la.pptEditorVoiceUXEnabled&&!!this.Xl&&
!!this.Xl.instance}jsc(){this.tD.style.color="rgba( 255, 255, 255, 1 )";this.tD.innerText="";this.tD.scrollTop=this.tD.scrollHeight;this.eJa=this.dJa="";this.g9c=!1;this.thb=0;this.tD.style.padding="0px"}szj(da,Y){this.g9c?this.toi(da):this.Wdl(da);this.g9c=Y;return r.a.Xa(this.dJa)||r.a.Xa(this.eJa)?r.a.Xa(this.dJa)?this.eJa:this.dJa:this.dJa+"\n"+this.eJa}toi(da){this.dJa=r.a.Xa(this.eJa)?this.dJa:this.eJa;this.eJa=da}Wdl(da){r.a.Xa(this.dJa)||r.a.Xa(this.eJa)?this.dJa=da:this.eJa=da}static get instance(){return N.Up}static TSj(){N.UY[1]=
ResourceStrings.L_SubtitleDetection_Listening;N.UY[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;N.UY[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;N.UY[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;N.UY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static oQl(da,Y){return"undefined"===typeof Y?null:Y}}N.UY=Array(20);N.Up=new N;Object(K.a)(N,"SlideshowSubtitles",null,[621])},1039:function(K,S,d){K=d(0);var h=d(27),e=d(56),r=d(55),m=d(272),n=d(314);
class z{constructor(Oa,Za=null){this.R5h=Oa;this.ZS=Za||n.a.Dbe(e.a.c8a,"")}get Cu(){return this.R5h}get Ob(){return this.ZS}Q0e(Oa){this.Ob.d++;return this.Cu.Q0e(Oa)}BOb(Oa){this.Ob.e++;return this.Cu.BOb(Oa)}eI(Oa){this.Ob.f++;return this.Cu.eI(Oa)}y1a(Oa){this.Ob.h++;return this.Cu.y1a(Oa)}iZ(Oa){this.Ob.i++;return this.Cu.iZ(Oa)}gZ(Oa){this.Ob.j++;return this.Cu.gZ(Oa)}M6(Oa){this.Ob.k++;return this.Cu.M6(Oa)}hZ(Oa){this.Ob.l++;return this.Cu.hZ(Oa)}H0e(Oa){this.Ob.m++;return this.Cu.H0e(Oa)}MLa(Oa,
Za=!1){this.Ob.n++;return this.Cu.MLa(Oa,Za)}lge(){this.Ob.o++;return this.Cu.lge()}A4e(){this.Ob.p++;return this.Cu.A4e()}NNb(Oa){this.Ob.m++;return this.Cu.NNb(Oa)}vr(Oa){this.Ob.q++;return this.Cu.vr(Oa)}qpa(Oa){this.Ob.r++;return this.Cu.qpa(Oa)}iOb(Oa){this.Ob.g++;return this.Cu.iOb(Oa)}cud(Oa){return this.Cu.cud(Oa)}F1a(Oa){this.Ob.s++;return this.Cu.F1a(Oa)}Itd(Oa){this.Ob.s++;return this.Cu.Itd(Oa)}Nga(Oa){this.Ob.s++;return this.Cu.Nga(Oa)}E1a(Oa){this.Ob.s++;return this.Cu.E1a(Oa)}Glb(Oa){this.Ob.t++;
return this.Cu.Glb(Oa)}dud(Oa){this.Ob.u++;return this.Cu.dud(Oa)}vtc(Oa){this.Ob.v++;return this.Cu.vtc(Oa)}spa(Oa){return this.Cu.spa(Oa)}jtd(Oa){this.Ob.z++;return this.Cu.jtd(Oa)}zYe(){return this.Cu.zYe()}TLa(Oa,Za){this.Ob.w++;this.Ob.x++;return this.Cu.TLa(Oa,Za)}f2(Oa){this.Ob.y++;return this.Cu.f2(Oa)}x1a(Oa){this.Ob.z++;return this.Cu.x1a(Oa)}clearFormatting(){return this.Cu.clearFormatting()}clone(){return new z(this.Cu.clone(),this.Ob)}}Object(K.a)(z,"FormattingStewardUsageCollector",
null,[710]);class t extends z{constructor(Oa,Za=null){super(Oa,Za)}get j6(){return this.Cu}get vE(){return this.j6.vE}set vE(Oa){this.j6.vE=Oa}get textIndent(){return this.j6.textIndent}get marginLeft(){return this.j6.marginLeft}get Mld(){return this.j6.Mld}get lineSpacing(){return this.j6.lineSpacing}get Wga(){return this.j6.Wga}get E5c(){return this.j6.E5c}get qga(){return this.j6.qga}get paragraph(){return this.j6.paragraph}set paragraph(Oa){this.j6.paragraph=Oa}get y$a(){return this.j6.y$a}ryd(Oa){return this.j6.ryd(Oa)}r9e(Oa){return this.j6.r9e(Oa)}clone(){const Oa=
this.Cu.clone();return new t(Oa,this.Ob)}}Object(K.a)(t,"FormattingStewardUsageCollector",z,[709,710]);var x=d(34),B=d(76),D=d(187),w=d(686),J=d(54),F=d(149),L=d(74),M=d(60),Q=d(317),C=d(1134),O=d(348),U=d(47),T=d(1261),ca=d(1256),N=d(1255),da=d(114),Y=d(41),fa=d(83),aa=d(42),ka=d(38),H=d(88),ra=d(308);class ha{}ha.yellow="FFFF00";ha.lime="00FF00";ha.aqua="00FFFF";ha.fuchsia="FF00FF";ha.blue="0000FF";ha.red="FF0000";ha.navy="000080";ha.teal="008080";ha.green="008000";ha.purple="800080";ha.maroon=
"800000";ha.olive="808000";ha.gray="808080";ha.DDl="C0C0C0";ha.black="000000";Object(K.a)(ha,"FontHighlightColorEnum",null,[]);var Ma=d(350),Ga=d(51),na=d(904),wa=d(378),Fa=d(109);class pa{constructor(Oa,Za,Na,sa,Sa,xb,gc,zc,Xb=null,jb=!1){this.qv=this.nFc=null;this.KXb=0;this.Def=this.JXb=null;this.f3=0;this.KPa=this.EHc=this.QDc=this.lHc=this.r5a=this.Cia=this.dEc=this.PHc=null;this.OTf=.25*da.Font.SI;this.paragraph=Oa;this.Jf=Za;this.eL=Na;this.VP=sa;this.aia=Sa;this.WV=xb;this.VZ=gc;this.z4a=
zc;Xb?(Fa.a(4223818,307,!!Xb.qv),this.qv=Xb.qv.xNc(this.paragraph),this.KXb=Xb.KXb,this.JXb=Xb.JXb,Xb.Cia&&(this.Cia=new na.a,this.Cia.afterSpacing.value=Xb.Cia.afterSpacing.value,this.Cia.beforeSpacing.value=Xb.Cia.beforeSpacing.value),Xb.r5a&&(this.r5a=Xb.r5a.clone()),this.f3=Xb.f3,this.EHc=Xb.EHc.clone(),this.PHc=Xb.PHc,this.dEc=Xb.dEc,this.lHc=Xb.lHc,this.QDc=Xb.QDc,Xb.qga&&(this.KPa=Xb.qga)):(this.qv=new ra.a(this.paragraph,0),this.qv.formatting=new Ma.a(this.qv,Q.a.nil),Za=Ga.a.eSa(Oa),Za=this.VP.Es(Za),
this.Sol(Za),pa.pzl(Oa)?(this.aia.K0e(this.qv.formatting,Za,jb),this.f3=Oa.Ta(Y.a.Vl)?Oa.eb(Y.a.Vl):0):this.f3=-1,this.KXb=0,this.JXb=null,this.Cia=this.yij(),this.z4a&&(this.Cia=this.aia.fX(Oa),this.r5a=this.aia.gce(Oa),this.lHc=this.aia.BUa(Oa),this.QDc=this.aia.k9(Oa)),this.EHc=new C.DictionaryPropertySet,this.aia.v0e(this.qv.formatting,Oa,jb))}get paragraph(){return this.nFc}set paragraph(Oa){Fa.a(4223816,307,!!Oa&&x.ParagraphReader.fe(Oa));this.nFc=Oa}get y$a(){return this.qv.formatting}get xoc(){return this.KXb}get zgh(){return this.JXb}get F3(){return this.Def}get vE(){return this.f3}set vE(Oa){Fa.a(4223817,
307,1===Oa||2===Oa||3===Oa||ka.a.instance.ga(54)&&6===Oa);this.f3=Oa}get textIndent(){return this.PHc}get marginLeft(){return this.dEc}get Mld(){return this.Cia}get lineSpacing(){return this.r5a}get Wga(){return this.lHc}get E5c(){return this.QDc}get qga(){return this.KPa}Sol(Oa){const Za=this.VP.language(Oa);Za&&this.Jf.ttc(this.qv.formatting,Za,0,Oa.cache.dWa,!1)}yij(){if(ka.a.instance.ga(54))return null;const Oa=new na.a;Oa.afterSpacing.value=this.OTf;Oa.beforeSpacing.value=this.OTf;return Oa}Q0e(Oa){(Oa=
m.a.He(Oa))&&this.Jf.z1a(this.qv.formatting,Oa.LCID);return!0}BOb(){return!1}eI(Oa){this.Jf.eI(this.qv.formatting,Oa);return!0}y1a(Oa){this.Jf.setItalic(this.qv.formatting,Oa);return!0}iZ(Oa){this.Jf.iZ(this.qv.formatting,Oa);return!0}gZ(Oa){this.Jf.gZ(this.qv.formatting,Oa);return!0}M6(Oa){this.Jf.M6(this.qv.formatting,Oa);return!0}hZ(Oa){this.Jf.hZ(this.qv.formatting,Oa);return!0}H0e(Oa){if(0>=Oa)return!1;this.Jf.Xq(this.qv.formatting,Oa);return!0}MLa(Oa,Za){if(!Oa||""===Oa)return!1;if(({fontInfo:Na}=
O.FontUtils.GPl(Oa)).returnValue)return this.Jf.pV(this.qv.formatting,Na.fontName),!0;var Na=!1;const sa=O.FontUtils.rG(Oa);Za&&this.Wcc(sa,this.WV)&&(this.WV.createFontUrl(Oa),Na=!0);this.Wcc(sa,this.VZ)&&(Na=!0);Na&&this.Jf.pV(this.qv.formatting,sa);return Na}Wcc(Oa,Za){return!!Za&&Za.isEnabled&&Za.Wcc(Oa)}lge(){this.Jf.gZc(this.qv.formatting);return!0}A4e(){this.Jf.Ivd(this.qv.formatting);return!0}NNb(Oa){if(0>=Oa)return!1;this.Jf.NNb(this.qv.formatting,Oa);return!0}vr(Oa){var {Box4PasteSteward:Za}=
d(252);if(!this.Jf.Ktg(Oa)){if(null===Oa||""===Oa)return!1;Oa=Za.X8a(Oa)}Za=null;this.qga&&this.qga.hasOwnProperty(aa.a.listLevel.id.toString())&&(Za=this.qga[aa.a.listLevel.id.toString()]);this.Jf.vr(this.qv.formatting,Oa,Za);return!0}qpa(Oa){const {Box4PasteSteward:Za}=d(252);if(!Oa||""===Oa||ka.a.instance.ga(49)&&!pa.CBj().contains(Oa)||this.aia.IDh(this.qv.formatting))return!1;this.Jf.qpa(this.qv.formatting,Za.X8a(Oa));return!0}x1a(Oa){this.Jf.x1a(this.qv.formatting,Oa);return!0}iOb(Oa){this.Jf.iOb(this.qv.formatting,
Oa);return!0}cud(Oa){let Za=0;switch(U.a.ug(Oa)){case "small-caps":Za=1;break;case "uppercase":Za=2}this.Jf.Rm(this.qv.formatting,fa.a.capitalization,Za);return!0}jtd(Oa){const {Box4PasteSteward:Za}=d(252);if(!Oa||""===Oa)return!1;this.EHc.setValue(Y.a.OMc,parseInt(Za.X8a(Oa),16));return!0}E1a(Oa){return 0>=Oa?!1:this.Itd(H.StyleReader.ixj(Oa))}F1a(Oa){this.clearFormatting();this.KXb=Oa;return!0}Itd(Oa){const {Box4PasteSteward:Za}=d(252);return Oa&&0<Oa.length&&Za.RPb&&Za.RPb.oH(Oa)?(this.JXb=Oa,
!0):!1}Nga(Oa){const {Box4PasteSteward:Za}=d(252);return Oa&&0<Oa.length&&Za.RPb&&Za.RPb.oH(Oa)?(this.Def=Oa,!0):!1}r9e(Oa){if(this.F3){Oa=d(252).Box4PasteSteward.RPb||H.StyleReader.OL(Oa);if(!Oa)return Fa.a(41968715,307,!1),!1;(Oa=Oa.oH(this.F3))&&this.Jf.Nga(this.qv.formatting,Oa);return!0}return!1}TLa(Oa,Za){if(ka.a.instance.ga(54))return!1;Fa.a(5297416,307,0<=Oa&&0<=Za);0<=Oa&&(this.Cia.beforeSpacing.value=Oa);0<=Za&&(this.Cia.afterSpacing.value=Za);return 0<=Oa||0<=Za}f2(Oa){if(!ka.a.instance.ga(54)||
!Oa)return!1;const Za=parseFloat(U.a.substring(Oa,0,U.a.ug(Oa).indexOf("px")));if(!isNaN(Za))return this.r5a=new wa.a(3,T.a.tga(Za,1)),!0;Oa=parseFloat(U.a.substring(Oa,0,U.a.ug(Oa).indexOf("%")));return isNaN(Oa)?!1:(this.r5a=new wa.a(2,Oa/100),!0)}Glb(Oa){let Za=0;if(!Oa||""===Oa)return!1;switch(Oa){case "left":Za=1;break;case "center":Za=2;break;case "right":Za=3;break;case "justify":ka.a.instance.ga(54)&&(Za=6)}if(0===Za)return!1;this.vE=Za;return!0}dud(Oa){this.PHc=Oa;return!0}vtc(Oa){this.dEc=
Oa;return!0}spa(Oa){this.KPa=JSON.parse(Oa);return this.qga?!0:!1}clearFormatting(){this.qv.formatting=new Ma.a(this.qv,Q.a.nil);return!0}zYe(){this.f3=0;return!0}ryd(Oa){var {Box4PasteSteward:Za}=d(252);if(!ka.a.instance.ga(71))return!1;if(0<this.xoc&&Za.hKa[this.xoc]){Fa.a(4223819,307,1<=this.xoc);Fa.a(4223820,307,7>=this.xoc);Za=H.StyleReader.OL(Oa);if(!Za)return Fa.a(4223821,307,!1),!1;Za=Za.oH(d(252).Box4PasteSteward.hKa[this.xoc]);this.eL.fba(Za,Oa,!1);return!0}if(this.zgh){Za=d(252).Box4PasteSteward.RPb||
H.StyleReader.OL(Oa);if(!Za)return Fa.a(41968716,307,!1),!1;this.eL.fba(Za.oH(this.zgh),Oa,!1);return!0}return!1}clone(){return new pa(this.paragraph,this.Jf,this.eL,this.VP,this.aia,this.WV,this.VZ,this.z4a,this)}static CBj(){pa.jQ||(pa.jQ=new ca.a(N.a.Gk()),pa.jQ.add(ha.yellow),pa.jQ.add(ha.lime),pa.jQ.add(ha.aqua),pa.jQ.add(ha.fuchsia),pa.jQ.add(ha.blue),pa.jQ.add(ha.red),pa.jQ.add(ha.navy),pa.jQ.add(ha.teal),pa.jQ.add(ha.green),pa.jQ.add(ha.purple),pa.jQ.add(ha.maroon),pa.jQ.add(ha.olive),pa.jQ.add(ha.gray),
pa.jQ.add(ha.DDl),pa.jQ.add(ha.black));return pa.jQ}static pzl(Oa){if(!ka.a.instance.ga(71))return!0;Oa=H.StyleReader.OQ(H.StyleReader.qE(Oa));return Oa===H.StyleReader.BTh||Oa===H.StyleReader.wNa||Oa===H.StyleReader.ETh||Oa===H.StyleReader.Mpa}}pa.jQ=null;Object(K.a)(pa,"FormattingSteward",null,[709,710]);class Ea{E9e(){return!1}Hge(Oa){return Oa}spa(){}fOb(){}n2c(){return!1}get l3c(){return!1}f2(){}TLa(){}LAh(){}Dzh(){}get LDh(){return!1}}Object(K.a)(Ea,"NoOpPasteStewardBridge",null,[433]);var ta=
d(18);class ia{constructor(Oa,Za){this.UCk=Oa;this.VCk=Za||"Normal"}}Object(K.a)(ia,"NoteTagInfoBox4",null,[]);const Ja=Oa=>{const Za=new ta.a;for(let Na of Oa)Oa=new ia(Na.UCk,Na.VCk),Za.add(Oa);return Za};d.d(S,"a",function(){return ab});class ab{constructor(Oa,Za,Na=null,sa=null){this.VZ=this.WV=null;this.w$i=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.Crf=0;this.zb=Oa;this.SG=Za;this.KZ=sa||new Ea;this.ZS=Na||n.a.Dbe(e.a.c8a,"")}get Ob(){return this.ZS}get characterPropertiesEditor(){return ab.mh||
(ab.mh=r.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.WV||(this.WV=r.a.instance.rb("Box4.IFontService"))}get GDa(){return this.VZ||(this.VZ=r.a.instance.rb("Box4.CustomFontService"))}reset(){}get w4b(){return this.Oae(!1)}Oae(Oa){Fa.a(4223770,307,M.OutlineElementReader.hh(this.zb));const Za=J.OutlineElementNavigator.yi(this.zb);J.OutlineElementNavigator.Se(this.zb);Fa.a(4223771,307,!!Za&&x.ParagraphReader.fe(Za));Oa=new pa(Za,ab.oh,ab.GP,ab.jaj,ab.kaj,this.fontService,
this.GDa,this.w$i,void 0,Oa);return new t(Oa,this.Ob)}E1(){}roa(){}C_a(){}qoa(){}poa(){}Exa(){}Dxa(){}QA(){}PA(){}x_a(){}w_a(){}Jxa(){}ZJa(){}uoa(){}soa(){}Ixa(){}toa(){}y_a(){}vIb(Oa){M.OutlineElementReader.hh(this.zb)?(ab.Xh.Dac(this.zb,!0),J.OutlineElementNavigator.cK(this.zb,!1,!1)):L.OutlineReader.pu(this.zb)?F.OutlineNavigator.zaa(this.zb)?Oa?(this.zb.Qi(),ab.dC.vW(this.zb,!1)):ab.Xh.Erc(this.zb):ab.dC.vW(this.zb,!1):Fa.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zb.Bi)}kUa(Oa){let Za=
null;if(Oa&&Oa.ZU&&Oa.cultureName)try{Za=Object.assign(new w.a,{languageId:m.a.He(Oa.cultureName).LCID})}catch(Na){Fa.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Oa.cultureName,Na)}Za||null==this.SG||(Za=Object.assign(new w.a,{languageId:this.SG}));return Za}get ZM(){return this.Crf}set ZM(Oa){this.Crf=Oa}WKc(){}cyd(){}m_d(){}get V8a(){return!1}get j9a(){return!1}cck(Oa){let Za=1;if(Oa.Brg){var Na=0;switch(Oa.listStyleType){case 1:Za=0;break;case 7:Za=1;break;case 8:Za=2;break;case 9:Za=
3;break;case 10:Za=4;break;case 11:Za=5}}else switch(Na=1,Oa.listStyleType){case 1:Za=0;break;case 3:Za=1;break;case 4:Za=2;break;case 5:Za=3}let sa;Na=(sa=B.ListReader.d$a)?D.a.SN(Na,Za,Ja(Oa.r6),Oa.listId,Oa.listLevel,Oa.levelText,Oa.font):D.a.SN(Na,Za,Ja(Oa.r6));Oa.Brg&&!Oa.TWj&&(Na.VA=sa&&0<Oa.listId&&0<=Oa.listLevel&&!Oa.aKb?Oa.EFl:Oa.HTi);this.KZ.fOb(this.zb,Na,Oa);return Na}NY(){}KY(){}MY(){}LY(){}JY(){}IY(){}static get Xh(){return ab.Mi||(ab.Mi=r.a.instance.resolve("Box4.IOutlineElementEditor"))}static get dC(){return ab.ey||
(ab.ey=r.a.instance.resolve("Box4.IOutlineEditor"))}static get oh(){return ab.Jf||(ab.Jf=r.a.instance.resolve("Box4.IFormattingEditor"))}static get GP(){return ab.eL||(ab.eL=r.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get jaj(){return ab.VP||(ab.VP=r.a.instance.resolve("Box4.IFormattingReader"))}static get kaj(){return ab.aia||(ab.aia=r.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}ab.Mi=null;ab.ey=null;ab.mh=null;ab.Jf=null;ab.eL=null;ab.VP=null;ab.aia=null;Object(K.a)(ab,
"Box4PasteStewardBase",null,[658,659,333])},1042:function(K,S,d){d.r(S);K=d(0);var h=d(735),e=d(1060),r=d(1046),m=d(199),n=d(7),z=d(41),t=d(74),x=d(32),B=d(39),D=d(28),w=d(43);class J{constructor(N,da){this.ve=N;this.eg=da}}Object(K.a)(J,"RowSpan",null,[]);class F{constructor(N){this.YB=N;this.$Ia=[]}WTd(N,da){Array.add(this.$Ia,new J(N,da))}Yhl(N){for(let da=0;da<this.$Ia.length;da++){const Y=this.$Ia[da];N<=Y.ve&&Y.ve++;N<=Y.eg&&Y.eg++}}get x(){return this.YB}get kvh(){return this.$Ia}static wse(N,
da){return N.YB===da}static q0d(N,da){N=N.YB-da.YB;return 0<N?1:0>N?-1:0}}Object(K.a)(F,"ColSplit",null,[]);const L=(N,da,Y)=>{let fa;fa=-1;for(let aa=0;aa<N.length;++aa)if(Y(N.ga(aa),da))return fa=aa,{returnValue:!0,cAb:fa};return{returnValue:!1,cAb:fa}};class M{constructor(N,da){this.oe=N;this.Tf=da}}Object(K.a)(M,"ColSpan",null,[]);class Q{constructor(N){this.ZB=N;this.$Ia=[]}WTd(N,da){Array.add(this.$Ia,new M(N,da))}HFi(N){for(let da=0;da<this.$Ia.length;da++){const Y=this.$Ia[da];N<=Y.oe&&Y.oe++;
N<=Y.Tf&&Y.Tf++}}get uNf(){return this.$Ia}get y(){return this.ZB}static wse(N,da){return N.ZB===da}static q0d(N,da){N=N.ZB-da.ZB;return 0<N?1:0>N?-1:0}}Object(K.a)(Q,"RowSplit",null,[]);var C=d(971),O=d(29);class U{constructor(N,da,Y,fa,aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa){this.UVa=!1;this.hj=this.MMc=this.D1g=this.mfd=null;this.jOh=N;this.Vc=da;this.$Gh=Y;this.d2a=fa;this.CAd=aa;this.tableNode=ka;this.Nd=H;this.tZ=ra;this.kUa=ha;this.Zhl=Ma;this.IFi=Ga;this.zrd=na;this.HNc=wa;this.rows=Fa;this.cols=
pa;this.e2a=0;this.Tcc=!1}$7a(N){this.mfd=new Date;this.D1g=N}O9a(){this.mfd>O.App.tn&&this.Vc&&this.Vc.Wa(this.D1g,(+new Date-+this.mfd).toString());this.mfd=O.App.tn}finish(){const {TableMergeSplitEditor:N}=d(1042);this.Vc&&(this.hj&&(this.Tcc=!1,this.Vc.Wa(N.V0l,this.hj.message)),this.Vc.Wa("SplitCellsSucceeded",this.Tcc.toString()),this.Vc.finish(),this.Vc=null);if(this.hj)throw this.hj;this.$Gh&&this.$Gh(this.Tcc,this.d2a)}}Object(K.a)(U,"SplitCellsArguments",null,[]);var T=d(337);d.d(S,"TableMergeSplitEditor",
function(){return ca});class ca{constructor(N,da,Y,fa,aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa,pa){this.Tb=N;this.uY=da;this.MA=Y;this.X5=fa;this.wfd=aa;this.vM=ka;this.Xcd=H;this.Sq=ha;this.Wea=Ma;this.egb=Ga;this.il=na;this.Fb=wa;this.pa=Fa;this.xed=pa}merge(N,da,Y){const fa=N.ff(da.ve,da.oe),aa=this.Tb.Lc(fa);let ka=aa.DB(1);const H=[B.a.rowId,B.a.cellId];ka&&aa.Cc();let ra=!0;for(let Ma=da.ve;Ma<da.eg;++Ma){let Ga=N.ff(Ma,da.oe);for(let na=da.oe+(Ma===da.ve?1:0);na<da.Tf;++na)if(na!==da.oe&&(Ga=N.ff(Ma,na)),
!Ga||!Ga.isGhostCell){Ga.yo(B.a.rowSpan,B.a.colSpan);Ga.isGhostCell=!0;var ha=x.GraphIterator.pb(Ga);t.OutlineReader.isEmpty(ha)?this.$ph(ha):(ra&&t.OutlineReader.isEmpty(aa)&&(ra=!1,ka=null,this.$ph(aa)),this.vM.P$i(Ga,wa=>{this.vM.oy(aa.currentNode,wa,H);return!0},wa=>11===wa.type||22===wa.type||12===wa.type),ha=this.Tb.Ibe(ha),ha.Db(1),this.vM.XAk(aa,ka,ha.role,ha.role,ha),ha.uzb(1),ka=ha.currentNode)}}this.X5.bSl(Y,fa,da);fa.rowSpan=da.mP;fa.colSpan=da.WR;N.setValue(B.a.complexTable,!0);this.Xcd.$We(N);
N.sea(511);this.MA.Iac(N);return fa}JEl(N,da,Y,fa,aa,ka,H,ra,ha){if(1>=Y&&1>=fa)ha&&ha(!0,da);else{var Ma=new Date,Ga=w.a.Jj("SplitCells",1);Ga.Qj=!0;var na=new h.a,wa=new e.a,Fa=new e.a,pa=this.Wea.jEa(N,aa,da);da=this.Sq.JSc(aa,da);var Ea=ka.rcg();for(ka=ka.i7f();pa.moveNext();){na.add(pa.H7b().id.toString());const ab=pa.tA;for(var ta=1;ta<Y;ta++){var ia=Ea[ab.ve];ia+=(Ea[ab.eg]-ia)*ta/Y;var Ja=void 0;({cAb:Ja}=L(wa,ia,Q.wse)).returnValue||(Ja=wa.length,wa.add(new Q(ia)));wa.ga(Ja).WTd(ab.oe,ab.Tf)}for(ta=
1;ta<fa;ta++)ia=ka[ab.oe],ia+=(ka[ab.Tf]-ia)*ta/fa,({cAb:Ja}=L(Fa,ia,F.wse)).returnValue||(Ja=Fa.length,Fa.add(new F(ia))),Fa.ga(Ja).WTd(ab.ve,ab.eg)}wa=wa.toArray();Fa=Fa.toArray();wa.sort((ab,Oa)=>Q.q0d(Oa,ab));Fa.sort((ab,Oa)=>F.q0d(Oa,ab));Ga.Wa("Prep",(+new Date-+Ma).toString());Ma=this.Fb.ke(15);Ma.jc(N);N=new U(Ma,Ga,ha,da,na,N,H,aa,ra,Ea,ka,wa,Fa,Y,fa);N=new r.a(null,Object(n.a)(this,this.QEl,"splitRowSeams"),N);N.Zi=!1;N.$l("SplitTableCells");N.run()}}QEl(N,da){try{for(da.$7a("SplitRowSeams");da.e2a<
da.zrd.length;){const Y=({UVa:da.UVa}=this.EMi(da.tableNode,da.Nd,da.tZ,da.kUa,da.Zhl,da.zrd[da.e2a])).returnValue;da.e2a++;if(da.UVa){let fa;(fa=da.d2a).eg=fa.eg+1;for(let aa=0;aa<da.HNc.length;aa++)da.HNc[aa].Yhl(Y)}if(N.Spa)return!0}da.O9a();da.e2a=0;N.gh(Object(n.a)(this,this.NEl,"splitColSeams"))}catch(Y){da.hj=Y,N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}return!0}NEl(N,da){try{for(da.$7a("SplitColSeams");da.e2a<da.HNc.length;){const Y=({UVa:da.UVa}=this.DMi(da.tableNode,da.Nd,da.tZ,da.kUa,
da.IFi,da.HNc[da.e2a])).returnValue;da.e2a++;if(da.UVa){let fa;(fa=da.d2a).Tf=fa.Tf+1;for(let aa=0;aa<da.zrd.length;++aa)da.zrd[aa].HFi(Y)}if(N.Spa)return!0}da.O9a();da.e2a=0;N.gh(Object(n.a)(this,this.tRb,"updateIsComplexTableProperty"))}catch(Y){da.hj=Y,N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}return!0}tRb(N,da){try{da.$7a("UpdateComplex"),this.Xcd.K$e(this.Tb.Lc(da.tableNode)),da.O9a(),da.MMc=this.Wea.jEa(da.tableNode,da.tZ,da.d2a),N.gh(Object(n.a)(this,this.u9i,"fixSplitCells"))}catch(Y){da.hj=
Y,N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}return!0}u9i(N,da){try{for(da.$7a("FixInsideBorders");da.MMc.moveNext();)if(da.CAd.contains(da.MMc.H7b().id.toString())&&this.t9i(da.tableNode,da.tZ,da.MMc,da.rows,da.cols),N.Spa)return!0;da.O9a();N.gh(Object(n.a)(this,this.t2i,"ensureMinRowHeightColumnWidth"))}catch(Y){da.hj=Y,N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}return!0}t2i(N,da){try{da.$7a("EnsureMinHeightWidth"),1<da.rows&&this.u2i(da.tableNode,da.d2a),1<da.cols&&this.s2i(da.tableNode,
da.d2a),da.O9a(),N.gh(Object(n.a)(this,this.setSelection,"setSelection"))}catch(Y){da.hj=Y,N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}return!0}setSelection(N,da){try{da.$7a("SetSelection");da.Tcc=!da.d2a.mTa();if(da.Tcc){const Y=this.xed.sSi(da.tableNode,da.tZ,da.d2a);Y&&this.pa.gF(Y)}da.O9a();da.$7a("Render");N.Zi||da.jOh.Rzh(N);da.jOh.dispose();N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}catch(Y){da.hj=Y,N.gh(Object(n.a)(this,this.Rmb,"tearDownSplit"))}return!0}Rmb(N,da){da.O9a();da.finish();
return!1}EMi(N,da,Y,fa,aa,ka){var H;let ra=({gqe:H}=C.c(aa,ka.y)).returnValue;if(H=!H){ra++;var ha=aa[ra-1],Ma=aa[ra],Ga=this.Tb.Lc(N);this.umc(Ga,ra-1);var na=Ga.currentNode;Ga=this.Xcd.Vje(Ga);ha=ka.y-ha;na.setValue(B.a.Ku,da.gf(ha,1));ha=Ma-ka.y;Ga.setValue(B.a.Ku,da.gf(ha,1));Array.insert(aa,ra,ka.y);Y.CVa(3)}for(da=0;da<ka.uNf.length;++da){aa=ka.uNf[da];Ma=[];for(na=aa.oe;na<=aa.Tf;++na)({ama:ha}=this.wfd.ZMh(N,Y,na,ra)),Ma[Ma.length]=ha;na=new T.a;na.oe=aa.oe;na.Tf=aa.Tf;na.ve=ra-1;na.eg=ra+
1;for(na=this.Wea.jEa(N,Y,na);na.moveNext();)ha=na.tA,Ga=na.H7b(),this.MPf(ra,ha.oe,Ga),this.$yh(ra,ha.oe,Ga,fa);for(na=aa.oe;na<aa.Tf;++na){ha=N.ff(ra-1,na);Ga=N.ff(ra,na);var wa=this.Sq.ZI(Y,ra-1,na);wa.oe===na&&(ha=N.ff(wa.ve,wa.oe),wa=ra-wa.ve,Ga.rowSpan=ha.rowSpan-wa,ha.rowSpan=wa,Ga.colSpan=ha.colSpan);Ga.isGhostCell=ha.isGhostCell}Y.CVa(1);this.X5.i9d(N,Y,ra,aa.oe,aa.Tf,!0);for(let Fa=aa.oe,pa=0;Fa<=aa.Tf;++Fa,++pa)Ma[pa]&&this.X5.U1e(N,Y,Fa,ra,ra+1,Ma[pa])}return{returnValue:ra,UVa:H}}DMi(N,
da,Y,fa,aa,ka){var H;let ra=({gqe:H}=C.b(aa,ka.x)).returnValue;if(H=!H){ra++;var ha=aa[ra-1],Ma=aa[ra],Ga=this.Tb.Lc(N);this.uY.e7g(Ga);Ga.hq(ra-1,1);this.Xcd.Uje(Ga);if(Ga=N.sa(z.a.gv,null))Ga=m.a.clone(Ga),Ga[ra-1]=da.gf(ka.x-ha,0),Ga[ra]=da.gf(Ma-ka.x,0),N.setValue(z.a.gv,Ga);Array.insert(aa,ra,ka.x);Y.CVa(3)}for(da=0;da<ka.kvh.length;++da){aa=ka.kvh[da];ha=[];for(Ma=aa.ve;Ma<=aa.eg;++Ma)({ama:Ga}=this.wfd.VMh(N,Y,Ma,ra)),ha[ha.length]=Ga;Ma=new T.a;Ma.ve=aa.ve;Ma.eg=aa.eg;Ma.oe=ra-1;Ma.Tf=ra+
1;for(Ma=this.Wea.jEa(N,Y,Ma);Ma.moveNext();){Ga=Ma.tA;var na=Ma.H7b();this.MPf(Ga.ve,ra,na);this.$yh(Ga.ve,ra,na,fa)}for(Ma=aa.ve;Ma<aa.eg;++Ma){Ga=N.ff(Ma,ra-1);na=N.ff(Ma,ra);var wa=this.Sq.ZI(Y,Ma,ra-1);wa.ve===Ma&&(Ga=N.ff(wa.ve,wa.oe),wa=ra-wa.oe,na.colSpan=Ga.colSpan-wa,Ga.colSpan=wa,na.rowSpan=Ga.rowSpan);na.isGhostCell=Ga.isGhostCell}Y.CVa(1);this.X5.k9d(N,Y,ra,aa.ve,aa.eg,!0);for(let Fa=aa.ve,pa=0;Fa<=aa.eg;++Fa,++pa)ha[pa]&&this.X5.N0e(N,Y,Fa,ra,ra+1,ha[pa])}return{returnValue:ra,UVa:H}}t9i(N,
da,Y,fa,aa){var ka=this.Wea.jEa(N,da,Y.GE);ka.moveTo(Y.bP,Y.lM);Y=ka.tA;for(let H=1;H<fa;++H)ka.gBk(),Y.eg=ka.tA.eg,Y.Tf=ka.tA.Tf;for(fa=1;fa<aa;++fa)ka.moveNext(),Y.eg=ka.tA.eg,Y.Tf=ka.tA.Tf;for(aa=this.Wea.jEa(N,da,Y);aa.moveNext();){ka=aa.tA;let H;ka.eg<Y.eg&&({ama:H}=this.wfd.VMh(N,da,Y.eg,ka.oe)).returnValue&&this.X5.N0e(N,da,ka.eg,ka.oe,ka.Tf,H);ka.Tf<Y.Tf&&({ama:H}=this.wfd.ZMh(N,da,Y.Tf,ka.ve)).returnValue&&this.X5.U1e(N,da,ka.Tf,ka.ve,ka.eg,H)}}u2i(N,da){N=this.Tb.Lc(N);this.umc(N,da.ve);
for(let Y=da.ve;Y<da.eg;++Y){const fa=N.currentNode.sa(B.a.Ku,0);fa&&fa<this.il.rMc(N.currentNode)&&N.currentNode.setValue(B.a.Ku,0);N.Hf(1)}}s2i(N,da){let Y=N.sa(z.a.gv,null),fa=!1;if(Y){Y=m.a.clone(Y);for(let aa=da.oe;aa<da.Tf;++aa){const ka=this.il.wub(N,aa);Y[aa]&&Y[aa]<ka&&(Y[aa]=ka,fa=!0)}}fa&&N.setValue(z.a.gv,Y)}MPf(N,da,Y){const fa=Y.getContainingTable();fa||D.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");fa.ff(N,da).cellShading=Y.cellShading}$yh(N,da,Y,fa){const aa=
Y.getContainingTable();aa||D.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");N=x.GraphIterator.pb(aa.ff(N,da));this.egb.vW(N,!0,fa(Y))}umc(N,da){for(this.uY.e7g(N);0<da--;)this.uY.mBk(N)}$ph(N){N=this.Tb.Ibe(N);let da=N.Db(1);for(;da;)da=N.FSa(1)}}Object(K.a)(ca,"TableMergeSplitEditor",null,[228])},1043:function(K,S,d){K=d(0);var h=d(7),e=d(395),r=d(27),m=d(170),n=d(204),z=d(55);class t{constructor(C,O,U,T){this.RKd=null;this.OAc=T;this.uca=C;this.vca=O;this.NP=U;this.Yuf=
this.N4g.Hxl;C=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.T4h=C[0];this.S4h=C[1]}get N4g(){return this.RKd||(this.RKd=z.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get iVa(){return CommonUIStrings.l_OICErrorHelpLink}get quc(){return this.Yuf}get P4g(){return this.T4h}get O4g(){return this.S4h}get M4g(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Yuf?3:2}get a6b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get oOc(){return!!this.vca}get b6b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get jka(){return CommonUIStrings.l_DefaultDialogTitle}sVe(C){this.Vmc(C)}ete(C){this.Vmc(C)}Vmc(C){let O=
10;this.vca&&1===C&&(this.vca(this.NP),O=1);this.uca&&this.uca(this.NP);this.No(O)}mib(){n.Redirect.showHelp("OICFailure");this.No(2)}hMe(){this.N4g.Qwg();this.No(4)}No(C){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.OAc,C);r.AFrameworkApplication.ykb(m.a.mfh,this.OAc,C)}dispose(){this.NP=this.uca=this.vca=null}}Object(K.a)(t,"AOICErrorDialog",null,[108]);var x=d(94),B=d(107);class D extends t{constructor(C,O,U,T){super(C,O,U,T);this.oPa=this.Zz=
null;C=document.createElement("span");C.id="errorMessageText";C.innerText=this.errorMessage;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.Zz=document.createElement("a");this.Zz.href="#";this.Zz.innerText=this.iVa;C.appendChild(this.Zz);x.a.addHandler(this.Zz,"click",Object(h.a)(this,this.mib,"oicErrorHelpLinkHandler"));O=new B.StandardDialog;O.ig=this.id;this.quc?(U=document.createElement("span"),T=document.createElement("span"),U.innerText=this.P4g,
T.innerText=this.O4g,this.oPa=document.createElement("a"),this.oPa.href="#",this.oPa.innerText=this.M4g,C.appendChild(document.createElement("br")),C.appendChild(U),C.appendChild(this.oPa),C.appendChild(T),x.a.addHandler(this.oPa,"click",Object(h.a)(this,this.hMe,"oicErrorMacOfferLinkHandler"))):this.oOc&&(C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),U=document.createElement("span"),U.innerText=this.a6b,C.appendChild(U));this.oOc?(O.Ad=1,O.Le(1,this.b6b)):
O.Ad=0;O.Tx(this.jka,null,this.icon,Object(h.a)(this,this.ete,"legacyOICErrorDialogHandler"),C);O.J6("errorMessageText")}dispose(){this.Zz&&(x.a.removeHandler(this.Zz,"click",Object(h.a)(this,this.mib,"oicErrorHelpLinkHandler")),this.Zz=null);this.oPa&&(x.a.removeHandler(this.oPa,"click",Object(h.a)(this,this.hMe,"oicErrorMacOfferLinkHandler")),this.oPa=null);super.dispose()}}Object(K.a)(D,"OICErrorDialog",t,[]);class w{constructor(C,O,U){this.uca=O;this.vca=C;this.NP=U}get id(){return"OICErrorDialogWithDownload"}get e_f(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get iVa(){return CommonUIStrings.l_OICErrorHelpLink}get a6b(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get b6b(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get jka(){return CommonUIStrings.l_DefaultDialogTitle}sVe(C){this.Vmc(C)}ete(C){this.Vmc(C)}Vmc(C){let O=
10;1===C&&(this.vca(this.NP),O=1);this.uca&&this.uca(this.NP);this.No(O)}mib(){n.Redirect.showHelp("OICFailure");this.No(2)}No(C){r.AFrameworkApplication.ykb(m.a.nfh,3,C)}dispose(){this.NP=this.vca=this.uca=null}}Object(K.a)(w,"AOICErrorDialogWithDownload",null,[108]);class J extends w{constructor(C,O,U){super(C,O,U);this.Zz=null;C=document.createElement("span");C.id="errorMessageText";C.innerText=this.e_f;C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));this.Zz=
document.createElement("a");this.Zz.href="#";this.Zz.innerText=this.iVa;C.appendChild(this.Zz);x.a.addHandler(this.Zz,"click",Object(h.a)(this,this.mib,"oicErrorHelpLinkHandler"));C.appendChild(document.createElement("br"));C.appendChild(document.createElement("br"));O=document.createElement("span");O.innerText=this.a6b;C.appendChild(O);O=new B.StandardDialog;O.ig=this.id;O.Ad=1;O.Le(1,this.b6b);O.Tx(this.jka,null,this.icon,Object(h.a)(this,this.ete,"legacyOICErrorDialogHandler"),C);O.J6("errorMessageText")}dispose(){this.Zz&&
(x.a.removeHandler(this.Zz,"click",Object(h.a)(this,this.mib,"oicErrorHelpLinkHandler")),this.Zz=null);super.dispose()}}Object(K.a)(J,"OICErrorDialogWithDownload",w,[]);var F=d(80);class L extends t{constructor(C,O,U,T){super(C,O,U,T);O={["errorMessage"]:this.errorMessage};O.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.iVa,["onExecute"]:ca=>{this.mib(ca)}};this.quc?(O.macOfficePreLinkText=this.P4g,O.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.M4g,
["onExecute"]:ca=>{this.hMe(ca)}},O.macOfficePostText=this.O4g):this.oOc&&(O.errorFileDownloadOffer=this.a6b);C=new F.a(!1,!1,!0);this.oOc?(C.Ad=1,C.Le(1,this.b6b)):C.Ad=0;C.ig=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};C.sj(this.jka,Object(h.a)(this,this.sVe,"reactOICErrorDialogHandler"),O)}}Object(K.a)(L,"ReactOICErrorDialog",t,[]);class M extends w{constructor(C,O,U){super(C,O,U);O={["errorMessage"]:this.e_f,["errorFileDownloadOffer"]:this.a6b};O.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.iVa,["onExecute"]:T=>{this.mib(T)}};C=new F.a(!1,!1,!0);C.Ad=1;C.Le(1,this.b6b);C.ig=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};C.sj(this.jka,Object(h.a)(this,this.sVe,"reactOICErrorDialogHandler"),O)}}Object(K.a)(M,"ReactOICErrorDialogWithDownload",w,[]);d.d(S,"a",function(){return Q});class Q{constructor(){this.Rqa=!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.mb.gD}WPi(C,O,U){this.Rqa?new L(C,O,null,U):new D(C,O,null,U)}XPi(C,
O,U){this.Rqa?new M(C,O,U):new J(C,O,U)}YPi(C,O,U,T,ca){const {ReactOICErrorDialogWithTrial:N}=d(1151),{OICErrorDialogWithTrial:da}=d(1152);this.Rqa?new N(C,O,U,null,T,ca):new da(C,O,U,null,T,ca)}static get instance(){return Q.La||(Q.La=new Q)}}Q.La=null;Object(K.a)(Q,"OICErrorDialogFactory",null,[1201])},1049:function(K,S,d){K=d(0);var h=d(395),e=d(1253),r=d(1254),m=d(1255),n=d(120),z=d(27),t=d(721),x=d(206),B=d(273),D=d(96),w=d(253),J=d(310),F=d(36),L=d(144),M=d(56),Q=d(47);class C{constructor(){this.cvFlights=
this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(K.a)(C,"CustomerVoiceSurveyParams",null,[]);var O=d(146),U=d(540);class T{sendTelemetryEvent(Y){const fa=new U.a;fa.otelEvent=Y;O.a.sendOtelEvent(fa)}}Object(K.a)(T,"OtelTelemetrySink",null,[1170]);class ca{constructor(){this.userFactName=this.props=this.dedupIntervalSeconds=null}}Object(K.a)(ca,"UserFactManifestParams",null,[]);var N=d(580);d.d(S,"a",function(){return da});class da{static init(Y,fa,aa,ka,H){H.onDismiss=Y;H.onError=
fa;Y=null;OfficeBrowserFeedback.initOptions?("screenshot"in H&&(OfficeBrowserFeedback.initOptions.screenshot=H.screenshot),"showEmailAddress"in H&&(OfficeBrowserFeedback.initOptions.showEmailAddress=H.showEmailAddress),"feedbackForumUrl"in H&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=H.feedbackForumUrl),Y=H):OfficeBrowserFeedback.initOptions=H;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=da.KRf());OfficeBrowserFeedback.multiFeedback(Y).then(()=>
{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(ra=>h.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+ra.toString()))}static rje(Y,fa,aa,ka){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(da.$pb===da.initialized)return Promise.resolve(1);if(da.$pb===da.cmg)return da.dmg||(da.dmg=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(da.$pb!==da.error){da.$pb=da.cmg;h.ULS.sendTraceTag(36546400,
356,50,"BFCOCV.InitSIFeedback:past init check");if(da.IQj(Y,fa,aa,ka))return z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",!1)?da.gQj(aa).then(()=>da.Flg()):da.Flg();da.$pb=da.error;Promise.reject(da.f9g)}return Promise.reject(0)}static Flg(){try{return t.a.x5k(da.Zmj(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>da.t5e())).catch(Y=>{let fa=10;Y&&Y.toString()&&L.a(Y.toString(),da.Rdk)&&(fa=15);h.ULS.sendTraceTag(36546402,
356,fa,"BFCOCV Floodgate initialize error:"+Y.toString())})}catch(Y){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+Y.toString()),Promise.reject(da.WDk)}}static Zmj(){return Object.assign(new N.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",vetoPillar:"OfficeBrowserFeedback"})}static t5e(){return OfficeBrowserFeedback.floodgate.start().then(()=>{da.Y9i()}).catch(Y=>{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+Y.toString())})}static Y9i(){da.$pb=
da.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const Y=z.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const fa of Y.split("|"))fa&&da.logActivity(fa,null)}catch(Y){h.ULS.sendTraceTag(539015366,356,50,"Error triggering test activity")}}static hva(){let Y=!1;const fa=z.AFrameworkApplication.fa;fa&&(Y="teams"===(fa.Ha(z.AFrameworkApplication.yK)||"").toLowerCase());return M.a.zGa||Y}static k9g(){return"undefined"==
typeof OfficeBrowserFeedback}static IQj(Y,fa,aa,ka){let H=!0;try{if(da.k9g())return h.ULS.sendTraceTag(39900617,356,15,da.f9g),!1;OfficeBrowserFeedback.initOptions||(aa.onDismiss=ka,aa.onError=fa,aa=da.goi(aa),OfficeBrowserFeedback.initOptions=aa);OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=da.KRf());const Ma=da.Zek;fa={};ka={};const Ga={};ka.onSurveyActivated=da.LMk;ka.onTeachingCampaignRender=aa.onTeachingCampaignRender;Ga.LogExperimentTrigger=
Ma;fa.onSurveyActivatedCallback=ka;fa.onDismiss=Y;fa.autoDismiss=aa.FloodgateUIAutoDismissTimeEnum;fa.telemetryGroup=aa.telemetryGroup;fa.uIStringGetter=aa.uIStringGetter;fa.authTokenCallback=aa.authTokenCallback;fa.augLoopCallback=aa.augLoopCallback;fa.campaignFlights="";fa.governanceServiceEnabled=aa.governanceServiceEnabled;fa.governanceServiceConfig=aa.governanceServiceConfig;fa.personalizerEnabled=aa.personalizerEnabled;fa.messagingServiceSettings=aa.messagingServiceSettings;fa.isPriorityEnabled=
aa.isPriorityEnabled;fa.enableWebCampaignGovernance=aa.enableWebCampaignGovernance;fa.logExperimentTrigger=Ga;fa.userFactsReadConfig=aa.userFactsReadConfig;z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.AppGovernanceProviderForSurveys",!1)&&z.AFrameworkApplication.uX&&(da.L1f.add(da.A7i),Y={},Y.getDecision=da.hij,fa.appGovernanceProvider=Y);z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&("surveyEnabled"in
aa&&(fa.surveyEnabled=aa.surveyEnabled),"showEmailAddress"in aa&&(fa.showEmailAddress=aa.showEmailAddress));fa.isEudbUxEnabled=!1;z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",!1)&&(fa.isEudbUxEnabled=!0);var ra=da.Mhj(aa);const na=da.h9f(ra);let wa=da.mij(aa);for(let Fa in na){ra=Fa;var ha=na[Fa];-1!==ra.toLowerCase().indexOf("flight")?fa.campaignFlights+=ha+";":wa=wa+ra+"="+ha+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+fa.campaignFlights+
" campaignQueryParameters: "+wa);fa.campaignQueryParameters=wa;fa.customerVoiceSurveyParams=da.$hj(aa.Application.toString(),da.hva()?da.qJl:"");OfficeBrowserFeedback.floodgate.initOptions=fa}catch(Ma){H=!1,h.ULS.sendTraceTag(39900618,356,15,Ma.toString())}return H}static hij(Y){if(Y=Y.getTags())for(const fa of Y)if(da.L1f.has(fa))return!0;return!1}static goi(Y){try{const fa=Y.applicationGroup?Y.applicationGroup:{},aa=fa.appData,ka=aa?F.a(F.a('"'+aa+'"')):{};ka.fgUIAutoDismiss=Y.FloodgateUIAutoDismissTimeEnum;
fa.appData=F.c(ka);Y.applicationGroup=fa}catch(fa){h.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",fa.toString())}return Y}static Mhj(Y){Y=Array.isArray(Y.Flights)?Y.Flights:null;Y||(Y=(Y=z.AFrameworkApplication.fa.Ha("FlightId"))?Y.toString().split(";"):null);if(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",!0)){const fa=z.AFrameworkApplication.fa.U6b;if(fa)for(let aa in fa){const ka={key:aa,value:fa[aa]};
-1!==(ka&&ka.key?ka.key.toLowerCase():"").indexOf("floodgateflight")&&"unset"!==(ka&&ka.value?ka.value.toString().toLowerCase():"")&&Y.push(ka.key)}}return Y}static h9f(Y){const fa={SelfTriggerActivity:""};if(!Y||!Y.length)return fa;try{for(let H=0;H<Y.length;H++){let ra=Y[H]?Y[H].toLowerCase():"";if(-1===ra.indexOf("floodgateflight"))continue;const ha=ra.lastIndexOf(".");-1!==ha&&(ra=ra.substring(ha+1,ra.length));if(-1!==("AppFlights"in fa?fa.AppFlights:"").indexOf(ra))continue;fa.AppFlights="AppFlights"in
fa?fa.AppFlights+(";"+ra):ra;const Ma=Q.a.replaceAll(ra,"-",""),Ga=z.AFrameworkApplication.fa.Ha(Ma);if(Ga)try{const na=F.a(Ga);na&&na.SelfTriggerActivity||(fa.SelfTriggerActivity+=";"+Ma);if(na)for(let wa in na){var aa=wa,ka=na[wa];aa in fa?fa[aa]!==ka&&(fa[aa]=fa[aa]+";"+ka):fa[aa]=ka}}catch(na){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+Ma+" json data",na.toString())}else fa.SelfTriggerActivity+=";"+Ma}}catch(H){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",
H.toString())}return fa}static mij(Y){let fa="";const aa={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let ra in aa){var ka=ra,H=aa[ra];let ha=Y[Object(e.a)(String,H)];ha||(ha=z.AFrameworkApplication.fa.Ha(Object(e.a)(String,H)));ha&&(fa+=ka+"="+encodeURIComponent(ha)+"&")}return fa}static Qol(Y){da.C3d=Y}static LMk(Y,fa,aa){if(Y)try{const H=fa?fa.getCampaignId():"",ra=fa?fa.getLauncherType():"",ha=aa?aa.contextInfo:null;var ka=fa?fa.getSurveyInfo():
null;const Ma=ka?ka.getPreferredLaunchType():null,Ga=ka?ka.getMetadata():null,na=Ga?Ga.getContentMetadata():null,wa=na?na.customSurveyName:null,Fa=na?na.telemetryEventName:null;da.EXj(H)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+H):(z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.AppGovernanceProviderForSurveys",!1)&&z.AFrameworkApplication.uX&&h.ULS.sendTraceTag(512312960,356,50,"BFCOCV.onSurveyActivated Initiated survey activation for campaign - {0} during Live session",
H),ka={},ka.campaignId=H,ka.surveyName=wa,ka.launcherType=ra,ka.contextInfoLength=ha?ha.length.toString():"-1",ka.preferredLaunchType=Ma,ka.telemetryEventName=Fa,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ka)),ra&&"coachingux"===ra.toLowerCase()&&Ma&&"default"!==Ma.toLowerCase()&&da.fig(na,fa,aa)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ka)):(Y.launch(aa),da.FBh()))}catch(H){h.ULS.sendTraceTag(555071514,
356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(H?H.toString():""))}else h.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")}static tbe(Y){if(!Y||z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const fa=(z.AFrameworkApplication.fa.Ha("FlightId")||"").toLocaleLowerCase(),aa=Y.toString().toLocaleLowerCase().split(";");for(const ka of aa)if(-1!==fa.indexOf(ka))return ka}catch(fa){h.ULS.sendTraceTag(508961430,
306,50,"Error retrieving flightId of campaign event -"+(fa?fa.toString():""))}return null}static Zek(Y){for(const fa of Y){Y=fa.eventInfo;if(fa.triggerEvent){const aa=da.tbe(fa.triggerEvent);aa&&(Y.flightId=aa);z.AFrameworkApplication.Oea(fa.triggerEvent)}h.ULS.sendTraceTag(509100380,306,50,"Web Campaign UI launched. "+JSON.stringify(Y))}}static LJj(Y){Y=Y?Y.surfaceContext:null;if(!Y||!Y.surveyForm)return h.ULS.sendTraceTag(555071516,356,10,"Missing activation arguments"),!1;try{const fa=Y.surveyForm.getSurveyInfo(),
aa=fa?fa.getMetadata():null,ka=aa?aa.getContentMetadata():null;return da.fig(ka,Y.surveyForm,Y.surveyParams)}catch(fa){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(fa?fa.toString():""))}return!1}static fig(Y,fa,aa){if(!Y||!Y.customSurveyName||!fa)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(Y?Y.customSurveyName:null)),!1;const ka=fa.getCampaignId();if(Y.telemetryEventName){var H={["action"]:"Opened",["id"]:ka,["success"]:"true",["triggerType"]:"custom",
["customSurveyName"]:Y.customSurveyName,["telemetryEventName"]:Y.telemetryEventName};da.C3d?da.C3d(Y.telemetryEventName,H):(z.AFrameworkApplication.uk(Y.telemetryEventName),z.AFrameworkApplication.Bdb(Y.telemetryEventName),h.ULS.sendTraceTag(512505554,356,50,"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(H)))}H=da.syf.Gb(Y.customSurveyName)?da.syf.ga(Y.customSurveyName):null;if(!H)return h.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+Y.customSurveyName+", "+ka),
!1;(Y=H(fa,aa))&&Y.then(ra=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(ra))}).catch(ra=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(ra?ra.toString():""))});return!0}static EXj(Y){try{return-1!==z.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((Y||"").toLowerCase())}catch(fa){h.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+
Y)}return!1}static logActivity(Y,fa=null){if(da.SZd(Y,"LogActivity")){var aa=da.ube();aa&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+Y),aa.logActivity(Y,1,fa))}}static hmb(Y){Y?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(Y),da.FBh()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static FBh(){da.Wra(da.r3f)}static NRj(Y,fa,aa){var ka=[3,2,5,1];const H=D.FocusManager.instance(),
ra=H.Ic(Y);ra.parent=n.AFrame.$i;ra.zJ=!0;B.a.instance.r3(Y,!0);fa&&ra.Oca(fa);if(aa){w.a.instance.l8(Y,aa,!1,!0);J.a.instance.l8(Y,aa,!1,!0);Y=new x.DOMFocusListing(()=>aa);for(fa=0;fa<ka.length;++fa)Y.So(ka[fa]);H.Aja(()=>aa,ra,Y).GX=!0}}static Wra(Y){const fa=document.getElementById(Y);fa?da.NRj(Y,da.xHk,fa):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+Y)}static xHk(Y,fa){h.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(Y?Y.name:"")+" NextScopeName "+
(fa?fa.name:""));fa&&(Y=D.FocusManager.instance().LQ(fa.name))&&Y.Ihd()}static Vdc(Y){if(da.SZd(Y,"LogActivityStart")){var fa=da.ube();fa&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+Y),fa.logActivityStartTime(Y))}}static Vxg(Y){if(da.SZd(Y,"LogActivityEnd")){var fa=da.ube();fa&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+Y),fa.logActivityStopTime(Y,new Date))}}static Z9i(){OfficeBrowserFeedback.floodgate.start()}static $9i(){OfficeBrowserFeedback.floodgate.stop()}static gQj(Y){try{const fa=
Y.telemetryGroup,aa=new Map;aa.set("Agent",da.A_i);aa.set("Platform","Web");aa.set("Host",Y.Host||"");aa.set("Audience",fa.audienceGroup||"");aa.set("TenantId",fa.tenantId||"");z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestEnabled",!1)&&(z.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignTestAudience","Dogfood"),aa.set("Audience","Dogfood"),aa.set("SurveyValidation","true"));const ka=
{};ka.appName=Y.Application||"";ka.language=Y.locale||"";ka.appVersion=fa.officeBuild||"";ka.host=da.z_i;ka.filters=aa;ka.localStorageProvider=OfficeBrowserFeedback.floodgate.getStorageProvider();const H=new FloodgateDynamicCampaign.Client(ka);H.telemetryEvents.subscribe((ra,ha)=>{h.ULS.sendTraceTag(508912419,356,50,"Floodgate Ecs Telemetry Event: "+ra+", details: "+JSON.stringify(ha))});return H.start().then(()=>{const ra={enabled:!0};ra.ecsClient=H;OfficeBrowserFeedback.floodgate.initOptions.dynamicCampaignConfig=
ra}).catch(ra=>{h.ULS.sendTraceTag(508912418,356,10,"EcsClient starts with Error: "+(ra?ra.toString():""))})}catch(fa){return h.ULS.sendTraceTag(508912417,356,15,"Initialized EcsClient failed with error: "+fa.toString()),Promise.resolve(0)}}static SZd(Y,fa){Y||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+fa);return!!Y}static ube(){let Y=null;const fa=OfficeBrowserFeedback.floodgate.getEngine();fa?(Y=fa.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):
da.Q8g||(da.Q8g=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));return Y}static KRf(){return new T}static $hj(Y,fa){return Object.assign(new C,{productName:Y,uiHost:fa,cvFlights:"",isCVSurveyEnabled:!0})}static Bfe(Y){return Object.assign(new ca,{dedupIntervalSeconds:86400,props:[],userFactName:Y})}}da.r3f="obf-ToastContainer";da.notInitialized=0;da.cmg=1;da.initialized=2;da.error=-1;da.$pb=da.notInitialized;da.Q8g=!1;da.dmg=!1;da.Rdk="window.localStorage is not available";
da.f9g="OFB still undefined";da.WDk="OFB Floodgate is undefined or does not contain initialize function";da.qJl="Teams";da.A7i="Live";da.z_i="https://config.edge.skype.com";da.A_i="ChillWAC";da.L1f=new Set;da.syf=new r.a(m.a.Gk());da.C3d=null;Object(K.a)(da,"BrowserFeedbackControlOCV",null,[])},1051:function(K,S,d){K=d(0);class h{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(K.a)(h,"DocumentContentSearchResults",null,[]);class e{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(M,
Q,C,O,U){this.selectRange(Q,C,O,U)}selectRangeV3(){}search(){}searchV2(M,Q){this.search(M,C=>{Q(Object.assign(new h,{results:C,totalResultCount:C.length,hasTooManyResults:100<C.length}))})}searchWithParam(M,Q){this.search(M.query,Q)}searchWithParamV2(M,Q){this.searchWithParam(M,C=>{Q(Object.assign(new h,{results:C,totalResultCount:C.length,hasTooManyResults:C.length>M.totalResultLimit}))})}highlight(){}highlightWithParam(M){this.highlight(M.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(K.a)(e,"BaseDocumentContentExecutor",null,[1130,1173]);class r{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(K.a)(r,"DocumentContentSearchResult",null,[]);var m=d(103),n=d(27),z=d(47),t=d(18),x=d(75),B=d(34),D=d(51),w=d(395),J=d(691),F=d(30);d.d(S,"a",function(){return L});class L extends e{constructor(M,
Q,C,O,U,T,ca,N,da,Y,fa){super();if(!M)throw Error("pageNode is null");if(!Q)throw Error("interactiveViewManager is null");if(!C)throw Error("selectionFactory is null");if(!O)throw Error("slideReader is null");if(!U)throw Error("workspace is null");if(!T)throw Error("graphTopologyManager is null");if(!ca)throw Error("searchContextFactory is null");if(!N)throw Error("actionManager is null");if(!da)throw Error("selectionManager is null");if(!Y)throw Error("clipServiceManager is null");if(!fa)throw Error("presentationReader is null");
this.Aqk=M;this.zA=Q;this.xed=C;this.lc=O;this.Ub=U;this.ua=T;this.Qtk=ca;this.ia=N;this.pa=da;this.FO=Y;this.ic=fa}getAllParagraphsInDocument(){const M=this.nde(),Q=new t.a;for(let C of M)Q.add(L.kde(C));return Q.toArray()}selectRange(M,Q,C,O){if(!(0>M||0>Q||0>C||0>O||M>C||M===C&&Q>O)){var U=this.nde();U.count<=C||(M=U.ga(M),C=U.ga(C),L.pvg(M,Q)&&L.pvg(C,O)&&(U=this.lc.jg(M),this.ua.Ba!==U&&this.Ub.vyh(U),Q=this.xed.Qg(M,Q),O=this.xed.aO(Q,D.a.Oj(C,O+1)),this.zA.V1e(this.Ub.jL,O)))}}search(M,Q){const C=
new t.a,O=M.toLowerCase();var U=this.nde();let T=0;for(let N of U){U=L.kde(N);const da=U.toLowerCase();let Y=0;for(;-1<(Y=da.indexOf(O,Y));){var ca=this.Qtk.nRi(U,Y,Y+M.length);ca=Object.assign(new r,{snippet:ca.IKi,startOffsetInSnippet:ca.ghl,endOffsetInSnippet:ca.dhl-1,paragraphIndex:T,startOffsetInParagraph:Y,endOffsetInParagraph:Y+M.length-1});C.add(ca);Y+=M.length}T++}C.Sc((N,da)=>N.paragraphIndex===da.paragraphIndex?N.startOffsetInParagraph-da.startOffsetInParagraph:N.paragraphIndex-da.paragraphIndex);
Q(C.toArray())}getSelectedSlidesAsPPTXStream(){const M=this.pa.Re();if(M&&M.length)return this.d7f(M);w.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const M=this.ic.vdg();if(M&&M.length)return this.d7f(M);w.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}d7f(M){var Q=this.FO.VOc(1,M.length,!1),C=m.a.create().toString();C=
new J.a(Q,C,M);var O=8;O=this.ia.Ja(F.a.t1d,2,C);Q.MW=O;C=n.AFrameworkApplication.fa.Ha("361");O=z.a.Ne(Q.Kp);const U=z.a.Ne(Q.OD);Q=z.a.Ne(Q.Py);if(O&&U&&Q)return{url:`${C}GetClipboardBytes.ashx?Id=${O}&DC=${U}&pkey=${Q}&wdwaccluster=${U}&DataType=${1}`,selectedSlideIDs:M.map(T=>T.id.toString())}}nde(){var M=B.ParagraphReader.xXc(this.Aqk.value,!0,!1);const Q=new t.a;for(let C of M)M=this.lc.jg(C),M.pO||M.gCb||Q.add(C);return Q}static kde(M){M=B.ParagraphReader.text(M);return x.AParagraphNode.Zpd(M,
" ")}static pvg(M,Q){M=L.kde(M);return Q<M.length}}Object(K.a)(L,"PPTDocumentContentExecutor",e,[])},1057:function(K,S,d){K=d(0);var h=d(358),e=d(541);class r extends e.a{constructor(D,w=null,J=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=w;this.messageText=D;this.isDeferred=J}}Object(K.a)(r,"DeferredContentProps",e.a,[]);var m=d(28),n=d(945),z=d(946);const t=(D,w)=>Object.assign(new n.a,{target:".EditingRibbonPanel",content:D,useTeachingStyles:!1,
showCloseIcon:!0,calloutProps:Object.assign(new z.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:w,preventDismissOnResize:!0})});var x=d(48);d.d(S,"a",function(){return B});class B{constructor(){this.tU=new r(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}oYi(D,w,J,F){F=Object.assign(new h.a,{onShow:()=>{J.hL(x.a.O1a)}});w=D.callout(w);return F=D.addNotification(w,F)}b$k(D,w){D.removeNotification(w);
m.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");return w}nQi(D){return t(this.tU,()=>{D.Eo(x.a.O1a)})}}Object(K.a)(B,"DownloadACopyDeferred",null,[540])},1058:function(K,S,d){K=d(0);var h=d(591),e=d(1253),r=d(294),m=d(510);class n{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(K.a)(n,"CT_LineJoinMiterProperties",null,[]);var z=d(979);class t{constructor(){this.valField=0}}Object(K.a)(t,"CT_PositiveFixedPercentage",null,[]);var x=d(980),B=d(374),D=d(327),w=d(295);
d.d(S,"a",function(){return J});class J{Rcg(F,L,M,Q,C,O){F=Object(e.a)(424,O.Ba.rg(C.Na));M=C.Nd;C=Math.round(Q.tK(M.Pe(L.width*h.a.yD,0),F.$T));L=Math.round(Q.tK(M.Pe(L.height*h.a.yD,1),F.$T));return{XBh:C,PBh:L}}xQf(F,L){return Object.assign(new r.a,{TopLeft:Object.assign(new w.a,{X:0,Y:0}),TopRight:Object.assign(new w.a,{X:F,Y:0}),BottomLeft:Object.assign(new w.a,{X:0,Y:L}),BottomRight:Object.assign(new w.a,{X:F,Y:L})})}Fzh(F){F.lineStyle=Object.assign(new z.a,{algnField:0,algnFieldSpecified:!0,
capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new n,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new x.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new D.a,{schemeClrField:Object.assign(new B.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}Qzh(F){F.fill=Object.assign(new m.a,{solidFillField:Object.assign(new D.a,{schemeClrField:Object.assign(new B.a,{valField:4})})});F.lineStyle=Object.assign(new z.a,{algnField:0,
algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new n,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new x.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new D.a,{schemeClrField:this.mRi(Object.assign(new t,{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}mRi(F){const L={itemsElementNameField:[26]};L.itemsField=[F];L.valField=4;return L}}Object(K.a)(J,"InsertShapeActorHelper",null,[557])},1068:function(K,
S,d){K=d(0);var h=d(7),e=d(1252),r=d(27),m=d(67),n=d(82);class z{constructor(x,B,D,w=null){this.origin=x;this.data=B;this.source=D;this.nc=w}}Object(K.a)(z,"MessageEventArgs",null,[]);d.d(S,"a",function(){return t});class t{constructor(x,B){this.zSd=null;this.Bci=x;this.ae=B;this.qEc=null}get $mb(){return this.Bci.value}get taskManager(){return this.ae.value}Sqi(x){this.qEc=x;this.zSd=Object(h.a)(this,this.NUk,"postMessageEventHandler");this.$mb.addHandler(m.a.message,this.zSd,null)}EWi(){this.qEc=
null;this.$mb.removeHandler(m.a.message,this.zSd)}T0c(x,B){const D=new n.a(0,1,1,()=>{x(B)},7);this.taskManager.Hb(D)}nVj(x,B){const D=new n.a(0,1,1,()=>{x(B)},7);this.taskManager.Hb(D)}NUk(x){return this.qEc?this.qEc(new z(x.origin,x.data,x.source,x.nc)):!1}static get instance(){return t.J$a()}static J$a(){return new t(new e.a(()=>r.AFrameworkApplication.$mb),new e.a(()=>r.AFrameworkApplication.De))}}Object(K.a)(t,"MessageEventHandler",null,[536])},1071:function(K,S,d){K=d(0);var h=d(395),e=d(106),
r=d(272),m=d(7),n=d(1253),z=d(36);class t{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(K.a)(t,"CritiqueTypeOption",null,[]);var x=d(3);d.d(S,"a",function(){return B});class B{constructor(D,w,J){this.xPd={};this.ol=null;this.Dtf=D;this.d9h=w;this.e9h=J;this.w5a=x.Task.ut({})}init(){this.w5a=this.Dtf.Dfe(this.d9h,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(m.a)(this,this.dJk,"onLoadSettingsTaskFinished"),8)}GMl(D){const w={};if(!(D&&"ProofingSettingLanguageList"in
D))return w;const J=Array.isArray(z.a(D.ProofingSettingLanguageList))?z.a(D.ProofingSettingLanguageList):null;for(const F of J)"ProofingSettings"+F in D&&(w[F]=Object(n.a)(Object,z.a(D["ProofingSettings"+F])));return w}HMl(D){const w={},J=[];for(let M in D){var F=M,L=D[M];L&&(J.push(F),w["ProofingSettings"+F]=z.c(L))}w.ProofingSettingLanguageList=z.c(J);return w}saveSettings(D){this.w5a=x.Task.ut(D);this.ol=null;try{const w=this.HMl(D);this.Dtf.hBh(this.e9h,w).continueWith(Object(m.a)(this,this.uLk,
"onSaveSettingsTaskFinished"),8)}catch(w){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",w.toString())}}Cae(){if(!this.ol){if(6!==this.w5a.status)return[];try{var D=this.w5a.result;let L;if(e.a.isEmpty(this.xPd))L=D;else if(e.a.isEmpty(D))L=this.xPd;else{L={};var w=this.xPd;for(let M in w)L[M]=e.a.Vtc(w[M]);L=B.merge(L,D)}this.ol=[];for(let M in L){var J=L[M];const Q=r.a.He(parseInt(M));if(!Q)continue;const C=Q.name;w=J;for(let O in w){D=O;var F=w[O];const U=Object.assign(new t,
{LanguageId:C,Id:D,Value:F.toString()});this.ol.push(U)}}}catch(L){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",L.toString())}}return this.ol}MXi(D,w){const J=this.w5a.result;if(J)try{let F=J[D];F||(F={});F[w]=!1;J[D]=F;this.saveSettings(J)}catch(F){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",F.toString())}}dJk(D){if(D.Hm)return h.ULS.sendTraceTag(34964619,375,10,"Load setting failed with exception {0}",D.hj),null;if(6===
D.status)try{return this.GMl(D.result)}catch(w){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",w.toString())}return null}uLk(D){D.Hm&&h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",D.hj)}static merge(D,w){D=D||{};if(w)for(let L in w){var J=L,F=w[L];D[J]=D[J]||{};for(let M in F)D[J][M]=F[M]}return D}}Object(K.a)(B,"CritiqueTypeSettings",null,[1009])},1074:function(K,S,d){K=d(0);var h=d(27),e=d(141),r=d(77),m=d(1261),n=d(199),z=d(47),t=d(162),x=d(28),
B=d(449),D=d(389);class w{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(K.a)(w,"ImagePasteArgs",null,[]);var J=d(333),F=d(43),L=d(49),M=d(30);d.d(S,"a",function(){return Q});class Q{constructor(C,O,U,T,ca,N,da,Y,fa,aa,ka,H){this.ia=C;this.Fa=O;this.xIa=U;this.pa=T;this.gxk=ca;this.Zo=N;this.pma=da;this.af=aa;this.QB=ka;this.Dc=H;this.Jhc=Y;this.yad=fa;this.Qed=!1;this.vic=-1}FQ(C){if(!this.xIa.Uac(this.Fa)||!C)return!1;if(C.$Sc&&C.Cie)return this.Qed=
!1,C.FQ=this.Jhc;if(!C.kn||0<C.kn.getElementsByTagName(L.a.Ikg).length)return!1;this.Qed=!this.ohe(C)&&this.n7j(this.pa.Ud());C.FQ=this.Qed?this.yad:this.Jhc;return C.FQ}n7j(C){return 1===C.length?C[0].D8j:!1}BYk(C,O){this.Okh(C,O,0);if(!C.firstChild||!C.firstChild.className||!B.a.Png(C.firstChild.className))if(!this.Zo.mg||"<br>"!==C.innerHTML){const U=t.b(C);U&&0<U.length&&(O.zV=C.innerHTML)}}Okh(C,O,U){if(C){if(U>=Q.WLc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",Q.WLc));
if(1===C.nodeType){var T=C.tagName.toLowerCase();if(this.pma.o5j(T))C.parentNode.removeChild(C);else{for(let N=C.firstChild;N;N=ca){var ca=N.nextSibling;this.Okh(N,O,U+1)}T===L.a.z4?(C.parentNode.removeChild(C),this.CYk(C,O)):T===L.a.Pmb?(C.parentNode.removeChild(C),this.hZk(C,O)):T===L.a.listTag&&this.IYk(C);h.AFrameworkApplication.fa.ka("EnhancedTextCCPEnabled")&&this.KTl(C);O.icc&&this.ual(C);O.jcc&&this.tal(C);this.Dc.G1e(C,O.Wb)}}}}KTl(C){(C=C.style)&&C.G7e&&(C.textDecoration=C.G7e)}tal(C){const O=
C.style;O&&(O.fontFamily&&(O.fontFamily=""),O.fontSize&&(O.fontSize=""),O.color&&(O.color=""),C.getAttribute&&C.getAttribute("data-scheme-color")&&C.setAttribute("data-scheme-color",""),O.backgroundColor&&(O.backgroundColor=""),O.backgroundImage&&C.className&&-1<C.className.indexOf("Highlight")&&(O.backgroundImage=""))}ual(C){const O=C.style;O&&(O.fontWeight&&(O.fontWeight=""),O.fontStyle&&(O.fontStyle=""),O.textDecoration&&(O.textDecoration=""),O.G7e&&(O.G7e=""),O.verticalAlign&&(O.verticalAlign=
""),O.fontFamily&&(O.fontFamily=""),O.fontSize&&(O.fontSize=""),O.color&&(O.color=""),C.getAttribute&&C.getAttribute("data-scheme-color")&&C.setAttribute("data-scheme-color",""),O.backgroundColor&&(O.backgroundColor=""),O.backgroundImage&&C.className&&-1<C.className.indexOf("Highlight")&&(O.backgroundImage=""))}IYk(C){if(C){var O=C.getAttribute("data-"+e.a.I0b);if(O&&0<O.length&&C.style){var U=parseInt(O);if(1!==O.length||isNaN(U)||1>U||U>J.a.A8)O="1",U=1;U>this.vic&&(this.vic=U);O=String.format(L.a.eck,
O);(U=C.style.cssText)?C.setAttribute("style",O+U):C.setAttribute("style",O)}if((O=C.parentNode)&&!this.af.f2j(O.tagName)){U=C.nextSibling;const T=this.af.W3b();T.appendChild(C);O.insertBefore(T,U)}}}CYk(C,O){if(C&&C.src&&C.src.length){var U=window.location.href.toLowerCase();U=r.a.KQ(U);if(C.src.startsWith(U))x.a.J(509153345,826,50,"Pasted image src is an empty string.");else{U=Math.ceil(m.a.Pe(this.pma.jmj(C),0,!1));var T=Math.ceil(m.a.Pe(this.pma.bmj(C),1,!1));O.lea.push(Object.assign(new w,{src:C.src,
alt:C.alt,width:U?U:C.width,height:T?T:C.height}))}}}hZk(C,O){C&&C.innerHTML&&C.rows&&C.rows.length&&(C.getElementsByTagName(L.a.Uwd).length||C.getElementsByTagName(L.a.BIl).length)&&(C=t.c(C),!C||0>=C.length||O.w2a.push(C))}ohe(C){if(C.$Sc)return!0;const O=C.kn.getElementsByTagName(L.a.Pmb).length;return 0<C.kn.getElementsByTagName(L.a.z4).length||0<O}paste(C){if(h.AFrameworkApplication.dR)this.gxk.Ruc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const O=Object.assign(new D.a,
{Wb:C.Wb});let U=!0;O.Wlb=this.Qed;h.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&(O.Dog=C.L7d,O.icc=C.l6b&&!this.ohe(C)&&""!==C.kn.innerText,O.jcc=h.AFrameworkApplication.fa.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&C.m6b&&!this.ohe(C));if(C.$Sc)O.lea.push(Object.assign(new w,{src:C.Cie,width:0,height:0}));else try{this.BYk(C.kn,O),0<this.vic&&(x.a.J(509153315,826,50,String.format("max list level pasted into new shape = {0}.",this.vic-1)),this.vic=-1)}catch(T){U=!1,x.a.J(509153314,
826,15,T.message)}U&&(this.Owl(O)?this.URk(O):this.ia.Ja(M.a.Doa,2,O))}}Owl(C){return n.a.Xa(C.w2a)&&z.a.Xa(C.zV)&&!!C.lea&&1===C.lea.length&&this.z9j(C.lea[0].src)}z9j(C){if(z.a.Xa(C)||!C.startsWith("data:image"))return!1;C=C.split(";");if(!C||2!==C.length)return!1;C=C[0].replace("/",".");return 0===this.QB.qAd(C,!0)}URk(C){let O=new Image;const U=C.lea[0],T=F.a.Kb;if(U.width&&U.height)C.n3c=!0,this.ia.Ja(M.a.Doa,2,C);else{const ca=new Date;O.onload=()=>{C.aQe=+new Date-+ca;U.width=O.width;U.height=
O.height;C.n3c=!0;O=null;F.a.qy(T,()=>{this.ia.Ja(M.a.Doa,2,C)})};O.onerror=()=>{O=null;F.a.qy(T,()=>{this.ia.Ja(M.a.Doa,2,C)})};O.src=U.src}}}Q.WLc=100;Object(K.a)(Q,"HtmlPasteHandler",null,[484])},1075:function(K,S,d){K=d(0);var h=d(18),e=d(27),r=d(1258),m=d(251),n=d(39);class z{constructor(D,w){this.actionId=D;this.vd=w}}Object(K.a)(z,"CommandActionData",null,[]);var t=d(30),x=d(33);d.d(S,"a",function(){return B});class B{constructor(D,w,J,F,L){this.C3g=[];this.zsg=!1;this.zec=null;this.A7c=new h.a;
this.ia=D;this.UFe=w;this.Dyf=!1;this.Tb=J;this.BH=F;this.baa=L;this.qAg=this.aGb=null;Object(x.a)("EnhancementOfSDXPaneBootTime")&&this.SPj()}SPj(){this.aGb||(this.aGb=e.AFrameworkApplication.Ji("officeExtensionMerge.js",5));this.qAg||(this.qAg=e.AFrameworkApplication.Ji("appforoffice.hermes"+this.BH.pse,1));if(!this.zec){const D=[this.baa.Pvb(this.gMe)];this.zec=r.a.create("pptedit.appforoffice",D,()=>d.e(7).then(d.bind(null,1297)))}}get Wyd(){return this.C3g}get gMe(){this.aGb||(this.aGb=e.AFrameworkApplication.Ji("officeExtensionMerge.js",
5));return this.aGb}set gMe(D){this.aGb=D}get Uni(){if(!this.zec){const D=[this.baa.Pvb(this.gMe)];this.zec=r.a.create("pptedit.appforoffice",D,()=>d.e(7).then(d.bind(null,1297)))}return this.zec}Cgi(D){this.Wyd.push(D)}Fja(){this.zsg||(m.a.py(this.Uni),this.zsg=!0)}qNl(){for(const D of this.Wyd)D.$lb();this.C3g=[]}rNl(){var D=this.Tb.Lc(this.UFe.Gf).Db(18);D=this.Tb.Lc(D);let w=D.Db(19);if(w){do w=D.Dq,this.ia.Ja(t.a.tkb,2,w.eb(n.a.q_));while(D.Hf(19))}}FQa(D,w){this.A7c.add(new z(D,w))}QDj(){if(0<
this.A7c.count){for(let D of this.A7c)this.ia.Ja(D.actionId,2,D.vd);this.A7c.clear()}}ahe(){const D=!!this.Wyd&&0<this.Wyd.length;let w=!1;if(this.UFe.Gf&&!D){const J=this.Tb.Lc(this.UFe.Gf).Db(18);J&&0<this.Tb.Lc(J).d9(19)&&(w=!0)}return D||w}}Object(K.a)(B,"AppForOfficeManagerFactory",null,[530])},1076:function(K,S,d){K=d(0);var h=d(47);class e{constructor(m,n){this.Bnk=m;this.Pbd=n}get QVa(){return this.Bnk}get message(){return this.Pbd}}Object(K.a)(e,"CalloutNotificationError",null,[]);d.d(S,
"a",function(){return r});class r{constructor(m,n){this.nBg=m;this.Btk=n}kba(m,n,z,t,x,B,D,w,J,F,L,M,Q,C){this.nBg.show(this.Btk,null,!1,J,F,m,n,z,x,t,B,D,w,L,M,Q,C)}W4d(){this.nBg.dismiss()}kEh(m){if(!m)throw Error.argumentNull("CalloutNotificationMessageAttributes");const n=this.zXl(m);if(n&&n.QVa)return n;this.kba(m.title,m.message,m.ajg,m.TKb,m.fjg,m.asd,m.OXk,m.Kkl,m.PXk,m.Lkl,!!m.timeoutInSeconds,m.timeoutInSeconds,m.UKj,m.CNj);return new e(!1,null)}zXl(m){return h.a.Xa(m.title)?new e(!0,"Invalid Title"):
h.a.Xa(m.message)?new e(!0,"Invalid Message"):m.ajg&&h.a.Xa(m.TKb)?new e(!0,"Missing PrimaryButtonLabel"):m.fjg&&h.a.Xa(m.asd)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(K.a)(r,"CalloutNotificationAdapter",null,[447])},1077:function(K,S,d){K=d(0);var h=d(27),e=d(748),r=d(233);class m extends e.a{constructor(z,t){super(z);this.Rik=t}wLh(z){return r.i(r.g(z))}o8e(z){return r.i(z)}Fwc(z){return this.Rik?z.Asi:z.Fwc().toString()}fwi(z,t,x){const B=new Sys.StringBuilder;B.append(String.format('<Menu Id="{0}">',
"menuFontColor"));B.append(this.Qfe(z,t,x));B.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');B.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",h.AFrameworkApplication.km,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));B.append("</Controls> </MenuSection>");B.append("</Menu>");return B.toString()}}Object(K.a)(m,
"ColorMenuBuilder",e.a,[]);d.d(S,"a",function(){return n});class n{fgj(z){return new e.a(z)}l7f(z,t){return new m(z,t)}}Object(K.a)(n,"ColorPickerBuilderFactory",null,[465])},1078:function(K,S,d){var h=d(134);K=d(0);var e=d(103),r=d(1288),m;(function(M){M[M.unattempted=0]="unattempted";M[M.inProgress=1]="inProgress";M[M.notHandled=2]="notHandled";M[M.handleExternally=4]="handleExternally";M[M.failed=8]="failed";M[M.error=16]="error";M[M.succeeded=32]="succeeded";M[M.delayed=64]="delayed"})(m||(m=
{}));Object(K.b)("ActionResponse",m);var n=d(39),z=d(281),t=d(351),x=d(693),B=d(152),D=d(340),w=d(1253),J=d(30),F=d(389);d.d(S,"a",function(){return L});class L{constructor(M,Q,C,O,U,T,ca,N,da,Y,fa){this.ua=M;this.pa=Q;this.kj=C;this.Fa=O;this.wk=U;this.Rq=T;this.r1=ca;this.qf=N;this.ia=da;this.sr=Y;this.sIa=fa;this.select=({scope:aa,index:ka=-1})=>Object(h.a)(this,void 0,void 0,function*(){let H=[],ra=[];var ha=null!==aa&&void 0!==aa?aa:"Selection";if("Selection"===ha){var Ma=this.pa.zn();Ma?ra.push(Ma):
(Ma=this.pa.Re(),0<Ma.length&&this.sIa.pNb(14,Ma,H),0!=H.length||aa||(ha="Presentation"))}if(Array.isArray(ha)&&0<ha.length&&ha[0]instanceof z.a)this.sIa.pNb(14,ha,H);else if("Presentation"===ha&&this.ua.presentation){ha=this.ua.presentation.slides;if(null===ha)throw Error("Could not cast from ISlide to ISlide on presentation slides");this.sIa.pNb(14,ha,H)}ra.push(...H.map(Ga=>Ga.node));return-1!==ka&&ka<ra.length?[ra[ka]]:ra});this.format=({tables:aa,color:ka,fillColor:H,styles:ra,cellColor:ha,border:Ma,
borderColor:Ga,mergeCells:na,splitCells:wa})=>Object(h.a)(this,void 0,void 0,function*(){var Fa;let pa=!1;var Ea=!1,ta=!1;const ia=[];for(const ab of aa){let Oa=this.pa.Fv();1===aa.length&&Oa&&0<Oa.length?pa=!0:Oa=ab.Kab();Oa.filter(Za=>!Za.isGhostCell);var Ja=this.hxj(null!==(Fa=null!==ra&&void 0!==ra?ra:H)&&void 0!==Fa?Fa:ka);Ja&&0<Ja.length&&ab.setValue(n.a.Mza,e.a.Kf(Ja));if(ha&&x.a.fKf(ha)&&!Ea){Ea=this.Dee(ha);for(const Za of Oa)Ja=Za.cellShading,t.b(Ja),Ja.solidFillField=Ea,Za.cellShading=
Ja;Ea=pa&&1===aa.length}if((Ma||Ga)&&!ta){if(Ma)ta=Ga&&x.a.fKf(Ga)?this.Dee(Ga):void 0,this.ia.Ja(J.a.Opa,r.a.execute,{["TableNode"]:ab,["CellNodes"]:Oa,["SourceControlId"]:this.O$a(Ma),["BorderColor"]:ta,["DoNotCreateTransaction"]:!0});else{ta=x.a.TRa(Ga);this.ia.Ja(J.a.xMa,r.a.execute,{["TableNode"]:ab,["Color"]:ta});ta=this.Dee(Ga);for(const Za of Oa)B.Box4ColorHelper.dcb(Za.zMa)||(Za.zMa=ta),B.Box4ColorHelper.dcb(Za.dha)||(Za.dha=ta),B.Box4ColorHelper.dcb(Za.yMa)||(Za.yMa=ta),B.Box4ColorHelper.dcb(Za.eha)||
(Za.eha=ta)}ta=pa&&1===aa.length}(na||wa)&&pa&&this.ia.Ja(na?J.a.mergeTableCells:J.a.splitTableCells,r.a.execute,{["rows"]:1,["columns"]:2});ia.push(new Promise(Za=>D.a.r9(Za,ab,!0).bind(this)))}yield Promise.all(ia)});this.jUj=aa=>{aa=Object.assign(new F.a,{Wlb:!1,w2a:[aa]});if(this.ia.Ja(J.a.Doa,r.a.execute,aa)!==m.succeeded)throw Error("Table insertion from HTML failed.");return this.pa.Ll()};this.lUj=(aa,ka,H)=>{const ra=[];if(!ka||Number.isNaN(ka)||!H||Number.isNaN(H))throw Error("Invalid rows and columns provided.");
this.pa.iu();this.pa.nh();this.Fa.Bd();for(const Ma of aa){aa=Ma;if(!aa)throw Error("Cannot find selected slide to insert table.");if(!this.qf.fd(aa)){if(!this.kj.hD(aa,1))throw this.kj.KD(aa),Error("Too many shapes on the slide.");var ha=aa.Cb;ha=aa.Q3(ha.sid,ha.cid,0,ka,H,aa.Cs());ra.push(ha);this.sr.HT([ha],aa,null);this.Rq.oA=ha}}return ra};this.insert=({slides:aa,rows:ka,columns:H,html:ra})=>Object(h.a)(this,void 0,void 0,function*(){if(!aa)throw Error("No slide context provided to insert table.");
const ha=[];ra?ha.push(this.jUj(ra)):ha.push(...this.lUj(aa,ka,H));const Ma=[];for(const Ga of ha)Ma.push(new Promise(na=>D.a.r9(na,Ga,!0).bind(this)));return Promise.all(Ma)});this.delete=({tables:aa})=>Object(h.a)(this,void 0,void 0,function*(){if(!aa)throw Error.argumentNull("tables");for(const ra of aa){var ka=this.pa.Ll();ka&&ka.xd&&this.qf.fd(ka)||(ka=Object(w.a)(4,ra),this.wk.VQc(ka))}const H=this.ua.Ba;H&&this.qf.uw(H,"handleDeleteTable");return new Promise(ra=>D.a.r9(ra,H).bind(this))});
if(!M)throw Error.argumentNull("m_graphTopologyManager");if(!Q)throw Error.argumentNull("m_selectionManager");if(!C)throw Error.argumentNull("m_shapeCountValidator");if(!O)throw Error.argumentNull("m_focusManager");if(!U)throw Error.argumentNull("m_shapeEditor");if(!T)throw Error.argumentNull("m_ribbonChangeManager");if(!ca)throw Error.argumentNull("m_tableStyleGalleryManager");if(!N)throw Error.argumentNull("m_actionBlockingManager");if(!da)throw Error.argumentNull("m_actionManager");if(!Y)throw Error.argumentNull("m_transactionHelper");
if(!fa)throw Error.argumentNull("m_odslGraphUtils");}Lyj(){var M=this.pa.Re();return M&&0!=M.length?(M=M[0])?M.Fd:null:null}bgj(M,Q){M=x.a.dgj(M);return(Math.abs(M.r-Q.r)^2)+(Math.abs(M.g-Q.g)^2)+(Math.abs(M.b-Q.b)^2)}hxj(M){if(!M)return"";var Q=M.toLowerCase();this.r1.H6d();M=this.r1.TUc();if(!M||!M.length)return"";if(Q.includes("transparent")||Q.includes("none")){var C=M[0].Sh(n.a.tableStyle);return C.vY?C.vY.styleIdField:""}Q=x.a.TRa(Q);if(!Q.length)return"";const O=this.Lyj();if(!O)return"";let U=
999999,T="";for(let N=0;7>N;++N){const da=M[N].Sh(n.a.tableStyle);if(!da.vY)continue;var ca=null!==(C=da.vY.firstRowField)&&void 0!==C?C:da.vY.wholeTblField;if(!ca||!ca.tcStyleField)continue;ca=ca.tcStyleField.fillField;if(!ca||ca.noFillField)continue;let Y;ca.solidFillField?Y=B.Box4ColorHelper.YH(B.Box4ColorHelper.Vga(ca.solidFillField),O):ca.gradFillField&&(Y=t.f(ca.gradFillField,O).stops[0].color);Y&&(ca=this.bgj(Q,Y),ca<=U&&(U=ca,T=da.vY.styleIdField))}return T}Dee(M){const Q={};Q.Color=x.a.TRa(M);
return B.Box4ColorHelper.vS(Q)}O$a(M){M=M.toLowerCase();if(M.includes("no"))return"TableBordersNoBorder";if(!M.includes("all")){if(M.includes("outside"))return"TableBordersOutsideBorders";if(M.includes("horizontal"))return"TableBordersInsideHorizontalBorder";if(M.includes("vertical"))return"TableBordersInsideVerticalBorder";if(M.includes("inside"))return"TableBordersInsideBorders";if(M.includes("top"))return"TableBordersTopBorder";if(M.includes("bottom"))return"TableBordersBottomBorder";if(M.includes("left"))return"TableBordersLeftBorder";
if(M.includes("right"))return"TableBordersRightBorder";if(M.includes("up"))return"TableBordersDiagonalUpBorder";if(M.includes("down"))return"TableBordersDiagonalDownBorder";if(M.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}Object(K.a)(L,"ODSLTable",null,[509])},1080:function(K,S,d){K=d(0);var h=d(443),e=d(138);class r extends h.a{constructor(){super();this.languageId=null;this.startOfSentence=!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,
{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(K.a)(r,"TextPredictorSignalBase",h.a,[]);d.d(S,"a",function(){return m});class m extends r{constructor(){super();this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static getBaseTypes(){return["AugLoop_Signals_TextPredictorSignalBase","AugLoop_Signals_Signal"]}}
Object(K.a)(m,"TextPredictorSignal",r,[])},112:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(1282);class e{constructor(){this.C$a=this.XHf=this.j4=this.nba=this.TLc=this.KUc=this.Pxb=this.CEa=this.C_=this.SNc=this.Qxd=null}If(r){this.Qxd=new h.a;this.Qxd.value=r}jtc(){this.SNc=new h.a;this.SNc.value=!0}qV(r){this.KUc=new h.a;this.KUc.value=r}}Object(K.a)(e,"QueryResult",null,[])},1148:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(99);class e{constructor(r){this.MDd=
r.cloneNode(!0);this.Wqf=r}restore(){for(h.a.yv(this.Wqf);this.MDd.firstChild;){const r=this.MDd.firstChild;h.a.sP(r);this.Wqf.appendChild(r)}this.MDd=null}}Object(K.a)(e,"DomElementContentState",null,[])},1149:function(K,S,d){d.r(S);d.d(S,"SpellingRequestObjectUpdatedV2",function(){return r});K=d(0);var h=d(677),e=d(676);class r extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=null;this.UxLcid=
0}static e$d(m,n){const z=new r;h.a.YQe(z,m,n);z.UserActionType=e.a[m.userAction];z.ProofingEngine=m.xga;z.Descriptors=m.descriptors;z.OverriddenCritiqueTypeOptions=m.overriddenCritiqueTypeOptions;z.UxLcid=m.mSh;2===m.xga?z.TextUnit=m.range.textUnit:1===m.xga&&(z.UseContextualResults=!0);return z}}Object(K.a)(r,"SpellingRequestObjectUpdatedV2",h.a,[])},1150:function(K,S,d){d.r(S);d.d(S,"SpellingRequestObjectUpdated",function(){return r});K=d(0);var h=d(677),e=d(676);class r extends h.a{constructor(){super();
this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static e$d(m,n,z,t,x,B){const D=new r;h.a.YQe(D,m,n);D.UserActionType=e.a[m.userAction];D.UseOneSpeller=z;D.TrackMetrics=t;D.UseContextualResults=x;B&&(D.ExperimentId=B);return D}}Object(K.a)(r,"SpellingRequestObjectUpdated",h.a,[])},1151:function(K,S,d){d.r(S);d.d(S,"ReactOICErrorDialogWithTrial",function(){return m});K=d(0);var h=d(7);S=d(941);var e=d(204),r=d(80);class m extends S.a{constructor(n,z,t,x,B,D){super(n,
z,t,x,B,D);z={["errorMessage"]:this.d_f,["offerString"]:this.j9g};n=new r.a(!1,!1,!0);this.FEh?(n.Ad=1,z.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.iVa,["onExecute"]:()=>{e.Redirect.showHelp(this.ujg)}}):(n.Ad=4,n.Le(2,this.vkg));n.Le(1,this.hyf);n.ig=this.id;z={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:z};n.sj(this.jka,Object(h.a)(this,this.Y3k,"reactOICErrorDialogWithTrialHandler"),z)}}Object(K.a)(m,"ReactOICErrorDialogWithTrial",S.a,[])},1152:function(K,S,
d){d.r(S);d.d(S,"OICErrorDialogWithTrial",function(){return r});K=d(0);var h=d(7);S=d(941);var e=d(107);class r extends S.a{constructor(m,n,z,t,x,B){super(m,n,z,t,x,B);m=document.createElement("span");m.innerText=this.d_f;m.appendChild(document.createElement("br"));m.appendChild(document.createElement("br"));n=document.createElement("span");n.innerText=this.j9g;m.appendChild(n);n=new e.StandardDialog;this.FEh?(n.Ad=1,n.BTd(this.iVa,this.ujg)):(n.Ad=4,n.Le(2,this.vkg));n.Le(1,this.hyf);n.ig=this.id;
n.Tx(this.jka,null,this.icon,Object(h.a)(this,this.Gbk,"legacyOICErrorDialogWithTrialHandler"),m)}}Object(K.a)(r,"OICErrorDialogWithTrial",S.a,[])},1153:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(K.a)(h,"HeaderButtonInfo",null,[])},1154:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(K.a)(h,"CalloutButtonProps",
null,[])},1155:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.y=this.x=0}}Object(K.a)(h,"IPoint",null,[])},1156:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(27);d=d(78);class e{static fji(r){e.ycf.addHandler(e.DNf,r)}static W0k(r){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.ycf.raiseEvent(e.DNf,r)}}e.DNf="CommandClickEvent";e.ycf=new d.a;Object(K.a)(e,"CommandClickEvents",null,[])},1157:function(K,S,d){d.d(S,"a",function(){return h});
K=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";Object(K.a)(h,"SplitButtonCommandProperties",null,[])},1158:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r=null,m=null,n=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=r;this.iconSet.icon24=
m;this.iconSet.icon32=n}}Object(K.a)(h,"IconSetContainer",null,[])},1159:function(K,S,d){d.r(S);d.d(S,"NewCustomEventFactory",function(){return h});K=d(0);d=d(544);class h extends d.a{constructor(){super()}create(e,r){const m={};m.detail=r;return new CustomEvent(e,m)}}Object(K.a)(h,"NewCustomEventFactory",d.a,[])},1160:function(K,S,d){d.r(S);d.d(S,"IECustomEventFactory",function(){return h});K=d(0);d=d(544);class h extends d.a{constructor(){super()}create(e,r){const m=window.document.createEvent("CustomEvent");
m.initCustomEvent(e,!1,!1,r);return m}}Object(K.a)(h,"IECustomEventFactory",d.a,[])},1161:function(K,S,d){d.r(S);d.d(S,"CheckRoamingRightsRequest",function(){return h});K=d(0);d=d(970);class h extends d.a{constructor(){super()}Uyb(){return 2}ul(){return 1}}Object(K.a)(h,"CheckRoamingRightsRequest",d.a,[])},1162:function(K,S,d){d.r(S);d.d(S,"GetRoamingLauncherRequest",function(){return h});K=d(0);d=d(970);class h extends d.a{constructor(){super()}Uyb(){return 0}ul(){return 2}}Object(K.a)(h,"GetRoamingLauncherRequest",
d.a,[])},1163:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(362);class h extends d.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(K.a)(h,"IconGalleryButtonProps",d.a,[])},1164:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.mjh="WAC_Powerpoint";h.D$b=null;Object(K.a)(h,"AddinHostApp",null,[])},1165:function(K,S,d){d.d(S,"a",function(){return r});K=d(0);var h=d(206),e=d(96);class r{constructor(m){this.rw=
m;this.wN=Array.indexOf(this.rw,this.Aka)}dispose(){this.rw=null}get G_(){return this.rw[this.wN]}mF(m){this.ltc(m,!1);return!0}x$a(m){this.ltc(m,!0)}ltc(m,n){m&&(this.G_!==m||n)&&(m.tabIndex=0,e.FocusManager.Zq(m));Array.contains(this.rw,m)&&(this.wN=Array.indexOf(this.rw,m))}get lkh(){let m=this.wN;do if(m)if(0<m&&m<this.rw.length)m--;else break;else m=this.rw.length-1;while(!h.DOMFocusListing.bEa(this.rw[m])&&m!==this.wN);return this.rw[m]}get Y7g(){let m=this.wN;do if(m===this.rw.length-1)m=0;
else if(0<=m&&m<this.rw.length-1)m++;else break;while(!h.DOMFocusListing.bEa(this.rw[m])&&m!==this.wN);return this.rw[m]}get Aka(){let m=0;for(;!h.DOMFocusListing.bEa(this.rw[m])&&m<this.rw.length;)m++;return h.DOMFocusListing.bEa(this.rw[m])?this.rw[m]:null}get BCb(){let m=this.rw.length-1;for(;!h.DOMFocusListing.bEa(this.rw[m])&&0<m;)m--;return h.DOMFocusListing.bEa(this.rw[m])?this.rw[m]:null}}Object(K.a)(r,"DialogFocusListing",null,[289])},1166:function(K,S){Object.defineProperty(S,"__esModule",
{value:!0});S.ActionRecommendationPrompt=void 0;K=S.ActionRecommendationPrompt||(S.ActionRecommendationPrompt={});K.ODSLPPT="ODSLPPT";K.TextToTableAndSmartArtPPT="TextToTableAndSmartArtPPT";K.NextSlidePPT="NextSlidePPT";K.TextGenerationForSelectedTextPPT="TextGenerationForSelectedTextPPT";K.TextGenerationForTextBoxPPT="TextGenerationForTextBoxPPT"},1167:function(K,S,d){Object.defineProperty(S,"__esModule",{value:!0});S.ActionRecommendationAnnotation=void 0;const h=d(249);class e{constructor(r){h.SchemaObject.assign(e,
this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return h.SchemaObject.matchesTypesFor(r,[e.getTypeName()])}}S.ActionRecommendationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1168:function(K,S){Object.defineProperty(S,"__esModule",{value:!0});S.ActionRecommendationTrigger=void 0;K=S.ActionRecommendationTrigger||
(S.ActionRecommendationTrigger={});K.TextBoxSelection="TextBoxSelection";K.TextSelection="TextSelection"},1169:function(K,S,d){Object.defineProperty(S,"__esModule",{value:!0});S.ActionRecommendationSignal=void 0;const h=d(249);class e{constructor(r){h.SchemaObject.assign(e,this,r)}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(r){return h.SchemaObject.matchesTypesFor(r,[e.getTypeName()])}}
S.ActionRecommendationSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1170:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(K.a)(h,"GallerySectionProps",null,[])},1171:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(301);class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(K.a)(h,"LabelCommandProperties",null,[])},1172:function(K,
S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"AppsForOfficeEntitlementQueryInfo",null,[])},1190:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=d(7),r=d(1253),m=d(27),n=d(143),z=d(465),t=d(271),x=d(205),B=d(55),D=d(73),w=d(37);class J{constructor(Wa,db,ub,Lb,Kb){this.sLd=null;this.YP=!0;this.PP=null;this.Ca=Wa;this.Yh=db;this.sEd=ub;this.G9h=Lb;this.Rg=Kb;m.AFrameworkApplication.MJc(Object(e.a)(this,this.FTl,"updateLastError"));this.G9h.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)?(this.YP=m.AFrameworkApplication.iF,B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(uc=>{uc.isFeatureEnabled("mso_sendASmile",!0).then(Yb=>{this.YP=m.AFrameworkApplication.iF&&Yb;this.Yh&&this.Yh.updateCommandUI();return null},()=>null)})):B.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(uc=>{uc.l4("Enabled").then(Yb=>{this.YP=Yb;return null},()=>null)})}get Rg(){this.PP||(m.AFrameworkApplication.Rg||(m.AFrameworkApplication.Rg=
new z.a),this.PP=m.AFrameworkApplication.Rg);return this.PP}set Rg(Wa){this.PP=Wa}FTl(Wa,db){void 0!==db&&null!==db&&db&&(this.sLd=db.errorCode)}vb(){this.Ca.ya(w.a.giveFeedback,D.a.frame,Object(e.a)(this,this.JBj,"giveFeedbackHandler"));this.Ca.ya(w.a.f9e,D.a.frame,Object(e.a)(this,this.f9e,"triggerFloodgateSurvey"));this.Yh.updateCommandUI()}f9e(Wa,db,ub,Lb,Kb){if(1===ub)return 32;if(2===ub&&!Kb)return 8;B.a.instance.Ia("Common.ISystemInitiatedFeedback").execute(uc=>{uc.logActivity(Object(r.a)(String,
Kb.ActivityName),Object(r.a)(String,Kb.BRSName))});return 32}JBj(Wa,db,ub,Lb,Kb){if(1===ub)return m.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.YP=!1),this.YP&&x.SessionStatusManager.instance.o0?32:8;if(2===ub){h.ULS.sendTraceTag(8405838,356,50,"");this.Rg.Feedback|=t.a.y6i;const uc=Kb||{};void 0!==uc.ErrorCode&&null!==uc.ErrorCode||null==this.sLd||(uc.ErrorCode=this.sLd);m.AFrameworkApplication.fa.nJc(uc);this.sEd&&(this.sEd.instance||3===m.AFrameworkApplication.Aa.mb.Ti&&
1===m.AFrameworkApplication.Aa.mb.LJa||B.a.instance.rb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.sEd.execute(Yb=>{m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",!1)?n.UISurfaces.Zce().then(Tc=>{void 0!==Tc&&null!==Tc?(h.ULS.sendTraceTag(8405838,356,100,"OCV vNext Modal: GiveFeedbackHandler command invoked"),Yb.Zak(uc,Tc)):(h.ULS.sendTraceTag(520626707,356,15,"FeedbackAPI not retrieved"),Yb.Wse(uc));return Tc},
()=>{h.ULS.sendTraceTag(520626706,356,15,"Error while retrieving feedbackAPI");Yb.Wse(uc);return null}):Yb.Wse(uc)}))}return 32}}Object(K.a)(J,"CustomerFeedbackActor",null,[1029]);class F{constructor(Wa,db,ub){this.kWb=this.GKd=!1;this.PP=this.uff=null;this.Y6a=Wa;this.nGc=db;this.Rg=ub}get Rg(){this.PP||(m.AFrameworkApplication.Rg||(m.AFrameworkApplication.Rg=new z.a),this.PP=m.AFrameworkApplication.Rg);return this.PP}set Rg(Wa){this.PP=Wa}Wse(Wa){this.uff=Wa;this.Glg()||this.Rdc()}Zak(Wa,db){this.Y6a.vAl(Wa,
db)}Rdc(){this.GKd||(this.GKd=!0,this.nGc.G5d(Object(e.a)(this,this.RDk,"oFeedbackJsDownloadFinished")))}RDk(Wa){Wa?(this.kWb=!0,this.Rg.Feedback|=t.a.C6i,this.Glg(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Rg.Feedback|=t.a.B6i,h.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.GKd=!1}Glg(){return this.kWb?(this.Y6a.pCl(this.uff),!0):!1}Uvg(Wa){this.kWb=Wa}}Object(K.a)(F,"CustomerFeedbackC3FormManager",null,[1231]);var L=d(18),M=d(681),Q=d(185),C=d(251),O=d(311);
class U{constructor(Wa=null){this.Fqf=null;this.ZEc=new L.a;this.NP=Wa}G5d(Wa){U.odc()?this.ZEc.add(Wa):this.Fqf=Wa;Wa="Feedback/officebrowserfeedback_floodgate.js";M.a.dpe()&&(Wa="Feedback/latest/officebrowserfeedback_floodgate.js");var db="OFeedbackIntl";m.AFrameworkApplication.fa.gu("IsServerFlavorDebug")&&m.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&(db+=".debug");db+=".js";Wa=Q.a.qvb(Wa);Q.a.SGi(db);db=null;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDynamicCampaignEnabled",
!1)){db=[];var ub=Q.a.qvb("Feedback/latest/officebrowserfeedback_ecs_client.js");ub=O.a.create(ub);db.push(ub)}db=O.a.create(Wa,db,null);db.sW(Object(e.a)(this,this.KIk,"onJsDownloadFinished"));C.a.py(db);h.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",Wa)}iol(Wa){this.NP?Wa&&this.NP.add(Wa):this.NP=Wa}KIk(Wa,db){if(U.odc()){for(Wa=0;Wa<this.ZEc.count;Wa++)this.ZEc.ga(Wa)(db.succeeded,this.NP);this.ZEc.clear()}else this.Fqf(db.succeeded,this.NP)}static odc(){return!!m.AFrameworkApplication.Aa&&
!!m.AFrameworkApplication.Aa.mb&&3===m.AFrameworkApplication.Aa.mb.Ti&&1===m.AFrameworkApplication.Aa.mb.LJa}}Object(K.a)(U,"CustomerFeedbackResourceDownloadManager",null,[1230]);class T{constructor(){this.audienceGroup=null;this.eMe=this.Okb=0}gtg(){return!this.eMe}}Object(K.a)(T,"OCVData",null,[]);var ca=d(120),N=d(206),da=d(93);class Y extends Sys.EventArgs{constructor(Wa){super();this.$Gl=Wa}}Object(K.a)(Y,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var fa=d(175),aa=d(69),ka=d(204),H=d(36),ra=
d(144),ha=d(272),Ma=d(478),Ga=d(47),na=d(103),wa=d(1049),Fa=d(78);class pa{constructor(Wa,db){this.vxk="obf-MainContentHolder";this.Nbk="obf-OverallSmileAnchor";this.CYl="obf-visible";this.pqa=this.fTb=pa.Oqd;this.xId=this.wId=this.YP=!0;this.Vkf=this.iqb=this.eGd=this.dGd=this.sDc=this.RCc=this.VVb=!1;this.VCc=!0;this.SKd=this.xKd=this.PP=this.ujd=this.WHd=this.CQd=null;this.g0h=m.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Pd=Wa;this.Rg=db;this.Oa=new Fa.a;if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)){const uc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Tc=>{Tc.isFeatureEnabled("mso_sendASmile",uc.YP).then(sc=>{uc.YP=sc;return null},()=>null);Tc.isFeatureEnabled("FloodgateSurvey",uc.sDc).then(sc=>{uc.sDc=sc;uc.eGd=!0;return null},()=>null)});const Yb=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Tc=>{Tc.l4("IncludeScreenshot").then(sc=>{Yb.VVb=sc;return null},()=>null);Tc.l4("IncludeEmail").then(sc=>
{Yb.RCc=sc;Yb.dGd=!0;return null},()=>null)})}else{const uc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Yb=>{Yb.l4("Enabled").then(Tc=>{uc.YP=Tc;return null},()=>null);Yb.l4("IncludeScreenshot").then(Tc=>{uc.VVb=Tc;return null},()=>null);Yb.l4("IncludeEmail").then(Tc=>{uc.RCc=Tc;uc.dGd=!0;return null},()=>null);Yb.l4("SurveyEnabled").then(Tc=>{uc.sDc=Tc;uc.eGd=!0;return null},()=>null)})}if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",
!0)){this.iqb=m.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const uc=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Yb=>{uc.iqb=Yb.isFreemiumUpsellEnabled();Yb.isFeatureEnabled("mso_sendASmile",!1).then(Tc=>{uc.Vkf=Tc;return null},()=>null)})}const ub=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(uc=>{uc.isFeatureEnabled("FeedbackForum",ub.VCc).then(Yb=>{ub.VCc=Yb;return null},()=>null)});const Lb=
this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(uc=>{uc.isFeatureEnabled("FeedbackComplianceCannotConsent",Lb.wId).then(Yb=>{Lb.wId=Yb;return null},()=>null)});const Kb=this;B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(uc=>{uc.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Kb.xId).then(Yb=>{Kb.xId=Yb;return null},()=>null)});M.a.dpe()?(this.CQd=Q.a.qvb("Feedback/latest/officebrowserfeedback.css"),
this.WHd=Q.a.o0d("Feedback/latest/Intl/")):(this.CQd=Q.a.qvb("Feedback/officebrowserfeedback.css"),this.WHd=Q.a.o0d("Feedback/Intl/"))}get Rg(){this.PP||(m.AFrameworkApplication.Rg||(m.AFrameworkApplication.Rg=new z.a),this.PP=m.AFrameworkApplication.Rg);return this.PP}set Rg(Wa){this.PP=Wa}get fte(){return this.xKd||(this.xKd=document.getElementById(this.Nbk))}get Igd(){return this.SKd||(this.SKd=document.getElementById(this.vxk))}uji(Wa){this.Oa.addHandler(pa.Mah,Wa)}ODi(){this.SKd=this.xKd=null}QZj(Wa){return!!Wa&&
0<=Wa.className.toLowerCase().indexOf(this.CYl.toLowerCase())}vAl(Wa,db){if(!m.AFrameworkApplication.iF)h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.YP)if(h.ULS.sendTraceTag(508952780,356,50,"Feedback api retrieved"),m.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.delayFeedbackForPolicies"))this.rVi(()=>{this.VNk(Wa,db)});else{h.ULS.sendTraceTag(520626705,356,
50,"Feedback api retrieved");const ub=Wa||{};this.getContext(ub);db.initializeFeedbackModal(ub,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"));h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus.");this.Rg.Feedback|=t.a.h8d}}VNk(Wa,db){this.pqa=this.clearInterval(this.pqa);Wa=Wa||{};this.getContext(Wa);db.initializeFeedbackModal(Wa,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"));h.ULS.sendTraceTag(508952779,
356,50,"Successfully opened feedback form and set focus.");this.Rg.Feedback|=t.a.h8d}rVi(Wa){let db=300;this.pqa=this.clearInterval(this.pqa);this.pqa=window.setInterval(()=>{this.QEf()&&Wa();db*=2;1E4<db&&(Wa(),h.ULS.sendTraceTag(508952778,356,10,"Failed to retrieve correct OCPS policies due to timeout"))},db)}pCl(Wa){if(!m.AFrameworkApplication.iF)h.ULS.sendTraceTag(520626704,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");else if(this.YP){Wa=
Wa||{};this.getContext(Wa);var db=pa.OWi(Wa.AppMode||"Unknown");wa.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,db,Wa);this.JRj();pa.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Rg.Feedback|=t.a.h8d}}m7i(Wa,db){db&&2>=db.Okb?((db=m.AFrameworkApplication.fa.Ha("UserPrincipalName"))&&0<db.length&&(Wa.userEmail=db),Wa.userEmailConsentDefault=!0):Wa.userEmail=""}U5f(Wa){const db={};if(void 0!==
Wa.appData&&null!==Wa.appData){var ub=Wa.appData;for(var Lb in ub)db[Lb]=ub[Lb]}db.App=Wa.Application||"";db.AppMode=Wa.AppMode||"";db.AppModeExt=Wa.ApplicationMode||"";db.Host=Wa.Host||"";db.Language=Wa.locale;db.IsError=Wa.Error||!1;db.IsCrash=Wa.Crash||!1;db.ServerDocId=Wa.ServerDocId||"";Wa.ErrorCode&&""!==Wa.ErrorCode.toString()&&(db.IsError=!0);"Origin"in Wa&&(db.Origin=Wa.Origin);db.ClientThrottlingProtection=this.Rg.ClientThrottlingProtection||"";db.HostServiceLevel=this.Rg.HostServiceLevel||
"";db.RequestedCallThrottling=this.Rg.RequestedCallThrottling||"";db.WacServiceLevel=this.Rg.WacServiceLevel||"";this.Rg.HostResponseStats&&(ub=this.Rg.HostResponseStats.Label)&&(db.HostFarmHint=ub);ub=m.AFrameworkApplication.fa;(Lb=ub.Ha(m.AFrameworkApplication.yK))&&""!==Lb&&(db.UiHost=Lb);(Lb=ub.Ha(m.AFrameworkApplication.sOh))&&""!==Lb&&(db.UiHostIntegrationType=Lb);ub.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&(ub=Wa.SessionOrigin,ub&&""!==ub||(Wa=Wa.SourceControlId)&&""!==Wa&&ra.a(ra.d(Wa),
"feedback")&&(ub=this.F7f().SessionOrigin),ub&&""!==ub&&(db.SessionOrigin=ub));Wa=null;try{Wa=H.c(db),Wa=Ga.a.Cda(Wa,Ga.a.wCb)}catch(Kb){Wa="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData: {0}",Kb.message)}return{["appData"]:Wa||""}}Whj(Wa){const db={};for(let ub in Wa)db[ub]=Wa[ub];db.IsFreemiumUpsellEnabled=this.iqb;db.IsAadcEnabled=this.Vkf;db.IsFeedbackEnabled=this.YP;return db}Zhj(){let Wa=null;try{const db=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",
null);db&&(Wa=H.b(db))}catch(db){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return Wa||{}}xgj(Wa,db){Wa.clientFeedbackId||(Wa.clientFeedbackId=na.a.create().toString());if(Wa&&db){Wa.LanguageID?Wa.locale=ha.a.He(Wa.LanguageID).name||"":Wa.ApplicationLCID&&(Wa.locale=Wa.ApplicationLCID);Wa.applicationGroup=this.U5f(Wa);Wa.applicationSettings=this.Whj(m.AFrameworkApplication.fa.appSettings);Wa.webSurfacesSettings=this.Zhj();Wa.userfactConfig=pa.Wzj();pa.eVf(db,
Wa);Wa.appId=pa.TWi();Wa.environment=db.eMe;Wa.stylesUrl=this.CQd;Wa.intlUrl=this.WHd;Wa.rtl=m.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var ub=pa.SWi();Wa.primaryColour=ub.primaryColour;Wa.secondaryColour=ub.secondaryColour;Wa.sessionId=Wa.SessionID||Wa.WACSessionID||"";Wa.build=Wa.ApplicationVersion||Wa.WFEVersion||"";ub=Wa.FlightIDs?Wa.FlightIDs.toString():Wa.Flights?Wa.Flights.toString():"";var Lb="";Wa.ErrorCode&&(Lb=Wa.ErrorCode.toString());var Kb=this.trj(Wa),uc=db.gtg()?m.AFrameworkApplication.fa.Ha("TenantId"):
"";uc&&"0"!==uc||(uc="");var Yb=m.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),Tc=m.AFrameworkApplication.fa.Ha("LoggableUserId")||"";switch(Yb){case "MsaPuid":Tc="p:"+Tc;break;case "MsaCid":Tc="m:"+Tc;break;case "OrgIdPuid":Tc="a:"+(m.AFrameworkApplication.fa.Ha("AADUserObjectId")||Tc);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: {0}, LoggableUserIdSpace: {1}",Tc,Yb),Tc=""}Yb={};if(void 0!==Wa.telemetryGroup&&null!==Wa.telemetryGroup){const sc=
Wa.telemetryGroup;for(let Qb in sc)Yb[Qb]=sc[Qb]}Yb.audienceGroup=db.audienceGroup;Yb.audience=db.audienceGroup;Yb.flights=ub;Yb.platform=Kb;Yb.ringId=db.Okb;Yb.officeUILang=m.AFrameworkApplication.lcid;Yb.errorCode=Lb;Yb.loggableUserId=Tc;Yb.processSessionId=Wa.SessionID||Wa.WACSessionID||"";Yb.officeBuild=Wa.ApplicationVersion||Wa.WFEVersion||"";0<uc.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==uc&&(Yb.tenantId=uc);Wa.telemetryGroup=Yb;Wa.webGroup={["browser"]:Wa.Browser||"",["browserVersion"]:(Wa.BrowserMajorVersion||
"")+"."+(Wa.BrowserMinorVersion||""),["dataCenter"]:Wa.Datacenter||Wa.WACDatacenter||""};Wa.isCommercialHost=m.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.MWi(Wa);Wa.disableIncludeScreenshot=!this.VVb;Wa.screenshot=this.VVb;Wa.showEmailAddress=this.RCc;Wa.emailPolicyValue=this.RCc?1:0;Wa.screenshotPolicyValue=this.VVb?1:0;m.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(Wa.disableIncludeScreenshot=!1,Wa.showEmailAddress=!0,Wa.screenshot=!0);m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&(Wa.surveyEnabled=this.sDc,m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(Wa.showEmailAddress=!0,Wa.surveyEnabled=!0));this.m7i(Wa,db);this.ujd=Wa.DismissHandler?Wa.DismissHandler:null;this.KWi(Wa)}}QEf(){return this.dGd&&this.eGd}getContext(Wa){Wa=Wa||this.F7f();const db=new T;this.xgj(Wa,db);return Wa}trj(Wa){let db="";Wa.Platform&&(db=Wa.Platform.toString());Wa.PlatformMajorVersion&&(0<db.length&&(db+=" "),db+=Wa.PlatformMajorVersion.toString()+".");Wa.PlatformMinorVersion&&(db+=Wa.PlatformMinorVersion.toString());
return db}hFl(Wa){Wa.ApplicationMode&&(Wa.AppMode=Wa.ApplicationMode);Wa.ApplicationModeExtended&&(Wa.ApplicationMode=Wa.ApplicationModeExtended)}F7f(){let Wa;try{Wa=H.b(m.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.hFl(Wa)}catch(db){h.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),Wa={}}return Wa}onError(Wa){Wa=Ma.a.Zyb(Wa);h.ULS.sendTraceTag(37259477,356,10,"FB submit error: {0}",Wa);this.Rg.Feedback|=t.a.A6i;pa.allowKeytips(!0)}aZi(){if(pa.Vrg()){h.ULS.sendTraceTag(40112215,
356,50,pa.P8g);var Wa=B.a.instance.resolve("Common.ISystemInitiatedFeedback");Wa&&Wa.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(Wa){this.Roa();this.ODi();fa.a.XIb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");fa.a.BWa()&&da.c(Wa?w.a.x6i:w.a.s6i,!0,null,2,8);Wa?(fa.a.XIb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Rg.Feedback|=t.a.D6i):(this.Rg.Feedback|=t.a.z6i,this.aZi());this.Oa.raiseEvent(pa.Mah,new Y(Wa));pa.allowKeytips(!0);this.ujd&&(this.ujd(),this.ujd=null)}JRj(){if(this.Pd){let Wa=
!1,db=5,ub=!1;this.pqa=this.clearInterval(this.pqa);this.fTb=this.clearInterval(this.fTb);this.fTb=window.setInterval(()=>{if(this.fte){ub=!0;var Lb=this.Pd.Ic(pa.l9a);Lb.zJ=!0;Lb.parent=ca.AFrame.$i;Lb.t7a(pa.UTi);Lb.n8(()=>{let Kb=this.Pd.LQ(pa.l9a),uc=null,Yb=5,Tc=!1;this.pqa=window.setInterval(()=>{this.QZj(this.Igd)&&(Tc=!0,this.fte.focus(),Kb||(Kb=this.Pd.LQ(pa.l9a)),Kb&&!uc&&(uc=Kb.Gj),uc&&uc.mF(this.fte));Yb--;if(Tc||!Yb)this.pqa=this.clearInterval(this.pqa)},1E3)});Wa||(this.Pd.cV(pa.l9a,
!0),Wa=!0);this.g0h&&this.Igd&&(Lb=new N.DOMFocusListing(()=>this.Igd),Lb.So(1),Lb.So(2),Lb.So(3),Lb.So(5),Lb=this.Pd.Aja(()=>this.Igd,this.Pd.Ic(pa.l9a),Lb),Lb.hkb(),Lb.GX=!0,Lb.XRa=!0,Lb.W6g())}db--;if(ub||!db)this.fTb=this.clearInterval(this.fTb)},1E3)}}clearInterval(Wa){Wa!==pa.Oqd&&(window.clearInterval(Wa),Wa=pa.Oqd);return Wa}Roa(){this.Pd&&(this.Pd.J1(pa.l9a),this.Pd.rMb(pa.l9a))}KWi(Wa){this.wId?this.xId||(Wa.ageGroup=4):Wa.ageGroup=3;m.AFrameworkApplication.fa.ka("IsAnonymousUser")?Wa.authenticationType=
2:Wa.authenticationType="aad"===m.AFrameworkApplication.fa.Ha("HostAuthType")?1:0}MWi(Wa){this.VCc&&(Wa.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",Wa.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.VCc){const db=pa.NWi();void 0!==db&&null!==db&&(Wa.feedbackPortalUrl=db,Wa.feedbackForumUrl=db)}}static allowKeytips(Wa){m.AFrameworkApplication.Aa.mb.Qp&&aa.a("allowKeytips")&&appChrome.api.allowKeytips(Wa)}static S0i(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSendUserFacts",
!1)}static T0i(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTargetedMessagingServiceFactRequest",!1)}static $Xi(){let Wa=null;try{const db=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.DisabledUserFacts","");db&&""!==db&&(Wa=db.split(","))}catch(db){h.ULS.sendTraceTag(509104515,356,10,"Could not parse DisabledUserFacts")}return Wa||[]}static Wzj(){const Wa={};Wa.enableSendUserFacts=pa.S0i();Wa.enableTargetedMessagingServiceFactRequest=
pa.T0i();Wa.disabledUserFacts=pa.$Xi();Wa.userFactRules=pa.dSi();return Wa}static dSi(){const Wa={};Wa.ExcelWebLastUsed=wa.a.Bfe("ExcelWebLastUsed");Wa.PowerPointWebLastUsed=wa.a.Bfe("PowerPointWebLastUsed");Wa.WordWebLastUsed=wa.a.Bfe("WordWebLastUsed");return Wa}static eVf(Wa,db){if(db){Wa.Okb=parseInt(db.Ring);if(isNaN(Wa.Okb))Wa.audienceGroup="Unknown",Wa.Okb=-2;else switch(Wa.Okb){case 0:case 1:Wa.audienceGroup="Dogfood";break;case 2:Wa.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:Wa.audienceGroup=
"Production";break;default:Wa.audienceGroup="Unknown"}var ub=!0;db.Host&&(ub="MsInternal"!==db.Host&&"Blue Chicken"!==db.Host);Wa.eMe=ub?0:1}}static TWi(){let Wa=0;switch(ka.Redirect.application){case 2:Wa=2155;break;case 4:Wa=2158;break;case 3:Wa=2157;break;case 1:Wa=2156;break;case 5:Wa=2159;break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",ka.Redirect.application.toString())}return Wa}static SWi(){const Wa={};let db="#2B579A",ub="#3C65A4";switch(ka.Redirect.application){case 2:m.AFrameworkApplication.fa&&
m.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?(db="#185ABD",ub="#2E6AC5"):(db="#2B579A",ub="#3C65A4");break;case 4:db="#7719AA";ub="#9953C0";break;case 3:db="#B7472A";ub="#C75033";break;case 1:db="#217346";ub="#3F8159";break;case 5:db="#3955A3";ub="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",ka.Redirect.application.toString())}Wa.primaryColour=db;Wa.secondaryColour=ub;return Wa}static NWi(){let Wa=null;switch(ka.Redirect.application){case 2:Wa=
"https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:Wa="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:Wa="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:Wa="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";break;case 5:Wa="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",ka.Redirect.application.toString())}return Wa}static OWi(Wa){let db=
356;switch(ka.Redirect.application){case 2:switch(Wa){case "Edit":db=364;break;case "View":case "Attendee":case "Presenter":db=363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",m.AFrameworkApplication.Aa.ZZa),db=363}break;case 4:db=362;break;case 3:switch(Wa){case "Edit":db=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":db=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",
m.AFrameworkApplication.Aa.ZZa),db=360}break;case 1:switch(Wa){case "Edit":db=358;break;case "View":db=357;break;case "Survey":db=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",m.AFrameworkApplication.Aa.ZZa),db=357}break;case 5:switch(Wa){case "View":db=373;break;case "Edit":db=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",m.AFrameworkApplication.Aa.ZZa),
db=373}break;default:h.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",ka.Redirect.application.toString())}return db}static UTi(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static Vrg(){if(!pa.ULe){const Wa=!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka(pa.P8g);pa.ULe=Wa?2:1}return 2===pa.ULe}}pa.l9a="CustomerFeedbackFocusId";pa.Mah="FUID";pa.Oqd=-1;pa.ULe=0;pa.P8g="NPSLocalizationTestingIsEnabled";Object(K.a)(pa,"CustomerFeedbackUiWrapper",
null,[1138]);var Ea=d(15),ta=d(1254),ia=d(1255);class Ja{constructor(Wa,db,ub,Lb){this.lef=Wa;this.Cha=db;this.kef=ub;this.$5h=Lb}activityName(){return this.Cha}object(){return this.$5h}}Object(K.a)(Ja,"OneCallBackData",null,[]);class ab{constructor(Wa,db,ub,Lb){this.ZNa=[];Array.add(this.ZNa,new Ja(Wa,db,ub,Lb))}add(Wa){Wa&&Array.addRange(this.ZNa,Wa.ZNa)}QDi(){Array.clear(this.ZNa)}}Object(K.a)(ab,"CallBackData",null,[]);var Oa=d(541);class Za extends Oa.a{constructor(Wa,db,ub=null,Lb=!1,Kb=!1,
uc=null,Yb=null,Tc=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=Wa;this.message=db;this.image=ub;this.positionImageAtLeft=Lb;this.smallHeadline=Kb;this.title=uc;this.primaryButtonProps=Yb;this.secondaryButtonProps=Tc}}Object(K.a)(Za,"FloodgateCalloutContent",Oa.a,[]);class Na{constructor(){this.props=this.options=null}}Object(K.a)(Na,"Notification",
null,[]);var sa=d(1154),Sa=d(945),xb=d(358);class gc extends Oa.a{constructor(Wa,db,ub=null,Lb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=Wa;this.content=db;this.imageProps=ub;this.imageHeight=Lb}}Object(K.a)(gc,"PremiumUpsellCalloutContentProps",Oa.a,[]);var zc=d(946),Xb=d(944);class jb{static d1d(Wa){return jb.Asj().then(db=>{try{const ub=[];for(let Lb=0;Lb<Wa.length;Lb++){const Kb=Wa[Lb],uc=jb.Z7j(Kb.surfaceType),Yb=new Na;Yb.options=
jb.Ypj(Kb,!uc);Yb.props=uc?db.callout(jb.Jxk(Wa[Lb])):db.externalNotification();ub.push(Yb)}return jb.FAl(db,ub)}catch(ub){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+ub.message);}})}static Z7j(Wa){switch(Wa.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static Ypj(Wa,db){const ub=new xb.a;db&&(ub.onShow=Wa.onUnsupportedSurfaceType);ub.telemetryId="FloodgateTeachingUx-Surface"+(db?"NotSupported":
"Supported");return ub}static Jxk(Wa){var db="premiumupsell"!==Wa.surfaceType.toLowerCase()?new Za(Wa.footer,Wa.description,Wa.illustrationImage?Object.assign(new Xb.a(Wa.illustrationImage),{ariaLabel:Wa.imageAriaLabel}):null,"left"===Wa.position,Wa.smallHeadline,Wa.title,jb.gVc(Wa.primaryButtonText,Wa.primaryButtonAction),jb.gVc(Wa.secondaryButtonText,Wa.secondaryButtonAction)):new gc(Wa.title,Wa.description,Wa.illustrationImage?Object.assign(new Xb.a(Wa.illustrationImage),{ariaLabel:Wa.imageAriaLabel}):
null);db=Object.assign(new Sa.a,{target:Wa.selector,content:db,showCloseIcon:null!=Wa.hasCloseButton?Wa.hasCloseButton:!0,preventLightDismiss:null!=Wa.preventAutoDismiss?Wa.preventAutoDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new zc.a,{onDismiss:ub=>{if(Wa.onClosed)if(ub)Wa.onClosed("close");else Wa.onClosed("auto dismiss")},directionalHint:Wa.anchorHint,setInitialFocus:!0})});"coachmark"===Wa.surfaceType.toLowerCase()?(db.hasDynamicSizing=!1,db.useCoachmark=!0,db.calloutProps.setInitialFocus=
!1):"premiumupsell"===Wa.surfaceType.toLowerCase()&&(db.primaryButtonProps=jb.gVc(Wa.primaryButtonText,Wa.primaryButtonAction),db.secondaryButtonProps=jb.gVc(Wa.secondaryButtonText,Wa.secondaryButtonAction),db.showCloseIcon=!1,db.useTeachingStyles=!1,db.calloutProps.preventDismissOnLostFocus=!1);return db}static gVc(Wa,db){return Wa&&""!==Wa&&db?Object.assign(new sa.a,{label:Wa,onExecute:db}):(h.ULS.shipAssertTag(594569111,356,(!Wa||""===Wa)&&!db,"A callout button needs both a caption and an action."),
null)}static Asj(){jb.UTc||(m.AFrameworkApplication.Aa.mb.iWa&&m.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?jb.UTc=n.UISurfaces.KL().then(Wa=>{const db=new Za(null,null);if(Wa.isCustomContentSupported&&Wa.isCustomContentSupported(db))return Wa;throw Error.create("Custom Content not supported: "+db.type);},Wa=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",Wa);return null}):jb.UTc=Promise.reject("React Notifications not enabled"));return jb.UTc}static FAl(Wa,
db){if(!db||!db.length)return[];const ub=[];for(let Lb=0;Lb<db.length;Lb++){const Kb=jb.qBl(Wa,db[Lb]);ub.push(Kb)}return ub}static qBl(Wa,db){const ub=Wa.addNotification(db.props,db.options);return()=>{Wa.removeNotification(ub)}}}jb.UTc=null;Object(K.a)(jb,"FloodgateNotifications",null,[]);class zb{static dfl(){return m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")?new Promise(Wa=>{B.a.instance.Ia("Common.App.OAuth.IOAuthManager").execute(db=>{if(db&&db.xog()){var ub=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.PersonalizationOAuthUri",
zb.TUi);db.mI("Tulips",ub).then(Lb=>{Lb&&Lb.IsSuccess?(h.ULS.sendTraceTag(508905242,356,50,"PersonalizationAuthManager got auth token"),Wa(Lb.Token)):(h.ULS.sendTraceTag(508905241,356,15,"PersonalizationAuthManager Error - "+(Lb?Lb.ErrorMessage:"")),Wa(null));return null})}else h.ULS.sendTraceTag(508905243,356,15,"PersonalizationAuthManager oauthManager not valid"),Wa(null)})}):Promise.resolve(null)}}zb.TUi="https://attributes.engagement.office.com";Object(K.a)(zb,"PersonalizationAuthManager",null,
[]);const Tb=(Wa,db)=>{Wa=m.AFrameworkApplication.fa.Ha("UserPrincipalName");if(db=!!db.e9g&&2===db.e9g.Okb)db=(db=Wa.toLowerCase())?0<db.indexOf("linkedin.com")||0<db.indexOf("linkedin.biz"):!1;return db};class Ya{constructor(Wa,db){this.e9g=Wa;this.context=db}}Object(K.a)(Ya,"SurveyMetadata",null,[]);var sb=d(67),oc=d(273),wb=d(94),rc=d(82);class Ka{constructor(Wa){this.QVa=this.isInitialized=!1;this.aka=this.vob=null;this.i3a=!1;this.C6e=null;this.eqg=!1;this.jQc=0;this.YTf=-1;this.hRe=this.iQc=
null;this.hVa=!0;this.zQ=Wa;this.Awc={};this.yFf=!1;this.QMb=this.ma=null;this.TTc=0}fTj(Wa){this.isInitialized&&this.vob||this.QVa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===Wa?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.i3a=Wa.i3a,h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}WSj(){const Wa=this.zQ.getContext(null),
db=new T;pa.eVf(db,Wa);this.C6e=new Ya(db,Wa);this.QMb=new Ea.ScriptSharpLegacyMap;this.QMb.$("LinkedInWACUsage",Tb)}get rtb(){this.vob||(this.vob=B.a.instance.rb("Common.App.IAppSpecificFeedbackData"));return this.vob}logActivity(Wa,db,ub=null){Wa&&this.u$a(Wa,Ka.Lhb,db)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+Wa),wa.a.logActivity(Wa,ub)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+Wa),this.Dje(new ab(wa.a.logActivity,Wa,null,
ub))))}Fte(Wa){try{m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+Wa),-1===this.YTf&&(this.YTf=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Ka.BTf)),this.iQc||(this.iQc=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),
!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.iQc&&Wa&&Wa.startsWith("Ribbon_")&&-1===this.iQc.indexOf(Wa.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.jQc&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.jQc),h.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+
Wa)),this.jQc=window.setTimeout(()=>{this.jQc=0;this.logActivity(Wa,null)},Ka.BTf)):h.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+Wa)}catch(db){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(db?db.toString():""))}}Vdc(Wa,db){Wa&&this.u$a(Wa,Ka.Lhb,db)&&(this.Xxg(Wa,db),this.Awc[Wa]=db)}Xxg(Wa,db){this.u$a(Wa,Ka.Lhb,db)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+Wa),wa.a.Vdc(Wa,
null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+Wa),this.Dje(new ab(wa.a.Vdc,Wa,null,null))))}Vxg(Wa){Wa&&this.isInitialized&&this.u$a(Wa,Ka.Lhb,void 0)&&(Wa in this.Awc&&delete this.Awc[Wa],this.Wxg(Wa,void 0))}Wxg(Wa,db){this.isInitialized&&this.u$a(Wa,Ka.Lhb,db)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+Wa),wa.a.Vxg(Wa))}hmb(Wa,db){if(this.u$a(Wa,Ka.Lhb,db))if(this.rtb){if(db=this.rtb.Cfe(Wa))this.isInitialized?(h.ULS.sendTraceTag(38605911,
356,50,"SIFB:ShowUserInitiatedSurvey "+Wa),wa.a.hmb(db)):(h.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+Wa),this.Dje(new ab(null,null,wa.a.hmb,db)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}u$a(Wa,db,ub){if(this.QVa)return!1;if(!m.AFrameworkApplication.iF)return h.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.M_j())return!1;this.MMi();return(this.CZj(Wa)||this.GTi(Wa)||this.cWj(Wa))&&
this.xti(db,ub)&&this.CHl(Wa)}MMi(){if(!this.vob){const Wa=B.a.instance.rb("Common.App.IAppSpecificFeedbackData");Wa?this.vob=Wa:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}N_j(Wa){return 6!==Wa}M_j(){if(0===this.TTc){const Wa=this.zQ.getContext(null);this.TTc=this.N_j(parseInt(Wa.Ring))?1:2;2===this.TTc&&h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.TTc}CHl(Wa){null===this.QMb&&this.WSj();
return Wa&&this.QMb&&this.QMb.Gb(Wa)?this.QMb.ga(Wa)(Wa,this.C6e):!0}Ohj(){if(!this.aka&&!this.yFf){this.yFf=!0;const Wa=this.zQ.getContext(null);this.aka="locale"in Wa?Wa.locale:"";this.aka=this.aka.toLowerCase()}return this.aka}GTi(Wa){this.aka||(this.aka=this.Ohj());if(!(this.aka&&this.aka.length&&Wa&&Wa.length))return!1;let db="en-us"===this.aka||this.W2j(Wa)||pa.Vrg();!db&&this.L2j(Wa)&&(db=this.M2j(this.aka));return db}L2j(Wa){return this.rtb?"AppUsageNPS"===Wa||"AppUsageTimeSatisfiedNPS"===
Wa||"SuiteUsageNPS"===Wa||"SuiteUsageTimeSatisfiedNPS"===Wa:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+Wa),!1)}CZj(Wa){return!!Wa&&-1!==Wa.toLowerCase().indexOf("floodgateflight")}W2j(Wa){return!!Wa&&-1!==Wa.toLowerCase().indexOf("nlqs")}M2j(Wa){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!Wa||!Wa.length)return!1;if(!m.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===
Wa;let db=!1;switch(Wa){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":db=!0}return db}xti(Wa,db){return m.AFrameworkApplication.fa.ka(Wa)?db&&!m.AFrameworkApplication.fa.ka(db)?(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+db+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+
Wa+") is off"),!1)}cWj(Wa){const db=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!Wa&&!!db&&-1!==db.toLowerCase().indexOf(Wa.toLowerCase())}Dje(Wa){if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))m.AFrameworkApplication.fa.$e(()=>{try{this.vRc(Wa)}catch(db){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+
db)}});else try{this.vRc(Wa)}catch(db){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+db)}}$nc(){this.i3a||this.start()}BNk(){this.i3a||this.stop()}t5e(){this.i3a&&this.start()}hGl(){this.i3a&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const Wa=rc.a.sPc(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",
10),Object(e.a)(this,this.CHh,"startSurvey"),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));m.AFrameworkApplication.De.Hb(Wa)}else this.CHh(null)}CHh(){wa.a.Z9i();this.PKl()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.OKl(),wa.a.$9i())}PKl(){const Wa=this.Awc;for(let db in Wa)this.Xxg(db,Wa[db])}OKl(){const Wa=this.Awc;for(let db in Wa)this.Wxg(db,Wa[db])}vRc(Wa){h.ULS.sendTraceTag(36546388,
356,100,"SIFB: Entered DownloadResources");var db=B.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");db&&(db.kWb?this.s3f(!0,Wa):(db=B.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),db.iol(Wa),db.G5d(Object(e.a)(this,this.s3f,"floodgateJsDownloadFinished"))))}s3f(Wa,db){h.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+Wa);let ub="";db&&db.ZNa&&0<db.ZNa.length&&(ub=db.ZNa[0].activityName());
if(Wa)if(M.a.dpe())if(this.isInitialized)this.r5d(db);else{if(this.QVa||!this.hRe)this.hRe=this.Pih();this.hRe.then(()=>{this.r5d(db)}).catch(Lb=>this.Qih(ub,Lb))}else this.Pih().then(()=>{this.r5d(db)}).catch(Lb=>this.Qih(ub,Lb));else this.QVa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+ub)}Qih(Wa,db){this.QVa=!0;h.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+Wa+". "+db.toString())}a$i(Wa){this.ma||this.bTj();let db=
Wa;Wa&&0<Wa.length&&(db=this.ma&&this.ma.Gb(Wa)?this.ma.ga(Wa):Wa);return db?db:""}Pih(){var Wa=B.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");Wa&&Wa.Uvg(!0);this.$ul();this.Aul();this.initOptions();if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&m.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.ndj().then(db=>{this.Nte(db);return db}).then(db=>wa.a.rje(Object(e.a)(this,
this.COe,"onSIFeedbackDismiss"),Object(e.a)(this.zQ,this.zQ.onError,"onError"),db,Object(e.a)(this.zQ,this.zQ.onDismiss,"onDismiss")));if(m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&m.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&m.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return Ka.oVi(this.h$f()).then(()=>{const db=this.E$d();this.Nte(db);return db}).then(db=>wa.a.rje(Object(e.a)(this,this.COe,"onSIFeedbackDismiss"),
Object(e.a)(this.zQ,this.zQ.onError,"onError"),db,Object(e.a)(this.zQ,this.zQ.onDismiss,"onDismiss")));Wa=this.E$d();this.Nte(Wa);return wa.a.rje(Object(e.a)(this,this.COe,"onSIFeedbackDismiss"),Object(e.a)(this.zQ,this.zQ.onError,"onError"),Wa,Object(e.a)(this.zQ,this.zQ.onDismiss,"onDismiss"))}ndj(){return new Promise(Wa=>{B.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(db=>{const ub=this.E$d();db.isFeatureEnabled("FloodgateSurvey",!0).then(Lb=>{ub.surveyEnabled=
"surveyEnabled"in ub?Lb&&ub.surveyEnabled:Lb;Wa(ub);return null},Lb=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",Lb.toString());Wa(ub);return null})})})}Yhj(){let Wa=null;try{const db=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);db&&(Wa=H.b(db))}catch(db){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return Wa||{}}E$d(){const Wa=this.zQ.getContext(null);
Wa.FloodgateUIAutoDismissTimeEnum=this.cej();Wa.uIStringGetter=Object(e.a)(this,this.a$i,"floodgateUIStringGetter");Wa.authTokenCallback=Ka.UMi(Object(r.a)(String,Wa.AudienceGroup));Wa.userFactsReadConfig=Ka.uQi();Wa.augLoopCallback=Ka.RMi();Wa.onTeachingCampaignRender=Ka.d1d;Wa.governanceServiceEnabled=Ka.A9f();Wa.governanceServiceConfig=Ka.klj();Wa.personalizerEnabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);Wa.messagingServiceSettings=
this.Yhj();Wa.isPriorityEnabled=Ka.Yrj();Wa.enableWebCampaignGovernance=Ka.V0i();return Wa}Nte(Wa){const db=this.zQ.QEf(),ub=this.h$f(),Lb=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),Kb=m.AFrameworkApplication.fa.ka("IsO365CommercialHost"),uc=m.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Yb=m.AFrameworkApplication.fa.ka("OcpsIsEnabled"),Tc="surveyEnabled"in Wa?Wa.surveyEnabled:"null or undefined",sc="showEmailAddress"in Wa?
Wa.showEmailAddress:"null or undefined",Qb=Ka.A9f(),kb=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',
db,Lb,Kb,uc,Yb,ub,sc,Tc,Qb,H.c(Wa.governanceServiceConfig),kb)}cej(){return Tb(null,this.C6e)?(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",m.AFrameworkApplication.fa.uc("FloodgateUIAutoDismissTimeEnum",2))}h$f(){return m.AFrameworkApplication.fa.uc("FloodgateContextAndInitDelayInMilliSeconds",Ka.UUi)}r5d(Wa){this.isInitialized=!0;this.Hhi();
wa.a.Qol(Object(e.a)(this,this.nhk,"logTriggerEvent"));if(Wa){for(const db of Wa.ZNa)db.lef?(0,db.lef)(db.activityName(),db.object()):db.kef?(0,db.kef)(db.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");Wa.QDi()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const db=this.zQ.getContext(null),ub=wa.a.h9f(Array.isArray(db.Flights)?db.Flights:null),Lb=ub?Object(r.a)(String,ub.SelfTriggerActivity):null;if(Lb)for(const Kb of Lb.split(";"))Kb&&
""!==Kb&&this.logActivity(Kb,null)}catch(db){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(db?db.toString():""))}}Hhi(){if(!this.eqg&&window.addEventListener){const Wa=Object(e.a)(this,this.yNk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",Wa,!0);this.eqg=!0}}dyg(Wa,db){Wa&&m.AFrameworkApplication.Oea(Wa);h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+db)}QYj(Wa){if(!Wa)return!1;try{const db=(m.AFrameworkApplication.fa.Ha("FlightId")||
"").toLocaleLowerCase(),ub=Wa.toString().toLocaleLowerCase().split(";");for(const Lb of ub)if(2<Lb.length&&(Lb.lastIndexOf("-control")===Lb.length-8||Lb.lastIndexOf("cf")===Lb.length-2&&-1!==db.indexOf(Lb)))return!0}catch(db){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(db?db.toString():""))}return!1}nhk(Wa,db){db=db||{};if(Wa){var ub=Ka.tbe(Wa);ub&&(db.flightId=ub);"isControl"in db||(ub=this.QYj(Wa))&&(db.isControl=ub)}this.dyg(Wa,JSON.stringify(db))}yNk(Wa){if(Wa=Wa?
Wa.detail:null){var db=!m.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),ub=(Wa.action||"").toLowerCase();switch(ub){case "dismissed":db&&oc.a.instance.Eo("obf-DynamicWebSurfaces");break;case "updated":db&&wa.a.Wra("obf-DynamicWebSurfaces");break;case "opened":case "":ub=Wa.telemetryEventName;let Lb;try{Lb=JSON.stringify(Wa)}catch(Kb){Lb="id : "+Wa.id+" telemetryEventName: "+ub,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+Lb+" Error: "+(Kb?
Kb.toString():""))}Wa.success?this.dyg(ub,Lb):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+Lb);Wa.isHidden||Wa.isAA||!db||wa.a.Wra("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+ub)}}}p$k(Wa){if(!Wa)return null;try{const db=m.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase();if(!db||""===db)return Wa;const ub=H.b(Wa),Lb=new L.a;let Kb=0;for(const uc of ub){const Yb=
uc.CampaignId;Yb&&-1!==db.indexOf(Yb.toLowerCase())?(h.ULS.sendTraceTag(509167254,356,50,"Ignoring disabled campaign -"+Yb),Kb++):Lb.add(uc)}return Kb?H.c(Lb.toArray()):Wa}catch(db){return h.ULS.sendTraceTag(509167253,356,10,"Error filtering out disabled campaigns"),Wa}}JNl(Wa){var db=["Live"];if(!Wa)return null;try{const ub=H.b(Wa),Lb=new L.a;for(const Kb of ub){const uc=Kb.Tags;if(uc)for(const Yb of db)Array.contains(uc,Yb)&&Lb.add(Kb)}return H.c(Lb.toArray())}catch(ub){return h.ULS.sendTraceTag(523904348,
356,10,"Could not deserialize CampaignDefinitionsJson"),null}}$ul(){let Wa=!1,db=null;const ub=this.rab();if(ub&&this.rtb)try{let Lb=this.rtb.afj();m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&m.AFrameworkApplication.uX&&(Lb=this.JNl(Lb));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FilterDisabledCampaigns",!0)&&(Lb=this.p$k(Lb));Lb?(ub.setItem(Ka.Bzi,Lb),Wa=!0):(db="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,
356,10,db))}catch(Lb){db="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+Lb,h.ULS.sendTraceTag(594143441,356,50,db)}else this.rtb?(db="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",h.ULS.sendTraceTag(594143440,356,50,db)):(db="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,db));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+Wa+" errorString: "+(db?db:
"null"))}COe(Wa,db){fa.a.XIb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",db,Wa);fa.a.BWa()&&da.c(db?w.a.RWl:w.a.QWl,!0,null,2,8);oc.a.instance.Eo(wa.a.r3f)}initOptions(){}Aul(){this.i3a||(wb.a.addHandler(window.self,sb.a.focus,Object(e.a)(this,this.$nc,"onWindowFocus")),wb.a.addHandler(window.self,sb.a.blur,Object(e.a)(this,this.BNk,"onWindowBlur")))}rab(){if(!this.hVa)return null;let Wa=null;try{Wa=localStorage}catch(db){this.hVa=!1,Wa=null,h.ULS.sendTraceTag(594052320,
356,50,"SIFB.GetLocalStorage error "+(db?db.toString():""))}return Wa}bTj(){h.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.ma=new ta.a(ia.a.Gk()),this.ma.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.ma.$("nps_PromptQuestion",CommonUIStrings.l_WAC_NPS_PromptQuestion),this.ma.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.ma.$("nps_RatingQuestion_Word",Ka.ufg()),this.ma.$("nps_RatingQuestion_OneNote",Ka.$Aj()),this.ma.$("nps_OneClickPromptQuestion_PPT",
CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.ma.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.ma.$("nps_OneClickRatingQuestion_Excel",Ka.sfg()),this.ma.$("nps_OneClickRatingQuestion_PowerPoint",Ka.tfg()),this.ma.$("nps_RatingQuestion_PowerPoint",Ka.tfg()),this.ma.$("nps_RatingQuestion_Excel",Ka.sfg()),this.ma.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.ma.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),
this.ma.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.ma.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.ma.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.ma.$("nps_Rating_Values_5",CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.ma.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.ma.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.ma.$("nps_OneClickRatingQuestion_Word",
Ka.ufg()),this.ma.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.ma.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.ma.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),this.ma.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.ma.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.ma.$("nps_Suite_RatingQuestion",
"How likely are you to recommend Microsoft 365 to others, if asked?"),this.ma.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.ma.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.ma.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),this.ma.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.ma.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.ma.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),
this.ma.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.ma.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.ma.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.ma.$("NSV_Prompt_Title_Feedback",CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.ma.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.ma.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),
this.ma.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.ma.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.ma.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.ma.$("NSVFreeformDidntCreateSheetView",CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.ma.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.ma.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),
this.ma.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.ma.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.ma.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.ma.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),this.ma.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.ma.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.ma.$("CatchUpFPS_RatingValue_2",
CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.ma.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.ma.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.ma.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.ma.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.ma.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.ma.$("ReviewMode_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.ma.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.ma.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.ma.$("ReviewMode_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.ma.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.ma.$("ReviewMode_FloodgateRating_2",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.ma.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.ma.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.ma.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),this.ma.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.ma.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),
this.ma.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.ma.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.ma.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.ma.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),this.ma.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.ma.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),
this.ma.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.ma.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.ma.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.ma.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),this.ma.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.ma.$("connector_campaign_Rating_Values_1",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.ma.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.ma.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.ma.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),this.ma.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.ma.$("connector_campaign_Verbatim_Question",
CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.ma.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.ma.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.ma.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),this.ma.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.ma.$("WordFollowUpFeelingsFPS_RatingQuestion",
CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.ma.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.ma.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.ma.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),this.ma.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.ma.$("WordFollowUpFeelingsFPS_RatingValue_5",
CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.ma.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.ma.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.ma.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),this.ma.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.ma.$("DictationV2_GreetingAnswer_Notnow",
CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.ma.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.ma.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.ma.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),this.ma.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.ma.$("DictationV2_RatingAnswer_4",
CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.ma.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.ma.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.ma.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),this.ma.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.ma.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),
this.ma.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.ma.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.ma.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.ma.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),this.ma.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.ma.$("OfficeScriptsFPS_RatingValue_4",
CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.ma.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.ma.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.ma.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.ma.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.ma.$("ExcelAddins_QuestionQuestion",
CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.ma.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.ma.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.ma.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.ma.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),this.ma.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.ma.$("ExcelIdeas_Prompt",
CommonUIStrings.l_Excel_Ideas_Prompt),this.ma.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.ma.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.ma.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.ma.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.ma.$("ExcelIdeas_Rating_3_Expectations",
CommonUIStrings.l_Excel_Rating_3_Expectations),this.ma.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.ma.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.ma.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.ma.$("ExcelRecommendedCharts_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),
this.ma.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.ma.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.ma.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.ma.$("ExcelRecommendedCharts_Rating_3_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.ma.$("ExcelRecommendedCharts_Rating_4_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.ma.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.ma.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.ma.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("ExcelRecommendedPivotTable_Rating_Question",CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.ma.$("ExcelRecommendedPivotTable_ExpectationsQuestion",
CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.ma.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.ma.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.ma.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.ma.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.ma.$("ExcelRecommendedPivotTable_Rating_5_Expectations",
CommonUIStrings.l_Excel_Rating_5_Expectations),this.ma.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.ma.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.ma.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.ma.$("Download_as_Image_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.ma.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),
this.ma.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.ma.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.ma.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.ma.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.ma.$("TextPredictions_FloodgatePromptTitle",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.ma.$("TextPredictions_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.ma.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.ma.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.ma.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),this.ma.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),
this.ma.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.ma.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.ma.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.ma.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),this.ma.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),
this.ma.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.ma.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.ma.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.ma.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.ma.$("SoftwareITDiagrams_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.ma.$("SoftwareITDiagrams_Rating_Values_3",
CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.ma.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.ma.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.ma.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.ma.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),this.ma.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),
this.ma.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.ma.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.ma.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.ma.$("ExternalContent_FloodgateRating_1",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.ma.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),
this.ma.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.ma.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.ma.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.ma.$("ExternalContent_FloodgateQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.ma.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),
this.ma.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.ma.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.ma.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.ma.$("Translator_RatingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.ma.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),
this.ma.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.ma.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.ma.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.ma.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),this.ma.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.ma.$("TeamsOpen_GreetingQuestion",
CommonUIStrings.l_WAC_NPS_Title),this.ma.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),this.ma.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.ma.$("TeamsOpen_RatingQuestion_PowerPoint",
CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.ma.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.ma.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.ma.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.ma.$("LinkedIn_Title",CommonUIStrings.l_LinkedIn_Title),this.ma.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.ma.$("LinkedIn_QuestionQuestion",
CommonUIStrings.l_LinkedIn_QuestionQuestion),this.ma.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.ma.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.ma.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.ma.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),this.ma.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.ma.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),
this.ma.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.ma.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.ma.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.ma.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.ma.$("VHRestore_SurveyQuestion",CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.ma.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.ma.$("VHRestore_Answer_Options_2",
CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.ma.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.ma.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.ma.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.ma.$("ShowChanges_Prompt",CommonUIStrings.l_Excel_ShowChanges_Prompt),this.ma.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.ma.$("ShowChanges_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.ma.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.ma.$("ShowChanges_RatingValue_2",CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.ma.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.ma.$("ShowChanges_RatingValue_4",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.ma.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.ma.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.ma.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),this.ma.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.ma.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",
CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.ma.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.ma.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.ma.$("ModernUxExperiment_FloodgateRatingValue_1",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.ma.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),
this.ma.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.ma.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.ma.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),this.ma.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.ma.$("FileBackedLoopComponents_FloodgatePromptTitle",
CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.ma.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),
this.ma.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.ma.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.ma.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),this.ma.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),
this.ma.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.ma.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.ma.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.ma.$("PollLoopComponent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.ma.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.ma.$("PollLoopComponent_FloodgateRatingValue_2",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.ma.$("PollLoopComponent_FloodgateRatingValue_3",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.ma.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.ma.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.ma.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),this.ma.$("RemoveLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_RemoveLoopComponents_Floodgate_PromptTitle),
this.ma.$("RemoveLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("RemoveLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("RemoveLoopComponents_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("RemoveLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingQuestion),this.ma.$("RemoveLoopComponents_FloodgateRatingValue_1",
CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_1),this.ma.$("RemoveLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_2),this.ma.$("RemoveLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_3),this.ma.$("RemoveLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_4),this.ma.$("RemoveLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_RemoveLoopComponents_Floodgate_RatingValue_5),
this.ma.$("RemoveLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_RemoveLoopComponents_Floodgate_FloodgateWhyQuestion),this.ma.$("NotUseLoopComponents_FloodgateCommentQuestion",CommonUIStrings.l_NotUseLoopComponents_Floodgate_CommentQuestion),this.ma.$("NotUseLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingQuestion),this.ma.$("NotUseLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_1),this.ma.$("NotUseLoopComponents_FloodgateRatingValue_2",
CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_2),this.ma.$("NotUseLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_3),this.ma.$("NotUseLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_4),this.ma.$("NotUseLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_NotUseLoopComponents_Floodgate_RatingValue_5),this.ma.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),
this.ma.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.ma.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.ma.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),this.ma.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),
this.ma.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.ma.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.ma.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),this.ma.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),
this.ma.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.ma.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.ma.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),this.ma.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),
this.ma.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.ma.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.ma.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),this.ma.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),
this.ma.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.ma.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.ma.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),this.ma.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),
this.ma.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.ma.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.ma.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.ma.$("ShortcutDiscovery_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.ma.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.ma.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.ma.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.ma.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.ma.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.ma.$("ShortcutDiscovery_RatingValue_5",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.ma.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.ma.$("Fonts_PromptTitle",CommonUIStrings.l_FontExperience_FloodgatePromptTitle),this.ma.$("Fonts_PromptQuestion",CommonUIStrings.l_FontExperience_FloodgatePromptQuestion),this.ma.$("Fonts_PromptAnswer_NotNow",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_NotNow),this.ma.$("Fonts_PromptAnswer_Sure",CommonUIStrings.l_FontExperience_FloodgatePromptAnswer_Sure),
this.ma.$("Fonts_RatingQuestion",CommonUIStrings.l_FontExperience_FloodgateRatingQuestion),this.ma.$("Fonts_RatingValue_1",CommonUIStrings.l_FontExperience_FloodgateRatingValue_1),this.ma.$("Fonts_RatingValue_2",CommonUIStrings.l_FontExperience_FloodgateRatingValue_2),this.ma.$("Fonts_RatingValue_3",CommonUIStrings.l_FontExperience_FloodgateRatingValue_3),this.ma.$("Fonts_RatingValue_4",CommonUIStrings.l_FontExperience_FloodgateRatingValue_4),this.ma.$("Fonts_RatingValue_5",CommonUIStrings.l_FontExperience_FloodgateRatingValue_5),
this.ma.$("Fonts_WhyQuestion",CommonUIStrings.l_FontExperience_FloodgateWhyQuestion),this.ma.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.ma.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.ma.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),this.ma.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.ma.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.ma.$("Ruler_RatingValue_1",
CommonUIStrings.l_WordRuler_RatingValue_1),this.ma.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.ma.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.ma.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.ma.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),this.ma.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.ma.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),
this.ma.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.ma.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.ma.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.ma.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),this.ma.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.ma.$("CustomTabDialog_RatingValue_2",
CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.ma.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.ma.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.ma.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.ma.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),this.ma.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),
this.ma.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.ma.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.ma.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.ma.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),this.ma.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.ma.$("WordStyles_FloodgateRating_2",
CommonUIStrings.l_WordStyles_FloodgateRating_2),this.ma.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.ma.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.ma.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.ma.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),this.ma.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),
this.ma.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.ma.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.ma.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.ma.$("UnsavedChangesHighlight_RatingQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.ma.$("UnsavedChangesHighlight_Rating_Yes",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.ma.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.ma.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.ma.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),this.ma.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),
this.ma.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.ma.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.ma.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.ma.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),this.ma.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),
this.ma.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.ma.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.ma.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.ma.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),this.ma.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),
this.ma.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.ma.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.ma.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.ma.$("GrammarSuggestions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.ma.$("GrammarSuggestions_FloodgateRating_1",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.ma.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.ma.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.ma.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),this.ma.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.ma.$("GrammarSuggestions_FloodgateQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.ma.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.ma.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.ma.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),this.ma.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.ma.$("WordRemoveSsr_FloodgateRatingQuestion",
CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.ma.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.ma.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.ma.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.ma.$("WordRemoveSsr_FloodgateRating_4",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.ma.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),
this.ma.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.ma.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.ma.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.ma.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),this.ma.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),
this.ma.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.ma.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.ma.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.ma.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.ma.$("WordDrawing_FloodgateRating_4",CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.ma.$("WordDrawing_FloodgateRating_5",
CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.ma.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.ma.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.ma.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.ma.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.ma.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.ma.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.ma.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.ma.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.ma.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.ma.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.ma.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.ma.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.ma.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),this.ma.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),
this.ma.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.ma.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.ma.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.ma.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.ma.$("ShyRibbon_Floodgate_Option_3",CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.ma.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),
this.ma.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.ma.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.ma.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.ma.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),this.ma.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),
this.ma.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.ma.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.ma.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.ma.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),this.ma.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),
this.ma.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.ma.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.ma.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.ma.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),this.ma.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.ma.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.ma.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.ma.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),
this.ma.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.ma.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.ma.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.ma.$("PasswordProtectedDocumentSupport_FloodgateRating_4",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),
this.ma.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.ma.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.ma.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.ma.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("WordSimilarity_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.ma.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.ma.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.ma.$("WordSimilarity_FloodgateRating_3",CommonUIStrings.l_WordSimilarity_FloodgateRating_3),
this.ma.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.ma.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.ma.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.ma.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.ma.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),this.ma.$("PremiumPreviewFloodgateRatingQuestion",
CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.ma.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.ma.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.ma.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.ma.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.ma.$("FloodgateNLQSPromptSubtitle",CommonUIStrings.l_FloodgateNLQSPromptSubtitle),
this.ma.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.ma.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.ma.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.ma.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.ma.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.ma.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),this.ma.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),
this.ma.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.ma.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.ma.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.ma.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.ma.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.ma.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.ma.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.ma.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.ma.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.ma.$("ExcelWebEaseOfUse_RatingValue_4",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.ma.$("ExcelWebEaseOfUse_RatingValue_5",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.ma.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.ma.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.ma.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.ma.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.ma.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.ma.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.ma.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.ma.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.ma.$("ExcelWebPrintSurvey_RatingValue_4",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),
this.ma.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.ma.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.ma.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.ma.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.ma.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ReactAutoFilter_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.ma.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.ma.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.ma.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.ma.$("ReactAutoFilter_RatingValue_4",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),
this.ma.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.ma.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.ma.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.ma.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.ma.$("WordLinksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),
this.ma.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.ma.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.ma.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.ma.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),this.ma.$("WordLinksExperience_FloodgateRating_3",
CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.ma.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.ma.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.ma.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.ma.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),this.ma.$("OnlineVideoSupport_FloodgatePromptQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.ma.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.ma.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.ma.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.ma.$("OnlineVideoSupport_FloodgateRating_1",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),
this.ma.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.ma.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.ma.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.ma.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.ma.$("OnlineVideoSupport_FloodgateWhyQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),
this.ma.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.ma.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.ma.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.ma.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),this.ma.$("NavPaneExperience_FloodgateRatingQuestion",
CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.ma.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.ma.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.ma.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.ma.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),this.ma.$("NavPaneExperience_FloodgateRating_5",
CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.ma.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.ma.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.ma.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.ma.$("BookmarksExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),
this.ma.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.ma.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.ma.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.ma.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),this.ma.$("BookmarksExperience_FloodgateRating_3",
CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.ma.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.ma.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.ma.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.ma.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),this.ma.$("WordPictureBorder_FloodgatePromptQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.ma.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.ma.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.ma.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.ma.$("WordPictureBorder_FloodgateRating_1",CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),
this.ma.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.ma.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.ma.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.ma.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.ma.$("WordPictureBorder_FloodgateWhyQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),
this.ma.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.ma.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.ma.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.ma.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.ma.$("WordComment_FloodgateRatingQuestion",CommonUIStrings.l_WordComment_FloodgateRatingQuestion),
this.ma.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.ma.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.ma.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.ma.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.ma.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),this.ma.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),
this.ma.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.ma.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.ma.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.ma.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),this.ma.$("WordTrackChanges_FloodgateRatingQuestion",
CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.ma.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.ma.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.ma.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.ma.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),this.ma.$("WordTrackChanges_FloodgateRating_5",
CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.ma.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.ma.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.ma.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.ma.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),
this.ma.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.ma.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.ma.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.ma.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),
this.ma.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.ma.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.ma.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.ma.$("CollabCorner_Survey_DownloadCopies_Comment_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),
this.ma.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.ma.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.ma.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.ma.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),this.ma.$("WordListsExperience_FloodgateRatingQuestion",
CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.ma.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.ma.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.ma.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.ma.$("WordChartsSupport_FloodgatePromptTitle",CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),
this.ma.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.ma.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.ma.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.ma.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),this.ma.$("WordChartsSupport_FloodgateRating_1",
CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.ma.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.ma.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.ma.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.ma.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),this.ma.$("WordChartsSupport_FloodgateWhyQuestion",
CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.ma.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.ma.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.ma.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.ma.$("WordTablesSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),
this.ma.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.ma.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.ma.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.ma.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.ma.$("WordTablesSupport_FloodgateRating_4",CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),
this.ma.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.ma.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.ma.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.ma.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.ma.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ModernPresence_PromptLabel_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.ma.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.ma.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.ma.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.ma.$("ModernPresence_RatingValue_4",CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),
this.ma.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.ma.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.ma.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.ma.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.ma.$("WordInsertImages_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),
this.ma.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.ma.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.ma.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.ma.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.ma.$("WordInsertImages_FloodgateRating_3",CommonUIStrings.l_WordInsertImages_FloodgateRating_3),
this.ma.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.ma.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.ma.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.ma.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.ma.$("FontPicker_FloodgatePromptQuestion",CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),
this.ma.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.ma.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.ma.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.ma.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.ma.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),this.ma.$("FontPicker_FloodgateRating3",
CommonUIStrings.l_FontPicker_FloodgateRating3),this.ma.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.ma.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.ma.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.ma.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.ma.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.ma.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.ma.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.ma.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.ma.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.ma.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.ma.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.ma.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.ma.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.ma.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.ma.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.ma.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.ma.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.ma.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.ma.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.ma.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.ma.$("OnenotePerf_FloodgatePromptTitle",Ka.aBj()),this.ma.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.ma.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.ma.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.ma.$("OnenotePerf_FloodgateRatingQuestion",Ka.bBj()),this.ma.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.ma.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.ma.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.ma.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.ma.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.ma.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.ma.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.ma.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.ma.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.ma.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.ma.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.ma.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.ma.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.ma.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.ma.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.ma.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.ma.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.ma.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.ma.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.ma.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.ma.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.ma.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.ma.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.ma.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.ma.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.ma.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.ma.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.ma.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.ma.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.ma.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.ma.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.ma.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.ma.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.ma.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.ma.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.ma.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.ma.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.ma.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.ma.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.ma.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.ma.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.ma.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.ma.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.ma.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.ma.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.ma.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.ma.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.ma.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.ma.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.ma.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.ma.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.ma.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.ma.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.ma.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.ma.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.ma.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.ma.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.ma.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.ma.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.ma.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.ma.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.ma.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.ma.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.ma.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.ma.$("WordDesignerDesignerPasteFeedbackRatingQuestion",Ka.cBj()),this.ma.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.ma.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.ma.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.ma.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.ma.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.ma.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.ma.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.ma.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.ma.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.ma.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.ma.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.ma.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.ma.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.ma.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.ma.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.ma.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.ma.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.ma.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.ma.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.ma.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.ma.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.ma.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.ma.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.ma.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.ma.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.ma.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.ma.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.ma.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.ma.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.ma.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.ma.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.ma.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.ma.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.ma.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.ma.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.ma.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.ma.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.ma.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.ma.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.ma.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.ma.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.ma.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.ma.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.ma.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.ma.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.ma.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.ma.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.ma.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.ma.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.ma.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.ma.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.ma.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.ma.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.ma.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.ma.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.ma.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.ma.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.ma.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.ma.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.ma.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.ma.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.ma.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.ma.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.ma.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.ma.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.ma.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.ma.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.ma.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.ma.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.ma.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.ma.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.ma.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.ma.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.ma.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.ma.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.ma.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.ma.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.ma.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.ma.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.ma.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.ma.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.ma.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.ma.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.ma.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.ma.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.ma.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.ma.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.ma.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.ma.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.ma.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.ma.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.ma.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.ma.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.ma.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.ma.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.ma.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.ma.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.ma.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.ma.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.ma.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.ma.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.ma.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.ma.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.ma.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.ma.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.ma.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.ma.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.ma.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.ma.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.ma.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.ma.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.ma.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.ma.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.ma.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.ma.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.ma.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.ma.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.ma.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.ma.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.ma.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.ma.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.ma.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.ma.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.ma.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.ma.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.ma.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.ma.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.ma.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.ma.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.ma.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.ma.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.ma.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.ma.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.ma.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.ma.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.ma.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.ma.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.ma.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.ma.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.ma.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.ma.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.ma.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.ma.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.ma.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.ma.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.ma.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.ma.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.ma.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.ma.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.ma.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.ma.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.ma.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.ma.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.ma.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.ma.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.ma.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.ma.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.ma.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.ma.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.ma.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.ma.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.ma.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.ma.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.ma.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.ma.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.ma.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.ma.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.ma.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.ma.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.ma.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.ma.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.ma.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.ma.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.ma.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.ma.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.ma.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.ma.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.ma.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.ma.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.ma.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.ma.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.ma.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.ma.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.ma.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.ma.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.ma.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.ma.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.ma.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.ma.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.ma.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.ma.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.ma.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.ma.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.ma.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.ma.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.ma.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.ma.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.ma.$("Toolbar_Floodgate_Prompt_Line1",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Line1),
this.ma.$("Toolbar_Floodgate_Prompt_Line2",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Line2),this.ma.$("Toolbar_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Affirmative_Answer),this.ma.$("Toolbar_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_Toolbar_Floodgate_Prompt_Negative_Answer),this.ma.$("Toolbar_Floodgate_Rating_Question",CommonUIStrings.l_Toolbar_Floodgate_Rating_Question),this.ma.$("Toolbar_Floodgate_Rating_Scale_1",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_1),
this.ma.$("Toolbar_Floodgate_Rating_Scale_2",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_2),this.ma.$("Toolbar_Floodgate_Rating_Scale_3",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_3),this.ma.$("Toolbar_Floodgate_Rating_Scale_4",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_4),this.ma.$("Toolbar_Floodgate_Rating_Scale_5",CommonUIStrings.l_Toolbar_Floodgate_Rating_Scale_5),this.ma.$("Toolbar_Floodgate_Comment_Question",CommonUIStrings.l_Toolbar_Floodgate_Comment_Question),this.ma.$("ToolbarOptOut_Floodgate_Prompt_Line1",
CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Line1),this.ma.$("ToolbarOptOut_Floodgate_Prompt_Line2",CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Line2),this.ma.$("ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Affirmative_Answer),this.ma.$("ToolbarOptOut_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_ToolbarOptOut_Floodgate_Prompt_Negative_Answer),this.ma.$("ToolbarOptOut_Floodgate_Rating_Question",CommonUIStrings.l_ToolbarOptOut_Floodgate_Rating_Question),
this.ma.$("ToolbarOptOut_Floodgate_Rating_Scale_1",CommonUIStrings.l_ToolbarOptOut_Floodgate_Rating_Scale_1),this.ma.$("ToolbarOptOut_Floodgate_Rating_Scale_2",CommonUIStrings.l_ToolbarOptOut_Floodgate_Rating_Scale_2),this.ma.$("ToolbarOptOut_Floodgate_Comment_Question",CommonUIStrings.l_ToolbarOptOut_Floodgate_Comment_Question),this.ma.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.ma.$("PerformanceExperience_RatingQuestion",Ka.x9b(0)),this.ma.$("PerformanceExperience_RatingQuestion_OpenFile",Ka.x9b(1)),this.ma.$("PerformanceExperience_RatingQuestion_Responsivness",Ka.x9b(2)),this.ma.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Ka.x9b(3)),this.ma.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Ka.x9b(4)),this.ma.$("PerformanceExperience_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.ma.$("PerformanceExperience_RatingValue_2",
CommonUIStrings.l_Excel_Rating_2_Satisfied),this.ma.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.ma.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.ma.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.ma.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),this.ma.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),
this.ma.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.ma.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.ma.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),this.ma.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),
this.ma.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.ma.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.ma.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.ma.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.ma.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),this.ma.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.ma.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.ma.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.ma.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.ma.$("DarkModeSurvey_RatingValue_3",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.ma.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.ma.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.ma.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.ma.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),this.ma.$("Fluent2Survey_Question",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.ma.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.ma.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.ma.$("Fluent2Survey_RatingValue_2",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),
this.ma.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.ma.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.ma.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.ma.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.ma.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),
this.ma.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.ma.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),this.ma.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),
this.ma.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.ma.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.ma.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.ma.$("ConsumerExperiment_PromptQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.ma.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),
this.ma.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.ma.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.ma.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.ma.$("ConsumerExperiment_RatingValue4",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.ma.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),
this.ma.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.ma.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),this.ma.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.ma.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),
this.ma.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.ma.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.ma.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.ma.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.ma.$("AIMakerSurvey_CommentQuestion",CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.ma.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.ma.$("CheckPerformance_PromptQuestion",
CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.ma.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),this.ma.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.ma.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),
this.ma.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.ma.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.ma.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.ma.$("CheckPerformance_CommentQuestion",CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.ma.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.ma.$("SmartSuggestion_PromptQuestion",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.ma.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),this.ma.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.ma.$("SmartSuggestion_RatingValue_2",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.ma.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.ma.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.ma.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),this.ma.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.ma.$("ArgumentAssistance_PromptTitle",
CommonUIStrings.l_Excel_ArgumentAssistance_Survey_PromptTitle),this.ma.$("ArgumentAssistance_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.ma.$("ArgumentAssistance_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("ArgumentAssistance_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("ArgumentAssistance_RatingQuestion",CommonUIStrings.l_Excel_ArgumentAssistance_Survey_RatingQuestion),this.ma.$("ArgumentAssistance_RatingValue_1",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.ma.$("ArgumentAssistance_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.ma.$("ArgumentAssistance_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.ma.$("ArgumentAssistance_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.ma.$("ArgumentAssistance_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),this.ma.$("ArgumentAssistance_CommentQuestion",
CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.ma.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.ma.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.ma.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("PPTO_Picture_FloodgateRatingQuestion",
CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.ma.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.ma.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.ma.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.ma.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.ma.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.ma.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.ma.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.ma.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.ma.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.ma.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.ma.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.ma.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.ma.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.ma.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.ma.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.ma.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.ma.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion),this.ma.$("FRE_FirstTeachingCalloutTitle",CommonUIStrings.l_FRE_FirstTeachingCalloutTitle),this.ma.$("FRE_FirstTeachingCalloutDescription",CommonUIStrings.l_FRE_FirstTeachingCalloutDescription),this.ma.$("FRE_TeachingCalloutNextButtonText",CommonUIStrings.l_FRE_TeachingCalloutNextButtonText),
this.ma.$("FRE_SecondTeachingCalloutTitle",CommonUIStrings.l_FRE_SecondTeachingCalloutTitle),this.ma.$("FRE_SecondTeachingCalloutDescription",CommonUIStrings.l_FRE_SecondTeachingCalloutDescription),this.ma.$("FRE_ThirdTeachingCalloutTitle",CommonUIStrings.l_FRE_ThirdTeachingCalloutTitle),this.ma.$("FRE_ThirdTeachingCalloutDescription",CommonUIStrings.l_FRE_ThirdTeachingCalloutDescription),this.ma.$("FRE_TeachingCalloutGotItButtonText",CommonUIStrings.l_FRE_TeachingCalloutGotItButtonText),this.ma.$("FloodgateSurveyNoRealEditPromptTitle",
CommonUIStrings.l_FloodgateSurveyNoRealEditPromptTitle),this.ma.$("FloodgateSurveyNoRealEditPromptQuestion",CommonUIStrings.l_FloodgateSurveyNoRealEditPromptQuestion),this.ma.$("FloodgateSurveyNoRealEditSure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FloodgateSurveyNoRealEditNotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FloodgateSurveyNoRealEditQuestion1",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion1),this.ma.$("FloodgateSurveyNoRealEditOption1",CommonUIStrings.l_FloodgateSurveyNoRealEditOption1),
this.ma.$("FloodgateSurveyNoRealEditOption2",CommonUIStrings.l_FloodgateSurveyNoRealEditOption2),this.ma.$("FloodgateSurveyNoRealEditOption3",CommonUIStrings.l_FloodgateSurveyNoRealEditOption3),this.ma.$("FloodgateSurveyNoRealEditOption4",CommonUIStrings.l_FloodgateSurveyNoRealEditOption4),this.ma.$("FloodgateSurveyNoRealEditOption5",CommonUIStrings.l_FloodgateSurveyNoRealEditOption5),this.ma.$("FloodgateSurveyNoRealEditQuestion2",CommonUIStrings.l_FloodgateSurveyNoRealEditQuestion2),this.ma.$("FormulaByExample_PromptTitle",
CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptTitle),this.ma.$("FormulaByExample_PromptQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_PromptQuestion),this.ma.$("FormulaByExample_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FormulaByExample_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FormulaByExample_RatingQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingQuestion),this.ma.$("FormulaByExampleIgnored_RatingQuestion",
CommonUIStrings.l_Excel_FormulaByExampleIgnored_Survey_RatingQuestion),this.ma.$("FormulaByExample_RatingValue_1",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_1),this.ma.$("FormulaByExample_RatingValue_2",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_2),this.ma.$("FormulaByExample_RatingValue_3",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_3),this.ma.$("FormulaByExample_RatingValue_4",CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_4),this.ma.$("FormulaByExample_RatingValue_5",
CommonUIStrings.l_Excel_FormulaByExample_Survey_RatingValue_5),this.ma.$("FormulaByExample_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExample_Survey_CommentQuestion),this.ma.$("FormulaByExampleDeclined_CommentQuestion",CommonUIStrings.l_Excel_FormulaByExampleDeclined_Survey_CommentQuestion),this.ma.$("CIQSeenNotKeptFPS_Title",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Title),this.ma.$("CIQSeenNotKeptFPS_Question",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_Question),this.ma.$("CIQSeenNotKeptFPS_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("CIQSeenNotKeptFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("CIQSeenNotKeptFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_RatingQuestion),this.ma.$("CIQSeenNotKeptFPS_RatingValue_Yes",CommonUIStrings.l_DialogYes),this.ma.$("CIQSeenNotKeptFPS_RatingValue_No",CommonUIStrings.l_DialogNo),this.ma.$("CIQSeenNotKeptFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQSeenNotKeptFPS_WhyQuestion),this.ma.$("FloodgateSurveyProofingSuggestions_PromptTitle",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptTitle),this.ma.$("FloodgateSurveyProofingSuggestions_PromptQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion),this.ma.$("FloodgateSurveyProofingSuggestions_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.ma.$("FloodgateSurveyProofingSuggestions_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.ma.$("FloodgateSurveyProofingSuggestions_WhyQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion1),
this.ma.$("FloodgateSurveyProofingSuggestions_Option_1",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption1),this.ma.$("FloodgateSurveyProofingSuggestions_Option_2",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption2),this.ma.$("FloodgateSurveyProofingSuggestions_Option_3",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption3),this.ma.$("FloodgateSurveyProofingSuggestions_Option_4",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption4),this.ma.$("FloodgateSurveyProofingSuggestions_Option_5",
CommonUIStrings.l_FloodgateSurveyProofingSuggestionsOption5),this.ma.$("FloodgateSurveyProofingSuggestions_AdditionalDetailsQuestion",CommonUIStrings.l_FloodgateSurveyProofingSuggestionsPromptQuestion2),this.ma.$("MultiColumnsSurvey_Title",CommonUIStrings.l_WAC_MultiColumnsSurvey_Title),this.ma.$("MultiColumnsSurvey_Question",CommonUIStrings.l_WAC_MultiColumnsSurvey_Question),this.ma.$("MultiColumnsSurvey_YesLabel",CommonUIStrings.l_WAC_MultiColumnsSurvey_YesLabel),this.ma.$("MultiColumnsSurvey_NoLabel",
CommonUIStrings.l_WAC_MultiColumnsSurvey_NoLabel),this.ma.$("MultiColumnsSurvey_RatingQuestion",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingQuestion),this.ma.$("MultiColumnsSurvey_RatingValue_1",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingValue_1),this.ma.$("MultiColumnsSurvey_RatingValue_5",CommonUIStrings.l_WAC_MultiColumnsSurvey_RatingValue_5),this.ma.$("MultiColumnsSurvey_ImproveQuestion",CommonUIStrings.l_WAC_MultiColumnsSurvey_ImproveQuestion),this.ma.$("WordOnlineShare_FloodgatePromptTitle",
CommonUIStrings.l_WordOnlineShare_FloodgatePromptTitle),this.ma.$("WordOnlineShare_FloodgatePromptQuestion",CommonUIStrings.l_WordOnlineShare_FloodgatePromptQuestion),this.ma.$("WordOnlineShare_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordOnlineShare_FloodgatePrompt_YesLabel),this.ma.$("WordOnlineShare_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordOnlineShare_FloodgatePrompt_NoLabel),this.ma.$("WordOnlineShare_FloodgateRatingQuestion",CommonUIStrings.l_WordOnlineShare_FloodgateRatingQuestion),
this.ma.$("WordOnlineShare_FloodgateRating_1",CommonUIStrings.l_WordOnlineShare_FloodgateRating_1),this.ma.$("WordOnlineShare_FloodgateRating_2",CommonUIStrings.l_WordOnlineShare_FloodgateRating_2),this.ma.$("WordOnlineShare_FloodgateRating_3",CommonUIStrings.l_WordOnlineShare_FloodgateRating_3),this.ma.$("WordOnlineShare_FloodgateRating_4",CommonUIStrings.l_WordOnlineShare_FloodgateRating_4),this.ma.$("WordOnlineShare_FloodgateRating_5",CommonUIStrings.l_WordOnlineShare_FloodgateRating_5),this.ma.$("WordOnlineShare_FloodgateWhyQuestion",
CommonUIStrings.l_WordOnlineShare_FloodgateWhyQuestion)}catch(Wa){h.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(Wa?Wa.toString():""))}}static oVi(Wa){try{return new Promise(db=>{window.setTimeout(()=>{db(null)},Wa)})}catch(db){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),Promise.resolve(null)}}static A9f(){return!m.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static Yrj(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",
!1)}static V0i(){return m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableWebCampaignGovernance",!1)}static d1d(Wa){const db=Wa?Wa[0]:null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(db?db.surfaceId:""));if(db&&"customsurface"===(db&&db.surfaceType?db.surfaceType.toLocaleLowerCase():null)){const ub=wa.a.LJj(db);if(ub)return h.ULS.sendTraceTag(555071522,356,50,"SIFB Info:Floodgate activation result - "+ub+", "+db.surfaceId),null}return jb.d1d(Wa)}static klj(){const Wa=
{};Wa.retry=m.AFrameworkApplication.fa.uc("FloodgateGovernanceServiceRetryCount",0);Wa.timeout=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);Wa.simpleRequestEnabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);Wa.forceServicelessSurveyDisplay=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",
!1);return Wa}static UMi(Wa){if(!("Unknown"!==Wa&&"Automation"!==Wa&&m.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+Wa),null;Wa={};Wa.getUserPuid=Ka.aAj;m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PersonalizationOAuthManagerEnabled",!1)&&(Wa.getAuthToken=
Ka.getAuthToken);return Wa}static uQi(){const Wa={};Wa.enabled=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PersonalizationUserFactsReadConfigEnabled",!1);return Wa}static getAuthToken(Wa){return Wa&&Wa.scenario?"tulips"===Wa.scenario.toLowerCase()?zb.dfl():null:(h.ULS.sendTraceTag(508905240,356,50,"SIFB Invalid authCallback params"),null)}static RMi(){const Wa={},db=!m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",
!1)&&(m.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));Wa.isEnabled=db;return Wa}static aAj(){return m.AFrameworkApplication.fa.Ha("Puid")}static tbe(Wa){if(!Wa||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableFloodgateTriggerFlightIdLog",!1))return null;try{const db=(m.AFrameworkApplication.fa.Ha("FlightId")||"").toLocaleLowerCase(),ub=
Wa.toString().toLocaleLowerCase().split(";");for(const Lb of ub)if(-1!==db.indexOf(Lb))return Lb}catch(db){h.ULS.sendTraceTag(508961431,306,50,"Error retrieving flightId of campaign event -"+(db?db.toString():""))}return null}static ufg(){return wa.a.hva()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static tfg(){return wa.a.hva()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static sfg(){return wa.a.hva()&&
m.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static x9b(Wa){if(wa.a.hva())switch(Wa){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;
case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(Wa){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;
default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static $Aj(){return wa.a.hva()&&m.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static bBj(){return wa.a.hva()?CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static aBj(){return wa.a.hva()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:
CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static cBj(){switch(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}Ka.Lhb="SystemInitiatedFeedbackIsEnabled";
Ka.Bzi="obf-CampaignDefinitions";Ka.BTf=100;Ka.UUi=8002;Object(K.a)(Ka,"SystemInitiatedFeedback",null,[1107]);class Db{constructor(Wa){if(!Wa)throw Error.argumentNull("SystemInitiatedFeedback is null");this.ivf=Wa;this.NBd={};this.Pyc={};this.KBd={}}logActivity(Wa,db,ub){const Lb=new Date;if(!Wa||!this.ivf.u$a(Wa,Ka.Lhb,db))return!1;let Kb=null;Wa in this.NBd&&(Kb=this.NBd[Wa]);const uc=this.Xcj(Wa),Yb=this.Wcj(Wa);if(this.q1i(Kb,Lb,ub))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",
uc,Wa),this.ivf.logActivity(Wa,db),this.NBd[Wa]=Lb,this.Pyc[Wa]=0,this.KBd[Wa]=Yb+1,!0;this.Pyc[Wa]=uc+1;return!1}q1i(Wa,db,ub){return Wa?db.getTime()-Wa.getTime()>=1E3*ub:!0}Xcj(Wa){let db=0;Wa in this.Pyc&&(db=this.Pyc[Wa]);return db}Wcj(Wa){let db=0;Wa in this.KBd&&(db=this.KBd[Wa]);return db}}Object(K.a)(Db,"SystemInitiatedFeedbackWithTimeLapse",null,[1223]);var bc=d(96),Mc=d(71);d.d(S,"CustomerFeedbackPackage",function(){return mb});class mb{constructor(){this.Jff=this.Ea=null}get name(){return"Common.App.CustomerFeedback"}Xb(Wa){m.AFrameworkApplication.Rg||
(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),m.AFrameworkApplication.Rg=new z.a);Wa.register(U,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").na();Wa.register(pa,"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").na().oa(()=>new pa(bc.FocusManager.instance(),m.AFrameworkApplication.Rg));Wa.register(F,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").na().oa(()=>
new F(Wa.resolve("Common.App.ICustomerFeedbackUiWrapper"),Wa.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),m.AFrameworkApplication.Rg));Wa.register(1029,"Common.ICustomerFeedbackActor").na().oa(()=>new J(m.AFrameworkApplication.Qa,m.AFrameworkApplication.Aa,Wa.Ia("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),m.AFrameworkApplication.fa,m.AFrameworkApplication.Rg));Wa.register(Ka,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").na().oa(()=>
new Ka(Wa.resolve("Common.App.ICustomerFeedbackUiWrapper")));Wa.register(Db,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").na().oa(()=>new Db(Wa.resolve("Common.ISystemInitiatedFeedback")));this.Ea=Wa}init(){mb._initialized||(mb.odc()||(this.Jff=this.Ea.resolve("Common.ICustomerFeedbackActor"),this.Jff.vb(),m.AFrameworkApplication.Aa.updateCommandUI()),this.Ea.Ia("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Ea.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");
this.Ea.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),mb._initialized=!0)}dispose(){}static odc(){return!!m.AFrameworkApplication.Aa&&!!m.AFrameworkApplication.Aa.mb&&3===m.AFrameworkApplication.Aa.mb.Ti&&1===m.AFrameworkApplication.Aa.mb.LJa}static main(){let Wa=!1;mb.odc()&&(Wa=!0);Mc.a.instance.Ac(new mb,0,Wa)}}mb._initialized=!1;Object(K.a)(mb,"CustomerFeedbackPackage",null,[2,3])},1199:function(K,S,d){K=d(0);var h=d(7),e=d(36);class r{constructor(){this.classId=
0}static t9a(x){try{return e.a(x)}catch(B){}return null}}Object(K.a)(r,"ARoamingAppsResponse",null,[]);class m{constructor(){this.state=this.callback=null;this.$oe=!1}}Object(K.a)(m,"GetRoamingAppsLauncherContext",null,[]);var n=d(27),z=d(82);d.d(S,"a",function(){return t});class t{constructor(x){this.ADd=!1;this.c8=t.Jbb;this.EOd=this.cMd=0;this.platform=null;this.c9h=x;this.kxf=this.FOd=!1}get jZe(){return this.c9h}get PWl(){return this.jZe&&this.FOd?this.kxf:!1}YCi(){n.AFrameworkApplication.$bc&&
this.jZe&&!this.FOd&&!this.ADd&&(this.EOd=3,this.ADd=!0,this.Rfl(),this.w_f())}Rfl(){this.c8=t.Jbb;this.cMd=0}getRoamingAppsLauncher(x,B,D){this.PWl?(x=new m,x.callback=B,x.state=D,x.$oe=!0,this.B_f(x)):B(!1,"",D)}w_f(){const x=new (d(1161).CheckRoamingRightsRequest);x.RoamingApp=this.EOd;x.BaseDocQuerySignature=n.AFrameworkApplication.Pg;x.execute(Object(h.a)(this,this.$Ci,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.ZCi,"checkUserRoamingRightsFailed"),null)}$Ci(x){n.AFrameworkApplication.Yg||
((x=r.t9a(x.data.Wd))?this.T1e(x.HasRights):this.T1e(!1))}ZCi(){if(!n.AFrameworkApplication.Yg)if(this.cMd>=t.jzk)this.T1e(!1);else{var x=new z.a(2,1,this.c8,Object(h.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);n.AFrameworkApplication.De.Hb(x);this.cMd++;this.c8*=t.XYe;this.c8>t.Olc&&(this.c8=t.Olc)}}T1e(x){this.kxf=x;this.FOd=!0;this.ADd=!1}retryCheckUserRoamingRights(){this.w_f()}B_f(x){const B=new (d(1162).GetRoamingLauncherRequest);B.RoamingApp=this.EOd;B.BaseDocQuerySignature=
n.AFrameworkApplication.Pg;B.execute(Object(h.a)(this,this.utj,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.ttj,"getRoamingAppsLauncherFailed"),x)}utj(x){if(!n.AFrameworkApplication.Yg){var B=r.t9a(x.data.Wd);x=x.data.state;B?(this.platform=B.Platform,x.callback(!0,B.Launcher,x.state)):x.callback(!1,"",x.state)}}ttj(x){if(!n.AFrameworkApplication.Yg){var B=x.data.state;5===x.data.status&&B.$oe?(B.$oe=!1,this.B_f(B)):B.callback(!1,"",B.state)}}static get instance(){return t.Yt||(t.Yt=new t(n.AFrameworkApplication.Ypi))}}
t.Jbb=1E3;t.XYe=5;t.Olc=12E5;t.jzk=5;t.Yt=null;Object(K.a)(t,"RoamingAppsManager",null,[])},1200:function(K,S,d){K=d(0);var h=d(7),e=d(976),r=d(67);class m extends e.a{constructor(w,J,F,L,M,Q=null){super(w,F,M.tS,Q);this.upf=0;this.Mba=this.Ooj(L);this.usb=J;this.Yh=M;this.i8e=7;this.vs=this.usb.ownerDocument.createElement("div");this.vs.className="ModalCalloutControlOverlay";this.vs.tabIndex=0;this.usb.insertBefore(this.vs,this.usb.firstChild)}show(){this.WL||(this.Yh.tjb(),this.Yh.nRa(!1),this.vs.style.zIndex=
String(this.Yh.Ura),super.show(),this.Jt(),this.upf=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.i8e))}dismiss(){this.WL&&(this.Yh.aTa(!1),this.Ypa(),this.usb&&this.usb.contains(this.vs)&&this.usb.removeChild(this.vs),super.dismiss(),window.clearTimeout(this.upf))}Jt(){this.Yh.q8(Object(h.a)(this,this.dismiss,"dismiss"));this.Yh.$y.ub(r.a.click,this.vs,Object(h.a)(this,this.onClick,"onClick"))}Ypa(){this.Yh.kLa(Object(h.a)(this,this.dismiss,"dismiss"));this.Yh.$y.Bb(r.a.click,
this.vs,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}Ooj(w){let J=0;switch(w){case 0:J=190;break;case 1:J=250;break;case 2:J=300;break;case 3:J=360}return J}}Object(K.a)(m,"ModalCallout",e.a,[]);var n=d(395),z=d(358),t=d(143);class x extends m{constructor(w,J,F,L,M,Q=null){super(w,J,F,L,M,Q);this.IEc=null}show(){if(!this.WL){const w=Object.assign(new z.a,{onShow:()=>{m.prototype.show.call(this)}});t.UISurfaces.KL().then(J=>{const F=J.externalNotification();this.IEc=
J.addNotification(F,w);return null},J=>{n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}}dismiss(){this.WL&&this.IEc&&(t.UISurfaces.KL().then(w=>{w.removeNotification(this.IEc);return this.IEc=null},w=>{n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",w);return null}),super.dismiss())}}Object(K.a)(x,"ReactManagedModalCallout",m,[]);var B=d(27);d.d(S,"a",function(){return D});class D{static l2d(w,J,F,L,M=null){return B.AFrameworkApplication.Aa.mb.iWa?
new x(w,J,F,L,B.AFrameworkApplication.Aa,M):new m(w,J,F,L,B.AFrameworkApplication.Aa,M)}}Object(K.a)(D,"ModalCalloutControlFactory",null,[])},1201:function(K,S,d){d.r(S);K=d(0);var h=d(527),e=d(528);class r{constructor(t){this.bQ=this.Gef=h.a.unused;this.fHc=t}get cvb(){return this.Gef}zMe(t,x,B,D){B===this.fHc.element&&(this.Gef=t,this.bQ=D+this.fHc.offset)}wOe(){}fYd(t){return this.cvb!==h.a.unused?Object.assign(new e.a,{element:t,offset:this.bQ}):null}}Object(K.a)(r,"ChildSelectionHelper",null,
[1485]);class m{constructor(t,x){this.vLd=!1;this.fHc=x;this._parent=t;this.bQ=x.offset}get cvb(){return h.a.unused}zMe(t,x,B,D){x||this.fHc.offset!==t||(this.bQ=D,this.vLd=!0)}wOe(t,x){!this.vLd&&this.bQ>x&&(this.bQ-=x-t+1)}fYd(t){return Object.assign(new e.a,{element:this.vLd?t:this._parent,offset:this.bQ})}}Object(K.a)(m,"ParentSelectionHelper",null,[1485]);var n=d(931);d.d(S,"CombineHelper",function(){return z});class z{constructor(t,x,B){this.xhf=h.a.unused;this.pTb="";this._element=t;this.tZb=
x;this.UYb=this.m7f(t,B.start);this.RYb=this.m7f(t,B.end)}m7f(t,x){return x.element===t?new m(t,x):new r(x)}hhi(t){const x=t===this.tZb,B=this._element.childNodes[t],D=this.pTb.length;this.UYb.zMe(t,x,B,D);this.RYb.zMe(t,x,B,D);this.pTb+=B.nodeValue}end(t,x){this.tZb!==x&&(this.xhf=x,Array.add(t,this))}hGi(){var t=this.Qrj();this.Wph(this.tZb,t-1);this.Wph(t+1,this.xhf);t=this._element.childNodes[this.tZb];this.pTb!==t.nodeValue&&(t.nodeValue=this.pTb);return this.cwi(t)}Wph(t,x){if(!(x<t)){this.UYb.wOe(t,
x);this.RYb.wOe(t,x);for(let B=t;B<=x;B++)this._element.removeChild(this._element.childNodes[t])}}cwi(t){return Object.assign(new n.a,{start:this.UYb.fYd(t),end:this.RYb.fYd(t)})}Qrj(){return this.UYb.cvb!==h.a.unused?this.UYb.cvb:this.RYb.cvb!==h.a.unused?this.RYb.cvb:this.tZb}}Object(K.a)(z,"CombineHelper",null,[])},1207:function(K,S,d){K=d(0);var h=d(1252),e=d(395),r=d(27),m=d(82),n=d(72);class z{static eBj(){if(!z.Wyc&&(z.Wyc=new n.a,r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.gu("AggregatorIdDisabledList"))){const B=
r.AFrameworkApplication.fa.ty("AggregatorIdDisabledList");for(let D=0;D<B.length;D++)z.Wyc.$(B[D],!0)}return z.Wyc}}z.Wyc=null;Object(K.a)(z,"DisabledAggregatorListStore",null,[]);var t=d(285);d.d(S,"a",function(){return x});class x{constructor(B,D,w,J,F,L=!0,M=null){this.ygf=this.Nvf=this.Mmf=!1;this.ae=null;if(!B)throw t.a.argument("taskManagerLazy");if(!F)throw t.a.argument("dataAggregator");this.Fai=B;this.qMd=D;this._id=w;this.Okf=6E4*J;this.EAc=F;this.gtf=L;this.HYb=M;z.eBj().Gb(this._id.toString())&&
(this.ygf=!0)}get taskManager(){return this.ae||(this.ae=this.Fai.value)}track(B,D=null){this.ygf||(this.J2i(),this.hkl(),this.EAc.b0b(B,D))}hkl(){!this.Mmf&&0<this.Okf&&(this.Mmf=!0,this.Swh())}Swh(){const B=new m.a(5,1,this.Okf,()=>{this.Ull()},19,this._id.toString());this.taskManager.Hb(B)}Ull(){!this.HYb||this.HYb.J2e()?this.Jsd():this.gtf&&this.EAc.reset();this.Swh()}Jsd(){const B=this.EAc.getData();if(B){const D=parseInt(String(B.length));if(isNaN(D)||0<D)this.dyh(B),this.gtf&&this.EAc.reset()}}dyh(B){e.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:B})}J2i(){this.Nvf||(this.qMd(()=>{this.Jsd()}),this.Nvf=!0)}static Kr(B,D,w,J,F){return new x(new h.a(()=>r.AFrameworkApplication.De),r.AFrameworkApplication.$ga,B,D,w,J,F)}static ZW(B,D,w,J=!0){return x.Kr(B,D,w,J,null)}}Object(K.a)(x,"Aggregator",null,[1342])},126:function(K,S,d){d.d(S,"a",function(){return h});d.d(S,"b",function(){return e});const h=r=>null===r||"undefined"===typeof r||!r.length,e=r=>null===r||"undefined"===typeof r},
1281:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=9]="teamsElectron"})(h||(h={}));Object(K.b)("BrowserCode",h)},1282:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.value=!1}}Object(K.a)(h,"OutBool",null,[])},
1283:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(K.a)(h,"ColorCellProps",null,[])},1284:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(362);class h extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}Object(K.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1285:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(521);class e{constructor(r){this.eda=r}S_e(r){return h.a.then(this.eda.Psb(r,
1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),m=>this.ltj(m))}ltj(r){return r&&r.xj&&r.xj.data?r.xj.data.Wd:null}}Object(K.a)(e,"SimpleRequestManager",null,[1534])},1286:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(301);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.eAb;h.Image32by32Class=d.a.vFa;h.Image48by48Class=d.a.Bie;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(K.a)(h,"ButtonCommandProperties",null,
[])},1287:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.horizontal=0]="horizontal";e[e.vertical=1]="vertical"})(h||(h={}));Object(K.b)("Orientation",h)},1288:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.isEnabled=1]="isEnabled";e[e.execute=2]="execute";e[e.animation=3]="animation"})(h||(h={}));Object(K.b)("ActionBehavior",h)},1289:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS";
e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid";e[e.msoulscat_ES_EWAJSHeaderResize=2]="msoulscat_ES_EWAJSHeaderResize";e[e.msoulscat_ES_EWAJSKeyboard=3]="msoulscat_ES_EWAJSKeyboard";e[e.msoulscat_ES_EWAJSTest=4]="msoulscat_ES_EWAJSTest";e[e.msoulscat_ES_EWAJSFloatingObjects=5]="msoulscat_ES_EWAJSFloatingObjects";e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart";e[e.msoulscat_ES_MobileEwa=7]="msoulscat_ES_MobileEwa";e[e.msoulscat_ES_EWAJSBIExplore=8]="msoulscat_ES_EWAJSBIExplore";e[e.msoulscat_ES_EWAJSNov=
9]="msoulscat_ES_EWAJSNov";e[e.msoulscat_ES_EWAJSExcelEverywhere=10]="msoulscat_ES_EWAJSExcelEverywhere";e[e.msoulscat_ES_EWAJSTp=11]="msoulscat_ES_EWAJSTp";e[e.msoulscat_ES_EWAJSComment=12]="msoulscat_ES_EWAJSComment";e[e.msoulscat_ES_EWAJSOCSIntegration=13]="msoulscat_ES_EWAJSOCSIntegration";e[e.msoulscat_bULS_Uploader=100]="msoulscat_bULS_Uploader";e[e.msoulscat_bULS_CachingHost=101]="msoulscat_bULS_CachingHost";e[e.msoulscat_bULS_Core=102]="msoulscat_bULS_Core";e[e.msoulscat_bULS_Assert=103]=
"msoulscat_bULS_Assert";e[e.msoulscat_Osi_MsoSpLogging=200]="msoulscat_Osi_MsoSpLogging";e[e.msoulscat_MSOSP_Error=201]="msoulscat_MSOSP_Error";e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands";e[e.msoulscat_MSOSP_MsoSpRenameManager=203]="msoulscat_MSOSP_MsoSpRenameManager";e[e.msoulscat_MSOSP_CrossDocumentMessenger=204]="msoulscat_MSOSP_CrossDocumentMessenger";e[e.msoulscat_MSOSP_ClientRequestManager=205]="msoulscat_MSOSP_ClientRequestManager";e[e.msoulscat_MSOSP_DownloadQueue=
206]="msoulscat_MSOSP_DownloadQueue";e[e.msoulscat_MSOSP_CommandUI=207]="msoulscat_MSOSP_CommandUI";e[e.msoulscat_MSOSP_AppSettings=208]="msoulscat_MSOSP_AppSettings";e[e.msoulscat_MSOSP_CommonDebug=209]="msoulscat_MSOSP_CommonDebug";e[e.msoulscat_MSOSP_DomUtils=210]="msoulscat_MSOSP_DomUtils";e[e.msoulscat_MSOSP_OIC=211]="msoulscat_MSOSP_OIC";e[e.msoulscat_MSOSP_AnonEdit=212]="msoulscat_MSOSP_AnonEdit";e[e.msoulscat_MSOSP_Activity=213]="msoulscat_MSOSP_Activity";e[e.msoulscat_MSOSP_AnonCreate=214]=
"msoulscat_MSOSP_AnonCreate";e[e.msoulscat_MSOSP_O365ShellService=215]="msoulscat_MSOSP_O365ShellService";e[e.msoulscat_MSOSP_SaveToCloudStorage=216]="msoulscat_MSOSP_SaveToCloudStorage";e[e.msoulscat_MSOSP_SessionExpirationManager=217]="msoulscat_MSOSP_SessionExpirationManager";e[e.msoulscat_MSOSP_TaskManager=218]="msoulscat_MSOSP_TaskManager";e[e.msoulscat_MSOSP_SaveAsToHost=219]="msoulscat_MSOSP_SaveAsToHost";e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands";e[e.msoulscat_MSOSP_CookieCompliance=
221]="msoulscat_MSOSP_CookieCompliance";e[e.msoulscat_Osi_MsoSpOfflineLogger=222]="msoulscat_Osi_MsoSpOfflineLogger";e[e.msoulscat_MSOSP_Signals=223]="msoulscat_MSOSP_Signals";e[e.msoulscat_MSOSP_Skills=224]="msoulscat_MSOSP_Skills";e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS";e[e.msoulscat_MSOSP_OTelJSBootstrap=226]="msoulscat_MSOSP_OTelJSBootstrap";e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker";e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype";
e[e.msoulscat_MSOSP_OTelJSTest=229]="msoulscat_MSOSP_OTelJSTest";e[e.msoulscat_MSOSP_LiveMeeting=230]="msoulscat_MSOSP_LiveMeeting";e[e.msoulscat_Wac_WordMerge=300]="msoulscat_Wac_WordMerge";e[e.msoulscat_WAC_WordViewer=301]="msoulscat_WAC_WordViewer";e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence";e[e.msoulscat_Wac_RevisionDiffer=303]="msoulscat_Wac_RevisionDiffer";e[e.msoulscat_Wac_WordCoauth=304]="msoulscat_Wac_WordCoauth";e[e.msoulscat_Wac_Replication=305]="msoulscat_Wac_Replication";
e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral";e[e.msoulscat_Box4_CopyPaste=307]="msoulscat_Box4_CopyPaste";e[e.msoulscat_Wac_WordEditorFootnoteEndnote=308]="msoulscat_Wac_WordEditorFootnoteEndnote";e[e.msoulscat_Wac_WordEditorPageNumber=309]="msoulscat_Wac_WordEditorPageNumber";e[e.msoulscat_Wac_EventManager=310]="msoulscat_Wac_EventManager";e[e.msoulscat_Wac_WordEditorTableStyle=311]="msoulscat_Wac_WordEditorTableStyle";e[e.msoulscat_Wac_WordEditorFindReplace=312]="msoulscat_Wac_WordEditorFindReplace";
e[e.msoulscat_Wac_FindReplace=313]="msoulscat_Wac_FindReplace";e[e.msoulscat_Wac_WordEditorPageBreak=314]="msoulscat_Wac_WordEditorPageBreak";e[e.msoulscat_WAC_Box4Crash=315]="msoulscat_WAC_Box4Crash";e[e.msoulscat_Wac_WordEditorBlobFormatting=316]="msoulscat_Wac_WordEditorBlobFormatting";e[e.msoulscat_Wac_WordEditorHeaderFooter=317]="msoulscat_Wac_WordEditorHeaderFooter";e[e.msoulscat_Wac_WordEditorSelection=318]="msoulscat_Wac_WordEditorSelection";e[e.msoulscat_Wac_NodeLogger=319]="msoulscat_Wac_NodeLogger";
e[e.msoulscat_Wac_TaskPaneFramework=320]="msoulscat_Wac_TaskPaneFramework";e[e.msoulscat_Wac_Focus=321]="msoulscat_Wac_Focus";e[e.msoulscat_Wac_ImageEditor=322]="msoulscat_Wac_ImageEditor";e[e.msoulscat_Wac_EditingView=323]="msoulscat_Wac_EditingView";e[e.msoulscat_Wac_Box4General=324]="msoulscat_Wac_Box4General";e[e.msoulscat_Wac_PeoplesWell=325]="msoulscat_Wac_PeoplesWell";e[e.msoulscat_Wac_PageView=326]="msoulscat_Wac_PageView";e[e.msoulscat_Wac_Comments=327]="msoulscat_Wac_Comments";e[e.msoulscat_Wac_DirectPrint=
328]="msoulscat_Wac_DirectPrint";e[e.msoulscat_Wac_GraphValidation=329]="msoulscat_Wac_GraphValidation";e[e.msoulscat_Wac_OneNotePrint=330]="msoulscat_Wac_OneNotePrint";e[e.msoulscat_Wac_AppSettings=331]="msoulscat_Wac_AppSettings";e[e.msoulscat_Wac_Embed=332]="msoulscat_Wac_Embed";e[e.msoulscat_Wac_SkypeChat=333]="msoulscat_Wac_SkypeChat";e[e.msoulscat_WAC_Accessibility=334]="msoulscat_WAC_Accessibility";e[e.msoulscat_Wac_Aggregator=335]="msoulscat_Wac_Aggregator";e[e.msoulscat_Wac_WordEditorPagination=
336]="msoulscat_Wac_WordEditorPagination";e[e.msoulscat_WAC_WordEditorSave=337]="msoulscat_WAC_WordEditorSave";e[e.msoulscat_Wac_WoncaGeneral=338]="msoulscat_Wac_WoncaGeneral";e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral";e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon";e[e.msoulscat_Wac_WordEditorAppsForOffice=341]="msoulscat_Wac_WordEditorAppsForOffice";e[e.msoulscat_Wac_SendUsYourFile=342]="msoulscat_Wac_SendUsYourFile";e[e.msoulscat_WAC_DocxSaveMonitor=343]="msoulscat_WAC_DocxSaveMonitor";
e[e.msoulscat_Wac_AppsForOffice=344]="msoulscat_Wac_AppsForOffice";e[e.msoulscat_Wac_BrowserPerformance=345]="msoulscat_Wac_BrowserPerformance";e[e.msoulscat_Wac_WordEditorShapes=346]="msoulscat_Wac_WordEditorShapes";e[e.msoulscat_Wac_WordEditorFeatureHelper=347]="msoulscat_Wac_WordEditorFeatureHelper";e[e.msoulscat_Wac_InsertSymbol=348]="msoulscat_Wac_InsertSymbol";e[e.msoulscat_Wac_WebAppsPortal=349]="msoulscat_Wac_WebAppsPortal";e[e.msoulscat_Wac_Yammer=350]="msoulscat_Wac_Yammer";e[e.msoulscat_Wac_OoXml=
351]="msoulscat_Wac_OoXml";e[e.msoulscat_Wac_InsertMedia=352]="msoulscat_Wac_InsertMedia";e[e.msoulscat_Wac_WordZoom=353]="msoulscat_Wac_WordZoom";e[e.msoulscat_Wac_WordEditorFormatPainter=354]="msoulscat_Wac_WordEditorFormatPainter";e[e.msoulscat_Wac_WordRealTimeTyping=355]="msoulscat_Wac_WordRealTimeTyping";e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback";e[e.msoulscat_Wac_WacFeedbackExcelOnlineViewMode=357]="msoulscat_Wac_WacFeedbackExcelOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackExcelOnlineEditMode=
358]="msoulscat_Wac_WacFeedbackExcelOnlineEditMode";e[e.msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode=359]="msoulscat_Wac_WacFeedbackExcelOnlineSurveyMode";e[e.msoulscat_Wac_WacFeedbackPptOnlineViewMode=360]="msoulscat_Wac_WacFeedbackPptOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackPptOnlineEditMode=361]="msoulscat_Wac_WacFeedbackPptOnlineEditMode";e[e.msoulscat_Wac_WacFeedbackOneNoteOnline=362]="msoulscat_Wac_WacFeedbackOneNoteOnline";e[e.msoulscat_Wac_WacFeedbackWordOnlineViewMode=363]="msoulscat_Wac_WacFeedbackWordOnlineViewMode";
e[e.msoulscat_Wac_WacFeedbackWordOnlineEditMode=364]="msoulscat_Wac_WacFeedbackWordOnlineEditMode";e[e.msoulscat_Wac_Box4Undo=365]="msoulscat_Wac_Box4Undo";e[e.msoulscat_Wac_WordEditorCustomXml=366]="msoulscat_Wac_WordEditorCustomXml";e[e.msoulscat_Wac_WordEditorNavigationPane=367]="msoulscat_Wac_WordEditorNavigationPane";e[e.msoulscat_Wac_WordEditorContentControl=368]="msoulscat_Wac_WordEditorContentControl";e[e.msoulscat_Wac_WordEditorExtension=369]="msoulscat_Wac_WordEditorExtension";e[e.msoulscat_Wac_UpdateHints=
370]="msoulscat_Wac_UpdateHints";e[e.msoulscat_Wac_OneNoteAppsforOffice=371]="msoulscat_Wac_OneNoteAppsforOffice";e[e.msoulscat_Wac_OneNoteExtension=372]="msoulscat_Wac_OneNoteExtension";e[e.msoulscat_Wac_WacFeedbackVisioOnlineViewMode=373]="msoulscat_Wac_WacFeedbackVisioOnlineViewMode";e[e.msoulscat_Wac_WacFeedbackVisioOnlineEditMode=374]="msoulscat_Wac_WacFeedbackVisioOnlineEditMode";e[e.msoulscat_Wac_Proofing=375]="msoulscat_Wac_Proofing";e[e.msoulscat_Wac_WordEditorTrackChange=376]="msoulscat_Wac_WordEditorTrackChange";
e[e.msoulscat_Wac_WordEditorCatchUp=377]="msoulscat_Wac_WordEditorCatchUp";e[e.msoulscat_Wac_WacSafeLinks=378]="msoulscat_Wac_WacSafeLinks";e[e.msoulscat_Wac_WopiBootstrapper=379]="msoulscat_Wac_WopiBootstrapper";e[e.msoulscat_Wac_PeopleHandler=380]="msoulscat_Wac_PeopleHandler";e[e.msoulscat_Wac_WacOcsVectorClockTelemetry=381]="msoulscat_Wac_WacOcsVectorClockTelemetry";e[e.msoulscat_Wac_WacDigitalPrint=382]="msoulscat_Wac_WacDigitalPrint";e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry";
e[e.msoulscat_Wac_PolicyHandler=384]="msoulscat_Wac_PolicyHandler";e[e.msoulscat_Wac_WordEditorMetadataHelper=385]="msoulscat_Wac_WordEditorMetadataHelper";e[e.msoulscat_Wac_WordEditorRevisionMetadata=386]="msoulscat_Wac_WordEditorRevisionMetadata";e[e.msoulscat_Wac_WacInProductMessaging=387]="msoulscat_Wac_WacInProductMessaging";e[e.msoulscat_Wac_WordEditorResumeAssistant=388]="msoulscat_Wac_WordEditorResumeAssistant";e[e.msoulscat_Wac_Box4AugmentationLoop=389]="msoulscat_Wac_Box4AugmentationLoop";
e[e.msoulscat_Wac_WordEditorAcronyms=390]="msoulscat_Wac_WordEditorAcronyms";e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities";e[e.msoulscat_Wac_WacAwayStatus=392]="msoulscat_Wac_WacAwayStatus";e[e.msoulscat_Wac_Box4List=393]="msoulscat_Wac_Box4List";e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation";e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync";e[e.msoulscat_Wac_IdeasRuntime=396]="msoulscat_Wac_IdeasRuntime";e[e.msoulscat_Wac_IdeasPane=397]=
"msoulscat_Wac_IdeasPane";e[e.msoulscat_Wac_Infrared=398]="msoulscat_Wac_Infrared";e[e.msoulscat_Wac_WordEditorModernTranslator=399]="msoulscat_Wac_WordEditorModernTranslator";e[e.msoulscat_OneService_Site=400]="msoulscat_OneService_Site";e[e.msoulscat_OneService_UnitTests=401]="msoulscat_OneService_UnitTests";e[e.msoulscat_OneService_ClipperInstall=402]="msoulscat_OneService_ClipperInstall";e[e.msoulscat_OneService_ClipperUsage=403]="msoulscat_OneService_ClipperUsage";e[e.msoulscat_OneService_Site_EmailSettings=
404]="msoulscat_OneService_Site_EmailSettings";e[e.msoulscat_OneService_Site_Notebooks=405]="msoulscat_OneService_Site_Notebooks";e[e.msoulscat_OneService_Site_DevSite=406]="msoulscat_OneService_Site_DevSite";e[e.msoulscat_OneService_Site_FeaturedApps=407]="msoulscat_OneService_Site_FeaturedApps";e[e.msoulscat_OneService_Site_FeedbackPage=408]="msoulscat_OneService_Site_FeedbackPage";e[e.msoulscat_OneService_Augmentation=409]="msoulscat_OneService_Augmentation";e[e.msoulscat_OneService_AugmentationProvider_UrlEnhancer=
410]="msoulscat_OneService_AugmentationProvider_UrlEnhancer";e[e.msoulscat_OneService_AugmentationProvider_DomEnhancer=411]="msoulscat_OneService_AugmentationProvider_DomEnhancer";e[e.msoulscat_OneService_AugmentationProvider_Entitization=412]="msoulscat_OneService_AugmentationProvider_Entitization";e[e.msoulscat_OneService_ClipperTooltip=413]="msoulscat_OneService_ClipperTooltip";e[e.msoulscat_OneService_Site_Students=414]="msoulscat_OneService_Site_Students";e[e.msoulscat_OneService_AugmentationProvider_BizcardExtractor=
415]="msoulscat_OneService_AugmentationProvider_BizcardExtractor";e[e.msoulscat_OneService_Site_ClassNotebook=416]="msoulscat_OneService_Site_ClassNotebook";e[e.msoulscat_WAC_RealtimeChannel=500]="msoulscat_WAC_RealtimeChannel";e[e.msoulscat_WAC_RealtimeChannelTest=501]="msoulscat_WAC_RealtimeChannelTest";e[e.msoulscat_WAC_HostNotification=502]="msoulscat_WAC_HostNotification";e[e.msoulscat_WAC_Signalr=600]="msoulscat_WAC_Signalr";e[e.msoulscat_WAC_VisioApp=700]="msoulscat_WAC_VisioApp";e[e.msoulscat_WAC_VisioLoader=
701]="msoulscat_WAC_VisioLoader";e[e.msoulscat_WAC_VisioDataModel=702]="msoulscat_WAC_VisioDataModel";e[e.msoulscat_WAC_VisioRenderer=703]="msoulscat_WAC_VisioRenderer";e[e.msoulscat_WAC_VisioRecalc=704]="msoulscat_WAC_VisioRecalc";e[e.msoulscat_WAC_VisioCommand=705]="msoulscat_WAC_VisioCommand";e[e.msoulscat_WAC_VisioController=706]="msoulscat_WAC_VisioController";e[e.msoulscat_WAC_VisioShapePanel=707]="msoulscat_WAC_VisioShapePanel";e[e.msoulscat_WAC_VisioAppControls=708]="msoulscat_WAC_VisioAppControls";
e[e.msoulscat_WAC_VisioSync=709]="msoulscat_WAC_VisioSync";e[e.msoulscat_WAC_VisioDataRefresh=710]="msoulscat_WAC_VisioDataRefresh";e[e.msoulscat_WAC_VisioWebDVAddinService=711]="msoulscat_WAC_VisioWebDVAddinService";e[e.msoulscat_WAC_VisioWebDVAddinClient=712]="msoulscat_WAC_VisioWebDVAddinClient";e[e.msoulscat_WAC_VisioWebClipboard=713]="msoulscat_WAC_VisioWebClipboard";e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation";e[e.msoulscat_Wac_PptAppEvents=801]="msoulscat_Wac_PptAppEvents";
e[e.msoulscat_Wac_PptAppsForOffice=802]="msoulscat_Wac_PptAppsForOffice";e[e.msoulscat_Wac_PptBrowserLayer=803]="msoulscat_Wac_PptBrowserLayer";e[e.msoulscat_Wac_PptCoauthoring=804]="msoulscat_Wac_PptCoauthoring";e[e.msoulscat_Wac_PptComments=805]="msoulscat_Wac_PptComments";e[e.msoulscat_Wac_PptEditingManager=806]="msoulscat_Wac_PptEditingManager";e[e.msoulscat_Wac_PptFocus=807]="msoulscat_Wac_PptFocus";e[e.msoulscat_Wac_PptGraph=808]="msoulscat_Wac_PptGraph";e[e.msoulscat_Wac_PptInit=809]="msoulscat_Wac_PptInit";
e[e.msoulscat_Wac_PptNavigation=810]="msoulscat_Wac_PptNavigation";e[e.msoulscat_Wac_PptNone=811]="msoulscat_Wac_PptNone";e[e.msoulscat_Wac_PptNotes=812]="msoulscat_Wac_PptNotes";e[e.msoulscat_Wac_PptPerf=813]="msoulscat_Wac_PptPerf";e[e.msoulscat_Wac_PptPresence=814]="msoulscat_Wac_PptPresence";e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape";e[e.msoulscat_Wac_PptSelection=816]="msoulscat_Wac_PptSelection";e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession";e[e.msoulscat_Wac_PptTasks=
818]="msoulscat_Wac_PptTasks";e[e.msoulscat_Wac_PptThumbnailPane=819]="msoulscat_Wac_PptThumbnailPane";e[e.msoulscat_Wac_PptText=820]="msoulscat_Wac_PptText";e[e.msoulscat_Wac_PptUtil=821]="msoulscat_Wac_PptUtil";e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView";e[e.msoulscat_Wac_PptSynchronization=823]="msoulscat_Wac_PptSynchronization";e[e.msoulscat_Wac_PptWebService=824]="msoulscat_Wac_PptWebService";e[e.msoulscat_Wac_PptMedia=825]="msoulscat_Wac_PptMedia";e[e.msoulscat_Wac_PptCopyPaste=826]=
"msoulscat_Wac_PptCopyPaste";e[e.msoulscat_Wac_PptZoom=827]="msoulscat_Wac_PptZoom";e[e.msoulscat_Wac_PptRealTimeCoauth=828]="msoulscat_Wac_PptRealTimeCoauth";e[e.msoulscat_Wac_PptDesigner=829]="msoulscat_Wac_PptDesigner";e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow";e[e.msoulscat_Wac_PptPictureCrop=831]="msoulscat_Wac_PptPictureCrop";e[e.msoulscat_Wac_PptVersionHistory=832]="msoulscat_Wac_PptVersionHistory";e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive";e[e.msoulscat_Wac_PptMWeb=
834]="msoulscat_Wac_PptMWeb";e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General";e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost";e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation";e[e.msoulscat_Wac_PptPresentToTeams=838]="msoulscat_Wac_PptPresentToTeams";e[e.msoulscat_Wac_PptWebSocketFrontDoor=839]="msoulscat_Wac_PptWebSocketFrontDoor";e[e.msoulscat_Wac_MediaSnap=840]="msoulscat_Wac_MediaSnap";e[e.msoulscat_Wac_MediaTranscoding=841]="msoulscat_Wac_MediaTranscoding";
e[e.msoulscat_Wac_FileSnap=842]="msoulscat_Wac_FileSnap";e[e.msoulscat_Wac_PptPartialDocs=843]="msoulscat_Wac_PptPartialDocs";e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync";e[e.msoulscat_Wac_PptCollabTasks=845]="msoulscat_Wac_PptCollabTasks";e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos";e[e.msoulscat_Wac_ChatPPT=847]="msoulscat_Wac_ChatPPT";e[e.msoulscat_Uci_CommandsClient=1300]="msoulscat_Uci_CommandsClient";e[e.msoulscat_Uci_InsightsClient=1301]="msoulscat_Uci_InsightsClient";
e[e.msoulscat_Uci_Assistance=1302]="msoulscat_Uci_Assistance";e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights";e[e.msoulscat_Uci_Insights_Overview=1304]="msoulscat_Uci_Insights_Overview";e[e.msoulscat_Uci_Insights_DrillIn=1306]="msoulscat_Uci_Insights_DrillIn";e[e.msoulscat_Uci_JunoClient=1307]="msoulscat_Uci_JunoClient";e[e.msoulscat_Uci_GraphImportClient=1308]="msoulscat_Uci_GraphImportClient";e[e.msoulscat_Uci_TellMeServiceClient=1309]="msoulscat_Uci_TellMeServiceClient";e[e.msoulscat_Uci_EnrichmentClient=
1310]="msoulscat_Uci_EnrichmentClient";e[e.msoulscat_Uci_JunoBrowserExtension=1311]="msoulscat_Uci_JunoBrowserExtension";e[e.msoulscat_Uci_Enrichment=1312]="msoulscat_Uci_Enrichment";e[e.msoulscat_Uci_SmartLookupClient=1313]="msoulscat_Uci_SmartLookupClient";e[e.msoulscat_Uci_CanvasContext=1314]="msoulscat_Uci_CanvasContext";e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency";e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification";e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime";
e[e.msoulscat_Osf_AppManagementMenu=1404]="msoulscat_Osf_AppManagementMenu";e[e.msoulscat_Osf_InsertionDialogSession=1405]="msoulscat_Osf_InsertionDialogSession";e[e.msoulscat_Osf_UploadFileDevCatelog=1406]="msoulscat_Osf_UploadFileDevCatelog";e[e.msoulscat_Osf_UploadFileDevCatalogUsage=1411]="msoulscat_Osf_UploadFileDevCatalogUsage";e[e.msoulscat_OneNoteOnline_Navigation=1600]="msoulscat_OneNoteOnline_Navigation";e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache";
e[e.msoulscat_OneNoteOnline_Zoom=1602]="msoulscat_OneNoteOnline_Zoom";e[e.msoulscat_Alchemy_Browser=1700]="msoulscat_Alchemy_Browser";e[e.msoulscat_Ice_EmailHrd=1800]="msoulscat_Ice_EmailHrd";e[e.msoulscat_Ice_InsertMedia=1801]="msoulscat_Ice_InsertMedia";e[e.msoulscat_Ice_Abt=1802]="msoulscat_Ice_Abt";e[e.msoulscat_Met_Broadcast=1900]="msoulscat_Met_Broadcast";e[e.msoulscat_NlAppsClient_Acronyms=2200]="msoulscat_NlAppsClient_Acronyms";e[e.msoulscat_NlAppsClient_EditorPane=2201]="msoulscat_NlAppsClient_EditorPane";
e[e.msoulscat_NlAppsClient_KeyPoints=2202]="msoulscat_NlAppsClient_KeyPoints";e[e.msoulscat_NlAppsClient_Synonyms=2203]="msoulscat_NlAppsClient_Synonyms";e[e.msoulscat_NlAppsClient_ToDo=2204]="msoulscat_NlAppsClient_ToDo";e[e.msoulscat_Wac_Ideas=2250]="msoulscat_Wac_Ideas";e[e.msoulscat_Wac_ReadingTime=2251]="msoulscat_Wac_ReadingTime";e[e.msoulscat_Wac_Goals=2252]="msoulscat_Wac_Goals";e[e.msoulscat_Wac_StatsDialog=2253]="msoulscat_Wac_StatsDialog";e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory";
e[e.msoulscat_Wac_OAuth=3E3]="msoulscat_Wac_OAuth";e[e.msoulscat_Wac_WordGraphicsEditor=3001]="msoulscat_Wac_WordGraphicsEditor";e[e.msoulscat_Wac_Licensing=3002]="msoulscat_Wac_Licensing";e[e.msoulscat_Wac_WordTasks=3003]="msoulscat_Wac_WordTasks";e[e.msoulscat_Wac_ApplicationFeatureHelper=3004]="msoulscat_Wac_ApplicationFeatureHelper";e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory";e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard";e[e.msoulscat_Wac_Box4Workers=
3007]="msoulscat_Wac_Box4Workers";e[e.msoulscat_Wac_WordWorkers=3008]="msoulscat_Wac_WordWorkers";e[e.msoulscat_Wac_WordEditorClientPagination=3009]="msoulscat_Wac_WordEditorClientPagination";e[e.msoulscat_Wac_WordPrediction=3010]="msoulscat_Wac_WordPrediction";e[e.msoulscat_Wac_TranscriptionPane=3011]="msoulscat_Wac_TranscriptionPane";e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout";e[e.msoulscat_Wac_ComponentStateLogging=3013]="msoulscat_Wac_ComponentStateLogging";e[e.msoulscat_Wac_WordRuler=
3014]="msoulscat_Wac_WordRuler";e[e.msoulscat_Wac_WordInlineTab=3015]="msoulscat_Wac_WordInlineTab";e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner";e[e.msoulscat_Wac_Styles=3017]="msoulscat_Wac_Styles";e[e.msoulscat_Wac_WordStyles=3018]="msoulscat_Wac_WordStyles";e[e.msoulscat_Wac_TableOfContents=3019]="msoulscat_Wac_TableOfContents";e[e.msoulscat_Wac_ConvertWordToPpt=3020]="msoulscat_Wac_ConvertWordToPpt";e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker";
e[e.msoulscat_Wac_WordTables=3022]="msoulscat_Wac_WordTables";e[e.msoulscat_Wac_WordColors=3023]="msoulscat_Wac_WordColors";e[e.msoulscat_Wac_ProactiveUxGovernance=3025]="msoulscat_Wac_ProactiveUxGovernance";e[e.msoulscat_Wac_PrebootHandler=3026]="msoulscat_Wac_PrebootHandler";e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost";e[e.msoulscat_Wac_ConditionalTriggering=3028]="msoulscat_Wac_ConditionalTriggering";e[e.msoulscat_Wac_WordBookmarks=3029]="msoulscat_Wac_WordBookmarks";e[e.msoulscat_Wac_WordEditorClientPaginationTyping=
3030]="msoulscat_Wac_WordEditorClientPaginationTyping";e[e.msoulscat_Wac_WordEditorNudgeToWeb=3031]="msoulscat_Wac_WordEditorNudgeToWeb";e[e.msoulscat_Wac_Suite=3032]="msoulscat_Wac_Suite";e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools";e[e.msoulscat_Wac_ContextIQ=3034]="msoulscat_Wac_ContextIQ";e[e.msoulscat_Wac_WordEditorClientActivityGeneration=3035]="msoulscat_Wac_WordEditorClientActivityGeneration";e[e.msoulscat_Wac_WordEditorEmergencyView=3036]="msoulscat_Wac_WordEditorEmergencyView";
e[e.msoulscat_Wac_WordRevisionSequenceNumber=3037]="msoulscat_Wac_WordRevisionSequenceNumber";e[e.msoulscat_Wac_WordDataLossMonitor=3038]="msoulscat_Wac_WordDataLossMonitor";e[e.msoulscat_Wac_OWL=3039]="msoulscat_Wac_OWL";e[e.msoulscat_Wac_OWLNest=3040]="msoulscat_Wac_OWLNest";e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker";e[e.msoulscat_Wac_OfficeTemplatesMetadataService=3042]="msoulscat_Wac_OfficeTemplatesMetadataService";e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite";e[e.msoulscat_Wac_AiInsert=
3044]="msoulscat_Wac_AiInsert";e[e.msoulscat_Wac_FastCards=3045]="msoulscat_Wac_FastCards";e[e.msoulscat_Wac_SendToKindle=3046]="msoulscat_Wac_SendToKindle";e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize";e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose"})(h||(h={}));Object(K.b)("ULSCat",h)},1290:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.error=10]="error";e[e.warning=15]="warning";e[e.important=20]="important";e[e.info=50]="info";
e[e.verbose=100]="verbose";e[e.spam=200]="spam";e[e.shiftFactor=1E3]="shiftFactor"})(h||(h={}));Object(K.b)("ULSTraceLevel",h)},1294:function(K,S,d){function h(a,b){if(!a||!b)return[];const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.cMe)||void 0===l?void 0:l.forEach(y=>{y&&c.add(y)})});return Array.from(c).map(f=>b.Be(ia.a.Kf(f))).filter(f=>null!==f&&void 0!==f)}function e(a,b){return b&&b.TableNode?new CF(b):new DF(a)}function r(a,b){ro.set(a,b)}d.r(S);var m=d(0),
n=d(71),z=d(56),t=d(96),x=d(183),B=d(176),D=d(120),w=d(27),J=d(1134),F=d(37),L=d(161),M=d(38);class Q{constructor(a){this.value=a}}Object(m.a)(Q,"RefTriState",null,[]);var C=d(35);class O{fWe(){this.Z2i();this.vNj();this.S$j();this.Lhk();M.a.instance.ga(70)&&this.BZk();this.Ill();M.a.instance.ga(71)&&this.OPb();this.$Hl();this.TIl();this.VTi();this.C$j();this.Hhl();this.pEl();this.XJl();M.a.instance.ga(79)&&(z.a.fl||this.EPj(),this.mck(),this.WCk(),this.uQl())}Z2i(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);
a.bindAction(x.KeyInputManager.Va(B.a.jp,0),C.a.enter);a.bindAction(x.KeyInputManager.Va(B.a.jp,4),C.a.Fud)}vNj(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Hyperlink),C.a.insertHyperlink)}EPj(){const a=t.FocusManager.instance().Ic(D.AFrame.$i);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.wha,5),C.a.QC);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.Jba,5),C.a.Ry)}C$j(){if(!z.a.Fx){const a=t.FocusManager.instance().Ic(D.AFrame.$i);D.AFrame.zk(a,
x.KeyInputManager.Va(B.a.Dyc,x.KeyInputManager.Te),C.a.Pvg,O.Lkb("faOpen"))}}S$j(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);M.a.instance.ga(54)&&D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_CenterJustify),C.a.centerJustify,O.iK);z.a.fl?(D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),C.a.leftJustify,O.iK),D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),C.a.rightJustify,O.iK)):(D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_LeftJustify),
C.a.leftJustify,O.iK),D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_RightJustify),C.a.rightJustify,O.iK));M.a.instance.ga(54)&&D.AFrame.zk(a,x.KeyInputManager.Va(B.a.lBd,x.KeyInputManager.Te),C.a.fullJustify,O.iK)}mck(){var a=t.FocusManager.instance();const b=a.Ic(D.AFrame.$i);a=a.Ic(L.AppFrame.UW);D.AFrame.zk(b,x.KeyInputManager.Va(B.a.rNa,x.KeyInputManager.Te),C.a.kN,O.CVf);D.AFrame.zk(b,x.KeyInputManager.Va(B.a.dbf,x.KeyInputManager.Te),C.a.JP,O.CVf);z.a.vCb&&a.bindAction(x.KeyInputManager.Va(B.a.Cyc,
4|x.KeyInputManager.Te),C.a.kN)}Lhk(){const a=t.FocusManager.instance().Ic(D.AFrame.$i);D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_TellMe),F.a.$vc,O.iK)}WCk(){if(M.a.instance.ga(27)||M.a.instance.ga(58)){const a=t.FocusManager.instance().Ic(D.AFrame.$i),b=M.a.instance.ga(58)?C.a.Qjl:C.a.save;D.AFrame.zk(a,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Save),b);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.scf,0),C.a.sync)}}BZk(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);w.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&
w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||D.AFrame.zk(a,x.KeyInputManager.Va(B.a.Ayc,1),C.a.vid);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.Ayc,0),C.a.vid)}Ill(){this.Hxh(L.AppFrame.UW);this.Hxh(L.AppFrame.uVe)}Hxh(a){var b=t.FocusManager.instance(),c=B.a.Jba,f=B.a.wha;a=b.Ic(a);const l=b.Ic(w.AFrameworkApplication.jjb);a.bindAction(x.KeyInputManager.Va(c,0),C.a.leftArrow);a.bindAction(x.KeyInputManager.Va(f,0),C.a.rightArrow);a.bindAction(x.KeyInputManager.Va(B.a.CZ,0),C.a.upArrow);
a.bindAction(x.KeyInputManager.Va(B.a.o7,0),C.a.downArrow);a.bindAction(x.KeyInputManager.Va(f,4),C.a.Q1a);a.bindAction(x.KeyInputManager.Va(c,4),C.a.P1a);z.a.fl?(a.bindAction(x.KeyInputManager.Va(f,1),C.a.DDa),a.bindAction(x.KeyInputManager.Va(c,1),C.a.CDa),a.bindAction(x.KeyInputManager.Va(f,5),C.a.mSa),a.bindAction(x.KeyInputManager.Va(c,5),C.a.lSa),a.bindAction(x.KeyInputManager.Va(f,8),C.a.b_a),a.bindAction(x.KeyInputManager.Va(c,8),C.a.c_a),a.bindAction(x.KeyInputManager.Va(f,12),C.a.hTa),a.bindAction(x.KeyInputManager.Va(c,
12),C.a.iTa)):(a.bindAction(x.KeyInputManager.Va(f,x.KeyInputManager.Te),C.a.DDa),a.bindAction(x.KeyInputManager.Va(c,x.KeyInputManager.Te),C.a.CDa),a.bindAction(x.KeyInputManager.Va(f,x.KeyInputManager.Te|4),C.a.mSa),a.bindAction(x.KeyInputManager.Va(c,x.KeyInputManager.Te|4),C.a.lSa));a.bindAction(x.KeyInputManager.Va(B.a.CZ,4),C.a.NOb);a.bindAction(x.KeyInputManager.Va(B.a.o7,4),C.a.Rlb);a.bindAction(x.KeyInputManager.Va(B.a.CZ,x.KeyInputManager.Te),C.a.f4b);a.bindAction(x.KeyInputManager.Va(B.a.o7,
x.KeyInputManager.Te),C.a.Vvb);a.bindAction(x.KeyInputManager.Va(B.a.CZ,x.KeyInputManager.Te|4),C.a.e9a);a.bindAction(x.KeyInputManager.Va(B.a.o7,x.KeyInputManager.Te|4),C.a.kSa);a.bindAction(x.KeyInputManager.Va(B.a.oI,0),C.a.c_a);a.bindAction(x.KeyInputManager.Va(B.a.oI,4),C.a.iTa);if(M.a.instance.ga(41))a.bindAction(x.KeyInputManager.Va(B.a.oI,x.KeyInputManager.Te),C.a.Jhd),a.bindAction(x.KeyInputManager.Va(B.a.ez,x.KeyInputManager.Te),C.a.OKe);else if(M.a.instance.ga(17)||M.a.instance.ga(77))a.bindAction(x.KeyInputManager.Va(B.a.oI,
x.KeyInputManager.Te),C.a.Vhb),a.bindAction(x.KeyInputManager.Va(B.a.ez,x.KeyInputManager.Te),C.a.Uhb);a.bindAction(x.KeyInputManager.Va(B.a.oI,x.KeyInputManager.Te|4),C.a.a$a);a.bindAction(x.KeyInputManager.Va(B.a.ez,0),C.a.b_a);a.bindAction(x.KeyInputManager.Va(B.a.ez,4),C.a.hTa);a.bindAction(x.KeyInputManager.Va(B.a.ez,x.KeyInputManager.Te|4),C.a.$9a);z.a.fl&&(a.bindAction(x.KeyInputManager.Va(B.a.CZ,2),C.a.c_a),a.bindAction(x.KeyInputManager.Va(B.a.CZ,6),C.a.iTa),a.bindAction(x.KeyInputManager.Va(B.a.o7,
2),C.a.b_a),a.bindAction(x.KeyInputManager.Va(B.a.o7,6),C.a.hTa),a.bindAction(x.KeyInputManager.Va(B.a.oI,1),C.a.Vhb),a.bindAction(x.KeyInputManager.Va(B.a.ez,1),C.a.Uhb),M.a.instance.ga(6)&&(a.bindAction(x.KeyInputManager.Va(B.a.CZ,5),C.a.e9a),a.bindAction(x.KeyInputManager.Va(B.a.o7,5),C.a.kSa)));c=x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,C.a.qta);l.bindAction(c,F.a.GSa);M.a.instance.ga(79)&&(f=b.Ic(D.AFrame.dE),b=b.Ic(D.AFrame.$i),f.bindAction(c,F.a.RCa),b.bindAction(x.KeyInputManager.Va(B.a.ANa,
x.KeyInputManager.Te|4),C.a.csd),M.a.instance.ga(41)&&z.a.fl&&(a.bindAction(x.KeyInputManager.Va(B.a.rF,1),C.a.Vhb),a.bindAction(x.KeyInputManager.Va(B.a.qF,1),C.a.Uhb)),b.bindAction(x.KeyInputManager.Va(B.a.qF,0),C.a.pageDown),b.bindAction(x.KeyInputManager.Va(B.a.rF,0),C.a.pageUp),b.bindAction(x.KeyInputManager.Va(B.a.qF,4),C.a.iuc),b.bindAction(x.KeyInputManager.Va(B.a.rF,4),C.a.Hud));M.a.instance.ga(6)&&(a.bindAction(x.KeyInputManager.Va(B.a.qF,x.KeyInputManager.Te|4),F.a.GSa),a.bindAction(x.KeyInputManager.Va(B.a.rF,
x.KeyInputManager.Te|4),F.a.GSa));z.a.ik||a.bindAction(x.KeyInputManager.Va(B.a.pNa,0),C.a.lba);a.bindAction(x.KeyInputManager.Va(B.a.hqa,4),C.a.Gud);a.bindAction(x.KeyInputManager.Va(B.a.hqa,4|x.KeyInputManager.Te),C.a.Gud)}OPb(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.iBd,x.KeyInputManager.Te|1),C.a.eWd);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.jBd,x.KeyInputManager.Te|1),C.a.fWd);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.mcf,x.KeyInputManager.Te|1),
C.a.gWd);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.ncf,x.KeyInputManager.Te|1),C.a.hWd);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.ocf,x.KeyInputManager.Te|1),C.a.iWd);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.pcf,x.KeyInputManager.Te|1),C.a.jWd);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.q3a,x.KeyInputManager.Te|4),C.a.dWd);M.a.instance.ga(61)&&t.FocusManager.instance().Ic(D.AFrame.$i).bindAction(x.KeyInputManager.Va(B.a.nBd,x.KeyInputManager.Te|4),C.a.tpi)}$Hl(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);
a.bindAction(x.KeyInputManager.Va(B.a.$q,0),C.a.tab);a.bindAction(x.KeyInputManager.Va(B.a.$q,4),C.a.juc)}TIl(){if(M.a.instance.ga(30)){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.jp,x.KeyInputManager.Te),C.a.Fua)}}XJl(){const a=t.FocusManager.instance(),b=a.Ic(L.AppFrame.UW);a.Ic(D.AFrame.dE);D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Bold),C.a.bold,O.iK);D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Italic),C.a.setItalic,
O.iK);D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Underline),C.a.underline,O.iK);z.a.fl&&(D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Bold_Mac),C.a.bold,O.iK),D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Italic_Mac),C.a.setItalic,O.iK),D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Underline_Mac),C.a.underline,O.iK));D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_ClearFormatting),C.a.clearFormatting);M.a.instance.ga(54)&&
D.AFrame.zk(b,x.KeyInputManager.Va(B.a.fob,x.KeyInputManager.Te|4),C.a.clearFormatting);D.AFrame.zk(b,x.KeyInputManager.Va(B.a.dob,x.KeyInputManager.Te|1),C.a.e2,O.Lkb("00FFFF"));if(M.a.instance.ga(94)||M.a.instance.ga(96))D.AFrame.zk(b,x.KeyInputManager.Va(B.a.rNa,x.KeyInputManager.Te|4),C.a.qH,O.iK),D.AFrame.zk(b,x.KeyInputManager.Va(B.a.$xc,x.KeyInputManager.Te),C.a.qH,O.iK),D.AFrame.zk(b,x.KeyInputManager.Va(B.a.iAd,x.KeyInputManager.Te|4),C.a.fI,O.iK),D.AFrame.zk(b,x.KeyInputManager.Va(B.a.Yxc,
x.KeyInputManager.Te),C.a.fI,O.iK);w.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&D.AFrame.zk(b,x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_ToggleCase),C.a.Rxd);w.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(D.AFrame.zk(b,x.KeyInputManager.Va(B.a.kAd,x.KeyInputManager.Te|4),C.a.superscript,O.iK),D.AFrame.zk(b,x.KeyInputManager.Va(B.a.nAd,x.KeyInputManager.Te|4),C.a.superscript,O.iK),D.AFrame.zk(b,x.KeyInputManager.Va(B.a.lAd,x.KeyInputManager.Te|4),C.a.subscript,
O.iK),D.AFrame.zk(b,x.KeyInputManager.Va(B.a.Zxc,x.KeyInputManager.Te|4),C.a.subscript,O.iK))}uQl(){const a=t.FocusManager.instance().Ic(D.AFrame.dE),b=t.FocusManager.instance().Ic(L.AppFrame.UW);var c=x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,F.a.RCa);b.bindAction(c,C.a.undo);c=x.KeyInputManager.Va(B.a.FG,1);a.bindAction(c,F.a.RCa);z.a.fl||b.bindAction(c,C.a.undo);c=x.KeyInputManager.yw(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,F.a.RCa);b.bindAction(c,C.a.redo);c=x.KeyInputManager.Va(B.a.FG,
5);a.bindAction(c,F.a.RCa);z.a.fl||b.bindAction(c,C.a.redo)}pEl(){const a=t.FocusManager.instance().Ic(L.AppFrame.UW);M.a.instance.ga(54)?(z.a.fl?this.tsa(a,x.KeyInputManager.Va(B.a.jBd,5),"\u20ac"):this.tsa(a,x.KeyInputManager.Va(B.a.bob,x.KeyInputManager.Te|1),"\u20ac"),this.tsa(a,x.KeyInputManager.Va(B.a.tAa,x.KeyInputManager.Te|1),"\u00a9"),this.tsa(a,x.KeyInputManager.Va(B.a.nSb,x.KeyInputManager.Te|1),"\u00ae"),this.tsa(a,x.KeyInputManager.Va(B.a.oSb,x.KeyInputManager.Te|1),"\u2122"),this.tsa(a,
x.KeyInputManager.Va(B.a.Zxc,x.KeyInputManager.Te|1),"\u2014"),this.tsa(a,x.KeyInputManager.Va(B.a.rNa,x.KeyInputManager.Te|1),"\u2026"),this.tsa(a,x.KeyInputManager.Va(B.a.dbf,x.KeyInputManager.Te|5),"\u00bf"),this.tsa(a,x.KeyInputManager.Va(B.a.iBd,x.KeyInputManager.Te|5),"\u00a1")):M.a.instance.ga(25)&&this.tsa(a,x.KeyInputManager.Va(B.a.bob,x.KeyInputManager.Te|1),"\u20ac")}tsa(a,b,c){D.AFrame.zk(a,b,C.a.zVa,O.gUj("symbol_"+c))}VTi(){if(w.AFrameworkApplication.iF){var a=t.FocusManager.instance().Ic(D.AFrame.$i);
D.AFrame.zk(a,x.KeyInputManager.Va(B.a.qcf,x.KeyInputManager.Te|1),F.a.giveFeedback);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.rcf,x.KeyInputManager.Te|1),F.a.giveFeedback)}}Hhl(){const a=t.FocusManager.instance().Ic(D.AFrame.$i);z.a.Fx||D.AFrame.zk(a,x.KeyInputManager.Va(B.a.dob,1),C.a.activateRibbonTab,O.Lkb("tabHome"));D.AFrame.zk(a,x.KeyInputManager.Va(B.a.q3a,1),C.a.activateRibbonTab,O.Lkb("tabInsert"));D.AFrame.zk(a,x.KeyInputManager.Va(B.a.eob,1),C.a.activateRibbonTab,O.Lkb("tabPageLayout"));
D.AFrame.zk(a,x.KeyInputManager.Va(B.a.nSb,1),C.a.activateRibbonTab,O.Lkb("tabReview"));D.AFrame.zk(a,x.KeyInputManager.Va(B.a.ucf,1),C.a.activateRibbonTab,O.Lkb("tabView"))}static get instance(){return O.La||(O.La=new O)}static CVf(){return new J.DictionaryPropertySet}static iK(){return new Q(2)}static gUj(a){return()=>{const b={};b.SourceControlId=a;return b}}static Lkb(a){return()=>a}}O.La=null;Object(m.a)(O,"ShortcutRegistration",null,[]);class U{get name(){return"Box4.Shortcuts"}Xb(){}init(){O.instance.fWe()}dispose(){}static main(){n.a.instance.Ac(new U)}}
Object(m.a)(U,"Box4ShortcutsPackage",null,[2,3]);var T=d(306);class ca{eu(a,b,c=!1,f=!1,l=!1,y=null){return T.a.eu(a,b,c,f,l,y)}Oxc(a,b,c){return T.a.Oxc(a,b,c)}cub(a,b){return T.a.cub(a,b)}BW(a,b,c,f,l=!1,y=!1){return T.a.BW(a,b,c,f,l,y)}rRa(a,b=null){return T.a.rRa(a,b)}tea(){T.a.tea()}$8a(a,b,c,f=null){return T.a.$8a(a,b,c,f)}eFa(a,b,c=!1,f=!0){return T.a.eFa(a,b,c,f)}Ecc(a,b){return T.a.Ecc(a,b)}}Object(m.a)(ca,"TextMetricsAdapterProxy",null,[1439]);var N=d(316),da=d(154);class Y{uyj(a){var b=
a;for(a=null;!a&&b&&"P"!==b.tagName;)a=N.a.Be(b,da.a.oQb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(Y,"TextMetricsHelper",null,[390]);class fa{constructor(){this.Ea=null}get name(){return"Box4.TextMetrics"}init(){this.Ea.resolve("Box4.ITextMetricsAdapter")}dispose(){}Xb(a){this.Ea=a;this.Ea.register(1439,"Box4.ITextMetricsAdapter").na().oa(()=>new ca);this.Ea.register(390,"Box4.TextMetricsApi.ITextMetricsHelper").na().oa(()=>new Y)}static main(){n.a.instance.Ac(new fa)}}
Object(m.a)(fa,"Box4TextMetricsPackage",null,[2,3]);var aa=d(348),ka=d(253),H=d(7),ra=d(100),ha=d(395),Ma=d(735),Ga=d(99),na=d(47),wa=d(1272),Fa=d(1268),pa=d(67),Ea=d(573),ta=d(106),ia=d(317),Ja=d(814),ab=d(272),Oa=d(18),Za=d(6);class Na{static Qpl(a){const b=new Ma.a;for(let c of a)b.add(c);return b}static eqh(a,b){const c=new Oa.a;b=Na.Qpl(b);for(let f of a)b.contains(f)||c.add(f);return c}static r$k(a,b){return Na.eqh(Za.asEnumerable(a),b).toArray()}static s$k(a,b){return Na.eqh(a,b)}}Object(m.a)(Na,
"ExtendedGuidUtils",null,[]);var sa=d(1253),Sa=d(19),xb=d(162);class gc{}gc.IAi="ChangeInfo";Object(m.a)(gc,"CatchUpActivityConstants",null,[]);class zc{}zc.LJb="\u00a0";zc.LGf="\ue200";zc.dlg="\ue201";zc.Q_i=32767;zc.ZQc=3;zc.g5d=1;Object(m.a)(zc,"ContentEditableViewConstants",null,[]);var Xb=d(556),jb=d(123),zb=d(34),Tb=d(373),Ya=d(41),sb=d(42),oc=d(90),wb=d(91),rc=d(54),Ka=d(88);class Db{constructor(a,b,c){this.Ra=b;this.Lb=c}}Object(m.a)(Db,"ChangeInfo",null,[]);d(620);var bc=d(833);class Mc{}
Object(m.a)(Mc,"InternalLinkConstants",null,[]);class mb extends Sys.EventArgs{constructor(){super();this.J9a=null}}Object(m.a)(mb,"EditEventArgs",Sys.EventArgs,[]);class Wa extends mb{constructor(){super();this.wbk=0;this.dMl=this.RRc=this.P7e=this.Ybk=this.iPj=this.Mng=this.m4f=this.V6i=this.b3i=!1}}Object(m.a)(Wa,"ParagraphContentUpdatedEventArgs",mb,[]);class db{constructor(a){this.n5c=a}}Object(m.a)(db,"BlobPresenterArgs",null,[]);var ub=d(32);class Lb{}Lb.B4="TrackedChange";Lb.YJh="TrackChangeTableRowInsertion";
Lb.VJh="TrackChangeTableRowDeletion";Lb.KKh="TrackChangeTextInsertion";Lb.IKh="TrackChangeTextDeletion";Lb.JOj="TrackChangeImageModified";Lb.HOj="TrackChangeImageInsertion";Lb.DOj="TrackChangeImageDeletion";Lb.mte="TrackChangeIndirectEffect";Object(m.a)(Lb,"TrackChangeConstants",null,[]);var Kb=d(930),uc=d(98);const Yb=a=>!!a.rSa&&Za.AT(a.rSa,b=>3===b.type||2===b.type||4===b.type),Tc=(a,b)=>{let c=!1,f=!1,l=null;if(b.rSa)for(let y of b.rSa)1===y.type&&(c=!0),3===y.type&&(f=!0),4===y.type&&y.Ke&&y.Ke.paragraph&&
(l=y);l&&Sys.UI.DomElement.addCssClass(a,uc.a.oTi);f&&Sys.UI.DomElement.addCssClass(a,uc.a.Wjg);c&&Sys.UI.DomElement.addCssClass(a,uc.a.iTi)},sc=a=>{const b=[uc.a.YZi,uc.a.ZZi,uc.a.XZi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var Qb=d(367);class kb{constructor(a){this.uUb=this.uZb=this.Dff=null;this.Vi=a}get paragraphNode(){return this.Vi}get rSa(){return this.Dff}get vmb(){return this.uZb}get P9a(){return this.uUb}get isEmpty(){return(!this.rSa||!this.rSa.count)&&(!this.vmb||!this.vmb.count)&&
(!this.P9a||!this.P9a.count)}GJk(){this.vmb&&(this.uZb=new Oa.a);this.P9a&&(this.uUb=new Oa.a)}Wzd(a){this.rSa||(this.Dff=new Qb.a);this.vmb||(this.uZb=new Oa.a);this.P9a||(this.uUb=new Oa.a);this.rSa.Wzd(a,b=>{this.vmb.add(b)},b=>{this.P9a.add(b)})}}Object(m.a)(kb,"IntentRenderingState",null,[]);class Ib{constructor(a,b){this.element=a;this.next=b}}Object(m.a)(Ib,"ElementStackNode",null,[]);class eb{constructor(a=!1){this._history=new Sys.StringBuilder;this.bBa=this.vv=null;this.TZb=a}ffk(a){if(this.TZb&&
a){this._history.append("[Cp "+a.cp+":");if(a.ai)for(var b=0;b<a.ai.length;b++)this._history.append(a.ai.ga(b).Ly+","+a.ai.ga(b).Yfa),b!==a.ai.length-1&&this._history.append("|");if(a.Ak)for(a.ai&&this._history.append("|"),b=0;b<a.Ak.length;b++)this._history.append(a.Ak.ga(b).Lua?"B":"I"),this._history.append(a.Ak.ga(b).Jk?"S":"E"),this._history.append(a.Ak.ga(b).PBb?"R":"F"),b!==a.Ak.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.vv){for(var a=this.vv;a.next;)a=
a.next;a.next=this.bBa;this.bBa=this.vv;this.vv=null;this.TZb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&ha.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.TZb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.vv.element}pop(a=""){this.isEmpty()&&ha.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=
this.vv.element;this.vv.element=null;const c=this.vv.next;this.vv.next=this.bBa;this.bBa=this.vv;this.vv=c;this.TZb&&this._history.append(String.format("Pop {0} Label:{1}\n",b?b.className:"Null Element",a));return b}push(a,b=""){if(this.bBa){const c=this.bBa.next;this.bBa.next=this.vv;this.vv=this.bBa;this.bBa=c;this.vv.element=a}else this.vv=new Ib(a,this.vv);this.TZb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.vv}}Object(m.a)(eb,
"ElementStack",null,[]);class Rb{constructor(){this.vcc=!1;this.span=null}}Object(m.a)(Rb,"IntelligentPlaceholderRenderingState",null,[]);class pc{constructor(a,b,c){this.eventName=a;this.Bc=b;this.handler=c}}Object(m.a)(pc,"ParagraphContentRendererMouseEventRegistration",null,[]);var Wc=d(78);class Ic extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.iMb=c}}Object(m.a)(Ic,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class nd extends Ic{constructor(a,
b,c,f,l){super(a,b,c);this.uZb=f.vmb;this.uUb=f.P9a;this.z_h=l}get vmb(){return this.uZb}get P9a(){return this.uUb}get elementType(){return this.z_h}}Object(m.a)(nd,"IntentRangeRenderedEventArgs",Ic,[]);class ob extends Ic{constructor(a,b,c,f){super(a,b,c);this.aq=f}}Object(m.a)(ob,"SpellingErrorRenderedEventArgs",Ic,[]);class $b{constructor(){this.Oa=new Wc.a}dispose(){this.Oa&&(this.Oa.dispose(),this.Oa=null)}k3k(a,b,c,f){this.Oa&&this.Oa.raiseEvent($b.DMk,new ob(a,b,c,f))}Gmh(a,b,c,f,l){this.Oa&&
this.Oa.raiseEvent($b.BIk,new nd(a,b,c,f,l))}}$b.DMk="OnSpellingErrorRangeRendered";$b.BIk="OnIntentRangeRendered";Object(m.a)($b,"ParagraphRenderEvents",null,[108]);class Hc{constructor(){this.HLf=null;this.mjg=!1;this.R6g=this.eyf=null}}Object(m.a)(Hc,"RenderParagraphContentResults",null,[]);var Pb=d(153),Yc=d(72),Rd=d(335);class Gb{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){this.hBa=this.JJd=this.KId=this.mrb=null;this.Pf=a;this.$P=b;this.hd=c;this.Lqa=f;this.BN=l;this.qw=G;this.g6a=
R;this.iPa=ja;this.jZh=Va;this.XV=hb;this.g8h=Cb;this.R0h=lc;this.LXh=yc;this.Pwf=new Ma.a;this.HHc=ic;this.tqb=!!za&&za.VFa(65);this.QHc=this.RBc=null;this.ROa=y;this.h3h=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");this.kd=za}get aJf(){return!0}get nrg(){null==this.KId&&(this.KId=!!this.kd&&this.kd.isFeatureEnabled(85));return this.KId}get zvg(){null==this.JJd&&(this.JJd=!!this.kd&&this.kd.isFeatureEnabled(77));return this.JJd}get rO(){null==
this.hBa&&(this.hBa=!!this.kd&&this.kd.isFeatureEnabled(79));return this.hBa}ydl(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){this.RBc={};this.QHc=new Pb.a;const Xd=zb.ParagraphReader.text(a),Qd=new Oa.a;var Ie=!1;w.AFrameworkApplication.fa&&(Ie=w.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));const Pe=new eb(Ie);Pe.push(c,"RenderParagraphContentStart");let ig=null,ff=null,bh=null,ch=null,of=Ie=null;const sg=new Wa;var Fg=!1;let og=!1,pi=!1,Wj=!1,wg=0,Tg=null,Dh=null;const Mm=
new Oa.a;this.HHc&&this.HHc.m1l(a,c);const Jj=this.iPa.fX(a);this.iPa.Voi(c,a,b,Jj,b.Nd);if(this.g6a.Gx&&b.lm){var Nm=this.Pf.Rd;Nm&&1===Nm.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}Nm=!a.nX;let so=!1,an=!1,to=!1,hm=!1,Vl=0,um=!1,Kn=!1,wl=null,ui=0;const Ln=new Rb,uo=Array(a.Sa.length+1);let Lp=this.nrg?new Oa.a:null,bn=null,cn=null;for(;wg<a.Sa.length;){const Fe=a.Sa.ga(wg);var Kj=void 0,vh=void 0,tj=!1;Pe.ffk(Fe);({YNc:Kj,UNc:vh}=Gb.r7f(Fe));this.nrg&&(!this.h3h||Kj.length||
vh.length)&&({YNc:Kj,UNc:vh,FTi:Lp,x1j:tj}=Gb.pSl(Fe.paragraph.Nh,Kj,vh,Lp),Ln.vcc=0<Lp.count);hm=0<Kj.length||hm;uo[wg]=c.childNodes.length;if(0<Fe.cp&&Fe.Xj)break;let Eh=Fe.cp;const Aj=wg<a.Sa.length-1?a.Sa.ga(wg+1).cp:zb.ParagraphReader.textLength(a);wg++;var zg=!1;0<Eh&&Pe.pop("CurrentCpLargerThanZero");Fe.eM&&(ig=null);Fe.Av&&(cn=Fe.Av);Fe.isDictationCorrectionEnd&&(cn=null);Fe.bZ&&(ff=null);Fe.L4&&(bh=null);Fe.Kla&&(ch=null);var $d=void 0,nf=void 0;this.rO?($d=Fe.Cea,nf=Fe.k0):($d=!!Fe.Vo,nf=
!!Fe.fieldRangeEnd);if(!Fg||Fe.blob||Fe.formatting||Fe.hyperlink||Fe.Cn||Fe.N4||nf||$d||this.tqb&&(Fe.isTrackChangeInfoEnd||Fe.xO)||Fe.Bw&&!Fe.Bw.isEmpty)zg=!0,0<Eh&&Fg&&Pe.pop("InFormattingSpan");nf&&(Pe.pop("HasFieldEnd"),Fg=!1);Fe.Cn&&(so||(pi=!0),an=so=!1);Fe.hyperlink&&(so&&(pi=!0),so=!0,an=Fe.hyperlink.Jua);Fe.Cn&&!pi&&(Pe.pop("IsHyperlinkEnd"),Fg=!1);this.kd&&this.kd.isFeatureEnabled(17)&&(Fe.isChangeEnd&&(um||ha.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),
um=!1,Dh=null),Fe.changeStart&&(um&&ha.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),Dh=Fe,um=!Fe.Xj));if(this.tqb&&(Fe.isTrackChangeInfoEnd&&(to||(Wj=!0),to=!1,Tg=null),Fe.xO&&(to&&(Wj=!0),Tg=Fe,to=!Fe.Xj),Fe.isTrackChangeInfoEnd&&!Wj)){for(Fg=0;Fg<Vl;Fg++)Pe.pop("IsTrackChangeInfoEnd");Vl=0;Fg=!1}bn&&bn.GJk();Fe.Bw&&(bn||(bn=new kb(a)),bn.Wzd(Fe.Bw));if(Fe.N4&&!Fe.Xj){Ie=Ie||Fe.formatting;nf=this.iRf(Pe.peek("CreateIpFormattingSpan"),Ie,Jj,b,a,Va,ja,Tg);nf=
Ga.a.pab(nf);for(let Lj of nf)hb=Gb.fja(l,hb,Lj);sg.Mng=!0}Fe.hyperlink&&!pi&&({HGa:hb,v0i:Kn,returnValue:of}=this.rdl(of,Fe,Pe,Jj,sg,b,a,f,l,y,G,ja,Tg,hb,Va,Nm,Fg,Kn));!this.tqb||Wj||Fe.Xj||(Fe.Fp&&(this.NXe(Fe.Fp,Pe,sg,b,ja),Vl++),Fe.Qo&&(this.NXe(Fe.Qo,Pe,sg,b,ja),Vl++),Fe.gt&&(this.NXe(Fe.gt,Pe,sg,b,ja),Vl++));$d&&({oSa:Ie,HGa:hb,returnValue:of}=this.ndl(of,l,a,Fe,Ie,Pe,Jj,sg,b,ja,Va,hb,Fg,Nm,Tg));this.zvg&&this.VKf(a,b,ec&&yc);Fe.blob?({HGa:hb,Xbk:wl,Wbk:ui,returnValue:og}=this.edl(hb,Fg,Ie,
Fe,y,G,Nm,of,Pe,Jj,sg,Eh,og,yc,b,Mm,ec,a,Va,l,Cb,lc,R,ja,Qd,Tg,Dh,Kj,vh,wl,ui,bn),Fg=!1,Ie=of=null):($d=Fe.N4&&!na.a.substring(Xd,Eh,Aj).length,zg&&(zg=of,{oSa:Ie,returnValue:of}=this.pdl(Ie,Fe,Jj,Pe,sg,b,a,ja,Tg,Va,$d),Fg=!0,of&&of.style&&(Kn&&zg&&zg.style&&(zg.style.fontSize=of.style.fontSize,zg.style.lineHeight=of.style.lineHeight),wl&&wl.style&&0<ui&&Fe.formatting&&Fe.formatting.cache.rua&&ui>Fe.formatting.cache.fontSize&&(wl.style.fontSize=of.style.fontSize,wl.style.lineHeight=of.style.lineHeight))),
Kn=!1,wl=null,ui=0,$d||(Fe.aq&&(ig=Fe.aq),Fe.QF&&(bh=Fe.QF),Fe.gM&&(ch=Fe.gM),Fe.Vw&&(ff=Fe.Vw),zg=na.a.substring(Xd,Eh,Aj),tj=this.P2d(Pe.peek("CreateTextOverlaySpan1"),Ie,a,ig,bh,ch,ff,b,Mm,ja,zg,ec&&(Cb<=Eh&&Eh<lc||a.nX),xd,Ln,tj,bn,!!cn,an),Pe.push(tj,"TextOverlaySpan1"),sg.P7e=!0,this.lTd(Pe.peek("AddCommentHintCssAndDataToElement"),Kj,vh),this.BN&&this.BN.OAb&&ig&&ig.Fh&&(Kj=Object(sa.a)(344,ig.Fh))&&Kj.UN&&Kj.UN.TraceId&&5===Kj.proofingType&&!Kj.uFa&&(this.g$k(Pe.peek("RemoveConsistencyCheckCustomData")),
vh=this.Egj(Fe.aq,a,wg),N.a.dw(Pe.peek("errorDetails"),vh,Kj.UN.TraceId)),this.n0e(Dh,Pe.peek("SetChangeId"),Fe.cp,Aj),ec&&Cb!==lc&&({HGa:hb,returnValue:Eh}=this.$Yk(tj,Pe,Ie,a,ig,bh,ch,ff,sg,b,l,Mm,ja,Xd,Cb,lc,hb,Eh,Aj,xd,Ln,bn,!!cn,an)),Ga.a.Rz(Pe.peek("SetElementText"),na.a.substring(Xd,Eh,Aj)),hb=Gb.fja(l,hb,Pe.peek("AddLeafNodeElement"))))}if(a.EZc!==hm||this.tqb||this.g6a.myc)a.EZc=hm,(f=rc.OutlineElementNavigator.AB(a))&&f.z9(b.Na,32,!0);({n5c:of,HGa:hb,returnValue:Fg}=this.tdl(a,c,Ie,Jj,sg,
of,b,a,l,ja,Tg,Va,hb,Fg,Nm));!Ln.vcc&&Ln.span&&this.TVd(null,Ln.span);Nm&&this.ldl(c,of,sg,b,a,l,ja,za,hb,ic,Dh);uo[uo.length-1]=c.children.length;this.mTl(og,jc,b);this.hUl(sg,Fg,l);this.Uzh(b,a,c);let Pf;return Pf=new Hc,Pf.HLf=Qd,Pf.mjg=og,Pf.eyf=uo,Pf.R6g=Mm,Pf}iMb(a,b,c,f){this.$P.ub(a,b,c,f);return new pc(a,b,c)}Egj(a,b,c){let f=0;a&&a.Fh&&(f|=16);if(c<b.Sa.length&&b.Sa.ga(c).eM||c===b.Sa.length)f|=1;switch(f){case 0:return Kb.a.yLe;case 16:return Kb.a.D5c;case 1:return Kb.a.qrd;case 17:return Kb.a.DLc}return""}g$k(a){N.a.Toa(a,
Kb.a.yLe);N.a.Toa(a,Kb.a.D5c);N.a.Toa(a,Kb.a.qrd);N.a.Toa(a,Kb.a.DLc)}n0e(a,b,c,f){this.kd&&this.kd.isFeatureEnabled(17)&&a&&a.changeStart&&N.a.dw(b,gc.IAi,new Db(a.changeStart.id,c,f))}rdl(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){!yc||ec||b.N4||(a=this.E3b(c.peek("CreateFormattingSpan1"),null,f,y,G,hb,ic,Cb),a.className+=" EmptyTextRun",lc=Gb.fja(ja,lc,a),jc=l.RRc=!0);b=this.fPi(c.peek("CreateLinkAnchor"),b.hyperlink,y,R,za,Va,hb);c.push(b,"RenderHyperlink");l.Ybk=!0;return{returnValue:a,HGa:lc,
v0i:jc}}NXe(a,b,c,f,l){a=this.GSi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.dMl=!0}ndl(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){Cb||f.N4||(l=f.formatting||l,lc?(a=this.E3b(y.peek("CreateFormattingSpan2"),l,G,ja,c,za,Va,ic),a.appendChild(ja.ownerDocument.createTextNode("")),a.className+=" EmptyTextRun",hb=Gb.fja(b,hb,a),R.RRc=!0):(a=this.EPc(l,G,ja,c,Va,ic),R.m4f=!0));b=this.fOi(y.peek("CreateFieldRangeSpan1"),ja,za,c);y.push(b,"RenderFieldRange");R.V6i=!0;return{returnValue:a,
oSa:l,HGa:hb}}edl(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og,pi){b||(c=f.formatting||c,G&&!f.N4?(R=this.E3b(ja.peek("CreateFormattingSpan4"),c,za,ic,jc,ig,xd,bh),R.appendChild(ic.ownerDocument.createTextNode("")),R.className+=" EmptyTextRun",a=Gb.fja(Xd,a,R),Va.RRc=!0):R=this.EPc(c,za,ic,jc,xd,bh));1===f.blob.Cq&&(Cb=!0);b=f.blob.Prj(ic);b.f5f(new db(R));R=b.element;Sys.UI.DomElement.containsCssClass(R,uc.a.Idc)&&(Fg=R,c&&c.cache.rua&&(og=c.cache.fontSize));
Sys.UI.DomElement.addCssClass(R,uc.a.JN);this.g6a.e_i&&5!==f.blob.Cq&&Sys.UI.DomElement.addCssClass(R,uc.a.a_i);this.tqb&&this.sdl(f,ic,R,bh);this.lTd(R,of,sg);pi&&!pi.isEmpty?(Tc(R,pi),this.mrb&&this.mrb.Gmh(R,jc,(Wj,wg,Tg,Dh)=>{yc.add(this.iMb(Wj,wg,Tg,Dh))},pi,1)):sc(R);this.n0e(ch,R,f.cp,f.cp+1);ja.peek("blobElt").appendChild(R);Pe(R,!0);ff.add(f.blob);ec&&(Qd<=hb&&hb+1<=Ie||jc.nX)?(lc&&(Sys.UI.DomElement.containsCssClass(R,uc.a.f3d)||Sys.UI.DomElement.addCssClass(R,uc.a.f3d),w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),
w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.Pf&&this.Pf.Rd&&Object(Sa.a)(Xb.PageView,this.Pf.Rd)&&(c=this.Pf.Rd,hb=w.AFrameworkApplication.Qa,c&&3===c.zwg?hb.Ja(C.a.PLh,2,R):hb.Ja(C.a.QLh,2,R))),Sys.UI.DomElement.addCssClass(R,uc.a.H8)):(Sys.UI.DomElement.removeCssClass(R,uc.a.f3d),Sys.UI.DomElement.removeCssClass(R,uc.a.H8));this.zvg||this.VKf(jc,ic,ec&&lc);Sys.UI.DomElement.removeCssClass(R,uc.a.kTi);this.kd&&this.kd.isFeatureEnabled(162)&&
5===f.blob.Cq&&(f=f.blob,f.properties&&f.properties.Ta(Ya.a.O$b)&&(f=f.properties.eb(Ya.a.O$b))&&""!==f&&(yc.add(this.iMb(pa.a.Vfa,R,l,f)),yc.add(this.iMb(pa.a.Vfa,R,y,f))));a=Gb.fja(Xd,a,R);ja.push(R,"RenderBlob");return{returnValue:Cb,HGa:a,Xbk:Fg,Wbk:og}}lTd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,uc.a.XNc),N.a.dw(a,uc.a.h0d,b)):Sys.UI.DomElement.removeCssClass(a,uc.a.XNc);c.length&&N.a.dw(a,uc.a.d0d,c)}VKf(a,b,c){a=ub.GraphIterator.pb(a);a.kf();a.Jg(11);if(b=a.currentNode.qc(b.Na))b.htmlElement.style.zIndex=
c?"1":""}sdl(a,b,c,f){let l=Ga.a.sfj(c,Gb.RLh);5===a.blob.Cq&&f?(l||(l=b.vp(Fa.a.span),l.id=Gb.RLh,Sys.UI.DomElement.addCssClass(l,Lb.JOj),Sys.UI.DomElement.addCssClass(l,Lb.B4),c.appendChild(l)),this.t5f(b,l,f.Fp,Lb.DOj),this.t5f(b,l,f.Qo,Lb.HOj)):l&&c.removeChild(l)}t5f(a,b,c,f){c&&!Ga.a.L7b(b,f)&&(a=a.vp(Fa.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}pdl(a,b,c,f,l,y,G,R,ja,za,Va){a=b.formatting||a;b=Va?this.EPc(a,c,y,G,za,ja):this.E3b(f.peek("CreateFormattingSpan5"),
a,c,y,G,R,za,ja);f.push(b,"RenderFormattingSpan");l.m4f=!0;return{returnValue:b,oSa:a}}$Yk(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig){jc<ic&&ic<xd&&(jc=na.a.substring(lc,jc,ic),Ga.a.Rz(a,jc),ec=Gb.fja(Va,ec,a),b.pop("ProcessSelectionBegins"),a=this.P2d(b.peek("CreateTextOverlaySpan2"),c,f,l,y,G,R,za,hb,Cb,jc,!0,Xd,Qd,!1,Ie,Pe,ig),b.push(a,"TextOverlaySpan2"),jc=ic,ja.P7e=!0);jc<yc&&yc<xd&&(lc=na.a.substring(lc,jc,yc),Ga.a.Rz(a,lc),ec=Gb.fja(Va,ec,a),b.pop("ProcessSelectionEnds"),
a=this.P2d(b.peek("CreateTextOverlaySpan3"),c,f,l,y,G,R,za,hb,Cb,lc,!1,Xd,Qd,!1,Ie,Pe,ig),b.push(a,"TextOverlaySpan3"),jc=yc,ja.P7e=!0);return{returnValue:jc,HGa:ec}}tdl(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){if(0<a.Sa.length){const ec=a.Sa.last;var yc=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=ub.GraphIterator.pb(a);!ec.Cn||yc&&a.rc(16)||(lc=!1,c=null);if(this.rO?ec.k0:ec.fieldRangeEnd)lc=!1,c=null;yc=y;if(ec.N4){c||(c=ec.formatting);y=this.iRf(b,
c,f,G,R,hb,za,Va);b=Ga.a.pab(y);for(let jc of b)Cb=Gb.fja(ja,Cb,jc);l.Mng=!0}else!lc&&ic&&(c||(c=ec.formatting),y=this.E3b(b,c,f,G,R,za,hb,Va),y.appendChild(G.ownerDocument.createTextNode("")),y.className+=" EmptyTextRun",Object(Rd.a)("UpdateStyleForEmptyTextRunSpan")&&y&&y.style&&yc&&yc.style&&(y.style.lineHeight!=yc.style.lineHeight&&(ha.ULS.sendTraceTag(508876387,324,50,"Update lineHeight for empty text run span"),y.style.lineHeight=yc.style.lineHeight),y.style.fontSize!=yc.style.fontSize&&(y.style.fontSize=
yc.style.fontSize)),Cb=Gb.fja(ja,Cb,y),l.RRc=!0)}else ha.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:lc,n5c:y,HGa:Cb}}ldl(a,b,c,f,l,y,G,R,ja,za,Va){var hb=Gb.Lej(a,za);b=this.SQf(b,f,R,hb);Ea.a.instance.shipAssertTag(25519712,8,0<l.Sa.length,"Chps should never be empty");R=null;l.Sa&&0<l.Sa.length&&(R=l.Sa.last);this.tqb&&R&&(R.Fp||R.Qo||R.gt)&&(b.className+=" "+Lb.B4);let Cb;({YNc:hb,UNc:Cb}=Gb.r7f(R));this.lTd(b,hb,Cb);this.n0e(Va,b,R?R.cp:0,-1);za&&
(b.className+=" "+Tb.a.Y3d);this.Uzh(f,l,b);a.appendChild(b);G(b);Gb.fja(y,ja,b);c.b3i=!0}Uzh(a,b,c){if(a.lm&&this.Lqa.hmd&&this.Lqa.lyl(c)){if((a=this.Lqa.fua(b))&&0<ta.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){ha.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.Lqa.yyj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}GSi(a,b,c,f){c=c.vp(Fa.a.span);switch(b.changeType){case 2:c.className=
Lb.IKh+" "+Lb.B4;c.style.color="#000";break;case 1:c.className=Lb.KKh+" "+Lb.B4;c.style.color="#000";break;case 3:c.className=Lb.B4}a.appendChild(c);f(c);return c}mTl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}hUl(a,b,c){a.wbk=c.count;a.iPj=b;this.g8h(a)}fPi(a,b,c,f,l,y,G){c=c.vp(Fa.a.a);c.className=uc.a.skg;b.Jua&&b.puc&&!M.a.instance.ga(61)&&(b.url.endsWith(w.AFrameworkApplication.fa.Ha("UserPrincipalName"))?c.className+=" "+uc.a.qTi:c.className+=" "+uc.a.rTi);this.qw.XDh()&&(c.style["pointer-events"]=
"all");this.qw.tDh(this.g6a.DWl,!0)&&this.T$k(c);this.$P.ub(pa.a.Vfa,c,l,b.url);this.$P.ub(pa.a.Wfa,c,y);f.add(c);b.url&&na.a.I9(b.url)&&!z.a.Yi&&(xb.d(c,wa.a.href,b.url),xb.d(c,wa.a.target,"_blank"),xb.d(c,wa.a.rel,"noreferrer"));a.appendChild(c);G(c);return c}T$k(a){a.style.textDecoration="none";a.style.color="inherit"}E3b(a,b,c,f,l,y,G,R){b=this.EPc(b,c,f,l,G,R);a.appendChild(b);y(b);return b}EPc(a,b,c,f,l,y){if(this.aJf){var G=a?a.Fm.toString():ia.a.nil.toString();if(G in this.RBc)a=this.RBc[G];
else{let R=a?a.cache:bc.FormattingCacheManager.P$a(f,ia.a.nil);a=this.J1d(a,R,b,c,f,l);this.RBc[G]=a}b=a.cloneNode();N.a.GOc(a,b)}else G=a?a.cache:bc.FormattingCacheManager.P$a(f,ia.a.nil),b=this.J1d(a,G,b,c,f,l);this.CEf(b,y);return b}J1d(a,b,c,f,l,y){const G=f.vp(Fa.a.span);b=this.qw.X7f(f,b,l)||b;this.Eoi(f,G,b,l);this.Joi(G,b,l,f,y);this.Toi(G,a);this.iPa.Woi(G,l,c,f.Nd,b.fontSize,b.BL);return G}Eoi(a,b,c,f){a=this.qw.V7f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}iRf(a,b,c,f,l,y,G,
R){var ja=b?b.cache:bc.FormattingCacheManager.P$a(l,ia.a.nil);ja=this.LXh(ja,l);b=this.J1d(b,ja,c,f,l,y);this.CEf(b,R);ja.isSuperscript||ja.dG?(f=f.vp(Fa.a.span),this.yEf(f,ja,!0),b.appendChild(f),Ga.a.Rz(f,""),G(f)):Ga.a.Rz(b,"");a.appendChild(b);G(b);return b}Joi(a,b,c,f,l){var y=b.zt;const G=[];Array.add(G,uc.a.MMa);var R=this.qw.xbe(c,b,this.g6a.EWl,y);var ja=null;b.qbb&&(ja=b.lS,ja=ja===oc.a.auto?"transparent":oc.a.fH(ja));b.cVa&&(ja=b.highlight,ja=ja===oc.a.auto?"transparent":oc.a.fH(ja));c.t8g!==
oc.a.nil&&(R=oc.a.fH(c.t8g));l!==oc.a.nil&&(ja=oc.a.fH(l));Ga.a.bDa(a);b.Rig&&(a.style.opacity=b.R3f.toString());b.hcb&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);R?(a.style.color=R,xb.d(a,wa.a.mTf,"WindowText"===R?"auto":"none")):xb.d(a,wa.a.mTf,"auto");ja?(a.style.backgroundColor=ja,"transparent"!==ja&&Array.add(G,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.dG)l=Math.floor(l*this.qw.Qee());R=this.qw.p9f(l,c,f.Nd);ja=this.qw.a8b(b);l=this.XV&&
this.XV.F$i?this.XV.tei(b.BL):this.jZh(ja);this.g6a.fpe&&l&&aa.FontUtils.WBb(ja)&&(l=this.qw.EEf(ja,l));let za=b.XUa&&b.isBold;void 0===za&&(za=!1);let Va=b.nbb&&b.isItalic;void 0===Va&&(Va=!1);l=this.qw.glh(new Ja.a(ja,za,Va),l,c);!this.HPl(ja,b,a.style)&&b.XUa&&(b.isBold?(a.style.fontWeight="bold",z.a.fl&&z.a.ik&&Array.add(G,"MacChromeBold")):a.style.fontWeight="normal");b.nbb&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.Nzb||y&&this.qw.vDh()||b.Mzb||b.g$b)&&this.OXe(a,b,c,G);R&&(a.style.fontSize=
R);if(l&&(a.style.fontFamily=l,M.a.instance.ga(118))){Ea.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");y=l.split(",");for(l=0;l<y.length-1;l++)c.append('"'+y[l].trim()+'",');0<y.length&&c.append('"'+y[y.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.YUa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.qw.U6f(b,f.Nd))a.style.letterSpacing=f;if(b=
this.qw.s$f(b))a.style.fontKerning=b,z.a.gU&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=G.join(" ")}HPl(a,b,c){return M.a.instance.ga(116)&&z.a.fl&&z.a.ik?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}CEf(a,b){this.hd.gg&&b&&!b.Xj&&(b.Fp||b.Qo)&&
(a.style.color="#000")}Toi(a,b){if(b=b?this.R0h(b):0){const c=ab.a.He(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.Pwf.contains(b)||(ha.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.Pwf.add(b))}}OXe(a,b,c,f){c="";const l=b.uE,y=b.cG;b=b.j0;l&&(c="underline",f[f.length]="Underlined");if(y||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||y||b||(c="none");0<c.length&&(a.style.textDecoration=c)}yEf(a,b,c){b.isSuperscript&&
(a.style.verticalAlign="super",a.className+=" Superscript");b.dG&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.dG)&&xb.d(a,wa.a.oTf,(b.fontSize/2).toString())}P2d(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){const xd=b?b.cache:bc.FormattingCacheManager.P$a(c,ia.a.nil);Va=!f||Cb||this.eTa(f,Va)?0:f.Fh.proofingType;Cb=!!l;const Xd=!!y,Qd=!!G;y=this.qw.PDh(xd,hb,l,y,G);if(lc.vcc||yc&&Yb(yc))y=!1;this.aJf?(l=this.Byj(xd,Va,Cb,Xd,
Qd,hb,y,ec),this.QHc.Gb(l)?hb=this.QHc.ga(l):(hb=this.qSf(R,xd,Va,Cb,Xd,Qd,hb,y,ec,f),this.QHc.$(l,hb)),R=hb.cloneNode(),N.a.GOc(hb,R)):R=this.qSf(R,xd,Va,Cb,Xd,Qd,hb,y,ec,f);this.Pmi(a,R,xd);this.hVd(a,R);this.kCf(R);this.jCf(a,R);this.Lqa.PLi&&this.Qmi(R,b,c);this.mrb&&0!==Va&&this.mrb.k3k(R,c,(Ie,Pe,ig,ff)=>{ja.add(this.iMb(Ie,Pe,ig,ff))},f);lc.vcc&&ic&&lc.span&&(this.TVd(null,lc.span),lc.span=null);if((b=lc.vcc?R:null)||lc.span)this.TVd(b,lc.span),lc.span=b,lc.span&&(b=(b=N.a.Be(a,da.a.J5c))?
b:-1,0<b&&(lc.span.style.lineHeight=String.format("{0}px",b+3)));yc&&!yc.isEmpty&&(Tc(R,yc),this.mrb&&this.mrb.Gmh(R,c,(Ie,Pe,ig,ff)=>{ja.add(this.iMb(Ie,Pe,ig,ff))},yc,0));jc&&Sys.UI.DomElement.addCssClass(R,uc.a.pTi);a.appendChild(R);za(R);return R}eTa(a,b){b=a&&a.Fh&&a.Fh.token?a.Fh.token:b;return 0!==a.Fh.errorType&&!!this.ROa&&this.ROa.contains(b,a.Fh.lcid)}Byj(a,b,c,f,l,y,G,R){b|=0;y&&(b|=16);G&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);R&&(b|=2048);a.isSuperscript&&(b|=512);a.dG&&(b|=1024);
return b}qSf(a,b,c,f,l,y,G,R,ja,za){a=a.vp(Fa.a.span);const Va=[];if(0!==c){if(!this.g6a.EZl)switch(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&za&&(ja=za.Fh)&&ja.NCf&&Va.push("annotation-"+ja.NCf),c){case 1:Va[Va.length]=uc.a.MPc;break;case 2:Va[Va.length]=uc.a.KPc;break;case 3:Va[Va.length]=uc.a.JPc}b.isSuperscript&&(Va[Va.length]=uc.a.h3d)}else ja&&(Va[Va.length]=uc.a.hTi);G&&(Va[Va.length]=uc.a.H8);f&&(Va[Va.length]=uc.a.c3d);l&&
(Va[Va.length]=uc.a.e3d);y&&(Va[Va.length]=uc.a.LPc);a.className=0<Va.length?Va.join(" "):uc.a.c4b;this.yEf(a,b,R);return a}Qmi(a,b,c){if(b&&a){if(b=wb.a.ayb(b))if(b=Ka.StyleReader.OQ(b)){a.setAttribute("data-ccp-charstyle",b);return}(c=zb.ParagraphReader.fe(c)?Ka.StyleReader.qE(c):null)&&(c=Ka.StyleReader.OQ(c))&&c!==Ka.StyleReader.wNa&&c!==Ka.StyleReader.CTh&&a.setAttribute("data-ccp-parastyle",c)}}Pmi(a,b,c){(c=this.qw.Vdg(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,
a=parseFloat(na.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.qw.Qee()*c/100+"px"))}hVd(){}kCf(){}jCf(){}fOi(a,b,c,f){b=b.vp(Fa.a.span);b.className=uc.a.o8d;this.HHc&&this.HHc.r2l(f,b);a.appendChild(b);c(b);return b}SQf(a,b,c,f){b=b.vp(Fa.a.span);b.className=uc.a.$N;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.Zae(a),b.style.fontFamily=a.style.fontFamily,Object(Rd.a)("UpdateTextColorInEOP")&&(b.style.color=a.style.color));a="";for(let l=0;l<f;l++)a+=c;
b.innerText=a;return b}Zae(a){return a.style.lineHeight}TVd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,uc.a.lTi),b||Sys.UI.DomElement.addCssClass(a,uc.a.d3d)):b&&((a=Sys.UI.DomElement.containsCssClass(b,uc.a.d3d))&&Sys.UI.DomElement.removeCssClass(b,uc.a.d3d),Sys.UI.DomElement.addCssClass(b,a?uc.a.nTi:uc.a.mTi))}static fja(a,b,c){N.a.dw(c,da.a.GGa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static r7f(a){let b,c;b=[];c=[];if(a&&a.Bg)for(let f=0;f<a.Bg.length;f++){const l=
a.Bg.ga(f);Array.add(l.Jk?b:c,l.RI)}return{YNc:b,UNc:c}}static tui(a,b){const c=new Yc.a;for(const l of b){var f=a.Be(l);b=f.eb(sb.a.O2b);if(f=f.sa(sb.a.VNc,null)){let y;({value:y}=c.vg(f)).returnValue||(y=new Oa.a,c.$(f,y));y.add(b)}}return c}static t7f(a,b,c){const f=new Oa.a,l=Gb.tui(a,b);for(const y of b){const G=a.Be(y),R=G.eb(sb.a.O2b),ja=G.sa(sb.a.YJi,!1),za=G.sa(sb.a.RNf,!1);G.sa(sb.a.Bpe,!1)&&!za&&(c.add(y),ja||l.Gb(R)||f.add(G.id))}return Na.r$k(b,f)}static pSl(a,b,c,f){const l=new Oa.a,
y=new Oa.a;b=Gb.t7f(a,b,l);a=Gb.t7f(a,c,y);c=new Oa.a;c.addRange(f);c.addRange(l);c=Na.s$k(c,y);return{YNc:b,UNc:a,FTi:c,x1j:0<y.count}}static Lej(a,b){var c=1;if(z.a.bG&&!b){a=Ga.a.RUc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&(c+=zc.ZQc+zc.g5d)}return c}}Gb.D$i=.8;Gb.RLh="TrackChangeImageOverlay";Object(m.a)(Gb,"ParagraphContentRenderer",null,[1463]);var Bb=d(76),dc=d(615),Xc=d(1267),Fb=d(55);class kd{constructor(a){this._element=null;this.pi=
a;this.qCc=[]}get ownerDocument(){return this.pi}get element(){return this._element}Jlb(a){this._element=a}G8g(){var a=Sys.EventArgs.Empty;if(this.qCc)for(let b=0;b<this.qCc.length;b++)(0,this.qCc[b])(this,a)}dispose(){this.qCc=this._element=this.pi=null}}Object(m.a)(kd,"APresenter",null,[1483,108]);class od extends kd{constructor(a,b){super(b.htmlElement.ownerDocument);this.yqb=null;this.IXb=a;this.qci=b}f5f(a){this.element&&a.n5c===this.yqb||(this.yqb=a.n5c,this.Jlb(this.IXb.SQf(this.yqb,this.qci.Od,
da.a.aSc,1)),this.element.className=uc.a.Idc,this.element.style.lineHeight=this.yqb.style.lineHeight,a=""+N.a.Be(this.yqb,da.a.oQb),N.a.dw(this.element,da.a.oQb,a),a=Xc.a.createElement(this.ownerDocument,Fa.a.span),a.innerText=da.a.EAi,Ga.a.yv(this.element),this.element.appendChild(a),a=Xc.a.createElement(this.ownerDocument,Fa.a.br),this.element.appendChild(a))}wng(){}dispose(){super.dispose();this.yqb=null}}Object(m.a)(od,"LineBreakPresenter",kd,[]);class Gd{constructor(a){this.IXb=a}create(a){return new od(this.IXb,
a)}}Object(m.a)(Gd,"LineBreakPresenterFactory",null,[1461]);class Fd extends kd{constructor(a,b){super(a.ownerDocument);this.cSd=b;this.Mca=a}f5f(){this.element||(this.Jlb(this.Mca.vp(Fa.a.span)),19===this.cSd.kind||18===this.cSd.kind?Sys.UI.DomElement.addCssClass(this.element,uc.a.b3d):(Sys.UI.DomElement.addCssClass(this.element,uc.a.d4b),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.cSd.z9a,this.G8g())}wng(){this.Jlb(null);this.G8g()}}Object(m.a)(Fd,"UnsupportedObjectPresenter",
kd,[]);class ee{create(a,b){return new Fd(a,b)}}Object(m.a)(ee,"UnsupportedObjectPresenterFactory",null,[1460]);class Bf{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,y=!1,G=!1){this.Gx=a;this.e_i=b;this.DWl=c;this.EWl=f;this.myc=l;this.fpe=y;this.EZl=G}}Object(m.a)(Bf,"ParagraphContentRendererSettings",null,[]);var be=d(114);class af{constructor(a,b,c){this.WV=a;this.VZ=b;this.pUb=c}eab(a){return a}p9f(a,b,c){return c.Sja(a)}U6f(){return null}s$f(){return z.a.ik&&window.chrome?"none":null}wLf(){return!1}MMh(){return!1}EEf(){return""}HRh(){}oOf(){}TDh(a){return a===
C.a.underline||a===C.a.wpa||a===C.a.strikethrough||a===C.a.rt||a===C.a.e2}cTe(a,b){this.WV&&this.WV.isEnabled&&this.WV.createFontUrl(a);this.VZ&&this.VZ.isEnabled&&(b=aa.FontUtils.Xsb(b,a,!1,!1,!0),this.VZ.createFontUrl(a));return b}glh(a,b,c=null){if(!a)return b;b=this.cTe(a.fontName,b);this.pUb&&this.pUb.isEnabled&&(b=aa.FontUtils.Xsb(b,a.fontName,!1,!0),this.pUb.u1l(a)||this.pUb.D0l(c),this.pUb.N0l(a));return b}Z1c(){return!1}xbe(a,b,c,f){a=null;!c&&f||!b.w4||(b=b.fontColor,a=b===oc.a.auto?"WindowText":
oc.a.fH(b));return a}PDh(a,b,c,f,l){return!b&&!c&&!f&&!l}Vdg(){return 0}Qee(){return.8}tDh(a,b){return a||!b}XDh(){return!1}vDh(){return!1}V7f(){return new Yc.a}X7f(){return null}a8b(a){return be.Font.OEa(a.BL)}}Object(m.a)(af,"TextRenderingStrategy",null,[1444]);class Ue{get name(){return"Box4.ParagraphRenderElements"}Xb(a){a.register(Gd,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").na().oa(()=>new Gd(a.resolve("Box4.IParagraphContentRenderer")));a.register(ee,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").na();
a.register(af,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").na().oa(()=>new af(a.rb("Box4.IFontService"),a.rb("Box4.CustomFontService"),a.rb("Box4.IEmbeddedFontService")));a.register(Bf,"Box4.ParagraphContentRendererSettings").na().oa(()=>new Bf(Bb.ListReader.Gx,w.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),M.a.instance.ga(49),M.a.instance.ga(53),w.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),w.AFrameworkApplication.fa.ka(aa.FontUtils.iNf),w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));
a.register(Gb,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").na().oa(()=>new Gb(ra.InteractiveViewManager.instance,ka.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.rb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.rb("Box4.IFeatureHelper"),
aa.FontUtils.Rja,a.rb("Box4.IFontSlotProvider"),Object(H.a)(a.resolve("Box4.IEditStateEventManager"),a.resolve("Box4.IEditStateEventManager").Qmh,"raiseParagraphContentUpdatedEvent"),wb.a.language,a.rb("Box4.ITableOfContentRenderHelper"),dc.a.lHf))}init(){}dispose(){}static main(){n.a.instance.Ac(new Ue)}}Object(m.a)(Ue,"Box4ParagraphRenderElementsPackage",null,[2,3]);class qf{constructor(a,b,c,f,l,y,G){this.jqe=a;this.v$j=b;this.Z2c=c;this.L4j=f;this.L7j=l;this.Gx=y;this.i8j=b&&G||f}}Object(m.a)(qf,
"TableCellViewElementSettings",null,[]);class Xa{get name(){return"Box4.TableViewElements"}Xb(a){a.register(qf,"Box4.TableCellViewElementSettings").na().oa(()=>new qf(w.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),M.a.instance.ga(63),M.a.instance.ga(30),M.a.instance.ga(77),M.a.instance.ga(71),Bb.ListReader.Gx,w.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){n.a.instance.Ac(new Xa)}}Object(m.a)(Xa,"Box4TableViewElementsPackage",
null,[2,3]);var vb=d(1252),cc=d(396),wc=d(1276),Ad=d(240),Md=d(168),Sd=d(182),Le=d(1206);class fe{Be(a,b){return N.a.Be(a,b)}dw(a,b,c){N.a.dw(a,b,c)}Toa(a,b){N.a.Toa(a,b)}eLa(a){N.a.eLa(a)}GOc(a,b){N.a.GOc(a,b)}}Object(m.a)(fe,"CustomDataProxy",null,[1590]);var Vf=d(359),Cd=d(65),Sc=d(29);class jg{constructor(){this.Oa=new Wc.a}P0k(a){this.Oa.raiseEvent("OnBackspaceDelete",a)}}Object(m.a)(jg,"BackspaceDeleteEventSource",null,[1504,1505]);class mg extends Sys.EventArgs{constructor(a,b){super();this.nN=
a;this.mV=b}}mg.eventId="AEV.AVLD";Object(m.a)(mg,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,[]);class Pa extends Wc.a{constructor(){super()}OAf(a){this.addHandler(mg.eventId,a)}mbl(a){this.removeHandler(mg.eventId,a)}}Pa.qKi="AEV.CR";Object(m.a)(Pa,"ContentEditableViewEventSource",Wc.a,[]);var bb=d(51);class Fc{constructor(){this.XFc=null;this.Zh=0}Cqj(a){if(!this.XFc){var b=a.Lb?bb.a.createTextRange(a.node,0,a.Lb):bb.a.Oj(a.node,a.Lb);this.XFc=jb.HyperlinkReader.UC(b,!1);this.Zh=this.XFc.length-
1}for(;0<=this.Zh;)if(b=this.XFc[this.Zh],a.Lb<=b.Ra)--this.Zh;else return b.Lb<=a.Ra?null:b;return null}}Object(m.a)(Fc,"OverlappingHyperlinkHelper",null,[]);class yd{constructor(a,b,c,f,l){this.B2a=a;this.cE=b;this.vsa=c;this.Chd=f;this.Dhd=l}}Object(m.a)(yd,"PersistActiveSpanEditState",null,[]);class ge{constructor(a,b){this.Mh=a;this.mh=b;this.AFc=[];this.wI=this.vI=-1}WXe(){if(-1!==this.vI&&-1!==this.wI&&this.mh){this.AFc.reverse();const a=this.AFc.join("");let b,c;this.vI===this.wI?(b=bb.a.Oj(this.Mh,
this.vI),c=!!a.length):(b=bb.a.createTextRange(this.Mh,this.vI,this.wI),c=this.wI-this.vI!==a.length||this.ife(b)!==a);c&&this.mh.replaceTextRange(b,a,!0,void 0,C.a.typing)}this.wI=this.vI=-1;Array.clear(this.AFc)}uoi(a,b){this.vI=a.Ra;-1===this.wI&&(this.wI=a.Lb);0<b.length&&Array.add(this.AFc,b)}ife(a){return zb.ParagraphReader.text(a.node).substring(a.Ra,a.Lb)}}Object(m.a)(ge,"ReplacementTextRangeBuilder",null,[]);var rb=d(40);class gf{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.Jh=a;this.SD=
b;this.bra=c;this.fg=f;this.qd=l;this.Mn=y;this.ud=G;this.nn=ja;this.jd=za;this.xf=Va;this.Ma=hb;this.wDc=this.Ma.ka("TextLayoutServiceUseResponse");this.Kmf=this.Ma.ka("TextLayoutServiceEnableActiveContentSpanFix")}yOl(){let a,b;a=b=null;if(this.ud&&this.ud.qS){var c=this.nn.getSelection(this.jd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,uc.a.pga);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,M3f:a,
N3f:b}}}return{returnValue:!1,M3f:a,N3f:b}}Zpj(a){let b=0;for(let c of Ga.a.pab(a))"span"===c.nodeName.toLowerCase()&&b++;return b}mll(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,uc.a.pga)&&!Sys.UI.DomElement.containsCssClass(b,uc.a.X9);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of Ga.a.pab(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=
b.parentNode}return null}jhj(a,b,c,f,l){let y=Ga.a.Gv(c);const G=Ga.a.F$d(c,uc.a.pga);l=this.Zpj(G)+this.Jh.Ni.length-l.Et.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?y=Ga.a.Gv(f)+Ga.a.Gv(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?y=Ga.a.Gv(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(y=Ga.a.Gv(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(y=Ga.a.Gv(f)+Ga.a.Gv(f.nextSibling)):
2<l&&(y=b.innerText,ha.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));a.T2b||!b.innerText.endsWith(" ")||y.endsWith(" ")||(y+=b.innerText.substr(b.innerText.trimEnd().length));return y}HSk(a,b,c,f,l){const y=new yd(null,null,!0,null,null);let G=null,R=null;if(1===this.xf.mode||2===this.xf.mode)({M3f:G,N3f:R}=this.yOl());let ja=!1,za=!1;const Va=new Fc,hb=new ge(a,f),Cb=0<this.Jh.Ni.length&&this.Jh.Ni[0].T2b;let lc=null;G&&this.Ma.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&
(lc=this.mll(G));for(let yc=this.Jh.Ni.length-1;0<=yc;yc--){const ec=this.Jh.Ni[yc],jc=ec.NF;let xd=!1;if(this.Kmf&&this.wDc&&R&&!Ga.a.C5b(jc)){var ic=!1;Cb&&yc===this.Jh.Ni.length-1&&!Ga.a.F$d(G,uc.a.$N)?xd=ic=!0:1===this.Jh.Ni.length&&(ic=!0);ic&&(jc.innerText=this.jhj(ec,jc,G,R,c),y.vsa=!1)}y.cE=Ga.a.Gv(jc);this.SD.V7&&this.o1i(y.cE)&&(y.cE=na.a.substr(y.cE,0,y.cE.length-1));ic=this.Tgj(a,yc);this.jBk(a,b,yc,y);za=!!y.B2a||za;lc===jc&&(y.Dhd=jc.innerText+Ga.a.Gv(G),G.nodeValue="",y.vsa=!1,ha.ULS.sendTraceTag(541172698,
323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));y.Chd||(y.Chd=this.Y7i(a,ic,Va));const Xd=!!l&&l.CKi(ic);this.tRl(a,b,jc,yc,y,xd);Xd&&0<y.cE.length?(hb.WXe(),this.replaceTextRange(f,y,"",ic),this.Poi(l,Xd,y,ic)):this.IHi(ec,y.cE,ic,hb);ja=jc===R||ja}hb.WXe();this.pTl(a,y);G&&Ga.a.Gv(G)&&!ja&&!za&&(this.qd.Yb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),gf.Fof||(ha.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),
gf.Fof=!0));return y.vsa}IHi(a,b,c,f){if(c.contextId!==rb.a.Mf&&!a.T2b&&0<=a.Bld){let l=a.Bld,y=a.wPe;a=l!==y?bb.a.createTextRange(c.node,l,y):bb.a.Oj(c.node,l);b=b.substring(l-c.Ra,b.length-(c.Lb-y))}else a=c;a.Lb-a.Ra!==b.length||b!==this.ife(a)?f.uoi(a,b):f.WXe()}o1i(a){return a.charAt(a.length-1)===zc.LJb||z.a.Io&&a.charCodeAt(a.length-1)===B.a.ORb}ife(a){return zb.ParagraphReader.text(a.node).substring(a.Ra,a.Lb)}replaceTextRange(a,b,c,f){b.cE!==c&&a&&a.replaceTextRange(f,b.cE,!0,!0)}Poi(a,b,
c,f){b&&0<c.cE.length&&(b=bb.a.createTextRange(f.node,f.Ra,f.Lb+c.cE.length),a.Roi(b))}pTl(a,b){b.Chd&&(b=jb.HyperlinkReader.UC(b.Chd,!0),1===b.length&&this.Mn&&this.Mn.oul(a,b[0]))}tRl(a,b,c,f,l,y){const G=Ga.a.ncg(c);this.Jh.Ni[f].T2b&&G?y||this.UDj(b,f,l,G):l.B2a&&!Sys.UI.DomElement.containsCssClass(c,uc.a.JN)?(this.qd.Yb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.fg.bc++,l.cE+=l.B2a,l.B2a=null,Ga.a.Rz(this.Jh.Ni[f].NF,l.cE)):l.Dhd?(l.cE=l.Dhd,l.Dhd=null):this.wDc&&
this.Kmf&&(a=zb.ParagraphReader.text(a),b=this.Jh.Ni[f],c=b.Bld,y=b.wPe,f+1<this.Jh.Ni.length&&!Ga.a.C5b(this.Jh.Ni[f+1].NF)&&c===y&&0<c&&" "===a.charAt(c-1)&&(l.cE=l.cE.substr(0,c-1)+" "+l.cE.substr(c-1),l.vsa=!1),b.NF.innerText.endsWith(" ")||" "!==a.charAt(y)||b.H_a+b.IUa!==y+1||(l.cE+=" ",l.vsa=!1))}UDj(a,b,c,f){!b&&c.B2a?(this.qd.Yb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.fg.bb++,c.cE=c.B2a,Ga.a.Rz(this.Jh.Ni[b].NF,c.cE),this.ud.eG&&(a=a.lastChild,this.wDc&&Sys.UI.DomElement.containsCssClass(a,
uc.a.X9)&&(a=a.lastChild),a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.B2a=null):(this.qd.Yb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.fg.bd++,c.cE="",Ga.a.Rz(this.Jh.Ni[b].NF,c.cE))}Tgj(a,b){b=this.Jh.Ni[b];return b.H_a?bb.a.createTextRange(a,b.IUa,b.IUa+b.H_a):bb.a.Oj(a,b.IUa)}jBk(a,b,c,f){if(this.Jh.Ni[c].IUa+this.Jh.Ni[c].H_a===zb.ParagraphReader.textLength(a)&&(a=b.lastChild,this.wDc&&Sys.UI.DomElement.containsCssClass(a,uc.a.X9)&&(a=a.lastChild),c=Ga.a.Gv(a),c.length>
this.bra.d7d)){this.fg.ba++;this.SD.xlb(!1,b,this.Jh);f.B2a=na.a.substr(c,0,c.length-this.bra.d7d);b="";for(c=0;c<this.bra.d7d;c++)b+=da.a.aSc;a.innerText=b;f.vsa=!1}}Y7i(a,b,c){return(b=c.Cqj(b))&&gf.cXj(b)?bb.a.Oj(a,b.Ra):null}static cXj(a){return!!a.hyperlink&&a.hyperlink.url===zb.ParagraphReader.text(a.paragraph).substring(a.Ra,a.Lb)}}gf.Fof=!1;Object(m.a)(gf,"ActiveContentSpansPersistanceManager",null,[1503]);class Ab{constructor(a){this.kt=a}SEk(a){a&&this.kt.sZ()}}Object(m.a)(Ab,"AppFrameResizeEventProcessor",
null,[]);class fc{constructor(){this.w_b=new Oa.a}ya(a){this.w_b.add(a)}Kta(a){return this.w_b.count>a?this.w_b.ga(a):null}get JGa(){return this.w_b.count}isEmpty(){return!this.w_b.count}}Object(m.a)(fc,"AggregatedAutoCorrectActions",null,[1080]);var kc=d(238);class ud{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){this.XR=this.Mn=this.tCc=this.Ye=null;this.ov=a;this.GK=b;this.Ch=c;this.Qb=f;this.Jh=l;this.TZ=y;this.Ro=G;this.gj=R;this.pia=ja;this.kt=za;this.xf=Va;this.BS=hb;this.Mk=Cb;this.Uc=
lc;this.hd=ic;this.pp=yc}mT(a){this.Ye=a}get U0b(){return this.GK}get hyperlinkEditor(){return this.Mn||(this.Mn=Fb.a.instance.rb("Box4.IHyperlinkEditor"))}get tNj(){return this.tCc||(this.tCc=Fb.a.instance.rb("Box4.IHyperlinkActionFactory"))}zVj(a){if(this.ov.instance&&a&&2===this.Ch.mode)if(this.Ye.ht(!0),this.pia.value.Dw(),a.Dx)this.ov.instance.xVj(a),this.pia.value.Dw();else{var b=this.gj.b9(this.Ch.mode,this.Qb.Ui);a.qkg.innerText=a.qkg.innerText;this.BS.hsc();this.Ro.raiseEvent(kc.a.autoCorrect);
1===this.ov.instance.yVj(a)&&(this.xf.dba(!0),b>=a.TR&&(b+=a.G5c),this.gj.GT(b,this.Qb.$h),this.Ye.ht(!0),this.pia.value.Dw(),this.kt.sZ())}}DJe(a,b){if(!this.ov.instance||!this.tNj||!this.hyperlinkEditor)return null;this.Ye.ht(!0);a=this.TZ.Uta(b).Ua;b=a.Ra;if(0>=b||!this.Jh.Ni.length)return null;if(a=this.ov.instance.DJe(a.node,b))this.XR||(this.XR=new fc),this.XR.ya(a);return a}SYi(a,b){if(2===this.Ch.mode&&this.Jh.Ni.length){var c=this.gj.b9(this.Ch.mode,this.Qb.Ui);!this.XR&&this.ov.instance&&
(b=this.TZ.Uta(b).Ua,0>c||!this.Jh.Ni.length||(this.XR=new fc,this.XR=this.ov.instance.wQf(b.node,c,c-this.Jh.Ni[0].HLc,this.Jh.Ni[0].NF,!this.Jh.Ni[0].HLc,a),this.XR.JGa||(this.XR=null)))}}xSk(){if(2===this.Ch.mode){if(0<this.XR.JGa){this.Ye.ht(!0);for(var a=0;a<this.XR.JGa;a++)this.XR.Kta(a).uSh();for(a=0;a<this.XR.JGa;a++)this.zVj(this.XR.Kta(a))}this.XR=null}}}Object(m.a)(ud,"AutocorrectActionExecutor",null,[]);var zd=d(321);class Td{constructor(a,b,c,f,l,y,G,R,ja,za){this.Pbi=y;this.TZ=a;this.oj=
b;this.XD=c;this.rf=f;this.PK=l;this.zcf=G;this.hd=R;this.VD=ja;this.zAa=!!za;this.ov=za}KOl(a,b,c,f,l,y,G){if(!f)return!1;f=this.TZ.Uta(l);if(!f||!this.rf.Ex(f)||!f.Ua.Rk)return!1;l=f.Ua;if(this.b4j(l)||this.D1j(a,l)||this.Fcb(l))return!1;if(Sc.App.Pri){if(this.a4j(y))return!1}else if(this.$3j(y))return!1;return this.PK&&this.PK.gBb(f)||!this.Lzi(a,this.oj,G,Ga.a.Gv(c),b)||this.zAa&&!a&&this.ov.instance&&this.ov.instance.JLj()?!1:!0}a4j(a){if(this.zcf&&a&&Sys.UI.DomElement.containsCssClass(a,uc.a.pga)){const b=
Ga.a.Rda(a,uc.a.X9);b&&(a=b)}return Ga.a.Rda(a,Td.s8g)?!0:!1}$3j(a){if(this.zcf&&a&&Sys.UI.DomElement.containsCssClass(a,uc.a.pga)){const b=Ga.a.Rda(a,uc.a.X9);b&&(a=b)}return Ga.a.Rda(a,zd.a.tdb)||Ga.a.Rda(a,Td.s8g)?!0:!1}Fcb(a){return this.VD.Fcb(a).returnValue}b4j(a){return this.oj&&(!this.Pbi.G1b(a.node)||M.a.instance.ga(14)&&this.XD.vgh(a.node))?!0:!1}D1j(a,b){return M.a.instance.ga(14)&&this.XD.n2j(b,!a)}Lzi(a,b,c,f,l){if(!f||""===f)return!1;var y=this.hd.gg&&this.hd.nz;y=a&&!y?0:1;!a&&1<c&&
na.a.Hx(f,c-1)?y=2:c<f.length&&na.a.Hx(f,c)&&(y=1);if(a){if(a=c+y,a>=f.length-2||!this.Mzi(c,f,y))return!1}else{a=c-y;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&na.a.yz(f.charCodeAt(0))&&(f.length===c||na.a.yz(f.charCodeAt(c))))return!1}b=T.a.eFa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,da.a.jTi)||Sys.UI.DomElement.containsCssClass(b,uc.a.$N)||Sys.UI.DomElement.containsCssClass(b,uc.a.JN)||Sys.UI.DomElement.containsCssClass(b,da.a.xW)?!1:!0}Mzi(a,b,c){return na.a.yz(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&na.a.yz(b.charCodeAt(0)))?!1:!0}}Td.s8g="NoteTagContainer";Object(m.a)(Td,"BackspaceInBrowserHandler",null,[]);var Me=d(1263),tf=d(227);class re{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(m.a)(re,"UnroundedRectangle",null,[]);var lh=d(1102),ze=d(64),Je=d(148);class Wh{constructor(a,b,c,f,l,y,G,R,ja){this.Eh=null;this.Qga=!1;this.nca=a;this.jd=b;this.ZZ=c;this.W2=f;this.ud=l;this.Pf=y;this.xf=G;this.Qb=R;this.dQ=ja}a1b(a){this.Eh=a}sZ(){if(2===
this.xf.mode&&this.Qb.Eg){var a=this.Qb.QW,b=this.Qb.$h;if(a&&b){if(!this.jd.Cg&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),w.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){ha.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.Eh.Na);return}this.jd.Cg.OLe(a);b=this.jd.Cg.Lu;var c=this.E8f(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;
a=c.width;c=c.height;0>a&&(a=0);var l=Me.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.cEh()&&(f=this.jd.Gm(),this.e$j()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.nca.instance.MTl(b.parentNode,this.Qb.tda,!!this.Eh&&this.Eh.lm&&this.Eh.vxb)}}}}cEh(){return this.ud.eG&&!this.ud.Yi&&M.a.instance.ga(30)}MZj(a){return Ga.a.TVa(a)}e$j(){return Je.c(this.Eh.Ag)}mi(a){return Cd.a.mi(a)}jJh(a){var b=
ze.a.instance.Pa.nb;if(1===this.xf.mode){var c=(b.Cf?b.jf:b.Ua).node;b=c.qc(this.Pf.Rd.Na);a=c.qc(a);if(b&&a){this.jd.Cg.OLe(b);a=this.jd.Cg.Lu;var f=this.E8f(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.ud.elb)this.W2.Qjg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}E8f(a,b){if(!this.MZj(a))return null;var c=this.mi(a),f=this.mi(b);
let l=c.x-f.x;f=c.y-f.y;var y=Me.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{y&&y.dispose()}b=c.width;c=c.height;this.ZZ&&this.ZZ.instance&&this.ZZ.instance.frg(a)&&(y=this.ZZ.instance.U3,b/=y,c/=y);if(this.dQ.TBb(a)){var G=tf.a.wt(a);G&&(y=parseFloat(G.width),G=parseFloat(G.height),isNaN(y)||isNaN(G)||(b=y,c=G))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.ud.VVa||this.ud.Io)b+=.001,l+=.001,f+=.001;c+=1.001;return new re(new lh.a(l,f),b,c)}}Object(m.a)(Wh,"BoundsSynchronizer",
null,[1502]);var Kg=d(572),pd=d(82);class Nc{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.M5h=new Kg.a(RegExp("\r\n","g"),"\n");this.kId=null;this.cKd=0;this.ONd=!1;this.GCc=!0;this.qd=b;this.fg=c;this.ODc=a;this.jd=f;this.kp=l;this.ud=y;this.Pf=G;this.ae=R;this.oj=ja;this.nn=za;this.cPd=Va;this.Lra=Cb}get upg(){null==this.kId&&(this.kId=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.kId}get FWa(){return this.cKd}get G3k(){return this.ONd}get BUj(){return this.GCc}hVc(a,
b){var c=this.jd.Vta();if(1===a||0===a)return 0;if(this.ud.qS){var f=this.LEa();if(f){this.ONd=!this.B3c(f);c=this.nn.kYc(f);var l=this.nn.Ddg(f),y=l;w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.upg&&this.ud.fl&&(f=this.nn.I8f(f),l!==f&&(y=f));return this.kp.hde(c,b,y,this.fg,this.qd,this.oj)}ha.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.ud.bG)try{return l=c.selection.createRange(),
y=this.jd.Gm().innerText,b=0,""!==y&&(b=Math.abs(this.nn.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.nn.moveEnd(l.range,-1E5)),this.ONd=b!==f),y=this.M5h.qKa(y),b>=y.length&&(b=y.length-1),b}catch(G){this.qd.Yb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.fg.bg++,ha.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",G.message,G.toString())}else ha.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.fg.bh++;return 0}B3c(a){return Cd.a.B3c(a)}LEa(){return Cd.a.LEa(this.jd.contentWindow)}Ryl(a,b,c,f,l){if(!w.AFrameworkApplication.fa||!w.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.Et.length-1||Sys.UI.DomElement.containsCssClass(b.Et[a+1],uc.a.$N))return!1;a=b.Et[a];b=Ga.a.F$d(a,uc.a.X9);if(!b)return!1;b=Ga.a.pab(b).toArray();return b[b.length-1]!==a?!1:!0}GT(a,b){var c=this.jd.contentWindow;this.GCc=!0;this.cKd=a;try{if(this.ud.qS){const y=b.Et;
let G;var f=0;const R=this.nn.getSelection(c);if(R)for(G=0;G<b.Et.length;G++){const ja=b.Et;ha.ULS.shipAssertTag(18437200,315,y===ja);let za=ja[G],Va=this.kp.gJ(za,this.fg,this.qd,this.oj);var l=a<=Va+f;const hb=Sys.UI.DomElement.containsCssClass(za,uc.a.JN),Cb=Sys.UI.DomElement.containsCssClass(za,da.a.xW),lc=this.Ryl(G,b,a,f,Va);if(l&&!hb&&!Cb&&!lc){b=G+1;if(a===Va+f&&b<ja.length){const ic=ja[b];!this.kp.gJ(ic,this.fg,this.qd,this.oj)&&Ga.a.C5b(ic)&&(za=ic,f=a)}a-=f;this.ODc.value.J2b(za,c);for(c=
za;c.firstChild;)c=c.firstChild;this.uXj(R,c,a)||(c=this.M2i(c,this.jd.Vta()),this.upg&&this.ud.fl?2!==this.Pf.editingView.Xvb&&this.lZf(c,a,R):this.lZf(c,a,R));break}f+=Va}}else this.ud.bG&&(f=this.cPd.create(this.Pf.Rd),l=this.nn.createRange(this.jd.Gm()),this.nn.collapse(l,!0),this.nn.moveStart(l,a),l.select(),f.dispose())}catch(y){ha.ULS.shipAssertTag(4203852,315,!1)}}M2i(a,b){"SPAN"===a.nodeName&&(b=b.Il.createTextNode(""),a.appendChild(b),a=b);return a}lZf(a,b,c){if(this.kp.Upg(a)){this.nn.removeAllRanges(c);
var f=this.nn.createRange(a.ownerDocument);this.nn.mOb(f,!0,a,b);this.nn.mOb(f,!1,a,b);try{this.nn.addRange(c,f)}catch(l){this.fg.bl++,this.qd.Yb("PossibleNoIp",{["Reason"]:"AddRangeException"}),ha.ULS.shipAssertTag(1708946,315,!1)}this.nn.collapse(f,!0)}else ha.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.cKd=this.hVc(a,b)}mouseDown(){return this.GCc=!1}bK(){this.GCc=!0;return!1}b9(a,b){this.Lra&&this.Lra.AXl(this.FWa,this.hVc(a,
b));return this.FWa}uXj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,y=a.focusOffset;return a.isCollapsed&&l&&f===b&&y===c}eUf(a,b){const c=new pd.a(0,1,0,()=>{b.DWa(a.mode)&&this.updateCaretPosition(a.mode,b.Ui)},28);this.ae.Hb(c)}}Object(m.a)(Nc,"CaretPositionManager",null,[1501]);var le=d(268);class Ye{constructor(){this.QI=le.a.instance.cae()}}Object(m.a)(Ye,"CevUsageDataTracker",null,[]);class Zc{constructor(a,b){this.pAc=null;this.Via=0;this.Eg=this.QW=null;this.tda=!1;this.dCa=a;this.Pf=
b}init(a){this.Via=a}get NLj(){return!!this.Eg&&!!this.Eg.rg(this.Via)}get nSa(){ha.ULS.shipAssertTag(18437208,315,!!this.Eg);return this.$h?this.$h.htmlElement:null}get Ui(){return this.$h?this.$h.Ui:null}get $h(){return this.pAc}set $h(a){this.pAc=a;a=null;this.dCa.instance&&(a=this.dCa.instance.kNh());this.pAc&&a&&a.Q2l(this.pAc.xgh)}DWa(a){return 1!==a||ze.a.instance.Pa.Dea?this.Eg&&this.$h&&this.QW?(a=this.Pf.Rd)&&zb.ParagraphReader.fe(this.Eg)&&this.$h===this.Eg.qc(this.Via)&&this.QW===this.Eg.qc(a.Na)?
!0:!1:!1:!0}}Object(m.a)(Zc,"CevViewContentManager",null,[1500]);var Jf=d(1270),pg=d(385);class gd{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){this.Ye=null;this.LK=a;this.iRd=b;this.qd=c;this.HHd=f;this.Lra=l;this.Kia=y;this.Zk=G;this.Ch=R;this.ar=ja;this.xf=za;this.UOa=Va;this.Vba=hb;this.zC=Cb;this.dW=lc;this.Trb=ic}mT(a){this.Ye=a}w0d(a,b,c){if(this.UOa.hPj||this.LK.bac||!b)return!1;if(this.iRd.FCh)return!0;b=this.qd.eq(C.a.typing);b.properties.$(Jf.a.source,"Composition");a=this.nHi(a,c);
b.end();return a}nHi(a,b){this.HHd.correctBadImeState()&&this.Lra.bsc(C.a.UPl);this.Kia.fixupAfterMagnifierDrag();if(this.dW.Cld(a))return!1;this.Zk.Jse=(new Date).getTime();if(1===this.Ch.mode){let c;({v4:b,DPb:c}=this.dW.nNh(a,b));if(b)return c}this.ar.isComposing=!0;this.Trb||this.xf.dba(!0);a.eventName===pa.a.x0d&&this.Vba.raiseEvent(pg.a.wOf,a);this.zC.MQa(a);return!1}V2b(a,b,c){this.Trb&&this.Ye&&this.Ye.ht(!0,!0);return this.w0d(a,b,c)}U2b(a,b,c){this.w0d(a,b,c);return this.ar.isComposing=
!1}}Object(m.a)(gd,"CompositionEventProcessor",null,[]);class bd{constructor(a,b,c){this.hId=!1;this.Vba=a;this.Ro=b;this.I7=c}get isComposing(){return this.hId}set isComposing(a){(this.hId=a)?(this.Vba.raiseEvent(pg.a.oHi),this.Ro.raiseEvent(kc.a.bPj)):(this.Vba.raiseEvent(pg.a.lHi),this.Ro.raiseEvent(kc.a.$Oj))}get sGa(){return!this.isComposing&&!this.I7.hlg}}Object(m.a)(bd,"CompositionStateManager",null,[]);var Ne=d(141),rf=d(92);class Fh{constructor(a,b,c){this.J2h=w.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.nCa=this.oFd=this.FSd=this.XAa=this.EEd=null;this.Dsb=a;this.qI=b;this.vqa=c;this.render();this.vqa.Shd&&this.qI.MI(Object(H.a)(this,this.Bhd,"modeSwitched"))}Bhd(){this.vqa.EDh&&this.ltd(!0);this.sZf()}get Lu(){return this.FSd}get contentWindow(){return Cd.a.brj(this.Dsb.ownerDocument)}get contentDocument(){return this.Dsb.ownerDocument}get sAa(){return this.Dsb}get ho(){return this.oFd}get HTh(){return this.nCa}get isValid(){return!0}initialize(a,b){this.XAa=a;this.XAa.CXd=Object(H.a)(this,
this.onBlur,"onBlur");b()}Tth(){this.Lu.style.left="0px";this.Lu.style.top="0px"}L1i(){this.XAa&&this.XAa.C2i(this,this.qI)}Roa(){}vyd(){t.FocusManager.Zq(this.contentWindow)}$Mh(){t.FocusManager.APl(this.ho)}get Ulb(){return!Cd.a.NVj(this.ho)}set Ulb(a){}e0e(a,b,c){this.ho.setAttribute(Ne.a.fr,a);this.EEd&&(this.EEd.innerText=b);this.otc(c)}otc(a){a&&this.ho.setAttribute(Ne.a.hf,a)}ltd(a){if(z.a.Yj||a)a=!this.vqa.Lne&&a,this.ho.setAttribute("contenteditable",a?"true":"false"),this.vqa.EDh?(Sys.UI.DomElement.addCssClass(this.ho,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.ho,L.AppFrame.DXf),Sys.UI.DomElement.addCssClass(this.ho,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.ho,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.ho,L.AppFrame.DXf),Sys.UI.DomElement.removeCssClass(this.ho,"EditingSurfaceBody"))}dispose(){this.WQl();this.Lu&&(this.Lu.parentNode&&this.Lu.parentNode.removeChild(this.Lu),this.oFd=this.FSd=null)}render(){const a=String.format("{0}_EditingElement",this.Dsb.id),b=String.format("{0}_WrappingDiv",
a);this.FSd=document.createElement("div");this.Lu.id=b;this.Lu.style.height="0px";this.Lu.style.width="0px";this.Lu.style.display="none";Sc.App.instance.U1c&&Sys.UI.DomElement.addCssClass(this.Lu,"NoPointer");this.oFd=document.createElement("div");this.ho.id=a;this.ho.setAttribute("contenteditable",!this.vqa.Lne);this.ho.setAttribute("spellcheck","false");z.a.Ila&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.eol();this.sZf();rf.c(this.ho,!0);rf.c(this.Lu,!0);this.nCa=document.createElement("div");
this.Lu.appendChild(this.ho);this.Dsb.appendChild(this.Lu)}sZf(){if(this.ho){const a=String.format("{0}_WACEditing_DescribedByElement",this.Dsb.id),b=this.vqa.Sci;this.vqa.Lne?this.ho.setAttribute("tabindex","0"):this.ho.removeAttribute("tabindex");if(!this.J2h){const c=M.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Ne.a.bfj();this.EEd=Ne.a.lDf(this.Lu,this.ho,a,c);this.e0e(b,c,null)}}}eol(){z.a.Yj?Sys.UI.DomElement.addCssClass(this.ho,"InternetExplorer"):
z.a.mg?Sys.UI.DomElement.addCssClass(this.ho,"FireFox"):z.a.kva&&Sys.UI.DomElement.addCssClass(this.ho,"Safari");z.a.Yi?Sys.UI.DomElement.addCssClass(this.ho,"iPad"):Sys.UI.DomElement.addCssClass(this.ho,"usehover")}WQl(){this.XAa&&(this.XAa.VQl(this,this.qI),this.XAa=null)}onBlur(a){this.XAa.izg(a);this.XAa.AGf(a)}yAk(){this.Lu.style.width="0px";this.Lu.style.height="0px"}OLe(a){a=a.htmlElement;this.Lu.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.Lu,a)}tOl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);Ga.a.bDa(a);a.appendChild(b);break}}}}Object(m.a)(Fh,"ContentEditableDiv",null,[1507,108]);class Ae{create(a,b,c){return new Fh(a,b,c)}}Object(m.a)(Ae,"ContentEditableDomFactory",null,[1499]);var Kf=d(75);class Mf{constructor(a,b){this.ud=a;Mf.Ma=b}R1c(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}m0i(a,
b){a=Ga.a.Gv(a);const c=na.a.FGa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(na.a.I9(b)||na.a.qbc(b))?!0:!1}Wae(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Yb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return zc.dlg;if("BR"===a.tagName)return zc.LGf;if(this.Xqg(a)&&(w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),Mf.Ma.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.Wae(a.childNodes[l],b,c);return f}teg(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(y){return ha.ULS.sendTraceTag(51463192,324,15,y.message),c.Yb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(Mf.N2c(a))return this.snj(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.Xqg(a)&&(w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
Mf.Ma.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.R1c(a)&&(l+=zc.ZQc+zc.g5d);for(let y=0;y<a.childNodes.length;y++){const G=this.teg(a.childNodes[y],b,c,f);if(0<=G)l+=G;else return a.innerText.length}return l}Xqg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}f8j(a){return Sys.UI.DomElement.containsCssClass(a,
uc.a.YHl)}snj(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):Kf.AParagraphNode.L_.length}gJ(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Yb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.teg(a,b,c,f)}S6f(a,b,c,f,l){let y=0;const G=a.Et;for(let R=0;R<G.length;R++){a=G[R];const ja=this.gJ(a,f,c,l);if(b<y+ja)return b-=y,c=a.innerText,b>=c.length?0:na.a.charCodeAt(c,
b);y+=ja}f.bt++;return 0}hde(a,b,c,f,l,y){if(void 0===a||null===a)return l.Yb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,ha.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return ha.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let G=0;if(3===a.nodeType)G=c;else for(var R=0;R<c;R++)G+=this.gJ(a.childNodes[R],f,l,y);for(;a!==b;){R=a;a=a.parentNode;
if(!a){ha.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Yb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(w.AFrameworkApplication.fa&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),w.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.R1c(R)&&(G+=zc.ZQc);let ja=0;for(;ja<a.childNodes.length&&a.childNodes[ja]!==R;)G+=
this.gJ(a.childNodes[ja],f,l,y),ja++;if(ja===a.childNodes.length)if(3===R.nodeType)G=c;else return l.Yb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,ha.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return G}Upg(a){return Ga.a.C5b(a)}static get instance(){Mf.La||(Mf.La=new Mf(wc.a.instance,w.AFrameworkApplication.fa));return Mf.La}static N2c(a){return Sys.UI.DomElement.containsCssClass(a,uc.a.Nyk)||
Sys.UI.DomElement.containsCssClass(a,uc.a.d3i)||Sys.UI.DomElement.containsCssClass(a,uc.a.N_i)}}Mf.La=null;Mf.Ma=null;Object(m.a)(Mf,"ContentEditableViewDomUtils",null,[1482]);class vf{constructor(a,b){this.tHd=null;this.jd=a;this.Zk=b}bzd(){return 1<this.yjj()||this.Iig(this.tHd,this.C8f())}hsc(){const a=this.C8f();this.tHd=a?a.cloneNode(!0):null}yjj(){if(this.jd){const a=this.jd.Gm();if(a&&a.childNodes)return a.childNodes.length}return 0}C8f(){if(this.jd){const a=this.jd.Gm();if(a)return a.firstChild}return null}Iig(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.MKj(a,b)}catch(c){return ha.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}MKj(a,b){if(na.a.ug(a.nodeName)!==na.a.ug(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!z.a.mg||a.childNodes.length!==b.childNodes.length-1||"BR"!==na.a.pC(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!Mf.N2c(a.childNodes[c])||!Mf.N2c(b.childNodes[c]))&&this.Iig(a.childNodes[c],b.childNodes[c]))return!0;return!1}n9i(a,b){if(z.a.cD&&M.a.instance.ga(98)){b.Yb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=Ga.a.Rda(this.tHd,"EOP");const c=Ga.a.Rda(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(m.a)(vf,"ContentEditableHtmlStructureUtils",null,[]);class eg{constructor(){this.B5h=w.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return w.AFrameworkApplication.Qa.mode}get Shd(){return this.B5h}get EDh(){return this.Shd?!0:1!==w.AFrameworkApplication.Qa.mode||Sc.App.NBb&&w.AFrameworkApplication.iU}get Sci(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get Lne(){return this.Shd?1===w.AFrameworkApplication.Qa.mode||Sc.App.NBb&&w.AFrameworkApplication.iU:Sc.App.NBb&&w.AFrameworkApplication.iU?!(Sc.App.I1b||Sc.App.xcc):1===w.AFrameworkApplication.Qa.mode}get Vud(){return this.Shd?1===w.AFrameworkApplication.Qa.mode||Sc.App.NBb&&w.AFrameworkApplication.iU:Sc.App.NBb&&w.AFrameworkApplication.iU}}Object(m.a)(eg,
"ContentEditableModeHelper",null,[1438]);var zf=d(196),Nd=d(36);class Se{static mMi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return Nd.c(b)}}Object(m.a)(Se,"CommonActivityAggregationMethods",null,[]);var Qe=d(1053),Ei=d(1065),Ff=d(583),Jh=d(318),Wf=d(282),md=d(94);class Gf{constructor(){this.CXd=this.izg=this.AGf=this.wRc=this.W1=this.DKe=this.Thb=this.BNb=this.d1a=this.jVd=this.M8e=this.N8e=this.LC=this.G9a=this.IC=this.f5b=this.n3b=this.D3d=this.Hoc=this.l5b=this.$Da=this.aEa=
this.Smb=this.U2b=this.y0d=this.V2b=this.idb=this.CGa=this.nA=null;this.H7=this.$Bd=this.cFd=this.VOd=this.RHd=this.jRd=this.WDd=!1}C2i(a,b){if(!this.H7){this.H7=!0;var c=Ff.a.instance,f=b.DG,l=b.tS,y=b.Zmb,G=b.$y,R=Jh.a.instance,ja=b.jha,za=Wf.a.instance,Va=b.xxd,hb=b.uxd;z.a.Yi&&(Md.EventHandlerManager.instance.w8k(this.jVd),this.$Bd=!0);b.q8(this.W1);this.D7k(a.ho,f,l,G,y,za,ja,R,c,Va,hb)}}VQl(a,b){if(this.H7){var c=Ff.a.instance,f=b.DG,l=b.tS,y=b.Zmb,G=b.$y,R=Jh.a.instance,ja=b.jha,za=Wf.a.instance,
Va=b.xxd,hb=b.uxd;this.$Bd&&(Md.EventHandlerManager.instance.YQl(this.jVd),this.$Bd=!1);b.kLa(this.W1);this.SQl(a.ho,f,l,G,y,za,ja,R,c,Va,hb);this.H7=!1}}D7k(a,b,c,f,l,y,G,R,ja,za,Va){b.Np(a);c.Np(a);f.Np(a);l.Np(a);y.Np(a);md.a.addHandler(a,pa.a.paste,this.Hoc);md.a.addHandler(a,pa.a.cut,this.D3d);md.a.addHandler(a,pa.a.copy,this.n3b);!Gf.I5j&&z.a.mg&&(md.a.addHandler(a,pa.a.C5d,this.f5b),this.cFd=!0);md.a.addHandler(a,pa.a.blur,this.CXd);f.ub(pa.a.click,a,this.IC);2===Sc.App.mode?G.jK(a,this.wRc,
!0):G.jK(a,this.wRc);R.ub(a,this.LC);l.ub(pa.a.f7,a,this.N8e);l.ub(pa.a.q2,a,this.M8e);c.ub(pa.a.mouseDown,a,this.Thb,null);c.ub(pa.a.bK,a,this.DKe,null);b.ub(pa.a.Tl,a,this.CGa);b.ub(pa.a.Ay,a,this.idb);b.ub(pa.a.Df,a,this.nA);b.ub(pa.a.PCa,a,this.nA);f.ub(pa.a.doubleClick,a,this.G9a);md.a.addHandler(a,pa.a.scroll,this.d1a);if(z.a.r6e||z.a.mg)Va.ub(pa.a.vOf,a,this.V2b,this),Va.ub(pa.a.x0d,a,this.y0d,this),Va.ub(pa.a.v0d,a,this.U2b,this),this.WDd=!0;Sc.App.LXd&&z.a.JIh||z.a.Io?(za.ub(pa.a.input,a,
this.Smb,this),this.RHd=!0):z.a.v6e&&(za.ub(pa.a.K7e,a,this.Smb,this),this.jRd=!0);ja.ub(pa.a.drop,a,this.aEa);z.a.bva&&(ja.ub(pa.a.H9a,a,this.$Da),ja.ub(pa.a.iXf,a,this.l5b),this.VOd=!0);ja.ub(pa.a.ANb,a,this.BNb)}SQl(a,b,c,f,l,y,G,R,ja,za,Va){md.a.removeHandler(a,pa.a.paste,this.Hoc);md.a.removeHandler(a,pa.a.cut,this.D3d);md.a.removeHandler(a,pa.a.copy,this.n3b);this.cFd&&(md.a.removeHandler(a,pa.a.C5d,this.f5b),this.cFd=!1);md.a.removeHandler(a,pa.a.blur,this.CXd);f.Bb(pa.a.click,a,this.IC);G.oF(a,
this.wRc);R.Bb(a,this.LC);l.Bb(pa.a.f7,a,this.N8e);l.Bb(pa.a.q2,a,this.M8e);c.Bb(pa.a.mouseDown,a,this.Thb);c.Bb(pa.a.bK,a,this.DKe);b.kr(a);c.kr(a);f.kr(a);l.kr(a);y.kr(a);b.Bb(pa.a.Tl,a,this.CGa);b.Bb(pa.a.Ay,a,this.idb);b.Bb(pa.a.Df,a,this.nA);b.Bb(pa.a.PCa,a,this.nA);f.Bb(pa.a.doubleClick,a,this.G9a);md.a.removeHandler(a,pa.a.scroll,this.d1a);this.WDd&&(Va.Bb(pa.a.vOf,a,this.V2b),Va.Bb(pa.a.x0d,a,this.y0d),Va.Bb(pa.a.v0d,a,this.U2b),this.WDd=!1);this.jRd&&(za.Bb(pa.a.K7e,a,this.Smb),this.jRd=
!1);this.RHd&&(za.Bb(pa.a.input,a,this.Smb),this.RHd=!1);ja.Bb(pa.a.drop,a,this.aEa);this.VOd&&(ja.Bb(pa.a.H9a,a,this.$Da),ja.Bb(pa.a.iXf,a,this.l5b),this.VOd=!1);ja.Bb(pa.a.ANb,a,this.BNb)}static get I5j(){null==Gf.iJd&&(Gf.iJd=w.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return Gf.iJd}}Gf.iJd=null;Object(m.a)(Gf,"ContentEditableSurfaceEventHandlers",null,[]);var Hd=d(62),Ee=d(119),Ki=d(852),wf=d(137),ag=d(260);class Og extends Ei.a{constructor(a,b,c,f,l,y,G,R,
ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og,pi,Wj,wg,Tg){super(wg);this.VFc=null;this.KRc=this.vxb=this.A4b=this.mV=!1;this.Pf=a;this.Uc=b;this.$k=c;this.Xt=G.create(this);this.Wob=ch;this.jd=R;this.vqa=Tg;y.ya(C.a.nVf,rb.a.application,zf.ActionManager.Sg);y.ya(C.a.oVf,rb.a.application,zf.ActionManager.Sg);f.execute(Dh=>{Dh.nUi(C.a.typing,Jf.a.Ohh);Dh.g0e(C.a.typing,Jf.a.source,Se.mMi)});l&&l.execute(Dh=>{Dh.V1l(Object(H.a)(this,this.Sxa,"onZoomChanged"))});this.Ro=za;this.Dqa=
jc;this.tPd=Cb;this.LK=Va;this.cL=lc;this.cL.init(this.Na);this.W2=ic;this.xf=yc;this.Zk=hb;this.Qb=ja;this.Qb.init(this.Na);this.Ch=xd;this.T5a=Xd;this.kt=ec;this.MPa=Qd;this.sI=ig;this.ar=Ie;this.zC=ff;this.UOa=Pe;this.dW=bh;this.WYh=of;this.XYh=sg;this.s_h=Fg;this.VYh=og;this.kia=pi;this.UYh=Wj;this.kia.Rii(Object(H.a)(this,this.x$g,"onBindEditingDom"));this.kia.iji(Object(H.a)(this,this.Leh,"onUnbindEditingDom"));this.kia.Aii(Object(H.a)(this,this.Dlh,"pushViewElementValidationStates"));this.kia.zii(Object(H.a)(this,
this.zbh,"onInteractiveViewOnAfterLoadContent"));this.Jef=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&z.a.u1c;this.lhf=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&z.a.dU}get Nd(){return this.Nf.Nd}dispose(){this.kia.jbl(Object(H.a)(this,this.x$g,"onBindEditingDom"));this.kia.wbl(Object(H.a)(this,this.Leh,"onUnbindEditingDom"));this.kia.abl(Object(H.a)(this,this.Dlh,"pushViewElementValidationStates"));
this.kia.$al(Object(H.a)(this,this.zbh,"onInteractiveViewOnAfterLoadContent"));this.VYh.dispose();super.dispose()}Sxa(){this.Qga=!0}get ownerDocument(){const a=this.jd.Vta();return a?a.Il:null}get container(){return this.QSa}get Q0d(){return this.ho}createElement(a){a=this.ownerDocument.createElement(a);this.jd.Cg.HTh.appendChild(a);return a}vp(a){a=Xc.a.createElement(this.ownerDocument,a);this.jd.Cg.HTh.appendChild(a);return a}QCa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}AMe(){this.Ro.raiseEvent(kc.a.R_i);this.KRc=!0}get QSa(){return this.jd.Cg?this.jd.Cg.Lu:null}get ho(){return this.jd.Gm()}get jBb(){return!0}sEi(){this.W2.rNc()}get J3c(){return this.ar.sGa}get isComposing(){return this.ar.isComposing}$Wk(){this.Jef||this.lhf?this.MPa.Sjh(!0,""):(this.disable(!1,24),this.ltd(!0),z.a.Fx&&(this.QSa.style.overflow="hidden"),this.QSa.style.width="0px",this.QSa.style.height="0px",this.QSa.style.display="block",this.Ro.raiseEvent(kc.a.CRk),this.W2.rNc(),this.cL.zLa(this.Ch.mode,
this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz))}sJl(){this.Jef||this.lhf?this.MPa.ouh("none"):z.a.Fx&&this.QSa&&(this.QSa.style.overflow="none")}ht(a,b=!1){this.sI.ht(a,b)}sZ(){this.kt.sZ()}get lm(){return!0}pha(a,b){if(1===this.mode&&17!==a.Bi){const c=a.currentNode;if(!ze.a.instance.Pa.yH&&!c.HBb(ze.a.instance.Pa.hs)&&6!==a.role)return!1}return super.pha(a,b)}get ZF(){let a=super.ZF;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get Xvb(){const a=
w.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.J3c?2:this.root&&this.ownerDocument&&this.isActive&&!this.Dqa.R9?a||this.J3c?1:2:3}FY(a){return this.XYh.FY(a)}B1(a){return this.WYh.B1(a)}W2d(){return new Ki.a(this.Na)}FMe(a){!w.AFrameworkApplication.Yg&&0!==this.mode&&this.Nf&&this.Nf.Go&&(this.ufk(a),this.Uc.ine())}ufk(a){if(a){var b=a.vB;a=this.N5f(a.dv,!0);b=this.N5f(b,!1);ha.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}N5f(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",zb.ParagraphReader.fe(a)&&(c+="paraId : "+zb.ParagraphReader.t8b(a)+"; ",c+="hasImage : "+Ee.a(a,5)+";"),b&&(b=ub.GraphIterator.pb(a),b.kf(),c+="inTable : "+Hd.TableReader.Ks(b)+";"));return c}XNe(a){!w.AFrameworkApplication.Yg&&1===this.mode&&a&1&&this.Nf&&this.Nf.Go&&this.Uc.GOe()}ltd(a){this.jd.v1a(a)}odb(a,b,c){this.Wob.odb(a,b,c)}iSc(){this.UOa.iSc()}Osl(){this.tPd.s0f(ze.a.instance.Pa)}alb(){this.cL.alb(this.mode,this.Qb.Ui,this.Qb.Eg,
this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz)}zLa(){this.cL.zLa(this.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz)}get Eg(){return this.isActive?this.Qb.Eg:null}get mode(){return this.Ch.mode}get isActive(){return this.xf.isActive}get KVa(){return this.xf.k8b(this.Qb.Eg)}get dre(){return this.xf.r$f(this.Qb.Eg)}get Nf(){return this.Pf.Rd}get tPe(){return this.T5a.rPf}get kza(){return this.UOa.kza}set kza(a){this.UOa.kza=a}get Qga(){return this.kt.Qga}set Qga(a){this.kt.Qga=
a}get Foe(){return!0}get IXe(){return 2}get Vud(){const a=this.$k.value.isEditingAllowed||this.$k.value.xz;return this.vqa.Vud?a:!0}get nKa(){return this.MPa.nKa}get zvb(){return this.Zk}get YPl(){return this.zC}get sKi(){return this.Wob}get ZOj(){return this.UOa}get rPk(){return this.dW}Ndc(a){return ag.a.yxg(a,this)}zMb(a){return ag.a.ksh(a,this)}Wrc(a){return ag.a.ysh(a,this)}Rlc(a){return ag.a.V5g(a,this)}zub(a){return ag.a.wJf(a,this)}atc(a){return ag.a.Cxh(a,this)}Y6b(a){return ag.a.q3f(a,this)}R0b(a){return ag.a.MFf(a,
this)}IZj(){switch(this.mode){case 2:if(this.Qb.Eg)return this.JZj(this.Qb.Eg)}return!1}JZj(a){a=wf.a.pb(this.Na,a.node);return a.ir&&a.kf()?a.tSa.CY(510&~this.ZF):!0}x$g(a,b){this.qGf(b.Cg)}Leh(){this.jd.kQl()}DRj(a,b,c,f){a=this.UYh.create(a,b,this.vqa);b=new Gf;b.wRc=c;this.s_h.RTk(b);a.initialize(b,f);return a}qGf(a){this.jd.Dsi(a,this)}disable(a,b){this.Ch.cba(0,a,b)}u2a(){this.Ch.u2a()}suspend(){this.Dqa.suspend()}resume(){this.Dqa.resume()}Dlh(a,b){this.Pf.Rd===b.Nf&&(this.VFc=this.tNa,this.tNa=
new Qe.a(0))}HTk(){const a=this.VFc,b=this.tNa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.tNa=a;this.VFc=null}GMf(){this.VFc=null}v3e(a){return 1!==this.mode||a.Vy||this.Nf.Nb.Pa.yH?!1:!0}cse(a,b){return this.Nf.Nb&&!this.Nf.Nb.Pa.yH&&b?a.Vy!==b.zre:!0}zbh(a,b){this.Pf.Rd===b.Nf?this.HTk():this.Pf.Rd||this.GMf()}}Object(m.a)(Og,"ContentEditableView",Ei.a,[177,172,108,1498]);class Kh{constructor(a,b,c,f,l,y){this.qd=a;this.fg=b;this.oj=c;this.kp=f;this.Pf=
l;this.Er=y}dpg(a){return Sys.UI.DomElement.containsCssClass(a,uc.a.dPf)}}Object(m.a)(Kh,"ContentEditableViewContentControlHelper",null,[1437]);var Xg=d(408),Yd=d(129),ce=d(118),Rh=d(853);class ng{constructor(a,b,c,f,l){this.T2b=!1;this.wPe=this.Bld=-1;this.NF=a;this.ane=b;this.HLc=c;this.IUa=f;this.H_a=l}}Object(m.a)(ng,"ActiveContentSpan",null,[]);class Vi{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe){this.$ha=this.lUb=null;this.V9=!1;this.zvf=0;this.rEd=Qd;this.Pf=a;
this.qd=b;this.fg=c;this.oj=f;this.Uc=l;this.rf=y;this.PK=G;this.Ch=R;this.Qb=ja;this.$k=za;this.iqa=Va;this.xf=hb;this.ae=Cb;this.ud=lc;this.gj=ic;this.kp=yc;this.Jh=ec;this.LK=jc;this.jd=xd;this.SD=Xd;this.eB=Pe}get Nda(){return this.$ha||(this.$ha=Fb.a.instance.rb("Box4.IFormatPainter"))}Esi(a){this.lUb=a}get tHh(){return this.zvf}QTi(a,b,c){const f=this.Pf.Rd;if(!f)return!1;f.BNe();if(2!==this.Ch.mode)return this.qd.Yb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.fg.be++,
!1;if(this.oj&&b)return this.qd.Yb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.fg.bf++,!0;if(3!==a.kg&&a.OA===Sys.UI.MouseButton.rightButton&&this.ud.mg)return Sc.App.Mb.vba.W8i(a.nc.rawEvent),!0;if(!f)return!1;b=f.Kka(a);if(3===a.kg){var l=this.Uc.Pa.nb;if(this.rf.Ex(l)){var y=l.Ua.node.rg(f.Na);l=this.eB?this.eB.ZRa(l.Ua,!0):l.Ua.Ra;y=T.a.BW(l,y,!!l,!1,!1);y=new Sys.UI.Bounds(y.x-7,y.y,14,y.height);if(Xg.a.Gmd(b,y))return Sc.App.Mb.O6(b,3),!0}}if(!c)return!0;this.gj.eUf(this.Ch,
this.Qb);t.FocusManager.oN()&&(t.FocusManager.instance().wf(f.$I),this.LK.setFocus(this.Ch.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz));(c=rf.a(a.Bc))?(this.lUb.ht(!0),f.i7(a.clientPoint,c,c.gb,f,a.nc.rawEvent.shiftKey,a.D_,a.kg)):f.i7(b,null,null,f,a.shiftKey,a.D_,a.kg);this.Nda&&this.Nda.TL&&this.iqa.processAction(C.a.Dka,2);this.lUb.odb(a.shiftKey,b,a.kg);f.XMe(new Rh.a(a));this.ud.cD&&(a=new pd.a(0,1,0,()=>{this.xf.QLa(!0);this.fixupAfterCursor(5)},
27),this.ae.Hb(a));return!0}M6e(a,b=!1){if(2===this.Ch.mode&&this.Qb.$h){var c=this.jd.Cg.Lu;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.ud.Yqe){c=this.Uc.Pa.nb;var f=!!this.PK&&this.PK.Dbb();this.oj&&a?(this.qd.Yb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.fg.bm++):(this.Nol(b||f,this.Qb.$h.Et,this.Uc.Pa.nb.Ua),f&&this.PK.e7e(c))}}}Nol(a,b,c){let f=0,l=0;c=c.Ra;let y=!1;for(let G=0;G<b.length;G++){const R=b[G],ja=this.kp.gJ(R,this.fg,this.qd,
this.oj);if(Sys.UI.DomElement.containsCssClass(R,da.a.xW))f+=ja;else if(y||(this.zvf=f,y=!0),Sys.UI.DomElement.containsCssClass(R,uc.a.JN))c--,f+=ja,l++;else{if(c<=ja){a||this.gj.GT(f+c,this.Qb.$h);this.$sd(b,G,f,l,c);break}c-=ja;f+=ja;l+=ja}}}fixupAfterCursor(){if(2===this.Ch.mode){var a=this.gj.b9(this.Ch.mode,this.Qb.Ui),b=0,c=0,f=this.Qb.$h.Et,l;for(l=0;l<f.length;l++){const y=this.kp.gJ(f[l],this.fg,this.qd,this.oj);let G,R,ja;({G4:G,Ela:ja,TAb:R}=this.LBi(f,l));if(a<=y&&this.A9i(f,l,a,G,ja,
b,c,R))return;a-=y;b+=y;G?c++:R||(c+=y)}this.qd.Yb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.fg.bq++}}A9i(a,b,c,f,l,y,G,R){const ja=a[b],za=this.kp.gJ(ja,this.fg,this.qd,this.oj);if(f||this.oj&&l)if(l||!this.V9&&c!==za){if(this.fg.bo++,this.gj.GT(y,this.Qb.$h),c=this.kp.gJ(a[b-1],this.fg,this.qd,this.oj),this.$sd(a,b-1,y-c,G-c,c),l)return!0}else this.fg.bn++,this.gj.GT(y+za,this.Qb.$h),this.$sd(a,b+1,y+za,G+1,0);else if(!R)return na.a.Hx(Ga.a.Gv(ja),c)&&(this.fg.bp++,
this.gj.GT(y+c+(this.V9?1:-1),this.Qb.$h)),this.$sd(a,b,y,G,c),!0;return!1}LBi(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],uc.a.JN);f=Sys.UI.DomElement.containsCssClass(a[b],da.a.xW);a=Sys.UI.DomElement.containsCssClass(a[b],uc.a.$N);return{G4:c,Ela:a,TAb:f}}$sd(a,b,c,f,l){const y=this.Qb.QW,G=a[b];Sys.UI.DomElement.containsCssClass(G,uc.a.$N)&&(ha.ULS.shipAssertTag(4318915,315,!1),this.qd.Yb(Yd.a.t2,{["Reason"]:ce.a.$Zf}));Sys.UI.DomElement.containsCssClass(G,uc.a.JN)&&(ha.ULS.shipAssertTag(4318916,
315,!1),this.qd.Yb(Yd.a.t2,{["Reason"]:ce.a.uGf}));a=this.KPi(a,b,c,f,l,y);b=a.length!==this.Jh.Ni.length;for(c=0;!b&&c<this.Jh.Ni.length;)this.Jh.Ni[c].NF!==a[c].NF&&(b=!0),this.Jh.Ni[c].H_a!==a[c].H_a&&(b=!0),c++;b&&(this.lUb.KVa&&this.lUb.ht(!0),this.Jh.Ni=a)}KPi(a,b,c,f,l,y){const G=a[b];var R=this.kp.gJ(G,this.fg,this.qd,this.oj);const ja=[];let za=null;b<a.length-1&&l===R&&(za=a[b+1]);var Va=null;0<b&&!l&&(Va=a[b-1]);a=this.rEd.Be(G,da.a.GGa);a=y.Et[a];Array.add(ja,new ng(G,a,c,f,R-(this.SD.V7?
1:0)));!za||Sys.UI.DomElement.containsCssClass(za,uc.a.$N)||Sys.UI.DomElement.containsCssClass(za,uc.a.JN)?!Va||Sys.UI.DomElement.containsCssClass(Va,uc.a.$N)||Sys.UI.DomElement.containsCssClass(Va,uc.a.JN)||Sys.UI.DomElement.containsCssClass(Va,da.a.xW)||(a=this.rEd.Be(Va,da.a.GGa),a=y.Et[a],R=this.kp.gJ(Va,this.fg,this.qd,this.oj),Array.insert(ja,0,new ng(Va,a,c-R,f-R,R))):(a=this.rEd.Be(za,da.a.GGa),a=y.Et[a],Va=this.kp.gJ(za,this.fg,this.qd,this.oj),Array.add(ja,new ng(za,a,c+R,f+R,Va)));return ja}}
Object(m.a)(Vi,"ContentEditableViewCursorManager",null,[1497]);class $h{}Object(m.a)($h,"ContentEditableViewDebugLogger",null,[]);class fg{constructor(a,b,c,f,l,y,G){this.bra=a;this.zC=b;this.Jh=c;this.qBc=f;this.fg=l;this.Vba=y;this.Ch=G}dispose(){this.bra.tMf();this.zC.dispose();this.Jh.fMf();this.qBc.Jsd();le.a.instance.rek(this.fg);this.Vba.raiseEvent(pg.a.Mfk);this.Ch.dispose()}}Object(m.a)(fg,"ContentEditableViewDisposer",null,[]);class dk{constructor(){this.WQc=!0}odb(a,b,c){a&&(this.WQc=!1,
Sc.App.Mb.O6(b,c))}}Object(m.a)(dk,"ContentEditableViewFloatieHandler",null,[1495]);var xi=d(1147),yh=d(147);class Lg{constructor(a,b,c,f,l,y,G){this.unf=0;this.H2c=this.bac=this.Oie=this.Sie=!1;this.jd=a;this.Pf=b;this.PK=c;this.oj=f;this.yq=l;this.VCd=y;this.Pd=G}Zsi(){this.oj&&!this.bac&&100<(new Date).getTime()-this.unf&&(yh.GrippersManager.instance.y$b=!0,this.H2c=!1)}setFocus(a,b,c,f,l){const y=this.Pf.Rd;this.unf=(new Date).getTime();this.PK&&this.PK.Dbb()||(1===a?this.Ipl(l):this.oj&&!this.yq.Uie&&
Md.EventHandlerManager.instance.k_f!==pa.a.click||!this.jd.Cg.Ulb||(l=new xi.a(y),this.jd.Cg.vyd(),this.oj&&(this.bac=!0,this.jd.Gm().blur(),this.bac=!1),this.jd.Cg.$Mh(),c&&f&&""!==b.innerText&&b.focus(),this.VCd.M9&&(this.H2c=!0),l&&l.dispose(),this.VCd.Yj&&0!==a&&(this.jd.Cg.Ulb=!1)))}Ipl(a){if(!this.oj||a){a=null;z.a.Yj&&(a=new xi.a(this.Pf.Rd));this.jd.Cg.Ulb&&(this.jd.Cg.vyd(),this.jd.Cg.$Mh(),z.a.Yj&&(this.jd.Cg.Ulb=!1),this.VCd.M9&&this.yq.Uie&&(this.H2c=!0));var b=this.jd.Gm();this.jd.Cg.Ulb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}R1i(a){2!==a&&1!==a||this.jd.Cg.vyd()}epe(){const a=this.Pd.Ee;return!!a&&this.Pf.Rd.$I===a.name}}Object(m.a)(Lg,"ContentEditableViewFocusHelper",null,[1496]);class yi{constructor(a,b,c){this.K$b=a;this.wjb=b;this.vsa=c}}Object(m.a)(yi,"GraphUpdateState",null,[]);var Vd=d(53),lf=d(109);class Zj{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og){this.Ye=this.QTb=null;this.Mk=
Fg;this.Er=sg;this.Qha=a;this.Ch=b;this.qd=c;this.Uc=f;this.PK=l;this.rf=y;this.xf=G;this.VK=R;this.Qb=ja;this.Zk=za;this.SD=Va;this.Jh=hb;this.jd=Cb;this.MV=lc;this.BS=ic;this.Dqa=yc;this.TZ=ec;this.Kia=xd;this.gj=Xd;this.T5a=Qd;this.kt=Ie;this.fg=Pe;this.I7=ig;this.ae=ff;this.ud=bh;this.iia=ch;this.lWh=of;this.mh=jc;this.$z=og}mT(a){this.Ye=a}get $Yc(){const a=this.TZ.Uta(this.MV.V9);return a?a.Ua.Ra:0}get Eti(){return this.$Yc}ht(a,b=!1){ha.ULS.shipAssertTag(18437283,315,!!this.mh);if(this.Ye.KVa||
this.Ye.dre)if(this.Ye.YPl.typingProcess(),this.Ye.isActive&&2===this.Ch.mode&&(this.Ye.KVa||this.Ye.dre)){var c=this.qd.eq(C.a.ht);this.Qha.wG(()=>{this.jTl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}Upl(a,b=!1){const c=this.rf.Uz;this.Uc.setSelection(a,void 0,void 0,b);this.rf.Uz=c}jTl(a,b=!1){lf.c(36226527,306,100,"UpdateGraphInternalCalled");this.xf.Afl();if(this.Qb.$h){a=new yi(!1,a,!1);a.wjb&&this.Dqa.suspend();this.Kia.fixupAfterMagnifierDrag();var c=this.VK.fUa();c.set(this.Qb.Eg.node);
var f=this.Mk.ke(b?12:15,C.a.ht);f.gd=this.Zk.C3?C.a.OCa:C.a.typing;f.Xy(c);this.SD.Yxl(a.wjb,this.Ye.J3c,this.Jh)&&(this.fg.v++,this.SD.xlb(!1,this.Qb.Ui,this.Jh));var l=!!this.PK&&this.PK.Dbb(),y=l?ze.a.instance.Pa.nb:this.ADi();this.ISk(a);this.fUl();this.rerenderWhenNeeded(b,a,c);l||this.L9i(b,y);this.Jh.fMf();f.dispose();this.XHl(a);this.kt.Qga&&(this.kt.sZ(),this.kt.Qga=!1);a.wjb&&this.Dqa.resume();this.Zk.V1();lf.c(18437313,306,100,"UpdateGraphInternalExited")}else ha.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}XHl(a){a.K$b||this.MV.M6e(this.Zk.xea,a.vsa)}rerenderWhenNeeded(a,b,c){!b.K$b||this.Zk.bvg()||a||(this.Ch.cba(0,!0,5),b.wjb&&(this.Dqa.resume(),b.wjb=!1),this.Lac(c.currentNode))}ADi(){this.gj.updateCaretPosition(this.Ch.mode,this.Qb.Ui);this.T5a.oaf();this.BS.n9i(this.jd.Gm(),this.qd);return this.TZ.Uta(this.MV.V9)}L9i(a,b){const c=this.Er.textLength(b.Ua.node);b.Ua.Ra>c&&(b=Vd.SelectionFactory.Qg(b.Ua.node,c));this.Upl(b,a);
a=!!this.PK&&this.PK.gBb(b);this.Zk.bvg()&&!a&&this.gj.GT(this.gj.FWa,this.Qb.$h)}Lac(a){M.a.instance.ga(70)&&Sc.App.uS.Lac(a)}fUl(){if(M.a.instance.ga(2)){const a=rc.OutlineElementNavigator.AB(this.Ye.Eg);a&&Bb.ListReader.XVa(a)}}g4d(){if(this.Ye.KVa||this.Ye.dre)this.QTb?this.ae.U1(this.QTb,Zj.fUf):(this.QTb=new pd.a(0,1,Zj.fUf,Object(H.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.ae.Hb(this.QTb))}delayUpdateGraphCallback(){this.QTb=null;this.Qb.DWa(this.Ch.mode)&&
this.ht(!0)}xal(){let a;if(this.Zk.C3){var b=this.$Yc;a=this.Zk.MOc}else if(this.Zk.Wsa)b=this.$Yc,a=b+(this.Zk.rxd-Ga.a.Gv(this.Qb.nSa).length);else return;if(b===a)this.qd.Yb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{ha.ULS.shipAssertTag(18437315,315,b<=a);var c=this.Er.text(this.Ye.Eg),f="";this.Er.WTa(this.Ye.Eg,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=zc.LJb;this.oEi(this.Ye.Eg);b=bb.a.createTextRange(this.Ye.Eg,
b,a);this.mh.replaceTextRange(b,f,void 0,void 0,C.a.nXd)}}oEi(a){M.a.instance.ga(70)&&this.$z.oNc(a)}ISk(a){let b=!0;if(this.I7.hlg)this.I7.e1i();else{const c=1<this.jd.Gm().childNodes.length;a.K$b=this.BS.bzd();if(a.K$b||this.Zk.Wsa||this.Zk.C3){a.K$b&&this.fg.w++;c&&(this.qd.Yb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.fg.x++,b=!1);if(this.Zk.C3||this.Zk.Wsa)this.xal(),this.BS.hsc(),b=!1;a.wjb&&(this.qd.Yb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.fg.z++,this.Dqa.resume(),a.wjb=!1);this.Jh.zDi(this.Qb.$h)}}a.vsa=!0;b&&(a.vsa=this.lWh.HSk(this.Qb.Eg,this.Qb.Ui,this.Qb.$h,this.mh,this.iia.instance))}}Zj.fUf=250;Object(m.a)(Zj,"ContentEditableViewGraphUpdater",null,[]);var Cj=d(440),he=d(60);class ij{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg){this.Ye=null;this.ywg=0;this.Eof=!1;this.Oa=a;this.Ch=b;this.Qb=c;this.Pf=f;this.jd=l;this.Mha=y;this.kt=G;this.SD=ja;this.ud=za;this.fg=Va;this.Er=hb;
this.Jh=Cb;this.BS=lc;this.kRd=ic;this.bra=yc;this.LK=ec;this.T5a=jc;this.Uc=xd;this.oj=Xd;this.cL=Qd;this.$k=Ie;this.Zk=Pe;this.Ro=ig;this.VK=ff;this.pQa=bh;this.zca=ch;this.kd=of;this.p3h=sg}mT(a){this.Ye=a}EEk(a){this.Oa.raiseEvent(mg.eventId,new mg(a.nN,this.Ye.mV),this.Ye);if(1===this.Ch.mode)return this.FEk(a);if(0===this.Ch.mode||!this.PSl(a))return!1;this.SD.uMf();if(this.OSl())return!0;this.H9i();this.bra.FHh(this.Qb.$h);this.F9i();!this.Eof&&this.Qb.$h&&0<this.Qb.$h.Pwd&&(this.Eof=!0,w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));
this.kd&&this.kd.isFeatureEnabled(84)&&this.rsh(this.Qb.$h);this.T5a.oaf();this.p3h||this.zca.SLb(Object.assign(new Cj.a,{zuc:!0}));this.kd&&this.kd.isFeatureEnabled(84)||this.rsh(this.Qb.$h);return!0}rsh(a){a&&a.Pwd&&(this.pQa?this.pQa.c2l(a,!0):ha.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}PSl(a){if(!this.Qb.Eg)return!1;this.Qb.$h=this.Qb.Eg.qc(this.Ye.Na);this.Qb.$h||ha.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Qb.QW=this.Qb.Eg.qc(this.Pf.Rd.Na);
if(!this.Qb.QW)return!1;this.jd.Cg.OLe(this.Qb.QW);const b=this.jd.Gm(),c=this.Qb.nSa;(b?b.firstChild:null)!==c&&c&&(Ga.a.yv(b),b.appendChild(c));if(!a.nN&&!this.Ye.KRc){this.Ye.mV&&this.Mha.M6e(this.Zk.xea);this.Ye.mV=!1;if(this.kt.Qga||!a.eKa)this.kt.sZ(),this.kt.Qga=!1;return!1}this.Ye.KRc&&(this.Ye.KRc=!1,this.Ye.vxb=!0);return!0}F9i(){this.kt.sZ();if(this.Ye.vxb){this.LK.setFocus(this.Ch.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz);if(this.ud.mg){const a=
this.jd.Gm(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.fg.bv++,a.removeChild(b))}this.Ye.vxb=!1}this.Mha.M6e(this.Zk.xea)}H9i(){if(this.ud.mg){var a=this.jd.Gm();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.fg.bu++,a.removeChild(b))}this.ud.WPb||(a=this.VK.Lc(this.Qb.Eg),this.Er.isEmpty(a)&&!this.Er.Loe(a)&&this.SD.xlb(!0,this.Qb.Ui,this.Jh));this.kRd.value.J2b(this.jd.Gm(),this.jd.contentWindow);this.BS.hsc()}OSl(){var a=this.Qb.QW;const b=this.jd.Gm().style;if(this.Ye.vxb){if(!a)return!0;
a=this.Qb.$h.htmlElement;this.kt.cEh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Qb.tda=this.E3j();return!1}E3j(){return he.OutlineElementReader.Jm(rc.OutlineElementNavigator.AB(this.Qb.Eg.node))}wt(a){return tf.a.wt(a)}FEk(a){if(!this.Uc.Pa||!this.Uc.Pa.nb)return ha.ULS.sendTraceTag(19711041,324,15,"Attempt to validate selection with empty selection."),!1;if(!this.Ye.mV&&(!a.nN||Sc.App.Hne&&a.eKa))return this.kt.Qga&&(this.kt.jJh(this.Ye.Na),this.kt.Qga=
!1),!1;this.Ye.mV=!1;a=(new Date).getTime();const b=this.Uc.Qpa;!this.oj&&!b.fqe&&!b.Xre&&250<a-this.ywg?this.bUf(null):(this.Ro.raiseEvent(kc.a.NCk),b.jrl(Object(H.a)(this,this.bUf,"delayOnAfterValidateSelection")));return!0}bUf(){1===this.Ch.mode&&(this.Uc.Pa.Dea&&this.Qb.Eg&&(this.Qb.$h=this.Qb.Eg.qc(this.Ye.Na),this.Qb.$h||ha.ULS.sendTraceTag(18437327,324,15,"current editing view element is set to null!"),this.Qb.QW=this.Qb.Eg.qc(this.Pf.Rd.Na)),this.Uc.Pa.Dea&&this.jd.Gm().firstChild!==this.Qb.nSa&&
this.Qb.nSa&&(Ga.a.yv(this.jd.Gm()),this.jd.Gm().appendChild(this.Qb.nSa)),this.jd.Gm().firstChild&&(this.Uc.Pa.Dea?this.jd.Gm().style.direction=this.wt(this.jd.Gm().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.jd.Gm().firstChild,"Rtl")?this.jd.Gm().style.direction="rtl":this.jd.Gm().style.direction="ltr",this.Uc.Pa.Dea&&this.bra.FHh(this.Qb.$h),this.kt.jJh(this.Ye.Na),this.cL.alb(this.Ch.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz)),this.ywg=
(new Date).getTime(),this.Ro.raiseEvent(kc.a.U8i))}B1(a){const b=this.EEk(a);this.Ro.raiseEvent(!a.nN||Sc.App.Hne&&a.eKa?kc.a.uKc:kc.a.wgh);return b}}Object(m.a)(ij,"ContentEditableViewOnAfterValidateHandler",null,[]);class Rf{constructor(a,b,c,f,l){this.Ye=null;this.kt=a;this.ar=c;this.jd=f;this.Ro=l}mT(a){this.Ye=a}FY(a){const b=this.Ye.Xvb;let c=3===b;c||2!==b||(this.Ye.root.Aie(510),c=!0,this.kt.sZ());if(c)return a.cancel=!0,!1;this.Ro.Q0k(a);return!1}}Object(m.a)(Rf,"ContentEditableViewOnBeforeValidateHandler",
null,[]);class zh{constructor(a,b,c,f,l){this.V7=!1;this.uBa=null;this.Ro=a;this.qd=b;this.fg=c;this.jd=f;this.Rsf=l}uMf(){this.V7=!1}xlb(a,b,c){const f=this.jd.Vta();a&&(this.V7=Ga.a.Gv(b)!==da.a.aSc);if(a&&!this.V7){for(b=this.jd.Gm();b.firstChild;)b=b.firstChild,this.Rsf&&Sys.UI.DomElement.containsCssClass(b,uc.a.MMa)&&Sys.UI.DomElement.addCssClass(b,uc.a.APe);3!==b.nodeType?(this.uBa=f.Il.createTextNode(zc.LJb),b.appendChild(this.uBa)):(this.uBa=b,this.uBa.nodeValue=zc.LJb);this.V7=!0;this.Ro.Pmh(!0)}if(!a&&
this.V7){a=this.uBa;b=null;try{b=this.uBa.parentNode,b||""!==a.nodeValue||(this.uBa=null)}catch(l){this.fg.i++,this.uBa=null}this.uBa&&b!==f||(this.qd.Yb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.fg.j++,c.Ni.length&&(a=this.i2f(c.Ni[c.Ni.length-1].NF)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(zc.LJb))){if(this.Rsf)for(c=a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,uc.a.APe)){Sys.UI.DomElement.removeCssClass(c,uc.a.APe);
break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.V7=!1;this.Ro.Pmh(!1)}}Yxl(a,b,c){return!this.V7||a||(z.a.eG&&!z.a.ik||z.a.bG)&&!b?!1:c.vyf()}i2f(a){if(a.className===uc.a.$N)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.i2f(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&(b=a.nodeValue,b.endsWith(" ")||b.endsWith(zc.LJb)))return a;return null}}Object(m.a)(zh,"ContentEditableViewPaddingManager",null,[1494]);class Sh{constructor(a){this.l4d=
this.L7e=this.Wsa=this.C3=!1;this.t5c=this.rxd=this.MOc=-1;this.nId=!1;this.Jse=0;this.iqa=a}get xea(){return this.nId}set xea(a){a!==this.nId&&this.iqa.processAction(a?C.a.nVf:C.a.oVf,2);this.nId=a}bvg(){return this.L7e||this.Wsa||this.C3}V1(){this.l4d=this.L7e=this.Wsa=this.C3=!1;this.t5c=this.rxd=this.MOc=-1}}Object(m.a)(Sh,"ContentEditableViewTypingState",null,[]);class jj{constructor(a,b,c,f,l,y,G){this.gj=a;this.fg=b;this.qd=c;this.kp=f;this.xf=l;this.Qb=y;this.oj=G}Uta(a){if(!this.Qb.$h||1===
this.xf.mode&&!this.Dea())return null;const b=this.gj.b9(this.xf.mode,this.Qb.Ui);let c=b,f=0;const l=this.Qb.$h.Et;let y,G=!1;for(y=0;y<l.length;y++){var R=l[y];if(!this.kp.Upg(R)){G=!0;continue}const ja=this.kp.gJ(R,this.fg,this.qd,this.oj),za=Sys.UI.DomElement.containsCssClass(R,uc.a.JN);R=Sys.UI.DomElement.containsCssClass(R,da.a.xW);if(c<=ja)return za?c=a||c===ja?1:0:R&&(c=0),this.Qg(this.Qb.Eg,f,c);c-=ja;za?f++:R||(f+=ja)}return G?this.Qg(this.Qb.Eg,0,b):this.Qg(this.Qb.Eg,0,0)}Qg(a,b,c){return Vd.SelectionFactory.Qg(a,
b+c)}Dea(){return ze.a.instance.Pa.Dea}}Object(m.a)(jj,"CurrentEditSelectionProvider",null,[1493]);class Dj{constructor(a,b,c){this.uSb=[];this.cJc=null;this.qd=a;this.ZS=b;this.kRd=c}get Ni(){return this.uSb}set Ni(a){this.uSb=a}vyf(){return this.uSb.length?1<this.uSb.length||1<this.uSb[0].NF.innerText.length:!1}l3f(a,b,c){const f=N.a.Be(a,da.a.GGa),l=b?a.firstChild:a.lastChild;let y=null;b&&0<f?y=c.Et[f-1]:!b&&f<c.Et.length&&(y=c.Et[f+1]);if(y)for(this.qd.Yb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),
this.ZS.u++,a.removeChild(l),b?y.appendChild(l):y.insertBefore(l,y.firstChild),a=0;a<this.Ni.length;a++);}zDi(a){for(let b=0;b<this.Ni.length;b++){const c=this.Ni[b].NF;z.a.eG&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.l3f(c,!0,a):3===c.lastChild.nodeType&&this.l3f(c,!1,a));Ga.a.Rz(c,c.innerText)}}BCk(a){for(let b=0;b<this.Ni.length;b++)this.kRd.J2b(this.Ni[b].NF,a)}d$k(){for(let a=0;a<this.Ni.length;++a){const b=this.Ni[a].NF;if(Sys.UI.DomElement.containsCssClass(b,uc.a.MPc)||
Sys.UI.DomElement.containsCssClass(b,uc.a.KPc)||Sys.UI.DomElement.containsCssClass(b,uc.a.JPc)||Sys.UI.DomElement.containsCssClass(b,uc.a.LPc)){const c=this.Ni[a].H_a;c&&c!==b.innerText.length&&(b.className=uc.a.c4b)}}}iyk(a,b){for(let c=0;c<this.Ni.length;c++){const f=this.Ni[c],l=a<=f.IUa,y=f.IUa+f.H_a,G=y<=b;f.Bld=l?f.IUa:a;f.wPe=G?y:b;l&&G&&(f.T2b=!0)}}fMf(){Array.clear(this.Ni)}}Object(m.a)(Dj,"CurrentlyActiveContentSpans",null,[1492]);class Ah{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,
yc,ec,jc,xd){this.tEd=!1;this.rf=a;this.Uc=b;this.qd=c;this.xf=f;this.Ro=l;this.Pf=y;this.Jh=G;this.Qb=R;this.ud=ja;this.cL=za;this.$k=Va;this.GAa=hb;this.$Sb=Cb;this.NZh=lc;this.lk=ic;this.jd=yc;this.Ca=jc;this.hd=xd;this.F2h=ec.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.SVb=ec.ka("PasteKeepSourceFontSizeFixIsEnabled");this.a3h=(this.X7h=ec.ka("ProtectInClient"))||ec.ka("ProtectedFile");this.P2h=ec.ka("EnableExtractForProtectedFile");this.AVb=ec?ec.ka("ImageDataURLSkippedForSafari12IsEnabled"):
!1;this.fWb=ec?ec.ka("TextLayoutServiceUseResponse"):!1;this.ytf=this.xtf=!1}get z_(){return this.GAa.instance}get adb(){return this.hd.gg&&this.hd.nz}Igg(a,b,c,f){this.RWk(a,b,c,f)}RWk(a,b,c,f){this.a3h&&!this.P2h?a.preventDefault():!b||this.$k.value.isEditingAllowed||this.$k.value.xz&&this.adb?1!==this.xf.mode||this.tEd||!c||f||(this.z_?b&&!this.rf.K1c(this.Uc.ak)?(ha.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.E3d}),this.$Sb.show(),a.preventDefault()):
(this.Uc.Qpa.O9d(),this.tEd=!0,b&&this.Ro.raiseEvent(kc.a.WTi),z.a.ava&&a.rawEvent&&a.rawEvent.currentTarget&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this.AVb&&this.lk.Aqd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.ud.ik&&this.F2h&&this.v9i(a),this.SVb&&(this.xtf=this.r9i(a)),this.fWb&&(this.ytf=this.S$k(a)),a=this.NZh.create(null,Object(H.a)(this,this.iYi,"dispatchCutCopy"),b),a.$l("Browser "+(b?"Cut":"Copied")),a.run()):
(ha.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.lue(b?C.a.cut:C.a.copy),a.preventDefault())):a.preventDefault()}v9i(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.bae();({r4b:c}=this.lk.PMh(c));c&&(a.preventDefault(),b.setData("text/html",xb.c(c)),b.setData("text/plain",c.innerText))}}r9i(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=
this.lk.iKa(c),this.lk.Q1b(a,this.Pf.Rd.Nd,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.lk.Q1b(a.rawEvent.currentTarget,this.Pf.Rd.Nd,!0)}S$k(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();a=c&&0<c.length?this.lk.iKa(c):a.rawEvent.currentTarget;if(this.lk.yzd(a,!1))return b.setData("text/html",xb.c(a)),b.setData("text/plain",a.innerText),!0}return!1}bae(){if(this.ud.qS){const a=this.jd.Vta();if(a&&a.Il)return a.Il.getSelection()}return null}iYi(a,
b){this.tEd=!1;if(this.Pf.Rd.Go&&1!==w.AFrameworkApplication.Aa.state){if(b){if(this.ud.mg){for(b=0;b<this.Jh.Ni.length;b++){const c=this.Jh.Ni[b].NF,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.cL.zLa(this.xf.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz)}this.z_.Fti(a)}else this.z_.Dti(a);z.a.ava&&this.AVb&&this.Pf&&this.lk.Aqd(this.Pf.Rd.Cg.ho,"data-srcurl","data-src");this.SVb&&this.xtf&&this.Pf&&this.Pf.Rd&&this.lk.Q1b(this.Pf.Rd.Cg.ho,
this.Pf.Rd.Nd,!1);this.fWb&&this.ytf&&this.Pf&&this.Pf.Rd&&this.lk.yzd(this.Pf.Rd.Cg.ho,!0)}}}Object(m.a)(Ah,"CutCopyHandler",null,[1491]);class hf{constructor(a,b,c,f,l,y,G,R){this.ud=a;this.Ch=b;this.ar=c;this.qd=f;this.xf=l;this.lia=y;this.kt=G;this.Trb=R}f5b(a,b){this.ud.mg&&2===this.Ch.mode&&b&&this.ar.isComposing&&(a=this.qd.eq(C.a.typing),a.properties.$(Jf.a.source,"DomChange"),this.GZi(),a.end())}GZi(){this.Trb||this.xf.dba(!0);this.lia.kIb();this.kt.sZ()}}Object(m.a)(hf,"DomChangeEventProcessor",
null,[]);class rg{constructor(a,b,c,f){this.gj=a;this.Ch=b;this.Qb=c;this.Pf=f}tib(a,b){if(!b)return!1;this.gj.eUf(this.Ch,this.Qb);return this.Pf.Rd?this.Pf.Rd.tib(a):!1}}Object(m.a)(rg,"DoubleClickProcessor",null,[]);class Ej{constructor(a,b,c){this.ud=a;this.xpb=b;this.pFd=c}$Da(){this.xpb.i9a=!0;return!1}l5b(){return this.xpb.i9a=!1}aEa(a){this.xpb.i9a=!1;this.pFd.cancelEventAndRestoreEditingSurface(a.nc);return!0}}Object(m.a)(Ej,"DragEventsProcessor",null,[]);class Li{constructor(a){this.Zgf=
0;this.oEd=!1;this.ud=a}get i9a(){return this.oEd}set i9a(a){this.oEd=a;window.clearTimeout(this.Zgf);this.oEd&&(this.Zgf=window.setTimeout(Object(H.a)(this,this.uEk,"onAfterDragInactivity"),1E3))}uEk(){this.i9a=!1}}Object(m.a)(Li,"DragStateManager",null,[]);class Gh extends mb{constructor(){super();this.V7g=this.dEk=0}}Object(m.a)(Gh,"SetModeEditEventArgs",mb,[]);class hg extends mb{constructor(){super();this.updates=null;this.$za=new Oa.a}}Object(m.a)(hg,"BeforeValidateEditEventArgs",mb,[]);class Lh{constructor(){this.Dll=
this.HZi=null}}Object(m.a)(Lh,"EditStateFactoryManager",null,[]);class La extends mb{constructor(){super();this.keyCode=this.charCode=0;this.Apg=this.N2j=this.isComposing=!1}}Object(m.a)(La,"KeyDownEditEventArgs",mb,[]);class lb extends mb{constructor(){super();this.charCode=0;this.isComposing=!1}}Object(m.a)(lb,"KeyPressEditEventArgs",mb,[]);class Ob extends mb{constructor(){super();this.oLj=!1}}Object(m.a)(Ob,"PaddingChangedEventArgs",mb,[]);class mc{constructor(a){this.Oa=new Wc.a;this.r4a=Object.assign(new Lh,
{HZi:()=>a.Gm(),Dll:()=>Cd.a.LEa(a.contentWindow)})}addHandler(a,b){this.Oa.addHandler(a,b)}removeHandler(a,b){this.Oa.removeHandler(a,b)}raiseEvent(a){this.Oa.raiseEvent(a,Object.assign(new mb,{J9a:this.r4a}))}H2k(a,b){0===a&&0===b||this.Oa.raiseEvent(kc.a.Yql,Object.assign(new Gh,{dEk:a,V7g:b,J9a:this.r4a}))}Q0k(a){this.Oa.raiseEvent(kc.a.gsi,Object.assign(new hg,{J9a:this.r4a,updates:a.updates,$za:a.$za}))}Qmh(a){a.J9a=this.r4a;this.Oa.raiseEvent(kc.a.wgh,a)}bVe(a,b){this.Oa.raiseEvent(kc.a.Ay,
Object.assign(new lb,{charCode:a.nc.charCode,isComposing:b,J9a:this.r4a}))}aVe(a,b,c,f=!1){this.Oa.raiseEvent(kc.a.Df,Object.assign(new La,{charCode:a.nc.charCode,keyCode:a.nc.keyCode,isComposing:b,N2j:c,Apg:f,J9a:this.r4a}))}Pmh(a){this.Oa.raiseEvent(kc.a.tPk,Object.assign(new Ob,{J9a:this.r4a,oLj:a}))}}Object(m.a)(mc,"EditStateEventManager",null,[1490]);class Rc{constructor(a){this.pJd=this.MCc=!1;this.Tnf=null;this.tff=0;this.u_c=!1;this.Oa=a;this.hhf=0;this.qKd=2}get mode(){return this.hhf}rlb(a,
b){0===a?(0===b&&(b=1),this.Tnf=(new Date).toISOString(),this.qKd=b):this.qKd=0;this.hhf=a}get s5c(){return this.qKd}get Dak(){return this.Tnf}get isActive(){return 0!==this.mode}get tKi(){return this.tff}QLa(a){this.pJd=a}k8b(a){return this.isActive&&!!a&&this.MCc}dba(a){!this.MCc&&a&&this.Oa.raiseEvent(Pa.qKi);this.MCc=a;this.mDk(a);a&&(this.tff=(new Date).getTime())}r$f(a){return this.isActive&&!!a&&this.pJd}mDk(a){a&&yh.GrippersManager.instance.setVisibility(!1)}Afl(){this.pJd=this.MCc=!1}}Object(m.a)(Rc,
"EditViewStateManager",null,[1489]);var Ud=d(932);class ue{constructor(a,b,c,f,l,y){this.jd=a;this.SD=b;this.Ro=c;this.cL=f;this.Ma=l;this.Pf=y;this.Ma&&(this.Ma.ka("WordEditorImageOverflowIsEnabled")||this.Ma.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(ue.ERc=-1*Math.pow(2,31))}rNc(){this.SD.uMf();Ga.a.yv(this.jd.Gm())}M6d(a){const b=this.jd.Gm();if(2===a){var c=zc.Q_i;a=ue.P_i;b.style.overflow="visible"}else if(1===a)c=z.a.elb?0:ue.ERc,a="0",b.style.overflow="hidden";else return;
const f=this.jd.Cg.Lu;f.style.position="absolute";this.Ma&&(this.Ma.ka("WordEditorImageOverflowIsEnabled")||this.Ma.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility="visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}tZf(a){if(this.jd&&this.jd.Cg&&this.jd.Cg.Lu){var b=this.jd.Cg.Lu;b.style.zIndex=
String(z.a.elb?0:ue.ERc);z.a.elb&&!a&&(b.style.visibility="hidden",this.jd.Gm().style.visibility="hidden")}}XWk(a){this.Ro.raiseEvent(kc.a.FVj);this.rNc();this.jd.v1a(!0);this.jd.Gm().style.direction="";this.M6d(a);this.jd.Cg.yAk()}TWk(a){this.jd.v1a(!0);this.M6d(a);z.a.elb&&this.Qjg();z.a.bG&&Sys.UI.DomElement.addCssClass(this.jd.Gm(),"NonStandardIEClipboard")}WWk(a){this.M6d(a);z.a.bG&&Sys.UI.DomElement.removeCssClass(this.jd.Gm(),"NonStandardIEClipboard")}VWk(a,b,c,f,l,y,G){this.Ro.raiseEvent(kc.a.endEditing);
const R=this.jd.Gm();R&&(Ga.a.yv(R),z.a.tX&&b&&a&&(this.jd.v1a(!0),R.innerText=" ",this.cL.zLa(c,f,l,y,G)),a||Cd.a.CMf(R),this.jd.v1a(!1),this.tZf(b))}UWk(a){this.jd.v1a(!1);z.a.bG&&Sys.UI.DomElement.removeCssClass(this.jd.Gm(),"NonStandardIEClipboard");this.tZf(a);this.Ro.raiseEvent(kc.a.TEi)}YWk(){const a=Sys.UI.DomElement.getBounds(this.Pf.Rd.oK),b=this.jd.Cg.Lu;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.Pf.Rd.scrollTop,Ud.a)+"px");b.style.opacity="0";b.style.zIndex=String(ue.ERc);
z.a.Yj&&(b.style.visibility="Hidden",this.jd.Gm().style.visibility="Hidden")}Qjg(){const a=1E3-this.Pf.Rd.container.getBoundingClientRect().left+this.Pf.Rd.scrollLeft+1,b=this.jd.Cg.Lu;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}ue.ERc=-1E3;ue.P_i="1";Object(m.a)(ue,"EditingDomDisplayManipulator",null,[]);class Xe{constructor(a){this.h8h=a}get range(){return this.h8h}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}
Object(m.a)(Xe,"RangeProxy",null,[1553]);class pe{constructor(a){this.MGc=a}get selection(){return this.MGc}get type(){return this.selection.type}createRange(){return new Xe(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(m.a)(pe,"SelectionProxy",null,[1543]);class gg{constructor(a){this.g_h=a}get Il(){return this.g_h}get body(){return this.Il.body}get activeElement(){return this.Il.activeElement}get documentElement(){return this.Il.documentElement}get document(){return this.Il.cookie}get selection(){return new pe(this.Il.selection)}get designMode(){return this.Il.designMode}get doctype(){return this.Il.doctype}get domain(){return this.Il.domain}get hidden(){return this.Il.hidden}get implementation(){return this.Il.implementation}get parentWindow(){return this.Il.parentWindow}get referrer(){return this.Il.referrer}get title(){return this.Il.title}get URL(){return this.Il.URL}get visibilityState(){return this.Il.visibilityState}createAttribute(a){return this.Il.createAttribute(a)}open(){this.Il.open()}close(){this.Il.close()}attachEvent(a,
b){return this.Il.attachEvent(a,b)}detachEvent(a,b){this.Il.detachEvent(a,b)}createAttributeNS(a,b){return this.Il.createAttributeNS(a,b)}createDocumentFragment(){return this.Il.createDocumentFragment()}createElement(a){return this.Il.createElement(a)}createElementNS(a,b){return this.Il.createElementNS(a,b)}createEvent(a){return this.Il.createEvent(a)}createTextNode(a){return this.Il.createTextNode(a)}dispatchEvent(a){return this.Il.dispatchEvent(a)}execCommand(a,b,c){return this.Il.execCommand(a,
b,c)}hasFocus(){return this.Il.hasFocus()}focus(){this.Il.focus()}getElementById(a){return this.Il.getElementById(a)}getElementsByTagName(a){return this.Il.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.Il.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.Il.getElementsByName(a)}write(a){this.Il.write(a)}querySelector(a){return this.Il.querySelector(a)}querySelectorAll(a){return this.Il.querySelectorAll(a)}queryCommandEnabled(a){return this.Il.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.Il.queryCommandIndeterm(a)}queryCommandState(a){return this.Il.queryCommandState(a)}queryCommandSupported(a){return this.Il.queryCommandSupported(a)}queryCommandValue(a){return this.Il.queryCommandValue(a)}}
Object(m.a)(gg,"DOMDocumentProxy",null,[1589]);class cg{constructor(){this.t4a=null}get isValid(){return this.Cg.isValid}get contentWindow(){return this.Cg?this.Cg.contentWindow:null}get Cg(){return this.t4a}bHk(a){ag.a.d5g(a,this.Cg.Lu)}aHk(){ag.a.t$e(this.Cg.Lu)}zZf(){this.Cg.L1i()}irj(a){if(!z.a.mg)return a.innerHTML;this.Cg.tOl(a);return a.innerHTML}kQl(){this.Cg?(this.aHk(),this.t4a=null):ha.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}Dsi(a,b){this.t4a=
a;this.bHk(b)}Gm(){return this.Cg?this.Cg.ho:null}v1a(a){this.Cg&&this.Cg.ltd(a)}Vta(){return this.Cg?new gg(this.Cg.contentDocument):null}}Object(m.a)(cg,"EditingDomManager",null,[1488]);var Sg=d(149);class Hh{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){this.Mia=0;this.Ye=null;this.Qb=a;this.Mk=b;this.W2=c;this.Ro=f;this.Dqa=l;this.ae=y;this.jd=G;this.xf=R;this.LK=ja;this.$k=za;this.ud=Va;this.SD=hb;this.Uc=Cb;this.PK=lc;this.Jh=ic;this.Pf=yc;this.rf=ec;this.hd=xd;this.kia=jc;this.kia.xli(Object(H.a)(this,
this.peh,"onSynchronizeMode"))}dispose(){this.kia.Qcl(Object(H.a)(this,this.peh,"onSynchronizeMode"))}a1b(a){(this.Ye=a)||ha.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.xf.mode}endClipboard(){if(1===this.mode){var a=this.Mk.ke(2);a.ld(this.Ye.root);this.Ye.detach();this.Qb.Eg&&!this.Mne&&this.Qb.Eg.z9(this.Pf.Rd.Na,4,!0);this.xf.rlb(0,3);this.Qb.Eg=null;this.Qb.$h=null;this.Qb.QW=null;this.W2.UWk(this.Ye.nKa);a.dispose()}}cba(a,b,c){this.Ye.KVa&&
this.Qb.$h?this.Ye.ht(!1):this.Ye.KVa&&!this.Qb.$h&&ha.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.Ro.H2k(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.xf.rlb(a,c);f=this.startEditing(this.PTi);break;case 1:if(this.mode!==a||this.Uc.Pa.hs!==this.Mia)this.endEditing(!0),this.xf.rlb(a,c),f=this.oFl(),this.Mia=this.Uc.Pa.hs;break;case 0:this.mode!==a&&(2===this.mode&&yh.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.xf.rlb(a,c))}f||this.xf.rlb(0,7)}apl(){this.xf.rlb(2,0)}get PTi(){return this.Uc.Pa.nb.Ua.node}startEditing(a){if(1===this.wyf)return!1;this.jd.zZf();this.Ye.kza?this.Ye.ht(!0):(this.Ye.ZOj.BZf(!1),this.xf.k8b(this.Qb.Eg)&&this.Ye.ht(!1));this.Ye.kza=!1;if(this.Qb.Eg===a)return a=ub.GraphIterator.pb(a.node),this.T6d(a),this.Qb.NLj&&(this.ud.Yi&&this.Ye.zvb.xea||this.LK.setFocus(this.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz)),!0;
const b=this.Mk.ke(2,C.a.startEditing);b.ld(a.node);this.Ye.detach();this.Qb.Eg&&this.Qb.Eg.z9(this.Pf.Rd.Na,4,!0);this.Qb.Eg=a;this.Qb.Eg.z9(this.Pf.Rd.Na,4,!0);if(this.hd.gg){const c=Ee.j(this.Qb.Eg,5);for(let f=0;f<c.length;f++)c[f].sWf(this.Ye)}this.Ye.vxb=!0;this.W2.XWk(this.mode);this.Ye.my(a.node);this.SD.xlb(!1,this.Qb.Ui,this.Jh);this.xf.dba(!1);this.xf.QLa(!1);a=ub.GraphIterator.pb(this.Qb.Eg.node);this.T6d(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Ye.iSc(),this.Ye.ht(!0),
!this.Mne)){var b=this.Mk.ke(2);b.ld(this.Ye.root);this.Ye.detach();this.Qb.Eg&&this.Pf.Rd&&this.Qb.Eg.z9(this.Pf.Rd.Na,20,!0);this.xf.rlb(0,4);this.Qb.Eg=null;this.Qb.$h=null;this.Qb.QW=null;this.W2.VWk(a,this.Ye.nKa,this.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz);b.dispose()}}oFl(){if(this.Mne||M.a.instance.ga(11)&&1===this.wyf)return!1;this.Ro.raiseEvent(kc.a.SEi);this.jd.zZf();const a=this.Mk.ke(2);a.ld(this.Uc.Ymb);this.xf.k8b(this.Qb.Eg)&&this.Ye.ht(!1);
this.Ye.detach();this.Qb.Eg=null;this.Qb.$h=null;this.Qb.QW=null;if(this.Uc.Pa.Dea){const b=this.Uc.Pa.nb.Ua.node;this.Ye.my(b);const c=ub.GraphIterator.pb(b);this.Qb.Eg=b;this.Qb.tda=this.wYj(b);this.T6d(c);this.Qb.Eg.z9(this.Pf.Rd.Na,4,!0)}else this.Ye.my(this.Uc.Ymb);this.W2.TWk(this.mode);this.SD.xlb(!1,this.Qb.Ui,this.Jh);a.dispose();return!0}peh(){this.u2a()}u2a(){if(!this.Dqa.R9&&!w.AFrameworkApplication.De.Hw&&this.Pf.Rd&&this.Pf.Rd.isActive){var a=this.Uc.Pa.nb;a&&this.LK.epe()?this.PK&&
this.PK.Dbb()?this.cba(2,!0,10):this.rf.Ex(a)?Sc.App.Mb.Ld.isEditingAllowed||Sc.App.Mb.Ld.xz?this.cba(2,!0,0):this.Ye.Vud?(this.cba(1,!0,0),this.cba(0,!0,15)):this.cba(2,!0,0):this.cba(1,!0,0):this.cba(0,!1,a?9:8)}}get Mne(){return w.AFrameworkApplication.Yg}get wyf(){return w.AFrameworkApplication.Aa.state}T6d(a){a.kf();Sg.OutlineNavigator.$Ye(a)}wYj(a){return he.OutlineElementReader.Jm(rc.OutlineElementNavigator.AB(a))}}Object(m.a)(Hh,"EditingModeTransitionManager",null,[1487]);class li{constructor(a,
b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie){this.Ye=null;this.ae=a;this.xf=b;this.Qb=c;this.e4h=f;this.Zk=l;this.d4h=y;this.b4h=G;this.VDd=R;this.Vai=ja;this.wpb=za;this.MPa=Va;this.Mff=hb;this.f_h=Cb;this.LK=lc;this.Mha=ic;this.SZb=yc;this.k_h=ec;this.q6h=jc;this.QWh=xd;this.Q4h=Xd;this.Kia=Qd;this.gj=Ie}mT(a){this.Ye=a}get mZ(){return!this.ae.Hw&&this.xf.isActive&&this.Qb.DWa(this.xf.mode)?!0:!1}RTk(a){a.CGa=b=>this.e4h.CGa(b,this.mZ);a.idb=b=>this.d4h.idb(b,this.mZ);a.nA=b=>this.b4h.nA(b,
this.mZ,this.Ye.A4b);a.V2b=b=>this.VDd.V2b(b,this.mZ,this.Ye.A4b);a.y0d=b=>this.VDd.w0d(b,this.mZ,this.Ye.A4b);a.U2b=b=>this.VDd.U2b(b,this.mZ,this.Ye.A4b);a.Smb=b=>this.Vai.Smb(b,this.mZ&&this.Ye.Vud);a.aEa=Object(H.a)(this.wpb,this.wpb.aEa,"dropHandler");a.$Da=Object(H.a)(this.wpb,this.wpb.$Da,"dragOverHandler");a.l5b=Object(H.a)(this.wpb,this.wpb.l5b,"dragLeaveHandler");a.Hoc=b=>{this.MPa.handlePaste(b,this.Ye.root,this.xf.u_c)};a.D3d=b=>{this.Mff.Igg(b,!0,this.mZ,this.xf.u_c)};a.n3b=b=>{this.Mff.Igg(b,
!1,this.mZ,this.xf.u_c)};a.f5b=b=>{this.f_h.f5b(b,this.mZ)};a.AGf=()=>{this.LK.Zsi()};a.IC=b=>this.Mha.QTi(b,this.Zk.xea,this.mZ);a.LC=b=>this.SZb.onContextMenu(b,this.Ye.Eg);a.N8e=Object(H.a)(this.SZb,this.SZb.Xnc,"onTouchMove");a.M8e=Object(H.a)(this.SZb,this.SZb.AJb,"onTouchEnd");a.jVd=()=>{this.LK.R1i(this.xf.mode)};a.G9a=b=>this.k_h.tib(b,this.mZ);a.d1a=b=>{this.q6h.onScroll(b,this.mZ,this.Ye.ownerDocument.documentElement)};a.W1=()=>{this.QWh.SEk(this.mZ)};a.izg=b=>{this.Q4h.lostFocus(b,this.mZ)};
a.BNb=()=>this.Kia.WIj(this.mZ,this.Ye.Eg);a.Thb=b=>this.gj.mouseDown(b);a.DKe=b=>this.gj.bK(b)}}Object(m.a)(li,"EditingSurfaceEventHandlerManager",null,[]);class Oh{constructor(a,b,c){this.qd=a;this.fg=b;this.Ch=c}cancelEventAndRestoreEditingSurface(a){this.qd.Yb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.fg.bx++;md.a.Pn(a);this.Ch.cba(0,!0,6);this.Ch.u2a()}}Object(m.a)(Oh,"EditingSurfaceEventHandlerUtils",null,[]);class Wi{constructor(){this.XBa=0}get R9(){return 0<
this.XBa}suspend(){this.XBa++}resume(){0<this.XBa&&this.XBa--}}Object(m.a)(Wi,"EditingSurfaceStateManager",null,[]);class Xi{constructor(a=30){this.Zgd=this.Plc=-1;this.fnb=Array(a);this.qhd=Array(a-1)}SLh(){this.C5k();this.VTl()}Jsd(){const a=this.Tml();ha.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}C5k(){var a=(new Date).getTime();if(this.Plc<this.fnb.length-1)this.Plc++;else for(let b=0;b<this.fnb.length-1;b++)this.fnb[b]=this.fnb[b+1];this.fnb[this.Plc]=a}VTl(){const a=this.Plc+1;
for(let b=2;b<=a;b++)this.OPl(b,this.sjj(b))}sjj(a){const b=this.Plc;return this.fnb[b]-this.fnb[b-(a-1)]}OPl(a,b){a-=2;this.Zgd<a?(this.Zgd++,this.qhd[this.Zgd]=b):b<this.qhd[a]&&(this.qhd[a]=b)}Tml(){const a=this.E7i();return Sys.Serialization.JavaScriptSerializer.serialize(a)}E7i(){const a=Array(this.Zgd+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.qhd[b]/(b+1));return a}}Object(m.a)(Xi,"EventFrequencyTracker",null,[]);var Fi=d(1119),Mi=d(1121);class mh{constructor(a){this.St=null;this.np=
0;this.EK=a;this.Nj=new Date;this.hzc=w.AFrameworkApplication.Aa.mode}end(a){this.np=a;this.St=new Date}get startTime(){return this.Nj}get endTime(){return this.St}get actionId(){return this.EK}get behavior(){return 2}get xLc(){return this.hzc}get mK(){return null}get vd(){return null}get telemetryData(){return null}get response(){return this.np}get bU(){return 1}get Lp(){return 30}get Gsa(){return null}get Zi(){return!0}}Object(m.a)(mh,"TypingActionOperation",null,[1481,485,486]);class ai{constructor(a,
b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){this.Ye=this.sCc=this.Ypb=null;this.I6h=a;this.Ch=b;this.Ro=c;this.pia=f;this.W2=l;this.Mk=y;this.Qb=G;this.Pf=R;this.ae=ja;this.$k=za;this.xf=Va;this.gj=hb;this.Jh=Cb;this.kt=lc;this.lia=ic;this.BS=yc;this.Uc=ec;this.XD=jc}mT(a){this.Ye=a}get hlg(){return!!this.Ypb}startHybridTransition(){if(this.$k.value.isEditingAllowed||this.$k.value.xz){this.Ch.apl();this.Ro.raiseEvent(kc.a.qPk);this.aql(C.a.overtype);this.pia.value.Dw();this.W2.WWk(this.Ch.mode);
var a=this.Mk.ke(2);a.ld(this.Ye.root);this.Qb.Eg&&!w.AFrameworkApplication.Yg&&this.Qb.Eg.z9(this.Pf.Rd.Na,4,!0);a.dispose();this.BS.hsc();this.xf.QLa(!0);this.gj.updateCaretPosition(this.Ch.mode,this.Qb.Ui);this.I6h.B9i(this.Qb.$h,this.Qb.Eg,this.Qb.QW);this.Jh.iyk(this.Uc.Pa.nb.Ua.Ra,this.Uc.Pa.nb.Ua.Lb);this.kt.sZ();this.lia.kIb();this.ifi();this.Ro.raiseEvent(kc.a.oPk)}else this.Ch.cba(0,!0,12)}e1i(){this.BS.hsc();this.Ypb.end(32);Fi.a.getInstance().krc(this.Ypb);Mi.a.getInstance().jrc(this.Ypb);
this.Ypb=null}ifi(){this.sCc||(this.sCc=new pd.a(2,1,20,Object(H.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.ae.Hb(this.sCc))}aql(a){this.Ypb=new mh(a)}hybridCleanup(){this.sCc=null;this.Qb.DWa(this.Ch.mode)&&this.Ye.ht(!0)}t3e(){if(!this.Uc.Pa.Dea)return!1;const a=this.Uc.Pa.nb.Ua,b=jb.HyperlinkReader.UC(a,!1);for(const c of b)if(c.Ra===a.Ra&&c.Lb<=a.Lb)return!1;return this.XD.F6j(a)?!1:!Ee.d(a.node,a.Ra)&&!Ee.d(a.node,a.Lb-1)&&!a.node.aKi}}Object(m.a)(ai,"HybridTransitionManager",null,
[1486]);class Aa{constructor(a,b,c,f,l){this.JHd=this.kza=!1;this.ar=a;this.Ch=b;this.jd=c;this.Jh=f;this.Pf=l}get hPj(){return this.JHd}iSc(){this.BZf(!0)}BZf(a){this.ar.isComposing&&2===this.Ch.mode&&(ha.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.JHd=!0,this.jd.Cg.Roa(),this.Jh.BCk(this.jd.contentWindow),this.JHd=!1,this.ar.isComposing=!1,a&&this.Pf.Rd.Go&&(this.Pf.Rd.$ub()&&ha.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.Ch.u2a()))}}
Object(m.a)(Aa,"ImeManager",null,[]);class Ua{constructor(a,b,c,f,l,y,G,R){this.Eh=null;this.ud=a;this.jd=b;this.Ch=c;this.Mk=f;this.qd=l;this.fg=y;this.nn=R}a1b(a){this.Eh=a}get fPj(){if(this.ud.mg){const a=Cd.a.LEa(this.jd.contentWindow);if(a&&this.nn.kYc(a)===this.jd.Gm())return!0}return!1}correctBadImeState(){if(!this.fPj)return!1;this.qd.Yb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.fg.bz++;const a=this.Mk.ke(3);a.ld(this.Eh.root);this.Ch.cba(0,!0,11);this.Ch.u2a();
a.dispose();return!0}}Object(m.a)(Ua,"ImeRecoveryUtils",null,[]);class gb{constructor(a,b,c,f,l,y,G,R,ja){this.Jh=a;this.fg=b;this.qd=c;this.oj=f;this.VK=l;this.kp=y;this.Pf=G;this.Qb=ja}kIb(){for(let a=0;a<this.Jh.Ni.length;a++)this.kp.gJ(this.Jh.Ni[a].NF,this.fg,this.qd,this.oj)?Sys.UI.DomElement.removeCssClass(this.Jh.Ni[a].ane,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Jh.Ni[a].ane,"EmptyTextRun"),Ga.a.m3b(this.Jh.Ni[a].NF,this.Jh.Ni[a].ane)}}Object(m.a)(gb,"InteractiveViewSynchronizer",
null,[]);var Eb=d(15),Ub=d(199),vc=d(244);class jd{constructor(){}}Object(m.a)(jd,"OnBackspaceDeleteEventArgs",null,[]);class Id{constructor(a){this.H8d=a}}Object(m.a)(Id,"OnDisMissFloatieEventArgs",null,[]);var Od=d(558),ba=d(102);class Da{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og,pi,Wj,wg,Tg,Dh,Mm,Jj,Nm,so,an,to,hm,Vl,um,Kn){this.Lia=null;this.Mlf=this.bdf=!1;this.nWb=new Eb.ScriptSharpLegacyMap;this.dCa=a;this.oj=b;this.ae=c;this.jd=f;this.qd=
l;this.fg=y;this.Lra=G;this.Kia=R;this.Mha=ja;this.Qb=za;this.gj=Va;this.ud=hb;this.nn=Cb;this.TZ=lc;this.rf=ic;this.BS=yc;this.sI=ec;this.Uqa=jc;this.Uc=xd;this.xf=Xd;this.ar=Qd;this.pia=Ie;this.zC=Pe;this.mh=ig;this.$k=ff;this.cL=bh;this.Wob=ch;this.Zk=of;this.UOa=sg;this.dW=Fg;this.uXh=og;this.Trb=pi;this.Mk=Wj;this.Ca=wg;this.hd=Tg;this.pp=Dh;this.aE=Mm;this.yUb=Jj;this.dQ=Nm;this.t6a=so;this.zca=an;this.Ro=to;this.tXh=hm;this.zAa=!!Vl;this.ov=Vl;this.Ma=um;this.Mn=Kn}get nxc(){return this.dCa.instance?
this.dCa.instance.kNh():null}get e4d(){return this.yUb||(this.yUb=Fb.a.instance.rb("Common.IEventTimingMeter"))}get l1a(){return this.Lia||(this.Lia=Fb.a.instance.rb("Box4.ISelectionCommands"))}$$j(a,b){let c=this.Dge(a);c||(c=this.QFj(a,b));return c}QFj(a,b){const c=a.nc,f=c.keyCode,l=a.eventName===pa.a.PCa;if(this.zAa&&l&&this.ov.instance&&this.ov.instance.jFk(f===B.a.FG))return md.a.Pn(c),!0;if(f===B.a.r3a&&c.shiftKey&&c.ctrlKey)return l&&(w.AFrameworkApplication.Qa.processAction(C.a.ESf,2),ha.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===B.a.kAd||f===B.a.nAd)return this.nue(C.a.DSf),!1;if(f===B.a.lAd||f===B.a.Zxc)return this.nue(C.a.CSf),!1;if(f===B.a.lcf)return this.nue(C.a.vTi),!1}this.oj&&(this.ae.dUf(Da.hJl),this.jd.Cg.vyd());if(1===this.xf.mode)return this.MIk(a,b);if(this.oj&&this.Zk.xea)return this.qd.Yb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.fg.bw++,md.a.Pn(c),this.Lra.bsc(C.a.typing),!0;this.Kia.fixupAfterMagnifierDrag();this.jd.Gm().scrollTop=
0;this.Mha.V9=!this.Qb.tda&&f===B.a.JV||this.Qb.tda&&f===B.a.BZ||f===B.a.ez;this.gj.updateCaretPosition(this.xf.mode,this.Qb.Ui);this.ud.Yj&&(c.ctrlKey||c.altKey)&&f!==B.a.jAd&&f!==B.a.oNa&&f!==B.a.Nnb&&f!==B.a.kBd&&this.UOa.iSc();return this.PFj(a)}PFj(a){var b=a.nc.keyCode;const c=b===B.a.vha,f=b===B.a.FG;let l=!1,y=!1,G=!1;switch(b){case B.a.ez:case B.a.oI:G=!0;w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.Ma.ka("BrowserHandledNavigationIsEnabled");
a.nc.altKey||a.nc.ctrlKey||a.nc.shiftKey||this.ud.fl||!b&&this.ud.ik||(y=!0);break;case B.a.BZ:case B.a.JV:G=!0;this.ud.fl&&this.nn.hag(a.nc.rawEvent)&&!a.nc.altKey&&!a.nc.shiftKey?y=!0:this.ud.Yj&&this.l1a?a.nc.altKey||a.nc.ctrlKey||a.nc.shiftKey||(y=!0):l=!0;this.Ma&&this.Ma.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.xf.QLa(!0);break;case B.a.B2:case B.a.A2:G=!0;this.ud.Yj&&this.l1a?y=this.sEj(a):l=!0;this.Ma&&this.Ma.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.rf.T3c(this.t6a.nb)||
this.rf.rLa(),this.xf.QLa(!0));break;case B.a.vha:case B.a.FG:if(!this.$k.value.isEditingAllowed&&this.$k.value.xz)l=!0;else if(this.hEj(a,c,f))return w.AFrameworkApplication.fa.ka("LocallyResizeTextBoxOnContinuousTypingEnabled")&&Rd.a("SendAutofitTypeToClient")&&a.eventName===pa.a.PCa&&this.Ro.aVe(a,this.ar.isComposing,!1,!0),!0;break;case B.a.qSh:this.qd.Yb("InsertKeyPressed");l=!0;break;default:if(a.nc.keyCode===B.a.kBd||a.nc.keyCode===B.a.oAd||this.ud.tVd)this.ar.isComposing=!0,this.Trb||this.xf.dba(!0)}(this.Zk.C3&&
!f||this.Zk.Wsa&&!c)&&this.sI.ht(!0);2!==this.xf.mode&&(G=y=!1);a.eventName===pa.a.PCa&&(w.AFrameworkApplication.fa.ka("LocallyResizeTextBoxOnContinuousTypingEnabled")&&Rd.a("SendAutofitTypeToClient")?this.Ro.aVe(a,this.ar.isComposing,G,f||c):this.Ro.aVe(a,this.ar.isComposing,G));y&&(this.pia.value.Dw(),this.zC.MQa(a));l&&md.a.Pn(a.nc);return y}Dge(a){return w.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?Od.a.Dge(a,this.t6a.K6b):!1}iEj(a){const b=this.t6a.K6b;var c=b.node;const f=b.Ra,
l=zb.ParagraphReader.text(c);let y=!1;if(a){if(f<zb.ParagraphReader.textLength(c)){a=this.Mk.ke(15);try{a.ld(c),c=f+1,na.a.Hx(l,c)&&c++,this.Mn.PIb(b,null),this.Ca.processAction(C.a.rightArrow,2)}finally{a&&a.dispose()}y=!0}}else if(0<f){a=this.Mk.ke(15);try{a.ld(c),c=f-1,na.a.Hx(l,c)&&c--,this.Mn.PIb(b,null),this.Ca.processAction(C.a.leftArrow,2)}finally{a&&a.dispose()}y=!0}return y}Guj(a){return wb.a.Es(a.Ua).cache.fontSize}sEj(a){var b=!1;if(!(a.nc.altKey||a.nc.ctrlKey||a.nc.shiftKey||(a=Ee.f(this.Qb.Eg),
Ub.a.any(a,c=>5===c.Cq||8===c.Cq)))){if(this.jd.Cg&&this.dQ.TBb(this.jd.Cg.ho))return!1;this.zC.znb&&this.zC.typingProcess();b=this.TZ.Uta(this.Mha.V9);a=this.rf.zja(b);a=this.Qb.tda?a.x+a.width:a.x;-1===this.rf.Uz?(this.rf.Uz=a,b=!0):b=Math.abs(this.rf.Uz-a)<=this.Guj(b)}return b}hEj(a,b,c){if(!a.nc.altKey&&!a.nc.ctrlKey&&!a.nc.shiftKey&&(this.oj&&this.Zk.C3&&this.BS.bzd()&&this.sI.ht(!1),this.uXh.KOl(b,this.Qb.$h,this.Qb.nSa,this.Qb.Eg,this.Mha.V9,this.Qb.QW.Ui,this.sI.Eti))){if(this.hd.gg&&this.hd.nz)return(b=
this.iEj(b))&&md.a.Pn(a.nc),b;const f=this.qd.eq(C.a.nXd);this.nxc&&this.nxc.fak();const l=new jd(a,c,b);this.tXh.P0k(l);(c&&!this.Zk.C3||b&&!this.Zk.Wsa)&&this.sI.ht(!1);M.a.instance.ga(50)&&this.Uqa.value&&this.Uqa.value.Ew&&this.Uc.t_b();Ga.a.m3b(this.Qb.$h.Ui,this.Qb.QW.Ui);this.zC.MQa(a);this.rf.rLa();this.xf.dba(!0);this.Zk.Wsa=b;this.Zk.C3=c;this.Zk.C3&&-1===this.Zk.MOc?this.Zk.MOc=this.sI.$Yc:this.Zk.Wsa&&-1===this.Zk.rxd&&(this.Zk.rxd=Ga.a.Gv(this.Qb.nSa).length);f.end();return!0}return!1}nA(a,
b,c){const f=this.e4d;try{f&&f.keyDownEventHandlerStart(a.nc.rawEvent);0===this.xf.mode&&a.nc.keyCode!==B.a.jp&&1!==this.Ca.mode&&this.Nfk(this.xf,a.eventName);if(!b||!this.mh)return!1;(a.nc.keyCode!==B.a.Nnb||this.Wob.WQc)&&this.$k.value.To.iE();if(!this.pxl(a)){const G=new Id(!0);this.zca.h1k(G)}if(!this.xf.isActive)return!1;this.Zk.Jse=(new Date).getTime();const l=this.qd.eq(C.a.typing);l.properties.$(Jf.a.source,"KeyDown");l.properties.$(Jf.a.Ohh,"KeyDown");const y=this.$$j(a,c);y&&md.a.oAi(a.nc);
l.end();return y}finally{f&&f.keyDownEventHandlerEnd(a.nc.rawEvent)}}pxl(a){switch(a.nc.keyCode){case B.a.Iba:case B.a.pSh:case B.a.o7:case B.a.CZ:case B.a.Jba:case B.a.wha:case B.a.oAd:case B.a.pAd:return!0}return!1}Nfk(a,b){b={["EventName"]:b};w.AFrameworkApplication.Aa&&(b.Mode=w.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=a.s5c,b.TriggeredTime=a.Dak,this.nWb.Gb(a.s5c)){let c,f;(c=this.nWb).$(f=a.s5c,c.ga(f)+1)}else this.nWb.$(a.s5c,1);b.Msg="BadEditSurfaceState";this.bdf?ha.ULS.sendTraceTag(18437408,
323,50,"{0}",b):(ha.ULS.shipAssertTag(18437408,323,!1,"{0}",b),w.AFrameworkApplication.$ga(()=>{this.Ofk()}));this.bdf=!0}Ofk(){if(!this.Mlf){var a="";for(let b of this.nWb.keys)a+=" Trigger "+b+" - "+this.nWb.ga(b)+",";ha.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.Mlf=!0}}MIk(a,b){this.oj&&this.cL.alb(this.xf.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz);if(this.hd.gg&&(x.KeyInputManager.PZc(a.nc)===x.KeyInputManager.Va(B.a.tAa,
x.KeyInputManager.Te)||x.KeyInputManager.PZc(a.nc)===x.KeyInputManager.Va(B.a.Fyc,x.KeyInputManager.Te))&&(w.AFrameworkApplication.XE||w.AFrameworkApplication.Vx)&&!w.AFrameworkApplication.YSa)return md.a.Pn(a.nc),!0;const c=this.t6a.K6b,f=c.node;if(a.nc.keyCode===B.a.jp){if(vc.EmbeddedFileReader.C4j(f))return md.a.Pn(a.nc),!0;if(ba.ImageReader.xH(f)||!vc.EmbeddedFileReader.ocb(f))if(ba.ImageReader.xH(f)||ba.ImageReader.cGa(c))return w.AFrameworkApplication.Qa.ii(c,C.a.$B,2,!1,null,null),md.a.Pn(a.nc),
!0}switch(a.nc.keyCode){case B.a.kBd:case B.a.oAd:if({v4:a,DPb:b}=this.dW.nNh(a,b),a)return b}return!1}nue(a){w.AFrameworkApplication.Qa.processAction(a,2)}}Da.hJl=2E3;Object(m.a)(Da,"KeyDownProcessor",null,[]);class Qa{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){this.kp=a;this.Qb=b;this.fg=c;this.qd=f;this.oj=l;this.SD=y;this.sI=G;this.BS=R;this.Ch=ja;this.gj=za;this.TZ=Va;this.MV=hb;this.rf=Cb;this.Zk=lc;this.xf=ic}get PPe(){return this.kp.gJ(this.Qb.Ui,this.fg,this.qd,this.oj)-(this.SD.V7?
1:0)-this.kp.gJ(this.Qb.Ui.lastChild,this.fg,this.qd,this.oj)}GYk(a,b){switch(b.keyCode){case B.a.oI:case B.a.BZ:if(this.JMj(a,b))return!0;break;case B.a.ez:case B.a.JV:if(this.a1i(a,b))return!0;break;case B.a.B2:case B.a.A2:if(this.rRl(a,b))return!0;break;case B.a.FG:if(this.Qri())return!0}return!1}Qri(){return this.Zk.C3&&this.BS.bzd()?(this.sI.ht(!1,!0),!0):!1}rRl(a,b){a.I1c=!0;var c=this.PPe;const f=this.gj.b9(this.Ch.mode,this.Qb.Ui);f>=c&&(this.gj.GT(c,this.Qb.$h),a.nb=this.TZ.Uta(this.MV.V9));
if(f===b.o4b)a.k9a=b.keyCode===B.a.CZ?1:3;else{if(f<c&&na.a.yz(this.kp.S6f(this.Qb.$h,f-1,this.qd,this.fg,this.oj))){c=this.rf.Cta(a.nb,!1,!1,!1,!0);c=this.rf.zja(c);var l=a.nb.Ua;a=this.rf.zja(a.nb);l=wb.a.Es(l);a.y>c.y&&Math.abs(a.x-this.rf.Uz)>2*l.cache.fontSize&&this.gj.GT(f-1,this.Qb.$h)}this.xf.QLa(!0);this.MV.fixupAfterCursor(b.keyCode===B.a.CZ?1:3);this.sI.g4d();return!0}return!1}a1i(a,b){a.I1c=!0;const c=this.PPe;this.rf.rLa();const f=this.gj.b9(this.Ch.mode,this.Qb.Ui);f>=c&&(this.gj.GT(c,
this.Qb.$h),a.nb=this.TZ.Uta(this.MV.V9));if(b.keyCode===B.a.JV&&(b.o4b>=c&&!this.Qb.tda||b.o4b===this.MV.tHh&&this.Qb.tda))a.k9a=2;else return this.xf.QLa(!0),b.keyCode===B.a.ez&&f<c&&na.a.yz(this.kp.S6f(this.Qb.$h,f-1,this.qd,this.fg,this.oj))&&this.gj.GT(f-1,this.Qb.$h),this.MV.fixupAfterCursor(this.Qb.tda?4:2),this.sI.g4d(),!0;return!1}JMj(a,b){a.I1c=!0;const c=this.PPe;this.rf.rLa();if(b.keyCode===B.a.BZ&&(b.o4b===this.MV.tHh&&!this.Qb.tda||b.o4b>=c&&this.Qb.tda))a.k9a=4;else return this.xf.QLa(!0),
this.MV.fixupAfterCursor(this.Qb.tda?2:4),this.sI.g4d(),!0;return!1}}Object(m.a)(Qa,"KeyEntryProcessor",null,[]);var nb=d(1259),Wb=d(130),Jb=d(44);class Uc{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of){this.GAa=this.esf=null;this.ud=a;this.nn=b;this.qd=c;this.Kia=f;this.$k=l;this.dW=y;this.I7=G;this.ar=R;this.xf=ja;this.Uc=za;this.jd=Va;this.qBc=hb;this.gj=Cb;this.Fha=lc;this.kp=ic;this.Qb=yc;this.Mha=ec;this.Jh=jc;this.Uqa=xd;this.Ro=Xd;this.zC=Qd;this.Vba=
Ie;this.dCa=Pe;this.tai=ig;this.Oha=ff;this.hd=bh;this.pp=ch;this.yUb=of}get nxc(){return this.dCa&&this.dCa.instance?this.dCa.instance.kNh():null}get adb(){return this.hd.gg&&this.hd.nz}get z_(){return this.GAa||(this.GAa=Fb.a.instance.rb("Box4.IClipboardCommands"))}get e4d(){return this.yUb||(this.yUb=Fb.a.instance.rb("Common.IEventTimingMeter"))}idb(a,b){if(!b)return!1;b=this.e4d;try{b&&b.keyPressedEventHandlerStart(a.nc.rawEvent);if(this.ud.eG&&this.ud.fl&&this.nn.hag(a.nc.rawEvent))return!1;
this.nxc&&!x.KeyInputManager.$qg(a)&&this.nxc.fak();const c=this.qd.eq(C.a.typing);c.properties.$(Jf.a.source,"KeyPress");const f=this.eak(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.nc.rawEvent)}}JJj(){if((this.tai||this.adb)&&this.Oha.A3(this.Uc.ak,14)){var a=Object(sa.a)(nb.a,this.Oha.o7b(this.Uc.ak,16,!1));if(a&&1<a.length){const b=[],c=this.Uc.Pa.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!ub.GraphIterator.pb(l).Aba(a))break;Array.add(b,
c.ga(f))}0<b.length&&this.Uc.setSelection(new Wb.Selection(b,!0))}}}L1k(a,b){if(1===this.xf.mode)return!1;this.Ro.bVe(a,this.ar.isComposing);let c;(c=this.zC).Z4c=c.Z4c+1;z.a.Io||Sc.App.LXd&&z.a.JIh||(this.zC.zDh(this.ar.sGa)||this.zC.MQa(a),this.xf.dba(!0));this.ar.isComposing&&M.a.instance.ga(50)&&this.Uqa.value&&this.Uqa.value.Ew&&this.Uc.t_b();this.Jh.cJc="";0<this.Jh.Ni.length&&(this.ud.mg||" "===b)&&(this.Jh.cJc=Ga.a.Gv(this.Jh.Ni[0].NF));this.Vba.raiseEvent(pg.a.yse,a);this.qBc.SLh();return!1}TYi(a){let b=
!1;this.ar.sGa&&this.Fha.U0b.instance&&(" "===a&&this.kp.m0i(this.Qb.Ui,this.gj.b9(this.xf.mode,this.Qb.Ui))&&(b=!!this.Fha.DJe(this.ar.sGa,this.Mha.V9)),!b&&this.Fha.U0b.instance.d9j(a)&&this.Fha.SYi(a,this.Mha.V9))}RFj(a){if(1!==this.xf.mode||(this.ud.Yj||this.ud.Io)&&a.nc.ctrlKey&&!a.nc.altKey||this.ud.Ila&&a.nc.charCode===B.a.AZ)return!1;if(this.dW.Ald(a))return!0;var b=this.dW.Y2e();const c=this.dW.rxl();if(b||c||!this.I7.t3e())return b&&!c&&this.Uc.setSelection(Vd.SelectionFactory.Qg(this.Uc.Pa.nb.Ua.node,
this.Uc.Pa.nb.Ua.Ra)),b=this.pcb(),this.JJj(),this.z_&&(this.z_.hhh(String.fromCharCode(a.nc.charCode),b),this.Vba.raiseEvent(pg.a.yse,a)),md.a.Pn(a.nc),!0;if(this.dW.xPe(a))return!0;if(this.adb){b=this.hd.Vtb();try{this.Ro.bVe(a,this.ar.isComposing),this.ud.Io&&this.z_?(this.z_.hhh(String.fromCharCode(a.nc.charCode)),md.a.Pn(a.nc)):(this.zC.MQa(a),this.xf.dba(!0))}finally{b&&b.dispose()}}else this.I7.startHybridTransition(),this.Ro.bVe(a,this.ar.isComposing),this.zC.MQa(a),this.xf.dba(!0);this.Vba.raiseEvent(pg.a.yse,
a);this.qBc.SLh();return!1}pcb(){if(this.Uc&&this.Uc.Pa&&this.Uc.Pa.nb){const a=this.Uc.Pa.nb;return Jb.SelectionEditor.nm(a.ga(a.length-1))||a.ga(a.length-1).contextId===rb.a.paragraph}return!1}eak(a){this.Kia.fixupAfterMagnifierDrag();if(!(this.$k.value.isEditingAllowed||this.$k.value.xz&&this.adb))return md.a.Pn(a.nc),!0;if(this.dW.Cld(a))return!1;if(1===this.xf.mode)return this.RFj(a);this.jd.Gm().scrollTop=0;this.ud.mg&&this.xf.k8b(this.Qb.Eg)&&" "===this.esf&&this.zC.typingProcess();const b=
na.a.charAt(na.a.fromCharCode(a.nc.charCode),0);this.esf=b;this.ar.isComposing||(x.KeyInputManager.$qg(a)&&(this.ar.isComposing=!0),this.gj.G3k&&(this.ar.isComposing=!0));this.TYi(b);if(this.ud.mg&&!this.ud.fl){const c=a.nc;if(c.ctrlKey&&122===this.nn.R6f(c)||c.ctrlKey&&121===this.nn.R6f(c))return!0}return this.L1k(a,b)}}Object(m.a)(Uc,"KeyPressProcessor",null,[]);class Jd{constructor(a,b){this.xj=a;this.keyCode=this.xj.nc.keyCode;this.o4b=b}get ZKj(){return!(void 0===this.keyCode||null===this.keyCode)}}
Object(m.a)(Jd,"KeyQueueEntry",null,[]);class ne{constructor(a,b,c,f,l,y,G){this.oWb=[];this.Lia=null;this.c4h=a;this.xf=b;this.Qb=c;this.rf=f;this.Uc=l;this.sI=y;this.gj=G}get l1a(){return this.Lia||(this.Lia=Fb.a.instance.rb("Box4.ISelectionCommands"))}Ojh(a){let b=-1;if(x.KeyInputManager.vrg(a.eventName)&&2===this.xf.mode)switch(a.nc.keyCode){case B.a.oI:case B.a.ez:case B.a.BZ:case B.a.JV:case B.a.B2:case B.a.A2:M.a.instance.ga(45)&&this.xf.k8b(this.Qb.Eg)&&this.sI.ht(!1,!1);yh.GrippersManager.instance.kVa();
b=this.gj.b9(this.xf.mode,this.Qb.Ui);break;default:yh.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.oWb,new Jd(a,b))}HYk(a){for(;0<this.oWb.length;){const b=this.oWb[0];Array.removeAt(this.oWb,0);const c=x.KeyInputManager.vrg(b.xj.eventName);if(!(c&&(b.xj.nc.altKey||b.xj.nc.ctrlKey||b.xj.nc.shiftKey)||this.oWb.length)){if(c)if(b.ZKj){if(this.c4h.GYk(a,b))return!0}else this.rf.rLa();if(this.lPl(a))return!0}}return!1}lPl(a){if(5!==a.k9a){if(this.xf.r$f(this.Qb.Eg))if(1===a.k9a||3===
a.k9a){const b=this.rf.Uz;this.Uc.setSelection(a.nb);this.rf.Uz=b}else this.Uc.setSelection(a.nb);this.l1a.YAk(a.k9a);if(2!==this.xf.mode)return!0}return!1}}Object(m.a)(ne,"KeyQueueProcessor",null,[]);class bf{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.Lia=null;this.qd=a;this.cL=b;this.Ch=c;this.ar=f;this.Qb=l;this.$k=y;this.lia=G;this.kt=R;this.ADc=ja;this.jd=za;this.Wob=Va;this.zC=hb}get l1a(){return this.Lia||(this.Lia=Fb.a.instance.rb("Box4.ISelectionCommands"))}CGa(a,b){if(!b)return!1;b=this.qd.eq(C.a.typing);
b.properties.$(Jf.a.source,"KeyUp");a=this.hak(a);b.end();return a}hak(a){a.nc.keyCode===B.a.Nnb&&(this.Wob.WQc=!0);a.nc.ctrlKey&&this.cL.ZUf(this.Ch.mode,ze.a.instance.Pa,this.l1a,this.Qb.$h,this.Qb.Ui,this.Qb.Eg,this.$k.value.isEditingAllowed||this.$k.value.xz);this.ar.isComposing&&(this.lia.kIb(),this.kt.sZ());this.zC.zDh(this.ar.sGa)&&(this.ADc.Ojh(a),this.zC.znb=!0,this.zC.typingProcess());this.jd.Gm().scrollTop=0;return!1}}Object(m.a)(bf,"KeyUpProcessor",null,[]);class sd{constructor(a){this.NDd=
this.sCd=this.KG=null;this.ae=a}get w8(){return this.KG||(this.KG=Fb.a.instance.resolve("Common.Utils.IAriaNotifier"))}zDk(a){a&&(this.NDd=a,this.sCd=new pd.a(2,1,500,Object(H.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),29),this.ae.Hb(this.sCd))}tryAriaNotifyParagraphLockedTask(a){this.NDd&&a&&this.sCd===a&&this.w8.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.NDd),!0)}}Object(m.a)(sd,"LockedParagraphAriaNotifier",null,[]);
class vd{constructor(a){this.sI=a}lostFocus(a,b){w.AFrameworkApplication.Yg||b&&this.sI.ht(!0,!1)}}Object(m.a)(vd,"LostFocusEventProcessor",null,[]);class $c{constructor(a,b,c,f){this.fg=a;this.Ch=b;this.lia=c;this.kt=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&(this.fg.h++,c.scrollLeft=0,c.scrollTop=0,2===this.Ch.mode&&(this.lia.kIb(),this.kt.sZ()))}}Object(m.a)($c,"OnScrollProcessor",null,[]);var hd=d(1148);class Dd{constructor(a,b,c,f){this.html=a;this.text=b;this.qKl=c;this.U0d=f}dispose(){this.U0d=
null}}Object(m.a)(Dd,"OriginalElementContent",null,[108]);class Re{constructor(a,b,c){this.xXb=[];this.Dhf=0;this.qd=a;this.ZS=b;this.kp=c}get d7d(){return this.Dhf}get Ffh(){return this.xXb}tMf(){for(let a=0;a<this.xXb.length;a++)this.xXb[a]&&(this.xXb[a].dispose(),this.xXb[a]=null)}FHh(a){this.tMf();a=a.Et;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,uc.a.o8d));if(b||Sys.UI.DomElement.containsCssClass(f,
uc.a.JN)||Sys.UI.DomElement.containsCssClass(f,da.a.xW)||Sys.UI.DomElement.containsCssClass(f,uc.a.$N)){let l=b=null,y=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=Ga.a.Gv(f):(l=this.kp.Wae(f,this.qd,this.ZS),y=new hd.a(f));this.Ffh[c]=new Dd(f.innerHTML,b,l,y)}Sys.UI.DomElement.containsCssClass(f,uc.a.$N)&&(this.Dhf=Ga.a.$$a(f))}}}Object(m.a)(Re,"OriginalElementContentArray",null,[1479]);class ml{constructor(a,b,c,f,l,y,G){this.Jh=a;this.fg=l;this.qd=f;this.oj=G;this.SD=b;this.Uc=c;
this.kp=y}B9i(a,b,c){var f=this.Uc.Pa.nb.Ua;const l=f.Ra;f=f.Lb;let y=0,G=0;a=a.Et;Array.clear(this.Jh.Ni);for(let Va=0;Va<a.length;Va++){var R=a[Va],ja=this.kp.gJ(R,this.fg,this.qd,this.oj);if(Sys.UI.DomElement.containsCssClass(R,uc.a.JN))G<l?y+=ja:G<f&&(ja=Ee.d(b,G))&&!ja.WCa&&(ja=N.a.Be(R,da.a.GGa),Array.add(this.Jh.Ni,new ng(R,c.Et[ja],y,G,1))),G++;else if(Sys.UI.DomElement.containsCssClass(R,da.a.xW))y+=ja;else if(!Sys.UI.DomElement.containsCssClass(R,uc.a.$N)){if(G+ja>=l&&G<=f){let hb=N.a.Be(R,
da.a.GGa);var za=c.Et[hb];Sys.UI.DomElement.removeCssClass(za,uc.a.H8);Array.add(this.Jh.Ni,new ng(R,za,y,G,ja-(this.SD.V7?1:0)));for(R=this.kp.gJ(za,this.fg,this.qd,this.oj);R<ja&&!(hb+1>=c.Et.length);)za=c.Et[hb+1],R+=this.kp.gJ(za,this.fg,this.qd,this.oj),za.parentNode.removeChild(za),Array.removeAt(c.Et,hb+1)}else if(G>f)break;y+=ja;G+=ja}}}}Object(m.a)(ml,"OvertypeDomPreparer",null,[]);var Mh=d(122),we=d(61);class Yi{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){this.YMd=!1;this.GAa=null;
this.K4h=a;this.Ch=b;this.ud=c;this.Uc=f;this.Lra=l;this.rf=y;this.$k=G;this.Pf=R;this.ar=ja;this.I7=za;this.oj=Va;this.Qb=hb;this.cL=Cb;this.zC=lc;this.hd=ic;this.pp=yc}get z_(){return this.GAa||(this.GAa=Fb.a.instance.rb("Box4.IClipboardCommands"))}ePl(){return 1===this.Ch.mode?(this.YMd&&this.ud.mg&&this.uXd(),this.YMd=!1,!0):!1}uXd(){if(this.z_){const a=new J.DictionaryPropertySet;a.setValue(we.a.aV,"<span></span>");this.z_.z8(null,a,!1)}}xPe(a){const b=this.Uc.Qpa;return b.Xre||b.fqe?(md.a.Pn(a.nc),
this.Lra.bsc(C.a.pPk),!0):!1}Ald(a){if(!this.rf.Hua(ze.a.instance.Pa.nb))return!1;md.a.Pn(a.nc);this.Lra.bsc(C.a.Ald);return!0}Cld(a){if(!M.a.instance.ga(14))return!1;var b=ze.a.instance.Pa.ga(0);if(!Mh.a.instance.zll(b))return!1;b=this.rf.Wxc(ze.a.instance.Pa);this.K4h.zDk(b);md.a.Pn(a.nc);this.Lra.bsc(2===this.Ch.mode?C.a.VPl:C.a.Cld);return!0}nNh(a,b){let c,f;f=c=!1;if(!this.$k.value.isEditingAllowed)return md.a.Pn(a.nc),{v4:!0,DPb:!0};if(!b)return{v4:!0,DPb:!0};if(this.Ald(a)||this.Pf.Rd.Nb.Pa.yH&&
a.nc.type===pa.a.v0d)return{v4:!0,DPb:f};this.ar.isComposing=!0;b=this.Y2e();if(!b&&this.I7.t3e()){if(this.xPe(a))return{v4:!0,DPb:f};this.oj&&this.cL.alb(this.Ch.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz);this.hd.gg&&this.hd.nz?(md.a.Pn(a.nc),f=c=!0):this.I7.startHybridTransition()}else b&&this.Uc.setSelection(Vd.SelectionFactory.Qg(ze.a.instance.Pa.nb.Ua.node,ze.a.instance.Pa.nb.Ua.Ra)),this.Uc.Qpa.Jub(),this.hd.gg&&this.hd.nz?(md.a.Pn(a.nc),f=c=!0):
this.ud.mg?(this.YMd=!0,this.zC.MQa(a),c=!0):(this.uXd(),md.a.Pn(a.nc));return{v4:c,DPb:f}}Y2e(){if(!this.Uc.Pa.Dea)return!1;var a=ze.a.instance.Pa.nb.Ua;return a.Ra!==a.Lb-1?!1:(a=Ee.d(a.node,a.Ra))&&5===a.Cq?!0:!1}rxl(){if(!this.Uc.Pa.Dea)return!1;const a=this.Uc.Pa.nb.Ua;return!Ee.d(a.node,a.Lb)||0<a.Ra&&!Ee.d(a.node,a.Ra-1)||a.Ra===a.Lb?!1:!0}}Object(m.a)(Yi,"OvertypeUtils",null,[]);class nl{constructor(a,b,c,f,l,y){this.f4a=null;this.jd=a;this.fZh=b;this.Pf=c;this.Ch=f;this.Qb=l;this.IMd=y}get rPf(){return this.fZh}oaf(){if(2===
this.Ch.mode&&this.Pf.Rd.yp&&this.Qb.DWa(this.Ch.mode)){var a=this.Qb.$h,b=this.rPf.fde(a.gb);this.IMd.gsh(b,this.f4a,a,this.jd.Cg.Lu,!1,!0);this.f4a=b}}}Object(m.a)(nl,"ParagraphOverlayPositioner",null,[]);class Pj{constructor(a,b){this.LRk=this.location=null;this.Uu=a;this.isRtl=b}}Object(m.a)(Pj,"OnShowFloatieEventArgs",null,[]);class ol{constructor(){this.type=0;this.payload=this.sPe=null;this.H5c=!1;this.PRa=this.style=this.dTe=null}}Object(m.a)(ol,"PasteDataContext",null,[]);class mi{constructor(a,
b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch){this.aNd=this.Brf=this.eo=null;this.GPd=bh;this.yra=ch;this.Arf=a.ka("PasteClipboardImageInChromeIsEnabled");this.W6h=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.TNd=a.ka("ReadImageBlobForIE11UpIsEnabled");this.sYh=a.uc("ClipboardDataImageBlobLimitaton",10);this.aZb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.fvf=a.ka("PasteInBootLoadingUIIsEnabled");this.LPd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");
this.ae=b;this.qd=c;this.Mk=f;this.Uc=l;this.Ch=y;this.jd=G;this.W2=R;this.Pf=ja;this.ud=za;this.cL=Va;this.Qb=hb;this.Fha=Cb;this.$k=lc;this.GAa=ic;this.lk=yc;this.MZh=jc;this.lQa=xd;this.QS=Xd;this.Ca=Qd;this.r7=Ie;this.gra=Pe;this.zca=ig;this.aCa=ff;this.Oef=[Object(H.a)(this,this.vOj,"imageClipboardDataHandler"),Object(H.a)(this,this.hTk,"plainTextClipboardDataHandler"),Object(H.a)(this,this.jNj,"htmlClipboardDataHandler")]}get z_(){return this.GAa.instance}get nKa(){return this.aNd}hrj(a){switch(a){case "image/png":a=
1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get k$h(){return this.LPd||this.aZb}YFj(a){const b=new ol;b.type=this.hrj(a.type);b.payload=a.data;b.H5c=!0;this.Gvh(b)}Sjh(a,b){this.Uc.Qpa.Jub();this.Ch.cba(0,!0,13);this.jd.v1a(!0);const c=this.jd.Cg.Lu.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.W2.YWk();this.Pf.Rd.pAa();this.ud.bva?this.cL.zLa(this.Ch.mode,this.Qb.Ui,this.Qb.Eg,this.Qb.$h,this.$k.value.isEditingAllowed||this.$k.value.xz):
this.W2.rNc();return b}ouh(a){this.jd.Cg.Lu.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.nKa&&!this.ae.Hw)if(this.z_||this.fvf){this.Fha.XR&&(this.Fha.XR=null);this.aNd=this.Mk.ke(3);this.nKa.ld(b);b=new ol;b.PRa=this.aCa.x5e();b.PRa.RKc("pasteHandler");b.H5c=!1;b.sPe=this.Sjh(this.QS.Oud,b.sPe);if(c=this.lk.Sda(a)){this.k$h&&this.YQk(c,b);for(let f=0;f<this.Oef.length&&this.Oef[f](a,c,b);++f);}this.yra&&a.preventDefault();w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");
!this.z_&&this.fvf?this.Gvh(b):this.Fvh(b)}else ha.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.gUf}),this.Ca.lue(C.a.z8),a.preventDefault()}Gvh(a){ha.ULS.sendTraceTag(24492118,307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.Fpa();this.r7.Vj(6,()=>{this.eYi(a)})}Fpa(){this.eo=this.gra();this.eo.Mr=!1;this.eo.Ad=5;this.eo.Fpa(null,null,null)}eYi(a){this.eo&&(this.eo.close(),this.eo=null);ha.ULS.sendTraceTag(24492119,
307,50,"Clipboard commands available. Dismissing progress dialog.");this.Fvh(a)}Fvh(a){a=this.MZh.create(null,Object(H.a)(this,this.gZi,"doPasteOperation"),a);a.$l("Browser Pasted (Editing Surface)");a.run()}vOj(a,b,c){if((this.Arf||this.TNd)&&(b=this.lk.lae(a.rawEvent))&&this.lk.cAd(this.jd.Gm())){let f=null;if(({V$b:f}=this.lk.zyd(b,this.sYh,this.QS.Mlc)).returnValue)return c.type=1,c.payload=f,this.TNd&&this.ud.tX&&a.preventDefault(),!1}return!0}hTk(a,b,c){return this.W6h&&this.lk.m4j(b)&&(a=this.lk.rde(b))?
(c.type=2,c.payload=a,!1):!0}jNj(a,b,c){return this.GPd&&(a=this.lk.c8b(b))?(c.type=3,c.payload=a,this.LPd&&c.style&&(c.payload+=c.style),!1):!0}gZi(a,b){var c=this.jd.Cg.Lu.style;b&&this.QS.Oud&&"hidden"===c.overflow&&this.ouh(b.sPe);if(c=this.jd.Gm()){if(this.ud.kva)for(var f=c.firstChild;f&&1===c.childNodes.length&&rf.a(f);)c=f,f=f.firstChild;if(b&&(this.Arf||this.TNd)&&1===b.type&&this.lk.cAd(c)&&(f=b.payload)){this.Brf=a;this.QS.j3b(f,l=>{this.IWf(this.Brf,l,b)});return}this.IWf(a,this.jd.irj(c),
b)}}Yxf(a){a=this.lQa.create(a,Object(H.a)(this,this.rKh,"teardownPaste"),null);a.$l("Aborting Paste in ContentEditableView");a.run()}IWf(a,b,c){this.ud.Yj&&(Ga.a.yv(this.jd.Gm()),this.ud.Ila||this.jd.Cg.Roa());if(this.yra&&!c)ha.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.Yxf(a);else{c.H5c&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.H5c;this.yra&&(f=!c.payload&&f);f?(ha.ULS.sendTraceTag(18437454,307,15,""),this.Yxf(a)):(c.style&&(b+=c.style),this.jd.v1a(!0),f=new J.DictionaryPropertySet,
f.setValue(we.a.aV,b),f.setValue(sb.a.wpe,!0),f.setValue(Ya.a.sO,!0),1===c.type&&this.QS.suc?f.setValue(we.a.z_c,b):2===c.type&&c.payload?f.setValue(we.a.Yib,c.payload):3===c.type&&c.payload&&(this.yra?f.setValue(we.a.aV,c.payload):f.setValue(we.a.fQe,c.payload)),this.aZb&&c.dTe&&f.setValue(we.a.whh,c.dTe),c.PRa&&f.setValue(we.a.PRa,c.PRa),a=this.lQa.create(a,Object(H.a)(this,this.uzi,"callPasteAction"),f),a.$l("Paste in ContentEditableView"),a.run())}}uzi(a,b){this.z_.z8(a,b,!0);a.gh(Object(H.a)(this,
this.rKh,"teardownPaste"));return!0}rKh(a){this.Ch.u2a();this.nKa&&(this.nKa.oV(a),this.nKa.dispose(),this.aNd=null);a.gh(Object(H.a)(this,this.YYd,"callPasteFloatie"));return!0}YYd(a,b){a=Object(sa.a)(J.DictionaryPropertySet,b);if(!a||a.sa(we.a.Yib,null)||a.sa(we.a.z_c,null))return!1;b=new Pj(1,w.AFrameworkApplication.isRtl);b.LRk=a.sa(we.a.aV,null);this.zca.hVe(b);return!1}YQk(a,b){if(a=this.lk.o0f(a)){w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");
if(this.aZb){let c=this.lk.p0f(a);null===c?c="inaccessible":""===c&&(c="unknown");b.dTe=c}this.LPd&&(b.style=this.lk.V4i(a))}}}Object(m.a)(mi,"PasteHandler",null,[1478]);class nk{constructor(a,b,c,f,l){this.Npf=new Kg.a(RegExp("\u00a0","g")," ");this.kwf=new Kg.a(new RegExp("["+zc.LGf+zc.dlg+"]","g"),"");this.qd=a;this.fg=b;this.gj=c;this.kp=f;this.ud=l}tDi(a,b,c,f,l){if(l){l=!1;for(let ja=0;ja<a.length;++ja){const za=b.Ffh[ja];if(!za)continue;const Va=a[ja];var y=Va.innerHTML,G=za.html;if(y.length===
G.length||y===G)continue;if(Mf.N2c(Va))continue;l=!0;y=Sys.UI.DomElement.containsCssClass(Va,da.a.xW);G=Sys.UI.DomElement.containsCssClass(Va,uc.a.JN);const hb=Sys.UI.DomElement.containsCssClass(Va,uc.a.$N);let Cb=!1,lc=!1;Va.parentNode&&Va.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Va.parentNode.parentNode,uc.a.o8d)&&(Cb=Va.parentNode.parentNode.firstChild===Va.parentNode,lc=Va.parentNode.parentNode.lastChild===Va.parentNode);var R=void 0;let ic;za.text?(R=Ga.a.Gv(Va),ic=za.text):
(R=this.kp.Wae(Va,this.qd,this.fg),ic=za.qKl);const yc=this.Npf.qKa(R).indexOf(this.Npf.qKa(ic));if(0<=yc){const ec=this.kwf.qKa(na.a.substring(R,0,yc));R=this.kwf.qKa(na.a.right(R,yc+ic.length));0<ec.length&&((hb||G||Cb)&&0<ja?(this.Qhd(a[ja-1],ec,!0,this.fg),this.kp.R1c(Va)&&(f-=zc.ZQc)):y&&ja!==a.length-1&&this.Qhd(a[ja+1],ec,!1,this.fg));0<R.length&&((G||lc||y)&&ja!==a.length-1?(this.Qhd(a[ja+1],R,!1,this.fg),this.kp.R1c(Va)&&(f+=zc.g5d)):hb&&0<ja&&this.Qhd(a[ja-1],R,!0,this.fg))}else hb&&(this.ud.Yj||
this.ud.Io)&&1===ic.length&&!R.length?ha.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):hb&&this.ud.mg||ha.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),y=ic?ic.length:0,G=R.length,G>y&&(f-=G-y);za.text?Ga.a.Rz(Va,za.text):(this.kp.f8j(Va)||za.U0d.restore(),za.U0d=new hd.a(Va))}l&&this.gj.GT(f,c)}}Qhd(a,b,c,f){f.n++;c?Ga.a.Rz(a,Ga.a.Gv(a)+b):Ga.a.Rz(a,b+Ga.a.Gv(a))}}Object(m.a)(nk,"ReadOnlyObjectsCleaner",null,[]);class ek{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,
lc,ic,yc,ec,jc,xd,Xd){this.Via=0;this.jd=a;this.tPd=b;this.LK=c;this.fg=f;this.qd=l;this.ODc=y;this.Uc=G;this.gj=R;this.kp=ja;this.ud=za;this.mf=Va;this.rf=hb;this.Pf=Cb;this.oj=lc;this.cPd=ic;this.nn=yc;this.Er=ec;this.c3h=jc;this.v0h=Xd}init(a){this.Via=a}alb(a,b,c,f,l){if(this.jd.isValid){var y=this.jd.Gm();y&&y.firstChild&&1!==w.AFrameworkApplication.Aa.state&&(this.tPd.s0f(this.Uc.Pa),this.p_e(a,b,c,f,l))}}zLa(a,b,c,f,l){if(this.LK.epe()&&(!this.oj||this.mf.ilh))if(this.LK.setFocus(a,b,c,f,l),
this.ud.qS){a="Window.getSelection";b=this.jd.Gm();if(this.ud.gU){if("none"===b.style.display){ha.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!Ga.a.NVa(this.jd.Cg.sAa,b)){ha.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var y=this.nn.getSelection(this.jd.contentWindow);y&&(a="Selection.removeAllRanges",this.nn.removeAllRanges(y),a="Selection.selectAllChildren",this.nn.Zkl(y,b))}catch(G){y=Ga.a.ncg(b),ha.ULS.sendTraceTag(18437461,
324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?Cd.a.O5d(b):"",G.stack,b?b.style.display:"",y?y.tagName+","+y.id+","+y.className:"")}}else this.nn.p_e(this.jd.Vta().Il)}p_e(a,b,c,f,l){const y=this.Uc.Pa.nb;try{if(this.LK.epe()&&(!this.oj||this.mf.ilh)){var G=y.Ua,R=y.jf,ja=this.cPd.create(this.Pf.Rd);this.zLa(a,b,c,f,l);a=null;var za=this.jd.Vta();if(this.ud.qS){a=this.nn.getSelection(this.jd.contentWindow);if(!a)return;if(this.nn.wsj(a)){var Va=this.nn.getRangeAt(a,
0);this.nn.removeAllRanges(a)}else Va=this.nn.createRange(za.Il)}else if(this.ud.bG)Va=za.selection.createRange();else return;this.c3h&&this.Sql(Va);(this.rf.tk(G)||this.rf.nm(G))&&this.x9i(G,Va);this.rf.tk(R)&&this.y9i(R,Va);this.ud.qS?this.nn.addRange(a,Va):this.ud.bG&&Va.select();ja.dispose()}}catch(hb){G=this.jd.Gm(),ha.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",hb.message,hb.stack,G?Cd.a.O5d(G):"")}}y9i(a,b){var c=a.node.qc(this.Via).Et;let f=0,l=0,y=0;
a=a.Lb;for(var G=!1;f<c.length;){const R=this.kp.gJ(c[f],this.fg,this.qd,this.oj);if(G)y+=R;else if(Sys.UI.DomElement.containsCssClass(c[f],uc.a.JN))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],da.a.xW)){if(a<=l+R)if(G=a-l,this.ud.qS){c=c[f];this.ODc.value.J2b(c,this.jd.contentWindow);this.kAh(b,c,G,!1);break}else y=R-G,G=!0;l+=R}f++}this.ud.bG&&this.nn.moveEnd(b,-y)}x9i(a,b){var c=a.node.qc(this.Via).Et;let f=0;var l=0;let y=0,G=a.Ra;for(this.rf.nm(a)&&(G=this.Er.textLength(a.node));f<c.length;)if(a=
this.kp.gJ(c[f],this.fg,this.qd,this.oj),Sys.UI.DomElement.containsCssClass(c[f],uc.a.JN))l++,f++,y+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],da.a.xW))f++,y+=a;else if(this.v0h&&Sys.UI.DomElement.containsCssClass(c[f],uc.a.m6d))f++,y+=a;else{if(G<=l+a){l=G-l;this.ud.qS?(c=c[f],this.ODc.value.J2b(c,this.jd.contentWindow),this.kAh(b,c,l,!0)):this.nn.moveStart(b,y+l);break}l+=a;y+=a;f++}}kAh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&ha.ULS.sendTraceTag(18437465,
324,50,"Span is not normalized"):ha.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,y=null;b=Ga.a.RUc(b,!0);for(let G of b)if(3===G.nodeType){b=G.nodeValue.length;if(c<=l+b){this.nn.mOb(a,f,G,c-l);return}y=G;l+=b}y?(ha.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.nn.mOb(a,f,y,c-l)):ha.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}ZUf(a,b,c,f,l,y,G){var R=this.Uc.Qpa;if(R.Xre||
R.fqe)return!1;var ja=this.jd.Gm();if(!ja.innerHTML.length)return!1;R=!1;if(this.ud.qS)(b=Cd.a.LEa(this.jd.contentWindow))&&(this.nn.kYc(b)===ja?R=!0:this.oj&&Cd.a.s5j(b)&&Cd.a.r5j(b)&&(R=!0));else if(this.ud.bG){var za=this.jd.Vta().selection.createRange();za=this.nn.Qlj(za.range);za=za.replace(na.a.SDc,"");ja=ja.innerHTML;ja=ja.replace(na.a.SDc,"");if(za===ja)switch(a){case 2:R=!0;break;case 1:1<b.length||!(this.rf.ou(b.nb.Ua)||this.rf.nm(b.nb.Ua)||this.rf.ou(b.nb.jf)||this.rf.nm(b.nb.jf))||(R=
!0)}}if(!R)return!1;this.fg.by++;this.oj&&c?c.qta():2===a?this.gj.GT(this.gj.FWa,f):1===a&&this.alb(a,l,y,f,G);return!0}Sql(a){a=Ga.a.RUc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=Ga.a.Lka(b),a.startsWith("OutlineElement")&&(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(m.a)(ek,"SelectContentHelper",null,[]);class bj{constructor(a,
b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){this.Lia=this.Hqa=this.Ye=null;this.Ch=a;this.gj=b;this.fg=Cb;this.Qb=c;this.xf=f;this.jd=l;this.ae=y;this.nn=G;this.kp=R;this.qd=hb;this.Uc=ja;this.oj=ic;this.cL=za;this.MV=Va;this.$k=lc;this.BS=yc}get l1a(){return this.Lia||(this.Lia=Fb.a.instance.rb("Box4.ISelectionCommands"))}mT(a){this.Ye=a}WIj(a,b){if(!a)return!1;var c=this.Ch.mode;if(2===c)if(!this.gj.BUj)this.fg.b++,this.gj.GT(this.gj.FWa,this.Qb.$h);else if(this.oj){if(500>(new Date).getTime()-this.xf.tKi)return this.Ye.zvb.xea=
!1;a=Cd.a.LEa(this.jd.contentWindow);if(!a)return!1;if(Cd.a.B3c(a)){b=this.gj.hVc(c,this.Qb.Ui);if(this.gj.FWa===b&&!this.Ye.zvb.xea)return this.Hqa&&(this.ae.Kg(this.Hqa),this.ae.Hb(this.Hqa)),!1;if(this.BS.bzd())return this.fg.c++,this.Ye.zvb.xea=!0,!1;if(this.Ye.zvb.xea)return this.fg.d++,this.xf.dba(!0),this.Ye.ht(!0),this.Ye.zvb.xea=!1;this.Hqa||this.Ye.ht(!0);yh.GrippersManager.instance.setVisibility(!1);this.ypl();return!1}if(this.cL.ZUf(c,ze.a.instance.Pa,this.l1a,this.Qb.$h,this.Qb.Ui,this.Qb.Eg,
this.$k.value.isEditingAllowed||this.$k.value.xz))return this.fg.e++,!1;c=this.kp.hde(this.nn.kYc(a),this.Qb.Ui,this.nn.Ddg(a),this.fg,this.qd,this.oj);a=this.kp.hde(this.nn.Ujj(a),this.Qb.Ui,this.nn.I8f(a),this.fg,this.qd,this.oj);if(0>c||a<c||zb.ParagraphReader.textLength(b.node)<a)return!1;this.fg.f++;this.Uc.setSelection(Vd.SelectionFactory.R3(b.node,c,a))}return!1}ypl(){this.Hqa?this.ae.Kg(this.Hqa):this.Hqa=new pd.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.ae.Hb(this.Hqa)}fixupAfterMagnifierDrag(){if(this.Hqa){this.Hqa=
null;var a=this.Ch.mode;2===a&&this.Qb.DWa(a)&&(this.fg.g++,this.gj.updateCaretPosition(a,this.Qb.Ui),this.xf.QLa(!0),this.MV.fixupAfterCursor(5),this.Ye.ht(!0),yh.GrippersManager.instance.EEh())}}}Object(m.a)(bj,"SelectionChangeHandler",null,[1477]);class Nk{constructor(a,b){this.jd=a;this.WYb=b}s0f(a){this.wEf(this.jd.Gm(),this.WYb+a.hs,z.a.Kti)}wEf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.$$k(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.wEf(a,
b,c))}$$k(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.WYb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else ha.ULS.sendTraceTag(18437474,324,50,"Class string for DOMElement is null")}}Object(m.a)(Nk,"SequenceCodeHelper",null,[1476]);class Qj{constructor(a,b,c,f){this.fg=f;this.gj=b;this.qd=c;this.Ma=a}UZk(a,b,c,f){if(a.Ni.length){var l=a.Ni[0].NF,y=Ga.a.Gv(l);if((a=a.cJc)&&y&&y.length===a.length+1&&y.endsWith(" ")){var G=Cd.a.hce(l);G&&((a=N.a.Be(l,da.a.GGa),
a=b.Et[a+1],a)?Cd.a.hce(a)!==G&&(c=this.gj.b9(c,f),f=Ga.a.Gv(a),this.qd.Yb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.fg.q++,Ga.a.Rz(l,y.substring(0,y.length-1)),Ga.a.Rz(a," "+f),this.gj.GT(c,b)):this.fg.p++)}}}DAi(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.Ma.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,uc.a.X9))for(let y=0;y<l.childNodes.length;y++)this.DKf(l.childNodes[y],
y,b,a,c)&&y--;else this.DKf(l,f,b,a,c)&&f--}}DKf(a,b,c,f,l){const y=a.parentNode;f=y===f;if(3===a.nodeType){let G=-1;const R=a.nodeValue;let ja=null,za="";if(b){const Va=y.childNodes[b-1];if(rf.a(Va)&&(!f||zb.ParagraphReader.fe(rf.a(Va).gb))){for(ja=Va;ja.lastChild&&1===ja.lastChild.nodeType;)ja=ja.lastChild;za=ja.innerText+R}}if(!ja&&b!==y.childNodes.length-1&&(b=y.childNodes[b+1],rf.a(b)&&(!f||zb.ParagraphReader.fe(rf.a(b).gb)))){for(ja=b;ja.firstChild&&1===ja.firstChild.nodeType;)ja=ja.firstChild;
za=R+ja.innerText}ja?(G=this.gj.b9(c,y),this.qd.Yb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.fg.r++,Ga.a.Rz(ja,za)):(this.qd.Yb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),this.fg.s++);y.removeChild(a);-1!==G&&this.gj.GT(G,l);return!0}return!1}Z9k(a,b,c,f){if(z.a.mg&&a.Ni.length){var l=Ga.a.Gv(a.Ni[0].NF),y=a.cJc;l&&y&&l.length===y.length+2?this.tqh(0,a,b,c,f):2===a.Ni.length&&this.tqh(1,a,b,c,f)}}tqh(a,b,c,f,l){c=this.gj.b9(c,f);if((f=Ga.a.Gv(b.Ni[a].NF))&&
f.endsWith("\u00a0 ")){this.fg.t++;var y=f.lastIndexOf("\u00a0 ");f=f.substr(0,y)+" ";b.Ni[a].NF.innerText=f;(0<a?c-(b.Ni[0].HLc+Ga.a.Gv(b.Ni[0].NF).length):c-b.Ni[0].HLc)>f.length&&c--;this.gj.GT(c,l)}}}Object(m.a)(Qj,"StrayTextCleanupUtils",null,[]);class Nf{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){this.$ha=null;this.iRd=a;this.xpb=b;this.pFd=c;this.qd=f;this.Kia=l;this.Ch=y;this.Uc=G;this.I7=R;this.ud=ja;this.xf=za;this.Zk=Va;this.zC=hb;this.lia=Cb;this.kt=lc;this.dW=ic;this.Vba=
yc;this.Qb=ec;this.pQa=jc;this.hd=xd}get Nda(){return this.$ha||(this.$ha=Fb.a.instance.rb("Box4.IFormatPainter"))}Smb(a,b){if(!b)return!1;if(this.iRd.FCh)return a.nc.preventDefault(),!0;if(this.xpb.i9a&&this.ud.bva)return this.xpb.i9a=!1,this.pFd.cancelEventAndRestoreEditingSurface(a.nc),!0;this.Nda&&this.Nda.TL&&(this.Nda.TL=!1);this.gEj(a.nc);b=this.qd.eq(C.a.typing);b.properties.$(Jf.a.source,"TextInput");a=this.YJl(a);b.end();return a}YJl(a){this.Kia.fixupAfterMagnifierDrag();if(1===this.Ch.mode){if(this.dW.Y2e())this.Uc.setSelection(Vd.SelectionFactory.Qg(ze.a.instance.Pa.nb.Ua.node,
ze.a.instance.Pa.nb.Ua.Ra));else if(this.I7.t3e()){if(this.dW.xPe(a))return!1;this.I7.startHybridTransition()}this.ud.cD&&this.dW.uXd()}this.Vba.raiseEvent(pg.a.ZJl,a);this.xf.dba(!0);this.Zk.L7e=!0;this.zC.MQa(a);this.pQa&&this.pQa.n2l(this.Qb.$h);this.lia.kIb();this.kt.sZ();return!1}gEj(a){this.ud.mg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Zk.l4d=!this.Zk.C3,this.Zk.l4d&&w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=Nf.sZd.hVc(2,this.Qb.Ui),
a<Nf.sZd.FWa&&(a=Vd.SelectionFactory.R3(this.Qb.Eg,a,Nf.sZd.FWa),w.AFrameworkApplication.Qa.Ja(C.a.CSa,2,a))))}static get sZd(){return Nf.gj||(Nf.gj=Fb.a.instance.resolve("Box4.ICaretPositionManager"))}}Nf.gj=null;Nf.BS=null;Nf.sI=null;Object(m.a)(Nf,"TextInputEventProcessor",null,[]);class Bg{constructor(a,b,c,f,l,y){this.LK=a;this.ud=b;this.mf=c;this.Zk=f;this.$k=l;this.hd=y}get adb(){return this.hd.gg&&this.hd.nz}get FCh(){if(this.LK.bac||!this.$k.value.isEditingAllowed&&this.$k.value.xz&&!this.adb)return!0;
if(this.ud.M9){var a=this.mf.tak;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Zk.Jse;if(500>a&&a<b)return!0}}return!1}}Object(m.a)(Bg,"TextInputHandlerUtils",null,[]);var Xk=d(527),Ni=d(310);class nh{constructor(a,b,c,f){this.Oqa=null;this.ud=a;this.LK=b;this.Pf=c;this.rf=f}onContextMenu(a,b){let c=!1;this.ud.M9&&this.LK.H2c&&(b=this.rf.Lvb(this.Pf.Rd,b,this.Pf.Rd.Kka(a),!1),this.rf.Ex(b)&&(c=!0));c?(this.Oqa=a.clientPoint,a=!0):(this.Oqa=null,a=this.Pf.Rd.onContextMenu(a));return a}Xnc(a){if(this.ud.M9&&
this.Oqa){const b=Ni.a.K8e;if(a.clientPoint.x>this.Oqa.x+b||a.clientPoint.x<this.Oqa.x-b||a.clientPoint.y>this.Oqa.y+b||a.clientPoint.y<this.Oqa.y-b)this.Oqa=null}return!1}AJb(a){let b=!1;this.ud.M9&&this.Oqa&&(b=this.Pf.Rd.onContextMenu(a),this.Oqa=null);return b}}Object(m.a)(nh,"TouchEventProcessor",null,[]);class ni{create(a){return new mh(a)}}Object(m.a)(ni,"TypingActionOperationFactory",null,[1473]);var ye=d(73),Dg=d(250);class Fj{constructor(a,b,c,f,l,y){this.Iwf=0;this.onf=ia.a.nil;this.cWb=
this.NCc=!1;this.gmf=4===Sc.App.mode;this.oFc=!1;this.ybi=new Pb.a;this.ybi.add(0,C.a.fYe);this.hIc=new Pb.a;this.hIc.add(0,0);this.Xnf=a;this.Vob=b;this.Pf=c;this.Ro=f;this.zbi=l;this.vDd=y;this.Zmf=Object(H.a)(this,this.Vel,"reportTypingCharCount");w.AFrameworkApplication.$ga(()=>{this.phk()});this.vDd&&this.a8k();this.$7k();w.AFrameworkApplication.Qa&&w.AFrameworkApplication.Qa.ra(C.a.fYe,ye.a.frame,zf.ActionManager.Sg,96)}a8k(){this.Ro&&this.Ro.addHandler(kc.a.Ay,this.Zmf)}$7k(){this.Vob&&this.Vob.OAf(Object(H.a)(this,
this.sKc,"afterEditingViewValidateEventHandler"))}bsc(a){this.Xnf.value&&0===this.Xnf.value.mode||(a=new mh(a),a.end(8),Fi.a.getInstance().krc(a),Mi.a.getInstance().jrc(a))}V$g(a,b){if(!this.gmf&&Sc.App.Mb&&2===Sc.App.Mb.mode&&b&&b.graphNode&&zb.ParagraphReader.fe(b.graphNode)&&!Ee.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.onf){if(this.oFc){var c;(c=this.hIc).$(0,c.ga(0)+1);w.AFrameworkApplication.Qa.processAction(C.a.fYe,2);c="Paragraph rendering is blocked";this.zbi&&(c+=", so graph transaction manager is reset",
Dg.GraphTransactionManager.instance.X1e());ha.ULS.sendTraceTag(38547550,323,15,c)}this.onf=a;this.oFc=!0}}else this.oFc=!1}sKc(a,b){this.gmf||!b.nN&&!b.mV||(!this.NCc&&this.Pf.Rd&&(this.Pf.Rd.$ii(Object(H.a)(this,this.V$g,"onContentEditableViewClick")),this.NCc=!0),this.oFc=!1)}Vel(){this.Iwf++}AXl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),ha.ULS.sendTraceTag(18437207,323,15,a))}phk(){this.cWb||(this.vDd&&(ha.ULS.sendTraceTag(38114780,323,50,
""+this.Iwf),this.HYi(),this.vDd=!1),0<this.hIc.ga(0)&&ha.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.hIc.ga(0)),this.GYi(),this.cWb=!0)}HYi(){this.Ro&&this.Ro.removeHandler(kc.a.Ay,this.Zmf)}GYi(){this.Vob&&this.Vob.mbl(Object(H.a)(this,this.sKc,"afterEditingViewValidateEventHandler"));this.NCc&&this.Pf.Rd&&(this.Pf.Rd.qbl(Object(H.a)(this,this.V$g,"onContentEditableViewClick")),this.NCc=!1)}}Object(m.a)(Fj,"TypingLogger",null,[1436]);const Gj=a=>{w.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&
(a.execute(b=>{b.Vdc("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};class xj{constructor(a){this.I1c=!1;this.k9a=5;this.N7g=!1;this.jLe=!0;this.nb=a}}Object(m.a)(xj,"TypingProcessState",null,[]);class Rj{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og){this.Sia=this.Ye=null;this.znb=!1;this.Tyd=null;this.Z4c=0;this.bVb=a;this.Qb=b;this.HHd=c;this.gj=f;this.T5a=l;this.Ro=
y;this.ADc=G;this.TZ=R;this.MV=ja;this.xf=za;this.Uqa=Va;this.Uc=hb;this.PK=Cb;this.lia=lc;this.qd=ic;this.fg=yc;this.sI=ec;this.ae=jc;this.Zk=xd;this.Jh=Xd;this.SD=Qd;this.bra=Ie;this.Fha=Pe;this.ud=ig;this.iia=ff;this.Mk=bh;this.kt=ch;this.o8h=of;this.yQd=sg;this.ar=Fg;this.hd=og;this.$mf=0;this.xif=!1;this.aTj()}mT(a){this.Ye=a}get A2a(){return this.Sia||(this.Sia=Fb.a.instance.rb("Box4.ITextFormattingCommands"))}XPl(){lf.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.hd.Vtb();
try{this.Z4c=0;if(this.Ye.rPk.ePl()||2!==this.xf.mode||!this.xf.isActive||w.AFrameworkApplication.Yg||!this.Qb.Eg||this.HHd.correctBadImeState())return;this.gj.updateCaretPosition(this.xf.mode,this.Qb.Ui);this.T5a.oaf();this.FDi();this.Ro.raiseEvent(kc.a.typingProcess);if(!this.Qb.nSa||(2==Sc.App.mode||Rd.a("SkipTypingProcessorDuringComposition"))&&this.ar.isComposing)return;const b=new xj(this.TZ.Uta(this.MV.V9));if(this.ADc.HYk(b))return;b.I1c||(this.xf.dba(!0),b.N7g=!0);this.NYk(b);if(!this.Qb.DWa(this.xf.mode))return;
const c=this.Qb.QW.gb;this.hd.gg&&(c.oIb=this.Uc.Pa.nb.Ua.Ra);b.N7g&&M.a.instance.ga(50)&&this.Uqa.value&&this.Uqa.value.Ew&&this.Uc.t_b();if(b.jLe){try{this.lia.kIb()}catch(f){this.qd.Yb("PossibleEditSurfaceIncorrectSize",{["Reason"]:"MirrorToPageViewCrash"}),this.fg.l++,this.sI.ht(!1,!1)}this.kt.sZ();this.ar.sGa&&(this.sI.ht(!0,!0),this.VBi())}}finally{a&&a.dispose()}lf.c(18437510,306,100,"TypingProcessInternalExited")}VBi(){Sc.App.Mb.LLj&&Sc.App.Mb.ril()}MQa(a){this.ADc.Ojh(a);this.znb||(this.znb=
!0,this.ae.Hb(this.Tyd))}tVi(){if(!this.Zk.C3&&!this.Zk.Wsa)return!1;const a=!this.Uqa.value||this.Uqa.value.amIAlone?Rj.mCj:Rj.lCj,b=this.bVb();-1===this.Zk.t5c&&(this.Zk.t5c=b);return b-this.Zk.t5c<a?(this.ae.Hb(this.Tyd),this.znb=!0):!1}typingProcess(){if(this.znb&&(this.znb=!1,this.$mf++,!this.ae.Hw&&this.Qb.DWa(this.xf.mode)&&!(this.PK&&this.PK.Dbb()||this.tVi()))){var a=this.qd.eq(C.a.typingProcess);this.XPl();a.end();this.xif||this.$mf!==Rj.wBi||((a=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&
Gj(a),this.xif=!0)}}FDi(){if(this.ar.sGa){if(this.Jh.vyf())if((this.ud.eG||this.ud.Io)&&this.SD.V7){const a=this.gj.b9(this.xf.mode,this.Qb.Ui);this.SD.xlb(!1,this.Qb.Ui,this.Jh);this.gj.GT(a,this.Qb.$h)}else this.SD.xlb(!1,this.Qb.Ui,this.Jh);this.o8h.tDi(this.Qb.$h.Et,this.bra,this.Qb.$h,this.gj.b9(this.xf.mode,this.Qb.Ui),this.ar.sGa);this.yQd.DAi(this.Qb.Ui,this.xf.mode,this.Qb.$h);this.yQd.UZk(this.Jh,this.Qb.$h,this.xf.mode,this.Qb.Ui);this.Jh.d$k();this.yQd.Z9k(this.Jh,this.xf.mode,this.Qb.Ui,
this.Qb.$h)}}NYk(a){this.Fha.XR?(this.Fha.xSk(),a.jLe=!1):this.iia.instance&&this.iia.instance.whe()&&!this.ud.WPb&&(this.ar.sGa&&this.A2a?(this.Qoi(a.nb),a.jLe=!1):this.iia.instance.R0a())}Qoi(a){if(this.A2a&&this.iia.instance){this.iia.instance.freeze();var b=ze.a.instance.Pa.nb,c=this.Mk.ke(15);c.ld(this.Qb.Eg.node);a=Vd.SelectionFactory.aO(a,b.Ua);this.A2a.aOb(a.Ua,!0);this.iia.instance.X7e();this.iia.instance.R0a();this.Qb.$h&&this.Uc.setSelection(this.TZ.Uta(this.MV.V9));c.dispose();this.xf.dba(!0);
this.sI.ht(!0,!1)}}aTj(){let a=1;z.a.Io&&(a=w.AFrameworkApplication.fa.uc("Box4TypingTaskTimeEdge",1));this.Tyd=new pd.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.Tyd=null}zDh(a){return this.ud.M9&&a?this.Fha.XR||this.Z4c>Rj.gzk||this.iia.instance&&this.iia.instance.whe()||this.SD.V7?!0:!1:!1}}Rj.gzk=7;Rj.lCj=250;Rj.mCj=2E3;Rj.wBi=500;Object(m.a)(Rj,"TypingProcessManager",null,[1472,108]);class Bl{constructor(){this.Oa=new Wc.a}h1k(a){this.Oa.raiseEvent("OnDismissPasteFloatie",a)}n1k(){this.Oa.raiseEvent("OnExpandMenuPasteFloatie")}SLb(a){this.Oa.raiseEvent("OnPastedContentUpdated",
a)}hVe(a){this.Oa.raiseEvent("OnShowPasteFloatie",a)}Nji(a){this.Oa.addHandler("OnPastedContentUpdated",a)}nji(a){this.Oa.addHandler("OnDismissPasteFloatie",a)}tji(a){this.Oa.addHandler("OnExpandMenuPasteFloatie",a)}iki(a){this.Oa.addHandler("OnShowPasteFloatie",a)}}Object(m.a)(Bl,"PasteFloatieEventSource",null,[1469,1470,1471]);var Cl=d(894),Th=d(132),hi=d(325),Yk=d(410),cj=d(229),Am=d(848);class Pl{constructor(){this.Ea=null}get name(){return"Box4.ContentEditableView"}Xb(a){this.Ea=a;a.register(Xk.a,
"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").na().oa(()=>new Xk.a);a.register(Ae,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").na().oa(()=>new Ae);a.register(Xi,"Box4.EventFrequencyTracker").na().oa(()=>new Xi);a.register(Ye,"Box4.CevUsageDataTracker").na().oa(()=>new Ye);a.register(Pa,"Box4.ContentEditableViewEventSource").na().oa(()=>new Pa);a.register(Dj,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").na().oa(()=>new Dj(cc.a.instance,
le.a.instance.cae(),a.resolve("Box4.TextNodeCombiner")));a.register(Re,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").na().oa(()=>new Re(cc.a.instance,le.a.instance.cae(),Mf.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(cg,"Box4.EditingDomManager").as("Box4.IEditingDomManager").na().oa(()=>new cg);a.register(mc,"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").na().oa(()=>new mc(a.resolve("Box4.IEditingDomManager")));a.register(zh,
"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").na().oa(()=>new zh(a.resolve("Box4.EditStateEventManager"),cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1436,"Box4.ITypingLogger").na().oa(()=>new Fj(a.ue("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),ra.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),
a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(Nc,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").na().oa(()=>new Nc(a.ue("Box4.ITextNodeCombiner"),cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.EditingDomManager"),Mf.instance,wc.a.instance,ra.InteractiveViewManager.instance,w.AFrameworkApplication.De,wc.a.instance.Yi,Cl.a.instance,a.resolve("Common.IScrollLockFactory"),
a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(Lg,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").na().oa(()=>new Lg(a.resolve("Box4.EditingDomManager"),ra.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),wc.a.instance.Yi,Ad.a.instance,wc.a.instance,t.FocusManager.instance()));a.register(nk,"Box4.ReadOnlyObjectsCleaner").na().oa(()=>new nk(cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,
a.resolve("Box4.CaretPositionManager"),Mf.instance,wc.a.instance));a.register(Qj,"Box4.StrayTextCleanupUtils").na().oa(()=>new Qj(w.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI));a.register(1437,"Box4.IContentEditableViewContentControlHelper").na().oa(()=>new Kh(cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,wc.a.instance.Yi,Mf.instance,ra.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(gf,
"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").na().oa(()=>new gf(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").QI,cc.a.instance,a.rb("Box4.IHyperlinkEditor"),wc.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),Cl.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),
a.resolve("Common.IAppSettingsManager")));a.register(Zc,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").na().oa(()=>new Zc(a.Ia("Common.ITypingSpeedMeterProvider"),ra.InteractiveViewManager.instance));a.register(Sh,"Box4.ContentEditableViewTypingState").na().oa(()=>new Sh(w.AFrameworkApplication.Qa));a.register(vf,"Box4.ContentEditableHtmlStructureUtils").na().oa(()=>new vf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(Nk,"Box4.SequenceCodeHelper").na().oa(()=>
new Nk(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").fyh));a.register(ek,"Box4.SelectContentHelper").na().oa(()=>new ek(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").QI,cc.a.instance,a.ue("Box4.ITextNodeCombiner"),ze.a.instance,a.resolve("Box4.ICaretPositionManager"),Mf.instance,wc.a.instance,Md.EventHandlerManager.instance,hi.a.instance,ra.InteractiveViewManager.instance,
wc.a.instance.Yi,a.resolve("Common.ScrollLockFactory"),Cl.a.instance,a.resolve("Box4.IParagraphReader"),Bb.ListReader.Gx,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(ue,"Box4.EditingDomDisplayManipulator").na().oa(()=>new ue(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),
w.AFrameworkApplication.fa,ra.InteractiveViewManager.instance));a.register(Rc,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").na().oa(()=>new Rc(a.resolve("Box4.ContentEditableViewEventSource")));a.register(gb,"Box4.InteractiveViewSynchronizer").na().oa(()=>new gb(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").QI,cc.a.instance,wc.a.instance.Yi,a.resolve("Box4.Graph.IGraphIteratorFactory"),Mf.instance,ra.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),
a.resolve("Box4.ICevViewContentManager")));a.register(jj,"Box4.CurrentEditSelectionProvider").na().oa(()=>new jj(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").QI,cc.a.instance,Mf.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),wc.a.instance.Yi,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Td,"Box4.BackspaceInBrowserHandler").na().oa(()=>new Td(a.resolve("Box4.CurrentEditSelectionProvider"),wc.a.instance.Yi,
Mh.a.instance,hi.a.instance,a.resolve("Box4.IExternalSelectionManager"),cj.a.instance,w.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),w.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ia("Box4.IAutoCorrectScheduler"):null));a.register(ml,"Box4.OvertypeDomPreparer").na().oa(()=>new ml(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),
ze.a.instance,cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,Mf.instance,wc.a.instance.Yi,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Ah,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").na().oa(()=>new Ah(hi.a.instance,ze.a.instance,cc.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),ra.InteractiveViewManager.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),wc.a.instance,
a.resolve("Box4.SelectContentHelper"),new vb.a(()=>Sc.App.Mb.Ld),a.Ia("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),w.AFrameworkApplication.fa,w.AFrameworkApplication.Qa,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Bl,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").na().oa(()=>
new Bl);a.register(jg,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").na().oa(()=>new jg);a.register(Wh,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").na().oa(()=>new Wh(a.Ia("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ia("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),wc.a.instance,ra.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.IRotatingCoordinateConverter")));a.register(Wi,"Box4.EditingSurfaceStateManager").na().oa(()=>new Wi);a.register(Hh,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").na().oa(()=>new Hh(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),w.AFrameworkApplication.De,a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new vb.a(()=>Sc.App.Mb.Ld),wc.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),ze.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),ra.InteractiveViewManager.instance,hi.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(nl,"Box4.ParagraphOverlayPositioner").na().oa(()=>
new nl(a.resolve("Box4.IEditingDomManager"),new Am.a,ra.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register($h,"Box4.ContentEditableViewDebugLogger").na().oa(()=>new $h);a.register(Ua,"Box4.ImeRecoveryUtils").na().oa(()=>new Ua(wc.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.ContentEditableViewDebugLogger"),Cl.a.instance));a.register(ud,"Box4.AutocorrectActionExecutor").na().oa(()=>new ud(a.Ia("Box4.IAutoCorrectScheduler"),a.Ia("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),
a.ue("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),ze.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(mi,"Box4.PasteHandler").as("Box4.IPasteHandler").na().oa(()=>new mi(a.resolve("Common.IAppSettingsManager"),w.AFrameworkApplication.De,cc.a.instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),ze.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),ra.InteractiveViewManager.instance,wc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new vb.a(()=>Sc.App.Mb.Ld),a.Ia("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),
a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),w.AFrameworkApplication.Qa,Sd.a.get_instance(),()=>new Le.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),Sc.App.instance.Ebc,Sc.App.instance.QOb));a.register(Vi,"Box4.ContentEditableViewCursorManager").na().oa(()=>new Vi(ra.InteractiveViewManager.instance,cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,wc.a.instance.Yi,ze.a.instance,
hi.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new vb.a(()=>Sc.App.Mb.Ld),w.AFrameworkApplication.Qa,a.resolve("Box4.IEditViewStateManager"),w.AFrameworkApplication.De,wc.a.instance,a.resolve("Box4.ICaretPositionManager"),Mf.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),
new fe,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.rb("Box4.CharacterPointConverter")));a.register(bj,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").na().oa(()=>new bj(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),w.AFrameworkApplication.De,Cl.a.instance,Mf.instance,ze.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.ContentEditableViewCursorManager"),cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,new vb.a(()=>Sc.App.Mb.Ld),wc.a.instance.Yi,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(ai,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").na().oa(()=>new ai(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.ue("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),ra.InteractiveViewManager.instance,w.AFrameworkApplication.De,new vb.a(()=>Sc.App.Mb.Ld),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),ze.a.instance,Mh.a.instance));a.register(bd,"Box4.CompositionStateManager").na().oa(()=>
new bd(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(Aa,"Box4.ImeManager").na().oa(()=>new Aa(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),ra.InteractiveViewManager.instance));a.register(Li,"Box4.DragStateManager").na().oa(()=>new Li(wc.a.instance));a.register(nh,"Box4.TouchEventProcessor").na().oa(()=>
new nh(wc.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),ra.InteractiveViewManager.instance,hi.a.instance));a.register(Ab,"Box4.AppFrameResizeEventProcessor").na().oa(()=>new Ab(a.resolve("Box4.BoundsSynchronizer")));a.register($c,"Box4.OnScrollProcessor").na().oa(()=>new $c(a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(Oh,"Box4.EditingSurfaceEventHandlerUtils").na().oa(()=>
new Oh(cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.IEditingModeTransitionManager")));a.register(Ej,"Box4.DragEventsProcessor").na().oa(()=>new Ej(wc.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(rg,"Box4.DoubleClickProcessor").na().oa(()=>new rg(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),ra.InteractiveViewManager.instance));a.register(hf,
"Box4.DomChangeEventProcessor").na().oa(()=>new hf(wc.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),cc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),w.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Bg,"Box4.TextInputHandlerUtils").na().oa(()=>new Bg(a.resolve("Box4.IContentEditableViewFocusHelper"),wc.a.instance,Md.EventHandlerManager.instance,
a.resolve("Box4.ContentEditableViewTypingState"),new vb.a(()=>Sc.App.Mb.Ld),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Zj,"Box4.ContentEditableViewGraphUpdater").na().oa(()=>new Zj(Vf.a.instance,a.resolve("Box4.EditingModeTransitionManager"),cc.a.instance,ze.a.instance,a.resolve("Box4.IExternalSelectionManager"),hi.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.HybridTransitionManager"),w.AFrameworkApplication.De,wc.a.instance,a.Ia("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.rb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(Qa,"Box4.KeyEntryProcessor").na().oa(()=>
new Qa(Mf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").QI,cc.a.instance,wc.a.instance.Yi,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),hi.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.EditViewStateManager")));a.register(ne,"Box4.KeyQueueProcessor").na().oa(()=>new ne(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),hi.a.instance,ze.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(Rj,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").na().oa(()=>new Rj(Cd.a.zj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new vb.a(()=>Sc.App.Oh),ze.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.ContentEditableViewGraphUpdater"),
w.AFrameworkApplication.De,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),wc.a.instance,a.Ia("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Yi,"Box4.OvertypeUtils").na().oa(()=>new Yi(new sd(w.AFrameworkApplication.De),a.resolve("Box4.EditingModeTransitionManager"),wc.a.instance,ze.a.instance,a.resolve("Box4.ITypingLogger"),hi.a.instance,new vb.a(()=>Sc.App.Mb.Ld),ra.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),wc.a.instance.Yi,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(dk,"Box4.ContentEditableViewFloatieHandler").na().oa(()=>new dk);a.register(bf,"Box4.KeyUpProcessor").na().oa(()=>new bf(cc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new vb.a(()=>Sc.App.Mb.Ld),
a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(Uc,"Box4.KeyPressProcessor").na().oa(()=>new Uc(wc.a.instance,Cl.a.instance,cc.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new vb.a(()=>
Sc.App.Mb.Ld),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),ze.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),Mf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new vb.a(()=>
Sc.App.Oh),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ia("Common.ITypingSpeedMeterProvider"),b,Th.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.rb("Common.IEventTimingMeter")));a.register(Da,"Box4.KeyDownProcessor").na().oa(()=>new Da(a.Ia("Common.ITypingSpeedMeterProvider"),wc.a.instance.Yi,w.AFrameworkApplication.De,
a.resolve("Box4.IEditingDomManager"),cc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),wc.a.instance,Cl.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),hi.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new vb.a(()=>
Sc.App.Oh),ze.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.ue("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new vb.a(()=>Sc.App.Mb.Ld),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),w.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),w.AFrameworkApplication.Qa,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.rb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),Yk.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),w.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.Ia("Box4.IAutoCorrectScheduler"):null,w.AFrameworkApplication.fa,a.rb("Box4.IHyperlinkEditor")));a.register(ij,"Box4.ContentEditableViewOnAfterValidateHandler").na().oa(()=>new ij(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),ra.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),
a.resolve("Box4.IContentEditableViewPaddingManager"),wc.a.instance,a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.ue("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),ze.a.instance,wc.a.instance.Yi,a.resolve("Box4.SelectContentHelper"),new vb.a(()=>Sc.App.Mb.Ld),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.rb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.rb("Box4.IFeatureHelper"),w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")));a.register(Rf,"Box4.ContentEditableViewOnBeforeValidateHandler").na().oa(()=>new Rf(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));a.register(gd,"Box4.CompositionEventProcessor").na().oa(()=>new gd(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),cc.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),
a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),w.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(Nf,"Box4.TextInputEventProcessor").na().oa(()=>new Nf(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),cc.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),
ze.a.instance,a.resolve("Box4.HybridTransitionManager"),wc.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),a.rb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(vd,
"Box4.LostFocusEventProcessor").na().oa(()=>new vd(a.resolve("Box4.ContentEditableViewGraphUpdater")));a.register(li,"Box4.EditingSurfaceEventHandlerManager").na().oa(()=>new li(w.AFrameworkApplication.De,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),
a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));
a.register(fg,"Box4.ContentEditableViewDisposer").na().oa(()=>new fg(a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").QI,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(ni,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").na().oa(()=>new ni);a.register(1438,
"Box4.IContentEditableModeHelper").na().oa(()=>new eg);a.register(Og,"Box4.ContentEditableView").as("Box4.IEditingView").na().oa(()=>new Og(ra.InteractiveViewManager.instance,ze.a.instance,new vb.a(()=>Sc.App.Mb.Ld),a.Ia("Common.IActivityAggregationInfo"),a.Ia("Common.IZoomManager"),w.AFrameworkApplication.Qa,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),Sc.App.PMa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Ea.resolve("Box4.EditingModeTransitionManager").a1b(this.Ea.resolve("Box4.ContentEditableView"));
this.Ea.resolve("Box4.BoundsSynchronizer").a1b(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ImeRecoveryUtils").a1b(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.AutocorrectActionExecutor").mT(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewCursorManager").Esi(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.SelectionChangeHandler").mT(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.HybridTransitionManager").mT(this.Ea.resolve("Box4.ContentEditableView"));
this.Ea.resolve("Box4.ContentEditableViewGraphUpdater").mT(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.TypingProcessManager").mT(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewOnAfterValidateHandler").mT(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").mT(this.Ea.resolve("Box4.ContentEditableView"));this.Ea.resolve("Box4.EditingSurfaceEventHandlerManager").mT(this.Ea.resolve("Box4.ContentEditableView"));
this.Ea.resolve("Box4.CompositionEventProcessor").mT(this.Ea.resolve("Box4.ContentEditableView"))}dispose(){}static main(){n.a.instance.Ac(new Pl)}}Object(m.a)(Pl,"ContentEditableViewPackage",null,[2,3]);class Dl{get name(){return"PowerPointWebEditor.AutoFit"}Xb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new Dl)}}Object(m.a)(Dl,"PPTWebEditorAutoFitPackage",null,[2,3]);var ii=d(134),oh=d(103),ok=d(171),ya=d(28),qd=d(33),ea=d(30);class Ok{constructor(a,b,c,f){this.la=a;this.Ya=c;this.Qr=f;
this.ia=b}D_f(a,b){return Object(ii.a)(this,void 0,void 0,function*(){try{let c;try{c=JSON.parse(a)}catch(y){return ya.a.J(508850828,817,10,"CopilotProxy::executeJOfcCommand failure to parse jsonPayload error: {0}, commandName: {1}",y,b),!1}const f=JSON.stringify([{data:c,name:b,version:"1.0.0"}]),l=JSON.parse(yield new Promise(y=>{const G={};G.promiseToResolve=y;G.requestBody=f;this.ia.Ja(ea.a.V9a,2,G)}));this.ia.Ja(ea.a.V9a,2,{promiseToResolve:void 0,requestBody:""});return l.FSuccess}catch(c){return ya.a.J(508850827,
817,10,"CopilotProxy::executeJOfcCommand error: {0}, commandName: {1}",c,b),!1}})}applyJOfcCommands(a,b,c){return Object(ii.a)(this,void 0,void 0,function*(){try{qd.a("PptApplyJOfcCommandsUseOptions")&&(a=Sys.Serialization.JavaScriptSerializer.serialize({jOfcCommandsPayload:a,designerOptions:b,appId:c}));let f=yield new Promise(l=>{const y={};y.promiseToResolve=l;y.requestBody=a;w.AFrameworkApplication.Qa.Ja(ea.a.V9a,2,y)});w.AFrameworkApplication.Qa.Ja(ea.a.V9a,2,{promiseToResolve:null,requestBody:""});
return f}catch(f){return ya.a.J(508850826,817,10,"CopilotProxy::executeJOfcCommand error: {0}",f),'{"FSuccess":false,"JOfcCommandStatusCode":4}'}})}b5f(a){return Object(ii.a)(this,void 0,void 0,function*(){try{a.RequestOptions.CorrelationId||(a.RequestOptions.CorrelationId=oh.a.create().toString());ya.a.J(509214920,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:a.RequestOptions.CorrelationId,ClientName:a.RequestOptions.ClientName,MergeAction:a.RequestOptions.MergeAction,
InsertPosition:a.RequestOptions.InsertPosition})}`);const b=yield this.m$d(a.OutlineInput,a.RequestOptions);return yield this.lKe(b,a.RequestOptions)}catch(b){return ya.a.J(509214918,817,10,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Error:b,Correlation:a.RequestOptions.CorrelationId,ClientName:a.RequestOptions.ClientName,MergeAction:a.RequestOptions.MergeAction,InsertPosition:a.RequestOptions.InsertPosition})}`),!1}})}m$d(a,b){return Object(ii.a)(this,void 0,void 0,function*(){b.CorrelationId||
(b.CorrelationId=oh.a.create().toString());ya.a.J(509214917,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`);let c=`${this.la.Ha("CreatorServiceBase")}?action=OutlineToPPT`;c=this.o4f(c);const f={};f.PodSID=this.Ya.podSessionId;f.Client=b.ClientName;Object(qd.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===b.MergeAction?"Create":"Insert");f["X-CorrelationId"]=
b.CorrelationId;f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;try{const l=yield this.send({pva:"generatePPTFromOutline",url:c,payload:JSON.stringify(a),headers:f});return JSON.parse(l)}catch(l){ya.a.J(509214916,817,10,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Exception:l,Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`)}})}lKe(a,b){return Object(ii.a)(this,void 0,void 0,function*(){b.CorrelationId||(b.CorrelationId=
oh.a.create().toString());if(!a||!a.DownloadablePPTInfos||0==a.DownloadablePPTInfos.length)return ya.a.J(509214919,817,10,`CopilotProxy::generatePPTFromOutline: generatePPTFromOutline returned invalid response ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`),!1;ya.a.J(509118050,817,15,`CopilotProxy::generatePPTFromOutline: ${JSON.stringify({Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,
InsertPosition:b.InsertPosition})}`);const c=a.DownloadablePPTInfos[0].DownloadUrl;if(!c)return ya.a.J(509163081,817,10,`CopilotProxy::generatePPTFromOutline: generatePPTFromOutline failed; ${JSON.stringify({ErrorCode:a.DownloadablePPTInfos[0].ErrorCode,Correlation:b.CorrelationId,ClientName:b.ClientName,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition})}`),!1;const f={};f.PodSID=this.Ya.podSessionId;f.Client=b.ClientName;Object(qd.a)("PptCreatorAddScenarioInHeader")&&(f.Scenario="ReplaceAll"===
b.MergeAction?"Create":"Insert");f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;f["X-CorrelationId"]=b.CorrelationId;let l=`${this.la.Ha("MergeSlidesFromUrlEndpoint")}`;l=this.o4f(l);return(yield this.send({pva:"mergeGeneratedSlides",url:l,payload:JSON.stringify({DownloadUrl:c,MergeAction:b.MergeAction,InsertPosition:b.InsertPosition}),headers:f})).includes("Error")?!1:!0})}o4f(a){if(!this.la.ka("StoryTellerForwardWdQueryParams"))return a;const b=new URLSearchParams(window.location.search.toLowerCase()),
c=this.la.Ha("StoryTellerWdQueryParamsToForward").toLowerCase().split(",");for(const [f,l]of b.entries())-1<c.indexOf(f)&&(a+="&"+f+"="+encodeURIComponent(l));return a}send(a){return new Promise((b,c)=>{const f=new Date;this.Qr.qj(a.url,2,a.payload,a.headers,!1,0,l=>{var y;ya.a.J(509214915,817,15,`CopilotProxy::${a.pva}: Time Taken ${+new Date-+f}`);l.data.Oe!==ok.a.mx&&(ya.a.J(509214914,817,10,`CopilotProxy::${a.pva}: Bad Http Status ${l.data.Oe}`),c(`Error - Bad Http Status ${l.data.Oe}`));ya.a.J(509214913,
817,15,`CopilotProxy::${a.pva}: call successful`);b(null!==(y=l.data.Wd)&&void 0!==y?y:"")},l=>{var y,G;const R=new Date;ya.a.J(509214912,817,10,`CopilotProxy::${a.pva}: request failed Status: ${null===(y=null===l||void 0===l?void 0:l.data)||void 0===y?void 0:y.Oe}, Time Taken ${+R-+f}`);c(`Error - ${a.pva} failed with ${null===(G=null===l||void 0===l?void 0:l.data)||void 0===G?void 0:G.Oe}`)},null)})}}Object(m.a)(Ok,"CopilotProxy",null,[1462]);class kj{constructor(){this.appId=this.designerOptions=
this.jOfcCommandsPayload=null}}Object(m.a)(kj,"ApplyJOfcCommandsWithOptionsDataContract",null,[]);class Ek{constructor(a,b,c,f){this.Mjk=5;this.Lwe=0;this.xic="ReplaceAll";this.WBg="colorSchemeTextArea";this.W2g="themeIdsTextArea";this.vYg="presOutlineTextArea";this.Vwe="CopilotStatusBarDebugUI";this.xOg="CopilotLogPanelId";this.EHf=l=>{l.innerText="";const y=this.ic.MTa();for(let G=0;G<y.length;++G){const R=y[G],ja=document.createElement("option");ja.value=R.sid+";"+R.cid;ja.textContent=""+(G+1);
l.appendChild(ja)}(l=l.options[l.selectedIndex].value.split(";"))&&2===l.length&&(this.OIg={ReferenceSlide:{Sid:parseInt(l[0]),Cid:parseInt(l[1])},InsertBefore:!1})};this.vKk=()=>{const l=document.getElementById("InsertPositionSelect");l&&this.EHf(l)};this.uU=a;this.Ywe={ColorScheme:b.Ha("CopilotTestDefaultColorScheme"),ThemeIds:b.Ha("CopilotTestDefaultThemeIds"),PresOutline:b.Ha("CopilotTestDefaultPresOutline")};this.ic=c;this.yGb=f;this.yGb.KF(this.vKk);document.getElementById("StatusBar").addEventListener("contextmenu",
()=>{this.Lwe++;this.Lwe>=this.Mjk&&(this.dAl(),this.Lwe=0)})}dAl(){if(!document.getElementById(this.Vwe)){var a=document.createElement("div");a.id=this.Vwe;a.setAttribute("style","position: absolute; right: 0; bottom: 24px; display: block; z-Index: 10001; border:1px solid gray; padding: 10px; background-color:#f1f1f1");a.appendChild(this.$Xd("Color Scheme",this.WBg,this.Ywe.ColorScheme,"100px"));a.appendChild(this.$Xd("Theme Ids",this.W2g,this.Ywe.ThemeIds,"30px"));a.appendChild(this.$Xd("Presentation Outline",
this.vYg,this.Ywe.PresOutline,void 0));a.appendChild(this.fvi());a.appendChild(this.Mvi());a.appendChild(this.dvi());document.body.appendChild(a);"ReplaceAll"==this.xic?this.Btd(!1):this.Btd(!0)}}$Xd(a,b,c,f){const l=document.createElement("div");l.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");const y=document.createElement("div");y.setAttribute("style","margin: 2px; color: black; display: inline");const G=document.createElement("textarea");
G.id=b;G.value=c;G.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");void 0!==f&&(G.style.height=f);b=document.createElement("div");b.setAttribute("style","display: inline; float: right; margin-bottom: 2px");f=document.createElement("button");f.innerText="Default";f.onclick=()=>{G.value=c};b.appendChild(f);f=document.createElement("button");f.style.marginLeft="10px";f.innerText="Clear";f.onclick=()=>{G.value=""};b.appendChild(f);
f=document.createElement("label");f.textContent=a;f.setAttribute("style","color: black; margin: 2px");y.appendChild(f);y.appendChild(b);l.appendChild(y);l.appendChild(G);return l}fvi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.evi());a.appendChild(this.Zui());return a}evi(){const a=document.createElement("div");a.setAttribute("style","display:inline; margin: 2px 20px;");const b=
document.createElement("label");b.textContent="MergeAction: ";b.style.color="black";const c=document.createElement("select"),f=document.createElement("option");f.value="ReplaceAll";f.textContent="ReplaceAll";const l=document.createElement("option");l.value="Insert";l.textContent="Insert";"ReplaceAll"==this.xic?f.selected=!0:l.selected=!0;c.appendChild(f);c.appendChild(l);a.appendChild(b);a.appendChild(c);c.addEventListener("change",()=>{"Insert"===c.options[c.selectedIndex].value?(this.xic="Insert",
this.Btd(!0)):(this.xic="ReplaceAll",this.Btd(!1))});return a}Zui(){const a=document.createElement("div");a.id="InsertPositionDiv";a.setAttribute("style","display:inline; margin: 2px 20px; visibility: hidden");const b=document.createElement("label");b.textContent="After slide: ";b.style.color="black";const c=document.createElement("select");c.id="InsertPositionSelect";this.EHf(c);c.addEventListener("change",()=>{const f=c.options[c.selectedIndex].value.split(";");f&&2===f.length&&(this.OIg={ReferenceSlide:{Sid:parseInt(f[0]),
Cid:parseInt(f[1])},InsertBefore:!1})});a.appendChild(b);a.appendChild(c);return a}Btd(a){document.getElementById("InsertPositionDiv").style.visibility=a?"visible":"hidden"}Mvi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px;");a.appendChild(this.Nvi());a.appendChild(this.qui());return a}Nvi(){const a=document.createElement("button");a.style.marginRight="10px";a.innerText="GenerateAndMergeSlides";a.onclick=
()=>Object(ii.a)(this,void 0,void 0,function*(){try{const b={OutlineInput:{ColorScheme:JSON.parse(document.getElementById(this.WBg).value),ThemeIds:JSON.parse(`[${document.getElementById(this.W2g).value}]`),FRenderFirstThumb:!0,PresOutline:JSON.parse(document.getElementById(this.vYg).value)},RequestOptions:{ClientName:"ChatPPT",MergeAction:this.xic,InsertPosition:this.OIg,CorrelationId:void 0}},c=yield this.uU.b5f(b);this.log(`generateAndMergeSlides succeeded: ${c}`)}catch(b){this.log(`generateAndMergeSlides error: ${b}`)}});
return a}qui(){const a=document.createElement("button");a.innerText="Close";a.onclick=()=>{document.body.removeChild(document.getElementById(this.Vwe))};return a}dvi(){const a=document.createElement("div");a.setAttribute("style","margin: 2px 0px; padding: 5px; border: solid 1px darkgray; border-radius: 10px; user-select: text;");var b=document.createElement("label");b.style.color="black";b.style.userSelect="text";b.textContent=`UserSessionId: ${w.AFrameworkApplication.userSessionId}`;a.appendChild(b);
b=document.createElement("textarea");b.id=this.xOg;b.value="";b.setAttribute("style","display: block; margin: 5px 0px; width: 800px; height: 200px; resize:none; overflow-y: scroll");b.disabled=!0;b.style.height="50px";a.appendChild(b);return a}log(a){document.getElementById(this.xOg).value+=a+"\r\n"}}Object(m.a)(Ek,"StatusBarDebugUI",null,[]);class Uf{constructor(a,b,c,f){this.SBg=this.UYg=!1;this.djj=()=>this.la.qJ?this.ead?"IrmProtected":this.DGg.instance&&this.DGg.instance.jSh?"UserEditHappened":
this.UYg?"RealtimeEditHappened":this.SBg?"CoauthMergeHappened":"None":"NotNewFile";this.Qch=()=>{this.UYg=!0;this.ih.rcl(this.Qch)};this.Ubh=()=>{this.SBg=!0;this.ih.ebl(this.Ubh)};this.la=a;this.ih=b;this.DGg=c;this.ead=f;this.ih.IUd(this.Qch);this.ih.nUd(this.Ubh)}}Object(m.a)(Uf,"CreatePresentationEnabledState",null,[1454]);class pl{get name(){return"PowerPointWebEditor.CopilotProxy"}Xb(a){this.K=a;a.register(Ok,"PowerPointWebEditor.CopilotProxy").as("PowerPointWebEditor.ICopilotProxy").na().oa(()=>
new Ok(a.resolve("PowerPointWebEditor.IApplicationSettings"),w.AFrameworkApplication.Qa,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),w.AFrameworkApplication.Je));Object(qd.a)("CreatePresentationEnabledState")&&a.register(Uf,"PowerPointWebEditor.CreatePresentationEnabledState").as("PowerPointWebEditor.ICreatePresentationEnabledState").na().oa(()=>new Uf(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ia("Common.Interface.IEditNotificationManager"),
w.AFrameworkApplication.XE||w.AFrameworkApplication.Vx))}init(){this.K.resolve("PowerPointWebEditor.ICopilotProxy");Object(qd.a)("CreatePresentationEnabledState")&&this.K.resolve("PowerPointWebEditor.ICreatePresentationEnabledState");this.K.resolve("Common.IAppSettingsManager").ka("CopilotDebugUIEnabled")&&new Ek(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.Graph.IGraphInstance").zd(7))}dispose(){}static main(){n.a.instance.Ac(new pl)}}
Object(m.a)(pl,"PPTWebEditorCopilotProxyPackage",null,[2,3]);var Zk=d(170),Sf=d(97),bi=d(651),qc=d(52),ql;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(ql||(ql={}));Object(m.b)("RefreshDocTrigger",ql);var Kc=d(43),Of=d(86);class nj extends Sys.EventArgs{constructor(a,b){super();
this.v6j=b}}Object(m.a)(nj,"FailoverEventArgs",Sys.EventArgs,[]);var Hj=d(246),Xf=d(111);class $l extends Xf.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}ul(){return 61}}Object(m.a)($l,"CheckUnblockUIRequest",Xf.a,[]);var kg=d(893);class Rm{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie){this.Wma=!1;this.dxa=this.nGe=this.jHa=this.pHa=this.yU=this.Qs=null;this.la=a;this.wb=b;this.Ssk=c;this.qf=f;this.pa=l;this.Fa=y;this.zA=G;this.W7c=ic;this.yfb=
ec;this.$m=R;this.Qik=ja;this.ua=za;this.Ub=Va;this.X$=hb;this.Ce=Cb;this.Vd=lc;this.mHa=yc;this.ia=jc;this.lD=xd;this.Dn=Xd;this.LZa=Qd;this.lj=Ie;this.glk=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.Pok=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}vb(){this.ia.ra(ea.a.cMb,qc.a.application,Object(H.a)(this,this.n6k,"refeshDoc"),64)}n6k(a,b,c,f,l){this.Q9e(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in l&&l.isPodSessionRefreshed?
3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get Di(){return this.Ub.Di}nta(a){a.l$b()&&a.nta()}Q9e(a,b,c,f){if(!this.Ce.rd.hermesFailOverImprovementIsEnabled||this.yfb())return!1;if(this.Wma||this.mHa.Dpg)return!0;const l=this.Di;if(!(l&&l.Fi&&l.Fi.xx&&l.Fi.xx.id!==ia.a.nil&&l.contentReplicator&&this.ua.presentation&&this.ua.presentation.id.equals(bi.a.FPe)))return!1;5===f&&this.ryf();this.$m.pause();this.X$.suspend();this.zA.Rd&&this.zA.Rd.endEditing(!1,14);
this.zA.forEach(Object(H.a)(this,this.nta,"ensureGraphUpdated"));l.TT(!0)&&l.Iga();this.pa.setSelection(null);this.Fa.Bd();this.Qs=Kc.a.Jj("RefreshDoc");this.Qs.Wa("IsPlanedShutdown",b.toString());this.Qs.Wa("PodSessionId",c);this.Qs.Wa("RefreshDocTrigger",ql[f]);ya.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.Qs.actionId,this.Qs.xQb());this.yU=a;b?(this.pHa=new Date,this.mHa.tEh(),this.W7c.Hb(this.M1d())):this.Ooh();this.lD.Cmh(new nj(b,!1));this.ua.presentation.FYe();
this.qf.blockContent(this.ua.presentation,"RefreshDoc",!0);ya.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Vd.disabled=!0;return this.Wma=this.Ce.wab().Cjd=!0}ryf(){this.$m.isPaused&&(ya.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.$m.Bnb());try{this.$m.jKf()}catch(a){ya.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",a)}}M1d(){return this.jHa=
new Hj.a(new $l(this.yU),Object(H.a)(this,this.UMe,"onCheckUnBlockUISuccess"),Object(H.a)(this,this.TMe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}Ooh(){this.Qs.Wa("FailedMachineId",this.yU);this.nGe=new Date;this.Ssk.cMb(this.yU,this.Qs,!this.Ce.rd.refreshDocSynchronouslyIsEnabled,!1,Object(H.a)(this,this.sZi,"docRefreshSuccessCallback"),Object(H.a)(this,this.rZi,"docRefreshFailedCallback"));this.Qik.Kxa()}UMe(){this.mHa.XZc();this.Qs.Wa("DeploymengUIBlockingTime",(+new Date-
+this.pHa).toString());this.Qs.Wa("CheckUnblockUISucceeded","True");this.Ooh()}TMe(a){if(142===a.ServerError.Code)return ya.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.yU,+new Date-+this.pHa),this.W7c.Hb(this.jHa),!0;this.Qs.Wa("DeploymengUIBlockingTime",(+new Date-+this.pHa).toString());this.Qs.Wa("CheckUnblockUISucceeded","False");this.mHa.XZc();return this.Sch(a)}sZi(){this.Dn.kUd(Object(H.a)(this,this.IOe,"onSlideDrawComplete"));
this.dxa&&this.wb.Kg(this.dxa);const a=this.Qs.vK("RefreshDocTrigger");this.dxa=new pd.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.glk:this.Pok,Object(H.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.wb.Hb(this.dxa);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.ryf()}rZi(a){return this.Sch(a)}IOe(){ha.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.dxa&&(this.wb.Kg(this.dxa),this.dxa=null);this.Dn.hqd(Object(H.a)(this,this.IOe,
"onSlideDrawComplete"));this.Qs&&(this.Qs.Wa("ReStoreStatusAfterRefreshStartTime",Kc.a.vf(new Date)),this.X$.resume(),this.Qs.Wa("SlideDrawResult","True"),this.Qs.zm("SlideDrawCompleteET",new Date),this.$m.isPaused&&this.$m.Bnb(),this.Qs.Wa("LoadAndRenderTime",(+new Date-+this.nGe).toString()),this.Ce.rd.RVe||this.Ce.wab().Mxa(),this.Qs.Wa("ReStoreStatusAfterRefreshEndTime",Kc.a.vf(new Date)),this.vOe(!0),this.LZa.Vmh(new kg.a("DocRefresh")),this.lj.Unb=2,w.AFrameworkApplication.ykb(Of.a.Ph(180),
Zk.a.unknown,Zk.a.sxc),Sf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.Dn.hqd(Object(H.a)(this,this.IOe,"onSlideDrawComplete"));this.dxa&&(this.wb.Kg(this.dxa),this.dxa=null);ha.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.Qs.Wa("SlideDrawResult","False");this.vOe(!1);this.Ael()}Ael(){this.Vd.disabled=!1;w.AFrameworkApplication.No(Of.a.Ph(379));Sf.Health.instance.recordQosError("RefreshDocTimeout",
["UnexpectedAppRefresh"],!1,!1,!0,!0,null);w.AFrameworkApplication.hv&&w.AFrameworkApplication.hv.X8();this.ia.Ja(ea.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}Sch(a){ha.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Qh);this.vOe(!1);return!1}vOe(a){this.Wma=
!1;this.jHa=this.yU=null;this.nGe=new Date(0);Kc.a.Cdc=new Date;this.Qs&&(this.Qs.Wa("Result",a?"Success":"Failed"),this.Qs.finish(!0),this.Qs=null);this.Vd.disabled=!1;this.Ce.wab().Cjd=!1;this.qf.zK(this.ua.presentation)}}Object(m.a)(Rm,"DocRefreshHandler",null,[1452]);var oi=d(158);class oj{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.Wma=!1;this.jHa=this.pHa=this.yU=this.Qs=null;this.ia=a;this.ei=b;this.ih=c;this.qf=f;this.pa=l;this.Fa=y;this.$m=G;this.ua=R;this.X$=ja;this.mHa=za;this.Ya=
Va;this.la=hb;this.yfb=Cb;this.la.kqg&&this.ih.GC(Object(H.a)(this,this.UE,"onSessionEnd"))}vb(){this.ia.ra(ea.a.failover,qc.a.application,Object(H.a)(this,this.QEj,"handleFailover"),64)}UE(){this.$m.isPaused||this.$m.pause()}QEj(a,b,c,f,l){if(1===c||this.yfb()||this.Wma||this.mHa.Dpg)return 32;this.yU=l;if(!this.yU)return 8;this.Qs=Kc.a.Jj("SeamlessFailover");this.$m.pause();this.X$.suspend();this.pa.setSelection(null);this.Fa.Bd();this.qf.blockContent(this.ua.presentation,"SeamlessFailover",!0);
ya.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.pHa=new Date;this.mHa.tEh();this.ih.Cmh(new nj(!0,!0));w.AFrameworkApplication.Uwb();this.ei.iJc(this.M1d());this.Wma=!0;return 32}M1d(){return this.jHa=new Hj.a(new $l(this.yU),Object(H.a)(this,this.UMe,"onCheckUnBlockUISuccess"),Object(H.a)(this,this.TMe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}UMe(){this.mHa.XZc();this.Qs.Wa("DeploymengUIBlockingTime",(+new Date-+this.pHa).toString());
this.Qs.Wa("CheckUnblockUISucceeded","True");this.Qs.Wa("FailedMachineId",this.yU);this.Ya.oxb=this.yU;this.N3k()}TMe(a){if(142===a.ServerError.Code)return ya.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.yU,+new Date-+this.pHa),this.ei.iJc(this.jHa),!0;this.Qs.Wa("DeploymengUIBlockingTime",(+new Date-+this.pHa).toString());this.Qs.Wa("CheckUnblockUISucceeded","False");this.mHa.XZc();return this.lHk(a)}N3k(){this.Qs.Wa("ReStoreStatusAfterRefresh",
Kc.a.vf(new Date));this.$m.Bnb();this.X$.resume();this.Gah(!0);w.AFrameworkApplication.ykb(Of.a.Ph(180),Zk.a.unknown,Zk.a.sxc);Sf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}lHk(a){ha.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Qh);this.Gah(!1);
a.ServerError=Object.assign(new oi.a,{Code:157,Source:0});return!1}Gah(a){this.Wma=!1;this.jHa=this.yU=null;this.Qs&&(this.Qs.Wa("Result",a?"Success":"Failed"),this.Qs.finish(),this.Qs=null);this.qf.zK(this.ua.presentation)}dispose(){this.la.kqg&&this.ih.Qaa(Object(H.a)(this,this.UE,"onSessionEnd"))}}Object(m.a)(oj,"SeamlessFailoverHandler",null,[108]);var zi=d(223),sh=d(107),Ij=d(1203),Uh=d(287),mf=d(846),Ql=d(234),Fk=d(635);class dj{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.la=b;this.r$=c;this.Lz=f;this.Ib=l;this.qfb=!1}Bv(a,b=!1,...c){this.S4b.apply(this,[Of.a.Ph(a),this.r$.LXc(a),this.r$.rfe(a),this.r$.Kce(a),b].concat(c))}S4b(a,b,c,f,l=!1,...y){if(!zi.a.wx){var G=2,R=!1;if(a===Of.a.Ph(83))this.la.g7j&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,G=3);else if(a===Of.a.Ph(8)||a===Of.a.Ph(256)||a===Of.a.Ph(257)||a===Of.a.Ph(291))G=0,R=!0;y&&0<y.length&&(f=String.format.apply(null,[f].concat(y)));this.Nt(new Fk.a(a,
c,f,b,G),l,R)}}Nt(a,b=!1,c=!1){let f=a.vpd;var l=Of.a.eU(a.Vm)?Ql.a[Of.a.sL(a.Vm)]:"";ya.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Vm,l,b,w.AFrameworkApplication.iF,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));"errorLocalChangeLostCoauth"==l&&qd.a("LocalChangesLostQoSErrorEnabled")&&
Sf.Health.instance.recordQosError("LocalChangesLost",["ClientSideDataLoss"],!1,!0,!0,!1,null);if(this.Syl(a))ya.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",a.Vm);else{l=new sh.StandardDialog;var y=null,G=!1,R=this.Ib.ka("UserCanWriteRelative");f&64&&ya.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.Ib.Ha("DocumentPermissions")||"");var ja=!1;f&64&&this.la.pptFileRecoveryEnabled&&(ja=!0);f&64&&!R&&ya.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");
!ja&&f&64&&(c=!1,f=this.XSl(a));R=!!(f&4)&&!(w.AFrameworkApplication.HMh||w.AFrameworkApplication.dR);var za=!!(f&2)&&w.AFrameworkApplication.uea;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.Mr=za||!!(f&1);f&8?(l.Ad=0,y=Object(H.a)(this,this.Apd,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Vm.toString())?l.zP(Ij.a.i4(a.title),Ij.a.i4(a.message),y):(ya.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Vm),l.Le(1,
ResourceStrings.L_Refresh),l.Yy(a.Vm,Ij.a.i4(a.title),Ij.a.i4(a.message),y,b)),G=this.qfb=!0):ja?(ya.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Vm),this.ia.processAction(ea.a.repair,2)):za&&R?(l.Ad=4,l.Le(1,c),l.Le(2,ResourceStrings.L_Close),y=Object(H.a)(this,this.nOk,"openOrCloseActionHandler"),this.qfb=!0):R?(l.Ad=0,l.Le(1,c),y=Object(H.a)(this,this.tld,"openInClientActionHandler"),this.qfb=!0):za?(l.Ad=0,l.Le(1,ResourceStrings.L_Close),
y=Object(H.a)(this,this.eFi,"closeActionHandler"),this.qfb=!0):(c=!!(f&1)||0===f,l.Mr=c,l.Ad=c?0:5);G||ja||(f&16&&f&32?(b||w.AFrameworkApplication.No(a.Vm),l.Y1a=!1,l.Tx(Ij.a.i4(a.title),Ij.a.i4(a.message),a.icon,y)):l.Yy(a.Vm,Ij.a.i4(a.title),Ij.a.i4(a.message),y,b));this.qfb&&this.Lz&&this.Lz.closeSession(4);this.qfb?Sf.Health.instance.recordQosError(Of.a.kda(a.Vm),["NonDismissibleDialog"],!1,!1,!0,!0,null):Sf.Health.instance.recordQosError(Of.a.kda(a.Vm),["DismissibleDialog"],!1,!1,!0,!1,null)}}get U2c(){return this.qfb}XSl(a){ya.a.J(512497105,
801,15,"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Vm===Of.a.Ph(8)||a.Vm===Of.a.Ph(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}tld(a,b){ya.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.Zkh()}nOk(a,b){ya.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.Zkh():this.ia.Ja(ea.a.Axb,2,Uh.c)}eFi(a,b){ya.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ja(ea.a.Axb,2,Uh.c)}Apd(a,b){ya.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.Ja(ea.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}Zkh(){(new mf.a(C.a.openInClient)).une()}Syl(a){return a.Vm===Of.a.Ph(83)&&(w.AFrameworkApplication.iM("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.OCl)||
a.Vm===Of.a.Ph(56)&&(w.AFrameworkApplication.iM("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.PCl)?!0:!1}}Object(m.a)(dj,"ErrorDialog",null,[1450]);var yj=d(280),ma=d(127),ib=d(524),yb=d(1036);class ac extends Sys.EventArgs{constructor(){super();this.dDa=this.JC=0;this.message=this.title=null}}Object(m.a)(ac,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class Qc extends ac{constructor(a){super();this.jTa=null;this.errorCode=a;this.JC=0}}Object(m.a)(Qc,
"OnBeforeHandleClientErrorEventArgs",ac,[]);class me extends ac{constructor(){super();this.JC=0}}Object(m.a)(me,"OnBeforeHandleServerErrorEventArgs",ac,[]);class Ge extends Sys.EventArgs{constructor(a,b,c){super();this.$O=a;this.alk=b;this.ph=c}get podSessionId(){return this.$O}get XSc(){return this.alk}get errorCode(){return this.ph}}Object(m.a)(Ge,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class sf{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){this.sBe=!1;this.lmk=[8];this.MBe={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.r$=a;this.bfa=b;this.wl=c;this.ZDg=f;this.ia=l;this.Ya=y;this.Ib=G;this.Rb=R;this.sGb=ja;this.vhf=!1;this.$m=za;this.Lz=Va;this.$o=Cb;this.uj=lc;this.Ce=hb}Gs(a,b,c=null,f=!1){if(this.disabled)return ha.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.Lz.Rxk();if(this.Lz.s0)return ha.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,y=0,G=0,R=null;var ja=null;c&&(ja=new me,l=c(ja),y=ja.JC,G=ja.dDa,R=ja.title,ja=ja.message);l||(l=this.YIj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.n5i(b)&&(this.vhf=!0,this.$m.pause()),a?this.Yy.apply(this,[y,b,G,R,ja,f].concat(a)):this.Yy(y,
b,G,R,ja,f));return l}YIj(a,b){if(!a)return!1;ha.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return yj.a.instance.AVe(Date.now()),yj.a.W5c(w.AFrameworkApplication.userSessionId),w.AFrameworkApplication.ykb(Of.a.Ph(153),Zk.a.unknown,Zk.a.sxc),({l8e:c}=yj.a.instance.cNh()).returnValue&&ha.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.g6k(a.ExtraErrorParam[0]):ha.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.Ja(ea.a.failover,2,a.ExtraErrorParam[0]):this.ZDg.Q9e(a.ExtraErrorParam[0],!0,this.Ya.podSessionId||"",1))||this.Yy(0,157,0,null,null),
!0;if(274===a.Code)return ha.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.$o.instance&&!na.a.Xa(this.Ya.qTc))return ha.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.$o.instance.d9e(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.Ib.ka("685")&&c.toLowerCase()!==this.Ya.podSessionId.toLowerCase()?(ya.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.Ib.ka("884")&&this.sBe?(ya.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.ZDg.Q9e(a.ExtraErrorParam[0],
!1,this.Ya.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.Ib.ka("560")&&229===a.Code||this.Ib.ka("914")&&this.$o.instance&&this.$o.instance.W5i(a.Code)){if(b!==this.Ya.podSessionId)return ya.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Ya.podSessionId),!0;if(this.Ib.ka("914")&&this.$o.instance&&this.$o.instance.P_)return ya.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Ya.podSessionId),!0;ya.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.sGb.j2k(new Ge(this.Ya.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Rb.notificationBar.wDa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.Ib.ka("IsAutomation")?a.displayTimeoutSeconds=this.Ib.uc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:ya.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Rb.notificationBar.li(a),!0;if(238===a.Code&&this.Ib.ka("561")&&this.$o.instance&&this.$o.instance.P_)return ya.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return ya.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.LFh(a.Code,null),!0;if(104===a.Code)return b=2===this.uj.sda,a.Code=b?56:105,ya.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",Ql.a[a.Code]),this.Yy(0,a.Code,0,
null,null),!0;if(this.OXj(a.Code)&&2!==this.Ib.state)return ya.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.Yy.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.Yy.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}rH(a,b){if(this.disabled)return ha.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,y=null,G=null;var R=null;b&&(R=new Qc(a),c=b(R),f=R.JC,l=R.dDa,y=R.title,G=R.message,R=R.jTa);c||(c=!1);c||(R?this.Yy.apply(this,[f,a,l,y,G,!1].concat(R)):this.Yy(f,a,l,y,G));return c}Yy(a,b,c,f,l,y=!1,...G){0===a&&(a=this.r$.Isj(b));0===c&&(c=this.r$.LXc(b));f||(f=this.r$.rfe(b));l||(3===b&&this.Ib.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.Oij():(ya.a.J(512263007,
801,50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.r$.Kce(b)));const R=()=>{this.oAl.apply(this,[a,b,c,f,l,y].concat(G))};2===this.Ib.state?R():this.Ib.$e(R)}Oij(){ya.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+w.AFrameworkApplication.u4b);return w.AFrameworkApplication.u4b&&this.MBe[w.AFrameworkApplication.u4b]?this.MBe[w.AFrameworkApplication.u4b]:this.MBe.Generic}oAl(a,b,c,f,l,y,...G){if(2===a){let R;(R=this.wl).S4b.apply(R,
[b,c,f,l].concat(G))}else 3===a?this.LFh.apply(this,[b].concat(G)):this.eta.apply(this,[Of.a.Ph(b),c,f,l,y].concat(G))}eta(a,b,c,f,l,...y){0===b&&(b=this.r$.LXc(Of.a.sL(a)));if(yb.GraphSpaceRootReplicator.ttg(Of.a.sL(a))&&y&&0<y.length){this.Ya.wqd=y[0];var G=new Oa.a;for(var R=1;R<y.length;R++)G.add(y[R]);y=G.toArray()}G=Object.assign(new ib.a,{Type:6,Token:this.Ce.rd.lpc,Data:{["Reason"]:"FatalError",["ErrorName"]:Of.a.kda(a)}});qd.a("PPT.BootstrapperMessageNewValues")&&(G.MessageId=ma.a.vPh,R=
{Reason:"FatalError"},R.ErrorName=G.Data.ErrorName,G.Values=R);window.parent.postMessage(Nd.c(G),"*");ha.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let ja;(ja=this.bfa).S4b.apply(ja,[a,b,c,f,l].concat(y))}g6k(a){Cd.a.openWindow(1,a)}get nla(){return this.sBe}set nla(a){this.sBe=a;ya.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get v6d(){return this.vhf}iUd(){}JUd(){}LFh(a,...b){const c=Of.a.Ph(a);ya.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");w.AFrameworkApplication.No(c);Sf.Health.instance.recordQosError(Of.a.kda(c),["SilentFailure"],!1,!0,!0,!1,null)}OXj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}n5i(a){return Array.contains(this.lmk,a)?!0:!1}}Object(m.a)(sf,"GlobalErrorHandler",null,[1453,1464]);class uf{constructor(a){this.egc=!1;this.oY=null;this.Yr=a}get Dpg(){return this.egc}tEh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.egc||(this.oY=new Le.a,this.oY.Ad=5,this.oY.message=Ij.a.i4(b),this.oY.Mr=!1,ya.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.oY.Fpa(Ij.a.i4(a),null,null),this.egc=!0,this.Yr.vGf(!0))}XZc(){this.egc&&(this.oY.hide(),this.egc=!1,this.oY=null,this.Yr.vGf(!1))}}Object(m.a)(uf,"DeployingDialog",null,[1448]);var xf=d(1046),dg=d(442),df=d(657),If=d(428),Ai=d(163),nc=d(58),hn=d(924);class yn{constructor(a,
b,c,f,l,y,G,R){this.Xea=this.Ve=this.IEb=this.CEb=null;this.S8c=!1;this.m9c=this.qfd=this.I6c=null;this.Wma=!1;this.ua=a;this.Ub=b;this.Pq=c;this.Sb=f;this.W7c=l;this.HEg=y;this.$o=G;this.Dwk=R}get Di(){return this.Ub.Di}cMb(a,b,c,f,l,y){this.Wma||(this.Wma=!0,this.S8c=c,this.Ve=b,this.qfd=l,this.m9c=y,this.$o.instance&&this.$o.instance.OSd("abortedOnRefreshDoc"),this.HEg&&this.HEg(),this.W7c.Hb(this.PQi(a,f)))}PQi(a,b){let c=this.ua.Ba&&!nc.a.Fw(this.ua.Ba.Cb)?this.ua.Ba.Cb:nc.a.empty;c=b?nc.a.empty:
c;this.Ve.Wa("CurrentActiveSlideId",c.toString());this.I6c=nc.a.Fw(c)?nc.a.empty:c;return new Hj.a(new hn.a(c,a),Object(H.a)(this,this.HHk,"onGetCellSuccess"),Object(H.a)(this,this.GHk,"onGetCellFailed"),this.Dwk?null:Object(H.a)(this,this.MXl,"validateResponse"))}MXl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}HHk(a){this.Ve.Wa("GetCells",a.Qh);a=new xf.a(null,Object(H.a)(this,this.pPj,"inboundSetup"),
a);a.Zi=!this.S8c;a.$l("RefreshUIOperation");a.run()}GHk(a){this.Ve.Wa("GetCells",a.Qh);200!==a.HttpStatusCode&&this.Ve.Wa("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.m9c&&this.m9c(a))return!0;a.ServerError=Object.assign(new oi.a,{Code:294,Source:0});Sf.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}pPj(a,b){(this.Xea=this.Ub.Rn)&&this.Xea.rN&&this.Xea.rN.h6c();this.Xea&&this.Xea.yp&&(this.Xea.rN=new df.a(le.a.instance,"FailoverView"));
this.Ve.Wa("InboundSetupStartTime",Kc.a.vf(new Date));if(qd.a("UseBuildIncrementalInboundOperation"))this.Ub.Ba=null,this.CEb=this.Di.contentReplicator.oHf(b);else{const c=b.Cells[b.Cells.length-1],f=this.Di.Fi.xx.id;c.RevisionList[0].BaseId=Ai.a(f);this.Ub.Ba=null;this.CEb=new dg.a(c,f,!1,new Date,b.Qh,!1,!1,!1)}this.IEb=this.Pq.ke(3);this.IEb.ld(this.ua.presentation);this.S8c&&this.IEb.oV(a);a.gh(Object(H.a)(this,this.pla,"inboundIncrementally"));this.Ve.Wa("InboundSetupEndTime",Kc.a.vf(new Date));
return!0}pla(a){this.Ve.Wa("InboundIncrementallyStartTime",Kc.a.vf(new Date));this.Di.contentReplicator.pla(this.CEb,new Date);this.CEb.XQ&&(this.IEb.dispose(),a.gh(Object(H.a)(this,this.wnl,"setActiveSlideAndRender")),this.IEb=this.CEb=null,this.Ve.Wa("InboundIncrementallyEndTime",Kc.a.vf(new Date)));return!0}wnl(a){this.Ve.Wa("SetActiveSlideAndRenderStartTime",Kc.a.vf(new Date));a.gh(Object(H.a)(this,this.T8i,"finishRefreshDoc"));if(nc.a.empty.equals(this.I6c))return this.Ve.Wa("SetActiveSlideAndRenderEndTime",
Kc.a.vf(new Date)),!0;const b=this.Sb.Qk(this.I6c);if(!b)return this.Ve.Wa("SetActiveSlideAndRenderEndTime",Kc.a.vf(new Date)),!0;const c=this.Pq.ke(3);try{c.ld(b),this.S8c&&c.oV(a),this.Ub.Ba=b}finally{c&&c.dispose()}this.Ve.Wa("SetActiveSlideAndRenderEndTime",Kc.a.vf(new Date));return!0}T8i(){this.qfd&&this.qfd();this.Xea&&this.Xea.rN&&(this.Xea.rN.h6c(),this.Xea.rN=new If.a);this.V1();return!1}V1(){this.Wma=!1;this.m9c=this.qfd=this.I6c=this.Xea=this.Ve=this.IEb=this.CEb=null}}Object(m.a)(yn,"RefreshDocExecutor",
null,[1451]);class Bm{Kce(a){switch(a){case 1:a=ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;
case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;
break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;
break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;
break;case 28:a=ResourceStrings.errorMessage_NoLicense;break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 39:a=ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;case 450:a=ResourceStrings.errorMessage_UploadedVideoTooLarge;break;default:a=ResourceStrings.errorMessage_Unknown}return a}rfe(a){switch(a){case 1:a=
ResourceStrings.errorTitle_Unknown;break;case 14:a=ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;
break;case 51:a=ResourceStrings.errorTitle_Unknown;break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;
break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;
break;case 70:a=ResourceStrings.errorTitle_WacStandard;break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;
break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 149:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;
case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;
break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 450:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}LXc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=
6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=
6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=
116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;
case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=
8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;case 450:a=49;break;default:a=0}return a}Isj(a){switch(a){case 5:a=
1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;
case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(m.a)(Bm,"DefaultErrorMapping",null,[1449]);var gh=d(726);class pj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Xb(a){this.K=a;a.register(1448,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").na().oa(()=>new uf(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1449,"PowerPointWebEditor.IErrorMapping").na().oa(()=>new Bm);a.register(1450,
"PowerPointWebEditor.IErrorDialog").na().oa(()=>new dj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));const b=new vb.a(()=>new gh.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),
a.resolve("PowerPointWebEditor.IReplicationTimerFactory").S3b(a.resolve("Box4.IReplicationParameters")),Fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>w.AFrameworkApplication.Yg));a.register(1451,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").na().oa(()=>new yn(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),
b.value,w.AFrameworkApplication.iZf,this.K.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));a.register(1452,"PowerPointWebEditor.IDocRefreshHandler").na().oa(()=>new Rm(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),
()=>w.AFrameworkApplication.Yg,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(oj,"PowerPointWebEditor.SeamlessFailoverHandler").na().oa(()=>new oj(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>w.AFrameworkApplication.Yg));
a.register(1453,"PowerPointWebEditor.IDelayedErrorHandler").na().oa(()=>new sf(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),
this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").vb();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").vb()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){n.a.instance.Ac(new pj)}}
Object(m.a)(pj,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var Rl=d(1275),Yg=d(87),va=d(39);class zn{constructor(){this.font=null;this.l2c=this.isValid=!1}}Object(m.a)(zn,"EmbeddedFontClientStatus",null,[]);class jh{constructor(a,b,c,f,l,y){this.lgd=this.Beb=null;this.Da=a;this.By=b;this.CYg=c.zd(7);this.ic=f;this.TGb=l;this.Dz=y;this.CYg.gk(Object(H.a)(this,this.Dib,"onPresentationPropertyChanged"));this.By.MFa(()=>{this.U$e(0)})}dispose(){this.CYg.Qm(Object(H.a)(this,this.Dib,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.Beb}get tSh(){return this.lgd}kae(a){return this.isInitialized?
this.Beb.Gb(a)?this.Beb.ga(a):null:null}createFontUrl(a){if(this.Da.podsHtmlTextForEmbeddedFontsIsEnabled)if(ya.a.J(41521309,820,50,"CreateFontUrl"),this.isInitialized||this.U$e(2),this.isInitialized){var b=this.Dz.rG(a);if((b=this.kae(b))&&!b.l2c&&b.isValid){b.font.Name!==a&&ya.a.J(41296397,820,15,"Name is not identical");a=aa.FontUtils.W7b(a);const c=this.TGb.resolve(Yg.a.z$i,jh.I$i(b.font));na.a.Xa(a)||na.a.Xa(c)?ya.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.Dz.wRa(a,String.format("url('{0}')",
c)),b.l2c=!0)}}else ya.a.J(41296401,820,10,"Dictionary is not initialized")}Dib(a,b){b&&b.node&&b.property&&b.property===va.a.embeddedFonts&&this.U$e(1)}U$e(a){if(this.Da.podsHtmlTextForEmbeddedFontsIsEnabled)if(ya.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.ic.Mjj()){this.Beb?ya.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.Beb=new Yc.a,ya.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(na.a.Xa(b.Name)){ya.a.J(41296407,
820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=jh.X_j(b);const c=this.Dz.rG(b.Name),f=this.kae(c);f&&(f.isValid===a||f.l2c)||this.Beb.$(c,Object.assign(new zn,{font:b,isValid:a,l2c:!1}))}this.lgd=jh.PSi(this.Beb);this.Dz.USl(this.lgd);aa.FontUtils.Fei(this.lgd,Object(H.a)(this,this.createFontUrl,"createFontUrl"))}else ya.a.J(41296403,820,10,"EmbeddedFonts is null")}static I$i(a){return JSON.stringify(a)}static X_j(a){return!na.a.Xa(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||
270===a.LoadResult)}static PSi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new Rl.a("",0,0,"",[0])),b[c.key]=a);return b}}Object(m.a)(jh,"EmbeddedFontsManager",null,[1447,108]);class Qg{}Qg.loading="loading";Qg.loaded="loaded";Qg.error="error";Object(m.a)(Qg,"FontFaceStatus",null,[]);class Pk{constructor(){this.Gad=this.Yzg=!1;this.PAe=null;this.init()}get pug(){return this.Gad}load(a){return new Promise((b,c)=>{this.Gad&&!na.a.Xa(a)||c([]);let f;f=this.Yzg&&-1<a.indexOf("'")?String.format('48px "{0}"',
a):String.format("48px '{0}'",a);this.PAe.load(f).then(l=>{for(const y of l)na.a.Xa(y.family)||y.status===Qg.loaded||ya.a.J(40429085,801,15,"Font load status {0}",y.status);l.length||ya.a.J(41494563,801,15,"No font resolved");b(l)},l=>{ya.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.PAe=a&&a.fonts?a.fonts:null;this.Gad=!!this.PAe;this.Yzg=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");ya.a.J(41494593,
801,50,"FontFaceSetAPIIsSupported: {0}",this.Gad)}}Object(m.a)(Pk,"FontFaceSetObserver",null,[1445]);class Sj{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");this.Oeb=a}Cje(a){return a?a:{}}uje(a){return a?a:()=>{}}mTh(a,b,c,f,l,y,G){if(!a)return[];b=this.Cje(b);c=this.uje(c);f=this.Cje(f);l=this.uje(l);y=this.Cje(y);G=this.uje(G);const R=[];for(const ja of a)ja in f?(l(ja),R.push(this.Oeb.load(String.format("{0}_MSCustomFont",ja)))):ja in b?(c(ja),R.push(this.Oeb.load(String.format("{0}_MSFontService",
ja)))):ja in y&&(G(ja),R.push(this.Oeb.load(String.format("{0}_EmbeddedFont",ja))));return R}}Object(m.a)(Sj,"FontsObserver",null,[1446]);class fk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Fonts"}Xb(a){this.K=a;this.K.register(1445,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").na().oa(()=>new Pk);this.K.register(1446,"PowerPointWebEditor.Fonts.IFontsObserver").na().oa(()=>new Sj(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1447,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").na().oa(()=>
new jh(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){n.a.instance.Ac(new fk)}}Object(m.a)(fk,"PPTWebEditorFontsPackage",
null,[2,3]);var km=d(437);class jn{MDh(){return!1}}Object(m.a)(jn,"DefaultParagraphViewElementSetUpdateStrategy",null,[1466]);var wk=d(225),rl=d(1113),Oi=d(245);class Qk extends wk.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){super(a,b,l);this.JDc=null;this.vWb=oc.a.nil;this.Eif=this.RGd=!1;this.NZ=this.MZ=this.Zob=this.Yob=-1;this.oHd=this.PVb=!1;this.wEc=this.I5c=this.PMd=this.Vsf=this.Xqb=null;this.Pwd=0;this.eef=this.f4a=this.ukf=null;a.rN.v0a(b);this.QWa=c;this.QMd=y;this.W0h=G;this.V0h=R;this.S6h=
ja;this.hd=za;this.v1h=Va;this.qw=hb;this.X2a(!0);this.a2e(!0);this.wJd=new vb.a(Object(H.a)(this,this.QWi,"determineIsShapesAndTextboxesEnabled"));this.Et=[];this.MOa=new Oa.a;this.Fef=new Oa.a;this.gib();this.Qc.Uh&&(b=this.Qc.Oqj(this.gb))&&(b.isSelected&&(this.fS.xIb=!0),b.F9&&(this.PVb=!0),this.fS.xIb&&(this.Yob=b.Tja,this.Zob=b.Uja,this.MZ=b.oT,this.NZ=b.xsa));a.yp&&(a=Object(sa.a)(176,a))&&a.D3k(this.gb);this.IXb=f;this.IMd=Cb}get OPk(){return this.IXb}get QPe(){return this.QMd}get ssh(){return this.Vsf||
(this.Vsf=this.W0h())}get Lld(){if(!this.PMd){const a=this.V0h();a&&(this.PMd=a.M2l())}return this.PMd}get Xf(){return this.hd}get d0(){return this.v1h}get xwg(){return this.vWb}set xwg(a){this.vWb=a}get uNj(){return this.MOa}get xgh(){return this.Ui?Ga.a.J5f(this.Ui,!1):0}get Ui(){return this.Xqb}get Abb(){return this.ukf}X2a(a){let b=!1;this.ywl(a)&&(a=this.d9a(),this.jc(a),this.JDc=null,this.vWb=oc.a.nil,b=!0);this.Xf.gg&&this.gb.nnb?Sys.UI.DomElement.addCssClass(this.htmlElement,Lb.B4):Sys.UI.DomElement.containsCssClass(this.htmlElement,
Lb.B4)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Lb.B4),this.htmlElement.removeAttribute("title"));return b}ywl(a){let b=!!this.htmlElement;b=b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Ui||"p"!==na.a.ug(this.Ui.tagName)}d9a(){this.Xqb=this.Od.vp(Fa.a.p);this.Xqb.className="Paragraph";this.ukf=this.Od.vp(Fa.a.span);this.Abb.className="WACImageGroupContainer";return this.Od.lm?this.Xqb:this.k_l()}k_l(){const a=this.Od.vp(Fa.a.div);a.className="ParaWrappingDiv";
a.appendChild(this.Xqb);this.hp(this.Xqb);return a}fV(a){super.fV(a);if(this.gb.A_)return a=this.gb.A_.qc(a.D2).uzc,this.gb.A_=null,new Oi.a(a.Wna,a.minWidth,a.Xna);let b;b=this.eef;a.Db(88)&&(b=Oi.a.max(b,a.ir.lMa),a.Cc());return b}az(a){if(w.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.I5c=null,this.Ui)){const b=this.Ui.getElementsByClassName("LineBox");if(b&&0<b.length){this.I5c=Array(b.length);for(let c=0;c<b.length;c++)this.I5c[c]=Ga.a.Gv(b[c]).length}}this.X2a(!1)&&
(a.currentNode.anchor.sk(this.Na,8),a.parentNode.anchor.sk(this.Na,8),this.JDc=null);super.az(a);this.mQi(a,this.Ui)}mQi(a,b){var c=this.gb;if(this.Qc.Uh){var f=ra.InteractiveViewManager.instance.Rd;f&&f.Na===this.Qc.Na&&f.editingView.lm&&f.editingView.Eg===this.gb&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,Qk.wjg):Sys.UI.DomElement.removeCssClass(this.htmlElement,Qk.wjg)}if(c.A_)c=c.A_.qc(a.D2).htmlElement,Ga.a.m3b(c,b),b=this.Qc,b.Uh&&b.ZF&128&&(this.gb.A_=null);else{a=
this.Pqj();f=Ka.StyleReader.I9f(a);Ka.StyleReader.D4c(a)&&f?(xb.d(b,wa.a.role,Ne.a.YEf),xb.d(b,wa.a.$Ef,f)):(b.removeAttribute(Ne.a.hf),b.removeAttribute(Ne.a.I0b));var l="";if(M.a.instance.ga(71)||M.a.instance.ga(77))l=this.Khj(c);f=a=null;var y=zb.ParagraphReader.Cdg(c,M.a.instance.ga(53),M.a.instance.ga(71),M.a.instance.ga(77),M.a.instance.ga(54));if(this.Eif||l!==this.JDc||this.vWb!==c.GLe){a="WindowText";f="transparent";this.JDc=l;this.Eif=!1;l="";let R=null;"P"!==b.tagName&&y.mbb&&(R=aa.FontUtils.Rja(y.fontName));
if(y.w4){var G=y.fontColor;G!==oc.a.auto&&(a=oc.a.fH(G))}M.a.instance.ga(49)||(y.qbb&&(G=y.lS,G!==oc.a.auto&&(f=oc.a.fH(G))),y.cVa&&(G=y.highlight,G!==oc.a.auto&&(f=oc.a.fH(G))));if(G=zb.ParagraphReader.language(this.gb))if(G=ab.a.He(G))b.setAttribute("xml:lang",G.name),b.setAttribute("lang",G.name);b.style.fontWeight=y.isBold?"bold":"normal";b.style.fontStyle=y.isItalic?"italic":"normal";b.style.verticalAlign="baseline";y.isSuperscript&&(b.style.verticalAlign="super");y.dG&&(b.style.verticalAlign=
"sub");y.uE&&(l="underline");if(y.cG||y.j0)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=R?R:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";y.YUa?1===y.capitalization?b.style.fontVariant="small-caps":2===y.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.vWb=c.GLe;M.a.instance.ga(49)&&(y.qbb&&(l=y.lS,l!==oc.a.auto&&(f=oc.a.fH(l))),y.cVa&&(y=y.highlight,y!==oc.a.auto&&(f=oc.a.fH(y))));this.gb.properties.sa(Ya.a.Zog,
!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Ne.a.Uca,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Ne.a.Uca),f?(b.style.backgroundColor=f,Qk.mAf(f,b)):M.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.GLe!==oc.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,Qk.mAf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,
"Highlight"));a&&(b.style.color=a);c=he.OutlineElementReader.Jm(rc.OutlineElementNavigator.AB(this.gb));this.Qc.lm&&(c?Sys.UI.DomElement.addCssClass(b,"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(zb.ParagraphReader.IL(this.gb)){case 1:b.style.textAlign="left";b.style.Tmb="";break;case 2:b.style.textAlign="center";b.style.Tmb="";break;case 3:b.style.textAlign="right";b.style.Tmb="";break;case 6:b.style.textAlign="justify";b.style.Tmb="auto";break;case 7:b.style.textAlign="justify";b.style.Tmb=
"distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.Tmb="kashida";break;case 13:b.style.textAlign="justify";b.style.Tmb="inter-cluster";break;default:b.style.textAlign="",b.style.Tmb=""}4===Sc.App.mode&&M.a.instance.ga(86)&&z.a.Yj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");M.a.instance.ga(54)&&(xb.d(b,wa.a.Ux,this.gb.sa(sb.a.zo,0)),xb.d(b,wa.a.IPk,this.gb.id.toString()));this.QPe.Tzh(this.gb,
b,c,this.Na)}}Pqj(){var a=M.a.instance.ga(71)?(a=Ka.StyleReader.qE(this.gb))?Ka.StyleReader.OQ(a):M.a.instance.ga(61)?Ka.StyleReader.wNa:Ka.StyleReader.Mpa:Ka.StyleReader.Mpa;return a}Khj(a){let b="";var c=Ka.StyleReader.qE(a);c&&(b+=c.id);Ka.StyleReader.yr&&({tableStyle:a,P8a:c}=Ka.StyleReader.yr.Lab(a),a&&(b+=a.id),c&&(b+=c.id));return b}Dba(){this.gb.z9(this.Na,16,!0)}gib(){this.wJd.value&&this.gb.Bbb.gib()}AK(a){if(!this.MCl()){this.gib();var b=this.gb;this.ULf();Ga.a.yv(this.Ui);Ga.a.yv(this.Abb);
var c=this.Ui;c.style.minHeight="";this.Et=[];this.Pwd=0;var f=new Oa.a,l=0;a&&(l=this.Nqi(a,b,f,c,l));if(!this.LCl()){a=!1;var y=this.htmlElement.parentNode,G=this.htmlElement.nextSibling;y&&(this.Drc(y,this.htmlElement),a=!0);this.Lld&&this.Lld.d2l();var R=l;l=this.OPk.ydl(b,this.Od,c,this.uNj,f,Object(H.a)(this,this.mch,"onOverHyperlink"),Object(H.a)(this,this.ich,"onOutHyperlink"),Object(H.a)(this,this.uK,"takeOwnershipOfSubtree"),Object(H.a)(this,this.hp,"takeOwnership"),da.a.aSc,this.xwg,l,
this.Yob,this.Zob,this.PVb,Qk.E4c,!!this.fS&&this.fS.xIb,this.RGd,Sc.App.uS.W2e,he.OutlineElementReader.Jm(rc.OutlineElementNavigator.AB(this.gb)));if(!w.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||this.qw.wLf(b,f))this.qw.MMh(c,this.Od,l.eyf,b,R,f,ze.a.instance.Pa?ze.a.instance.Pa.nb:null,this.I5c)||this.Od.yp||this.qw.HRh(b);this.Et=f.toArray();this.wEc=l.R6g;this.Fef=l.HLf;this.RGd=l.mjg;this.Lld&&this.Lld.Z1l(this.xgh);this.ssh&&this.ssh.b2l(c);this.kQh();this.oHd=
!0;a&&y.insertBefore(this.htmlElement,G);!this.Qc.lm&&y&&"li"===na.a.ug(y.tagName)&&this.Tqi(b,y);this.Qc.lm||this.qw.oOf(c)}}}Tqi(a,b){if(Bb.ListReader.ioa){if(b=this.YWc(a)){const c=b.qc(this.Qc.Na);if(c){const f=Ga.a.Rda(this.htmlElement,"Paragraph");this.wPk(a)?(a=(a=this.Dqj(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):Ga.a.hTd(f,c.htmlElement);b.anchor.sk(this.Na,64)}}}else this.QWa.qQf(b,a,this.Na)}Dqj(a){for(let b=0;b<a.children.length;b++){const c=
a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}wPk(a){if(!a)return!1;a=a.Sa;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Cq:!1:!1}YWc(a){const b=new ub.GraphIterator;b.set(a);return b.kf()?(rc.OutlineElementNavigator.Se(b),this.Xf.gg&&!b.kJ(4)?b.Db(31):b.Db(4)):null}Nqi(a,b,c,f,l){a=wf.a.pb(a.D2,a.currentNode);if(!a.Ri())return l;let y=0,G=!1,R=0,ja=0,za=0,Va=!1;const hb=zb.ParagraphReader.rX(b),Cb=this.wJd.value;do{const lc=a.ir.htmlElement;Sys.UI.DomElement.containsCssClass(lc,
da.a.xW)?(Cb&&b.Bbb.D2l?(Va||(Bb.ListReader.Gx&&hb||b.Bbb.v2l(this.Abb),f.appendChild(this.Abb)),this.Abb.appendChild(lc)):f.appendChild(lc),N.a.dw(lc,da.a.GGa,l++),c.add(lc),this.Qc.Uh&&({rAk:R,Vyk:ja,Uyk:za}=Qk.Xql(b,lc,Cb,a,Va,R,ja,za)),G=Va=!0):f.appendChild(lc)}while(a.nFa());Cb?this.Qc.lm?this.sTl():(this.nQh(za+6,ja+6),y=ja+6):y=ja-R+6;G&&!Sc.App.instance.LOj&&this.Qc.Uh&&f.clientHeight<y&&(f.style.minHeight=y+"px");return l}nQh(a=0,b=0){this.wJd.value&&this.gb.Bbb.u2l(this.Abb,a,b)}zzd(){const a=
new wf.a(this.Na);a.set(this.gb);a.kf();rc.OutlineElementNavigator.Se(a);Bb.ListReader.Gx&&(this.QPe.Tzh(this.gb,this.Ui,he.OutlineElementReader.Jm(a.currentNode),this.Na),this.QWa.PTl(a))}kQh(){this.d0.Anc(this.gb,this.Ui)}QWi(){const a=Fb.a.instance.rb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.NZ=this.MZ=this.Zob=this.Yob=-1)}get Tja(){return this.Qc.lm?this.gb.qc(this.Qc.Nf.Na).Tja:this.Yob}set Tja(a){this.Yob!==
a&&(this.Yob=a,this.xpa(16),this.gb.anchor.sk(this.Qc.Na,16))}get Uja(){return this.Qc.lm?this.gb.qc(this.Qc.Nf.Na).Uja:this.Zob}set Uja(a){this.Zob!==a&&(this.Zob=a,this.xpa(48),this.gb.anchor.sk(this.Qc.Na,48))}get oT(){return this.Qc.lm?this.gb.qc(this.Qc.Nf.Na).oT:this.MZ}set oT(a){this.MZ!==a&&(this.MZ=a,this.xpa(16),this.gb.anchor.sk(this.Qc.Na,16))}get xsa(){return this.Qc.lm?this.gb.qc(this.Qc.Nf.Na).xsa:this.NZ}set xsa(a){this.NZ!==a&&(this.NZ=a,this.xpa(48),this.gb.anchor.sk(this.Qc.Na,
48))}get F9(){return this.Qc.lm?this.gb.qc(this.Qc.Nf.Na).F9:this.PVb}set F9(a){this.PVb!==a&&(this.PVb=a,this.xpa(16),this.gb.anchor.sk(this.Qc.Na,16))}get ZZf(){return this.Et[this.Et.length-1]}dispose(){this.k$k();super.dispose();this.ULf();for(let a of this.Fef)a.sWf(this.Od)}k$k(){if(this.f4a&&this.htmlElement)for(let a of this.f4a)a.j$k(this.htmlElement)}loa(){super.loa();this.RGd&&this.Qc.notify(2)}vzd(a){const b=w.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Qc.tPe.fde(this.gb);
this.IMd.gsh(c,this.f4a,this,this.htmlElement,b,this.Zxl());this.f4a=c;this.oHd||this.kQh();this.oHd=!1;super.vzd(a)}xpa(a){this.S6h.MDh(this.gb)||super.xpa(a)}MCl(){if(this.prg()){const a=this.Qc;if(1!==a.editingView.Xvb)return a.k3d=!0}return!1}LCl(){return this.Qc.lm&&Jb.SelectionEditor.Hua(ze.a.instance.Pa.nb)?!0:!1}sTl(){var a=this.gb.qc(this.Qc.Nf.Na);a&&(a=Sys.UI.DomElement.getBounds(a.Abb),this.nQh(a.width,a.height))}Zxl(){return!this.prg()&&!this.Qc.lm}prg(){if(ra.InteractiveViewManager.instance.Rd!==
this.Qc)return!1;const a=this.Qc.editingView;return a.Eg===this.gb&&2===a.mode}c4j(){const a=this.getBounds(),b=Cd.a.mi(this.Qc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}cKe(a){a.tth(this);0<this.Pwd&&a.ifl(this)}get WZa(){return this.Ui}FQh(a){this.eef=new Oi.a(0,a,0)}getBounds(){const a=T.a.cub(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Qc.Uh?this.gb.id.toString():"");this.QPe.kmi(this.gb,a,he.OutlineElementReader.Jm(rc.OutlineElementNavigator.AB(this.gb)),
this.Qc.Na);return a}mch(a){wk.a.Wtl(a.Bc,a.MD);if(Sc.App.I1b){const b=a.Bc,c=b.querySelector(".NormalTextRun")||b;M.a.instance.ga(8)||a.D_?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,Qk.CKe);rl.a.instance().gji(Object(H.a)(this,this.fNe,"onCtrlKeyDown"));rl.a.instance().hji(Object(H.a)(this,this.hNe,"onCtrlKeyUp"))}return!0}ich(a){Sys.UI.DomElement.removeCssClass(a.Bc,Qk.CKe);rl.a.instance().erh(Object(H.a)(this,this.fNe,"onCtrlKeyDown"));rl.a.instance().grh(Object(H.a)(this,
this.hNe,"onCtrlKeyUp"));return!0}ULf(){for(let a=0;a<this.MOa.count;a++)Sc.App.Mb.tS.Bb(pa.a.Vfa,this.MOa.ga(a),Object(H.a)(this,this.mch,"onOverHyperlink")),Sc.App.Mb.tS.Bb(pa.a.Wfa,this.MOa.ga(a),Object(H.a)(this,this.ich,"onOutHyperlink")),rl.a.instance().erh(Object(H.a)(this,this.fNe,"onCtrlKeyDown")),rl.a.instance().grh(Object(H.a)(this,this.hNe,"onCtrlKeyUp"));this.MOa.clear();if(this.wEc){for(let a of this.wEc)Sc.App.Mb.tS.Bb(a.eventName,a.Bc,a.handler);this.wEc=null}}fNe(){this.bza("pointer")}hNe(){this.bza("text")}bza(a){for(let b=
0;b<this.MOa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.MOa.ga(b),Qk.CKe)){const c=this.MOa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get E4c(){return!!ze.a.instance.Pa&&!!ze.a.instance.Pa.nb&&ze.a.instance.Pa.nb.E4c}static mAf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static Xql(a,b,c,f,l,y,G,R){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.Bbb.g1l(f.currentNode),b.x=a.x,b.y=a.y,b.height&&
b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<y)y=b.y;if(!l||a>G)G=a;b=b.x+b.width;if(!l||b>R)R=b;return{rAk:y,Vyk:G,Uyk:R}}}Qk.wjg="HiddenParagraph";Qk.CKe="MouseIsOn";Object(m.a)(Qk,"ParagraphViewElement",wk.a,[646,1468,340,305,108]);class gk extends wk.a{constructor(a,b,c,f,l,y){super(a,b);this.fh=this.hd=this.nca=this.QMd=null;Bb.ListReader.ioa?(this.RVf(),this.a2e(!0),this.nca=c,this.QMd=l,this.hd=y,this.fh=f,this.X2a(!0)):(this.a2e(!1),a=this.Od.vp(Fa.a.span),a.className=
"ListGhost",this.jc(a))}X2a(a){if(Bb.ListReader.ioa){var b=this.hbg(this.gb);a&&(a=this.j2d(),this.jc(a),(b=Object(sa.a)(Qk,b.qc(this.Qc.Na)))&&b.htmlElement&&(b=b.Ui))&&((a=Ga.a.L7b(b,gk.tdb))?b.replaceChild(this.htmlElement,a):Ga.a.hTd(b,this.htmlElement))}}get ote(){return Ga.a.L7b(this.htmlElement,gk.Mdc)}az(){this.X2a(!1);if(!this.Qc.lm&&Bb.ListReader.ioa)if(this.hd.gg)this.Kql(this.htmlElement,this.ote,this.gb);else{const a=this.nca.QCb(this.gb);this.ote.innerText=a}}AK(a){this.Qc.lm||Bb.ListReader.ioa&&
a.currentNode.anchor.sk(this.Na,64)}cKe(a){Bb.ListReader.ioa&&a.tth(this)}get WZa(){return this.htmlElement}FQh(){}zzd(){this.Lql()}Q$f(){return-1}Kql(a,b,c){var f=this.fh.pce(c);if(f)if(12!==f.type)Ea.a.instance.shipAssertTag(34930713,8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Sa,y=l?l.last.Qo:null;l=l?l.last.Fp:null;var G=f.nnb,R=f.SKb,ja=f.h9();f=!!G&&R.q8f(ja).Ta(sb.a.listID);G=null;f&&(G=R.Ta(sb.a.listID)&&ja.Ta(sb.a.listID)?3:R.Ta(sb.a.listID)?2:1);R=this.nca.QCb(c);
c=this.nca.QCb(c);y=!!y||f&&(1===G||3===G);l=!!l||f&&(2===G||3===G);G=!y&&!l&&""!==R&&R!==c;for(ja=!y&&!l&&!G;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,Lb.mte);Sys.UI.DomElement.removeCssClass(a,Lb.B4);if(ja)b.innerText=c;else{if(l||G)ja=Xc.a.createElement(b.ownerDocument,Fa.a.span),Sys.UI.DomElement.addCssClass(ja,Lb.IKh),ja.innerText=R,b.appendChild(ja);if(y||G)R=Xc.a.createElement(b.ownerDocument,Fa.a.span),Sys.UI.DomElement.addCssClass(R,
Lb.KKh),R.innerText=c,b.appendChild(R);y||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Lb.mte);f&&Sys.UI.DomElement.addCssClass(a,Lb.B4)}}else Ea.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}hbg(a){if(!a)return null;const b=new ub.GraphIterator;b.set(a);b.kf();return rc.OutlineElementNavigator.Se(b)?b.Db(2):null}j2d(){const a=this.Od.vp(Fa.a.span);Sys.UI.DomElement.addCssClass(a,gk.tdb);this.nPc(a);return a}nPc(a){const b=Xc.a.createElement(a.ownerDocument,
Fa.a.span);Sys.UI.DomElement.addCssClass(b,gk.Mdc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}Lql(){if(!this.Qc.lm){var a=this.hbg(this.gb),b=a.qc(this.Qc.Na).htmlElement.parentNode;!this.Qc.lm&&b&&"li"===na.a.ug(b.tagName)&&this.nca.CQh(b,a,this.Na,this.ote,!1)}}}gk.tdb="ListMarkerWrappingSpan";gk.Mdc="ListMarker";Object(m.a)(gk,"NumberListViewElement",wk.a,[1468,340,305,108]);var Lf=d(399),am=d(1133);class jo{constructor(a,b){this.offsetWidth=a;this.offsetHeight=
b}}Object(m.a)(jo,"ListMarkerOffset",null,[]);class Rk{constructor(){this.Xok="ListMarkerMeasuringPad";this.mic=new Qe.a}Mnj(a){let b=a.innerHTML;if(!b.length)return new jo(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.mic.Gb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,
a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),am.a.Y0b(),am.a.Eab(this.Xok).appendChild(a),{width:c,height:a}=Cd.a.bWc(a),this.mic.$(b,new jo(c,a)),am.a.P5b());return this.mic.ga(b)}}Object(m.a)(Rk,"ListMarkerOffsetCache",null,[1442]);var ve=d(1261),I=d(1278),V=d(83),Ba=d(258),cb=d(187),Nb=d(500);class Ec{constructor(a,b){this.hd=this.ZZ=this.XK=null;this.fh=a;this.TG=b;this.OG=Bb.ListReader.Gx;this.Fx=z.a.Fx||z.a.Io}get Vf(){return this.fh}get XM(){return this.TG}get hM(){return this.XK||
(this.XK=Fb.a.instance.rb("Box4.List.ListSettings"))}get Gka(){return this.ZZ||(this.ZZ=Fb.a.instance.Ia("Common.IZoomManager"))}set Gka(a){this.ZZ=a}get Xf(){return this.hd||(this.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.OG}QCb(a){const b=this.Vf.qab(a);return b&&b.propertySet.sa(Ya.a.ej,null)?1===b.listType?this.NHf(b):0===b.listType?this.Z8g(b,a):"":""}OTl(a,b){if(this.enabled&&b&&(this.Vf.Aea(b)||this.Xf.gg&&63===b.type)&&this.sBb(a)){a.style.display=
"block";var c=this.Eyb(a);this.Ctd(a,b);c&&(a=this.QCb(b),c.innerText=a)}}qQf(a,b,c){if(this.enabled&&this.sBb(a)){var f=this.Eyb(a);f&&this.CQh(a,b,c,f)}}CQh(a,b,c,f,l=!1){var y=ub.GraphIterator.pb(b);y.kf();rc.OutlineElementNavigator.Se(y);if(Bb.ListReader.Hk(y)||this.Xf.gg&&Bb.ListReader.Fcc(y)){const R=y.currentNode;var G=he.OutlineElementReader.Jm(R);this.Xf.gg?this.Vf.h7g(y):this.Vf.Yna(y);y=y.currentNode;if(!Bb.ListReader.ioa){const ja=this.QCb(y);f.innerText=ja}f.setAttribute(Ne.a.NI,Ne.a.rB);
12!==b.type?Nb.a.J2c(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.qyb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=G?"13px":c+"px",f.style.marginRight=G?c+"px":"13px",Ga.a.hpl(f,G?"right":"left"),G=0,{height:G}=this.qyb(a.parentNode),f.style.marginTop=Math.max((G-b)/2,0)+"px"):(this.otl(a,f,b,R,y,c),this.eaf(b,f,c,y,G,l))}}PTl(a){this.enabled&&a&&a.ir&&he.OutlineElementReader.Jm(a.currentNode)}daf(a,b,c,f,l=-1){this.enabled&&(zb.ParagraphReader.rX(a)||
this.Xf.gg&&zb.ParagraphReader.v0j(a))&&this.AQh(a,b,c,l,null)}MTl(a,b,c){if(this.enabled&&this.sBb(a)){var f=Ga.a.X6f(a,Ec.T_i);if(f&&(f=Ga.a.X6f(f,Ec.S_i))&&(f=Ga.a.c9(f,Ec.pga))&&f.style&&(z.a.mg||(f.style.marginTop="0px"),(a=Ga.a.c9(a,Ec.MPk))&&(a=Ga.a.c9(a,Ec.pga))&&f.className.startsWith(Ec.pga))){if(this.Xf.gg){var l=Ga.a.byb(a,Ec.MMa);var y=Ga.a.byb(f,Ec.MMa)}else l=this.f9d(a,Ec.MMa),y=Ga.a.c9(f,Ec.MMa);l&&y&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?
"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{a3f:b,P2f:c}=this.yQh(a,f,l,y,b,c),this.Cmi(b,c,f))}}}f9d(a,b){return Ga.a.c9(a,b)}yQh(a,b,c,f,l,y){var G;""!==a.style.textIndent&&(y&&this.Vf.udb||""===b.style.textIndent)&&(y=a.style.textIndent,this.Vf.udb&&(G=this.XWc(a))&&(y=this.Nyi(G,y)),b.style.textIndent=y);y=this.nyb(c);G=this.nyb(f);Math.floor(G.x)!==Math.floor(y.x)?(a=this.Zyi(l,y,G),a=isNaN(a)?
0:a,""!==b.style.textIndent&&(l=b.style.textIndent,y=l.lastIndexOf("px"),0<y&&(l=l.substring(0,y),a+=parseInt(l))),b.style.textIndent=a+"px",y=this.nyb(c),G=this.nyb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{a3f:y,P2f:G}}Zyi(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.hM.g2j||(f=this.ibg(a,b,c)):f=this.ibg(a,b,c);return f}ibg(a,b,c){return a?c.x-b.x:b.x-c.x}Nyi(a,b){let c=b,f;({width:f}=this.qyb(a));if(f){var l=a.style.marginLeft,y=a.style.marginRight;const G=l.lastIndexOf("px"),
R=y.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<G&&0<R&&(l=this.UPe(l,G),y=this.UPe(y,R),(b=this.UPe(b,a))||l||y)&&(c=b+f+l+y+"px")}return c}UPe(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}Cmi(a,b,c){if(z.a.mg){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}Q$f(a,b=!1){return(a=this.Eyb(a))?({width:a}=this.qyb(a),b?a+0:a):0}Eyb(a){return this.enabled&&this.sBb(a)?(a=Nb.a.Vnj(a))?
this.O$f(a):null:null}Ctd(a,b,c=!1){if(this.enabled&&this.sBb(a)){if(this.Xf.gg){var f="1";var l=this.Vf.lce(b)}else f=this.Lnj(b),l=this.Vf.qab(b);b=this.l8b(b,l);c?(xb.d(a,wa.a.eUi,b),xb.d(a,wa.a.role,Ne.a.fRa),xb.d(a,wa.a.dUi,f)):(xb.d(a,wa.a.sqi,b),xb.d(a,wa.a.role,Ne.a.fRa),xb.d(a,wa.a.$Ef,f))}}O$f(a){if(!this.enabled||!a)return null;let b=null;(a=this.XWc(a))&&(b=Ga.a.c9(a,Ec.Mdc)||this.nPc(a));return b}sBb(a){return!!a&&"li"===na.a.ug(a.tagName)}AQh(){}g8f(){return 720}qyb(a){let b,c;({width:b,
height:c}=Cd.a.bWc(a));this.Gka&&this.Gka.instance&&this.Gka.instance.frg(a)&&(b/=this.Gka.instance.U3,c/=this.Gka.instance.U3);return{width:b,height:c}}nyb(a){const b=Cd.a.bWc(a).returnValue;this.Gka&&this.Gka.instance&&this.Gka.instance.frg(a)&&(b.x/=this.Gka.instance.U3,b.y/=this.Gka.instance.U3);return b}Rka(a,b){switch(a.Rka()){case 0:return b+"";case 4:return na.a.GPf(b-1,!0);case 2:return na.a.IPf(b,!0);case 3:return na.a.GPf(b-1,!1);case 1:return na.a.IPf(b,!1);case 22:return 10>b?"0"+b:b+
"";default:return b+""}}NHf(a){if(1!==a.listType)return"";a=this.aqj(a.listType,a.listStyle);return Ba.a.dHf(a[0])}Z8g(a,b){b=this.l8b(b,a);return this.Rka(a,b)+"."}aqj(a,b){return cb.a.SN(a,b).propertySet.sa(Ya.a.ej,null)}l8b(a,b){const c=b.nka;return c!==Ba.a.ex?c:this.ezi(a,b)}ezi(a,b){if(b.AX!==Ba.a.ex)return b.AX;if(b.VA!==Ba.a.ex)return b.VA;let c=1;const f=new ub.GraphIterator;f.set(a);f.kf();for(rc.OutlineElementNavigator.Se(f);f.pua();)if(Bb.ListReader.Hk(f)){const l=this.Vf.Hv(f);if(l&&
b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.AX!==Ba.a.ex)return c+l.AX;if(l.VA!==Ba.a.ex)return c+l.VA;if(a.Ta(sb.a.listID)&&f.currentNode.Ta(sb.a.listID)&&f.currentNode.eb(sb.a.listID)!==a.eb(sb.a.listID))break;c++}}return c}sVl(a,b){Sc.App.sdb&&(a.Ta(Ya.a.fontColor)&&(b.fontColor=a.eb(Ya.a.fontColor)),a.Ta(Ya.a.fontSize)&&(b.fontSize=a.eb(Ya.a.fontSize)),a.Ta(Ya.a.font)&&(b.fontName=a.eb(Ya.a.font)),a.Ta(Ya.a.bold)&&(b.isBold=a.eb(Ya.a.bold)),a.Ta(Ya.a.italic)&&(b.isItalic=a.eb(Ya.a.italic)),
a.Ta(Ya.a.superscript)&&(b.isSuperscript=a.eb(Ya.a.superscript)),a.Ta(Ya.a.subscript)&&(b.dG=a.eb(Ya.a.subscript)),a.Ta(Ya.a.strikethrough)&&(b.cG=a.eb(Ya.a.strikethrough)),a.Ta(V.a.rt)&&(b.j0=a.eb(V.a.rt)))}ide(a,b){a=zb.ParagraphReader.Cdg(a,M.a.instance.ga(53),M.a.instance.ga(71),M.a.instance.ga(77),M.a.instance.ga(54));this.sVl(b,a);return a}Y7f(){return null}BQh(a,b,c,f){const l=c.parentNode;let y=f.sa(Ya.a.fontSize,be.Font.SI);if(a.dG||a.isSuperscript)xb.d(c,wa.a.oTf,(y/2).toString()),y=Math.floor(y*
Gb.D$i),l&&(l.style.fontSize=y/2+"pt"),c.style.fontSize=y/2+"pt";else if(Bb.ListReader.ioa){if(c.style.fontSize=y/2+"pt",!f.Ta(Ya.a.fontSize)&&(a=Ga.a.byb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}otl(a,b,c,f,l,y){b&&this.sBb(a)&&(b.style.verticalAlign=a.style.verticalAlign,f&&l&&Sc.App.sdb&&(y=f.rg(y)))&&(f=this.ide(c,l,M.a.instance.ga(53),M.a.instance.ga(71),M.a.instance.ga(77),M.a.instance.ga(54)),f=this.Y7f(y.Od,c)||f,this.a8b(a,b,l),!this.Xf.gg||""===
b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Lb.mte)?(c="",f.w4&&(y=f.fontColor,y!==oc.a.auto&&(c=oc.a.fH(y))),b.style.color=c,c=this.Vf.qab(l)):c=this.Vf.lce(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?b.style.verticalAlign="super":f.dG&&(b.style.verticalAlign="sub"),this.BQh(f,a,b,l),f.cG||f.j0)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":
"line-through")}a8b(a,b){b.style.fontFamily=a.style.fontFamily}XWc(a){return a?Ga.a.L7b(a,zd.a.tdb)||this.j2d(a):null}nPc(a){const b=Xc.a.createElement(a.ownerDocument,Fa.a.span);Sys.UI.DomElement.addCssClass(b,Ec.Mdc);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}j2d(a){if(!a)return null;const b=Xc.a.createElement(a.ownerDocument,Fa.a.span);Sys.UI.DomElement.addCssClass(b,zd.a.tdb);Ga.a.hTd(a,b);this.nPc(b);return b}eaf(a,b,c){this.daf(a,b.parentNode.parentNode,this.XM.syb(a).PRb,
this.XM.gab(a).PRb,c)}}Ec.pga="Paragraph";Ec.MPk="ParaWrappingDiv";Ec.S_i="_EditingElement";Ec.T_i="_EditingElement_WrappingDiv";Ec.MMa="TextRun";Ec.Mdc="ListMarker";Object(m.a)(Ec,"AListMarkerUtility",null,[1443]);var Oc=d(66),je=d(828);class De{}De.gYd=8226;De.LHf="Arial";De.A3d=65532;De.JJa=65533;Object(m.a)(De,"PptListConstants",null,[]);var Pd=d(63),Ke=d(235);class xg extends Ec{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){super(a,b);this.Rhk=[12295,19968,20108,19977,22235,20116,
20845,19971,20843,20061];this.Jue=c;this.mic=f;this.Ga=l;this.om=y;this.Juk=G;this.Tb=R;this.wD=ja;this.Hh=za;this.MJ=Va;this.KH=hb;this.zA=Cb;this.vzg=lc;this.oYa=ic;this.DA=jc;this.hwa=yc;this.Hhc=ec}Lnj(a){const b=new ub.GraphIterator;b.set(a);b.kf();rc.OutlineElementNavigator.Se(b);return b.currentNode.sa(sb.a.listLevel,0)+1+""}AQh(a,b,c,f,l=null){const y=this.Jue.eq(ea.a.NTl);l=new wf.a(f);l.set(a);l.kf();rc.OutlineElementNavigator.Se(l);if(Bb.ListReader.Hk(l)){if(!b){this.Jue.Yb(Yd.a.Ah,{["Reason"]:"ParagraphElementNull"});
y.end();return}f=this.O$f(b);if(!f){this.Jue.Yb(Yd.a.Ah,{["Reason"]:"ListMarkerNotFound"});y.end();return}let G=this.qyb(f).width;const R=l.ir.Od.Nd;a=R.xK(this.XM.k9(a).qN,0);c=R.xK(ve.a.tga(c,0),0);this.DA&&Object(Sa.a)(376,this.zA.Rd)&&(c=0);l=he.OutlineElementReader.Jm(l.currentNode);this.Hql(b,f,a,c,G,l)}y.end()}qyb(a){a=this.mic.Mnj(a);return{width:a.offsetWidth,height:a.offsetHeight}}XWc(a){let b=a;this.oYa&&a&&0<=a.className.indexOf(uc.a.pga)&&(a=Ga.a.Rda(a,uc.a.X9))&&(b=a);return super.XWc(b)}f9d(a,
b){return this.oYa?Ga.a.c9(a,uc.a.X9)?Ga.a.byb(a,b):Ga.a.c9(a,b):super.f9d(a,b)}yQh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.nyb(c);f=this.nyb(f);return{a3f:a,P2f:f}}Rka(a,b){switch(a.Rka()){case 18:return 21>b?na.a.fromCharCode(b-1+9312):b.toString();case 19:return this.fcj(b)}return super.Rka(a,b)}NHf(a){let b="";if(1===a.listType){const c=a.propertySet.sa(Ya.a.ej,null);c&&c.length&&c[0]&&(b=na.a.vw(c[0],4))}b=this.Tmi(b?b:"2022",a);if(qd.a("FixEvalSecurityBugForListMarkerUtility")&&
String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));ya.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(I.a)(String.format("'\\u{0}'",b))}Z8g(a,b){b=this.l8b(b,a);return this.Rka(a,b)+this.$pj(a)}Hql(a,b,c,f,l,y){f?this.Jql(a,b,f,c,l,y):this.Iql(a,b,l,y)}Jql(a,b,c,f,l,y){const G=Math.max(Math.abs(c),l);a.style.textIndent=0<c?G+"px":Math.max(G-f,0)+"px";this.Izh(G-l,-1*G,b,y)}Iql(a,b,c,f){a.style.textIndent=c+"px";this.Izh(0,-1*c,b,f)}Izh(a,b,c,f){c.style.marginLeft=
f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}$pj(a){a=a.Y9;for(let b=0;b<a.length;b++)if(a[b]===De.JJa){if(b+2>=a.length)break;return a[b+2]?na.a.fromCharCode(a[b+2]):""}return"."}fcj(a){let b="";for(;0<a;)b=na.a.fromCharCode(this.Rhk[a%10])+b,a=parseInt(String(a/10));return b}Tmi(a,b){let c=a;1===b.listType&&b.lbb&&0<=Array.indexOf(xg.Cil,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}ide(a,b,c,f,l,y){if(!this.vzg)return super.ide(a,b,c,f,l,y);f=this.Tb.Lc(b);f.rc(11);f.Jg(11);l=this.MJ.JQ(f,
this.KH.Wda(f));c=new je.ParagraphStandardProperties;(y=this.om.D9(b))||this.Juk.QXj(b)?(c.fontColor=oc.a.xSa,c.fontSize=y?Pd.a.x8g:zb.ParagraphReader.wka(a,Ya.a.fontSize,be.Font.SI)):(b.Ta(Ya.a.fontColor)?c.fontColor=b.eb(Ya.a.fontColor):l&&l.Ta(Ya.a.fontColor)&&!Oc.isTableCellOrInside(f)?c.fontColor=l.eb(Ya.a.fontColor):c.fontColor=this.Hh.wka(a,Ya.a.fontColor,oc.a.nil),f=this.Hh.wka(a,Ya.a.fontSize,be.Font.SI),a=this.Ga.IEa(this.Ga.An(a)),a*=f,b.Ta(va.a.zxb)&&(a*=b.eb(va.a.zxb)),c.fontSize=a);
return c}BQh(a,b,c){this.vzg&&(b=this.wD.eJ(b))&&a.rua&&(c.style.fontSize=b.Od.Nd.Sja(a.fontSize),c.style.lineHeight="0.1")}n9f(a,b){let c="";const f=this.Vf.qab(b);1===f.listType&&f.lbb?c=f.font&&-1===f.font.indexOf(",")?aa.FontUtils.Rja(f.font):f.font:19===f.Rka()||18===f.Rka()&&21>this.l8b(b,f)?c=aa.FontUtils.Rja("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}a8b(a,b,c){a=this.n9f(b,c);b.style.fontFamily=
a;b.style.fontFamily||!z.a.ik&&!z.a.Io||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}eaf(a,b,c,f,l,y=!1){if(this.oYa){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(uc.a.X9)?b.parentNode:b,this.daf(a,b,this.XM.syb(a).PRb,this.XM.gab(a).PRb,c)}else super.eaf(a,b,c,f,l,y)}Eyb(a){return super.Eyb(a)}Dnj(a,b){return this.l8b(b,a)}Ctd(a,b,c=!1){if(this.hwa){const l=this.Tb.Lc(b);l.rc(11);
l.Jg(11);l.Db(2);if(c){if(b&&b.Ta(va.a.ypg)&&!b.eb(va.a.ypg)){var f=b.sa(Ya.a.ej,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.Eyb(a);f=this.n9f(f,b);na.a.Xa(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.sa(va.a.autonumberBulletType,8))}this.Hhc&&l.currentNode.Ta(va.a.yoe)&&!l.currentNode.eb(va.a.yoe)&&a.setAttribute("data-margin",l.currentNode.sa(sb.a.um,Ke.a.leftMargin).toString())}}super.Ctd(a,b,c)}Y7f(a,b){return this.DA&&a&&b&&(Object(Sa.a)(376,
a)||Object(Sa.a)(376,this.zA.Rd)&&a.lm)?(a=new je.ParagraphStandardProperties,a.fontName=be.Font.vT,a.fontColor=oc.a.xSa,a.fontSize=Pd.a.NDl,a):null}}xg.Cil="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(m.a)(xg,"ListMarkerUtility",Ec,[1305]);class Gg{static kgk(){"GetSpecialIndentWithTabs"in Gg.$vh||(Gg.$vh.GetSpecialIndentWithTabs=!0,ya.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}Gg.$vh={};Object(m.a)(Gg,"SessionLogger",
null,[]);class ph{constructor(a,b,c,f,l,y){this.wbd=a;this.Q$=b;this.Hh=c;this.Tb=f;this.MJ=l;this.FCg=y}Tzh(a,b,c,f=-1){let l=this.FCg;0<=f&&(l=this.t8f(a,f)||l);this.Arl(a,b,c,l);this.Brl(a,b,l,f)}t8f(a,b){let c=null;(a=a.qc(b))&&a.Od&&(c=a.Od.Nd);return c}Arl(a,b,c,f){let l=0;this.Hh.rX(a)||(l=f.xK(this.Q$.k9(a).qN,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=l+"px",b.style.marginRight="")}Brl(a,b,c,f=-1){var l=this.Q$.nWc(a).qN;a.anchor&&this.Hh.rX(a)&&0<=f?this.wbd.daf(a,
b,ve.a.xK(l,0),0,f):(f=c.xK(l,0),l=c.xK(this.Q$.k9(a).qN,0),b.style.textIndent=this.Dwj(f,l,this.oMi(a),this.Bij(a),c)+"px")}oMi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}Bij(a){let b=a.sa(sb.a.hwb,ph.mMc);if(!a.Ta(sb.a.hwb)){const c=this.Tb.Lc(a);c.set(a);c.rc(11);c.Jg(11);(a=this.MJ.JQ(c,a.sa(sb.a.listLevel,Ke.a.xFa)))&&(b=a.sa(sb.a.hwb,ph.mMc))}return b}Dwj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&
(c=0,Gg.kgk());0<c&&(f=l.xK(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}kmi(a,b,c,f=-1){var l=this.FCg;0<=f&&(l=this.t8f(a,f)||l);a=this.Q$.nWc(a).qN;l=l.xK(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}ph.mMc=1440;Object(m.a)(ph,"ParagraphViewIndentationStrategy",null,[1467]);var qg=d(433),th=d(652),ci=d(374),Hf=d(152),Xh=d(233),bm=d(266);class Qn{constructor(a,b,c){this.success=a;this.gPk=b;this.JXk=c}}Object(m.a)(Qn,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var Sm=d(616);class lg{constructor(){this.Zm=
new J.DictionaryPropertySet}eb(a){return this.Zm.eb(a)}sa(a,b){return this.Zm.sa(a,b)}Ta(a){return this.Zm.Ta(a)}get propertySet(){return this.Zm.clone()}get BL(){return this.Zm.sa(Ya.a.font,be.Font.vT)}get DV(){return this.Zm.sa(sb.a.DV,-1)}get fieldInstruction(){return this.Zm.sa(sb.a.fieldInstruction,"")}get rua(){return this.Zm.Ta(Ya.a.fontSize)}get fontSize(){return this.Zm.sa(Ya.a.fontSize,be.Font.SI)}get w4(){return this.Zm.Ta(Ya.a.fontColor)}get fontColor(){return this.Zm.sa(Ya.a.fontColor,
oc.a.nil)}get Rig(){return this.Zm.Ta(Sm.a.G2b)}get R3f(){return this.Zm.sa(Sm.a.G2b,1)}get cVa(){return this.Zm.Ta(Ya.a.highlight)}get highlight(){return this.Zm.sa(Ya.a.highlight,oc.a.nil)}get qbb(){return this.Zm.Ta(V.a.lS)}get lS(){return this.Zm.sa(V.a.lS,oc.a.nil)}get Tig(){return this.Zm.Ta(Ya.a.At)}get language(){return this.Zm.sa(Ya.a.At,0)}get XUa(){return this.Zm.Ta(Ya.a.bold)}get isBold(){return this.Zm.sa(Ya.a.bold,!1)}get nbb(){return this.Zm.Ta(Ya.a.italic)}get isItalic(){return this.Zm.sa(Ya.a.italic,
!1)}get Nzb(){return this.Zm.Ta(Ya.a.underline)}get uE(){return this.Zm.sa(Ya.a.underline,!1)}get NZc(){return this.Zm.Ta(Ya.a.iw)}get iw(){return this.Zm.sa(Ya.a.iw,be.Font.IV)}get Mzb(){return this.Zm.Ta(Ya.a.strikethrough)}get cG(){return this.Zm.sa(Ya.a.strikethrough,!1)}get g$b(){return this.Zm.Ta(V.a.rt)}get j0(){return this.Zm.sa(V.a.rt,!1)}get isSuperscript(){return this.Zm.sa(Ya.a.superscript,!1)}get dG(){return this.Zm.sa(Ya.a.subscript,!1)}get bH(){return this.Zm.sa(sb.a.bH,null)}get zt(){return this.Zm.sa(Ya.a.zt,
!1)}get m0(){return this.Zm.sa(Ya.a.m0,!1)}get Wm(){return this.Zm.sa(Ya.a.Wm,!1)}get hcb(){return this.Zm.sa(sb.a.hcb,!1)}get dWa(){return this.Zm.sa(we.a.zxa,!1)}get YUa(){return this.Zm.Ta(V.a.capitalization)}get capitalization(){return this.Zm.sa(V.a.capitalization,0)}get OFa(){return this.Zm.sa(sb.a.OFa,!1)}gq(a,b){b.Ta(a)&&this.Zm.setValue(a,b.Sh(a))}static NLc(a){const b=new lg;b.Zm.setValue(Ya.a.fontSize,Pd.a.KDl);b.gq(Ya.a.superscript,a.propertySet);b.gq(Ya.a.subscript,a.propertySet);a.zt&&
b.Zm.setValue(Ya.a.underline,!0);return b}}Object(m.a)(lg,"PptSmartArtFormattingCache",null,[842]);class Cm{constructor(a,b,c,f){this.wsi=a;this.zsi=b;this.xsi=c;this.ysi=f}}Object(m.a)(Cm,"SelectionImageProperty",null,[]);var Eg=d(151),qe=d(70);class Bi{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh){this.xHg=this.wHg=!1;if(!ff)throw Error.argumentNull("graphTopologyManager");this.zA=a;this.Ga=b;this.lc=c;this.ujk=f;this.Zo=l;this.wD=y;this.zjc=G;this.Dy=R;this.Cz=
ja;this.WX=za;this.ua=ff;this.jfb=Va;this.qad=hb;this.hFb=Cb&&!xd;this.oYa=lc;this.wYa=ic;this.qFb=yc;this.khc=ec;this.jgd=jc&&!xd;this.DA=Xd;this.Uma=Qd;this.rad=Ie;this.Dlf=Pe;this.uok=ig;this.ua=ff;this.mok=bh}eab(a,b){if(b.sa(va.a.gGa,!1))return Pd.a.x8g;b=this.Ga.IEa(this.Ga.An(b));return Xg.a.vz(b,1)?a:2*Math.round(a*b/2)}EEf(a,b){if(!this.Dlf||!a)return b;const c=Bi.o9f(a);if(a===c)return b;qd.a("PPTO.TextRendering.UpdateFontFamilyWithWebFontFallback")&&(this.Dy&&this.Dy.R_j?({f7b:b}=Bi.Pyd(a,
this.Dy.Wcc(a),b)).returnValue||({f7b:b}=Bi.Pyd(c,this.Dy.HXj(c),b)).returnValue:({f7b:b}=Bi.Pyd(c,!0,b)).returnValue&&({f7b:b}=Bi.Pyd(a,!0,b)).returnValue);return b}Ruj(a){if(!this.mok||na.a.Xa(a))return null;const b=this.ua.presentation.H9d;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}p9f(a,b,c){return c.Sja(this.eab(a,b))}U6f(a,b){return a.Ta(va.a.Wub)?b.Iaa(a.eb(va.a.Wub)/qg.a.rpc,0)+"px":null}s$f(a){if(a.Ta(va.a.xCb)){const b=a.eb(va.a.xCb)/qg.a.rpc;
a=a.fontSize;return 0<b&&a*qg.a.wbb>=b?"normal":"none"}return null}xbe(a,b,c,f){let l=null;this.jfb?l=oc.a.fH(0):!c&&f||!b.w4?this.hFb&&f&&(l=M.a.instance.ga(119)?b.sa(va.a.nVa,!1)?this.P9f(a):oc.a.fH(b.fontColor):this.P9f(a)):(a=b.fontColor,l=a===oc.a.auto?"WindowText":oc.a.fH(a));return l}PDh(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.qad||a.isSuperscript||a.dG)}Vdg(a){return a.Ta(va.a.IN)?a.eb(va.a.IN)/1E3:0}Qee(){return 2/3}P9f(a){let b=null;var c=Object.assign(new th.a,{schemeClrField:Object.assign(new ci.a,
{valField:10})});a=Object(sa.a)(115,this.lc.jg(a));(c=this.ujk.YH(c,a?a.Fd:null))&&(b=Hf.Box4ColorHelper.nha(c).FV());return b}tDh(a,b){return this.hFb||a||!b}XDh(){return!0}vDh(){return this.hFb}HVl(a,b,c,f){if(!c||!c.Ua||!f||1>f.length)return b;let l=0,y=0;for(let G=0;G<f.length;G++){if(c.Ua.Ra>=y&&c.Ua.Ra<y+f[G]||c.Ua.Ra===y+f[G]&&f[G]>b.Lines[G]){l=G;break}y+=f[G]}c=0;for(const G of b.Lines)c+=G;a=a.Sa.ga(a.Sa.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}wLf(a,b){a=Object(sa.a)(Kf.AParagraphNode,
a);if(!a||!a.Sa)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}MMh(a,b,c,f,l,y,G,R){if(!(this.oYa&&a&&c&&c.length&&b))return!1;var ja=this.Ga.An(f);if(!ja)return!1;ja=this.wYa&&ja.qEb;if(!b.yp&&!ja)return!1;f=Object(sa.a)(Kf.AParagraphNode,f);if(!f||!f.Sa||!ja&&this.zjc.v9a(f))return!1;c=this.phj(c,f,!b.yp);if(this.FWi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.Zo||
this.Zo.bva)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,"JustifyAlign");return this.qFb?this.SNl(f,a,b,l,y,G,R):this.QNl(a,b,c)}HRh(a){this.wYa&&a&&(a=this.Ga.An(a))&&a.qEb&&(ya.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.Inb(!1))}znj(a,b){const c=Eg.a.ui(a,va.a.pQb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Sa.length)return ya.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",
c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Sa.ga(a.Sa.length-1).cp+1!==b)return null}return c}QNl(a,b,c){if(!c)return!1;const f=new Oa.a;for(const l of c){c=b.vp(Fa.a.span);Sys.UI.DomElement.addCssClass(c,uc.a.X9);f.add(c);let y=!1;for(let G=0;G<l;G++)if(a.firstChild)c.appendChild(a.firstChild);else{ya.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");y=!0;break}if(y)break}b=Object(sa.a)(646,this.wD.eJ(a));if(!b)return ya.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let l of f)b.hp(l),a.appendChild(l);return!0}SNl(a,b,c,f,l,y,G){if(!b||!c)return!1;let R=Eg.a.ui(a,va.a.pQb,null);if(!R||!R.Lines||!R.Lines.length)return!1;for(this.uok&&(R=this.HVl(a,R,y,G));l.count>f;)l.removeAt(f);a=new Oa.a;G=y=f=null;for(let ja=0;ja<R.Lines.length;ja++){f=c.vp(Fa.a.span);Sys.UI.DomElement.addCssClass(f,uc.a.X9);a.add(f);const za=this.Qgi(R.Lines[ja],b,f,y,G,l);y=za.gPk;G=za.JXk;this.ehk(ja,R.Lines.length,f.lastChild);if(!za.success){ya.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");
break}}for(this.DJc(y,f,l);b.firstChild;)this.DJc(b.firstChild,f,l);return this.RNl(b,a)}ehk(a,b,c){Bi.zHg||(Sf.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),Bi.zHg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!Bi.yHg&&!a&&b&&c&&(Sf.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),Bi.yHg=!0))}Qgi(a,b,c,f,l,y){let G=!0;for(;0<
a;){if(!(f&&f.innerText.length||b.firstChild)){ya.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");G=!1;break}let R;f?(l=R=f,f=null):(R=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(R,uc.a.$N)&&(l.style.lineHeight=R.style.lineHeight),l=null);const ja=R.innerText.length;a>=ja?(this.DJc(R,c,y),a-=ja):(f=R.cloneNode(!1),this.REl(R,f,a),this.DJc(R,c,y),a-=R.innerText.length)}return new Qn(G,f,l)}REl(a,b,c){a=a.childNodes;let f=-1;for(let l=
0;l<a.length;l++){const y=a[l];if(c)if(c>=y.innerText.length)c-=y.innerText.length;else{const G=y.cloneNode(!0);G.innerText=y.innerText.substring(c,y.innerText.length+1);b.appendChild(G);y.innerText=y.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}DJc(a,b,c){if(a&&b&&c){b.appendChild(a);a=Ga.a.pab(a);for(let f of a)c.add(f),N.a.dw(f,"leafEltIdx",c.count-1)}}RNl(a,b){const c=Object(sa.a)(646,this.wD.eJ(a));if(!c)return ya.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let f of b)c.hp(f),a.appendChild(f);return!0}phj(a,b,c){const f=this.uLi(this.znj(b,c));if(!f||!f.length)return null;c=f.length;const l=Array(c);let y=0,G=1;for(let R=0;R<b.Sa.length;R++)G<c&&b.Sa.ga(R).cp===f[G]&&(l[y]=a[R],y++,G++);l[c-1]=a[a.length-1];if(G!==c)return ya.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}uLi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=
Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}FWi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],uc.a.JN)||Sys.UI.DomElement.containsCssClass(a[l],uc.a.m6d)||(b=!1);if(b)return!0;c+=f}return!1}V7f(a,b,c){const f=new Yc.a;if(!a||!b||!c)return ya.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":
"null",c?"not null":"null"),f;this.hwl(a,b)&&(a=null,c.Ta(va.a.schemeColor)&&(a=c.eb(va.a.schemeColor),a=this.Rpj(b,a)),na.a.Xa(a)||f.$("data-scheme-color",a),this.rad&&c.Ta(va.a.L1c)&&(c.eb(va.a.L1c)?f.$("data-usefontface","false"):f.$("data-usefontface","true")),qd.a("HyperlinkColorBugFix")&&c.Ta(va.a.nVa)&&(c.eb(va.a.nVa)||f.$("data-hyperlinkhascustomcolor","true")));return f}Rpj(a,b){if(na.a.Xa(b))return"";const c=bm.SchemeColor.parse(b);if(c&&c.color&&!c.qua){a=Object(sa.a)(115,this.lc.jg(a));
a=c.resolve(a?a.Fd:null);if(!a)return"";c.tQ=Xh.g(a.X0a);return c.toString()}return b}hwl(a,b){return this.khc&&a.lm&&Bi.U7j(b)}oOf(a){if(this.jgd){a=a.querySelectorAll("."+Bi.g3d);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.Gdl(a[b]);for(b=0;b<c;++b)qe.a.zTj(a[b],f[b].wsi,f[b].zsi,f[b].xsi,f[b].ysi)}}Edl(a){return new Cm("linear-gradient(to right, "+qe.a.NNc+", "+qe.a.NNc+")",qe.a.U5e,"0px "+a.style.verticalAlign,qe.a.swd)}bWj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,
uc.a.H8))return!1;a=a.nextSibling}return!0}Fdl(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+uc.a.H8);for(let y=0;y<l.length;y++){const G=l[y];f+=this.Jjj(G);b=Math.min(b,G.offsetLeft);c=Math.max(c,G.offsetLeft+G.offsetWidth)}return new Cm("linear-gradient(to right, "+qe.a.NNc+", "+qe.a.NNc+")",0<c-a.offsetLeft?f+"px 100%":qe.a.U5e,b-a.offsetLeft+"px "+a.style.verticalAlign,qe.a.swd)}Gdl(a){return this.bWj(a)?this.Edl(a):this.Fdl(a)}Jjj(a){let b=0;if((a=a.getClientRects())&&
0<a.length)for(const c of a)b+=c.width;return b}X7f(a,b,c){return this.DA&&a&&b&&c&&(Object(Sa.a)(376,a)||Object(Sa.a)(376,this.zA.Rd)&&a.lm)?lg.NLc(b):null}TDh(){return!1}a8b(a){let b=a.sa(va.a.latinFont,be.Font.vT);b.startsWith("+")&&(b=a.sa(Ya.a.font,be.Font.vT));let c=new Oa.a;c.add(b);var f=[va.a.eastAsianFont,va.a.complexScriptFont,va.a.bQb];for(var l of f)a.Ta(l)&&(f=a.eb(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.Ruj(b))l=new Oa.a,l.add(b),qd.a("UseServerFallbackFontFirst")?
l.insert(0,a):l.add(a),this.Pgk(a,c),c=l;return c.toArray().join(",")}Pgk(a,b){this.wHg||aa.FontUtils.isMissingFont(b.ga(0))?this.xHg||b.contains(a)||(ya.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.xHg=!0):(ya.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.wHg=!0)}cTe(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.Dy&&this.Dy.isEnabled;const f=!!this.Cz&&this.Cz.isEnabled;if(f||c||this.Uma)b=
aa.FontUtils.Xsb(b,a,c,this.Uma,f);f&&this.Cz.createFontUrl(a);c&&(this.Dlf&&a?(c=Bi.o9f(a),this.Dy.createFontUrl(a),c&&this.Dy.createFontUrl(c)):this.Dy.createFontUrl(a));this.Uma&&this.WX.createFontUrl(a);return b}glh(a,b){return a?this.cTe(a.fontName,b):b}Z1c(){return this.Uma}static mWc(a){if(na.a.Xa(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static o9f(a){if(na.a.Xa(a))return null;a=Bi.mWc(a);let b=a.toLowerCase();for(;b;){let f=!1;b=b.trim();for(const l of Bi.G$i){var c=
l;b.endsWith("\u200b")&&(c+="\u200b");b.endsWith(c)&&(f=!0,c=b.lastIndexOf(c),b=b.substring(0,c+1))}if(!f)break}return a.substring(0,b.length)}static Pyd(a,b,c){return a&&b?(c=aa.FontUtils.Rei(Bi.mWc(a),c),{returnValue:!0,f7b:c}):{returnValue:!1,f7b:c}}static U7j(a){return a.sa(va.a.gGa,!1)?!1:!0}}Bi.g3d="Selection";Bi.BSf="SelectionShadow";Bi.G$i=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");Bi.zHg=!1;Bi.yHg=!1;Object(m.a)(Bi,
"TextRenderingStrategy",null,[1444]);class kn{constructor(){this.Vzb=[]}kWe(a){a&&!Array.contains(this.Vzb,a)&&(a.d0=this,Array.add(this.Vzb,a))}Anc(a,b){for(let c=0;c<this.Vzb.length;c++){const f=this.Vzb[c];f.Wzb&&f.Anc(a,b)}}}Object(m.a)(kn,"AHighlightManager",null,[1441]);class Tm extends kn{constructor(){super();this.XNg=this.vfc=null}get Yja(){return this.vfc}get ndb(){return this.XNg}otd(a){if(a&&((this.vfc=a)&&0===this.vfc.action&&(this.XNg=this.vfc),a.kea||a.xjb)){var b=[];for(let c=0;c<
this.Vzb.length;c++){const f=this.Vzb[c];f.Wzb&&Array.addRange(b,f.qMh(a.kea,a.xjb))}}}}Object(m.a)(Tm,"HighlightManager",kn,[]);class hk{constructor(a,b){this.xwa=a;this.Wfc=b;this.xwa.gk(Object(H.a)(this,this.$g,"onPropertyChanged"))}dispose(){this.xwa.Qm(Object(H.a)(this,this.$g,"onPropertyChanged"))}$g(a,b){a=b.node;b.property.id===va.a.pQb.id&&a.isConnected&&!this.Wfc.isComposing&&a.anchor.Nr(208)}}Object(m.a)(hk,"ParagraphNodeViewBehavior",null,[108]);class Dm{constructor(a){this.Wfc=a}MDh(a){if(a=
Object(sa.a)(5,a)){if(this.Wfc.isComposing){if(!a.n4c)return ya.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),!0;ya.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.n4c=!1}return!1}}Object(m.a)(Dm,"ParagraphViewElementCEVSetUpdateStrategy",null,[1466]);class Rn{constructor(a){this.ucd=[va.a.CX,va.a.Jx,va.a.Hea,va.a.cma,va.a.Gea,va.a.bma,sb.a.um,sb.a.QY,sb.a.xo,sb.a.MJb,sb.a.listLevel,Ya.a.Vl,Ya.a.CJ];this.$6h=a.mqe;
this.C2c=a.C2c;this.Z6h=a.pptCopyPasteMarginAndIndentationEnabled}get hmd(){return this.$6h}get PLi(){return!1}get jhh(){return this.Z6h}get UPk(){return this.ucd}lyl(a){return!!a.tagName&&"p"===na.a.ug(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,uc.a.pga)}fua(a){const b={};for(const c of this.ucd)b[c.id.toString()]=a.Sh(c);return b}spa(a,b){if(b){const c=zb.ParagraphReader.rX(a);this.Wrl(a,b,this.ucd,this.Dsg(a),c);a.setValue(we.a.hcc,!0)}}Dsg(a){let b=!1;(a=ub.GraphIterator.pb(a).parentNode)&&
he.OutlineElementReader.O9(a)&&(b=Bb.ListReader.XVa(a));return b}Xzk(a,b,c,f){this.jhh||(f=!0);if(this.hmd){const l=a.sa(we.a.hcc,!1),y=b.sa(we.a.hcc,!1),G=l||!f&&!y&&!l?b:a;this.TLi(G,l||!f&&!y&&!l?a:b,this.ucd,this.Dsg(G),c)}}yyj(a){return this.jhh&&a?zb.ParagraphReader.rX(a)&&a.Ta(va.a.xoe)&&!a.eb(va.a.xoe)&&a.Ta(sb.a.xo)?a.eb(sb.a.xo).toString():"":""}Wrl(a,b,c,f,l){for(const y of c)this.KDh(y,f,l)||(c=b[y.id.toString()],void 0!==c?a.setValue(y,c):a.removeProperty(y))}TLi(a,b,c,f,l){for(const y of c)this.KDh(y,
f,l)||(c=b.Sh(y),void 0!==c?a.Ae(y,c):a.removeProperty(y))}KDh(a,b,c){return this.C2c&&!b&&c&&(a===sb.a.um||a===sb.a.xo)}}Object(m.a)(Rn,"PptFormattingPropertyTransitStrategy",null,[1465]);class ak{}ak.COh="UnderlineColor";ak.Zyd="UnderlinePositionInEm";ak.$yd="UnderlineThicknessInEm";ak.dUc="FontSizePx";Object(m.a)(ak,"ParagraphViewElementProperties",null,[]);class Ho extends Gb{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe){super(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc);
this.eec=ec;this.UMg=jc;this.sKg=xd&&!Qd;this.jgd=Xd&&!Qd;this.VMg=Ie;this.Oed=Pe}hVd(a,b){this.eec?a.style&&!na.a.Xa(a.style.verticalAlign)&&(na.a.Xa(b.style.verticalAlign)?(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.vmi(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.hVd(a,b)}vmi(a){if(null!==a.style&&!na.a.Xa(a.style.verticalAlign)){if(this.UMg&&this.P0j(a)){const b=a.style.backgroundColor;
a.style.backgroundColor=null;qe.a.kDf(a,String.format("linear-gradient(to right, {0}, {0})",b),qe.a.U5e,String.format("0px {0}",a.style.verticalAlign),qe.a.swd)}if(this.jgd||this.UMg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}Zae(a){return this.eec?"0px":super.Zae(a)}kCf(a){a.style.position=qe.a.svc}P0j(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&
a.style.backgroundColor!==qe.a.dGi}OXe(a,b,c,f){if(this.sKg&&b.zt){if(b.cG||b.j0)a.style.textDecoration=qe.a.QGl,f[f.length]="Strikethrough";b.uE&&(f[f.length]="Underlined");let l,y;this.Oed&&({Zyd:l,$yd:y}=this.Ezj(b.BL)).returnValue?(N.a.dw(a,ak.COh,this.Dzj(c,b)),N.a.dw(a,ak.Zyd,l),N.a.dw(a,ak.$yd,y)):na.a.Xa(a.style.textDecoration)?a.style.textDecoration=qe.a.vIh:a.style.textDecoration+=" "+qe.a.vIh}else super.OXe(a,b,c,f)}Dzj(a,b){a=this.qw.xbe(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",
a)}Ezj(a){return{returnValue:"Calibri"===a,Zyd:1.1133,$yd:.0654}}PXj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,uc.a.H8))return!0;a=a.nextSibling}return!1}jCf(a,b){this.jgd&&(Sys.UI.DomElement.containsCssClass(b,uc.a.H8)||this.PXj(a,uc.a.H8)?(Sys.UI.DomElement.addCssClass(a,Bi.g3d),this.VMg&&z.a.ik&&Sys.UI.DomElement.addCssClass(a,Bi.BSf)):(Sys.UI.DomElement.removeCssClass(a,Bi.g3d),this.VMg&&z.a.ik&&Sys.UI.DomElement.removeCssClass(a,Bi.BSf)));if(this.sKg&&
Sys.UI.DomElement.containsCssClass(a.parentNode,uc.a.skg)){const c=N.a.Be(a,ak.COh),f=N.a.Be(a,ak.$yd);let l=N.a.Be(a,ak.Zyd);if(c&&f&&l){if(!na.a.Xa(a.style.fontSize)&&a.style.fontSize.endsWith("px")&&!na.a.Xa(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=parseFloat(a.style.fontSize);const y=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(y)||(l-=y/a)}qe.a.kDf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),qe.a.swd);b.style.textDecoration=qe.a.RGl}}}}Object(m.a)(Ho,
"PptParagraphContentRenderer",Gb,[]);class Em{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Xb(a){this.K=a;this.mWe();this.uWe();this.E8k();this.qWe();this.L8k();this.M8k();this.D8k()}init(){this.K.register(1441,"Box4.Highlight.IHighlightManager").na().oa(()=>new Tm);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new km.a((a,b)=>new Qk(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),
new Tb.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.lm&&w.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new km.a((a,b)=>new gk(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}mWe(){this.K.register(1442,
"PowerPointWebEditor.IListMarkerOffsetCache").na().oa(()=>new Rk);this.K.register(1443,"Box4.IListMarkerUtility").na().oa(()=>new xg(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),cc.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Kcb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}uWe(){this.K.register(1444,"Box4.ITextRenderingStrategy").na().oa(()=>new Bi(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),
this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.rb("Box4.CloudFontService"),this.K.rb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bog,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xsg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Usg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Kcb,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").qQb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").MKh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").v3c,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wsg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Y_j,this.K.resolve("PowerPointWebEditor.IApplicationSettings").kKl,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").anl))}E8k(){this.K.register(jn,"Box4.DefaultParagraphViewElementSetUpdateStrategy").na();this.K.register(Dm,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").na().oa(()=>
new Dm(this.K.resolve("Box4.IEditingView")))}qWe(){this.K.register(ph,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").na().oa(()=>new ph(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new Lf.a))}L8k(){this.K.register(Rn,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").na().oa(()=>
new Rn(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}M8k(){this.K.register(Ho,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").na().oa(()=>new Ho(ra.InteractiveViewManager.instance,ka.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.rb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),
this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.rb("Box4.IFeatureHelper"),aa.FontUtils.ZKi,this.K.rb("Box4.IFontSlotProvider"),Object(H.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").Qmh,"raiseParagraphContentUpdatedEvent"),wb.a.language,this.K.rb("Box4.ITableOfContentRenderHelper"),dc.a.lHf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Xsg,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Usg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Wsg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ywl))}D8k(){this.K.register(hk,"PowerPointWebEditor.ParagraphNodeViewBehavior").na().oa(()=>new hk(this.K.resolve("Box4.Graph.IGraphInstance").zd(12),
this.K.resolve("Box4.IEditingView")))}static main(){n.a.instance.Ac(new Em)}}Object(m.a)(Em,"PPTWebEditorParagraphPackage",null,[2,3]);var ik=d(505),Gk=d(634);class An extends Sys.EventArgs{constructor(a){super();this.Wk=a}}Object(m.a)(An,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class Io{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){this.REe=this.Dwa=null;this.Ie=a;this.Qr=b;this.Vd=c;this.pc=f;this.la=l;this.slc=y;this.Ocd=G;this.By=R;this.Hg=ja;this.Cfa=za;this.pa=Va;this.qf=
hb;this.ua=Cb;this.ia=lc;this.wb=ic;this.bfa=yc;this.$o=jc;this.lD=xd;G.FUd(Object(H.a)(this,this.rJb,"onPodSessionUnavailable"));G.Ysb(Object(H.a)(this,this.hga,"onPodSessionRefreshed"));ec.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.KFe=new pd.a(4,2,2E3,Object(H.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.yg}get occ(){return!!this.Dwa}wrj(a,b){const c=Kc.a.Jj("GetPodSessionInfo");try{const f=this.Ie.podSessionId,l=oh.a.create().toString(),
y=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),G={};G.PodSID=f;G["X-UserSessionId"]=this.slc();G["X-CorrelationID"]=l;c.Wa("PodSessionId",f);c.Wa("Cid",l);this.Qr.qW(y,2,null,G,[Yg.a.t6],0,R=>{try{if(f!==this.Ie.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Ie.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var ja=!0;if(R.data){if(c.Wa("HttpStatus",R.data.Oe.toString()),c.Wa("RequestStatus",ik.a[R.data.status]),
R.data.Dj){const za=R.data.Dj[Yg.a.t6];za&&"errorCannotFindSession"===za&&(c.Wa("ErrorCode",za),ja=!1)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");ja?(c.Wa("Result","Succeeded"),c.finish(),a&&a()):(c.Wa("Result","Failed"),c.finish(!0),b&&b())}}catch(za){ya.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",za),b&&b()}},R=>{try{if(f!==this.Ie.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Ie.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),
c.finish(!0),a&&a();else{if(R.data){if(c.Wa("HttpStatus",R.data.Oe.toString()),c.Wa("RequestStatus",ik.a[R.data.status]),R.data.Dj){const ja=R.data.Dj[Yg.a.t6];ja&&c.Wa("ErrorCode",ja)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");c.Wa("Result","Failed");c.finish(!0);b&&b()}}catch(ja){ya.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",ja),b&&b()}},null,void 0,void 0,this.la.yrj,this.la.zrj,"GetPodSessionInfo",void 0,!0)}catch(f){ya.a.J(512496141,801,
10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Wa("Result","Failed"),c.finish(!0),b&&b()}}rJb(a,b){a=!1;this.Dwa?ya.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ie.presentationId.string,this.By.Ala,this.Hg.tG,this.Ie.Wk,this.Ie.podSessionId,
!this.pc.Ho,Kc.a.vf(this.Dwa),!!this.$o.instance,b.XSc):(this.Dwa=new Date,a=!0,ya.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Ie.presentationId.string,this.By.Ala,this.Hg.tG,this.Ie.Wk,this.Ie.podSessionId,!this.pc.Ho,Kc.a.vf(this.Dwa),
!!this.$o.instance,b.XSc));this.bfa.instance&&this.bfa.instance.U2c?ya.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Ie.Wk,this.Ie.podSessionId):this.By.Ala&&this.la.podsSeamlessFailoverEnabled&&this.$o.instance?this.$o.instance.d9e(b.XSc,4,b.errorCode):(this.Vd.nla=!1,this.By.Ala?this.Hg.tG?(a&&this.wb.Hb(this.KFe),this.Cfa.oXc(this.Ie.presentationId.string,this.Ie.Wk,
this.Ie.podSessionId,b.XSc,c=>{this.ohl(c,this.Ie.Wk)},c=>{this.nhl(c,this.Ie.Wk)}),this.pa.setSelection(null),this.qf.blockContent(this.ua.presentation,"OnPodSessionUnavailable",!0),ya.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.zGj():ya.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Ie.podSessionId))}zGj(){this.REe||(this.REe=new Date);const a=+new Date-+this.REe;a>this.la.podsNullSrmWaitTimeInMs?
(ya.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Ie.podSessionId),w.AFrameworkApplication.No(Of.a.Ph(305)),Sf.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.Ja(ea.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):ya.a.J(512496134,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",
this.la.podsNullSrmWaitTimeInMs,a,this.Ie.podSessionId)}detectFailoverTimeout(){if(this.Dwa){var a=+new Date-+this.Dwa;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.wb.Kg(this.KFe),ya.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Ie.podSessionId,this.Ie.Wk),a=Object.assign(new oi.a,{Code:293,Source:6}),this.Vd.Gs(a,this.Ie.podSessionId,b=>{b.JC=1;b.dDa=8;return!1}))}}ohl(a,
b){a&&(this.Ie.Wk!==b?ya.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ie.Wk,b,this.Ie.podSessionId):(b=a.result)?(ya.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Ie.podSessionId,b.DocumentSessionID),this.Ie.podSessionId!==b.DocumentSessionID&&(a=this.Ie.podSessionId,this.Ie.podSessionId=b.DocumentSessionID,
this.Ocd.Tmh(new Gk.a(a,b.DocumentSessionID)))):ya.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Ie.podSessionId,this.Ie.Wk))}nhl(a,b){if(this.Ie.Wk!==b)ya.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Ie.Wk,b,this.Ie.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=Of.a.sL(a.error.Vm),c=a.error.Vm);
ya.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Ie.presentationId.string,this.Ie.Wk,this.Ie.podSessionId,"",Kc.a.vf(new Date),c,b);c===Of.a.Ph(241)&&(this.Hg.tG=!1,this.lD.cVe(new An(this.Hg.Fea)))}}hga(a,b){Kc.a.HCb=new Date;Kc.a.Exd=[];this.Ie.podSessionId!==b.EY?ya.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",
this.Ie.podSessionId,b.EY,this.Ie.Wk):(this.wb.Kg(this.KFe),ya.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",this.Ie.presentationId.string,this.Ie.Wk,b.$Ib,b.EY,Kc.a.vf(this.Dwa||new Date),Kc.a.vf(new Date)),this.Vd.nla=!1,this.la.podsSeamlessFailoverEnabled&&this.$o.instance?ya.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):
(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.EY,this.ia.Ja(ea.a.cMb,2,a)),this.Dwa=null)}Hn(){this.Dwa=null}}Object(m.a)(Io,"PodSessionManager",null,[1361]);var pk;(function(a){a[a.active=0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(pk||(pk={}));Object(m.b)("AppVisibilityState",pk);class Sn{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(m.a)(Sn,"GetHostSessionInfoParams",null,[]);
class ej{constructor(a,b,c,f,l,y,G,R,ja,za){this.Wdd=0;this.dIa=this.ana=this.DGe=null;this.H_g=0;this.lJe=!1;this.Ya=b;this.tjc=a;this.Hg=c;this.la=f;this.bfa=l;this.CR=y;this.nna=G;this.pc=R;this.iY=ja;this.tJa=za;this.IDb=0;this.pGb=this.la.getHostSessionInfoRequestTimeoutInMs;this.Lqk=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.Rqk=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.Cjk=f.maxPopsRehydrationCount;this.vGb=this.la.Aih;this.uGb=this.la.podsPopSessionDisconnectedTimeLimitInMS;
this.uma=!1;this.EFb=this.Ya.Wk;this.CNg="";this.Mqd();this.xLa(0,!0)}Mqd(){this.Wdd=0;this.dIa=new Date}szi(a){if(this.Cla&&!w.AFrameworkApplication.Yg&&this.pc.YL){var b=!1;this.tJa&&this.tJa.instance&&(b=2===this.tJa.instance.I7a,this.lJe||(this.lJe=!0,this.tJa.instance.YJc(Object(H.a)(this,this.$Sh,"visiblityChanged"))));var c=Object.assign(new Sn,{PopSessionID:this.Ya.Wk,PresentationID:this.Ya.presentationId.string,IsTabHidden:b});this.DGe=new Date;b=Math.min(this.pGb+2E3*this.Wdd,this.Lqk);
var f=ta.a.kI("RequestTimeout",b.toString());this.tjc.BWc(c,()=>{this.PHk(c.PopSessionID,a)},l=>{this.OHk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.pc.YL&&(ya.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",this.Cla,w.AFrameworkApplication.Yg,!!this.bfa.instance&&this.bfa.instance.U2c,!this.pc.Ho),this.close(this.Cla?this.pc.YL?
"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}xLa(a,b){this.ana=new Date;this.H_g=window.setTimeout(()=>{this.szi(b)},a)}yVl(a){ya.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.DGe);this.Mqd();this.IDb=0;this.Hg.Rse=this.dIa;this.Hg.Qse=a}PHk(a,b){this.iY.asc();this.CR.O0f(a,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.xLa(0,b):(this.yVl(a),b&&this.xLa(this.la.getHostSessionInfoPingIntervalInMs,
!0))}$Sh(a,b){ya.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",pk[b.oldState],pk[b.newState]);this.xLa(0,!1)}cAi(){return this.nna.occ||!this.Cla?(ya.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.nna.occ,this.Cla,Kc.a.vf(new Date)),!1):this.IDb>this.Cjk?(ya.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",
this.IDb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.CR.Gge(Of.a.Ph(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}Aga(a){this.cAi()&&(++this.IDb,this.CR.Aga(a),this.Mqd())}Wxl(a){if(Of.a.eU(a))switch(Of.a.sL(a)){case 326:case 240:case 103:return!0;case 329:return this.la.z9k}return!1}Wjj(a){if(Of.a.eU(a))switch(Of.a.sL(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}OHk(a,b,c){a.YY&&
200===a.YY.Oe&&this.iY.asc();if(this.CR.O0f(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.xLa(0,c);else{++this.Wdd;var f=+new Date-+this.dIa,l=44,y=-1;a&&a.error&&(l=Of.a.eU(a.error.Vm)?Of.a.sL(a.error.Vm):44,y=a.error.Vm);a=ta.a.kI("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",y,"TimeTakenInMs",+new Date-+this.DGe,"RetryCount",this.Wdd,"PopSessionDisconnectedTimeLimitInMS",this.uGb,"PopsIdleTimeLimitInMS",this.vGb,"Now",Kc.a.vf(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",
this.IDb,"LastPingScheduledTime",Kc.a.vf(this.ana),"LastSuccessfulEnsureHostSessionId",this.Hg.Pse);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(G){ya.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",G)}ya.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.ana>this.uGb?this.xLa(0,c):this.Wxl(y)?this.Aga(this.Wjj(y),y):y===Of.a.Ph(370)?
f<this.vGb?this.xLa(this.la.getHostSessionInfoPingIntervalInMs,c):this.Aga(11,y):f>=this.uGb?this.Aga(3,y):this.xLa(this.Rqk,c)}}$te(a){const b=ta.a.kI("LastUsedPopSessionId",this.EFb,"LastClientClosedReason",this.CNg,"IsClientActive",this.Cla,"AppInEditingMode",this.pc.Ho,"PopSessionDisconnectedTimeLimitInMS",this.uGb,"PopsIdleTimeLimitInMS",this.vGb,"Now",Kc.a.vf(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.IDb,"LastPingScheduledTime",Kc.a.vf(this.ana),"LastSuccessfulEnsureHostSessionId",
this.Hg.Pse);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){ya.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}ya.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}Vjb(a){ya.a.J(36282957,801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Ya.Wk,this.EFb,this.Cla);this.Cla&&this.EFb===this.Ya.Wk||
(this.EFb=this.Ya.Wk,this.Mqd(),this.uma?(this.uma=!1,this.xLa(0,!0)):ya.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Ya.Wk,this.EFb,this.Cla))}close(a){this.uma||(ya.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Ya.Wk,Kc.a.vf(new Date),a),this.lJe&&this.tJa&&this.tJa.instance&&this.tJa.instance.icl(Object(H.a)(this,
this.$Sh,"visiblityChanged")),this.uma=!0,this.EFb="",this.CNg=a,window.clearTimeout(this.H_g))}get Cla(){return!this.uma}}Object(m.a)(ej,"HostSessionInfoCaller",null,[]);class qk{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.Ewa=null;this.tjc=a;this.Ya=b;this.Mc=c;this.Hg=f;this.la=l;this.bfa=y;this.CR=G;this.nna=R;this.pc=ja;this.iY=Va;this.tJa=hb;this.Mc.GUd(Object(H.a)(this,this.Bib,"onPopSessionClosed"));this.Mc.GC(Object(H.a)(this,this.Oxa,"onSessionEnded"));this.Mc.HUd(Object(H.a)(this,this.v_a,
"onPopSessionInitialized"))}TRj(){ya.a.J(509150673,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.Hg.tG&&this.Hch()}v_a(){this.Hch()}Hch(){!this.Ewa&&this.Hg.tG?this.Ewa=new ej(this.tjc,this.Ya,this.Hg,this.la,this.bfa,this.CR,this.nna,this.pc,this.iY,this.tJa):this.Vjb("PopSessionInitialized")}Bib(){this.close("PopSessionClosed")}Oxa(){this.$te("SessionClosed")}$te(a){this.Ewa&&this.Ewa.$te(a)}Vjb(a){this.Ewa&&this.Ewa.Vjb(a)}close(a){this.Ewa&&this.Ewa.close(a)}get Cla(){return!!this.Ewa&&
this.Ewa.Cla}dispose(){this.Mc.Drh(Object(H.a)(this,this.Bib,"onPopSessionClosed"));this.Mc.rXe(Object(H.a)(this,this.v_a,"onPopSessionInitialized"))}}Object(m.a)(qk,"PopSessionInfoClient",null,[1362,108]);var $k=d(269),qj=d(216),kh=d(115),lm=d(665),xk=d(331),Jo=d(880),xp=d(866);const Um=a=>{if(Of.a.eU(a)){a=Of.a.sL(a);if(xp.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case Of.a.qEa:case Of.a.M4c:return 0;
default:return 3}};class sl{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.Ya=a;this.Hg=b;this.Vd=c;this.la=f;this.Uv=l;this.lD=y;this.U$=G;this.Cfa=Va;this.pc=hb;this.nna=ja;this.nPg=this.la.hermesNotRefreshErrorList;this.uEe=this.la.podsMaxRetryTimesForEnsureHostSession;this.JOg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.yg&&(R.wli(Object(H.a)(this,this.MMk,"onSyncLoopStatusNotified")),za.oki(Object(H.a)(this,this.KMk,"onSuccessfulOutbound")),za.Qca(Object(H.a)(this,this.Oy,"onUnifiedAppStateChanged")));
w.AFrameworkApplication.zz&&za.eKc(Object(H.a)(this,this.nga,"onWopiTokenRefreshed"))}Aga(a,b=null,c=null){var f=this.U$.F$a(this.Ya.presentationId.string);f=Object.assign(new lm.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Ya.podSessionId,PresentationID:this.Ya.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Haa,IsCoauthSession:w.AFrameworkApplication.Rg.IsCoauthSession,IsCreateNewSession:this.la.qJ,UseSharedHostFile:this.la.KRb});
this.U$.uMc(f,b,c,a)}tNe(a,b){if(this.P0f(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.Eph();else{var c=new Date;this.Ya.Wk=b.eC.PopSessionID;this.Hg.tG=!0;this.Hg.bpc=!0;this.Hg.Pse=b.eC.PopSessionID;this.Hg.Wla=c;this.lD.k2k();ya.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.l_a,b.eC.PopSessionID,b.eC.PodSessionID,this.Ya.podSessionId,Jo.a[b.trigger],b.retryCount,Kc.a.vf(b.startTime),Kc.a.vf(c),+c-+b.startTime,b.actionId);b.ZH&&b.ZH(a)}}gJb(a,b){let c=a.error.Vm;const f=new Date;if(this.P0f(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.Eph();else{if(b.retryCount<this.uEe&&+f-+b.startTime<=this.JOg){if(0===Um(c)||c===Of.a.Ph(252)){b.retryCount++;a=this.U$.F$a(this.Ya.presentationId.string);ya.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.l_a,b.eC.PopSessionID,b.eC.PodSessionID,this.Ya.podSessionId,Jo.a[b.trigger],b.retryCount,Kc.a.vf(b.startTime),Kc.a.vf(f),+f-+b.startTime,c,b.actionId);b.eC.PopSessionID=a;b.eC.IsRetrySession=!0;this.U$.AJf(b);return}this.Hg.Wla=f;var l="FatalError"}else this.Hg.Wla=f,l=b.retryCount>=this.uEe?String.format("Exceeded the limit of {0} times of retrying",this.uEe):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.JOg,+f-+b.startTime);c===Of.a.qEa&&(c=0===b.trigger?Of.a.Ph(375):Of.a.Ph(309));ya.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.l_a,b.eC.PopSessionID,b.eC.PodSessionID,this.Ya.podSessionId,Jo.a[b.trigger],b.retryCount,Kc.a.vf(b.startTime),
Kc.a.vf(f),+f-+b.startTime,c,l,b.actionId);b.Gr&&b.Gr(a)||this.Gge(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}P0f(a,b){return a.eC.PodSessionID!==this.Ya.podSessionId?(ya.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Ya.podSessionId,a.eC.PodSessionID,b),!0):!1}Eph(){this.Hg.Wla=new Date;this.Aga(8)}MMk(a,b){a=Of.a.Ph(b.gJh);ya.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.gJh,a,this.Ya.Wk,this.Ya.podSessionId);this.Hg.tG=!1;this.lD.cVe(new An(this.Hg.Fea));this.Gge(a,"PopSessionManager::OnSyncLoopStatusNotified",b.F4i)}nga(a,b){try{b.s4c?(ya.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.D4j||(this.Aub(()=>{},()=>{}),this.Aga(9))):ya.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){ya.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}O0f(a,b){return a&&this.Ya.Wk&&this.Ya.Wk!==a?(ya.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Ya.Wk,a,this.Hg.Fea),!0):!1}Gge(a,b,c=null){ya.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.PEj(a)){if(w.AFrameworkApplication.zz&&
a===Of.a.Ph(320)){const f=$k.a.instance.IRa();if(f){ya.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.Uv.Oge(a,b)||this.j5d(a,b,c)}}Aub(a,b,c=!1){ya.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Ya.Wk,this.Ya.podSessionId,this.Hg.tG,this.Hg.Fea,this.Hg.Qmd);if(this.Hg.tG||!this.Hg.Qmd){if(this.V9e(c,
""))a(new xk.a(null)),ya.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=w.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.Cfa.zNc(this.Hg.Fea,this.Ya.podSessionId,this.Ya.presentationId.string,w.AFrameworkApplication.fa.appSettings["361"],this.Ya.Gaa,c,a,b,null,f)}this.Hg.tG=!1;this.Hg.Qmd=!0;this.lD.cVe(new An(this.Hg.Fea))}}V9e(a,b){if(!z.a.fub())return!1;try{const c=this.nej(a,b),f=this.U$d();w.AFrameworkApplication.Je.mpa(f,c);
return!0}catch(c){return ya.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}nej(a,b){const c={};c.popSessionID=this.Hg.Fea;c.podSessionID=b.length?b:this.Ya.podSessionId;c.presentationID=this.Ya.presentationId.string;c.podUrl=w.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Ya.Gaa;c.fTimeoutOrUserClose=a;return kh.c(c)}U$d(){var a=w.AFrameworkApplication.fa.Ha("368")+w.AFrameworkApplication.fa.Ha("367")+"/ClosePopWacSession";a=new qj.QueryStringBuilder(a);
a.iy(w.AFrameworkApplication.oAa,w.AFrameworkApplication.userSessionId);a.iy(w.AFrameworkApplication.QXd,w.AFrameworkApplication.buildVersion);a.iy("waccluster",this.Ya.Ck);a.iy("WacUserType",w.AFrameworkApplication.userType);a.iy(w.AFrameworkApplication.Cdb,w.AFrameworkApplication.$5c);a.iy(w.AFrameworkApplication.HN,w.AFrameworkApplication.accessToken);a.iy(w.AFrameworkApplication.oW,w.AFrameworkApplication.gm.toString());a.iy("X-UsePopsRole",this.Ya.mAa.toString());a.iy("X-PopsAffinityRoutingEnabled",
this.Ya.mGa.toString());return a=a.toString()}PEj(a){if(a!==Of.a.Ph(245))return!1;if(this.Hg.rwg>this.Hg.Wla&&this.Hg.tG)return ya.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.Hg.rwg=new Date;this.xLf(0);return!0}xLf(a){const b=this.Ya.podSessionId;this.nna.wrj(()=>{if(b!==this.Ya.podSessionId)ya.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Ya.podSessionId);else{var c=Of.a.Ph(245);this.Uv.Oge(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.j5d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Ya.podSessionId?ya.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Ya.podSessionId):this.nna.occ?ya.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.xrj?(ya.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.xLf(a+1)):(ya.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Vd.Gs(Object.assign(new oi.a,{Code:223,Source:6}),b))})}j5d(a,b,c=null){ya.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=Of.a.sL(a);Of.a.eU(a)?(a=Object.assign(new oi.a,{Code:Of.a.sL(a),Source:5,ExtraErrorParam:c}),this.Vd.Gs(a,this.Ya.podSessionId,l=>{l.JC=1;Array.contains(this.nPg,Ql.a[f].toUpperCase())||(l.dDa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.nPg,Ql.a[f].toUpperCase())||(b=8),this.Vd.eta(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}KMk(){this.Hg.tG||(ya.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Ya.Wk,!this.Ya.presentationId.string),this.Aga(5))}Oy(a,b){qd.a("Pops.CloseSessionDueToReadonly")&&b.zpe&&!this.pc.YL&&this.Hg.tG&&(ya.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.Aub(()=>{},()=>{}))}}Object(m.a)(sl,"PopSessionManager",null,[1360]);class Wd{get name(){return"PowerPointWebEditor.PodsPops"}Xb(a){a.register(1360,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").na().oa(()=>new sl(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1361,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").na().oa(()=>
new Io(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),w.AFrameworkApplication.Je,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>w.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ia("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1362,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").na().oa(()=>
new qk(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ia("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ia("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){n.a.instance.Ac(new Wd)}}Object(m.a)(Wd,"PPTWebEditorPodsPopsPackage",null,[2,3]);class Bh{constructor(a,b,c,f,l){this.K$=new Oa.a;this.jfc=this.kfc=null;this.gEg=this.Vfc=0;this.QBe=this.PBe=!1;this.AEb=ve.a.Iaa(2,0,!1);this.KZa=ve.a.Iaa(2,1,!1);this.gfd=a;this.Hgc=c;this.zl=f;this.Uq=b;this.DOg=l}get Hc(){return this.Hgc.Hc}sdh(a,b,c,f){if(!b)return!1;
this.PBe||(this.Vfc=Date.now(),this.PBe=!0);b=!1;try{if(this.zl.TEf(c.shapeNode)){this.K$.clear();this.Xyi();const l=this.Agj(c);if(a){const G=this.zl.vwj(this.zl.cJ(c,a),this.UTa(l),this.Hc,this.AEb,this.KZa);if(G.top||G.bottom||G.left||G.right)b=!0,this.zl.$uc(c,G);if(this.DOg){const R=this.zl.Zjj(this.zl.cJ(c,a),l,this.AEb,this.KZa,f);if(R.top||R.bottom||R.left||R.right)b=!0,this.zl.$uc(c,R);const ja=this.zl.$jj(this.zl.cJ(c,a),l,this.Hc,this.KZa,f,a);if(ja.top||ja.bottom||ja.left||ja.right)b=
!0,this.zl.$uc(c,ja);const za=this.zl.qoj(this.zl.cJ(c,a),l,this.Hc,this.KZa,f,a);if(za.top||za.bottom||za.left||za.right)b=!0,this.zl.$uc(c,za)}}else b=this.zl.YDl(c,this.zl.cJ(c,a),this.UTa(l),this.Hc,this.AEb,this.KZa);this.K$.addRange(this.zl.Fyi(this.zl.cJ(c,a),this.UTa(l),this.Hc));const y=this.zl.vub(this.zl.cJ(c,a),this.UTa(l));if(y.count)this.K$.addRange(y);else if(!b){let G;G=a?this.zl.XDl(this.zl.cJ(c,!0),this.UTa(l),c):this.zl.WDl(this.zl.cJ(c,!1),this.UTa(l),c,this.KZa,this.AEb);this.K$.addRange(G);
b=!!G&&0<G.count}if(this.DOg)if(a)this.K$.addRange(this.zl.PYd(this.zl.cJ(c,a),this.zl.PTa(l),this.Hc,f,a)),this.K$.addRange(this.zl.o8a(this.zl.cJ(c,a),this.zl.PTa(l),this.Hc,f,a)),this.K$.addRange(this.zl.Oyi(this.zl.cJ(c,a),this.zl.PTa(l),f));else{const G=this.zl.o8a(this.zl.cJ(c,a),this.zl.PTa(l),this.Hc,f,a);if(G.count)this.K$.addRange(G);else if(!b){const ja=this.zl.CGh(this.zl.cJ(c,!1),this.UTa(l),c,this.Hc,this.KZa,this.AEb);this.K$.addRange(this.zl.o8a(this.zl.cJ(c,a),this.zl.PTa(l),this.Hc,
f,a));b=ja}const R=this.zl.PYd(this.zl.cJ(c,a),this.zl.PTa(l),this.Hc,f,a);if(R.count)this.K$.addRange(R);else if(!b){const ja=this.zl.CGh(this.zl.cJ(c,!1),this.UTa(l),c,this.Hc,this.KZa,this.AEb);this.K$.addRange(this.zl.PYd(this.zl.cJ(c,a),this.zl.PTa(l),this.Hc,f,a));b=ja}}this.gfd.rXf(this.K$.toArray());this.gfd.visible=!0}}catch(l){this.QBe||(ya.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.QBe=!0)}return b}vdh(a){a&&(this.gfd.visible=!1,this.jfc=this.kfc=null,this.K$.clear(),
this.gfd.rXf([]),this.gEg=Date.now(),this.QBe=this.PBe=!1,ya.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.gEg-this.Vfc).toString()))}Xyi(){this.zl.g9g=this.Uq.vm(this.Hc.$U.offsetLeft-this.Hc.Qc.scrollLeft);this.zl.h9g=this.Uq.vm(this.Hc.$U.offsetTop-this.Hc.Qc.scrollTop)}Agj(a){return this.kfc?this.kfc:this.kfc=this.zl.zgj(this.zl.yvj(this.Hc,this.Hc.Na),a)}UTa(a){return this.jfc?this.jfc:this.jfc=this.zl.PTa(a)}}Object(m.a)(Bh,"SmartGuideManager",null,[1357]);var Ce=d(133),rd=d(165),
Gi=d(200),cd=d(59),vg=d(166);class yg{constructor(){this.Z7c=this.bHa=null;this.Q9c=0;this.Ceb=this.dhb=null;this.Flf=!1}get color(){return this.bHa}set color(a){this.bHa=a}get dashStyle(){return this.Z7c}set dashStyle(a){this.Z7c=a}get L9b(){return this.Q9c}set L9b(a){this.Q9c=a}get Sf(){return this.dhb}set Sf(a){this.dhb=a}get Fg(){return this.Ceb}set Fg(a){this.Ceb=a}get wH(){return this.Flf}set wH(a){this.Flf=a}length(){let a=-1;this.dhb&&this.Ceb&&(a=Math.sqrt(Math.pow(this.Ceb._x-this.dhb._x,
2)+Math.pow(this.Ceb._y-this.dhb._y,2)));return a}reset(){const a=new yg;this.bHa=a.bHa;this.Z7c=a.Z7c;this.Q9c=a.Q9c;this.dhb=a.dhb;this.Ceb=a.Ceb}}Object(m.a)(yg,"SmartGuideLine",null,[1400]);class Bn{constructor(a,b,c,f){this.distance=a;this.rXd=b;this.A6d=c;this.direction=f}}Object(m.a)(Bn,"DistancePair",null,[]);class yp{constructor(a,b){this.shape=a;this.Sk=b}}Object(m.a)(yp,"LightSet",null,[]);class cm{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(m.a)(cm,
"LightSetItem",null,[]);class Zo{constructor(){this.veb={};this.wNg=[]}ga(a){return this.veb[a]}$(a,b){a in this.veb||this.wNg.push(a);return this.veb[a]=b}get keys(){return this.wNg}}Object(m.a)(Zo,"NumberDictionary",null,[]);class Hi{constructor(a,b){this.first=a;this.second=b}}Object(m.a)(Hi,"NumberPair",null,[]);var rk=d(673);class Hk{constructor(a,b){this.eHe=[];this.zg=5;this.T4=this.Rw=2;this.VO=4;this.SB=3;this.icd=this.hcd=0;this.Uq=a;this.rHb=b}yvj(a,b){a=ub.GraphIterator.pb(a.gb);const c=
[];for(var f=a.Db(1);f;f=a.Hf(1))f=vg.a(f,b),c.push(f);return c}cJ(a,b){for(const c of this.eHe)if(c.yG(a))return c.cJ(a,b);return null}addHandler(a){this.eHe.push(a)}WDl(a,b,c,f,l){f=this.Yvd(f,Hk.bMc);l=this.Yvd(l,Hk.bMc);for(var y of f){f=a.copy();f.move(0,0-y);f=this.vub(f,b);if(f.count)return this.nMa(c,0,-y),f;f=a.copy();f.move(0,y);f=this.vub(f,b);if(f.count)return this.nMa(c,0,y),f}for(let G of l){y=a.copy();y.move(0-G,0);y=this.vub(y,b);if(y.count)return this.nMa(c,-1*G,0),y;y=a.copy();y.move(G,
0);y=this.vub(y,b);if(y.count)return this.nMa(c,G,0),y}return new Oa.a}Yvd(a,b){const c=new Oa.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}XDl(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.vub(f,b),f.count)return this.$uc(c,l),f;return new Oa.a}PTa(a){const b=[];for(const c of a)b.push(new rk.a(c.Bs()));return b}YDl(a,b,c,f,l,y){const G=new cd.a(Number.MAX_VALUE,Number.MAX_VALUE);let R=Number.MAX_VALUE;var ja=Number.MAX_VALUE;let za=[];for(const Va of c)za.push(Va);
this.rHb&&(za=this.Lgi(za,f));for(const Va of za)c=this.Koj(b,Va,R),Math.abs(G.y)>Math.abs(c)&&(G.y=c),R=Math.abs(c),c=this.Ioj(b,Va,ja),Math.abs(G.x)>Math.abs(c)&&(G.x=c),ja=Math.abs(c);ja=this.wjj(b,R,f);Math.abs(G.y)>Math.abs(ja)&&(G.y=ja);ja=this.vjj(b,R,f);Math.abs(G.x)>Math.abs(ja)&&(G.x=ja);Math.abs(G.x)>l&&(G.x=0);Math.abs(G.y)>y&&(G.y=0);return G.x||G.y?(this.nMa(a,G.x,G.y),!0):!1}Lgi(a,b){var c=this.Uq.vm(b.ye.width);b=this.Uq.vm(b.ye.height);var f=new rk.a(new Ce.a(new cd.a(0,0),new cd.a(c,
0),new cd.a(c,b),new cd.a(0,b)));a.push(f);f=new rk.a(new Ce.a(new cd.a(0,0),new cd.a(c,0),new cd.a(c,b/2),new cd.a(0,b/2)));a.push(f);c=new rk.a(new Ce.a(new cd.a(0,0),new cd.a(c/2,0),new cd.a(c/2,b),new cd.a(0,b)));a.push(c);return a}$uc(a,b){this.BZc(a,c=>{c.setOffsets(a,b)})}nMa(a,b,c){this.BZc(a,f=>{f.setPosition(a,b,c)})}BZc(a,b){for(const c of this.eHe)if(c.yG(a)){b(c);break}}vwj(a,b,c,f,l){let y=Number.MAX_VALUE,G=Number.MAX_VALUE,R=Number.MAX_VALUE,ja=Number.MAX_VALUE;var za=[];for(var Va of b)za.push(Va.copy());
b=this.Uq.vm(c.ye.width);c=this.Uq.vm(c.ye.height);Va=new rk.a(new Ce.a(new cd.a(0,0),new cd.a(b,0),new cd.a(b,c),new cd.a(0,c)));za.push(Va);this.rHb&&(Va=new rk.a(new Ce.a(new cd.a(0,0),new cd.a(b,0),new cd.a(b,c/2),new cd.a(0,c/2))),za.push(Va),b=new rk.a(new Ce.a(new cd.a(0,0),new cd.a(b/2,0),new cd.a(b/2,c),new cd.a(0,c))),za.push(b));for(const hb of za)za=this.usd([hb.Zb-a.mc,hb.mc-a.mc,hb.Zf().y-a.mc],l),this.kU(za,l)&&Math.abs(za)<Math.abs(y)&&(y=za),za=this.usd([hb.Zb-a.Zb,hb.mc-a.Zb,hb.Zf().y-
a.Zb],l),this.kU(za,l)&&Math.abs(za)<Math.abs(G)&&(G=za),za=this.usd([hb.kc-a.kc,hb.hc-a.kc,hb.Zf().x-a.kc],f),this.kU(za,f)&&Math.abs(za)<Math.abs(R)&&(R=za),za=this.usd([hb.kc-a.hc,hb.hc-a.hc,hb.Zf().x-a.hc],f),this.kU(za,f)&&Math.abs(za)<Math.abs(ja)&&(ja=za);a=new Gi.a;a.top=y===Number.MAX_VALUE?a.top:y;a.bottom=G===Number.MAX_VALUE?a.bottom:G;a.left=R===Number.MAX_VALUE?a.left:R;a.right=ja===Number.MAX_VALUE?a.right:ja;return a}TEf(a){return a.Rla||a.tj||a.Ik||a.qr||a.Wf}ejj(a,b){return Math.abs(a-
b)}Koj(a,b,c){a=[new Hi(a.mc,b.mc),new Hi(a.mc,b.Zb),new Hi(a.mc,b.Zf().y),new Hi(a.Zb,b.mc),new Hi(a.Zb,b.Zb),new Hi(a.Zb,b.Zf().y),new Hi(a.Zf().y,b.mc),new Hi(a.Zf().y,b.Zb),new Hi(a.Zf().y,b.Zf().y)];return this.bXc(a,c)}Ioj(a,b,c){a=[new Hi(a.kc,b.kc),new Hi(a.kc,b.hc),new Hi(a.kc,b.Zf().x),new Hi(a.hc,b.kc),new Hi(a.hc,b.hc),new Hi(a.hc,b.Zf().x),new Hi(a.Zf().x,b.kc),new Hi(a.Zf().x,b.hc),new Hi(a.Zf().x,b.Zf().x)];return this.bXc(a,c)}wjj(a,b,c){c=this.Uq.vm(c.ye.height);a=[new Hi(a.mc,0),
new Hi(a.mc,c),new Hi(a.Zb,0),new Hi(a.Zb,c),new Hi(a.Zf().y,0),new Hi(a.Zf().y,c)];return this.bXc(a,b)}vjj(a,b,c){c=this.Uq.vm(c.ye.width);a=[new Hi(a.kc,0),new Hi(a.kc,c),new Hi(a.hc,0),new Hi(a.hc,c),new Hi(a.Zf().x,0),new Hi(a.Zf().x,c)];return this.bXc(a,b)}bXc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.ejj(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}kU(a,b){a=Math.abs(a);return.2<a&&a<b}usd(a,b){let c=Number.MAX_VALUE;for(const f of a)this.kU(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}zgj(a,b){const c=new Oa.a;for(const f of a)this.TEf(f.shapeNode)&&f.gb!==b.gb&&c.add(f);return c.toArray()}vub(a,b){var c=new Oa.a;c.add(a);var f=new Oa.a;f.add(a);var l=new Oa.a;l.add(a);var y=new Oa.a;y.add(a);for(const G of b)G.Zb<a.mc||G.mc>a.Zb||(G.kc<a.kc&&this.fJc(c,G,2),G.hc>a.hc&&this.fJc(f,G,3)),G.hc<a.kc||G.kc>a.hc||(G.mc<a.mc&&this.fJc(l,G,0),G.Zb>a.Zb&&this.fJc(y,G,1));a=this.gXc(c,2);f=this.gXc(f,3);b=this.gXc(l,0);c=this.gXc(y,1);y=new Zo;this.oPc(y,a[0]);this.oPc(y,
f[0]);l=new Zo;this.oPc(l,b[0]);this.oPc(l,c[0]);this.tTc(y,a,2);this.tTc(y,f,3);this.tTc(l,b,0);this.tTc(l,c,1);a=new Oa.a;f=new Oa.a;this.nRf(y,a,f);this.nRf(l,a,f);this.l2a(a,1);this.l2a(f,2);a.addRange(f);for(let G of a)this.aw(G);return a}gXc(a,b){const c=new Oa.a;for(let l=0;l<a.count;++l){var f=new cm(this.kij(a,l,b),this.Eij(a,l,b),null,-1);f=new yp(a.ga(l),[f]);for(let y=l+1;y<a.count;++y){const G=f.Sk.length;let R=G;for(let ja=0;ja<G;++ja)if(!f.Sk[ja].shape&&-1===f.Sk[ja].distance&&f.Sk[ja].end>
f.Sk[ja].begin){const za=this.fjj(a,l,y,b);R+=this.xYk(a,y,ja,R,l,za,f,b);R+=this.zYk(a,y,ja,R,l,za,f,b);R+=this.nZk(a,y,ja,R,l,za,f,b);R+=this.yYk(a,y,ja,l,za,f,b)}}c.add(f)}return c.toArray()}nRf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const y=new Oa.a;for(let G of f){f=!1;for(let R of y)if(this.Vpi(G,R)){f=!0;y.remove(R);break}f||y.add(G)}for(let G of y)this.ePi(G,b,c)}}}Vpi(a,b){return this.NEf(a.rXd,b.rXd)&&this.NEf(a.A6d,b.A6d)}NEf(a,b){return a.kc===b.kc&&a.hc===b.hc&&a.mc===
b.mc&&a.Zb===b.Zb}fJc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const y=a.ga(l);if(3===c&&(b.kc<a.ga(0).hc?b.hc:b.kc)<(y.kc<a.ga(0).hc?y.hc:y.kc)||2===c&&(b.hc>a.ga(0).kc?b.kc:b.hc)>(y.hc>a.ga(0).kc?y.kc:y.hc)||0===c&&(b.Zb>a.ga(0).mc?b.mc:b.Zb)>(y.Zb>a.ga(0).mc?y.mc:y.Zb)||1===c&&(b.mc<a.ga(0).Zb?b.Zb:b.mc)<(y.mc<a.ga(0).Zb?y.Zb:y.mc)){a.insert(l,b);return}}a.add(b)}oPc(a,b){for(const c of b.Sk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Oa.a)}tTc(a,b,c){const f=new Zo;for(const l of b){for(const y of a.keys)f.$(y,
0);for(const y of l.Sk)if(0<y.distance&&y.shape)for(const G of a.keys)if(b=G,this.Vu(y.distance,b)){const R=f.ga(G);1>R&&(a.ga(G).add(new Bn(b,l.shape,y.shape,c)),f.$(G,R+1));break}}}kij(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.mc,a.mc);case 0:case 1:return Math.max(b.kc,a.kc);default:return-1}}Eij(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Zb,a.Zb);case 0:case 1:return Math.min(b.hc,a.hc);default:return-1}}xYk(a,b,c,f,l,y,G,R){const ja=a.ga(b);
l=a.ga(l);switch(R){case 3:case 2:if(ja.Zb>=G.Sk[c].begin&&ja.Zb<=G.Sk[c].end&&ja.mc<=G.Sk[c].begin)return a=new cm(G.Sk[c].begin,ja.Zb,a.ga(b),3===R?y-l.hc:l.kc-y),G.Sk[f]=a,G.Sk[c].begin=ja.Zb,1;break;case 0:case 1:if(ja.hc>=G.Sk[c].begin&&ja.hc<=G.Sk[c].end&&ja.kc<=G.Sk[c].begin)return a=new cm(G.Sk[c].begin,ja.hc,a.ga(b),0===R?l.mc-y:y-l.Zb),G.Sk[f]=a,G.Sk[c].begin=ja.hc,1}return 0}zYk(a,b,c,f,l,y,G,R){const ja=a.ga(b);l=a.ga(l);switch(R){case 3:case 2:if(ja.mc>=G.Sk[c].begin&&ja.mc<=G.Sk[c].end&&
ja.Zb>=G.Sk[c].end)return a=new cm(ja.mc,G.Sk[c].end,a.ga(b),3===R?y-l.hc:l.kc-y),G.Sk[f]=a,G.Sk[c].end=ja.mc,1;break;case 0:case 1:if(ja.kc>=G.Sk[c].begin&&ja.kc<=G.Sk[c].end&&ja.hc>=G.Sk[c].end)return a=new cm(ja.kc,G.Sk[c].end,a.ga(b),0===R?l.mc-y:y-l.Zb),G.Sk[f]=a,G.Sk[c].end=ja.kc,1}return 0}nZk(a,b,c,f,l,y,G,R){const ja=a.ga(b);l=a.ga(l);switch(R){case 3:case 2:if(ja.mc>G.Sk[c].begin&&ja.mc<G.Sk[c].end&&ja.Zb>G.Sk[c].begin&&ja.Zb<G.Sk[c].end)return a=new cm(ja.mc,ja.Zb,a.ga(b),3===R?y-l.hc:
l.kc-y),G.Sk[f]=a,a=new cm(ja.Zb,G.Sk[c].end,null,-1),G.Sk[++f]=a,G.Sk[c].end=ja.mc,2;break;case 0:case 1:if(ja.kc>G.Sk[c].begin&&ja.kc<G.Sk[c].end&&ja.hc>G.Sk[c].begin&&ja.hc<G.Sk[c].end)return a=new cm(ja.kc,ja.hc,a.ga(b),0===R?l.mc-y:y-l.Zb),G.Sk[f]=a,a=new cm(ja.hc,G.Sk[c].end,null,-1),G.Sk[++f]=a,G.Sk[c].end=ja.kc,2}return 0}yYk(a,b,c,f,l,y,G){const R=a.ga(b);f=a.ga(f);switch(G){case 3:case 2:R.mc<y.Sk[c].begin&&R.Zb>y.Sk[c].end&&(y.Sk[c].shape=a.ga(b),y.Sk[c].distance=3===G?l-f.hc:f.kc-l);break;
case 0:case 1:R.kc<y.Sk[c].begin&&R.hc>y.Sk[c].end&&(y.Sk[c].shape=a.ga(b),y.Sk[c].distance=0===G?f.mc-l:l-f.Zb)}return 0}fjj(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.kc<a.hc&&c.hc>=a.hc&&(l=c.hc);c.kc>=a.hc&&(l=c.kc);break;case 2:c.hc>a.kc&&c.kc<=a.kc&&(l=c.kc);c.hc<=a.kc&&(l=c.hc);break;case 0:c.Zb>a.mc&&c.mc<=a.mc&&(l=c.mc);c.Zb<=a.mc&&(l=c.Zb);break;case 1:c.mc<a.Zb&&c.Zb>=a.Zb&&(l=c.Zb),c.mc>=a.Zb&&(l=c.mc)}return l}ePi(a,b,c){const f=a.rXd;var l=a.A6d;switch(a.direction){case 3:var y=
Math.max(f.Zb,l.Zb),G=new yg;G.Sf=new cd.a(f.hc-this.SB,f.mc);G.Fg=new cd.a(f.hc-this.SB,y+this.zg);b.add(G);G=new yg;G.Sf=new cd.a(f.hc+a.distance-this.SB,l.mc);G.Fg=new cd.a(f.hc+a.distance-this.SB,y+this.zg);b.add(G);b=new yg;b.Sf=new cd.a(f.hc-this.SB,y+this.zg);b.Fg=new cd.a(f.hc+a.distance-this.SB,y+this.zg);c.add(b);break;case 2:y=Math.max(f.Zb,l.Zb);G=new yg;G.Sf=new cd.a(f.kc-a.distance-this.SB,l.mc);G.Fg=new cd.a(f.kc-a.distance-this.SB,y+this.zg);b.add(G);l=new yg;l.Sf=new cd.a(f.kc-this.SB,
f.mc);l.Fg=new cd.a(f.kc-this.SB,y+this.zg);b.add(l);b=new yg;b.Sf=new cd.a(f.kc-a.distance-this.SB,y+this.zg);b.Fg=new cd.a(f.kc-this.SB,y+this.zg);c.add(b);break;case 0:y=Math.max(f.hc,l.hc);G=new yg;G.Sf=new cd.a(f.kc,f.mc-this.Rw);G.Fg=new cd.a(y+this.zg,f.mc-this.Rw);b.add(G);G=new yg;G.Sf=new cd.a(l.kc,f.mc-a.distance-this.Rw);G.Fg=new cd.a(y+this.zg,f.mc-a.distance-this.Rw);b.add(G);b=new yg;b.Sf=new cd.a(y+this.zg,f.mc-this.Rw);b.Fg=new cd.a(y+this.zg,f.mc-a.distance-this.Rw);c.add(b);break;
case 1:y=Math.max(f.hc,l.hc),G=new yg,G.Sf=new cd.a(f.kc,f.Zb-this.Rw),G.Fg=new cd.a(y+this.zg,f.Zb-this.Rw),b.add(G),G=new yg,G.Sf=new cd.a(l.kc,f.Zb+a.distance-this.Rw),G.Fg=new cd.a(y+this.zg,f.Zb+a.distance-this.Rw),b.add(G),b=new yg,b.Sf=new cd.a(y+this.zg,f.Zb-this.Rw),b.Fg=new cd.a(y+this.zg,f.Zb+a.distance-this.Rw),c.add(b)}}Oyi(a,b,c){const f=new Oa.a;if(!c)return f;let l=!1;var y=!1;const G=c.equals(rd.a.west)||c.equals(rd.a.Zu)||c.equals(rd.a.iI),R=c.equals(rd.a.east)||c.equals(rd.a.TE)||
c.equals(rd.a.jF),ja=c.equals(rd.a.north)||c.equals(rd.a.Zu)||c.equals(rd.a.TE);c=c.equals(rd.a.south)||c.equals(rd.a.iI)||c.equals(rd.a.jF);for(const Va of b){if(this.bug(a,Va,!0,b)&&(G||R)){l=!0;var za=new yg;za.Sf=new cd.a(Va.kc,Va.Zf()._y);za.Fg=new cd.a(Va.hc-this.SB,Va.Zf()._y);za.wH=!0;f.add(this.aw(za))}this.bug(a,Va,!1,b)&&(ja||c)&&(y=!0,za=new yg,za.Sf=new cd.a(Va.Zf()._x,Va.mc),za.Fg=new cd.a(Va.Zf()._x,Va.Zb-this.T4),za.wH=!1,f.add(this.aw(za)))}l&&(b=new yg,b.Sf=new cd.a(a.kc,a.Zf()._y),
b.Fg=new cd.a(a.hc-this.SB,a.Zf()._y),b.wH=!0,f.add(this.aw(b)));y&&(y=new yg,y.Sf=new cd.a(a.Zf()._x,a.mc),y.Fg=new cd.a(a.Zf()._x,a.Zb-this.T4),y.wH=!1,f.add(this.aw(y)));this.l2a(f,2);return f}g6(a,b,c){var f=this.oea(a,b,!1),l=this.oea(a,b,!0);if(!f&&!l)return!1;let y=[];if(f){if(a.hc<=b.kc||a.hc<=b.hc){var G;var R=b.mc>a.mc?b.mc:a.mc;var ja=b.Zb<a.Zb?b.Zb:a.Zb;f=G=b.kc;a.hc>b.kc&&(f=G=b.hc);f=new rk.a(new Ce.a(new cd.a(f,R),new cd.a(G,R),new cd.a(G,ja),new cd.a(f,ja)));Array.add(y,f)}if(a.kc>=
b.hc||a.kc>=b.kc)R=b.mc>a.mc?b.mc:a.mc,ja=b.Zb<a.Zb?b.Zb:a.Zb,f=G=b.hc,a.kc<b.hc&&(f=G=b.kc),f=new rk.a(new Ce.a(new cd.a(f,R),new cd.a(G,R),new cd.a(G,ja),new cd.a(f,ja))),Array.add(y,f)}if(l){if(a.Zb<=b.mc||a.Zb<=b.Zb)l=b.kc>a.kc?b.kc:a.kc,R=b.hc<a.hc?b.hc:a.hc,f=G=b.mc,a.Zb>b.mc&&(f=G=b.Zb),l=new rk.a(new Ce.a(new cd.a(l,f),new cd.a(R,f),new cd.a(R,G),new cd.a(l,G))),Array.add(y,l);if(a.mc>=b.Zb||a.mc>=b.mc)l=b.kc>a.kc?b.kc:a.kc,R=b.hc<a.hc?b.hc:a.hc,f=G=b.Zb,a.mc<b.Zb&&(f=G=b.mc),l=new rk.a(new Ce.a(new cd.a(l,
f),new cd.a(R,f),new cd.a(R,G),new cd.a(l,G))),Array.add(y,l)}for(const za of c)this.ejg(za,a)||this.ejg(za,b)||(y=this.ITl(a,za,y));return 0<y.length?!0:!1}ITl(a,b,c){let f=[];for(const l of c)c=!0,l.kc===l.hc?(this.oea(l,b,!1)||(c=!1),a.hc<=l.kc&&b.hc<=a.hc&&(c=!1),a.hc<=l.kc&&b.kc>=l.hc&&(c=!1),a.kc>=l.hc&&b.kc>=a.kc&&(c=!1),a.kc>=l.hc&&b.hc<=l.kc&&(c=!1),c?b.mc<=l.mc&&b.Zb<l.Zb?f=this.xRb(f,!0,!0,!1,l,b):b.Zb>=l.Zb&&b.mc>l.mc?f=this.xRb(f,!0,!1,!1,l,b):b.mc>l.mc&&b.Zb<l.Zb&&(f=this.xRb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.mc===l.Zb&&(this.oea(l,b,!0)||(c=!1),a.Zb<=l.mc&&b.Zb<=a.Zb&&(c=!1),a.Zb<=l.mc&&b.mc>=l.Zb&&(c=!1),a.mc>=l.Zb&&b.mc>=a.mc&&(c=!1),a.mc>=l.Zb&&b.Zb<=l.mc&&(c=!1),c?b.kc<=l.kc&&b.hc<l.hc?f=this.xRb(f,!1,!0,!1,l,b):b.hc>=l.hc&&b.kc>l.kc?f=this.xRb(f,!1,!1,!1,l,b):b.kc>l.kc&&b.hc<l.hc&&(f=this.xRb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}xRb(a,b,c,f,l,y){let G,R,ja,za,Va,hb,Cb;if(c)b?(c=R=l.kc,G=y.Zb,ja=l.Zb):(G=ja=l.mc,c=y.hc,R=l.hc);else if(c||f){if(b?(c=R=za=hb=l.kc,G=l.mc,
ja=y.mc,Va=y.Zb,Cb=l.Zb):(G=ja=Va=Cb=l.mc,c=l.kc,R=y.kc,za=y.hc,hb=l.hc),f&&b&&!this.Vu(Va,Cb)||f&&!b&&!this.Vu(za,hb))f=new rk.a(new Ce.a(new cd.a(za,Va),new cd.a(hb,Va),new cd.a(hb,Cb),new cd.a(za,Cb))),Array.add(a,f)}else b?(c=R=l.kc,G=l.mc,ja=y.mc):(G=ja=l.mc,c=l.kc,R=y.kc);if(b&&!this.Vu(G,ja)||!b&&!this.Vu(c,R))b=new rk.a(new Ce.a(new cd.a(c,G),new cd.a(R,G),new cd.a(R,ja),new cd.a(c,ja))),Array.add(a,b);return a}ejg(a,b){return a.hc!==b.hc||a.kc!==b.kc||a.mc!==b.mc||a.Zb!==b.Zb?!1:!0}bug(a,
b,c,f){if(c)return c=this.Vu(a.kc,b.kc)&&this.Vu(a.hc,b.hc),this.Vu(a.hc-a.kc,b.hc-b.kc)&&!c&&this.g6(a,b,f);c=this.Vu(a.mc,b.mc)&&this.Vu(a.Zb,b.Zb);return this.Vu(a.Zb-a.mc,b.Zb-b.mc)&&!c&&this.g6(a,b,f)}Zjj(a,b,c,f,l){const y=new Gi.a;if(!l)return y;let G=Number.MAX_VALUE,R=Number.MAX_VALUE,ja=Number.MAX_VALUE,za=Number.MAX_VALUE;const Va=l.equals(rd.a.west)||l.equals(rd.a.Zu)||l.equals(rd.a.iI),hb=l.equals(rd.a.east)||l.equals(rd.a.TE)||l.equals(rd.a.jF),Cb=l.equals(rd.a.north)||l.equals(rd.a.Zu)||
l.equals(rd.a.TE);l=l.equals(rd.a.south)||l.equals(rd.a.iI)||l.equals(rd.a.jF);const lc=[];for(const ic of b)lc.push(new rk.a(ic.Bs()));for(const ic of lc)b=ic.Zb-ic.mc-(a.Zb-a.mc),this.kU(b,f)&&Math.abs(b)<Math.abs(G)&&this.g6(a,ic,lc)&&Cb&&(G=-1*b),this.kU(b,f)&&Math.abs(b)<Math.abs(R)&&this.g6(a,ic,lc)&&l&&(R=b),b=ic.hc-ic.kc-(a.hc-a.kc),this.kU(b,c)&&Math.abs(b)<Math.abs(ja)&&this.g6(a,ic,lc)&&Va&&(ja=-1*b),this.kU(b,c)&&Math.abs(b)<Math.abs(za)&&this.g6(a,ic,lc)&&hb&&(za=b);y.top=G===Number.MAX_VALUE?
y.top:G;y.bottom=R===Number.MAX_VALUE?y.bottom:R;y.left=ja===Number.MAX_VALUE?y.left:ja;y.right=za===Number.MAX_VALUE?y.right:za;return y}$jj(a,b,c,f,l,y){let G=Number.MAX_VALUE,R=Number.MAX_VALUE,ja=Number.MAX_VALUE,za=Number.MAX_VALUE,Va=!0,hb=!0,Cb=!0,lc=!0;y&&l&&(Va=l.equals(rd.a.west)||l.equals(rd.a.Zu)||l.equals(rd.a.iI),hb=l.equals(rd.a.east)||l.equals(rd.a.TE)||l.equals(rd.a.jF),Cb=l.equals(rd.a.north)||l.equals(rd.a.Zu)||l.equals(rd.a.TE),lc=l.equals(rd.a.south)||l.equals(rd.a.iI)||l.equals(rd.a.jF));
l=[];for(var ic of b)l.push(new rk.a(ic.Bs()));b=this.Uq.vm(c.ye.width);c=this.Uq.vm(c.ye.height);for(const yc of l)yc.kc>b/2&&yc.kc<3*b/4&&a.hc<b/2&&hb&&(ic=b/2-a.hc-(yc.kc-b/2),this.kU(ic,f)&&Math.abs(ic)<Math.abs(za)&&this.g6(a,yc,l)&&(za=ic)),yc.hc<b/2&&yc.hc>b/4&&a.kc>b/2&&Va&&(ic=b/2-yc.hc-(a.kc-b/2),this.kU(ic,f)&&Math.abs(ic)<Math.abs(ja)&&this.g6(a,yc,l)&&(ja=ic)),yc.mc>c/2&&yc.mc<3*c/4&&a.Zb<c/2&&lc&&(ic=c/2-a.Zb-(yc.mc-c/2),this.kU(ic,f)&&Math.abs(ic)<Math.abs(R)&&this.g6(a,yc,l)&&(R=ic)),
yc.Zb<c/2&&yc.Zb>c/4&&a.mc>c/2&&Cb&&(ic=c/2-yc.Zb-(a.mc-c/2),this.kU(ic,f)&&Math.abs(ic)<Math.abs(G)&&this.g6(a,yc,l)&&(G=ic));a=new Gi.a;a.top=G===Number.MAX_VALUE?a.top:G;a.bottom=R===Number.MAX_VALUE?a.bottom:R;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=za===Number.MAX_VALUE?a.right:za;return a}CGh(a,b,c,f,l,y){l=this.Yvd(l,Hk.bMc);y=this.Yvd(y,Hk.bMc);for(var G of l){l=a.copy();l.move(0,0-G);if(this.o8a(l,b,f,null,!1).count)return this.nMa(c,0,-G),!0;l=a.copy();l.move(0,G);if(this.o8a(l,b,
f,null,!1).count)return this.nMa(c,0,G),!0}for(let R of y){G=a.copy();G.move(0-R,0);if(this.o8a(G,b,f,null,!1).count)return this.nMa(c,-1*R,0),!0;G=a.copy();G.move(R,0);if(this.o8a(G,b,f,null,!1).count)return this.nMa(c,R,0),!0}return!1}oea(a,b,c){return c?a.kc>=b.kc&&a.kc<=b.hc||a.hc>=b.kc&&a.hc<=b.hc||b.kc>=a.kc&&b.kc<=a.hc||b.hc>=a.kc&&b.hc<=a.hc:a.mc>=b.mc&&a.mc<=b.Zb||a.Zb>=b.mc&&a.Zb<=b.Zb||b.mc>=a.mc&&b.mc<=a.Zb||b.Zb>=a.mc&&b.Zb<=a.Zb}PYd(a,b,c,f,l){const y=new Oa.a,G=new Oa.a,R=new Oa.a;
let ja=!1,za=!1,Va=!1,hb=!1,Cb=!0,lc=!0,ic=!0,yc=!0;l&&f&&(Cb=f.equals(rd.a.west)||f.equals(rd.a.Zu)||f.equals(rd.a.iI),lc=f.equals(rd.a.east)||f.equals(rd.a.TE)||f.equals(rd.a.jF),ic=f.equals(rd.a.north)||f.equals(rd.a.Zu)||f.equals(rd.a.TE),yc=f.equals(rd.a.south)||f.equals(rd.a.iI)||f.equals(rd.a.jF));f=this.Uq.vm(c.ye.width);c=this.Uq.vm(c.ye.height);l=new yg;l.Sf=new cd.a(f/2-this.VO,0-this.Rw);l.Fg=new cd.a(f/2-this.VO,c-this.Rw);const ec=new yg;ec.Sf=new cd.a(0-this.VO,c/2-this.Rw);ec.Fg=new cd.a(f-
this.VO,c/2-this.Rw);ec.wH=!0;for(const jc of b)jc.kc>f/2&&jc.kc<3*f/4&&a.hc<f/2&&this.g6(a,jc,b)&&lc&&this.Vu(f/2-a.hc,jc.kc-f/2)&&(ja=!0,0>jc.mc&&(l.Sf=new cd.a(f/2,jc.mc)),jc.Zb>c&&(l.Fg=new cd.a(f/2,jc.Zb+this.zg)),y.add(this.HQa(jc,!1,!1)),G.add(this.DQa(jc,!1,!1,f,c))),jc.hc<f/2&&jc.hc>f/4&&a.kc>f/2&&this.g6(a,jc,b)&&Cb&&this.Vu(a.kc-f/2,f/2-jc.hc)&&(za=!0,0>jc.mc&&(l.Sf=new cd.a(f/2,jc.mc)),jc.Zb>c&&(l.Fg=new cd.a(f/2,jc.Zb+this.zg)),y.add(this.HQa(jc,!1,!0)),G.add(this.DQa(jc,!1,!0,f,c))),
jc.mc>c/2&&jc.mc<3*c/4&&a.Zb<c/2&&this.g6(a,jc,b)&&yc&&this.Vu(c/2-a.Zb,jc.mc-c/2)&&(Va=!0,0>jc.kc&&(ec.Sf=new cd.a(jc.kc,c/2)),jc.hc>f&&(ec.Fg=new cd.a(jc.hc+this.zg,c/2)),y.add(this.HQa(jc,!0,!1)),G.add(this.DQa(jc,!0,!1,f,c))),jc.Zb<c/2&&jc.Zb>c/4&&a.mc>c/2&&this.g6(a,jc,b)&&ic&&this.Vu(a.mc-c/2,c/2-jc.Zb)&&(hb=!0,0>jc.kc&&(ec.Sf=new cd.a(jc.kc,c/2)),jc.hc>f&&(ec.Fg=new cd.a(jc.hc+this.zg,c/2)),y.add(this.HQa(jc,!0,!0)),G.add(this.DQa(jc,!0,!0,f,c)));(ja||za)&&y.add(this.aw(l));(Va||hb)&&y.add(this.aw(ec));
Va&&(a.kc<ec.Sf._x&&(ec.Sf=new cd.a(a.kc,c/2)),a.hc>ec.Fg._x&&(ec.Fg=new cd.a(a.hc,c/2+this.zg)),y.add(this.HQa(a,!0,!0)),G.add(this.DQa(a,!0,!0,f,c)));hb&&(a.kc<ec.Sf._x&&(ec.Sf=new cd.a(a.kc,c/2)),a.hc>ec.Fg._x&&(ec.Fg=new cd.a(a.hc,c/2+this.zg)),y.add(this.HQa(a,!0,!1)),G.add(this.DQa(a,!0,!1,f,c)));ja&&(a.mc<l.Sf._y&&(l.Sf=new cd.a(f/2,a.mc)),a.Zb>l.Fg._y&&(l.Fg=new cd.a(f/2,a.Zb+this.zg)),y.add(this.HQa(a,!1,!0)),G.add(this.DQa(a,!1,!0,f,c)));za&&(a.mc<l.Sf._y&&(l.Sf=new cd.a(f/2,a.mc)),a.Zb>
l.Fg._y&&(l.Fg=new cd.a(f/2,a.Zb+this.zg)),y.add(this.HQa(a,!1,!1)),G.add(this.DQa(a,!1,!1,f,c)));this.l2a(y,1);this.l2a(G,2);for(let jc of y)R.add(jc);for(let jc of G)R.add(jc);return R}HQa(a,b,c){const f=b&&c,l=b&&!c,y=!b&&!c;return!b&&c?(b=new yg,b.Sf=new cd.a(a.hc-this.SB,a.Zb),b.Fg=new cd.a(a.hc-this.SB,a.Zb+this.zg),this.aw(b)):y?(b=new yg,b.Sf=new cd.a(a.kc-this.VO,a.Zb),b.Fg=new cd.a(a.kc-this.VO,a.Zb+this.zg),this.aw(b)):f?(b=new yg,b.Sf=new cd.a(a.hc,a.Zb-this.T4),b.Fg=new cd.a(a.hc+this.zg,
a.Zb-this.T4),this.aw(b)):l?(b=new yg,b.Sf=new cd.a(a.hc,a.mc-this.Rw),b.Fg=new cd.a(a.hc+this.zg,a.mc-this.Rw),this.aw(b)):null}DQa(a,b,c,f,l){const y=b&&c,G=b&&!c,R=!b&&!c;return!b&&c?(l=new yg,l.wH=!0,l.Sf=new cd.a(f/2-this.VO,a.Zb+this.zg),l.Fg=new cd.a(a.hc-this.SB,a.Zb+this.zg),this.aw(l)):R?(l=new yg,l.wH=!0,l.Sf=new cd.a(f/2-this.VO,a.Zb+this.zg),l.Fg=new cd.a(a.kc-this.VO,a.Zb+this.zg),this.aw(l)):y?(f=new yg,f.wH=!0,f.Sf=new cd.a(a.hc+this.zg,l/2-this.Rw),f.Fg=new cd.a(a.hc+this.zg,a.Zb-
this.T4),this.aw(f)):G?(f=new yg,f.wH=!0,f.Sf=new cd.a(a.hc+this.zg,l/2-this.Rw),f.Fg=new cd.a(a.hc+this.zg,a.mc-this.Rw),this.aw(f)):null}qoj(a,b,c,f,l,y){let G=Number.MAX_VALUE,R=Number.MAX_VALUE,ja=Number.MAX_VALUE,za=Number.MAX_VALUE,Va=!0,hb=!0,Cb=!0,lc=!0;y&&l&&(Va=l.equals(rd.a.west)||l.equals(rd.a.Zu)||l.equals(rd.a.iI),hb=l.equals(rd.a.east)||l.equals(rd.a.TE)||l.equals(rd.a.jF),Cb=l.equals(rd.a.north)||l.equals(rd.a.Zu)||l.equals(rd.a.TE),lc=l.equals(rd.a.south)||l.equals(rd.a.iI)||l.equals(rd.a.jF));
l=[];for(const ic of b)l.push(new rk.a(ic.Bs()));b=this.Uq.vm(c.ye.width);c=this.Uq.vm(c.ye.height);for(const ic of l)ic.hc>3*b/4&&ic.hc<b&&a.kc<b/4&&0<a.kc&&this.oea(a,ic,!1)&&Va&&(l=b-ic.hc-a.kc,this.kU(l,f)&&Math.abs(l)<Math.abs(ja)&&(ja=l)),ic.kc<b/4&&0<ic.kc&&a.hc>3*b/4&&a.hc<b&&this.oea(a,ic,!1)&&hb&&(l=b-a.hc-ic.kc,this.kU(l,f)&&Math.abs(l)<Math.abs(za)&&(za=l)),ic.Zb>3*c/4&&ic.Zb<c&&a.mc<c/4&&0<a.mc&&this.oea(a,ic,!0)&&Cb&&(l=c-ic.Zb-a.mc,this.kU(l,f)&&Math.abs(l)<Math.abs(G)&&(G=l)),ic.mc<
c/4&&0<ic.mc&&a.Zb>3*c/4&&a.Zb<c&&this.oea(a,ic,!0)&&lc&&(l=c-a.Zb-ic.mc,this.kU(l,f)&&Math.abs(l)<Math.abs(R)&&(R=l));a=new Gi.a;a.top=G===Number.MAX_VALUE?a.top:G;a.bottom=R===Number.MAX_VALUE?a.bottom:R;a.left=ja===Number.MAX_VALUE?a.left:ja;a.right=za===Number.MAX_VALUE?a.right:za;return a}o8a(a,b,c,f,l){const y=new Oa.a,G=new Oa.a,R=new Oa.a;var ja=!1,za=!1,Va=!1,hb=!1,Cb=!0;let lc=!0,ic=!0,yc=!0;l&&f&&(Cb=f.equals(rd.a.west)||f.equals(rd.a.Zu)||f.equals(rd.a.iI),lc=f.equals(rd.a.east)||f.equals(rd.a.TE)||
f.equals(rd.a.jF),ic=f.equals(rd.a.north)||f.equals(rd.a.Zu)||f.equals(rd.a.TE),yc=f.equals(rd.a.south)||f.equals(rd.a.iI)||f.equals(rd.a.jF));f=this.Uq.vm(c.ye.width);c=this.Uq.vm(c.ye.height);for(const ec of b)ec.hc>3*f/4&&ec.hc<f&&a.kc<f/4&&0<a.kc&&this.oea(a,ec,!1)&&Cb&&this.Vu(a.kc,f-ec.hc)&&(ja=!0,b=new yg,b.Sf=new cd.a(ec.hc-this.SB,ec.Zb),b.Fg=new cd.a(ec.hc-this.SB,ec.Zb+this.zg),y.add(this.aw(b)),b=new yg,b.wH=!0,b.Sf=new cd.a(f-this.SB,ec.Zb+this.zg),b.Fg=new cd.a(ec.hc-this.SB,ec.Zb+this.zg),
G.add(this.aw(b))),ec.kc<f/4&&0<ec.kc&&a.hc>3*f/4&&a.kc<f&&this.oea(a,ec,!1)&&lc&&this.Vu(f-a.hc,ec.kc)&&(za=!0,b=new yg,b.Sf=new cd.a(ec.kc-this.VO,ec.Zb),b.Fg=new cd.a(ec.kc-this.VO,ec.Zb+this.zg),y.add(this.aw(b)),b=new yg,b.wH=!0,b.Sf=new cd.a(0-this.VO,ec.Zb+this.zg),b.Fg=new cd.a(ec.kc-this.VO,ec.Zb+this.zg),G.add(this.aw(b))),ec.Zb>3*c/4&&ec.Zb<c&&a.mc<c/4&&0<a.mc&&this.oea(a,ec,!0)&&ic&&this.Vu(a.mc,c-ec.Zb)&&(Va=!0,b=new yg,b.Sf=new cd.a(ec.hc,ec.Zb-this.T4),b.Fg=new cd.a(ec.hc+this.zg,ec.Zb-
this.T4),y.add(this.aw(b)),l=new yg,b.wH=!0,l.Sf=new cd.a(ec.hc+this.zg,ec.Zb-this.T4),l.Fg=new cd.a(ec.hc+this.zg,c-this.T4),G.add(this.aw(l))),ec.mc<c/4&&0<ec.mc&&a.Zb>3*c/4&&a.Zb<c&&this.oea(a,ec,!0)&&yc&&this.Vu(c-a.Zb,ec.mc)&&(hb=!0,b=new yg,b.Sf=new cd.a(ec.hc,ec.mc-this.Rw),b.Fg=new cd.a(ec.hc+this.zg,ec.mc-this.Rw),y.add(this.aw(b)),l=new yg,b.wH=!0,l.Sf=new cd.a(ec.hc+this.zg,0-this.Rw),l.Fg=new cd.a(ec.hc+this.zg,ec.mc-this.Rw),G.add(this.aw(l)));Va&&(Va=new yg,Va.Sf=new cd.a(a.hc,a.mc-
this.Rw),Va.Fg=new cd.a(a.hc+this.zg,a.mc-this.Rw),y.add(this.aw(Va)),Cb=new yg,Va.wH=!0,Cb.Sf=new cd.a(a.hc+this.zg,0-this.Rw),Cb.Fg=new cd.a(a.hc+this.zg,a.mc-this.Rw),G.add(this.aw(Cb)));hb&&(hb=new yg,hb.Sf=new cd.a(a.hc,a.Zb-this.T4),hb.Fg=new cd.a(a.hc+this.zg,a.Zb-this.T4),y.add(this.aw(hb)),Va=new yg,hb.wH=!0,Va.Sf=new cd.a(a.hc+this.zg,c-this.T4),Va.Fg=new cd.a(a.hc+this.zg,a.Zb-this.T4),G.add(this.aw(Va)));ja&&(ja=new yg,ja.Sf=new cd.a(a.kc-this.VO,a.Zb),ja.Fg=new cd.a(a.kc-this.VO,a.Zb+
this.zg),y.add(this.aw(ja)),ja=new yg,ja.wH=!0,ja.Sf=new cd.a(0-this.VO,a.Zb+this.zg),ja.Fg=new cd.a(a.kc-this.VO,a.Zb+this.zg),G.add(this.aw(ja)));za&&(za=new yg,za.Sf=new cd.a(a.hc-this.SB,a.Zb),za.Fg=new cd.a(a.hc-this.SB,a.Zb+this.zg),y.add(this.aw(za)),za=new yg,za.wH=!0,za.Sf=new cd.a(f-this.SB,a.Zb+this.zg),za.Fg=new cd.a(a.hc-this.SB,a.Zb+this.zg),G.add(this.aw(za)));this.l2a(y,1);this.l2a(G,2);for(let ec of y)R.add(ec);for(let ec of G)R.add(ec);return R}Fyi(a,b,c){var f=new yg;const l=new yg,
y=new yg,G=new yg,R=new yg,ja=new yg,za=new Oa.a;za.add(f);za.add(l);za.add(y);za.add(G);za.add(R);za.add(ja);this.l2a(za,0);this.iTj(f,l,y,G,R,ja,a);for(const Va of b)this.Y3(a.mc,Va.mc,Va.Zb,f,Va),this.Y3(a.Zb,Va.mc,Va.Zb,l,Va),this.Y3(a.kc,Va.kc,Va.hc,y,Va),this.Y3(a.hc,Va.kc,Va.hc,G,Va),this.rHb&&(this.Y3(a.mc,Va.Zf()._y,null,f,Va),this.Y3(a.Zb,Va.Zf()._y,null,l,Va),this.Y3(a.kc,Va.Zf()._x,null,y,Va),this.Y3(a.hc,Va.Zf()._x,null,G,Va),this.Y3(a.Zf()._y,Va.mc,null,R,Va),this.Y3(a.Zf()._y,Va.Zb,
null,R,Va),this.Y3(a.Zf()._x,Va.kc,null,ja,Va),this.Y3(a.Zf()._x,Va.hc,null,ja,Va)),this.Y3(a.Zf()._y,Va.Zf()._y,null,R,Va),this.Y3(a.Zf()._x,Va.Zf()._x,null,ja,Va);0<f.length()&&0<l.length()&&(this.rHb?(R.Sf=new cd.a(a.kc-this.zg,a.Zf()._y),R.Fg=R.Sf.copy()):R.reset());0<y.length()&&0<G.length()&&(this.rHb?(ja.Sf=new cd.a(a.Zf()._x,a.kc-this.VO),ja.Fg=ja.Sf.copy()):ja.reset());if(this.rHb&&c){b=this.Uq.vm(c.ye.width);c=this.Uq.vm(c.ye.height);if(this.Vu(a.mc,c/2)||Math.abs(a.mc)<=Hk.i8a||this.Vu(a.mc,
c))f.Sf._x=Math.min(f.Sf._x,-1*this.zg),f.Fg._x=Math.max(f.Fg._x,b+this.zg);if(this.Vu(a.Zb,c/2)||Math.abs(a.Zb)<=Hk.i8a||this.Vu(a.Zb,c))l.Sf._x=Math.min(l.Sf._x,-1*this.zg),l.Fg._x=Math.max(l.Fg._x,b+this.zg);if(this.Vu(a.Zf()._y,c/2)||Math.abs(a.Zf()._y)<=Hk.i8a||this.Vu(a.Zf()._y,c))R.Sf._x=Math.min(R.Sf._x,-1*this.zg),R.Fg._x=Math.max(R.Fg._x,b+this.zg);if(this.Vu(a.hc,b/2)||Math.abs(a.hc)<=Hk.i8a||this.Vu(a.hc,b))G.Sf._y=Math.min(G.Sf._y,-1*this.zg),G.Fg._y=Math.max(G.Fg._y,c+this.zg);if(this.Vu(a.kc,
b/2)||Math.abs(a.kc)<=Hk.i8a||this.Vu(a.kc,b))y.Sf._y=Math.min(y.Sf._y,-1*this.zg),y.Fg._y=Math.max(y.Fg._y,c+this.zg);if(this.Vu(a.Zf()._x,b/2)||Math.abs(a.Zf()._x)<=Hk.i8a||this.Vu(a.Zf()._x,b))ja.Sf._y=Math.min(ja.Sf._y,-1*this.zg),ja.Fg._y=Math.max(ja.Fg._y,c+this.zg)}f=new Oa.a;for(let Va of za)Va.Sf&&0<Va.length()&&(this.d0f(Va,a),f.add(this.aw(Va)));return f}Y3(a,b,c,f,l){(this.Vu(a,b)||this.Vu(a,c))&&this.d0f(f,l)}d0f(a,b){a.wH?(a.Sf._x=Math.min(a.Sf._x,b.kc-this.zg),a.Fg._x=Math.max(a.Fg._x,
b.hc+this.zg)):(a.Sf._y=Math.min(a.Sf._y,b.mc-this.zg),a.Fg._y=Math.max(a.Fg._y,b.Zb+this.zg))}aw(a){let b;(b=a.Sf).x=b.x+this.hcd;let c;(c=a.Sf).y=c.y+this.icd;let f;(f=a.Fg).x=f.x+this.hcd;let l;(l=a.Fg).y=l.y+this.icd;return a}Vu(a,b){var c=Hk.i8a;return!!a&&!!b&&Math.abs(a-b)<=c}iTj(a,b,c,f,l,y,G){a.Sf=new cd.a(G.kc-this.zg,G.mc-this.Rw);a.Fg=a.Sf.copy();a.wH=!0;b.Sf=new cd.a(G.kc-this.zg,G.Zb-this.T4);b.Fg=b.Sf.copy();b.wH=!0;c.Sf=new cd.a(G.kc-this.VO,G.mc-this.zg);c.Fg=c.Sf.copy();f.Sf=new cd.a(G.hc-
this.SB,G.mc-this.zg);f.Fg=f.Sf.copy();b=G.Zf();l.Sf=new cd.a(a.Sf._x-this.zg,b._y-this.Rw);l.Fg=l.Sf.copy();l.wH=!0;y.Sf=new cd.a(b._x-this.zg,c.Sf._y-this.zg);y.Fg=y.Sf.copy()}l2a(a,b){for(let c of a)0===b?(c.color=qe.a.cGi,c.dashStyle="4,4",c.L9b=0):1===b?(c.color=qe.a.bGi,c.dashStyle="4,4",c.L9b=1):2===b&&(c.color=qe.a.ANf,c.dashStyle="4,4",c.L9b=2)}get g9g(){return this.hcd}set g9g(a){this.hcd=a}get h9g(){return this.icd}set h9g(a){this.icd=a}}Hk.i8a=.4;Hk.bMc=5;Object(m.a)(Hk,"SmartGuideUtility",
null,[1359]);var dm=d(139),Ko=d(214),Vm=d(167),ln=d(190);class em{constructor(a,b,c,f,l){this.tHb=this.uHb=this.yb=null;this.bna=new Sys.UI.Bounds(0,0,0,0);this.wJa=1;this.Ab=!1;this.Ig=a;this.Hi=b;this.od=f;this.Kc=c;this.od.Z_b(Object(H.a)(this,this.onResize,"onResize"));l&&this.od.NQa(Object(H.a)(this,this.A1,"onActiveSlideDomDisplayed"));this.Bm()}get visible(){return!!this.yb&&this.Ab}set visible(a){this.yb||this.Bm();this.Ab!==a&&(this.yb.Sd(a),this.Ab=a)}rXf(a){this.tHb&&this.uHb.xa.removeChild(this.tHb.xa);
this.tHb=new Ko.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new Vm.a,l=em.Ibk(em.Knh(cd.a.scale(c.Sf,this.wJa,this.wJa)),em.Knh(cd.a.scale(c.Fg,this.wJa,this.wJa)));f.Mt(l);f.fv(this.H5f(c.color));f.tpa(c.dashStyle);f.xr(1);this.tHb.appendChild(f);2===c.L9b&&this.g_i(l[0],l[1])}this.uHb.appendChild(this.tHb)}g_i(a,b){a._y===b._y?a._x<b._x?this.uQf(a,b):this.uQf(b,a):a._y>b._y?this.vQf(a,b):this.vQf(b,a)}uQf(a,b){const c=this.qJf(b._x-a._x);this.POc([new cd.a(a._x,a._y),new cd.a(a._x+c,a._y-c/2),
new cd.a(a._x+c,a._y+c/2)]);this.POc([new cd.a(b._x,b._y),new cd.a(b._x-c,b._y-c/2),new cd.a(b._x-c,b._y+c/2)])}vQf(a,b){const c=this.qJf(a._y-b._y);this.POc([new cd.a(a._x,a._y),new cd.a(a._x-c/2,a._y-c),new cd.a(a._x+c/2,a._y-c)]);this.POc([new cd.a(b._x,b._y),new cd.a(b._x-c/2,b._y+c),new cd.a(b._x+c/2,b._y+c)])}qJf(a){return Math.min(a,10)/2}POc(a){const b=new Vm.a,c=this.H5f(qe.a.ANf);b.Mt(a);b.fv(c);b.xr(1);b.dF(c);b.Sd(!0);this.tHb.appendChild(b)}H5f(a){return this.Hi&&this.Hi.highContrastColors?
this.Hi.highContrastColors.foregroundTextColor:a}Bm(){this.yb=new dm.a;this.yb.Fr("SmartGuideView");this.yb.ek(0);this.yb.Sd(!1);this.Ig.xa.appendChild(this.yb.xa);this.uHb=new ln.a;this.uHb.xa.style.overflow="visible";this.yb.appendChild(this.uHb);this.ls(this.Kc.Hc)}onResize(a,b){b&&this.ls(b.zG)}A1(a,b){b&&this.ls(b.zG)}ls(a){this.yb&&a&&a.ye&&a===this.Kc.Hc&&(this.bna.x!==a.ye.x||this.bna.y!==a.ye.y||this.bna.width!==a.ye.width||this.bna.height!==a.ye.height)&&(this.bna=new Sys.UI.Bounds(a.ye.x,
a.ye.y,a.ye.width,a.ye.height),this.yb.setPosition(a.ye.x,a.ye.y),this.uHb.ah(a.ye.width,a.ye.height),this.yb.ah(a.ye.width,a.ye.height))}static Ibk(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static Knh(a){return new cd.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(m.a)(em,"SmartGuideView",null,[1358]);class zp{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Gi.a.add(a.k_a,b),!0)}cJ(a){return new rk.a(a.Bs())}yG(a){return!a.shapeNode.Lv}}
Object(m.a)(zp,"DefaultShapeMoveResizeHandler",null,[829]);class $o{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Xb(a){this.K=a;this.K.register(1357,"PowerPointWebEditor.ISmartGuideManager").na().oa(()=>new Bh(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1358,"PowerPointWebEditor.ISmartGuideView").na().oa(()=>new em(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cva));this.K.register(1359,"PowerPointWebEditor.ISmartGuideUtility").na().oa(()=>new Hk(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new zp)}dispose(){}static main(){n.a.instance.Ac(new $o)}}Object(m.a)($o,"PPTWebEditorSmartGuidePackage",null,[2,3]);class Fm{}Fm.Yxg=[C.a.backspace,C.a.Uvb,C.a.uL,C.a.e4b,C.a.MDa,C.a.enter,C.a.Fud,C.a.$B,C.a.tab,C.a.juc,C.a.pageDown,C.a.pageUp,C.a.c_a,C.a.RKe,C.a.b_a,C.a.QKe];Fm.Qdk=[C.a.backspace,C.a.Uvb,C.a.uL,C.a.e4b,C.a.MDa,
C.a.enter,C.a.Fud,C.a.$B,C.a.tab,C.a.juc,C.a.font,C.a.y6,C.a.vLa,C.a.Xq,C.a.HKa,C.a.W0a,C.a.qH,C.a.fI,C.a.bold,C.a.setItalic,C.a.underline,C.a.strikethrough,C.a.vr,C.a.e2,C.a.Hja,C.a.kN,C.a.JP,C.a.QC,C.a.Ry,C.a.Dja,C.a.$la,C.a.gpa,C.a.BEa,ea.a.zoa,ea.a.M1,ea.a.L1,ea.a.K1,C.a.ODa,C.a.ola,C.a.Nza,C.a.Oza,C.a.Pza,C.a.EMa,C.a.FMa,C.a.sac,C.a.tac,C.a.Obb,C.a.uVa,C.a.xVa,C.a.Fua,C.a.N8,ea.a.sKb,C.a.deleteRow,ea.a.qpc,C.a.LDa,ea.a.$md,C.a.insertTable,ea.a.yRe,C.a.iT,C.a.s_,ea.a.w6,ea.a.EKa,ea.a.J1a,ea.a.XLa,
ea.a.upa,ea.a.YLa,ea.a.Wvd,ea.a.Vvd,C.a.cN,C.a.zVa,C.a.centerJustify,C.a.leftJustify,C.a.rightJustify,C.a.fullJustify,C.a.V4b,C.a.qdc,C.a.Otc,ea.a.jmb,ea.a.kmb,ea.a.lmb,ea.a.mmb,C.a.f1b];Fm.xll=[C.a.leftArrow,C.a.rightArrow,C.a.upArrow,C.a.downArrow,C.a.Q1a,C.a.P1a,C.a.DDa,C.a.CDa,C.a.mSa,C.a.lSa,C.a.NOb,C.a.Rlb,C.a.f4b,C.a.Vvb,C.a.e9a,C.a.kSa,C.a.c_a,C.a.iTa,C.a.Vhb,C.a.Uhb,C.a.a$a,C.a.b_a,C.a.hTa,C.a.$9a,C.a.qta,C.a.Gud,ea.a.Wsc,ea.a.gRb,ea.a.$1a,ea.a.rPb];Object(m.a)(Fm,"ActionIdList",null,[]);
class Tn{constructor(){this.ActionTime=this.ActionName=this.ActionId=null}}Object(m.a)(Tn,"ActionInformation",null,[]);class al{constructor(a,b,c,f,l,y){this.Idb=[];this.lec=[];this.DJ=a;this.Gue=b||[];this.ia=c;this.ia.Oaa(this);this.Ya=f;this.YX=l;this.GH=y}m6(a){this.RDh(a)&&this.Dpa(a.actionId)&&(this.Idb.push(a.actionId),this.lec.push(Date.now()))}l6(a){this.RDh(a)&&this.Dpa(a.actionId)&&(this.Idb.pop(),this.lec.pop())}Dpa(a){if(Array.contains(this.Gue,a))return!0;a=this.ia.MT(a);return!!a&&
!(a.flags[32]||a.flags[64])}RDh(a){return 2===a.behavior&&a.Zi?!0:!1}getCommandName(a,b=""){return(a=this.DJ?this.DJ.F6(a):null)?a:b}CY(a){a&&a.Usa&&ya.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.Usa.toString(),this.actionName||(this.YX.gd===C.a.typing||this.YX.gd===C.a.OCa||this.YX.gd===C.a.BSa?"Typing":null)||(this.GH.w1c?"ClosingTextUndoStack":""),this.Ya.podSessionId||"",this.DJ.F6(this.YX.gd));return!!this.Idb.length}update(a,b){a=new Tn;a.ActionId=
this.C$f();a.ActionName=this.D$f();a.ActionTime=this.mnj().toString();Eg.a.Po(b,va.a.bdi,a);b.setValue(va.a.fac,!0);b.setValue(va.a.krd,1)}get actionName(){return this.D$f()}get actionId(){return this.C$f()}dce(){return this.Idb[this.Idb.length-1]}C$f(){return this.Idb.length?this.dce().toString():null}D$f(){return this.Idb.length?this.getCommandName(this.dce(),this.dce().toString()):null}mnj(){return this.lec.length?this.lec[this.lec.length-1]:Number.MAX_VALUE}}Object(m.a)(al,"ActionInfoRevisionMetaDataUpdater",
null,[1366,144]);class mn{constructor(){this.va=new Wc.a}Cnh(a){this.va.raiseEvent("UCI",a)}Mli(a){this.va.addHandler("UCI",a)}Zcl(a){this.va.removeHandler("UCI",a)}}Object(m.a)(mn,"CcpEventSource",null,[1418,1419,1420]);class Un{constructor(a,b){this.$ec=this.Sve=this.Rve=null;this.Tve=a;this.LU=b;this.Tve.Mli(Object(H.a)(this,this.F$g,"onCcpPropertyChanged"))}F$g(a,b){this.Rve=b.Kp;this.Sve=b.LAi;this.$ec=b.MAi}CY(a){a=this.LU.ZEa(a.Mya);!this.$ec&&a.Ta(va.a.F8a)&&(a.removeProperty(va.a.ON),a.removeProperty(va.a.uQ),
a.removeProperty(va.a.F8a));return!!this.$ec}update(a,b){b.setValue(va.a.ON,this.Rve);b.setValue(va.a.uQ,this.Sve);b.setValue(va.a.F8a,this.$ec);this.$ec=this.Sve=this.Rve=null}dispose(){this.Tve&&this.Tve.Zcl(Object(H.a)(this,this.F$g,"onCcpPropertyChanged"))}}Object(m.a)(Un,"CcpInfoRevisionMetaDataUpdater",null,[1347,1366,108]);var ap=d(329);class ko extends Xf.a{constructor(a,b,c,f,l,y,G){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=
null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=y;this.AuthToken=G}ul(){return 108}}Object(m.a)(ko,"AugmentImageRequest",Xf.a,[]);class lo extends Xf.a{constructor(){super()}ul(){return 81}}Object(m.a)(lo,"FlushRequest",Xf.a,[]);class Vn extends Xf.a{constructor(a,b,c,f,l,y){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=
f;this.DeckSuggestionId=l;this.Hints=y}ul(){return 111}}Object(m.a)(Vn,"GenerateAgendaDeckSuggestionRequest",Xf.a,[]);class Ik extends Xf.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}ul(){return 110}}Object(m.a)(Ik,"GenerateAgendaSuggestionRequest",Xf.a,[]);class Sk extends Xf.a{constructor(a,b,c,f,l,y,G,R,ja,za){super();this.ShapeViewHeight=
this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=y;this.SubNodeWidth=G;this.SubNodeHeight=R;this.CorrelationId=ja;this.Trigger=za}ul(){return 99}}Object(m.a)(Sk,"GenerateIconSuggestionRequest",Xf.a,[]);class fm extends Xf.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=
this.IsSVGBlipFill=!1;this.GraphNodeId=Ai.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}ul(){return 91}}Object(m.a)(fm,"GenerateImageDescriptionRequest",Xf.a,[]);class $g extends Xf.a{constructor(a,b,c,f,l,y,G){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=y;this.Hints=G}ul(){return 66}}
Object(m.a)($g,"GenerateSuggestionRequest",Xf.a,[]);class mm extends $g{constructor(a,b,c,f,l,y,G,R){super(a,b,f,null,l,y,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=G;this.ShapeViewHeight=R}ul(){return 83}}Object(m.a)(mm,"GenerateReplaceObjectRequest",$g,[]);class tl extends Xf.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}ul(){return 57}}Object(m.a)(tl,"GetPictureCropInfoRequest",
Xf.a,[]);class El extends Xf.a{constructor(){super();this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}ul(){return 109}}Object(m.a)(El,"ImageTransformRequest",Xf.a,[]);class Pi extends Xf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}ul(){return 84}}Object(m.a)(Pi,"ReportReplaceObjectInfoRequest",Xf.a,[]);class Lo extends Xf.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=
b}ul(){return 67}}Object(m.a)(Lo,"ReportSuggestionSessionInfoRequest",Xf.a,[]);class yk extends Xf.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}ul(){return 59}}Object(m.a)(yk,"UpdateContentAddinSnapshotInfoRequest",Xf.a,[]);class Ve{constructor(a,b,c){this.GH=a;this.Ub=b;this.hCg=c}get w1c(){return this.GH.w1c}I8a(a,b=!1){return this.GH.I8a(a,b)}forceOutbound(){this.GH.forceOutbound()}Kga(a,b,c=!1){this.GH.Kga(a,
b,c)}iJc(a){this.GH.iJc(a)}zyb(a){return this.GH.zyb(a)}Hb(a){this.GH.Hb(a)}pbg(a,b,c,f=null,l=null,y=!1){a=new Hj.a(new tl(a,b,c),f,l,G=>0===G.StatusCode);this.GH.Kga(a,this.Ub,y)}Hka(a,b,c,f,l,y,G,R=null,ja=null){a=new Hj.a(new $g(a,b,c,f,l,y,G),R,ja,za=>0===za.StatusCode);this.GH.Kga(a,this.Ub)}generateImageDescription(a,b,c,f){a=new Hj.a(new fm(a,b,c,f),null,null,l=>0===l.StatusCode);this.GH.Kga(a,this.Ub)}$oa(a,b,c){a=new Hj.a(new Lo(a,b),null,()=>!0,f=>0===f.StatusCode);this.GH.Kga(a,this.Ub,
c)}m5f(a,b,c,f,l,y,G,R=null,ja=null){a=new Hj.a(new mm(a,b,c,f,l,null,y,G),R,ja,za=>0===za.StatusCode);this.GH.Kga(a,this.Ub)}Pel(a,b,c=null,f=null){a=new Hj.a(new Pi(a,b),c,f,l=>0===l.StatusCode);this.GH.Kga(a,this.Ub)}Ybj(a,b,c,f,l,y,G,R,ja=null,za=null){a=new Hj.a(new Sk(a,b,c,f,l,y,74,74,G,R),ja,za,Va=>0===Va.StatusCode);this.GH.Kga(a,this.Ub)}augmentImage(a,b,c,f,l,y,G,R=null,ja=null){a=new Hj.a(new ko(a,b,c,f,l,y,G),R,ja,za=>0===za.StatusCode);this.GH.Kga(a,this.Ub)}generateAgendaSuggestion(a,
b,c,f,l,y=null,G=null){a=new Hj.a(new Ik(a,b,c,f,l),y,G,R=>0===R.StatusCode);this.GH.Kga(a,this.Ub)}generateAgendaDeckSuggestion(a,b,c,f,l,y,G=null,R=null){a=new Hj.a(new Vn(a,b,c,f,l,y),G,R,ja=>0===ja.StatusCode);this.GH.Kga(a,this.Ub)}JPh(a,b,c,f=null,l=null){const y=new Hj.a(new yk(a,b,c),f,l,ja=>0===ja.StatusCode),G=()=>{this.H3i(y)};a=this.GH.zyb(this.Ub.Gf);const R=new ap.a;a?a.forceOutbound(()=>{G()},l?()=>{l(R)}:null,null):(ya.a.J(509084637,823,10,"Can't find graph space replicator when trying to do outbound"),
l&&l(R))}flush(a=null,b=null){a=new Hj.a(new lo,a,b,c=>0===c.StatusCode,3);this.GH.pta(a)}pta(a){this.GH.pta(a)}MVc(){return this.zyb(this.Ub.Gf)}H3i(a){this.hCg.Hb(a);this.hCg.forceOutbound(null,null,null)}}Object(m.a)(Ve,"OutboundHelper",null,[1344,22,1374]);var rj=d(261),lj=d(172);class Mo{constructor(a,b,c,f,l){this.AM=[];this.Ofb=new rj.a;this.Efd=null;this.Dzg=[];this.H5=null;this.va=new Wc.a;this.$Fg=this.VFb=this.ifd=!1;this.Sb=a;this.la=b;this.ua=c;this.ltk=l;this.uwa=f;this.spk=this.la.Yua?
1:4;f.gk(Object(H.a)(this,this.ekd,"onMainMastersLoaded"));this.la.Yua&&f.gk(Object(H.a)(this,this.Tbh,"onMasterIdListChanged"))}get Lyk(){if(this.la.Yua&&this.ua.Ba){const a=this.ua.Ba.mj;a&&Array.contains(this.AM,a)&&this.LKe(a)}return this.AM.slice(0,Math.min(this.spk,this.AM.length))}Y$k(a){Array.remove(this.AM,a)}get WIl(){return this.Efd}get jP(){return this.Ofb}get r_b(){return this.Dzg}get rPj(){return!this.Efd}get uSk(){return 0<this.AM.length&&(!this.la.pWa||this.ifd)}get hLe(){return this.VFb}set hLe(a){this.VFb=
a}zFl(a){a&&this.qNh(a.mj)}rHh(){this.ifd=!0;this.Dpd(!0);this.cNb()}qNh(a){this.ifd=!0;a&&(Array.remove(this.AM,a),Array.insert(this.AM,0,a));this.cNb()}w5e(a){this.la.Yua?this.qNh(a):this.rHh()}bag(a){if(!a||!this.Ofb)return null;a=a.mj;if(!a)return null;let b=null;return({value:b}=this.Ofb.vg(a)).returnValue?b:null}Tbh(a,b){b.property.id===va.a.Wgd.id&&(ya.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.VFb),this.VFb&&(this.VFb=!1,this.ifd&&(this.Dpd(!1),this.cNb())),
this.pLf())}ekd(a,b){a=b.property;if(this.la.Yua)if(a.id===va.a.eIb.id){a=this.Sb.jnj();const f=this.Sb.bJ();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],y=f[c];l.Id<y.Id?(this.PPh(l.Id),b++):y.Id<l.Id?(this.laf(y.Id),c++):(Nd.c(l)!==Nd.c(y)&&this.NSl(y.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.laf(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.PPh(a[b].Id);this.cNb()}else lj.b(f,null,l=>{this.laf(l.Id)})}else a.id===va.a.XY.id&&(ya.a.J(38847375,824,
50,"Slide size changed, need to reload the resources."),this.Dpd(!0),this.cNb());else if(a.id===va.a.eIb.id||a.id===va.a.XY.id)ya.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.Dpd(!0),this.cNb()}laf(a){this.LKe(a)}NSl(a){this.LKe(a)}LKe(a){Array.contains(this.AM,a)&&Array.remove(this.AM,a);Array.insert(this.AM,0,a)}PPh(a){this.Ofb.remove(a);-1!==Array.indexOf(this.AM,a)&&Array.remove(this.AM,a)}cNb(){this.H5=this.H5||this.ltk(this);this.H5.SF(null,null,null)}Dpd(a){if(this.la.Yua){ya.a.J(38847378,
824,50,"RefreshMastersToLoad, need clean cache: {0} ",a);var b=this.Sb.Txb();a&&(Array.clear(this.AM),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.AM,c.idField)&&Array.add(this.AM,c.idField);else this.VFb=!0,(a=this.Sb.zx(0))&&(a=a.mj)&&Array.add(this.AM,a)}else if(a=this.Sb.bJ(),Array.clear(this.AM),this.clearCache(),a)for(b of a)this.Ofb.remove(b.Id),-1===Array.indexOf(this.AM,b.Id)&&Array.add(this.AM,b.Id)}hJk(a){if(a){for(const b of a)b&&(ya.a.J(38847381,824,50,
"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",b.MasterId),this.Ofb.$(b.MasterId,b),this.Efd=this.Efd||b.TableStyleGallery,this.la.Yua||Array.remove(this.AM,b.MasterId));this.pLf();this.va.raiseEvent("MainMasterResourcesLoaded")}else ya.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}pLf(){!this.$Fg&&this.pFf()&&(this.$Fg=!0,ya.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),
qd.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}iEk(a){this.la.powerPointEnableAccCheck&&(a&&a.length?(this.Dzg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):ya.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}pFf(){if(!this.la.Yua)return!0;const a=this.Sb.Txb();if(a&&0<a.length)for(const b of this.Sb.Txb())if(0<b.layoutCountField&&this.jP.Gb(b.idField)&&this.jP.ga(b.idField).LayoutIcons.length===
b.layoutCountField)return ya.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",b.idField,b.layoutCountField),!0;return!1}RJc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}Nbl(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}wji(a){this.va.addHandler("FirstMasterRetrieved",a)}Qii(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}ibl(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.Ofb=new rj.a}dispose(){this.uwa.Qm(Object(H.a)(this,
this.ekd,"onMainMastersLoaded"));this.la.Yua&&this.uwa.Qm(Object(H.a)(this,this.Tbh,"onMasterIdListChanged"));this.va.dispose();this.H5&&this.H5.dispose()}}Object(m.a)(Mo,"PresentationResourcesManager",null,[1346,108]);var Sl=d(397);class Qi extends Xf.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}ul(){return 52}static F0d(a,b,c){const f=new Qi;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(m.a)(Qi,"GetEditPresResourcesRequest",
Xf.a,[]);class Wn extends Sl.a{constructor(a,b,c,f){super();this.JDb=0;this.ngb=this.c5=!1;this.$m=a;this.XYa=b;this.iY=f;this.enabled=2;this.Uw=c.bOi();this.$m.register(this)}SF(){this.Uw.Y$i();this.Uw.Ebb();this.$m.Zaa()}forceOutbound(){}ila(){return this.XYa.uSk||this.XYa.hLe}jO(){return!1}ZUa(){return this.Xd&&2===this.Xd.status?!0:this.c5||this.ngb?!1:this.ila()&&this.Uw.m$b()}EMb(){if(1===this._state){var a=this.XYa.Lyk;this.Xd.XH=Qi.F0d(a,this.XYa.rPj,this.XYa.hLe);for(const b of a)this.XYa.Y$k(b);
this.Xd.status=1;this._state=3}else 3===this._state&&this.Xd&&2===this.Xd.status&&(this.ngb?(this._state=4,this.dispose()):(200===this.Xd.Iv&&this.iY.asc(),this.Uw.hNa(),2!==this.Xd.statusCode?this.UH():this.Xd.es&&1===this.Xd.es.length?(a=this.Xd.es[0],0===a.StatusCode?(this.XYa.hJk(Nd.a(a.MainMasterResources)),this.XYa.iEk(Nd.a(a.AccRuleInfoList)),this.C1()):this.UH()):this.UH()))}get vda(){return this.ila()?this.Uw.zkb():super.vda}dispose(){1===this._state||4===this._state?(this.c5||this.$m.unregister(this),
this.c5=!0):this.ngb=!0}C1(){this.JDb=0;this._state=1;this.ila()||this.Uw.a2a()}UH(){4<++this.JDb?(this._state=4,ya.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.JDb)):(ya.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(m.a)(Wn,"PresentationResourcesReplicator",Sl.a,[108]);class No{constructor(a,b){this.xtk=a;this.LU=b}jLk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.Mya;let c=null,
f=!1;for(const l of this.xtk)if(l.CY(a)){if(!c&&(c=this.LU.ZEa(b),!c)){ya.a.J(23594507,817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.LU.MTd(b,a,c)}}Object(m.a)(No,"RevisionMetaDataUpdateListener",null,[1348]);var Oo=d(417);class zk{ZEa(a){if(!a)return null;const b=a.ML(4);return b&&!b.equals(ia.a.nil)?a.Be(b):new Oo.a}vaf(a,b,c,f,l,y,G,R,ja){if(a&&f){a.yo.apply(a,zk.Oil);a.setValue(va.a.Lsg,b);a.setValue(va.a.fac,!0);a.setValue(va.a.krd,1);a.setValue(va.a.sid,f.sid);a.setValue(va.a.cid,
f.cid);c&&a.setValue(va.a.gGa,!0);l&&a.setValue(va.a.shapeId,l.get_shapeId());y&&(a.setValue(va.a.jq,!0),a.setValue(va.a.KJh,y.cellId),a.setValue(va.a.rowId,y.rowId));if(G&&0<G.length){b=G.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=G[l].rowId,f[l]=G[l].cellId;a.setValue(va.a.jq,!0);a.setValue(va.a.Nmb,f);a.setValue(va.a.XJh,c)}a.setValue(va.a.U7e,R);a.setValue(va.a.T7e,ja)}}MTd(a,b,c){if(a&&b&&c){var f=!1;a.Be(zk.Fga)||(a.YE(c,zk.Fga),f=!0);b.Yra(c);f&&b.gza(c.id,4)}}dRh(a,b){if(a){var c=a.Mya,
f=this.ZEa(c);f.setValue(va.a.krd,b);this.MTd(c,a,f)}}IUl(a){if(a){var b=a.Mya,c=this.ZEa(b);c.setValue(va.a.Bhl,0);this.MTd(b,a,c)}}}zk.Fga=ia.a.Kf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");zk.Oil=[va.a.Lsg,va.a.shapeId,va.a.jq,va.a.gGa,va.a.KJh,va.a.rowId,va.a.Nmb,va.a.XJh,va.a.U7e,va.a.T7e];Object(m.a)(zk,"RevisionMetadataHelper",null,[1367]);var nm=d(674),Fl=d(868);class bp extends Xf.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;
this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=f}ul(){return 32}}Object(m.a)(bp,"SaveAndCloseRequest",Xf.a,[]);class nn{constructor(a,b,c,f,l,y,G,R,ja){this.ei=a;this.led=b;this.lD=c;this.Ya=f;this.la=l;this.Lz=y;this.Vd=G;this.pc=R;this.$m=ja}$$i(a){this.Ya.aCb=!0;a=new bp(!0,!1,a,this.Ya.podSessionId);this.Vd.nla=!0;const b=this.ei.MVc();b&&b.jO()&&this.pc.Ho?this.la.HDa?(ha.ULS.sendTraceTag(509436876,844,50,"SaveAndCloseHandler: forceSaveOnUnload - application is unloading, forceOutbound to save any remaining changes."),
b.forceOutbound(null,null,null),this.led.x7d(a,null,null)):b.w$a(null,null,null,a):this.led.x7d(a,null,null)}h4(a=!1,b=!0,c=null,f=null,l=1){ya.a.J(509691458,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const y=new bp(a,!0,l,this.Ya.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.Lz.markSessionClosingAtForceSave(l),this.$m.pause(),this.led.w$a(y,G=>{ya.a.J(509691457,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");
this.la.$_f?this.Lz.closeSession(l):this.lD.hpd(new nm.a(l));c(G)},()=>{ya.a.J(509691456,823,15,"SaveAndCloseHandler::ForceSave Failed.");this.$m.Bnb();f&&f(null);return!0});else{a=this.ei.MVc();const G=R=>{this.CHk(y,c,f,ja=>0===ja.StatusCode,R,b,l)};a?a.forceOutbound(()=>{G(!0)},()=>{G(!1)},null):(ya.a.J(509691427,823,10,"Can't find graph space replicator when trying to do outbound"),G(!1))}}CHk(a,b,c,f,l,y,G){ya.a.J(509691426,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",
a.ShouldReleaseLock,l,y);l&&y||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Vd.nla=!0),this.led.pta(a,R=>{a.ShouldReleaseLock&&(this.la.$_f?this.Lz.closeSession(G):this.lD.hpd(new nm.a(G)));b(R)},c,f)):l&&b?b(new Fl.a):!l&&c&&c(new ap.a)}}Object(m.a)(nn,"SaveAndCloseHandler",null,[1345]);var mo=d(1061),Ii=d(105);class Tl{constructor(a,b,c,f){this.ei=a;this.QIe=b;this.Tkc=c;this.mxa=f}CY(a){let b=null,c=!0;if(this.ei.w1c)b=a.Usa,c=!1;else if(this.QIe.gd===C.a.typing||this.QIe.gd===C.a.OCa||this.QIe.gd===
C.a.BSa)b=a.Usa;b&&(this.mxa&&this.JSi(b.toString()),Kc.a.BGa(),this.Tkc.WLh(b,c),ya.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.Usa.toString(),Kc.a.vf(new Date)));return!1}update(){}JSi(a){const b=new mo.ActionContext(Ii.a.nOh,1,null);b.Qj=!0;b.HF=new Date;b.Wa(Ii.a.ZY,Kc.a.Cab(a).toString());b.$p=!0;Kc.a.Naa(b)}}Object(m.a)(Tl,"TextEditingRevisionInfoMetaDataUpdater",null,[1366]);class sj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Xb(a){this.K=a;
const b=()=>new gh.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").S3b(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>w.AFrameworkApplication.Yg);a.register(1344,"PowerPointWebEditor.Storage.IOutboundHelper").na().oa(()=>new Ve(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1345,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").na().oa(()=>new nn(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1346,"PowerPointWebEditor.IPresentationResourcesManager").na().oa(()=>new Mo(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").zd(7),c=>new Wn(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),
this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.XIi()}XIi(){this.K.register(zk,"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").na();this.K.register(mn,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").na();this.K.register(1347,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").na().oa(()=>new Un(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),
this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));this.K.register(1348,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").na().oa(()=>new No([new al(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),Fm.Yxg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new Tl(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();
this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){n.a.instance.Ac(new sj)}}Object(m.a)(sj,"PPTWebEditorStoragePackage",null,[2,3]);class Bc{constructor(a,b,c){this.SVh=a;this.wZh=b;this.n9h=c}get LCID(){return this.SVh}get tkl(){return this.n9h}get FSf(){return this.wZh}get joe(){return!!(this.FSf&Bc.WUh)}get mbc(){return!!(this.FSf&Bc.XUh)}static O_c(){Bc.MZe={["20490"]:new Bc(20490,4215112,"Latn"),["8251"]:new Bc(8251,4215112,"Latn"),["17418"]:new Bc(17418,
4215112,"Latn"),["17417"]:new Bc(17417,4215112,"Latn"),["8218"]:new Bc(8218,4215304,"Cyrl"),["8204"]:new Bc(8204,4215112,"Latn"),["8202"]:new Bc(8202,4215112,"Latn"),["8201"]:new Bc(8201,4215112,"Latn"),["8193"]:new Bc(8193,4493640,"Arab"),["6154"]:new Bc(6154,4215112,"Latn"),["7227"]:new Bc(7227,4215112,"Latn"),["19466"]:new Bc(19466,4215112,"Latn"),["16394"]:new Bc(16394,4215112,"Latn"),["16393"]:new Bc(16393,4215112,"Latn"),["16385"]:new Bc(16385,4493640,"Arab"),["7194"]:new Bc(7194,4215048,"Cyrl"),
["7180"]:new Bc(7180,20808,"Latn"),["7178"]:new Bc(7178,4215112,"Latn"),["7177"]:new Bc(7177,4215112,"Latn"),["7169"]:new Bc(7169,4493640,"Arab"),["12289"]:new Bc(12289,4493640,"Arab"),["6203"]:new Bc(6203,4215080,"Latn"),["15372"]:new Bc(15372,4215112,"Latn"),["15370"]:new Bc(15370,4215112,"Latn"),["15369"]:new Bc(15369,4215112,"Latn"),["15361"]:new Bc(15361,4493640,"Arab"),["6170"]:new Bc(6170,4215304,"Latn"),["6156"]:new Bc(6156,4215112,"Latn"),["18442"]:new Bc(18442,4215112,"Latn"),["6153"]:new Bc(6153,
4215112,"Latn"),["6145"]:new Bc(6145,4493640,"Arab"),["4155"]:new Bc(4155,4215080,"Latn"),["11274"]:new Bc(11274,4215112,"Latn"),["5179"]:new Bc(5179,4215112,"Latn"),["14348"]:new Bc(14348,4215112,"Latn"),["14346"]:new Bc(14346,4215112,"Latn"),["14345"]:new Bc(14345,20808,"Latn"),["14337"]:new Bc(14337,4493640,"Arab"),["5146"]:new Bc(5146,4215048,"Latn"),["5132"]:new Bc(5132,4215112,"Latn"),["5130"]:new Bc(5130,4215112,"Latn"),["5129"]:new Bc(5129,4215112,"Latn"),["5127"]:new Bc(5127,4215112,"Latn"),
["5124"]:new Bc(5124,4281672,"Hant"),["5121"]:new Bc(5121,4493640,"Arab"),["31770"]:new Bc(31770,4210820,""),["31748"]:new Bc(31748,4277380,""),["10266"]:new Bc(10266,4215048,"Cyrl"),["10252"]:new Bc(10252,4215112,"Latn"),["10250"]:new Bc(10250,4215112,"Latn"),["10249"]:new Bc(10249,4215112,"Latn"),["13324"]:new Bc(13324,4215112,"Latn"),["13322"]:new Bc(13322,4215112,"Latn"),["13321"]:new Bc(13321,4215112,"Latn"),["10241"]:new Bc(10241,4493640,"Arab"),["13313"]:new Bc(13313,4493640,"Arab"),["4122"]:new Bc(4122,
4215048,"Latn"),["4108"]:new Bc(4108,4215112,"Latn"),["4106"]:new Bc(4106,4215112,"Latn"),["4105"]:new Bc(4105,4215112,"Latn"),["4103"]:new Bc(4103,4215112,"Latn"),["4100"]:new Bc(4100,4282696,"Hans"),["3179"]:new Bc(3179,4215048,"Latn"),["4097"]:new Bc(4097,4493640,"Arab"),["1085"]:new Bc(1085,299432,"Hebr"),["1144"]:new Bc(1144,4280616,"Yiii"),["21514"]:new Bc(21514,4215112,"Latn"),["2145"]:new Bc(2145,5132616,"Deva"),["3131"]:new Bc(3131,4215112,"Latn"),["2143"]:new Bc(2143,4215432,"Latn"),["12314"]:new Bc(12314,
4215048,"Cyrl"),["1070"]:new Bc(1070,4215080,"Latn"),["1130"]:new Bc(1130,4215080,"Latn"),["12300"]:new Bc(12300,4215112,"Latn"),["1091"]:new Bc(1091,4215080,"Latn"),["12298"]:new Bc(12298,4215112,"Latn"),["12297"]:new Bc(12297,4215112,"Latn"),["2055"]:new Bc(2055,4215112,"Latn"),["2052"]:new Bc(2052,4282664,"Hans"),["2115"]:new Bc(2115,4215368,"Cyrl"),["9242"]:new Bc(9242,4215304,"Latn"),["3098"]:new Bc(3098,4215048,"Cyrl"),["2107"]:new Bc(2107,4215112,"Latn"),["9228"]:new Bc(9228,4215112,"Latn"),
["3084"]:new Bc(3084,4215112,"Latn"),["9226"]:new Bc(9226,4215112,"Latn"),["3082"]:new Bc(3082,4215080,"Latn"),["3081"]:new Bc(3081,4215112,"Latn"),["2094"]:new Bc(2094,4215080,"Latn"),["3079"]:new Bc(3079,4215112,"Latn"),["2092"]:new Bc(2092,4215368,"Cyrl"),["1064"]:new Bc(1064,4215080,"Cyrl"),["3076"]:new Bc(3076,4281640,"Hant"),["2155"]:new Bc(2155,4215048,"Latn"),["3073"]:new Bc(3073,4493640,"Arab"),["1153"]:new Bc(1153,4215080,"Latn"),["1119"]:new Bc(1119,299400,"Arab"),["1086"]:new Bc(1086,
4215080,"Latn"),["2144"]:new Bc(2144,938632,"Deva"),["2077"]:new Bc(2077,4215112,"Latn"),["1053"]:new Bc(1053,4215080,"Latn"),["2141"]:new Bc(2141,4215336,"Latn"),["2074"]:new Bc(2074,4215304,"Latn"),["2073"]:new Bc(2073,20808,"Cyrl"),["2072"]:new Bc(2072,4215112,"Latn"),["2137"]:new Bc(2137,4493896,"Arab"),["2070"]:new Bc(2070,4215048,"Latn"),["2068"]:new Bc(2068,4215048,"Latn"),["2067"]:new Bc(2067,4215112,"Latn"),["1073"]:new Bc(1073,4215080,"Latn"),["2064"]:new Bc(2064,4215112,"Latn"),["2129"]:new Bc(2129,
414016,"Tibt"),["2128"]:new Bc(2128,4608584,"Mong"),["2060"]:new Bc(2060,4215112,"Latn"),["1132"]:new Bc(1132,4215080,"Latn"),["1097"]:new Bc(1097,5132584,"Taml"),["2057"]:new Bc(2057,4215080,"Latn"),["1164"]:new Bc(1164,4493608,"Arab"),["106"]:new Bc(106,4210820,""),["2118"]:new Bc(2118,4493640,"Arab"),["2117"]:new Bc(2117,5132584,"Beng"),["2049"]:new Bc(2049,4493640,"Arab"),["1156"]:new Bc(1156,4215080,"Latn"),["2110"]:new Bc(2110,4215112,"Latn"),["1054"]:new Bc(1054,4608296,"Thai"),["2108"]:new Bc(2108,
4215048,"Latn"),["1083"]:new Bc(1083,4215080,"Latn"),["136"]:new Bc(136,4210820,""),["1114"]:new Bc(1114,4493608,"Syrc"),["1148"]:new Bc(1148,4215080,"Latn"),["1145"]:new Bc(1145,20776,"Latn"),["11290"]:new Bc(11290,4215304,"Latn"),["1075"]:new Bc(1075,20776,"Latn"),["1106"]:new Bc(1106,4215080,"Latn"),["1140"]:new Bc(1140,4215080,"Latn"),["120"]:new Bc(120,4276356,""),["1136"]:new Bc(1136,4215080,"Latn"),["1066"]:new Bc(1066,4215080,"Latn"),["1098"]:new Bc(1098,5132584,"Telu"),["1169"]:new Bc(1169,
4215048,"Latn"),["11276"]:new Bc(11276,4215112,"Latn"),["61"]:new Bc(61,295044,"Hebr"),["1060"]:new Bc(1060,4215080,"Latn"),["11273"]:new Bc(11273,4215112,"Latn"),["1058"]:new Bc(1058,4215080,"Cyrl"),["128"]:new Bc(128,4489348,""),["1160"]:new Bc(1160,4215080,"Latn"),["1159"]:new Bc(1159,4215080,"Latn"),["1158"]:new Bc(1158,20776,"Latn"),["1157"]:new Bc(1157,4215080,"Cyrl"),["11265"]:new Bc(11265,4493640,"Arab"),["1155"]:new Bc(1155,4215080,"Latn"),["1154"]:new Bc(1154,4215080,"Latn"),["1117"]:new Bc(1117,
4215080,"Cans"),["1152"]:new Bc(1152,4493608,"Arab"),["1115"]:new Bc(1115,5132584,"Sinh"),["1150"]:new Bc(1150,4215080,"Latn"),["1113"]:new Bc(1113,938280,"Deva"),["1112"]:new Bc(1112,938280,"Beng"),["51"]:new Bc(51,16516,""),["1146"]:new Bc(1146,4215080,"Latn"),["1109"]:new Bc(1109,5132584,"Mymr"),["115"]:new Bc(115,4210820,""),["1143"]:new Bc(1143,4215080,"Latn"),["1142"]:new Bc(1142,20872,"Latn"),["1141"]:new Bc(1141,4215080,"Latn"),["1104"]:new Bc(1104,4215080,"Cyrl"),["2058"]:new Bc(2058,4215112,
"Latn"),["1102"]:new Bc(1102,5132584,"Deva"),["1137"]:new Bc(1137,20776,"Latn"),["1100"]:new Bc(1100,5132584,"Mlym"),["1135"]:new Bc(1135,4215080,"Latn"),["1134"]:new Bc(1134,4215080,"Latn"),["1133"]:new Bc(1133,4215080,"Cyrl"),["1096"]:new Bc(1096,5132584,"Orya"),["1131"]:new Bc(1131,4215048,"Latn"),["1094"]:new Bc(1094,5132584,"Guru"),["1129"]:new Bc(1129,20872,"Latn"),["1128"]:new Bc(1128,4215080,"Latn"),["1127"]:new Bc(1127,20776,"Latn"),["1126"]:new Bc(1126,20776,"Latn"),["1125"]:new Bc(1125,
4493608,"Thaa"),["1124"]:new Bc(1124,4215080,"Latn"),["1123"]:new Bc(1123,4493608,"Arab"),["1122"]:new Bc(1122,4215080,"Latn"),["1121"]:new Bc(1121,5132584,"Deva"),["1120"]:new Bc(1120,299400,"Arab"),["1118"]:new Bc(1118,4215080,"Ethi"),["1082"]:new Bc(1082,4215080,"Latn"),["1116"]:new Bc(1116,4215080,"Cher"),["1080"]:new Bc(1080,4215080,"Latn"),["1079"]:new Bc(1079,4215080,"Geor"),["1078"]:new Bc(1078,4215080,"Latn"),["1077"]:new Bc(1077,4215080,"Latn"),["1111"]:new Bc(1111,5132584,"Deva"),["1110"]:new Bc(1110,
4215080,"Latn"),["1074"]:new Bc(1074,4215080,"Latn"),["1108"]:new Bc(1108,4608296,"Laoo"),["1107"]:new Bc(1107,4608296,"Khmr"),["1071"]:new Bc(1071,4215080,"Cyrl"),["1105"]:new Bc(1105,4608296,"Tibt"),["1069"]:new Bc(1069,4215080,"Latn"),["1103"]:new Bc(1103,5132584,"Deva"),["1067"]:new Bc(1067,4215080,"Armn"),["1101"]:new Bc(1101,5132584,"Beng"),["1065"]:new Bc(1065,4493608,"Arab"),["1099"]:new Bc(1099,5132584,"Knda"),["1063"]:new Bc(1063,4215080,"Latn"),["1062"]:new Bc(1062,4215080,"Latn"),["1061"]:new Bc(1061,
4215080,"Latn"),["1095"]:new Bc(1095,5132584,"Gujr"),["1059"]:new Bc(1059,4215080,"Cyrl"),["1093"]:new Bc(1093,5132584,"Beng"),["1092"]:new Bc(1092,4215080,"Cyrl"),["1056"]:new Bc(1056,4493608,"Arab"),["1090"]:new Bc(1090,4215080,"Latn"),["1089"]:new Bc(1089,4215080,"Latn"),["1088"]:new Bc(1088,4215080,"Cyrl"),["1087"]:new Bc(1087,4215080,"Cyrl"),["1052"]:new Bc(1052,4215080,"Latn"),["1051"]:new Bc(1051,4215080,"Latn"),["1050"]:new Bc(1050,4215048,"Latn"),["1049"]:new Bc(1049,4215080,"Cyrl"),["1048"]:new Bc(1048,
4215080,"Latn"),["1081"]:new Bc(1081,5132584,"Deva"),["1046"]:new Bc(1046,4215048,"Latn"),["1045"]:new Bc(1045,4215080,"Latn"),["1044"]:new Bc(1044,4215048,"Latn"),["1043"]:new Bc(1043,4215080,"Latn"),["1076"]:new Bc(1076,4215080,"Latn"),["1041"]:new Bc(1041,4280616,"Jpan"),["1040"]:new Bc(1040,4215080,"Latn"),["119"]:new Bc(119,4210820,""),["1072"]:new Bc(1072,4215176,"Latn"),["1037"]:new Bc(1037,4493608,"Hebr"),["1036"]:new Bc(1036,4215080,"Latn"),["1035"]:new Bc(1035,4215080,"Latn"),["1068"]:new Bc(1068,
4215080,"Latn"),["1033"]:new Bc(1033,4215048,"Latn"),["1032"]:new Bc(1032,4215080,"Grek"),["1031"]:new Bc(1031,4215080,"Latn"),["1030"]:new Bc(1030,4215080,"Latn"),["1029"]:new Bc(1029,4215080,"Latn"),["1028"]:new Bc(1028,4281672,"Hant"),["1027"]:new Bc(1027,4215080,"Latn"),["1026"]:new Bc(1026,4215080,"Cyrl"),["140"]:new Bc(140,4489348,""),["1057"]:new Bc(1057,4215080,"Latn"),["50"]:new Bc(50,4210820,""),["1055"]:new Bc(1055,4215080,"Latn"),["135"]:new Bc(135,4210820,""),["134"]:new Bc(134,16516,
""),["133"]:new Bc(133,4210820,""),["132"]:new Bc(132,4210820,""),["131"]:new Bc(131,4210820,""),["130"]:new Bc(130,4210820,""),["129"]:new Bc(129,4210820,""),["1047"]:new Bc(1047,4215080,"Latn"),["126"]:new Bc(126,4210820,""),["89"]:new Bc(89,5128324,""),["124"]:new Bc(124,4210820,""),["1042"]:new Bc(1042,4280616,"Hang"),["122"]:new Bc(122,4210820,""),["121"]:new Bc(121,16516,""),["1039"]:new Bc(1039,4215080,"Latn"),["1038"]:new Bc(1038,4215080,"Latn"),["118"]:new Bc(118,16516,""),["117"]:new Bc(117,
4210820,""),["116"]:new Bc(116,4210820,""),["1034"]:new Bc(1034,4219176,"Latn"),["114"]:new Bc(114,4210820,""),["113"]:new Bc(113,16516,""),["112"]:new Bc(112,4210820,""),["111"]:new Bc(111,4210820,""),["110"]:new Bc(110,4210820,""),["109"]:new Bc(109,4210820,""),["108"]:new Bc(108,4210820,""),["107"]:new Bc(107,4210820,""),["1025"]:new Bc(1025,4493608,"Arab"),["105"]:new Bc(105,16516,""),["104"]:new Bc(104,4210820,""),["103"]:new Bc(103,4210820,""),["102"]:new Bc(102,16516,""),["101"]:new Bc(101,
4489348,""),["100"]:new Bc(100,4210820,""),["99"]:new Bc(99,4489348,""),["98"]:new Bc(98,4210820,""),["97"]:new Bc(97,5128324,""),["96"]:new Bc(96,966788,""),["95"]:new Bc(95,4505732,""),["94"]:new Bc(94,4210820,""),["93"]:new Bc(93,4210820,""),["92"]:new Bc(92,4210820,""),["91"]:new Bc(91,5128324,""),["90"]:new Bc(90,4489348,""),["85"]:new Bc(85,5128324,""),["88"]:new Bc(88,934020,""),["87"]:new Bc(87,5128324,""),["86"]:new Bc(86,4210820,""),["9275"]:new Bc(9275,4215112,"Latn"),["84"]:new Bc(84,
4604036,""),["83"]:new Bc(83,4604036,""),["82"]:new Bc(82,4210820,""),["81"]:new Bc(81,4604036,""),["80"]:new Bc(80,4604036,""),["79"]:new Bc(79,5128324,""),["78"]:new Bc(78,5128324,""),["77"]:new Bc(77,5128324,""),["76"]:new Bc(76,5128324,""),["75"]:new Bc(75,5128324,""),["74"]:new Bc(74,5128324,""),["73"]:new Bc(73,5128324,""),["72"]:new Bc(72,4210820,""),["71"]:new Bc(71,4210820,""),["70"]:new Bc(70,5128324,""),["69"]:new Bc(69,5128324,""),["68"]:new Bc(68,4210820,""),["67"]:new Bc(67,4210820,
""),["66"]:new Bc(66,4210820,""),["65"]:new Bc(65,4210820,""),["64"]:new Bc(64,4210820,""),["63"]:new Bc(63,4210820,""),["62"]:new Bc(62,4210820,""),["18441"]:new Bc(18441,4215112,"Latn"),["59"]:new Bc(59,4210820,""),["58"]:new Bc(58,4210820,""),["57"]:new Bc(57,5128324,""),["56"]:new Bc(56,4210820,""),["55"]:new Bc(55,4210820,""),["54"]:new Bc(54,4210820,""),["53"]:new Bc(53,4210820,""),["52"]:new Bc(52,4210820,""),["31"]:new Bc(31,4210820,""),["47"]:new Bc(47,4210820,""),["49"]:new Bc(49,4210820,
""),["48"]:new Bc(48,4210820,""),["44"]:new Bc(44,4210820,""),["46"]:new Bc(46,4210820,""),["45"]:new Bc(45,4210820,""),["41"]:new Bc(41,4489348,""),["43"]:new Bc(43,4210820,""),["42"]:new Bc(42,4210820,""),["38"]:new Bc(38,4210820,""),["40"]:new Bc(40,4210820,""),["39"]:new Bc(39,4210820,""),["35"]:new Bc(35,4210820,""),["37"]:new Bc(37,4210820,""),["36"]:new Bc(36,4210820,""),["9225"]:new Bc(9225,4215112,"Latn"),["34"]:new Bc(34,4210820,""),["33"]:new Bc(33,4210820,""),["32"]:new Bc(32,4489348,
""),["29"]:new Bc(29,4210820,""),["30"]:new Bc(30,4604036,""),["27"]:new Bc(27,4210820,""),["28"]:new Bc(28,4210820,""),["9217"]:new Bc(9217,4493640,"Arab"),["26"]:new Bc(26,4210820,""),["25"]:new Bc(25,4210820,""),["24"]:new Bc(24,4210820,""),["23"]:new Bc(23,4210820,""),["22"]:new Bc(22,4210820,""),["21"]:new Bc(21,4210820,""),["20"]:new Bc(20,4210820,""),["19"]:new Bc(19,4210820,"Latn"),["18"]:new Bc(18,4276356,""),["17"]:new Bc(17,4276356,""),["16"]:new Bc(16,4210820,""),["15"]:new Bc(15,4210820,
""),["14"]:new Bc(14,4210820,""),["13"]:new Bc(13,4489348,""),["12"]:new Bc(12,4210820,""),["11"]:new Bc(11,4210820,""),["10"]:new Bc(10,4210820,""),["9"]:new Bc(9,4210820,""),["8"]:new Bc(8,4210820,""),["7"]:new Bc(7,4210820,""),["6"]:new Bc(6,4210820,""),["5"]:new Bc(5,4210820,""),["4"]:new Bc(4,4278404,""),["3"]:new Bc(3,4210820,""),["2"]:new Bc(2,4210820,""),["1"]:new Bc(1,4489348,""),["0"]:new Bc(0,1,"")}}static He(a){Bc.MZe||Bc.O_c();return Bc.MZe[a.toString()]}}Bc.MZe=null;Bc.WUh=262144;Bc.XUh=
65536;Object(m.a)(Bc,"ExtendedCultureInfo",null,[]);class Wm{pV(a,b){var c=a.sa(Ya.a.At,1033);ab.a.He(c)&&(c=Bc.He(c))&&(c.mbc?a.setValue(va.a.eastAsianFont,b):c.joe&&a.setValue(va.a.complexScriptFont,b));a.setValue(va.a.latinFont,b)}static eHi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.Ae(Ya.a.subscript,!0):0<b.baselineField?a.Ae(Ya.a.superscript,!0):(a.Ae(Ya.a.subscript,!1),a.Ae(Ya.a.superscript,!1)));b.bFieldSpecified&&a.Ae(Ya.a.bold,b.bField);b.noProofFieldSpecified&&a.Ae(sb.a.noProof,
b.noProofField);b.iFieldSpecified&&a.Ae(Ya.a.italic,b.iField);b.strikeFieldSpecified&&a.Ae(Ya.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.Ae(Ya.a.underline,b.uField);if(b.langField){var f=ab.a.He(b.langField);f?a.Ae(Ya.a.At,f.LCID):ya.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=ab.a.He(b.altLangField))?a.Ae(va.a.CKc,f.LCID):ya.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+
b.altLangField));b.hlinkClickField&&(a.Ae(Ya.a.zt,!0),a.Ae(Ya.a.m0,!0));Wm.hHi(a,b,c)}static xPf(a){a>qg.a.$gd?a=qg.a.$gd:a<qg.a.shd&&(a=qg.a.shd);return Wm.w0i(a)}static hHi(a,b,c){b.szFieldSpecified&&a.Ae(Ya.a.fontSize,Wm.xPf(b.szField));(c=Hf.Box4ColorHelper.LMb(b,c))&&a.setValue(Ya.a.fontColor,c.ND);b.latinField&&a.Ae(va.a.latinFont,b.latinField.typefaceField);b.eaField&&a.Ae(va.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.Ae(va.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&
a.Ae(V.a.capitalization,b.capField);b.symField&&a.Ae(va.a.bQb,b.symField.typefaceField)}static w0i(a){return a/(qg.a.rpc*qg.a.wbb)}static HGf(a){return a*qg.a.wbb}}Object(m.a)(Wm,"FormattingHelper",null,[1221]);class Cn{cgj(a,b,c){let f="";const l=a.sa(sb.a.A0,[]);l&&0<=b&&b<l.length&&(a=a.Nh)&&(b=a.Be(l[b]))&&b.Ta(va.a.schemeColor)&&((b=bm.SchemeColor.parse(b.eb(va.a.schemeColor)))?b.qua?f=Xh.i(b.tQ):b.VVe(c)&&(f=Xh.i(b.tQ)):ya.a.J(38606471,826,50,"schemeClr is null."));return f}egj(a,b){let c="";
(a=a.zud)||ya.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&ya.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");a&&a.schemeClrField&&(14===a.schemeClrField.valField?ya.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?ya.a.J(38549312,826,50,"The color of shapeFont is B"):ya.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=Hf.Box4ColorHelper.Dkb(a,b),b=Xh.g(b.X0a),c=Xh.i(b),"000000"===c?ya.a.J(38549316,
826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?ya.a.J(38549318,826,50,"The resolved color of shapeFont is W"):ya.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));return c}}Object(m.a)(Cn,"NonTableThemeColorHelper",null,[1356]);class Gm{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(m.a)(Gm,"CT_TextFont",null,[]);class Gl{constructor(){this.ATa=this.T0a=null}}Object(m.a)(Gl,"ThemeFont",null,[]);
class jf{static isThemeFont(a){return jf.ejl.hasOwnProperty(a)}static clj(a){let b="",c,f;({m$a:c,omb:f}=jf.Vkj(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static awi(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=jf.z0,y=jf.z0,G=jf.z0;({Gwg:l,yXf:y,ASf:G}=jf.ZRh(l,y,G,a));({Gwg:l,yXf:y,ASf:G}=jf.ZRh(l,y,G,b));a=c.FontScheme;l!==jf.z0?(jf.cLb(a,0,l,jf.Lgd,f),jf.cLb(a,
1,l,jf.yhd,f)):(l=jf.Oab(a,0,0),b=jf.Oab(a,1,0),jf.Xa(l)||jf.Xa(b)||(f.push(Object.assign(new Gl,{T0a:l,ATa:jf.Lgd})),f.push(Object.assign(new Gl,{T0a:b,ATa:jf.yhd}))));y!==jf.z0?(jf.cLb(a,0,y,jf.Kgd,f),jf.cLb(a,1,y,jf.xhd,f)):(y=jf.Oab(a,0,1),l=jf.Oab(a,1,1),jf.Xa(y)||jf.Xa(l)||(f.push(Object.assign(new Gl,{T0a:y,ATa:jf.Kgd})),f.push(Object.assign(new Gl,{T0a:l,ATa:jf.xhd}))));G!==jf.z0?(jf.cLb(a,0,G,jf.Jgd,f),jf.cLb(a,1,G,jf.whd,f)):(G=jf.Oab(a,0,2),y=jf.Oab(a,1,2),jf.Xa(G)||jf.Xa(y)||(f.push(Object.assign(new Gl,
{T0a:G,ATa:jf.Jgd})),f.push(Object.assign(new Gl,{T0a:y,ATa:jf.whd}))));return f}static Xa(a){return!a||!a.length}static cLb(a,b,c,f,l){a&&c!==jf.z0&&(c=jf.Azj(a,b,c),jf.Xa(c)&&(c=jf.Oab(a,b,0),jf.Xa(c)&&(c="Arial")),l.push(Object.assign(new Gl,{T0a:c,ATa:f})))}static Oab(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=jf.Ueg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=jf.Ueg(a.minorFontField,c))}return f}static Ueg(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);
break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static Azj(a,b,c){if(!a||c===jf.z0)return"";let f="";if(1066===c)f="Viet";else if(1152===c)f="Uigh";else if(c=Bc.He(c))f=c.tkl;return jf.Bzj(a,b,f)}static Bzj(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=jf.Teg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=jf.Teg(a.minorFontField,c))}return f}static Teg(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=
0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static ZRh(a,b,c,f){if(f!==jf.z0){const l=Bc.He(f);l&&(l.mbc?b===jf.z0&&(b=f):l.joe?c===jf.z0&&(c=f):a===jf.z0&&(a=f))}return{Gwg:a,yXf:b,ASf:c}}static Vkj(a){switch(a){case jf.Jgd:return{returnValue:!0,m$a:0,omb:2};case jf.Kgd:return{returnValue:!0,m$a:0,omb:1};case jf.Lgd:return{returnValue:!0,m$a:0,omb:0};case jf.whd:return{returnValue:!0,m$a:1,omb:2};
case jf.xhd:return{returnValue:!0,m$a:1,omb:1};case jf.yhd:return{returnValue:!0,m$a:1,omb:0}}return{returnValue:!1,m$a:2,omb:0}}static Svb(a,b){let c=null;if(0===a)switch(b){case 2:c=jf.Jgd;break;case 1:c=jf.Kgd;break;case 0:c=jf.Lgd}else if(1===a)switch(b){case 2:c=jf.whd;break;case 1:c=jf.xhd;break;case 0:c=jf.yhd}null===c&&(ya.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new Gm,{typefaceField:c,charsetField:1})}}jf.Jgd="+mj-cs";
jf.Kgd="+mj-ea";jf.Lgd="+mj-lt";jf.whd="+mn-cs";jf.xhd="+mn-ea";jf.yhd="+mn-lt";jf.z0=0;jf.ejl={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(m.a)(jf,"TextFontHelper",null,[]);class bl{constructor(a,b,c){this.ua=a;this.lc=b;this.Ycd=c}jgl(a,b){let c="";var f=a.sa(Ya.a.At,jf.z0),l=a.sa(va.a.CKc,jf.z0),y=Bc.He(f===jf.z0?1033:f);if(y){let G="";a.Ta(va.a.bQb)?G=a.eb(va.a.bQb):y.joe&&a.Ta(va.a.complexScriptFont)?G=a.eb(va.a.complexScriptFont):y.mbc&&a.Ta(va.a.eastAsianFont)?
G=a.eb(va.a.eastAsianFont):a.Ta(va.a.latinFont)&&(G=a.eb(va.a.latinFont));if(jf.isThemeFont(G)){y=!1;let R=null;if(this.Ycd){if(b=Object(sa.a)(115,this.lc.jg(b)))R=b.Fd}else{if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");R=this.ua.Ba.Fd}if(R&&(f=jf.awi(f,l,R)))for(l=0;l<f.length;l++)if(G===f[l].ATa){c=f[l].T0a;y=!0;break}y||(c=jf.clj(G))}else c=G}c&&a.Ae(Ya.a.font,c)}}Object(m.a)(bl,"FontResolver",null,[1355]);class sk{constructor(a){this.Blk=a}HLi(a,b,c){a(Ya.a.At);a(va.a.latinFont);
a(va.a.eastAsianFont);a(va.a.complexScriptFont);a(va.a.bQb);a(va.a.CKc);a(va.a.Fd);a(va.a.Wub);a(va.a.xCb);a(va.a.IN);a(va.a.schemeColor);a(va.a.L1c);a(va.a.W3d);a(va.a.T3d);a(va.a.Q3d);a(va.a.$3d);a(va.a.nVa);this.Blk.jgl(b(),c)}}Object(m.a)(sk,"PptFormattingCacheCopyPropertyStrategy",null,[1372]);class xe{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Xb(a){this.K=a;a.register(1355,"Box4.IFontResolver").na().oa(()=>new bl(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1221,"PowerPointWebEditor.IFormattingHelper").na().oa(()=>new Wm);a.register(sk,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").na().oa(()=>new sk(a.resolve("Box4.IFontResolver")));a.register(1356,"PowerPointWebEditor.INonTableThemeColorHelper").na().oa(()=>new Cn)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");
this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){n.a.instance.Ac(new xe)}}Object(m.a)(xe,"PPTWebEditorTextFormattingPackage",null,[2,3]);class Hg{constructor(a){this.hd=a;this.fYh=M.a.instance.ga(115)}isg(a){return this.Nqg(a)?!0:this.fYh?1074135161===a.Xe||1074135162===a.Xe:!1}Mqg(a){return this.Nqg(a)||131162===a.Xe||4325465===a.Xe||1179729===a.Xe}Nqg(a){return 131140===a.Xe||this.hd.gg&&131120===a.Xe}PWf(a){return ta.a.any(a.nK,(b,c)=>!this.Mqg(c)&&!this.isg(c))}}
Object(m.a)(Hg,"UndoRevisionValidator",null,[1390]);class Dn{constructor(){this.kd=Fb.a.instance.rb("Box4.IFeatureHelper")}OOb(){return w.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}R1a(){return this.OOb()&&w.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(m.a)(Dn,"UndoSettingsManager",null,[1389]);var Ul=d(353),Ji=d(1060),Ap=d(207);class on{Ta(a){return a.Ta(void 0)}Nbg(a,b){return a.sa(b,null)}IXc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Ji.a(a)}Qbg(a,b){return a.sa(b,
"")}gAh(a,b,c){a.setValue(b,c)}}Object(m.a)(on,"MergeableObjectUtilities",null,[531]);class Xm{constructor(a,b,c,f,l){this.Eb=a;this.ua=b;this.Ga=c;this.pa=f;this.U0=l}bjd(a,b,c){if(a)if("PowerPointGroupShapes"===b&&c)for(a=a.nK,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Xe&&f.Ta(va.a.s9)){f=(new on).IXc(f,va.a.s9);for(var l=0;l<f.length;l++){var y=this.ua.Ba;if(!y)throw Error.argumentNull("ActiveSlide is null");const G=this.U0.Zda(f.ga(l));y=y.WC(G.get_shapeId());b.push(y)}this.kMj(b)}}else if("PowerPointUngroupShapes"===
b&&!c)for(a=a.nK,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Xe&&c.Ta(va.a.Xpa))for(c=(new on).IXc(c,va.a.Xpa),f=0;f<c.length;f++){l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");y=this.U0.Zda(c.ga(f));l=l.WC(y.get_shapeId());this.jMj(l)}}VZc(a){if(a){const b=a.rg(this.Eb.Na);b.lla();b.sNb=!0;this.pa.O8(a)}else ya.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}kMj(a){if(a.length){var b=this.Ga.Fs(a[0]);this.VZc(b);
for(const c of a)this.VZc(c)}}jMj(a){this.VZc(a);if(a.Of){a=this.Ga.yx(a);for(const b of a)this.VZc(b)}}}Object(m.a)(Xm,"GroupUngroupUndoRedoActionController",null,[1352]);class om{P$g(){}bjd(){}o$g(){}N9g(){}w4c(){return!1}}Object(m.a)(om,"NoOpTablePartialEditController",null,[1353]);class Xn{constructor(a,b,c,f,l,y){this.igb=null;this.ei=a;this.Ga=b;this.Tkc=c;this.Ub=f;this.pa=l;this.Ehc=y}P$g(){this.Ure()&&this.J5e()}bjd(a){a&&this.Ure()&&(a=this.igb,this.J5e(),this.EHh(a))}o$g(a,b,c,f){let l;
this.Ure()&&!this.f4j(a,b,c,f)&&(l=this.J5e());return l}N9g(a,b,c){if(a&&b&&c){this.igb=null;a=this.pa.Ud();c=new Qe.a;b=b.nK;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Xe&&f.Ta(va.a.cellId)&&(f=this.Ga.An(f),Array.contains(a,f)&&c.$(f.get_shapeId(),f))}0<c.count&&this.EHh(c.values.ga(0))}}f4j(a,b,c,f){let l=!1;b&&this.w4c(a)&&(f=b.cU&&f,l=(c||f)&&b.actionId===a,this.Ehc||(l=(b.actionId===a||this.w4c(b.actionId))&&1===this.Tkc.ozb(b.T6)||l));return l}w4c(a){let b=a===C.a.OCa||a===C.a.BSa||
a===C.a.typing;this.Ehc||(b=a===C.a.$B||a===C.a.enter||b);return b}EHh(a){this.igb=a}J5e(){if(this.igb){var a=this.Ub.Di.Fi.xx.id;0!==this.Tkc.ozb(a)&&this.Tkc.WLh(a,!1);a=this.ei.I8a(this.igb,!0)}this.igb=null;return a}Ure(){return!!this.igb}}Object(m.a)(Xn,"TablePartialEditController",null,[1353]);var Bp=d(937);class cp{constructor(a,b,c,f){this.Xs=a;this.pwk=c;this.ia=f;this.vb()}vb(){this.ia.ra(ea.a.Gjb,qc.a.application,Object(H.a)(this,this.Gjb,"queryIsShapeTextEditHappened"),96)}Gjb(a,b,c,f,
l){l.Nua=this.Nua(l.Wvc,l.vak);return 32}wCj(a,b,c){this.pwk.mLl(new Bp.a(a,b,c))}Nua(a,b){let c=!1;a&&(c=!this.Xs.L2c()&&a.EGa!==b,this.Xs.L2c()||a.EGa!==b||ya.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",Object(Sa.a)(4,a)?"Shape":"Notes"));return c}}Object(m.a)(cp,"PPTUndoActionBehavior",null,[1388]);class Cp extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(m.a)(Cp,
"OnUndoEventArgs",Sys.EventArgs,[]);var pn=d(742),qn=d(136);class gm extends pn.a{constructor(a=null,b=null,c=null){super(a,b);this.eLd=c||new on}VKb(){super.VKb();const a=new Ji.a,b=new Ma.a;b.add(ia.a.nil);this.Pkb.forEach((l,y)=>{b.add(y);a.add(y);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<a.length;){var c=a.ga(0);a.h4d(0);var f=this.objects.ga(c)||this.I_.Gyb(c);if(f){c=f;f=c.pA();for(let l=0;l<f.length;l++){const y=f[l],G=qn.a.$8b(qn.a.F4f(y));8===G?this.Kzf(this.eLd.Nbg(c,
y),a,b):9===G&&this.eLd.IXc(c,y).forEach(R=>{this.Kzf(R,a,b);return!0})}}else Ea.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}Kzf(a,b,c){c.contains(a)||(c.add(a),this.osg(a)&&(c=this.I_.Gyb(a),this.bMe(c),b.add(a)))}}Object(m.a)(gm,"ReferenceFollowingRevisionDiffer",pn.a,[]);class Jk{cRi(a,b){return new gm(a,b)}}Object(m.a)(Jk,"UndoDifferFactory",null,[1376]);var pm=d(285),Hm=d(598);class dp{constructor(a,b,c,f,l,y,G){a||pm.a.argument("revisionStore cannot be null",
"revisionStore");b||pm.a.argument("undoRevisionValidator cannot be null","undoRevisionValidator");c||pm.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||pm.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||pm.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");y||pm.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.Y8h=a;this.kIc=b;this.Kca=c;this.Fbi=f;this.zYb=l;this.Ibi=y;this.Qkf=G}mPc(a,b){const c=
this.Fbi.cRi(a,b);c.VKb();const f=new Hm.a;f.D5e(this.zYb,a);c.Pkb.forEach((G,R)=>{f.gza(R,G);return!0});const l=new Ji.a,y=a.lU<b.lU;c.objects.forEach((G,R)=>{if(this.kIc.isg(R))return!0;if(y&&!this.kIc.Mqg(R)&&!b.p0(G)&&!a.p0(G))return l.add(G),!0;f.Yra(R);return!0});0<l.length&&ha.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",a.id,b.id,l.Xm());this.Qkf&&this.Qkf.yTl(f);return f.JTc()}dRi(a,b,c,f){b=this.mPc(a,b);if(!b)return null;
if(a.id===c.id)return ha.ULS.sendTraceTag(22607312,365,this.Kca.R1a()?15:50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.Kca.R1a()),b;a=this.mPc(a,c);if(!a)return null;var l=b;this.kIc.PWf(a)?(ha.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),l=new Ji.a,l.add(a),a=new Ji.a,a.add(b),l=this.Ibi.Zzk(f,a,l,c.ird).kP.last()):ha.ULS.sendTraceTag(22607314,365,this.Kca.R1a()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",
this.Kca.R1a());return this.mPc(c,l)}eRi(a,b,c,f,l){let y=null;f||(this.Kca.R1a()||!this.Kca.OOb()?y=this.mPc(c,b):(ha.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(y=this.dRi(a,b,c,l));return y&&this.zGl(y)?y:null}zGl(a){return this.kIc.PWf(a)?(this.Y8h.zmb(a),!0):!1}}Object(m.a)(dp,"UndoRevisionManager",null,[1375]);var Im=d(164);class tk{constructor(a){this.Rof=null;this.Oa=new Wc.a;this.nob=null;this.zsb=[];this.Jbi=
a}dispose(){for(;0<this.zsb.length;)this.Pqh(this.zsb[0])}get iL(){return this.nob}set iL(a){this.nob&&(this.nob.isActive=!1);if(this.nob=a)this.nob.isActive=!0}nBf(a){this.Oa.addHandler(tk.Meh,a)}register(a){if(!this.Qla(a)){const b=this.Jbi.KSi(a);b.mBh(c=>{this.Oa.raiseEvent(tk.Meh,new Cp(c))});a.addListener(this);Array.add(this.zsb,b)}}unregister(a){if(a=this.qzb(a))a===this.iL&&(this.iL=null),this.Pqh(a)}setActive(a){this.iL=this.qzb(a)}sNc(){const a=this.qzb(void 0);a&&(a.fpa(void 0),this.TLe())}get gX(){return this.jJ?
this.iL.gX:!1}get v3d(){return this.jJ?this.iL.v3d:null}get kla(){return this.jJ?this.iL.kla:!1}get dGa(){return this.jJ?this.iL.dGa():!1}u5e(a,b){this.jJ&&this.iL.u5e(a,b)}Dw(){this.jJ&&this.iL.Dw()}aX(){return this.jJ?this.iL.aX():null}undo(){return this.jJ?this.iL.undo():!1}redo(){return this.jJ?this.iL.redo():!1}TZa(a,b,c=!1){this.jJ&&this.iL.TZa(a,b,c)&&(this.TLe(),this.Rof&&this.Rof())}YOe(){this.jJ&&this.iL.YOe()}Pqh(a){a.graphSpace.removeListener(this);a.mBh(null);a.dispose();Array.remove(this.zsb,
a)}Qla(a){return!!this.qzb(a)}get jJ(){return!!this.iL}qzb(a){for(let b=0;b<this.zsb.length;b++){const c=this.zsb[b];if(c.NWj(a))return c}return null}TLe(){Sc.App.Mb.updateCommandUI()}Mjd(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.qzb(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.qzb(a);if(b)b.onAfterLoadContent(a);this.iL===b&&(this.iL.gX||this.iL.kla)&&this.TLe()}onAfterFirstSaveContent(){}}tk.Meh="OnUndo";Object(m.a)(tk,"UndoManager",null,[1386,494,108,1387]);
class A extends tk{constructor(a,b,c){super(a);this.Jjk=b;this.tgd=c;this.Jjk.qii(Object(H.a)(this,this.mHk,"onFailoverSucceeded"));this.tgd.lUd(Object(H.a)(this,this.uIk,"onInitialSelectionSet"))}get mya(){return this.iL}$Yj(a){return this.jJ?this.mya.spg(a):!1}b_d(){this.jJ&&this.mya.GDi()}Kae(a){return this.jJ?this.mya.Kae(a):null}OVc(a){return this.jJ?this.mya.OVc(a):0}K6e(){this.jJ&&this.mya.K6e()}get gX(){return this.jJ?this.mya.bLj:!1}fpa(){this.jJ&&this.mya.fpa(!0)}mHk(a,b){b.v6j&&this.fpa()}uIk(){this.TZa(C.a.tVa,
null)}O$e(a){this.jJ&&this.mya.O$e(a)}L2c(){return this.jJ?this.mya.L2c():!1}zcb(){return this.jJ?this.mya.zcb():!1}}Object(m.a)(A,"PPTUndoManager",tk,[1385,1386,494,108,1387]);class W{Zzk(a,b,c,f){return a?a.khd(b,c,null,f,1,!1,5):null}}Object(m.a)(W,"PPTUndoRevisionMergeStrategy",null,[1384]);var oa=d(142),xa=d(48);class Ia{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){this.fDe=!1;if(xd&&!jc)throw Error.argumentNull("viewElementEventNotifier");this.Dve=a;this.VB=b;this.W0g=c;this.pZa=
f;this.WIa=l;this.Xgb=y;this.Wkc=G;this.$J=jc;this.P5=xd;R===xa.a.Qz&&(R=xa.a.hr);this.mGg=R;this.pa=ja;this.Sb=za;this.hmk=Va;this.Ub=hb;this.Fa=Cb;this.ia=lc;this.Ghc=ic;this.zkc=yc;this.Eb=ec}ahl(){this.dOh();if(this.VB){var a=this.Sb.Qk(this.VB);a&&this.hmk.Ba!==a&&(this.Ub.Ba=a)}if(this.Ghc){if(this.pZa&&0<this.pZa.length){a=[];for(const b of this.pZa){let c=this.Sb.Qk(b);c&&a.push(c)}if(0<a.length){let b;(b=this.pa).yP.apply(b,a)}}this.ia.processAction(ea.a.e1a,2)}this.P5&&this.$J&&this.$J.Ymh()}hV(a=
!1,b=null){this.ahl();if(this.fDe||this.fog())return this.fDe=!1,null;b||(b=this.yub());this.setSelection(a,b);return b}yub(){let a=null;if(0<this.Xgb.length){const b=this.Sb.Qk(this.VB);if(b){const c=[];for(const f of this.Xgb){if(!f)continue;const l=b.MQ(f);if(l){const y=l.rg(this.Eb.Na);y&&!y.sNb&&c.push(Vd.SelectionFactory.rl(l))}}0<c.length&&(a=new oa.SelectionCollection(c,c.length-1))}}a||(a=this.Dve.yub(!0));!a&&this.Wkc&&(a=this.Wkc.o5f());return a}setSelection(a=!1,b=null){this.Dve.setSelection(a,
b);b&&this.Wkc&&ya.a.J(509445784,816,50,"Selection restore to IP level");b||this.mGg!==xa.a.qg?this.Fa.wf(this.mGg):(this.pa.nh(),this.Fa.Bd())}RLc(){return this.Dve.RLc()}dOh(){this.VB=this.a$e(this.VB,this.W0g);const a=[];let b=0;for(const c of this.pZa)a.push(this.a$e(c,this.WIa[b++]));this.pZa=a}a$e(a,b){let c=a;a&&nc.a.Fw(a)&&(a=this.Sb.izb(b),a||(b=this.zkc.Ovj(b),null!=b&&(a=this.Sb.dFa(b))),a&&(c=a.Cb));return c}NPl(){this.VB=this.a$e(this.VB,this.W0g);this.Ghc&&this.dOh();if(this.Xgb.length&&
Array.contains(this.Xgb,0)){Array.clear(this.Xgb);var a=this.yub();if(this.pa.u0(a))for(let b of a)(a=Object(sa.a)(4,b.Ua.node))&&this.Xgb.push(a.get_shapeId())}}$Ul(){this.fDe=this.fog()}fog(){const a=this.Sb.Qk(this.VB);if(!a)return!1;var b=this.Wkc?[this.Wkc.H0d]:this.Xgb;for(const c of b)if((b=a.MQ(c))&&b.iq)return!0;return!1}}Object(m.a)(Ia,"PPTUndoSelectionReference",null,[475,1383]);class qb{constructor(a,b,c,f,l){this.ic=a;this.Cwe=b;this.I7c=c;this.Rkc=f;this.Qkc=l}o5f(){var a=this.ic.Qk(this.Cwe);
if(!a)return null;a=a.MQ(this.I7c);if(!a)return null;a=a.lzb();if(!a)return null;var b=a.sa(Ya.a.Lza,0);const c=a.sa(Ya.a.hha,0);if(!this.Rkc||!this.Qkc||this.Rkc.DMa>=b||this.Rkc.CMa>=c||this.Qkc.DMa>=b||this.Qkc.CMa>=c)return null;b=ub.GraphIterator.pb(a.ff(this.Rkc.DMa,this.Rkc.CMa));b.rc(14);a=ub.GraphIterator.pb(a.ff(this.Qkc.DMa,this.Qkc.CMa));a.rc(14);return Vd.SelectionFactory.T3b(b,a)}get H0d(){return this.I7c}}Object(m.a)(qb,"PPTUndoTableCellSelectionPos",null,[1403]);class Hb{constructor(a,
b,c,f,l,y,G,R){this.Tb=a;this.ic=b;this.uY=c;this.Djk=f;this.Cwe=l;this.I7c=y;this.zfd=G;this.Gvk=R}o5f(){var a=this.ic.Qk(this.WJi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.MQ(this.H0d),!b)return null;var c=[];switch(this.containerType){case 10:c=this.o$d(b);break;case 16:a=this.Tb.Lc(b);if(!a.Ri()||!a.Ri())return null;if(0>this.DMa||0>this.CMa||this.DMa>=a.currentNode.sa(Ya.a.Lza,0)||this.CMa>=a.currentNode.sa(Ya.a.hha,0)){this.uY.j7g(a,0,0);c.push(Vd.SelectionFactory.Ej(a.currentNode,
!0));break}this.uY.j7g(a,this.DMa,this.CMa);c=this.o$d(a.currentNode);break;case 60:c=a.nUa();if(!c)return null;c=this.o$d(c);break;default:return null}return 0<c.length?new oa.SelectionCollection(c,0):null}get H0d(){return this.I7c}o$d(a){const b=[];for(const c of this.VJl){const f=c.pcj(a);f&&b.push(f)}b.length||b.push(Vd.SelectionFactory.Ej(a,!0));return b}get containerType(){return this.Djk}get WJi(){return this.Cwe}get CMa(){return this.zfd?this.zfd.CMa:-1}get DMa(){return this.zfd?this.zfd.DMa:
-1}get VJl(){return this.Gvk}}Object(m.a)(Hb,"PPTUndoTextSelectionPos",null,[1403]);class hc{constructor(a,b){this.mvk=a;this.uvk=b}get CMa(){return this.mvk}get DMa(){return this.uvk}}Object(m.a)(hc,"TableCellIndex",null,[]);class Jc{constructor(a,b,c,f,l,y){this.Tb=a;this.Hh=b;this.Dqk=c;this.Gjk=f;this.lnk=l;this.knk=y}get contextId(){return this.Gjk}get paragraphIndex(){return this.Dqk}get Rac(){return this.lnk}get Qac(){return this.knk}pcj(a){a=this.Tb.Lc(a);if(!a.$fe(this.paragraphIndex)||11!==
a.Dq.type||!a.Db(2)||12!==a.Dq.type&&21!==a.Dq.type||this.Rac>this.Qac||-1>this.Rac||this.Qac>this.Hh.textLength(a.currentNode))return null;switch(this.contextId){case rb.a.Mf:return Vd.SelectionFactory.R3(a.currentNode,this.Rac,this.Qac);case rb.a.textRange:return Vd.SelectionFactory.R3(a.currentNode,this.Rac,this.Qac);case rb.a.endOfParagraph:return Vd.SelectionFactory.oda(a.currentNode);case rb.a.paragraph:return Vd.SelectionFactory.Qu(bb.a.cSa(this.Rac,this.Qac,!1,a.currentNode))}return null}}
Object(m.a)(Jc,"TextContextRecord",null,[]);class ld{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){if(yc&&!ic)throw Error.argumentNull("viewElementEventNotifier");this.Xik=a;this.pa=b;this.nHg=c;this.Ub=f;this.Tb=l;this.Fa=y;this.ic=G;this.Ga=R;this.Hh=ja;this.uY=za;this.ia=Va;this.Ghc=hb;this.zkc=Cb;this.Eb=lc;this.$J=ic;this.P5=yc}Psa(){const a=this.Xik.Psa();let b=null,c=ia.a.nil;const f=this.nHg.Ba;f&&(b=f.Cb,c=f.id);const l=[],y=[];if(this.Ghc){var G=this.pa.Re();for(var R of G)l.push(R.Cb),
y.push(R.id)}G=[];R=null;f&&(this.pa.vH()&&this.O5k(G),this.pa.uz()&&(R=this.T5k(b)));return new Ia(a,b,c,l,y,G,R,this.Fa.I8,this.pa,this.ic,this.nHg,this.Ub,this.Fa,this.ia,this.Ghc,this.zkc,this.Eb,this.$J,this.P5)}W2c(a){return 10===a.type||60===a.type||16===a.type}O5k(a){const b=this.pa.Ud();for(const c of b)a.push(c.get_shapeId())}T5k(a){return this.pa.Pa.nb.og?this.R5k(a):this.S5k(this.pa.Pa,a)}S5k(a,b){var c=Object(sa.a)(5,a.nb.Ua.node),f=this.Tb.Lc(c);if(f.h7(Object(H.a)(this,this.W2c,"isOEContainerNode")))if(f.Cc()&&
11===f.currentNode.type){if(f.Cc()){c=(c=this.Ga.Xda(c))?c.get_shapeId():0;const l=f.Dq.type;f=16===l?this.Zee(Object(sa.a)(130,f.Dq)):null;const y=a.nb,G=[];this.sDf(y,G);for(let R of a)R!==y&&this.Xpi(R,y)&&this.sDf(R,G);return new Hb(this.Tb,this.ic,this.uY,l,b,c,f,G)}}else ya.a.J(509445783,816,15,"Find text selection but its container is not OutlineElement");return null}R5k(a){var b=this.pa.Pa.ga(0),c=this.pa.Pa.last,f=b.og;b=16===f.Ua.node.type?this.Zee(Object(sa.a)(130,f.Ua.node)):null;f=c.og;
c=16===f.jf.node.type?this.Zee(Object(sa.a)(130,f.jf.node)):null;f=(f=this.Ga.Xda(f.Ua.node))?f.get_shapeId():0;return new qb(this.ic,a,f,b,c)}Zee(a){return a?new hc(a.Ai,a.rowIndex):null}sDf(a,b){for(let c of a){if(!Object(Sa.a)(102,c.node))continue;a=this.Tb.Lc(c.node);if(!a.h7(Object(H.a)(this,this.W2c,"isOEContainerNode")))continue;a.Cc();const f=a.currentNode;a.Cc();a=a.TTa(f);b.push(new Jc(this.Tb,this.Hh,a,c.contextId,c.Ra,c.Lb))}}Xpi(a,b){a=this.Tb.Lc(a.Ua.node);b=this.Tb.Lc(b.Ua.node);return a.h7(Object(H.a)(this,
this.W2c,"isOEContainerNode"))&&b.h7(Object(H.a)(this,this.W2c,"isOEContainerNode"))&&a.Cc()&&11===a.currentNode.type&&b.Cc()&&11===b.currentNode.type&&a.Cc()&&b.Cc()?a.currentNode===b.currentNode:!1}}Object(m.a)(ld,"PPTUndoSelectionReferenceFactory",null,[331]);class wd{constructor(){this.PXa=this.Q_g=this.aHe=this.F3g=null;this.vad=!1;this.WIe=null}Y9e(){if(!this.PXa.aBb&&this.PXa.u5c)for(const a of this.PXa.u5c)if(a.equals(this.F3g)){this.aHe.hV(!1,this.Q_g);ya.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.WIe);this.PXa.Krc(Object(H.a)(this,this.Y9e,"trySetSelectionWhenServerUndoRedoFinish"));this.vad=!0;break}}V8k(a,b,c,f){a&&(this.F3g=b,this.Q_g=f,(this.aHe=Object(sa.a)(1383,c))?(this.z$e(),this.WIe=new Date,this.PXa=a,this.PXa.OJc(Object(H.a)(this,this.Y9e,"trySetSelectionWhenServerUndoRedoFinish")),this.vad=!1):ya.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}z$e(){this.PXa&&!this.vad&&(ya.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.WIe),this.PXa.Krc(Object(H.a)(this,this.Y9e,"trySetSelectionWhenServerUndoRedoFinish")),this.vad=!0)}}Object(m.a)(wd,"PPTUndoSelectionRestoreExecutor",null,[1351]);class Bd{constructor(){this.bvk=new Qe.a(!1);this.swk=new Qe.a(!1);this.EOg=new Qe.a(!1);this.init()}init(){this.rQj()}rQj(){this.EOg.add(ea.a.TI,!0)}jMi(a){return a&&this.bvk.Gb(a)?!0:!1}iMi(a){return a&&this.swk.Gb(a)?!1:!0}Cxl(a){return a&&this.EOg.Gb(a)?!0:!1}}Object(m.a)(Bd,"PPTUndoSettings",null,[1382]);class de{constructor(a){this.Nj=
null;this.xef=a}start(a){this.Nj=a}NKj(){var a=new Date;return this.xef?+a-+this.Nj>this.xef:!1}}Object(m.a)(de,"UndoTimer",null,[1402]);var oe=d(487),Pc=d(530);class tc{constructor(a){this.bca=this.p3=null;this.Swb=this.lvc=a}get lvc(){return this.p3}set lvc(a){this.p3&&(this.p3.pP&=-2);this.p3=a;this.p3.pP|=1}get Swb(){return this.bca}set Swb(a){this.bca&&(this.bca.pP&=-3);this.bca=a;this.bca.pP|=2}get T6(){return this.p3?this.p3.id:ia.a.nil}get y6d(){return this.bca?this.bca.id:ia.a.nil}get nK(){return this.p3?
this.p3.kxg():[]}combineWithPrevious(){}dispose(){this.p3&&(this.p3.pP&=-2);this.bca&&(this.bca.pP&=-3)}}Object(m.a)(tc,"Box4UndoRecordData",null,[1416,108]);class id{constructor(a,b,c,f,l,y){this.Xya=a;this.clb=b;this.Gbi=c;this.actionId=f;this.cU=l;this.qLa=y}get s2(){return this.Gbi}get T6(){return this.s2.T6}dispose(){this.s2&&this.s2.dispose()}}Object(m.a)(id,"UndoRecord",null,[108]);class ie{constructor(){this.Mra=[]}ga(a){return this.Mra[a]}get length(){return this.Mra.length}add(a){this.Mra.push(a)}clear(){for(let a=
0;a<this.Mra.length;a++)this.Mra[a].dispose();Array.clear(this.Mra)}remove(a){const b=Array.remove(this.Mra,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.Mra.length&&(this.Mra[a].dispose(),Array.removeAt(this.Mra,a))}}Object(m.a)(ie,"UndoRecordsArray",null,[]);class v{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe){this.A6a=!0;this.T4a=this.tjf=this.cDc=this.Lrb=!1;this.Dpb=null;this.YLd=this.gqf=0;this.xSd=null;this.mvf=!0;this.isActive=!1;this.Yz=a;this.qDd=b;this.t4h=
c;this.uGd=f;this.Ici=l;this.E6h=y;this.Mk=G;this.qI=R;this.btf=ja;this.v9h=za;this.ae=Va;this.xbi=hb;this.F9h=Cb;this.qsf=lc;this.Lwf=yc;this.Mwf=ec;this.Kbi=jc;this.Owf=xd;this.Kca=Xd;this.iz=Ie;this.Vg=new ie;this.As=this.vh=-1;this.Gkf=Object(H.a)(this,this.gRf,"createInitialUndoRecord");this.uGc=ic;this.uGc.Rki(Object(H.a)(this,this.Oqh,"removeUndoRecordForRevision"));this.mvf=Pe}dispose(){this.Gkf=null;this.sNc();this.Yz=null;this.uGc.vcl(Object(H.a)(this,this.Oqh,"removeUndoRecordForRevision"))}get graphSpace(){return this.Yz}get Upc(){return this.t4h.value}NWj(a){return this.Yz===
a?!0:!1}sNc(){this.Vg.clear();this.As=this.vh=-1;this.A6a=!0}dEi(){if(this.vh===this.Vg.length-1)this.sNc();else{let a=0;for(;a<this.vh;)this.Vg.removeAt(0),a++;this.vh=0;this.As=1}}get gX(){return 0<this.vh}get v3d(){return this.gX?this.Vg.ga(this.vh).actionId:null}get w3d(){return 0<=this.vh&&this.vh<this.Vg.length?this.Vg.ga(this.vh).s2:null}u5e(a,b){this.T4a?(this.bwc(),this.fpa()):(this.qsf&&this.Upc.suspend(),this.T4a=!0,this.Dpb=a,this.gqf=b,this.YLd=0)}bwc(){this.T4a=!1;this.qsf&&this.Upc.resume()}rQl(){this.F9h(new ia.a(this.Dpb,
1));this.bwc()}TZa(a,b,c=!1){if(!this.qDd()||a===C.a.tVa&&this.Vg.length)return!1;var f=this.Yz.TT();if(!f&&a!==C.a.tVa&&!c||!this.Yz||!this.Yz.Fi)return!1;f&&(this.tjf||(ha.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.tjf=!0),this.uGd.execute(y=>{y.a6d()}));if(this.T4a){ha.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.Dpb);this.bwc();for(c=this.Vg.length-2;0<=c;c--)this.Vg.removeAt(c);this.vh=0;this.As=-1}c=this.aX();f=
this.R2d(f,a);this.twb();b=this.kGi(a,f,b);const l=this.Kca.OOb()&&!this.Kca.R1a();a=new id(b,c,f,a,this.Lrb,l);this.Vg.add(a);this.vh=this.Vg.length-1;return!0}R2d(a,b){return this.Lwf(a,b,void 0)}kGi(a,b,c){if(0<=this.vh){switch(a){case C.a.OCa:case C.a.BSa:case C.a.typing:this.A6a&&this.Vg.ga(this.vh).actionId===a?(a=this.Vg.ga(this.vh),c=a.Xya,b.combineWithPrevious(a.s2),this.Vg.removeAt(this.vh)):w.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.xbi.create(a),b.end(32),
this.Ici.krc(b),this.E6h.jrc(b))}this.A6a=!0}return c}YOe(){this.Kbi(this)}KXi(){this.mvf&&!this.A6a||!this.Kca.OOb()||(this.A6a=!1,this.Lrb=!0)}syk(){if(this.Kca.R1a())for(let a=0;a<this.Vg.length;a++)this.Vg.ga(a).qLa=!0}twb(){if(this.vh<this.Vg.length-1){for(let a=this.Vg.length-1;a>this.vh;a--)this.Vg.removeAt(a);this.As=-1}}AUl(){var a=Im.ObjectSpace.g9(this.Yz.Fi);a=new tc(a);const b=this.aX(),c=this.Vg.ga(this.vh).Xya;a=new id(c,b,a,C.a.gzd,this.Vg.ga(this.vh).cU,this.Vg.ga(this.vh).qLa);this.Vg.removeAt(this.Vg.length-
1);this.Vg.add(a)}zjb(a,b,c,f){return a.zjb(b,c,f)}uQe(a,b,c){this.cDc=!0;a.ste();this.cDc=!1;b.hV(void 0,c)}undo(){if(!this.gX)return!1;this.uGd.execute(za=>{za.a6d()});var a=!0;let b=!1;var c=!1;const f=this.Mk.ke(7);f.ld(this.Yz);let l=0,y=!1,G=this.aX(),R=null;const ja=this.Mwf(!0);for(this.Owf.start(new Date);this.gX&&a;){const za=this.Vg.ga(this.vh),Va=this.Vg.ga(this.vh-1);a=za.cU&&Va.cU;ha.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,Pc.a[this.iz]);
this.As=this.vh;try{if(b=this.zjb(ja,za.s2,Va.s2,za.qLa||Va.qLa))G=this.Vg.ga(this.vh).Xya,R=this.Vg.ga(this.As).clb,this.xSd&&this.xSd(this.Vg.ga(this.vh).actionId)}catch(hb){ha.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",hb.message,hb.stack),b=!1,c=!0}l++;b?this.vh--:(ha.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,Pc.a[this.iz]),this.dEi(),a=!1);if(this.Owf.NKj()){y=!0;break}}b&&this.uQe(ja,G,null,R,!0);f.dispose();this.Dw();
this.T4a&&(this.rQl(),this.twb());this.qI.updateCommandUI();this.btf.Zaa();if(0<this.vh&&y&&this.Vg.ga(this.vh).cU){a=this.vh;for(c=0;0<a&&this.Vg.ga(a).cU;)c++,a--;this.Vg.ga(this.vh).cU=!1;ha.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&ha.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}Dw(){this.Lrb=this.A6a=!1}get kla(){return 0<this.As}redo(){if(!this.kla)return!1;
this.uGd.execute(G=>{G.a6d()});var a=!0;let b=!1,c=!1;const f=this.Mk.ke(7);f.ld(this.Yz);let l=this.aX();const y=this.Mwf(!1);for(;this.kla&&a;){a=this.Vg.ga(this.As);const G=this.Vg.ga(this.vh);ha.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Vg.ga(this.As).cU&&this.Vg.ga(this.vh).cU,Pc.a[this.iz]);try{if(b=this.zjb(y,a.s2,G.s2,a.qLa||G.qLa))l=this.Vg.ga(this.As).clb}catch(R){ha.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
R.message,R.stack),b=!1,c=!0}b?(this.vh=this.As,this.As<this.Vg.length-1?(this.As++,a=this.Vg.ga(this.As).cU&&this.Vg.ga(this.vh).cU):(this.As=-1,a=!1)):(ha.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,Pc.a[this.iz]),this.fpa(),a=!1)}b&&this.uQe(y,l,null,null,!1);f.dispose();this.Dw();this.qI.updateCommandUI();this.btf.Zaa();return b}aX(){return this.qDd()?this.v9h.Psa():null}YYk(a){return this.T4a&&oh.a.compare(a.guid,this.Dpb)?(ha.ULS.sendTraceTag(512362002,
365,50,"Incremental Action in progress"),this.AUl(),this.YLd=a.n,this.YLd===this.gqf&&(ha.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.Dpb),this.bwc()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.cDc&&!this.YYk(a.Fi.xx.id))if(this.T4a&&(ha.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.Dpb,this.Yz.Fi.xx.id),this.bwc()),!this.Kca.OOb())this.fpa();else if(this.kla||this.gX)this.KXi(),
this.syk()}fpa(a=!1){this.sNc();a?this.gRf(null):(a=new pd.a(2,1,0,this.Gkf,50),this.ae.Hb(a))}Oqh(a,b){if(b&&(1===(b.pP&1)||2===(b.pP&2))){a=this.kla;const f=this.gX;for(var c=this.Vg.length-1;0<=c;c--){const l=Object(sa.a)(tc,this.Vg.ga(c).s2);!l||l.lvc!==b&&l.Swb!==b||(this.Vg.removeAt(c),-1!==this.vh&&this.vh--,-1!==this.As&&this.As--)}b=this.kla;c=this.gX;!this.isActive||a===b&&f===c||(ha.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,
c),this.qI.updateCommandUI())}}gRf(){this.qDd()&&this.TZa(C.a.tVa,this.aX())}dGa(){return this.cDc}mBh(a){this.xSd=a}}Object(m.a)(v,"UndoStack",null,[1417,108]);var Z=d(815);class ua extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(m.a)(ua,"RevisionStateArgs",Sys.EventArgs,[]);class Ra{constructor(a,b,c,f,l,y){this.Xya=a;this.clb=b;this.T6=c;this.actionId=f;this.cU=l;this.qLa=y}}Object(m.a)(Ra,"PPTLocalUndoRecord",null,[]);class fb extends v{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,
Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og,pi,Wj,wg,Tg){super(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,ch,wg,4,Tg);this.Mad=!1;this.ujc=-1;this.zM=[];this.LU=Xd;this.TFe=Qd;this.RFe=Ie;this.Tb=Pe;this.la=ig;this.Mna=ff;this.Fa=bh;this.OXa=of;this.OXa.wBf(Object(H.a)(this,this.vJb,"onRevisionProcessed"));this.ohb=sg;this.pa=Fg;this.VIe=og;this.kNg=pi;this.G3g=Wj;this.kPg=ch.OOb()&&!ch.R1a()}TZa(a,b,c=!1){let f=!1;b=this.G3g.VUl(b);var l=this.vh;this.TFe.Cxl(a)?f=this.Gyk(a,b):
this.TFe.iMi(a)?(f=this.tzi(a,b,c))&&this.aOl(a):this.fpa();b=null;f?(l=this.vh-l,b=this.r9b(this.vh),this.y5k(b,!l),this.zcb()||this.$6d()):this.G3g.GUj();l=null;this.la.designerSendActionDuration&&b&&b.s2&&b.s2.y6d!==ia.a.nil&&(l=b.s2.y6d);this.RFe.wCj(a,f,l);return f}R2d(a,b){const c=0<=this.vh?this.Vg.ga(this.vh):null,f=this.ohb.o$g(b,c,this.A6a,this.Lrb);b=this.Lwf(a,b,f);this.ohb.N9g(c,b,a);return b}spg(a){let b=!1,c=null;a&&this.gX?c=this.Vg.ga(this.vh):!a&&this.kla&&(c=this.Vg.ga(this.As));
c&&(b=this.B2c(c.T6));return b&&this.zcb()}zjb(a,b,c,f){let l=!1;if(this.spg(a.ddb))(l=super.zjb(a,b,c,f))&&this.zyk(a.Zla);else{const y=a.ddb?2:3;l=a.zlh(G=>{this.LU.dRh(G,y)});this.myk(a.Zla);this.OXa.mpd(new ua(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.Mad&&this.OXa.mpd(new ua(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.Mad&&(this.OXa.mpd(new ua(3)),this.Mad=!1)}dispose(){this.OXa.Irh(Object(H.a)(this,this.vJb,"onRevisionProcessed"));super.dispose()}uQe(a,
b,c,f,l){a&&a.Zla!=ia.a.nil&&(this.kNg&&(f&&this.pRh(f),b&&this.pRh(b)),0<this.zM.length&&(f=new Ra(this.aX(),b,a.Zla,l?ea.a.$_a:ea.a.Z_a,!1,this.kPg),Array.add(this.zM,f)),a.ste(),b&&0<this.zM.length?b.hV(void 0,c):(Kc.a.Kb&&(Kc.a.Naa(Kc.a.Kb),Kc.a.Kb.qC(Ii.a.ZY,Kc.a.Cab(a.Zla.toString()).toString())),this.kNg&&(f=Object(sa.a)(136,this.Yz.contentReplicator))&&b&&this.VIe.V8k(f,a.Zla,b,c)))}vJb(a,b){b&&(!(a=b.GD)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.Mad=!0,this.la.xpg||(b=2===a.RevisionSource?
Object(sa.a)(1383,this.Vg.ga(0<this.As?this.As:this.Vg.length-1).Xya):Object(sa.a)(1383,this.Vg.ga(this.vh).clb))&&b.$Ul(),this.h2i(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.OXa.mpd(new ua(1))))}h2i(a,b,c,f){a!==this.vh&&ya.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.vh);if(a<this.vh||f){do this.Vg.removeAt(this.vh--);while(this.vh>a);this.As=0<this.As?this.vh+1:-1;this.VIe.z$e()}if(!(0>this.As)&&
(b!==this.Vg.length-this.As&&ya.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Vg.length-this.As),b<this.Vg.length-this.As||c)){do this.Vg.removeAt(this.As);while(this.Vg.length-this.As>b);if(!b||this.As>=this.Vg.length)this.As=-1;this.VIe.z$e()}}pRh(a){(a=Object(sa.a)(1383,a))&&a.NPl()}GDi(){if(this.la.tBb&&this.zM.length){var a=this.r9b(this.vh);if(a){var b=a.Xya;if(this.B2c(a.T6)){for(let c=this.vh-1;0<c;c--){const f=this.r9b(c);if(!f)break;if(this.B2c(f.T6))b=
f.Xya,this.Vg.removeAt(c),this.vh--;else break}this.twb()}else this.Vg.add(a),this.vh++,this.As=-1;a.Xya=b;a.cU=!1;this.Pqd();this.$6d()}else this.twb(),this.Pqd()}}K6e(){if(this.la.tBb){var a=this.r9b(this.vh);if(a){if(0<(-1===this.ujc?0:this.Vg.length-this.ujc)){for(var b=this.Vg.length-1;b>=this.ujc;b--)this.Vg.removeAt(b);for(b=0;0<=b&&b<this.zM.length;){var c=b;let f=!0;for(;f&&b<this.zM.length;)b<this.zM.length-1?(f=this.zM[b].cU&&this.zM[b+1].cU,b++):(f=!1,b=-1);c=this.zM[c];this.Vg.add(new id(c.Xya,
this.zM[0>b?this.zM.length-1:b-1].clb,a.s2,c.actionId,!1,c.qLa))}this.vh=this.Vg.length-1}this.As=-1;this.Pqd();this.$6d()}else this.twb(),this.Pqd()}}get bLj(){if(this.la.tBb&&this.zcb()){const a=this.r9b(this.vh);if(!a||0<this.zM.length&&!this.B2c(a.T6))return!1}return this.gX}$6d(){var a=this.la.xzk;if(this.vh>a){var b=0;for(a=this.vh-a-1;0<=a;a--)this.Vg.removeAt(a),b++;this.vh-=b;b=this.As-b;this.As=0<b?b:-1}}tzi(a,b,c){const f=0<=this.vh?this.Vg.ga(this.vh):null;this.Lrb=!!f&&this.ohb.w4c(a)&&
f.actionId===a&&this.Lrb;return super.TZa(a,b,c)}y5k(a,b){this.la.tBb&&a&&(this.zcb()||this.TFe.jMi(a.actionId))&&(this.zM.length||(this.ujc=this.vh),b&&Array.removeAt(this.zM,this.zM.length-1),Array.add(this.zM,new Ra(a.Xya,a.clb,a.T6,a.actionId,a.cU,a.qLa)))}r9b(a){return 0<a&&a<=this.vh?this.Vg.ga(a):null}Kae(a){a=a?this.vh:this.As;return 0<=a&&a<this.Vg.length?this.Vg.ga(a).s2:null}OVc(a){a=a?this.vh:this.As;return 0<=a&&a<this.Vg.length?this.Vg.ga(a).actionId:0}Pqd(){Array.clear(this.zM);this.ujc=
-1}zcb(){const a=this.Fa.Ee;return a?a.name!==xa.a.qg&&a.name!==xa.a.goa&&a.name!==xa.a.nS&&a.name!==xa.a.Kza&&a.name!==xa.a.qP||!this.pa.uz()||this.ZXj()?!1:!0:!1}zmb(a){Im.ObjectSpace.m4(this.graphSpace.Fi,!1).zmb(a)}aOl(a){this.la.tBb||this.$Nl(a);this.ZNl(a)}$Nl(a){if(1<=this.vh&&this.cvg(a)){const b=this.vh-1,c=this.Vg.ga(b),f=c.actionId;f!==a&&!this.cvg(f)||1!==this.Mna.ozb(c.T6)||(this.Vg.removeAt(b),this.vh=this.Vg.length-1)}}ZNl(a){if(1<=this.vh&&this.CWj(a)){const b=this.vh-1,c=this.Vg.ga(b).actionId;
if(c===a||this.kZj(c))this.Vg.removeAt(b),this.vh=this.Vg.length-1}}cvg(a){return a===C.a.$B||a===C.a.OCa||a===C.a.BSa||a===C.a.typing||a===C.a.enter}kZj(a){return a===ea.a.t8||a===ea.a.lmd}CWj(a){return a===ea.a.wtb||a===ea.a.Joc||a===ea.a.bKb}Gyk(a,b){const c=this.R2d(this.Yz.TT(),a);this.twb();a=new id(b,null,c,a,!1,this.kPg);this.Vg.add(a);this.vh=this.Vg.length-1;return!0}zyk(a){let b=null;this.pa.Lla()?b=this.pa.Dcg():this.pa.uz()&&(b=this.pa.Ll());b&&this.OXa.Bnh(new Z.a(b,a))}myk(a){const b=
this.Tb.Lc(this.graphSpace);b.Db(80);Object(sa.a)(347,b.Dq).isDirty=!0;this.OXa.Bnh(new Z.a(b.currentNode,a))}O$e(a){0>this.vh||(this.Vg.ga(this.vh).clb=a)}L2c(){return!this.zM.length}B2c(a){for(const b of this.zM)if(b.T6===a)return!0;return!1}ZXj(){for(const a of this.pa.Ud())if(a.eb(va.a.clearFormatting))return!0;return!1}}Object(m.a)(fb,"PPTUndoStack",v,[]);class Mb{constructor(a){this.qwk=a}KSi(a){const b=this.qwk.wSf(a);return new fb(a,()=>!!ra.InteractiveViewManager.instance.Rd,new vb.a(()=>
Sc.App.uS),Fb.a.instance.Ia("Common.Interface.IEditNotificationManager"),Fi.a.getInstance(),Mi.a.getInstance(),Fb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Fb.a.instance.resolve("Box4.IAppFrame"),Fb.a.instance.resolve("Box4.IReplicationScheduler"),Fb.a.instance.resolve("Box4.ISelectionReferenceFactory"),Fb.a.instance.resolve("Common.ITaskManager"),Fb.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},M.a.instance.ga(70),oe.a.instance,b.DOh,b.EOh,b.IOh,new de(Sc.App.EKf),
Fb.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),Fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),Fb.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),Fb.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),Fb.a.instance.resolve("Common.IFocusManager"),Fb.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
Fb.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Fb.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),Fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,Fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
Fb.a.instance.ue("Box4.ICoauthCashTelemetry"),Object(qd.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(m.a)(Mb,"PPTUndoStackFactory",null,[1381]);class xc{constructor(){this.h8c=new Wc.a}mLl(a){this.h8c.raiseEvent("MU",a)}V_b(a){this.h8c.addHandler("MU",a)}eXe(a){this.h8c.removeHandler("MU",a)}dispose(){this.h8c.dispose()}}Object(m.a)(xc,"UndoEventSource",null,[1378,1379,1380,108]);class Dc{constructor(a,b){this.whb=0;this.wed=null;this.dDe=!1;this.Xs=a;this.Kk=b;this.Kk.IAf(Object(H.a)(this,
this.n$g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Kk.HAf(Object(H.a)(this,this.Jjd,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Kk.Xqh(Object(H.a)(this,this.n$g,"onBeforeForceOutboundGraphTransactionInitialize"));this.Kk.Xal(Object(H.a)(this,this.Jjd,"onForceOutboundGraphTransactionDisposed"))}VUl(a){return 1===this.whb&&this.wed?this.wed:a}GUj(){1===this.whb&&(this.dDe=!0)}n$g(a,b){this.evg(b.transaction.$za)&&(this.whb+=1,1===this.whb&&(this.wed=this.Xs.aX()))}Jjd(a,
b){this.evg(b.transaction.$za)&&(1===this.whb&&(this.wed=null,this.dDe||(a=this.Xs.aX(),this.Xs.O$e(a)),this.dDe=!1),--this.whb)}evg(a){return 8===(a&8)}}Object(m.a)(Dc,"UndoSelectionUpdater",null,[1354,108]);var Vb=d(603);class Lc{constructor(a,b,c){this.Yz=a;this.FJd=b;this.URd=c;this.UZ=Im.ObjectSpace.g9(this.Yz.Fi)}zjb(a,b,c){a=this.URd.eRi(this.FJd?a.lvc:b.Swb,this.FJd?b.Swb:a.lvc,this.UZ,c,Sc.App.OMa);if(b=!!a)this.UZ=a;return b}zlh(a){const b=new Hm.a;b.D5e(this.Yz.Fi,this.UZ);a(b);a=b.JTc();
Im.ObjectSpace.m4(this.Yz.Fi,!1).zmb(a);this.UZ=a;return!!a}ste(){const a=new Vb.a(Im.ObjectSpace.g9(this.Yz.Fi),this.UZ);this.Yz.SCb(a)}get ddb(){return this.FJd}get Zla(){return this.UZ.id}}Object(m.a)(Lc,"Box4UndoRedoPerformer",null,[1415]);class dd{constructor(a,b){this.DOh=c=>{c&&this.Yz.Iga();c=Im.ObjectSpace.g9(this.Yz.Fi);return new tc(c)};this.EOh=c=>new Lc(this.Yz,c,this.URd);this.IOh=c=>{if(c.w3d&&(this.Yz.TT()&&this.Yz.Iga(),c.w3d&&(c=c.w3d))){var f=Im.ObjectSpace.g9(this.Yz.Fi);c.Swb=
f}};this.Yz=a;this.URd=b}}Object(m.a)(dd,"Box4UndoStackDataSyncHelper",null,[1399]);class Ed{constructor(a){this.Hbi=a}wSf(a){return new dd(a,this.Hbi(a.Fi))}}Object(m.a)(Ed,"Box4UndoStackDataSyncHelperFactory",null,[1377]);class te{constructor(a,b){var c,f;this.$Ya=[];this.QHb=null!==(c=null===a||void 0===a?void 0:a.undoOperation)&&void 0!==c?c:null;this.Ydd=null!==(f=null===a||void 0===a?void 0:a.revisionId)&&void 0!==f?f:ia.a.nil;this.$Ya=h(null===a||void 0===a?void 0:a.$ab,b);this.Lic=b}get T6(){return this.Ydd}get y6d(){return this.Ydd}get nK(){return this.$Ya}perform(){try{if(this.QHb){const a=
this.QHb.perform();this.QHb=a.undoOperation;this.$Ya=h(a.$ab,this.Lic);return a}}catch(a){ha.ULS.sendTraceTag(509097475,844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.QHb&&this.QHb.combineWithPrevious(a.QHb)}dispose(){}}Object(m.a)(te,"FluidUndoRecordData",null,[1416,108]);class Ef{constructor(a,b){this.Jgc=[];this.Seb=a;this.zok=b}zjb(a){return a?(a=a.perform(),this.Nkh(a)):!1}zlh(a){const b=this.Seb.Fi.pZi.$Oc();b.start(this.Seb.Fi);a(b);a=b.finish();
return this.Nkh(a)}ste(){this.Jgc.forEach(a=>{this.Seb.SCb(a)})}get ddb(){return this.zok}get Zla(){return 0<this.Jgc.length?this.Jgc[this.Jgc.length-1].Yla:ia.a.nil}Nkh(a){return a?(a.$ab&&this.Jgc.push(...a.$ab),!0):!1}}Object(m.a)(Ef,"FluidUndoRedoPerformer",null,[1415]);class $f{constructor(a){this.DOh=(b,c,f)=>{c=f;b&&(b=this.Seb.Iga())&&(c=b,f&&(c.$ab.unshift(...f.$ab),c.undoOperation.combineWithPrevious(f.undoOperation)));return new te(c,this.Seb.Fi)};this.EOh=b=>new Ef(this.Seb,b);this.IOh=
()=>{};this.Seb=a}}Object(m.a)($f,"FluidUndoStackDataSyncHelper",null,[1399]);class Mg{wSf(a){return new $f(a)}}Object(m.a)(Mg,"FluidUndoStackDataSyncHelperFactory",null,[1377]);class ri{constructor(a){this.LU=a}yTl(a){this.LU.dRh(a,1);this.LU.IUl(a)}}Object(m.a)(ri,"PPTInverseRevisionUpdater",null,[1370]);class ki{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Xb(a){this.K=a;a.register(Dn,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").na();
a.register(Hg,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").na().oa(()=>new Hg(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(331,"Box4.ISelectionReferenceFactory").na().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new ld(Ul.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.fD,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
b.Xn):Ul.SelectionReferenceFactory.instance});a.register(W,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").na();a.register(Bd,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").na();a.resolve("PowerPointWebEditor.IApplicationSettings").HDa?a.register(Mg,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").na():a.register(Ed,
"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").na().oa(()=>new Ed(b=>new dp(Im.ObjectSpace.m4(b,a.resolve("PowerPointWebEditor.IApplicationSettings").HDa),a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new Jk,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new ri(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(Mb,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").na().oa(()=>
new Mb(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(cp,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").na().oa(()=>new cp(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(A,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").na().oa(()=>
new A(a.resolve("Box4.UndoRedo.IUndoStackFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1351,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").na().oa(()=>new wd);a.register(xc,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").na();this.eJi(a);
this.iJi(a);a.register(1352,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").na().oa(()=>new Xm(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}eJi(a){a.register(1353,"PowerPointWebEditor.ITablePartialEditController").na().oa(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");
return b.r8j?new Xn(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.tBb):new om})}iJi(a){a.register(1354,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").na().oa(()=>new Dc(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");var b=this.K.resolve("Box4.IPageView");b.Ag&&(b=b.Ag.Xo(),a.register(b),a.setActive(b),a.TZa(C.a.tVa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){n.a.instance.Ac(new ki)}}Object(m.a)(ki,"PPTWebEditorUndoRedoPackage",null,[2,3]);class hj{constructor(a=!1,b,c=!1,f=!1,l=!1,y=!1,G=!1){this.ZVa=a;this.Tpe=
c;this.kbb=f;this.obc=l;this.tbc=y;this.g2c=G}}Object(m.a)(hj,"DocModeSwitcherData",null,[]);var Ng=d(867);class Yl{constructor(a,b,c,f,l){this.VEb=!1;this.jGe=null;this.rId=this.IJd=this.UId=this.dJd=this.XId=this.rJd=this.MId=this.uJd=this.gBa=this.CId=this.JId=this.aJd=this.yId=this.TId=this.slf=!1;this.pc=a;this.wl=b;this.Mc=c;this.Uv=l;this.QJg=f.H0j;this.Vva=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.ufb=f.otg;this.Tsk=w.AFrameworkApplication.zz;this.reset()}initialize(){this.Mc.Qca(Object(H.a)(this,
this.Oy,"onUnifiedAppStateChanged"));this.Mc.PQa(Object(H.a)(this,this.znc,"onOutboundReplication"));this.jGe=[Object(H.a)(this,this.sCi,"checkIsInlineRepairedDocument"),Object(H.a)(this,this.pCi,"checkIrmProtection"),Object(H.a)(this,this.XCi,"checkUserPermission"),Object(H.a)(this,this.RBi,"checkFileFormats"),Object(H.a)(this,this.SBi,"checkFileLock"),Object(H.a)(this,this.CCi,"checkPasswordProtection"),Object(H.a)(this,this.UBi,"checkFontRestriction"),Object(H.a)(this,this.tCi,"checkIsMarkedFinal"),
Object(H.a)(this,this.uCi,"checkIsMarkedReadOnlyRecommended"),Object(H.a)(this,this.ICi,"checkSessionRestriction"),Object(H.a)(this,this.HCi,"checkSessionAccessTokenExpired"),Object(H.a)(this,this.zCi,"checkNetworkIssueHappened"),Object(H.a)(this,this.ECi,"checkPopsHostIssueHappened"),Object(H.a)(this,this.dDi,"checkWopiAccessTokenOutOfRefreshRange"),Object(H.a)(this,this.rCi,"checkIsEmergencyViewMode")];this.yvh(this.jGe)}dispose(){this.Mc.skb(Object(H.a)(this,this.Oy,"onUnifiedAppStateChanged"))}reset(){this.rId=
this.JId=this.IJd=this.UId=this.dJd=this.XId=this.rJd=this.MId=this.uJd=this.CId=this.aJd=this.gBa=this.yId=this.TId=this.slf=!1}Oy(a,b){ya.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.mcb&&this.pc.Ho||(this.wl.bWf(),this.yvh(this.jGe))}znc(){this.Vva&&!this.VEb&&(this.VEb=!0);this.pc.YL||ya.a.J(38633602,801,15,"Outbound on RO mode")}yvh(a){if(a)for(const b of a)if(b())break}RBi(){if(this.s_j||!this.pc.sg(64)||this.QJg&&!(this.pc.sg(4)&&this.pc.sg(16)&&this.pc.sg(8)))return!0;
if(!this.pc.getState(64))return!1;if(this.QJg&&this.pc.getState(4)&&!this.pc.getState(16)&&!this.pc.getState(8)){var a=w.AFrameworkApplication.Qa.Ja(ea.a.UDa,2,Object.assign(new hj,{g2c:!0,kbb:this.pc.getState(1)}));ya.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.wl.wL(10);ya.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=w.AFrameworkApplication.Qa.Ja(ea.a.UDa,2,Object.assign(new hj,
{tbc:!0,kbb:this.pc.getState(1)})),ya.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.yId=!0}pCi(){return this.H1j||!this.pc.sg(32768)?!0:this.pc.getState(32768)?(this.wl.wL(14),this.MId=!0,ya.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}SBi(){return this.v_j?!0:this.pc.sg(128)&&this.pc.getState(128)?(this.wl.wL(3),this.gBa=!0,ya.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.pc.sg(256)&&this.pc.getState(256)?(this.wl.wL(4),this.gBa=!0,ya.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.pc.sg(512)&&this.pc.getState(512)?(this.wl.wL(5),this.gBa=!0,ya.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.pc.sg(1024)&&this.pc.getState(1024)?(this.wl.wL(6),this.gBa=!0,ya.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.pc.sg(2048)&&this.pc.getState(2048)?(this.wl.wL(7),this.gBa=!0,ya.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.pc.sg(4096)&&this.pc.getState(4096)?(this.wl.wL(8),this.gBa=!0,ya.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.pc.sg(8192)&&this.pc.getState(8192)?(this.wl.wL(9),this.gBa=!0,ya.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}tCi(){if(this.t2j||!this.pc.sg(2)||!this.pc.sg(16))return!0;if(!this.pc.getState(2)&&this.pc.getState(16)){const a=w.AFrameworkApplication.Qa.Ja(ea.a.UDa,2,Object.assign(new hj,{ZVa:!0,kbb:this.pc.getState(1)}));ya.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.TId=!0}return!1}uCi(){if(!this.ufb)return!1;if(this.u2j||!this.pc.sg(2)||!this.pc.sg(524288))return!0;if(!this.pc.getState(2)&&this.pc.getState(524288)){const a=w.AFrameworkApplication.Qa.Ja(ea.a.UDa,
2,Object.assign(new hj,{Tpe:!0,kbb:this.pc.getState(1)}));ya.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.UId=!0}return!1}CCi(){if(this.g4j||!this.pc.sg(2)||!this.pc.sg(32))return!0;if(!this.pc.getState(2)&&this.pc.getState(32)){const a=w.AFrameworkApplication.Qa.Ja(ea.a.UDa,2,Object.assign(new hj,{obc:!0,kbb:this.pc.getState(1)}));ya.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.aJd=!0}return!1}sCi(){return this.m1j||!this.pc.sg(2097152)?!0:this.pc.getState(2097152)?(this.wl.wL(22),this.JId=!0,ya.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}rCi(){var a=!1;if(this.VZj||!this.pc.sg(4194304))return!0;this.pc.getState(4194304)&&(a="NotAvailable",this.Uv&&(a=this.Uv.oyb(),a=Ng.a[a]),Sf.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===w.AFrameworkApplication.Qa.processAction(ea.a.Cvc,
1)?(a=w.AFrameworkApplication.Qa.processAction(ea.a.Cvc,2),ya.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.wl.wL(23),ya.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.rId=a=!0);return a}UBi(){return!this.T_j&&this.pc.sg(2)&&this.pc.sg(8)?!this.pc.getState(2)&&this.pc.getState(8)?(this.wl.wL(12),this.CId=!0,ya.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}XCi(){if(this.FZj||!this.pc.sg(1))return!0;if(!this.pc.getState(1)){const a=w.AFrameworkApplication.Qa.Ja(ea.a.UDa,2,new hj);ya.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}ICi(){return this.S6j?!0:this.pc.sg(16384)&&this.pc.getState(16384)?(this.wl.wL(13),this.uJd=!0,ya.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}HCi(){return this.Q6j?!0:this.pc.sg(65536)&&this.pc.getState(65536)?
(Sf.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.Vva?this.wl.$Qc(15,this.VEb):this.wl.wL(15),this.rJd=!0,ya.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}ECi(){return this.I4j?!0:this.pc.sg(262144)&&this.pc.getState(262144)&&this.Vva?(this.wl.$Qc(17,this.VEb),this.dJd=!0,ya.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}dDi(){return this.m$j?
!0:this.pc.sg(1048576)&&this.pc.getState(1048576)&&this.Vva&&this.Tsk?(this.wl.$Qc(21,this.VEb),this.IJd=!0,ya.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}zCi(){return this.P2j?!0:this.pc.sg(131072)&&this.pc.getState(131072)&&this.Vva?(this.wl.$Qc(16,this.VEb),this.XId=!0,ya.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get FZj(){return this.slf}get t2j(){return this.TId}get s_j(){return this.yId}get g4j(){return this.aJd}get m1j(){return this.JId}get T_j(){return this.CId}get v_j(){return this.gBa}get S6j(){return this.uJd}get H1j(){return this.MId}get Q6j(){return this.rJd}get P2j(){return this.XId}get I4j(){return this.dJd}get u2j(){return this.UId}get m$j(){return this.IJd}get VZj(){return this.rId}}
Object(m.a)(Yl,"ReadOnlyUIManager",null,[1349,108]);class ll{constructor(a,b,c,f,l,y,G){this.RJg=!1;this.Oy=()=>{ya.a.J(509367064,809,50,"FilterPrivacyUIManager::OnUnifiedAppStateChanged");this.k7d()};this.x_j=()=>!this.Ib.ka("FilterPrivacyBusinessBarEnabled")||this.RJg?!1:this.pc.sg(16777216)?this.pc.getState(16777216):(ya.a.J(509367063,809,50,"FilterPrivacyUIManager::IsFilterPrivacyEnabled - Business bar not displayed, filterPrivacyEnabled field not ready"),!1);this.k7d=()=>{this.x_j()&&(this.uj.amIAlone?
(ya.a.J(508842016,809,50,"FilterPrivacyUIManager::EvaluateBusinessBarRequirements - !isCoauthoringActive"),this.yE.LJc(this.UJa)):this.Ib.ka("KeepFilterPrivacyClickCountRoamingEnabled")?this.wAe.getKeepFilterPrivacyClickCount(this.GNe):this.lWf())};this.UJa=(R,ja)=>{2===ja.tLe&&(ya.a.J(508842015,809,50,"FilterPrivacyUIManager::OnCoauthStatusChanged - e.newStatus === CoauthorStatus.coauthoring"),this.k7d());this.yE.fqd(this.UJa)};this.GNe=R=>{R<this.vNg?this.lWf():ya.a.J(508895451,809,50,`FilterPrivacyUIManager::OnGetKeepFilterPrivacyClickCountSucceeded - keepFilterPrivacyClickCount at maximum (${this.vNg})`)};
this.lWf=()=>{this.wl.wL(27);this.RJg=!0;ya.a.J(509366796,809,15,"FilterPrivacyUIManager::DisplayFilterPrivacyBusinessBar - Business bar displayed")};if(!f)throw Error.argumentNull("appSettingsManager");this.pc=a;this.wl=b;this.Mc=c;this.Ib=f;this.uj=l;this.yE=y;this.wAe=G}initialize(){this.Mc.Qca(this.Oy);this.vNg=this.Ib.uc("KeepFilterPrivacyMaxClickCount",3);this.k7d()}dispose(){this.Mc.skb(this.Oy)}}Object(m.a)(ll,"FilterPrivacyUIManager",null,[1350,108]);var Nl=d(248);class Ol{constructor(a,
b,c){this.PHa=this.Zma=!0;this.GNe=l=>{this.PHa=!0;try{let y=null;l.data.Wd&&0<l.data.Wd.trim().length&&(y=JSON.parse(l.data.Wd));const G=l.data.state;G(y)}catch(y){ya.a.J(508909132,824,10,`FilterPrivacyRoamingCacheProxy::OnGetKeepFilterPrivacyClickCountSucceeded - Exception caught: ${y.toString()}`)}ya.a.J(508909131,824,50,`FilterPrivacyRoamingCacheProxy:OnGetKeepFilterPrivacyClickCountSucceeded - ResponseSize=${0}, EnqueueTimeMS=${JSON.stringify(l.data.PF)}, InvokedTimeMS=${JSON.stringify(l.data.Is)}, CompletedTimeMS=${JSON.stringify(l.data.fu)}`)};
this.QHk=l=>{this.PHa=!0;l=this.vfa.j9(l);ya.a.J(508909130,824,10,`FilterPrivacyRoamingCacheProxy:OnGetKeepFilterPrivacyClickCountFailed - ${l}`)};this.EKk=l=>{this.Zma=!0;ya.a.J(508908743,824,50,`FilterPrivacyRoamingCacheProxy:OnPutKeepFilterPrivacyClickCountSucceeded - EnqueueTimeMS=${JSON.stringify(l.data.PF)}, InvokedTimeMs=${JSON.stringify(l.data.Is)}, CompletedTimeMS=${JSON.stringify(l.data.fu)}`)};this.DKk=l=>{this.Zma=!0;l=this.vfa.j9(l);ya.a.J(508909129,824,10,`FilterPrivacyRoamingCacheProxy::OnPutKeepFilterPrivacyClickCountFailed - ${l}`)};
const f=[];a||f.push("clientRequestManager");b||f.push("jsonpHelperManager");c||f.push("appSettings");if(f.length)throw Error.argumentNull(f.join());this.Qr=a;this.vfa=b;this.la=c}get Cvg(){return this.Zma}getKeepFilterPrivacyClickCount(a){if(this.PHa){ya.a.J(508909135,824,50,"FilterPrivacyRoamingCacheProxy::GetKeepFilterPrivacyClickCount");var b=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTKeepFilterPrivacyClickCount",w.AFrameworkApplication.Pg),
c={};c["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Qr.qj(b,1,null,c,!1,2,this.GNe,this.QHk,a,void 0,void 0,void 0,void 0,Nl.a("18"));this.PHa=!1}else ya.a.J(508909136,824,50,"FilterPrivacyRoamingCacheProxy::GetKeepFilterPrivacyClickCount - Response of previous get roaming request is not back yet.")}yPj(){if(this.Zma){ya.a.J(508909133,824,50,"FilterPrivacyRoamingCacheProxy::IncrementKeepFilterPrivacyClickCount");var a=this.la.roamingServiceHandlerWebServiceBase+
String.format("RoamingServiceHandler.ashx?action={0}&{1}","incrementPPTKeepFilterPrivacyClickCount",w.AFrameworkApplication.Pg);if(w.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.Qr.mpa(a,null);else{const b={};b["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Qr.qj(a,2,null,b,!1,2,this.EKk,this.DKk,void 0,void 0,void 0,void 0,void 0,Nl.a("19"))}this.Zma=!1}else ya.a.J(508909134,824,50,"FilterPrivacyRoamingCacheProxy::IncrementKeepFilterPrivacyClickCount - Response of previous write roaming request is not back yet.")}dispose(){}}
Object(m.a)(Ol,"FilterPrivacyRoamingCacheProxy",null,[1014,108]);class fn{constructor(){this.xAe=this.Mjc=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Xb(a){this.K=a;this.K.register(1349,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").na().oa(()=>new Yl(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")));this.K.register(1350,"PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager").na().oa(()=>new ll(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
new Ol(w.AFrameworkApplication.Je,a.resolve("PowerPointWebEditor.IJsonpHelperManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").YFa&&(this.Mjc=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.xAe=this.K.resolve("PowerPointWebEditor.UnifiedApp.IFilterPrivacyUIManager"),this.Mjc.initialize(),this.xAe.initialize())}dispose(){this.Mjc&&this.Mjc.dispose();this.Mjc&&this.xAe.dispose()}static main(){n.a.instance.Ac(new fn)}}
Object(m.a)(fn,"PPTWebEditorUnifiedAppPackage",null,[2,3]);var Vh=d(277);class Fo{constructor(a,b,c,f){this.Eb=a;this.ur=b;this.PE=c;this.Zva=f}Pka(){const a=new Qe.a;a.$(0,Object(H.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(H.a)(this,this.pptTableColumnHandleClickHandler,"pptTableColumnHandleClickHandler"));a.$(2,Object(H.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(H.a)(this,this.backgroundClickHandler,
"backgroundClickHandler"));a.$(4,Object(H.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.ur.Q4(a.Bc)||this.ur.uWa(a.Bc)||this.ur.k4c(a.Bc)?(this.Eb.Xwb(),Vh.a.jm(!0)):Vh.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.ur.gva(a.Bc)){const b=this.ur.afe(a.Bc);if(!b||!b.Pk)return ya.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),Vh.a.jm(!1);b.Pk.iq||this.ur.QNc(a.Bc,a.yV,a.Fj.kg);
return Vh.a.jm(!0)}return Vh.a.notHandled}pptTableRowHandleClickHandler(a){if(this.ur.Zcc(a.Bc)){const b=this.ur.afe(a.Bc);if(!b||!b.Pk)return ya.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),Vh.a.jm(!1);b.Pk.iq||this.ur.Xhl(a.Bc,a.yV,a.Fj.kg);return Vh.a.jm(!0)}return Vh.a.notHandled}backgroundClickHandler(a){return this.Eb.Ncc(a)?(this.Zva.setVisibility(!1),Vh.a.jm(!0)):Vh.a.notHandled}shapeClickHandler(a){let b=Vh.a.notHandled;this.PE.Gcc||(b=this.PE.j2e(a));
this.PE.Gcc=!1;if((a=this.PE.cyb(a))&&!a.fM||a&&a.shapeNode&&a.shapeNode.xd&&a.fM)return Vh.a.jm(!0);this.Zva.setVisibility(!1);return b}}Object(m.a)(Fo,"ClickHandlers",null,[]);var gn=d(431),Zl=d(436);class wi{constructor(a,b,c,f,l,y){this.Eb=a;this.pa=b;this.Fa=c;this.ia=f;this.PE=l;this.wGb=y}Pka(){const a=new Qe.a;a.$(0,Object(H.a)(this,this.noContextMenuHandler,"noContextMenuHandler"));a.$(1,Object(H.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(H.a)(this,
this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Eb.DDh(a)?gn.a.notHandled:gn.a.jm(null)}slideBackgroundContextMenuHandler(a){return this.Eb.Ncc(a)?(this.pa.iu(),this.pa.nh(),this.Fa.Bd(),this.ia.Ja(ea.a.Z0d,2,a.Fj),gn.a.jm(null)):gn.a.notHandled}shapeContextMenuHandler(a){var b=this.PE.cyb(a);if(this.Jyl(b,a))b.iEa(),this.wGb?b.yy||this.ia.Ja(ea.a.mRa,2,new Zl.a(b.shapeNode,!0,a.Fj)):this.ia.Ja(ea.a.mRa,2,new Zl.a(b.shapeNode,!0,a.Fj));else if(this.Fyl(b))return this.pa.iu(),
(b=this.PE.wvj(b,a))&&this.pa.selectShape(b,!0),this.Fa.Bd(),this.ia.Ja(ea.a.Y0d,2,a.Fj),gn.a.jm(null);return gn.a.notHandled}Jyl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.Rug&&!a.UAb(b.Fj)}Fyl(a){return!!a||this.pa.vH()||!this.pa.Pa.length}}Object(m.a)(wi,"ContextMenuClickHandlers",null,[]);class jm{constructor(a,b,c,f,l){this.Eb=a;this.ur=b;this.PE=c;this.ia=f;this.Ahc=l}Pka(){const a=new Qe.a;a.$(0,Object(H.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));
a.$(1,Object(H.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(H.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.ur.Q4(a.Bc)||this.ur.uWa(a.Bc)||this.ur.k4c(a.Bc)?(this.Eb.Xwb(),Vh.a.jm(!0)):this.ur.gva(a.Bc)||this.ur.Zcc(a.Bc)?(this.Eb.Xwb(),Vh.a.jm(!1)):Vh.a.notHandled}shapeDoubleClickHandler(a){return this.PE.cyb(a)?(this.Eb.Xwb(),Vh.a.jm(!1)):Vh.a.notHandled}backgroundDoubleClickHandler(a){return this.Eb.Ncc(a)?
(this.Eb.Xwb(),this.Ahc||this.ia.processAction(ea.a.HFa,2,{DoubleClickInsert:"true"}),Vh.a.jm(!0)):Vh.a.notHandled}}Object(m.a)(jm,"DoubleClickHandlers",null,[]);class Vp{constructor(a,b,c,f,l){this.PE=a;this.wD=b;this.ia=c;this.Ga=f;this.LO=l}qag(){return Object(H.a)(this,this.Ghd,"mouseUpHandlerFilter")}Ghd(a){return a?(a=this.wD.Qde(a.Bc))&&a.gb&&this.Ga.An(a.gb)&&this.LO.yWa&&this.PE.V2e?(this.ia.processAction(C.a.Dka,2),!0):this.PE.V2e=!1:!1}}Object(m.a)(Vp,"MouseInputHandlers",null,[]);var wj=
d(263);class wp{constructor(a,b,c,f){this.PE=a;this.Rb=b;this.d1=c;this.xe=f}Pka(){const a=new Qe.a;a.$(0,Object(H.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(H.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,Object(H.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.uPl();return this.PE.$Ff(a)}uPl(){this.xe.Fne()||Kc.a.v7d("ScrollActiveThumbnailIntoView",ea.a.Wkb,()=>
{this.xe.Zrd();return 32})}shapePointerDownHandler(a){this.Rb.vX&&this.d1.show(3,-1);const b=this.PE.cyb(a);if(b&&b.shapeNode&&b.shapeNode.Wf&&!b.shapeNode.Ug)return Vh.a.jm(!1);if((Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.zpa)||Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.Plb)||Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.Bud)||Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.Zwd)||Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.LJh)||Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.ZJh))&&b.isSelected&&
!b.fM||void 0!==b&&null!==b&&b.shapeNode.Pp)return this.PE.Gcc=!1,Vh.a.jm(!0);this.PE.Gcc=!0;a=this.PE.j2e(a);a.v4&&(this.PE.V2e=!0);return a}defaultPointerDownHandler(){return Vh.a.jm(!0)}}Object(m.a)(wp,"PointerDownHandlers",null,[]);class Wp{constructor(a){this.PE=a}Pka(){const a=new Qe.a;a.$(0,Object(H.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(H.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(H.a)(this,this.shapePointerUpHandler,
"shapePointerUpHandler"));a.$(2,Object(H.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.PE.$Ff(a)}shapePointerUpHandler(a){const b=this.PE.cyb(a);return b&&b.shapeNode&&b.shapeNode.Wf&&!b.shapeNode.Ug?Vh.a.jm(!1):this.PE.j2e(a)}defaultPointerUpHandler(){return Vh.a.jm(!0)}}Object(m.a)(Wp,"PointerUpHandlers",null,[]);class Yo extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Yo,"SlideBackgroundClickedEventArgs",Sys.EventArgs,
[]);class Pn{constructor(a,b,c,f,l,y,G,R){this.Eb=a;this.ur=b;this.pa=c;this.Zva=f;this.Fa=l;this.$J=y;this.Dna=G;this.Ga=R;this.V2e=this.Gcc=!1}$Ff(a){return this.Eb.Ncc(a)?(this.pa.iu(),a=a.Fj,this.$J.rnh(new Yo(!1)),(a.ctrlKey||a.shiftKey)&&a.OA===Sys.UI.MouseButton.leftButton?this.pa.nj():this.pa.nh(),this.Zva.setVisibility(!1),this.Fa.Bd(),Vh.a.jm(!0)):Vh.a.notHandled}j2e(a){const b=this.cyb(a);b&&this.pa.iu();const c=Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.zpa)||Sys.UI.DomElement.containsCssClass(a.Bc,
wj.a.Plb)||Sys.UI.DomElement.containsCssClass(a.Bc,wj.a.Bud),f=this.ur.k4c(a.Bc)||this.ur.Q4(a.Bc)||this.ur.uWa(a.Bc);Kc.a.yk("isEventFromHandlers",c.toString());Kc.a.yk("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.fM?(this.pa.nj(),this.Zva.setVisibility(!1),this.Fa.Bd(),Vh.a.jm(!0)):f&&b&&!b.fM?(b.j$g(a.Fj),Vh.a.jm(!0)):!b||b.fM&&!this.Jne(a)?Vh.a.notHandled:(b.RLk(a.Fj),Vh.a.jm(!0))}cyb(a){let b=this.ur.eJ(a.Bc);if(!b){var c=a.Bc,f=xb.a(c,wa.a.role);f=f?f.toString()===Ne.a.J0b:!1;
if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.ur.eJ(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(sa.a)(117,b);if(!c&&(this.ur.k4c(a.Bc)||this.ur.Q4(a.Bc)||this.ur.uWa(a.Bc))&&(c=this.Dna.P7b(this.Ga.An(b.gb)),!c))return ya.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.Dna.P7b(this.Ga.An(b.gb)))&&
c.GB&&!(c.yy||c.iq||c.Sre))return c}return null}Jne(a){return a&&a.Bc?a.Bc.id.startsWith(Pd.a.H7a):!1}wvj(a,b){return a?this.vvj(a):this.uvj(b.graphNode)}vvj(a){let b=null;a.isSelected&&this.pa.vH()||(b=Object(sa.a)(4,a.gb));return b}uvj(a){let b=null;if(a){const c=ub.GraphIterator.pb(a);c.rc(10)?(a=Object(sa.a)(4,c.Jg(10)),this.pa.yX(a)||(b=a)):ya.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(m.a)(Pn,"ViewEventHandlerHelper",null,
[1368]);class Go{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Xb(a){this.K=a;a.register(Fo,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").na().oa(()=>new Fo(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(jm,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").na().oa(()=>
new jm(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").AAb));a.register(wi,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").na().oa(()=>new wi(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(wp,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").na().oa(()=>new wp(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));
a.register(Wp,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").na().oa(()=>new Wp(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(Vp,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").na().oa(()=>new Vp(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(Pn,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").na().oa(()=>new Pn(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.Ndi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").Pka());a.Cei(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").Pka());a.oei(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").Pka());
a.dgi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").Pka());a.ggi(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").Pka());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").ub(pa.a.bK,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").qag())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").Bb(pa.a.bK,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").qag())}static main(){n.a.instance.Ac(new Go)}}Object(m.a)(Go,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var ug=d(77),si;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(si||(si={}));Object(m.b)("WebSocketCompressionHelperLoadState",si);var Ak=d(89),Ar=d(313),
fp;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(fp||(fp={}));Object(m.b)("WebSocketState",fp);class Ro{constructor(a,b,c,f,l){this.bjc=this.Zl=this.VHb=null;this.AIa=-1;this.Ifb=this.wma=0;this.efc=-1;this.wFb=0;this.xFb=null;this.qXa=0;if(!a)throw Error.argumentNull("webSocketClient");this.Zv=a;this.Ya=b;this.NE=c;this.Mc=f;a=document.createElement("a");a.href=this.Zv.lZl;a.protocol="http:"===a.protocol?"ws":"wss";qd.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new qj.QueryStringBuilder(a.href),qd.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.xg(Yg.a.Mgh,b.Ck),qd.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.xg(Yg.a.vQk,w.AFrameworkApplication.userSessionId),a.xg(Yg.a.Foc,l.toString()),this.VHb=a.toString()):this.VHb=a.href;this.Mfb=ug.a.jA(this.VHb);this.X2b(2);this.yna=this.Zv.xuh;this.$ve=this.Zv.oFi;this.h2e();this.Mc.CCa(Object(H.a)(this,this.Fib,"onSessionEnding"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"))}dispose(){this.Mc.oqd(Object(H.a)(this,
this.Fib,"onSessionEnding"));this.Mc.Raa(Object(H.a)(this,this.Hn,"onSessionRehydrated"))}X2b(a){this.Zl&&this.Zl.close();this.Zl=new WebSocket(this.VHb,[]);this.Zl.onopen=Object(H.a)(this,this.onOpen,"onOpen");this.Zl.onerror=Object(H.a)(this,this.onError,"onError");this.Zl.onclose=Object(H.a)(this,this.onClose,"onClose");this.Zl.onmessage=Object(H.a)(this,this.onMessage,"onMessage");this.qXa=a;ya.a.J(556541794,this.Zv.eR,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.Mfb,this.Ya.Ck,this.qXa)}ping(){if(this.Zl)if(1===this.Zl.readyState){const a=this.Zv.yQi();this.Zl.send(a)}else ya.a.J(559284698,this.Zv.eR,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Zl.readyState),this.Lya(4);else ya.a.J(559284697,this.Zv.eR,50,"WebSocketFetcher::Ping Websocket is unavailable.")}vFi(){this.Zl.close()}onOpen(){ya.a.J(591208995,this.Zv.eR,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.Mfb,this.Ya.Ck);this.isc();this.wFb=0;this.xFb=null;
this.Zv.gGk()}onError(a){ya.a.J(591208993,this.Zv.eR,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.Mfb,this.Ya.Ck)}onClose(a){ya.a.J(591208991,this.Zv.eR,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.Mfb,this.Ya.Ck,JSON.stringify(a),a.code,a.reason);this.wFb=a.code;this.xFb=a.reason}onMessage(a){try{a&&a.data&&this.Zv.mJk(a)}catch(b){ya.a.J(559284699,this.Zv.eR,10,"WebSocketFetcher::OnMessage",
b.toString())}}h2e(){this.bjc=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.efc),this.Zl||(ya.a.J(559284700,this.Zv.eR,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Lya(1))):this.efc=window.setTimeout(()=>{this.Zl&&(ya.a.J(559284701,this.Zv.eR,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.wFb=1E3,this.xFb="Lost visibility",this.Zl.close(this.wFb,this.xFb),this.Zl=null,window.clearTimeout(this.AIa))},
this.$ve)};window.self.addEventListener("visibilitychange",this.bjc)}isc(){this.wma=0}pVd(){0<this.Zv.thd&&(new Date).getTime()-this.Ifb>this.Zv.thd&&(this.isc(),ya.a.J(559284702,this.Zv.eR,50,"WebSocketFetcher::Retry connect to server after long pause."))}lZd(){const a=!!this.NE&&!!this.NE.instance&&!this.NE.instance.s0,b=(new Date).getTime()-this.Ifb>this.yna,c=this.wma<this.Zv.C5g,f=!this.Zl||3===this.Zl.readyState||2===this.Zl.readyState,l=a&&b&&c&&f;ya.a.J(557181E3,this.Zv.eR,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}q1e(){this.Ifb=(new Date).getTime();this.yna=Math.pow(2,this.wma)*this.Zv.xuh;0<this.Zv.thd&&(this.yna=Math.min(this.yna,this.Zv.thd));window.setTimeout(()=>{this.Lya(3)},this.yna)}Lya(a){this.pVd();this.lZd()&&(this.X2b(a),this.q1e(),this.wma++,a!==this.qXa&&ya.a.J(541671620,this.Zv.eR,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.qXa),ya.a.J(559284703,this.Zv.eR,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.qXa),this.wma===this.Zv.C5g&&ya.a.J(559284704,this.Zv.eR,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.qXa))}sendMessage(a,b){if(!this.Zl)return ya.a.J(559284705,this.Zv.eR,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.wFb,this.xFb),1;ya.a.J(559284706,this.Zv.eR,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",fp[this.Zl.readyState],
b,this.wFb,this.xFb);if(1===this.Zl.readyState)return this.Zl.send(a),0;this.Lya(5);return 2}yul(){this.Zl.binaryType="arraybuffer"}qJb(){-1!==this.AIa&&window.clearTimeout(this.AIa);this.AIa=window.setTimeout(()=>{this.ping()},this.Zv.dTk)}SDi(){this.qXa=0}Fib(){this.Zl&&(ya.a.J(557352418,this.Zv.eR,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Zl.close(),this.Zl=null)}Hn(){this.Zl||(ya.a.J(557352419,this.Zv.eR,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.Lya(6))}}Object(m.a)(Ro,"WebSocketFetcher",null,[1408,108]);var Vq;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(Vq||(Vq={}));
Object(m.b)("ConnectionReason",Vq);var Wq;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Wq||(Wq={}));Object(m.b)("SendMessageStatusCode",Wq);class yt extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.Mgl=b;this.tYj=c}}Object(m.a)(yt,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Kk=d(663);class Xq{constructor(a,b,c,f,l){this.Pl=window.performance.now();this.HGe=new Wc.a;this.Vye=this.lgc=!0;this.$Db=
null;this.aIb=1;this.Ya=b;this.Fbd=a.jZl;this.IFe=a.kZl;this.Ipk=a.hZl;this.ttk=a.iZl;this.ojk=a.fZl;this.GGb=a.HAd;this.kgd=a.CWl;this.sJe=a.gZl;this.Mfb=ug.a.jA(this.sJe);this.txa=new Ro(this,b,c,f,new Ar.a(a.Haa));this.jFg=a.fOc;if(l)this.$Db=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.txa.dispose()}ping(){this.txa.ping()}Xx(a){const b=new Map,c=this.MAj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),Sf.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.GGb?(a=this.txa.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",Wq[a]),Sf.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new Ak.a,{extendedProperties:b})))):Sf.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new Ak.a,{extendedProperties:b}))}Qki(a){this.HGe.addHandler("ResponseReceivedEventId",a)}ucl(a){this.HGe.removeHandler("ResponseReceivedEventId",
a)}gGk(){if(this.GGb){var a=Kc.a.Kb?Kc.a.Kb.actionId:oh.a.create().toString(),b=w.AFrameworkApplication.userSessionId,c=this.Ya.Ck;this.Vye=!0;b=Kk.p(a,b,this.Ya.podSessionId,c);b=this.txa.sendMessage(JSON.stringify(b),"validateSession");ya.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Wq[b],this.Mfb,c)}}mJk(a){if(this.GGb)try{const b=this.P4i(a);if(b.pong)this.qJb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.vNk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.cGk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.HGe.raiseEvent("ResponseReceivedEventId",new yt(b,this.jtj(a,c),c))}}catch(b){ya.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.qJb(a.data)}P4i(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.aIb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);ya.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}jtj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}vNk(a){if(a.isValid){if(this.jFg){a=Kc.a.Kb?Kc.a.Kb.actionId:oh.a.create().toString();const b=w.AFrameworkApplication.userSessionId,c=this.Ya.podSessionId,
f=this.Ya.Ck;ya.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",si[this.aIb]);1===this.aIb?this.Bdk(a,b,c,f):2===this.aIb&&this.Mxh(a,b,c,f)}this.ping()}else ya.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.Mfb,this.Ya.Ck),this.txa.vFi()}Bdk(a,b,c,f){this.jFg&&this.$Db.loadScript("WebSocketCompressionHelper").then(()=>{this.aIb=
2;this.Mxh(a,b,c,f)}).catch(()=>{ya.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.aIb=3})}Mxh(a,b,c,f){a=Kk.a(a,b,c,!0,f);a=this.txa.sendMessage(JSON.stringify(a),"compressionHandshake");ya.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}cGk(a){a=a.clientReadyForCompression;ya.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.txa.yul()}MAj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}qJb(a){this.txa.qJb(a);na.a.Xa(a)?ya.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?ya.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.GGb):(a={["PingTime"]:window.performance.now()-this.Pl-a,MeasurementType:"Performance.Now"},a.First=this.lgc?1:0,a.WebSocketFrontDoorProtobufEnabled=this.GGb,a.PostConnectionPing=this.Vye,a.ConnectionReason=Vq[this.txa.qXa],this.txa.SDi(),this.Vye=this.lgc=!1,ya.a.J(591208985,839,50,ta.a.toJSON(a))))}yQi(){var a=(window.performance.now()-this.Pl).toString();if(!this.GGb)return a;a=Kk.q(Kk.l(a),null,null,null,this.Ya.Ck);return JSON.stringify(a)}get lZl(){return this.kgd&&!na.a.Xa(this.sJe)?this.sJe:
w.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get eR(){return 839}get dTk(){return this.IFe}get C5g(){return this.Fbd}get xuh(){return this.ttk}get thd(){return this.Ipk}get oFi(){return this.ojk}}Object(m.a)(Xq,"PodsWebSocketFrontDoor",null,[1337,108,1365]);class qm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Xb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1337,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").na().oa(()=>{try{return new Xq(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ia("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").xI)}catch(b){return ya.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){n.a.instance.Ac(new qm)}}
Object(m.a)(qm,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var Br=d(1197),Yp=d(1207);class zt{constructor(a=null){this.ao=null;this.reset();this.HYb=a}b0b(a,b){if(!this.HYb||this.HYb.J2e())b in this.ao||(this.ao[b]=[]),this.ao[b].push(a)}getData(){return ta.a.count(this.ao)?this.ao:null}reset(){this.ao={}}}Object(m.a)(zt,"NamedValuesAggregator",null,[1546]);class no{constructor(){this.ao=new Oa.a}get i5k(){return this.ao.count}b0b(a){this.ao.add(a)}getData(){return this.i5k?Za.toArray(this.ao):
null}reset(){this.ao=new Oa.a}}Object(m.a)(no,"BatchDataAggregator",null,[1546]);var Dp;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Dp||(Dp={}));Object(m.b)("ApiType",Dp);class Yq{constructor(a,b){this.ji=a;this.GNd=b}Xx(a,b,c){if(c){a=Dp[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=w.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.ji.qj(this.GNd()+
"&apitype="+a,2,b,f,!1,3,Object(H.a)(this,this.pLa,"requestSucceeded"),Object(H.a)(this,this.nLa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}pLa(a){if(!w.AFrameworkApplication.Yg&&a&&a.data){var b=a.data.state;b&&b.yZc(b,a.data.Wd)}}nLa(a){!w.AFrameworkApplication.Yg&&a&&a.data&&(a=a.data.state)&&a.kZc(a)}}Object(m.a)(Yq,"EditorServiceRequestManager",null,[1425]);class rs extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(m.a)(rs,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var ul=d(276);class ef{constructor(a,b,c){this.begin=a;this.end=b;this.Fh=c}}Object(m.a)(ef,"ErrorRange",null,[270]);class Hn{constructor(a,b){this.$n=a;this.O_h=b}get Ke(){return this.$n}get Fh(){return this.O_h}ge(a){return new Hn(a||this.$n,this.Fh)}}Object(m.a)(Hn,"SpellingErrorObject",null,[147]);class Cr{constructor(a,b,c){this.Oa=new Wc.a;this.Er=a;this.M9h=b;this.t3h=c}dzf(a,b){b=this.FGh(a,b);if(!Ub.a.Xa(b)){for(var c=this.VF(a),f=[],l=0,y=0;l<b.length&&y<c.length;){const G=c[y],R=b[l];
R.end<=G.begin?++l:(G.end>R.begin&&Array.add(f,G),++y)}c=a.s2a();try{const G=a.cka();try{this.bqh(a,f),this.ezf(a,b)}finally{G&&G.dispose()}}finally{c&&c.dispose()}this.Iid(a)}}hLa(a,b,c=!1){if(!Ub.a.Xa(b)){c=c?null:a.s2a();try{const f=a.cka();try{this.bqh(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.Iid(a)}}Udl(a,b){const c=a.s2a();try{const f=a.cka();try{this.f_d(a),b=this.FGh(a,b),Ub.a.Xa(b)||this.ezf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}f_d(a){const b=a.s2a();try{const c=
a.cka();try{const f=a.Sa;for(a=0;a<f.length;a++){const l=f.ga(a);l.aq&&(l.aq=null);l.eM=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}VF(a,b=null){const c=[];let f=0,l=null;var y=!1;a=a.Sa;for(let G=0;G<a.length;G++){const R=a.ga(G);if(R.eM){const ja=R.cp;l?(y=new ef(f,ja,l),b&&!b(y)||Array.add(c,y)):y?ha.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):ha.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,ja);y=!1}R.aq&&(y=!0,f=R.cp,l=R.aq.Fh)}return c}bUa(a){if(!a||!Jb.SelectionEditor.tk(a)&&!Jb.SelectionEditor.Xg(a))return null;const b=a.node;let c=a.Ra,f=a.Lb;a=Jb.SelectionEditor.Xg(a);const l=this.Er.text(b);for(const y of this.VF(b))if(a){if(y.begin<=c&&y.end>=f)return y}else if(y.begin<=c&&y.end>=c&&na.a.hKi(l,y.end,f))return y;return null}$sc(a){if(!this.t3h||!a||!(a.ida||2===a.length&&Jb.SelectionEditor.nm(a.jf)))return!1;a=this.bUa(a.Ua);if(!a)return!1;if(a=Object(sa.a)(344,a.Fh))if(a.jTh=
!0,a.vpe())return!1;return!a||5!==a.proofingType}FGh(a,b){if(Ub.a.Xa(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Fh||(ha.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;ul.d(b);c=[];this.M9h&&Array.addRange(c,this.Er.dUa(a));c=ul.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const y=c[a];l.begin<y.end&&y.begin<l.end?Array.removeAt(b,f):l.end<
y.end?f++:a++}return b}ezf(a,b){let c=!1;for(const f of b){b=f.Fh;c=1===b.proofingType||c;let l=a.Vwb(f.begin);l.aq=new Hn(l,b);l.isFromErrorRangeSplit=!0;l=a.Vwb(f.end);l.eM=!0;l.isFromErrorRangeSplit=!0}c&&(a.ZAb=!1)}bqh(a,b){if(!Ub.a.Xa(b)){a=a.Sa;for(const c of b){b=a.NT(c.begin);const f=a.NT(c.end);b&&b.aq&&f&&f.eM?(b.aq=null,f.eM=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),ha.ULS.sendTraceTag(37532355,324,10,b))}}}rji(a){this.Oa.addHandler("OnErrorRangesChanged",
a)}Iid(a){if(this.Oa.p$b){const b=this.VF(a);this.Oa.raiseEvent("OnErrorRangesChanged",new rs(a.id.toString(),b))}}}Object(m.a)(Cr,"ErrorRangeEditor",null,[1424]);var So=d(217);class ss{constructor(){this.tkf=new So.a}contains(a,b){return a?this.tkf.contains(na.a.uLh(a,b)):!1}add(a,b){a&&this.tkf.add(na.a.uLh(a,b))}}Object(m.a)(ss,"IgnoreAllKeywords",null,[1339]);var Lk=d(219);class Zq extends Lk.a{constructor(a,b,c){super(b,c);this.SG=a;this.AKa=this.Kaa=-1;this.GZd=0;this.textUnit=2}get lcid(){return this.SG}}
Object(m.a)(Zq,"ModifiedRange",Lk.a,[]);class To{constructor(a,b,c,f){this.Dci=a;this.aL=b;this.BN=c;this.ssf=f}get Ind(){return this.ssf?this.ssf.instance:null}NGf(a,b){const c=[];if(Ub.a.Xa(a)||Ub.a.Xa(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new Zq(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let y=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const G=a.pop(),R=G.end,ja=Math.min(R,l);R>l&&a.push(new Lk.a(l,R));Array.add(c,new Zq(y,G.begin,
ja))}f++}while(0<a.length&&f<b.length);ha.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}i4i(a,b,c,f){let l,y;({oKe:l,TJe:y}=To.z2f(a,c,b));c=0;let G=a.begin,R=a.end;const ja=this.Ind;let za=!1;ja?(c=ja.findEndBoundary(b,R-1,y),f||-1!==c||this.ojg(b,a)?c=-1===c?y:c:za=!0):za=!0;if(za)return this.L8f(a,b,this.BN.a9g,l,y);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(ja.findBeginBoundary(b,G,l),l);return Lk.a.createTextRange(a,c)}h4i(a,
b,c){return this.W_f(a,b,c,this.BN.a9g)}g4i(a,b){if(!a||Ub.a.Xa(b))return a;let c=a.begin,f=a.end,l=!1;for(const y of b){if(a.end<=y.begin)break;a.begin>y.begin&&a.begin<y.end&&(c=y.begin,l=!0);a.end>y.begin&&a.end<y.end&&(f=y.end,l=!0)}return l?Lk.a.createTextRange(c,f):a}Sxl(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!na.a.DBb(b.substring(c,a))&&!na.a.gKi(b,c,a)}mfj(a,b,c){if(!a||!c||Ub.a.Xa(b))return 0;a=ul.c([a],b);b=0;for(const f of a)b+=this.Dci.ofg(c,f.begin,f.end);return b}Jei(a,
b,c,f){if(a&&b){var l=a.begin,y=a.end,G=this.BN.NDk;if(0>=G)a.Kaa=l,a.AKa=y;else if(G=this.W_f(a,b,f,G)){b=a.lcid;f=G.begin;G=G.end;if(0>f||this.$Ch(f,l,b,c))f=l;this.$Ch(y,G,b,c)&&(G=y);a.Kaa=f;a.AKa=G}else a.Kaa=l,a.AKa=y}}ojg(a,b){return this.Ind?-1!==this.Ind.findEndBoundary(a,b.begin,b.end):!1}$Ch(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.NGf([new Lk.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}W_f(a,b,c,f){if(!a||!b||0>f)return null;let l;({oKe:c,TJe:l}=To.z2f(a,c,b));return this.L8f(a,
b,f,c,l)}L8f(a,b,c,f,l){return Lk.a.createTextRange(this.aL.k8i(b,c,a.begin,f),this.aL.R7i(b,c,a.end,l))}static z2f(a,b,c){let f;f=0;c=c.length;if(Ub.a.Xa(b))return{oKe:f,TJe:c};let l=a.begin;a=a.end;let y=!1,G=!1;for(const R of b)if(!y&&R.end<=l?f=R.end:y=!0,!G&&R.begin>=a&&(c=R.begin,G=!0),y&&G)break;return{oKe:f,TJe:c}}}Object(m.a)(To,"ModifiedExpandRangeHelper",null,[1423]);var dl=d(355);class ts{constructor(a,b){this.XHd=null;this.Mh=a;this.aL=b;this.XG=zb.ParagraphReader.text(this.Mh);this.nsf=
[]}nAj(a,b){return this.IYc(this.aL.H6b(this.XG,a,b))}IYc(a){return a?this.Ffe(a.begin,a.end):null}Ffe(a,b){this.XHd=this.XHd||this.aL.WVc(this.Mh);return this.aL.IYc(a,b,this.XG,this.XHd)}iFa(a,b){(a=this.Ffe(a,b))&&Array.add(this.nsf,a)}z8b(){return Array.clone(this.nsf)}}Object(m.a)(ts,"ValidatedRangeContainer",null,[]);class Zp{constructor(a,b,c,f,l,y){this.Tm=a;this.aL=b;this.Uc=c;this.BN=f;this.j$h=l;this.Q7h=y}gyb(a){return new ts(a,this.aL)}Ymi(a){const b=a.D4d.currentNode;var c=a.LGh.currentNode;
const f=a.Gfh;a=this.aua(b);const l=this.gyb(b);c=this.aua(c);for(var y of c)l.iFa(f+y.begin,f+y.end);Array.addRange(a,l.z8b());if(y=l.nAj(f,f))Array.add(a,y),this.PWe(b,y,0);b.v1=a}Zmi(a,b,c){var f=a.v1;if(Ub.a.Xa(f)||f[f.length-1].end<=c)this.oNc(b);else{var l=[],y=this.gyb(a),G=this.gyb(b);for(const R of f)if(f=R.end,f>c){const ja=R.begin;ja<c?(y.iFa(ja,c),G.iFa(0,f-c)):G.iFa(ja-c,f-c)}else Array.add(l,R);c=y.z8b();Array.addRange(c,l);a.v1=c;b.v1=G.z8b();a.rtc();b.rtc()}}zrl(a){zb.ParagraphReader.fe(a)&&
!this.aL.HVa(a)&&(this.Tm.f_d(a),this.TXe(a,[new Lk.a(0,zb.ParagraphReader.textLength(a))]))}jAh(a,b){b&&a&&zb.ParagraphReader.fe(a)&&!this.aL.HVa(a)&&!a.KC&&this.e6g(a,this.gyb(a).IYc(b),C.a.typing)}oBh(a,b,c){a&&this.jAh(a,this.aL.H6b(zb.ParagraphReader.text(a),b,c))}TXe(a,b){if(zb.ParagraphReader.fe(a))if(Ub.a.Xa(b))this.oNc(a);else{const c=this.gyb(a);for(const f of b)c.iFa(f.begin,f.end);a.v1=c.z8b()}}oNc(a){zb.ParagraphReader.fe(a)&&(a.v1=null)}Mtd(a,b,c=null){if(zb.ParagraphReader.fe(a)&&!a.KC&&
!Ub.a.Xa(b)){ul.d(b);var f=null;if(this.BN.OAb||this.BN.DVa)f=R=>1===R.Fh.proofingType;f=this.Tm.VF(a,f);for(var l=[],y=0,G=0;G<f.length&&y<b.length;){const R=b[y],ja=f[G];R.end<=ja.begin?y++:(ja.end<=R.begin||ja.begin>=R.begin&&ja.end<=R.end&&(0!==ja.Fh.errorType||ja.begin!==R.begin)&&Array.add(l,ja),G++)}this.Tm.hLa(a,l);f=this.aua(a);b=ul.b(f,b);c&&(c=ul.c(f,[c]),0<c.length&&(b=ul.e(b,c)));this.TXe(a,b)}}aua(a){return zb.ParagraphReader.fe(a)?a.v1||[]:[]}gpi(a,b,c,f,l=0){const y=a.node;if(zb.ParagraphReader.fe(y)&&
!this.aL.HVa(y)&&!y.KC){var G=zb.ParagraphReader.text(y),R=a.Ra,ja=a.Lb+f;this.j$h?(R=a.Ra+b,ja=a.Lb-c+f):this.Q7h&&(b=this.Uc.ak,0<=f&&b&&Jb.SelectionEditor.Xg(b)&&(b=b.Ra,0<=b&&b<=G.length&&(b=this.aL.H6b(G,b,b))&&b.begin>=R&&b.end<=ja&&(R=b.begin,ja=b.end)));b=this.gyb(y);c=null;0<=f&&(c=b.Ffe(R,ja));c||(c=this.aL.H6b(G,R,ja));0<=f?this.e6g(y,c,l):this.WTl(y,a.Ra,a.Lb,c,b,f,l)}}e6g(a,b,c){if(b){var f=this.aua(a);Array.add(f,b);a.v1=f;a.rtc();this.PWe(a,b,c)}}WTl(a,b,c,f,l,y,G){const R=this.aua(a),
ja=[];if(R.length)if(R[R.length-1].end<b)if(f)Array.addRange(ja,R);else return;else{for(const za of R)za.end<b?Array.add(ja,za):za.begin>=c?l.iFa(za.begin+y,za.end+y):za.begin<b?za.end>c?l.iFa(za.begin,za.end+y):l.iFa(za.begin,b):za.end>c&&l.iFa(b,za.end+y);Array.addRange(ja,l.z8b())}f&&(Array.add(ja,f),this.PWe(a,f,G));a.v1=ja;a.rtc();this.Tm.Iid(a)}PWe(a,b,c){const f=this.Tm.VF(a,y=>y.begin<=b.end&&y.end>=b.begin);if((c===C.a.nXd||c===C.a.typing||c===C.a.cut||c===C.a.paste)&&1===f.length&&f[0].Fh){c=
f[0].Fh;var l=ab.a.He(c.lcid);l=l?l.name:Zp.UUh;const y=Object(Sa.a)(dl.a,c)?c.typeId:Zp.lVh;ha.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",y,l);c.jTh&&ha.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",y,l)}this.Tm.hLa(a,f)}}Zp.lVh="";Zp.UUh="UNKNOWN";Object(m.a)(Zp,"ModifiedRangeEditor",null,[1422]);class gp{constructor(a,b,c,f,l,y,G,R,ja,za,Va=null){this.Tm=a;this.$z=b;this.a_b=c;this.VK=f;this.l5a=l;this.vPa=y;this.aL=G;this.t6a=
R;this.nff=ja;this.Ajf=Va||gp.IUi;this.Cuf=!1;za.execute(hb=>{this.Cuf=!!hb})}HPh(a){if(a&&zb.ParagraphReader.fe(a)&&a.KZc){let b=null;this.nff.Sua&&(b=c=>!!c.Fh&&1===c.Fh.proofingType);a.ZAb=Ub.a.Xa(this.$z.aua(a))&&Ub.a.Xa(this.Tm.VF(a,b))}}Voj(a,b){var c=this.Xoj(a,b);if(Ub.a.Xa(c))return[];const f=zb.ParagraphReader.text(a).replace("\u00a0"," "),l=this.Tm.VF(a),y=this.Sml(a,l),G=y&&this.hMi(a),R=this.aL.R1f(a),ja=ul.e(this.aL.Q1f(a),R);c=this.hkj(c,b,f,ja,l,y,G);if(Ub.a.Xa(c))return[];b=this.l5a.fnj(a);
c=this.vPa.NGf(c,b);if(Ub.a.Xa(c))return[];this.QZk(a,f,c);a=this.$z.aua(a);for(const za of c)this.vPa.Jei(za,f,b,R),za.GZd=this.vPa.mfj(za,a,f),y&&(G||this.vPa.ojg(f,za))&&(za.textUnit=4);return c}J7i(a){if(this.Ajf()||!a||""===a.sa(Ya.a.Oo,""))return null;var b=this.t6a.K6b;if(!b||!Jb.SelectionEditor.Xg(b)||b.node!==a||!this.cLj(a))return null;b=b.Ra;return this.aL.H6b(zb.ParagraphReader.text(a),b,b)}fpi(a,b,c,f,l,y,G=0){this.VK.Lc(a.node).kf()&&(this.$z.gpi(a,b,c,y,G),this.a_b.WVl(a,f,l))}cLj(a){const b=
ul.a(this.$z.aua(a));if(!b.length)return!1;a=ul.a(this.Tm.VF(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],y=a[c];l.begin>=y.begin&&l.end<=y.end?f++:c++}return f!==b.length}Xoj(a,b){if(!a||a.ioe)return null;a=this.$z.aua(a);return a.length&&b?ul.b(a,[b]):a}Sml(a,b){return this.Cuf&&this.nff.Sua?a.RVb||!b.length||Ub.a.any(b,c=>!!c.Fh&&2===c.Fh.Oxg):!1}hMi(a){if(!a.RVb||this.Ajf())return!0;var b;(b=this.t6a.K6b)&&b.node===a?(a=this.$z.aua(a),b=b.Ra<a[a.length-1].begin):b=!0;return b}hkj(a,
b,c,f,l,y,G){let R=[];for(const ja of a)a=y?this.vPa.i4i(ja,c,f,G):this.vPa.h4i(ja,c,f),(a=this.vPa.g4i(a,l))&&Array.add(R,a);R=ul.a(R);b=ul.f(f,b);return ul.b(R,b)}QZk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const y=c[l];this.vPa.Sxl(y,b)||(Array.removeAt(c,l),Array.add(f,y))}this.$z.Mtd(a,f)}static IUi(){return Xg.a.HLj(Sc.App.Mb.DG.uwg)}}Object(m.a)(gp,"ParagraphProofingFacade",null,[1421]);var Bk=d(1098);class Ep{constructor(){this.kZc=this.yZc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(m.a)(Ep,"EditorServiceAPIRequest",null,[]);class us extends Ep{constructor(){super();this.Qza=this.request=null}}Object(m.a)(us,"ProofingConfigV2Request",Ep,[]);class vs{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(m.a)(vs,"ProofingConfigV2RequestObject",null,[]);var $p;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})($p||($p={}));Object(m.b)("ResponseStatus",$p);var oo=d(3);class qq{constructor(a,b,c,f,l){this.mUb=a;this.qd=b;this.cYb=c;this.O7h=f;this.pxf=w.AFrameworkApplication.lcid;this.Dha=Sc.App.mode;this.oAc={};this.vXb=new Yc.a;this.I7h=l}init(){this.Rmd(this.pxf)}Rmd(a){if(!(a.toString()in this.oAc||w.AFrameworkApplication.Yg))try{this.O7h.vCi(a).continueWith(b=>{!b.result||this.vXb.Gb(a.toString())&&this.vXb.ga(a.toString())||this.Sll(a)},3)}catch(b){ha.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}Sll(a){var b=new Bk.a;const c=ab.a.He(a).name,f=ab.a.He(this.pxf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new us,{request:new vs(a,this.Odj(),c,f,this.cYb.descriptors),activity:this.qd.eq(C.a.efl),Qza:b,yZc:Object(H.a)(this,this.Tpc,"processSuccessResponse"),kZc:Object(H.a)(this,this.Rpc,"processFailResponse")}),this.vXb.$(a.toString(),!0),this.mUb.Xx(2,Nd.c(b.request),b))}Tpc(a,b){if(!a||!a.request)return!1;this.vXb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.oAc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=Nd.a(b)}catch(f){ha.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?$p[c.ResponseStatus]:"EmptyResponse",ha.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.I7h.filter(b);
ha.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.oAc[a.request.Lcid.toString()]=b;return!0}Rpc(a){a&&(a.request&&this.vXb.$(a.request.Lcid.toString(),!1),a.Qza.Ng(!1),ha.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return oo.Task.ut(this.oAc[a.toString()])}Odj(){const a=
Pc.a[this.Dha];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(m.a)(qq,"ProofingConfigV2Manager",null,[1343]);class In{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new In,{Name:a,Value:b})}static Bje(){Object.assign(new In,{Name:"IsCompliant",Value:void 0});Object.assign(new In,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new In,{Name:"IsGoLocal",Value:void 0})}}Object(m.a)(In,"Descriptor",null,[]);class ws{constructor(a,b){this.UAa=[];this.Ma=
a;this.Yhf=b}get descriptors(){if(!this.UAa.length)try{this.Bje()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);ha.ULS.sendTraceTag(33952285,375,10,b)}return this.UAa}Bje(){Array.clear(this.UAa);var a=this.Ma.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.UAa,Object.assign(new In,{Name:"IsGoLocal",Value:this.Ma.ka("IsGoLocalEnvironment").toString()}));Array.add(this.UAa,Object.assign(new In,{Name:"IsCompliant",Value:a}));
if(this.Yhf.nse||this.Yhf.DVa)a=this.Ma.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.UAa,Object.assign(new In,{Name:"LicenseType",Value:a}));this.koi();this.roi()}roi(){var a=Nd.b(this.Ma.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.UAa,Object.assign(new In,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.UAa,Object.assign(new In,{Name:"Origin",Value:a}))}koi(){const a=
this.p7i(this.Ma.Ha("FlightId"));let b;0<a.length&&(b=Ub.a.join(a,";"),Array.add(this.UAa,Object.assign(new In,{Name:"FlightIds",Value:b})),ha.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}p7i(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(m.a)(ws,"ProofingDescriptors",null,[1338]);class rq{constructor(a,b){this.DVa=this.OAb=this.sPd=!1;this.eMd=this.dMd=
0;this.PFc=a.ka("ProofingWithEditorServiceIsEnabled");this.i1h=a.ka("GrammarCheckIsEnabled");this.hWa=a.ka("ProofingSettingIsEnabled");this.Fqe=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.PCc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.Hci=a.ka("WritingStyleIsEnabled");this.c_h=a.ka("DoNotCheckThisIssueEnabled");this.V2h=a.ka("IgnoreProofingCommandIsEnabled");this.Sua&&(this.sPd=!1,b.execute(()=>{this.sPd=!0}));2===this.xga?(this.eMd=2,
this.dMd=3):(this.eMd=a.uc("NumberOfWordsToProofAroundModifiedRanges",1),this.dMd=a.uc("NumberOfWordsAsContextAroundProofedRanges",0))}get Vqg(){return this.V2h}get Sua(){return 2===this.xga&&this.i1h}get nse(){return this.Sua&&this.Hci}get Doe(){return this.c_h&&this.Fqe&&this.hWa}get tZj(){return this.PCc}get xga(){return this.PFc?2:0}get NDk(){return this.dMd}get a9g(){return this.eMd}get isLoaded(){return!this.PFc||!this.Sua||this.sPd}}Object(m.a)(rq,"ProofingFeatureConfiguration",null,[1414]);
class sq extends Ep{constructor(){super();this.request=null}}Object(m.a)(sq,"ProofingFeedbackLoopRequest",Ep,[]);class tq{constructor(a,b,c){this.mUb=a;this.qd=b;this.cYb=c}Wll(a){a.Descriptors=this.cYb.descriptors;a=Object.assign(new sq,{request:a,activity:this.qd.eq(C.a.tml),yZc:Object(H.a)(this,this.Tpc,"processSuccessResponse"),kZc:Object(H.a)(this,this.Rpc,"processFailResponse")});this.mUb.Xx(1,Nd.c(a.request),a)}Tpc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}Rpc(a){a&&(ha.ULS.sendTraceTag(38847138,
375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(m.a)(tq,"ProofingFeedbackLoopManager",null,[1413]);class Uo extends Ep{constructor(){super();this.Qza=this.request=null}}Object(m.a)(Uo,"ProofingLanguageInfoRequest",Ep,[]);class Dr{constructor(a){this.AppId=a}}Object(m.a)(Dr,"ProofingLanguageInfoRequestObject",null,[]);class Zn{constructor(a,b){this.mUb=a;this.qd=b;this.Dha=Sc.App.mode;this.Sqa=new Eb.ScriptSharpLegacyMap;this.Jha=null;this.h6a=0}vCi(a){if(this.Sqa.Gb(a))return oo.Task.ut(!0);
this.c_e();return this.Jha.CWRCo(()=>!!this.Jha.result&&this.Jha.result.Gb(a),3)}wCi(a,b){if(this.Sqa.Gb(a))return oo.Task.ut(this.Wdg(a,b));this.c_e();return this.Jha.CWRCo(()=>this.Wdg(a,b),3)}yhj(a){if(0<this.Sqa.count)return oo.Task.ut(this.L7f(a));this.c_e();return this.Jha.CWRCo(()=>this.L7f(a),3)}Yel(){const a=new Bk.a;w.AFrameworkApplication.Yg&&a.Ng(null);const b=Object.assign(new Uo,{request:new Dr(Pc.a[this.Dha]+"_Online"),activity:this.qd.eq(C.a.ffl),Qza:a,yZc:Object(H.a)(this,this.Tpc,
"processSuccessResponse"),kZc:Object(H.a)(this,this.Rpc,"processFailResponse")});this.mUb.Xx(0,Nd.c(b.request),b);this.h6a+=1;return a.task}Tpc(a,b){let c=null;if(!a)return!1;try{c=Nd.a(b)}catch(l){ha.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=ab.a.He(f.LanguageId))&&0!==f.SupportedTextUnit&&this.Sqa.$(b.LCID,f);a.Qza.Ng(this.Sqa);
a.endActivity("RequestSucceeded");return!0}a.Qza.Ng(null);f=c?$p[c.ResponseStatus]:"EmptyResponse";ha.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}Rpc(a){a&&(a.Qza.Ng(null),ha.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}Wdg(a,b){if(!this.Sqa||!this.Sqa.Gb(a))return 0;a=this.Sqa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.nkj(b,a)}nkj(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}L7f(a){const b=new Oa.a;if(!this.Sqa)return b;for(let c of this.Sqa)c.value.SupportedCritiqueTag&
a&&b.add(c.key);return b}c_e(){if(!this.Jha||5===this.Jha.status||4===this.Jha.status||6===this.Jha.status&&!this.Jha.result)this.Jha=this.Yel(),ha.ULS.sendTraceTag(38319180,375,1===this.h6a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.h6a,this.h6a)}}Object(m.a)(Zn,"ProofingLanguageInfoManager",null,[1412]);class At{constructor(a,b){this.P3h=a;this.grb=b}track(a,b=null){this.P3h&&this.grb.track(a(),b)}}Object(m.a)(At,"ProofingMetricsAggregator",null,[1342]);
class rm{wAf(a,b){a&&zb.ParagraphReader.fe(a)&&!Ub.a.Xa(b)&&(ul.d(b),a.iRb=ul.e(a.iRb,b))}WVl(a,b,c){if(b){var f=a.Lb;a=a.node.iRb;for(let y=0;y<a.length;y++){var l=a[y];const G=l.begin;l=l.end;0>b?l>c&&(G>=f?a[y]=new Lk.a(G+b,l+b):G>=c&&l<=f?(Array.removeAt(a,y),y--):a[y]=new Lk.a(G<c?G:c,l<=f?c:l+b)):a[y]=new Lk.a(G>f?G+b:G,l>f?l+b:l)}}}}Object(m.a)(rm,"UnsupportedLanguageRangeEditor",null,[1411]);var Jm=d(1313),kf=d(474),Er=d(239),u=d(457),P=d(1126),la=d(677);class Ca{constructor(){this.Zy=this.P0a=
null}}Object(m.a)(Ca,"ClientRequestManagerStateObject",null,[]);class Ta{constructor(a,b){this.request=a;this.response=b}}Object(m.a)(Ta,"SpellCheckRequestResponseTuple",null,[]);class pb{constructor(){this.mSh=0;this.ZSf=this.yoa=this.paragraphNode=this.range=null;this.userAction=0;this.PF=null;this.xga=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}grg(){const a=zb.ParagraphReader.text(this.paragraphNode);if(!a||!this.yoa)return a===this.yoa;let b=this.range.begin,c=this.range.end;return na.a.zWd(a.substring(b,
c),this.yoa.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.grg()}}Object(m.a)(pb,"SpellCheckRequest",null,[]);var Sb=d(676),Cc=d(859),ed=d(860);class ad{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd){this.bSd=new Ma.a;this.QXb=[];this.aBc=0;this.lGc={};this.Qba=null;this.Cef=Number.POSITIVE_INFINITY;this.Yzc=0;this.c8=ad.Jbb;this.a6a=null;this.BHc=0;this.esb=[];this.vAc=null;this.D8h=!1;this.tXb=[];this.bOd=[];this.J7h=0;this.N7h=c.ka(ad.xZk);this.S7h=c.ka(ad.EZk);
this.K7h=c.appSettings[ad.vZk];this.H7h=c.ka(ad.uZk);this.R7h=c.ka(ad.CZk);this.qI=f;this.Dha=Sc.App.mode;this.Tm=a;this.$z=b;this.a_b=za;this.ji=l;this.j5h=c.uc(ad.AZk,ad.zZk);this.P7h=Cb;this.Mk=y;this.rf=G;this.VK=R;this.aL=ja;this.GNd=Va;this.NFc=hb;this.ki=new Jm.a;this.M7h=c.ka(ad.wZk);this.MFc=ic;this.yZk=yc;this.jTc=lc;this.PFc=c.ka(ad.DZk);this.cYb=ec;this.G7h=jc;this.$ob=xd;this.r7=Xd;this.ae=Qd}get Zeh(){return this.tXb}set Zeh(a){this.tXb=a}get MUc(){return w.AFrameworkApplication.Yg}get a4b(){return this.$ob.instance}suspend(){this.BHc++}resume(){if(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",
!1)&&Object(Rd.a)("ALV2SpellingEnabled"))ha.ULS.sendTraceTag(508913506,324,15,"Paragraph legacy proofing hit");else if(0>=--this.BHc&&(this.BHc=0,0<this.esb.length&&!this.vAc)){const a=this.r7.isCompleted(4)?0:1;this.vAc=new pd.a(a,1,1,Object(H.a)(this,this.xEl,"spellCheckSuspendedNodes"),74);this.ae.Hb(this.vAc)}}xEl(){this.vAc=null;const a=Ub.a.clone(this.esb);Array.clear(this.esb);Date.now();let b=null;for(const c of a)b=this.WNh(c,!0,b);b&&b.dispose();this.D8h||Date.now()}oS(a,b=!1){(a=this.WNh(a,
b,null))&&a.dispose()}WNh(a,b,c){switch(this.Kta(a,b)){case 1:Ub.a.contains(this.esb,a)||Array.add(this.esb,a);break;case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}Kta(a,b){return!a||this.MUc||!this.qI.Ld.isEditingAllowed&&!this.qI.Ld.xz?0:!b&&0<this.BHc||!this.jTc.isLoaded?1:!zb.ParagraphReader.fe(a)||!a.isConnected||a.anchor.vJ||a.ioe||a.nX||a.KC?3:this.Qba&&Ub.a.any(this.Qba,c=>c.paragraphNode===a)?0:Ub.a.any(this.QXb,c=>c.paragraphNode===
a)||!this.rf.Pt(this.VK.Lc(a))?3:2}doSpellCheck(a,b){const c=(za,Va)=>{this.$z.Mtd(za,Va)};var f=this.aL.WVc(a);let l=0<f.length;b=this.PSe(b,a,f,c);(f=this.MFc.J7i(a))&&this.lQi(a);const y=this.MFc.Voj(a,f),G=zb.ParagraphReader.text(a),R=a.RVb,ja=[];for(let za=y.length-1;0<=za;za--){const Va=y[za];Va.begin!==Va.end&&(this.bSd.contains(Va.lcid)?Array.add(ja,Va):(this.vMi(a,G,f,Va,R),Array.removeAt(y,za)))}l=0<ja.length||0<y.length||l;b=this.PSe(b,a,ja,Object(H.a)(this.a_b,this.a_b.wAf,"addUnsupportedRanges"));
b=this.PSe(b,a,y,c);l&&this.MFc.HPh(a);return b}ke(a){const b=this.Mk.ke(7,C.a.Mzd);b.ld(a);return b}PSe(a,b,c,f){Ub.a.Xa(c)||(a=a||this.ke(b),f(b,c));return a}lQi(a){const b=new pd.a(4,1,500,Object(H.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.ae.Hb(b)}PCk(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.yoa.length+b.paragraphNode.id;this.lGc[b]=(this.lGc[b]||0)+1;this.aBc=Math.max(this.lGc[b],this.aBc);return this.aBc>ad.Zyk?(ha.ULS.sendTraceTag(22390425,
324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.aBc=0,this.lGc={},this.$z.oNc(a),!1):!0}vMi(a,b,c,f,l){const y=new pb;y.mSh=w.AFrameworkApplication.lcid;y.yoa=b;y.range=f;y.paragraphNode=a;y.ZSf=c;y.userAction=l?1:0;const G=this.jTc.hWa;G&&this.a4b&&(y.overriddenCritiqueTypeOptions=this.a4b.Cae());this.PCk(a,y)&&this.Exj(y.range.lcid,y.range.textUnit).continueWith(R=>{R=R.result;y.xga=2===this.jTc.xga?0!==R?2:0:this.J7h;y.range.textUnit=R;y.descriptors=this.cYb.descriptors;
this.s1i(y);G&&2===y.xga&&this.G7h.Rmd(y.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}Exj(a,b){return 2===this.jTc.xga?this.yZk.wCi(a,b):oo.Task.ut(b)}s1i(a){a.PF=new Date;Array.enqueue(this.QXb,a)}recheckParagraphTask(a){this.oS(a.customData)}executeNextRequest(){if(!this.MUc&&!this.Qba){var a=[];do{if(!this.QXb.length)break;const b=Array.dequeue(this.QXb);b.isValid()&&Array.add(a,b)}while(a.length<this.j5h);0>=a.length?(this.Qba=null,this.yEl()):(this.Qba=a,this.Qba.sort((b,c)=>
+b.PF-+c.PF),a=this.Qba[0],this.NFc.track(+new Date-+a.PF,"ProofingRequestInQueue."+Sb.a[a.userAction]),this.executeRequest(this.Qba))}}yEl(){for(var a=0;a<this.tXb.length;a++)(0,this.tXb[a])();Array.clear(this.tXb);for(a=0;a<this.bOd.length;a++)(0,this.bOd[a])();Array.clear(this.bOd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=la.a.Puj(this.N7h,a[c],this.Dha,this.S7h,this.R7h,this.H7h,this.K7h,this.PFc);Array.add(b,f)}b=Cc.a.IJi(b,Sc.App.mode);this.ji.qj(this.GNd(),
2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(H.a)(this,this.vEl,"spellCheckSucceeded"),Object(H.a)(this,this.uEl,"spellCheckFailed"),Object.assign(new Ca,{P0a:a,Zy:this.ki.Ii("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}vEl(a){if(!this.MUc){a=a.data;this.NFc.track(a.state.Zy.er,"ProofingRequestRoundtrip");var b=this.ki.Ii("DOMUpdate","Proofing");this.wEl(a);this.NFc.track(b.er,"UpdateProofingResults")}}wEl(a){kf.a.mark(7798);this.Qba=null;var b=a.state.P0a;
if(({group:c}=ed.a.UMh(a.Wd)).returnValue){var c=c.Responses;var f=({whl:b,bnl:c}=this.vxj(b,c)).returnValue;if(0<f.length){const l=this.ke(f[0].request.paragraphNode);try{for(const y of f){const G=y.request;this.qI.u1i(G.paragraphNode,()=>{this.Byk(y.response,G)})}}finally{l&&l.dispose()}}b.length?(this.qXd(a),this.zSe(b),this.w6d()):this.Qfl();this.qXd(a);for(const l of c)Er.PageStats.P_b(l);this.w6d();this.executeNextRequest()}else this.zSe(b);kf.a.mark(7799)}vxj(a,b){let c,f;const l=[];c=[];f=
[];for(let y=0;y<a.length;y++){const G=a[y];if(!G.paragraphNode.isConnected)continue;const R=b[y];if(5===R.classId){const ja=R.Fault;if(ja)switch(ja.Type){case 1:ha.ULS.sendTraceTag(22390429,324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.Cef,ja.Limit,ja.AttemptedValue);this.Cef=ja.Limit;break;default:ha.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(G)}else l.push(new Ta(G,R));R.ServerPageStatsTrace&&
f.push(R.ServerPageStatsTrace)}return{returnValue:l,whl:c,bnl:f}}Byk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.KC)this.executeNextRequest();else{var f=this.ke(c),l=this.P7h.pgl(a);if(b.grg()){var y=b.range;const G=[y];l.Zqd(a)?(y=ul.a(this.Tm.VF(c)),1!==b.userAction&&c.Lpi()&&this.M7h&&(a=l.K1f(a,b,y)),this.$z.Mtd(c,G,b.ZSf),a=l.U4i(a,b,y),this.Tm.dzf(c,a)):this.YJj(c,y);this.MFc.HPh(c)}c.rtc();f.dispose();this.oS(c)}else this.executeNextRequest()}YJj(a,b){const c=[b];b=b.lcid;this.bSd.contains(b)||
(ha.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.bSd.add(b));this.$z.Mtd(a,c);this.a_b.wAf(a,c)}uEl(a){a=a.data;if(!this.MUc){var b=a.state;this.NFc.track(b.Zy.er,"ProofingRequestRoundtrip");this.zSe(b.P0a);this.qXd(a);this.w6d()}}zSe(a){this.Qba=a;a=new pd.a(3,1,this.c8,Object(H.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.ae.Hb(a);++this.Yzc;this.c8*=ad.XYe;this.c8>ad.Olc&&(this.c8=ad.Olc);4!==this.Yzc||this.ji.fGa||(this.a6a=Sc.App.Mb.notificationBar.wDa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,
!0),Sc.App.Mb.notificationBar.li(this.a6a),w.AFrameworkApplication.Ci.Gbb(ad.TUh,1),ha.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),this.ji.uJc(this))}Qfl(){this.Yzc&&(this.Yzc=0,this.c8=ad.Jbb);this.a6a&&(Sc.App.Mb.notificationBar.removeEntry(this.a6a),this.a6a=null,this.ji.Ypd(this))}retryCurrentRequest(){this.executeRequest(this.Qba)}EIb(){Sc.App.Mb.notificationBar.removeEntry(this.a6a);this.a6a=null;this.ji.Ypd(this)}Emc(){}get xre(){return!this.esb.length&&!this.Qba&&!this.QXb.length}qXd(a){Er.PageStats.Y7a("SpellCheck",
a.Is);(a=a.Dj?a.Dj[u.a.M3]:null)&&Er.PageStats.r7a(P.a.Qh,a)}w6d(){Er.PageStats.fEa("SpellCheck")}}ad.AZk="ProofingRequestsBatched";ad.zZk=1;ad.uZk="ProofingContextualResultsIsEnabled";ad.CZk="ProofingTrackMetricsIsEnabled";ad.xZk="ProofingInstrumentedAndContextualIsEnabled";ad.EZk="ProofingWithOneSpellerIsEnabled";ad.vZk="ProofingExperimentId";ad.DZk="ProofingWithEditorServiceIsEnabled";ad.wZk="ProofingFilterSpellCheckResultIsEnabled";ad.TUh=11093;ad.Zyk=30;ad.Jbb=1E3;ad.XYe=5;ad.Olc=72E6;Object(m.a)(ad,
"ProofingCheckOperator",null,[355,1410]);var Zd=d(532);class We{constructor(a){this.grb=a}U4i(a,b,c){if(this.QYe(a)){const f={};a=this.t0f(b,a,c,f);this.kni(b,f);return a}b&&this.lni(b);return[]}kni(a,b){this.grb.track(()=>Object.assign(new Zd.a,{E:a.xga,C:a.range.GZd,F:b}))}lni(a){this.grb.track(()=>Object.assign(new Zd.a,{E:a.xga,C:a.range.GZd}))}Wrg(a,b,c){return!a||Ub.a.all(a,f=>f.begin!==b||f.end!==c)}Bvg(a,b,c){return!!a&&Ub.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(m.a)(We,"AProofingResultsManager",
null,[1435]);var Qf=d(531),Af;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(Af||(Af={}));Object(m.b)("ProofingType",Af);class Ph extends We{constructor(a,b,c,f=null){super(a);this.Ma=f;this.P_h=b;this.BN=c}Zqd(a){return a&&63===a.classId?!0:(ha.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}QYe(a){return this.Zqd(a)&&!!a.Critiques&&
0<a.Critiques.length}t0f(a,b,c,f){const l=[];b=b.Critiques;for(const R of b)if(this.hLj(b,R)&&this.jwl(R)){var y=0<=a.range.Kaa?a.range.Kaa+R.Start:a.range.begin+R.Start;const ja=y+R.Length;var G=a.yoa.substring(y,ja);const za=this.P_h.create(R,this.grb,this.Ma);za.lcid=a.range.lcid;za.token=G;za.originalText=a.yoa;za.Kaa=a.range.Kaa;za.AKa=a.range.AKa;a.range.end>=ja&&(G=new ef(y,ja,za),Array.add(l,G));this.Wrg(c,y,ja)&&(y=1===za.proofingType?Af[za.proofingType]:za.typeId,f[y]=y in f?f[y]+1:1)}return l}K1f(a,
b,c){if(!this.QYe(a))return a;const f=[];for(const l of a.Critiques){const y=0<=b.range.Kaa?b.range.Kaa+l.Start:b.range.begin+l.Start;this.Bvg(c,y,y+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}jwl(a){return 2!==Qf.b(a)||!this.BN.DVa}hLj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(m.a)(Ph,"ProofingCheckResultsManager",We,[]);var pf=d(50),He=d(95);class Yf{constructor(a,b,c,f,l,y,G){this.lHd=
!1;G&&c.MI(Object(H.a)(this,this.K4k,"recheckAllParagraphs"));b.Phi(Object(H.a)(this,this.AEk,"onAfterParagraphMerge"));l&&l.zd(12).p8(Object(H.a)(this,this.hKk,"onParagraphDisconnected"));this.$z=a;this.bYb=f;this.Tm=y}hKk(a,b){zb.ParagraphReader.fe(b.node)&&this.Tm&&this.Tm.Iid(b.node)}AEk(a,b){this.$z.Ymi(b);this.oS(b.D4d.currentNode)}Lac(a){this.$z.zrl(a);this.oS(a)}K4k(a){if(2===a.mode&&(a=this.keg(a)))for(a=He.a.gA(a);a.moveNext();)zb.ParagraphReader.vl(a.iterator)&&this.oS(a.currentNode)}suspend(){this.bYb.suspend()}resume(){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",
!1)&&Object(Rd.a)("ALV2SpellingEnabled")||this.bYb.resume()}get xre(){return this.bYb.xre}get W2e(){return this.lHd}set W2e(a){if(this.lHd!==a&&(this.lHd=a,a=this.keg(Sc.App.Mb))){var b=new pf.GraphTransaction(2);try{b.set(a.hk);const c=He.a.gA(a);for(;c.moveNext();)zb.ParagraphReader.vl(c.iterator)&&c.currentNode.Kv(16,!0)}finally{b&&b.dispose()}}}keg(a){return(a.Ld.isEditingAllowed||a.Ld.xz)&&a.Ld.Rn.Go?a.Ld.Rn.Ag:null}lgi(a){Array.add(this.bYb.Zeh,a)}oS(a){this.bYb.oS(a,!1)}}Object(m.a)(Yf,"ProofingManager",
null,[1341]);var Rg=d(1262),$i=d(675);class jk extends $i.a{constructor(a){super(a);this.yZb=null}get proofingType(){return 1}get suggestions(){return this.yZb?Array.clone(this.yZb):null}wtl(a){this.yZb=a}XMa(a,b=0){this.rsf.track(()=>Object.assign(new Zd.a,{E:0,T:1,A:a,I:b}))}}Object(m.a)(jk,"OfficeSpellerErrorDetails",$i.a,[]);class fj extends We{constructor(a){super(a)}Zqd(a){return!!a.Errors}QYe(a){return this.Zqd(a)&&0<a.Errors.length}t0f(a,b,c,f){let l=0;const y=[],G=b.Errors;for(let za=0;za<
G.length;za++){var R=G[za],ja=Object.assign(new jk(this.grb),{token:R.Word,errorType:R.Type,lcid:a.range.lcid});ja.wtl(Rg.a.HSh(b.Suggestions,za*Rg.a.hwg));const Va=R.Offset+a.range.begin;R=Va+R.Word.length;ja=new ef(Va,R,ja);Array.add(y,ja);this.Wrg(c,Va,R)&&l++}f.spelling=l;return y}K1f(a,b,c){if(Ub.a.Xa(c)||!a)return a;const f=[],l=[];for(let G=0;G<a.Errors.length;++G){const R=a.Errors[G];var y=R.Offset+b.range.begin;this.Bvg(c,y,y+R.Word.length)&&(y=G*Rg.a.hwg,Array.add(f,Rg.a.aak(a.Suggestions,
y)),Array.add(f,Rg.a.HSh(a.Suggestions,y)),Array.add(l,R))}a.Suggestions=f;a.Errors=l;return a}}Object(m.a)(fj,"ProofingResultsManager",We,[]);class Mk{constructor(a,b,c){this.OFc=new Qe.a;this.Vff=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.OFc.add(63,c.value);this.OFc.add(4,this.Vff)}pgl(a){if(this.OFc.Gb(a.classId))return this.OFc.ga(a.classId);ha.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.Vff}}Object(m.a)(Mk,"ProofingResultsManagerResolver",
null,[1340]);class Tk{constructor(a=null,b=null){this.aE=this.hd=null;this.PRd=a;this.QRd=b}get Xf(){!this.hd&&this.PRd&&this.PRd.instance&&(this.hd=this.PRd.instance.instance);return this.hd}get Twc(){!this.aE&&this.QRd&&this.QRd.instance&&(this.aE=this.QRd.instance.instance);return this.aE}k8i(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:
c}R7i(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}HVa(a){return a.properties.sa(Ya.a.HVa,!1)}Q1f(a){a=zb.ParagraphReader.text(a);let b;const c=[];for(;b=Tk.oOj.exec(a);)Array.add(c,new Lk.a(b.index+b[1].length,b.index+b[0].length));return c}R1f(a,b=!0,c=!1){let f=[],l=!1,y=!1,G=!1,R=!1,ja=-1;a=a.Sa;for(let Va=0;Va<a.length;Va++){var za=a.ga(Va);za.hyperlink?
y=!0:za.Cn&&(y=!1);b&&za.formatting&&(G=za.formatting.cache.dWa);if(c&&(za.eM&&(R=!1),za.aq)){const hb=Object(sa.a)(344,za.aq.Fh);hb&&(R=hb.uFa)}l!==(y||G||R||!!za.blob)&&(za=za.cp,l?Array.add(f,new Lk.a(ja,za)):ja=za,l=!l)}l&&(b=Lk.a.createTextRange(ja,a.last.cp))&&Array.add(f,b);return f}WVc(a,b=!0,c=!1){return ul.e(this.Q1f(a),this.R1f(a,b,c))}H6b(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return Lk.a.createTextRange(b,
c)}IYc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=Tk.l6f(a,b,c);for(var l=0;l<f.length;l++){var y=f[l];if(a<y.begin)break;a<y.end&&(a=Tk.l6f(y.end,b,c))}b=Tk.H8f(b,c);for(l=f.length-1;0<=l;l--){y=f[l];if(b>y.end)break;b>y.begin&&(b=Tk.H8f(y.begin,c))}return(a=Lk.a.createTextRange(a,b))&&a.S9j()?a:null}static l6f(a,b,c){for(;a<b&&na.a.yz(c.charCodeAt(a));)a++;return a}static H8f(a,b){for(;0<a&&Tk.fXj(a,b);)a--;return a}static fXj(a,b){a=b.charAt(a-1).toString();return a===
Kf.AParagraphNode.ORc||a===Kf.AParagraphNode.L_}}Tk.oOj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)","ig");Object(m.a)(Tk,"ProofingTextUtility",null,[1371]);class Uk{constructor(){this.Ea=null}get name(){return"Box4.Proofing"}Xb(a){this.Ea=a;this.Ea.register(Cr,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").na().oa(()=>new Cr(this.Ea.resolve("Box4.IParagraphReader"),M.a.instance.ga(14),M.a.instance.ga(70)));this.Ea.register(Zp,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").na().oa(()=>
new Zp(this.Ea.resolve("Box4.Proofing.IErrorRangeEditor"),this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),this.Ea.resolve("Box4.ISelectionManager"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),w.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),w.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Ea.register(rm,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").na().oa(()=>new rm);this.Ea.register(To,
"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").na().oa(()=>new To(Br.a.instance,this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Ea.Ia("Box4.Proofing.IProofingSentenceSeparator")));this.Ea.register(gp,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").na().oa(()=>new gp(this.Ea.resolve("Box4.Proofing.IErrorRangeEditor"),this.Ea.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Ea.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Ea.resolve("Box4.Graph.IGraphIteratorFactory"),this.Ea.resolve("Box4.ILanguageReader"),this.Ea.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),Yk.a.instance,this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Ea.Ia("Box4.Proofing.IProofingSentenceSeparator")));this.Ea.register(Tk,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").na().oa(()=>
new Tk(this.Ea.Ia("Box4.TrackChange.ITrackChangeManagerFactory"),this.Ea.Ia("Box4.TrackChange.ITrackChangeReaderFactory")));const b=()=>{const c=w.AFrameworkApplication.fa.Ha("ProofingWebServiceBase");return(void 0===c?Sc.App.webServiceBase:c)+"proofing.ashx?"+w.AFrameworkApplication.Pg};this.Ea.register(Yq,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").na().oa(()=>new Yq(w.AFrameworkApplication.Je,b));this.Ea.register(Zn,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").na().oa(()=>
new Zn(this.Ea.resolve("Box4.Proofing.IEditorServiceRequestManager"),cc.a.instance));this.Ea.register(tq,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").na().oa(()=>new tq(this.Ea.resolve("Box4.Proofing.IEditorServiceRequestManager"),cc.a.instance,this.Ea.resolve("Box4.Proofing.IProofingDescriptors")));this.Ea.register(rq,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").na().oa(()=>new rq(w.AFrameworkApplication.fa,
this.Ea.Ia("Box4.Proofing.IProofingSentenceSeparator")));this.Ea.register(1338,"Box4.Proofing.IProofingDescriptors").na().oa(()=>new ws(w.AFrameworkApplication.fa,this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Ea.register(ad,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").na().oa(()=>new ad(this.Ea.resolve("Box4.Proofing.IErrorRangeEditor"),this.Ea.resolve("Box4.Proofing.IModifiedRangeEditor"),w.AFrameworkApplication.fa,Sc.App.Mb,w.AFrameworkApplication.Je,
this.Ea.resolve("Box4.Graph.IGraphTransactionFactory"),hi.a.instance,this.Ea.resolve("Box4.Graph.IGraphIteratorFactory"),this.Ea.resolve("Box4.Proofing.IProofingTextUtility"),this.Ea.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,Yp.a.ZW(4,1,new zt),this.Ea.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Ea.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Ea.resolve("Box4.Proofing.IProofingLanguageInfoManager"),
this.Ea.resolve("Box4.Proofing.IProofingDescriptors"),this.Ea.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.Ea.Ia("Box4.Proofing.ICritiqueTypeSettings"),Sd.a.get_instance(),w.AFrameworkApplication.De));this.Ea.register(fj,"Box4.Proofing.ProofingResultsManager").na().oa(()=>new fj(this.Ea.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Ea.register(1339,"Box4.Proofing.IIgnoreAllKeywords").na().oa(()=>new ss);this.Ea.register(Ph,"Box4.Proofing.ProofingCheckResultsManager").na().oa(()=>
new Ph(this.Ea.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.Ea.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Ea.resolve("Box4.Proofing.IProofingFeatureConfiguration"),w.AFrameworkApplication.fa));this.Ea.register(1340,"Box4.Proofing.IProofingResultsManagerResolver").na().oa(()=>new Mk(w.AFrameworkApplication.fa,this.Ea.resolve("Box4.Proofing.ProofingResultsManager"),this.Ea.ue("Box4.Proofing.ProofingCheckResultsManager")));
this.Ea.register(1341,"Box4.IProofingManager").na().oa(()=>new Yf(this.Ea.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Ea.resolve("Box4.IParagraphEditor"),this.Ea.resolve("Box4.IAppFrame"),this.Ea.resolve("Box4.Proofing.IProofingCheckOperator"),this.Ea.rb("Box4.INotebookManager").AV,this.Ea.rb("Box4.Proofing.IErrorRangeEditor"),4!==Sc.App.mode));this.Ea.register(1342,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").na().oa(()=>new At(w.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),
Yp.a.ZW(15,1,new no)));this.Ea.register(1343,"Box4.Proofing.IProofingConfigV2Manager").na().oa(()=>new qq(this.Ea.resolve("Box4.Proofing.IEditorServiceRequestManager"),cc.a.instance,this.Ea.resolve("Box4.Proofing.IProofingDescriptors"),this.Ea.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Ea.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Ea.resolve("Box4.IProofingManager")}dispose(){}static main(){n.a.instance.Ac(new Uk)}}Object(m.a)(Uk,"Box4ProofingPackage",
null,[2,3]);var uh=d(178);class Ri{constructor(a){this.j8e=0;this.vbb=this.ZKb=this.wmb=null;this.pba=w.AFrameworkApplication.Aa.BV;this.UQ=a;this.UQ.Nu(ma.a.Tyh);this.UQ.fC(ma.a.Tyh,Object(H.a)(this,this.QKk,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.vbb)return ha.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.vbb;this.wmb=this.pba.Ii("ComponentAttach","getCustomAuthConfig");return this.vbb=new Promise((a,b)=>{const c={};let f=!1,l=!1,y=0;this.j8e=window.setInterval(()=>
{4>y?(y++,this.UQ.sendMessage(ma.a.getCustomAuthConfig,c)):(window.clearInterval(this.j8e),f=!0,ha.ULS.sendTraceTag(588087303,344,10,Nd.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.ZKb=(G,R)=>{window.clearInterval(this.j8e);f||l||(l=!0,G?(ha.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(G)):(ha.ULS.sendTraceTag(589050654,369,10,Nd.c({["error"]:R.toString()})),b(R)))};this.UQ.sendMessage(ma.a.getCustomAuthConfig,c)})}QKk(a){try{const b=
Nd.a(a.Values[uh.a.uyi]);let c=w.AFrameworkApplication.fa.Ha("Application")||"";c=na.a.ug(c);b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.wmb&&(this.wmb.stop(),this.wmb=null);
this.ZKb(b,"")}catch(b){ha.ULS.sendTraceTag(589050655,344,10,Nd.c({["error"]:b.message,["stack"]:b.stack})),this.ZKb(null,b.message)}}}Object(m.a)(Ri,"AccountSwitchingManager",null,[1398]);class Tj{get name(){return"Common.App.AccountSwitching"}Xb(a){a.register(Ri,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").na().oa(()=>new Ri(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){n.a.instance.Ac(new Tj)}}Object(m.a)(Tj,
"AccountSwitchingPackage",null,[2,3]);class Km{constructor(){this.Oa=new Wc.a}X_b(a){this.Oa.addHandler("OnEditHappenedEvent",a)}i1k(){this.Oa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Km,"EditNotificationEventSource",null,[]);var kk=d(93);class Vk{constructor(a,b,c,f,l,y,G=0){this.nFd=!1;this.mFd=this.K5a=null;this.jxf=!1;this.ae=b;this.JEc=a;this.LOa=c;this.Wha=f;this.hxf=l;this.q_h=y;this.cBc=0;this.eCc=!1;try{0<G&&(this.cBc=G,3E5>this.cBc&&(this.cBc=3E5),this.ae&&!this.mFd&&(this.mFd=new pd.a(3,
2,this.cBc,Object(H.a)(this,this.zel,"reportEditDocumentUserActionTelemetryIfNecessary")),this.ae.Hb(this.mFd)))}catch(R){ha.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+R)}}get jSh(){return this.jxf}a6d(){this.jSh?this.eCc=!0:(this.jxf=!0,Sf.Health.instance.addQosPillar("Save"),Sf.Health.instance.addQosPillar("ContentCreation"),kk.c(F.a.editDocument));this.nFd=!0;this.hxf&&this.hxf.Byf();this.Wha&&this.Wha.i1k();w.AFrameworkApplication.Rg&&
w.AFrameworkApplication.Rg.gyk();this.q_h&&!this.K5a&&(this.htc(null),this.K5a=new pd.a(3,2,this.JEc,Object(H.a)(this,this.htc,"sendPostMessageIfNecessary"),113),this.ae.Hb(this.K5a))}htc(){this.nFd&&(this.LOa.CWR(()=>this.LOa.result.sendMessage(ma.a.editNotification,null)),ha.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.nFd=!1)}zel(){try{this.eCc&&(kk.c(F.a.editDocument),this.eCc=!1)}catch(a){this.eCc=!1,ha.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+
a)}}}Object(m.a)(Vk,"EditNotificationManager",null,[1406]);class aq{constructor(a,b,c,f,l){this.SGd=this.K5a=null;this.Ppb=this.JBd=!1;this.ae=b;this.JEc=a;this.LOa=c;this.$P=f;this.qMd=l;this.jph(null)}jph(){const a=document.getElementById(w.AFrameworkApplication.u0b);!this.Ppb&&this.$P&&a&&(this.$P.ub(pa.a.tq,a,Object(H.a)(this,this.BKe,"mouseActivityHandler"),null),this.Ppb=!0);this.qMd(()=>{this.dispose()})}BKe(){this.Ppb&&(this.$P.Bb(pa.a.tq,document.getElementById(w.AFrameworkApplication.u0b),
Object(H.a)(this,this.BKe,"mouseActivityHandler")),this.Ppb=!1);this.Byf();return!1}Byf(){this.JBd=!0;this.SGd||(this.SGd=new pd.a(3,2,this.JEc,Object(H.a)(this,this.jph,"registerHandlerTask"),112),this.ae.Hb(this.SGd));this.K5a||(this.htc(null),this.K5a=new pd.a(3,2,this.JEc,Object(H.a)(this,this.htc,"sendPostMessageIfNecessary"),111),this.ae.Hb(this.K5a))}htc(){this.JBd&&(this.LOa.CWR(()=>this.LOa.result.sendMessage(ma.a.FWl,null)),ha.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.JBd=!1)}dispose(){this.Ppb&&(this.$P.Bb(pa.a.tq,document.getElementById(w.AFrameworkApplication.u0b),Object(H.a)(this,this.BKe,"mouseActivityHandler")),this.Ppb=!1)}}Object(m.a)(aq,"UserActivityHostNotificationManager",null,[1405,108]);var Uj=d(135),Zm=d(254);class $n{constructor(){this.Ea=null}get name(){return"Common.App.EditNotification"}init(){w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.$e(Object(H.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){$n.I_i&&0<$n.b6d&&(this.Ea.register(Km,
"Common.App.HostNotification.EditNotificationEventSource").na(),this.Ea.register(aq,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").na().oa(()=>new aq(6E4,Uj.a.instance,Zm.a.Ot(this.Ea.Ia("Postmessage.IHostPostmessenger")),ka.a.instance,w.AFrameworkApplication.$ga)),this.Ea.register(Vk,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").na().oa(()=>new Vk($n.b6d,Uj.a.instance,
Zm.a.Ot(this.Ea.Ia("Postmessage.IHostPostmessenger")),this.Ea.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Ea.rb("Common.Interface.IUserActivityHostNotificationManager"),$n.J_i,$n.G_i)),this.Ea.resolve("Common.Interface.IEditNotificationManager"),ha.ULS.shipAssertTag(38086291,209,0<$n.b6d,"EditNotification Interval is less than or equal to 0."))}Xb(a){this.Ea=a}dispose(){}static get b6d(){return w.AFrameworkApplication.fa?parseInt(w.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get G_i(){return w.AFrameworkApplication.fa?parseInt(w.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get I_i(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get J_i(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){n.a.instance.Ac(new $n)}}Object(m.a)($n,"CommonHostNotificationPackage",
null,[2,3]);class Hl{}Hl.hhd="ReactSharedHeaderMeControlFlexPane";Hl.sFa="headerui";Hl.c2b="chat_wrapper_pane";Object(m.a)(Hl,"ReactSharedHeaderConstants",null,[]);class $q{constructor(a){this.dsf=0;this.yDd=null;this.l8h=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get y2e(){return this.l8h.value}vb(){this.isInitialized?this.Fpd():this.x8k(Object(H.a)(this,this.Fpd,"registerActionsInternal"))}Fpd(){ha.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&
(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(H.a)(this,this.AFk,"onChatContainerReady"))}).catch(a=>{ha.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(H.a)(this,this.yBi,"chatCountChanged"))}).catch(a=>{ha.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(H.a)(this,this.DFk,"onChatKeyPress"))}).catch(a=>
{ha.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){ha.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}yBi(a){ha.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",a);if(!a)this.y2e.zFk();else if(1===a&&!this.dsf){const b=document.getElementById(this.yDd?this.yDd:Hl.c2b);b?this.y2e.EFk(b,Object(H.a)(this,this.BMl,"transferFocusToChat")):ha.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.dsf=a}AFk(a){this.yDd=a}DFk(a){a.ctrlKey&&
"f6"===a.key.toLowerCase()&&this.AMl(a.shiftKey)}x8k(a){Ff.a.instance.ub(pa.a.IHl,window.self,()=>{a();return!0})}BMl(){ha.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{ha.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){ha.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}AMl(a){ha.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");
this.y2e.BFk(a)}}Object(m.a)($q,"ChatManager",null,[1409]);class Fp{constructor(){this.Oa=new Wc.a;this.xwf=!1}pki(a){this.Oa.addHandler("OnTopRowControlsCreatedEvent",a)}Wji(a){this.Oa.addHandler("OnRenameTextboxStatusChangedEventKey",a)}get ULl(){return this.xwf}Z1k(){this.xwf=!1;this.Oa.raiseEvent("OnTopRowControlsDisposingEvent")}anh(a){this.Oa.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(m.a)(Fp,"HeaderEventSource",null,[]);var ar=d(206);class uq{constructor(a,
b,c,f,l){this.eIc=null;this.Pd=a;this.QK=b;this.$P=c;this.kbi=f;this.Ca=l}iph(a,b,c,f=null){const l=this.Pd.Ic(b);l.parent=c;l.zJ=!0;f&&l.Oca(f);this.$P.l8(b,a,!1);this.kbi.l8(b,a,!1);b=new ar.DOMFocusListing(()=>a);b.So(2);b.So(1);b.So(8);b.So(5);b.So(3);b.So(6);this.Pd.Aja(()=>a,l,b).GX=!0;b=x.KeyInputManager.Va(B.a.$q,0);c=x.KeyInputManager.Va(B.a.$q,4);l.hw(b);l.hw(c)}onFlexPaneOpen(a){this.iph(a,Hl.hhd,Hl.sFa);this.Pd.wf(Hl.hhd);this.QK.r3(Hl.hhd)}onFlexPaneClose(){this.QK.Eo(Hl.hhd);this.Pd.wf(Hl.sFa)}EFk(a,
b){this.eIc||(this.eIc=b,this.iph(a,Hl.c2b,D.AFrame.dE,Object(H.a)(this,this.CFk,"onChatFocus")));this.Pd.wf(Hl.c2b);this.QK.r3(Hl.c2b)}CFk(){this.eIc&&this.eIc()}zFk(){this.QK.Eo(Hl.c2b);this.Pd.kUc(D.AFrame.SW)}BFk(a){this.Ca.processAction(a?F.a.J7d:F.a.cBd,2)}}Object(m.a)(uq,"ReactSharedHeaderFocusManager",null,[1052]);var lw=d(533);class Lu{constructor(a){this.Ca=a}vb(){this.Ca.ya(F.a.xUc,ye.a.frame,Object(H.a)(this,this.I7g,"navigateToUpsellPage"));this.Ca.ya(F.a.Aaj,ye.a.frame,Object(H.a)(this,
this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.ya(F.a.Gel,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.Jsh,ye.a.frame,zf.ActionManager.Sg)}I7g(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.uae(l,"experience","gopremiumribbon"),l=ug.a.cX("2116536"),l=ug.a.JQa(l,"ocid",lw.b(w.AFrameworkApplication.Aa.mb.Ti,w.AFrameworkApplication.Aa.mb.LJa,c)),Cd.a.In(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(F.a.Jsh,2),ha.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));
return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var y=8;2===c&&(ha.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(y=Fb.a.instance.rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(a=this.uae(l,"experience","gopremium"),l=this.uae(l,"dimeCampaignId",null),y.launchUpsellExperience(a,l),y=32):(ha.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),y=this.I7g(a,b,c,f,l)));return y}uae(a,b,c){a&&a[b]&&(c=Object(sa.a)(String,
a[b]));return c}}Object(m.a)(Lu,"UpsellActor",null,[1394]);class Bt{constructor(){this.Ea=null}get name(){return"Common.App.Header"}init(){Fb.a.instance.resolve("Common.App.Header.IUpsellActor").vb();Fb.a.instance.resolve("Common.App.Header.IChatManager").vb()}dispose(){}Xb(a){this.Ea=a;this.Ea.register(Fp,"Common.App.Header.HeaderEventSource").na();this.Ea.register(Lu,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").na().oa(()=>new Lu(w.AFrameworkApplication.Qa));this.Ea.register(uq,
"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").na().oa(()=>new uq(w.AFrameworkApplication.Aa.ks,w.AFrameworkApplication.Aa.hx,w.AFrameworkApplication.Aa.tS,w.AFrameworkApplication.Aa.Zmb,w.AFrameworkApplication.Qa));this.Ea.register($q,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").na().oa(()=>new $q(this.Ea.ue("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){n.a.instance.Ac(new Bt)}}Object(m.a)(Bt,
"CommonAppHeaderPackage",null,[2,3]);class mw{constructor(a,b,c,f=null,l=null){this.BF=a;this.fVb=b;this.cVb=c;this.Vrf=f;this.YXb=l}u7d(a){const b=new Sys.StringBuilder(this.BF.Asc);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.Cde(a));b.append("&");b.append(w.AFrameworkApplication.Pg);w.AFrameworkApplication.Je.qj(b.toString(),1,null,null,!0,2,Object(H.a)(this,this.Bab,"getRequestSuccessCallback"),Object(H.a)(this,this.YEa,"getRequestFailureCallback"),
null)}GSc(a){var b=new Sys.StringBuilder(this.BF.Asc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(w.AFrameworkApplication.Pg);b=b.toString();a=Nd.c(a);w.AFrameworkApplication.Je.qj(b,2,a,null,!0,4,Object(H.a)(this,this.RUk,"postRequestSuccessCallback"),Object(H.a)(this,this.BKa,"postRequestFailureCallback"),null)}Bab(a){let b=!1,c=null;try{if(0<a.data.Wd.length){const f=Object(sa.a)(Object,Nd.a(a.data.Wd)),l=f?f[this.BF.CVd]:null;
l&&(c=Object(sa.a)(Object,Nd.a(l.toString())))}b=!0}catch(f){this.YEa(null)}b&&this.fVb&&this.fVb(a.data,c)}YEa(a){this.cVb&&this.cVb(a?a.data:null)}RUk(a){this.Vrf&&this.Vrf(a?a.data:null)}BKa(a){this.YXb&&this.YXb(a?a.data:null)}Cde(a){const b=new Sys.StringBuilder("requestedsettings=");for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(m.a)(mw,"FirstRunExperienceRequestHandler",null,[]);var Mu=d(409);class vq{constructor(){this.NUb=this.GBc=this.BF=
null}E3e(a){a?(this.BF=a,this.y2j()&&(ha.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Oa.a,a.add(this.BF.CVd),this.GBc=new mw(this.BF,Object(H.a)(this,this.Bab,"getRequestSuccessCallback"),Object(H.a)(this,this.YEa,"getRequestFailureCallback"),null,Object(H.a)(this,this.BKa,"postRequestFailureCallback")),this.GBc.u7d(a)),(this.BF.Oug||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.F3e()):ha.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}y2j(){try{if(this.BF.Oug)return!0;if(!w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||w.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;if(this.BF.iZj||this.BF.sCb||w.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=w.AFrameworkApplication.fa.Ha("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){ha.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",a?a.toString():null)}return!1}ywh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.BF.CVd]=Nd.c(c);ha.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.GBc&&this.GBc.GSc(b)}Bab(a,b){a=a?+a.fu-+a.Is:-1;a>this.BF.Vuh?ha.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
a,this.BF.Vuh):b?this.vzl(b)?(ha.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.BF.n6g),this.F3e()):(this.c5d(!1),ha.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ha.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.F3e())}YEa(a){this.c5d(!1);
ha.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.Oe:-1)}BKa(a){ha.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",a?a.Oe:-1)}F3e(){this.c5d(!0);var a=Fb.a.instance.rb("Common.ISystemInitiatedFeedback");a?this.AEh(a):(ha.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((a=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.AEh(b)}):ha.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}AEh(a){if(a){var b=this.BF.R9i;b&&(w.AFrameworkApplication.uk(b),w.AFrameworkApplication.Bdb(b));ha.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.NUb=Object(H.a)(this,this.qHk,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.NUb,!0),window.addEventListener("FRELaunchedEvent",this.NUb,!0)):(ha.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.ywh(this.BF.currentVersion))}else ha.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}qHk(a){if(a){var b=a.detail;a=a.type;var c=this.BF&&this.BF.CJf?this.BF.CJf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(ha.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.ywh(this.BF.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.NUb,!0),window.removeEventListener("FRELaunchedEvent",this.NUb,!0))}}vzl(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.BF.n6g)return!0}else if(w.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in a&&a.VersionDisplayed<this.BF.currentVersion)return ha.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}c5d(a){w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&Mu.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(m.a)(vq,"FirstRunExperienceLauncher",null,[1369]);class Nu{constructor(){this.Ea=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Xb(a){this.Ea=
a;this.Ea.register(1369,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").na().oa(()=>new vq)}init(){}dispose(){}static main(){n.a.instance.Ac(new Nu)}}Object(m.a)(Nu,"FirstRunExperienceLauncherPackage",null,[2,3]);class xs{constructor(){this.GBd={}}ldi(a){this.GBd[a.id.toString()]=a}fDk(a){const b=this.GBd;for(let c in b)b[c].notify(a,!1);this.GBd={}}o_k(a,b){b&&this.ldi(b);return this.edh(a,b)}i6d(a){this.fDk(a)}nYf(a,b){a.notify(b,!0)}}Object(m.a)(xs,"AEventEmitter",null,[1397]);
var ys;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(ys||(ys={}));Object(m.b)("EventResultState",ys);class zs{constructor(){this._state=0}get state(){return this._state}set state(a){ha.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:ys[this._state],["NewState"]:ys[a]},"ResultType",this.jcg());this._state=a}}Object(m.a)(zs,"AEventResult",null,[1431]);class nw extends zs{constructor(){super();
this.xQd=this.UXb=null;this.state=0;this.YHd=this.Kkf=!1}get ZR(){return this.UXb}get vMa(){return this.xQd}get AUj(){return this.Kkf}jcg(){return"GetMoreInfo Result"}}Object(m.a)(nw,"GetMoreInfoResult",zs,[1432,1431]);var ow=d(444),pw=d(534);class Gp{constructor(a,b,c,f,l,y,G,R){this.Ca=a;this.ji=b;this.qI=c;this.Eha=f;this.ae=l;this.bVb=y;this.p1h=G;this.yHc=R}l7k(){this.FIb.ya(F.a.HJb,ye.a.frame,Object(H.a)(this,this.HJb,"openUrlInNewTab"));this.FIb.ya(F.a.hPe,ye.a.frame,Object(H.a)(this,this.hPe,
"openDocumentUrl"));w.AFrameworkApplication.xda?this.zyg():this.FIb.ra(F.a.qRc,ye.a.frame,Object(H.a)(this,this.qRc,"documentLoaded"),96)}HJb(a,b,c,f,l){l&&l.MenuItemId&&(ha.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:pw.a[this.w1]}),Cd.a.In(l.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}hPe(a,b,c,f,l){if(l&&l.MenuItemId){const y=w.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),G=w.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");
ha.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",y,G);if(y&&G){ha.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:pw.a[this.w1]});a=l.MenuItemId.toString();const R={};R[uh.a.XLb]="1";R[uh.a.documentUrl]=a;R[uh.a.reason]=ow.a.open;ha.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");w.AFrameworkApplication.QT().execute(ja=>{ja.sendMessage(ma.a.YDa,R)})}else this.HJb(a,
b,c,f,l)}return 32}qRc(){this.zyg();return 32}Ddb(a,b,c=""){if(b&&b.Is){const f=ik.a[b.status];b=b.Is.getTime();const l=this.TF()-b;ha.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,["StartTime"]:b,["Notes"]:c})}else ha.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}zyg(){var a=w.AFrameworkApplication.fa.ka("QPGVCI"),b=ug.a.cO(document.URL,"wdNewAndOpenCt",
a);if(b){b=parseInt(b);var c=ug.a.cO(document.URL,"wdPreviousSession",a);a=ug.a.cO(document.URL,"wdPreviousCorrelation",a);var f=w.AFrameworkApplication.fa.ka("NAOPLP");if(w.AFrameworkApplication.xda){var l=w.AFrameworkApplication.xda.getTime();!b||b>l?ha.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):ha.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else ha.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get FIb(){return this.Ca.value}get Fmc(){return this.ji.value}get P7g(){return this.qI.value}get w1(){return this.Eha.value}get bid(){return this.ae.value}get TF(){return this.bVb}get aoa(){return this.p1h.value}get Eza(){return this.yHc.value}static get instance(){return Gp.La||
(Gp.La=Gp.Kr())}static Kr(){return new Gp(new vb.a(()=>w.AFrameworkApplication.Qa),new vb.a(()=>w.AFrameworkApplication.Je),new vb.a(()=>w.AFrameworkApplication.Aa),new vb.a(()=>w.AFrameworkApplication.Aa.mb.Ti),new vb.a(()=>w.AFrameworkApplication.De),()=>(new Date).getTime(),new vb.a(()=>w.AFrameworkApplication.Aa.mb.aoa),new vb.a(()=>w.AFrameworkApplication.Eza))}}Gp.La=null;Object(m.a)(Gp,"NewAndOpenCommonHelpers",null,[1396]);class qy{constructor(a,b,c){this.RGc=this.rn=null;this.AOd=0;this.B9h=
a;this.ae=b;this.cgf=c}Wmi(){this.AOd=this.TMb+1}EYe(a){this.rn&&(this.ae.Kg(this.rn),this.rn=null);a&&(this.AOd=0)}DFl(a){const b=this.YKl;0<=b?(this.Wmi(),this.EYe(!1),this.rn=new pd.a(4,1,b,a,107),this.ae.Hb(this.rn)):(this.EYe(!0),ha.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.cgf}))}get TMb(){return this.AOd}get YKl(){return this.TMb>=this.kyh.length?-1:this.kyh[this.TMb]}get kyh(){if(!this.RGc){const a=(this.B9h.value||"0").split(",");this.RGc=[];for(let b=0;b<a.length;b++){const c=
parseInt(a[b]);isNaN(c)?ha.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.cgf,["Entry"]:a[b]}):Array.add(this.RGc,c)}}return this.RGc}}Object(m.a)(qy,"RetryHelper",null,[]);class Jn extends xs{constructor(a,b){super();this.tia=a;this.yYb=new qy(b,this.emc.bid,"GetMoreInfo");this.gy=new nw}Gxk(){this.CJe("Document opened")}vPi(a){return()=>{this.CJe(a,!0)}}edh(a,b=null){ha.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:a});3===this.gy.state?(b&&this.nYf(b,this.gy),ha.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):this.CJe(a);return this.gy}CJe(a,b=!1){this.yYb.EYe(!b);1===this.gy.state?ha.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.yYb.TMb}):(ha.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.yYb.TMb}),this.gy.state=1,b=
String.format("{0}GetMoreInfoHandler.ashx?{1}",this.emc.aoa,w.AFrameworkApplication.Pg),this.emc.Fmc.qW(b,1,null,null,[Jn.Krf,Jn.Ivf],5,this.yOi(),this.xOi(a),null))}yOi(){return a=>{var b=!1;let c=!1;var f=!1,l;w.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.Wd?({Su:l}=Nd.d(a.data.Wd)).returnValue?l?(f=!0,this.gy.xQd=l.StorageServiceDisplayName,this.gy.UXb=Jn.svg(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.gy.ZR&&"SharePointOnlineConsumer"===w.AFrameworkApplication.fa.Ha("FileSource")&&
(this.gy.UXb=ug.a.Paa(w.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.gy.ZR&&""!==this.gy.vMa):ha.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):ha.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):ha.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));
f||((l=a.data.Dj)?(this.gy.xQd=(l[Jn.Ivf]||"").toString(),b=(l[Jn.Krf]||"").toString(),this.gy.UXb=Jn.svg(b)?b:"",""===this.gy.ZR&&"SharePointOnlineConsumer"===w.AFrameworkApplication.fa.Ha("FileSource")?(this.gy.UXb=ug.a.Paa(w.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.gy.ZR&&""!==this.gy.vMa):b=""===b&&""!==this.gy.vMa):(ha.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.yYb.TMb,c,b,f);this.emc.Ddb("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",a.data,f);this.xyh(3,b,c)}}xOi(a){return b=>{this.emc.Ddb("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.xyh(2);this.yYb.DFl(this.vPi(a))}}xyh(a,b=!1,c=!1){this.gy.state=a;this.gy.Kkf=b;this.gy.YHd=c;this.i6d(this.gy)}get emc(){return this.tia.value}static get instance(){return Jn.La||(Jn.La=Jn.Kr())}static Kr(){return new Jn(new vb.a(()=>Gp.instance),new vb.a(()=>w.AFrameworkApplication.bpj))}static svg(a){if(!a)return ha.ULS.sendTraceTag(5849624,
202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(na.a.ug(a).startsWith("https://"))return!0;ha.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Jn.Krf="PersonalFileStorageUrl";Jn.Ivf="StorageServiceDisplayName";Jn.La=null;Object(m.a)(Jn,"GetMoreInfoActor",xs,[]);class bq{constructor(a,b,c,f,l){this.T1h=6E4;this.ilg="inactive";this.tyf="active";this.mia=!0;this.ae=a;this.S0h=b;this.bVb=c;this.YHc=f;this.Oa=new Wc.a;l&&this.vFl();this.knf=
this.E$f()}Jyf(a){this.Oa.addHandler(this.tyf,a)}Nfi(a){this.Oa.addHandler(this.ilg,a)}vFl(){const a=new pd.a(5,2,this.T1h,Object(H.a)(this,this.mPj,"inactiveLoop"),108);this.nPj.Hb(a)}mPj(){const a=this.E$f(),b=this.TF()-a;b>this.Jxd&&this.mia&&(ha.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.mia=!1,this.Oa.raiseEvent(this.ilg));a-this.knf>this.Jxd&&(this.mia=!0,this.Oa.raiseEvent(this.tyf));this.knf=a}get nPj(){return this.ae.value}get E$f(){return this.S0h}get TF(){return this.bVb}get Jxd(){return this.YHc.value}static get instance(){return bq.La||
(bq.La=bq.Kr())}static Kr(){return new bq(new vb.a(()=>Uj.a.instance),()=>w.AFrameworkApplication.Tse.getTime(),()=>(new Date).getTime(),new vb.a(()=>w.AFrameworkApplication.Jxd),!0)}}bq.La=null;Object(m.a)(bq,"InactivityManager",null,[]);var Ct=d(938);class qw extends zs{constructor(){super();this.C5h=this.Epf=this.Dpf=null;this.state=this.twf=0;this.YHd=!1}get bLe(){return this.Dpf}get p7g(){return this.Epf}get aLl(){return this.twf}jcg(){return"MruActor Result"}}Object(m.a)(qw,"MruResult",zs,[1430,
1431]);class Dt{constructor(a,b,c){this.task=null;this.Jbb=a;this.rzk=b;this.taskManager=c;this.retryCount=this.Gac=0;this.BNd=this.xdc=null}p4j(a,b){return a===ok.a.K9d||20===b||18===b||3===b}S5j(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get ynd(){return this.BNd}reset(){this.Gac=this.retryCount=0;this.BNd=this.xdc=null;this.task&&(this.taskManager.Kg(this.task),this.task=null)}kTj(a,b,c,f){this.BNd=String.format("{0}_{1}",
c,f);if(this.retryCount>=this.rzk)return ha.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.p4j(c,f))return ha.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.S5j(f)&&1<=this.Gac)return this.xdc=c,!1;b=Math.max(b,this.Jbb*Math.pow(2,this.Gac));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.xdc||412!==this.xdc)?b=500:this.Gac+=1;this.xdc=c;this.retryCount+=1;this.task&&this.taskManager.Kg(this.task);
ha.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new pd.a(2,1,b,a,107);this.taskManager.Hb(this.task);return!0}}Object(m.a)(Dt,"RetryManager",null,[]);var br=d(224),Zg=d(69);class rw{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(rw,"WriteOptions",null,[]);class $m extends xs{constructor(a,b,c,f,l,y,G){super();this.tia=a;this.J4h=b;this.WPa=new Dt(w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.nP.bid);this.AQa=new Dt(w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.nP.bid);this.p8h=c;this.Rxf=f;this.Gci={};this.Q7=new qw;this.O0h=l;this.AEc="";this.wF=y;this.uhf=G}get TAd(){return this.Gci}v9k(){this.nP.FIb.ya(F.a.Yrh,ye.a.frame,
Object(H.a)(this,this.bdl,"renameMruEntry"))}bdl(){return this.Nbf("Rename")}Oxk(){this.U4g("File Opened")}Pxk(){this.U4g("IntervalUpdate")}U4g(a){ha.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.Nbf(a)}IQ(a){(a=na.a.IQ(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}YUc(){switch(this.nP.w1){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}hAj(a){var b=this.O0h();
if(!b)return null;const c=new rw;c.documentUrl=this.uhf.value?encodeURI(b):b;c.mruItemId=this.AEc;c.app=this.YUc();if(b=this.wF())c.folderName=b.breadcrumbFolderName,b=b.rx,c.documentName=na.a.mH(b),c.documentExt=this.IQ(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}Nbf(a,b=!1){if(4===
this.nP.w1&&!w.AFrameworkApplication.oRc)return 2;var c=br.a.fA();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.AEc?"true":"false"),c.set("URLEncoded",this.uhf.value?"true":"false"));Sf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.hAj(c);if(!a)return b=!w.AFrameworkApplication.Tnb,c&&(c.set("WebEditingIsEnabled",w.AFrameworkApplication.Tnb?"true":"false"),c.set("ProtectedFile",w.AFrameworkApplication.XE?"true":"false")),Sf.Health.instance.recordKpiFailure("WriteMru",
"MissingDocumentUrl",b,!1,Object.assign(new Ak.a,{extendedProperties:c})),2;this.AQa&&!b&&this.AQa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.nP.aoa,this.Rxg);this.Rxf?this.TAd["X-FileId"]=w.AFrameworkApplication.Pg:c+=String.format("&{0}",w.AFrameworkApplication.Pg);w.AFrameworkApplication.Md&&(this.TAd["X-Office-AudienceGroup"]=Object(sa.a)(String,w.AFrameworkApplication.Md.AudienceGroup)||"");this.TAd["X-Timeout"]=15E3;return this.nP.Fmc.qj(c,2,a,this.TAd,!0,5,Object(H.a)(this,
this.o_l,"writeMruV2EntryOnServerSuccessCallback"),Object(H.a)(this,this.$Si,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}o_l(a){this.rhg(a.data)}rhg(a){const b=br.a.fA();this.AQa&&(b&&this.AQa.ynd&&(b.set("LastError",this.AQa.ynd),b.set("NumRetries",this.AQa.retryCount.toString())),this.AQa.reset());const c=Ct.c(a.Wd);c&&c.diagnostics_data&&(this.AEc=c.diagnostics_data.mru_id);a=+a.fu-+a.Is;b&&b.set("RequestDuration",a.toString());Sf.Health.instance.recordKpiSuccess("WriteMru",
Object.assign(new Ak.a,{extendedProperties:b}))}$Si(a){if(a.data.Oe===ok.a.Y3b)this.rhg(a.data);else{var b=a.data.Oe===ok.a.Ipc,c=br.a.fA();this.Qhg(this.AQa,a,this.OSi(),c);c&&(c.set("StatusCode",a.data.Oe.toString()),b||this.qTd(a.data,c));Sf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.Oe),b,!1,Object.assign(new Ak.a,{extendedProperties:c}))}}OSi(){return()=>{this.Nbf("Retry",!0)}}hpj(){this.Ngd("Polling")}gpj(){this.Ngd("Retry",!0)}Ixk(){this.Ngd("Open")}Hxk(){this.Ngd("Activity")}Ngd(a,
b=!1){ha.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const c=br.a.fA();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"));Sf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",c);this.WPa&&!b&&this.WPa.reset();this.zOi(Object(H.a)(this,this.jpj,"getMruV2FromServerSuccessCallback"),Object(H.a)(this,this.fpj,"getMruFromServerFailureCallback"))}qTd(a,b){a&&a.Dj&&(a=a.Dj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}tfk(a,b){a&&(b&&b.set("RequestDuration",
(+a.fu-+a.Is).toString()),Sf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Ak.a,{extendedProperties:b})))}jpj(a){this.kpj(a)}kpj(a){var b="";let c=null,f=null,l=null;const y=Ct.c(a.data.Wd);y&&(c=y.places?y.places.items:[],f=y.documents?y.documents.items:[],(l=Ct.a(y,!1))&&(b=Nd.c(l)));w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.pGa&&Zg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0));b=br.a.fA();this.WPa&&(b&&this.WPa.ynd&&(b.set("LastError",this.WPa.ynd),
b.set("NumRetries",this.WPa.retryCount.toString())),this.WPa.reset());l||c||f?(this.nP.Ddb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.Dzd(3,l,c,f),this.tfk(a.data,b)):(this.nP.Ddb("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),b&&this.qTd(a.data,b),Sf.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Ak.a,{extendedProperties:b})),this.Dzd(3,null,null,null,!0));this.i6d(this.Q7)}Qhg(a,b,c,f){let l=0,y=0;const G=
Ct.c(b.data.Wd);G&&(null!=G.response_code&&(l=G.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.AEc="")),G.error_data&&null!=G.error_data.retry_after_ms&&(y=G.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",y.toString())));a&&(b=a.kTj(c,y,b.data.Oe,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}fpj(a){this.ipj(a)}ipj(a){const b=a.data.Oe===ok.a.Ipc,c=br.a.fA();c&&(c.set("StatusCode",a.data.Oe.toString()),b||this.qTd(a.data,
c));this.nP.Ddb("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.Dzd(2);this.Qhg(this.WPa,a,Object(H.a)(this,this.gpj,"getMruFromServerRetryTask"),c);Sf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.Oe),b,!1,Object.assign(new Ak.a,{extendedProperties:c}));this.i6d(this.Q7);w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.pGa&&Zg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}Dzd(a,b=null,c=null,f=null,l=!1){if(3!==this.Q7.state||3===a)this.Q7.Dpf=b,this.Q7.Epf=c,this.Q7.C5h=f,this.Q7.state=a,this.Q7.YHd=l,this.Q7.twf=this.nP.TF()}edh(a,b){ha.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.Q7.state});b&&3===this.Q7.state&&this.nYf(b,this.Q7);return this.Q7}zOi(a,b){this.Dzd(1);let c;const f={};c=String.format(this.nP.aoa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.YUc(),this.Rxg);this.p8h.value||
(c+="&entity=docs");w.AFrameworkApplication.Md&&(f["X-Office-AudienceGroup"]=Object(sa.a)(String,w.AFrameworkApplication.Md.AudienceGroup)||"");this.Rxf?f["X-FileId"]=w.AFrameworkApplication.Pg:c+=String.format("&{0}",w.AFrameworkApplication.Pg);this.nP.Fmc.qj(c,1,null,f,!0,5,a,b,null)}get nP(){return this.tia.value}get Rxg(){return this.J4h.value}static get instance(){return $m.La||($m.La=$m.Kr())}static Kr(){return new $m(new vb.a(()=>Gp.instance),new vb.a(()=>ab.a.He(w.AFrameworkApplication.lcid).name),
new vb.a(()=>w.AFrameworkApplication.Aa.mb.gD),w.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>w.AFrameworkApplication.Aa.mb.NN,()=>w.AFrameworkApplication.ju,new vb.a(()=>w.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}$m.La=null;Object(m.a)($m,"MruActor",xs,[]);class Ou{constructor(){this.b_b=this.Fsf=this.Ea=null;this.Bo=!1}get name(){return"Common.App.NewAndOpen.Core"}Xb(a){this.Ea=a;a.register(1396,"Common.INewAndOpenCommonHelpers").na().oa(()=>Gp.instance);a.register(1397,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").na().oa(()=>Jn.instance);a.register(1397,"Common.IEventEmitter<Common.IMruResult>").na().oa(()=>$m.instance)}init(){w.AFrameworkApplication.fa.$e(()=>{this.zFa()})}zFa(){this.Ea.resolve("Common.INewAndOpenCommonHelpers");this.Ea.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Ea.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;Gp.instance.l7k();w.AFrameworkApplication.yxa&&(a=!0);w.AFrameworkApplication.tVe&&($m.instance.Ixk(),
0<w.AFrameworkApplication.q7g&&this.tzf(),this.ivl(),a=!0);w.AFrameworkApplication.Eza&&a&&Jn.instance.Gxk();w.AFrameworkApplication.XTl&&(a=$m.instance,a.v9k(),a.Oxk(),Uj.a.instance.Hb(this.YTl))}ivl(){bq.instance.Jyf(Object(H.a)($m.instance,$m.instance.Hxk,"makeGetMruRequestActivityTrigger"));bq.instance.Jyf(Object(H.a)(this,this.tzf,"addGetMruFromServerTask"));bq.instance.Nfi(Object(H.a)(this,this.IVi,"deleteGetMruFromServerTask"))}IVi(){Uj.a.instance.Kg(this.r7g)}tzf(){Uj.a.instance.Hb(this.r7g)}get r7g(){return this.Fsf||
(this.Fsf=new pd.a(5,2,w.AFrameworkApplication.q7g,Object(H.a)($m.instance,$m.instance.hpj,"getMruFromServerTask"),109))}get YTl(){return this.b_b||(this.b_b=new pd.a(2,2,6E4*w.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(H.a)($m.instance,$m.instance.Pxk,"makeUpdateMruTask"),197))}dispose(){this.Bo||(this.Bo=!0,this.b_b&&(Uj.a.instance.Kg(this.b_b),this.b_b=null))}}Object(m.a)(Ou,"CorePackageManager",null,[2,3,108]);var Si=d(125);
class sw{constructor(a,b,c,f,l,y,G,R,ja,za){this.QOg=new Oa.a;this.h0g=null;this.Ub=f;this.ua=l;this.Fa=c;this.zva=G;this.kma=R;this.zA=y;this.pa=b;this.la=ja;this.Vq=a;this.od=za;this.la.r6j&&(this.pa&&this.pa.FC(Object(H.a)(this,this.CD,"onSelectionChanged")),R&&R.s8k(this),this.Vq.NJc(Object(H.a)(this,this.YU,"onFocusChanged")),this.od.HBf(Object(H.a)(this,this.Mnc,"onShapeViewElementUnlocked")),this.od.Bli(Object(H.a)(this,this.Eeh,"onThumbnailsSetFakeImage")),this.od.Cli(Object(H.a)(this,this.Feh,
"onThumbnailsSetFocus")),this.od.Dli(Object(H.a)(this,this.Geh,"onThumbnailsSetSelected")),this.la.t2c&&this.Vq.mki(Object(H.a)(this,this.Ydh,"onSlideshowNavigationToolbarClickedHandler")),this.la.yg&&this.Vq.lki(Object(H.a)(this,this.Wdh,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Vq.gqd(Object(H.a)(this,this.YU,"onFocusChanged"));this.Vq.Oal(Object(H.a)(this,this.yGk,"onDesignerClickSuggestion"));this.od.Qrh(Object(H.a)(this,this.Mnc,"onShapeViewElementUnlocked"));this.od.Scl(Object(H.a)(this,
this.Eeh,"onThumbnailsSetFakeImage"));this.od.Tcl(Object(H.a)(this,this.Feh,"onThumbnailsSetFocus"));this.od.Ucl(Object(H.a)(this,this.Geh,"onThumbnailsSetSelected"));this.la.t2c&&this.Vq.fcl(Object(H.a)(this,this.Ydh,"onSlideshowNavigationToolbarClickedHandler"));this.la.yg&&this.Vq.ecl(Object(H.a)(this,this.Wdh,"onSlideshowContextMenuFocusedHandler"))}CD(a,b){if(b&&b.jl&&this.pa.u0(b.jl))try{this.OIj(b.jl)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),ya.a.J(17367906,822,10,a)}}OIj(a){var b=this.pa.Qf();if(1===a.length||1===b.length&&b[0].Ug){if(a=this.pa.Ll()){b=new Oa.a;let c=this.Rbg(a,b,Object(H.a)(this,this.hvj,"getShapeName"));c||b.count||(c=this.kma.Qcg(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:na.a.Xa(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.kma.pvj(a);({cFf:c,bcf:b}=this.oDf(f,c,b));!a.Hs&&a.isUnread&&({cFf:c,bcf:b}=this.oDf(this.kma.qvj(a,this.h0g),c,b));0<b.count?
this.Wnh(b):this.yga(c||"")}}else 1<a.length&&(a=this.kma.mpj(this.pa.Ud()),this.yga(a||""))}oDf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{cFf:b,bcf:c}}YU(a,b){b=b.fib;if(b===Si.a.fE||b===xa.a.qg){a=this.ua.Ba;let c=null;b===Si.a.fE?c=(a=this.Ub.twc.W9)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.uab()+this.kma.kfe(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.uab()):b!==xa.a.qg||
!this.pa.Js()&&this.pa.F4()||(this.zA&&this.zA.value&&(b=this.zA.value.Rd)&&a&&b.yp&&vg.e(a,b.Na),c=this.kma.Wvj());this.yga(c||"")}}setAttribute(a,b,c){a&&Ne.a.gS(a,b,c)}C6(a){this.QOg.add(a)}Rbg(a,b,c=null){try{if(a&&this.Fa)for(let f of this.QOg)if(f){const l=f(a,this.Fa.Ee?this.Fa.Ee.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),ya.a.J(17662480,822,10,a)}return null}Wnh(a){if(this.zva&&
this.zva.value){const b=this.zva.value.Wnj();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}Znh(a,b){if(a){const c=new Oa.a;let f=this.Rbg(a,c);f||c.count||(f=this.kma.Qcg(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.Wnh(c)):(b&&(f+=" "+b),this.yga(f||""))}}yga(a){this.zva&&this.zva.value&&this.zva.value.sendNotification(a,!0)}Mnc(a,b){b.presenceUser&&b.A6j&&this.yga(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}yGk(a,b){this.yga(this.kma.Lij(b.vll,b.kHl))}Eeh(a,b){this.setAttribute(b.e7.image,Ne.a.hf,Ne.a.fRa)}Feh(a,b){b.hasFocus&&b.e7.isSelected&&this.yga(this.uab()+this.kma.kfe(b.e7));this.setAttribute(b.e7.anb,Ne.a.P7a,b.hasFocus&&b.e7.isSelected?"true":"false")}Geh(a,b){b.e7.isSelected&&b.hasFocus?this.yga(this.uab()+this.kma.kfe(b.e7)):b.e7.isSelected||this.yga(this.uab());this.setAttribute(b.e7.anb,Ne.a.P7a,b.e7.isSelected?"true":"false")}Ydh(a,b){this.yga(b.text)}hvj(a){this.h0g=
a||ResourceStrings.l_Object}Wdh(a,b){this.yga(b.text)}uab(){let a="";const b=this.pa.Re();b&&1<b.length&&(b.sort((c,f)=>c.qe-f.qe),this.Etb(b)&&(a=this.kma.uab(b[0].qe+1,b[b.length-1].qe+1)));return a}Etb(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].qe-a[0].qe+1===b?!0:!1}}Object(m.a)(sw,"AriaManager",null,[1006,108]);var ry=d(939);class cq{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Xb(a){this.K=a;this.K.register(1005,"PowerPointWebEditor.IAriaMessageHelper").na().oa(()=>
new ry.a(this.K.Ia("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ia("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.ue("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1006,
"PowerPointWebEditor.IAriaManager").na().oa(()=>new sw(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.ue("Box4.IInteractiveViewManager"),this.K.ue("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){n.a.instance.Ac(new cq)}}Object(m.a)(cq,"PptAriaPackage",null,[2,3]);var tw=d(1071);class As{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=As.s0i;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0;this.AnnotationId=null}}As.s0i=[];Object(m.a)(As,"Critique",null,[]);class Pu{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(Pu,"Suggestion",null,[]);class Qu{wOc(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new As,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.mLi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.f1d(c.supportedActions)),c.suggestions&&(a.Suggestions=this.k1d(c.suggestions)),b.push(a);return b}k1d(a){if(!a)return null;const b=[];for(const c of a)(a=this.i1d(c))&&b.push(a);return b}i1d(a){if(!a)return null;
const b=Object.assign(new Pu,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.e1d(a.confidenceLevel)});a.actions&&(b.Action=this.j1d(a.actions));return b}e1d(a){return 1===a?0:2===a?1:2}j1d(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}mLi(a){return a.consistency?1:0}f1d(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(m.a)(Qu,"CloudALResponseTransformer",null,[1238]);var Ig=d(84),vA=d(536);class Fr{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.xwa=a;this.Tfb=b;this.j0g=c;this.ua=f;this.Fb=l;this.ia=y;this.lc=R;this.om=ja;this.Hh=za;this.Mc=G;this.EA=Va;this.xwa.ACa(Object(H.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.xwa.gk(Object(H.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.Hii(Object(H.a)(this,this.Gbh,"onLanguageOnRangeChanged"));
this.Tfb.ACa(Object(H.a)(this,this.q$g,"onBeforeNumberListDisconnect"));this.Tfb.gk(Object(H.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.j0g.KF(Object(H.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ua.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new vA.a,{slideId:b.Cb});this.ia.Ja(ea.a.q0a,2,c);return 0<c.Vuc?(ya.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.dne(this.ua.Ba)}dispose(){this.xwa.iLa(Object(H.a)(this,this.QJa,"onBeforeParagraphDisconnect"));this.xwa.Qm(Object(H.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.cbl(Object(H.a)(this,this.Gbh,"onLanguageOnRangeChanged"));this.Tfb.iLa(Object(H.a)(this,this.q$g,"onBeforeNumberListDisconnect"));this.Tfb.Qm(Object(H.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.j0g.vP(Object(H.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}QJa(a,b){this.dxc(Object(sa.a)(Kf.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==Ya.a.Oo&&b.property!==sb.a.listLevel||this.dxc(Object(sa.a)(Kf.AParagraphNode,b.node),!1)}Gbh(a,b){this.dxc(b.paragraphNode,!0)}q$g(a,b){b.node&&Object(Sa.a)(Ig.a,b.node)&&this.dxc(this.EA.pce(Object(sa.a)(Ig.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Sa.a)(Ig.a,b.node)&&b.node.isConnected&&b.property===Ya.a.ej&&this.dxc(this.EA.pce(Object(sa.a)(Ig.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(sa.a)(4,b.node))a=this.lc.jg(a),this.dne(a)}dxc(a,b){!this.sxl(a)||b&&this.OKj(a)||(a=Object(sa.a)(116,this.lc.jg(a)),this.dne(a))}dne(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Fb.ke(7,C.a.Mzd);b.jc(a);a.isSlideCritiqueReady=!1;b.dispose()}}sxl(a){return!!a&&a.isConnected&&this.Hh.fe(a)&&!this.om.D9(a)&&!a.sa(va.a.hU,!1)}OKj(a){a=a.sa(Ya.a.Oo,"");return!a||!a.length}}Object(m.a)(Fr,"ConsistencyCheckManager",null,[998,108]);
var sm=d(159),hp=d(535);class dq{constructor(){this.d=this.p=this.w=null}}Object(m.a)(dq,"ProofingDashboardTraceMetrics",null,[]);class vl{}vl.Cse="bs";vl.d5c="bd";vl.gTh="was";vl.hTh="wad";vl.Q5j="rm";vl.h_l="wd";vl.TYl="ad";vl.Pgl="rs";Object(m.a)(vl,"TelemetryFieldNames",null,[]);class tm{}tm.NKl="tcw";tm.Gxd="tcc";tm.lwg="bs";tm.rak="bd";tm.kwg="bpc";tm.f5g="md";Object(m.a)(tm,"TelemetryValues",null,[]);class Gr{constructor(){this.wn=this.i=null}}Object(m.a)(Gr,"Workflow",null,[]);var zj=d(336);
class Bs{constructor(a){zj.a.assign(Bs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Bs.getTypeName()])}}Bs.H_={T_:Bs.getTypeName(),B_:Bs.getBaseTypes()};class eq{constructor(a){zj.a.assign(eq,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,
[eq.getTypeName()])}}eq.H_={T_:eq.getTypeName(),B_:eq.getBaseTypes()};class Cs{constructor(a){zj.a.assign(Cs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Cs.getTypeName()])}}Cs.H_={T_:Cs.getTypeName(),B_:Cs.getBaseTypes()};class Hr{constructor(a){zj.a.assign(Hr,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Hr.getTypeName()])}}Hr.H_={T_:Hr.getTypeName(),B_:Hr.getBaseTypes()};class Et{constructor(a){zj.a.assign(Et,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,
[Et.getTypeName()])}}Et.H_={T_:Et.getTypeName(),B_:Et.getBaseTypes()};class Ft{constructor(a){zj.a.assign(Ft,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Ft.getTypeName()])}}Ft.H_={T_:Ft.getTypeName(),B_:Ft.getBaseTypes()};class Ds{constructor(a){zj.a.assign(Ds,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Ds.getTypeName()])}}Ds.H_={T_:Ds.getTypeName(),B_:Ds.getBaseTypes()};class wq{constructor(a){zj.a.assign(wq,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[wq.getTypeName()])}}wq.H_={T_:wq.getTypeName(),B_:wq.getBaseTypes()};class Gt{constructor(a){zj.a.assign(Gt,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,
[Gt.getTypeName()])}}Gt.H_={T_:Gt.getTypeName(),B_:Gt.getBaseTypes()};class Ht{constructor(a){zj.a.assign(Ht,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Ht.getTypeName()])}}Ht.H_={T_:Ht.getTypeName(),B_:Ht.getBaseTypes()};class Es{constructor(a){zj.a.assign(Es,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Es.getTypeName()])}}Es.H_={T_:Es.getTypeName(),B_:Es.getBaseTypes()};class Fs{constructor(a){zj.a.assign(Fs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,
[Fs.getTypeName()])}}Fs.H_={T_:Fs.getTypeName(),B_:Fs.getBaseTypes()};class It{constructor(a){zj.a.assign(It,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[It.getTypeName()])}}It.H_={T_:It.getTypeName(),B_:It.getBaseTypes()};class xq{constructor(a){zj.a.assign(xq,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=
a}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[xq.getTypeName()])}}xq.H_={T_:xq.getTypeName(),B_:xq.getBaseTypes()};class Gs{constructor(a){zj.a.assign(Gs,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(a){return zj.a.matchesTypesFor(a,[Gs.getTypeName()])}}Gs.H_={T_:Gs.getTypeName(),B_:Gs.getBaseTypes()};class Ru extends Sys.EventArgs{constructor(a){super();this.Ba=a}}Object(m.a)(Ru,"RefreshTileAnnotationsEventArgs",Sys.EventArgs,[]);class Su{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){this.ua=a;this.nD=b;this.hGe=c;this.Fb=f;this.Lkk=l;this.OYg=y;this.aP=G;this.Ga=R;this.om=ja;this.Da=za;this.bwe=Va;this.W$=hb;this.bik=lc;this.wec=ic;this.od=
yc;this.ic=ec;this.Rfd=jc}initialize(){this.aP.execute(a=>{this.Da.E4?(a.kQ(wq.getTypeName()),a.Y6k(wq.getTypeName(),this.nge.bind(this)),qd.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966307,375,20,"EditorServiceResultsManager.initialize: Activated annotation {0} on AugLoop v2 session & registered annotation handler {1}",wq.getTypeName,this.nge.getName),this.od.eT(this.onActiveSlideDomReady.bind(this))):(a.addEventHandler(hp.a.TWd,Object(H.a)(this,this.Agg,"handleAugResults")),qd.a("PPTOAugLoopProofingTelemetry")&&
ya.a.J(508966306,375,20,"EditorServiceResultsManager.initialize: Registered event handler {0} with AugLoop V1 session for {1}",this.Agg.getName,hp.a.TWd),this.Da.pptAugmentationLoopCloudALEnabled&&(a.addEventHandler(hp.a.DNc,Object(H.a)(this,this.Egg,"handleCloudALResults")),qd.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966305,375,20,"EditorServiceResultsManager.initialize: Registered event handler {0} with AugLoop V1 session for {1}",this.Egg.getName,hp.a.DNc)))})}dispose(){this.Da.E4&&this.od.Voa(this.onActiveSlideDomReady.bind(this))}onActiveSlideDomReady(a,
b){var c,f,l;if(qd.a("EnableAnnotationStorage")&&this.wec&&b&&b.Ba){var y=b.Ba;y&&null!==(c=y.yj())&&void 0!==c&&c.some(G=>G.hasText)&&(a=nc.a.ax(y.sid,y.cid),a=this.wec.Kdj(a),!a||1>a.length?this.Rfd.execute(G=>G.Zmh(new Ru(y))):(b=null===(l=null===(f=y.changesData)||void 0===f?void 0:f.dtField)||void 0===l?void 0:l.getTime(),f=a.map(G=>G.body).filter(G=>G&&G.critiqueMetadata.sourceTimestamp).map(G=>Number(G.critiqueMetadata.sourceTimestamp)).find(G=>0<G),!f||!b||f>=b?this.nge(a,!1,!1):this.Rfd.execute(G=>
G.Zmh(new Ru(y)))))}}nge(a,b,c=!0){qd.a("EnableAnnotationStorage")&&this.wec&&c&&this.wec.PCj(a,b);c=Date.now();var f=this.wec.jdg(a);if(f&&!b&&a&&!(1>a.length)){b=[];f=this.ic.Qk(f);for(var l of a){const y=l.body;if(!y)continue;const G=this.Hej(f,Number(y.critiqueMetadata.shapeId),Number(y.critiqueMetadata.paragraphIndex));G&&b.push(...this.bik.wOc([y],G.id.toString()))}this.oyk(b,f);qd.a("PPTOAugLoopProofingTelemetry")&&(l=Date.now(),a=a.map(y=>y.body).filter(y=>y&&y.critiqueMetadata.sourceTimestamp).map(y=>
Number(y.critiqueMetadata.sourceTimestamp)).find(y=>0<y),ya.a.J(508945999,375,20,"ALv2TotalProofingTime: {0}, ALv2MarkingResultsTime: {1}",l-a,l-c))}}oyk(a,b){var c;try{qd.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966304,375,20,"ALv2: Marking critiques for slide, critiques count: {1}",null!==(c=null===a||void 0===a?void 0:a.length)&&void 0!==c?c:0);const G=qd.a("ALV2SpellingEnabled"),R=this.vXc(a,G);if(R){var f=new Oa.a,l=this.ua.Ba.ada,y=this.Fb.ke(7,C.a.Mzd);y.jc(b);for(const ja in R){const za=
Object(sa.a)(Kf.AParagraphNode,l.Be(ia.a.Kf(ja)));if(!za||za.sa(sm.a.O4,!1))continue;f.add(ja);const Va=R[ja];Va||0<Va.length?this.uyk(za,Va):this.uqh(za);za.setValue(sm.a.O4,!0)}if(this.Da.pptEditorConsistencyCheckIsEnabled){const ja=String.format("Start:{0}",(new Date).getTime().toString());c=0;const za=b.isSlideCritiqueReady;l=!1;if(!za){const Va=new Oa.a,hb=this.vXc(a,!0);(l=this.J1f(hb,f,b,Va))&&(c=this.rEf(hb,f,b,Va))}ya.a.J(509116999,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",
ja,(new Date).getTime().toString(),za,l,c)}b.setValue(sm.a.Qoe,!0);y.dispose()}}catch(G){ya.a.J(509116997,375,10,"markEditorServiceResultsForALV2 failed {0}",G.message)}}uyk(a,b){const c=this.enj(a);this.i5g(a,b,c)}enj(a){const b=new Eb.ScriptSharpLegacyMap;let c=-1,f=-1,l=0;for(let y=0;y<a.Sa.length;y++){const G=a.Sa.ga(y).formatting;G&&(f=wb.a.language(G),-1!==c&&c!==f&&(b.add(l,f),l=a.Sa.ga(y).cp),c=f)}b.add(l,f);return b}Hej(a,b,c){if(!a)return null;a=a.MQ(b);if(!a)return null;a=a.vy();b=0;for(const f of a)if(f.characterData){if(b==
c)return f;b++}return null}Agg(a,b,c,f){ya.a.J(509116995,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,(new Date).getTime().toString());var l=this.b6f(b.Content);c=this.zjj(f.Payload);if(l&&c){var y=!1;if(this.Da.pptRegisterSingleProofingWorkflowEnabled||!this.Da.pptAugmentationLoopCloudALEnabled||this.Da.pptAugmentationLoopShadowCloudALEnabled)this.g5g(c.Critiques,l),y=!0;l=(new Date).getTime();if(f=this.W$.t4d(f.DashboardTelemetry))try{const G={};
G[vl.Pgl]=c.ResponseStatus;G[vl.Q5j]=y;G[vl.h_l]=l-f.d[vl.Cse];G[vl.TYl]=f.d[vl.hTh]-f.d[vl.gTh];f.d=G;f.p=tm.f5g;this.W$.track(f)}catch(G){ya.a.J(509116993,375,15,"trace metrics exception {0}",G.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());ya.a.J(509116992,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",y,b.Id,c.Critiques?c.Critiques.length:0,a)}else ya.a.J(509116994,375,10,c?"Aug slide is null":"Result is null")}}Egg(a,b,c,f){ya.a.J(509116963,375,50,"Handle Cloud AL results");
a=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&ya.a.J(509116962,375,15,"Get partial success response");c=String.format("MarkStart:{0}",a.toString());var l=this.b6f(b.Content);if(l){var y=!1;if(this.Da.pptRegisterSingleProofingWorkflowEnabled||!this.Da.pptAugmentationLoopShadowCloudALEnabled)y=this.bwe.wOc(f.critiques),this.g5g(y,l),y=!0;var G=(new Date).getTime(),R=Object.assign(new dq,{w:Object.assign(new Gr,{wn:tm.Gxd,i:b.Id}),p:tm.f5g,d:{["ms"]:a,["md"]:G,["rm"]:y,["rs"]:f.partialSuccess?
1:0}});this.W$.track(R);c=String.format("{0}, MarkDone:{1}",c,G.toString());ya.a.J(509116960,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",y,b.Id,f.critiques?f.critiques.length:0,c);qd.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508945998,375,20,"ALv1TotalProofingTime: {0}, ALv1MarkingResultsTime: {1}",G-l.sourceTimestamp,G-a)}else ya.a.J(509116961,375,10,"Aug slide is null")}}b6f(a){let b=null;try{b=Nd.a(a)}catch(c){return ya.a.J(509116959,375,10,"Try parse aug slide failed"),
null}return b}zjj(a){let b=null;try{b=Nd.a(a)}catch(c){return ya.a.J(509116958,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return ya.a.J(509116957,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return ya.a.J(509116956,375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&ya.a.J(509116955,375,15,"Get partial success response");
return b}g5g(a,b){var c;try{const R=this.ua.Ba;qd.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(509088202,375,20,"ALv1: Marking critiques for slide, critiques count: {1}",null!==(c=null===a||void 0===a?void 0:a.length)&&void 0!==c?c:0);if(!this.Qyl(b,R)){var f=this.vXc(a,!1);if(f){var l=this.ua.Ba.ada,y=new Oa.a,G=this.Fb.ke(7,C.a.Mzd);G.jc(R);for(const ja of b.drawingElems)if(ja.text&&ja.text.paragraphs)for(const za of ja.text.paragraphs){const Va=za.id;y.add(Va);const hb=Object(sa.a)(Kf.AParagraphNode,
l.Be(ia.a.Kf(Va)));if(hb&&!hb.sa(sm.a.O4,!1)){if(this.Da.pptEditorGrammarAndWritingStyleIsEnabled)if(Va in f){const Cb=Array.isArray(f[Va])?f[Va]:null;if(!Cb||!Cb.length||Cb[0].RevisionId!==hb.sa(sm.a.r5c,0).toString())continue;this.i5g(hb,Cb,this.Rtj(za.cfRuns))}else this.uqh(hb);hb.setValue(sm.a.O4,!0)}}if(this.Da.pptEditorConsistencyCheckIsEnabled){const ja=String.format("Start:{0}",(new Date).getTime().toString());b=0;const za=R.isSlideCritiqueReady;c=!1;if(!za){const Va=new Oa.a,hb=this.vXc(a,
!0);(c=this.J1f(hb,y,R,Va))&&(b=this.rEf(hb,y,R,Va))}ya.a.J(509116998,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",ja,(new Date).getTime().toString(),za,c,b)}R.setValue(sm.a.Qoe,!0);G.dispose()}}}catch(R){ya.a.J(509116996,375,10,"MarkEditorServiceResults failed {0}",R.message)}}Rtj(a){const b=new Eb.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}i5g(a,b,c){var f=this.nD.VF(a,y=>!!y.Fh);const l=[];for(const y of f)1===y.Fh.proofingType&&
Array.add(l,y);b=this.v7i(a,b,l);f=this.u7i(b,f);this.nD.hLa(a,f);this.e5g(b,a,c);a.setValue(sm.a.O4,!0)}uqh(a){const b=this.nD.VF(a,c=>!!c.Fh&&1!==c.Fh.proofingType);this.nD.hLa(a,b);a.setValue(sm.a.O4,!0)}rEf(a,b,c,f){const l=c.ada,y=new Qe.a;let G=0;this.Vfl(c);for(let ja in a){var R=a[ja];const za=Object(sa.a)(Kf.AParagraphNode,l.Be(ia.a.Kf(ja)));R=Array.isArray(R)?R:null;if(!(za&&za.isConnected&&R&&R.length))continue;const Va=[];for(const hb of R)this.$og(hb)&&!f.contains(hb.BucketId)&&Va.push(hb);
0<Va.length&&(this.e5g(Va,za),y.Gb(za.id.toString())||y.$(za.id.toString(),za),G+=Va.length)}if(0<y.count)for(let ja of b)y.Gb(ja)&&(a=y.ga(ja))&&c.mMa.add(a);c.isSlideCritiqueReady=!0;return G}J1f(a,b,c,f){var l=this.Lqj(c);if(b.count!==l.count)return this.e6c(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.ada;for(var y of b){if(!l.contains(y))return this.e6c("ParaId changed"),!1;b=Object(sa.a)(Kf.AParagraphNode,c.Be(ia.a.Kf(y)));if(!b||!b.isConnected)return this.e6c("Invalid ParaId"),
!1;if(!b.sa(sm.a.O4,!1))return this.e6c("Para pending proofing"),!1}for(let G in a){y=a[G];l=Object(sa.a)(Kf.AParagraphNode,c.Be(ia.a.Kf(G)));y=Array.isArray(y)?y:null;if(!y||!y.length)continue;b=this.nD.VF(l,ja=>!!ja.Fh&&(1===ja.Fh.proofingType||2===ja.Fh.proofingType||3===ja.Fh.proofingType));const R=this.nD.VF(l,ja=>{ja=Object(sa.a)(344,ja.Fh);return!!ja&&5===ja.proofingType&&ja.uFa});l=this.hGe.WVc(l,!1,!0);for(const ja of y)if(this.$og(ja)){if(this.G1c(ja,b)||this.WYj(ja,y))f.add(ja.BucketId),
ya.a.J(509116954,375,50,"Overlap critique: {0}",ja.BucketId);(this.G1c(ja,l)||this.G1c(ja,R))&&f.add(ja.BucketId)}}return!0}e6c(a){ya.a.J(509116953,375,50,"Skip apply: {0}",a)}v7i(a,b,c){if(this.Da.E4)return b;const f=[];for(const l of b){if(this.HKj(b,l)||a.characterData.length<l.Start+l.Length||this.G1c(l,c))continue;const y=Qf.b(l);2!==y&&3!==y||f.push(l)}return f}u7i(a,b){const c=[];for(const f of b)this.txl(a,f)||Array.add(c,f);return c}txl(a,b){const c=b.Fh.proofingType;if(1===c)return!0;if(2===
c||3===c)return!1;if(5===c){for(const f of a)if(this.C3c(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}G1c(a,b){const c=a.Start;a=a.Start+a.Length;for(const f of b)if(this.C3c(c,a,f.begin,f.end))return!0;return!1}vXc(a,b){const c={};qd.a("PPTOAugLoopProofingTelemetry")&&ya.a.J(508966303,375,20,"Including spelling critiques {0}",b);if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}iUa(a,b){let c=0;for(let f of a)if(b>=f.key)c=
f.value;else break;return c}e5g(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const G of a){var y=G.Start;const R=y+G.Length,ja=b.characterData.substring(y,R);a=this.Lkk.create(G,this.OYg);a.token=ja;c&&(a.lcid=this.iUa(c,y));y=new ef(y,R,a);Array.add(l,y);a=1===a.proofingType?Af[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.nD.dzf(b,l);this.OYg.track(()=>Object.assign(new Zd.a,{E:2,C:this.pMi(b.characterData),F:f}))}}HKj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.C3c(c,
f,l.Start,l.Start+l.Length)&&Qf.a(l)>Qf.a(b))return!0;return!1}WYj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==a&&this.C3c(c,f,l.Start,l.Start+l.Length))return!0;return!1}C3c(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}pMi(a){return Br.a.instance.ofg(a,0,a.length-1)}Qyl(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}$og(a){return!!a&&5===Qf.b(a)}Lqj(a){const b=new Oa.a;a=a?a.yj():[];for(const c of a)this.om.hGa(c)||this.Ga.vG(c,f=>{b.add(f.id.toString())});return b}Vfl(a){for(let b of a.mMa){const c=
b;if(c){const f=this.nD.VF(c,l=>{l=Object(sa.a)(344,l.Fh);return!!l&&5===l.proofingType&&!l.uFa});this.nD.hLa(c,f)}}a.mMa.clear()}}Object(m.a)(Su,"EditorServiceResultsManager",null,[]);class uw extends dl.a{constructor(a,b,c,f,l,y=null){super(a,b,c,f,y);this.pG=l}get proofingType(){const a=super.proofingType;return this.pG.DVa||2!==a?a:1}}Object(m.a)(uw,"PPTEditorServiceErrorDetails",dl.a,[]);class cr{constructor(a,b,c){this.cok=a;this.Gsk=b;this.pG=c}create(a,b,c=null){return new uw(a,b,this.cok,
this.Gsk,this.pG,c)}}Object(m.a)(cr,"PPTEditorServiceErrorDetailsFactory",null,[995]);class vw{constructor(a){this.Da=a}filter(a){if(a&&(!this.Da.pptEditorConsistencyCheckIsEnabled||!this.Da.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=Qf.c(b.CritiquePriority,b.CritiqueTag);this.Da.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Da.pptEditorGrammarAndWritingStyleIsEnabled||
2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(m.a)(vw,"PPTProofingCritiqueCategoryInfoFilter",null,[996]);class Tu extends $i.a{constructor(a,b){super(null);this.INd=a;this.errorType=2;this.Oxg=b}get proofingType(){return this.INd}get suggestions(){return[]}XMa(){}}Object(m.a)(Tu,"UnknownErrorDetails",$i.a,[]);class Uu{constructor(a,b,c,f,l){this.fef=this.bef=null;this.aSd=this.qLd=0;this.kEd=!1;this.Vi=a;this.dYb=b;this.$z=c;this.Tm=f;this.BN=l;this.wAc=0}soh(a,b,c){return{qlh:a,
A9g:b,z9g:c}}ONh(){}yte(a,b,c,f,l,y,G,R){!y&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Vi.Sa.last.cp,y=this.Vi.characterData.length,Array.add(G,new Lk.a(b,y)),(c||f)&&Array.add(R,new ef(b,y,new Tu(this.BN.nse?l?l[a]:0:f?2:1,c?1:2))))}gUl(a,b){this.$z.TXe(this.Vi,a);b&&this.Tm.Udl(this.Vi,b);w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopV2Proofing",!1)&&Object(Rd.a)("ALV2SpellingEnabled")||this.plh()}plh(){this.dYb.oS(this.Vi)}Ejl(a,b,c,f){this.wwh(this.wAc,
b,c,f);this.UZe(a,this.kEd)}wwh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.BN.nse?a:0)}UZe(a,b){a.add(b)}idk(a){let b,c,f,l;b=this.Vi.sa(Ya.a.Axa,null);c=this.Vi.sa(Ya.a.sMa,null);f=this.Vi.sa(sb.a.Xab,null);l=this.Vi.sa(sb.a.c0a,null);this.Vi.ZAb=this.Vi.sa(V.a.Lmc,!1);({Axa:b,sMa:c,Xab:f,c0a:l}=this.GSh(b,c,f,l,a,"loading"));return{Axa:b,sMa:c,Xab:f,c0a:l}}WZe(a,b,c,f,l){({Axa:a,sMa:b,Xab:c,c0a:f}=this.GSh(a,b,c,f,l,"saving"));this.e1e(Ya.a.Axa,a);this.e1e(Ya.a.sMa,b);this.h3e()&&this.e1e(sb.a.Xab,
c);this.nrl(sb.a.c0a,f);this.Vi.ZAb?this.Vi.Ae(V.a.Lmc,!0):this.Vi.removeProperty(V.a.Lmc)}h3e(){return!0}e1e(a,b){b&&Array.contains(b,!0)?this.Vi.Ae(a,b):this.Vi.removeProperty(a)}nrl(a,b){!b||Ub.a.all(b,c=>0===c)?this.Vi.removeProperty(a):this.Vi.Ae(a,b)}YEi(a,b){(b=this.Vi.Sa.ga(b).formatting)?(a.formatting=b.ge(a),M.a.instance.ga(57)&&(this.Vi.nv(),-1!==a.formatting.tg&&this.Vi.wordRunProperties.vAb(b.tg,64))):(ha.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),
cc.a.instance.Yb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}GSh(a,b,c,f,l,y){const G=cc.a.instance.eq(C.a.LXl);G.properties.$(Jf.a.source,y);let R=!1;a&&a.length!==l&&(ha.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,y),R=!0);b&&b.length!==l&&(ha.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
b.length,l,y),R=!0);this.h3e()&&c&&c.length!==l&&(ha.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",c.length,l,y),R=!0);f&&f.length!==l&&(ha.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,y),R=!0);if(R)for(f=c=b=null,a=[],y=0;y<l;y++)Array.add(a,!0);G.end();return{returnValue:!R,Axa:a,sMa:b,Xab:c,c0a:f}}ieh(){}DMe(){this.wAc=
0;this.bef=this.Vi.v1||[];this.fef=this.Vi.iRb||[];this.aSd=this.qLd=0;this.kEd=!1}GMe(a,b){a.aq&&a.aq.Fh?this.wAc=a.aq.Fh.proofingType:a.eM&&(this.wAc=0);a=a.cp;b=b?b.cp:a;this.kEd=({E5e:this.qLd}=this.ppg(a,b,this.bef,this.qLd)).returnValue||({E5e:this.aSd}=this.ppg(a,b,this.fef,this.aSd)).returnValue}ppg(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,E5e:f}}return{returnValue:!1,E5e:f}}}Object(m.a)(Uu,"ProofingDataHandler",null,[1293]);var ww=d(518);class xw extends Uu{constructor(a,
b,c,f,l,y,G,R,ja,za){super(a,b,c,f,R);this.MJg=!1;this.Tec=null;this.SJ=l;this.ia=y;this.Ga=G;this.lc=ja;this.H7c=null;this.la=za}ieh(){this.SJ.tPl(this.Vi)}soh(a,b,c){this.Vi.ioe||(a=!1,c=this.Tm.VF(this.Vi));this.H7c=this.Tm.VF(this.Vi,f=>{f=Object(sa.a)(344,f.Fh);return!!f&&5===f.proofingType&&!f.uFa});return{qlh:a,A9g:b,z9g:c}}ONh(a,b,c,f,l){const y=Object(sa.a)(116,this.lc.jg(this.Vi));this.Vi&&y&&y.isConnected&&y.isSlideCritiqueReady&&na.a.zWd(this.Vi.characterData,b)&&this.H7c&&0<this.H7c.length&&
(Array.addRange(l,this.H7c),l.sort((G,R)=>G.end-R.end));if(!a&&c&&0<c.length&&na.a.zWd(this.Vi.characterData,b)&&f&&0<f.length){for(const G of c)this.jtg(G,f)&&!this.jtg(G,l)&&Array.add(l,G);l.sort((G,R)=>G.end-R.end)}}jtg(a,b){a=ul.c([a],b);return!Ub.a.Xa(a)&&Ub.a.any(a,c=>c.begin<c.end)}plh(){this.la.E4&&Object(qd.a)("ALV2SpellingEnabled")?this.SJ.i5j(this.Vi)&&this.dYb.oS(this.Vi):ya.a.J(508913505,375,15,"Paragraph legacy proofing hit")}h3e(){return!1}UZe(a,b){this.MJg=!0;super.UZe(a,b);b&&(this.Vi.Ae(sm.a.O4,
!1),this.Vi.Ae(sm.a.r5c,(new Date).getTime()))}wwh(a,b){this.Tec||(this.Tec=this.Tm.VF(this.Vi));b.add(1===a)}DMe(){super.DMe();this.Tec=null}yte(a,b,c,f,l,y,G,R){y||(b=!!b&&b[a],a=!!c&&c[a],c=this.Vi.Sa.ga(this.Vi.Sa.length-1),b?(Array.add(G,new Lk.a(c.cp,this.Vi.characterData.length)),this.Djl()):(b=this.Wej(c.cp,this.Vi.characterData.length,this.Vi.characterData,ja=>{ja=ja.Fh.proofingType;return 2===ja||3===ja}))&&0<b.length&&Array.addRange(R,b),a&&(Array.add(G,new Lk.a(c.cp,this.Vi.characterData.length)),
Array.add(R,new ef(c.cp,this.Vi.characterData.length,new Tu(1,1)))))}WZe(a,b,c,f,l){this.MJg||this.BLj()||ya.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.WZe(a,b,c,null,l)}BLj(){if(!this.Vi)return ya.a.J(508921562,375,10,"ParagraphNode is null"),!1;var a=this.Ga.An(this.Vi);if(!a)return ya.a.J(508921561,375,10,"ShapeNode is null"),!1;a=new ww.a(a,Sc.App.tn);this.ia.Ja(ea.a.Gjb,2,a);return a.Nua}Djl(){const a=new pf.GraphTransaction(4);
a.ld(this.Vi);this.Vi.Ae(sm.a.O4,!1);this.Vi.Ae(sm.a.r5c,(new Date).getTime());a.dispose()}Wej(a,b,c,f){const l=[];if(this.Tec)for(const y of this.Tec){const G=Object(sa.a)(ef,y);G&&G.Fh&&G.Fh.token===c.substring(G.begin,G.end)&&G.end>a&&G.end<=b&&f(G)&&Array.add(l,G)}return l}}Object(m.a)(xw,"PPTProofingDataHandler",Uu,[]);class yw{constructor(a,b,c,f,l,y,G,R,ja){this.X$=a;this.Lpk=b;this.nD=c;this.SJ=f;this.pG=G;this.ia=l;this.lc=R;this.Ga=y;this.la=ja}hQi(a){return new xw(a,this.X$,this.Lpk,this.nD,
this.SJ,this.ia,this.Ga,this.pG,this.lc,this.la)}}Object(m.a)(yw,"PPTProofingDataHandlerFactory",null,[999]);class Vu{constructor(a,b){this.aP=a;this.CAg=b}initialize(){this.aP.execute(a=>{if(this.CAg)for(const b of this.CAg)this.u9k(a,b)})}u9k(a,b){a.registerSimpleRemoteWorkflow(b.GG,b.Utb,b.lMb,b.htb)}}Object(m.a)(Vu,"ProofingAugLoopRuntimeManager",null,[]);class zw{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){this.Ga=a;this.om=b;this.lc=c;this.Yl=f;this.Fb=l;this.Tb=y;this.Kk=G;this.ua=
R;this.X$=ja;this.nD=za;this.ei=hb;this.Hh=Cb;this.Dna=lc;this.wb=ic;this.od=ec;this.JUg=jc;this.HZa=new Oa.a;this.Kk.Jli(Object(H.a)(this,this.Neh,"onUndoRevisionStateChanged"));this.GU=Va.zd(12);this.GU.gk(Object(H.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.IM=Va.zd(10);this.IM.KF(Object(H.a)(this,this.Edh,"onShapeTopologyChanged"));this.stk=new pd.a(3,1,0,Object(H.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.xkc=this.s5=!1;this.od.eT(Object(H.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Kk.Ycl(Object(H.a)(this,this.Neh,"onUndoRevisionStateChanged"));this.GU.Qm(Object(H.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.IM.vP(Object(H.a)(this,this.Edh,"onShapeTopologyChanged"));this.od.Voa(Object(H.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}xtc(a,b){this.Ga.vG(a,c=>{this.Wzh(c,b)})}Xzh(a,b){this.om.Hpc(a,c=>{this.Wzh(c,b)})}vUl(a,b){b?this.Ga.vG(a,c=>{c&&this.nD.f_d(c)}):
this.Ga.vG(a,c=>{c&&(c.e0b=!0)})}PNh(a){if(a&&a.isConnected&&!a.iq){var b=this.Fb.ke(4);try{let c=!1;const f=this.Tb.Lc(a);b.jc(f);const l=this.Yl.Osa(a);for(;l.moveNext();){const y=l.currentNode;this.dyl(y)&&(c=!0,y.Gkd(),y.Vpc=!0)}c&&this.n5g(a)}finally{b&&b.dispose()}this.ei.forceOutbound()}}tPl(a){if(this.Tua(a)&&a.e0b)if(this.xkc&&!this.HZa.contains(a))this.HZa.add(a);else{var b=this.Fb.ke(4);try{b.jc(a),a.Gkd(),a.Vpc=!0,this.vyk(a)}finally{b&&b.dispose()}a.e0b=!1}}Gnd(a){this.Tua(a)&&this.Ga.vG(a,
b=>{this.X$.oS(b)})}tZk(a){this.Tua(a)&&this.om.Hpc(a,b=>{this.X$.oS(b)})}i5j(a){return this.Tua(a)&&(this.k5j(a)||this.j5j(a))}n5g(a){a&&a.isConnected&&this.Ga.wGa(a)&&this.dAh(a)}vyk(a){const b=this.Ga.An(a);this.n5g(b);this.om.D9(a)&&(a=this.om.Qyb(a))&&a.isConnected&&this.om.hGa(a)&&this.dAh(a)}Neh(a,b){if(b)switch(b.state){case 0:this.xkc=!0;break;case 3:this.xkc=!1,this.s5||(this.wb.Hb(this.stk),this.s5=!0)}}dyl(a){return this.Tua(a)?a.sa(Ya.a.Axa,null)?!0:a.sa(Ya.a.sMa,null)?!0:!1:!1}onParagraphPropertyChanged(a,
b){this.xkc&&b&&b.node&&(12!==b.node.type||this.HZa.contains(b.node)||this.HZa.add(b.node))}Edh(a,b){this.xkc&&b&&b.node&&(10!==b.node.type||this.HZa.contains(b.node)||this.HZa.add(b.node))}resumeProofingAfterUndo(){this.s5=!1;for(let b of this.HZa)if(this.Tua(b))if(this.Ga.wGa(b)){var a=b;a&&(this.xtc(a,!0),this.Gnd(a))}else this.Hh.fe(b)&&(a=b)&&(a.e0b=!0,this.X$.oS(a));this.HZa.clear()}Wzh(a,b){a&&(a.e0b=b&&a.v1&&0<a.v1.length?!0:!1)}k5j(a){if(this.JUg){const b=this.ua.Ba;if(!this.Tua(b))return!1;
a=this.Ga.Xda(a);return this.lc.jg(a)===b}return this.Dna.xYj(a)}j5j(a){var b=this.ua.Ba;if(!this.Tua(b))return!1;a=this.om.Qyb(a);b=b.nUa();return this.Tua(a)&&this.Tua(b)&&ia.a.pQ(a.id,b.id)}dAh(a){a.setValue(va.a.Hnd,a.sa(va.a.Hnd,0)+1)}Tua(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.JUg){var a=this.ua.Ba;if(a&&(a=a.yj())&&0<a.length)for(const b of a)this.Ga.GB(b)&&this.Gnd(b)}}}Object(m.a)(zw,"ProofingBehaviorController",null,[1E3,108]);class Aw extends Yp.a{constructor(a,b,c,
f,l,y=!0,G=!1,R=50){super(a,b,c,f,l,y);this.vok=G;this.IOg=R}dyh(a){a=Array.isArray(a)?a:null;if(!Ub.a.Xa(a))if(a.length<=this.IOg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.IOg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&ya.a.J(37325012,375,this.vok?15:50,"{0}",kh.c(a))}}Object(m.a)(Aw,"DashboardAggregator",Yp.a,[]);class Vj{constructor(a){this.W$=new Aw(new vb.a(()=>w.AFrameworkApplication.De),w.AFrameworkApplication.$ga,
15,a.pptProofingDashboardTraceIntervalInMinutes,new no,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.W$.track(a,"")}t4d(a){let b=null;try{b=Nd.a(a)}catch(c){ya.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(m.a)(Vj,"ProofingDashboardAggregator",null,[997]);class ip{track(){}t4d(){return null}}Object(m.a)(ip,"ProofingDashboardNonOperationAggregator",null,[997]);var Bw=d(446),Hs=d(445);class Jt{constructor(a){this.mtk=
a}Xx(a,b,c){this.mtk(b,c);return!0}}Object(m.a)(Jt,"NonOpProofingALRequestManager",null,[1082]);class Cw{constructor(a,b,c){this.i1=this.G0=null;this.uhb=a;this.nfc=b.pptEditorConsistencyCheckIsEnabled;this.jEe=b.pptProofingLogWorkflowExceptionEnabled;this.W$=c;this.gGe=new Jt(Object(H.a)(this,this.iYe,"requestAL"))}get GG(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get Utb(){this.G0||(this.G0=Object.assign(new Hs.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:Bw.a.Wuc,
outputSchema:hp.a.hNf,func:Object(H.a)(this,this.kdb,"lambdaBeforeFunc")}));return this.G0}get htb(){return null}get lMb(){this.i1||(this.i1=Object.assign(new Hs.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:hp.a.hNf,outputSchema:hp.a.DNc,func:null}));return this.i1}iYe(a,b){b(a)}kdb(a,b,c){try{ya.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.GG);const G=Object.assign(new dq,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Gr,{wn:tm.Gxd})});this.W$.track(Object.assign(new dq,
{w:Object.assign(new Gr,{wn:tm.Gxd}),p:tm.lwg}));let R=String.format("LambdaBeforeStart:{0}",G.d[vl.Cse].toString());if(a){G.w.i=a.Id;try{var f=Nd.a(a.Content)}catch(ja){ya.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var y=({oGa:b}=this.uhb.xDl(f)).returnValue;y?b&&(!this.nfc||this.nfc&&l)?(c(null),this.W$.track(Object.assign(new dq,{w:Object.assign(new Gr,{wn:tm.Gxd}),p:tm.kwg})),ya.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",
this.GG,a.Id,b,l)):(G.d[vl.d5c]=(new Date).getTime(),G.p=tm.rak,R=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,R,G.d[vl.d5c].toString()),this.W$.track(G),ya.a.J(36783312,375,50,R),this.gGe.Xx(f.id,y,c)):(c(null),ya.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.GG,a.Id))}else c(null)}else c(null),ya.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.GG)}catch(G){a="CloudAL LambdaBefore Exception",this.jEe&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",
G.message,G.stack)),ya.a.J(37835201,375,10,a),c(null)}}}Object(m.a)(Cw,"ProofingTileCheckCloudALWorkflow",null,[958,1036]);class Hp{}Object(m.a)(Hp,"AugEditorServiceTileCheckRequest",null,[]);class Dw{constructor(){this.contextId=this.e5c=null}}Object(m.a)(Dw,"RequestStateObject",null,[]);class Wu{constructor(a,b,c,f){this.ntk=0;this.i1=this.G0=null;this.uhb=a;this.rU=b;this.nfc=c.pptEditorConsistencyCheckIsEnabled;this.jEe=c.pptProofingLogWorkflowExceptionEnabled;this.W$=f;this.gGe=new Jt(Object(H.a)(this,
this.iYe,"requestAL"))}get GG(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get Utb(){this.G0||(this.G0=Object.assign(new Hs.a,
{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:Bw.a.Wuc,outputSchema:hp.a.GFf,func:Object(H.a)(this,this.kdb,"lambdaBeforeFunc")}));return this.G0}get htb(){return null}get lMb(){this.i1||(this.i1=Object.assign(new Hs.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:hp.a.GFf,outputSchema:hp.a.TWd,func:Object(H.a)(this,this.Dse,"lambdaRemoteFunc")}));return this.i1}iYe(a,b){if(b){var c=this.W$.t4d(a.DashboardTelemetry);c&&(c.d[vl.gTh]=(new Date).getTime());var f=String.format("{0}, LambdaRemoteStart:{1}",
a.Telemetry,(new Date).getTime());this.rU.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.csc(a.Topic,a.Data,a.ContextId,y=>{this.pLa(y,f,c)},y=>{this.nLa(y,f)},Object.assign(new Dw,{contextId:a.ContextId,e5c:b}))})}}kdb(a,b,c){try{ya.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.GG);const G=Object.assign(new dq,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new Gr,{wn:tm.NKl})});let R=String.format("LambdaBeforeStart:{0}",G.d[vl.Cse].toString());
this.W$.track(Object.assign(new dq,{w:G.w,p:tm.lwg}));if(a){try{var f=Nd.a(a.Content)}catch(ja){c(null);ya.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var y=({oGa:b}=this.uhb.yDl(f,++this.ntk)).returnValue;y?b&&(!this.nfc||this.nfc&&l)?(c(null),this.W$.track(Object.assign(new dq,{w:G.w,p:tm.kwg})),ya.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.GG,a.Id,b,l)):(G.d[vl.d5c]=(new Date).getTime(),
R=String.format("{0}, LambdaBeforeDone:{1}",R,G.d[vl.d5c].toString()),c(Object.assign(new Hp,{Topic:hp.a.e0i,Data:Nd.c(y),ContextId:f.id,Telemetry:R,DashboardTelemetry:kh.c(G)})),ya.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.GG,a.Id)):(c(null),ya.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.GG,a.Id))}else c(null)}else c(null),ya.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.GG)}catch(G){a="WACAL LambdaBefore Exception",this.jEe&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
G.message,G.stack)),ya.a.J(37835210,375,10,a),c(null)}}Dse(a,b,c){ya.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.GG);a?this.gGe.Xx(a.ContextId,a,c):(c(null),ya.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.GG))}pLa(a,b,c){if(!w.AFrameworkApplication.Yg&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var y=Nd.a(a.data.Wd)}catch(G){l.e5c(null);ya.a.J(36525527,375,10,"Try parse aug response failed:{0}",G.message);return}y&&(y.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[vl.hTh]=f,y.DashboardTelemetry=kh.c(c)));l.e5c(y);ya.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.GG)}}}nLa(a,b){!w.AFrameworkApplication.Yg&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),ya.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Wd,b),(a=a.data.state)&&a.e5c(null))}}Object(m.a)(Wu,"ProofingTileCheckWacALWorkflow",null,[958,1036]);class Xu{constructor(){this.groupType=0}}
Object(m.a)(Xu,"AnalyzerData",null,[]);class Kt{constructor(){this.nodes=this.metadata=null}}Object(m.a)(Kt,"TopologyNode",null,[]);class Ew{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(m.a)(Ew,"Content",null,[]);class Fw{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(m.a)(Fw,"CritiqueTypeOption",null,[]);class Yu{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(m.a)(Yu,"Descriptors",null,[]);class Zu{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(m.a)(Zu,"EditorServiceTileCheckRequest",null,[]);class sy{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(m.a)(sy,"ListMetadata",null,[]);var Is;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(Is||
(Is={}));Object(m.b)("ListNumeration",Is);var Lt;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(Lt||(Lt={}));Object(m.b)("ListType",Lt);class $u{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(m.a)($u,"ProofingRequest",null,[]);class Mt{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(m.a)(Mt,"TopologyNode",null,[]);class Gw{constructor(){this.nodes=null}}Object(m.a)(Gw,"ReadingOrderTopology",null,[]);class Hw{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(m.a)(Hw,"Span",null,[]);class Iw{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(m.a)(Iw,"TextTile",null,[]);class ty{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(m.a)(ty,"TextTileElement",null,[]);class uy{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(m.a)(uy,"TextTileElementSpan",null,[]);class Ir{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(m.a)(Ir,"TileContext",null,[]);class av{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(m.a)(av,"TileElement",null,[]);class di{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(m.a)(di,"TileMetadata",null,[]);class Jw{constructor(a,b,c,f,l,y){this.MYg=a;this.P7c=b;this.LYg=c;this.pG=f;this.Da=l;this.ic=y;this.g8c=null}get oug(){return w.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.pG.DVa}get descriptors(){this.g8c||(this.g8c=this.Kij(),ya.a.J(37090579,375,50,"Descriptors: {0}",Nd.c(this.g8c)));return this.g8c}yDl(a,b){let c;c=!0;var f=ab.a.He(w.AFrameworkApplication.lcid);if(!f)return{returnValue:null,oGa:c};
var l=new Mt,y=new Mt;b=Object.assign(new Zu,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:w.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.P7c.Cae()});this.Da.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=oh.a.X3b(w.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.ic.rj(),l.AreChildrenOrdered=!1,y.Id=a.id,
y.Type=3,y.AnalyzerData=null,y.Children=[],y.NumberOfChildren=null,y.AreChildrenOrdered=!0,Array.add(l.Children,y));for(var G of a.drawingElems)if(this.Da.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(y.Children,this.EMl(G)),G.text&&G.text.paragraphs)for(const ja of G.text.paragraphs){if(null===ja.chars||!ja.cfRuns||!ja.cfRuns.length)continue;a=new Ew;a.TileId=ja.id;a.TileElements=[];l=new av;l.Text=ja.chars;l.TextUnit=8;if(ja.pfRuns&&ja.pfRuns.length&&ja.pfRuns[0].pf){f=ja.pfRuns[0].pf;
l.AnalyzerData={};if(this.Da.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var R=Lt[this.mae(f.listType)];1===f.listType?(l.AnalyzerData.ListType=R,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=R,l.AnalyzerData.ListNumeration=Is[this.f7f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;R=0;const za=[];let Va=null;for(const hb of ja.cfRuns)if(hb)if(f=ab.a.He(hb.cf.lang)){this.LYg.Rmd(hb.cf.lang);f=Object.assign(new Hw,{Start:R,Length:hb.len,LanguageId:f.name,DoNotCheck:hb.cf.noProof});Va||(Va=f.LanguageId);if(Va!==f.LanguageId||hb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?za.push(f):(f.Length||f.Start!==l.Text.length)&&ya.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
R+=hb.len}else R+=hb.len;!l.IsClean&&0<za.length&&(l.Spans=Array.clone(za));l.LanguageId=Va;na.a.Xa(l.LanguageId)?ya.a.J(38385410,375,15,"Empty LanguageId, span length {0}",za.length):(a.TileElements.push(l),b.Content.push(a))}for(y=b.Content.length-1;0<=y;y--)G=b.Content[y],G.TileElements.length&&null!==G.TileElements[0].Text||(ya.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",G.TileId),Array.removeAt(b.Content,y));b.Content.length||ya.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
oGa:c}}EMl(a){const b=Object.assign(new Mt,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new Mt,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}xDl(a){let b;b=!0;var c=ab.a.He(w.AFrameworkApplication.lcid);if(!c)return{returnValue:null,oGa:b};var f={};c=Object.assign(new $u,{descriptors:this.Pfj(this.descriptors),
languageUxId:c.name,documentSessionId:w.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.Ofj(this.P7c.Cae()),tileContextDictionary:f,documentId:oh.a.X3b(w.AFrameworkApplication.fa.Ha("ServerDocId")).toString(),readingOrderTopology:Object.assign(new Gw,{nodes:[]})});const l=this.Mgi(a,c.readingOrderTopology,f);for(var y of a.drawingElems)if(y.text&&y.text.paragraphs){a=this.ffi(y,l,f);for(const G of y.text.paragraphs)({oGa:b}=this.ihi(c.tiles,G,b)),this.Wfi(G,a,f)}for(f=
c.tiles.length-1;0<=f;f--)y=c.tiles[f],y.elements.length&&null!==y.elements[0].text||(ya.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",y.metadata?y.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||ya.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,oGa:b}}Kij(){if(!this.MYg.descriptors)return null;const a=Array.clone(this.MYg.descriptors);for(const b of a)if(this.oug&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.oug&&Array.add(a,
Object.assign(new In,{Name:"LicenseType",Value:"Subscription"}));return a}Pfj(a){const b=new Yu;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}mae(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}Ofj(a){const b=[];for(const c of a)a=Object.assign(new Fw,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}f7f(a){return a+
1}Qfj(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}ihi(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,oGa:c};const f=new Iw;f.metadata=new di;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new ty;l.text=b.chars;l.textUnit=4;l.listMetadata=new sy;var y=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){y=b.pfRuns[0].pf;if(this.Da.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
y.listType){l.listMetadata.listLevel=y.lvl;var G=this.mae(y.listType);1===y.listType?(l.listMetadata.listType=G,l.listMetadata.listTag=y.listTag):0===y.listType&&(l.listMetadata.listType=G,l.listMetadata.listNumeration=this.f7f(y.listNumeration),l.listMetadata.listElementIndex=y.listElementIndex)}else l.listMetadata.indentationLevel=y.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.mae(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
y=!b.pfRuns[0].pf.proofingDirty;c=c&&y}G=0;const R=[];let ja=null;for(const za of b.cfRuns)if(za)if(b=ab.a.He(za.cf.lang)){this.LYg.Rmd(za.cf.lang);b=Object.assign(new uy,{start:G,length:za.len,languageId:b.name,doNotProcess:za.cf.noProof});ja||(ja=b.languageId);if(ja!==b.languageId||za.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?R.push(b):(b.length||b.start!==l.text.length)&&ya.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);G+=za.len}else G+=za.len;!y&&0<R.length&&(l.spans=Array.clone(R));l.languageId=ja;if(na.a.Xa(l.languageId))return ya.a.J(38385415,375,15,"Empty LanguageId, span length {0}",R.length),{returnValue:null,oGa:c};f.elements.push(l);a.push(f);return{returnValue:f,oGa:c}}Mgi(a,b,c){const f=Object.assign(new Kt,{metadata:Object.assign(new di,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Ir,{analyzerData:new Xu,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}ffi(a,b,c){const f=Object.assign(new Kt,{metadata:Object.assign(new di,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Ir,{analyzerData:Object.assign(new Xu,{groupType:this.Qfj(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}Wfi(a,b,c){const f=Object.assign(new Kt,{metadata:Object.assign(new di,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new Ir,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(m.a)(Jw,
"TileToTileCheckRequestTransformer",null,[1035]);var vy;(function(a){a[a.High=0]="High";a[a.Medium=1]="Medium";a[a.Low=2]="Low";a[a.Informational=3]="Informational"})(vy||(vy={}));var ao;(function(a){a[a.NotificationOnly=0]="NotificationOnly";a[a.Delete=1]="Delete";a[a.Ignore=2]="Ignore";a[a.IgnoreAll=4]="IgnoreAll";a[a.IgnoreCritiqueType=8]="IgnoreCritiqueType";a[a.AddToDictionary=16]="AddToDictionary";a[a.ShowDetails=32]="ShowDetails"})(ao||(ao={}));var dr;(function(a){a[a.None=0]="None";a[a.ChangeOnce=
1]="ChangeOnce";a[a.ChangeAll=2]="ChangeAll";a[a.AutoCorrect=4]="AutoCorrect";a[a.ReadAloud=8]="ReadAloud";a[a.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"})(dr||(dr={}));class bv{wOc(a,b){if(!a)return null;const c=[];for(const f of a)a=Object.assign(new As,{CategoryTitle:f.categoryName,ExplanationTitle:f.explanationTitle||"",ExplanationLabel:f.explanationLabel||"",Explanation:f.context||"",TileId:b,BucketId:f.bucketId,Tag:0,Start:f.range.start,Length:f.range.length,Priority:f.priority,TypeId:f.typeId,
AnnotationId:f.id}),f.critiqueActions&&(a.SupportedActions=this.f1d(f.critiqueActions)),f.suggestions&&(a.Suggestions=this.k1d(f.suggestions)),c.push(a);return c}k1d(a){if(!a)return null;const b=[];for(const c of a)(a=this.i1d(c))&&b.push(a);return b}i1d(a){if(!a)return null;const b=Object.assign(new Pu,{Description:a.description,Text:a.text,Level:this.e1d()});a.suggestionActions&&(b.Action=this.j1d(a.suggestionActions));return b}e1d(){return 2}j1d(a){let b=0;a&dr.AutoCorrect&&(b|=4);a&dr.ChangeOnce&&
(b|=1);a&dr.ChangeAll&&(b|=2);a&dr.ReadAloud&&(b|=8);return b}f1d(a){let b=0;a&ao.AddToDictionary&&(b|=16);a&ao.Delete&&(b|=1);a&ao.Ignore&&(b|=2);a&ao.IgnoreAll&&(b|=4);a&ao.IgnoreCritiqueType&&(b|=8);a&ao.ShowDetails&&(b|=32);return b}}Object(m.a)(bv,"ALV2ResponseTransformer",null,[1033]);class Js{constructor(a){this.Da=a;this.oDb=new Map}PCj(a,b){!a||1>a.length||(b?this.BVi(a):(a=a.filter(c=>zj.a.getTypeNameFor(c.body)===wq.getTypeName()),!a||1>a.length||this.ydi(a)))}Kdj(a){if(a&&this.oDb.has(a.toString()))return this.oDb.get(a.toString())}BVi(a){for(const b of a){const c=
b.id;this.oDb.forEach(f=>{const l=f.findIndex(y=>y.id===c);-1<l&&f.splice(l,1)})}}ydi(a){const b=this.jdg(a);b&&(this.oDb.has(b.toString())?this.oDb.get(b.toString()).push(...a):this.oDb.set(b.toString(),a))}ewj(a){var b=a[a.length-1];if(!b)return ya.a.J(508900097,375,15,"ALV2:getSlideNodeFromParentPath:: Null slide id received"),null;if(this.Da.E4&&Object(qd.a)("ALSlideTileIdNewFormat")){if(0>b.indexOf("#")){ya.a.J(508900096,375,15,"ALV2:getSlideNodeFromParentPath:: Slide Id does not have valid separator");
return}b=b.split("#");a=parseInt(b[0]);b=parseInt(b[1])}else a=parseInt(b.substring(0,3)),b=parseInt(b.substring(3,b.length));return nc.a.ax(a,b)}jdg(a){if(a&&!(1>a.length)&&a[0].source)switch(a=a[0],a.source.toLowerCase()){case "proofing-powerpoint":return this.ewj(a.parentPath)}}}Object(m.a)(Js,"AnnotationStore",null,[1034]);class Ks{constructor(){this.pG=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Xb(a){this.K=a;this.TIi();this.UIi();this.K.register(995,"Box4.Proofing.IEditorServiceErrorDetailsFactory").na().oa(()=>
new cr(w.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(996,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").na().oa(()=>new vw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(997,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").na().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?
new Vj(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new ip);this.K.register(Js,"PowerPointWebEditor.Proofing.AnnotationStore.AnnotationStore").as("PowerPointWebEditor.Proofing.AnnotationStore.IAnnotationStore").na().oa(()=>new Js(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Su,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").na().oa(()=>new Su(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"),this.K.resolve("PowerPointWebEditor.Proofing.IALV2ResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.AnnotationStore.IAnnotationStore"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.Ia("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier")));this.K.register(998,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").na().oa(()=>new Fr(this.K.resolve("Box4.Graph.IGraphInstance").zd(12),this.K.resolve("Box4.Graph.IGraphInstance").zd(22),this.K.resolve("Box4.Graph.IGraphInstance").zd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(Jw,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").na().oa(()=>new Jw(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Qu,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").na().oa(()=>new Qu);this.K.register(bv,"PowerPointWebEditor.Proofing.ALV2ResponseTransformer").as("PowerPointWebEditor.Proofing.IALV2ResponseTransformer").na().oa(()=>new bv);this.K.register(Wu,
"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").na().oa(()=>new Wu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Cw,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").na().oa(()=>
new Cw(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Vu,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").na().oa(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new Vu(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(tw.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").na().oa(()=>new tw.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
w.AFrameworkApplication.fa.Ha("PptRoamingServiceGetActionName"),w.AFrameworkApplication.fa.Ha("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.$e(()=>{this.pG=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.pG.DVa=a.ka("810");this.pG.OAb=a.ka("809");this.pG.hWa=a.ka("299");if(this.pG.DVa||this.pG.OAb)this.K.resolve("Box4.Proofing.IProofingDescriptors").Bje(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.pG.hWa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.pG.OAb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.pG.OAb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose();this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").dispose()}TIi(){this.K.register(999,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").na().oa(()=>new yw(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}UIi(){this.K.register(1E3,"PowerPointWebEditor.Proofing.IProofingBehaviorController").na().oa(()=>new zw(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),
this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").O4j))}static main(){n.a.instance.Ac(new Ks)}}Object(m.a)(Ks,"PPTWebEditorProofingPackage",null,[2,3]);class Kw{constructor(a,b,c,f,l,y,G,R,ja,za){this.od=a;this.od.aKc(Object(H.a)(this,this.zeh,"onTextEditViewClose"));
this.od.$sb(Object(H.a)(this,this.Aeh,"onTextEditViewOpen"));this.od.$ki(Object(H.a)(this,this.v$g,"onBeforeTextEditViewClose"));this.od.dli(Object(H.a)(this,this.Beh,"onTextEditViewUpdate"));this.jwe=b;this.ei=l;this.Xs=y;this.SJ=c;this.ohb=f;this.Kgc=G;this.Wfc=R;this.Ved=ja;this.NE=za}get FNc(){return this.jwe.instance}dispose(){this.od.vXe(Object(H.a)(this,this.zeh,"onTextEditViewClose"));this.od.Nrc(Object(H.a)(this,this.Aeh,"onTextEditViewOpen"));this.od.Acl(Object(H.a)(this,this.v$g,"onBeforeTextEditViewClose"));
this.od.Dcl(Object(H.a)(this,this.Beh,"onTextEditViewUpdate"))}Beh(){this.Wfc.sZ()}Aeh(a,b){a=b.$w.shapeNode;this.SJ.xtc(a,!1);this.SJ.Gnd(a);this.FNc&&this.FNc.ULk(a)}v$g(a,b){this.Kgc.O6d(b.$w.Od)}zeh(a,b){a=b.$w;const c=b.$w.shapeNode,f=!!c&&c.isConnected;b.Nua?this.NE.instance&&((this.NE.instance.aCb||this.NE.instance.s0)&&2===this.NE.instance.iC||this.NE.instance.Y3c)?ya.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",
this.NE.instance.iC,this.NE.instance.Y3c):(f&&c.Wtd(),c.xd?(this.SJ.PNh(c),this.ohb.P$g(),this.Xs.K6e()):(this.ei.I8a(c),this.Xs.b_d())):this.Ved||this.SJ.PNh(c);this.SJ.xtc(b.$w.shapeNode,f&&c.d2c);this.FNc&&!a.iq&&this.FNc.TLk(c)}}Object(m.a)(Kw,"ShapeViewElementTextEditHandler",null,[108]);class Jr{constructor(a){this.hlc=null;this.tok=a;this.reset()}WLh(a,b){a&&this.hlc.$(a,b)}ozb(a){let b=0;this.hlc.Gb(a)&&(b=this.hlc.ga(a)?1:2);return b}iLe(a){return this.tok?1===this.ozb(a):!1}reset(){const a=
this.hlc;this.hlc=new Qe.a(!1);return a}}Object(m.a)(Jr,"TextEditingRevisionInfoTracker",null,[1391,1392]);var Nt=d(1104),Oe=d(591),Ot=d(425),po=d(865),cv=d(327);class Lw{constructor(){this.typeField=this.startAtField=0}}Object(m.a)(Lw,"CT_TextAutonumberBullet",null,[]);class wy{constructor(){this.charField=null}}Object(m.a)(wy,"CT_TextCharBullet",null,[]);class yq{}Object(m.a)(yq,"CT_TextNoAutofit",null,[]);class Mw{}Object(m.a)(Mw,"CT_TextNoBullet",null,[]);class dv{constructor(){this.lnSpcReductionField=
this.fontScaleField=0}}Object(m.a)(dv,"CT_TextNormalAutofit",null,[]);class Pt{constructor(){this.itemField=null}}Object(m.a)(Pt,"CT_TextSpacing",null,[]);class Qt{constructor(){this.valField=0}}Object(m.a)(Qt,"CT_TextSpacingPercent",null,[]);class ev{constructor(){this.tField=this.rPrField=null}}Object(m.a)(ev,"CT_WebRegularTextRun",null,[]);class Nw{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(m.a)(Nw,"CT_WebTextBody",null,[]);class Ls{constructor(){this.lInsField=
this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(m.a)(Ls,"CT_WebTextBodyProperties",null,[]);class er{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=
!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=
null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=
this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(m.a)(er,"CT_WebTextCharacterProperties",null,[]);class Ow{constructor(){this.pPrField=this.itemsField=this.endParaRPrField=null}}Object(m.a)(Ow,"CT_WebTextParagraph",null,[]);class Ms{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=
this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=
this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(m.a)(Ms,"CT_WebTextParagraphProperties",null,[]);class Lm{constructor(a,b){this.shapeText=a;this.eSb=b}}Object(m.a)(Lm,"ShapeTextState",
null,[]);class qo{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(m.a)(qo,"IncrementalRequestTextOperation",null,[]);class uk{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}dH(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.dH()}Yxa(a){return this.contains(a.cp)||a.contains(this.cp)}LFa(a){const b=Math.max(a.cp,this.cp);return new uk(b,Math.max(0,Math.min(a.dH(),this.dH())-1-b+1))}static copy(a){return new uk(a.cp,
a.len)}}Object(m.a)(uk,"TextRange",null,[]);class Ip{constructor(a){this.Tq=a}}Object(m.a)(Ip,"ChangeState",null,[]);const Pw=(a,b)=>{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new er;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,
f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=
b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=
b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},Qw=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new Ms;let f=!1;Kr(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);Kr(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);Kr(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);
Kr(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);Kr(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,f=!0);Kr(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);Nd.c(a.defRPrField)!==Nd.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);Nd.c(a.buCharField)!==Nd.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);Nd.c(a.buAutoNumField)!==Nd.c(b.buAutoNumField)&&
(c.buAutoNumField=b.buAutoNumField,f=!0);Nd.c(a.buFontField)!==Nd.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||
a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=
b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=
b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,
c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},Kr=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class Rt{constructor(){this.to=
this.vIa=null}}Object(m.a)(Rt,"TextParaRange",null,[]);class St{constructor(){this.to=this.jJa=null}}Object(m.a)(St,"TextRunRange",null,[]);class Tt{constructor(a,b,c,f,l,y){this.Gfa=this.tna=null;this.M5=this.lma=0;this.mM=this.Z4=null;this.Swa=this.XGa=0;this.YGa=c;this.JIa=f;this.nma=l;this.Z$=y;this.Ltd(new uk(0,a.shapeText.length),new uk(0,b.shapeText.length))}Ltd(a,b){this.tna=a;this.Gfa=b;for(a=Math.max(0,this.XGa-1);a<this.YGa.length;a++)if(this.YGa[a].to.Yxa(this.tna)||this.tna.dH()<=this.YGa[a].to.cp){this.XGa=
a;break}for(a=Math.max(0,this.Swa-1);a<this.JIa.length;a++)if(this.JIa[a].to.Yxa(this.Gfa)||this.Gfa.dH()<=this.JIa[a].to.cp){this.Swa=a;break}this.mM=this.Z4=null;for(a=Math.max(0,this.lma-1);a<this.nma.length;a++)if(this.nma[a].to.Yxa(this.tna)||this.tna.dH()<=this.nma[a].to.cp){this.lma=a;break}for(a=Math.max(0,this.M5-1);a<this.Z$.length;a++)if(this.Z$[a].to.Yxa(this.Gfa)||this.Gfa.dH()<=this.Z$[a].to.cp){this.M5=a;break}}MSf(){return this.XGa>=this.YGa.length?null:Object.assign(new Rt,{vIa:this.YGa[this.XGa].vIa,
to:this.YGa[this.XGa].to.LFa(this.tna)})}NSf(){return this.Swa>=this.JIa.length?null:Object.assign(new Rt,{vIa:this.JIa[this.Swa].vIa,to:this.JIa[this.Swa].to.LFa(this.Gfa)})}OSf(){return this.woe()&&this.Z4?Object.assign(new St,{jJa:this.nma[this.lma].jJa,to:this.Z4}):null}PSf(){return this.jbc()&&this.mM?Object.assign(new St,{jJa:this.Z$[this.M5].jJa,to:this.mM}):null}voe(){return this.rpg()&&this.ibc()}rpg(){return this.XGa>=this.YGa.length?!1:this.YGa[this.XGa].to.Yxa(this.tna)}ibc(){return this.Swa>=
this.JIa.length?!1:this.JIa[this.Swa].to.Yxa(this.Gfa)}woe(){return!this.rpg()||this.lma>=this.nma.length?!1:this.nma[this.lma].to.Yxa(this.YGa[this.XGa].to)&&this.nma[this.lma].to.Yxa(this.tna)}jbc(){return!this.ibc()||this.M5>=this.Z$.length?!1:this.Z$[this.M5].to.Yxa(this.JIa[this.Swa].to)&&this.Z$[this.M5].to.Yxa(this.Gfa)}xNh(){this.voe()&&(this.XGa++,this.Swa++);return this.voe()}yNh(){this.ibc()&&this.Swa++;return this.ibc()}YOl(){if(!this.woe()||!this.jbc())return!1;if(this.Z4&&this.mM){this.Z4.dH()===
this.nma[this.lma].to.dH()&&this.lma++;this.mM.dH()===this.Z$[this.M5].to.dH()&&this.M5++;if(!this.woe()||!this.jbc())return!1;var a=this.nma[this.lma].to.LFa(this.tna);this.Z4.cp=Math.max(a.cp,this.Z4.dH());this.Z4.len=a.dH()-this.Z4.cp;a=this.Z$[this.M5].to.LFa(this.Gfa);this.mM.cp=Math.max(a.cp,this.mM.dH());this.mM.len=a.dH()-this.mM.cp}else this.Z4=this.nma[this.lma].to.LFa(this.tna),this.mM=this.Z$[this.M5].to.LFa(this.Gfa);a=Math.min(this.Z4.len,this.mM.len);this.Z4.len=a;this.mM.len=a;return 0<
a}ZOl(){if(!this.jbc())return!1;this.Z4||(this.Z4=this.nma[this.lma].to.LFa(this.tna));if(this.mM){if(this.mM.dH()===this.Z$[this.M5].to.dH()&&(this.M5++,!this.jbc()))return!1;const a=this.Z$[this.M5].to.LFa(this.Gfa);this.mM.cp=Math.max(a.cp,this.mM.dH());this.mM.len=a.dH()-this.mM.cp}else this.mM=this.Z$[this.M5].to.LFa(this.Gfa);return 0<this.mM.len}}Object(m.a)(Tt,"TextFormatIterator",null,[]);class Rw{constructor(){this.txt=this.txtrng=null}}Object(m.a)(Rw,"TextModificationData",null,[]);class fv{constructor(a,
b){this.textRange=new uk(a.cp,a.len);this.text=b}}Object(m.a)(fv,"TextModificationInfo",null,[]);class gv{constructor(){this.len=this.cp=0}}Object(m.a)(gv,"TextRangeData",null,[]);class xy{constructor(){this.charPrp=this.txtrng=null}}Object(m.a)(xy,"WebTextCharFormatChange",null,[]);class hv{constructor(){this.paraPrp=this.txtrng=null}}Object(m.a)(hv,"WebTextParaFormatChange",null,[]);class Lr{constructor(a,b){this.KAg=this.EYa=this.HFb=this.dna=this.FU=-1;this.qFe=this.Vve=null;this.vXa=new uk(0,
0);this.xma=new uk(0,0);this.a1=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.tDb=a;this.Lgb=b;let c,f;({AZe:a,LPe:c}=this.veg(a.eSb));1<a.length&&(this.KAg=a[a.length-1].to.dH());({AZe:b,LPe:f}=this.veg(b.eSb));this.KO=new Tt(this.tDb,this.Lgb,c,f,a,b)}zHi(){this.qHi();this.rHi();this.BHi();const a=[],b=this.HHi();b&&a.push(b);a.push.apply(a,this.xHi());a.push.apply(a,this.wHi());a.push.apply(a,this.yHi());return a}veg(a){const b=
[],c=[];var f=[];var l=[];let y=0;if(!a.pField)return{AZe:f,LPe:l};for(const G of a.pField)if(a=new Rt,a.vIa=G,a.to=new uk(y,0),f=0,G.itemsField&&G.itemsField.length){for(const R of G.itemsField)R.tField&&R.tField.length&&(l=new St,l.to=new uk(y,R.tField.length),l.jJa=R,y+=R.tField.length,f+=R.tField.length,b.push(l));y+=1;a.to.len=f;c.push(a)}return{AZe:b,LPe:c}}qHi(){this.FU=this.Ygd(!0)}rHi(){this.FU===this.tDb.shapeText.length?this.dna=0:(this.dna=this.Ygd(!1),this.FU+this.dna>this.tDb.shapeText.length?
this.dna=this.tDb.shapeText.length-this.FU:this.FU+this.dna>this.Lgb.shapeText.length&&(this.dna=this.Lgb.shapeText.length-this.FU))}BHi(){this.HFb=this.tDb.shapeText.length-this.FU-this.dna;this.EYa=this.Lgb.shapeText.length-this.FU-this.dna}xHi(){const a=[];if(!this.FU)return a;this.KO.Ltd(new uk(0,this.FU),new uk(0,this.FU));do this.a1=this.WMh(),0!==this.a1.Tq&&a.push(this.lVc(this.a1));while(0!==this.a1.Tq);return a}HHi(){if(!this.HFb&&!this.EYa)return null;this.vXa=new uk(this.FU,this.HFb);
this.xma=new uk(this.FU,this.EYa);this.a1=!this.HFb&&0<this.EYa?new Ip(4):0<this.HFb&&!this.EYa?new Ip(5):new Ip(6);return this.lVc(this.a1)}wHi(){const a=[];if(!this.EYa)return a;const b=new uk(this.FU-1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.KAg-1);this.KO.Ltd(b,new uk(this.FU,this.EYa));do this.a1=this.rOl(),0!==this.a1.Tq&&a.push(this.lVc(this.a1));while(0!==this.a1.Tq);return a}yHi(){const a=[];if(!this.dna)return a;this.a1=null;this.KO.Ltd(new uk(this.FU+this.HFb,this.dna),new uk(this.FU+
this.EYa,this.dna));do this.a1=this.WMh(),0!==this.a1.Tq&&a.push(this.lVc(this.a1));while(0!==this.a1.Tq);return a}lVc(a){if(!a)return null;const b=new qo;b.chngTyp=a.Tq;switch(a.Tq){case 3:b.charFrmtChng=Object.assign(new xy,{txtrng:this.xma,charPrp:this.Vve});break;case 2:b.paraFrmtChng=Object.assign(new hv,{txtrng:this.xma,paraPrp:this.qFe});break;case 4:b.insChar=Lr.O7e(new fv(this.vXa,this.Lgb.shapeText.substring(this.xma.cp,this.xma.dH())));break;case 5:b.delChar=Lr.O7e(new fv(this.vXa,""));
break;case 6:b.repChar=Lr.O7e(new fv(this.vXa,this.Lgb.shapeText.substring(this.xma.cp,this.xma.dH())))}return b}Ygd(a){const b=this.tDb.shapeText,c=this.Lgb.shapeText,f=new uk(0,b.length),l=new uk(0,c.length);let y=a?0:b.length-1,G=a?0:c.length-1;for(;f.contains(y)&&l.contains(G)&&b.charAt(y)===c.charAt(G);)y=a?y+1:y-1,G=a?G+1:G-1;return a?y:b.length-y-1}rOl(){do{for(;this.KO.ZOl();){var a=this.KO.OSf(),b=this.KO.PSf();if(a&&b){var c=Pw(a.jJa,b.jJa);this.vXa=uk.copy(a.to);this.xma=uk.copy(b.to);
if(c)return this.Vve=c,new Ip(3)}}if(this.KO.ibc()&&(a=this.KO.MSf(),b=this.KO.NSf(),a&&b&&(c=Qw(a.vIa,b.vIa),this.vXa=uk.copy(a.to),this.xma=uk.copy(b.to),c)))return this.qFe=c,this.KO.yNh(),new Ip(2)}while(this.KO.yNh());return new Ip(0)}WMh(){do{for(;this.KO.YOl();){var a=this.KO.OSf(),b=this.KO.PSf();if(a&&b){var c=Pw(a.jJa,b.jJa);this.vXa=uk.copy(a.to);this.xma=uk.copy(b.to);if(c)return this.Vve=c,new Ip(3)}}if(this.KO.voe()&&(a=this.KO.MSf(),b=this.KO.NSf(),a&&b&&(c=Qw(a.vIa,b.vIa),this.vXa=
uk.copy(a.to),this.xma=uk.copy(b.to),c)))return this.qFe=c,this.KO.xNh(),new Ip(2)}while(this.KO.xNh());return new Ip(0)}static O7e(a){return Object.assign(new Rw,{txt:a.text,txtrng:Lr.lKl(a.textRange)})}static lKl(a){return Object.assign(new gv,{cp:a.cp,len:a.len})}}Object(m.a)(Lr,"IncrementalChangeIterator",null,[]);class Sw{constructor(){this.rh=this.bh=this.increq=null}}Object(m.a)(Sw,"TextLayoutDeltaClientRequestData",null,[]);class iv{constructor(){this.tb=null;this.h=this.w=0}}Object(m.a)(iv,
"TextLayoutFullClientRequest",null,[]);class jv{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(m.a)(jv,"TextLayoutRequest",null,[]);class Ns{constructor(a,b,c,f,l,y){this.bjc=this.Zl=null;this.lgc=!0;this.AIa=-1;this.Sqk=(new Date).getTime();this.Ifb=this.wma=0;this.efc=-1;this.$ve=5E3;const G=document.createElement("a");G.href=a;G.protocol="http:"===G.protocol?"ws":"wss";this.VHb=G.href;this.p5=b;this.X2b();this.wOg=c;this.GPg=f;this.nqk=l;this.IFe=y.gKl;this.Fbd=
y.fKl;this.UZg=y.cKl;this.Vdd=y.bKl;this.yna=this.UZg;this.h2e()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.qJb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.GPg&&this.GPg(a)}catch(b){ya.a.J(578828128,824,50,(this.p5?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.wOg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.lgc;this.wOg(b)}this.lgc=
!1}else ya.a.J(592304271,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){ya.a.J(592840414,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){ya.a.J(592840412,820,10,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){ya.a.J(592840410,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.isc();this.ping();this.nqk()}h2e(){this.bjc=
()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.efc),this.Zl||(ya.a.J(587522389,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Lya())):this.efc=window.setTimeout(()=>{this.Zl&&(ya.a.J(587522387,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Zl.close(),this.Zl=null,window.clearTimeout(this.AIa))},this.$ve)};
window.self.addEventListener("visibilitychange",this.bjc)}X2b(){this.Zl&&this.Zl.close();this.Zl=new WebSocket(this.VHb,[]);this.Zl.onopen=Object(H.a)(this,this.onOpen,"onOpen");this.Zl.onerror=Object(H.a)(this,this.onError,"onError");this.Zl.onclose=Object(H.a)(this,this.onClose,"onClose");this.Zl.onmessage=Object(H.a)(this,this.onMessage,"onMessage")}isc(){this.wma=0}pVd(){0<this.Vdd&&(new Date).getTime()-this.Ifb>this.Vdd&&(this.isc(),ya.a.J(587337758,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}lZd(){return(new Date).getTime()-
this.Ifb>this.yna&&this.wma<this.Fbd&&(!this.Zl||3===this.Zl.readyState||2===this.Zl.readyState)}q1e(){this.Ifb=(new Date).getTime();this.yna=Math.pow(2,this.wma)*this.UZg;0<this.Vdd&&(this.yna=Math.min(this.yna,this.Vdd));window.setTimeout(()=>{this.Lya()},this.yna)}Lya(){this.pVd();this.lZd()&&(this.X2b(),this.q1e(),this.wma++,ya.a.J(588071072,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.wma===this.Fbd&&ya.a.J(588071070,820,50,(this.p5?"Dark Traffic ":
"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.Zl?(ya.a.J(587804674,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",fp[this.Zl.readyState]),1===this.Zl.readyState?this.Zl.send(Nd.c(a)):this.Lya()):ya.a.J(587522383,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.Zl?1===this.Zl.readyState?this.Zl.send("ping"+((new Date).getTime()-this.Sqk).toString()):(ya.a.J(588294232,
820,10,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.Zl.readyState),this.Lya()):ya.a.J(587522380,820,50,(this.p5?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}qJb(){-1!==this.AIa&&window.clearTimeout(this.AIa);this.AIa=window.setTimeout(()=>{this.ping()},this.IFe)}}Object(m.a)(Ns,"WebSocketTextLayoutFetcher",null,[1395]);class fr{constructor(a,b,c,f,l,y,G){this.iHb=this.Ygb=this.WFg=this.VFg=null;this.nextId=1;this.fwe=
-1;this.ewe=0;this.Tze=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");if(!y)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ga=a;this.qq=b;this.Tfa=f;this.la=l;this.TU=-1;y.execute(R=>{this.Ygb=R});this.la.iKl&&(this.VFg=new Ns(this.la.eKl,!1,Object(H.a)(this,this.jgk,"logOnResponseReceived"),Object(H.a)(this,
this.SMk,"onTextLayoutReceived"),Object(H.a)(this,this.T$g,"onConnectionOpen"),this.la),this.la.Fjh&&(this.WFg=new Ns(this.la.dKl,!0,Object(H.a)(this,this.igk,"logOnDarkTrafficResponseReceived"),null,Object(H.a)(this,this.T$g,"onConnectionOpen"),this.la)));this.Dfa=G}UM(a,b,c){ya.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.TU){window.clearTimeout(this.TU);this.TU=-1;var f=this.qq.presentation;f?(a=Object(sa.a)(116,f.XC(nc.a.ax(a,
b))))?(c=a.MQ(c))?c.Inb(!1):ya.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):ya.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):ya.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}hgk(){this.ewe++;-1===this.fwe&&(this.fwe=window.setTimeout(Object(H.a)(this,this.TFk,"onCoauthLogTimer"),3E5))}TFk(){this.fwe=-1;ya.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.ewe);this.ewe=0}Vcg(a){let b=
"";a.vG(c=>{(c=Object(sa.a)(Kf.AParagraphNode,c))&&(b+=zb.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}AHi(a){try{var b=Object,c=b.assign,f=new Sw,l=this.iHb;const za=[];var y,G=l.eSb.bodyPrField,R=a.eSb.bodyPrField;let Va=!1;G.anchorField!==R.anchorField&&(Va=!0);G.bInsField!==R.bInsField&&(Va=!0);G.tInsField!==R.tInsField&&(Va=!0);G.lInsField!==R.lInsField&&(Va=!0);G.rInsField!==R.rInsField&&(Va=!0);G.horzOverflowField!==R.horzOverflowField&&(Va=!0);G.vertOverflowField!==R.vertOverflowField&&
(Va=!0);Nd.c(G.normAutofitField)!==Nd.c(R.normAutofitField)&&(Va=!0);Nd.c(G.spAutoFitField)!==Nd.c(R.spAutoFitField)&&(Va=!0);G.rotField!==R.rotField&&(Va=!0);G.spcFirstLastParaField!==R.spcFirstLastParaField&&(Va=!0);G.wrapField!==R.wrapField&&(Va=!0);(y=Va?R:null)&&za.push(Object.assign(new qo,{chngTyp:1,bodyPrChng:y}));const hb=new Lr(l,a);var ja=za.concat.apply(za,hb.zHi());const Cb=c.call(b,f,{increq:ja});ya.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",
Nd.c(Cb).length);return Cb}catch(za){ya.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",za.message)}return null}j8d(a,b){if(this.la.LKh&&a)if(b&&ya.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),this.Tfa.Czi())if(0!==this.Tfa.PCi(a,this.Ga))a.Inb(!1);else{if(!a.qEb)if(b)a.Inb(this.la.qQb);else return;if(!a.mA&&a.p9().length&&(a.KMa||4===a.mL))try{const c=this.Lfe(a),f=Object.assign(new jv,
{id:this.nextId.toString(),corr:oh.a.create().toString()});if(this.la.hKl)if(!this.iHb||b||this.Tze)this.iHb=new Lm(this.Vcg(a),c),this.Tze=!1;else{const y=this.Vcg(a),G=new Lm(y,c),R=Nt.a.Sxb(Nd.c(this.iHb.eSb));f.delta=this.AHi(G);f.delta&&(f.delta.bh=R,f.delta.rh=Nt.a.Sxb(Nd.c(G.eSb)));if(f.delta&&!f.delta.increq.length)if(this.la.N7e)f.delta=null;else return;if(f.delta&&f.delta.increq.length)for(const ja of f.delta.increq)if(ja.repChar){ja.repChar.txtrng.len===this.iHb.shapeText.length&&(f.delta=
null);break}this.iHb=G}f.delta&&f.delta.increq.length&&!this.la.N7e||(f.full=Object.assign(new iv,{tb:c,w:a.KMa?a.KMa.Right:a.get_widthPersisted(),h:a.KMa?a.KMa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.TU&&window.clearTimeout(this.TU);this.TU=window.setTimeout(()=>{this.UM(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.jKl);f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.TU;f.h.reqHash=
Nt.a.Sxb(Nd.c(c));f.h.reqSz=Nd.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.N7e;const l=a.zyj();b&&l&&(f.h.initialTextLayout=l.toString());this.VFg.fetch(f);this.la.Fjh&&this.WFg.fetch(f)}catch(c){ya.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.hgk(),a.Inb(!1)}BPf(a,b){switch(a.listType){case 16:b.buNoneField=new Mw;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new Lw,
{startAtField:a.VA});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new wy,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new Gm,b.buFontField.typefaceField=a.font}}qUa(a){const b=new Qt;b.__type=fr.Tbk;b.valField=Math.floor(1E5*a);return b}eLi(a){const b=new Ms;var c=new ub.GraphIterator;c.set(a);c.rc(11);c.Jg(11);a.Vf.Hv(c)?this.BPf(a.Vf.Hv(c),b):this.BPf(cb.a.SN(16,0),b);c=a.sa(sb.a.um,Ke.a.leftMargin);const f=a.sa(sb.a.QY,Ke.a.rightMargin);b.indentField=
Oe.a.Ryd(a.sa(sb.a.xo,Ke.a.indent));b.indentFieldSpecified=!0;b.marLField=Oe.a.Ryd(c);b.marLFieldSpecified=!0;b.marRField=Oe.a.Ryd(f);b.marRFieldSpecified=!0;b.defTabSzField=Oe.a.Ryd(a.sa(sb.a.hwb,fr.mMc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(sb.a.listLevel,Ke.a.xFa);b.lvlFieldSpecified=!0;b.algnField=this.$Jl(a.sa(Ya.a.Vl,1));b.algnFieldSpecified=!0;2===this.Dfa.fX(a).lineSpacing.unit&&(b.lnSpcField=new Pt,b.lnSpcField.itemField=this.qUa(this.Dfa.fX(a).lineSpacing.value));2===this.Dfa.fX(a).beforeSpacing.unit&&
(b.spcBefField=new Pt,b.spcBefField.itemField=this.qUa(this.Dfa.fX(a).beforeSpacing.value));2===this.Dfa.fX(a).afterSpacing.unit&&(b.spcAftField=new Pt,b.spcAftField.itemField=this.qUa(this.Dfa.fX(a).afterSpacing.value));a=rc.OutlineElementNavigator.AB(a);a.properties.Ta(Ya.a.PY)&&(b.rtlField=a.Sh(Ya.a.PY));return b}$Jl(a){switch(a){case 2:return 1;case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}Lfe(a){try{const b=Object.assign(new Nw,{bodyPrField:new Ls,pField:[]});b.bodyPrField.noAutofitField=
a.Aaa?new yq:null;a.Ta(va.a.B3)&&(b.bodyPrField.normAutofitField=new dv,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.B3));a.Ta(va.a.rsa)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new dv),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.rsa));b.bodyPrField.rotField=Math.floor(a.Q7e);b.bodyPrField.vertField=a.o2;b.bodyPrField.lInsField=Math.floor(ve.a.wIb(a.wja));b.bodyPrField.tInsField=Math.floor(ve.a.wIb(a.yja));b.bodyPrField.rInsField=
Math.floor(ve.a.wIb(a.xja));b.bodyPrField.bInsField=Math.floor(ve.a.wIb(a.vja));b.bodyPrField.anchorField=a.Ppa;b.bodyPrField.wrapField=a.p4c?0:1;this.Ga.vG(a,c=>{if(c=Object(sa.a)(Kf.AParagraphNode,c)){var f=Object.assign(new Ow,{itemsField:[]});f.pPrField=this.eLi(c);for(var l=zb.ParagraphReader.text(c),y=0;y<c.Sa.length;){const R=new ev;R.__type="CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var G=c.Sa.ga(y);const ja=G.cp,za=y<c.Sa.length-1?c.Sa.ga(y+1).cp:zb.ParagraphReader.textLength(c);
y++;G.formatting?R.rPrField=this.weg(G.formatting.cache):(G=Ot.c(c.Sa,G.cp).m5c,R.rPrField=G?this.weg(G.cache):this.Cyj(a));R.tField=na.a.substring(l,ja,za);f.itemsField.push(R)}b.pField.push(f)}});return b}catch(b){throw ya.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");}}weg(a){const b=new er;b.bField=a.isBold;b.bFieldSpecified=a.XUa;b.iField=a.isItalic;b.iFieldSpecified=a.nbb;b.uField=a.uE;b.uFieldSpecified=a.Nzb;
b.strikeFieldSpecified=a.Mzb;b.strikeField=a.cG;b.szField=a.fontSize*qg.a.rpc*qg.a.wbb;b.szFieldSpecified=a.rua;b.baselineFieldSpecified=a.Ta(va.a.IN);b.baselineField=a.eb(va.a.IN);b.capFieldSpecified=a.YUa;b.capField=a.capitalization;if(a.Tig){const c=ab.a.He(a.language);b.langField=c?c.Gxb:"en-US"}a.Ta(va.a.latinFont)&&(b.latinField=Object.assign(new Gm,{typefaceField:a.eb(va.a.latinFont)}));a.Ta(va.a.eastAsianFont)&&(b.eaField=Object.assign(new Gm,{typefaceField:a.eb(va.a.eastAsianFont)}));a.w4&&
(b.rawSolidFillField=Object.assign(new cv.a,{srgbClrField:Object.assign(new po.a,{valField:oc.a.Wtb(a.fontColor)})}));a.cVa&&(b.highlightField=Object.assign(new th.a,{srgbClrField:Object.assign(new po.a,{valField:oc.a.Wtb(a.highlight)})}));a.Ta(va.a.Wub)&&(b.spcField=a.eb(va.a.Wub),b.spcFieldSpecified=!0);a.Ta(va.a.xCb)&&(b.kernField=a.eb(va.a.xCb),b.kernFieldSpecified=!0);return b}Cyj(a){const b=new er;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.uE;
b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.cG;b.szField=a.uba*qg.a.rpc;b.szFieldSpecified=!!b.szField;const c=ab.a.He(a.iUa());b.langField=c?c.Gxb:"en-US";a.Ta(va.a.latinFont)&&(b.latinField=Object.assign(new Gm,{typefaceField:a.eb(va.a.latinFont)}));a.Ta(va.a.eastAsianFont)&&(b.eaField=Object.assign(new Gm,{typefaceField:a.eb(va.a.eastAsianFont)}));b.baselineField=a.IN;b.baselineFieldSpecified=!0;return b}jgk(a){if(a){ya.a.J(512493790,820,50,kh.c(a));var b=new Map;for(let l in a){var c=
l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}Sf.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else ya.a.J(512493791,820,50,"response data null")}igk(a){a?ya.a.J(512493788,820,50,"Dark Traffic"+kh.c(a)):ya.a.J(512493789,820,50,"Dark Traffic response data null")}T$g(){this.Tze=!0}T7f(a){var b=this.qq.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.wnb(a,"cid"),f=this.wnb(a,"sid");a=this.wnb(a,"shapeId");
if(!c||!f||!a)return ya.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(sa.a)(116,b.XC(nc.a.ax(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.MQ(Number.parseInvariant(a)):(ya.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}SMk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&a.h)ya.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.T7f(a.h))?this.j8d(a,!0):ya.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");
else{if(ya.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?Sf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new Ak.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),Sf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new Ak.a,{extendedProperties:b})))}}else if(this.la.qQb){b=
this.wnb(a.h,"timeoutId");var c=this.wnb(a.h,"firstRequest");if(b&&-1!==this.TU&&this.TU===Number.parseInvariant(b))window.clearTimeout(this.TU),this.TU=-1;else if(!c||!Boolean.parse(c))return;if(b=this.T7f(a.h)){var f=this.wnb(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),Sf.Health.instance.recordKpiFailure("TextLayoutServiceResponse",
"ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new Ak.a,{extendedProperties:c})),ya.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.Inb(!1)):b.Inb(!0):(f=this.wnb(a.h,"reqHash"))?(c=this.Lfe(b),Nt.a.Sxb(Nd.c(c))!==f?ya.a.J(512493779,820,50,"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.Ygb&&this.Ygb.prl(f,a.l,b),b.Szd(a.l))):ya.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else ya.a.J(512493782,
820,50,"OnTextLayoutReceived - IShapeNode is null")}}wnb(a,b){return b in a?a[b].toString():null}}fr.Tbk="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";fr.mMc=1440;Object(m.a)(fr,"TextLayoutManager",null,[993]);var Os;(function(a){a[a.noWall=0]="noWall";a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(Os||(Os={}));Object(m.b)("TextLayoutWall",Os);var Ps=d(886);class yy{constructor(a,
b){this.lEe=new Qe.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.oXa=a;this.Tfa=b.OKh}mdc(a){switch(a){case 1:return!!this.Tfa.COAUTH;case 2:return!!this.Tfa.LINEBREAKBLOBS;case 3:return!!this.Tfa.TABLE;case 4:return!!this.Tfa.SMARTART;case 5:return!!this.Tfa.NONRECTSHAPE}return!1}Czi(){return!this.mdc(1)||this.oXa.Lta}cDi(a,b){return a?this.mdc(2)&&Ps.a.K0f(a,b)?2:this.mdc(3)&&a.xd?3:this.mdc(4)&&a.Wf?4:this.mdc(5)&&4!==a.mL?5:0:0}PCi(a,
b){b=this.cDi(a,b);if(!this.lEe.Gb(a.eNa)||this.lEe.ga(a.eNa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.eNa.toString());c.set("IsShapeWalled",Os[b]);Sf.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",Os[b]),Sf.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new Ak.a,{extendedProperties:c})))}this.lEe.$(a.eNa,b);return b}}Object(m.a)(yy,
"TextLayoutServiceWalls",null,[992]);class zq{constructor(a,b,c,f){this.Ys=a;this.We=b.Na;this.QO=c;this.K$c=f}initialize(){this.Ys.NQa(Object(H.a)(this,this.fCf,"adjustShapeViews"))}dispose(){this.Ys.uMb(Object(H.a)(this,this.fCf,"adjustShapeViews"))}fCf(a,b){if((a=b.zG)&&a.$c&&(a=a.$c.W_(c=>c.isEditable&&c.bR))&&a.length)for(const c of a)if(a=Object(sa.a)(117,c.rg(this.We)))a.ARh(),c.xd&&a.lo&&a.bVl(),!this.K$c||this.QO&&!b.c4c||a.fM||!a.GB||a.ZIh()}}Object(m.a)(zq,"TextLocalRenderAdjustManager",
null,[108]);class Ut{constructor(){this.llc=this.rGb=null;this.fCg=-1;this.rfc=Date.now()}uig(){return 0<=this.fCg}}Object(m.a)(Ut,"LineBreakComparison",null,[]);class Mr{constructor(a){this.HH=new Qe.a;this.GNg=0;this.nIf="TextLayoutServiceAccuracy";this.Ukc=a}orl(a,b){try{if(a&&b){var c=a.vy(),f=Nt.a.Sxb(Nd.c(b.Lfe(a)));if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const y=Eg.a.ui(c[l],va.a.pQb,null);y&&(b.push.apply(b,y.Lines),b.push(-1))}if(b.length){if(!this.HH.Gb(f))this.HH.add(f,new Ut);
else if(this.HH.ga(f).uig())return;this.HH.ga(f).rGb=b;this.mOf(f,a)}}}}catch(l){ya.a.J(512493704,820,10,l.message)}}prl(a,b,c){try{if(!this.HH.Gb(a))this.HH.add(a,new Ut);else if(this.HH.ga(a).uig())return;this.HH.ga(a).llc=b;this.mOf(a,c)}catch(f){ya.a.J(512493703,820,10,f.message)}}mOf(a,b){if(this.HH.ga(a)&&this.HH.ga(a).rGb&&this.HH.ga(a).llc){var c=!0;if(this.HH.ga(a).rGb.length!==this.HH.ga(a).llc.length)c=!1;else for(var f=0;f<this.HH.ga(a).rGb.length;f++)if(this.HH.ga(a).rGb[f]!==this.HH.ga(a).llc[f]){c=
!1;break}ya.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.p9().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());Sf.Health.instance.recordKpiUsage(this.nIf,0,"pptotext",f);c||(f.set("UnifiedResponseLineCount",this.HH.ga(a).rGb.length.toString()),f.set("TextLayoutResponseLineCount",this.HH.ga(a).llc.length.toString()),Sf.Health.instance.recordKpiFailure(this.nIf,
"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new Ak.a,{extendedProperties:f})));this.HH.ga(a).fCg=Date.now()}this.qDi()}qDi(){const a=Date.now();a-this.GNg<this.Ukc||(this.HH.keys.forEach(b=>{a-this.HH.get(b).rfc>this.Ukc&&this.HH.remove(b);return!0}),this.GNg=a)}}Object(m.a)(Mr,"ServiceComparisonLineBreakTelemetry",null,[994]);class kv{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Xb(a){this.K=a;this.K.register(Jr,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").na().oa(()=>
new Jr(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(Kw,"PowerPointWebEditor.ShapeViewElementTextEditHandler").na().oa(()=>new Kw(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ia("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,a.Ia("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(zq,"PowerPointWebEditor.TextLocalRenderAdjustManager").na().oa(()=>new zq(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,
a.resolve("PowerPointWebEditor.IApplicationSettings").Fpg));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").LKh;ya.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",b);b&&(this.K.register(992,"PowerPointWebEditor.ITextLayoutServiceWallManager").na().oa(()=>new yy(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(993,"PowerPointWebEditor.ITextLayoutManager").na().oa(()=>{try{return new fr(a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),w.AFrameworkApplication.Je,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ia("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return ya.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),
this.K.register(994,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").na().oa(()=>new Mr(this.K.resolve("PowerPointWebEditor.IApplicationSettings").aKl)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.Fpg&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){n.a.instance.Ac(new kv)}}Object(m.a)(kv,"PPTWebEditorTextEditingPackage",null,[2,3]);class Vt{constructor(){this.capabilities=2}}Object(m.a)(Vt,"IExternalPeopleAPI",null,[]);class Tw{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(m.a)(Tw,"ExternalGrantAccessResponse",null,[]);class Uw{constructor(a,b,c,f){this.authorImageURL=
this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(m.a)(Uw,"PersonaIconProperties",null,[]);var lv=d(678),Jp=d(679),mv=d(538);class Vw extends Vt{constructor(a,b,c,f,l){super();this.eW=a;this.d7h=b;this.Zif=c;this.EWh=l}Sfh(a){this.eW.Yya=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.eW.uog.continueWith(c=>{c.jo||c.Hm?(ha.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(Jp.a.qt(-2130915318))):
a(this.eW.uog.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.eW.checkUserAccess([a]);f.continueWith(l=>{l.jo||l.Hm?(ha.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(Jp.a.qt(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){ha.ULS.sendTraceTag(37582727,380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.eW.$Ca(a);f.continueWith(l=>{if(l.jo||l.Hm)ha.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),
c(Jp.a.qt(-2130915318));else{l=f.result;var y=!l.Canceled;for(var G of l.Result)if(!G.UserCanWrite&&!G.UserCanReview){y=!1;break}G=new Tw(y,l);b(G)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const y=this.eW.getUserContacts(a,b,0,c,"AtMentions");y.continueWith(G=>{G.jo||G.Hm?(ha.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(Jp.a.qt(-2130915318))):f(y.result)})})}getAuthToken(){ha.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,
b)=>{this.Zif.continueWith(c=>{c.jo||c.Hm?(ha.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(Jp.a.qt(-2130915318))):this.Zif.result.coj().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(ha.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),a(f.token)):w.AFrameworkApplication.fa.Ha("LokiUserDataSignature")?(ha.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.EWh.execute(l=>{l.Cdj().then(y=>{void 0!==y&&
null!==y&&0<y.length?(ha.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(y)):0<w.AFrameworkApplication.fa.Ha("LokiUserDataSignature").length&&(ha.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),a(w.AFrameworkApplication.fa.Ha("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(ha.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(Jp.a.qt(-2130915318))):
(ha.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(Jp.a.qt(-2130915318)))}).catch(f=>{ha.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(Jp.a.qt(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>{const c=[];for(const l of a){let y=null;var f=l;let G=l.Email;G&&""!==G||!l.UserId||""===l.UserId||"AD"!==l.Provider||(G=mv.a.e$a(l.UserId));G&&""!==G&&(y=this.eW.Tvb(G,l.Provider,
w.AFrameworkApplication.Pg,0),f=new lv.a(G,void 0,l.DisplayName));f=this.d7h.nua(f,2);Array.add(c,new Uw(l.DisplayName,l.UserId,f,y))}b(c)})}}Object(m.a)(Vw,"ExternalPeopleAPI",Vt,[]);class Wt{constructor(){this.d7a={};this.ppb={};this.BLd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in this.d7a?(b=this.d7a[a.UserId],!c||c in this.ppb||(this.ppb[c]=b)):c&&c in this.ppb&&(b=this.ppb[c],a.UserId&&(c in this.BLd?(delete this.BLd[c],this.d7a[a.UserId]=b):a.UserId in this.d7a||
(b=null)));return b}add(a,b){a.UserId&&(this.d7a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.ppb||(this.ppb[c]=b,a.UserId||(this.BLd[c]=!0))}Tfj(a){a=Array(a.PNc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of ta.a.JL(this.d7a))b=this.d7a[c],b.sources.contains(1)&&a[b.xNf]++;return a}normalize(a){return a?a.toLowerCase():null}}Object(m.a)(Wt,"ColorLookupDict",null,[]);class Kp{constructor(a,b){this.xNf=a;this.sources=new Oa.a;this.sources.add(b)}Pgi(a){this.sources.contains(a)||
this.sources.add(a)}}Object(m.a)(Kp,"ColorSource",null,[]);class nv{constructor(a){this.nTb=a;this.kSd=new Wt;this.lnf=-1;this.NWh=0}nua(a,b,c=!0){if(!this.nTb||!this.nTb.PNc.length)return ha.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.vbj();else if(!a.UserId&&!a.DisplayName)return ha.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.kSd.get(a);if(f)c=f.xNf,f.Pgi(b);
else{if(!c)return null;c=this.zpj();this.kSd.add(a,new Kp(c,b));this.lnf=c}return this.$fj(this.nTb.PNc[c])}zpj(){const a=this.nTb.PNc.length,b=this.kSd.Tfj(this.nTb),c=this.nlg(this.lnf,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.nlg(f,a))||(l=!0);else break;l&&ha.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");return f}nlg(a,b){return(a+1)%b}vbj(){return"anonymous"+ ++this.NWh}$fj(a){return 16777215>=a?"#"+na.a.vw((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}
Object(m.a)(nv,"PeopleColorUtils",null,[1220]);class Qs{constructor(a,b,c,f,l,y){this.vog=new Bk.a;this.ora=a;this.c7a=b;this.ixf=f;this.Ma=c;this.r7=l;this.mxf=y;this.Ma.$e(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=w.AFrameworkApplication.Mnb||w.AFrameworkApplication.dR,b=this.Ma.ka("PeopleEndPointIsEnabled");let c=b&&!a&&(this.Qoc||this.TPb&&this.UPb);const f=this.Ma.ka("DisableAtmentionsForTeams"),l=this.Ma.ka("ConsumerMentionsHostIsEnabled")||this.ixf.GIh;c=c&&l&&this.EIh&&
this.DIh&&!f;this.Ma.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.Ma.ka("OneDriveConsumerMentionsIsEnabled"));ha.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",c,b,this.Qoc,this.TPb,this.UPb,this.EIh,a,this.DIh);this.vog.Ng(c);c&&this.r7&&this.r7.Vj(4,Object(H.a)(this,this.WNe,"onInteractiveReady"))}WNe(){const a=
this.Ma.uc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.Hm||b.jo)&&ha.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get TPb(){return this.c7a.TPb}get A4c(){return this.mxf.A4c}get UPb(){return this.c7a.UPb}get Qoc(){return this.c7a.Qoc}get EIh(){return this.Ma.ka("SupportsAddActivities")}get DIh(){return this.Ma.ka("SupportsActivitiesNotification")}$Ca(a){return this.c7a.$Ca(a)}L3b(a,b){return this.c7a.L3b(a,
b)}get uog(){return this.vog.task}get Yya(){return this.ora.Yya}set Yya(a){this.ora.Yya=a}checkUserAccess(a){ha.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.c7a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.c7a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.ixf.getUserContacts(a,b,c,f,l)}Tvb(a,b,c,f){return this.mxf.Tvb(a,b,c,f)}supportsExchangeRestApis(){const a=new Bk.a,b=this.ora.supportsExchangeRestApis();b.continueWith(()=>{b.Hm||b.jo?a.Ng(!1):
a.Ng(!0)});return a.task}}Object(m.a)(Qs,"PeopleManager",null,[1218,1211]);var fq=d(386);class ov{}Object(m.a)(ov,"CheckUserAccessRequestItem",null,[]);class pv extends fq.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.N1d(c)}N1d(a){const b=[];for(const c of a)Array.add(b,Object.assign(new ov,{Id:c.UserId,Provider:c.Provider}));return b}ul(){return 1}}Object(m.a)(pv,"CheckUserAccessRequest",fq.a,[]);class qv extends fq.a{constructor(a,b,c,f,l,y,G){super(a,b);this.Filter=null;this.Skip=
this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=y;this.Skip=l;this.Scenario=G}ul(){return 2}}Object(m.a)(qv,"GetUserContactsRequest",fq.a,[]);class Ww extends fq.a{constructor(a,b,c,f,l,y,G){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.N1d(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=y;this.GrantReviewAccess=G}N1d(a){const b=[];for(const c of a)Array.add(b,
Object.assign(new ov,{Id:c.UserId,Provider:c.Provider}));return b}ul(){return 4}}Object(m.a)(Ww,"GrantUserAccessRequest",fq.a,[]);class rv extends fq.a{constructor(a,b){super(a,b)}ul(){return 5}}Object(m.a)(rv,"SupportsExchangeRestApisRequest",fq.a,[]);var Xt=d(537);class Nr{constructor(a,b,c,f){this.Yya=null;this.G8h=a;this.M3a=b;this.Ma=c;this.W3a=f}get gfl(){return this.Ma.uc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return ha.ULS.sendTraceTag(37757202,380,
15,"no user in the request"),a=new Bk.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;ha.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new Bk.a,c=this.W3a.execute(new pv(this.M3a(),null,a),(f,l,y)=>this.fRc(f,l,y,"CheckUserAccess"),this.Yya);c.continueWith(()=>{if(c.jo||c.Hm)b.EG(c.hj);else{var f=this.vRk(c.result.xj);b.Ng(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return ha.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new Bk.a,a.Ng(null),a.task;ha.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const y=new Bk.a,G=this.W3a.execute(new Ww(this.M3a(),null,a,b,c,f,l),(R,ja,za)=>this.fRc(R,ja,za,"GrantUserAccess"),this.Yya);G.continueWith(()=>{if(G.jo||G.Hm)ha.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",G.hj),y.EG(G.hj);else{var R=this.XQk(G.result.xj);y.Ng(R)}});return y.task}vRk(a){if(!a.data)return ha.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Wd)return ha.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=Xt.a.t9a(a.data.Wd);return a?a.Result?a.Result:(ha.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(ha.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}XQk(a){if(!a.data)return ha.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.Wd)return ha.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=Xt.a.t9a(a.data.Wd);return a?a.Result?a.Result:(ha.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(ha.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const y=new Bk.a,G=this.W3a.execute(new qv(this.M3a(),null,a,b,c,f,l),(R,ja,za)=>this.fRc(R,ja,za,"GetUserContacts"),
this.Yya);G.continueWith(()=>{if(G.jo||G.Hm)y.EG(G.hj);else{var R=G.result;try{const ja=this.uRk(R.xj);y.Ng(ja.Result)}catch(ja){y.EG(ja)}}});return y.task}uRk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.Wd)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=Xt.a.t9a(a.data.Wd);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new Bk.a,b=this.W3a.execute(new rv(this.M3a(),null),(c,f,l)=>this.fRc(c,f,l,"SupportsExchangeRestApisRequest"),this.Yya);b.continueWith(()=>{b.jo||b.Hm?(a.EG(b.hj),ha.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(ha.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.wK(!0))});return a.task}fRc(a,b,c,f){return this.G8h.Psb(a,2,c,b,2,f,null,!1,null,this.gfl)}}Object(m.a)(Nr,"PeopleRequestHandler",null,[1219]);class Xw{constructor(a,
b){this.eW=a;this.Ca=b;this.Ca.ya(F.a.WCi,ye.a.frame,Object(H.a)(this,this.RCi,"checkUserAccessAction"));this.Ca.ya(F.a.Vzj,ye.a.frame,Object(H.a)(this,this.Uzj,"getUserContactsAction"));this.Ca.ya(F.a.VCi,ye.a.frame,Object(H.a)(this,this.TCi,"checkUserAccessAndGrantPermissionsAction"));this.Ca.ya(F.a.$zj,ye.a.frame,Object(H.a)(this,this.Zzj,"getUserProfilePictureAction"));this.Ca.ya(F.a.qHl,ye.a.frame,Object(H.a)(this,this.rHl,"supportsExchangeRestApisTestAction"))}rHl(){this.supportsExchangeRestApis();
return 32}RCi(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}Uzj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}TCi(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.$Ca(a);return 32}Zzj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.dfg(a);return 32}Evh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.$Ca(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.dfg(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}oo.Task.delay(5E3).continueWith(()=>{this.Evh()})}qil(){window.setTimeout(Object(H.a)(this,
this.Evh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.eW.supportsExchangeRestApis();a.continueWith(b=>{if(b.Hm)alert("Exception: "+b.hj.message);else{b=a.result;var c=new sh.StandardDialog;c.Ad=0;c.Le(1,"Close");document.createElement("pre").innerText=b.toString();c.Tx("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}dfg(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.Wij(a)}catch(l){alert("Invalid dimension value");return}Fb.a.instance.Ia("Common.App.People.IPeopleManager").execute(l=>
{var y=l.Tvb(b,c,w.AFrameworkApplication.Pg,f);l=document.createElement("img");l.src=y;y=new sh.StandardDialog;y.Ad=0;y.Le(1,"Close");y.Tx("Profile photo",null,3,null,l)})}Wij(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.eW.L3b(a,"O365");
const b=this.eW.checkUserAccess(a);b.continueWith(c=>{if(c.Hm)alert("Exception: "+c.hj.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new sh.StandardDialog;l.Ad=0;l.Le(1,"Close");f=document.createElement("pre");f.innerText=c;l.Tx("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.eW.L3b(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),y=0<=c.toUpperCase().indexOf("REVIEW"),G=this.eW.grantUserAccess(a,b,f,l,y);G.continueWith(R=>{if(R.Hm)alert("Exception: "+R.hj.message);else{R=G.result;var ja="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(y?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const za of R.Result)ja+="User: "+za.Id+"\nMessage: "+za.Message+"\nStatus Code: "+za.Status+"\nProvider: "+za.Provider+"\n\n";alert(ja)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.eW.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(y=>{if(y.Hm)alert("Something went wrong"+y.hj.message);else if(y.jo)alert("Task was canceled");else{var G=l.result;y="";for(var R of G)G="ID => "+R.Id+" \n",G+="Provider => "+R.Provider+" \n",G+="DisplayName => "+R.DisplayName+" \n",G+="GivenName => "+R.GivenName+" \n",G+="Surname => "+R.Surname+" \n",G+="Email => "+R.Email+" \n",G+="Title => "+R.Title+" \n",y+=G+"----------------------\n";R=new sh.StandardDialog;R.Ad=0;R.Le(1,"Close");G=document.createElement("pre");G.innerText=y;
R.Tx("Contacts",null,3,null,G)}})}$Ca(a){a=a.split(";");a=this.eW.L3b(a,"O365");const b=this.eW.$Ca(a);b.continueWith(c=>{if(c.Hm)alert("Exception: "+c.hj.message);else{c=b.result;var f="";for(var l of c.Result){var y=[];Array.add(y,l.UserCanRead?"Read YES":"Read NO");Array.add(y,l.UserCanReview?"Review YES":"Review NO");Array.add(y,l.UserCanWrite?"Write YES":"Write NO");y=l.Id+"=>"+y.join(" | ");f+=y+"\r\n"}l=new sh.StandardDialog;l.Ad=0;l.Le(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.Tx("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(m.a)(Xw,"PeopleTestHook",null,[]);var Yt=d(198);class Yw{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(m.a)(Yw,"ShowSharingUiRequestBody",null,[]);class Zt{constructor(a,b){this.D6a=null;this.pGc=new Bk.a;this.iZb=new Yw(this.NPi(),a,b);ha.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.iZb.Persons?
this.iZb.Persons.length:0,this.iZb.UserPermissionsVerified)}get Lgl(){return this.pGc.task}get id(){return this.iZb.Id}get payload(){return this.iZb}nsl(a){this.D6a=a;this.YXl()?this.pGc.wK(this.D6a):this.pGc.EG(Error.format("Format of the "+ma.a.WZd+" body is not valid"))}setException(a){ha.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.pGc.EG(a)}NPi(){return Zt.I1h++}ZXl(a){if(void 0===a.Id)return ha.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return ha.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(ha.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(ha.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):na.a.DBb(a.Status)?!0:(ha.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}YXl(){if(void 0===this.D6a.Persons)return ha.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Ub.a.isArray(this.D6a.Persons))return ha.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.D6a.Persons.length;a++)if(!this.ZXl(this.D6a.Persons[a]))return!1;return void 0===this.D6a.DialogCanceled?(ha.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(ha.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):na.a.DBb(this.id)?!0:(ha.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}Zt.I1h=0;Object(m.a)(Zt,"PostmessageRequestState",null,[]);class sv{constructor(a){this.mOd=new Yt.a;this.EVb=this.M4a=null;this.Dkf=!1;this.LOa=a}TPj(){ha.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.EVb)return this.EVb.task;this.EVb=new Bk.a;this.LOa.continueWith(()=>{ha.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.M4a=this.LOa.result;this.nje();this.EVb.Ng(!0)});return this.EVb.task}nje(){this.Dkf||(ha.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.Dkf=!0,this.M4a.Nu(ma.a.WZd),this.M4a.fC(ma.a.WZd,Object(H.a)(this,this.UCi,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}UCi(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)ha.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.mOd.vg(a.Id)).returnValue?(ha.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.nsl(a),this.mOd.remove(a.Id)):ha.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else ha.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}SCi(a,b){const c=new Zt(a,b);this.TPj().continueWith(()=>{const f=oh.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,
f);ha.ULS.sendTraceTag(25036179,380,50,l);this.M4a.sendMessage(ma.a.$Ca,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.mOd.add(c.id,c)});return c.Lgl}}Object(m.a)(sv,"ShowSharingUiPostMessageHandler",null,[]);class Zw{}Object(m.a)(Zw,"GrantUserAccessResponse",null,[]);var ei=d(80);class Rs extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.LSk=a;this.IMa=c;this.scenario=f}}Object(m.a)(Rs,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class $t{static MNi(a){return ei.a.pz($t.Fo,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}$t.Fo="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(m.a)($t,"ShareAndNotifyDialogHtml",null,[]);class tv extends ei.a{constructor(a,b,c){super();this.pOa=!1;this.Oa=new Wc.a;this.f7h=a;this.gci=tv.gaj(a);this.ow=b;this.e_=c}fli(a){this.Oa.addHandler("SNEK",a)}j4e(){this.hg=$t.MNi(this.gci);this.Ad=8;this.ig="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(H.a)(this,this.Lvl,"shareAndNotifyDialogResultHandler"));this.J6("ShareAndNotifyDialogTextId")}Hxa(){}dispose(){this.pOa||(super.dispose(),this.pOa=!0)}Lvl(a){this.Oa.raiseEvent("SNEK",new Rs(this.f7h,a,this.ow,this.e_))}static gaj(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(m.a)(tv,"ShareAndNotifyDialog",ei.a,[]);class $w{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(m.a)($w,"ShowSharingUiRequestPerson",null,[]);class Aq{constructor(a,b,c,f,l,y){this.ora=a;this.Ma=b;this.w$h=c;this.mW=f;this.JXh=l;this.ae=y}get TPb(){return this.Ma.ka("SupportsCheckUserAccess")}get UPb(){return this.Ma.ka("SupportsGrantUserAccess")}get Qoc(){return this.Ma.ka("PermissionsPostMessage")&&!this.Ma.ka("CrossDocumentMessengerDisabled")&&this.JXh()}$Ca(a){const b=new Bk.a;if(Ub.a.Xa(a))return b.Ng(this.mW.bSa([])),b.task;let c;const f=({E1b:c}=this.mW.cbf(a)).returnValue,
l=Aq.fLi(f);0<f.length?this.Qoc?this.RAl(f,b,c,l):this.TPb&&this.UPb&&this.j4e(l,b,"mention"):b.Ng(this.mW.bSa(a));return b.task}RAl(a,b,c,f){const l=Date.now();ha.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const y=this.w$h.SCi(f,c);c=new pd.a(4,1,this.Ma.uc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(H.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.ae.Hb(c);c.customData=y;y.continueWith(G=>{if(G.Hm)ha.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",G.hj?G.hj.message:"No inner exception"),b.EG(G.hj);else{G=y.result;this.mW.$Rl(G);var R=this.mW.bSa(a);R.Canceled=G.DialogCanceled;b.Ng(R);ha.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){ha.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.jo?ha.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.Hm?ha.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||ha.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):ha.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}j4e(a,b,c){a=new tv(a,b,c);a.fli(Object(H.a)(this,this.hMk,"onShareAndNotify"));a.j4e()}hMk(a,b){let c;const f=Aq.jLi(b.LSk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.Hm?(ha.ULS.sendTraceTag(36300674,380,15,
"GrantUserAccess from OnShareAndNotify failed with exception. {0}",l.hj?l.hj.message:"No inner exception"),b.IMa.EG(l.hj)):(ha.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.mW.bSa(f),c.Canceled=!1,b.IMa.Ng(c))});break;default:ha.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.mW.bSa(f),c.Canceled=!0,b.IMa.Ng(c)}}checkUserAccess(a){const b=new Bk.a;if(!this.TPb)return ha.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),
b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),b.task;if(!a||!a.length)return b.Ng(this.mW.bSa([])),b.task;let c;const f=({E1b:c}=this.mW.cbf(a)).returnValue;if(c)ha.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Ng(this.mW.bSa(a));else{const l=this.ora.checkUserAccess(f);l.continueWith(()=>{if(l.jo||l.Hm)ha.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));
else{ha.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var y=l.result;y&&this.mW.YRl(y);y=this.mW.bSa(a);b.Ng(y)}})}return b.task}grantUserAccess(a,b,c,f,l){const y=new Bk.a;if(!this.UPb)return ha.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),y.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),y.task;if(!a||!a.length)return y.Ng(this.mW.aRf([])),y.task;let G;const R=({E1b:G}=
this.mW.cbf(a)).returnValue;if(G)ha.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),y.Ng(this.mW.aRf(a));else{const ja=this.ora.grantUserAccess(R,b,c,f,l);ja.continueWith(()=>{if(ja.jo||ja.Hm)ha.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),y.setException(Error.create("GrantUserAccess Call failed."));else{ha.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var za=ja.result;this.mW.ZRl(za,c,f,l);za=Object.assign(new Zw,{Result:za});
y.Ng(za)}})}return y.task}L3b(a,b){const c=[];for(const f of a)c.push(new lv.a(f,b));return c}static fLi(a){const b=[];for(const c of a)a=new $w(c.UserId,c.Provider,""),b.push(a);return b}static jLi(a){const b=[];for(const c of a)a=new lv.a(c.Id,c.Provider),b.push(a);return b}}Object(m.a)(Aq,"UserAccessUtils",null,[1211]);class ax{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=
a.Title)}}Object(m.a)(ax,"PersonaProperties",null,[]);class Bq{constructor(a,b){this.kuf=[];this.gDd=[];this.bof=-1;this.Ma=a;this.ora=b}get GIh(){return this.Ma.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){ha.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const y=new Map;y.set("Limit",b.toString());y.set("SearchGal",f.toString());y.set("Scenario",l);Sf.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser",
"wackpitesting",y);if(!this.GIh)return ha.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),Sf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new Bk.a,a.EG(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return ha.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),Sf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser",
"LimitShouldBeGreaterThanZero",!1,!0,null),a=new Bk.a,a.EG(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===l&&ha.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.bof&&!a&&!f)return a=new Bk.a,c=this.gDd.slice(0,Math.max(b-1,this.gDd.length-1)),c=this.a6g(this.kuf,c),a.Ng(c),a.task;const G=new Bk.a;let R;try{R=this.ora.getUserContacts(a,b,c,f,l)}catch(ja){return G.EG(ja),G.task}if(f||"AtMentions"!==l)return R;R.continueWith(ja=>{if(ja.jo||ja.Hm){ja=ja.jo?
"Canceled":ja.hj.message;ha.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",ja);var za=new Map;y.set("ErrorMessage",ja);za=Object.assign(new Ak.a,{extendedProperties:za});Sf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,za);G.EG(Error.create(ja))}else this.gDd=ja=R.result,this.bof=b,ja=this.a6g(this.kuf,ja),G.Ng(ja)});return G.task}a6g(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>
{this.rAf(f,c)});b.forEach(f=>{this.rAf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}rAf(a,b){if(a&&(a=new ax(a),a.Email&&a.DisplayName&&a.Id&&a.Provider)){const c=b[this.LRf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.LRf(a)]=a}}LRf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(m.a)(Bq,"UserContactsUtils",null,[1210]);class bx{}Object(m.a)(bx,"CheckUserAccessResponse",null,[]);class au{}Object(m.a)(au,"GrantUserAccessResponseItem",
null,[]);class cx{}Object(m.a)(cx,"UserPermissions",null,[]);class jp{constructor(){this.uN=new Yc.a;this.m6e=0}cbf(a){let b;const c=[];if(!a)return ha.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,E1b:!1};if(!a.length)return ha.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,E1b:!1};b=!0;const f={};for(const l of a){a=
jp.K1d(l);if(a in f)continue;f[a]=!0;const y=({value:a}=this.uN.vg(jp.K1d(l))).returnValue;y&&(!a||a.UserCanWrite||a.UserCanReview)||Array.add(c,l);b=b&&y}return{returnValue:c,E1b:b}}YRl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.uN.remove(jp.TOc(b));this.uN.add(jp.TOc(b),b)}}ZRl(a,b,c,f){if(!a)throw Error.argumentNull("result");
for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const y=jp.L1d(l.Id,l.Provider);({value:a}=this.uN.vg(y)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new cx,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.uN.remove(y),this.uN.add(y,a))}}}$Rl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");
a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");for(let b=0;b<a.length;b++){const c=new cx,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?ha.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.m6e,c.UserCanWrite=f.Status===this.m6e,c.UserCanReview=f.Status===this.m6e,c.Id=f.Id,c.Provider=f.Provider,this.uN.remove(jp.TOc(c)),
this.uN.add(jp.TOc(c),c))}}cfg(a){const b=[];for(const c of a)a=jp.K1d(c),this.uN.Gb(a)&&Array.add(b,this.uN.ga(a));return b}bSa(a){a=this.cfg(a);return Object.assign(new bx,{Result:a,Canceled:!1})}aRf(a){a=this.cfg(a);const b=[];for(const c of a)b.push(Object.assign(new au,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new Zw,{Result:b,Canceled:!1})}static TOc(a){return jp.L1d(a.Id,a.Provider)}static K1d(a){return jp.L1d(a.UserId,
a.Provider)}static L1d(a,b){return b+a}}Object(m.a)(jp,"UserPermissionsCache",null,[1209]);class dx{constructor(a,b,c,f){this.ora=a;this.Ma=b;this.jci=c;this.hci=f}Tvb(a,b,c,f){var l=this.ora.Yya;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new qj.QueryStringBuilder(l);l.xg("oid","3");l.xg("bdqs",c);(c=this.YKi(f))&&2<=c.length&&(f=c[1],l.xg("w",c[0]),l.xg("h",f));l.xg("uid",a);l.xg("p",b);l.xg("usid",this.jci);l.xg("WacUserType",this.hci);return l.toString()}YKi(a){switch(a){case 1:return["48",
"48"];case 2:return["64","64"];case 3:return["96","96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get A4c(){return this.Ma.ka("IsUserProfilePictureResolutionEnabled")}}Object(m.a)(dx,"UserProfilePictureUtils",null,[1207,1208]);var ex=d(581);class Ss{get name(){return"Common.App.People"}Xb(a){a.register(Nr,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").na().oa(()=>
new Nr(w.AFrameworkApplication.Je,()=>w.AFrameworkApplication.Pg,w.AFrameworkApplication.fa,new Xt.a));a.register(jp,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").na();a.register(sv,"Common.App.People.ShowSharingUiPostMessageHandler").na().oa(()=>new sv(Zm.a.Ot(a.Ia("Postmessage.IHostPostmessenger"))));a.register(Aq,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").na().oa(()=>new Aq(a.resolve("Common.App.People.PeopleRequestHandler"),
w.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),ex.a,Uj.a.instance));a.register(Bq,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").na().oa(()=>new Bq(w.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(dx,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").na().oa(()=>
new dx(a.resolve("Common.App.People.PeopleRequestHandler"),w.AFrameworkApplication.fa,w.AFrameworkApplication.userSessionId,w.AFrameworkApplication.userType));a.register(nv,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").na().oa(()=>new nv(a.rb("Common.IColorTable")));a.register(Qs,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").na().oa(()=>new Qs(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
w.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),Sd.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(Vw,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").na().oa(()=>new Vw(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),Zm.a.Ot(a.Ia("Common.ILokiTokenManager")),w.AFrameworkApplication.fa,a.Ia("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){w.AFrameworkApplication.fa&&
w.AFrameworkApplication.fa.$e(Object(H.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){const a=Fb.a.instance.resolve("Common.App.People.IPeopleManager");Fb.a.instance.resolve("Common.App.People.IExternalPeopleAPI");w.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new Xw(a,w.AFrameworkApplication.Qa)).qil()}dispose(){}static main(){n.a.instance.Ac(new Ss)}}Object(m.a)(Ss,"PeoplePackage",null,[2,3]);var gr={};gr.kSb=function(){function a(){return G()&&(ic()||3<=(hb()?yc("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f($d){$d=(new RegExp($d+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var nf=-1;null!=$d&&2<=$d.length&&(nf=parseFloat($d[1]),isNaN(nf)&&(nf=-1));return nf}function l(){Lp||(Lp=!0,bn=f("Windows Phone"));return 8<=bn}function y(){return"function"==typeof navigator.msLaunchUri&&!c()&&!lc()&&!R()}function G(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function R(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function ja(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function za(){return ja()?8==window.document.documentMode:!1}function Va(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function hb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Cb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function lc(){var $d=window.navigator.userAgent.toLowerCase();
return 0<=$d.indexOf("android")&&0<=$d.indexOf("chrome")}function ic(){return 3<=(Va()?yc("firefox/"):0)}function yc($d){var nf=window.navigator.userAgent.toLowerCase(),Pf=nf.indexOf($d);return 0<=Pf?parseInt(nf.substring(Pf+$d.length,nf.length)):0}function ec($d,nf,Pf,Fe,Eh){if(Fe&&null!=nf)nf();else if(y())navigator.msLaunchUri($d,nf,Pf);else if(!(Cb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&G())||R())xd($d,nf,
Pf);else if(Cb()&&Eh)a:{try{window.open($d,"_self")}catch(Aj){null!=Pf&&Pf();break a}null!=nf&&nf()}else jc($d,nf,Pf)}function jc($d,nf,Pf){var Fe=document.getElementById("OICLinkTag");null==Fe&&(Fe=document.createElement("a"),Fe.id="OICLinkTag",Fe.style.visibility="hidden",Fe.href="",0==(ui.Options&Kj.SupportsTopTargetNavigation)||ui.NoBrowserModalDialogs?Fe.target="_blank":Fe.target="_top",document.body.appendChild(Fe),null!=Fe.addEventListener&&Fe.addEventListener("click",function(Eh){null!=Eh.stopPropagation&&
Eh.stopPropagation()},!1));try{Fe.href=$d,Fe.dispatchEvent(new MouseEvent("click"))}catch(Eh){null!=Pf&&Pf();return}null!=nf&&nf()}function xd($d,nf,Pf){var Fe=document.getElementById("OICFrame");null==Fe&&(Fe=document.createElement("iframe"),Fe.className="ObjectInDialog",Fe.style.visibility="hidden",Fe.src="about:blank",document.body.appendChild(Fe),Fe.id="OICFrame");try{Fe.contentWindow.location.href=$d}catch(Eh){null!=Pf&&Pf();return}null!=nf&&nf()}function Xd($d){return 0!=($d.Options&Kj.SkipProtocolHandler)||
za()}function Qd($d){return $d===cn.ReadOnly||$d===cn.ReadWrite}function Ie($d,nf,Pf,Fe){var Eh;try{var Aj=new ActiveXObject("SharePoint.OpenDocuments.4");return(Eh=Aj.ViewDocument3(window.self,$d,nf,Fe))?(Mm(tj.O14ActiveX),vh.None):vh.Failed}catch(Lj){}if(Kj.O14Only===(Pf&Kj.O14Only))return ui.DescriptiveUnattemptedEnums?vh.O14AttemptFailure:vh.Unattempted;try{return Aj=new ActiveXObject("SharePoint.OpenDocuments.3"),(Eh=Aj.ViewDocument3(window.self,$d,nf,Fe))?(Mm(tj.O12ActiveX),vh.None):vh.Failed}catch(Lj){}if(Kj.O12UpOnly===
(Pf&Kj.O12UpOnly))return ui.DescriptiveUnattemptedEnums?vh.O12UpOnlyFail:vh.Unattempted;try{return Aj=new ActiveXObject("SharePoint.OpenDocuments.2"),(Eh=Qd(nf)?Aj.ViewDocument2(window.self,$d,Fe):Aj.EditDocument2(window.self,$d,Fe))?(Mm(tj.O11ActiveX),vh.None):vh.Failed}catch(Lj){}return ui.DescriptiveUnattemptedEnums?vh.ActiveXUnattempted:vh.Unattempted}function Pe($d,nf,Pf,Fe,Eh){$d==zg.Visio&&Pf==cn.ReadWrite&&(Pf=cn.WriteOnly);Fe=Fe||c()&&!l();if(!Fe){Fe="";if($d==zg.PowerPoint){$d=Fe;Fe=ui.DocumentExtension;
Pf=Qd(Pf);var Aj=new Set([".pot",".potm",".potx"]),Lj=new Set([".pps",".ppsm",".ppsx"]);Pf=Pf&&Aj.has(Fe)?"nft|ofc|":Pf&&Lj.has(Fe)?"ofv|ofs|t|":!Pf&&Lj.has(Fe)?"ofe|ofs|t|":Pf?"ofv|ofc|":"ofe|";Pf=$d+Pf}else Pf=Qd(Pf)?Fe+"ofv|ofc|":Fe+"ofe|";Fe=Pf;ui.NewTelemetryDataIsEnabled&&(Pf=ui.SessionOrigin?"or|"+ui.SessionOrigin+"|":"",Pf+=ui.ClickTime?"ct|"+ui.ClickTime+"|":"",Pf+=ui.CorrelationId?"cid|"+ui.CorrelationId+"|":"",Fe+=ff(Pf));Eh+=ff(Fe+"u|")}Eh+=ff(nf);nf=window.location.href;Pf=nf.toLowerCase().indexOf("&wdlor=");
-1!=Pf?(Pf+=7,$d=nf.indexOf("&",Pf),nf=-1==$d?nf.substr(Pf):nf.substring(Pf,$d)):nf=void 0;if(null!=nf&&"undefined"!=typeof nf){Pf="";try{Pf=decodeURIComponent(nf)}catch(uv){}0<Pf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Pf)&&(Eh=Eh+"|f|"+Pf)}return Eh}function ig($d,nf,Pf,Fe,Eh,Aj){var Lj=wg($d);if(null==Lj)return Jj(ui.DescriptiveUnattemptedEnums?vh.ProtocolHandlerIsNull:vh.Unattempted,ui.Application),!1;$d=Pe($d,nf,Pf,Fe,Lj);ec($d,bh,ch,Eh,Aj);return!0}function ff($d){if(G()&&
Cb()){var nf="";try{nf=decodeURI($d)}catch(Pf){}if(nf==$d)return encodeURI($d)}return $d}function bh(){Mm(tj.ProtocolHandler)}function ch(){ui.Options|=Kj.SkipProtocolHandler;Dh(ui,Vl,um)}function of(){null!=Kn&&Kn(tj.RoamingProtocolHandler)}function sg(){null!=wl&&wl(vh.ControlNeeded)}function Fg(){var $d=document.getElementById("npSharePointPlugin");if(null==$d){$d="application/x-sharepoint";G()&&3<=(hb()?yc("version/"):0)&&og("application/x-sharepoint-webkit",!0)&&($d="application/x-sharepoint-webkit");
if(!og($d,!0))if(G()&&og("application/officelive",!0))$d="application/officelive";else return null;var nf=document.createElement("object");nf.id="npSharePointPlugin";nf.type=$d;nf.style.width="0px";nf.style.height="0px";nf.style.setProperty("visibility","hidden","");document.body.appendChild(nf);$d=document.getElementById("npSharePointPlugin")}return $d}function og($d,nf){var Pf=window.navigator.mimeTypes;if(null==Pf)return!1;$d=Pf[$d];return!$d||nf&&!$d.enabledPlugin?!1:!0}function pi($d){try{if(null!=
new ActiveXObject($d))return!0}catch(nf){}return!1}function Wj($d){switch($d){case zg.OneNote:return"OneNote.Notebook";default:return""}}function wg($d){if($d!=zg.OneNote&&c()&&!l())return"office:";switch($d){case zg.Excel:return"ms-excel:";case zg.OneNote:return"onenote:";case zg.PowerPoint:return"ms-powerpoint:";case zg.Visio:return"ms-visio:";case zg.Word:return"ms-word:";case zg.Project:return"ms-project:";case zg.Publisher:return"ms-publisher:";case zg.Infopath:return"ms-infopath:";case zg.Access:return"ms-access:";
default:return""}}function Tg($d){switch($d){case zg.Excel:return"root\\office15\\excel.exe";case zg.PowerPoint:return"root\\office15\\powerpnt.exe";case zg.Visio:return"root\\office15\\visio.exe";case zg.Word:return"root\\office15\\winword.exe";case zg.Project:return"root\\office15\\winproj.exe";case zg.Publisher:return"root\\office15\\mspub.exe";case zg.Infopath:return"root\\office15\\infopath.exe";case zg.Access:return"root\\office15\\msaccess.exe";default:return null}}function Dh($d,nf,Pf){ui=
$d;Vl=nf;um=Pf;if($d.DocumentUrl){var Fe=Pf=nf=$d.DocumentUrl;try{Fe=decodeURIComponent($d.DocumentUrl)}catch(vv){}try{Pf=encodeURI($d.DocumentUrl)}catch(vv){}nf=nf+""+$d.CorrelationIdForWinClient;Fe+=$d.CorrelationIdForWinClient;Pf+=$d.CorrelationIdForWinClient;$d.Mode===cn.ReadWrite&&Kj.CheckoutRequired===($d.Options&Kj.CheckoutRequired)&&($d.Mode=cn.ForceCheckout);Kj.HostIsEditOnly===($d.Options&Kj.HostIsEditOnly)&&($d.Mode=cn.WriteOnly);if(Xd($d)?0:G()&&($d.Application==zg.OneNote||og("application/x-sharepoint-protocolhandler",
!1)||og("application/x-sharepoint-webkit-protocolhandler",!1))||y()||lc()||!(a()||ic()||"ActiveXObject"in window&&!c()||Cb())||15<=Nm())ig($d.Application,$d.EncodeUrl?Pf:nf,$d.Mode,$d.Application==zg.OneNote,$d.SilentExternalHandler,$d.NavigateUsingWindowOpen);else{var Eh;if(Eh=za())a:{var Aj=$d.EncodeUrl?nf:Fe,Lj=$d.Mode,uv=Wj($d.Application);try{Eh=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Aj,Lj,uv);break a}catch(vv){}Eh=!1}if(Eh)Mm(tj.O15ActiveX);else{if(a()||
ic()){var Om=$d.EncodeUrl?nf:Fe;Fe=$d.Mode;Eh=Wj($d.Application);Aj=Fg();if(null==Aj)Om=ui.DescriptiveUnattemptedEnums?vh.PluginIsNull:vh.Unattempted;else{Lj=!1;try{Lj=Aj.ViewDocument3(window.self,Om,Fe,Eh)}catch(vv){}if(!Lj)try{Lj=Qd(Fe)?Aj.ViewDocument2(window.self,Om,Eh):Aj.EditDocument2(window.self,Om,Eh)}catch(vv){}Lj?(Mm(tj.NpapiPlugin),Om=vh.None):Om=vh.Failed}}else{try{Om=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Om&&Om.SaveSSOCreds()}catch(vv){}Om=Ie($d.EncodeUrl?nf:Fe,$d.Mode,$d.Options,
Wj($d.Application))}if(Om!=vh.None){if(Fe=$d.CouldUseRoamingApps)Ln||(Ln=!0,uo=f("Windows NT")),Fe=6.1<=uo&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(ja()||ic()||Cb());if(Fe&&$d.Application!=zg.OneNote){if(!gr.kSb.V_l()){Jj(vh.ControlNeeded,ui.Application);return}if($d.RoamingAppsLauncher){"undefined"==typeof $d.RoamingAppsLauncher||null==$d.RoamingAppsLauncher?Jj(ui.DescriptiveUnattemptedEnums?vh.RoamingLauncherIsNull:vh.Unattempted,ui.Application):"undefined"==typeof $d.RoamingBitsUrl||
null==$d.RoamingBitsUrl?gr.kSb.b0l($d.DocumentUrl,$d.RoamingAppsLauncher,$d.Application,$d.ApplicationParameters,Vl,um):gr.kSb.iVh($d.DocumentUrl,$d.RoamingAppsLauncher,$d.RoamingApplicationExe,$d.ApplicationParameters,$d.RoamingPlatform,$d.RoamingBitsUrl,Vl,um);return}if(!$d.ContinueIfLauncherIsNull){Jj(vh.LauncherNeeded,ui.Application);return}}Kj.NoProtocolHandlerFallback==($d.Options&Kj.NoProtocolHandlerFallback)||Xd($d)||ja()||G()&&!(ui.DescriptiveUnattemptedEnums?Om>=vh.O14Unattempted&&Om<=vh.DocumentUrlIsNull:
Om==vh.Unattempted)?Jj(Om,ui.Application):ig($d.Application,$d.EncodeUrl?Pf:nf,$d.Mode,$d.Application==zg.OneNote,$d.SilentExternalHandler,$d.NavigateUsingWindowOpen)}}}}else Jj(ui.DescriptiveUnattemptedEnums?vh.DocumentUrlIsNull:vh.Unattempted,ui.Application)}function Mm($d){null!=Vl&&Vl($d)}function Jj($d,nf){"undefined"==typeof nf&&(nf=null);null!=um&&um($d,nf)}function Nm(){var $d=0;if(a()||ic()||Cb()){var nf=Fg();try{null!=nf&&($d=nf.GetOfficeVersion())}catch(Pf){}}else pi("SharePoint.OpenDocuments.5")?
$d=15:pi("SharePoint.OpenDocuments.4")?$d=14:pi("SharePoint.OpenDocuments.3")?$d=12:pi("SharePoint.OpenDocuments.2")&&($d=11);return $d}function so(){return G()&&(og("application/x-sharepoint",!0)||og("application/x-sharepoint-webkit",!0))}var an="",to="",hm="",Vl,um,Kn,wl,ui,Ln,uo,Lp,bn,cn={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Kj={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
vh={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},tj={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},zg={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:cn,OpenDocumentOptions:Kj,OpenDocumentFailureType:vh,OpenDocumentControl:tj,OfficeApplication:zg,EditDocumentInClient:Dh,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=zg.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Nm,IsO14MacPluginInstalled:so,OfferOfficeInDialog:function(){return b()&&11>=Nm()},OfferOfficeNoIntrusive:function(){return b()&&15>Nm()},OfferMacOffice:function(){return G()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!so()},InstallRoamingControl:function(){Va()?window.InstallTrigger.install({Office:{URL:to}}):xd(hm,null,null)},CanUseRoamingControl:function(){if(y())return!0;if(Cb())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Va()){var $d=document.createElement("RoamingExtensionElement");document.documentElement.appendChild($d);var nf=document.createEvent("Events");nf.initEvent("RoamingOfficeInstalled",!0,!1);$d.dispatchEvent(nf);
return!!$d.getAttribute("installed")}if(ja())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Pf){}return!1},InitUrls:function($d,nf,Pf){an=$d;to=Pf;hm=nf},LaunchRoamingApps:function($d,nf,Pf,Fe,Eh,Aj){gr.kSb.iVh($d,nf,Tg(Pf),Fe,"x86",an,Eh,Aj)},LaunchRoamingApps2:function($d,nf,Pf,Fe,Eh,Aj,Lj,uv){var Om="";null!=Fe&&(Om+=" "+Fe);null!=$d&&(Om+=' "'+$d+'"');if(y()||Cb())Kn=Lj,wl=uv,Lj='office: "'+(Aj+'" "')+(Pf+'" "ROAMING"'),Lj+=' "'+nf+'"',Lj+=' "'+Eh+'"',Lj+=
" "+Om,ec(Lj,of,sg,!1,!1);else if(Va())$d=document.createElement("RoamingExtensionElement"),$d.setAttribute("cabUrl",Aj),$d.setAttribute("app",Pf),$d.setAttribute("licensingEntitlements",nf),$d.setAttribute("platform",Eh),$d.setAttribute("args",Om),document.documentElement.appendChild($d),nf=document.createEvent("Events"),nf.initEvent("RoamingOfficeLaunch",!0,!1),$d.dispatchEvent(nf),null!=Lj&&Lj(tj.RoamingFFExtension);else if(ja()){if($d=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
$d)try{$d.HrConfigureSingle(Aj,Pf,nf,Eh,Om),null!=Lj&&Lj(tj.RoamingActiveX)}catch(vv){}}else null!=uv&&uv(vh.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:jc,OpenDocumentWithProtocolHandler:ig,OpenDocumentWithProtocolHandlerNoCallBack:function($d,nf,Pf,Fe){var Eh=wg($d);if(null==Eh)return Jj(ui.DescriptiveUnattemptedEnums?vh.ProtocolHandlerNoCallbackIsNull:vh.Unattempted,ui.Application),!1;$d=Pe($d,nf,Pf,Fe,Eh);ec($d,null,null,!1,!1);return!0}}}();gr.ClientUtils=
gr.kSb;class bu{constructor(a,b,c){this.Ca=a;this.g3h=b;this.SG=c}vb(){this.Ca.ya(F.a.tryMacOffice,ye.a.frame,Object(H.a)(this,this.fNk,"onTryMacOffice"));this.Ca.ya(F.a.tNh,ye.a.frame,Object(H.a)(this,this.Jeh,"onTryMacOfficeFromViewer"));this.Ca.ya(F.a.sNh,ye.a.frame,Object(H.a)(this,this.Jeh,"onTryMacOfficeFromViewer"))}fNk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?Cd.a.In(ug.a.PEa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===
a&&Cd.a.In(ug.a.PEa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Qwg();return 32}Jeh(a,b,c){if(1===c)return 32;switch(a){case F.a.tNh:Cd.a.In(ug.a.PEa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case F.a.sNh:Cd.a.In(ug.a.PEa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Qwg(){Cd.a.In(bu.sxk,"_blank",void 0,"LaunchMacTrialWindow")}get quc(){return this.g3h&&z.a.fl&&!z.a.Aqe&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get lDh(){const a=
this.quc;a||w.AFrameworkApplication.Ci.Znl();return a}get Hxl(){return this.quc}static get sxk(){return ug.a.cX("522401")}}Object(m.a)(bu,"MacOfficeOffer",null,[1174]);class cu{constructor(a,b,c){this.Ca=a;this.j3h=b;this.pCd=null;(this.tIc=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.pCd=f});this.SG=c}vb(){this.Ca.ya(F.a.tryOffice,
ye.a.frame,Object(H.a)(this,this.gNk,"onTryOffice"));this.Ca.ya(F.a.M9e,ye.a.frame,Object(H.a)(this,this.M9e,"tryOfficeThroughTellMe"));this.Ca.ya(F.a.BNh,ye.a.frame,Object(H.a)(this,this.CNh,"tryOfficeThroughViewer"));this.Ca.ya(F.a.ANh,ye.a.frame,Object(H.a)(this,this.CNh,"tryOfficeThroughViewer"))}gNk(a,b,c,f,l){if(this.tIc&&1===c)return this.isFreemiumUpsellEnabled&&this.ruc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?Cd.a.In(ug.a.PEa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===a?Cd.a.In(ug.a.PEa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Xse()):this.Xse());return 32}M9e(a,b,c,f,l){if(this.tIc&&1===c)return this.isFreemiumUpsellEnabled&&this.ruc?32:8;2===c&&(l?(a=l.SourceControlId,Cd.a.In(ug.a.cX("862405")+this.Tqj(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Cd.a.In(ug.a.cX("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}CNh(a,b,c){if(this.tIc&&1===c)return this.isFreemiumUpsellEnabled&&
this.ruc?32:8;if(2===c)switch(a){case F.a.BNh:Cd.a.In(ug.a.PEa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case F.a.ANh:Cd.a.In(ug.a.PEa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get i9g(){return this.ruc}get XDk(){return this.ruc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get ruc(){return this.j3h&&!z.a.fl}get isFreemiumUpsellEnabled(){let a=!1;this.pCd&&(a=this.pCd.isFreemiumUpsellEnabled());return a}Xse(a=null){let b=0;a&&(b=a);Cd.a.In(cu.Cnj(b),"_blank",void 0,"LaunchOfficeOffer")}Tqj(a){let b=
0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static Cnj(a){if(z.a.Yi)switch(a){case 1:return ug.a.cX("393806");case 2:return ug.a.cX("393810");case 3:return ug.a.cX("393809");case 5:return ug.a.cX("393805")}else if(z.a.cD)switch(a){case 1:return ug.a.cX("521979");case 3:return ug.a.cX("521980");case 5:return ug.a.cX("521978");case 2:return ug.a.cX("522490")}else{if(2===a)return ug.a.cX("517778");
if(1===a)return ug.a.PEa(30)}return ug.a.cX("522402")}}Object(m.a)(cu,"OfficeTrialExperience",null,[1172]);class Or{Xb(a){a.register(cu,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").na().oa(()=>new cu(w.AFrameworkApplication.Qa,w.AFrameworkApplication.eqe,w.AFrameworkApplication.lcid));a.register(bu,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").na().oa(()=>new bu(w.AFrameworkApplication.Qa,w.AFrameworkApplication.Lrg,w.AFrameworkApplication.lcid))}}
Object(m.a)(Or,"OpenInClientConfiguration",null,[3]);var hh=d(185),k=d(49);class E{constructor(a,b,c){this.eY=this.uu=this.K=null;this.tf=a;this.lG=b;this.oHe=c}fRf(a,b,c){if(!this.tf)return null;if(!this.K){this.K=k.a.ee();this.K.id=this.lG;this.K.className="HTMLSpinnerIndicator";const f=k.a.ee();f.className="HtmlspinnerOverlay";this.uu=k.a.ee();this.uu.className="HtmlspinnerInner";const l=k.a.Hl();l.className="BootSpinner";this.uu.appendChild(l);this.oHe&&(this.eY=k.a.Hl(),this.eY.id="htmlspinner_label",
this.uu.appendChild(this.eY));this.K.appendChild(f);this.K.appendChild(this.uu);this.tf.appendChild(this.K)}this.oHe&&(this.eY.innerText=a||ResourceStrings.l_Loading);this.dVd(b,c);return this.K}sRb(a){this.eY&&(this.eY.innerText=a)}dVd(a,b){this.K.style.left=k.a.Pc(a);this.K.style.top=k.a.Pc(b);this.uu.style.bottom=this.oHe?k.a.Pc(this.tf.clientHeight/2+16):k.a.Pc(this.tf.clientHeight/2+24)}}Object(m.a)(E,"HtmlSpinnerIndicator",null,[]);class X extends E{constructor(a,b,c){super(a,b,!1);this.qHe=
c}fRf(a,b,c){if(!this.tf)return null;if(!this.K){this.K=k.a.ee();this.K.id=this.lG;this.K.className="HTMLProgressIndicator";const f=k.a.ee();f.className="HtmlprogressOverlay";this.uu=k.a.ee();this.uu.className="HtmlprogressInner";if(this.qHe){const l=k.a.xB();l.src=hh.a.PN(Pd.a.Joa);l.width=Pd.a.YKb;l.height=Pd.a.Fnd;this.uu.appendChild(l)}this.eY=k.a.Hl();this.uu.appendChild(this.eY);this.K.appendChild(f);this.K.appendChild(this.uu);this.tf.appendChild(this.K)}this.eY.innerText=a||ResourceStrings.l_Loading;
this.dVd(b,c);return this.K}dVd(a,b){this.K.style.left=k.a.Pc(a);this.K.style.top=k.a.Pc(b);this.K.style.display=qe.a.Tj;this.uu.style.position=qe.a.tba;a=this.uu.clientWidth;this.uu.style.top=k.a.Pc(this.tf.clientHeight/2-this.uu.clientHeight/2);w.AFrameworkApplication.isRtl?(this.uu.style.right=k.a.Pc(this.tf.clientWidth/2-a/2),this.uu.style.direction=qe.a.k2a):(this.uu.style.left=k.a.Pc(this.tf.clientWidth/2-a/2),this.uu.style.direction=qe.a.rIh);this.K.style.display=qe.a.Qe}}Object(m.a)(X,"HtmlProgressIndicator",
E,[]);class qa{constructor(a,b){this.VJ=this.fP=this.K=null;this.Ab=!0;this.SHg=a;this.DJ=b}iPb(a,b,c,f,l){w.AFrameworkApplication.jCb()||(this.K=this.SHg.fRf(a,c,f),b?(this.fP&&(window.clearTimeout(this.fP),this.fP=null),this.VJ&&(window.clearTimeout(this.VJ),this.VJ=null),this.Q3e(l)):this.fP||this.VJ||(this.fP=window.setTimeout(()=>{this.p4e(l)},200)))}$Zc(){this.fP&&(window.clearTimeout(this.fP),this.fP=null);this.VJ&&(window.clearTimeout(this.VJ),this.VJ=null);this.K&&(this.K.style.display=qe.a.Qe,
this.K.style.opacity="0")}sRb(a){this.SHg.sRb(a)}Q3e(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=qe.a.Tz,this.Ab&&(this.K.style.display=qe.a.Tj),ya.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.exc(a)))}p4e(a){this.fP=null;this.K&&(this.K.style.visibility=qe.a.Tz,this.Ab&&(this.K.style.display=qe.a.Tj),this.K.style.opacity="0.0",this.VJ||(this.VJ=window.setTimeout(()=>{this.o4e(a)},1800)))}o4e(a){this.VJ=null;this.K&&(this.K.style.opacity=
"1.0",this.Ab&&(this.K.style.display=qe.a.Tj),ya.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.exc(a)))}exc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.DJ.F6(a):null:null}get visible(){return this.Ab}set visible(a){this.Ab=a;this.K&&(this.K.style.display=a?qe.a.Tj:qe.a.Qe)}}Object(m.a)(qa,"HtmlProgressIndicatorView",null,[1393]);class Ha{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=null}}Object(m.a)(Ha,
"UploadConvertedFileToHostParams",null,[]);var $a=d(1043),tb=d(79);const Zb=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},Ac=a=>a.nc.keyCode===B.a.jp||a.nc.keyCode===B.a.BK?(a.Bc.click(),!0):!1,Vc=(a,b,c,f,l,y,G)=>{const R=document.createElement("a");R.className="ProtocolLaunchingDialogButtonAnchor";R.className+=" OICDialog";R.id=a;R.setAttribute(Ne.a.hf,Ne.a.Ou);R.style.padding="0";R.style.margin=
"0";f&&td(l,b,c,f,R);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;R.appendChild(a);R.tabIndex=0;y&&Ad.a.instance.ub(pa.a.click,R,y);G&&x.KeyInputManager.instance.ub(pa.a.Tl,R,G);return R},td=(a,b,c,f,l)=>{var y=document.createElement("img");y.alt=a;y.className=tb.getImageClassWithCluster(c,f);y.src=b;y.setAttribute(Ne.a.hf,Ne.a.qQ);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(y);y=document.createElement("span");
y.className="ProtocolLaunchingDialogIconContainer";y.appendChild(a);l.appendChild(y)};class Be{static get hg(){return ei.a.pz(Be.Fo,CommonUIStrings.l_OICLaunchDialogTitle)}}Be.Fo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(Be,"OICLaunchDialogHtml",null,[]);class $e extends ei.a{constructor(a){super();this.Hob=this.Q3a=null;this.pOa=!1;this.px=a;this.hg=Be.hg;this.Ad=5;this.ig="OICLaunchDialog";this.showDialog("",Object(H.a)(this,this.aEk,"oicLaunchDialogResultHandler"));this.Azh();this.J6("ProtocolLaunchingDialogTitle");4!==w.AFrameworkApplication.Aa.mb.kta&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.jS(this.Q3a);ha.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Hxa(){this.Q3a=Vc("BtnRichClient",this.px.wwb,this.px.Cbb,this.px.Jie,CommonUIStrings.l_OICLaunchRichClient,Object(H.a)(this,this.idh,"onRichClientButtonClick"),Ac);document.getElementById("OICLaunchRichClient").appendChild(this.Q3a);Zb(this.Q3a);this.Hob=Vc("BtnReturn",this.px.wwb,this.px.Cbb,this.px.blg,CommonUIStrings.l_OICReturnToOnlineClient,Object(H.a)(this,this.gdh,"onReturnButtonClick"),
Ac);document.getElementById("OICReturnToApp").appendChild(this.Hob);Zb(this.Hob)}gdh(){this.hide();this.px.U0a();return!0}idh(){ha.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();w.AFrameworkApplication.Qa.processAction(F.a.Kkb,2);return!0}aEk(){this.px.U0a()}dispose(){this.pOa||(this.Q3a&&(Ad.a.instance.Bb(pa.a.click,this.Q3a,Object(H.a)(this,this.idh,"onRichClientButtonClick")),x.KeyInputManager.instance.Bb(pa.a.Tl,this.Q3a,Ac)),this.Hob&&(Ad.a.instance.Bb(pa.a.click,
this.Hob,Object(H.a)(this,this.gdh,"onReturnButtonClick")),x.KeyInputManager.instance.Bb(pa.a.Tl,this.Hob,Ac)),super.dispose(),this.pOa=!0)}}Object(m.a)($e,"OICLaunchDialog",ei.a,[]);class cf{static get hg(){return ei.a.pz(cf.Fo,CommonUIStrings.l_OICDialogTitle)}}cf.Fo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(cf,"ProtocolLaunchingDialogV2Html",null,[]);var Tf=d(204);class qh extends ei.a{constructor(a){super();this.Gob=this.DAa=null;this.pOa=!1;this.VNa=null;this.px=a;this.hg=cf.hg;this.Ad=5;this.ig="ProtocolLaunchingDialog";this.DAc="OICRetryDialog";w.AFrameworkApplication.De.sua&&w.AFrameworkApplication.De.tLa();w.AFrameworkApplication.De.Hb(new pd.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(H.a)(this,this.Wpc,"protocolLaunchingDialogResultHandler"));this.Azh();
this.J6("Issues");this.J3f();ha.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Hxa(){const a=document.getElementById("Issues");if(a){td("",this.px.wwb,this.px.Cbb,this.px.Jie,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.px.dfh?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);Zb(a);a.style.display="none"}w.AFrameworkApplication.Aa.mb.Hfg?
(this.Gob=Vc("GiveFeedback",this.px.wwb,this.px.Cbb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(H.a)(this,this.Kjd,"onGiveFeedbackClick"),Object(H.a)(this,this.hbh,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.Gob),Zb(this.Gob)):document.getElementById("ButtonGiveFeedback").style.display="none";0===w.AFrameworkApplication.Aa.mb.kta||w.AFrameworkApplication.NXi?document.getElementById("ButtonEdit").style.display="none":(this.DAa=
Vc("Edit",this.px.wwb,this.px.Cbb,"",2===w.AFrameworkApplication.Aa.mb.Ti?4===w.AFrameworkApplication.Aa.mb.kta?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===w.AFrameworkApplication.Aa.mb.kta?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(H.a)(this,this.vah,"onEditClick"),Object(H.a)(this,this.zah,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.DAa),Zb(this.DAa));0===w.AFrameworkApplication.Aa.mb.kta&&
!w.AFrameworkApplication.eqe&&a&&(a.style.display="none")}K3f(){return this.VNa?(this.jS(this.VNa),!0):!1}J3f(){return this.DAa?(this.jS(this.DAa),!0):!1}zah(a){return this.OMe(a,0)}hbh(a){return this.OMe(a,2)}fdh(a){return this.OMe(a,1)}OMe(a,b){let c=!1;if(a.nc.keyCode===B.a.jp||a.nc.keyCode===B.a.BK)a.Bc.click(),c=!0;else if(a.nc.keyCode===Sys.UI.Key.down||a.nc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.J3f();break;case 0:c=this.K3f()}return c}vah(){this.hide();4===w.AFrameworkApplication.Aa.mb.kta?
(ha.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.px.U0a()):(ha.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.px.O9b());return!0}Kjd(){ha.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}Lkd(){ha.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";w.AFrameworkApplication.Qa.processAction(F.a.Kkb,2);return!0}Wpc(){this.px.U0a()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.VNa=Vc("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(H.a)(this,this.Lkd,"onRetryOICClick"),Object(H.a)(this,this.fdh,"onRetryOICKeyUp")),a.appendChild(this.VNa),Zb(this.VNa),this.DAa||this.K3f())}}dispose(){this.pOa||(this.DAa&&(Ad.a.instance.Bb(pa.a.click,this.DAa,Object(H.a)(this,
this.vah,"onEditClick")),x.KeyInputManager.instance.Bb(pa.a.Tl,this.DAa,Object(H.a)(this,this.zah,"onEditKeyUp"))),this.Gob&&(Ad.a.instance.Bb(pa.a.click,this.Gob,Object(H.a)(this,this.Kjd,"onGiveFeedbackClick")),x.KeyInputManager.instance.Bb(pa.a.Tl,this.Gob,Object(H.a)(this,this.hbh,"onGiveFeedbackKeyUp"))),this.VNa&&(Ad.a.instance.Bb(pa.a.click,this.VNa,Object(H.a)(this,this.Lkd,"onRetryOICClick")),x.KeyInputManager.instance.Bb(pa.a.Tl,this.VNa,Object(H.a)(this,this.fdh,"onRetryOICKeyUp"))),super.dispose(),
this.pOa=!0)}}Object(m.a)(qh,"ProtocolLaunchingDialog",ei.a,[]);class Zi extends sh.StandardDialog{constructor(a){super();this.px=a;this.ig="ProtocolLaunchingDialog";w.AFrameworkApplication.De.sua&&w.AFrameworkApplication.De.tLa();w.AFrameworkApplication.Aa.mb.Hfg&&this.vTd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(H.a)(this,this.Kjd,"onGiveFeedbackClick"));Zi.yig?(this.Ad=12,this.Le(1,CommonUIStrings.l_CloseFile),this.Le(2,CommonUIStrings.l_OICDialogContinueHere),this.Le(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.Ad=4,this.Le(1,CommonUIStrings.l_OICDialogContinueHere),this.Le(2,CommonUIStrings.l_OICDialogLaunchAgain));this.jIb(CommonUIStrings.l_OICDialog2ndTitle,5===this.px.dfh?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(H.a)(this,this.Wpc,"protocolLaunchingDialogResultHandler"),null)}Kjd(a){ha.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Lah(a)}Lkd(){ha.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");w.AFrameworkApplication.Qa.processAction(F.a.Kkb,
2)}Wpc(a){Zi.yig?3===a?this.zuh():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.zuh():(1===a||0===a)&&this.continueEditing()}closeDocument(){ha.ULS.sendTraceTag(577783557,211,50,"Closing the document");w.AFrameworkApplication.Qa.Ja(F.a.close,2,Uh.a)}zuh(){ha.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(H.a)(this,this.Lkd,"onRetryOICClick"),0)}continueEditing(){4===w.AFrameworkApplication.Aa.mb.kta||w.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===w.AFrameworkApplication.Aa.mode?(ha.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.px.U0a()):(ha.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.px.O9b())}static get yig(){return w.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===w.AFrameworkApplication.Qa.processAction(F.a.close,1)}}Object(m.a)(Zi,"StandardProtocolLaunchingDialog",sh.StandardDialog,[]);var ti=d(680);class cl{}Object(m.a)(cl,"EditDocumentInClientParams",null,[]);
class Ch{static AXf(a,b,c,f,l,y,G=!1,R=!1,ja="",za=!1,Va=!1,hb=!1,Cb="",lc="",ic="",yc=!1,ec=""){const jc=new cl;jc.DocumentUrl=a;jc.DocumentExtension=ec;jc.Mode=b;jc.Options=c;jc.Application=f;jc.SilentExternalHandler=G;jc.EncodeUrl=R;jc.CorrelationIdForWinClient=ja;jc.NavigateUsingWindowOpen=za;jc.DescriptiveUnattemptedEnums=Va;jc.NoBrowserModalDialogs=hb;jc.SessionOrigin=Cb;jc.CorrelationId=lc;jc.ClickTime=ic;jc.NewTelemetryDataIsEnabled=yc;MSOJS.ClientUtils.EditDocumentInClient(jc,l,y)}}Object(m.a)(Ch,
"ClientUtils",null,[]);var En=d(575),ep=d(539),Fn=d(110);class Yn{constructor(a){this.zBa=this.eUb=this.jTb=null;this.SUb=!1;this.ZEd=this.RKd=this.wqf=null;this.Jzc=this.xqa=this.TGc="";this.application=this.iz=0;this.zHl=this.x6e=!1;this.qWl=a&&w.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");w.AFrameworkApplication.Qa.MT(F.a.Kkb)||w.AFrameworkApplication.Qa.ya(F.a.Kkb,ye.a.frame,Object(H.a)(this,this.thl,"retryOpenInClientAction"));this.KFh=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("SilentExternalHandler")}get dfh(){return this.iz}Ftl(a,
b="",c=""){this.xqa=c||oh.a.create().toString();this.TGc=b||En.a.Gag();this.Jzc=a}thl(a,b,c){return b.contextId!==ye.a.frame?2:1===c?32:this.Kkb()}get options(){let a=0;w.AFrameworkApplication.requiresCheckout&&(a|=1);w.AFrameworkApplication.lfh&&(a|=4);this.xHl()&&(a|=64);return a}xHl(){return!(2===this.application&&w.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get wwb(){return w.AFrameworkApplication.km}get Cbb(){return w.AFrameworkApplication.lO}get blg(){return""}get Jie(){return""}get yHl(){return w.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get sKl(){return this.wqf||
(this.wqf=Fb.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.x6e||this.D3i()}U0a(){this.zHl||this.N_f()}A4k(a){return this.qWl&&z.a.Yi?(new $e(this),32):this.rvb(a)}rvb(a){const b=({H2a:a}=this.Mak(a)).returnValue;ha.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,y,G=""){this.jTb=a;this.ZEd=G;this.eUb=b;this.zBa=y;this.application=c;this.iz=f;return w.AFrameworkApplication.ZWf?(this.Lwg(),32):w.AFrameworkApplication.dR&&!w.AFrameworkApplication.akg?
(w.AFrameworkApplication.nFh(),8):this.fGf(l)}get $Dk(){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}Kkb(){this.$Dk&&this.mek();return this.rvb(this.SUb)}Wxh(){const a=new ep.a(ma.a.openInClient);a.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();a.Values[ti.a.SSf]=w.AFrameworkApplication.userSessionId;return this.zBa.value.send(a)?32:8}mek(){Sf.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Ak.a,{inStaging:!0}))}Fml(a){const b=new ep.a(ma.a.MYl);b.Values["ui-language"]=w.AFrameworkApplication.lcid.toString();b.Values[ti.a.SSf]=w.AFrameworkApplication.userSessionId;b.Values[uh.a.LYl]=a;this.zBa.value.send(b)}Mak(a){this.SUb=a;this.Fml(5===this.iz?Yn.ZNk:Yn.eOk);return 5===this.iz?this.Lak():this.Nak()}Lak(){this.Rwg();return{returnValue:32,H2a:"HostEditUrl,"}}Nak(){let a;var b=a="";w.AFrameworkApplication.fAf&&(b="|f|"+w.AFrameworkApplication.userSessionId);
const c=w.AFrameworkApplication.fa.ka("IsAssignmentMode")&&w.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||w.AFrameworkApplication.fdc||z.a.zGa,f=w.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=w.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(w.AFrameworkApplication.Qa.iid){var y=w.AFrameworkApplication.Qa.k9b(3588168074);y&&this.Ftl(y.epochClickTime,y.sessionOrigin,y.correlationId);this.Dyg()}if(w.AFrameworkApplication.Mjh){a+="NewOrder,";
y=8;this.zBa&&this.zBa.value&&this.zBa.value.isEnabled()&&w.AFrameworkApplication.Qxc&&(a+="Post,",y=this.Wxh());if(32===y)return{returnValue:y,H2a:a};ha.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return w.AFrameworkApplication.ju.Txa?(ha.ULS.shipAssertTag(5566816,211,!!w.AFrameworkApplication.ju.Txa),a+="HostUrl,",{returnValue:w.AFrameworkApplication.Aa.PM(!0,w.AFrameworkApplication.ju.Txa),H2a:a}):this.jTb?(ha.ULS.sendTraceTag(18715405,211,15,
"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId),a+="DocUrl,",Ch.AXf(this.jTb,this.iz,this.options,this.application,Object(H.a)(this,this.yah,"onEditInClientSuccess"),Object(H.a)(this,this.xah,"onEditInClientFailure"),this.KFh,w.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.TGc,this.xqa,this.Jzc,w.AFrameworkApplication.Qa.iid,this.ZEd),{returnValue:32,H2a:a}):{returnValue:8,H2a:a}}a+="OldOrder,";if(!this.jTb&&w.AFrameworkApplication.ju.Txa)return this.zBa&&
this.zBa.value&&this.zBa.value.isEnabled()&&w.AFrameworkApplication.Qxc?(a+="Post,",b=this.Wxh()):(ha.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(ha.ULS.shipAssertTag(22595484,211,!!w.AFrameworkApplication.ju.Txa),a+="HostUrl,",{returnValue:w.AFrameworkApplication.Aa.PM(!0,w.AFrameworkApplication.ju.Txa),H2a:a}):{returnValue:b,H2a:a};ha.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",w.AFrameworkApplication.userSessionId);
a+="DocUrl,";Ch.AXf(this.jTb,this.iz,this.options,this.application,Object(H.a)(this,this.yah,"onEditInClientSuccess"),Object(H.a)(this,this.xah,"onEditInClientFailure"),this.KFh,w.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.TGc,this.xqa,this.Jzc,w.AFrameworkApplication.Qa.iid,this.ZEd);return{returnValue:32,H2a:a}}xel(a){w.AFrameworkApplication.Ci.setDw(8981,a)}yah(a){this.xel(a);ha.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?
(this.yHl||this.Rwg(),this.Dyg()):this.x6e||this.closeApplication()}xah(a,b=0){ha.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.eUb&&!this.SUb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.x6e=!0));this.sKl.XDk?(ha.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),$a.a.instance.YPi(this.SUb?Object(H.a)(this,
this.t9g,"oicErrorDialogHandlerCloseForced"):Object(H.a)(this,this.u9g,"oicErrorDialogHandlerNoCloseForced"),c?Object(H.a)(this,this.Hbh,"onLaunchDownload"):null,this.EVf(!1)?Object(H.a)(this,this.yNj,"iHaveOfficeButtonHandler"):null,f,b)):(ha.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),$a.a.instance.WPi(this.SUb?Object(H.a)(this,this.t9g,"oicErrorDialogHandlerCloseForced"):Object(H.a)(this,this.u9g,"oicErrorDialogHandlerNoCloseForced"),c?Object(H.a)(this,this.Hbh,
"onLaunchDownload"):null,f))}}Dyg(){try{const a=[Object.assign(new Fn.a,{name:"CorrelationId",string:this.xqa}),Object.assign(new Fn.a,{name:"SessionOrigin",string:this.TGc}),Object.assign(new Fn.a,{name:"ClickTime",string:this.Jzc}),Object.assign(new Fn.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];kk.a("OpenInClientCompleted",!0,0,a)}catch(a){ha.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}Rwg(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.gD&&
w.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?new Zi(this):new qh(this)}t9g(){this.closeApplication()}u9g(){this.U0a()}Hbh(){this.Lwg()}yNj(){return this.EVf(!0)}EVf(a){const b=(z.a.VVa||z.a.Io)&&!!w.AFrameworkApplication.OQc;b&&a&&(Cd.a.In(w.AFrameworkApplication.OQc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}Yn.eOk="OpenInDesktop";Yn.ZNk="OpenInBrowser";Object(m.a)(Yn,"AOpenInClientOperation",null,[]);class Ym extends Yn{constructor(a,b,c=!1){super(c);
this.S1h=a;this.R1h=b}get blg(){return this.R1h}get Jie(){return this.S1h}D3i(){w.AFrameworkApplication.Qa.Ja(F.a.close,2,Uh.a)}N_f(){}fGf(a){return this.A4k(a)}Lwg(){ha.ULS.shipAssertTag(5566817,211,!!this.eUb);w.AFrameworkApplication.uea?w.AFrameworkApplication.Aa.PM(!0,this.eUb):Cd.a.In(this.eUb,void 0,void 0,"LaunchDownload")}O9b(){w.AFrameworkApplication.Aa.mb.O9b()}}Object(m.a)(Ym,"OpenInClientOperation",Yn,[]);class Gn extends Ym{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");
if(!a)throw Error.argumentNull("pathManager");this.CPg=b;this.le=a;this.Yo=c;this.ia=f}get wwb(){return this.le.qk(this.Cbb+".png")}get Cbb(){return"prt2"}fGf(a){return this.CPg?this.CPg(a):this.rvb(a)}N_f(){ya.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.Ja(ea.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}rvb(a){this.Yo.acc=!0;return super.rvb(a)}}Object(m.a)(Gn,"OpenInPowerPointOperation",Ym,[]);class Po{constructor(a,
b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie){this.PHg=null;this.KE=y;this.ia=a;this.Fa=b;this.pa=c;this.le=f;this.BPg=new Gn(this.le,Object(H.a)(this,this.osi,"beginSaveBeforeOpenInClient"),hb,a);G.execute(Pe=>{this.PHg=new vb.a(()=>Pe)});this.YDg=l;this.Yu=R;this.mxk=ja;this.ua=za;this.fc=Va;this.Da=Cb;this.Ya=lc;this.Cfa=ic;this.Rb=yc;this.Vd=ec;this.$m=jc;this.Uv=xd;this.vgb=Xd;this.U$=Qd;this.CR=Ie}vb(){this.ia.ya(ea.a.openInClient,qc.a.application,Object(H.a)(this,this.ffh,"openExternal"));
this.ia.ya(F.a.jPe,qc.a.application,Object(H.a)(this,this.ffh,"openExternal"));this.ia.ya(ea.a.convertAndEdit,qc.a.application,Object(H.a)(this,this.UKi,"convertBinaryFormat"));this.ia.ya(ea.a.repair,qc.a.application,Object(H.a)(this,this.Pdl,"repairCorruptedFile"));this.ia.ya(ea.a.Yrc,qc.a.application,Object(H.a)(this,this.Yrc,"replaceOriginalFile"));this.ia.ya(ea.a.hNb,qc.a.application,Object(H.a)(this,this.hNb,"saveRepairedFile"));this.ia.ya(ea.a.r5b,qc.a.application,Object(H.a)(this,this.r5b,
"editAnyway"));this.ia.ya(ea.a.z9b,qc.a.application,Object(H.a)(this,this.z9b,"goToEditMode"));this.ia.ie(ea.a.openInClient,12288)}osi(a){if(this.$m.isPaused)return this.Fa.Bd(),this.TZe(a),32;this.pa.nh();this.Fa.Bd();if(1===this.Rb.mode&&this.Da.ntg)return this.F2f(a),32;this.KE.h4(a,!0,()=>{this.TZe(a)},()=>{this.TZe(a);return!0},3);this.Yu.show(!1,"OpenInClient");return 32}TZe(a){this.Yu.hide();this.F2f(a)}F2f(a){Kc.a.tyd();this.BPg.rvb(a)}ffh(a,b,c){if(b.contextId!==qc.a.application)return 2;
b=!(!this.le.documentUrl&&!this.YDg.Txa&&!w.AFrameworkApplication.Qxc);if(1===c)return b?32:8;if(!b)return 8;this.ggk();if(this.fc.fd(this.mxk.Gf))return 16;a=a===F.a.jPe?5:2;1===this.Rb.mode&&this.Da.ntg&&(a=1);return this.BPg.begin(this.le.documentUrl,w.AFrameworkApplication.JSa,3,a,this.Da.l3j,this.PHg,qd.a("OpenPPTTemplateInDesktopAppAsNFT")?na.a.IQ(this.YDg.rx):"")}ggk(){try{let a="";const b=this.ua.pk;b&&(a=b.toString());ya.a.J(509372432,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",
this.ua.currentSlideIndex,a)}catch(a){ya.a.J(509372431,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}UKi(a,b,c){ya.a.J(509372430,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");if(b.contextId!==qc.a.application)return 2;if(1===c)return 32;const f=Object.assign(new Ha,{PodEndpointUrl:this.Da.podsWebServiceBase,PodSessionID:this.Ya.podSessionId,PresentationID:this.Ya.presentationId.string});this.Cfa.Xzd(f,Object(H.a)(this,this.pNk,"onUploadConvertedFileToHostSucceeded"),
l=>{this.oNk(l,f.PodSessionID)});this.Yu.x4e(!0,ResourceStrings.L_FileConverting,a);return 32}pNk(a){ya.a.J(509372429,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.Yu.hide();if(this.Rb)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;w.AFrameworkApplication.fa&&(b=w.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=w.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=w.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){ya.a.J(509372426,
801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[uh.a.XLb]="1";l[uh.a.documentUrl]=a.EditUrl;l[uh.a.mode]="edit";l[uh.a.reason]=ow.a.convert;w.AFrameworkApplication.QT().execute(y=>{y.sendMessage(ma.a.YDa,l)})}else this.Rb.PM(!0,a.EditUrl)}else ya.a.J(509372427,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else ya.a.J(509372428,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}oNk(a,
b){a=Of.a.sL(a.error.Vm);ya.a.J(509372425,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.Yu.hide();a=Object.assign(new oi.a,{Code:a,Source:5});this.Vd.Gs(a,b,c=>{c.JC=1;c.dDa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}Pdl(a,b,c){if(b.contextId!==qc.a.application)return 2;if(1===c)return 32;ya.a.J(509372424,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.Rdl();
return 32}Rdl(){const a=new Date;ya.a.J(509372423,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",a);const b=Kc.a.Jj("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.CR.Aub(()=>{ya.a.J(509372422,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},
()=>{ya.a.J(509372421,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});this.vgb.zsh(b,()=>{ya.a.J(509372420,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.aNl()},c=>{ya.a.J(509372419,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-
+a,c);b.finish();this.WYk(c,this.Ya.podSessionId);return!0})}aNl(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Ya.podSessionId;a.fromInlineDocumentRepair=!0;this.Uv.y0e();a=this.ia.Ja(ea.a.cMb,2,a);ya.a.J(509372418,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}WYk(a,b){a=Object.assign(new oi.a,{Code:a,Source:5});this.Vd.Gs(a,b,c=>{c.JC=1;c.dDa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;
return!1})}r5b(a,b,c,f,l){if(b.contextId!==qc.a.application)return 2;if(1===c)return 32;ya.a.J(509372417,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.Uv.oyb();0!==a&&(ya.a.J(509372416,801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.ORf());if(20===l)this.Uv.MSl();else return ya.a.J(509372387,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}hNb(a,b,c,f,l){if(b.contextId!==
qc.a.application)return ya.a.J(509372386,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,1);ya.a.J(509372385,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.tdg(1,l);return 32}tdg(a,b){ya.a.J(509372384,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.Da.podsWebServiceBase,this.Ya.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;const l=new Date;w.AFrameworkApplication.Je.qj(c,1,"",f,!1,0,y=>{this.JNe(y,l,b)},y=>{this.INe(y,a,b)},null,null)}JNe(a,b,c){ya.a.J(509372383,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Wd).downloadUrl;na.a.Xa(a)?(ya.a.J(509372382,
801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.EGh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.Ja(c,2,b))}INe(a,b,c){a=a.data?a.data.Oe:-1;a===ok.a.Sri&&0<b--?(ya.a.J(509372381,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.tdg(b,c)):(ya.a.J(509372380,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",
a,c),this.EGh())}EGh(){const a=Object.assign(new oi.a,{Code:20,Source:6});this.Vd.Gs(a,this.Ya.podSessionId,b=>{b.JC=1;b.dDa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}Yrc(a,b,c){if(b.contextId!==qc.a.application)return ya.a.J(509372379,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=
w.AFrameworkApplication.fa.Ha("DocumentPermissions")||"",b=this.Ya.Vfh&&-1<a.indexOf("W"),ya.a.J(509372378,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",this.Ya.Vfh,a),b?32:8;ya.a.J(509372377,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Ya.Wk=this.U$.F$a(this.Ya.presentationId.string);a=Object.assign(new lm.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Ya.podSessionId,
PresentationID:this.Ya.presentationId.string,PodEndpointUrl:this.Da.podsWebServiceBase,PopSessionID:this.Ya.Wk,UrlOverrides:this.Da.Haa,IsCreateNewSession:this.Da.qJ,UseSharedHostFile:this.Da.KRb});this.U$.uMc(a,()=>{this.gHk()},Object(H.a)(this,this.gJb,"onEnsureHostSessionFailed"),0,!0);return 32}gHk(){ya.a.J(509372376,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.Uv.zfl();this.Ya.Pfl();0!==this.Uv.oyb()&&this.Uv.z0e(!1)}gJb(){ya.a.J(509372375,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");
this.Uv.y0e();0!==this.Uv.oyb()&&this.Uv.z0e(!0);return!1}z9b(a,b,c){if(b.contextId!==qc.a.application)return ya.a.J(509372374,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return 32;a=new Date;this.ORf();ya.a.J(509372373,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}ORf(){this.Ya.Wk=this.U$.F$a(this.Ya.presentationId.string);const a=
Object.assign(new lm.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Ya.podSessionId,PresentationID:this.Ya.presentationId.string,PodEndpointUrl:this.Da.podsWebServiceBase,PopSessionID:this.Ya.Wk,UrlOverrides:this.Da.Haa,IsCreateNewSession:this.Da.qJ,UseSharedHostFile:this.Da.KRb});this.U$.uMc(a,()=>{this.hHk()},null,15,!0);this.Uv.z0e(!1)}hHk(){ya.a.J(509372372,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(m.a)(Po,"PowerPointAppFrameCommandUIActor",
null,[]);var Qo=d(513);class Uq{constructor(a,b,c){this.OAg=a;this.T0=b;this.eFb=c}show(a,b){this.eFb?(b=new Qo.a(b),b.message=ResourceStrings.l_Saving,b.Gqg=!0,b.gPb=a,this.T0.XKa(b)):this.x4e(a,ResourceStrings.l_Saving,b)}x4e(a,b,c){this.eFb?(c=new Qo.a(c),c.message=b,c.gPb=a,this.T0.XKa(c)):this.OAg.iPb(b,a,0,0,c)}hide(){this.eFb?this.T0.XKa(Object.assign(new Qo.a(null),{Fqg:!0})):this.OAg.$Zc()}}Object(m.a)(Uq,"SaveBlockingUI",null,[990]);var Xp=d(241);class zr{constructor(a,b,c,f,l,y,G,R,ja){this.iic=
Sc.App.tn;this.iOg=ia.a.nil;this.wb=a;this.ua=b;this.Mc=c;this.Kk=f;this.uM=l;this.ned=y;this.Lz=R;this.Yr=G;this.fpk=ja.Njl;this.Ypk=ja.pptNotShowSavingStatusOfProofingOnlyRevision;this.Mc.GC(Object(H.a)(this,this.UE,"onSessionEnd"));this.Kk.uUd(Object(H.a)(this,this.lRh,"updateSavingStatus"));this.Kk.wBf(Object(H.a)(this,this.kRh,"updateSavedStatus"));this.Yr.MI(Object(H.a)(this,this.$pa,"updateSaveStatusDisplay"));this.wwk=new pd.a(3,1,ja.Mjl,Object(H.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),
90,"28");this.vWa=!1;this.Tcd=ja.powerPointTextEditOnlyMode}initialize(){this.$pa(this.Yr)}kRh(){this.vWa||this.Lz.s0||this.Lz.Ttg||(this.wb.Hb(this.wwk),this.vWa=!0)}lRh(a,b){this.Lz.s0||this.Lz.Ttg||(this.Ypk&&zr.l5j(b.node)||this.ned.updateSaveStatusText(!1),this.iic=new Date,this.iOg=b?b.revisionId:ia.a.nil)}updateSaveStatusText(){this.vWa=!1;const a=!this.uM.pX(this.ua.presentation);this.ned.updateSaveStatusText(a);a&&(this.Ksh(0,0),this.iic=Sc.App.tn);this.Tcd&&zr.aTl(a)}$pa(a){this.ned.$pa(!1,
1===a.mode?1:3)}UE(a,b){this.ned.updateSaveStatusText(!0);this.Ksh(1,b.iC);this.iic=Sc.App.tn}Ksh(a,b){if(this.iic!==Sc.App.tn){var c=+new Date-+this.iic;c>=this.fpk&&(c=String.format("SavingTime {0};Type {1};Revision {2};",c,a,this.iOg),1===a&&(c+=String.format("CloseReason {0};",b)),ya.a.J(21604228,811,50,c))}}dispose(){this.Mc.Qaa(Object(H.a)(this,this.UE,"onSessionEnd"));this.Kk.hXe(Object(H.a)(this,this.lRh,"updateSavingStatus"));this.Kk.Irh(Object(H.a)(this,this.kRh,"updateSavedStatus"));this.Yr.WY(Object(H.a)(this,
this.$pa,"updateSaveStatusDisplay"))}static aTl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display="block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static l5j(a){return a.Ta(va.a.Hnd)&&!a.Ta(Xp.a.Qrd)}}Object(m.a)(zr,"SaveStatusManager",null,[108]);class xt{constructor(){this.K=
null;this.cDe=!1}get name(){return"PowerPointWebEditor.Actors"}Xb(a){(new Or).Xb(a);this.K=a;a.register(Po,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").na().oa(()=>new Po(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ia("Postmessage.IHostPostmessenger"),
a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(990,"PowerPointWebEditor.ISaveBlockingUI").na().oa(()=>new Uq(new qa(new X(a.resolve("PowerPointWebEditor.IPaneManager").xa,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").lsg));a.register(zr,"PowerPointWebEditor.SaveStatusManager").na().oa(()=>new zr(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.cDe=this.K.resolve("PowerPointWebEditor.IApplicationSettings").Q4j)&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").vb();this.K.resolve("Common.IOfficeTrialExperience").vb();this.K.resolve("Common.IMacOfficeOffer").vb()}dispose(){this.cDe&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){n.a.instance.Ac(new xt)}}Object(m.a)(xt,"PowerPointActorsPackage",null,[2,3]);var Ku=d(1068),bQ=d(1139);class wA{constructor(){this.Nra=this.aT=this.pBa=null;this.$uf=!1;this.Hcf=null;this.Icf=this.YWb=0}get messageId(){return this.pBa}get values(){return this.aT}get userSessionId(){return this.Nra}get shouldRetry(){return this.$uf}get QIc(){return this.Hcf}get uxa(){return this.YWb}get Wci(){return this.Icf}static $Qi(a,
b){var c=ma.a.yUi;const f=new wA;f.pBa=a;f.aT={};f.Nra=b;f.$uf=!0;f.Hcf=c;f.YWb=3;f.Icf=1E3;return f}}Object(m.a)(wA,"PostMessageData",null,[]);class xA{constructor(a,b,c){this.EQd={};this.Ma=a;this.rHd=c;this.rdk();this.Q6k(b)}rdk(){if(this.Ma.ka("DocRebootIsSupported")||this.Ma.ka("UiHostSupportsDocRebootFeatures"))this.EQd[bQ.a.refresh]=()=>this.qml(ma.a.YDa)}Q6k(a){a.ya(F.a.smh,ye.a.frame,Object(H.a)(this,this.Oll,"sendActionToHostIfSupported"))}Oll(a,b,c,f,l){if(2!==c)return 32;if(!l)return ha.ULS.sendTraceTag(41972610,
204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.EQd[a]?(ha.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.EQd[a]()):2}qml(a){const b=wA.$Qi(a,w.AFrameworkApplication.userSessionId);this.rHd.execute(c=>{c.postMessage(b)});return 32}}Object(m.a)(xA,"HostActionExecutionManager",null,[]);var zy=d(121),yA=d(744);class zA extends ti.a{constructor(a,b,c,f){super(a,b,c);this.oVb=this.F7=0;this.Sjf=
!1;this.qVb=0;this.qHd=this.oCc=null;this.Tjf=this.Ujf=!1;this.Ca=f;this._name="HostIntegrationMessenger";this.create()}WMj(a){const b=a.message,c=a.Fj.origin;w.AFrameworkApplication.wopiHostOriginFromPostMessage||(w.AFrameworkApplication.wopiHostOriginFromPostMessage=c);switch(b.MessageId){case ma.a.BXd:case ma.a.DXd:this.QMj(b);break;case ma.a.bge:case ma.a.cge:this.Byd();break;case ma.a.iie:this.YMj(b);break;case ma.a.fdb:this.H$j(b);break;case ma.a.tbf:this.fsi(a);break;case ma.a.ubf:this.DQl()}}bQl(a){switch(a.MessageId){case ma.a.eie:w.AFrameworkApplication.Qa.Ja(F.a.brd,
2,a.Values[uh.a.direction]);break;case ma.a.$zb:ha.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");w.AFrameworkApplication.Qa.Ja(F.a.$zb,2,(new Date).getTime());break;case ma.a.fie:ha.ULS.sendTraceTag(544221062,204,50,"We received HostBackButtonPressed message in WAC");break;case ma.a.gie:ha.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");w.AFrameworkApplication.Qa.processAction(F.a.Ffj,2);break;case ma.a.E$b:ha.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");
w.AFrameworkApplication.Qa.processAction(F.a.E$b,2);break;case ma.a.hie:ha.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");w.AFrameworkApplication.Qa.processAction(F.a.NAj,2);break;case ma.a.lie:ha.ULS.sendTraceTag(537424842,204,50,"Host_SendChannelId Received")}}Byd(){t.FocusManager.instance()&&t.FocusManager.instance().Ee&&t.FocusManager.instance().Ee.name===w.AFrameworkApplication.jjb&&t.FocusManager.instance().J1(t.FocusManager.instance().Ee.name)}QMj(a){t.FocusManager.instance().cV(w.AFrameworkApplication.jjb,
!1);if(uh.a.huc in a.Values){const b={};b[uh.a.huc]=a.Values[uh.a.huc];ha.ULS.sendTraceTag(38278996,204,50,Nd.c(b))}}YMj(a){if(!ug.a.cO(document.URL,w.AFrameworkApplication.Ahd)&&a.Values){var b=0,c=0;try{b=a.Values[uh.a.ZMj],c=a.Values[uh.a.$Mj],uh.a.fkg in a.Values?this.oCc=a.Values[uh.a.fkg]:uh.a.gkg in a.Values&&(this.oCc=a.Values[uh.a.gkg]),uh.a.hkg in a.Values&&(this.qHd=a.Values[uh.a.hkg])}catch(f){return}this.oVb=b;this.qVb=c;this.F7&&this.pyg()}}H$j(a){ha.ULS.sendTraceTag(37536415,204,50,
"JsApiDiagnostics");var b=a.Values[uh.a.VMj];b&&yj.a.instance.r5k(b);(b=a.Values[uh.a.z_d])&&yj.a.instance.e5k(b);(a=a.Values[uh.a.fdb])&&yj.a.instance.w5k(a)}fsi(a){ha.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now());w.AFrameworkApplication.dCb=!0;w.AFrameworkApplication.Aa.p2.BMe(a.Fj.nc)}DQl(){ha.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());w.AFrameworkApplication.Aa.p2.gOe(null,Sys.EventArgs.Empty)}pyg(){this.vfk();
this.wfk();null!=this.oCc&&yj.a.instance.s5k(this.oCc);null!=this.qHd&&yj.a.instance.t5k(this.qHd)}vfk(){this.F7&&this.oVb&&!this.Sjf&&(this.Sjf=!0,this.oVb>this.F7||(w.AFrameworkApplication.Ci.setDw(10324,this.F7-this.oVb),yj.a.instance.xoh(this.oVb)))}wfk(){this.F7&&this.qVb&&!this.Ujf&&(this.Ujf=!0,this.qVb>this.F7||(w.AFrameworkApplication.Ci.setDw(10325,this.F7-this.qVb),yj.a.instance.Y5k(this.qVb)))}vel(){var a=Cd.a.nfg();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.F7||
w.AFrameworkApplication.Ci.setDw(11045,this.F7-b)}}create(){w.AFrameworkApplication.qpg&&this.disable();this.GMa!==yA.a.l0b&&this.qCa(this.GMa);this.Ca.ra(F.a.DYi,ye.a.frame,Object(H.a)(this,this.IYi,"disposeInstance"),96);this.Nu(ma.a.BXd);this.Nu(ma.a.DXd);this.Nu(ma.a.bge);this.Nu(ma.a.cge);this.Nu(ma.a.iie);this.Nu(ma.a.kie);this.Nu(ma.a.EVd);const a=Object(H.a)(this,this.WMj,"hostMessageHandler");this.A0a(ma.a.BXd,a);this.A0a(ma.a.DXd,a);this.A0a(ma.a.bge,a);this.A0a(ma.a.cge,a);this.A0a(ma.a.iie,
a);w.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.Fyf(ma.a.tbf),this.Fyf(ma.a.ubf),this.A0a(ma.a.tbf,a),this.A0a(ma.a.ubf,a));if(w.AFrameworkApplication.fa.ka("PostMessageEmbedded")||w.AFrameworkApplication.fa.ka("IsJsApi")){this.Nu(ma.a.$zb);const b=Object(H.a)(this,this.bQl,"uiHostMessageHandler");w.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.Nu(ma.a.eie),this.fC(ma.a.eie,b));this.fC(ma.a.$zb,b);w.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&
(this.Nu(ma.a.gie),this.fC(ma.a.gie,b),this.Nu(ma.a.fie),this.fC(ma.a.fie,b),this.Nu(ma.a.E$b),this.fC(ma.a.E$b,b),this.Nu(ma.a.hie),this.fC(ma.a.hie,b));w.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.Nu(ma.a.lie),this.fC(ma.a.lie,b))}w.AFrameworkApplication.fa.ka("IsJsApi")&&(this.Nu(ma.a.fdb),this.A0a(ma.a.fdb,a))}IYi(a,b,c){if(2!==c)return 32;zy.a.Wy(this);return 32}reportDocumentLoadedTime(a){this.Tjf||(this.F7=a,this.vel(),this.GMa!==yA.a.l0b&&this.sendMessage(ma.a.Xni,
{["DocumentLoadedTime"]:a}),this.pyg(),this.Tjf=!0)}}Object(m.a)(zA,"HostIntegrationMessenger",ti.a,[1110,537,108]);class EF{constructor(){this.Ea=null}get name(){return"Common.App.Postmessengers"}init(){w.AFrameworkApplication.fa.$e(()=>{this.nje(this.Ea)})}nje(a){w.AFrameworkApplication.UQ=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");w.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Xb(a){this.Ea=a;a.register(zA,
"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").na().oa(()=>{w.AFrameworkApplication.fa.fU||ha.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=w.AFrameworkApplication.Foa?w.AFrameworkApplication.Foa:yA.a.l0b;ha.ULS.sendTraceTag(536987587,204,50,"HostIntegrationMessenger instantiating");return new zA(window.parent,b,Ku.a.instance,w.AFrameworkApplication.Qa)});a.register(xA,"Common.App.HostActionExecutionManager").na().oa(()=>
{w.AFrameworkApplication.fa.fU||ha.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new xA(w.AFrameworkApplication.fa,w.AFrameworkApplication.Qa,a.Ia("Postmessage.IHostPostmessenger"))})}}Object(m.a)(EF,"PostmessengersPackage",null,[2,3]);var AA=d(414),bo=d(319),el=d(275),tg=d(210);class BA extends tg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(BA,"PersonaButtonProps",
tg.a,[]);class FF{N3b(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new el.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.kOi(a,c.ControlList);b.push(c)}}kOi(a,b){const c=Object.assign(new AA.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new bo.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new el.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,
b);this.tQi(a,b.ControlList)}tQi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new BA,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}Object(m.a)(FF,"PresenceContextMenuSectionBuilder",null,[684]);var CA=d(361);class DA{constructor(a,b,c,f){this.LZ=this.Kn=this.rn=this.Ff=this.lqa=null;this.gHc=a;this.u$h=f;this.gHc.One&&(this.rn=
new pd.a(3,2,5E3,Object(H.a)(this,this.rri,"authenticationCheckTask"),2),w.AFrameworkApplication.De.Hb(this.rn),this.vb(b,c));this.gHc.Yhi(()=>{this.Ymc()});this.gHc.CAf(()=>{this.Zmc()})}get businessBar(){return this.Kn||(this.Kn=Fb.a.instance.rb("CommonUI.IBusinessBar"))}get UHf(){return this.LZ||(this.LZ=Fb.a.instance.rb("CommonUI.IBusinessBarEntryFactory"))}vb(a,b){const c=w.AFrameworkApplication.Qa;c.ra(F.a.JFf,ye.a.frame,a,96);c.ra(F.a.KFf,ye.a.frame,b,96);c.ya(F.a.sKf,ye.a.frame,zf.ActionManager.Cv);
c.ya(F.a.tKf,ye.a.frame,zf.ActionManager.Cv);c.ya(F.a.Zse,ye.a.frame,zf.ActionManager.Cv)}Ymc(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);w.AFrameworkApplication.Qa.processAction(F.a.JFf,2)}Zmc(){this.uJl();w.AFrameworkApplication.Qa.processAction(F.a.KFf,2)}rri(){this.gHc.authenticationCheck()}uJl(){this.Ff&&(this.Ff.hide(),this.Ff.dispose(),this.Ff=null);this.lqa&&this.businessBar&&(w.AFrameworkApplication.Yg||this.businessBar.removeEntry(this.lqa),this.lqa.dispose(),this.lqa=
null)}showDialog(a){zy.a.Wy(this.Ff);this.Ff=new sh.StandardDialog;this.u$h||(this.Ff.Mr=!1,this.Ff.Ad=0);this.Ff.Le(1,CommonUIStrings.l_SignIn);this.Ff.zP(CommonUIStrings.l_DefaultDialogTitle,a,Object(H.a)(this,this.V3,"dialogHandler"))}V3(a){1===a?(CA.a.ymd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),w.AFrameworkApplication.Qa.processAction(F.a.Zse,2)):(this.Izl(),w.AFrameworkApplication.Qa.processAction(F.a.tKf,2))}Izl(){this.businessBar&&this.UHf&&(this.lqa=
this.UHf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.lqa.closeable=!0,this.lqa.addButton(CommonUIStrings.l_SignIn,DA.mwi,""),this.lqa.KW=Object(H.a)(this,this.nwi,"businessBarEntryCloseHandler"),this.businessBar.li(this.lqa,!1))}nwi(){this.UXi();w.AFrameworkApplication.Qa.processAction(F.a.sKf,2)}UXi(){this.rn&&(w.AFrameworkApplication.De.Kg(this.rn),this.rn=null)}dispose(){this.rn=this.Ff=this.lqa=null}static mwi(){CA.a.ymd();w.AFrameworkApplication.Qa.processAction(F.a.Zse,
2)}}Object(m.a)(DA,"SignOutResponseUI",null,[108]);class Pr{get name(){return"Common.App.UI"}Xb(a){a.register(FF,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").na()}init(){}dispose(){zy.a.Wy(Pr.Fca);Pr.Fca=null}static main(){n.a.instance.Ac(new Pr)}static QQj(a,b,c){Pr.uzl()&&(Pr.Fca=new DA(CA.a.instance,a,b,c))}static uzl(){return w.AFrameworkApplication.O7g&&!w.AFrameworkApplication.isEmbedded}}Pr.Fca=null;Object(m.a)(Pr,"CommonAppUIPackage",
null,[2,3]);class EA{constructor(a){this.KBa=this.EBa=this.PBa=this.OBa=null;this.vjf=this.Egf=this.xjf=this.xnf=this.ZP=this.jca=!1;this.lOd=this.Pnf=null;this.Inf=0;this.Ma=this.Nnf=null;this.Wha=a;this.IG=3;this.eqb=!0}initialize(a,b,c){this.OBa=this.Yde(a,b);this.PBa=CommonUIStrings.l_SavingStatus;this.EBa=CommonUIStrings.l_ReadOnlyStatus;this.KBa=CommonUIStrings.l_ReviewModeStatus;this.Wha&&this.Wha.execute(f=>{f.X_b(Object(H.a)(this,this.Jxc,"updateToSavingStatus"))});this.ZP=!0;this.Ma=c;this.Egf=
this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}$pa(a,b){this.jca=a;this.IG=b;this.updateSaveStatusText(this.eqb)}updateSaveStatusText(a){!this.eqb&&a&&(this.Nnf=new Date);this.eqb=a;this.vjf=!1;a=null;3===this.IG&&(a=this.eqb?this.OBa:this.PBa);this.kYi(a)}Yde(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}Jxc(){this.updateSaveStatusText(!1)}Qoj(){switch(this.IG){case 1:return this.EBa;
case 2:return this.KBa;default:return null}}Poj(){if(3!==this.IG)switch(this.IG){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.vjf?"FailedToSave":this.eqb?"Saved":"Saving"}sZj(a){return this.xnf===this.jca&&this.Inf===this.IG&&this.Pnf===a}$4d(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.jca,a,this.Qoj(),this.Nnf,this.eqb,this.Egf?b.getHeaderSaveStatusIconProps(this.Poj()):null);this.xjf=!0;return null});this.lOd=null}kYi(a){this.ZP&&Zg.c()&&
!this.sZj(a)&&(!this.xjf&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.$4d(a):Cd.a.mYe()?(this.lOd&&ha.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.lOd=window.requestIdleCallback(()=>{this.$4d(a)})):window.requestAnimationFrame(()=>{this.$4d(a)}),this.xnf=this.jca,this.Pnf=a,this.Inf=this.IG)}}Object(m.a)(EA,"ReactSaveStatusUIHandler",null,[1109]);class FA{constructor(a,b){this.UQ=
null;this.OBa=CommonUIStrings.l_SavedStatus;this.PBa=CommonUIStrings.l_SavingStatus;this.EBa=CommonUIStrings.l_ReadOnlyStatus;this.KBa=CommonUIStrings.l_ReviewModeStatus;this.fBa=b;this.Wha=a;this.IG=3;this.cQa=!0}rP(){this.Wha&&this.Wha.execute(a=>{a.X_b(Object(H.a)(this,this.Jxc,"updateToSavingStatus"))});this.fBa.execute(a=>{this.UQ=a})}$pa(a,b){this.IG=b;3===b?this.updateSaveStatusText(this.cQa):2===b?this.W9e(this.KBa):this.W9e(this.EBa)}Jxc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.cQa=
a;this.W9e(this.cQa?this.OBa:this.PBa)}W9e(a){this.UQ&&this.UQ.sendMessage(ma.a.$Pl,this.OJi(a))}OJi(a){const b={};b.StatusText=a;return b}}Object(m.a)(FA,"SaveStatusPostMessageHandler",null,[1109]);var Pm=d(267);class GA{constructor(a,b,c,f){this.KBa=this.EBa=this.PBa=this.OBa=null;this.z5a=0;this.eQ=this.YOd=this.G3a=this.lCd=this.yRd=null;this.mf=a;this.Nqa=b;this.Wha=c;this.nl=f;this.Alf=!0;this.jca=!1;this.IG=3;this.cQa=!0}initialize(a,b){if(!this.mf)return!1;this.OBa=this.Yde(a,b);this.PBa=
CommonUIStrings.l_SavingStatus;this.EBa=CommonUIStrings.l_ReadOnlyStatus;this.KBa=CommonUIStrings.l_ReviewModeStatus;this.rP();return!0}Yde(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}rP(){this.Nqa&&this.Nqa.execute(a=>{a.pki(Object(H.a)(this,this.kSf,"createStatusAndModeElements"));a.Wji(Object(H.a)(this,this.PAl,"showHideSaveStatusElement"));a.ULl&&this.kSf(null,
null)});this.Wha&&this.Wha.execute(a=>{a.X_b(Object(H.a)(this,this.Jxc,"updateToSavingStatus"))})}hAa(){this.eQ&&this.mf&&this.mf.ezd(this.eQ)}PAl(a,b){this.$pa("true"===b,this.IG)}$pa(a,b){this.jca=a;this.IG=b;this.lCd&&(this.lCd.style.display=this.jca||3===this.IG||!this.yRd?"none":"");this.G3a&&(this.G3a.style.display=this.jca||3===this.IG?"none":"",this.G3a.innerText=1===this.IG?this.EBa:this.KBa,this.G3a.title=1===this.IG?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.YOd&&(this.YOd.style.display=this.jca||1===this.IG||!this.yRd&&!this.G3a?"none":"");this.eQ&&(this.eQ.style.display=this.jca||1===this.IG?"none":"",this.updateSaveStatusText(this.cQa),this.eQ.title=CommonUIStrings.l_SaveStatusTooltip)}kSf(a,b){a=document.getElementById(Pm.CuiHelper.WLj);b&&b.qZl||!a||""===this.OBa||""===this.PBa||""===this.EBa||""===this.KBa||(this.yRd=document.getElementById(Pm.CuiHelper.PXd),this.lCd=Pm.CuiHelper.SOc(a,"BreadcrumbAppModeDash","-"),this.G3a=Pm.CuiHelper.SOc(a,
"BreadcrumbAppModeStatus",1===this.IG?this.EBa:this.KBa),this.WPh(this.G3a),this.YOd=Pm.CuiHelper.SOc(a,"BreadcrumbSaveStatusDash","-"),this.eQ=Pm.CuiHelper.SOc(a,"BreadcrumbSaveStatus",this.OBa),this.WPh(this.eQ),this.$pa(this.jca,this.IG))}Jxc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.cQa=a;this.QUl(this.cQa?this.OBa:this.PBa)}QUl(a){!this.eQ||3!==this.IG&&2!==this.IG||(this.Alf&&!this.cQa?(this.z5a=this.eQ.offsetWidth<this.z5a?this.z5a:this.eQ.offsetWidth,this.IRl(this.PBa),
this.Alf=!1):this.eQ.innerText=a)}WPh(a){a.style.direction=this.nl?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.nl?"right":"left";a.style.display=this.jca?"none":"";a.setAttribute("Unselectable","on")}IRl(a){this.eQ&&(this.eQ.style.width="",this.eQ.innerText=a,this.z5a=this.eQ.offsetWidth<this.z5a?this.z5a:this.eQ.offsetWidth,a=tf.a.wt(this.eQ),this.eQ.style.width=this.z5a-Ga.a.YM(a.paddingLeft)-Ga.a.YM(a.paddingRight)+1+"px")}}Object(m.a)(GA,"SaveStatusUIHandler",null,[1109]);class GF{constructor(){this.ZOd=
this.RNd=this.JYb=this.Ea=null}get name(){return"Common.App.SaveStatus"}Xb(a){this.Ea=a;w.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&w.AFrameworkApplication.UT?this.Ea.register(FA,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").na().oa(()=>new FA(this.Ea.Ia("Common.App.HostNotification.EditNotificationEventSource"),this.Ea.Ia("Postmessage.IHostPostmessenger"))):w.AFrameworkApplication.Aa.mb.wug||(w.AFrameworkApplication.Aa.mb.uO?this.Ea.register(EA,
"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").na().oa(()=>new EA(this.Ea.Ia("Common.App.HostNotification.EditNotificationEventSource"))):this.Ea.register(GA,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").na().oa(()=>new GA(Md.EventHandlerManager.instance,this.Ea.Ia("Common.App.Header.HeaderEventSource"),this.Ea.Ia("Common.App.HostNotification.EditNotificationEventSource"),w.AFrameworkApplication.isRtl)))}init(){w.AFrameworkApplication.fa.$e(Object(H.a)(this,
this.jn,"onFullAppSettingsReady"))}jn(){const a=w.AFrameworkApplication.fa,b=!!w.AFrameworkApplication.Aa.mb&&4===w.AFrameworkApplication.Aa.mb.Ti;if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))w.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&w.AFrameworkApplication.UT?(this.ZOd=this.Ea.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&
this.ZOd.rP():w.AFrameworkApplication.Aa.mb.wug||w.AFrameworkApplication.hideHeader||(w.AFrameworkApplication.Aa.mb.uO?(this.RNd=this.Ea.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.RNd.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus"),w.AFrameworkApplication.fa):(this.JYb=this.Ea.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.JYb.initialize(a.ka("IsSkyDrive"),a.Ha("HostNameToIncludeInSavedStatus")))}dispose(){this.JYb&&this.JYb.hAa()}}Object(m.a)(GF,
"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2023-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:.97,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},
CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCih_e1uFIbpMs9-LxFTE8VpUOTdPWE9TQlVSMzRRMklBVE5XQVowSUE3OC4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:1,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},
FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},
Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,
IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},
Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:.97,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},
CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrqS6vMqN69DhDipYQ7GG0BUQkU0RkYxUFEzTEJINlNaR0RDUTNDMzZHUC4u"}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive",
"4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},
SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2","VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",
StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",
StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",
Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",
EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",
YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,
NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",
NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:1,NominationScheme:{Type:0,
PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",
RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},
{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",
Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",
YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",
RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},
{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,
Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,
Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},
{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},
{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,
Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},
FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3",
"FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-06-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}},{CampaignId:"c855ff69-ff13-48f9-83b8-e76d1b65ee6a",
StartTimeUtc:"2023-01-01T00:00:00Z",EndTimeUtc:"2024-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"InsertPicture",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"PPTO_Picture_FloodgatePromptTitle",
Question:"PPTO_Picture_FloodgatePromptQuestion",YesLabel:"PPTO_Picture_FloodgatePrompt_YesLabel",NoLabel:"PPTO_Picture_FloodgatePrompt_NoLabel"},Rating:{Question:"PPTO_Picture_FloodgateRatingQuestion",RatingValuesAscending:["PPTO_Picture_FloodgateRating_1","PPTO_Picture_FloodgateRating_2","PPTO_Picture_FloodgateRating_3","PPTO_Picture_FloodgateRating_4","PPTO_Picture_FloodgateRating_5"]},Question:{Question:"PPTO_Picture_FloodgateWhyQuestion"}}}}];var cQ=d(681);class HF{U5f(){return null}afj(){return Nd.c(window.PPTCampaignsObj_FromAppPackage)}Cfe(a){return cQ.a.Cfe(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(m.a)(HF,"PowerPointFeedbackAppData",null,[989]);class HA{constructor(){this.Ea=null}Xb(a){this.Ea=a;a.register(989,"Common.App.IAppSpecificFeedbackData").na().oa(()=>new HF)}init(){this.Ea.rb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){n.a.instance.Ac(new HA)}}Object(m.a)(HA,"PPTWebEditorFeedbackPackage",null,[2,3]);class IA{get name(){return"Box4.ListEditors"}Xb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new IA)}}
Object(m.a)(IA,"Box4ListEditorsPackage",null,[2,3]);var Mj=d(143),Ck=d(126);const JA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class IF{constructor(a){this.rSd=this.YGd=!1;this.eOa=null;this.pef=!1;this.G2=null;this.ica=!1;this.k8h=a;ka.a.instance.ub(pa.a.mouseDown,this.R7b(),Object(H.a)(this,this.iGk,"onContextualUIMouseDown"));(a=Fb.a.instance.Ia("Common.IActionContextProvider"))&&a.execute(b=>{this.G2=b});w.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
w.AFrameworkApplication.Aa.mb.uO?Sd.a.get_instance().Vj(16,()=>{this.sg?this.initializeContextualUI(this.R7b()):Sd.a.get_instance().Vj(7,()=>{this.initializeContextualUI(this.R7b())})}):Sd.a.get_instance().Vj(7,()=>{this.initializeContextualUI(this.R7b())})}get Qua(){return this.ica}get sg(){return w.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&w.AFrameworkApplication.Aa.mb.uO?Sd.a.get_instance().isCompleted(16)&&Sd.a.get_instance().isCompleted(7):Sd.a.get_instance().isCompleted(7)}Vzi(){if(this.pef)return!0;
try{return Promise.resolve(null),this.pef=!0}catch(a){return!1}}n$e(a){if(!this.sg||this.rSd)return this.kue("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.Vzi())return this.kue("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(w.AFrameworkApplication.nRc||""!==w.AFrameworkApplication.c5b)if(!w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===w.AFrameworkApplication.c5b||"ContentAssemblyView"===
w.AFrameworkApplication.c5b)return this.kue("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.rSd=!0;let b=F.a.we;switch(a){case 1:b=F.a.showContextMenu;break;case 0:b=F.a.showFloatie;break;case 2:b=F.a.ivd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.rSd=!1;kk.c(b)},0)});return!1}mfg(a){return Mj.UISurfaces.JEa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();
const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.n$e(0)||this.mfg(b).then(l=>{if(0>=l.length)return null;this.d2e(l).then(()=>{const y={};y.target=a;Mj.UISurfaces.JEa().then(G=>{appChrome.api.dispatch(G.showFloatie(y,c,void 0,this.Ice(),f));this.ica=!0;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&w.AFrameworkApplication.Qa&&w.AFrameworkApplication.Qa.processAction(F.a.tek,
2);return null})});return null})}showContextMenu(a,b,c=null,f=null){this.n$e(1)||this.oEh(a,b,c,f)}oEh(a,b,c=null,f=null){this.d2e(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);Mj.UISurfaces.JEa().then(y=>{appChrome.api.dispatch(y.showContextMenu(l,b,c,void 0,this.Ice()));return null})})}oza(a,b,c){this.n$e(2)||this.mfg(b).then(f=>{0>=f.length?this.oEh(a,c,null):this.d2e(f).then(()=>{const l={};l.target=a;const y={};y.target=a;Mj.UISurfaces.JEa().then(G=>{appChrome.api.dispatch(G.showContextualUI(l,
y,c,void 0,null,this.Ice()));this.ica=!0;return null})});return null})}kue(a){ha.ULS.sendTraceTag(561394519,340,15,a)}X4d(){this.sg&&Mj.UISurfaces.isLoaded()&&Mj.UISurfaces.JEa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());return null})}iE(){this.sg&&Mj.UISurfaces.isLoaded()&&Mj.UISurfaces.JEa().then(a=>{this.ica=!1;appChrome.api.dispatch(a.hideFloatie());return null})}R4b(){this.sg&&Mj.UISurfaces.isLoaded()&&Mj.UISurfaces.JEa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.ica=
!1;return null})}initializeContextualUI(a){return Mj.UISurfaces.JEa().then(b=>{this.YGd||(b.initializeContextualUI(a),this.YGd=!0);return null})}d2e(a){if(!this.YGd)return this.initializeContextualUI(this.R7b()).then(()=>{this.setActiveFloatieGroups(a);return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];Mj.UISurfaces.JEa().then(f=>{c.push.apply(c,
this.k8h.ULb.EYc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}R7b(){if(this.eOa)return this.eOa;this.eOa=JA("div");this.eOa.id="ReactContextualUIDiv";this.eOa.style.position="absolute";this.eOa.style.zIndex="1001";document.body.insertBefore(this.eOa,document.body.firstChild);return this.eOa}iGk(a){a.nc&&a.nc.target&&"input"===a.nc.target.tagName.toLowerCase()&&t.FocusManager.instance().hC("ribbon");return!1}Ice(){return this.G2?this.G2.contentType:
"Unknown"}}Object(m.a)(IF,"ReactContextualUILauncher",null,[984]);var Bj=d(131);class KA{constructor(a){this.sYb=a}create(a,b){const c=new Sys.StringBuilder;this.R3b(c,a,b);this.d2d(c,a);return c.toString()}hu(a,b){const c=[];this.K2d(c,a,b);this.e2d(c,a);return c}R3b(a,b,c){switch(b.errorType){case 0:a.append(this.sYb.build());break;case 1:case 2:a.append(this.XXd(b,c))}}K2d(a,b,c){switch(b.errorType){case 0:a.push(this.sYb.AHf());break;case 1:case 2:a.push(this.zui(b,c))}}d2d(a,b){M.a.instance.ga(92)||
(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(Bj.a("btnIgrnoreSpellingError",(2===b.errorType?C.a.gzd:C.a.ola).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}e2d(a,b){if(!M.a.instance.ga(92)){var c=Object.assign(new el.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:b}));a.push(c)}}XXd(a,b){a=this.tcj(a.suggestions,
b);return 0<a.length?Bj.e("msUnknownWord",Bj.c(null,a),"Menu16"):Bj.e("msUnknownWord",Bj.c(null,[Bj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}tcj(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l)a[l]&&c.push(Bj.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}zui(a,b){const c=Object.assign(new el.a,{Id:"Suggestions",ControlList:[]});this.scj(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new tg.a,
{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}scj(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const y=Object.assign(new tg.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});Array.add(c,y)}}}}Object(m.a)(KA,"DefaultProofingContextMenuCreator",null,[]);class LA{constructor(a,b){this.Rff=a;this.jhf=b;this.nQa=[C.a.Nza,C.a.Oza,C.a.Pza,C.a.EMa,C.a.FMa]}create(a,b){return b?Object(Sa.a)(dl.a,b)?this.jhf.create(a,b,
this.nQa):this.Rff.create(b,this.nQa):""}N3b(a,b){return b?Object(Sa.a)(dl.a,b)?this.jhf.hu(a,b,this.nQa):this.Rff.hu(b,this.nQa):null}}Object(m.a)(LA,"ProofingContextMenuSectionFactory",null,[1426]);class JF{build(){const a=[Bj.a("btnDeleteRepeatedWord","2023591105",Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Bj.e("msRepeatedWord",Bj.c(null,a),"Menu16")}AHf(){const a=Object.assign(new el.a,{ControlList:[]}),b=Object.assign(new tg.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,
b);return a}}Object(m.a)(JF,"ProofingRepeatedWordSectionBuilder",null,[1427]);var MA=d(1155);class Ts{constructor(a,b){this.c4a=a;this.fm=b}get isVisible(){return this.c4a.Qua}get controls(){return null}iE(){this.c4a.iE();return!0}G3e(a,b){this.c4a.showFloatie(Object.assign(new MA.a,{x:a.x,y:a.y}),this.u7b(b),b,null)}g9f(){return new Sys.UI.Bounds(0,0,0,0)}dta(){return this.iE()}u7b(){return[]}}Object(m.a)(Ts,"ReactFloatie",null,[334,335]);class KF{constructor(a){this.sAc=null;this.c4a=a}dispose(){}dta(){this.c4a.R4b();
return!0}showContextMenu(a,b){this.N6(a,b.clientPoint,b.kg)}N6(a,b,c){this.hvd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);ha.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}hvd(a,b,c,f=null){this.sAc?this.c4a.oza(Object.assign(new MA.a,{x:b.x,y:b.y}),this.sAc.u7b(c),c):this.c4a.showContextMenu(Object.assign(new MA.a,{x:b.x,y:b.y}),c,void 0,f);this.sAc=null}ivd(a,b,c,f){this.sAc=Object(sa.a)(Ts,c);f.lba(a,b);return!0}}Object(m.a)(KF,"ReactContextMenuController",null,[985,108]);
var Qr=d(447);class Ay{static get hg(){return ei.a.pz(Ay.Fo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Ay.Fo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(m.a)(Ay,"AutoCorrectOptionsDialogHTML",null,[]);class By{static get hg(){return ei.a.pz(By.Fo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}By.Fo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(m.a)(By,"AutoCorrectOptionsDialogHTML2",null,[]);class LF extends ei.a{constructor(a,b){super();this.wS=a;this.l3=b;this.ig="AutoCorrectOptionsDialog"}Kuc(){ha.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.hg=this.l3?By.hg:Ay.hg;const a={};a.ReplaceTextAsYouType=this.wS.vkb;a.CapitalizeFirstLetterOfSentences=this.wS.JMc;a.ReplaceOrdianalsWithSuperscript=this.wS.Bqd;a.ReplaceHyphensWithDash=this.wS.Xrc;a.ReplaceFractionsWithFractionCharacter=this.wS.zqd;this.l3&&
(a.ReplaceQuoteWithSmartQuote=this.wS.UXe);this.sj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(H.a)(this,this.Tnl,"setAutoCorrectOptionsHandler"),a)}Tnl(a,b){M.a.instance.ga(70)&&(1!==a?ha.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.wS.vkb||b.CapitalizeFirstLetterOfSentences!==this.wS.JMc||b.ReplaceOrdianalsWithSuperscript!==this.wS.Bqd||b.ReplaceHyphensWithDash!==this.wS.Xrc||b.ReplaceFractionsWithFractionCharacter!==
this.wS.zqd||this.l3&&b.ReplaceQuoteWithSmartQuote!==this.wS.UXe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.l3&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.wS.vjl(a),ha.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.l3,["ReplaceQuoteWithSmartQuote"]:this.l3&&b.ReplaceQuoteWithSmartQuote}),
Sc.App.Mb.updateCommandUI(!0)):ha.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(m.a)(LF,"AutoCorrectOptionsDialog",ei.a,[987]);class Cy{static get hg(){return ei.a.pz(Cy.Fo,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Cy.Fo="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Cy,"AltTextDialogWithDescriptionHtml",null,[]);class Dy{static get hg(){return ei.a.pz(Dy.Fo,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}Dy.Fo="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(Dy,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class kp extends ei.a{constructor(a=!1,b=!1){super(!1,!1,a);this.Sjg=!1;b?(this.Sjg=!0,this.hg=Dy.hg):this.hg=Cy.hg;this.ig=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}AMi(a){this.sj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(H.a)(this,this.qVd,"altTextDialogHandler"),this.RVc(a));a=document.getElementById(kp.sVd)||document.getElementById(kp.BKc);a.focus();a.select()}CMi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.RVc(a)};
this.sj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(H.a)(this,this.qVd,"altTextDialogHandler"),a)}RVc(a){const b={};this.Sjg?b[kp.CMj]=!0:b[kp.sVd]=this.getAltText(a);b[kp.BKc]=this.i8f(a)||"";return b}YN(a){return a.Bc.id===kp.BKc?!1:super.YN(a)}}kp.sVd="titleText";kp.BKc="descriptionText";kp.CMj="hideTitleField";Object(m.a)(kp,"BaseAltTextDialogWithDescription",ei.a,[]);class du extends kp{constructor(a,b=!1,c=!1){super(b,c);this.ig=du.INj;b&&w.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?
this.CMi(a):this.AMi(a)}}du.INj="AAltTextDialogWithDescription";Object(m.a)(du,"AAltTextDialogWithDescription",kp,[]);class MF extends du{constructor(a,b,c,f,l){super(a);this.hsb=this.xTb=null;this.$D=b;this.Lha=c;this.Mk=f;this.hd=l}i8f(a){this.xTb=a.node;this.hsb=Hd.TableReader.deg(a);return Hd.TableReader.Wee(this.hsb)}getAltText(a){this.xTb=a.node;this.hsb=Hd.TableReader.deg(a);return Hd.TableReader.Xee(this.hsb)}qVd(a){if(1===a){Hd.TableReader.Xee(this.hsb);Hd.TableReader.Wee(this.hsb);this.hide();
a=this.Mk.ke(15);try{a.ld(this.xTb)}finally{a&&a.dispose()}}M.a.instance.ga(50)&&this.Lha.Ew&&this.Lha.vZ.Sra(this.xTb)}}Object(m.a)(MF,"TableAltTextDialog",du,[]);class NA{constructor(a,b,c){this.$D=a;this.Mk=b;this.hd=c}create(a){return new MF(a,this.$D,Sc.App.Oh,this.Mk,this.hd)}}Object(m.a)(NA,"TableAltTextDialogFactory",null,[]);const dQ=()=>{Sc.App.Ani=!0;return 32},eQ=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,Uu:b}=NF(l)).returnValue)return 16;Sc.App.Mb.oza(a,b);return 32},fQ=(a,b,c,f,
l)=>{if(1===c)return 32;if(!({point:a,Uu:b}=NF(l)).returnValue)return 16;Sc.App.Mb.O6(a,b);return 32},NF=a=>{let b,c;b=null;c=0;if(!a)return{returnValue:!1,point:b,Uu:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,Uu:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,Uu:c}};var gQ=d(1156);class OF extends Sys.EventArgs{constructor(a,b,c,f,l,y=0,G=0,R=null){super();this.controlId=a;this.ZJb=c;this.commandId=f;this.time=l;this.commandSurface=
y;this.Uu=G;this.contentType=R}}Object(m.a)(OF,"CommandClickEventArgs",Sys.EventArgs,[]);class PF{constructor(a,b){this.fca=a.Fhj();this.DTb=a;this.GNa=b}O_f(a,b,c,f=null,l=null){c&&(this.GNa.Lp=c.CommandLocation,this.GNa.bU=c.InvocationMethod,this.GNa.Gsa=c.CommandTabName);let y=this.DTb.K8f(parseInt(a),b,c);y.zD&&(y=this.DTb.K8f(y.hm,b,c));if(void 0!==y.yL&&null!==y.yL)return y.yL;if(y.Ghe)l=32;else{var G=null;this.fca&&this.fca.NRe&&(G=this.fca.NRe(y,l));y.xX||y.Hqe?y.Fq?l=16:(l=this.GNa.Ja(y.hm,
y.Gqe?2:1,y.vd,l),2===l&&(l=32)):y.Fq?l=this.GNa.Bnd(null,y.hm,y.vd,R=>{f&&f(R.response)},l):(l=this.GNa.Ja(y.hm,2,y.vd,l),f&&f(l));this.fca&&this.fca.iRe&&this.fca.iRe(y,l,G);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";G=b.ParentMenuId;void 0!==G&&null!==G||!b.MenuId||(G=b.MenuId);let R=b.SqmControlId;void 0!==R&&null!==R||!b.SourceControlId||(R=b.SourceControlId);(void 0!==R&&null!==R||void 0!==G&&null!==G)&&gQ.a.W0k(new OF(R,c,G,a,Date.now()))}}y.xX&&
32===l&&this.fca&&this.fca.A0b&&this.fca.A0b(y,b);y.Hqe&&32===l&&this.fca&&this.fca.cWd&&this.fca.cWd(y,b);return 32===l||1===l}Acc(a,b=null){if(w.AFrameworkApplication.Yg||Uj.a.instance.Hw)return!1;const c=parseInt(a);b&&b.UILocation&&(this.GNa.Lp=b.UILocation);if(!a||c===zf.ActionManager.G5b)return!0;a=this.DTb.fWc(c,b);a.zD&&(a=this.DTb.fWc(a.hm,b));if(void 0!==a.yL&&null!==a.yL)return a.yL;c===F.a.u7a&&b&&(a.vd=b);return 32===this.GNa.Ja(a.hm,1,a.vd)}clearCache(){this.DTb.clearCache()}}Object(m.a)(PF,
"GeneralCuiUser",null,[986,1364]);class QF{constructor(a,b,c,f){this.jwf=a;this.Sia=b;this.ezc=c;this.l5a=f}Ccg(){let a;a=this.l5a.csj(this.jwf);return{returnValue:this.l5a.SWc(this.jwf),rlh:a}}AAh(a,b){if(this.Sia){var c=new J.DictionaryPropertySet;this.ezc.execute(f=>{f.R5b(a)});c.setValue(Ya.a.At,a);c.setValue(M.a.instance.ga(20)?sb.a.noProof:we.a.zxa,b);b=new pf.GraphTransaction(15);b.set(Sc.App.IP.AV);this.Sia.rV(c);b.dispose()}}}Object(m.a)(QF,"LanguageEditor",null,[501]);var Ti=d(203);class hr{constructor(a=
!1,b=0){this.dCd=null;this.TJd=hr.udg(ab.a.Hhj());this.PDc=new Yt.a;this.kra=[];this.lrb=new Ma.a;this.Jsf=a;this.Ksf=0>=b?7:b;this.Isf=this.ZNd=0;this.qjf=!1;a&&(this.BSj(),w.AFrameworkApplication.$ga(()=>{this.Agk()}))}get languages(){return this.TJd}BSj(){for(var a of this.TJd)this.PDc.$(a.LCID,a);a=[];try{var b=Ti.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.Ksf);for(const l of f){let y;({value:y}=this.PDc.vg(parseInt(l))).returnValue&&a.push(y)}}}catch(f){ha.ULS.sendTraceTag(38385057,
324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",f.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.lrb.contains(b)||(this.kra.push(c),this.lrb.add(b));else c=w.AFrameworkApplication.lcid,({value:b}=this.PDc.vg(c)).returnValue&&(this.kra.push(b),this.lrb.add(c));this.Cwh()}Cwh(){const a=Za.toArray(Za.select(Za.asEnumerable(this.kra),b=>b.LCID)).join(",");Ti.a.qK("RecentlyUsedLcids",a,180)}iUk(a,b){if(a&&!(0<a.options.length)){var c=-1,f=hr.udg(this.kra);
this.Jsf&&0<f.length&&(c=hr.vHf(f),c=hr.Lzf(a,c,b),a.add(hr.Eui(),null));this.dCd||(this.dCd=hr.vHf(this.TJd));b=hr.Lzf(a,this.dCd,b);-1===c&&(c=b);a.selectedIndex=c}}zql(a,b){if(this.Jsf&&({value:c}=this.PDc.vg(a)).returnValue){b=a!==b;if(this.lrb.contains(a))a=Array.indexOf(this.kra,c),0<=a&&(Array.removeAt(this.kra,a),this.kra.push(c)),b&&this.ZNd++;else{this.lrb.add(a);this.kra.push(c);if(this.kra.length>this.Ksf){var c=this.kra.shift();this.lrb.remove(c.LCID)}b&&this.Isf++}this.Cwh()}}Agk(){const a=
this.ZNd+this.Isf;!this.qjf&&0<a&&(ha.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.ZNd/a),this.qjf=!0)}static vHf(a){return Za.toArray(Za.select(Za.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static Eui(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static Lzf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static udg(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(m.a)(hr,"LanguageListHelper",null,[1023]);var OA=d(242);class eu extends OA.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(eu,"NumberButtonProps",OA.a,[]);class Rr{static get mEl(){return Rr.tvf||(Rr.tvf=
Fb.a.instance.rb("Box4.ISpacingCommands"))}static get pDh(){return!!Rr.mEl}static vb(){const a=w.AFrameworkApplication.Qa;a.ya(C.a.xKa,rb.a.view,Rr.xKa);a.ie(C.a.xKa,1126)}static xKa(a,b,c,f,l){if(1===c||!Rr.pDh)return Rr.pDh?32:8;if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp)a=[],a.push(Object.assign(new eu,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new eu,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new eu,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new eu,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new eu,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new eu,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=Bj.d(a);else{a=Bj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=Bj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=Bj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=Bj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const y=Bj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),G=Bj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),R=Bj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=Bj.c("LineSpacing.Menu.Controls",[a,b,c,f,y,G,R]);a=Bj.e("msLineSpacing",a,"Menu");a=Bj.f([a]);l.PopulationXML=a}return 32}}Rr.tvf=null;Object(m.a)(Rr,"LineSpacingRibbonMenu",null,[]);var hQ=d(1154),iQ=d(945);const jQ=(a,b,c)=>{if(1===
c)return 32;a=Sc.App.Mb.notificationBar.wDa("Automation test",!1);a.image=3;Sc.App.Mb.notificationBar.li(a);return 32},lQ=(a,b,c,f,l)=>{let y;if(!({fSh:y}=kQ(l)).returnValue)return 16;Mj.UISurfaces.KL().then(G=>{let R=null;var ja=Object.assign(new hQ.a,{label:"OK",onExecute:()=>{R&&G.removeNotification(R)}});ja=Object.assign(new iQ.a,{target:"#"+L.AppFrame.Ouh,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:ja,useTeachingStyles:y});ja=G.callout(ja);R=G.addNotification(ja);
return null},G=>{ha.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null});return 32},kQ=a=>{let b;b=!1;if(!a)return{returnValue:!1,fSh:b};b=Boolean.parse(a);return{returnValue:!0,fSh:b}};class PA{constructor(a){this.qI=a}oRb(a){this.qI&&this.qI.pF(a)}}Object(m.a)(PA,"RibbonButtonUpdater",null,[1022]);var RF=d(291);class QA{constructor(){this.B7=this.Ea=null}get name(){return"Box4.UI"}Xb(a){this.Ea=a;a.register(984,"Common.IReactContextualUILauncher").na().oa(()=>
new IF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(985,"Box4.IContextMenuController").na().oa(()=>new KF(a.resolve("Common.IReactContextualUILauncher")));a.register(986,"Box4.IGeneralCuiUser").oa(()=>new PF(a.resolve("Box4.UI.CuiActionBridge"),w.AFrameworkApplication.Qa)).na();a.register(NA,"Box4.UI.TableAltTextDialogFactory").na().oa(()=>new NA(a.resolve("Box4.ITableEditor"),new RF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(501,"Box4.UI.ILanguageEditor").oa(()=>new QF(ze.a.instance.ak,a.rb("Box4.ITextFormattingCommands"),a.Ia("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(987,"Box4.UI.IAutoCorrectOptionsDialog").oa(()=>new LF(a.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(hr,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").na().oa(()=>new hr(w.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(JF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").na();a.register(KA,"Box4.UI.DefaultProofingContextMenuCreator").na().oa(()=>new KA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(LA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").na().oa(()=>new LA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(PA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").na().oa(()=>new PA(this.Ea.resolve("Box4.IAppFrame")))}init(){var a=Sc.App.Mb;const b=a.mb;Pr.QQj(Object(H.a)(b,b.Ymc,"onAuthenticationLost"),Object(H.a)(b,b.Zmc,"onAuthenticationRestored"),a.gAi);Qr.a.vb();a=w.AFrameworkApplication.Qa;a.ya(C.a.AXk,rb.a.application,dQ);a.ra(C.a.Zzl,rb.a.application,eQ,96);a.ra(C.a.BAl,rb.a.application,fQ,96);a=w.AFrameworkApplication.Qa;a.ra(C.a.lCl,rb.a.application,jQ,96);a.ra(C.a.Ozl,rb.a.application,
lQ,96);Rr.vb();this.B7=this.Ea.rb("Box4.IContextMenuController")}dispose(){this.B7&&(this.B7.dispose(),this.B7=null)}static main(){n.a.instance.Ac(new QA,6)}}Object(m.a)(QA,"Box4UIPackage",null,[2,3]);var SF=d(466),mQ=d(898),Us=d(208),nQ=d(553),wv=d(383),rn=d(320),uj=d(74);class TF{constructor(a){this.foa=a}}Object(m.a)(TF,"ValidParentData",null,[]);var Ey=d(376),oQ=d(831),xv=d(289),UF=d(830),yv=d(614),Qm=d(247),VF=d(363),Cq=d(228);class WF{constructor(){this.lwb=0}}Object(m.a)(WF,"BelowOutlineElementData",
null,[]);var Vs=d(426),pQ=d(602),qQ=d(486);class XF extends Vs.a{constructor(a,b,c,f){super(4,f);this.RZh=a;this.rBd=b;this.NCd=c}get sQc(){return this.RZh}get p_b(){return this.rBd}get sXd(){return this.NCd}rzb(){var a=this.sQc;if(!a)return ha.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new pQ.a(this.sQc.id,this.sQc.zo,this.p_b?this.p_b.id:null);""!==a.characterData&&a.characterData&&(a=new qQ.DeleteTextUpdateHint(this.sQc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(m.a)(XF,"DeleteParagraphOperation",Vs.a,[]);var rQ=d(601),sQ=d(485);class RA extends Vs.a{constructor(a,b,c,f,l){super(3,l);this.iMd=a;this.jMd=b;this.mXb=f}get MJa(){return this.iMd}get YIb(){return this.jMd}get DJa(){return this.mXb}rzb(){const a=[];var b=new rQ.AddParagraphUpdateHint(this.DJa.id,this.DJa.zo,this.MJa?this.MJa.id:null);Array.add(a,b);""!==this.DJa.characterData&&this.DJa.characterData&&(b=new sQ.a(this.DJa.id,0,this.DJa.characterData),
Array.add(a,b));return a}}Object(m.a)(RA,"InsertNewParagraphOperation",Vs.a,[]);var tQ=d(600);class YF extends Vs.a{constructor(a,b,c,f){super(2,f);this.iMd=a;this.jMd=b;this.w5h=c}get MJa(){return this.iMd}get YIb(){return this.jMd}get j6g(){return this.w5h}rzb(){const a=[],b=new tQ.MergeParagraphUpdateHint(this.MJa.id,this.MJa.zo,this.MJa.characterData.length,this.YIb.id,this.YIb.zo,this.j6g.id,this.j6g.zo);Array.add(a,b);return a}}Object(m.a)(YF,"MergeParagraphOperation",Vs.a,[]);var uQ=d(599);
class ZF extends Vs.a{constructor(a,b,c,f,l){super(1,l);this.lMd=a;this.R$h=b;this.rBd=c;this.NCd=f}get NJa(){return this.lMd}get p_b(){return this.rBd}get sXd(){return this.NCd}get LEl(){return this.R$h}rzb(){const a=[],b=new uQ.a(this.NJa.id,this.NJa.zo,this.LEl,this.p_b.id,this.p_b.zo,this.sXd.id,this.sXd.zo);Array.add(a,b);return a}}Object(m.a)(ZF,"SplitParagraphOperation",Vs.a,[]);var $F=d(323);class lk{constructor(a,b,c,f,l,y=null){this.pp=this.hd=null;this.ey=a;this.lp=b;this.fh=c;this.oZh=
f;this.t5h=l;this.Lqa=y}Xci(a){M.a.instance.ga(50)&&Sc.App.Oh&&Sc.App.Oh.Ew&&Sc.App.Oh.vZ.Sra(a)}tlb(a,b,c){rc.OutlineElementNavigator.yi(a);zb.ParagraphReader.vl(a)?lk.paragraphEditor.Jv.tlb(a,b,c):Hd.TableReader.jq(a)&&14===a.Bi&&(b=(new xv.a(1,c)).qN,this.Ctl(Object(sa.a)(Ey.a,a.currentNode),b));rc.OutlineElementNavigator.Se(a)}Ctl(a,b){a&&Object(Sa.a)(Ey.a,a)&&(a.um=b)}get Jv(){return wv.a.Lyb}get Xf(){return this.hd||(this.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get g7(){return this.pp||
(this.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get kq(){return this.lp.value}get Vf(){return this.fh.value}get dC(){return this.ey.value}get ij(){return Mh.a.instance}q2d(){const a=nQ.a.instance.createInstance(393229);a.setValue(Ya.a.WE,rn.a.first);a.setValue(Ya.a.cTi,new Date);a.xzd();return a}fQi(){const a=new mQ.a;a.setValue(Ya.a.WE,rn.a.first);return a}gtd(a,b,c){const f=a.Nh;if(f){f.id.equals(lk.aef)||(lk.aef=f.id,lk.rzc={});var l=lk.rzc[b];b in lk.rzc&&
f.pbb(l.id)&&f.xx&&f.xx.p0(l.id)||(l=new Cq.a,l.setValue(Ya.a.author,b),l=f.dLa(l));a.properties.setValue(c,l.id);lk.rzc[b]=l}}eOb(a,b){a.properties.setValue(Ya.a.lastModifiedTime,b)}H$e(a,b=null){const c=new pf.GraphTransaction(7);c.ld(a);b||(b=new Date);this.eOb(a,b);this.gtd(a,this.HYc(),Ya.a.S0b);""===he.OutlineElementReader.bVc(a,Ya.a.mLc)&&this.gtd(a,this.HYc(),Ya.a.mLc);c.dispose()}HYc(){return Sc.App.$7e.name}T5d(a,b,c=!1){if(M.a.instance.ga(56))he.OutlineElementReader.Wqe(a)?(a=he.OutlineElementReader.isRtl(a),
c?this.Otd(b,a):this.VLa(b,a)):this.oal(b);else if(M.a.instance.ga(26)||M.a.instance.ga(89))a=he.OutlineElementReader.isRtl(a),c?this.Otd(b,a):this.VLa(b,a)}BOb(a,b){var c=new ub.GraphIterator;c.set(a);c.rc(11);c=c.Jg(11);he.OutlineElementReader.Jm(c)!==b&&(this.VLa(c,b),M.a.instance.ga(54)?a.anchor.Nr(4):(c=1,b&&(c=3),a.setValue(Ya.a.Vl,c),a.setValue(Ya.a.CJ,c)))}VLa(a,b){const c=new pf.GraphTransaction(7);c.ld(a);this.Otd(a,b);if(M.a.instance.ga(26)){var f=new ub.GraphIterator;f.set(a);f.Db(2)&&
zb.ParagraphReader.vl(f)&&(f=f.currentNode,b?(f.Ae(V.a.tpd,!0),lk.paragraphEditor.pK(f,3)):(f.removeProperty(V.a.tpd),lk.paragraphEditor.pK(f,1)))}f=new ub.GraphIterator;f.set(a);$F.a.instance.UUj(f);if(f.rc(10)){const l=f.Jg(10);f.Db(1)===a&&this.dC.VLa(l,b)}c.dispose()}Otd(a,b){let c=null,f=null;if(this.Xf.gg&&a.isConnected){c=zb.ParagraphReader.xXc(a,!0,!0);f=new Oa.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).h9())}b?a.properties.setValue(Ya.a.PY,!0):M.a.instance.ga(56)?a.properties.setValue(Ya.a.PY,
!1):(M.a.instance.ga(26)||M.a.instance.ga(89))&&a.properties.removeProperty(Ya.a.PY);if(this.Xf.gg&&c&&f)if(c.count!==f.count)ha.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}oal(a){a.properties.removeProperty(Ya.a.PY)}pda(a,b=null,c=!1){let f=null,l=null;if(!he.OutlineElementReader.hh(a))return ha.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var y=null;let G=null,R=0;b&&(y=b.formatting,G=b.style,R=b.languageId);c||({MJa:f,YIb:l}=this.y5f(a));b=Us.a.instance.createInstance(393230);b.setValue(Ya.a.Oo,"");a.Gl(b,2);a.el(b);lk.paragraphEditor.Erc(b);lk.paragraphEditor.Cxk(b);lk.paragraphEditor.zRb(b);this.Xci(b);y&&(b.Sa.first.formatting.Fm=y);R||(R=w.AFrameworkApplication.lcid);a.currentNode.Ae(Ya.a.Mkb,a.currentNode.sa(Ya.a.Mkb,R));M.a.instance.ga(54)&&a.currentNode.setValue(sb.a.uoc,0);!M.a.instance.ga(71)||M.a.instance.ga(61)||G||
(y=Ka.StyleReader.OL(b))&&(G=y.oH(Ka.StyleReader.Mpa));this.oZh.v4i(a);G&&lk.GP.fba(G,b,!0);!c&&f&&(c=new RA(f,l,f,new yv.a(b),b.ISa),a.currentNode.nH().graphTransactionOperations.l_(c));return b}y5f(a){let b;const c=new ub.GraphIterator;c.Tc(a);b=null;c.yqg?c.currentNode.nH().graphTransactionOperations.uja(6):(rc.OutlineElementNavigator.xxa(c,!0,!1),b=this.vWc(c));c.Tc(a);a=this.m6f(c);return{MJa:b,YIb:a}}m6f(a){const b=new ub.GraphIterator;b.Tc(a);a=null;b.oBb||(rc.OutlineElementNavigator.cK(b,
!0,!1),a=this.vWc(b));return a}vWc(a,b=!1){a=rc.OutlineElementNavigator.yi(a,!0);return a?this.C9f(a,b):(ha.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}C9f(a,b=!1){if(12===a.type)return b?new yv.a(a):new UF.a(a);a.nH().graphTransactionOperations.uja(5);return new oQ.a(a)}XEi(a,b){var c=b.currentNode.clone();a.SL(c,null,1);a.el(c);c.A_=b.currentNode;rc.OutlineElementNavigator.yi(b);b.lX&1&&b.currentNode.m3a(null);c=b.currentNode.clone();c.wV=b.currentNode.wV;a.SL(c,
null,2);a.el(c);a.aU(1);c.A_=b.currentNode;M.a.instance.ga(55)&&c.setValue(sb.a.zo,Xg.a.t0a());b.gC(11)}Erc(a){a.Db(2)&&a.Qi()}Bsh(a,b){const c=a.currentNode;rc.OutlineElementNavigator.yi(a);const f=a.currentNode;rc.OutlineElementNavigator.Se(a);b.DB(1);rc.OutlineElementNavigator.yi(b);a.Gl(b.currentNode,2);b.Qi();var l=new ub.GraphIterator;l.Tc(b);if(l.Db(1)){const y=new ub.GraphIterator;y.Tc(a);const G=new TF(null);if(!this.jAj(y,l.currentNode,G))return;Qm.h(y,null,1,1,l,-1)}b.Qi();l=null;a.YF(1)&&
(l=a.currentNode);for(a.Cc();Sg.OutlineNavigator.zaa(b);)a.SL(b.currentNode,l,1),l=b.currentNode,b.Qi();a.el(c);a.el(f);a.Qi()}zPb(a,b,c,f,l,y=!1){this.Erc(b);const G=b.Bi;var R=a.currentNode;let ja=null;var za=null;let Va=null,hb=!1;rc.OutlineElementNavigator.yi(a);const Cb=a.Bi;if(zb.ParagraphReader.vl(a)){var lc=a.currentNode;(za=Object(sa.a)(Kf.AParagraphNode,lc))?za.Sa&&za.Sa.length||ha.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",za):ha.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");za=new yv.a(za);(hb=c.Ra===zb.ParagraphReader.textLength(lc))&&(Va=this.m6f(b));var ic=b.currentNode;ja=this.pda(b,void 0,!0);lk.paragraphEditor.l5e(a,b,c,l,!0,y);M.a.instance.ga(71)&&(f?(l=Ka.StyleReader.qE(lc))&&lk.GP.fba(l,ja,!0):hb&&(l=Ka.StyleReader.qE(lc))&&((lc=l.sa(V.a.c8g,null))?(l=Ka.StyleReader.OL(ja).oH(lc),lk.GP.fba(l,ja,!1)):lk.GP.fba(l,ja,!0)));this.T5d(R,ic);this.kq.R5d(R,ic)}rc.OutlineElementNavigator.Se(a);rc.OutlineElementNavigator.Se(b);R=he.OutlineElementReader.isEmpty(a,
!0);ic=he.OutlineElementReader.isEmpty(b,!0);M.a.instance.ga(27)&&R&&!ic&&(b.lX&1&&(R=new VF.a,R.Tc(b),b.currentNode.m3a(R)),this.gtd(b.currentNode,he.OutlineElementReader.bVc(a.currentNode,Ya.a.S0b),Ya.a.S0b),this.gtd(b.currentNode,he.OutlineElementReader.bVc(a.currentNode,Ya.a.mLc),Ya.a.mLc),this.eOb(b.currentNode,he.OutlineElementReader.knj(a.currentNode)));rc.OutlineElementNavigator.yi(a);(R=Object(sa.a)(Kf.AParagraphNode,a.currentNode))?R.Sa&&R.Sa.length||ha.ULS.sendTraceTag(38925762,307,15,
"srcParaNode: {0}. srcParaNode has no characterProperties",R):ha.ULS.sendTraceTag(38925761,307,15,"srcPara is null");R=new yv.a(R);rc.OutlineElementNavigator.Se(a);(a=ja)?a.Sa&&a.Sa.length||ha.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(ha.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),ha.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:hb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:Cb,
["destinationOutlineElementNodeType"]:G,["alwaysMoveEopToDestinationPara"]:y}));hb?(c=new RA(za,Va,R,new yv.a(a),a.ISa),b.currentNode.nH().graphTransactionOperations.l_(c)):(c=new ZF(za,c.Ra,R,new yv.a(a),a.ISa),b.currentNode.nH().graphTransactionOperations.l_(c))}LJf(a,b){rc.OutlineElementNavigator.yi(a);let c=zb.ParagraphReader.zs(a.currentNode);const f=a.currentNode;M.a.instance.ga(14)&&(c=b?c&&!this.ij.WPk(f):c&&!this.ij.QPk(f));rc.OutlineElementNavigator.Se(a);return c}merge(a,b,c,f,l=null,y=
!1,G=!1,R=!1){if(a.currentNode.id===b.currentNode.id)return!1;let ja,za;var Va=new ub.GraphIterator;Va.Tc(b);ja=this.vWc(Va);Va.Tc(a);za=this.vWc(Va,!0);if(!this.LJf(b,!0)||!this.LJf(a,!1))return!1;if(this.Vf.Ypc){var hb=Object(sa.a)(Kf.AParagraphNode,a.currentNode);hb=(c||!hb||!hb.characterData.length)&&!Bb.ListReader.Hk(a)}else hb=this.t5h.zWl(c,a);R||this.kq.merge(a,b,hb,l);rc.OutlineElementNavigator.yi(a);l=a.currentNode.ISa;rc.OutlineElementNavigator.yi(b);if(zb.ParagraphReader.vl(b)){if(M.a.instance.ga(50)&&
Sc.App.Oh.Ew){R=b.currentNode;hb=a.currentNode;const Cb=SF.CoauthLockEditor.getInstance();if(Cb.XOb(this.ij.N7b(R))||Cb.XOb(this.ij.N7b(hb)))return b.Cc(),a.Cc(),!1}R=!1;Bb.ListReader.Gx&&(hb=a.parentNode)&&he.OutlineElementReader.O9(hb)&&(R=Bb.ListReader.XVa(hb));M.a.instance.ga(71)&&(hb=(hb=zb.ParagraphReader.isEmpty(a)||c)&&!R)&&(hb=Ka.StyleReader.Ndg(b))&&lk.GP.fba(hb,a.currentNode,!0);c&&this.Lqa.Xzk(b.currentNode,a.currentNode,R,G);c=lk.paragraphEditor.merge(a,b,c,f,y);f=Va.currentNode;Va=a.currentNode;
a.Cc();c&&he.OutlineElementReader.isEmpty(b,!0)&&this.SDa(b);a=new YF(za,ja,new UF.a(f),l);Va.nH().graphTransactionOperations.l_(a);return!0}b.Cc();a.Cc();return!1}TTj(a){const b=new ub.GraphIterator;b.set(a.node);b.kf();rc.OutlineElementNavigator.Se(b);const c=this.Dac(b),f=this.Dac(b);this.zPb(b,c,a,!1,!0);he.OutlineElementReader.isEmpty(b,!1)&&(this.kq.Soa(b),b.Qi());he.OutlineElementReader.isEmpty(c,!1)&&!he.OutlineElementReader.Hcb(c)&&(this.kq.Soa(c),c.Qi());return f}rea(a,b,c,f=null,l=!1){if(!this.Yzi(a))return null;
const y=a.currentNode,G=Bb.ListReader.Hk(a);b||l||he.OutlineElementReader.isEmpty(a,!1);l=this.kq.azl(G);b=b?a.YF(1):a.currentNode;a.Cc();c=this.dC.Cac(a,b,c,f);if(!c)return null;this.T5d(y,c);this.kq.R5d(y,c);l&&this.kq.CMl(a,y);return c}Yzi(a){return he.OutlineElementReader.hh(a)&&(a=a.parentNode,uj.OutlineReader.ecc(a)||he.OutlineElementReader.O9(a)||he.OutlineElementReader.Zua(a))?!0:!1}h$k(a){const b=new ub.GraphIterator;b.set(a);b.kf();b.gC(11);let c,f;({MJa:c,YIb:f}=this.y5f(b));let l=-1;12===
a.type&&(l=a.ISa);b.currentNode.nH().graphTransactionOperations.l_(new XF(this.C9f(a,!0),c,f,l));this.SDa(b)}SDa(a){if(a.kJ(1)){const b=new WF,c=new ub.GraphIterator;c.Tc(a);this.qej(c,b)&&this.Jv.xQc(a,-b.lwb)}a.Qi();Hd.TableReader.Ks(a)&&this.OUk(a)}cke(a,b,c){if(!uj.OutlineReader.pu(a)&&!he.OutlineElementReader.hh(a))return null;const f=this.fQi();0<c&&c<rn.a.last&&f.setValue(Ya.a.WE,Math.min(rn.a.nil,c));a.SL(f,b,1);return f}VTj(a,b){if(!he.OutlineElementReader.hh(a)&&!he.OutlineElementReader.uJ(a)||
!uj.OutlineReader.wX(a.parentNode)&&!he.OutlineElementReader.O9(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.Cc();b=this.cke(a,f,b);a.el(c);return b}OUk(a){he.OutlineElementReader.uJ(a)&&(a.kJ(1)||a.Qi());this.h3f(a,!1);this.cCf(a)}h3f(a,b){var c,f=null;for(c=a.Db(1);c;){var l=!1;he.OutlineElementReader.Zua(c)&&!a.kJ(1)&&(l=!0);var y=c;c=a.Pj(1);if(l)l=new ub.GraphIterator,l.set(y),l.kf(),l.Qi();else if(he.OutlineElementReader.Zua(y)){if(f){l=new ub.GraphIterator;l.set(f);
var G=new ub.GraphIterator;G.set(y);G.kf();l.Gl(G.currentNode,1);G.Qi();G=he.OutlineElementReader.n4(y);G===rn.a.nil&&(G=1);(G=Math.max(0,he.OutlineElementReader.n4(y)-G))?y.setValue(Ya.a.WE,Math.min(rn.a.nil,G)):(l.el(y),a.Db(1),Qm.e(l),l.Cc());b&&this.h3f(l,!0)}}else f=y}b=null;f=rn.a.last+1;for(c=a.Db(1);c;c=a.Pj(1))if(he.OutlineElementReader.uJ(a))y=he.OutlineElementReader.n4(c),f>y&&(f=y,b=c);else{a.Cc();return}if(b){for(c=a.Db(1);c;c=a.Pj(1))c!==b&&a.currentNode.setValue(Ya.a.WE,Math.min(rn.a.nil,
he.OutlineElementReader.n4(c)-f));f+=he.OutlineElementReader.n4(a.currentNode);a.currentNode.setValue(Ya.a.WE,Math.min(rn.a.nil,f));c=new ub.GraphIterator;c.Tc(a);c.el(b);c.Db(1);Qm.e(c)}}jAj(a,b,c){var f=he.OutlineElementReader.n4(a.currentNode);if(1===f)return!0;if(he.OutlineElementReader.uJ(a))return!1;if(!a.d9(1)||this.y3j(a,b))return a.currentNode.setValue(Ya.a.WE,Math.min(rn.a.nil,1)),!0;if(c.foa&&a.el(c.foa)){if(he.OutlineElementReader.uJ(a)&&1===f+he.OutlineElementReader.n4(a.currentNode))return c.foa=
a.DB(1),a.Cc(),!0;a.Cc()}if(c.foa&&a.el(c.foa)||!c.foa&&a.Db(1)){if(a.currentNode!==b&&a.Hf(1)&&he.OutlineElementReader.uJ(a)&&1===f+he.OutlineElementReader.n4(a.currentNode))return c.foa=null,!0;a.Cc()}if(a.$Ua(b)&&this.x3j(a,b)){for(c=a.Db(1);c;c=a.Pj(1))c!==b&&c.setValue(Ya.a.WE,Math.min(rn.a.nil,he.OutlineElementReader.n4(c)+(f-1)));a.currentNode.setValue(Ya.a.WE,Math.min(rn.a.nil,1));return!0}if(1>f)return f=this.cke(a,c.foa,1-f),a.el(f),c.foa=null,!0;if(1<f){a.currentNode.setValue(Ya.a.WE,Math.min(rn.a.nil,
1));b=null;let l=a.Db(1);for(;l;){if(he.OutlineElementReader.uJ(a)){l.setValue(Ya.a.WE,Math.min(rn.a.nil,f-1+he.OutlineElementReader.n4(l)));l=a.Pj(1);continue}b||(b=this.VTj(a,f-1));const y=l;l=Qm.j(a,b,1);l===b&&(l=a.Pj(1));c.foa===y&&(c.foa=b,b=null)}return!0}return!1}y3j(a,b){return ub.GraphIterator.Gda(()=>{if(1===a.d9(1)){const c=a.Db(1);a.Cc();if(c===b)return!0}return!1})}x3j(a,b){return ub.GraphIterator.Gda(()=>{let c;for(c=a.Db(1);c;c=a.Pj(1))if(c!==b&&!he.OutlineElementReader.uJ(a))return a.Cc(),
!1;return!0})}qej(a,b){b.lwb=0;do{const c=a.currentNode;if(a.Db(1))b.lwb-=he.OutlineElementReader.n4(c);else{if(uj.OutlineReader.pu(a)||null===a.currentNode)return!1;if(3!==a.role||!a.dla(1))for(;!a.Pj(1);)if(b.lwb+=he.OutlineElementReader.n4(a.currentNode),uj.OutlineReader.pu(a)||null===a.currentNode)return!1}}while(he.OutlineElementReader.uJ(a));return!0}Dac(a,b=!1){return this.bke(a,!1,b)}bke(a,b,c=!1){const f=new ub.GraphIterator;f.Tc(a);a=new ub.GraphIterator;a.Tc(f);this.rea(a,b,!1,null,c);
a.currentNode.setValue(Ya.a.WE,Math.min(rn.a.nil,he.OutlineElementReader.n4(f.currentNode)));f.Db(1)&&Qm.h(a,null,1,1,f,-1);return a}cCf(a){if(he.OutlineElementReader.mfl(a)){1!==he.OutlineElementReader.n4(a.currentNode)&&a.currentNode.setValue(Ya.a.WE,rn.a.first);for(var b=a.Db(1);b;)if(he.OutlineElementReader.uJ(a)){b=new ub.GraphIterator;b.Tc(a);b.Cc();const c=new ub.GraphIterator;c.Tc(a);c.Db(1);Qm.h(b,a.currentNode,1,1,c,-1);b=a.FSa(1)}else this.cCf(a),b=a.Pj(1)}}static get GP(){return lk.eL||
(lk.eL=Fb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set GP(a){lk.eL=a}static get paragraphEditor(){return lk.qx||(lk.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){lk.qx=a}}lk.eL=null;lk.qx=null;lk.aef=null;lk.rzc=null;Object(m.a)(lk,"OutlineElementEditor",null,[1075]);var fx=d(113),gx=d(418),aG=d(605),Dq=d(259);class vo{constructor(a){this.irf=a}gQi(){const a=Us.a.instance.createInstance(393228);a.setValue(Ya.a.WE,rn.a.first);a.setValue(Ya.a.ati,0);
a.setValue(Ya.a.Ix,uj.OutlineReader.NTf);(new aG.OutlineIndentInfo(!0)).Gwh(a);return a}vW(a,b,c=null){const f=a.currentNode;if(!a.DB(1))return this.Cac(a,null,b,c);he.OutlineElementReader.uJ(a)&&rc.OutlineElementNavigator.YKe(a,!0);return he.OutlineElementReader.hh(a)?vo.Xh.rea(a,!1,b,c):(a.wsc(f),null)}Xzi(a){return uj.OutlineReader.kqe(a.currentNode)||he.OutlineElementReader.hh(a)||he.OutlineElementReader.uJ(a)||Oc.isTableCell(a)}Cac(a,b=null,c=!1,f=null){if(!this.Xzi(a))return null;const l=vo.Xh.q2d();
this.wsl(l,a);a.c0c(l,b,1,this.irf.j5f());a.el(l);c&&(vo.Xh.pda(a,f),rc.OutlineElementNavigator.Se(a));M.a.instance.ga(25)&&vo.Xh.H$e(a.currentNode);return l}wsl(a,b){if(b=this.Otj(b))switch(b.type){case 11:vo.Xh.T5d(b,a,!0);break;case 8:b=vo.Vk.isRtl(b),vo.Xh.Otd(a,b)}}Otj(a){return this.irf.Wde(a)}xij(a,b){a=vo.Vk.aXc(a);return new gx.a(a.x+uj.OutlineReader.fQc*(b?-1:1),a.y+uj.OutlineReader.VTf)}Gtd(a){if(M.a.instance.ga(17)){var b=new ub.GraphIterator;b.set(a);b.mv();b=this.xij(b.origin,uj.OutlineReader.Jm(a));
Dq.c(a,b.x,b.y)}}VLa(a,b){M.a.instance.ga(43)&&Je.c(a)||a.setValue(Ya.a.CJ,b?11:9)}static get Vk(){return fx.PageReader.instance}static get Xh(){return vo.Mi||(vo.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Xh(a){vo.Mi=a}}vo.Mi=null;vo.Jf=null;Object(m.a)(vo,"OutlineEditor",null,[1079]);const vQ=a=>{a.register(vo,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").na().oa(()=>new vo(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(lk,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").na().oa(()=>
new lk(a.ue("Box4.IOutlineEditor"),a.ue("Box4.List.IListEditor"),a.ue("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class SA{get name(){return"Box4.OutlineLevelEditors"}Xb(a){vQ(a)}init(){}dispose(){}static main(){n.a.instance.Ac(new SA)}}Object(m.a)(SA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class TA{get name(){return"Box4.TableEditors"}Xb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new TA)}}
Object(m.a)(TA,"Box4TableEditorsPackage",null,[2,3]);class UA{get name(){return"Box4.TextLevelEditors"}Xb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new UA)}}Object(m.a)(UA,"Box4TextLevelEditorsPackage",null,[2,3]);class Sr{constructor(a,b,c){this.nMd=this.f6a=this.kMd=this.e6a=this.kKd=null;this.KG=a;this.u_h=b;this.Uc=c;this.init()}init(){this.u_h.ub(Object(H.a)(this,this.CEj,"handleEditingViewUpdatesSafe"));this.e6a=new Qe.a;this.kMd=new Qe.a;this.f6a=new Qe.a;this.nMd=new Ji.a}z0a(a){this.e6a.add(a.key,
a)}tWe(a){this.f6a.add(a.key,a)}CEj(a){try{this.BEj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),ha.ULS.sendTraceTag(5285580,334,10,a)}}BEj(a){let b;({u3d:b}=Sr.IOl(this.Uc.Pa.nb)).returnValue&&(a=Sr.Vgj(a,this.kKd,b),this.oYk(a,b),this.kKd=b)}oYk(a,b){a=this.mdj(a,b);let c;({notification:c}=Sr.BOl(a)).returnValue&&this.KG.sendNotification(c,!1)}mdj(a,b){const c=new Qe.a;c.$(1,new Ji.a);c.$(0,new Ji.a);a.forEach(f=>
{3===f?(ba.ImageReader.xH(b.node)||this.rfl(b),this.Nqj(c,b)):0===f&&this.uhj(c,b);return!0});return c}rfl(a){this.e6a.forEach((b,c)=>{c.reset(a);return!0})}uhj(a,b){let c=new Qe.a;ba.ImageReader.xH(b.node)||(c=this.rhj(b.Ra));this.shj(a,this.kMd,c,Sr.Axh(this.kKd,b));this.kMd=c}rhj(a){const b=new Qe.a;this.e6a.forEach((c,f)=>{c=null;({pCa:c}=f.cxc(a)).returnValue&&b.$(f.key,c);return!0});return b}shj(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((y,G)=>{const R=
this.e6a.ga(y).E8||G.title;let ja;({value:ja}=c.vg(y)).returnValue?f&&ja.vQ!==G.vQ&&(R&&a.ga(1).add(R),y=this.e6a.ga(y).E8,y=String.format(l,ja.title,y),ja.description&&(y+=", "+ja.description),a.ga(0).add(y)):R&&a.ga(1).add(R);return!0});c.forEach((y,G)=>{b.Gb(y)||(y=this.e6a.ga(y).E8,y=String.format(l,G.title,y),G.description&&(y+=", "+G.description),a.ga(0).add(y));return!0})}Nqj(a,b){b=this.Ywj(b.node);b=this.TFi(b);this.Zwj(a,this.nMd,b);this.nMd=b}Ywj(a){const b=new ub.GraphIterator;b.set(a);
if(!b.rc(1))return null;const c=new Ji.a;for(;1!==b.Bi;)this.f6a.forEach((f,l)=>{let y;({yvb:y}=l.x9e(b)).returnValue&&c.add(y);return!0}),b.Cc();c.reverse();return c}TFi(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.N1===a[b+1].N1&&(this.f6a.ga(c.N1),({WFi:c}={returnValue:!1,WFi:null}).returnValue)){a.splice(b,2,c);continue}b++}return new Ji.a(a)}Zwj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.f6a.ga(c.ga(f).N1).JVc(c.ga(f),
b.ga(f));l&&(c.ga(f).description&&(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let y=this.f6a.ga(c.ga(l).N1).JVc(c.ga(l),null);y&&(c.ga(l).description&&(y+=", "+c.ga(l).description),a.ga(0).add(y))}for(c=f;c<b.length;c++)(f=this.f6a.ga(b.ga(c).N1).E8)&&a.ga(1).add(f)}static Vgj(a,b,c){const f=new Ji.a;(a=a||Sr.Ell(b,c))?(f.add(3),f.add(0)):Sr.Axh(b,c)&&f.add(0);return f}static Ell(a,b){return!a||!a.node.id.equals(b.node.id)}static Axh(a,b){return!a||!a.equals(b)}static IOl(a){let b;
b=null;if(!a||!(Jb.SelectionEditor.Ex(a)||(a=Jb.SelectionEditor.im(a,!0,!1),Jb.SelectionEditor.Ex(a)||a.Ua&&ba.ImageReader.xH(a.Ua.node))))return{returnValue:!1,u3d:b};b=a.Ua;return{returnValue:!!b,u3d:b}}static BOl(a){const b=new Ji.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<
b.length,notification:a}}}Object(m.a)(Sr,"AccessibilityContextManager",null,[1025]);class hx{constructor(a,b){this.mmf=!1;this.LYb=null;this.NGc=this.rIc=!1;this.ihf=null;this.ae=a;this.Vob=b}get yLj(){return!!this.LYb}ub(a){this.mmf||(this.Vob.OAf(Object(H.a)(this,this.sKc,"afterEditingViewValidateEventHandler")),this.mmf=!0);this.ihf=a}sKc(a,b){(b.nN||b.mV)&&this.nDk(b.nN,b.mV)}nDk(a,b){this.yLj&&this.ae.Kg(this.LYb);this.rIc=this.rIc||a;this.NGc=this.NGc||b;this.LYb=new pd.a(4,1,hx.t3i,()=>{this.ihf(this.rIc,
this.NGc);this.reset()},126);this.ae.Hb(this.LYb)}reset(){this.LYb=null;this.NGc=this.rIc=!1}}hx.t3i=100;Object(m.a)(hx,"EditingViewOnAfterValidateEventsConsolidator",null,[1024]);class VA{constructor(){this.Ea=null}get name(){return"Box4.Accessibility"}init(){Sc.App.aFf&&this.Ea.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Xb(a){this.Ea=a;a.register(hx,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").na().oa(()=>
new hx(w.AFrameworkApplication.De,a.resolve("Box4.ContentEditableViewEventSource")));a.register(Sr,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").na().oa(()=>new Sr(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),ze.a.instance))}static main(){n.a.instance.Ac(new VA)}}Object(m.a)(VA,"Box4AccessibilityPackage",null,[2,3]);class WA{constructor(a,b){this.Ctf=a;this.l3=b;this.Zsf=
this.Wsf=this.Xsf=this.Ysf=this.wef=this.$sf=!0}get vkb(){return this.$sf}get JMc(){return this.wef}get Bqd(){return this.Ysf}get Xrc(){return this.Xsf}get zqd(){return this.Wsf}get UXe(){return this.Zsf}ZIf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.$sf=f;break;case "CapitalizeFirstLetterOfSentences":this.wef=f;break;case "ReplaceOrdianalsWithSuperscript":this.Ysf=f;break;case "ReplaceHyphensWithDash":this.Xsf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.Wsf=f;break;case "ReplaceQuoteWithSmartQuote":this.Zsf=this.l3&&f}}}bej(){this.Ctf.Dfe("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(H.a)(this,this.THk,"onGetRequestFinished"),8);ha.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}vjl(a){this.Ctf.hBh("saveAutoCorrectOptionsSettings",
a);ha.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.ZIf(a)}THk(a){a.Hm?ha.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.ZIf(a),ha.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!ta.a.count(a)))}}Object(m.a)(WA,"AutoCorrectOptionsInfo",null,[1031]);var Fy=d(221);class Nj{static get NFf(){Nj.KSb||(Nj.KSb=[],
Nj.iIb(ab.a.He("ar-sa")),Nj.iIb(ab.a.He("de-de")),Nj.iIb(ab.a.He("es-es")),Nj.QR(ab.a.He("en-029"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-au"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-bz"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-ca"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-gb"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-id"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-my"),ab.a.He("en-us")),Nj.QR(ab.a.He("en-ph"),ab.a.He("en-us")),Nj.QR(ab.a.He("zh-tw"),ab.a.He("en-us")),Nj.iIb(ab.a.He("fr-fr")),Nj.QR(ab.a.He("hr-ba"),ab.a.He("hr-hr")),
Nj.QR(ab.a.He("it-ch"),ab.a.He("it-it")),Nj.QR(ab.a.He("nb-no"),ab.a.He("nn-no")),Nj.iIb(ab.a.He("nl-nl")),Nj.QR(ab.a.He("ro-md"),ab.a.He("ro-ro")),Nj.QR(ab.a.He("ru-md"),ab.a.He("ru-ru")),Nj.QR(ab.a.He("sr-latn-ba"),ab.a.He("sr-latn-cs")),Nj.QR(ab.a.He("sr-latn-me"),ab.a.He("sr-latn-cs")),Nj.QR(ab.a.He("sr-latn-rs"),ab.a.He("sr-latn-cs")),Nj.iIb(ab.a.He("sr-cyrl-cs")),Nj.QR(ab.a.He("sv-fi"),ab.a.He("sv-se")));return Nj.KSb}static iIb(a){Nj.KSb[a.languageId]=a.LCID}static QR(a,b){Nj.KSb[a.LCID]=b.LCID}static Q8f(a){var b=
ab.a.He(a);if(!b)return 0;b=Nj.NFf[b.LCID]||Nj.NFf[b.languageId]||0;return b===a?0:b}}Nj.KSb=null;Object(m.a)(Nj,"AutoCorrectListFallback",null,[]);class wo{constructor(a,b,c,f,l){this.xlf=!1;this.$nf=0;this.GOa=null;this.w9h=!1;this.Unf=this.Opf=!0;this.Pkf=null;this.NDc=!0;this.Wpb=a;this.HOa=b;this.y5a=c;this.O7=f;this.mh=l;this.AXb=a?a.innerText:zb.ParagraphReader.text(b)}get Dx(){throw Error.notImplemented("The inherit class should have the default value.");}set Dx(a){}get G5c(){return this.$nf}zBh(a){this.$nf=
a}get nb(){return this.GOa}set nb(a){this.GOa=a}get qkg(){return this.Wpb}get mgg(){return this.HOa}get NA(){return this.y5a}get TR(){return this.O7}get DIb(){return this.Opf}set DIb(a){this.Opf=a}get rqg(){return this.xlf}get fvg(){return!1}get yoa(){return this.AXb}invoke(){this.xlf=!0;if(this.Wpb&&this.Wpb.parentNode&&!this.Dx){var a=this.Wpb.innerText;if(this.DIb&&na.a.substring(this.AXb,this.y5a,this.O7)!==na.a.substring(a,this.y5a,this.O7))return 0;this.A9a(this.Wpb);this.zBh(this.Wpb.innerText.length-
a.length);return 1}this.NDc||cc.a.instance.Yb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.Unf)return cc.a.instance.Yb("AbortedAction",{["Reason"]:this.Pkf}),0;var b=zb.ParagraphReader.text(this.HOa);a=b.length;var c=this.AXb.length,f=na.a.substring(this.AXb,this.y5a,this.O7).trimEnd();b=na.a.substring(b,this.y5a,this.O7).trimEnd();f===b&&this.O7>c&&(this.O7=c);if(this.DIb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===na.a.substr(b,0,c.length))this.O7-=2;else return 0;if(M.a.instance.ga(50)&&
Sc.App.Oh.Ew&&SF.CoauthLockEditor.getInstance().XOb(wo.ij.N7b(this.HOa)))return 0;c=new pf.GraphTransaction(15);c.ld(this.HOa);c.gd=this.commandId;this.Q8(this.HOa);this.zBh(zb.ParagraphReader.textLength(this.HOa)-a);this.GOa&&!this.w9h&&Jb.SelectionEditor.Ex(this.GOa)&&(b=this.GOa.Ua,a=b.Ra,f=b.Lb,b=b.node,b===this.HOa&&this.G5c&&(a>=this.O7&&(a+=this.G5c),f>=this.O7&&(f+=this.G5c),this.GOa=Vd.SelectionFactory.R3(b,a,f)));c.dispose();return 2}uSh(){this.NDc=this.uLf()}A9a(){}uLf(){var a=zb.ParagraphReader.text(this.HOa);
const b=na.a.substring(this.AXb,this.y5a,this.O7).trimEnd();a=na.a.substring(a,this.y5a,this.O7).trimEnd();return b===a}static get ij(){return Mh.a.instance}}Object(m.a)(wo,"AutoCorrectAction",null,[1108]);class xo extends wo{constructor(a,b,c,f,l,y){super(a,b,c,f,y);this.iof=null;this.Una=l;this.NV=y}get OWa(){return this.iof||(this.iof=Fb.a.instance.rb("Box4.List.IListCommands"))}get kq(){return xo.lp||(xo.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}get Dx(){return!0}get commandId(){return C.a.cXd}set Dx(a){super.Dx=
a}}xo.lp=null;Object(m.a)(xo,"RegexCorrectAction",wo,[]);const zv={[0]:{"a)":{autonumberBulletType:2,ej:[65533,4,41]},"a.":{autonumberBulletType:4,ej:[65533,4,46]},"A.":{autonumberBulletType:5,ej:[65533,3,46]},"1)":{autonumberBulletType:7,ej:[65533,0,41]},"1.":{autonumberBulletType:8,ej:[65533,0,46]},"i.":{autonumberBulletType:14,ej:[65533,2,46]},"I.":{autonumberBulletType:15,ej:[65533,1,46]}},[1]:{"*":{ej:[8226],font:"Arial"},"-":{ej:[45],font:"Calibri"},"--":{ej:[167],font:"Wingdings"},">":{ej:[216],
font:"Wingdings"},"<>":{ej:[118],font:"Wingdings"}}};class lp extends xo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y);lp.aOa=y}get commandId(){return C.a.VWd}Q8(a){if(this.OWa){var b=ub.GraphIterator.pb(a);b.kf();rc.OutlineElementNavigator.Se(b);var c=lp.Vf.Hv(b),f=this.Una[0];switch(na.a.charAt(f,0)){case "*":var l=cb.a.SN(1,1);l.ssa="*";break;default:l=cb.a.SN(1,0)}c&&l.nhe(c)||(c=new pf.GraphTransaction(15),c.Xy(b),b=this.Pej(l.listType,l.listStyle,f),null!=b&&this.OWa.lwi(b)&&(ha.ULS.sendTraceTag(509747285,
393,50,"Found list insert matching string "+f),lp.aOa.replaceTextRange(bb.a.createTextRange(a,this.NA,this.TR+1),"",!0,!1)),c.dispose())}}Pej(a,b,c){var f;let l=null===(f=null===zv||void 0===zv?void 0:zv[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new J.DictionaryPropertySet;c.setValue(we.a.wE,a);c.setValue(we.a.Jea,b);c.setValue(Ya.a.ej,l.ej);c.setValue(Ya.a.font,l.font);return c}static get characterPropertiesEditor(){return lp.aOa||(lp.aOa=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Vf(){return lp.fh||
(lp.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static NC(a,b,c,f,l){return new lp(null,a,b,c,f,l)}static xQ(a,b,c,f,l){return new lp(a,rf.a(a).gb,b,c,f,l)}}lp.aOa=null;lp.fh=null;Object(m.a)(lp,"BulletListAction",xo,[]);class rh extends xo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y);this.QVb=!1;this.Dx=!a;this.aOa=y;rh.Cl=new Yc.a}get Dx(){return this.QVb}set Dx(a){this.QVb=a}A9a(a){this.RZd(a.innerText,(b,c,f)=>{a.innerText=na.a.substring(a.innerText,0,b)+f+na.a.right(a.innerText,c)})}Q8(a){this.RZd(zb.ParagraphReader.text(a).substring(this.NA,
this.TR),(b,c,f)=>{this.aOa.replaceTextRange(bb.a.createTextRange(a,this.NA+b,this.NA+c),f,!0,!1)})}RZd(a,b){if(!(2>this.Una.length)&&this.Una[1]){var c=this.Una[1];rh.Cl.count||this.Kih();rh.Cl.Gb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,rh.Cl.ga(c)))}}}rh.Cl=null;Object(m.a)(rh,"DictionarySequenceReplacerAction",xo,[]);class ix extends rh{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.T0b}Kih(){rh.Cl.$("--","\u2014");rh.Cl.$(" -- "," \u2013 ");rh.Cl.$(" - "," \u2013 ");
rh.Cl.$("-- ","\u2014");rh.Cl.$(" --"," \u2013");rh.Cl.$(" -"," \u2013")}static NC(a,b,c,f,l){return new ix(null,a,b,c,f,l)}static xQ(a,b,c,f,l){return new ix(a,rf.a(a).gb,b,c,f,l)}}Object(m.a)(ix,"DashAction",rh,[]);class fu extends rh{constructor(a,b,c,f,l,y,G){super(a,b,c,f,l,y);this.Ca=G}get commandId(){return C.a.XWd}Kih(){rh.Cl.$(":)","\ud83d\ude0a");rh.Cl.$(":-)","\ud83d\ude0a");rh.Cl.$(":|","\ud83d\ude10");rh.Cl.$(":-|","\ud83d\ude10");rh.Cl.$(":(","\ud83d\ude41");rh.Cl.$(":-(","\ud83d\ude41");
rh.Cl.$(";)","\ud83d\ude09");rh.Cl.$(";-)","\ud83d\ude09");rh.Cl.$(":D","\ud83d\ude00");rh.Cl.$(":-D","\ud83d\ude00");rh.Cl.$(":')","\ud83d\ude02");rh.Cl.$("=D","\ud83d\ude03");rh.Cl.$(":>","\ud83d\ude06");rh.Cl.$(":->","\ud83d\ude06");rh.Cl.$(":3","\ud83d\ude0a");rh.Cl.$(":-3","\ud83d\ude0a");rh.Cl.$("B-)","\ud83d\ude0e");rh.Cl.$("*-*","\ud83d\ude0d");rh.Cl.$(":*","\ud83d\ude19");rh.Cl.$(":-*","\ud83d\ude19");rh.Cl.$(":X","\ud83d\ude36");rh.Cl.$(":-X","\ud83d\ude36");rh.Cl.$(":O","\ud83d\ude2e");
rh.Cl.$(":-O","\ud83d\ude2e");rh.Cl.$(":#","\ud83e\udd10");rh.Cl.$(":-#","\ud83e\udd10");rh.Cl.$(":P","\ud83d\ude1b");rh.Cl.$(":-P","\ud83d\ude1b");rh.Cl.$(";P","\ud83d\ude1c");rh.Cl.$(";-P","\ud83d\ude1c");rh.Cl.$(":-/","\ud83d\ude15");rh.Cl.$("$-$","\ud83e\udd11");rh.Cl.$(":S","\ud83d\ude16");rh.Cl.$(":-S","\ud83d\ude16");rh.Cl.$(":[","\ud83d\ude1f");rh.Cl.$(":-[","\ud83d\ude1f");rh.Cl.$(":\u2019(","\ud83d\ude22");rh.Cl.$(":'(","\ud83d\ude22");rh.Cl.$("@-@","\ud83d\ude31")}Q8(a){this.RZd(zb.ParagraphReader.text(a).substring(this.NA,
this.TR),(b,c,f)=>{b=bb.a.createTextRange(a,this.NA+b,this.NA+c);c={};c.MenuItemId=f;this.Ca.ii(b,C.a.FTj,2,!1,null,c,null)})}static NC(a,b,c,f,l,y){return new fu(null,a,b,c,f,l,y)}static xQ(a,b,c,f,l,y){return new fu(a,rf.a(a).gb,b,c,f,l,y)}}Object(m.a)(fu,"EmojiAction",rh,[]);class gq{constructor(a,b,c,f){this.MK=a;this.gIc=b;this.enf=f;this.aA=c}Bsg(){if(!this.aA)return!1;this.MK=this.MK.trimStart();return this.MK===this.aA?!0:!1}r$j(){if(!this.MK)return!1;const a=this.MK.lastIndexOf(" ");return-1!==
a&&"."===this.MK.charAt(a-1)&&"."===this.MK.charAt(a-3)?!0:!1}q$j(){if(!this.MK)return!1;var a=this.MK.lastIndexOf(" ");return-1!==a&&(a=this.MK.substring(0,a-1).lastIndexOf(" "),"."===this.MK.charAt(a+2))?!0:!1}q3j(){return this.Bsg()&&(1===this.aA.length&&"."===this.gIc||"."===this.MK.charAt(1))?!0:!1}r3j(){return this.aA?0<="\\/".indexOf(this.gIc)||3===this.aA.length&&0<="\\/".indexOf(this.aA.charAt(1))?!0:!1:!1}r2j(){return this.aA?0<=this.aA.indexOf("@")?!0:!1:!1}zt(){if(!this.aA)return!1;for(const a of gq.Tfe())if(na.a.startsWith(this.aA+
this.gIc,a))return!0;return!1}Z1j(){return this.aA?"i"===this.aA&&0<=gq.quotes.indexOf(this.gIc)?!0:!1:!1}qYj(){if(!this.MK)return!1;const a=na.a.FGa(this.MK,this.MK.length-1);if(-1!==a&&this.MK.substring(a+1,this.MK.length)===this.aA){const b=this.MK.charAt(a-1);if(0<=gq.V_e.indexOf(b)||0<=gq.quotes.indexOf(b)&&0<=gq.V_e.indexOf(this.MK.charAt(a-2)))return!0}return!1}MBi(){return!this.MK||this.r$j()||this.q3j()||this.r3j()||this.q$j()||this.r2j()||this.zt()?!1:this.Bsg()||this.Z1j()||this.qYj()?
!0:!1}static Tfe(){return gq.hof||(gq.hof="http: https: ftp:// mailto: \\\\ www.".split(" "))}}gq.V_e=".!?";gq.quotes="'\"";gq.hof=null;Object(m.a)(gq,"FirstLetterUpperCaseRules",null,[]);class Eq{constructor(a){this.aA=a}naj(){if(!this.aA)return null;for(let a=0;a<Eq.yfg().length;a++)if(this.aA===Eq.yfg()[a])return Eq.kBj()[a];return null}static yfg(){return Eq.Oif||(Eq.Oif=["1/2","1/4","3/4"])}static kBj(){return Eq.Nif||(Eq.Nif=["\u00bd","\u00bc","\u00be"])}}Eq.Oif=null;Eq.Nif=null;Object(m.a)(Eq,
"FractionsCollection",null,[]);class XA extends wo{constructor(a,b,c,f,l,y){super(a,b,c,f,y);this.BTb=l;this.NV=y}get Dx(){return!0}get commandId(){return C.a.YWd}A9a(a){a.innerText=na.a.substring(a.innerText,0,this.NA)+this.BTb+na.a.right(a.innerText,this.TR)}Q8(a){this.NV.replaceTextRange(bb.a.createTextRange(a,this.NA,this.TR),this.BTb,!0,!1)}set Dx(a){super.Dx=a}static NC(a,b,c,f,l){return new XA(null,a,b,c,f,l)}}Object(m.a)(XA,"FractionsReplaceCorrectAction",wo,[]);class Ws extends xo{constructor(a,
b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.$Wd}Q8(a){if(this.OWa){var b=ub.GraphIterator.pb(a);b.kf();rc.OutlineElementNavigator.Se(b);var c=this.Una[0],f=Ws.HDk(c),l=na.a.hdc(c.charAt(0))?4:2,y=bb.a.createTextRange(a,this.NA,this.TR+1);this.kq.iRa(a,b,l,f,y,c,this.OWa)}}static NC(a,b,c,f,l){return new Ws(null,a,b,c,f,l)}static xQ(a,b,c,f,l){return new Ws(a,rf.a(a).gb,b,c,f,l)}static HDk(a){if(!a)return 0;a=na.a.ug(a);if(!na.a.i1c(a.charAt(0)))return 0;const b=a.charCodeAt(0)-97+1;let c;
for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(m.a)(Ws,"LetterListAction",xo,[]);class jx extends xo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.iRa}Q8(a){if(this.OWa){var b=ub.GraphIterator.pb(a);b.kf();rc.OutlineElementNavigator.Se(b);var c=this.Una[0],f=parseInt(c);if(!(99999999<=f)){var l=bb.a.createTextRange(a,this.NA,this.TR+1);this.kq.iRa(a,b,1,f,l,c,this.OWa)}}}static NC(a,b,c,f,l){return new jx(null,a,b,c,f,l)}static xQ(a,b,c,f,l){return new jx(a,
rf.a(a).gb,b,c,f,l)}}Object(m.a)(jx,"NumberListAction",xo,[]);class hq extends wo{constructor(a,b,c,f,l){super(a,b,c,f,l);hq.NV=l}get Dx(){return!0}get commandId(){return C.a.aXd}A9a(){}Q8(a){const b=bb.a.createTextRange(a,this.TR-2,this.TR),c=new pf.GraphTransaction(15);c.ld(a);let f=!1,l=null,y=0;for(;y<a.Sa.length;){var G=a.Sa.ga(y),R=!!G.Vo||G.Cea;let ja=!!G.fieldRangeEnd||G.k0;if(G.cp>=b.Ra){G.cp>b.Ra||!G.formatting?l=f?G.formatting:hq.NV.Xga(a,y,b.Ra,l):(l=G.formatting,ja&&(f=!1),R&&(f=!0));
y++;break}G.formatting&&(l=G.formatting);ja&&(f=!1);R&&(f=!0);y++}for(;y<a.Sa.length;){R=a.Sa.ga(y);if(R.cp>=b.Lb){if(R.cp>b.Lb||!R.formatting&&!R.Xj)f||hq.NV.Xga(a,y,b.Lb,l);f||hq.oh.hZ(l,!0);break}R.formatting&&(f||hq.oh.hZ(l,!0),l=R.formatting);G=!!R.Vo||R.Cea;R=!!R.fieldRangeEnd||R.k0;G&&(f=!0);!G&&R&&(f=!1);y++}c.dispose()}set Dx(a){super.Dx=a}static get oh(){return hq.Jf||(hq.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}static NC(a,b,c,f){return new hq(null,a,b,c,f)}}hq.NV=null;hq.Jf=
null;Object(m.a)(hq,"OrdinalsReplaceCorrectAction",wo,[]);class Il extends xo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y);Il.krb||Il.XFl();this.aOa=y}get commandId(){return C.a.bXd}Q8(a){if(!a.FKj){var b=this.GOa.Ua.node===a,c=-1,f=3;this.Una[2]&&(c=parseInt(this.Una[2]));this.Una[1]&&(f=parseInt(this.Una[1]));if(!(20<c||100<f)){a.nH().graphTransactionOperations.uja(7);var l=ub.GraphIterator.pb(a);l.kf();rc.OutlineElementNavigator.Se(l);Il.Xh.rea(l,!1,!1);Il.Xh.pda(l);for(let R=0;R<f;++R){const ja=
[];var y=R%Il.krb.length,G=0<c?c:Il.krb[y].length;for(let za=0;za<G;++za)Array.add(ja,Il.krb[y][za%Il.krb[y].length]);y=bb.a.Oj(l.currentNode,0);G=wb.a.Es(y);2!==Sc.App.mode?Il.oh.z1a(G,1142):Il.oh.Rm(G,sb.a.noProof,!0);this.aOa.replaceTextRange(y,ja.join(" "),!0,!1);R<f-1&&(rc.OutlineElementNavigator.Se(l),Il.Xh.rea(l,!1,!1),Il.Xh.pda(l))}c=l.currentNode;l=ub.GraphIterator.pb(a);l.kf();rc.OutlineElementNavigator.Se(l);l.Qi();b&&(this.GOa=Vd.SelectionFactory.Qg(c,zb.ParagraphReader.textLength(c)))}}}static get Xh(){return Il.Mi||
(Il.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get oh(){return Il.Jf||(Il.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}static XFl(){Il.krb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static NC(a,b,c,f,l){return new Il(null,a,b,c,f,l)}static xQ(a,b,c,f,l){return new Il(a,rf.a(a).gb,b,c,f,l)}}Il.krb=null;Il.Mi=null;Il.Jf=null;Object(m.a)(Il,"RandAction",xo,[]);class bG{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.lNj=b;this.fCj=c;this.flags=f}}Object(m.a)(bG,"RegexAutoCorrectEntry",null,[]);class Mn extends xo{constructor(a,b,c,f,l,y){super(a,b,c,f,l,y)}get commandId(){return C.a.dXd}Q8(a){if(this.OWa){var b=
ub.GraphIterator.pb(a);b.kf();rc.OutlineElementNavigator.Se(b);var c=this.Una[0],f=na.a.substring(c,0,c.indexOf("."));f=Mn.IDk(f);if(!(0>=f)){var l=na.a.hdc(c.charAt(0))?5:3,y=bb.a.createTextRange(a,this.NA,this.TR+1);this.kq.iRa(a,b,l,f,y,c,this.OWa)}}}static NC(a,b,c,f,l){return new Mn(null,a,b,c,f,l)}static xQ(a,b,c,f,l){return new Mn(a,rf.a(a).gb,b,c,f,l)}static F2i(){Mn.rra||(Mn.rra={},Mn.rra.M=1E3,Mn.rra.D=500,Mn.rra.C=100,Mn.rra.L=50,Mn.rra.X=10,Mn.rra.V=5,Mn.rra.I=1)}static IDk(a){if(!a)return 0;
Mn.F2i();a=na.a.pC(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=Mn.rra[na.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}Mn.rra=null;Object(m.a)(Mn,"RomanListAction",xo,[]);class kx extends wo{constructor(a,b,c,f,l,y){super(a,b,c,c+1,y);this.NV=y;this.wbi=f;this.yff=l;this.DIb=!1}get Dx(){return!1}get commandId(){return C.a.vri}A9a(a){a.innerText=na.a.substring(a.innerText,0,this.NA)+this.yff+na.a.right(a.innerText,this.TR)}Q8(a){this.NV.replaceTextRange(bb.a.createTextRange(a,this.NA,
this.TR),this.wbi,!0,!1);this.NV.replaceTextRange(bb.a.createTextRange(a,this.NA,this.NA+1),this.yff,!0,!1)}set Dx(a){super.Dx=a}static NC(a,b,c,f,l,y){if("'"!==c&&'"'!==c)return null;var G=ub.GraphIterator.pb(a);G.kf();rc.OutlineElementNavigator.Se(G);if(he.OutlineElementReader.Jm(G.currentNode))return null;f=!b||na.a.jse(f)||-1!==Array.indexOf(kx.QNk,f);G="'"===c;return new kx(y,a,b,c+"",f?G?"\u2018":"\u201c":G?"\u2019":"\u201d",l)}}kx.QNk=["[","{","("];Object(m.a)(kx,"SmartQuoteCorrectAction",
wo,[]);class Xs extends wo{constructor(a,b,c,f,l,y){super(a,b,c,f,y);this.BTb=l;this.NV=y}get Dx(){return Xs.QVb}set Dx(a){Xs.QVb=a}get commandId(){return C.a.fXd}uSh(){this.NDc=this.uLf();this.NDc||(this.Unf=!1,this.Pkf="MatchTextIsNotTheSame")}A9a(a){a.innerText=na.a.substring(a.innerText,0,this.NA)+this.BTb+na.a.right(a.innerText,this.TR)}Q8(a){this.NV.replaceTextRange(bb.a.createTextRange(a,this.NA,this.TR),this.BTb,!0,!1)}static xQ(a,b,c,f,l){const y=rf.a(a);return new Xs(a,y?y.gb:null,b,c,f,
l)}static NC(a,b,c,f,l){return new Xs(null,a,b,c,f,l)}}Xs.QVb=!1;Object(m.a)(Xs,"StringReplaceCorrectAction",wo,[]);class Gy extends wo{constructor(a,b,c,f,l,y,G,R){super(a,b,c,f,l);this.NV=l;this.XD=y;this.f3h=G;this.aE=R}get Dx(){return!0}get commandId(){return C.a.hXd}A9a(a){let b=na.a.substring(a.innerText,this.NA,this.TR);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=na.a.substring(a.innerText,0,this.NA)+b+na.a.right(a.innerText,this.TR)}Q8(a){const b=
this.NA,c=this.NA+1,f=a.characterData.substring(b,c).charAt(0);na.a.hdc(f)||(a=bb.a.createTextRange(a,b,c),this.IYj(a)||this.NV.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}IYj(a){return this.f3h?!!this.XD&&this.XD.Vua(a):!1}set Dx(a){super.Dx=a}static xQ(a,b,c,f){const l=rf.a(a);return new Gy(a,l?l.gb:null,b,c,f,null,!1,null)}static NC(a,b,c,f,l,y,G){return new Gy(null,a,b,c,f,l,y,G)}}Object(m.a)(Gy,"UpperFirstLetterAutoCorrect",wo,[]);class Tr{constructor(a,b){this.enf=b;this.aA=a}DXl(){const a=
Number.parseInvariant(this.aA.substring(0,this.aA.length-2));switch(Number.parseInvariant(this.aA.charAt(this.aA.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}B3j(){var a=ab.a.He(this.enf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.aA||2>=this.aA.length)return!1;for(a=0;a<Tr.RYc().length;a++)if(this.aA.toLowerCase().endsWith(Tr.RYc()[a])){if(RegExp("^\\d+$").test(this.aA.substr(0,
this.aA.length-2))){const b=this.DXl();if(this.aA.toLowerCase().endsWith(Tr.RYc()[a])&&b===Tr.RYc()[a])return!0}break}return!1}static RYc(){return Tr.Uqf||(Tr.Uqf=["st","nd","rd","th"])}}Tr.Uqf=null;Object(m.a)(Tr,"ValidateOrdinalsRule",null,[]);class sn{constructor(a,b,c,f,l,y,G){this.d6a=[];this.Cob=[];this.JSb=[];this.zCd=[];this.Qqa=-1;this.ikf=this.l3=this.hBc=!1;this.tCc=a;this.mh=b;this.XD=c;this.Ca=f;this.wS=y;this.aE=G;l?(this.hBc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||l.ka("OneNoteInsertEmojiIsEnabled"),
this.l3=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.ikf=l.ka("HyperlinkUrlValidationIsEnabled"),ha.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.hBc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.l3})):(ha.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.l3=this.hBc=!1)}zoe(a){return 0<=sn.WWd.indexOf(a)}d9j(a){return 0<=sn.gXd.indexOf(a)}Krg(a){return a.toLowerCase()===a}hdc(a){return a.toUpperCase()===
a}i1c(a){return a.toLowerCase()!==a.toUpperCase()}B_j(a,b,c,f){return(new gq(a,b,c,f)).MBi()}Ghj(a){do{if(a.getAttribute("xml:lang"))return ab.a.He(a.getAttribute("xml:lang"))||ab.a.Oac;if(a.getAttribute("lang"))return ab.a.He(a.getAttribute("lang"))||ab.a.Oac;a=a.parentNode}while(a&&1===a.nodeType);return ab.a.Oac}Hae(a){return ab.a.He(wb.a.language(wb.a.Es(a)))||ab.a.Oac}DTc(a,b){0>b&&(b=0);let c=-1;const f=sn.WWd.length;for(let l=0;l<f;++l){const y=a.lastIndexOf(na.a.charAt(sn.WWd,l),b);y>c&&(c=
y)}a=na.a.FGa(a,b);a>c&&(c=a);return c}P7i(a){for(let b=0;b<a.length;++b)if(this.i1c(na.a.charAt(a,b)))return b;return-1}B2f(a,b){if(!a||0>b)return-1;let c=b;c=c?this.DTc(a,c-1):-1;c=c>na.a.FGa(a,b-1)?c:na.a.FGa(a,b-1);c++;return c}t2f(a,b,c){if(!M.a.instance.ga(70))return null;this.R5b(b);if(!this.Cob[b])if(b=Nj.Q8f(b),0<b){if(this.R5b(b),!this.Cob[b])return null}else return null;if(c&&this.JSb[b]&&Array.contains(this.JSb[b],a+c))return null;c=this.Cob[b][na.a.ug(a)];if("string"!==typeof c||c===
a)return null;if(c){var f=this.P7i(a);if(0>f||this.Krg(na.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=na.a.charAt(a,f);b&&!this.hdc(l)&&(b=!1)}return b?na.a.pC(c):na.a.pC(na.a.substring(c,0,1))+na.a.right(c,1)}return null}X7i(a,b,c,f){kf.a.mark(4666);const l=this.Ghj(b).LCID;let y=0,G=a;const R=b.innerText;var ja=R.lastIndexOf(" ",a);if(this.Soe(R.substring(ja+1,a)))return kf.a.mark(4667),null;ja=null;var za=!1;do{G=G?this.DTc(R,G-1):-1;if(-1===G&&!c){za=b;var Va=null;if(!this.zoe(R.charAt(0))){do{for(;za&&
!za.previousSibling;)za=za.parentNode;za&&(za=za.previousSibling,Va=za.innerText)}while(za&&!Va);if(za&&Va&&!this.zoe(na.a.charAt(Va,Va.length-1)))return kf.a.mark(4667),null}za=!0}Va=na.a.substring(R,G+1,a);++y;var hb=this.t2f(Va,l,f.toString());if(hb)ja=Xs.xQ(b,G+1,a,hb,this.mh);else for(hb=0;hb<this.d6a.length;++hb){const Cb=this.d6a[hb];if(!(Cb.flags&1&&!(c&&1>G)||Cb.flags&4||Cb.flags&2&&" "!==f)){const lc=Cb.pattern.exec(Va);if(lc){ja=Cb.lNj(b,G+1,a,lc,this.mh,this.Ca);break}}}}while(!za&&!ja&&
y<sn.A5g&&0<=G);kf.a.mark(4667);return ja}T7i(a,b,c){const f=a.node;let l=zb.ParagraphReader.text(f);0>b&&(b=a.Ra);a=this.Hae(a).LCID;if(this.Soe(l.substring(na.a.FGa(l,b)+1,b)))return null;var y=-1,G=jb.HyperlinkReader.e8b(f);for(var R=0;R<G.length;R++)if(b>G[R].Lb)y=G[R].Lb;else{if(b>G[R].Ra)return null;break}G=null;R=(R=b)?this.DTc(l,R-1):-1;R<y&&(R=y-1);y=na.a.substring(l,R+1,b);y=y.trimStart();if(1>R)for(let ja=0;ja<this.d6a.length;++ja){const za=this.d6a[ja];let Va=l;" "!==c&&(Va=l+c);if(za.pattern.exec(Va))return null}l=
l.substring(0,b);if(!this.B_j(l,c.toString(),y,a))return null;y.charAt(0).toUpperCase()!==y.charAt(0)&&(G=Gy.NC(f,R+1,b,this.mh,this.XD,M.a.instance.ga(14),this.aE));return G}Y1f(a,b,c){a=Vd.SelectionFactory.Ej(a,!1);if(!a)return null;a=a.jf;return Jb.SelectionEditor.Xg(a)?this.T7i(a,b,c):null}Soe(a){return na.a.I9(a)}P8d(a,b,c,f){kf.a.mark(4666);const l=a.node,y=this.Hae(a).LCID,G=zb.ParagraphReader.text(l);0>b&&(b=a.Ra);if(c&&!this.zoe(na.a.charAt(G,b))||this.Soe(G.substring(na.a.FGa(G,b)+1,b)))return kf.a.mark(4667),
null;a=-1;c=jb.HyperlinkReader.e8b(l);for(var R=0;R<c.length;R++)if(b>c[R].Lb)a=c[R].Lb;else{if(b>c[R].Ra)return null;break}c=0;R=b;let ja=null;do{R=R?this.DTc(G,R-1):-1;R<a&&(R=a-1);const Va=na.a.substring(G,R+1,b);++c;var za=this.t2f(Va,y,f==B.a.rNa?".":null);if(za)this.wS.vkb&&(ja=Xs.NC(l,R+1,b,za,this.mh));else for(za=0;za<this.d6a.length;++za){const hb=this.d6a[za];if(!(hb.flags&1&&!(0>R)||hb.flags&4&&f!==B.a.jp||hb.flags&2&&f!==B.a.BK)){const Cb=hb.pattern.exec(Va);if(Cb){ja=hb.fCj(l,R+1,b,
Cb,this.mh,this.Ca);if(ja.commandId!==C.a.T0b&&!this.wS.vkb||ja.commandId===C.a.T0b&&!this.wS.Xrc)ja=null;break}}}}while(0<=R&&R>=a&&!ja&&c<sn.A5g);kf.a.mark(4667);return ja}X1f(a,b,c){a=Vd.SelectionFactory.Ej(a,!1);if(!a)return null;a=a.jf;return Jb.SelectionEditor.Xg(a)?this.P8d(a,b,!1,c):null}d2f(a,b){a=Vd.SelectionFactory.Ej(a,!1);if(!a)return null;a=a.jf;if(!Jb.SelectionEditor.Xg(a)||jb.HyperlinkReader.Jla(a,!1))return null;var c=zb.ParagraphReader.text(a.node);const f=0<b?na.a.FGa(c,b-1)+1:
na.a.FGa(c,c.length-1)+1;b=0<b?b:c.length;c=na.a.substring(c,f,b);return!c||this.ikf&&!jb.HyperlinkReader.ese(c)||!na.a.I9(c)&&!na.a.qbc(c)||!sn.hyperlinkEditor.dal(a,f,b)?null:this.tCc.MOi(a.node,f,b)}h2f(a,b){var c=Vd.SelectionFactory.Ej(a,!1);if(!c)return null;var f=c.jf;if(!Jb.SelectionEditor.Xg(f))return null;0>b&&(b=f.Ra);var l=zb.ParagraphReader.text(f.node);c=this.B2f(l,b);const y=sn.gXd.length;for(let G=0;G<y;++G){const R=l.lastIndexOf(na.a.charAt(sn.gXd,G),b-1);R>c&&(c=R+1)}l=na.a.substring(l,
c,b);if(!l)return null;f=this.Hae(f).LCID;return(new Tr(l,f)).B3j()?hq.NC(a,c,b,this.mh):null}W1f(a,b){var c=Vd.SelectionFactory.Ej(a,!1);if(!c)return null;c=c.jf;if(!Jb.SelectionEditor.Xg(c))return null;0>b&&(b=c.Ra);var f=zb.ParagraphReader.text(c.node);c=this.B2f(f,b);f=na.a.substring(f,c,b);return f?(f=(new Eq(f)).naj())?XA.NC(a,c,b,f,this.mh):null:null}C8i(a,b,c,f,l){var y=Vd.SelectionFactory.Ej(a,!1);if(!y)return null;y=y.jf;if(c>b||!Jb.SelectionEditor.Xg(y))return null;0>b&&(b=y.Ra);if(0>b)return null;
y=zb.ParagraphReader.text(y.node);return kx.NC(a,c,l,b?y.charAt(b-1):"\x00",this.mh,f)}yCa(a,b,c,f){Array.add(this.d6a,new bG("^"+a+"$",b,c,f))}iKe(a){if(this.Cob[this.Qqa]){const b=this.Cob[this.Qqa];for(let c in a)b[c]=a[c]}else this.Cob[this.Qqa]=a}jKe(a){this.JSb[this.Qqa]?Array.addRange(this.JSb[this.Qqa],a):this.JSb[this.Qqa]=a}AYe(){this.Qqa=-1}eXd(){this.N1i(this.Qqa);this.Qqa=-1}vck(a,b){this.zCd[b]||(this.zCd[b]=!0,this.Qqa=b,b=document.createElement("script"),b.type="text/javascript",b.src=
a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}N1i(a){a=Nj.Q8f(a);0<a&&this.R5b(a)}Fck(){M.a.instance.ga(70)&&(this.R5b(1033),this.yCa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Il.xQ,Il.NC,5),this.yCa("(\\d+)[\\.|\\)]",jx.xQ,jx.NC,3),this.yCa("(L|l|C|c|D|d|M|m){1}\\.",Ws.xQ,Ws.NC,3),this.yCa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",Mn.xQ,Mn.NC,11),this.yCa("([A-Za-z]){1}[\\.|\\)]",Ws.xQ,Ws.NC,
3),this.yCa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",lp.xQ,lp.NC,3),this.yCa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",ix.xQ,ix.NC,0),this.hBc&&(this.yCa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",fu.xQ,fu.NC,0),this.yCa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",fu.xQ,fu.NC,0)))}R5b(a){this.zCd[a]||this.vck(Fy.a.wti(String.format("Acl/Acl{0}.js",a)),a)}static get hyperlinkEditor(){return sn.Mn||(sn.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}}sn.WWd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";
sn.gXd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";sn.V_e=".!?";sn.A5g=5;sn.Mn=null;Object(m.a)(sn,"AutoCorrectRules",null,[1032]);class YA{constructor(a,b,c,f,l,y){this.Tqa=this.EF=null;this.GK=a;this.Uc=b;this.qd=c;this.ydf=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.Bdf=f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.l3=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.xca=l;this.zAa=!!y;this.ot=y;this.t8h=new Yt.a;this.zAa&&this.Uc.FC(Object(H.a)(this,
this.xJb,"onSetSelectionFinished"))}gxc(a,b,c=-1){if(this.xca.vkb||this.xca.Xrc)if(b=this.GK.d2f(a,c)||this.GK.X1f(a,c,b))this.EF||(this.EF=new fc),this.EF.ya(b);this.ydf&&this.xca.JMc&&(b=this.GK.Y1f(a,c," "))&&(this.EF||(this.EF=new fc),0<this.EF.JGa&&(this.EF.Kta(0).Dx=!0,b.DIb=!1),this.EF.ya(b));this.Bdf&&(this.xca.Bqd&&4!==Sc.App.mode&&(b=this.GK.h2f(a,c))&&(this.EF||(this.EF=new fc),this.EF.ya(b),ha.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.xca.zqd&&
(a=this.GK.W1f(a,c))&&(this.EF||(this.EF=new fc),this.EF.ya(a),ha.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}wQf(a,b,c,f,l,y){const G=new fc;if(0<b){if(!this.ydf&&this.xca.vkb){var R=this.GK.X7i(c,f,l,y);R&&G.ya(R)}else{if(this.xca.vkb||this.xca.Xrc)if(R=0," "===y?R=B.a.BK:"."===y&&(R=B.a.rNa),R=this.GK.X1f(a,b,R))R.Dx=!0,G.ya(R);this.xca.JMc&&(R=this.GK.Y1f(a,b,y))&&(0<G.JGa&&(R.DIb=!1),G.ya(R))}this.Bdf&&(this.xca.Bqd&&4!==Sc.App.mode&&(R=this.GK.h2f(a,b))&&(G.ya(R),
ha.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.xca.zqd&&(R=this.GK.W1f(a,b))&&(G.ya(R),ha.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===y||'"'===y)&&this.l3&&this.xca.UXe&&(R=this.GK.C8i(a,b,c,f,y))&&(G.ya(R),ha.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."));for(let ja of this.t8h.values)if((R=ja.wQf(a,b,c,f,l,y))&&!R.isEmpty())for(let za=0;za<R.JGa;za++)G.ya(R.Kta(za));return G}DJe(a,b){return this.GK.d2f(a,
b)}Rwh(a){this.EF||(this.EF=new fc);this.EF.ya(a)}wVj(a){if(this.EF){var b=!1;for(var c=0;c<this.EF.JGa;c++){var f=this.EF.Kta(c);if(!f)return;if(!f.rqg){b=!0;break}}if(b){b=this.Tqa=null;c=new pf.GraphTransaction(15);c.gd=a;a=!1;for(f=0;f<this.EF.JGa;f++){let l=this.EF.Kta(f);if(!l)return;if(l.rqg)continue;this.zAa&&l.Dx&&l.fvg&&(b=l);a||(a=!0,c.ld(l.mgg));l.nb=this.Uc.Pa.nb;const y=this.qd.eq(l.commandId);l.invoke();y.end();this.Uc.setSelection(l.nb)}this.EF=null;this.Tqa=b?b.commandId:null;a&&
c.dispose()}}}xVj(a){this.Tqa=null;const b=new pf.GraphTransaction(15);b.ld(a.mgg);b.gd=a.commandId;a.nb=this.Uc.Pa.nb;const c=this.qd.eq(a.commandId);a.invoke();c.end();this.Uc.setSelection(a.nb);this.zAa&&a.Dx&&a.fvg&&(this.Tqa=a.commandId);b.dispose()}yVj(a){this.Tqa=null;return a.invoke()}JLj(){return this.zAa&&!!this.Tqa}jFk(a){if(!this.zAa||!this.Tqa)return!1;const b=this.Tqa;this.Tqa=null;if(!a||!this.ot.gX||this.ot.v3d!==b)return!1;this.ot.undo();return!0}xJb(){this.Tqa=null}}Object(m.a)(YA,
"AutoCorrectScheduler",null,[1030]);class Ur extends wo{constructor(a,b,c,f,l,y){super(a,b,c,f,l);this.Urf=this.b3=null;this.NV=l;this.hd=y}get y9(){return this.b3||(this.b3=Fb.a.instance.rb("Box4.IInternalLinkManager"))}get Sih(){return this.Urf||(this.Urf=Fb.a.instance.rb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get Dx(){return!0}get commandId(){return C.a.ZWd}Q8(a){kf.a.mark(7012);const b=new pf.GraphTransaction(15);b.ld(a);var c=this.NA,f=this.TR,l=zb.ParagraphReader.text(a),y=l.substring(c,
f);const G=({Hmc:R}=na.a.Q5e(y)).returnValue;y!==G&&(c+=R,f=c+G.length);y=bb.a.createTextRange(a,c,f);var R=l.substring(c,f);Ur.u1j(l,c,f)&&(this.NV.replaceTextRange(bb.a.createTextRange(a,c-1,f+1),R,!0,!1),--c,--f,y=bb.a.createTextRange(a,c,f),c=Vd.SelectionFactory.Qg(a,f),ze.a.instance.setSelection(c));c=jb.HyperlinkReader.$Ea(R);Ur.hyperlinkEditor.Vja(y,c,!1);l=R="";f=!1;this.y9&&({Lph:R,Daj:l}=this.y9.QMh(c,!0)).returnValue&&(c=R,f=!0,R=jb.HyperlinkReader.UC(y,!1),Ur.hyperlinkEditor.cN(R[0].paragraph,
R[0].hyperlink),""!==l&&(this.NV.replaceTextRange(y,l,!0,!1),y=bb.a.createTextRange(a,this.NA,this.NA+l.length),a=Vd.SelectionFactory.Qg(a,this.NA+this.NA+l.length),ze.a.instance.setSelection(a)),Ur.hyperlinkEditor.Vja(y,c,!1));b.dispose();!f&&this.Sih&&this.Sih.Q1l(y,c);kf.a.mark(7013)}set Dx(a){super.Dx=a}static get hyperlinkEditor(){return Ur.Mn||(Ur.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static u1j(a,b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===
a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Ur.Mn=null;Object(m.a)(Ur,"HyperlinkAction",wo,[]);class ZA{constructor(a,b){this.mh=a;this.hd=b}MOi(a,b,c){return new Ur(null,a,b,c,this.mh,this.hd)}}Object(m.a)(ZA,"Factory",null,[1026]);class $A{constructor(){this.Ea=null}get name(){return"Box4.AutoCorrect"}Xb(a){this.Ea=a;a.register(sn,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").na().oa(()=>new sn(a.resolve("Box4.IHyperlinkActionFactory"),a.resolve("Box4.ICharacterPropertiesEditor"),
Mh.a.instance,w.AFrameworkApplication.Qa,w.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(WA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").na().oa(()=>new WA(a.resolve("Box4.IRoamingServiceRequestManager"),w.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(YA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").na().oa(()=>
new YA(a.resolve("Box4.IAutoCorrectRules"),ze.a.instance,cc.a.instance,w.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),w.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(ZA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").na().oa(()=>new ZA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Ea.resolve("Box4.IAutoCorrectRules").Fck();
const a=w.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Ea.resolve("Box4.IAutoCorrectOptionsInfo").bej()}dispose(){}static main(){n.a.instance.Ac(new $A)}}Object(m.a)($A,"Box4AutoCorrectPackage",null,[2,3]);class aB{get name(){return"Box4.Clipboard"}init(){}dispose(){}Xb(){}static main(){n.a.instance.Ac(new aB)}}Object(m.a)(aB,"Box4ClipboardPackage",null,[2,3]);var bB=d(592),lx=d(503),mp=d(333);class Vr{}Vr.fontSize=0;Vr.bold=
!1;Vr.italic=!1;Vr.spacing=0;Object(m.a)(Vr,"DefaultTextCharPropertyBag",null,[]);class cB{constructor(a,b,c,f,l,y,G,R){this.g7c=[Ya.a.fontColor,va.a.zxb];this.xbd=[Ya.a.ej,Ya.a.font,va.a.autonumberBulletType,Ya.a.RWa,we.a.PWa];this.Tok=[new lx.a(va.a.CX,va.a.Jx),new lx.a(va.a.cma,va.a.Hea),new lx.a(va.a.bma,va.a.Gea)];this.wwa=a;this.MJ=b;this.lic=c;this.wi=f;this.cYa=l;this.qYa=y;this.Tb=G;this.Ga=R}Gub(a){return this.kZd(a,-1)}zMc(a){return this.kZd(a,1)}kZd(a,b){return ub.GraphIterator.Gda(()=>
this.qYa?he.OutlineElementReader.hh(a)&&!a.e$b(14)&&a.e$b(12)&&!this.i1j(a)&&this.YJf(a,b):Bb.ListReader.Hk(a)&&this.YJf(a,b))}i1j(a){return(a=this.Ga.An(a.currentNode))?a.x0:!1}YJf(a,b){return ub.GraphIterator.Gda(()=>{const c=a.currentNode.sa(sb.a.listLevel,Ke.a.xFa)+b;if(0>c||c>=mp.a.A8||!this.MJ.JQ(a,c))return!1;this.qYa||(rc.OutlineElementNavigator.yi(a),rc.OutlineElementNavigator.Se(a));return!0})}Ajb(a,b){this.Mfh(a,b)}xQc(a,b){this.Mfh(a,b)}Mfh(a,b){if(this.kZd(a,b)&&(this.qYa||Bb.ListReader.Hk(a))){var c=
a.Db(2);a.Cc();(new ub.GraphIterator).Tc(a);const f=a.currentNode.sa(sb.a.listLevel,Ke.a.xFa);(0>f||f>=mp.a.A8)&&ya.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=mp.a.A8)&&ya.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.MJ.JQ(a,f),y=this.MJ.JQ(a,f+b);if(l&&y){a.currentNode.setValue(sb.a.listLevel,f+b);c.setValue(sb.a.listLevel,
f+b);for(b=0;b<c.Sa.length;b++)c.Sa.ga(b).formatting&&c.Sa.ga(b).formatting.ene();this.Bmi(c,l,y);this.tmi(c,l,y);this.ymi(c,l,y);c=a.Db(4);a.Cc();c&&this.nmi(c,l,y)}}}tmi(a,b,c){b=c.sa(Ya.a.fontSize,Vr.fontSize)-b.sa(Ya.a.fontSize,Vr.fontSize);a.Ta(Ya.a.fontSize)&&a.setValue(Ya.a.fontSize,a.eb(Ya.a.fontSize)+b);for(c=0;c<a.Sa.length;++c){const f=a.Sa.ga(c);f||ya.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",c);f&&
f.formatting&&f.formatting.iA&&f.formatting.iA.Ta(Ya.a.fontSize)&&this.wi.Xq(f.formatting,f.formatting.iA.eb(Ya.a.fontSize)+b)}this.cYa&&this.cYa.Ta(Ya.a.fontSize)&&(a=this.cYa.fontSize(),this.cYa.Xq(a+b))}Bmi(a,b,c){if(a.Ta(sb.a.um)){var f=a.eb(sb.a.um);let l=b.sa(sb.a.um,Ke.a.leftMargin),y=c.sa(sb.a.um,Ke.a.leftMargin);const G=this.Ga.An(a);G&&!G.xd&&(l=b.sa(va.a.x4b,Ke.a.leftMargin),y=c.sa(va.a.x4b,Ke.a.leftMargin));f=f+y-l;0>f&&a.setValue(sb.a.xo,a.sa(sb.a.xo,Ke.a.indent)+f);this.wwa.Jv.ztd(a,
1,f)}this.VSc(a,b,sb.a.xo)&&this.M_c(a,c,sb.a.xo)}ymi(a,b,c){for(const f of this.Tok)this.VSc(a,b,f.first,f.second)&&this.M_c(a,c,f.first,f.second)}nmi(a,b,c){if(this.VSc(a,b,Ya.a.ej,Ya.a.font)){if(0===this.lic.Fyb(a)&&a.sa(va.a.autonumberBulletType,8)!==b.sa(va.a.autonumberBulletType,8))return;if(c.sa(Ya.a.ej,null))this.lic.q2b(a),a.yo.apply(a,this.xbd),this.M_c.apply(this,[a,c].concat(this.xbd));else{const f=this.Tb.Lc(a);f.rc(11);f.Qi()}}for(const f of this.g7c)this.VSc(a,b,f)&&(a.removeProperty(f),
this.M_c(a,c,f))}VSc(a,b,...c){for(const f of c)if(a.Ta(f)||b.Ta(f))if(!a.Ta(f)||!b.Ta(f)||!bB.APropertySet.f0a(f.type,a.Sh(f),b.Sh(f)))return!1;return!0}M_c(a,b,...c){for(const f of c)b.Ta(f)&&a.Ae(f,b.Sh(f))}}Object(m.a)(cB,"OutlineElementIndentationEditor",null,[1407]);var Hy=d(157);class Mp{constructor(a,b){this.pp=this.hd=this.Ut=null;this.lp=b;Mp.fh=a}get kq(){return this.lp.value}get insertionPointFormatting(){return this.Ut||(this.Ut=Fb.a.instance.rb("Box4.IInsertionPointFormatting"))}get Xf(){return this.hd||
(this.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get g7(){return this.pp||(this.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}Jee(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.V6f():null;if(c&&!c.equals(ia.a.nil)){a=b.Nh;if(!a)return null;c=a.Be(c);if(!c||c&&1!==Ka.StyleReader.kua(c))return null}else c=wb.a.Es(a),c=wb.a.ayb(c);return c}fba(a,b,c){if(zb.ParagraphReader.fe(b))if(a)if(Ka.StyleReader.F4c(a))if(2!==
Ka.StyleReader.kua(a))ha.ULS.shipAssertTag(7467991,324,!1);else{var f=Ka.StyleReader.OL(b);if(f){var l=Ka.StyleReader.OQ(a);if(!l)ha.ULS.shipAssertTag(7467993,324,!1);else if(f.oH(l)){l=null;this.Xf.gg&&b.h9();c||(l=this.kq.C4k(l),Mp.paragraphEditor.r2b(b,!0));this.Gxc(b,f);M.a.instance.ga(61)||(a=f.oH(Ka.StyleReader.OQ(a)));b.properties.setValue(V.a.paragraphStyle,a.id);b.wV=a;for(c=0;c<b.Sa.length;c++)b.Sa.ga(c).formatting&&b.Sa.ga(c).formatting.ene();Mp.k6c.e5b(a)&&(l||(l=new ub.GraphIterator,
l.set(b),l.kf(),rc.OutlineElementNavigator.Se(l)),Bb.ListReader.Hk(l)||(b.yo(sb.a.um,sb.a.$xa,sb.a.xo,sb.a.gKa,sb.a.uoc,sb.a.ngh),this.UVd(l,a)))}}else ha.ULS.shipAssertTag(7467992,324,!1)}else ha.ULS.shipAssertTag(7467990,324,!1);else ha.ULS.shipAssertTag(7467989,324,!1);else ha.ULS.shipAssertTag(7467988,324,!1)}UVd(){}pNc(a,b=!1){let c;c=Je.c(a)?Je.d(a)?Ka.StyleReader.OL(a).oH(Ka.StyleReader.uwd):Ka.StyleReader.OL(a).oH(Ka.StyleReader.wwd):Ka.StyleReader.OL(a).oH(M.a.instance.ga(61)?Ka.StyleReader.wNa:
Ka.StyleReader.Mpa);this.fba(c,a,b)}E1e(a,b){const c=Ka.StyleReader.OL(b);c&&c.oH(Ka.StyleReader.OQ(a))&&(this.Gxc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.R0a(),this.insertionPointFormatting.Nga(a,b)))}Gxc(a,b){return(a=Mp.tm.CIb(a))?b.qtl(a):!1}static get paragraphEditor(){return Mp.qx||(Mp.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Mp.qx=a}static get k6c(){return Mp.fh||(Mp.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static get tm(){return Hy.PageNavigator.instance}}
Mp.qx=null;Mp.fh=null;Object(m.a)(Mp,"StyleEditor",null,[1404]);class ir{static Ufe(){return ir.Yhk}static g0f(a){return new ia.a(a,1)}static JPf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return oh.a.Kf(a)}}ir.Yhk=[va.a.aya,va.a.cellId,va.a.rowId,va.a.shapeId];Object(m.a)(ir,"TransformHelper",null,[]);class dB{constructor(a,b){this.e7c=new Mp(a,b);this.EA=a;this.MJ=b.value}Jee(a){return this.e7c.Jee(a)}E1e(a,b){this.e7c.E1e(a,b)}fba(a,b){const c=new ub.GraphIterator;c.set(b);
c.mv();c.Cc();Qm.d(a,c.currentNode,[sb.a.listLevel]);Qm.d(a,b,[Ya.a.Vl,Ya.a.CJ,sb.a.xo,sb.a.um,va.a.Jx,va.a.CX,va.a.cma,va.a.Hea,va.a.bma,va.a.Gea]);if(this.EA.e5b(a)&&!Bb.ListReader.Hk(c)){a=cb.a.yDa(a,a);const f=cb.a.SN(a.listType,a.listStyle);f.VA=a.VA;a.propertySet.Ta(Ya.a.ej)&&f.propertySet.setValue(Ya.a.ej,a.propertySet.eb(Ya.a.ej));a.propertySet.Ta(Ya.a.font)&&f.propertySet.setValue(Ya.a.font,a.propertySet.eb(Ya.a.font));a.propertySet.Ta(va.a.autonumberBulletType)&&f.propertySet.setValue(va.a.autonumberBulletType,
a.propertySet.eb(va.a.autonumberBulletType));this.MJ.$Qa(c,f,!1,!1,0);a=c.Db(4);Qm.b(b,a,ir.Ufe());c.Cc()}}pNc(a,b=!1){this.e7c.pNc(a,b)}Gxc(a,b){return this.e7c.Gxc(a,b)}}Object(m.a)(dB,"StyleEditor",null,[1404]);class eB{constructor(a){this.gHg=a;this.gHg.hja(Object(H.a)(this,this.p_a,"onBeforeValidatePersistence"))}dispose(){this.gHg.wMb(Object(H.a)(this,this.p_a,"onBeforeValidatePersistence"))}p_a(a,b){10!==b.node.type&&60!==b.node.type||b.node.uQh()}}Object(m.a)(eB,"LockableGraphNodeEditBehavior",
null,[108]);class fB{constructor(){}v4i(a){const b=a.parentNode.eb(va.a.shapeId),c=a.parentNode.eb(va.a.aya);let f=null,l=null;const y=Object(sa.a)(5,a.currentNode);y&&y.Ks()&&(f=a.parentNode.eb(va.a.rowId),l=a.parentNode.eb(va.a.cellId));this.m1e(a.currentNode,b,c,f,l)}m1e(a,b,c,f,l){a.Ae(va.a.shapeId,b);a.Ae(va.a.aya,c);l&&(a.Ae(va.a.rowId,f),a.Ae(va.a.cellId,l))}}Object(m.a)(fB,"PptCreateParagraphStrategy",null,[1021]);var wQ=d(31);class gB{constructor(a){this.Ur=a;this.Ur.hja(Object(H.a)(this,
this.p_a,"onBeforeValidatePersistence"))}dispose(){this.Ur.wMb(Object(H.a)(this,this.p_a,"onBeforeValidatePersistence"))}p_a(a,b){Kc.a.Kb&&(a=Kc.a.Kb,a.$p&&Kc.a.Naa(Kc.a.Kb),b.revisionId&&(b=Kc.a.Cab(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?ha.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),wQ.Debug.mu()):a.qC(Ii.a.ZY,b.toString())))}}Object(m.a)(gB,"PresentationNodeEditBehavior",null,[108]);class hB{ntc(a,
b,c){let f;({value:f}=a.vg(b)).returnValue||(f=new Oa.a,a.$(b,f));f.add(c)}Qyd(a,b,c,f){if(a.count)for(let l of a)l&&l!==ia.a.nil&&(a=b.nXc(l,ia.a.nil),a=f.ga(a))&&(b.$(l,a),this.ntc(c,a,l))}Lyd(a,b,c){a.Gb(b)&&ia.a.pQ(a.ga(b),c)&&a.remove(b)}}Object(m.a)(hB,"GraphHotColdHelper",null,[1015]);var Wr=d(212),Iy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(Iy||(Iy={}));Object(m.b)("GraphNodeModificationType",
Iy);class cG{constructor(a,b,c,f,l,y){this.PYa=a;this.Fna=b;this.Cna=c;this.MU=f;this.tR=l;this.Mna=y;this.ljc=ia.a.nil}yG(a){return!!a&&(7===a.type||68===a.type)}lnc(a,b){this.PYa.$(a.id,b);this.Mna.iLe(b)?this.ljc=a.id:this.tR.ntc(this.MU,b,a.id)}uaf(a){if(this.ljc&&this.ljc!==ia.a.nil){let b;this.tR.Qyd((b=new Oa.a,b.add(this.ljc),b),this.PYa,this.MU,a);this.ljc=ia.a.nil}}vJb(a,b){this.tR.Lyd(this.PYa,a,b)}I4(a){return this.PYa.Gb(a.id)}pX(a){return this.I4(a)||0<this.Fna.count||0<this.Cna.count}}
Object(m.a)(cG,"PresentationHotColdHandler",null,[1062,1017]);class dG extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(m.a)(dG,"RevisionPersistArgs",Sys.EventArgs,[]);var eG=d(922);class fG{constructor(a,b,c,f,l,y,G){this.bxa=a;this.Cna=b;this.MU=c;this.tR=f;this.Mna=l;this.lc=y;this.Ga=G;this.Bcd=new Oa.a;this.zIa=new Oa.a}yG(a){return!!a&&(10===a.type||60===a.type||39===a.type)}lnc(a,b){let c=a;const f=this.lc.jg(a);60!==a.type&&39!==a.type&&(c=this.Ga.An(a));
f&&c&&(this.Cna.$(c.id,b),this.bxa.$(f.id,b),this.Mna.iLe(b)?(this.Bcd.contains(c.id)||this.Bcd.add(c.id),this.zIa.contains(f.id)||this.zIa.add(f.id)):(this.tR.ntc(this.MU,b,c.id),this.tR.ntc(this.MU,b,f.id)))}uaf(a){this.tR.Qyd(this.Bcd,this.Cna,this.MU,a);this.tR.Qyd(this.zIa,this.bxa,this.MU,a);this.Bcd.clear();this.zIa.clear()}vJb(a,b){this.tR.Lyd(this.Cna,a,b);this.tR.Lyd(this.bxa,a,b)}I4(a){return this.yG(a)&&this.Cna.Gb(a.id)}pX(a){return this.I4(a)}}Object(m.a)(fG,"ShapeLevelHotColdHandler",
null,[1062,1017]);class gG{constructor(a,b,c,f,l){this.Fna=a;this.bxa=b;this.MU=c;this.tR=f;this.Mna=l;this.zIa=new Oa.a}yG(a){return!!a&&8===a.type}lnc(a,b){this.Fna.$(a.id,b);this.Mna.iLe(b)&&!this.zIa.contains(a.id)?this.zIa.add(a.id):this.tR.ntc(this.MU,b,a.id)}uaf(a){this.tR.Qyd(this.zIa,this.Fna,this.MU,a);this.zIa.clear()}vJb(a,b){this.tR.Lyd(this.Fna,a,b)}I4(a){return this.Fna.Gb(a.id)}pX(a){return this.I4(a)||this.SXj(a)}SXj(a){return this.bxa.Gb(a.id)}}Object(m.a)(gG,"SlideHotColdHandler",
null,[1062,1017]);class Jy{constructor(a,b,c,f,l,y,G,R,ja,za=null,Va=null,hb=null){this.yl=this.MU=this.Cna=this.bxa=this.Fna=this.PYa=null;this.lc=a;this.Ga=b;this.Mc=c;this.Sp=f;this.tR=l;this.Ur=y;this.wFe=!1;this.T0=G;this.ua=R;this.Mna=ja;this.Sp.TQa(Object(H.a)(this,this.Mkd,"onRevisionProcessedOnServerHandler"));this.Sp.JBf(Object(H.a)(this,this.Ljd,"onGraphNodePersistHandler"));this.Ur.hja(Object(H.a)(this,this.Ljd,"onGraphNodePersistHandler"));this.Mc.GC(Object(H.a)(this,this.UE,"onSessionEnd"));
this.Mc.pii(Object(H.a)(this,this.Hah,"onFailoverHandler"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.initialize(za,Va,hb);this.TXa=new Qe.a}reset(){this.initialize();this.Sp.dnh(new eG.a(null));this.eOh()}initialize(a=null,b=null,c=null){a||this.poj();this.MU=b||new Qe.a;this.yl=c||this.Pka()}Hah(){this.reset()}Mkd(a,b){b&&(a=b.GD)&&this.BOe(a)}Ljd(a,b){this.lnc(b.node,b.revisionId)}lnc(a,b){if(!this.wFe&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.yl)if(c.yG(a)){c.lnc(a,
b);this.Sp.a1k(new dG(b,a));break}}BOe(a){const b=ia.a.Kf(a.Id),c=this.MU.ga(b);if(c&&c.count){for(let f of c)for(const l of this.yl)l.vJb(f,b);this.MU.remove(b);this.Sp.dnh(new eG.a(a));this.eOh()}}t_i(){const a={},b=Jy.cTj(a);b(0,this.PYa);b(1,this.Fna);b(2,this.bxa);b(3,this.Cna);ta.a.isEmpty(a)||ya.a.J(21112097,811,50,ta.a.toJSON(a))}pX(a){for(const b of this.yl)if(b.yG(a))return b.pX(a);return!1}I4(a){for(const b of this.yl)if(b.yG(a))return b.I4(a);return!1}zRh(a){if(0<a.count)for(const b of this.yl)b.uaf(a)}dispose(){this.Mc.Qaa(Object(H.a)(this,
this.UE,"onSessionEnd"));this.Mc.Tal(Object(H.a)(this,this.Hah,"onFailoverHandler"));this.Ur.wMb(Object(H.a)(this,this.Ljd,"onGraphNodePersistHandler"));this.Sp.yMb(Object(H.a)(this,this.Mkd,"onRevisionProcessedOnServerHandler"));this.Sp.Wrh(Object(H.a)(this,this.Ljd,"onGraphNodePersistHandler"));this.Mc.Raa(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.TXa&&0<this.TXa.count&&ya.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.TXa.count))}UE(){this.wFe=!0;this.t_i();
this.reset()}Hn(){this.ua.presentation.FYe();this.reset();this.wFe=!1;this.T0.XKa(new Qo.a("SessionRehydrated"))}Pka(){return[new fG(this.bxa,this.Cna,this.MU,this.tR,this.Mna,this.lc,this.Ga),new gG(this.Fna,this.bxa,this.MU,this.tR,this.Mna),new cG(this.PYa,this.Fna,this.Cna,this.MU,this.tR,this.Mna)]}poj(){this.PYa=new Qe.a;this.Fna=new Qe.a;this.bxa=new Qe.a;this.Cna=new Qe.a}W4b(a,b){var c=Object(sa.a)(565,a);c.uua+=1;({value:c}=this.TXa.vg(b.id)).returnValue||(c=new Oa.a,this.TXa.add(b.id,c));
c.add(a)}eOh(){if(this.TXa.count&&this.ua.presentation&&this.ua.presentation.Nh){var a=this.ua.presentation.Nh;this.TXa.forEach((b,c)=>{if(!this.I4(Object(sa.a)(9,a.Be(b)))){for(let f of c)if(c=Object(sa.a)(565,f))--c.uua,this.zBb(c)&&(this.T0.XKa(new Qo.a("SessionRehydrated")),this.Gqd(f));this.TXa.remove(b)}return!0})}}zBb(a){return a?!a.uua&&!a.Cka:!1}Gqd(a){var b=Object(sa.a)(565,a);a&&b&&(b=+new Date-+b.Pja,12E4<b&&ya.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static cTj(a){return(b,
c)=>{c=Wr.b(c.values.toArray(),f=>f.toString());c.length&&(a[Iy[b]]=c)}}}Object(m.a)(Jy,"GraphHotColdManager",null,[1016,1017,108,1018]);class iB{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}Xb(a){this.K=a;this.K.register(eB,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").na().oa(()=>new eB(this.K.resolve("Box4.Graph.IGraphInstance").KTa));this.K.register(gB,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").na().oa(()=>new gB(this.K.resolve("Box4.Graph.IGraphInstance").zd(7)));
this.K.register(cB,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").oa(()=>new cB(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(dB,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").na().oa(()=>new dB(this.K.resolve("Box4.List.IListReader"),this.K.ue("Box4.List.IListEditor")));this.K.register(hB,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").oa(()=>new hB);this.K.register(Jy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").na().oa(()=>
new Jy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").KTa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));
this.K.register(fB,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").na().oa(()=>new fB(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){n.a.instance.Ac(new iB)}}Object(m.a)(iB,"PPTWebEditorGraphEditorPackage",null,[2,3]);var xQ=d(793),Ky=d(795),yQ=d(794),yo=d(458);const hG=a=>{a.element.style.top=""};var Av=d(804);class iG{constructor(a,b,c){this.i8=!1;this.jOa=0;this.Nha=this.$qf=null;this.WS=a;this.Aai=b;this.Kn=c;this.WP=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.d3=!!w.AFrameworkApplication.Aa&&
w.AFrameworkApplication.Aa.mb.$ua)&&!this.Kn.bRc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";z.a.mg&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.WP}get visible(){return this.i8}set_visible(a){if(this.i8!==a)return(this.i8=a)?this.RWd():this.G4b(),a}dispose(){this.visible&&this.G4b();Ga.a.bDa(this.htmlElement);this.WS=this.WP=null}xEh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.$th();this.jOa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.KCf,y=Object(H.a)(this,this.DEk,"onAfterShowEntry");yo.WacAirSpace.p1a(c,"Shared_BasicClass");var G=new yQ.a(c);G.i0b(0,1);const R=new Ky.a(c);R.j0b(c.clientTop-30,c.clientTop);l?(yo.WacAirSpace.a_a(G,null,null),yo.WacAirSpace.a_a(R,null,y)):(yo.WacAirSpace.animate(G,null,null),yo.WacAirSpace.animate(R,null,y));for(b+=1;b<
f.length;b++)y=f[b],yo.WacAirSpace.p1a(y,"Shared_BasicClass"),G=new Ky.a(y),G.j0b(y.clientTop-c.clientHeight,y.clientTop),l?yo.WacAirSpace.a_a(G,null,null):yo.WacAirSpace.animate(G,null,null);a.mAl();this.set_visible(!0)}Ejg(a){const b=a.htmlElement;if(Ga.a.TVa(b)){this.jOa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.KCf;var f=Object(H.a)(this,this.zEk,"onAfterHideEntry");yo.WacAirSpace.p1a(b,"Shared_BasicClass");var l=new xQ.a(b);l.i0b(1,0);a?yo.WacAirSpace.a_a(l,null,f):yo.WacAirSpace.animate(l,
null,f);f=!1;for(l=0;l<c.length;l++){if(f){const y=c[l];yo.WacAirSpace.p1a(y,"Shared_BasicClass");const G=new Ky.a(y);G.j0b(y.clientTop,-b.clientHeight);a?yo.WacAirSpace.a_a(G,null,hG):yo.WacAirSpace.animate(G,null,hG)}f||c[l]!==b||(f=!0)}}}DEk(a){a.element.style.top="";w.AFrameworkApplication.Aa.Du()}zEk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);w.AFrameworkApplication.Aa.Du()}RWd(){""===this.WS.style.top.trim()&&(this.WS.style.top=this.WS.offsetTop+
"px");this.htmlElement.style.left=this.WS.style.left;this.htmlElement.style.top=this.WS.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.$qf=this.WS.style.top;this.jOa=a.height;this.Qzd();w.AFrameworkApplication.Aa.q8(Object(H.a)(this,this.onResize,"onResize"));md.a.addHandler(this.htmlElement,pa.a.xsd,md.a.Iub);this.Nha=Object(H.a)(this,this.LC,"contextMenuHandler");w.AFrameworkApplication.Aa.vba.ub(this.htmlElement,
this.Nha,null);if(t.FocusManager.oN()){var b=t.FocusManager.instance();a=b.Ic(Av.a.g8a);a.parent=D.AFrame.$i;const c=new ar.DOMFocusListing(()=>this.htmlElement);c.So(1);c.So(2);c.So(8);b.Aja(()=>this.htmlElement,a,c);b=b.LQ(Av.a.g8a);b.hkb();b.GX=!0;b.XRa=!0;const f=w.AFrameworkApplication.Aa.hx;a.t7a(()=>{f.Eo(Av.a.g8a)});f.cja(Av.a.g8a);(c.Aka||w.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.hL(Av.a.g8a)}}G4b(){this.ZDh()&&(this.WS.style.top=this.$qf);this.htmlElement.style.visibility=
"hidden";w.AFrameworkApplication.Aa&&(t.FocusManager.oN()&&t.FocusManager.instance().rMb(Av.a.g8a),this.Nha&&(w.AFrameworkApplication.Aa.vba.Bb(this.htmlElement,this.Nha),this.Nha=null));md.a.removeHandler(this.htmlElement,pa.a.xsd,md.a.Iub)}Qzd(){if(this.ZDh()&&this.visible){var a=this.WS,b=this.jOa+this.Aai;const c=Ga.a.YM(a.style.top);yo.WacAirSpace.p1a(a,"Shared_BasicClass");a=new Ky.a(a);a.j0b(c,b);yo.WacAirSpace.animate(a,null,null)}}ZDh(){return!this.d3&&!this.Kn.bRc}onResize(){const a=this.Kn.entries.length,
b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=this.Kn.entries[f],c.htmlElement&&c.$th();this.jOa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.jOa&&this.Qzd()}LC(){return!0}}Object(m.a)(iG,"BusinessBarDom",null,[686,108]);var gu;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]=
"fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=
17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=
27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=
36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(gu||(gu={}));Object(m.b)("BusinessBarId",gu);class Fq{constructor(a,b=0,c=null,f=null){this.kmf=this.Dgf=!1;this.crb=null;
this.SP=[];this.EAa=f||new iG(a,b,this);this.xSj(c)}xSj(a){if(a){this.crb={};a=a.ranking;for(let b=0;b<a.length;b++)this.crb[gu[a[b]]]=b}}dispose(){this.EAa.dispose();zy.a.Ord(this.SP);this.SP=null}get htmlElement(){return this.EAa.htmlElement}get visible(){return this.EAa.visible}get bRc(){return this.Dgf}set bRc(a){this.Dgf=a}get Jqe(){return this.kmf}set Jqe(a){this.kmf=a}get entries(){return this.SP}set entries(a){this.SP=a}wea(a){for(let b=0;b<this.SP.length;b++)if(this.SP[b].id===a)return!0;
return!1}li(a,b=!1,c=null){a.businessBar=this;let f=this.nmj(a.id);b&&!this.crb&&(f=0);f<Fq.Nhb&&(this.EAa.xEh(a,f),this.SP.length>=Fq.Nhb&&this.EAa.Ejg(this.SP[Fq.Nhb-1]),this.EAa.Qzd());Array.insert(this.SP,f,a);ha.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",gu[a.id],void 0===a.nDa||null===a.nDa?"":a.nDa);a.errorCode&&w.AFrameworkApplication.No(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.SP,a);-1!==b&&b<Fq.Nhb&&(this.SP.length>Fq.Nhb&&
this.EAa.xEh(this.SP[Fq.Nhb],Fq.Nhb),this.EAa.Ejg(a),this.EAa.Qzd());Array.remove(this.SP,a);a.businessBar=null;a.dispose()}nmj(a){if(!this.crb||0===a)return this.SP.length;a=this.crb[gu[a]];if(void 0===a||null===a)return this.SP.length;for(let b=0;b<this.SP.length;b++)if(a<this.crb[gu[this.SP[b].id]])return b;return this.SP.length}}Fq.Nhb=2;Object(m.a)(Fq,"BusinessBar",null,[641,108,642]);class jB{constructor(a){this.UPc=null;this.o9g=a.Ha("OfficeOnlineChromeExtensionId");this.y9g=a.Ha("ChromeClipboardAccessExtensionId");
this.AXj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.Tuf=!this.p3j();this.UPc=this.jza?this.y9g:this.o9g}gWc(){return this.UPc}xYe(){this.UPc===this.o9g&&this.Frg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.UPc=this.y9g;this.Tuf=!0}get jza(){return this.Tuf}p3j(){if(this.AXj&&this.Frg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&
"true"===a}return!1}get Frg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){ha.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(m.a)(jB,"ChromeExtensionHelper",null,[511]);class jG{constructor(a=null,b=null,c=null){this.zba=a||{};this.IMh=b||[];this.MNl=c||{}}}Object(m.a)(jG,"RibbonTrimmingProperties",
null,[]);var zQ=d(463);class kG{create(a,b,c){return new zQ.a(a,b,c)}}Object(m.a)(kG,"Factory",null,[685]);class lG{constructor(){w.AFrameworkApplication.Qa.ya(F.a.JCb,ye.a.frame,Object(H.a)(this,this.R3k,"reactFileMenuOpenFromTellMe"))}R3k(a,b,c,f,l){if(1===c)return 32;w.AFrameworkApplication.Bdb("54hi9858;4f638686");if(!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],Zg.d("setFileMenuSelectedPage")&&("New"===a&&w.AFrameworkApplication.Aa?2===w.AFrameworkApplication.Aa.mb.Ti?
l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&w.AFrameworkApplication.Aa&&(2===w.AFrameworkApplication.Aa.mb.Ti?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}Rak(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}
Object(m.a)(lG,"ReactFileMenu",null,[1434]);class mG{createFileMenu(){const a=new lG,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(m.a)(mG,"ReactFileMenuFactory",null,[1433]);var Ih=d(542);class nG{constructor(a,b,c,f,l){this.NHa=!1;this.vA=null;this.Sma=this.vfd=this.rYa=!1;this.$gc="Edit";this.pc=f;this.ia=a;this.Uv=b;this.Rb=l;this.Rb.MI(Object(H.a)(this,this.Bhd,"modeSwitched"));
this.Da=c;this.vb()}vb(){this.ia.ya(ea.a.H6g,ye.a.frame,Object(H.a)(this,this.KAk,"modeSwitcherHandler"));this.ia.ya(ea.a.Avc,ye.a.frame,Object(H.a)(this,this.Avc,"switchToDocumentEditMode"));this.ia.ya(ea.a.Cvc,ye.a.frame,Object(H.a)(this,this.Cvc,"switchToEmergencyViewMode"));this.ia.ya(ea.a.Bvc,ye.a.frame,Object(H.a)(this,this.Bvc,"switchToDocumentViewMode"));this.ia.ra(ea.a.kUe,ye.a.frame,Object(H.a)(this,this.Klh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ra(ea.a.lUe,ye.a.frame,Object(H.a)(this,
this.Klh,"queryDocumentModeSwitchMenuItem"),96);this.ia.ya(ea.a.UDa,qc.a.application,Object(H.a)(this,this.UDa,"displayCallout"));this.ia.ya(F.a.VIh,ye.a.frame,Object(H.a)(this,this.KHl,"switchFromViewModeToEditMode"))}dispose(){this.Rb.WY(Object(H.a)(this,this.Bhd,"modeSwitched"))}me(){}KAk(){return 32}Bvc(a,b,c){if(1===c||"View"===this.X$a())return 32;this.Uv.aJh();this.Psd("View");this.vfd=!0;return 32}Avc(a,b,c){if(w.AFrameworkApplication.$Q)return 8;a=this.X$a();if(1===c){if("Edit"===a||this.NHa||
this.vfd||this.rYa&&this.pc.getState(1))return 32;ha.ULS.sendTraceTag(512500510,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.Uv.iul();c=this.rYa?this.ia.Ja(ea.a.r5b,2,20):this.ia.processAction(ea.a.z9b,2);this.NHa=this.rYa=this.vfd=!1;this.Psd("Edit");return c}KHl(a,b,c){if(w.AFrameworkApplication.$Q)return 8;a=this.X$a();if(1===c){if("Edit"===a||this.NHa||this.vfd||this.rYa&&this.pc.getState(1))return 32;
ha.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;if(2!==c)return ha.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.Ja(ea.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}Cvc(a,b,c){if(1===c)return 32;this.NHa=!0;return this.initialize()}Klh(a,b,c,f,l){b=this.X$a();l[Ih.a.On]=a===ea.a.kUe&&
"Edit"===b||a===ea.a.lUe&&"View"===b?!0:!1;return 32}UDa(a,b,c,f,l){if(!l||!Object(Sa.a)(hj,l))return 8;this.vA=l;this.initialize();return this.initialize()}initialize(){if(!Zg.c())return ha.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.$gc=this.i$f();!this.Sma&&this.Da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.X$a()!==this.$gc&&ha.ULS.sendTraceTag(512500506,
306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",this.$gc,this.X$a());var a=this.vA?this.vA.obc||this.vA.tbc:!1,b=this.vA?this.vA.ZVa:this.pc.getState(16);this.rYa=this.vA?this.vA.Tpe:this.pc.getState(524288);var c=this.vA?this.vA.kbb:this.pc.getState(1);const f=this.NHa||a||this.rYa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.$gc;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.rYa;l.isReviewer=!1;l.isServiceDefaultedToView=this.NHa||
a;l.forceShowNotificationByExternalTrigger=this.vA&&this.vA.g2c?!this.vA.g2c:f;a&&(a={},c={},c.title=ResourceStrings.L_BizBarTitle_Readonly,this.vA.obc?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.vA.tbc&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);
if(!a)return ha.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),8;ha.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.vA,l.hasEditPermission,this.$gc,b,this.rYa,!!this.vA&&
this.vA.obc,!!this.vA&&this.vA.tbc,this.NHa,this.hog());b=this.Z4d(a);this.Sma=!0;return b}Z4d(a){if(appChrome.api)return appChrome.api.dispatch(a),32;ha.ULS.sendTraceTag(512500503,306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}hog(){return!!w.AFrameworkApplication.Aa&&1===w.AFrameworkApplication.Aa.mode}i$f(){return this.vA?this.NHa||this.vA.ZVa||this.vA.Tpe||this.vA.obc||this.vA.tbc||this.vA.g2c?"View":this.vA.kbb?
"Edit":"View":this.NHa||this.hog()?"View":"Edit"}X$a(){if(Zg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:ha.ULS.sendTraceTag(512500502,306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}Psd(a){if(Zg.c()&&this.X$a()!==a){var b={};b.activeMode=a;ha.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",
a);a=appChrome.actions.updateModeSwitcher(b);this.Z4d(a)}}Bhd(a){this.Sma&&(1===a.mode?this.Psd("View"):2===a.mode&&this.Psd("Edit"))}jdl(){const a={hidden:!1};a.activeMode=this.i$f();this.Z4d(appChrome.actions.updateModeSwitcher(a))}}Object(m.a)(nG,"ModeSwitcherControlActor",null,[977]);var oG=d(255);class kB{constructor(a,b,c,f){this.eCa=this.aif=this.Sqb=this.vgf=this.mOa=this.zff=null;this.Qwf=!1;this.Kn=a;this.LZ=b;this.Ca=c;this.Ma=f}BSk(){this.d2b();this.e2b();this.QCi()}d2b(){const a=Sc.App.Mb.Ld.Di;
a&&(this.zff=this.Rzd(this.zff,1,2===Sc.App.Mb.mode&&a.F1c,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get l9j(){if(!Sc.App.fPh)return!1;z.a.tX&&w.AFrameworkApplication.uk("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");return z.a.Yj}QCi(){this.l9j&&!this.Sqb&&(this.Sqb=this.LZ.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.Sqb.id=15,this.Sqb.closeable=!0,this.Sqb.addButton(Box4Intl.Box4Strings.L_DownloadNow,L.AppFrame.oRl,""),kk.a("NewBrowserSuggestionShown"),
this.Kn.li(this.Sqb,!1))}e2b(){let a=null;const b=Sc.App.Mb.Ld.j8;if(b){const c=b.ioc;oG.a.Xac(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===c||20===c?a=z.a.Yi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=z.a.Yi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):
2!==Sc.App.Mb.mode||oG.a.OZc(b.s_b)||Sc.App.xcc||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.aif=this.Rzd(this.aif,5,!!a,a)}jul(a){!!this.eCa===a||this.Qwf||(a?(this.eCa=this.LZ.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.eCa.id=13,this.eCa.closeable=!0,this.eCa.KW=()=>{this.Qwf=!0;this.eCa=null},this.Kn.li(this.eCa)):(this.Kn.removeEntry(this.eCa),this.eCa=null))}DEh(a,b,c,f){a=this.LZ.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.Gzf(b,()=>
{Cd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.KW=f);this.Kn.li(a,!0)}IAl(a,b,c){this.DEh(a,b,c,null)}cAl(a){a=this.LZ.create(null,a,null);a.closeable=!0;a.id=24;a.image=1;this.Kn.li(a,!0)}TAl(a){a=this.LZ.create(null,a,null);a.closeable=!0;a.id=20;this.Kn.li(a)}iAl(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.mOa||(this.mOa=this.LZ.create(a,b,null),this.mOa.closeable=!0,this.mOa.id=27,this.Kn.li(this.mOa))}nMj(){this.mOa&&
(this.mOa=this.Rzd(this.mOa,27,!1,""))}C3e(a){this.vgf=this.Rzd(this.vgf,30,!0,a)}Rzd(a,b,c,f){c?a?a.message=f:(a=this.LZ.create("",f,null),a.id=b,a.closeable=!1,this.Kn.li(a,!1)):a&&(this.Kn.removeEntry(a),a=null);return a}}Object(m.a)(kB,"BusinessBarController",null,[1429]);var AQ=d(264);class lB extends kB{constructor(a,b,c,f,l,y,G,R,ja,za){const Va=[];a||Va.push("businessBar");b||Va.push("businessBarEntryFactory");c||Va.push("appFrame");f||Va.push("actionManager");l||Va.push("errorMapping");y||
Va.push("appSettingsManager");G||Va.push("focusManager");R||Va.push("applicationSettings");ja||Va.push("presentationIdGetter");za||Va.push("filterPrivacyRoamingCacheProxy");if(Va.length)throw Error.argumentNull(Va.join());super(a,b,f,y);this.Ljc=[];this.vue=this.CHg=!1;this.PGa=0;this.BGe=null;this.KW=hb=>{ya.a.J(508884448,801,50,"BusinessBarController::CloseHandler");this.ije(hb)};this.x$k=hb=>{ya.a.J(509195598,801,50,"BusinessBarController::RemoveFilterPrivacyHandler");AQ.a.wpl(this.vsk.presentationId.string,
this.$Kk,this.ZKk);this.Kn.removeEntry(hb)};this.$Kk=()=>{ya.a.J(509195597,801,50,"BusinessBarController::OnRemoveFilterPrivacySucceeded")};this.ZKk=hb=>{ya.a.J(509195596,801,10,"BusinessBarController::OnRemoveFilterPrivacyFailed - Error: {0}",Of.a.sL(hb.error.Vm))};this.T$j=hb=>{this.Ma.ka("KeepFilterPrivacyClickCountRoamingEnabled")&&this.wAe.yPj();ya.a.J(509182920,801,50,"BusinessBarController::KeepFilterPrivacyHandler");this.Kn.removeEntry(hb)};this.Rb=c;this.ia=f;this.r$=l;this.Fa=G;this.BA=
R.YFa;this.vjc=R.powerPointDragInsertMultipleImageQuantityLimit;this.vsk=ja;this.wAe=za}initialize(){this.Rb.MI(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"))}dispose(){this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"))}Bv(a,...b){this.S4b.apply(this,[a,this.r$.LXc(a),this.r$.rfe(a),this.r$.Kce(a)].concat(b))}S4b(a,b,c,f){0===a||this.BGe||(c=this.LZ.create(c,f||"",null),c.closeable=!0,c.errorCode=Of.a.Ph(a),c.KW=Object(H.a)(this,this.g3i,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&
4),a&&c.addButton(ResourceStrings.L_Refresh,Object(H.a)(this,this.Apd,"refreshActionHandler"),""),b&&(a?c.PTd(ResourceStrings.L_OpenInPowerPoint,Object(H.a)(this,this.tld,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,Object(H.a)(this,this.tld,"openInClientActionHandler"),"")),this.BGe=c,this.B_b(c))}wL(a){var b="";let c="",f=null,l="",y=null;var G=!1;let R=!1,ja=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;
G=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;G=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;G=!0;break;case 2:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;G=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;G=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_RequiresCheckout;G=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;G=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;G=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;G=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;
G=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;G=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;c=ResourceStrings.L_BizBarButton_Convert;f=Object(H.a)(this,this.RKi,"convertActionHandler");G=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;G=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_FontRestricted;G=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;G=!0;break;case 14:b=w.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?w.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=w.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?w.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";G=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;
G=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;G=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,this.vjc);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,this.vjc);G=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.auj();G=!1;a&&(this.PGa=a,a=this.ia.Ja(ea.a.hNb,1,this.PGa),8!==a&&16!==a&&(G=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,
f=Object(H.a)(this,this.Sdl,"repairSaveCopyHandler")));32===this.ia.processAction(ea.a.Yrc,1)&&(G?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,y=Object(H.a)(this,this.Esh,"replaceOriginalFileHandler")):(G=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(H.a)(this,this.Esh,"replaceOriginalFileHandler")));a=G?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;G=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;
a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(H.a)(this,this.UBj,"goToEditModeHandler");G=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(H.a)(this,this.vOk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;
break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;G=!1;break;case 27:ja=R=!0;a=ResourceStrings.L_BizBarInlineFilterPrivacy;c=ResourceStrings.L_RemoveSetting;f=this.x$k;l=ResourceStrings.L_KeepSetting;y=this.T$j;break;default:return}b=this.LZ.create(b,a,null);b.image=3;b.closeable=!0;b.KW=G?Object(H.a)(this,this.Unh,"readOnlyInfoEntryClosedHandler"):ja?this.KW:Object(H.a)(this,this.ije,"infoEntryClosedHandler");R&&(b.R2c=!1);f&&b.addButton(c,f,"");y&&b.PTd(l,y);this.B_b(b);
G&&Array.add(this.Ljc,b)}VDa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.LZ.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.B_b(c)}$Qc(a,b){let c,f=!1,l=!1,y=!1,G=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;
b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;y=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:
ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;G=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;f=!0;b=1;break;default:return}a=this.LZ.create(a,c||"",
null);a.closeable=!0;a.KW=Object(H.a)(this,this.Unh,"readOnlyInfoEntryClosedHandler");a.image=b;f?(ya.a.J(512263711,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(H.a)(this,this.Apd,"refreshActionHandler"),"")):l?(ya.a.J(512263710,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,Object(H.a)(this,this.njl,"saveAsActionHandler"),"")):G?(ya.a.J(512263709,801,15,"DownloadACopy button is show"),a.addButton(ResourceStrings.L_DownloadCopy,
Object(H.a)(this,this.LZi,"downloadACopyActionHandler"),"")):y&&(ya.a.J(512263708,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(H.a)(this,this.C_i,"editAnywayActionHandler"),""));this.B_b(a);Array.add(this.Ljc,a)}wea(a){return this.Kn.wea(a)}auj(){let a=0;if(this.Ma.ka("IsUIEmbedMode")||this.Ma.ka("DisablePrint")||!this.Ma.Ha("DownloadACopyUrl")||"true"===this.Ma.Ha("ProtectInClient")||z.a.Yi)return a;let b=!0;this.Ma.ka("SaveToAnotherFolderBrsIsEnabled")&&
this.Ma.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.Ma.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.Ma.ka("SaveAsToHostBrsIsEnabled")&&this.Ma.ka("UserCanWriteRelative")&&this.Ma.ka("SupportsEditing")||(f=!1);a=b?F.a.Ukb:c?F.a.Qsc:a;ya.a.J(512263707,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,f,a);return a}B_b(a){const b=this.Kn.visible;this.Kn.li(a);b||this.Fa.wj(Si.a.rYd,
!0)}Apd(a){ya.a.J(512263706,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(ea.a.refresh,2)}ije(){this.Kn.entries.length||this.Fa.wj(Si.a.rYd,!1)}g3i(){this.BGe=null;this.Kn.entries.length||this.Fa.wj(Si.a.rYd,!1)}Unh(a){Array.remove(this.Ljc,a);this.ije(a);ya.a.J(512263705,801,50,"Read-only info entry is closed")}tld(){this.ia.Ja(ea.a.openInClient,2,!0)}RKi(){this.ia.Ja(ea.a.convertAndEdit,2,!1)}Sdl(){w.AFrameworkApplication.Vx?this.g4e(CommonUIStrings.l_SensitivitySaveDocumentError):
this.ia.Ja(ea.a.hNb,2,this.PGa)}Esh(){this.ia.processAction(ea.a.Yrc,2)}UBj(){this.ia.processAction(ea.a.z9b,2)}njl(){ya.a.J(512263704,801,15,"SaveACopy button is clicked");w.AFrameworkApplication.Vx?this.g4e(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.Ja(F.a.Ukb,2,!0)}LZi(){ya.a.J(512263703,801,15,"DownloadACopy button is clicked");w.AFrameworkApplication.Vx?this.g4e(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.Ja(F.a.downloadACopy,2,!0)}g4e(a){ya.a.J(512263702,801,50,
"Unable to save/download ppt from business bar as document is protected");const b=new sh.StandardDialog;b.Ad=0;b.Yy(Of.a.wZi,Ij.a.i4(ResourceStrings.l_GenericDialogTitle),Ij.a.i4(a),null)}C_i(){ya.a.J(512263701,801,50,"EditAnyway button is clicked");this.ia.Ja(ea.a.r5b,2,20)}vOk(){ya.a.J(512263700,801,50,"Learn More button is clicked");Tf.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}NZd(){if(this.Rb.ibb&&!this.vue&&!this.CHg){this.vue=!0;var a=this.LZ.create("",CommonUIStrings.l_OdfFileCompatWarningBusinessBar,
null);a.closeable=!0;a.KW=()=>{this.CHg=!0;this.vue=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(H.a)(this,this.aGk,"onCompatWarningButtonClick"),"");this.B_b(a)}}aGk(){Tf.Redirect.showHelp("PPTODF")}bWf(){for(const a of this.Ljc)this.Kn.removeEntry(a);Array.clear(this.Ljc)}Eu(a){this.BA&&2===a.mode&&this.bWf()}}Object(m.a)(lB,"BusinessBarController",kB,[1428,1429,108]);class pG{constructor(a,b){this.Vdb=null;this.Psk=b;this.ob=document.createElement("div");this.ob.className=
"BusinessBarPanel";this.ob.id="BusinessBarPanel";this.Clc=document.createElement("div");this.Clc.id="BusinessBarPanelWorking";this.ob.insertBefore(this.Clc,this.ob.firstChild);a.execute(c=>{this.Vdb=c;this.Psk&&this.Vdb&&(this.Vdb.bRc=!0);this.Clc.insertBefore(this.Vdb.htmlElement,this.Clc.firstChild)});this.ob.style.position=qe.a.svc}dispose(){}layout(a,b){if(!this.Vdb||!this.Vdb.visible)return this.Kq(),a;this.uYi(b);this.ob.style.height=k.a.Pc(this.Vdb.htmlElement.offsetHeight);return a}Kq(){"none"!==
this.ob.style.display&&(this.ob.style.display="none")}uYi(a){this.ob.style.display.length&&(this.ob.style.display="");a&&(this.ob.style.direction=qe.a.k2a)}get xa(){return this.ob}get i_l(){return this.Clc}get order(){return 2}}Object(m.a)(pG,"BusinessBarPane",null,[981,654,108]);var mx=d(579),qG=d(379);class np{}np.Value="value";np.MinValue="MinValue";np.MaxValue="MaxValue";np.Text="Text";Object(m.a)(np,"SliderCommandProperties",null,[]);var op=d(1158);class Vo{constructor(){this.iconSet=null;this.hidden=
this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(m.a)(Vo,"CommonOptionalButtonProperties",null,[]);class Bv extends Vo{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(Bv,"OptionalButtonProperties",Vo,[]);class rG extends Bv{constructor(){super();this.animateTransition=!1}}Object(m.a)(rG,"AdditionalInkButtonProperties",
Bv,[]);class Ly extends Vo{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(Ly,"OptionalFlyoutAnchorProperties",Vo,[]);class sG extends Ly{constructor(){super();this.animateTransition=!1}}Object(m.a)(sG,"AdditionalInkFlyoutAnchorProperties",Ly,[]);class tG{constructor(){this.selected=!1;this.iconColor=null}}Object(m.a)(tG,"InkControlState",null,[]);
class uG{constructor(){this.keytip=this.iconName=this.label=null}}Object(m.a)(uG,"InkFlyoutAnchorResources",null,[]);class Xr{constructor(){this.jDb=[]}ya(a){this.jDb.push(a)}commit(){appChrome.api.dispatch(this.jDb);Array.clear(this.jDb)}}Object(m.a)(Xr,"AppChromeTransaction",null,[]);var Te=d(666);class pp{constructor(a,b,c,f,l){this.HYa=this.JYa=this.IYa=pp.$Lc;this.wFj=(y,G,R)=>{if(1===R)return 32;if(this.z$.ga(Te.a.Bua).selected)return this.Q4d(),32;!pp.X_c.some(ja=>this.z$.ga(ja).selected&&
Te.a.vla!==ja)&&this.y$.count&&(this.p2b(!1),y=new Xr,this.eF(this.FA,!0,!0,y,!0),this.ia.processAction(ea.a.Oje,2),y.commit());return 32};this.c0=(y,G,R,ja,za)=>{if(1===R)return this.pxe?8:32;G=this.z$.ga(Te.a.vla).selected;y!==ea.a.ssd&&this.p2b(y===ea.a.ALa);R=new Xr;if(this.I2e(this.tqe(za)))switch(y){case ea.a.psd:case ea.a.qsd:case ea.a.nsd:case ea.a.msd:case ea.a.tsd:case ea.a.rsd:case ea.a.osd:case ea.a.gsd:case ea.a.hsd:case ea.a.isd:case ea.a.jsd:case ea.a.ksd:case ea.a.lsd:this.eF(Te.a.Bua,
!0,!1,R,!1)}switch(y){case ea.a.psd:this.eF(Te.a.lA,!0,!0,R,!0);this.ia.Ja(ea.a.lA,2,za);this.FA=Te.a.lA;break;case ea.a.jsd:this.eF(Te.a.lA,!0,!0,R,!0);this.qNb(Te.a.lA,this.XXa,Te.a.qea,[Te.a.sla,Te.a.tla],"#000000",za,R);this.ia.Ja(ea.a.sla,2,za);this.FA=Te.a.lA;break;case ea.a.gsd:this.eF(Te.a.lA,!0,!0,R,!0);this.qNb(Te.a.lA,this.XXa,Te.a.qea,[Te.a.sla,Te.a.tla],"#000000",za,R);this.ia.Ja(ea.a.Lbb,2,za);this.FA=Te.a.lA;break;case ea.a.qsd:this.eF(Te.a.bD,!0,!0,R,!0);this.ia.Ja(ea.a.bD,2,za);this.FA=
Te.a.bD;break;case ea.a.ksd:this.eF(Te.a.bD,!0,!0,R,!0);this.qNb(Te.a.bD,this.XXa,Te.a.qea,[Te.a.sla,Te.a.tla],"#e71224",za,R);this.ia.Ja(ea.a.tla,2,za);this.FA=Te.a.bD;break;case ea.a.hsd:this.qNb(Te.a.bD,this.XXa,Te.a.qea,[Te.a.sla,Te.a.tla],"#e71224",za,R);this.eF(Te.a.bD,!0,!0,R,!0);this.ia.Ja(ea.a.qea,2,za);this.FA=Te.a.bD;break;case ea.a.nsd:this.eF(Te.a.aD,!0,!0,R,!0);this.ia.Ja(ea.a.aD,2,za);this.FA=Te.a.aD;break;case ea.a.lsd:this.eF(Te.a.aD,!0,!0,R,!0);this.qNb(Te.a.aD,this.LEb,Te.a.Aua,
[Te.a.CFa],"#fffc00",za,R);this.ia.Ja(ea.a.CFa,2,za);this.FA=Te.a.aD;break;case ea.a.isd:this.eF(Te.a.aD,!0,!0,R,!0);this.qNb(Te.a.aD,this.LEb,Te.a.Aua,[Te.a.CFa],"#fffc00",za,R);this.ia.Ja(ea.a.Aua,2,za);this.FA=Te.a.aD;break;case ea.a.msd:this.eF(Te.a.v9,!0,!1,R,!1);this.ia.Ja(ea.a.v9,2,za);break;case ea.a.tsd:this.la.ka("IsInkPartialEraserEnabled")&&(this.eF(Te.a.Nbb,!0,!1,R,!1),this.ia.Ja(ea.a.Nbb,2,za));break;case ea.a.rsd:this.la.ka("IsInkPartialEraserEnabled")&&(this.eF(Te.a.Mbb,!0,!1,R,!1),
this.ia.Ja(ea.a.Mbb,2,za));break;case ea.a.ssd:this.eF(Te.a.vla,!G,!1,R,!1);this.ia.Ja(ea.a.vla,2,za);break;case ea.a.osd:this.eF(Te.a.w9,!0,!1,R,!1);this.ia.Ja(ea.a.w9,2,za);break;case ea.a.ALa:this.eF(Te.a.DFa,!0,!1,R,!1),this.eF(Te.a.Bua,!1,!1,R,!1),this.ia.processAction(ea.a.DFa,2)}R.commit();this.pok&&mx.ShyRibbon.GRa(1,2);return 32};this.ia=a;this.pok=f;this.la=l;this.z$=new Yc.a;this.y$=new Yc.a;for(const y of pp.X_c){a="";if(qd.a("PenColorRetentionEnabled"))(a=qG.a.instance.getItem(y+"Color"))||
(a=pp.Sil[y]);else switch(y){case Te.a.lA:a="#000000";break;case Te.a.bD:a="#E71224";break;case Te.a.aD:a="#FFFC00"}this.z$.$(y,Object.assign(new tG,{selected:!1,iconColor:a}))}w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb&&w.AFrameworkApplication.Aa.mb.Rp&&this.vb();this.XXa=new Oa.a;this.XXa.add("#FFC114");this.XXa.add("#F6630D");this.XXa.add("#FF0066");this.XXa.add("#5B2D90");this.LEb=new Oa.a;this.LEb.add("#00F900");this.LEb.add("#00FDFF");this.LEb.add("#FF40FF");this.LEb.add("#FF8517");
this.FA=Te.a.lA;b.SJc(Object(H.a)(this,this.YU,"onFocusChanged"));this.pxe=!c||!c.Hc}vb(){this.ia.ra(ea.a.Pje,rb.a.application,Object(H.a)(this,this.K0i,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.ra(ea.a.hmg,rb.a.application,Object(H.a)(this,this.nIj,"handleRefreshInkUIValues"),4);this.ia.ra(ea.a.Y_c,rb.a.application,Object(H.a)(this,this.vFj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.ra(ea.a.psd,rb.a.application,this.c0,4);this.ia.ra(ea.a.qsd,rb.a.application,this.c0,4);this.ia.ra(ea.a.nsd,
rb.a.application,this.c0,4);this.ia.ra(ea.a.ssd,rb.a.application,this.c0,4);this.ia.ra(ea.a.gsd,rb.a.application,this.c0,4);this.ia.ra(ea.a.hsd,rb.a.application,this.c0,4);this.ia.ra(ea.a.isd,rb.a.application,this.c0,4);this.ia.ra(ea.a.jsd,rb.a.application,this.c0,4);this.ia.ra(ea.a.ksd,rb.a.application,this.c0,4);this.ia.ra(ea.a.lsd,rb.a.application,this.c0,4);this.ia.ra(ea.a.x_e,rb.a.application,Object(H.a)(this,this.Vge,"handleThicknessSliderChanged"),4);this.ia.ra(ea.a.y_e,rb.a.application,Object(H.a)(this,
this.Vge,"handleThicknessSliderChanged"),4);this.ia.ra(ea.a.z_e,rb.a.application,Object(H.a)(this,this.Vge,"handleThicknessSliderChanged"),4);this.ia.ra(ea.a.w_e,rb.a.application,Object(H.a)(this,this.tFj,"handleInkDrawWithTouchSelected"),4);qd.a("PenDownHandlingEnabled")&&this.ia.ra(ea.a.qxh,rb.a.application,this.wFj,4);this.ia.ra(ea.a.msd,rb.a.application,this.c0,4);this.la.ka("IsInkPartialEraserEnabled")&&(this.ia.ra(ea.a.tsd,rb.a.application,this.c0,4),this.ia.ra(ea.a.rsd,rb.a.application,this.c0,
4));this.ia.ra(ea.a.osd,rb.a.application,this.c0,4);this.ia.ra(ea.a.ALa,rb.a.application,this.c0,4)}vFj(a,b,c,f,l){if(1===c)return 32;this.pxe=l;return 32}nIj(a,b,c){if(1===c)return 32;a=new Xr;this.cOb(Te.a.EFa,this.IYa,a);this.cOb(Te.a.FFa,this.JYa,a);this.cOb(Te.a.GFa,this.HYa,a);a.commit();this.y$.count||this.Vck();return 32}tFj(a,b,c,f,l){if(1===c)return this.pxe?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.z$.ga(Te.a.Bua).selected||a?(this.p2b(!1),this.Q4d()):(this.p2b(!1),a=new Xr,this.eF(Te.a.Bua,
!0,!1,a,!1),this.eF(this.FA,!0,!0,a,!0),a.commit(),this.ia.Ja(ea.a.Nje,2,{enable:!0}));return 32}Vge(a,b,c,f,l){if(1===c)return 32;b=new Xr;qd.a("DrawWithTouchEnabledOnThicknessSliderMove")||this.eF(Te.a.Bua,!0,!1,b,!1);l&&l&&(l[pp.BDl]=np.Value);switch(a){case ea.a.x_e:this.ia.Ja(ea.a.EFa,2,l);this.IYa=this.Nab(l);this.cOb(Te.a.EFa,this.IYa,b);this.FA=Te.a.lA;break;case ea.a.y_e:this.ia.Ja(ea.a.FFa,2,l);this.JYa=this.Nab(l);this.cOb(Te.a.FFa,this.JYa,b);this.FA=Te.a.bD;break;case ea.a.z_e:this.ia.Ja(ea.a.GFa,
2,l),this.HYa=this.Nab(l),this.cOb(Te.a.GFa,this.HYa,b),this.FA=Te.a.aD}b.commit();return 32}isEnabled(a){return this.z$.ga(a).selected}K0i(a,b,c){if(1===c)return 32;if(!Zg.c())return ya.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.y$.count)return 32;this.p2b(!1);this.Q4d();this.z$.ga(this.FA).selected=!1;a=new Xr;this.eF(this.FA,!0,!0,a,!0);this.ia.processAction(ea.a.Oje,2);a.commit();return 32}Vck(){for(const a of pp.X_c)switch(a){case Te.a.lA:this.Pdc(Te.a.lA);
break;case Te.a.bD:this.Pdc(Te.a.bD);break;case Te.a.aD:this.Pdc(Te.a.aD);break;case Te.a.v9:this.la.ka("IsInkPartialEraserEnabled")||this.Pdc(Te.a.v9);break;case Te.a.w9:this.Pdc(Te.a.w9)}}Pdc(a){const b=appChrome.selectors.getInkButtonState(a);this.y$.$(a,Object.assign(new uG,{label:Te.a.B3f in b?Object(sa.a)(String,b[Te.a.B3f]):"",iconName:Te.a.z3f in b?Object(sa.a)(String,b[Te.a.z3f]):"",keytip:Te.a.A3f in b?Object(sa.a)(String,b[Te.a.A3f]):""}))}p2b(a){const b=new Xr;for(const c of pp.X_c)if(c!==
Te.a.vla)switch(this.eF(c,!1,!1,b,!0),c){case Te.a.lA:this.pvb(Te.a.lA,b,!0,a);break;case Te.a.bD:this.pvb(Te.a.bD,b,!0,a);break;case Te.a.aD:this.pvb(Te.a.aD,b,!0,a);break;case Te.a.v9:this.pvb(Te.a.v9,b,!0,a);break;case Te.a.w9:this.pvb(Te.a.w9,b,!0,a)}b.commit()}DRh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.z$.ga(a).selected=b}eF(a,b,c,f,l){c?b?(b&&!this.z$.ga(a).selected&&this.PGi(a,f,l),this.DRh(a,b,f)):this.pvb(a,f,l,a!==Te.a.DFa):this.DRh(a,b,f)}pvb(a,b,c,f){if(this.y$.Gb(a)){var l=
this.y$.ga(a).iconName,y=this.y$.ga(a).keytip,G=this.y$.ga(a).label,R=this.rae(a);a=appChrome.api.createInkButtonModel(a,R?R:G,Object.assign(new rG,{iconSet:(new op.a(l)).iconSet,iconColor:this.z$.ga(a).iconColor,keytip:y,animateTransition:c&&!f}));b.ya(appChrome.actions.addControls([a]))}}PGi(a,b,c){if(this.y$.Gb(a)){var f=this.rae(a),l=this.y$.ga(a).iconName,y=this.y$.ga(a).keytip,G=this.y$.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,f?f:G,Object.assign(new sG,{iconSet:(new op.a(l)).iconSet,
iconColor:this.z$.ga(a).iconColor,keytip:y,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));b.ya(appChrome.actions.addControls([a]))}}rae(a){if(this.la.ka("InkColorLabelEnabled")){var b=void 0;switch(a){case Te.a.lA:case Te.a.bD:var c=appChrome.selectors.getColorPickerState(Te.a.qea);break;case Te.a.aD:c=appChrome.selectors.getColorPickerState(Te.a.Aua)}c&&(c=this.CQf(Array.isArray(c.colorCells)?c.colorCells:null),b=this.y$.ga(a).label,b=`${b.split(":")[0]}: ${c[this.z$.ga(a).iconColor].label}`);
return b}}oql(a,b,c){c.ya(appChrome.actions.updateIconColor(a,b));this.pql(a,c)}pql(a,b){let c=this.rae(a);c&&b.ya(appChrome.actions.setControlLabel(a,c))}qql(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}cOb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}jUk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.CQf(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.qql(l,this.joj(a,c),f)}}koj(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-
1):a.removeAt(c);a.insert(0,b)}CQf(a){const b={};for(const c of a)b[c.id]=c;return b}joj(a,b){const c=[];for(let f of b)f in a&&Array.add(c,a[f]);return c}tqe(a){return a&&a.InputMethod?a.InputMethod===Te.a.Sje:!1}I2e(a){return!a||z.a.Yi||z.a.bbc}ouj(a,b){a&&a.Color&&(b=6===Object(sa.a)(String,a.Color).length?"#"+a.Color:Object(sa.a)(String,a.Color));return b}qNb(a,b,c,f,l,y,G){l=this.ouj(y,l);this.z$.ga(a).iconColor=l;qd.a("PenColorRetentionEnabled")&&qG.a.instance.setItem(a+"Color",l);this.oql(a,
l,G);this.koj(b,l);this.jUk(c,f,b,G)}Q4d(){const a=new Xr;this.eF(Te.a.Bua,!1,!1,a,!1);this.ia.Ja(ea.a.Nje,2,{enable:!1});a.commit()}YU(a,b){b.QKb===xa.a.qP&&b.fib!==xa.a.qP&&this.ia.processAction(ea.a.fmg,2);b.QKb!==xa.a.qg&&b.fib===xa.a.qg&&this.ia.processAction(ea.a.kmg,2)}Nab(a){return a&&a[np.Value]?a[np.Value]:pp.$Lc}}pp.BDl="SliderCommandPropertiesValueKey";pp.$Lc=3;pp.X_c=[Te.a.lA,Te.a.bD,Te.a.Bua,Te.a.v9,Te.a.Nbb,Te.a.Mbb,Te.a.aD,Te.a.vla,Te.a.w9,Te.a.DFa];pp.Sil={[Te.a.lA]:"#000000",[Te.a.bD]:"#E71224",
[Te.a.aD]:"#FFFC00"};Object(m.a)(pp,"InkRibbonManager",null,[983]);class vG{constructor(a){this.Xve=a}get jza(){return this.Xve.jza}gWc(){return this.Xve.gWc()}xYe(){this.Xve.xYe()}}Object(m.a)(vG,"PPTChromeExtensionHelper",null,[976,511]);var wG=d(1059);class My{}My.kJh="TabId";Object(m.a)(My,"RibbonSQMProperties",null,[]);class mB{constructor(a){this.Ca=a;this.Ca.ya(F.a.Hqd,ye.a.frame,Object(H.a)(this,this.Hqd,"reportTabSwitch"));this.Ca.ya(F.a.fth,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.hth,
ye.a.frame,zf.ActionManager.Sg)}Hqd(a,b,c,f,l){this.Ca.processAction(this.qtj(l[My.kJh]),2);return 32}}Object(m.a)(mB,"RibbonSQMInformation",null,[982]);class Nh{}Nh.oJc="PptRibbon.AddIns";Nh.animations="PptRibbon.Animation";Nh.design="PptRibbon.Design";Nh.FQc="PptRibbon.Developer";Nh.eZc="PptRibbon.Graphics";Nh.help="PptRibbon.Help";Nh.home="PptRibbon.Home";Nh.insert="PptRibbon.InsertTab";Nh.picture="PptRibbon.PictureFormat";Nh.review="PptRibbon.Review";Nh.shape="PptRibbon.DrawingFormat";Nh.slideShow=
"PptRibbon.SlideShow";Nh.smartArt="PptRibbon.SmartArt";Nh.PJh="ContextualTabs.Tables.Design";Nh.tableLayout="ContextualTabs.Tables.Layout";Nh.I2a="PptRibbon.Transition";Nh.view="PptRibbon.View";Object(m.a)(Nh,"MLRTabIds",null,[]);class Oj{}Oj.oJc="AddIns";Oj.animations="Animations";Oj.design="Design";Oj.FQc="Developer";Oj.draw="Draw";Oj.eZc="Graphics";Oj.help="Help";Oj.home="Home";Oj.insert="Insert";Oj.picture="FormatPicture";Oj.review="Review";Oj.shape="FormatShape";Oj.slideShow="SlideShow";Oj.smartArt=
"SmartArtDesign";Oj.table="Table";Oj.I2a="Transitions";Oj.view="View";Object(m.a)(Oj,"SLRTabIds",null,[]);class xG extends mB{constructor(a){super(a)}X8k(){this.Ca.ya(F.a.Ssh,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.Tsh,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.Ush,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.Vsh,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.Xsh,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.Ysh,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.Zsh,ye.a.frame,zf.ActionManager.Sg);
this.Ca.ya(F.a.$sh,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.ath,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.bth,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.cth,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.dth,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.eth,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.eYe,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(ea.a.gth,ye.a.frame,zf.ActionManager.Sg);this.Ca.ya(F.a.ith,ye.a.frame,zf.ActionManager.Sg)}qtj(a){let b=F.a.hth,c="PptRibbon.Unknown";
switch(a){case Nh.oJc:case Oj.oJc:c=Nh.oJc;b=F.a.Ssh;break;case Nh.animations:case Oj.animations:c=Nh.animations;b=ea.a.Tsh;break;case Nh.design:case Oj.design:c=Nh.design;b=ea.a.Ush;break;case Nh.FQc:case Oj.FQc:c=Nh.FQc;b=F.a.Vsh;break;case Oj.draw:c=a;b=ea.a.Wsh;break;case Nh.eZc:case Oj.eZc:c=Nh.eZc;b=ea.a.Xsh;break;case Nh.help:case Oj.help:c=Nh.help;b=F.a.Ysh;break;case Nh.home:case Oj.home:c=Nh.home;b=F.a.Zsh;break;case Nh.insert:case Oj.insert:c=Nh.insert;b=F.a.$sh;break;case Nh.picture:case Oj.picture:c=
Nh.picture;b=ea.a.ath;break;case Nh.review:case Oj.review:c=Nh.review;b=F.a.bth;break;case Nh.shape:case Oj.shape:c=Nh.shape;b=ea.a.cth;break;case Nh.slideShow:case Oj.slideShow:c=Nh.slideShow;b=ea.a.dth;break;case Nh.smartArt:case Oj.smartArt:c=Nh.smartArt;b=ea.a.eth;break;case Nh.PJh:case Nh.tableLayout:c=a;b=ea.a.eYe;break;case Oj.table:c=Nh.PJh;b=ea.a.eYe;break;case Nh.I2a:case Oj.I2a:c=Nh.I2a;b=ea.a.gth;break;case Nh.view:case Oj.view:c=Nh.view,b=F.a.ith}if(a=Kc.a.Kb)a.actionName=c,a.Qj=!0,a.$p=
!1;return b}}Object(m.a)(xG,"PPTWebEditorRibbonSQMInformation",mB,[]);var Cv=d(942);class nB{constructor(){this.rSb=null}rPl(){this.rSb||(this.rSb=Fb.a.instance.rb("Common.App.AccountSwitching.IAccountSwitching"))||ha.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}Ocj(){this.rPl();return this.rSb?this.rSb.getCustomAuthConfig():null}static cZj(){return w.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}Object(m.a)(nB,"ReactSharedHeaderAccountSwitchingUtils",
null,[]);class oB{constructor(){this.wdc=this.cultureName=null}}Object(m.a)(oB,"HeaderCultureInfo",null,[]);var Ny=d(684);class yG{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(yG,"SearchInitializationSettings",null,[]);var zG=d(360);class AG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=
!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(AG,"DocumentTitleAppProps",null,[]);class BG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(BG,"DocumentTitleCalloutAppProps",
null,[]);class CG{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=
this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(CG,"HeaderAppProps",null,[]);class DG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(DG,"HeaderControls",
null,[]);class EG{constructor(){this.command=this.label=null}}Object(m.a)(EG,"WorkflowButtonAppProps",null,[]);var Oy;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(Oy||(Oy={}));Object(m.b)("RenameDisableReason",Oy);class FG{constructor(a=""){this.i_e=this.documentTitleAppProps=this.Kbf=null;this.Y$h=
""!==a?a:hh.a.EP}zsj(a){const b=Fb.a.instance.rb("Common.IExternalUICommandDefinitionMapping").HEa(a);if(b&&0<b.length)return b[0].externalUxCommand;ha.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",a));return null}Pfe(){if(!this.Kbf){const a=Cv.a();if(a){const b=this.zsj(a.command);b&&(this.Kbf=Object.assign(new EG,{command:b,label:a.label}))}}return this.Kbf}dhj(){return Object.assign(new DG,{workflowButton:this.Pfe()})}XGk(){Sd.a.get_instance().dI(17)}onMove(){const a=
{};a.MoveButtonClickedTime=new Date;w.AFrameworkApplication.Qa.Ja(F.a.$hb,2,a)}btj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}jjj(){let a=null,b=null;var c=Fb.a.instance.rb("Common.IRenameProps");c?(c=c.acg(),0!==c&&(a=this.btj(c),b=Oy[c])):ha.ULS.sendTraceTag(572375621,
340,15,"IRenameProps not yet initialized");return Object.assign(new BG,{breadcrumbBrandName:w.AFrameworkApplication.ju.breadcrumbBrandName,breadcrumbBrandUrl:w.AFrameworkApplication.ju.breadcrumbBrandUrl,breadcrumbFolderName:w.AFrameworkApplication.ju.breadcrumbFolderName,breadcrumbFolderUrl:w.AFrameworkApplication.ju.breadcrumbFolderUrl,hideDocumentTitleInput:w.AFrameworkApplication.Aa.mb.oMj,isVersionHistoryEnabled:this.Kyl(),documentExtension:na.a.IQ(w.AFrameworkApplication.fileName),isMoveEnabled:32===
w.AFrameworkApplication.Qa.processAction(F.a.$hb,1),onMove:Object(H.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:w.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}w8f(){if(!this.documentTitleAppProps){const a=w.AFrameworkApplication.ju.rx;this.documentTitleAppProps=Object.assign(new AG,{documentTitle:w.AFrameworkApplication.oRc?a:na.a.mH(a),onFirstRender:Object(H.a)(this,this.XGk,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(H.a)(this,this.jjj,
"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Kyl(){return!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Ztg}Rwl(){return!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.$6j}uyl(){const a=!Cv.b()&&!w.AFrameworkApplication.hideHeader&&!w.AFrameworkApplication.Bjg&&(w.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||w.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));ha.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}KKi(a){appChrome.getHeaderApi().then(b=>
{b.setNavBarData(a.result);return null});ha.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}k7k(){appChrome.getHeaderApi().then(a=>{const b=Fb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});
a.setHeaderCommandHandler("SetCookie",c=>Ti.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.ehj(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(H.a)(this,this.Pfe,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(H.a)(this,this.w8f,"getDocumentTitleAppProps"));a.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.YGk();return null});Ny.a.N3c()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",
Object(H.a)(this,this.zcg,"getSearchInitializationSettings"))})}YGk(){Fb.a.instance.Ia("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.$pa(!1,w.AFrameworkApplication.Qa.mode)})}ehj(a){a=Ti.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}Dxj(){return zG.AppChromeOverrideUtilities.isEnabled?zG.AppChromeOverrideUtilities.getPath("suiteux-shell",!1):this.Y$h+w.AFrameworkApplication.Z1+"suiteux-shell"}onFirstRender(){Fb.a.instance.Ia("Common.App.O365Shell.IO365ShellActor").execute(a=>
{a.cwl.continueWith(Object(H.a)(this,this.KKi,"continueShellServiceDataAsync"),3)});Sd.a.get_instance().dI(15)}onFullyLoaded(){Sd.a.get_instance().dI(16)}jsj(){a:{try{var a=ab.a.He(w.AFrameworkApplication.lcid);if(a){var b=Object.assign(new oB,{cultureName:a.name,wdc:a.wdc});break a}}catch(c){ha.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+w.AFrameworkApplication.lcid.toString())}b=Object.assign(new oB,{cultureName:"en-us",wdc:"en"})}a=Fb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");
b=Object.assign(new CG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.wdc,isConsumer:!w.AFrameworkApplication.eAd,showAppLauncher:Cv.f(),showMeControl:Cv.e(),hideUserName:w.AFrameworkApplication.Qhe,defaultDocumentTitleToLeft:w.AFrameworkApplication.ETf,assetsContainerOverride:this.Dxj(),controls:this.dhj(),documentTitleAppProps:this.w8f(),showDocumentTitleControl:!0,showWorkflowButton:!!this.Pfe(),showChatControl:this.uyl(),showGoPremiumControl:Cv.g(),showDiscoverPremiumButton:Cv.d(),
enableSearchControl:Ny.a.w6j(),onFlexPaneOpen:Object(H.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(H.a)(a,a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.Rwl(),testTraffic:w.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(H.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(H.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:w.AFrameworkApplication.Swl()});!w.AFrameworkApplication.Mnb||w.AFrameworkApplication.D4e?
(b.userDisplayName=w.AFrameworkApplication.userName,b.emailAddress=w.AFrameworkApplication.fa.Ha("UserPrincipalName"),b.userID=w.AFrameworkApplication.fa.Ha("Puid")||"",b.signOutLink=w.AFrameworkApplication.D4e):w.AFrameworkApplication.signInUrl&&(b.signInLink=w.AFrameworkApplication.signInUrl);Ny.a.N3c()&&(a=this.zcg(),b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=w.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),
b.userRing=a.userRing);nB.cZj()&&(a=new nB,b.shellAuthProviderConfigPromise=Object(H.a)(a,a.Ocj,"getAccountSwitchingConfig"));this.k7k();w.AFrameworkApplication.Oea("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return b}zcg(){if(!this.i_e){const a=new Ny.a;let b=w.AFrameworkApplication.fa.Ha("Microsoft365Ring");b&&b.length||(b="generalAudience");this.i_e=Object.assign(new yG,{loadTellMeResources:a.tdk(),getTokenRequestDictionary:Object(H.a)(a,a.bzj,"getTokenRequestDict"),
userRing:b})}return this.i_e}}Object(m.a)(FG,"ReactSharedHeaderPropsHelper",null,[1051]);var Jg=d(354),BQ=d(1279),CQ=d(1111);d(943);var GG=d(683);const hu=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},HG=(a,b,c,f)=>{if(a&&a.parentNode&&a.parentNode.parentNode){var l=(l=tf.a.wt(a))?Ga.a.YM(l.paddingLeft)+Ga.a.YM(l.paddingRight):0;var y=tf.a.wt(a.parentNode);y=y?Ga.a.YM(y.paddingLeft)+Ga.a.YM(y.paddingRight):0;let G=0,R=a;for(;R.nextSibling;)R=R.nextSibling,G+=R.offsetWidth;l=l+y+G;"auto"!==a.parentNode.style.width&&
(a.style.width=a.parentNode.offsetWidth-l+"px");y=f?c:b;c=f?b:c;f=Cd.a.mi(a.parentNode.parentNode);b=y?Cd.a.mi(y):new Sys.UI.Bounds(f.x,0,0,0);c=c?Cd.a.Z$a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=Cd.a.mi(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Py=a=>{a&&jr(a)&&(a.style.display="",a._isHidden="0")},xl=a=>{a&&!jr(a)&&(a.style.display="none",a._isHidden="1")},jr=a=>
{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},Ys=(a,b,c)=>{if(a&&!jr(a)){var f=tf.a.wt(a);f=Ga.a.YM(f.paddingLeft)+Ga.a.YM(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=tf.a.wt(b))&&(l+=Ga.a.YM(f.paddingLeft)+Ga.a.YM(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},Yr=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},DQ=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,top:l}=Cd.a.D8f(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position=
"absolute",a.style.left=b+"px")}},Gq=(a,b,c)=>!a||!b||jr(a)||jr(b)?!1:Cd.a.$wg(Cd.a.mi(a),Cd.a.mi(b),c),Zs=(a,b,c)=>{let f=0;a&&b&&(f=Cd.a.cte(Cd.a.mi(a),Cd.a.mi(b),c));return f};var $s=d(370);class Qy{constructor(a,b,c){this.Mwb=this.F5b=this.Lwb=this.N9a=this.MRc=this.E5b=this.iH=this.D5b=this.VSa=this.EQ=this.NRc=this.USa=this.Bda=this.Dv=this.zL=this.DT=this.TSa=this.M9a=this.L9a=this.cEa=null;this.ES=a;this.nUb=b;this.nl=c}Wjl(a){this.ES=a;this.nUb=null;this.$8d(this.ES);this.GOh();this.Nwh()}c1a(){this.ES&&
this.nUb&&this.nUb.clientHeight&&(this.$8d(this.ES),this.GOh(),this.Nwh(),-1!==this.nUb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.x2f(this.nUb),this.tQl(),this.$jl()))}$8d(a){if(a)for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=Ga.a.Lka(f),y=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.cEa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.L9a=f;else if(f.id===Pm.CuiHelper.NXd)this.M9a=f;else if(f.id===Pm.CuiHelper.P3f)this.TSa=f;else if(f.id===
Pm.CuiHelper.OXd)this.DT=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.zL=f;else if(f.id===Pm.CuiHelper.PXd)this.Dv=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.Bda=f;else{var b;if(b=y)b=f,b=!!b.id&&(b.id.startsWith(Pm.CuiHelper.s2e)||b.id.startsWith(Pm.CuiHelper.Eqd));b?this.USa=f:y&&f.id.startsWith(Pm.CuiHelper.SCl)?this.NRc=f:-1!==l.indexOf("UsernameNameContainer")?this.EQ=f:-1!==l.indexOf("UsernameNameItem")&&(this.VSa=f)}this.$8d(f)}}GOh(){var a=[this.zL,this.Dv,this.EQ],b=[this.L9a,
this.M9a,this.TSa,this.DT,this.zL,this.Dv,this.Bda,this.USa,this.NRc,this.EQ];for(const c of b)Py(c);for(const c of a)Yr(c);if(a=this.zL)a.style.position="static",a.style.left="auto"}Nwh(){this.b1d()?this.Yjl():this.Zjl();var a=this.TSa,b=this.DT;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}Yjl(){let a;const b=this.qbe();a=[()=>{Ys(this.DT,this.DT,Zs(this.cEa,b,this.nl))},()=>{xl(this.L9a);xl(this.M9a);xl(this.TSa);xl(this.DT)}];hu(a,()=>Gq(this.DT,b,this.nl));Gq(this.iH,this.zL,
this.nl)&&DQ(this.zL,this.iH,this.nl);this.fuh();a=[()=>{Ys(this.EQ,this.VSa,Zs(this.iH,this.Bda,this.nl))},()=>{xl(this.USa)}];this.guh();jr(this.zL)||jr(this.Dv)||HG(this.Dv,this.iH,this.Bda,this.nl)}Zjl(){const a=!!this.DT,b=!!this.Dv;let c=0;if((a||b)&&0<(c=Zs(this.cEa,this.zL,this.nl))){let f=a;b&&(!a||this.Dv.offsetWidth>this.DT.offsetWidth)&&(f=!1);Ys(f?this.DT:this.Dv,f?this.DT:this.Dv,f?c:2*c);a&&b&&0<(c=Zs(this.cEa,this.zL,this.nl))&&(f=!f,Ys(f?this.DT:this.Dv,f?this.DT:this.Dv,f?c:2*c))}hu([()=>
{xl(this.L9a);xl(this.M9a);xl(this.TSa);xl(this.DT);Yr(this.Dv)},()=>{Ys(this.Dv,this.Dv,2*Zs(this.cEa,this.zL,this.nl))},()=>{xl(this.Dv)}],()=>Gq(this.cEa,this.zL,this.nl));this.fuh();this.guh();jr(this.zL)||jr(this.Dv)||HG(this.Dv,this.cEa,this.Bda,this.nl)}fuh(){const a=jr(this.Dv);hu([()=>{this.LYe()},()=>{xl(this.USa);Yr(this.Dv);Yr(this.EQ);a||Py(this.Dv)},()=>{this.LYe()},()=>{xl(this.NRc);Yr(this.Dv);Yr(this.EQ);a||Py(this.Dv)},()=>{this.LYe()}],()=>Gq(this.zL,this.Bda,this.nl))}LYe(){const a=
!!this.Dv,b=!!this.EQ;let c=0;if((a||b)&&0<(c=Zs(this.zL,this.Bda,this.nl))){const f=!!this.zL&&"absolute"!==this.zL.style.position;let l=a;b&&(!a||this.EQ.offsetWidth>this.Dv.offsetWidth)&&(l=!1);Ys(l?this.Dv:this.EQ,l?this.Dv:this.VSa,l&&f?2*c:c);a&&b?(0<(c=Zs(this.zL,this.Bda,this.nl))&&(l=!l,Ys(l?this.Dv:this.EQ,l?this.Dv:this.VSa,l&&f?2*c:c)),Gq(this.zL,this.Bda,this.nl)&&(xl(this.zL),Yr(this.EQ))):a&&Gq(this.zL,this.Bda,this.nl)&&xl(this.Dv)}}guh(){const a=()=>{Ys(this.EQ,this.VSa,Zs(this.cEa,
this.Bda,this.nl))};hu([a,()=>{xl(this.USa);Yr(this.EQ)},a,()=>{xl(this.NRc);Yr(this.EQ)},a,()=>{xl(this.EQ)}],()=>Gq(this.cEa,this.Bda,this.nl))}b1d(){if(!this.iH)return!1;for(let a=0;a<this.iH.childNodes.length;a++)if(-1!==Ga.a.Lka(this.iH.childNodes[a]).indexOf("cui-cg"))return!0;return!1}qbe(){if(!this.iH)return null;let a=null;for(let b=this.iH.childNodes.length-1;0<=b;b--){const c=this.iH.childNodes[b];if(-1===Ga.a.Lka(c).indexOf("cui-cg"))break;a=c}return a}x2f(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=
a.childNodes[b],f=Ga.a.Lka(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.D5b=c:-1!==f.indexOf("cui-tts")?this.iH=c:-1!==f.indexOf("cui-TabRowInline")?this.E5b=c:-1!==f.indexOf("cui-separator")?this.MRc=c:l&&c.id.startsWith(Pm.CuiHelper.kfh)?this.N9a=c:l&&c.id.startsWith(Pm.CuiHelper.o1f)?this.Lwb=c:-1!==f.indexOf("cui-TabRowRight")?this.F5b=c:l&&c.id.startsWith(Pm.CuiHelper.nQe)&&(this.Mwb=c);this.x2f(c)}}tQl(){var a=[this.iH,this.E5b,this.MRc,this.N9a,this.Lwb,this.F5b,this.Mwb];for(const b of a)Py(b);
this.zOb(0)}$jl(){let a;a=[()=>{xl(this.MRc);xl(this.N9a)},()=>{this.zOb(1)},()=>{this.zOb(2)},()=>{xl(this.E5b);this.zOb(0)}];hu(a,()=>Gq(this.iH,this.E5b,this.nl));a=[()=>{xl(this.MRc);xl(this.N9a)},()=>{xl(this.Lwb)},()=>{xl(this.Mwb)},()=>{xl(this.F5b)}];hu(a,()=>Gq(this.E5b,this.F5b,this.nl)||Gq(this.iH,this.F5b,this.nl));a=[()=>{this.zOb(1)},()=>{this.zOb(2)},()=>{xl(this.iH)}];hu(a,()=>Gq(this.D5b,this.iH,this.nl))}zOb(a){this.iH&&(this.iH.className=Qy.ZHl[a],this.iH._scaleStep=a)}}Qy.ZHl=
["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(m.a)(Qy,"TopBarScalingManager",null,[]);class IG{constructor(a,b){this.ES=this.dBa=null;this._clientId=a;this.htf=b}Q2i(){if(!Ck.b(this.ES))return this.ES;this.V1i();this.ES.style.display="block";this.htf&&this.htf.q8(Object(H.a)(this,this.onResize,"onResize"));return this.ES}onResize(){this.c1a()}c1a(){this.p1i()?(document.getElementById("application").style.minWidth="0px",(new Qy(this.ES,null,w.AFrameworkApplication.isRtl)).Wjl(this.ES)):w.AFrameworkApplication.Aa.mb.uO||
GG.a.Xjl(this.ES,w.AFrameworkApplication.isRtl)}p1i(){return w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}V1i(){if(Ck.b(this.dBa)){var a;({t$b:a}=$s.a.YQb(!w.AFrameworkApplication.UT)).returnValue?(this.dBa=JA("div"),this.dBa.className=$s.a.A4i,this.dBa.id=Pm.CuiHelper.H7d,a.appendChild(this.dBa),this.M1i(),w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.kWa&&!w.AFrameworkApplication.UT&&this.P1i(),this.P2i()):w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ReactHeaderCrashLogs")&&
ha.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}P2i(){Ck.b(this.ES)&&(this.ES=JA("div"),this.ES.className=$s.a.TLl,this.ES.style.display="none",this.dBa.appendChild(this.ES))}M1i(){Sys.UI.DomElement.addCssClass(this.dBa,$s.a.B4i);if(w.AFrameworkApplication.isRtl){var a=this.dBa;if(!Ck.b(a)){var b=a.className;if(Ck.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}P1i(){Sys.UI.DomElement.addCssClass(this.dBa,
"FlexBoxLayout")}}Object(m.a)(IG,"HeaderSkeleton",null,[]);var EQ=d(1311),pB=d(1255);class qB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(qB,"CommandDefinition",null,[]);class JG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(JG,"CommandDefinitionMapping",null,[]);const FQ=a=>Object.assign(new JG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new qB,
{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):Object.assign(new qB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(F.a.we),addCommandToMaps:Object(H.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(H.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(H.a)(a,a.addTabToMap,"addTabToMap")});var KG=d(953);class LG{}Object(m.a)(LG,"RibbonInitState",null,[]);var GQ=d(470),MG=d(521);let at;class Np{static LNl(a){w.AFrameworkApplication.Aa.mb.Yog||(a.ShowCommentsTopBar=
!0);w.AFrameworkApplication.Aa.mb.Mog||(a.CatchUpWithChanges=!0)}static EMh(a){for(let b of Np.w1h)a[b]=!0}static TVl(a,b){var c=w.AFrameworkApplication.H$b;if(w.AFrameworkApplication.fa.gu(c)&&w.AFrameworkApplication.fa.Ha(c)){Np.EMh(b);c=w.AFrameworkApplication.fa.ty("HostDefinedUIControls");for(let f=0;f<c.length;f++)Np.UVl(a,b,c[f]);Np.GNl(b);Np.FNl(b)}}static UVl(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static GNl(a){a.HostMoreOptions=a.HostOpenInBrowser&&
a.HostOpenInClient&&a.HostDownload?!0:!1}static hva(){const a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.yK);return!!a&&"teams"===a.toLowerCase()}static zyl(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)}static dzl(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",
!1)}static FNl(a){Np.hva()&&(Np.zyl()&&(a.HostOpenInClient=!1),Np.dzl()&&(a.HostMoreOptions=!0))}}Np.w1h=(at=new Oa.a,at.add("HostOpenInClient"),at.add("HostConversation"),at.add("HostClose"),at.add("HostDownload"),at.add("HostOpenInBrowser"),at.add("HostMoreOptions"),at);Object(m.a)(Np,"CommandTrimmer",null,[]);class NG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(m.a)(NG,"ReactAsyncDispatcher",null,[]);class rB{}rB.noc="PageId";Object(m.a)(rB,"FileMenuSQMProperties",
null,[]);var sB=d(175);class OG{constructor(a,b){this.Aq=null;this.gGc=!1;this.sPa=0;this.mnf="";this.lDd={};this.mLd=a;this.Pd=b;this.Hqf=Object(H.a)(this,this.fOe,"onModalMouseWheel");this.ymf=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Q9;this.d3=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.$ua}lJb(){0<this.sPa?this.sPa++:(this.sPa++,w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>
{window.setTimeout(Object(H.a)(this,this.Blh,"pushTransientFocusScope"),0)}):this.Blh(),this.showModal())}Blh(){this.Pd&&this.Pd.cV(D.AFrame.qP,!0)}Xej(){const a=Zg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.ymf&&b.isActive&&1===b.state?"_ShyRibbon":"")}gzj(a){var b=0;if(this.d3){if(this.lDd[a])return this.lDd[a];(b=document.getElementById("BusinessBar"))||ha.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");
b=b?b.offsetTop:0;this.lDd[a]=b}return b}showModal(){if(!this.Aq)if(this.Aq=this.createElement("div"),this.Aq.setAttribute("id","ReactModalDiv"),this.Aq.style.position="absolute",this.Aq.style.bottom="0px",this.Aq.style.left="0px",this.Aq.style.right="0px",this.Aq.style.backgroundColor="white",this.Aq.style.opacity="0.0",this.d3){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.Aq)}else this.mLd.appendChild(this.Aq);a=this.Xej();if(a!==this.mnf){const b=this.gzj(a),c=appChrome.selectors.getShyState();
this.ymf&&c.isActive&&1===c.state&&Zg.a("getRibbonHeight")?this.Aq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Zg.f())):this.Aq.style.top=String.format("{0}px",b);this.mnf=a}this.Aq.style.display="block";this.Aq.style.visibility="visible";this.Aq.style.zIndex="1000";this.gGc||(window.addEventListener("wheel",this.Hqf,!0),this.O2c()?Wf.a.instance.ub(pa.a.aS,this.Aq,Object(H.a)(this,this.jkd,"onModalPointerUp")):Wf.a.instance.ub(pa.a.pointerDown,this.Aq,Object(H.a)(this,this.ikd,
"onModalPointerDown")),this.gGc=!0)}jJk(){this.sPa--;0<this.sPa||(0>this.sPa?this.sPa=0:this.Ljg())}ZMe(){this.sPa=0;this.X4d();this.Ljg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}Kjg(){this.Pd&&this.Pd.Ee&&this.Pd.Ee.name===D.AFrame.qP&&!w.AFrameworkApplication.De.Hw&&this.Pd.J1(D.AFrame.qP,!1);this.Aq&&(this.Aq.style.zIndex="-1",this.Aq.style.visibility="hidden",this.Aq.style.display="none");this.gGc&&(window.removeEventListener("wheel",this.Hqf,
!0),this.O2c()?Wf.a.instance.Bb(pa.a.aS,this.Aq,Object(H.a)(this,this.jkd,"onModalPointerUp")):Wf.a.instance.Bb(pa.a.pointerDown,this.Aq,Object(H.a)(this,this.ikd,"onModalPointerDown")),this.gGc=!1)}Ljg(){this.O2c()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Kjg()},0)}):this.Kjg()}ikd(){this.R4b();this.dWf();this.ZMe();this.KLa();return!0}jkd(){this.R4b();this.dWf();this.ZMe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.KLa()},0)});return!0}KLa(){4===w.AFrameworkApplication.Aa.mb.Ti&&
w.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?w.AFrameworkApplication.Aa.KLa():this.Pd.wf(D.AFrame.SW)}fOe(a){a.stopPropagation()}R4b(){const a=Fb.a.instance.rb("Common.IReactContextualUILauncher");a&&a.R4b()}X4d(){const a=Fb.a.instance.rb("Common.IReactContextualUILauncher");a&&a.X4d()}dWf(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.pGa&&(this.O2c()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}O2c(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(m.a)(OG,"ReactModalDiv",null,[]);var tn=d(543);class PG{constructor(a,b){this.D$h=a;this.FYh=b}}Object(m.a)(PG,"ReactExecuteCommandContext",null,[]);class Dv{}Dv.Color="Color";Dv.IndexColorSelected="ColorSelected";Object(m.a)(Dv,"ColorPickerCommandProperties",null,[]);var zo=d(947);class co{}co.SelectedFont="SelectedFont";co.Formatting="Format";co.RequestUpdateMru="RequestUpdateMru";co.FontPickerId="fontPickerId";co.IsPinned="IsPinned";co.Trigger="Trigger";Object(m.a)(co,"FontPickerCommandProperties",
null,[]);class qp{}qp.Trigger="FontTrigger";qp.Name="FontName";qp.Action="FontAction";qp.Level="FontLevel";qp.IsPinned="FontIsPinned";Object(m.a)(qp,"FontPickerLogProperties",null,[]);class nx{}nx.Rows="Rows";nx.Columns="Columns";Object(m.a)(nx,"InsertTableCommandProperties",null,[]);class un{}un.Alt="Alt";un.Number="Number";un.UnitType="UnitType";un.Text="Text";un.MaxValue="MaxValue";Object(m.a)(un,"SpinnerCommandProperties",null,[]);class QG{constructor(a,b,c,f,l,y,G,R,ja,za=null,Va=null){this.B5a=
null;this.Uuf=!1;this.zFd=[];this.rAc=-1;this.NHc=!1;this.nai=0;this.qTb=null;this.fsf=!1;this.dAc=null;this.Gof=!1;this.cQ=a;this.VPa=b;this.HOd=Object(sa.a)(1550,a);this.fm=c;this.Pd=f;l&&(this.B5a=new OG(l,f));this.Z8h=y;this.i0h=G;this.DN=za;this.Ca=R;this.o5a={};this.Ma=ja;this.Acf=Va;ja&&(ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||ja.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&yj.a.instance.XCf.CWR(()=>this.Uuf=!0);ja&&(a=this.Ma.Ha("CommandControlIdPairsForLoggingOverride")||
"")&&0<=a.trim().length&&({Su:this.qTb}=Nd.d(a));this.qTb||(this.qTb={})}get Fsd(){return!!window.appChrome&&!!appChrome.selectors}Twh(){-1!==this.rAc&&window.clearTimeout(this.rAc);this.rAc=window.setTimeout(()=>{for(this.rAc=-1;0<this.zFd.length;){if(Uj.a.instance.Hw){this.Twh();break}const a=this.zFd.shift();a&&this.executeCommand(a.D$h,a.FYh)}},0)}executeCommand(a,b){if(Uj.a.instance.Hw){if(this.Uuf){this.zFd.push(new PG(a,b));this.Twh();return}ha.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,b.modelType,ta.a.toJSON(b.payload));if(this.Ma.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.fm.getCommandByExternalUxId(a),f=b.modelType;this.Acf&&this.Acf.zek(a,b);c?this.F3i(a,c,f,b):this.G3i(a,f,b);this.WBi(b);this.uNl(b);this.Qxk(a,b)}}G3i(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.A_f(c,a);break;case "ButtonModel":this.C3i(c,a)}}jUl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;
break;case "ButtonPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;a.TerminalParentControlId=c.payload.terminalParentControlId;this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(b=!0,Ck.b(c.payload.dismissHostingSurfaceOnExecute)||(b=c.payload.dismissHostingSurfaceOnExecute),b&&this.fDa()):this.fDa();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;
case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}kUl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.fm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":a=this.fm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=
b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.fDa();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}F3i(a,b,c,f){var l=this.TTk(f,c),y=b.commandId;const G={},R={};switch(c){case "SplitButtonModel":if(this.R9b(f.payload,Object(H.a)(this,this.qVl,"updateSplitButtonMenuState"),l))return;G.MenuItemId=b.menuItemId;
this.M1e(f,G);break;case "StatefulSplitButtonModel":if(this.R9b(f.payload,Object(H.a)(this,this.uVl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?G.Color=c:"icon"===l&&(c=this.fm.getCommandByExternalUxId(c))&&(G.MenuItemId=c.menuItemId);break;case "FileMenu":G.MenuItemId=b.menuItemId;G.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.TEj(y,f.payload,a);break;case "TellMe":y=this.kUl(y,f,G);G.SourceControlId=
a;G.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.FJj(G,f):y=this.jUl(G,b,f,a,y);break;case "CompoundButtonModel":G.MenuItemId=b.menuItemId;G.CommandValueId=f.payload.commandValueId;G.SourceControlId=a;this.M1e(f,G);this.fDa();break;case "ToggleButtonModel":case "InkButtonModel":G.MenuItemId=b.menuItemId;G.SourceControlId=a;this.M1e(f,G);this.fDa();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":y=this.fm.getCommandByExternalUxId("FontPickerMenuOpen").commandId;
G[co.FontPickerId]=f.payload.launcherId;break;case "MenuClosePayload":y=this.fm.getCommandByExternalUxId("FontPickerMenuClose").commandId;G[co.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=aa.FontUtils.rG(c),G.CommandValueId=l,l=aa.FontUtils.qPc(l)):(c.data?(G.CommandValueId=c.data.fontToApply,G.MenuItemId=c.data.themeIndex,G[co.Formatting]=c.data):G.CommandValueId=c.name,l=c);G.SourceControlId=a;G[co.RequestUpdateMru]=
l;R[qp.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?aa.FontUtils.z1c(c)?"*"+c:aa.FontUtils.Koe(c)?"[EF]":"[MF]":"";R[qp.IsPinned]=f.payload.isPinned;R[qp.Level]=f.payload.level;this.Ote();break;case "FontPickerFontInfoRequestedPayload":G.CommandValueId=f.payload.font.name;G[co.Trigger]=f.payload.trigger;R[qp.Trigger]=f.payload.trigger;R[qp.Name]=f.payload.nameToLog;this.Ote();break;case "FontPickerFontPinningPayload":c=f.payload.isPinned;G.CommandValueId=f.payload.fontKey;G[co.IsPinned]=
c;R[qp.Name]=f.payload.nameToLog;R[qp.Action]=c?"pin":"unpin";R[qp.Level]=f.payload.level;this.Ote();break;default:return}break;case "ComboBoxModel":var ja=f.payload.type;switch(ja){case "MenuOpenPayload":case "MenuPopulatePayload":this.YOb(f.payload.launcherId,l)&&(y={},y[f.payload.launcherId]=c,this.VPa.$oc(y,Zg.g(f.payload)),this.o5a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=f.payload.newValue;if(!c)return;c.value?(G[zo.a.Value]=c.value,
G[zo.a.IsFreeForm]=!0):(G[zo.a.Value]=c.text,G.MenuItemId=c.key,G.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===ja&&(y=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":y=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=ta.a.JL(f.payload);for(ja of c)G[ja]=f.payload[ja];break;default:this.R9b(f.payload,Object(H.a)(this,this.cTl,"updateFlyoutAnchorMenuState"),l),G.launcherId=f.payload.launcherId}break;
case "InkFlyoutAnchorModel":this.R9b(f.payload,Object(H.a)(this,this.vTl,"updateInkFlyoutAnchorMenuState"),l);G.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":G[Dv.Color]=f.payload.selectedColorId;G.colorRGB=f.payload.color;break;case "ColorPickerPreviewPayload":y=b.commandPreviewId;G[Dv.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":y=b.commandRevertId;break;default:return}break;case "SpinButtonModel":G[un.Number]=
f.payload.value;G[un.UnitType]=Oe.a.k3b(f.payload.unitType.toLowerCase());G[un.Text]=f.payload.reservedValue;break;case "SliderModel":G[np.Value]=f.payload.value;break;case "InsertTableModel":G[nx.Rows]=f.payload.rows;G[nx.Columns]=f.payload.columns;break;case "CheckboxModel":G[Ih.a.On]=f.payload.checked;G.MenuItemId=b.menuItemId;G.TerminalParentControlId=f.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.R9b(f.payload,Object(H.a)(this,this.uUl,"updatePreviewGalleryMenuState"),
l)){G.launcherId=f.payload.launcherId;break}this.A_f(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":G.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":y={};y[f.payload.launcherId]=c;this.VPa.$oc(y,Zg.g(f.payload));this.o5a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":G.MenuItemId=f.payload.url;this.gfk(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":G.MenuItemId=
f.payload.assetId;G.SourceControlId=a;w.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(G.IsPremium=f.payload.isPremium||!1);this.hfk(f.payload.pageId);break;case "CoauthorGallery":G.RenderTime=f.triggerTime;break;case "PeopleWell":G.RenderTime=f.triggerTime;break;case "SyncStatus":G.SourceControlId=a;break;case "InputBoxModel":G.Text=f.payload.newValue;break;case "PersonaButtonModel":G.CommandValueId=f.payload.commandValueId;this.cHj(f.payload);break;case "MultiActionButtonModel":G.CommandValueId=
f.payload.commandValueId;G.Href=f.payload.href;G.SourceControlId=a;G.Type=f.payload.type;G.TerminalParentControlId=f.payload.terminalParentControlId;this.fDa();break;default:return}y&&!this.isShadowMenuOpen(f.payload)&&(f.payload&&"terminalParentControlId"in f.payload&&(G.ParentMenuId=f.payload.terminalParentControlId),G.CommandValueId||(G.CommandValueId=G.MenuItemId),b.legacyControlId&&(G.LegacyId=b.legacyControlId),G.SourceControlId||(G.SqmControlId=a),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&G.launcherId&&(b=this.fm.getCommandByExternalUxId(G.launcherId))&&(G.launcherCommandId=parseInt(b.commandId)),f.payload&&!Ck.b(f.payload.PRIReadinessCheck)&&(G.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.fsf=!0),f.payload&&!Ck.b(f.payload.shouldTakeFocus)&&(G[tn.a.iba]=f.payload.shouldTakeFocus),b=this.DTd(f,G),Ck.b(f.triggerTime)||(R.TriggerTime=f.triggerTime),f.payload&&!Ck.b(f.payload.userActionKey)&&(R.userActionKey=f.payload.userActionKey),this.s0e(R,f,a,y),this.HOd.executeCommand(y,
G,this.getSelectedTabId(),b,!0,()=>{this.MKe(G,a)},R,Zg.g(f.payload)))}s0e(a,b,c,f){if(this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&b.payload){const l=!Ck.b(b.payload.launcherId);c=this.mwh(this.Spj(l?b.payload.launcherId:c,f),f,!1);a.ControlId=c;const y=b.payload.inputMethod,G=b.payload.location;Ck.b(y)||Ck.b(G)||this.Fek(1===y,2===y||3===y||4===y,l||"TabSwitchPayload"===b.payload.type,c,G)}this.Ma&&this.Ma.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&
b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.mwh(b.payload.terminalParentControlId,f,!0))}Fek(a,b,c,f,l){this.dAc||(this.dAc={});const y=[];l=sB.a.V_("UILocation",l,2);Array.add(y,l);if(l=this.getSelectedTabId())l=sB.a.V_("Tab",l,2),Array.add(y,l);this.dAc[f]||(this.dAc[f]=1,b?c?this.WCb("DistinctUserInitiatedNavigationalCommand",y):this.WCb("DistinctUserInitiatedTerminalCommand",y):a&&this.WCb("DistinctUserInitiatedKeyboardCommand",y));b?c?this.WCb("UserInitiatedNavigationalCommand",
y):this.WCb("UserInitiatedTerminalCommand",y):a&&this.WCb("UserInitiatedKeyboardCommand",y)}WCb(a,b){kk.b(a,null,0,!0,0,b)}mwh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;ha.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}Spj(a,b){b=parseInt(b);b=zf.ActionManager.X_d(b)||zf.ActionManager.n7a(b)||"";return!Ck.b(b)&&
b in this.qTb?this.qTb[b]:100<a.length?"":a}Ote(){this.DN&&this.DN.execute(a=>{a.Fte("ModernFontPickerExperience")})}DTd(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[tn.a.Uu]=c);return c}MKe(a,b){const c=Object(sa.a)(D.AFrame,w.AFrameworkApplication.Aa);if(this.Pd&&this.jDh(a)){if(!this.Pd.Ee&&c){let f="null";if(a){const l=a.Value;delete a.Value;f=ta.a.toJSON(a);Ck.b(l)||(a.Value=l)}ha.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
b,f,c.wLa)}this.Pd.G3f()}(this.Pd&&this.Pd.Ee&&this.Pd.Ee.name!==D.AFrame.qP&&c&&this.Pd.Ee.name!==c.wLa||this.jDh(a))&&this.VFi(a)}jDh(a){return!!a&&!Ck.b(a[tn.a.iba])&&a[tn.a.iba]}VFi(a){tn.a.Uu in a&&1===a[tn.a.Uu]&&mx.ShyRibbon.GRa(1,0)}FJj(a,b){Zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.fDa();this.cQ.Zoc();if(this.Z8h&&this.Ca){const c={};c[My.kJh]=b.payload.tabId;this.Ca.Ja(F.a.Hqd,2,c,this.k9b(b));Ck.b(b.payload.inputMethod)||
(this.Ca.processAction(F.a.fth,2),this.NHc||this.gCl(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.fm.Vee(b);ha.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.DN&&b){const c=b+"TabSwitchActivity";this.DN.execute(f=>{f.Fte(c)})}}R9b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}cHj(a){a=a.type;"MenuOpenPayload"===a?w.AFrameworkApplication.MIh=!0:"MenuClosePayload"===a&&(w.AFrameworkApplication.MIh=
!1)}TTk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.fm.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.VPa.ZQe(f,b,a.payload))&&c in this.o5a&&delete this.o5a[c],a):!1}cTl(a,b){const c=a.launcherId;this.YOb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.uRb(b,c,Zg.g(a)))}vTl(a,b){const c=a.launcherId;this.YOb(c,b)&&(b=Zg.j("getInkFlyoutAnchorMenuItems")?
appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.uRb(b,c,Zg.g(a)))}uUl(a,b){const c=a.launcherId;this.YOb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.uRb(b,c,Zg.g(a)))}qVl(a,b){const c=a.launcherId;this.YOb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.uRb(b,c,Zg.g(a)))}uVl(a,b){const c=a.launcherId;this.YOb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.uRb(b,c,Zg.g(a)))}getSelectedTabId(){return this.Fsd?
appChrome.selectors.getSelectedTabId():null}uRb(a,b,c){this.VPa.$oc(a,c);this.o5a[b]=new Date}YOb(a,b){let c=!0;a in this.o5a&&(c=this.o5a[a].getTime()<this.cQ.o5c.getTime());return c&&!b&&this.Fsd}A_f(a,b){const c={};var f=a.payload.selectedGalleryId;const l=this.fm.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!Ck.b(a.payload.shouldTakeFocus)&&(c[tn.a.iba]=a.payload.shouldTakeFocus);this.Vqj(a.payload,
c);(f=this.k9b(a))||(f={});this.s0e(f,a,b,l.commandId);const y=this.DTd(a,c);this.HOd.executeCommand(l.commandId,c,this.getSelectedTabId(),y,!0,()=>{this.MKe(c,b)},f,Zg.g(a.payload))}}C3i(a,b){const c=this.fm.getCommandByExternalUxId(b);if(c){const f={};f.SourceControlId=b;f.MenuItemId=b;f.SqmControlId=b;a.payload&&!Ck.b(a.payload.shouldTakeFocus)&&(f[tn.a.iba]=a.payload.shouldTakeFocus);let l=this.k9b(a);l||(l={});this.s0e(l,a,b,c.commandId);const y=this.DTd(a,f);this.HOd.executeCommand(c.commandId,
f,this.getSelectedTabId(),y,!1,()=>{this.MKe(f,b)},l,Zg.g(a.payload))}}Vqj(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=a.character)}M1e(a,b){a.payload&&"toggled"in a.payload&&(b[Ih.a.On]=a.payload.toggled)}Qxk(a,b){"MenuOpen"===a?!this.B5a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.B5a.lJb():"MenuClose"===a&&this.B5a&&this.B5a.jJk()}fDa(){this.B5a&&this.B5a.ZMe()}k9b(a){let b=null;Ck.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}TEj(a,b,c){if(this.i0h&&
this.Ca){const f={};f[rB.noc]=c;this.Ca.Ja(F.a.Cel,2,f)}this.uRb(b.pageControlIdMap,a,Zg.g(b))}hfk(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(F.a.Sel,2);break;case "FileNewPage":this.Ca.processAction(F.a.Tel,2)}}gfk(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(F.a.Lel,2);break;case "FileOpenPage":this.Ca.processAction(F.a.Mel,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}gCl(a){if(w.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&
"Help"===a)this.DN.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.NHc=!0;else{if(w.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.DN.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.nai)){this.NHc=!0;return}w.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(F.a.gmb,2)&&(this.NHc=!0)}}WBi(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.fsf&&appChrome.PRIToastManager.dismissToast()}uNl(a){!this.Gof&&
this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",!1)&&(a=Zg.g(a.payload),31===a||14===a||15===a||2===a)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const b=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback");b&&b.execute(c=>{c.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.Gof=!0)}}Object(m.a)(QG,"ReactExecuteCommandHandler",null,[]);class RG{constructor(){this.fileMenu=null}get Iaf(){return 0}c1a(){}dta(){return!1}v2(){return!1}get yxh(){return null}iS(){}ooe(){return!1}nRa(){}aTa(){}refresh(){}get controls(){return null}$Nc(){}Zoc(){}get Xaa(){return null}set Xaa(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(m.a)(RG,"ReactRibbonExternal",null,[979,1539,1540]);var HQ=d(273);class SG{constructor(a,b,c,f){this.Pd=a;this.Ca=b;this.Hxf=c;this.yrb=f}initialize(){this.Ca.ya(F.a.zsc,ye.a.frame,Object(H.a)(this,this.Nuh,"ribbonMoveForwardAction"));this.Ca.ya(F.a.ysc,ye.a.frame,Object(H.a)(this,this.Muh,"ribbonMoveBackwardAction"));this.Ca.ya(F.a.lrd,ye.a.frame,Object(H.a)(this,this.Luh,"ribbonEscAction"));var a=$s.a.Aje(this.yrb,null,this.Hxf,!1);a.zJ=!0;this.WLb(a,F.a.zsc,F.a.ysc);a.bindAction(x.KeyInputManager.Va(B.a.AZ,
0),F.a.lrd);a=this.Pd.Ic(D.AFrame.qP);a.zJ=!0;this.WLb(a,F.a.gta,F.a.gta);ka.a.instance.ub(pa.a.mouseDown,this.Hxf,Object(H.a)(this,this.lLk,"onRibbonMouseDown"));a=HQ.a.instance;Zg.a("enterKeytipMode")&&a.jOb(this.yrb,()=>{appChrome.api.enterKeytipMode(!1)});Zg.a("exitKeytipMode")&&a.wtc(this.yrb,()=>{appChrome.api.exitKeytipMode();mx.ShyRibbon.GRa(1,0)});w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Q9&&(a=Object(sa.a)(t.FocusManager,this.Pd))&&a.yji(Object(H.a)(this,this.zHk,"onFocusScopeChanged"))}zHk(a,
b){if((a=Object(sa.a)(D.AFrame,w.AFrameworkApplication.Aa))&&b.a8g&&w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Q9){const c=appChrome.selectors.getShyState();c.isActive&&b.a8g.name===a.wLa&&mx.ShyRibbon.GRa(c.state,1)}}Nuh(){return 4}Muh(){return 4}Luh(){Zg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Q9&&appChrome.selectors.getShyState().isActive&&mx.ShyRibbon.GRa(1,0),this.Pd.wf(D.AFrame.SW));return 4}WLb(a,b,c){const f=
x.KeyInputManager.Va(B.a.$q,0),l=x.KeyInputManager.Va(B.a.$q,4);a.hw(f);a.hw(l);a.bindAction(f,b);a.bindAction(l,c)}lLk(a){a.nc&&a.nc.target&&"input"!==a.nc.target.tagName.toLowerCase()&&a.nc.preventDefault();return!1}dispose(){this.Ca.kK(F.a.zsc,ye.a.frame,Object(H.a)(this,this.Nuh,"ribbonMoveForwardAction"));this.Ca.kK(F.a.ysc,ye.a.frame,Object(H.a)(this,this.Muh,"ribbonMoveBackwardAction"));this.Ca.kK(F.a.lrd,ye.a.frame,Object(H.a)(this,this.Luh,"ribbonEscAction"))}}Object(m.a)(SG,"ReactRibbonFocusManager",
null,[108]);class tB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(m.a)(tB,"CommandSqmInfo",null,[]);var ke=d(526),ox=d(362),px;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=
7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(px||(px={}));Object(m.b)("GalleryType",px);class Wo{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(Wo,"CommonGalleryButtonProps",null,[]);class Ry extends Wo{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(Ry,"AdditionalTableStyleGalleryButtonProps",Wo,[]);class TG extends Ry{constructor(){super()}}Object(m.a)(TG,"AdditionalChangeColorsGalleryButtonProps",
Ry,[]);class UG extends Wo{constructor(){super();this.character=null}}Object(m.a)(UG,"AdditionalCharacterCodeGalleryButtonProps",Wo,[]);class VG extends Wo{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(VG,"AdditionalFontStyleGalleryButtonProps",Wo,[]);class WG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(WG,"AdditionalGalleryProperties",
null,[]);class XG extends Wo{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(XG,"AdditionalIconButtonProperties",Wo,[]);class YG extends Wo{constructor(){super();this.styleDisplayName=null}}Object(m.a)(YG,"AdditionalInkThicknessGalleryButtonProps",Wo,[]);class ZG extends Wo{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(ZG,"AdditionalListGallerButtonProps",
Wo,[]);class $G extends Wo{constructor(){super();this.text=null}}Object(m.a)($G,"AdditionalPageNumberGalleryButtonProps",Wo,[]);var Sy=d(682),vm=d(948),aH=d(1157);class uB{}uB.Text="Text";Object(m.a)(uB,"TextBoxCommandProperties",null,[]);var wm=d(301);const IQ=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(sa.a)(Object,c[a])){if((a=Object(sa.a)(String,c.value))&&a===b)return!1;a=Object(sa.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:
null;let f=null;for(let l=0;l<c.length;l++){const y=Object(sa.a)(Object,c[l]);if(Object(sa.a)(String,y.key)===a){f=y;break}}if(f&&Object(sa.a)(String,f.text)===b)return!1}}return!0},cH=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(Ty(a,c[Ih.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[Ih.a.On]));break;case "ComboBoxModel":if(w.AFrameworkApplication.fa&&(w.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!IQ(a,c[zo.a.Value]))break;(b=c[zo.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[zo.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[zo.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[co.SelectedFont]));break;case "SplitButtonModel":f.push(Ty(a,c[aH.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,
c[un.Number],Oe.a.l3b(c[un.UnitType]),c[un.Text],c[un.MaxValue],c[un.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[Dv.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[vm.a.Text]));break;case "CompoundButtonModel":c[Ih.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[Ih.a.Description]));Ih.a.On in c&&f.push(Ty(a,c[Ih.a.On]));break;case "SliderModel":c.snapToStep?
f.push(appChrome.actions.updateSliderSelectedValue(a,c[np.Value])):f.push(appChrome.actions.updateSliderValue(a,c[np.Value],c[np.MinValue]||0,c[np.MaxValue],c[np.Text]));break;case "FlyoutAnchorModel":Sy.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[Sy.a.ImageIsVisible]));Ih.a.On in c&&f.push(Ty(a,c[Ih.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[uB.Text]))}b=f;var l=Object(sa.a)(String,c[wm.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,
l));bH(a,c,f);b=f;(l=Object(sa.a)(Object,c[wm.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(sa.a)(String,c[wm.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[wm.a.Koh])?c[wm.a.Koh]:null)&&a.push.apply(a,c);return f}return null},iu=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),Ty=(a,b)=>appChrome.actions.toggleButton(a,b),bH=(a,b,c)=>{b=Object(sa.a)(String,b[wm.a.Icon]);void 0!==b&&
null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class dH{constructor(a,b,c,f){this.fm=f;this.tra=a;this.bL=b;this.zrb=c;this.lWb={}}cUk(a,b,c,f,l=null){const y=a.ExternalGalleryId||a.ExternalId;var G=a.ExternalId;f.push(y);if(appChrome.selectors.isControlDefined(y))a.GalleryStyle&&Zg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(y,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(y,Object.assign(new WG,{columns:a.Width,sections:[appChrome.api.gallerySection([],
G)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!w.AFrameworkApplication.fa&&(w.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Zg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){G=[];const ja=[],za=[],Va={};for(var R of a.GallerySections){G.push(appChrome.api.gallerySection([],R.SectionId,R.Title));0===c&&R.GalleryButtons&&
0<R.GalleryButtons.length&&(c=R.GalleryButtons[0].Type);f&&this.zbg(R.GalleryButtons,l,Va);const hb=this.yTd(ja,R.GalleryButtons,Va);ja.push.apply(ja,this.zde(hb,y,R.SectionId,!1,c,l,!0,Va));za.push.apply(za,hb)}b.push(appChrome.actions.setGallerySections(y,G));b.push.apply(b,ja);b.push.apply(b,this.Gbe(y,px[c],za,null,5===a.Type,!0,null,Va))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),R=f?this.zbg(a.GalleryItems,l,null):null,b.push.apply(b,this.zde(this.yTd(b,a.GalleryItems,
R),y,G,!1,c,l,!1,R))}Srj(a,b){const c=[];let f=null,l=!1;if(!a)return null;const y=this.tra.Yoc(this.bL,a.commandId,b);c.push(iu(a.externalUxCommand,!y));if(a.previewControlIds){const ja=[];for(let za=0;za<a.previewControlIds.length;za++){var G={},R=a.previewControlIds[za];G.SourceControlId=R;const Va=this.fm.getCommandByExternalUxId(R);this.EXc(Va||a,G);G[vm.a.On]&&(f=G.SourceControlId,G[vm.a.HighlightOn]&&(l=!0));bH(R,G,c);if(G=Object(sa.a)(ox.a,G[vm.a.GalleryButtonProps]))ja.push(G),y&&(R=this.tra.Yoc(this.bL,
G.Command,b),G.IsDisabled=!R)}0<ja.length&&c.push.apply(c,this.zde(this.yTd(c,ja),a.externalUxCommand,a.externalUxCommand,!0,ja[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(ha.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}yTd(a,b,c=null){const f=[],l=[];for(let G=0;G<b.length;G++){const R=b[G],ja=Ck.a(R.ExternalId)?R.Id:R.ExternalId;f.push(ja);const za=
c&&c[ja]?c[ja].result:-1;switch(R.Type){case 1:var y=R;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(ja,Object.assign(new UG,{disabled:-1!==za?1>(za&1):y.IsDisabled,character:y.Character,style:y.Style,title:y.Alt})));break;case 2:y=R;l.push(appChrome.api.createFontStylesGalleryButtonModel(ja,Object.assign(new VG,{disabled:-1!==za?1>(za&1):y.IsDisabled,styleDisplayName:y.LabelText,style:y.Style,title:y.Alt,previewStyleLabel:y.PreviewStyleLabel})));break;case 3:y=R;l.push(appChrome.api.createInkThicknessGalleryButtonModel(ja,
Object.assign(new YG,{disabled:-1!==za?1>(za&1):y.IsDisabled,styleDisplayName:y.LabelText,style:y.Style,title:y.Alt})));break;case 4:y=R;l.push(appChrome.api.createIconGalleryButtonModel(ja,Object.assign(new XG,{disabled:-1!==za?1>(za&1):y.IsDisabled,icon:[y.Icon],fullIconStyle:y.FullIconStyle,previewIconStyle:y.PreviewIconStyle,largePreviewIconStyle:y.LargePreviewIconStyle,label:y.LabelText,title:y.Alt})));break;case 5:y=R;l.push(appChrome.api.createListGalleryButtonModel(ja,Object.assign(new ZG,
{disabled:-1!==za?1>(za&1):y.IsDisabled,infoAtLevel:y.LevelInfo,ariaLabel:y.Alt})));break;case 6:y=R;l.push(appChrome.api.createTableStyleGalleryButtonModel(ja,Object.assign(new Ry,{disabled:-1!==za?1>(za&1):y.IsDisabled,tableCellStyles:y.TableCellStyles,tableStyles:y.TableStyles,title:y.Alt,columns:y.columns})));break;case 8:y=R;l.push(appChrome.api.createChangeColorsGalleryButtonModel(ja,Object.assign(new TG,{disabled:-1!==za?1>(za&1):y.IsDisabled,tableCellStyles:y.TableCellStyles,tableStyles:y.TableStyles,
title:y.Alt})));break;case 7:y=R,l.push(appChrome.api.createPageNumberGalleryButtonModel(ja,Object.assign(new $G,{disabled:-1!==za?1>(za&1):y.IsDisabled,text:y.Text,title:y.Alt})))}this.fm.addCommandToMaps(Object.assign(new ke.a(ja,R.Command),{queryCommandId:R.QueryCommand,menuItemId:R.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}zde(a,b,c,f,l,y=null,G=!1,R=null){const ja=[];f?ja.push(appChrome.actions.populateGalleryItems(b,a)):(this.lWb[b]=!1,G||(f=!0,appChrome.selectors.isControlDefined(b)&&
(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),ja.push.apply(ja,this.Gbe(b,px[l],a,null,5===l,f,y,R))),ja.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return ja}ilj(a){return this.Gbe(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}Gbe(a,b,c,f,l,y=!0,G=null,R=null){const ja=[];if(a in this.lWb){if(this.lWb[a])return delete this.lWb[a],ja;this.lWb[a]=!0}let za=
null,Va=-1;if(c)({X4f:Va,returnValue:za}=this.rzf(b,c,ja,y,G,R));else if(f)for(const hb of f)(c=({X4f:Va}=this.rzf(b,hb.galleryButtons,ja,y,null,R)).returnValue)&&(za=c);ja.push(appChrome.actions.updateGallerySelectedId(a,za));y&&ja.push(iu(a,!1));l&&0<Va&&ja.push(appChrome.actions.updateListGalleryTextDirection(a,2===Va));return ja}ybg(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.fm.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.EXc(a,f);c.result=a;c.props=
f;return c}zbg(a,b=null,c=null){c||(c={});for(const f of a)a=Ck.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.ybg(a,b);return c}rzf(a,b,c,f,l=null,y=null){let G,R=null;G=-1;let ja=!1;for(const Va of b){var za=this.glj(a);b=y&&y[Va]&&-1!==y[Va].result?y[Va]:this.ybg(Va,l);const hb=b.result;b=b.props;f&&c.push(iu(Va,1>(hb&1)));(za=cH(Va,za,b,hb))&&c.push.apply(c,za);b[vm.a.On]&&(R=Va,b[vm.a.HighlightOn]&&b[vm.a.HighlightOn]&&(ja=!0));void 0!==b[wm.a.labelText]&&null!==b[wm.a.labelText]&&(za=this.fm.getCommandByExternalUxId(Va),
c.push(appChrome.actions.setControlLabel(za.externalUxCommand,b[wm.a.labelText])));b[vm.a.IsRtl]&&0>G&&(G=b[vm.a.IsRtl])}ja&&(ha.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",R),c.push(appChrome.actions.highlightSelectedFontStyle(R)));return{returnValue:R,X4f:G}}glj(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";
case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}EXc(a,b){b.MenuItemId=a.menuItemId;return this.tra.Pmd(this.bL,this.zrb,a.commandId,a.queryCommandId,b)}}Object(m.a)(dH,"ReactGalleryPoller",null,[]);var Ao=d(929),JQ=d(594),Uy=d(811),KQ=d(813);class vB extends tg.a{constructor(){super()}get ControlType(){return 3}}
Object(m.a)(vB,"CompoundButtonProps",tg.a,[]);var LQ=d(949),Hq=d(593),eH=d(595),MQ=d(950);class fH{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(fH,"PopulateFontPickerDataProps",null,[]);var Zr=d(415);class gH extends Vo{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(gH,"OptionalCompoundButtonProperties",Vo,[]);class hH extends Vo{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(m.a)(hH,"OptionalErrorViewProperties",Vo,[]);class iH extends Vo{constructor(){super();this.isBanner=null}}Object(m.a)(iH,"OptionalLabelProperties",Vo,[]);class jH extends Vo{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(jH,"OptionalMultipActionButtonProperties",
Vo,[]);class kH extends Bv{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(kH,"OptionalPersonaButtonProperties",Bv,[]);class Vy extends Vo{constructor(){super();this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(Vy,"OptionalToggleButtonProperties",Vo,[]);var NQ=d(952),OQ=d(951),Wy=d(482);class lH{constructor(){this.PNf=this.actions=null;this.kTh=!1}}Object(m.a)(lH,"PopulateActions",null,[]);class wB{Hdg(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);
case "ToggleButtonModel":return this.nsj(a);case "InkButtonModel":return this.msj(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}nsj(a){const b={};b[Ih.a.On]=appChrome.selectors.getButtonToggleState(a);return b}msj(a){const b={};b[Ih.a.On]=Zg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);
return b}}Object(m.a)(wB,"ReactStatePropsSelector",null,[]);class Xy{constructor(a,b,c,f,l){this.tra=a;this.bL=b;this.zrb=c;this.fm=f;this.DQd={};this.m8h=new wB;this.c6a=l}RFh(a){const b=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&b in this.DQd}Ksj(a,b,c=null){const f=[],l={};if(!this.RFh(a)){const y=a.populationProps.populateQueryCommandId,G={};G.MenuId=a.externalUxCommand;G.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.tra.Pmd(this.bL,this.zrb,y,y,
G,this.xmj(c))&1))if("FontPickerModel"===b)this.DQd[y]=!0,f.push(Xy.Drj(a,G)),l[a.externalUxCommand]="FontPickerModel";else if(G.MenuItems)switch(this.DQd[y]=!0,b){case "ComboBoxModel":f.push(Xy.Brj(a,G));l[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.Xeg(a.externalUxCommand,b,G.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new lH,
{actions:f,PNf:l,kTh:this.isShadowMenuOpen(c)})}eag(a,b,c,f,l,y,G,R,ja=null){let za=null;const Va=[];Ck.b(a.Title)||(za=a.Title);for(let hb=0;hb<a.ControlList.length;hb++){const Cb=Object(sa.a)(OA.a,a.ControlList[hb]);if(!Cb||Cb.ExternalId)y&&this.qgj(Cb,y),b.push.apply(b,this.Crj(Cb,G,Va,l,c,f,ja))}return R?appChrome.api.menuSection(Va,za,a.Lang):null}Xeg(a,b,c,f,l=null){const y=[],G=[],R=[],ja=[];for(var za=0;za<c.MenuSectionList.length;za++){var Va=Object(sa.a)(el.a,c.MenuSectionList[za]);Va&&
(Va=this.eag(Va,y,a,b,ja,f,G,c.UpdateDynamically,l),c.UpdateDynamically&&R.push(Va))}za=null;c.MenuFooterSection&&(za=this.eag(c.MenuFooterSection,y,a,b,ja,f,G,c.UpdateDynamically,l));c.UpdateDynamically&&y.push(appChrome.actions.updateMenu(a,R,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,za,c.IsFlexLayout));0<G.length&&y.splice(0,0,appChrome.actions.addControls(G));0<ja.length&&Zg.d("setStatefulSplitButtonMruBypassControls")&&y.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,
ja));return y}qgj(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;case 7:b[a.ExternalId]="ColorPickerModel";a=Object(sa.a)(Uy.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}Crj(a,b,c,f,l,y,G=null){const R=[];switch(a.ControlType){case 14:w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",
!1)&&(f=Object(sa.a)(eH.a,a),null!=f.IsBanner&&f.IsBanner&&this.KTk(Object(sa.a)(eH.a,a),R,b,c));break;case 1:case 3:a=Object(sa.a)(tg.a,a);this.LTk(a,R,b,c);a.MenuItemsStatefulData&&Zg.d("setStatefulSplitButtonMenuItemsStatefulData")&&R.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,a.MenuItemsStatefulData));break;case 2:this.BUk(Object(sa.a)(Wy.a,a),R,b,c);break;case 6:this.OTk(Object(sa.a)(JQ.a,a),R,b,c);break;case 4:this.tUk(Object(sa.a)(BA,a),R,b,c);break;case 7:this.PTk(Object(sa.a)(Uy.a,
a),R,b,c);break;case 12:this.VTk(Object(sa.a)(LQ.a,a),R,b,c);break;case 13:this.nUk(Object(sa.a)(MQ.a,a),R,b,c);break;case 9:a=Object(sa.a)(AA.a,a);this.YTk(a,R,b,c);"StatefulSplitButtonModel"===y&&f.push(a.ExternalId);break;case 8:this.c6a.cUk(Object(sa.a)(Hq.a,a),R,b,c,G)}return R}KTk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,
a.IconName))):(b=null,a.IconName&&0<a.IconName.length&&(b=new op.a(a.IconName)),c.push(appChrome.api.createLabelModel(a.ExternalId,a.LabelText,a.Id,Object.assign(new iH,{isBanner:a.IsBanner,iconSet:b?b.iconSet:null}))))}LTk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&
b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.AKc()&&((c=this.Yta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new op.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Sa.a)(vB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new gH,{iconSet:(new op.a(this.Yta(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,
ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):(f=a.DismissHostingSurfaceOnExecute,c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new Bv,{iconSet:(new op.a(this.Yta(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==f&&null!==f?f:!0})))),this.fm.addCommandToMaps(Object.assign(new ke.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&Zg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}OTk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.AKc()&&((c=this.Yta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,
(new op.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Vy,{iconSet:(new op.a(this.Yta(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),
this.fm.addCommandToMaps(Object.assign(new ke.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}VTk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):(b=null,a.IconName&&0<a.IconName.length&&(b=new op.a(a.IconName)),c.push(appChrome.api.createErrorViewModel(a.ExternalId,
Object.assign(new hH,{label:a.Label,retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId,ariaDescription:a.AriaDescription,iconSet:b?b.iconSet:null}))))}nUk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(c={},a.Label&&(c.label=a.Label),a.SecondaryLabel&&(c.secondaryLabel=a.SecondaryLabel),a.Details&&(c.details=a.Details),a.Description&&(c.description=a.Description),a.iconSet&&(c.iconSet=a.iconSet),a.Links&&(c.links=a.Links),a.CommandValueId&&(c.commandValueId=
a.CommandValueId),a.ActionCommandValueId&&(c.actionCommandValueId=a.ActionCommandValueId),a.ActionCommandId&&(c.actionCommandId=a.ActionCommandId),a.CommandId&&(c.commandId=a.CommandId),b.push(appChrome.actions.updateMultiActionButton(a.ExternalId,c))):(c.push(appChrome.api.createMultiActionButtonModel(a.Id,Object.assign(new jH,{label:a.Label,secondaryLabel:a.SecondaryLabel,actionText:a.ActionText,description:a.Description,iconSet:a.iconSet,links:a.Links,details:a.Details,actionId:a.ActionId,commandId:a.CommandId,
actionCommandId:a.ActionCommandId||a.ActionId,commandValueId:a.CommandValueId,actionCommandValueId:a.ActionCommandValueId||a.CommandValueId}))),a.CommandIdMapped&&this.fm.addCommandToMaps(new ke.a(a.CommandId,a.CommandIdMapped)),a.ActionIdMapped&&this.fm.addCommandToMaps(new ke.a(a.ActionId,a.ActionIdMapped)))}BUk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.AKc()&&((c=this.Yta(a))&&
0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new op.a(c)).iconSet)),w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Vy,{iconSet:(new op.a(this.Yta(a))).iconSet,
iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Vy,{iconSet:(new op.a(this.Yta(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.fm.addCommandToMaps(Object.assign(new ke.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}tUk(a,
b,c,f){f.push(a.ExternalId);f=this.nrj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):Zg.a("createPersonaButtonModel")&&c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new kH,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}YTk(a,b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&
b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.AKc()&&((c=this.Yta(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new op.a(c)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;
const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new Ly,{iconSet:(new op.a(this.Yta(a))).iconSet,keytip:a.KeyTip,hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.fm.addCommandToMaps(Object.assign(new ke.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new Ao.a(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.Xeg(a.ExternalId,
"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}PTk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(f=this.m8h.Hdg(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.fm.addCommandToMaps(Object.assign(new ke.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,
commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.fm.addCommandToMaps(Object.assign(new ke.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));c=[];const l=[];for(let y=0;y<a.Colors.length;y++){const G=a.Colors[y];y<f?c.push(appChrome.api.colorPickerCell(G.Color,G.DisplayColor,G.Alt)):l.push(appChrome.api.colorPickerCell(G.Color,G.DisplayColor,G.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,
c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}Yta(a){return a.Image32by32Class?this.fm.N8f(a.Image32by32Class):a.Image16by16Class?this.fm.N8f(a.Image16by16Class):a.ExternalImageId}nrj(a){return a?Object.assign(new OQ.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,
isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new NQ.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}xmj(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}AKc(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",!1)}static Drj(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,f)=>{Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>
{l.isFeatureEnabled(Zr.a.IWa,!1).then(y=>{let G=b.fonts;y||l.isFreemiumUpsellEnabled()||(G=Ub.a.fqa(G,R=>R.fontType!==Zr.a.RRe));y=Object.assign(new fH,{commandId:a.externalUxCommand,fonts:G,isSubscriber:y,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});c(y)}).catch(f)})}))}static Brj(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+
f.toString(),l.Title));for(let y=0;y<l.ControlList.length;y++){const G=Object(sa.a)(KQ.a,l.ControlList[y]);G&&c.push(appChrome.api.comboBoxItem(G.MenuItemId,G.LabelText,G.Styles,G.CommandValueId,G.AriaLabel,G.Data,G.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(m.a)(Xy,"ReactPopulateQueryCommandPoller",null,[]);class mH{constructor(a,b,c,f,l){this.fm=
c;this.tra=a;this.bL=b;this.zrb=f;this.c6a=l}Jsj(a,b,c){const f=[];if(this.vYj(b))a=this.Owj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.EXc(a,c);wm.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[wm.a.visible]));f.push(iu(a.externalUxCommand,1>(l&1)));void 0!==c[wm.a.labelText]&&null!==c[wm.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[wm.a.labelText]));void 0!==b&&null!==b&&(l=cH(a.externalUxCommand,
b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.bgi(a.externalUxCommand,c,f))}return f}Pjj(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var y=appChrome.selectors.getSplitButtonState(a);if(y=this.fm.getCommandByExternalUxId(y.command))c=this.tra.Yoc(this.bL,y.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),f.push(iu(a,!1));return f;default:return null}b=
!1;for(y in l)if(l=this.fm.getCommandByExternalUxId(y),Ck.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.tra.Yoc(this.bL,l.commandId,c))return f.push(iu(a,!1)),f;f.push(iu(a,!b));return f}Owj(a,b,c){switch(b){case "PreviewGalleryModel":return this.c6a.Srj(a,c);case "GalleryModel":return this.c6a.ilj(c)}return null}vYj(a){return"GalleryModel"===a||"PreviewGalleryModel"===a}EXc(a,b){b.MenuItemId=a.menuItemId;return this.tra.Pmd(this.bL,this.zrb,a.commandId,a.queryCommandId,b)}bgi(a,b,
c){const f=b[Sy.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Sy.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.Lzj(a,b))}Lzj(a,b){return appChrome.actions.updatePeopleWell(this.Xfj(a),b)}Xfj(a){const b=[];var c={};a=this.fm.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.tra.Pmd(this.bL,this.zrb,"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=c.ControlList[a],l={};
l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(m.a)(mH,"ReactQueryCommandPoller",null,[]);class nH{Pmd(a,b,c,f,l,y){let G=0;a&&(this.Yoc(a,c,l)&&(G|=1),c=new tB,c.CommandLocation=b,void 0!==y&&null!==y&&(c.InvocationMethod=y),!Ck.b(f)&&a.O_f(f,l,c)&&(G|=2));return G}Yoc(a,b,c=null){return a?a.Acc(b,
c):!1}}Object(m.a)(nH,"RootPoller",null,[]);class oH{constructor(a,b,c){this.fm=a;this.bL=b;a=new nH;this.W$h=new wB;this.c6a=new dH(a,this.bL,c,this.fm);this.Dsf=new Xy(a,this.bL,c,this.fm,this.c6a);this.ysf=new mH(a,this.bL,this.fm,c,this.c6a)}rUa(){const a=[];if(!Zg.c())return a;a.push.apply(a,this.Jzj());var b=this.ajj();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),Object.keys(b).length){const c=this.bjj();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,
!0)),delete b[f];a.push.apply(a,this.EYc(b))}return a}$oc(a,b){Zg.c()&&(a=this.EYc(a,b),appChrome.api.dispatch(a))}ZQe(a,b,c=null){if(!Ck.b(a)&&a.populationProps&&!this.Dsf.RFh(a)){a=this.Dsf.Ksj(a,b,c);if(!a.kTh){let f;(f=a.actions).push.apply(f,this.EYc(a.PNf,Zg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}EYc(a,b=0){const c=[],f={};if(Zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&
""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var y of appChrome.selectors.getVisibleControlsInGroup(l))f[y]=!0;for(let G in a)l=G,y=a[G],0===b&&f[l]&&(b=2),c.push.apply(c,this.Izj(l,y,b));return c}Izj(a,b,c=0){const f=[],l=this.fm.getCommandByExternalUxId(a);let y={};appChrome.selectors.isControlDefined(a)&&(y=this.W$h.Hdg(a,b));y[tn.a.Vyd]=c;Ck.b(l)?(y.ExternalUxId=a,(a=this.ysf.Pjj(a,b,y))&&0<a.length&&f.push.apply(f,a)):(y.MenuItemId=l.menuItemId,
y.SourceControlId=a);f.push.apply(f,this.ysf.Jsj(l,b,y));return f}Jzj(){const a=[],b=!!w.AFrameworkApplication.fa&&(w.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());for(let y=0;y<c.length;y++){var l=this.fm.Vee(c[y]);if(l){l=this.bL.Acc(l);let G=!0;b&&(G=0<=
Array.indexOf(f,c[y]));b&&G===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[y],l))}}return a}ajj(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.fm.Vee(a);c&&(this.bL.Acc(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}bjj(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.fm.vlj(c))for(const f of a)this.bL.Acc(f.commandId)||((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),
b.push.apply(b,a));return b}}Object(m.a)(oH,"ReactRibbonRootPoller",null,[1549]);class qx{constructor(a,b,c=null){this.bL=this.xWb=this.VPa=null;this.j8h=b;a.Rsb(this);this.Xaa=c}get o5c(){this.xWb||(this.xWb=new Date,this.xWb.setTime(0));return this.xWb}set o5c(a){this.xWb=a}get Rhl(){return 2}get Xaa(){return this.bL}set Xaa(a){this.bL=a}get ULb(){this.VPa||(this.VPa=new oH(this.j8h,this.Xaa,this.Rhl));return this.VPa}$Nc(){const a=document.activeElement;Ga.a.isEditable(a)&&a.blur()}executeCommand(a,
b,c,f,l,y,G,R=2){Ck.b(this.Xaa)||(l=new tB,l.CommandLocation=R,l.InvocationMethod=f,l.CommandTabName=c,b[tn.a.Vyd]=R,this.Xaa.O_f(a,b,l,y,G),this.xek(a,b))}rUa(){return Ck.b(this.Xaa)?[]:this.ULb.rUa()}Zoc(){const a=this.rUa();0<a.length&&(this.o5c=new Date,appChrome.api.dispatch(a))}vRb(){Zg.c()&&this.ULb.$oc({PeopleWell:"PeopleWell"},18)}xek(a,b){try{const c=Fb.a.instance.rb("Common.ISystemInitiatedFeedback");if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?
"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.Fte("Ribbon"+l)}}catch(c){ha.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(m.a)(qx,"ReactRibbonRoot",null,[1540,1550]);class xB{constructor(){this.ura=[]}Rsb(a){a&&!Array.contains(this.ura,a)&&Array.add(this.ura,a)}Gqh(a){Array.remove(this.ura,a)}$Nc(){for(const a of this.ura)a.$Nc()}dispose(){this.ura=null}}Object(m.a)(xB,"RootManagerBase",null,[311,108]);class $r extends xB{constructor(){super()}static get instance(){return $r.La||
$r.HSj()}static HSj(){$r.La=new $r;return $r.La}}$r.La=null;Object(m.a)($r,"ReactRootManager",xB,[310,311]);class Op{constructor(a,b,c,f,l,y,G,R=null,ja=!0,za=null,Va=null){this.HUb=this.mIc=this.SDd=this.cQ=null;this.Luf=[];this.wGc=null;this.k6a=a;this.mLd=b;this.yrb=c;this.Pd=f;this.Ca=l;this.fm=y;this.cQ=za?za:new qx($r.instance,this.fm);this.h5a=G;this.Btf=new RG;this.aQa=R;this.MPd=ja;new NG;this.dif=Va;Sd.a.get_instance().Vj(7,Object(H.a)(this,this.ssl,"setRibbonPostInteractiveReady"));Sd.a.get_instance().Vj(7,
Object(H.a)(this,this.Hgk,"logRibbonLoadedActivity"));Sd.a.get_instance().Vj(19,Object(H.a)(this,this.kek,"logAppLoadedActivity"));Sd.a.get_instance().Vj(7,Object(H.a)(this,this.d9k,"registerSubComponentReporting"));Sd.a.get_instance().Vj(7,Object(H.a)(this,this.w0k,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.MPd||this.dI(5);c?c.then(()=>{this.lsh()}).catch(()=>ha.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):MG.a.cLh(MG.a.cLh(oo.Task.WAA(this.Gxg(a),
this.Fxg(Op.JYh)),()=>this.Fxg(Op.OWh)),()=>this.Gxg(b)).continueWith(()=>{this.lsh()},11)}dispose(){this.mQl();this.wGc&&this.wGc.dispose();for(const a of this.Luf)Sd.a.get_instance().LDi(a);w.AFrameworkApplication.Qa.kK(F.a.Nel,ye.a.frame,zf.ActionManager.Sg)}Fxg(a){return Fb.a.instance.resolve("Common.ISharedDependencyLoader").TCb(w.AFrameworkApplication.Ji(a,2))}Gxg(a){return""===a?oo.Task.ut(!0):Fb.a.instance.resolve("Common.ISharedDependencyLoader").TCb(w.AFrameworkApplication.Ji(a,3))}Ylg(){(this.aQa||
this.h5a)&&appChrome.api.dispatch(this.Seg());this.R1e();Zg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(w.AFrameworkApplication.Kpa);this.cQ.Zoc()}lsh(){this.Ylg();this.MPd&&(appChrome.renderAppChrome(this.k6a,Zg.e()),this.dI(10));this.Lyf();this.MLc();this.MPd&&this.dI(5);this.V_c()}V_c(){this.Pd&&this.Ca&&this.yrb&&(this.wGc=new SG(this.Pd,this.Ca,this.k6a,this.yrb),this.wGc.initialize())}get Dhl(){return this.Btf}setCommandDefinitionMapping(){if(Zg.a("setCommandDefinitionMapping")){const a=
FQ(this.fm);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Q9&&Zg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{0===b&&this.iKb()})}Lyf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(sa.a)(qx,this.cQ);this.SDd=new QG(this.cQ,a.ULb,this.fm,this.Pd,this.mLd,Fb.a.instance.rb("Common.IRibbonSQMInformation"),Fb.a.instance.rb("Common.IFileMenuSQMInformation"),
w.AFrameworkApplication.Qa,w.AFrameworkApplication.fa,Fb.a.instance.Ia("Common.ISystemInitiatedFeedback"),null);this.Isi();this.tDj()}Isi(){this.mIc=appChrome.api.bindCommandHandler((a,b)=>{this.SDd.executeCommand(a,b)})}mQl(){this.mIc&&(this.mIc(),this.mIc=null)}R1e(){appChrome.api.initializeLogger(new GQ.a)}rUa(){return this.cQ?this.cQ.rUa():[]}iKb(){Vf.a.instance.wG(()=>{let a=null;Vf.a.instance.wG(()=>{a=this.rUa()},"RB:GA");a&&0<a.length&&(this.cQ.o5c=new Date,Vf.a.instance.wG(()=>{appChrome.api.dispatch(a)},
"RB:DA"));this.HUb&&Vf.a.instance.wG(()=>{},"RB:J")},"RB:PFSU")}vRb(){this.cQ.vRb()}gdi(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}Seg(){var a=w.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>
{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));b.push.apply(b,this.T8f());a=new KG.a(this.fm);this.aQa.zba&&(Np.LNl(this.aQa.zba),b.push.apply(b,a.w$d(this.aQa.zba)));if(this.aQa.IMh)for(const c of this.aQa.IMh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.mbj,c.aF,c.NNl));b.push.apply(b,a.Scj(this.aQa.MNl));
return b}T8f(){const a=[];if(this.h5a&&this.h5a.zba){const c=this.h5a.zba;for(let f in c){var b=c[f];const l=this.fm.cbe(f);if(l)for(let y of l)a.push(appChrome.actions.updateControlHiddenState(y,b))}}return a}oRb(a){a&&this.cQ.ULb.$oc(a,0)}ZQe(a){this.cQ.ULb.ZQe(this.fm.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}zzl(a){Sd.a.get_instance().Vj(5,null).continueWith(()=>{appChrome.api.dispatch(this.Jvj(a))})}lYi(){const a=w.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?
"ShareMenu":"Share",b=w.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.dVl(a,"Shared"===(b.SharingStatus||"")))}w0k(){w.AFrameworkApplication.fa.$e(()=>{this.lYi()})}dVl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,b)}Jvj(a){return appChrome.actions.updateControlHiddenState(a,!1)}Kvj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}dI(a){Sd.a.get_instance().dI(a);this.Luf.push(a)}ssl(){Zg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new LG,
{postRibbonInteractiveReady:!0})))}MLc(){this.h5a&&this.dif&&(this.HUb=this.dif.createFileMenu(this.h5a,this.cQ.Xaa),this.Btf.fileMenu=this.HUb)}Wak(){this.HUb&&this.HUb.Rak()}nrd(a,b,c){if(1===c)return 32;this.Btc(!0);this.iKb();w.AFrameworkApplication.Aa.updateCommandUI();return 32}ord(a,b,c){if(1===c)return 32;this.Btc(!1);this.xsl();this.iKb();w.AFrameworkApplication.Aa.updateCommandUI();return 32}h9e(a,b,c){if(1===c)return 32;(a=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback"))&&a.execute(f=>
{f.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}xsl(){Ti.a.qK(w.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),"true",Ti.a.aK)}Btc(a){Ti.a.qK(w.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),a.toString(),Ti.a.aK)}Hgk(){if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Qp){const a=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),
w.AFrameworkApplication.iM("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),w.AFrameworkApplication.iM("69a7h198;dfd7j584"));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFreemiumUpsellEnabled()&&w.AFrameworkApplication.iM("5fjej882;e0jjh200")})}}W3e(){const a=
Fb.a.instance.Ia("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("SingleLineToolBarOptOut",null)});return 32}kek(){this.Ca.ya(F.a.h9e,ye.a.frame,Object(H.a)(this,this.h9e,"triggerModeSwitcherTUI"));this.Ca.ra(F.a.W3e,ye.a.frame,Object(H.a)(this,this.W3e,"showMultilineRibbonFromToolbar"),96);const a=Ti.a.S_(w.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const b=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback");b&&(w.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?
(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):w.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}d9k(){Sd.a.get_instance().Vj(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)w.AFrameworkApplication.Qa.MT(l)?
appChrome.api.reportRibbonSubComponentBehaviorMapped(b):w.AFrameworkApplication.Qa.irl(l,this.$Pi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}$Pi(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}tDj(){if(w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&
w.AFrameworkApplication.eKb.YSd){const a=w.AFrameworkApplication.eKb.YSd,b=w.AFrameworkApplication.eKb.uyf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:a;Op.prd.Gb(c)?Op.prd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.SDd.executeCommand(a,b))}}}Op.JYh="common";Op.OWh="appChrome";Op.prd=new EQ.a(pB.a.Afg());Object(m.a)(Op,"ReactRibbonUser",null,[299,139,108]);class yB{constructor(){this.label=
this.value=null}}Object(m.a)(yB,"TextInfoSectionField",null,[]);class pH{constructor(a,b){this.zba=b}}Object(m.a)(pH,"ReactRibbonJewelProperties",null,[]);class zB extends Op{constructor(a,b,c,f,l,y,G,R,ja=null,za=!0,Va=null,hb=null){super(a,b,f,l,y,G,R,ja,za,Va,hb);this.WBc=null;this.XBc=c;this.XBc.execute(Cb=>{this.WBc=Cb});this.XBc.execute(Cb=>{this.cQ.Xaa=Cb})}rUa(){return this.WBc?(this.WBc.clearCache(),super.rUa()):[]}}Object(m.a)(zB,"ReactRibbonUser",Op,[]);var AB=d(913),as=d(193),BB=d(382),
PQ=d(732),CB=d(1153);class rx{static get Fug(){return"teams"===(w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.yK)||"").toLowerCase()}static get MCh(){return rx.Fug?(ya.a.J(576030427,811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",w.AFrameworkApplication.uTa,w.AFrameworkApplication.Gvb),w.AFrameworkApplication.uTa&&w.AFrameworkApplication.Gvb):w.AFrameworkApplication.uTa}}Object(m.a)(rx,"CopyLinkHelper",null,[]);class qH{constructor(a,b){this.KIe=null;this.la=a;this.auk=b}dispose(){this.KIe&&
(Pm.CuiHelper.OYi(this.KIe),this.KIe=null)}hzj(){if(w.AFrameworkApplication.workflowEnabled){let a="";switch(w.AFrameworkApplication.nyc){case "Assign":a=CommonUIStrings.l_Assign;break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new CB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return w.AFrameworkApplication.Rqe&&w.AFrameworkApplication.J0a||w.AFrameworkApplication.Rxc?Object.assign(new CB.a,{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:Pm.CuiHelper.Eqd}):
w.AFrameworkApplication.uTa?Object.assign(new CB.a,{command:"981334692",label:ResourceStrings.L_Share,image:Pm.CuiHelper.Mvl,id:Pm.CuiHelper.s2e}):null}ryl(){if(rx.Fug&&!this.auk)return!1;const a=this.hzj();return a&&"981334692"===a.command?this.la.btg||this.la.S4j:!1}vyl(){ya.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",w.AFrameworkApplication.uTa,w.AFrameworkApplication.Gvb);return w.AFrameworkApplication.uTa&&(w.AFrameworkApplication.Gvb||w.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}
Object(m.a)(qH,"CuiControlUser",null,[108]);class rH extends zB{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){super(b,a.mka,f,xa.a.Waa,l,y,G,null,za,!0,null,Cb);this.CBg=this.pec=this.LAg=this.jEb=this.oIa=this.la=this.jh=this.lXa=this.bed=this.Hwe=this.lBe=null;this.fMg=!1;this.J8=0;this.hCe=this.dad=this.E$=!1;this.Wu=this.Fcd=this.xgb=null;b=new BB.a("ReactRibbonUser::InitPptReactRibbon",!1);try{this.oIa=hb,this.la=Va,this.Hwe=new qH(this.la,ic.ka("ShareMenuIsEnabled")),this.lBe=
a,this.bed=ja,this.jEb=G,this.lXa=R||new PQ.a,this.jh=this.lXa.r2d(2,"ReactRibbonUser"),this.J8=0,this.LAg=za.zba,this.E$=!!window.performance&&!!window.performance.now,this.dad=lc,this.xgb=ic,this.hCe=yc,this.Fcd=ec,this.Wu=jc,this.kaa=xd,this.ddl(),Sd.a.get_instance().Vj(10,Object(H.a)(this,this.QRj,"initializeFullPptRibbon"),11),Sd.a.get_instance().Vj(10,Object(H.a)(this,this.createHeader,"createHeader"),3)}finally{b&&b.dispose()}}Xlg(){Jg.a.instance.$b("InitRibbon",(new Date).getTime());ya.a.J(512496020,
801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.fWk?"2":"1",this.la.lza);this.la.podsRibbonEarlyRendererExposureControl&&!this.la.cUf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(H.a)(this,this.CRj,"initializeEarlyRenderedPptRibbon")):(Jg.a.instance.$b("RenderRibbonStart",Date.now()),this.Xnj(as.a(Fb.a.instance)).catch(()=>{ya.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>{Jg.a.instance.$b("AppChromeReadyTime",
Date.now());appChrome.setScriptLoader(as.a(Fb.a.instance));Zg.a("setCookieWithExpirationCallback")&&Zg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>Ti.a.qK(a,b,Ti.a.aK)),appChrome.api.setGetCookieValueCallback(a=>Ti.a.get(a)));appChrome.setAppSettings(w.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=w.AFrameworkApplication.Kpa+"exp/";appResourceLoader.init(BQ.a.resolveScript,a);appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();
this.R1e();appChrome.initializeRibbonStore(this.la.lza);this.Ylg();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==w.AFrameworkApplication.Aa.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",!1)?this.nph():this.Mje());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.oIa&&this.oIa.jdl();appChrome.renderAppChrome(this.k6a,Zg.e());
this.la.AJa&&qd.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");Sd.a.get_instance().dI(5);Sd.a.get_instance().dI(10);Sd.a.get_instance().dI(6);this.Kyg();Jg.a.instance.$b("Stage1Ribbon",AB.a.c8d&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}nph(){Sd.a.get_instance().Vj(4,()=>{Sd.a.get_instance().isCompleted(7)||this.Mje()})}Xnj(a){return a(this.la.lza?
"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome"))}CRj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&Jg.a.instance.$b("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&Jg.a.instance.$b("AppChromeReadyTime",
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&Jg.a.instance.$b("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),this.Mje()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)&&this.nph();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.Fcd.tyh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?Jg.a.instance.$b("AppInitStatus_ribbonSkeletonDismissed",
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.Kyg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&ha.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.R1e();Sd.a.get_instance().dI(5);Sd.a.get_instance().dI(10);Sd.a.get_instance().dI(6);Mu.a.dispatch("RibbonVisible")}jvl(){var a;Ti.a.get("PPTReactShyRibbonPreference")&&(null===(a=w.AFrameworkApplication.Aa)||void 0===
a?0:a.mb.Q9)?this.kaa.execute(b=>{b.logActivity("OptInShyRibbonNormalScreenActivity",null)}):appChrome.api.isSmallDevice()&&this.kaa.execute(b=>{b.logActivity("NonOptInShyRibbonSmallScreenActivity",null)})}QRj(){Jg.a.instance.$b("InitFullRibbon",(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{Jg.a.instance.$b("RibbonLazyPromiseFulfilled",(new Date).getTime());w.AFrameworkApplication.fa.$e(()=>{this.Hwe.vyl()?Sd.a.get_instance().Vj(7,()=>{ya.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");
appChrome.api.dispatch(this.Kvj())}):Sd.a.get_instance().Vj(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.aQa&&a.push.apply(a,this.Seg());if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Q9){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new CQ.a,{shyDismissalRegions:b})))}this.jvl();appChrome.api.dispatch(a);this.m9k();this.XBc.execute(b=>{if(void 0===this.cQ.Xaa||null===
this.cQ.Xaa)this.cQ.Xaa=b;this.Lyf()});this.M6k();this.MLc();this.createFileMenu();this.oIa&&(a=this.oIa.initialize(),ya.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.V_c();Sd.a.get_instance().dI(7);Jg.a.instance.$b("Stage3Ribbon",(new Date).getTime());this.E$&&Jg.a.instance.$b("RibbonInteractivePerfMark",window.performance.now());this.Igk();this.t$k();this.RRj();Ga.a.WI(this.lBe.UF(),"ScrollableRibbon");return null})}Igk(){if(Jg.a.instance.obb)ya.a.J(512496016,
813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};Jg.a.instance.xn("Stage1Ribbon")&&(a.RibbonDisplayed=Jg.a.instance.Tg("Stage1Ribbon"));Jg.a.instance.xn("Stage3Ribbon")&&(a.RibbonInteractive=Jg.a.instance.Tg("Stage3Ribbon"));Jg.a.instance.xn("InitRibbon")&&(a.InitRibbon=Jg.a.instance.Tg("InitRibbon"));Jg.a.instance.xn("InitFullRibbon")&&(a.InitFullRibbon=Jg.a.instance.Tg("InitFullRibbon"));Jg.a.instance.xn("RibbonLazyPromiseFulfilled")&&
(a.RibbonLazyPromiseFulfilled=Jg.a.instance.Tg("RibbonLazyPromiseFulfilled"));Jg.a.instance.xn("RenderRibbonStart")&&(a.RenderRibbonStart=Jg.a.instance.Tg("RenderRibbonStart"));Jg.a.instance.xn("AppChromeReadyTime")&&(a.AppChromeReadyTime=Jg.a.instance.Tg("AppChromeReadyTime"));Jg.a.instance.xn("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=Jg.a.instance.Tg("AppInitStatus_ribbonSkeletonDismissed"));ya.a.J(512496015,809,50,"Ribbon Perf metrics: "+ta.a.toJSON(a))}}Rfk(){if(Jg.a.instance.obb)ya.a.J(512496014,
813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};Jg.a.instance.xn("Stage2Ribbon")&&(a.RibbonEnabled=Jg.a.instance.Tg("Stage2Ribbon"));Jg.a.instance.xn("Stage4Ribbon")&&(a.RibbonFull=Jg.a.instance.Tg("Stage4Ribbon"));ya.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+ta.a.toJSON(a))}}RRj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);Jg.a.instance.$b("Stage4Ribbon",(new Date).getTime());
this.Rfk();return null})}iKb(){this.WBc&&Sd.a.get_instance().isCompleted(7)&&(kf.a.mark(4893),super.iKb(),kf.a.mark(4894),this.fMg||(Jg.a.instance.$b("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),Jg.a.instance.$b("Stage2Ribbon",Date.now()),this.fMg=!0))}SA(){this.iKb()}selectRibbonTabById(a){this.gdi(a)}get yxh(){return appChrome.selectors.getSelectedTabId()}gYi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=
(new Date).getTime();w.AFrameworkApplication.fa.$e(()=>{if(!qd.a("PPTOHideLegacySharedHeaderBugFix")||!w.AFrameworkApplication.UT){var b=(new Date).getTime(),c=this.jh.du("createHeader"),f=w.AFrameworkApplication.Aa.mb.uO,l=document.getElementById("HeaderPlaceholder");this.i_g=(new IG(Pd.a.K_i,this.lBe)).Q2i();if(f)try{ya.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");var y=new FG;appChrome.renderSharedHeader(this.i_g,y.jsj()).then(()=>{this.fek(b,a);l&&this.gYi()})}catch(G){ya.a.J(512496011,
801,10,"Exception while trying to render shared header {0}",G)}else throw ya.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),Error.invalidOperation("Invalid request to render legacy Shared Header");w.AFrameworkApplication.UT||(y=$s.a.Aje(L.AppFrame.sFa,null,this.i_g,!0),f&&(y.zJ=!0,this.WLb(y,F.a.zsc,F.a.ysc),y.bindAction(x.KeyInputManager.Va(B.a.AZ,0),F.a.lrd)));!l&&AB.a.h1f&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.jh.lu(c);this.J8|=1;this.lxc()}})}fek(a,b){var c=
(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;ya.a.J(512496009,809,50,"Create Header Perf metrics: "+ta.a.toJSON(f))}WLb(a,b,c){const f=x.KeyInputManager.Va(B.a.$q,0),l=x.KeyInputManager.Va(B.a.$q,4);a.hw(f);a.hw(l);a.bindAction(f,b);a.bindAction(l,c)}MLc(){const a=()=>{const b=this.jh.du("createJewel");this.h5a=this.ASj();Op.prototype.MLc.call(this);this.jh.lu(b);this.J8|=2;this.lxc()};this.dad&&this.xgb?this.xgb.Ybb(a):
w.AFrameworkApplication.fa.$e(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.jh.du("createFileMenu"),l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var y=[Object.assign(new yB,{label:CommonUIStrings.L_DiagnosticsSessionId,value:w.AFrameworkApplication.userSessionId}),Object.assign(new yB,{label:CommonUIStrings.L_DiagnosticsBuild,value:w.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",
y))}l.push.apply(l,this.T8f());y=document.createElement("div");document.body.appendChild(y);appChrome.renderFileMenu(y,l);this.eek(c,a);this.jh.lu(f);this.J8|=22;this.lxc()};this.dad&&this.xgb?this.xgb.Ybb(b):w.AFrameworkApplication.fa.$e(b)}eek(a,b){var c=(new Date).getTime();const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;ya.a.J(512496008,809,50,"File Menu Perf metrics: "+ta.a.toJSON(f))}M6k(){const a=()=>{const b=this.jh.du("refreshRibbon");
this.pec||(this.pec={},Np.EMh(this.pec),this.bed.FRh(this.pec),this.CBg=this.lfj(this.LAg,this.pec));const c=new KG.a(this.jEb);appChrome.api.dispatch(c.w$d(this.CBg));this.jh.lu(b);this.J8|=4;this.lxc()};this.dad&&this.xgb?this.xgb.Ybb(a):w.AFrameworkApplication.fa.$e(a)}lfj(a,b){const c={};for(let l in b){var f=b[l];const y=l;f!==a[y]&&(c[y]=f,ya.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",y,a[y],f))}return c}ASj(){const a={};
this.bed.wql(a);this.bed.FRh(a);return new pH(null,a,"jewelPPTEditor")}t$k(){AB.a.c8d&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}Lqh(a){Sd.a.get_instance().Vj(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}ddl(){const a=this.la.ka("ShareMenuIsEnabled"),b=a?"ShareTopBar":"Share";w.AFrameworkApplication.Gvb?this.Lqh(b):w.AFrameworkApplication.fa.$e(()=>{const c=this.jh.du("createShareAction"),f=this.Hwe.ryl();f?this.zzl(b):this.Lqh(b);a&&(f||Sd.a.get_instance().Vj(7,
()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.jh.lu(c);this.J8|=8;this.lxc()})}lxc(){31===this.J8&&(this.lXa.g6c(2),this.J8=0)}Mje(){this.Fcd.Hsi();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));Sd.a.get_instance().Vj(7,()=>{this.Fcd.lQl();Zg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.hCe||appChrome.PRIToastManager.dismissToast()},11)}Kyg(){Sd.a.get_instance().dI(18);
Mu.a.dispatch("RibbonVisible")}R4g(){return()=>{this.Wu.RJc(()=>{appChrome.PRIToastManager.dismissToast()})}}m9k(){this.hCe&&(Op.prd.$("NewDefaultSlide",this.R4g()),Op.prd.$("ChangeLayoutFlyout",this.R4g()))}}Object(m.a)(rH,"ReactRibbonUser",zB,[978,139,108]);class sH{constructor(a,b,c,f,l,y,G){this.yFb=null;this.wb=a;this.eQg=b;this.pa=c;this.Vv=f;this.LO=l;this.ia=y;this.Wp=G;this.eQg.gk(Object(H.a)(this,this.Kuh,"ribbonChangeTabHandler"))}dispose(){this.eQg.Qm(Object(H.a)(this,this.Kuh,"ribbonChangeTabHandler"))}get oA(){return this.yFb}set oA(a){this.yFb!==
a&&a&&(this.yFb=a,this.LO.t0?this.LO.t0=!1:this.Wp&&this.LO.yWa&&this.ia.processAction(C.a.Eka,2))}Kuh(a,b){b.node.Ta(va.a.shapeId)&&(a=b.node.eb(va.a.shapeId),this.yFb&&this.yFb.id===b.node.id&&a&&(this.wb.Hb(new pd.a(2,1,0,()=>{const c=this.pa.muj(this.Vv.yxh,b.node);0<c.length&&this.Vv.selectRibbonTabById(c)},90,"10")),this.yFb=null))}}Object(m.a)(sH,"RibbonChangeManager",null,[980]);class tH{constructor(a,b,c){this.mbj=a;this.aF=b;this.NNl=c}}Object(m.a)(tH,"GallerySectionData",null,[]);let DB,
EB,Yy,FB,sx,GB,HB,IB,JB;class Ev{constructor(a,b,c,f,l){this.la=a;this.jcd=b;this.Cbd=c;this.xWg=f;this.lEb=l}iud(a){this.la.Trg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,
a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.cBi,
a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=
!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.Trg||(a["PptRibbon.Home.Drawing.AllShapes"]=!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.Jre||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=
!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=
!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=
!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.Hre){if(this.la.Ire||this.la.oCb||this.la.Gre)a["ContextualTabs.Tables.Layout"]=!1;this.la.Gre&&(a["ContextualTabs.Tables.Layout.Alignment"]=
!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.Ire&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.oCb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=
!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=
!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.Jaa&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.MKb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.qjb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.j4c&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.Lre&&
(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.Epc&&(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=
!this.la.ka("InsertSymbolIsEnabled");this.la.Tsg||(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.K4j||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.doe||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.GMh(a,!0,!0,!0);this.FMh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.Bjh||(a["PptRibbon.AudioPlayback"]=!0);this.la.KKb||(a["PptRibbon.AudioFormat"]=
!0);if(w.AFrameworkApplication.cta||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.FBb)a["PptRibbon.InsertTab.AppForOffice"]=!0,a["PptRibbon.InsertTab.InsertAddinTransitionEntry"]=!0;this.la.cBb||(a["PptRibbon.View.Zoom"]=!0);this.la.a2j||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.cog||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=
!0);var b=[];this.la.ZMa&&(b=this.la.ZMa.split(","));for(const c of b){const f=c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.sWd||(a.AnimationMore=!0);this.la.c9j?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.yg&&(a["PptRibbon.View.PresentationViews"]=
!0);this.xWg?a["PptRibbon.Home.Clipboard.Paste"]=!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.Xrg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.hqe||
(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=this.la.ka("HelpTabIsEnabled")&&!w.AFrameworkApplication.YPb&&!w.AFrameworkApplication.cta)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&this.la.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&this.la.ka("HelpTabShowTrainingIsEnabled"));
a.btnWhatsNew=!(b&&this.la.ka("HelpTabWhatsNewIsEnabled"));a.btnFeedbackPane=!0;this.la.Rbb&&this.la.l0c&&this.la.l0c.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=
!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=!0;a.PresentLive=!0;a.PresentLiveConsumer=
!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;this.lEb&&(a["PptRibbon.Review.Comments.Markers"]=!0);this.la.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.oih;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.yWk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=!this.la.FKa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.la.FKa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.FKa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=
!this.la.FKa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.FKa;a.FixIt=!this.la.STc}gul(a){if(!this.la.ka("HelpTabIsEnabled")||w.AFrameworkApplication.YPb||w.AFrameworkApplication.cta)a.Help=!0;a.Draw=!this.la.yg}xzj(){const a=new Oa.a;if(this.la.ZMa){var b=this.la.ZMa.split(",");for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new tH("TransitionMore","Transition"+b,!0))}return a.toArray()}wql(a){a["PptJewel.Menu"]=!0;this.la.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=
!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.jcd&&this.jcd.i9g||(a["PptJewel.About.TryOffice"]=!0);
this.Cbd&&this.Cbd.lDh||(a["PptJewel.About.TryMacOffice"]=!0);this.la.ka("DocumentNameInJewelInfoMenuIsEnabled")&&w.AFrameworkApplication.ju.rx||(a.lblBreadcrumbDocName=!0);this.la.ka("HelpTabIsEnabled")&&!w.AFrameworkApplication.YPb&&(a["PptJewel.Help"]=!0)}FRh(a){delete a["PptJewel.Menu"];const b=this.la.Ha(w.AFrameworkApplication.yK);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=!0;var c=this.la.ka("SaveACopyIsEnabledForUiHost");const f=this.la.ka("UiHostSupportsDocRebootFeatures");
c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}w.AFrameworkApplication.yxa||(a["PptJewel.New"]=!0);w.AFrameworkApplication.tVe||(a["PptJewel.Open"]=!0);w.AFrameworkApplication.iF||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);w.AFrameworkApplication.HMh&&(a["PptJewel.Info.OpenInClient"]=!0,a.btnOpenInClient=!0);w.AFrameworkApplication.J0a||(a["PptJewel.Share.ReplyWithChanges"]=!0);w.AFrameworkApplication.B8d||
w.AFrameworkApplication.Paf||(a["PptJewel.Info.FileVersion"]=!0);w.AFrameworkApplication.fCb?(a["PptJewel.Info.FileVersion"]=!0,w.AFrameworkApplication.uk("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),ha.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):w.AFrameworkApplication.G4c()?this.la.lTk?(a["PptJewel.Info.VersionHistory"]=!0,ha.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):
this.la.JXi?this.la.ka("IsAnonymousUserCheckSupportedForVH")&&this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ha.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):this.la.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,ha.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):(a["PptJewel.Info.VersionHistory"]=!0,ha.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));
a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&(a["PptJewel.Info"]=!0);w.AFrameworkApplication.uTa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(w.AFrameworkApplication.XE||!w.AFrameworkApplication.Naf&&!w.AFrameworkApplication.Zzb&&!w.AFrameworkApplication.r8d)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);w.AFrameworkApplication.INl&&(a["PptJewel.SaveACopy"]=
!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);this.la.ka("DisablePrint")&&(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=
!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);w.AFrameworkApplication.XE&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);this.la.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=!0);this.la.ka("SaveAsToHostBrsIsEnabled")&&this.la.ka("UserCanWriteRelative")&&this.la.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=
!0);this.la.ka("SaveToAnotherFolderBrsIsEnabled")&&this.la.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.P4j||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.la.atg&&this.la.yg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!this.la.ka("153")||".odp"===this.la.Ha("152").toLowerCase()||w.AFrameworkApplication.XE)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=
!0;this.la.ka("RenameDialogIsEnabled")&&w.AFrameworkApplication.ucc()&&!w.AFrameworkApplication.XE||(a["PptJewel.Rename"]=!0);w.AFrameworkApplication.$rc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!w.AFrameworkApplication.phd||!this.la.ka("1072");w.AFrameworkApplication.privacyUrl||!c||w.AFrameworkApplication.cwc||this.jcd&&this.jcd.i9g||this.Cbd&&this.Cbd.lDh||this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);w.AFrameworkApplication.privacyUrl||(a["PptJewel.About.Privacy"]=
!0);a["PptJewel.About.TrustCenter"]=c;w.AFrameworkApplication.cwc||(a["PptJewel.About.TermsOfUse"]=!0);this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);w.AFrameworkApplication.uea||(a["PptJewel.SecondaryMenu"]=!0);c=!this.la.ka("248");a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;a["PptRibbon.Home.ShowHide.Designer"]=c;c=!this.la.ka("822");a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=
c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!Ev.T5j())||ha.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=c;ha.ULS.sendTraceTag(512262728,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",
w.AFrameworkApplication.Lbc(),w.AFrameworkApplication.insertOnlinePictureFromHostEnabled,w.AFrameworkApplication.l_c,w.AFrameworkApplication.fCb,w.AFrameworkApplication.QKc,w.AFrameworkApplication.p0b);this.la.ka("671")&&this.GMh(a,this.la.pptInsertOnlinePictureEnabled,w.AFrameworkApplication.Lbc(),this.la.Rbb);this.FMh(a,this.la.q0c);this.la.ka("670")&&(c=!this.la.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=
!this.la.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!this.la.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!this.la.ka("619");a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=
!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!1);c=this.la.ka("LiveSubtitlesEnabled");this.la.Vla&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,qd.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=
!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.ddc&&this.la.qtg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.LKb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=
!1),this.la.LKb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);this.la.a9j&&this.la.Vla&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,qd.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);this.la.ka("WacLabelingPoliciesIsEnabled")&&this.la.ka("WacApplyManualPolicyLabelIsEnabled")&&
this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&this.la.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0);this.la.dictationIsEnabled&&z.a.LIh&&this.la.ka("UserCanUseDictation")&&(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&
a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.oih;a.FixIt=!this.la.STc;this.la.gu("IsPresentToTeamsSupportedHost")&&!this.la.ka("IsPresentToTeamsSupportedHost")?(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=
!0,a.PresentToTeamsTopBar=!0);this.la.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);Np.TVl(Ev.TMj,a);if(w.AFrameworkApplication.cta||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.FBb)a["PptJewel.Addin"]=!0}GMh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=
!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=
!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}FMh(a,b){a.InsertPictureFromMobileDevice=!b;a.ChangePictureFromMobileDevice=!b}static T5j(){const a=
w.AFrameworkApplication.fa.Ha("SovereignEnvironmentName"),b=w.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");var c=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.yK);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}Ev.TMj={["ellipsisOpenInApp"]:(JB=new Oa.a,JB.add("HostOpenInClient"),JB),["ellipsisOpenInBrowser"]:(IB=new Oa.a,IB.add("HostOpenInBrowser"),IB),["ellipsisDownload"]:(HB=new Oa.a,HB.add("HostDownload"),HB),["conversation"]:(GB=new Oa.a,GB.add("HostConversation"),
GB),["close"]:(sx=new Oa.a,sx.add("HostClose"),sx.add("btnjClose"),sx.add("msJewelSecondary"),sx),["copyLink"]:(FB=new Oa.a,FB.add("CopyLink"),FB),["share"]:(Yy=new Oa.a,Yy.add("jbtnFileSharing"),Yy.add("btnFileSharing"),Yy),["docChat"]:(EB=new Oa.a,EB.add("DocChat"),EB),["openInApp"]:(DB=new Oa.a,DB.add("btnOpenInClient"),DB)};Object(m.a)(Ev,"RibbonCommandTrimmer",null,[1363]);class KB{constructor(){this.oIa=this.wl=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Xb(a){this.K=a;w.AFrameworkApplication.fa.ka("StatusBarPRIEnabled")||
a.register(wG.a,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").na().oa(()=>new wG.a(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IAppSettingsManager")));a.register(976,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").na().oa(()=>new vG(new jB(w.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").GBb;z.a.ik&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").jza);
const c=this.K.resolve("PowerPointWebEditor.IFileInfo").Mja;let f=2===c||3===c||0===c;f=f&&1!==c;a.register(Ev,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").na().oa(()=>new Ev(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f));a.register(977,"PowerPointWebEditor.IModeSwitcherControlActor").na().oa(()=>new nG(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),Sd.a.get_instance()));a.register(978,"PowerPointWebEditor.IRibbonUser").na().oa(()=>{const l=a.resolve("PowerPointWebEditor.IApplicationSettings"),y=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var G={};y.iud(G);var R={};y.gul(R);G=new jG(G,y.xzj(),R);R=new mG;const ja=a.resolve("Common.IAppSettingsManager"),za=new rH(a.resolve("PowerPointWebEditor.AppFrame"),
a.resolve("PowerPointWebEditor.IRibbonPane").xa,a.resolve("PowerPoint.IPathManager"),a.Ia("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.rb("PowerPointWebEditor.Core.IBundleMetricRecorder"),y,G,l,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),R,ja.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Sa.a)(110,ja)?ja:null,
ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),w.AFrameworkApplication.eKb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"),a.Ia("Common.ISystemInitiatedFeedback"));l.cUf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").JAb(()=>{za.Xlg()}):za.Xlg();return za});a.register(979,"Common.IRibbonExternal").na().oa(()=>a.resolve("PowerPointWebEditor.IRibbonUser").Dhl);a.register(980,"PowerPointWebEditor.IRibbonChangeManager").na().oa(()=>new sH(a.resolve("Common.ITaskManager"),
a.resolve("Box4.Graph.IGraphInstance").zd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(lB,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").na().oa(()=>new lB(a.resolve("CommonUI.IBusinessBar"),
new kG,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),w.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.PresentationContext"),new Ol(w.AFrameworkApplication.Je,a.resolve("PowerPointWebEditor.IJsonpHelperManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))));a.register(981,"PowerPointWebEditor.IBusinessBarPane").na().oa(()=>
new pG(a.Ia("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").crc));a.register(Fq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").na().oa(()=>new Fq(a.resolve("PowerPointWebEditor.IBusinessBarPane").i_l));a.register(982,"Common.IRibbonSQMInformation").na().oa(()=>{const l=new xG(w.AFrameworkApplication.Qa);l.X8k();return l});a.register(983,"PowerPointWebEditor.IInkRibbonManager").na().oa(()=>{const l=a.resolve("PowerPointWebEditor.IApplicationSettings");return new pp(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),w.AFrameworkApplication.Aa.mb.Q9,l)})}init(){this.oIa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");this.K.resolve("PowerPointWebEditor.BusinessBarController").BSk();this.wl=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.wl.initialize();w.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):
this.K.Ia("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").qrc?(c=document.getElementById("BusinessBarRegion"),b.IQa(a,c,null)):c?b.IQa(a,this.K.resolve("PowerPointWebEditor.AppFrame").E2,c):b.m_(a);this.K.resolve("CommonUI.IBusinessBar");
this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.wl&&this.wl.dispose();this.oIa&&this.oIa.dispose()}static main(){n.a.instance.Ac(new KB)}}Object(m.a)(KB,"PPTWebEditorRibbonPackage",null,[2,3]);var tx=d(685);class uH{get name(){return"Box4.Insights"}init(){}dispose(){}Xb(a){a.register(tx.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").na().oa(()=>new tx.a)}}Object(m.a)(uH,"Box4InsightsPackage",null,
[2,3]);class LB{constructor(a,b){this.NLd=0;this.yia=new Oa.a;this.Ca=a;this.qd=b}get Xc(){return this.qd}get Rie(){return 0<this.NLd}m6(a){this.$rg(a)&&this.NLd++;this.Rie?this.Xc.enabled=!1:this.yia.add(this.Xc.eq(a.actionId))}l6(a){!this.Rie&&0<this.yia.count&&(this.yia.ga(this.yia.count-1),this.IYf(this.yia.count-1));this.$rg(a)&&this.NLd--;this.Rie||(this.Xc.enabled=!0)}IYf(a){if(0<this.yia.count&&0<=a&&a<this.yia.count){const b=this.yia.ga(a);this.yia.removeAt(a);b.end()}}dFi(){let a=this.yia.count-
1;for(;0<=a;){var b=this.yia.ga(a);(b=this.Ca.MT(b.activityName))&&b.flags[128]&&this.IYf(a);a--}}$rg(a){if(2!==a.behavior)return!0;a=this.Ca.MT(a.actionId);return!!a&&a.flags[32]}}Object(m.a)(LB,"ActivityActionListener",null,[144]);var Zy;(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(Zy||(Zy={}));Object(m.b)("ActivityAutoEndReason",Zy);class MB{constructor(a){this.Tia=new rj.a;this.ASb=a}wri(){for(let a of this.Tia.keys)this.xri(a)}b4f(a){if(this.ASb.oLc)for(let b of this.Tia.keys){const c=
Array.clone(this.Tia.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.L9d();this.noh(b,a,l.uniqueID)}}}xri(a){var b=this.Tia.ga(a);b=this.hoj(b);for(let c=0;c<b.length;c++){const f=b[c];f.L9d();this.noh(a,0,f.uniqueID)}}hoj(a){const b=[];for(let c=0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.z5g&&Array.add(b,f)}return b}noh(a,b,c){const f={};f.AID=c;f.A=a;f.AE=Zy[b];cc.a.instance.Yb("AutoEnded",f)}Yul(){if(this.ASb.oLc){var a=new pd.a(2,2,this.ASb.yri,Object(H.a)(this,this.wri,
"autoEndLongRunningActivities"),67);w.AFrameworkApplication.De.Hb(a)}}register(a){if(this.ASb.oLc){var b=a.activityName;this.Tia.Gb(b)&&this.Tia.ga(b)||this.Tia.$(b,[]);Array.add(this.Tia.ga(b),a)}}unregister(a){if(this.ASb.oLc){var b=a.activityName;this.Tia.Gb(b)&&this.Tia.ga(b)&&Array.remove(this.Tia.ga(b),a)}}}Object(m.a)(MB,"ActivityAutoEndHelper",null,[585]);class ju{constructor(a){this.Ocf=null;this.eEc=0;this.yFd=this.OG=!1;this.WRd=0;this.fy=new Yc.a;this.Hxb=new Yc.a;this.mWh=a}get bTd(){return this.Ocf||
(this.Ocf=this.mWh())}get properties(){return this.fy}get z5g(){return this.eEc}get enabled(){return this.OG}get ended(){return this.yFd}get uniqueID(){return this.WRd}T4g(){const a={};a.ID=this.uniqueID;a.A=this.activityName;a.ST=this.startTime;a.ET=this.endTime;Za.Ct(this.properties.keys)&&(a.P=ju.Obg(this.properties));Za.Ct(this.Hxb.keys)&&(a.FP=ju.Obg(this.Hxb));return a}static Obg(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(m.a)(ju,"AActivity",null,[604,605]);class NB extends ju{constructor(a,
b,c,f,l,y,G,R){super(G);this.St=0;this.oWh=a;this.S_h=b;this.Cha=c;this.Nj=(new Date).getTime();this.H5h=f;this.HBd=y;this.eEc=l;this.HBd.register(this);this.WRd=R()}get activityName(){return this.Cha}get startTime(){return this.Nj}get endTime(){return this.St}SYf(a){this.St=(new Date).getTime();this.ended?this.A5k():(this.yFd=!0,this.St=(new Date).getTime(),this.St<this.Nj&&(ha.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.St,
this.Nj,this.Cha)),this.St=this.Nj),this.HBd.unregister(this),this.H5h&&(!a&&this.bTd&&this.bTd.enabled?this.Vsb():this.S2b()))}end(){this.SYf(!1)}L9d(){this.SYf(!0)}A5k(){const a={};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.S_h("AlreadyEnded",this.endTime,a)}Vsb(){this.bTd.Vsb()}S2b(){this.oWh(this.T4g())}cancel(){this.ended||(this.yFd=!0,this.HBd.unregister(this))}}Object(m.a)(NB,"ActivityImpl",ju,[]);class vH extends Sys.EventArgs{constructor(){super();this.name=
this.properties=null}}Object(m.a)(vH,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class ku{constructor(a,b,c){this.Oa=new Wc.a;this.OG=!0;this.settings=a;this.IBd=b;this.MBd=c}get enabled(){return this.OG&&this.settings.enabled}set enabled(a){this.OG=a}eq(a,b=-1){-1===b&&(b=this.settings.OUi);return this.IBd(Object(H.a)(this,this.S2b,"completeActivity"),Object(H.a)(this,this.ooh,"recordEventInternal"),a,this.RVj(a.toString()),b)}Yb(a,b=null){this.ooh(a,(new Date).getTime(),b);this.Oa.raiseEvent("HHR",
Object.assign(new vH,{name:a,properties:b}))}ooh(a,b,c){this.bqg(a)&&(a=this.Lcg(a,c,b),ha.ULS.sendTraceTag(6068304,213,100,a))}Ooa(a,b=null){this.bqg(a.toString())&&(a=this.Lcg(a.toString(),b,(new Date).getTime()),ha.ULS.sendTraceTag(6415520,213,100,a))}RVj(a){return this.enabled&&!this.SVj(a)}bqg(a){return this.enabled&&!this.i_j(a)}SVj(a){return this.settings.XXi.contains(a)}i_j(a){return this.settings.YXi.contains(a)}S2b(a){if(this.MBd.UJf(a.A.toString())){var b=[];Array.add(b,a);a=Nd.c(b);ha.ULS.sendTraceTag(5894867,
213,100,a)}}Lcg(a,b,c){const f={};f.ID=ku.r$d();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return Nd.c(a)}static r$d(){return ku.Mbi++}}ku.Mbi=0;Object(m.a)(ku,"ActivityManagerImpl",null,[581]);class rp{constructor(){this.OG=!1;this.Uff=this.Adf=0;this.zdf=!1;this.zgf=new So.a;this.Agf=new So.a}h6b(a){this.OG=Boolean.parse(a[rp.b_j]||"false");this.zgf=this.Pgh(a[rp.WXi]);this.Agf=this.Pgh(a[rp.ZXi]);this.I4i(a)}get enabled(){return this.OG}get XXi(){return this.zgf}get YXi(){return this.Agf}I4i(a){this.zdf=
Boolean.parse(a[rp.SWj]||"false");this.Adf=parseInt(a[rp.zri]||"60000");this.Uff=parseInt(a[rp.PUi]||"5000")}get yri(){return this.Adf}get OUi(){return this.Uff}get oLc(){return this.zdf}Pgh(a){const b=new So.a;for(const c of(a||"").split(","))""!==c&&b.add(c);return b}}rp.b_j="ActivityLoggingIsEnabled";rp.WXi="DisabledClientActivityNames";rp.ZXi="DisabledClientActivityEventNames";rp.SWj="ActivityAutoEndEnabled";rp.zri="ActivityAutoEndTaskInterval";rp.PUi="ActivityDefaultMaxDuration";Object(m.a)(rp,
"ActivitySettings",null,[582]);class Fv{constructor(a){this.WEd=new So.a;this.GYb=new Yc.a;this.WHc=a;this.Zul()}Zul(){this.WHc.enabled&&(Fv.nwf=new pd.a(2,2,this.WHc.interval,Object(H.a)(this,this.kZi,"doThrottle"),65),w.AFrameworkApplication.De.Hb(Fv.nwf))}kZi(){this.Ufl()}Ufl(){this.GYb=new Yc.a;this.WEd=new So.a}TVj(a){return this.WEd.contains(a)}YNl(a){if(this.GYb.Gb(a)){if(this.GYb.ga(a)>=this.WHc.Syk)return this.WEd.add(a),ha.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",
a),!1;let b;(b=this.GYb).$(a,b.ga(a)+1)}else this.GYb.add(a,1);return!0}UJf(a){return this.WHc.enabled?!this.TVj(a)&&this.YNl(a):!0}}Fv.nwf=null;Object(m.a)(Fv,"ActivityThrottler",null,[580]);class bs{constructor(){this.OG=!1;this.Nkf=this.Vof=0}h6b(a){this.OG=Boolean.parse(a[bs.s6d]||"false");this.Vof=parseInt(a[bs.Tyk]||"600");this.Nkf=parseInt(a[bs.HUj]||"600000")}get enabled(){return this.OG}get Syk(){return this.Vof}get interval(){return this.Nkf}}bs.s6d="ActivityThrottlerEnabled";bs.Tyk="ActivityThrottlerMaxActivities";
bs.HUj="ActivityThrottlerInterval";Object(m.a)(bs,"ActivityThrottlerSettings",null,[579]);class OB{constructor(){this.Ea=null}get name(){return"Common.App.Activities"}init(){this.iRj()}iRj(){const a=this.Ea.resolve("Common.App.Activities.IActivitySettings"),b=w.AFrameworkApplication.fa.appSettings;a.h6b(b);this.Ea.resolve("Common.App.Activities.IActivityThrottlerSettings").h6b(b);if(a.enabled){cc.a.instance=new ku(this.Ea.resolve("Common.App.Activities.IActivitySettings"),(l,y,G,R,ja)=>new NB(l,y,
G,R,ja,this.Ea.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Ea.rb("Common.App.Activities.IActivityAggregationManager"),ku.r$d),this.Ea.resolve("Common.App.Activities.IActivityThrottler"));var c=this.Ea.resolve("Common.App.Activities.ActivityAutoEndHelper"),f=this.Ea.resolve("Common.App.Activities.ActivityActionListener");c.Yul();w.AFrameworkApplication.$ga(()=>{f.dFi();c.b4f(1)});w.AFrameworkApplication.Qa.Oaa(f);w.AFrameworkApplication.MJc((l,y)=>{cc.a.instance.Ooa(y.errorCode,
{["ErrorCause"]:y.e7d,["ErrorResolution"]:y.f7d});c.b4f(2)})}}dispose(){}Xb(a){this.Ea=a;a.register(rp,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").na();a.register(MB,"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").na().oa(()=>new MB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(LB,"Common.App.Activities.ActivityActionListener").oa(()=>new LB(w.AFrameworkApplication.Qa,a.resolve("Common.IActivityManager")));
a.register(bs,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").na().oa(()=>new bs);a.register(Fv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").na().oa(()=>new Fv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){n.a.instance.Ac(new OB)}}Object(m.a)(OB,"ActivitiesPackage",null,[2,3]);class wH{constructor(){this.kqa=new Yc.a}g0e(a,b){this.kqa.$(a,b)}C$d(a){({value:a}=this.kqa.vg(a));
return a}}Object(m.a)(wH,"AggregationMethodsForActivityName",null,[]);class PB{constructor(){this.IFc=new rj.a;this.kqa=new rj.a}g0e(a,b,c){this.kqa.Gb(a)&&this.kqa.ga(a)||this.kqa.$(a,new wH);this.kqa.ga(a).g0e(b,c)}C$d(a,b){return this.kqa.Gb(a)&&this.kqa.ga(a)?this.kqa.ga(a).C$d(b):null}y8b(a){this.IFc.Gb(a)&&this.IFc.ga(a)||this.IFc.$(a,new So.a);return this.IFc.ga(a)}nUi(a,b){this.y8b(a).add(b)}}Object(m.a)(PB,"ActivityAggregationInfo",null,[630]);class ux extends ju{constructor(a,b){super(a);
this.WRd=(this.nWh=b)?b.Qkj():ku.r$d()}get Zia(){return this.nWh}get activityName(){return this.Zia.name}get startTime(){return this.Zia.startTime}get endTime(){return this.Zia.endTime}end(){}cancel(){}L9d(){}gTl(){this.Hxb.$("AM",this.Zia.mode.toString());this.Hxb.$("C",this.Zia.count.toString());this.Hxb.$("DA",this.Zia.uXf.toFixed(2));this.Hxb.$("DV",this.Zia.u_i.toFixed(2))}Bde(a){return this.Zia.Bde(a)}aee(){return this.Zia.aee()}Vsb(){for(let a of this.Zia.$ia)a.Vsb()}}Object(m.a)(ux,"AggregatedActivity",
ju,[]);class xH{constructor(a,b){this.aCd=0;this.Cha=a;this.yAa=b}mni(a,b){this.aCd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.nni(c)}}nni(a){const b=Object(sa.a)(ux,a);if(b)if(1===this.aCd)this.jni(b);else if(2===this.aCd){this.oni(b);for(let c of this.yAa.y8b(this.Cha)){const f=b.Zia.$ia.ga(0);f.properties.Gb(c)&&a.properties.$(c,f.properties.ga(c))}}}jni(a){for(let b of this.yAa.y8b(this.Cha))this.wvh(a,b)}oni(a){for(let b of a.aee())this.wvh(a,b)}wvh(a,b){const c=this.yAa.C$d(this.Cha,b);if(c){const f=
a.Bde(b);a.properties.$(b,c(f))}}}Object(m.a)(xH,"PropertyAggregationHelper",null,[]);class QB{constructor(a,b,c,f,l){this.rob=a;this.yAa=b;this.lff=l;this.MBd=f;this.m4h=c}get Ayf(){return this.m4h.value}S2b(a){if(Object(Sa.a)(NB,a))a.S2b();else if(Object(Sa.a)(ux,a)&&this.MBd.UJf(a.activityName.toString())){a=Object(sa.a)(ux,a);a.gTl();a=a.T4g();var b=[];Array.add(b,a);a=Nd.c(b);ha.ULS.sendTraceTag(6907266,213,50,a)}}b0b(a,b){const c=(new Date).getTime();var f=this.lff.list.ga(a);const l=({pni:f}=
this.ldj(f)).returnValue;this.lff.list.$(a,new Oa.a);b&&(f=this.eMi(f,c,this.rob.Zfg));0<f.count&&(new xH(a,this.yAa)).mni(f,l)}eMi(a,b,c){const f=new Oa.a;for(let l=0;l<a.count;l++){const y=a.ga(l);y.startTime>b-c?y.Vsb():f.add(y)}return f}ldj(a){const b=this.Ayf.mLh(a);a=this.Ayf.TKl(a);const c=this.qni(b,a);return{returnValue:c,pni:1===c?b:a}}qni(a,b){return a.count*this.rob.F6g<b.count?1:2}get enabled(){return this.rob.enabled}Vsb(){}}Object(m.a)(QB,"ActivityAggregationManager",null,[622]);class Xo{constructor(a){this.enabled=
!1;this.G5g=500;this.l6g=2;this.gxd=6E4;this.F6g=5;this.Zfg=3E4;this.h6b(a.appSettings)}h6b(a){this.enabled=Boolean.parse(a[Xo.s6d]||"false");this.G5g=parseInt(a[Xo.hzk]||"500");this.l6g=parseInt(a[Xo.tAk]||"2");this.gxd=parseInt(a[Xo.jJl]||"60000");this.F6g=parseInt(a[Xo.JAk]||"5");this.Zfg=parseInt(a[Xo.cCj]||"30000")}}Xo.s6d="ActivityAggregationEnabled";Xo.hzk="ActivityAggregationMaxInterval";Xo.tAk="ActivityAggregationMinChain";Xo.jJl="ActivityAggregationTaskInterval";Xo.JAk="ActivityAggregationModeFactor";
Xo.cCj="ActivityAggregationGraceWindow";Object(m.a)(Xo,"ActivityAggregationParams",null,[]);class RB{constructor(a,b){this.yAa=a;this.Pcf=b}mLh(a,b=1){if(!a||!a.count)return a;const c=new Oa.a;var f=null;for(let l=0;l<a.count;l++){const y=a.ga(l);if(!y)continue;const G=y.activityName;f?f.l$j(y)?f.add(y):(f=f.process(),c.addRange(f),f=this.Pcf(G,b),f.add(y)):(f=this.Pcf(G,b),f.add(y))}f&&(a=f.process(),c.addRange(a));return c}TKl(a){if(!a||!a.count)return a;const b={};var c=null;for(let l=0;l<a.count;l++){const y=
a.ga(l);if(y){if(!c){c=new Oa.a;var f=this.yAa.y8b(y.activityName);for(let G of f)c.add(G)}f=this.isj(y,c);null!==f&&(f in b&&b[f]||(b[f]=new Oa.a),b[f].add(y))}}a=new Oa.a;for(const l of ta.a.JL(b))c=this.mLh(b[l],2),a.addRange(c);return a}isj(a,b){let c="";for(let f of b)c+=f,c=a.properties.Gb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(m.a)(RB,"ActivityAggregationSchemes",null,[600]);class yH{constructor(a,b,c,f,l){this.St=this.Nj=0;
this.rob=c;this.IBd=f;this.yAa=l;this.name=a;this.iz=b;this.$ia=new Oa.a}get mode(){return this.iz}get count(){return this.$ia.count}get startTime(){return this.Nj}get endTime(){return this.St}get uXf(){if(!this.count)return 0;let a=0;for(let b of this.$ia)a+=b.endTime-b.startTime;return a/this.count}get u_i(){if(!this.count)return 0;let a=0;const b=this.uXf;for(let c of this.$ia){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?this.St=a.endTime>this.endTime?a.endTime:
this.endTime:(this.Nj=a.startTime,this.St=a.endTime);this.$ia.add(a)}l$j(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.rob.G5g}process(){if(this.count>=this.rob.l6g){const a=new Oa.a,b=this.IBd(this);a.add(b);return a}return this.$ia}Bde(a){const b=new Oa.a;for(let c of this.$ia)if(c.properties.Gb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}aee(){const a=this.yAa.y8b(this.name),b=new So.a;for(let c of this.rdj())a.contains(c)||b.add(c);return b}rdj(){const a=new So.a;
if(!this.$ia)return a;for(let b of this.$ia)for(let c of b.properties.keys)a.add(c);return a}Qkj(){return this.$ia.ga(0).uniqueID}}Object(m.a)(yH,"ActivityCollection",null,[589]);class SB{constructor(){this.X3a=new rj.a}get list(){return this.X3a}add(a){const b=a.activityName;if(this.X3a.Gb(b)&&this.X3a.ga(b)){const c=this.mmj(this.X3a.ga(b),a);this.X3a.ga(b).insert(c,a)}else this.X3a.$(b,new Oa.a),this.X3a.ga(b).add(a)}mmj(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>a.ga(c).startTime)return c+
1;return 0}}Object(m.a)(SB,"CompletedActivitiesHelper",null,[588]);class TB{constructor(){this.Ea=null}get name(){return"Common.App.ActivityAggregator"}init(){w.AFrameworkApplication.$ga(()=>{this.Ea.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Xb(a){this.Ea=a;const b=f=>new ux(()=>a.rb("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new yH(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));
a.register(QB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").na().oa(()=>new QB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.ue("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Xo,"Common.App.ActivityAggregator.ActivityAggregationParams").na().oa(()=>
new Xo(w.AFrameworkApplication.fa));a.register(PB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").na().oa(()=>new PB);a.register(RB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").na().oa(()=>new RB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(SB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").na().oa(()=>new SB)}static main(){n.a.instance.Ac(new TB)}}
Object(m.a)(TB,"ActivityAggregatorPackage",null,[2,3]);var zH=d(16);class kr{constructor(){this.Nhl="getAddinShortcutsPreference";this.Ohl="saveAddinShortcutsPreference";this.Phl="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.fdj=6E4;this.jid=this.L8=this.kZ=null}mcg(a){return String.format(this.Phl,w.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",a,w.AFrameworkApplication.Pg)}executeRequest(a,b,c,f,l=null){return kr.eda.Psb(a,b,l,null,2,c,f,!1,null,this.fdj)}saveSetting(a,
b,c,f,l){return this.Dwh(a,b,c,null,f,l)}startBatchUpdateScope(){this.jid=[]}saveShortcutInfoArrayBatch(a,b,c){this.Fjl(c,a,b)}Fjl(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.nTd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;b=new zH.a(c.toString(),a);this.jid.push(b)}commitBatchUpdateScope(){return this.Buc()?this.Hjl().then(()=>{this.jub();return Promise.resolve(!0)}):
this.Jjl().then(()=>{this.jub();return Promise.resolve(!0)})}Hjl(){return this.getSetting().then(a=>{let b=null;if(a&&!({Su:b}=Nd.d(a)).returnValue)return ha.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.jid){(a=b[c.key])||(a={});const f=c.value;for(const l of ta.a.JL(f))a[l]=f[l];b[c.key]=a}this.kZ=b;try{return localStorage.setItem("AddinShortcutPreferenceData",Nd.c(b)),Promise.resolve(!0)}catch(c){return ha.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}Jjl(){return this.Wml().then(a=>this.Srd(a))}Wml(){return this.gee().then(a=>{let b=null;a&&(({Su:b}=Nd.d(a)).returnValue||ha.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));b||(b={});for(const c of this.jid){(a=b[c.key])||(a={});const f=c.value;for(const l of ta.a.JL(f))a[l]=f[l];b[c.key]=a}this.kZ=b;return Nd.c(b)})}saveShortcutInfoArray(a,
b,c){return this.Dwh(0,"","",c,a,b)}Dwh(a,b,c,f,l,y){const G=this.Buc(),R={};R.action=c;R.addinId=b;R.ownerType=a;R.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),y.toString());0===a&&f?(R.shortcutInfoArray=f,this.nTd(l,y,f)):b&&(R.shortcutInfoArray=b);a={};a[l.toString()]=R;l=new zH.a(y.toString(),a);return G?this.Gjl(l):this.Ijl(l)}Gjl(a){return this.getSetting().then(b=>{let c=null;if(b&&!({Su:c}=Nd.d(b)).returnValue)return ha.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.kZ=c;try{return localStorage.setItem("AddinShortcutPreferenceData",Nd.c(c)),Promise.resolve(!0)}catch(f){return ha.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}Ijl(a){return this.Vml(a).then(b=>this.Srd(b))}Vml(a){return this.gee().then(b=>{let c=null;b&&(({Su:c}=Nd.d(b)).returnValue||ha.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
c||(c={});c[a.key]=a.value;this.kZ=c;return Nd.c(c)})}saveSettings(a){this.kZ=Nd.a(a);this.jub();return this.Buc()?this.Ewh(a):this.Srd(a)}Ewh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return ha.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}Srd(a){const b={};b.Wac=a;const c=Nd.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.mcg(this.Ohl),
2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.jo||l.Hm)ha.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var y=l.result;void 0!==y.xj&&null!==y.xj&&void 0!==y.xj.data&&null!==y.xj.data&&y.xj.data.Oe===ok.a.mx?f(!0):f(!1)}})}}catch(y){ha.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",y.toString()),f(!1)}})}getSetting(){const a=this.Buc();return this.kZ?Promise.resolve(Nd.c(this.kZ)):a?this.Zuj():
this.gee()}Buc(){const a=w.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=w.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}Zuj(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return ha.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}gee(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.mcg(this.Nhl),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.jo||c.Hm)ha.ULS.sendTraceTag(522739862,
0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.xj&&f.xj.data?f.xj.data.Oe!==ok.a.mx?ha.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.xj.data.Oe):f.xj.data.Wd?(f=Nd.a(f.xj.data.Wd),f.Wac&&(l=f.Wac)):ha.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):ha.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){ha.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",
c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.Buc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=Nd.a(f));if(!l)return ha.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const y of ta.a.JL(l)){f=l[y.toString()];for(const G of ta.a.JL(f)){const R=f[G];if(R.addinId===a)delete f[G.toString()];else if(0===R.ownerType&&R.shortcutInfoArray){const ja=R.shortcutInfoArray,za=new Oa.a;
for(let Va=0;Va<ja.length;++Va)ja[Va].addinId!==a&&za.add(ja[Va]);R.shortcutInfoArray=za.toArray()}}ta.a.count(f)||delete f[y]}c.kZ=l;c.l$k(a);return b?c.Ewh(Nd.c(l)):c.Srd(Nd.c(l))})}jub(){if(this.kZ){this.L8=null;const c=this.kZ;for(let f in c){var a=f;const l=c[f];for(let y in l){var b=y;const G=l[y];G.shortcutInfoArray&&this.nTd(parseInt(b),parseInt(a),G.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({Su:b}=Nd.d(a)).returnValue)return ha.ULS.sendTraceTag(522739868,
0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.kZ=b;this.jub();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.kZ&&(c=this.kZ[c])&&(b=c[b])&&b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.kZ&&(b=this.kZ[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,
b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.jub();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.L8)return Promise.resolve(!0);var c=this.L8[a];if(!c)return Promise.resolve(!0);var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let y=0;for(const G of l){if(G.addinId===a&&G.action===b)break;++y}if(y>=l.length)return Promise.resolve(!0);l.splice(y,
1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.jub();return Promise.resolve(!0)})}nTd(a,b,c){this.L8||(this.L8={});for(const f of c){c=f.addinId;const l=f.action;let y=this.L8[c];y||(y={});const G={};G.modifiers=a;G.keyCode=b;y[l]=G;this.L8[c]=y}}l$k(a){a in this.L8&&delete this.L8[a]}isActionCustomized(a,b){return this.L8&&(a=this.L8[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.L8&&(a=this.L8[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.kZ}static instance(){kr.XUd||
(ha.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),kr.XUd=new kr,kr.eda=w.AFrameworkApplication.Je);return kr.XUd}}kr.XUd=null;kr.eda=null;Object(m.a)(kr,"AddinShortcutsPreferenceSettingHelper",null,[]);class AH{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=
this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(AH,"BrowserInfo",null,[]);class BH{constructor(){this.Version=this.Name=null}}Object(m.a)(BH,"PluginInfo",null,[]);class vk{static Rte(){if(w.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=
vk.pbj();try{const b=JSON.stringify(a);ha.ULS.sendTraceTag(6903563,102,50,b)}catch(b){ha.ULS.sendTraceTag(6903564,102,15,b.message)}}else ha.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static vrj(){const a=window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new BH,{Name:f,Version:l}))}return b}static pbj(){const a=new AH,b=new Sys.StringBuilder;vk.BB(c=>{a.DocElemClientHeight=
c},()=>document.documentElement.clientHeight,b);vk.BB(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);vk.BB(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);vk.BB(c=>{a.DocElemOffsetWidth=c},()=>document.documentElement.offsetWidth,b);vk.BB(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);vk.BB(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);vk.BB(c=>{a.ScreenWidth=c},()=>window.screen.width,b);vk.BB(c=>{a.ScreenHeight=c},()=>window.screen.height,
b);vk.BB(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);vk.BB(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);vk.BB(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);vk.BB(c=>{a.ScreenDeviceYdpi=c},()=>window.screen.deviceYDPI,b);vk.BB(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);vk.BB(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);vk.BB(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);vk.BB(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);
vk.BB(c=>{a.WinOrientation=c},()=>window.self.orientation,b);vk.BB(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);vk.BB(c=>{a.SupportsTouch=c},()=>z.a.wMa,b);vk.BB(c=>{a.NavAppName=c},()=>window.navigator.appName,b);vk.BB(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);vk.BB(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);vk.BB(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);vk.BB(c=>{a.NavPlatform=c},()=>window.navigator.platform,
b);vk.BB(c=>{a.NavPlugins=c},vk.vrj,b);vk.BB(c=>{a.CalculatedDevicePixelRatio=c},()=>vk.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static BB(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(m.a)(vk,"BrowserInfoLogger",null,[]);class UB{get name(){return"Common.App.BrowserInfoLogger"}Xb(){}init(){vk.Rte()}dispose(){}static main(){n.a.instance.Ac(new UB)}}
Object(m.a)(UB,"BrowserInfoLoggerPackage",null,[2,3]);class VB{get name(){return"Common.App.DialogWithLinkToResource"}Xb(){}init(){}dispose(){}static main(){n.a.instance.Ac(new VB)}}Object(m.a)(VB,"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var QQ=d(724);class WB{get name(){return"Common.App.EventsCachePackage"}Xb(){}init(){QQ.a.instance.init()}dispose(){}static main(){n.a.instance.Ac(new WB)}}Object(m.a)(WB,"EventsCachePackage",null,[2,3]);class XB{constructor(a,b,c){this.C6a=null;this.ae=
a;this.Ca=b;this.wif=c.create()}vrc(){this.C6a?ha.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ha.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.C6a=new pd.a(2,1,3E4,Object(H.a)(this,this.lvd,"showFloatPane"),67),this.ae.Hb(this.C6a))}lvd(){this.C6a=null;ha.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.wif.display()}zya(){this.Ca.ya(F.a.lvd,ye.a.frame,Object(H.a)(this,this.zAl,
"showFloatPaneHandler"))}zAl(a,b,c,f,l){return a!==F.a.lvd?2:1===c?32:2===c&&l?(ha.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.vrc():(this.C6a?(ha.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.ae.Kg(this.C6a)):(ha.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.wif.remove(null)),this.C6a=null),32):8}}Object(m.a)(XB,"FloatPaneActor",null,[651]);class CH{constructor(a,b,c,f,
l){this.zKd=this.nVb=this.jGc=this.GBa=this.h3=this.HAa=this.WCd=this.c_=this.HXb=this.KWb=this.LWb=this.hGd=null;this.ae=b;this.Ma=a;this.yq=c;this.Ea=l;this.Eha=f}HQf(){this.c_=document.createElement("div");this.c_.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.c_.style.width=this.h3.width+"px";(this.zKd=this.cqj(this.Eha))?(this.GBa=document.createElement("a"),this.GBa.setAttribute(Ne.a.hf,Ne.a.qQ),this.yq.ub(pa.a.click,this.GBa,Object(H.a)(this,this.Rch,"onRedirectClick")),
this.GBa.href=this.zKd,this.GBa.target="_blank",this.GBa.appendChild(this.h3),this.c_.appendChild(this.GBa)):this.c_.appendChild(this.h3);this.HAa=document.createElement("a");this.HAa.setAttribute(Ne.a.hf,Ne.a.Ou);this.HAa.className="StandardButton WACFloatPaneCloseButton";this.HAa.title=CommonUIStrings.l_Close;this.HAa.tabIndex=-1;this.WCd=tb.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.WCd.setAttribute(Ne.a.hf,Ne.a.qQ);
this.HAa.appendChild(this.WCd);this.yq.ub(pa.a.click,this.HAa,Object(H.a)(this,this.onClose,"onClose"));this.c_.appendChild(this.HAa);this.HXb.appendChild(this.c_)}qk(a){const b=this.Ma.ka("O365PromotionHasStarted");switch(a){case 2:return hh.a.PN(String.format("adppt{0}.png",b?"sale":""));case 1:return hh.a.PN(String.format("adxls{0}.png",b?"sale":""));case 3:return hh.a.PN(String.format("addoc{0}.png",b?"sale":""))}return null}cqj(a){const b=this.Ma.Ha("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,
"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.nVb=null;this.c_&&!this.jGc&&(a?ha.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):ha.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.c_.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.c_.style.height="0px",this.jGc=new pd.a(2,1,1E3,Object(H.a)(this,this.remove,"remove"),67),this.ae.Hb(this.jGc))}remove(){this.c_&&
this.HXb&&(this.GBa&&this.yq.Bb(pa.a.click,this.GBa,Object(H.a)(this,this.Rch,"onRedirectClick")),this.yq.Bb(pa.a.click,this.HAa,Object(H.a)(this,this.onClose,"onClose")),this.HXb.removeChild(this.c_),this.c_=null);this.jGc=null}display(){if(this.hGd=this.Ea.rb("Common.IFloatPaneContainer"))if(this.HXb=this.hGd.container){var a=this.qk(this.Eha);a?(ha.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.h3=document.createElement("img"),this.h3.className="WACFloatPaneImage",
this.LWb=Object(H.a)(this,this.cJk,"onLoadImageFinish"),md.a.addHandler(this.h3,pa.a.load,this.LWb),this.KWb=Object(H.a)(this,this.bJk,"onLoadImageError"),md.a.addHandler(this.h3,pa.a.error,this.KWb),this.h3.src=a):ha.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ha.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ha.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}cJk(){const a=
this.Ma.uc("O365AdPaneShowingDuration",60);this.HQf();this.c_.style.display="block";this.c_.style.height=this.h3.height+"px";this.nVb=new pd.a(2,1,1E3*a,Object(H.a)(this,this.hide,"hide"),67);this.ae.Hb(this.nVb);this.nqh()}bJk(){ha.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.nqh();this.h3=null}nqh(){this.LWb&&this.h3&&md.a.removeHandler(this.h3,pa.a.load,this.LWb);this.LWb=null;this.KWb&&this.h3&&md.a.removeHandler(this.h3,pa.a.error,this.KWb);
this.KWb=null}Rch(){ha.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.nVb&&this.ae.Kg(this.nVb);this.hide();return!0}dispose(){this.hide()}}Object(m.a)(CH,"FloatPane",null,[596]);class YB{constructor(a,b,c,f,l){this.ae=b;this.Ma=a;this.yq=c;this.Ea=l;this.Eha=f}create(){return new CH(this.Ma,this.ae,this.yq,this.Eha,this.Ea)}}Object(m.a)(YB,"FloatPaneFactory",null,[551]);class ZB{constructor(){this.Ea=null}get name(){return"Common.App.FloatPane"}get Cqg(){return w.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&
w.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.Cqg&&(ha.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Ea.resolve("Common.App.FloatPane.IFloatPaneActor").vrc(),ha.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Ea.resolve("Common.App.FloatPane.IFloatPaneActor").zya())}Xb(a){this.Ea=a;this.Cqg&&(this.Ea.register(YB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").oa(()=>
new YB(w.AFrameworkApplication.fa,w.AFrameworkApplication.De,Ad.a.instance,w.AFrameworkApplication.Aa.mb.Ti,this.Ea)).na(),this.Ea.register(XB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").oa(()=>new XB(w.AFrameworkApplication.De,w.AFrameworkApplication.Qa,this.Ea.resolve("Common.App.FloatPane.IFloatPaneFactory"))).na())}dispose(){}static main(){n.a.instance.Ac(new ZB)}}Object(m.a)(ZB,"FloatPanePackage",null,[2,3]);const DH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);
0>a&&(a+=2*Math.PI);return a};class RQ{constructor(a,b,c){this.bQ=this.Apb=this.$rb=null;this.BAa=this.qEd=this.qqa=0;this.QG=this.$Cc=this.IBc=this.HBc=!1;this.FHd=this.vkf=this.xkf=0;this.TOa=a;this.Ca=b;this.j_=c}Mv(a){return Sc.App.Mb.Ld.isEditingAllowed?""!==this.zWc(a.Bc):!1}av(a){if(!this.Mv(a))return!1;this.BAa=this.TOa.a1l();this.ksl(a);this.lsl();({spe:this.$Cc,fse:this.QG}=this.oAh(this.qEd));this.msl();this.$rb=a.$E;this.bQ=new Sys.UI.Point(0,0);({width:this.xkf,height:this.vkf}=this.TOa.VVc());
ha.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}Sw(a){this.Apb=a.$E;this.Eyi();var b=this.bQ.x,c=this.bQ.y;a=this.xkf;var f=this.vkf,l=this.$Cc,y=this.QG,G=1;(b||c)&&a&&f&&(l&&y?(G=a+b,l=f+c,b=1/a,c=1/f,y=b>c?b:c,1>G?G=1:1920<G&&(G=1920),1>l?l=1:1280<l&&(l=1280),b=G-a,c=l-f,G=Math.abs(b/a)>Math.abs(c/f)?G/a:l/f,G<y&&(G=y)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),G=b/a):y&&(b=f+c,1>b?b=1:1280<b&&(b=1280),G=b/f));a=G;this.FHd=a;this.TOa.R2l(this.FHd,this.$Cc,this.QG);return!0}vo(){this.ah();
ha.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}Fu(){this.TOa.e2l();ha.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}lsl(){this.qEd=(Math.floor((this.BAa+22)/45)%8+this.qqa)%8}oAh(a){let b,c;if(this.BAa&&90!==this.BAa&&180!==this.BAa&&270!==this.BAa&&360!==this.BAa||this.y1j(a))return{spe:!0,fse:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{spe:b,fse:c}}msl(){this.IBc=this.HBc=!1;switch(this.qEd){case 0:this.IBc=this.HBc=!0;break;case 1:case 2:this.IBc=
!0;break;case 7:case 6:this.HBc=!0}}y1j(a){return!(a%2)}zWc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}ksl(a){switch(this.zWc(a.Bc)){case "WACImageResizeHandleNW":this.qqa=0;break;case "WACImageResizeHandleN":this.qqa=1;break;case "WACImageResizeHandleNE":this.qqa=2;break;case "WACImageResizeHandleE":this.qqa=
3;break;case "WACImageResizeHandleSE":this.qqa=4;break;case "WACImageResizeHandleS":this.qqa=5;break;case "WACImageResizeHandleSW":this.qqa=6;break;case "WACImageResizeHandleW":this.qqa=7}}Eyi(){var a=1;this.j_.instance&&(a=this.j_.instance.U3);const b=(this.Apb.x-this.$rb.x)/a;a=(this.Apb.y-this.$rb.y)/a;this.bQ.x=this.HBc?-b:b;this.bQ.y=this.IBc?-a:a}ah(){const a=new J.DictionaryPropertySet;a.setValue(we.a.QOj,100*this.FHd);a.setValue(we.a.ROj,!0);if(90===this.BAa||270===this.BAa){let b,c;({spe:b,
fse:c}=this.oAh(this.qqa));a.setValue(we.a.Vkg,b);a.setValue(we.a.Wkg,c)}else a.setValue(we.a.Vkg,this.$Cc),a.setValue(we.a.Wkg,this.QG);this.Ca.Ja(C.a.OOj,2,a)}}Object(m.a)(RQ,"ImageResizeDragAdapter",null,[235]);class $B{constructor(a,b){this.Ca=a;this.j_=b}}Object(m.a)($B,"ImageResizeDragAdapterFactory",null,[507]);class EH{constructor(a,b,c,f,l,y){this.Arb=this.AGc=this.IHd=this.Apb=this.$rb=this.BGc=null;this.eFc=this.JIc=0;this.fy=null;this.Bo=!1;this.Ca=a;this.Uc=b;this.Og=c;this.TOa=f;this.j_=
l;this.oof=this.Jia=0;this.Grb=y}Mv(a){return Sc.App.Mb.Ld.isEditingAllowed&&a?(this.BGc=this.Uc.ak)?!0:!1:!1}av(a){if(!this.Mv(a))return!1;this.BGc=this.Uc.ak;if(this.fy=ba.ImageReader.QEa(this.BGc))return this.$rb=this.Rta(a),this.IHd=Sys.UI.DomElement.getBounds(this.Grb),this.JIc=0<ba.ImageReader.W9f(this.fy)?ba.ImageReader.W9f(this.fy):0,this.eFc=ba.ImageReader.emj(this.fy),ha.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;ha.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");
return!1}Sw(a){this.Apb=this.Rta(a);this.Gyi();if(this.TOa)return this.TOa.KUl(this.Jia,this.oof),ha.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;ha.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}vo(){var a=this.Jia;a%=360;0>a&&(a+=360);this.JIc=this.Jia=a;this.setRotation();ha.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}Fu(){this.TOa.KUl(this.eFc,0);ha.ULS.sendTraceTag(22052888,322,50,
"Image rotate drag event canceled.")}Rta(a){return this.Og.Kka(a)}Gyi(){var a=1;this.j_&&this.j_.instance&&(a=this.j_.instance.U3);var b=new Sys.UI.Point(this.IHd.x+this.Grb.clientWidth/2*a,this.IHd.y+this.Grb.clientHeight/2*a);a=DH(this.$rb,b);b=DH(this.Apb,b);this.Jia=Math.round(Oe.a.bN(b-a));0<this.JIc&&(this.Jia+=this.JIc-this.eFc);this.oof=this.Jia;this.Jia+=this.eFc}setRotation(){const a=new J.DictionaryPropertySet;a.setValue(we.a.POj,0);a.setValue(we.a.X$b,this.Jia);this.Ca.Ja(C.a.imageRotate,
2,a)}dispose(){ha.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.Bo||(this.Arb&&(this.AGc&&this.Arb.contains(this.AGc)&&(this.Arb.removeChild(this.AGc),this.AGc=null),this.Grb&&this.Grb.contains(this.Arb)&&(this.Grb.removeChild(this.Arb),this.Arb=null)),this.Bo=!0)}}Object(m.a)(EH,"ImageRotateDragAdapter",null,[545,235,108]);class aC{constructor(a,b,c){this.Ca=a;this.Uc=b;this.j_=c}create(a,b,c){return new EH(this.Ca,this.Uc,a,b,this.j_,c)}}Object(m.a)(aC,"ImageRotateDragAdapterFactory",
null,[506]);class bC{constructor(){this.Ea=null}get name(){return"Box4.Images"}Xb(a){this.Ea=a;this.Ea.register($B,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").na().oa(()=>new $B(w.AFrameworkApplication.Qa,Fb.a.instance.Ia("Common.IZoomManager")));this.Ea.register(aC,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").na().oa(()=>new aC(w.AFrameworkApplication.Qa,ze.a.instance,Fb.a.instance.Ia("Common.IZoomManager")))}init(){this.Ea.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){n.a.instance.Ac(new bC)}}
Object(m.a)(bC,"Box4ImagesPackage",null,[2,3]);class FH{create(a){return new hd.a(a)}}Object(m.a)(FH,"Factory",null,[517]);var $y=d(448);class GH{constructor(){this.Vi=null}get key(){return"COMMENTTEXTANCHOR"}get E8(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Vi=Object(sa.a)(Kf.AParagraphNode,a.node)}cxc(a){a=(a=this.sgj(a))?Object.assign(new $y.a,{N1:this.key,vQ:a}):null;return{returnValue:!!a,pCa:a}}sgj(a){if(!this.Vi.Sa)return null;const b=new Oa.a;for(let c=0;c<this.Vi.Sa.length;c++){const f=
this.Vi.Sa.ga(c);if(f.cp>a)break;if(f.Bg)for(let l=0;l<f.Bg.length;l++){const y=f.Bg.ga(l);y.Jk?b.add(y.RI.guid.toString()):b.remove(y.RI.guid.toString())}}return 0<b.count?b.ga(0):null}}Object(m.a)(GH,"CommentTextAnchorDetailsProvider",null,[703,328]);class vx{constructor(){this.Vi=null}get E8(){return null}getTitle(){return null}h8f(){return null}reset(a){this.Vi=a.node}cxc(a){const b=Ee.d(this.Vi,a);a=null;if(!b||b.Cq!==this.Cq)return{returnValue:!1,pCa:a};a=Object.assign(new $y.a,{N1:this.key,
vQ:b,title:this.getTitle(b),description:this.h8f(b)});return{returnValue:!0,pCa:a}}}Object(m.a)(vx,"BlobDetailsProvider",null,[703,328]);class HH extends vx{constructor(){super()}get key(){return"EQUATION"}get Cq(){return 11}get E8(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(m.a)(HH,"EquationDetailsProvider",vx,[]);class IH{constructor(){this.hkf=null}get key(){return"LINK"}get E8(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.hkf=jb.HyperlinkReader.e8b(a.node)}cxc(a){let b;
b=null;for(const c of this.hkf)if(c.Ra<=a&&a<c.Lb)return b=Object.assign(new $y.a,{N1:this.key,vQ:c.hyperlink}),{returnValue:!0,pCa:b};return{returnValue:!1,pCa:b}}}Object(m.a)(IH,"HyperlinkDetailsProvider",null,[703,328]);class JH extends vx{constructor(){super()}get key(){return"IMAGE"}get Cq(){return 5}get E8(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return ba.ImageReader.DWc(a.properties)}h8f(a){return ba.ImageReader.Sbe(a.properties)}}Object(m.a)(JH,"ImageDetailsProvider",
vx,[]);class az{constructor(){this.description=this.contentId=this.vQ=this.N1=null}}Object(m.a)(az,"StructuralContentDetails",null,[474]);class KH{get key(){return"IMAGENODE"}get E8(){return Box4Intl.Box4Strings.l_ImageContentTitle}x9e(a){let b;b=null;if(!a||!ba.ImageReader.xH(a.currentNode))return{returnValue:!1,yvb:b};b=Object.assign(new az,{N1:this.key,contentId:a.currentNode.id,vQ:a.currentNode});return{returnValue:!0,yvb:b}}JVc(a,b){a=a.vQ;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.vQ.id||(f=String.format(c,ba.ImageReader.DWc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(m.a)(KH,"ImageNodeDetailsProvider",null,[327,328]);let wx,xx;class cs{constructor(a,b){this.Ghf=null;this.Tm=b;this.INd=a;this.mWb=cs.keys.ga(a);this.ZYh=cs.AKi.ga(a)}get key(){return this.mWb}get E8(){return this.ZYh}reset(a){this.Ghf=this.Tm.VF(a.node)}cxc(a){var b=cs.b9i(this.Ghf||[],c=>this.VYj(a,c));b=this.yNi(b);return{returnValue:!!b,pCa:b}}VYj(a,b){return b.begin<=
a&&a<b.end&&(!b.Fh||this.INd===b.Fh.proofingType)}yNi(a){return a?Object.assign(new $y.a,{N1:this.key,vQ:a.Fh,description:this.yae()}):null}yae(){return w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static b9i(a,b){for(const c of a)if(b(c))return c;return null}}cs.keys=(xx=new Pb.a,xx.add(1,"SPELLINGERROR"),xx.add(2,"GRAMMATICALERROR"),xx.add(3,"ADVANCEDERROR"),xx);cs.AKi=(wx=new Pb.a,
wx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),wx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),wx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),wx);Object(m.a)(cs,"ProofingDetailsProvider",null,[703,328]);class LH{constructor(){this.tableNode=null;this.GNc=this.xrd=this.columns=this.rows=0}}Object(m.a)(LH,"TableInfo",null,[]);var eo=d(150),ae=d(85),Dk=d(128);class MH{get key(){return"TABLE"}get E8(){return Box4Intl.Box4Strings.l_TableContentTitle}x9e(a){var b=
null;if(!Oc.isTableCell(a))return{returnValue:!1,yvb:b};b=new ub.GraphIterator;b.Tc(a);a=new LH;a.xrd=Dk.c(b)+1;a.GNc=eo.a(b)+1;ae.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=Hd.TableReader.Gi(a.tableNode);a.rows=Hd.TableReader.Ek(a.tableNode);b=Object.assign(new az,{N1:this.key,contentId:a.tableNode.id,vQ:a});return{returnValue:!0,yvb:b}}JVc(a,b){a=a.vQ;const c=new Ji.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.vQ.GNc===a.GNc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.GNc));b&&b.vQ.xrd===a.xrd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.xrd));return c.toArray().join(" ")}}Object(m.a)(MH,"TableDetailsProvider",null,[327,328]);class cC{constructor(a,b){this.L0h=a;this.Tm=b}hWe(){this.L0h.execute(a=>{a.z0a(new IH);a.z0a(new cs(1,this.Tm));a.z0a(new cs(2,this.Tm));a.z0a(new cs(3,this.Tm));a.z0a(new HH);a.z0a(new JH);a.z0a(new GH);a.tWe(new MH);a.tWe(new KH)})}}
Object(m.a)(cC,"AccessibilityActor",null,[]);class dC{constructor(a,b,c){this.GZb=a;this.qd=b;this.pXh=c}vb(){this.GZb.ra(C.a.ONk,rb.a.view,Object(H.a)(this,this.PNk,"openAutoCorrectOptionsView"),1028)}PNk(a,b,c){if(1===c)return 32;this.pXh().Kuc();return 32}}Object(m.a)(dC,"AutoCorrectActor",null,[]);class eC{constructor(a){this.n3h=a}S3j(a){if(!a||!a.zw||1>a.zw.count)return!1;const b=[uc.a.tTi,uc.a.sTi];return!!this.rVc(a.zw,1,c=>this.lOc(c,b))}Ppg(a){return!a||!a.zw||1>a.zw.count?!1:!!this.rVc(a.zw,
1,b=>this.lOc(b,[uc.a.$N]))}g1j(a){return!a||!a.zw||1>a.zw.count?!1:!!this.rVc(a.zw,2,b=>this.lOc(b,[uc.a.Idc]))}vl(a){return!a||!a.zw||1>a.zw.count?!1:!!this.rVc(a.zw,1,b=>this.lOc(b,[uc.a.pga]))}n2c(a){if(!a||!a.zw)return!1;a=a.zw;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).gri)return!1;return!0}k3i(a,b){return this.Ppg(b)||this.g1j(b)?"":a}get l3c(){return this.n3h}rVc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}lOc(a,
b){a=a&&a.mkg?a.mkg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(m.a)(eC,"Box4PasteStewardUtils",null,[649]);class NH{constructor(){this.zZ=0;this.OCb=Array(9)}}Object(m.a)(NH,"FullListMetadata",null,[]);class bz{constructor(){this.level=0;this.vNa=null;this.zZ=0;this.g6i=this.foc=null;this.aKb=!1}}Object(m.a)(bz,"ListItemMetadata",null,[]);class lu{constructor(){this.GZ=[]}G7f(){const a=new lu;for(let b=0;b<this.GZ.length;b++)a.add(this.ga(b));
return a}get count(){return this.GZ.length}ga(a){return this.GZ[a]}$(a,b){return this.GZ[a]=b}add(a){Array.add(this.GZ,a)}clear(){Array.clear(this.GZ)}contains(a){return Array.contains(this.GZ,a)}indexOf(a){return Array.indexOf(this.GZ,a)}insert(a,b){Array.insert(this.GZ,a,b)}remove(a){return Array.remove(this.GZ,a)}removeAt(a){Array.removeAt(this.GZ,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.GZ,a)}reverse(){this.GZ.reverse()}sort(){this.GZ.sort()}toArray(){return Array.clone(this.GZ)}}
Object(m.a)(lu,"List",null,[]);class OH{constructor(){this.level=0;this.tagName="UL";this.$Za=null;this.ignore=!1;this.Pmc=0;this.listStyle="BulletListStyle1";this.Z9=new lu;this.font=this.levelText=""}}Object(m.a)(OH,"ListLevelMetadata",null,[]);class fC{constructor(){this.zxg={};this.TPc=-1}}Object(m.a)(fC,"LevelLists",null,[]);class gC{constructor(a){this.nodes=a;this.S3=0;this.lists={};this.Z9=[];this.DCb=null;this.$ja=[];this.$ja[0]=new fC}}Object(m.a)(gC,"WordConverterArguments",null,[]);class PH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(m.a)(PH,"AbsolutePosition",null,[]);class vn{constructor(a,b,c,f,l){this.cultureName=this.r6=this.zw=this.ZU=null;a&&(this.ZU=a);b&&(this.zw=b);this.r6=c?c:new Oa.a;f&&""!==f&&(this.cultureName=f);this.Xia=l}}Object(m.a)(vn,"GlobalAttributesArgs",null,[]);class mu{constructor(a,b,c="",f=0){this.mw=!1;this.Zjf=this.$jf=null;let l=!1;mu.D0j(a)&&(l=!0,this.$jf=a);mu.S0j(b)&&(this.Zjf=b);this.B1h=c;this.kXh=f;this.mw=l&&this.J$b?!0:!1}get isValid(){return this.mw}get okg(){return this.$jf}get J$b(){return this.Zjf}get mkg(){return this.B1h}get gri(){return this.kXh}static D0j(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static S0j(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(m.a)(mu,"HtmlElementInfo",null,[]);class QH{constructor(a){this.next=null;this.data=a}}Object(m.a)(QH,"StackNode",null,[]);class yx{constructor(){this.vv=null;this.pn=0}get count(){return this.pn}get isEmpty(){return!this.pn||!this.vv}push(a){a=new QH(a);a.next=this.vv;this.vv=a;this.pn++}peek(){return this.isEmpty?null:this.vv.data}pop(){if(this.isEmpty)return null;const a=this.vv;this.vv=a.next;
this.pn--;return a.data}clear(){this.vv=null;this.pn=0}toArray(){const a=Array(this.count);let b=this.vv;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(m.a)(yx,"Stack",null,[]);class wh{constructor(a){this.WUb=this.WEc=null;this.dBc=!1;this.Mg=a}get oSa(){return this.WUb.peek()}reset(){this.Mg.reset();this.WEc=new yx;this.WUb=new yx;this.WUb.push(this.Mg.w4b);this.dBc=!1}Zid(){this.dBc=!1}FD(a){this.dBc||(this.WEc.push(null),this.dBc=!0);this.WEc.push(a)}onClose(){for(;;){const a=
this.WEc.pop();if(!a)break;a()}}gzh(){return!1}qDk(){this.Jq(()=>!0)}Jq(a){const b=this.oSa.clone();return a(b)?(this.WUb.push(b),this.Mg.poa(b),this.FD(Object(H.a)(this,this.DHk,"onFormattingEnd")),!0):!1}oge(a){return a.style?this.Jq(b=>this.gzh(b,a))?1:2:2}DHk(){this.WUb.pop();this.Mg.poa(this.oSa)}E1(){}Tid(){return 2}iMe(){return 2}jMe(){return 2}lMe(){return 2}sMe(){return 3}vMe(){}Xid(){return 2}wMe(){}xMe(){}yMe(){return 2}cjd(){return 2}djd(){return 2}KMe(){return 2}ejd(){}PMe(){return 2}fjd(){return 2}hjd(){return 2}kjd(){return 2}mjd(){return 2}$Me(){}aNe(){return 2}pjd(){return 2}qjd(){return 2}sjd(){return 2}tjd(){return 2}vjd(){return 2}wjd(){return 2}xjd(){return 2}Ajd(){return 2}xNe(){return 2}Ijd(){return 2}DNe(){return 2}ENe(){}FNe(){return 2}Njd(){return 2}Ojd(){return 2}Pjd(){return 2}Qjd(){return 2}Rjd(){return 2}Sjd(){return 2}KNe(){return 3}Tjd(){}MNe(){return 2}Ujd(){return 2}ONe(){return 3}Vjd(){}RNe(){}Wjd(){return 2}YNe(){return 3}Xjd(){return 2}Zjd(){return 2}akd(){return 2}bkd(){return 2}aOe(){}bOe(){return 3}fkd(){return 2}lJb(){return 2}eOe(){}hOe(){return 2}iOe(){return 2}jOe(){return 3}mkd(){return 2}kOe(){return 2}qkd(){return 2}tkd(){return 2}lOe(){}Fkd(){return 2}tOe(){return 2}Nkd(){return 2}Okd(){return 2}EOe(){return 3}FOe(){return 2}Xkd(){return 2}Ykd(){return 2}Zkd(){return 2}$kd(){return 2}LOe(){return 3}ald(){return 2}dld(){return 2}hld(){return 2}OOe(){return 2}Unc(){return 2}QOe(){return 2}ROe(){return 2}ild(){return 2}SOe(){return 2}UOe(){return 3}jld(){return 2}mld(){return 2}nld(){return 2}old(){return 2}qld(){return 2}static gua(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(na.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static Uvj(a){if(!a||""===a)return-1;const b=na.a.ug(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(na.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(na.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static Bbg(a){return a&&""!==a?wh.gua(a):null}static Qy(a){let b=null,c=null,f=null,l=null;a&&a.Yf&&(b=wh.Wta(a.Yf,"id"),c=wh.Wta(a.Yf,"lang"),f=a.Yf.tagName,
a.xoi&&(l=Object.assign(new PH,{x:wh.gua(a.Yf.style.left),y:wh.gua(a.Yf.style.top),left:wh.Bbg(a.Yf.style.left),top:wh.Bbg(a.Yf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new vn(new mu(b,f),a.zw,null,c,l)}static Wta(a,b){return a[b]}}Object(m.a)(wh,"AHtmlTranslator",null,[750]);class RH extends vn{constructor(a,b,c,f=0,l=0,y=null){super(y?y.ZU:null,y?y.zw:null,y?y.r6:null,y?y.cultureName:null,y?y.Xia:null);this.width=f;this.height=l}}Object(m.a)(RH,"AugmentationSemanticArgs",vn,[]);
class SH{constructor(){this.stop=this.color=null}}Object(m.a)(SH,"ColorStopPair",null,[]);class cz{constructor(a,b){this.value=a;this.Eaj=b}get o2c(){return this.Eaj}}Object(m.a)(cz,"ElementValueWrapper",null,[]);class TH extends cz{constructor(a,b,c){super(a,b);this.stg=c}}Object(m.a)(TH,"DimensionWrapper",cz,[]);class hC{constructor(a=0,b=0,c=0,f=0,l="",y="",G="",R="",ja="0pt",za="0pt",Va="0pt",hb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=y;this.borderBottomColor=G;this.borderLeftColor=R;this.borderTopWidth=ja;this.borderRightWidth=za;this.borderBottomWidth=Va;this.borderLeftWidth=hb}}Object(m.a)(hC,"TableCellBorderProperties",null,[]);class iC{constructor(a="",b="",c="",f=""){this.WAi=a;this.VAi=b;this.TAi=c;this.UAi=f}}Object(m.a)(iC,"TableCellMarginProperties",null,[]);class dh{static get nkg(){return dh.D1h}static get Vwd(){return dh.rai}static get Rwd(){return dh.pai}static Gfe(a,
b,...c){b=dh.gfg(b);let f=!1;b||(b=dh.rAj.apply(null,[a].concat(c)),f=!!b);return new cz(b,f)}static gfg(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static rAj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static prj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(ve.a.Iaa(b,0,!1));case "in":return Math.round(ve.a.f0(b,
0,!1));case "cm":return Math.round(ve.a.f0(Oe.a.RKf(b),0,!1));case "mm":return Math.round(ve.a.f0(Oe.a.RKf(.1*b),0,!1));default:return b}}static drd(a,b,...c){a=dh.Gfe.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=na.a.substring(a.value,0,a.value.length-1)):a.o2c?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=na.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=dh.prj(c,f)}return new TH(c,a.o2c,b)}static szb(a){return dh.drd(a,
[a.style.width],"width","WIDTH","Width")}static hab(a){return dh.drd(a,[a.style.height],"height","HEIGHT","Height")}static Bce(a){return dh.drd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static Cce(a){return dh.drd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static yAj(a){a=dh.Gfe(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in dh.Vwd&&void 0!==dh.Vwd[a.value]&&null!==dh.Vwd[a.value]?dh.Vwd[a.value]:0}static h8j(a){a=
dh.gfg([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static gej(a){return dh.Gfe(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static iLi(a){const b=na.a.substring(a,0,1),c=na.a.substring(a,1,2);a=na.a.substring(a,2,3);return b+b+c+c+a+a}static jda(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=na.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return na.a.pC(b)}if(dh.nkg[na.a.ug(b)])return dh.nkg[na.a.ug(b)];b.startsWith("#")&&(b=na.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=dh.iLi(b));return 6!==b.length?"":b}static dRk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static iZc(a,b){const c=dh.gej(a);c&&""!==c&&b.Jq(f=>f.jtd(dh.jda(c)))}static J6f(a){a=a.style;if(!a)return null;const b=dh.Rwd[a.borderTopStyle],c=dh.jda(a.borderTopColor),f=a.borderTopWidth,l=dh.Rwd[a.borderRightStyle],y=dh.jda(a.borderRightColor),G=a.borderRightWidth,R=dh.Rwd[a.borderBottomStyle],ja=dh.jda(a.borderBottomColor),za=a.borderBottomWidth,Va=dh.Rwd[a.borderLeftStyle],hb=dh.jda(a.borderLeftColor);return new hC(b,l,R,Va,
c,y,ja,hb,f,G,za,a.borderLeftWidth)}static ffj(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new iC(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}dh.D1h=ta.a.kI("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");dh.rai=ta.a.kI("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);dh.pai=ta.a.kI("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(m.a)(dh,"DefaultHtmlTranslatorHelper",null,[]);class UH{constructor(){this.direction=null;this.I2b=new lu}Jig(){return!!this.direction&&0<this.direction.length}}Object(m.a)(UH,"LinearGradient",null,[]);class jC{constructor(){this.rqe=this.gbc=!1}}Object(m.a)(jC,"HtmlTranslatorContext",null,[]);class kC{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,y=!1,G=!0,R=!1,ja=!0,za=!0,Va=!0,hb=
!1,Cb=!1,lc=!1,ic=!1,yc=!1,ec=!1,jc=!1,xd=!1,Xd=null,Qd=null,Ie=null,Pe=null,ig=null,ff=null,bh=null){this.gbc=!1;this.Uyl=ch=>this.sqe&&ch.rqe;this.Y6h=a;this.c7h=b;this.V6h=c;this.b7h=f;this.V9h=l;this.T9h=y;this.O9h=G;this.P9h=R;this.R9h=ja;this.S9h=za;this.Q9h=Va;this.d$h=hb;this.r$h=Cb;this.c$h=lc;this.gai=ic;this.Y9h=yc;this.b2h=ec;this.N2h=jc;this.hDc=xd;this.X9h=Xd;this.b$h=Qd;this.U9h=ff;this.$9h=Pe;this.W9h=ig;this.Z9h=bh;this.a$h=Ie}get K_a(){return this.Y6h}get WRk(){return this.c7h}get ahh(){return this.V6h}get VRk(){return this.b7h}get TCh(){return this.V9h}get SCh(){return this.T9h}get Zwl(){return this.O9h}get $wl(){return this.P9h}get bxl(){return this.R9h}get dxl(){return this.S9h}get axl(){return this.Q9h}get T1a(){return this.Y9h}get rTj(){return this.b2h}get XCh(){return this.d$h}get Myl(){return this.r$h}get lxl(){return this.c$h}get oHl(){return this.gai}get PVa(){return this.N2h}get sqe(){return this.hDc}get UCh(){return this.X9h||
Object(H.a)(this,this.grd,"returnFalse")}get kxl(){return this.b$h||Object(H.a)(this,this.grd,"returnFalse")}get jxl(){return this.$9h||Object(H.a)(this,this.aZe,"returnTrue")}get fxl(){return this.W9h||Object(H.a)(this,this.aZe,"returnTrue")}get exl(){return this.U9h||Object(H.a)(this,this.grd,"returnFalse")}get ixl(){return this.Z9h||Object(H.a)(this,this.aZe,"returnTrue")}get WCh(){return this.a$h||this.Uyl||Object(H.a)(this,this.grd,"returnFalse")}aZe(){return!0}grd(){return!1}}Object(m.a)(kC,
"HtmlTranslatorSettings",null,[432]);class VH extends vn{constructor(a,b,c,f,l=null,y=0,G=0,R=null,ja=null){super(l?l.ZU:null,l?l.zw:null,l?l.r6:null,l?l.cultureName:null,l?l.Xia:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=y;this.maxHeight=G;this.href=R;this.desc=ja}}Object(m.a)(VH,"ImageSemanticArgs",vn,[]);class WH{constructor(a,b){this.kEl=a;this.jEl=b}}Object(m.a)(WH,"IndentationProperties",null,[]);class zx extends vn{constructor(a,b,c,f=0,l=-1,y=!1,G=!1,R="",ja="",za=
null,Va=-1){super(c?c.ZU:null,c?c.zw:null,c?c.r6:null,c?c.cultureName:null,c?c.Xia:null);this.Xqf=a;this.HWb=0;this.lQd=b;this.JVb=1===b&&-1===l&&!this.w4a;this.AKd=f;this.BKd=l;this.XMd=y;this.w4a=G;this.p5a=R;this.Ipb=ja;this.Fzc=za;this.ozc=Va;this.fpb=-1;this.vIc=!0}get listStyleType(){return this.e2j?this.HWb:this.Xqf}get e2j(){return 0!==this.HWb}get EFl(){return this.lQd}get listLevel(){return this.BKd}set listLevel(a){this.BKd=a}get listId(){return this.AKd}set listId(a){this.AKd=a}get aKb(){return this.XMd}set aKb(a){this.XMd=
a}get d$a(){return this.w4a}set d$a(a){this.w4a=a}get levelText(){return this.p5a}set levelText(a){this.p5a=a}get font(){return this.Ipb}set font(a){this.Ipb=a}get HRa(){return this.Fzc}set HRa(a){this.Fzc=a}get gub(){return this.ozc}set gub(a){this.ozc=a}get Brg(){return 6<=this.listStyleType}get TWj(){return this.JVb}get HTi(){return this.vIc?this.lQd+this.fpb:this.fpb}clone(){const a=new zx(this.Xqf,this.lQd,new vn(this.ZU,this.zw,this.r6,this.cultureName,this.Xia),this.AKd,this.BKd,this.XMd,this.w4a);
a.HWb=this.HWb;a.JVb=this.JVb;a.fpb=this.fpb;a.vIc=this.vIc;a.p5a=this.p5a;a.Ipb=this.Ipb;a.Fzc=this.Fzc;a.ozc=this.ozc;return a}Xoi(a,b,c){this.HWb=a;0<b?(this.JVb=!1,this.fpb=b,this.vIc=!1):(this.fpb++,this.JVb=!c)}}Object(m.a)(zx,"ListSemanticArgs",vn,[]);class dz extends vn{constructor(a,b,c,f,l=null,y=0,G=null,R=null,ja=!1,za=!1,Va=69905,hb=null){super(hb?hb.ZU:null,hb?hb.zw:null,hb?hb.r6:null,hb?hb.cultureName:null,hb?hb.Xia:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.eCb=za;this.height=
f;this.qGa=ja;this.Utc=l;this.verticalAlignment=y;this.X6=G;this.Swd=R;this.NMc=Va}}Object(m.a)(dz,"TableCellSemanticArgs",vn,[]);class lC extends vn{constructor(a,b=null){super(b?b.ZU:null,b?b.zw:null,b?b.r6:null,b?b.cultureName:null,b?b.Xia:null);this.height=a}}Object(m.a)(lC,"TableRowSemanticArgs",vn,[]);class mC extends vn{constructor(a,b,c,f,l,y,G,R,ja,za=null,Va=-1,hb=null){super(hb?hb.ZU:null,hb?hb.zw:null,hb?hb.r6:null,hb?hb.cultureName:null,hb?hb.Xia:null);this.SRa=null;this.jV=a;this.Dsa=
b;this.width=c;if(l)for(this.SRa=Array(l.length),a=0;a<l.length;++a)this.SRa[a]=l[a];this.Cog=y;this.S6e=R;this.lXj=G;this.qGa=f;this.fje=ja;this.sIh=za;this.tableLook=Va}}Object(m.a)(mC,"TableSemanticArgs",vn,[]);let ds;class Jl extends wh{constructor(a,b=null,c=null,f=null){super(a);this.u5a=null;this.G4h=ta.a.kI("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Yc=b||new kC;this.Rt=c||new jC;this.DKd=f}get vxg(){return this.G4h}T$f(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.vxg[na.a.ug(c)])||(c=wh.Wta(a,"type"))&&""!==c&&(c=this.vxg[c]))return c;if(this.Yc.K_a&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=Jl.BYc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=Jl.BYc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}M$f(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=Ga.a.X8f(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.aVc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=Ga.a.X8f(a,"p"))return Jl.Inj(a)-1}return b}aVc(a,b,c){a=this.Yc.K_a?a.getAttribute(b):wh.Wta(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}YIk(){this.u5a.pop();this.Mg.soa()}Q9b(a,b){this.Jq(l=>l.TLa(0,0));const c=this.T$f(a.Yf,b?6:2);let f=1;b&&(f=this.aVc(a.Yf,"start",1));b=!1;this.Yc.K_a&&(b=a.Yf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Yf.removeAttribute("data-pasteFromRc"),(z.a.gU||z.a.mg)&&Jl.nNc(a.Yf));a=new zx(c,f,wh.Qy(a),0,-1,b,this.Yc.K_a);this.u5a.push(a);this.Mg.uoa(a);this.FD(Object(H.a)(this,this.YIk,"onListElementClose"));return 1}reset(){super.reset();this.u5a=new yx}gzh(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||wh.Wta(b,"lang")}catch(ja){f=null}f&&""!==f&&(c=a.Q0e(f)||c);(f=wh.Wta(b,"dir"))&&(c=a.BOb(f)||c);f=b.style;var l=this.Yc.sqe&&this.Rt.rqe;if(f){if(f.fontWeight){var y=na.a.pC(f.fontWeight),G=parseInt(y);isNaN(G)?"BOLD"===y?c=a.eI(!0)||c:"NORMAL"===y&&(c=a.eI(!1)||c):c=600<=G?a.eI(!0)||c:a.eI(!1)||c}this.Yc.SCh&&f.fontSize&&!l&&(y=Math.round(wh.Uvj(f.fontSize)),0<y&&(c=a.NNb(Math.floor(2*y))||c));this.Yc.jxl(this.Rt)&&(this.Yc.XCh&&b.getAttribute?
(y=b.getAttribute("data-indent"))&&0<y.length&&(y=ve.a.xK(parseInt(y),0)+"px",c=a.dud(y)||c):f.textIndent&&(c=a.dud(f.textIndent)||c));this.Yc.fxl(this.Rt)&&f.marginLeft&&(this.Yc.XCh&&b.getAttribute?(y=b.getAttribute("data-margin"))&&0<y.length&&(c=a.vtc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.vtc(f.marginLeft)||c));this.Yc.exl(this.Rt)&&f.lineHeight&&(c=a.f2(f.lineHeight)||c);if(this.Yc.axl)if(y=f.fontVariantCaps?na.a.ug(f.fontVariantCaps):null,G=f.fontVariant?na.a.ug(f.fontVariant):null,"uppercase"===
(f.textTransform?na.a.ug(f.textTransform):null))c=a.cud("uppercase")||c;else if("small-caps"===y||G&&0<=G.indexOf("small-caps"))c=a.cud("small-caps")||c;this.Yc.ixl(this.Rt)&&f.textAlign&&(c=a.Glb(na.a.ug(f.textAlign))||c);f.fontStyle&&(y=na.a.pC(f.fontStyle),"ITALIC"===y||"OBLIQUE"===y?c=a.y1a(!0)||c:"NORMAL"===y&&(c=a.y1a(!1)||c));y=Jl.qyj(b);if(f.textDecoration||y){G=na.a.ug(f.textDecoration||"");y=na.a.ug(y||"");if(b.parentNode&&b.parentNode.tagName&&"a"===na.a.ug(b.parentNode.tagName)){var R=
(b.querySelector(".TextRun")||b).className;R&&-1<R.indexOf("Underlined")&&(c=a.iZ(!0)||c)}else if(f.K2l||Jl.uE(G)||Jl.uE(y))c=a.iZ(!0)||c;if(f.J2l||Jl.Arg(G)||Jl.Arg(y))c=a.gZ(!0)||c}if(f.verticalAlign){y=na.a.pC(f.verticalAlign);if("SUB"===y||this.Yc.WCh(this.Rt)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.M6(!0)||c;else if("SUPER"===y||this.Yc.WCh(this.Rt)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.hZ(!0)||c;this.Yc.SCh&&("SUB"===y||"SUPER"===y)&&b.getAttribute&&(y=parseFloat(b.getAttribute("data-fontsize")),
isNaN(y)||(c=a.H0e(Math.floor(2*y))||c))}this.Yc.dxl&&f.fontFamily&&!l&&(this.Yc.PVa?c=this.G0e(a,f.fontFamily,c):this.Yc.lxl&&b.getAttribute?(y=b.getAttribute("data-usefontface"))&&"true"===y&&(c=this.G0e(a,f.fontFamily,c)):c=this.G0e(a,f.fontFamily,c));y=null;this.Yc.bxl&&f.color&&(y=dh.jda(f.color));G=!!y;this.Yc.kxl(this.Rt)&&b.getAttribute&&(G=b.getAttribute("data-scheme-color"),y=null!==G?G:y,G="inherit"!=f.color&&(""!==y||!this.Rt.gbc||Jl.E8j(b))&&!l);G&&(c=a.vr(y)||c);this.Yc.Zwl&&!this.Rt.gbc&&
f.backgroundColor&&!l&&(this.Yc.WRk&&b.tagName&&Jl.bJl.contains(na.a.pC(b.tagName))||(c=a.qpa(dh.jda(f.backgroundColor))||c));if(this.Yc.$wl&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&!l&&(l=Jl.sAj(f.backgroundImage))&&0<l.I2b.count){y=l.I2b.ga(0).color;G=!0;for(R=0;R<l.I2b.count&&(G=G&&y===l.I2b.ga(R).color,G);R++);G&&(ha.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.qpa(dh.jda(y))||c)}}this.Yc.UCh(this.Rt)&&b.getAttribute&&(l=b.getAttribute("data-ccp-props"))&&
(c=a.spa(l)||c);if(b.getAttribute){if(l=b.getAttribute("data-ccp-charstyle"))w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Yc.T1a&&(c=a.Nga(l)||c);if(l=b.getAttribute("data-ccp-parastyle"))w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Yc.T1a&&(c=a.Itd(l)||c);"true"==b.getAttribute("data-hyperlinkhascustomcolor")&&(ha.ULS.sendTraceTag(508900183,307,
50,"Paste hyperlink with custom color"),b=null,f.color&&(b=dh.jda(f.color),a.x1a(!1)),c=a.vr(b)||c)}return c}Lyl(a){if(this.Yc.Myl)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===String&&-1<na.a.pC(a.className).indexOf("MSOCOM"))return!0;if("DIV"===na.a.pC(a.tagName))break;a=a.parentNode}return!1}G0e(a,b,c){b=this.l9f(b);return a.MLa(b,this.Yc.oHl)||c}E1(a,b){"\u200b"===a&&(a="\u00a0");b&&b.Yf&&this.Lyl(b.Yf)&&(a="");this.Mg.E1(a,wh.Qy(b))}Tid(a){const b=wh.Wta(a.Yf,
"href");return b&&""!==b?(this.Mg.Exa(b,wh.Qy(a)),this.FD(Object(H.a)(this.Mg,this.Mg.Dxa,"onAnchorEnd")),1):2}Xid(){return this.Jq(a=>a.eI(!0))?1:2}cjd(){return this.Jq(a=>a.lge())?1:2}djd(a){this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}ejd(a){this.Mg.roa(wh.Qy(a))}fjd(a){this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}kjd(){return this.Jq(a=>a.y1a(!0))?1:2}hjd(a){this.Jq(b=>b.Glb("center"));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,
this.Mg.PA,"onParagraphEnd"));return 1}mjd(){return this.Jq(a=>a.MLa("consolas"))?1:2}qjd(){return this.Jq(a=>a.gZ(!0))?1:2}pjd(a){return this.Q9b(a,!1)}sjd(){return this.Jq(a=>a.y1a(!0))?1:2}tjd(a){return this.Q9b(a,!1)}vjd(a){var b=a.Yf.getAttribute("data-render-src");const c=a.Yf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const G=a.Yf.getAttribute("data-render-fallback");let R=0,ja=0;if(a.Yf.currentStyle){var f=a.Yf.currentStyle.width,l=a.Yf.currentStyle.height;f&&-1!==f.indexOf("px")&&
(f=parseInt(na.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(R=f));l&&-1!==l.indexOf("px")&&(l=parseInt(na.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(ja=l))}a=new RH(b,c,G,R,ja,wh.Qy(a));this.Mg.y_a(a);return 2}this.Yc.K_a&&(z.a.gU||z.a.mg)&&(b=a.Yf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Yc.K_a&&b&&b.length&&Jl.nNc(a.Yf));const y=a.Yf.getAttribute("align");this.Jq(G=>G.Glb(y));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}wjd(a){this.Mg.QA(wh.Qy(a));
this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}xjd(a){this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}Ajd(){return this.Jq(a=>a.y1a(!0))?1:2}Ijd(a){return this.Jq(b=>{var c=this.l9f(a.Yf.getAttribute("face"));c=b.MLa(c);b=b.vr(dh.jda(a.Yf.getAttribute("color")));return c||b})?1:2}Njd(a){this.Jq(b=>this.Yc.T1a?b.E1a(1):b.F1a(1));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}Ojd(a){this.Jq(b=>this.Yc.T1a?
b.E1a(2):b.F1a(2));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}Pjd(a){this.Jq(b=>this.Yc.T1a?b.E1a(3):b.F1a(3));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}Qjd(a){this.Jq(b=>this.Yc.T1a?b.E1a(4):b.F1a(4));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}Rjd(a){this.Jq(b=>this.Yc.T1a?b.E1a(5):b.F1a(5));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));
return 1}Sjd(a){this.Jq(b=>this.Yc.T1a?b.E1a(6):b.F1a(6));this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}Tjd(a){this.Mg.roa(wh.Qy(a))}Vjd(a){var b=a.Yf;const c=b.src,f=b.alt,l=b.y1l;let y=0,G=0;b.style&&(y=wh.gua(b.style.width),G=wh.gua(b.style.height));y&&G||(y=b.width,G=b.height);let R=b=0;a.Yf.currentStyle&&(y||G||(y=wh.gua(a.Yf.currentStyle.width),G=wh.gua(a.Yf.currentStyle.height)),b=wh.gua(a.Yf.currentStyle.maxWidth),R=wh.gua(a.Yf.currentStyle.maxHeight));
a=new VH(c,f,y,G,wh.Qy(a),b,R,l);this.Mg.qoa(a)}Ujd(){return this.Jq(a=>a.y1a(!0))?1:2}Wjd(){return this.Jq(a=>a.iZ(!0))?1:2}Xjd(){return this.Jq(a=>a.MLa("consolas"))?1:2}Zjd(a){this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}akd(a){this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}bkd(a){let b;const c=this.T$f(a.Yf,0);let f=this.aVc(a.Yf,"value",0);var l=!1;0<this.u5a.count?b=this.u5a.peek():(b=new zx(2,1,wh.Qy(a)),f||
(f=1));if(this.Yc.K_a){l=b.listLevel;let ja=b.listId;this.Yc.TCh?(l=this.M$f(a.Yf),l=0>l&&0>b.listLevel&&0<this.u5a.count?b.listLevel=this.u5a.count-1:b.listLevel=0<=l?l:b.listLevel,this.DKd&&this.DKd.b<l&&(this.DKd.b=l)):0>l&&(l=b.listLevel=this.M$f(a.Yf));1>ja&&(ja=b.listId=this.aVc(a.Yf,"data-listid",0));a.Yf.getAttribute("data-leveltext")&&(b.levelText=a.Yf.getAttribute("data-leveltext"));var y=a.Yf.getAttribute("data-font");y&&(b.font=y);y=!1;w.AFrameworkApplication.fa&&(y=w.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));
if(y){var G=a.Yf.getAttribute("data-charcodes");y=[];if(G&&""!==G)if(-1<G.indexOf(",")){G=G.split(",");for(var R=0;R<G.length;R++)Array.add(y,parseInt(G[R]))}else Array.add(y,parseInt(G));if(y&&0<y.length){G=Array(y.length);for(R=0;R<y.length;R++)G[R]=y[R];b.HRa=G}(y=a.Yf.getAttribute("data-buAutoNum"))&&0<y.length&&(b.gub=parseInt(y))}(l=0<=l&&0<ja)&&Jl.nNc(a.Yf)}b.Xoi(c,f,l);this.Mg.Ixa(b.clone());this.FD(Object(H.a)(this.Mg,this.Mg.toa,"onListItemEnd"));return 1}lJb(a){return this.Q9b(a,!1)}fkd(a){if(this.Jq(b=>
b.iOb(!0))){const b=a.Yf.getAttribute("OuterHtml");this.Mg.Jxa(b,wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.ZJa,"onMathEnd"))}return 1}mkd(a){return this.Q9b(a,!0)}qkd(a){this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));return 1}tkd(a){const b=a.Yf.getAttribute("align");this.Jq(c=>c.Glb(b));if(this.Yc.K_a){const c=a.Yf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&Jl.nNc(a.Yf,z.a.gU||z.a.mg)}this.Mg.QA(wh.Qy(a));this.FD(Object(H.a)(this.Mg,this.Mg.PA,"onParagraphEnd"));
return 1}Fkd(){this.Jq(a=>a.MLa("consolas"));this.Mg.x_a();this.FD(Object(H.a)(this.Mg,this.Mg.w_a,"onPreFormattedTextEnd"));return 1}Nkd(){return this.Jq(a=>a.gZ(!0))?1:2}Okd(){return this.Jq(a=>a.MLa("consolas"))?1:2}Xkd(){return this.Jq(a=>a.A4e())?1:2}Ykd(a){var b=a.Yf.attributes.getNamedItem("style"),c="";b&&b.value&&(c=b.value);b=dh.dRk(c);if(0<b&&this.Yc.rTj){for(c=0;c<b;c++)this.Mg.C_a(wh.Qy(a));return 3}return 2}Zkd(){return this.Jq(a=>a.gZ(!0))?1:2}$kd(){return this.Jq(a=>a.eI(!0))?1:2}ald(){return this.Jq(a=>
a.M6(!0))?1:2}dld(){return this.Jq(a=>a.hZ(!0))?1:2}hld(a){this.Jq(Va=>Va.clearFormatting()&&Va.zYe());dh.iZc(a.Yf,this);const b=dh.szb(a.Yf),c=dh.J6f(a.Yf),f=dh.Bce(a.Yf),l=dh.Cce(a.Yf),y=!parseInt(wh.Wta(a.Yf,"border")),G=dh.h8j(a.Yf);let R=-1,ja="";var za=-1;a.Yf.attributes.hasOwnProperty("style")&&-1!==(za=a.Yf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?R=parseInt(a.Yf.attributes.getNamedItem("style").value.substr(za+17)):a.Yf.attributes.hasOwnProperty(wa.a.H3d.toString())&&
(R=parseInt(a.Yf.attributes.getNamedItem(wa.a.H3d.toString()).value));za=-1;a.Yf.attributes.hasOwnProperty("class")&&-1!==(za=a.Yf.attributes.getNamedItem("class").value.indexOf("Mso"))?ja=a.Yf.attributes.getNamedItem("class").value.substr(za).split(" ")[0]:a.Yf.attributes.hasOwnProperty(wa.a.I3d.toString())&&(ja=a.Yf.attributes.getNamedItem(wa.a.I3d.toString()).value);this.Mg.NY(new mC(0,0,b.value,b.stg,null,y,G,c,new WH(f.value,l.value),ja,R,wh.Qy(a)));this.FD(Object(H.a)(this.Mg,this.Mg.KY,"onTableEnd"));
w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}Unc(a){const b=dh.hab(a.Yf),c=dh.szb(a.Yf);if(!c.value&&c.o2c&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Yc.ahh))return 3;let f=parseInt(wh.Wta(a.Yf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(wh.Wta(a.Yf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let y=!1;a.Yf.attributes.hasOwnProperty("style")&&
(y=-1!==a.Yf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Yf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!y&&a.Yf.attributes.hasOwnProperty("class")&&(y=-1!==a.Yf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let G=69905;if(a.Yf.attributes.hasOwnProperty(wa.a.G3d.toString())){var R=parseInt(a.Yf.attributes.getNamedItem(wa.a.G3d.toString()).value);isNaN(R)||(G=R)}R=dh.jda(a.Yf.style.backgroundColor);
const ja=dh.yAj(a.Yf);this.Jq(hb=>hb.TLa(0,0));dh.iZc(a.Yf,this);const za=dh.J6f(a.Yf),Va=this.Yc.VRk?dh.ffj(a.Yf):null;a=new dz(f,l,c.value,b.value,R,ja,za,Va,c.stg,y,G,wh.Qy(a));this.Mg.JY(a);this.FD(Object(H.a)(this.Mg,this.Mg.IY,"onTableCellEnd"));this.qDk();return 1}ild(a){const b=this.Unc(a);if(3===b)return b;this.Jq(c=>{const f=c.eI(!0);c=c.Glb("center");return f||c});dh.iZc(a.Yf,this);return 1}jld(a){dh.iZc(a.Yf,this);const b=dh.hab(a.Yf);if(b.o2c&&!b.value&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),
this.Yc.ahh))return 3;this.Mg.MY(new lC(b.value,wh.Qy(a)));this.FD(Object(H.a)(this.Mg,this.Mg.LY,"onTableRowEnd"));return 1}mld(){return this.Jq(a=>a.MLa("consolas"))?1:2}nld(){return this.Jq(a=>a.iZ(!0))?1:2}old(a){return this.Q9b(a,!1)}qld(){return this.Jq(a=>a.iZ(!0))?1:2}Ijj(a){if(!a)return null;a=a.split(",");return this.Yc.PVa&&a[0].startsWith("WordVisi")&&1<a.length?a[1].trim():a[0]}static HNl(a){if(!a)return null;a=na.a.ZWe(a,'"');return a=na.a.ZWe(a,"'")}l9f(a){if(!a)return null;a=this.Ijj(a);
return a=Jl.HNl(a)}static kAf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.Jig())return!1;a.direction=b;return!0}if((c=b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.Jig())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:dh.jda(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new SH;f.color=c;f.stop=
b;a.I2b.add(f);return!0}static sAj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);b=b.substr(0,b.lastIndexOf(")"));const c=new UH;for(;0<b.trim().length;){let f=b.indexOf(",");const l=b.indexOf("(");if(0<l&&l<f){const y=b.indexOf(")");if(y<l)return null;f=b.indexOf(",",y)}if(-1===f){if(!Jl.kAf(c,b))return null;b=""}else{const y=b.substr(0,f);b=b.substr(f+1);if(!Jl.kAf(c,y))return null}}return c}catch(b){return null}}static BYc(a,
b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static nNc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin="",b&&Jl.iMf(a,b))}static iMf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=""),b&&Jl.iMf(a,b)),a=a.nextSibling}static Inj(a){if("p"!==a.tagName.toLowerCase())return-1;if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&
"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static E8j(a){return!(void 0===a.className||null===a.className)&&a.className.startsWith("TextRun")}static qyj(a){a=a.style.textDecorationLine;return void 0===a||null===a?null:a}static Arg(a){return 0<=a.indexOf("line-through")}static uE(a){return 0<=a.indexOf("underline")}}Jl.bJl=(ds=new Oa.a,ds.add("TABLE"),ds.add("THEAD"),ds.add("TBODY"),ds.add("TFOOT"),ds.add("TR"),ds.add("TH"),
ds.add("TD"),ds);Object(m.a)(Jl,"DefaultHtmlTranslator",wh,[]);var dn=d(314);class mk{constructor(a=null){this.ZS=a||dn.a.Ofe("");this.EEc=Number.parseInvariant((new Date).format("HHmmss"))}get Ob(){return this.ZS}process(a,b){if(a&&a.querySelectorAll){const y=a.querySelectorAll("p");if(y&&0<y.length){for(var c=0,f=!1,l=y[0].parentNode;5>c&&l&&l!==a;){c++;const G=l.id.toLowerCase();if(G&&G.length&&-1!==G.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,
"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),c=l}a=new xf.a(b,Object(H.a)(this,this.ISe,"processNodesDiscovery"),new gC(y));a.$l("Word Converter Operation");a.Zi=!b||b.Zi;a.run()}}}ISe(a,b){const c=b.nodes[b.S3];var f=mk.mce(c);if(f){let y=f.vNa.replace(RegExp("level[0-9]"),"").trim();y=y&&y.length?y:f.vNa;let G=b.lists[y];G||(G=new NH,
G.zZ=this.EEc++);let R=G.OCb[f.level-1];R||(R=new OH,R.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(R.tagName=l)}else R.$Za=mk.P8f(c,5),R.$Za&&R.$Za.length||(R.$Za=mk.Ree(c,5)),R.ignore=!R.$Za||!R.$Za.length,R.tagName=mk.hWc(R.$Za);f.zZ=G.zZ;R.Pmc++;R.ignore||"li"===c.parentNode.tagName.toLowerCase()||(l=(l=mk.Ree(c,5))?l:R.$Za)&&l.length&&(f.g6i=l,(l=mk.Oql(c,l,R.listStyle,f.level-1))&&l.length&&(R.listStyle=
l));b.Z9[b.Z9.length]=f;R.Z9.contains(f)||R.Z9.add(f);if(void 0===G.OCb[f.level-1]||null===G.OCb[f.level-1]||G.OCb[f.level-1]!==R)G.OCb[f.level-1]=R;b.lists[y]&&b.lists[y]===G||(b.lists[y]=G);b.DCb=c}else if((f=b.DCb)&&mk.D8b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.S3++;if(b.nodes.length<=b.S3){if(!b.Z9.length)return!1;
b.S3=0;a.gh(Object(H.a)(this,this.HSe,"processNodeConvert"))}return!0}HSe(a,b){a=b.Z9[b.S3];var c=a.foc,f=a.vNa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.vNa;f=b.lists[f];var l=f.OCb[a.level-1],y=c.parentNode.tagName.toLowerCase();if(!l.ignore&&c.parentNode&&"li"!==y){if(y=mk.jPi(c,l)){mk.k2b(c,5);const G=c.ownerDocument.createElement("LI");G.setAttribute("data-aria-level",String.format("{0}",a.level));for(G.setAttribute("data-listid",String.format("{0}",f.zZ));c.firstChild;)G.appendChild(c.firstChild);
y.appendChild(G);c.parentNode.removeChild(c);"UL"===l.tagName?this.Ob.b++:this.Ob.c++}}else"li"===y&&(l=l.tagName,c=c.parentNode,a.aKb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc","true"),c.setAttribute("data-listid",String.format("{0}",f.zZ)),"UL"===l?this.Ob.b++:this.Ob.c++);b.S3++;return b.S3<b.Z9.length}static jPi(a,b){a=mk.gPi(a,b.tagName);return mk.h1d(a,b)}static h1d(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);
a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static gPi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?Jl.BYc(c,"NumberListStyle"):Jl.BYc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static k2b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=
a.childNodes[c];1===f.nodeType&&1<b&&mk.k2b(f,b-1);if(mk.Moe(f)||mk.Gbc(f))a.removeChild(f),c--}}static mce(a){if(1===a.nodeType){var b=mk.c9b(a,"mso-list");if(b&&0<b.length)try{var c=b.split(" ");if(3===c.length){var f=new bz;f.level=Number.parseInvariant(c[1].substr(5));f.vNa=b;f.foc=a;f.aKb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&(b=c.getAttribute("data-"+Ne.a.I0b),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new bz,f.level=
Number.parseInvariant(b),f.vNa=c+" level"+b,f.foc=a,f.aKb=!1,f}return null}static Oql(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===mk.hWc(b))return c=mk.Qej(b),Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?mk.vtj(c,f):1,1!==f&&((c=mk.xOc(a,
l,RegExp("^[ivxlcdm]+"),na.a.zPf,"NumberListStyle3"))||(c=mk.xOc(a,l,RegExp("^[IVXLCDM]+"),na.a.zPf,"NumberListStyle5")))||f&&((c=mk.xOc(a,l,RegExp("^[a-z]+"),na.a.yPf,"NumberListStyle2"))||(c=mk.xOc(a,l,RegExp("^[A-Z]+"),na.a.yPf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static Qej(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static vtj(a,b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=
1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static xOc(a,b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static hWc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static Ree(a,b){let c=null;var f;let l,y;for(let G=-1;!c&&G<a.childNodes.length;G++){const R=-1===G?a:a.childNodes[G];
if(R)if((f=R.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(y=f.indexOf("\x3c!--[endif]--\x3e"),0<=y)){f=f.substring(l,y+14);R.innerHTML=R.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=G&&1===R.nodeType&&1<b&&(c=mk.Ree(R,b-1))}return c}static P8f(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];mk.Gbc(l)?(c="string"===typeof l.innerText?
l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=mk.P8f(l,b-1))}return c}static Gbc(a){return 1===a.nodeType&&(a=mk.c9b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Moe(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static c9b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===
b)return f[1].trim()}}return null}static D8b(a){do a=a.previousSibling;while(a&&mk.rbc(a));return a}static rbc(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(mk.yKd,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:mk.rbc(a.firstChild):!0}}mk.yKd=RegExp("[\n|\r]","gi");Object(m.a)(mk,"WacAndRichClientWordConverter",null,[706]);class XH{constructor(){this.zZ=0;this.tagName="UL";this.L6b=null;this.ignore=!1;this.Pmc=0}}Object(m.a)(XH,
"ListMetadata",null,[]);class yl{constructor(a=null){this.EEc=1;this.ZS=a||dn.a.Ofe("")}get Ob(){return this.ZS}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&0<a.length&&(a=new xf.a(b,Object(H.a)(this,this.ISe,"processNodesDiscovery"),new gC(a)),a.$l("Word Converter Operation"),a.Zi=!b||b.Zi,a.run())}ISe(a,b){const c=b.nodes[b.S3];var f=yl.mce(c);if(f){let l=b.$ja[f.level-1];l||(l=new fC,b.$ja[f.level-1]=l);b.DCb&&yl.D8b(c)!==b.DCb&&yl.xfl(b);let y=l.zxg[f.vNa];if(!y)y=new XH,y.zZ=
this.EEc++,y.L6b=yl.ebe(c,5),y.ignore=!y.L6b||!y.L6b.length,y.tagName=yl.hWc(y.L6b),l.zxg[f.vNa]=y,b.lists[y.zZ.toString()]=y;else if(!y.ignore&&1===y.Pmc){const G=yl.ebe(c,5);y.tagName=y.L6b===G?"UL":"OL"}f.zZ=y.zZ;y.ignore||"OL"===y.tagName&&0<y.Pmc&&l.TPc!==f.zZ?(y.ignore=!0,b.$ja[0].TPc=-1,b.$ja=b.$ja.slice(0,1)):(b.$ja.length>f.level&&(b.$ja=b.$ja.slice(0,f.level)),l.TPc=f.zZ,b.Z9[b.Z9.length]=f,y.Pmc++);b.DCb=c}else if((f=b.DCb)&&yl.D8b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));
for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.S3++;if(b.nodes.length<=b.S3){if(!b.Z9.length)return!1;b.S3=0;a.gh(Object(H.a)(this,this.HSe,"processNodeConvert"))}return!0}HSe(a,b){var c=b.Z9[b.S3];a=c.foc;const f=b.lists[c.zZ.toString()];if(!f.ignore&&(c=yl.sqj(a,c,f))){yl.k2b(a,5);const l=a.ownerDocument.createElement("LI");for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===
f.tagName?this.Ob.b++:this.Ob.c++}b.S3++;return b.S3<b.Z9.length}static sqj(a,b,c){let f=yl.Eoh(a,b.level,c);const l=N.a.Be(f,"UniqueListId");if(l&&l!==b.zZ||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;N.a.dw(f,"UniqueListId",b.zZ);return yl.h1d(f,c)}static h1d(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(N.a.dw(b,"UniqueListId",N.a.Be(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,
a);a.parentNode.removeChild(a);a=b}return a}static Eoh(a,b,c){let f=null,l;1===b?l=yl.D8b(a):(f=yl.Eoh(a,b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const y=l.tagName.toUpperCase();if("UL"===y||"OL"===y)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static k2b(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&yl.k2b(f,b-1);if(yl.Moe(f)||yl.Gbc(f))a.removeChild(f),c--}}static mce(a){if(1===
a.nodeType){const b=yl.c9b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=new bz;f.level=Number.parseInvariant(c[1].substr(5));f.vNa=b;f.foc=a;return f}}catch(c){}}return null}static hWc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static ebe(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];yl.Gbc(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&
(c=yl.ebe(l,b-1))}return c}static Gbc(a){return 1===a.nodeType&&(a=yl.c9b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Moe(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static c9b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static D8b(a){do a=a.previousSibling;while(a&&yl.rbc(a));return a}static rbc(a){return a?
3===a.nodeType?(a=a.nodeValue,a=a.replace(yl.yKd,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:yl.rbc(a.firstChild):!0}static xfl(a){for(let b=0;b<a.$ja.length;b++){const c=a.$ja[b];c&&(c.TPc=-1)}}}yl.yKd=RegExp("[\n|\r]","gi");Object(m.a)(yl,"WordConverter",null,[706]);class nC{constructor(a){this.w4a=a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get d$a(){return this.w4a}create(a=null){return this.w4a?new mk(a):
new yl(a)}}Object(m.a)(nC,"Box4WordConverterFactory",null,[648]);var YH=d(719);class ZH{constructor(a,b,c,f,l){this.Ahf=0;this.qd=a;this.ud=b;this.EDd=l;this.jW=c;this.lQa=f}OCi(a,b,c){ha.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.ud.mz);a.Zi&&this.ud.ik&&window.chrome&&ha.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",b);this.jW.Eda(!!(b&16));this.lQa.create(a,Object(H.a)(this,
this.wbf,"waitingForEnsureAccessOperationResult"),null).$l("ClipboardPreProcess");this.Ahf=Date.now()}Zfl(){this.jW.reset()}wbf(a){let b=!0;const c=this.jW.y2i,f=null==this.jW.f2i;null!=c?(a.p6=c,b=!1):Date.now()-this.Ahf>this.EDd&&!f&&(ha.ULS.sendTraceTag(18354843,307,50,null),this.qd.Yb(Yd.a.vka,{["Reason"]:ce.a.Bfh}),b=a.p6=!1);return b}}Object(m.a)(ZH,"ClipboardOperationClipboardAccessHelper",null,[520]);class ez{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec){this.Ca=a;this.qd=b;this.us=
c;this.Mi=f;this.Uc=l;this.jW=y;this.Er=G;this.rf=R;this.zia=ja;this.VK=za;this.Aia=Va;this.nrb=hb;this.r6a=Cb;this.lk=ic;this.AVb=lc?lc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.SVb=lc?lc.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.fWb=lc?lc.ka("TextLayoutServiceUseResponse"):!1;this.kBc=lc?lc.ka("EnhancedTextCCPEnabled"):!1;this.ud=yc;this.jd=ec}get Xh(){return this.Mi}get Xc(){return this.qd}UYl(a){a.gqa();return!0}OPf(a,b){a=b.Jp;ha.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&
256){z.a.ava&&w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.Nf&&b.Nf.Cg&&(c=b.Nf.Cg.ho);let f=!1;this.AVb&&z.a.ava&&this.lk.Aqd(c,"data-src","data-srcurl");this.SVb&&(f=this.lk.Q1b(b.Nf.Cg.ho,b.Nf.Nd,!0));this.fWb&&this.lk.yzd(c,!1);this.kBc?(md.a.addHandler(c,pa.a.copy,Object(H.a)(this,this.eTf,"cutCopyHandlerForRibbon")),a=this.jW.copy(),md.a.removeHandler(c,pa.a.copy,Object(H.a)(this,this.eTf,"cutCopyHandlerForRibbon"))):a=
this.jW.copy();this.AVb&&z.a.ava&&this.lk.Aqd(c,"data-srcurl","data-src");this.SVb&&f&&this.lk.Q1b(b.Nf.Cg.ho,b.Nf.Nd,!1);this.fWb&&this.lk.yzd(c,!0);if(!a)return ha.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Xc.Yb(Yd.a.i$a,{["Reason"]:ce.a.Q6e}),b.G1&&b.G1.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}eTf(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=null;c=this.bae();({r4b:c}=this.lk.PMh(c));c&&(a.preventDefault(),a.stopPropagation(),
b.setData("text/html",xb.c(c)),b.setData("text/plain",c.innerText))}}bae(){if(this.ud.qS){const a=this.jd.Vta();if(a&&a.Il)return a.Il.getSelection()}ha.ULS.sendTraceTag(509109137,307,10,"Browser don't support DomL2Selection");return null}o3b(a,b){const c=b.Nf;ha.ULS.shipAssertTag(18130961,307,!!(b.Jp&16));b.JCl?this.us.oMf():this.us.s1d(c,a);return!0}nQc(a,b){var c=b.context,f=b.vd;const l=b.mK;var y=!1;a=this.Uc.Pa.nb.jf;if(this.Er.Im(a)||this.rf.nm(a)){const G=this.VK.Lc(a.node);let R=G.kf();ha.ULS.shipAssertTag(18130962,
307,R);this.zia.Se(G);this.Aia.Hcb(G)&&(y=!0)}f=b.Jp&64?new J.DictionaryPropertySet:f||new J.DictionaryPropertySet;f.setValue(we.a.ywb,!1);c=this.Ca.ii(c,C.a.uL,2,!0,l,f);8===c&&(ha.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Xc.Yb(Yd.a.vka,{["Reason"]:ce.a.qUf}),b.G1&&b.G1.fail("DeleteKey failed",!1),b.failed=!0);32===c&&y&&(b=this.Uc.Pa.nb,this.rf.Ex(b)&&b.Ua.node===a.node&&!this.Er.textLength(b.Ua.node)&&(b=this.VK.Lc(b.Ua.node),a=this.rf.Pt(b),ha.ULS.shipAssertTag(18130964,307,a),
this.zia.Se(b),this.Aia.hBb(b)||(a=this.nrb.create(),a.Tc(b),this.zia.xxa(a,!1,!1),y=this.zia.yi(a),this.Er.fe(y)&&(this.zia.Se(a),this.Xh.merge(a,b,!1,!1),this.Uc.setSelection(this.r6a.Qg(y,this.Er.textLength(y)))))));return!0}}Object(m.a)(ez,"ClipboardOperationCutCopy",null,[476]);class $H{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec){this.Ca=a;this.qd=b;this.us=c;this.jW=y;this.Uc=l;this.Mi=f;this.Er=G;this.rf=R;this.zia=ja;this.VK=za;this.Aia=Va;this.nrb=hb;this.r6a=Cb;this.Ma=lc;this.lk=
ic;this.ud=yc;this.jd=ec}create(){return new ez(this.Ca,this.qd,this.us,this.Mi,this.Uc,this.jW,this.Er,this.rf,this.zia,this.VK,this.Aia,this.nrb,this.r6a,this.Ma,this.lk,this.ud,this.jd)}}Object(m.a)($H,"Factory",null,[272]);class aI{JCh(){return!0}}Object(m.a)(aI,"ClipboardOperationCutStrategy",null,[440]);var bt=d(473),oC=d(1274),pC=d(230);class sp{constructor(a,b,c,f,l,y=null,G="",R=!0){this.Ata=this.gwd=this.e0a=this.Dqd=null;this.Kbc=!1;this.Yie=null;this.ZLe=0;this.context=a;this.Nf=a.view;
this.Jp=b;this.vd=l;this.G1=c;this.mK=f;this.tNb=this.failed=!1;this.xld=null;this.pcb=this.EBb=!1;this.JCl=sp.V0d(a);this.browserName=G;this.eSh=R;this.mNa=!1;this.aSa=0;this.E_d=ia.a.create().toString();if(a=Object(Sa.a)(10,l)?l:null){this.e0a=new J.DictionaryPropertySet;this.e0a.oy(a);if(a.sa(we.a.rmd,!1)){this.EBb=!0;this.pcb=a.sa(we.a.pcb,!1);this.xld=y;for(y=this.Nf.Nb.ak;y.Cx;)y=y.getContext(0);if(l=Object(sa.a)(Kf.AParagraphNode,y.node)){c=0;f=zb.ParagraphReader.textLength(l);switch(y.contextId){case rb.a.textRange:c=
y.Ra;f=y.Lb;break;case rb.a.endOfParagraph:c=f}this.Dqd=wb.a.Fkj(y.node,c);ha.ULS.shipAssertTag(6305503,307,!!this.Dqd);l=jb.HyperlinkReader.e8b(l);for(const ja of l)ja.Lb<=c||ja.Ra>=f||sp.hyperlinkEditor.cN(y.node,ja.hyperlink)}}this.tNb=a.sa(we.a.tNb,!1);this.mNa=a.sa(we.a.mNa,!1)}b&64&&(this.tNb=!0)}static get Xc(){return cc.a.instance}static get hyperlinkEditor(){return sp.Mn||(sp.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static V0d(a){if(a){if(a.Cx){for(let b=0;b<a.length;b++)if(sp.V0d(a.getContext(b)))return!0;
return!1}if(Object(Sa.a)(pC.a,a))return sp.V0d(a.RE);if(zb.ParagraphReader.fe(a.node)&&a.node.KC)return!0}return!1}}sp.Mn=null;Object(m.a)(sp,"ClipboardActionArguments",null,[]);var Gv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";
a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.pasteAsMerge=16384]="pasteAsMerge";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(Gv||(Gv={}));Object(m.b)("ClipboardActionFlags",Gv);const bI=a=>{a=a.Pa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},cI=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};
class dI extends bt.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch=!0){super();this.kPd=this.wca=this.y7=this.yC=null;this.init(a);this.$l("ClipboardOperation");this.yFa(ja,b,l,y,G);this.qd=za;this.rf=Va;this.ud=hb;this.Mk=Cb;this.Pef=lc;this.Sef=ic;this.Qef=yc;this.Tef=ec;this.Lzc=jc;this.LDd=xd;this.hTb=R;this.$Sb=Xd;this.lQa=Qd;this.aci=ch;this.aE=Ie;this.hd=Pe;this.ot=ig;this.zca=ff;this.Rt=f;this.aCa=bh;G&&Object(Sa.a)(10,G)&&(this.wca=Object(sa.a)(878,
G.sa(we.a.PRa,null)));this.wca||(this.wca=this.aCa.x5e());this.y3a=void 0===c||null===c?"NotAvailable":Object(oC.a)(Gv,c);this.wca.noi(this.y3a.split(", "));a=this.Rt;a.view.Uh?(this.Og=a.view,this.Og.Nb?(this.EI=0,this.KV=c,this.ksb=ec.cKb,!ch||this.ksb&&this.ksb.nb&&this.ksb.length?(ec=Jb.SelectionEditor.Ex(this.ksb.nb),ec=!(this.KV&16&&ec),ec=xd.dYj(c,this.ak)&&ec,1!==this.behavior&&ec||(ec||this.wca.fail("Clipboard operation disabled for selection",!0),this.np=ec?32:8,this.eZ())):(this.qd.Yb(Yd.a.Ah,
{["Reason"]:ce.a.noSelection}),this.wca.fail("No selection when one required",!0),this.np=8,this.finish())):(this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),this.wca.fail("No selection manager",!1),this.np=8,this.finish())):(this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.Aid}),this.wca.fail("Not in interactive view",!0),this.np=8,this.finish())}get ak(){this.kPd||(this.kPd=ze.a.kub(this.ksb));return this.kPd}R1(){super.R1();this.ksb=null}run(){0===this.EI&&this.setup();1===this.EI&&this.process();2===this.EI&&
this.teardownSync();3===this.EI&&this.teardownAsync();4===this.EI&&this.finish()}setup(){if(this.KV&256&&this.hTb){this.ux||this.Lzc.OCi(this,this.KV,this.y3a);this.ux.run();if(this.ux.inProgress)return;const a=this.ux.p6;this.jNc();if(!a){this.wca.fail("No access to system clipboard",!0);this.np=8;this.EI=4;this.Gek();return}}else ha.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.KV,this.y3a,this.ud.mz);this.KV&32&&!this.rf.K1c(this.Og.Nb.ak)?(ha.ULS.sendTraceTag(6305506,
307,50,"Cut not allowed"),this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.E3d}),this.wca.fail("Cut not allowed",!0),this.$Sb.show(),this.np=8,this.EI=4):(this.KV&4096&&(this.zca.SLb(Object.assign(new Cj.a,{Dqg:!0,$gh:this.y3a})),this.ot.undo()),this.LDd.aXk(this.KV),this.yC=this.Mk.ke(15),this.yC.ld(this.Og.Ag),this.EI=1)}process(){if(!this.ux){ha.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.KV,this.y3a,this.ud.mz);ha.ULS.shipAssertTag(6305507,307,!this.y7);this.y7=
new sp(this.Rt,this.KV,this.wca,this.mK,this.HG,void 0,this.ud.mz,this.aci);let a;a=this.KV&65536?Object(H.a)(this.Pef,this.Pef.process,"process"):this.KV&64?Object(H.a)(this.Sef,this.Sef.process,"process"):this.KV&1?Object(H.a)(this.Tef,this.Tef.process,"process"):Object(H.a)(this.Qef,this.Qef.process,"process");this.KV&16&&this.Og.Nb.Qpa.O9d();this.lQa.create(this,a,this.y7).$l("ClipboardAction")}ha.ULS.shipAssertTag(6305536,307,!!this.ux);this.ux.run();this.ux.inProgress||(this.jNc(),this.EI=this.Zi?
2:3)}teardownSync(){this.y7.EBb&&(this.yC.gd=C.a.typing);this.y7.Kbc&&this.yC.Ogd(this.y7.Yie,this.y7.ZLe);this.yC.dispose();this.np=this.y7.failed?8:32;this.EI=4}teardownAsync(){if(this.ux){if(this.ux.run(),this.ux.inProgress)return}else if(this.y7.EBb&&(this.yC.gd=C.a.typing),this.yC.oV(this),this.y7.Kbc&&this.yC.Ogd(this.y7.Yie,this.y7.ZLe),this.yC.dispose(),this.bJc)return;this.np=this.y7.failed?8:32;this.EI=4}finish(){this.zca.SLb(Object.assign(new Cj.a,{Dqg:!1}));this.eZ();32===this.response?
ha.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.KV,this.y3a,this.ud.mz):ha.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.KV,this.y3a,this.ud.mz);this.aCa.fEa(this.wca)}Gek(){var a=!!(this.KV&1),b=this.Rt.view;if(b){var c=b.Nb;b=this.ud.mz;w.AFrameworkApplication.Qa.processAction(C.a.fTf,2);a?ha.ULS.sendTraceTag(18617483,
307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(ha.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",b),a=bI(c),1===a.length?ha.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=cI(a),ha.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}Object(m.a)(dI,"ClipboardOperation",
bt.a,[]);class eI{constructor(a,b){this.Zzc=null;this.us=a;this.PV=b;this.uC=0}process(a,b){this.uC||(this.Zzc=[Object(H.a)(this,this.KLi,"copyGlossarySelection"),Object(H.a)(this.PV,this.PV.KRk,"pasteGlossaryPlaceholder")]);let c=!0;this.uC<this.Zzc.length&&(c=this.Zzc[this.uC++](a,b));return c?this.uC<this.Zzc.length:!1}KLi(a,b){if(!Object(Sa.a)(10,b.vd))return!1;const c=Object(sa.a)(10,b.vd);if(!c.Ta(we.a.Ifg))return!1;const f=c.eb(we.a.Ifg),l=b.Nf,y=l.Nb;this.us.BWl();y.Drd(()=>{y.setSelection(f,
void 0,!0);this.us.s1d(l,a)},!0);return!0}}Object(m.a)(eI,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[877]);class fI{constructor(a){this.h4a=null;this.yS=a;this.uC=-1}process(a,b){-1===this.uC&&(this.XTi(a,b),this.uC=0);let c=!1;this.uC<this.h4a.length&&(c=this.h4a[this.uC++](a,b));return c?this.uC<this.h4a.length:!1}XTi(a,b){z.a.M9||b.Jp&512?(this.h4a=[Object(H.a)(this.yS,this.yS.o3b,"copyInternal")],ha.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.Zi&&b.Jp&256?(this.h4a=[Object(H.a)(this.yS,this.yS.UYl,"waitBeforeCopy"),Object(H.a)(this.yS,this.yS.OPf,"copyExternal"),Object(H.a)(this.yS,this.yS.o3b,"copyInternal")],ha.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.h4a=[Object(H.a)(this.yS,this.yS.OPf,"copyExternal"),Object(H.a)(this.yS,this.yS.o3b,"copyInternal")],ha.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
b.Jp&32&&(a=Object(H.a)(this.yS,this.yS.nQc,"deleteForCut"),this.h4a.push(a),ha.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;ha.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Nf)if(b=bI(b.Nf.Nb),1===b.length)ha.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=cI(b);ha.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",
b.length,c,a)}}}Object(m.a)(fI,"ClipboardOperationCutCopyProcessor",null,[879]);class gI{constructor(a,b,c,f){this.yEc=null;this.us=a;this.Uc=b;this.yS=c;this.PV=f;this.uC=0}process(a,b){this.uC||(this.yEc=[Object(H.a)(this,this.OLi,"copyMovedSelection"),Object(H.a)(this.yS,this.yS.nQc,"deleteForCut"),Object(H.a)(this,this.X6g,"moveIp"),Object(H.a)(this.PV,this.PV.ihh,"pasteInternal"),Object(H.a)(this.PV,this.PV.DAh,"setSelectionAfterPaste")]);let c=!0;this.uC<this.yEc.length&&(c=this.yEc[this.uC++](a,
b));return c?this.uC<this.yEc.length:!1}OLi(a,b){b=b.Nf;this.us.oWl();this.us.s1d(b,a);return!0}X6g(a,b){b=new Wb.Selection([b.vd],!0);this.Uc.setSelection(b,a);return!0}}Object(m.a)(gI,"ClipboardOperationMoveProcessor",null,[876]);class hI{constructor(a,b,c,f,l,y){this.WMd=null;this.Yrf=0;this.qd=f;this.ud=b;this.PV=l;this.uHd=c;this.hTb=w.AFrameworkApplication.dvd()&&!(z.a.dU&&w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.EDd=a.appSettings.ChromeClipboardAccessOperationTimeout;
this.uC=0;this.rYh=y}get cKb(){return this.PV.cKb}process(a,b){if(0===this.uC)return this.SRk(b);if(1===this.uC)return this.prepareForPaste(a,b);if(2===this.uC)return this.uC=3,this.WMd(a,b);3===this.uC&&this.PV.DAh(a,b);return!1}SRk(a){this.ud.M9||a.Jp&512?(this.WMd=a.Jp&2?Object(H.a)(this.PV,this.PV.paste,"paste"):Object(H.a)(this.PV,this.PV.ihh,"pasteInternal"),this.uC=2):(this.hTb?(this.uC=1,this.Yrf=Date.now()):this.uC=2,this.WMd=Object(H.a)(this.PV,this.PV.paste,"paste"));ha.ULS.sendTraceTag(18617486,
307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.uHd.value.Pjh())this.uC=2;else{const c=Date.now()-this.Yrf;c>this.EDd&&(ha.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.qd.Yb(Yd.a.vka,{["Reason"]:ce.a.Bfh}),b.G1&&b.G1.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.rYh.Zfl())}return a}}Object(m.a)(hI,"ClipboardOperationPasteProcessor",null,[702]);class iI{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){this.us=a;this.Ca=
b;this.hTb=c;this.qd=f;this.rf=l;this.ud=y;this.Mk=G;this.vYh=R;this.tYh=ja;this.Lzc=za;this.LDd=Va;this.$Sb=hb;this.lQa=Cb;this.aE=lc;this.hd=ic;this.ot=yc;this.zca=ec;this.aCa=jc}create(a,b,c,f,l,y,G,R,ja=!0){const za=this.vYh.create(f,Object(sa.a)(10,R));var Va=this.tYh.create();const hb=new eI(this.us,za),Cb=new gI(this.us,ze.a.instance,Va,za);Va=new fI(Va);f=new hI(w.AFrameworkApplication.fa,wc.a.instance,f,cc.a.instance,za,this.Lzc);return new dI(a,b,c,l,y,G,R,this.hTb,this.Ca,this.qd,this.rf,
this.ud,this.Mk,hb,Cb,Va,f,this.Lzc,this.LDd,this.$Sb,this.lQa,this.aE,this.hd,this.ot,this.zca,this.aCa,ja)}}Object(m.a)(iI,"Factory",null,[522]);class fz{constructor(a,b){this.Yab=a.xWc(b);this.A1d=a.vhj(b);this.z8a=a.oVc(b);this.oRa=a.dVc(b)}static ZW(a){return fz.Kr(a)}static Kr(a){return new fz(le.a.instance,a)}}Object(m.a)(fz,"CpUsageHelper",null,[]);var ct=d(179);class jI{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.qd=a;this.us=b;this.NXb=c;this.Lca=f;this.Uc=l;this.Ca=y;this.uHd=G;this.ZZb=
ja;this.ZMd=R;this.aFd=za;this.KDd=Va;this.hd=hb}get Yn(){return this.ZZb.value}get Gba(){return this.Lca}get Xc(){return this.qd}get cKb(){return this.ZMd.cKb}paste(a,b){const c=this.hd.Vtb();try{const f=b.Nf;ha.ULS.shipAssertTag(18131010,307,!!(b.Jp&1));Object(Sa.a)(10,b.vd)&&b.vd.setValue(ct.a.u5b,f.Cg.ho.clientWidth);this.KDd.FPl(a,b);let l;if(!({rOc:l}=this.uHd.value.dNh()).returnValue)return b.G1&&b.G1.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.Yn.Dw();let y=!0,G=null;const R=
this.aFd.create(l),ja=b.eSh;f.Nb.Drd(()=>{ja&&2===this.Ca.processAction(C.a.MDa,2)?y=!1:(G=ja?this.Uc.Pa.nb.Ua:b.vd,ha.ULS.shipAssertTag(18158338,307,Jb.SelectionEditor.Xg(G)),this.xyg(G,"paste"))},this.ZMd.Ksg);if(!y)return!1;f.editingView.disable(!0,25);R.restore();this.NXb.FRk(l,G,a);return!0}finally{c&&c.dispose()}}KRk(a,b){this.Yn.Dw();const c=(new RF.a).ke(15);c.ld(this.us.Y7e);b=Object(sa.a)(10,b.vd).eb(we.a.NBj);ha.ULS.shipAssertTag(20492440,307,Jb.SelectionEditor.Xg(b));this.NXb.jng(b,a);
this.us.oMf();c.dispose();return!0}ihh(a){this.Yn.Dw();this.Ca.processAction(C.a.MDa,2);const b=this.Uc.Pa.nb.Ua;ha.ULS.shipAssertTag(18158339,307,Jb.SelectionEditor.Xg(b));this.xyg(b,"intPaste");this.NXb.jng(b,a);return!0}xyg(a,b){b=fz.ZW(b);this.Gba.k5k(b,a.node,a.Ra);this.Gba.Hek(b.A1d);this.Gba.Pte(b.Yab);this.Gba.Jte(b.z8a);this.Gba.Ite(b.oRa)}DAh(a,b){if(!b.eSh)return!1;b.Jp&64&&this.us.AWl();if(!b.Ata)return ha.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Xc.Yb(Yd.a.t2,
{["Reason"]:ce.a.png}),b.G1&&b.G1.fail("No selection after paste",!1),b.failed=!0,!1;this.ZMd.gWl(b);this.Yn.Dw();return!1}}Object(m.a)(jI,"ClipboardOperationPaste",null,[701]);class kI{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.qd=a;this.us=b;this.NXb=c;this.Lca=f;this.Uc=l;this.Ca=y;this.ZZb=R;this.a7h=G;this.aFd=ja;this.KDd=za;this.hd=Va}create(a,b){b=this.a7h.create(this.Uc,b);return new jI(this.qd,this.us,this.NXb,this.Lca,this.Uc,this.Ca,a,b,this.ZZb,this.aFd,this.KDd,this.hd)}}Object(m.a)(kI,
"Factory",null,[519]);class lI{constructor(a,b){this.dai=a;this.Q6h=b}get stylePropertySet(){return this.dai}get BQk(){return this.Q6h}}Object(m.a)(lI,"ParagraphFormatStore",null,[]);class mI{constructor(a,b,c,f){this.Uc=a;this.Er=b;this.fL=c;this.D3h=f}FPl(a,b){if(b.EBb&&this.D3h){b=a.p6;var c=this.Uc.Pa.nb.Ua.node,f=null;this.Er.fe(c)&&(f=this.fL.qE(c),c=this.Er.fua(c),f=new lI(f,c));b=new sp(b.context,b.Jp,b.G1,b.mK,b.vd,f);a.p6=b}}}Object(m.a)(mI,"ClipboardOperationPasteOvertypeStrategy",null,
[518]);class Ax{constructor(a){this.EKd=null;this.Uc=a;a.Drd(b=>{this.EKd=b},!1)}get Ksg(){return!1}gWl(a){a=this.a0b(a);this.setSelection(this.Uc,a)}a0b(a){let b=a.Ata;(a.mNa||a.tNb)&&a.gwd&&(b=Vd.SelectionFactory.aO(a.gwd,b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(m.a)(Ax,"AClipboardOperationPasteStrategy",null,[749]);class nI extends Ax{constructor(a){super(a)}get cKb(){return this.EKd}}Object(m.a)(nI,"ClipboardOperationPasteToLiveSelectionStrategy",Ax,[]);class oI extends Ax{constructor(a,
b){super(a);this.qSd=null;this.eXb=b;a.Drd(c=>{this.qSd=c},!0)}get Ksg(){return!0}get cKb(){return this.qSd}a0b(a){let b=super.a0b(a);a.vd.setValue(we.a.YRk,b);return b=this.eXb.e1l(this.EKd.nb,this.qSd.nb,b)}}Object(m.a)(oI,"ClipboardOperationPasteToVirtualSelectionStrategy",Ax,[]);class pI{constructor(a){this.eXb=null;this.pSd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(we.a.mNa,!1)&&this.pSd?new oI(a,this.BYl):new nI(a)}get BYl(){this.eXb||(this.eXb=Fb.a.instance.rb("Box4.Actors.IVirtualSelectionMerger"));
return this.eXb}}Object(m.a)(pI,"ClipboardOperationPasteStrategyFactory",null,[521]);class qC{constructor(a,b,c,f,l,y){this.qd=a;this.Uc=b;this.Lha=c;this.XD=f;this.e3h=l;this.S3h=y}aXk(a){this.S3h&&(a&1||a&32)&&this.Lha.Ew&&this.Uc.t_b()}dYj(a,b){return this.e3h?a&1&&this.XD.U8a(b)?(this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),!1):!0:!0}}Object(m.a)(qC,"ClipboardOperationWordStrategy",null,[]);class qI{constructor(a){this.tZh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}lLi(a,b){if(b)if(b=
b.sheet)if(b=b.cssRules){var c=Array.clone(b);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");this.tZh&&c.reverse();var f=b=0,l=0,y=0;for(const R of c){c=R.style;var G=R.selectorText;c=c?c.cssText:null;G=G?G.split(","):null;if(c&&G&&R.type===R.STYLE_RULE){y+=G.length;for(const ja of G){0<=ja.indexOf("#")&&b++;0<=ja.indexOf(".")&&f++;0>ja.indexOf("#")&&0>ja.indexOf(".")&&l++;G=null;try{G=a.querySelectorAll(ja)}catch(za){ha.ULS.sendTraceTag(41427107,
307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",ja,za.message)}if(G)for(let za=0;za<G.length;za++)G[za].setAttribute("style",c+(G[za].getAttribute("style")||""))}}}ha.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",y,b,f,l)}else this.Qyg();else this.Qyg()}Qyg(){ha.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",
z.a.mz)}}Object(m.a)(qI,"ExternalPasteCssConverter",null,[526]);var gz=d(1282);class Bx{constructor(a){this.TV=this.jWb=null;this.jsb=a.currentNode;const b=new ub.GraphIterator;b.Tc(a);this.DMd=new ub.GraphIterator;this.DMd.Tc(a);this.AMd=b.origin;this.BDd=Array(b.depth);this.Qob=Array(b.depth);this.CDd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.Qob[a]=b.role;this.CDd[a]=c;b.Cc();this.BDd[a]=b.wfj(c,this.Qob[a])}}wm(a,b){this.jWb=a;this.TV=b}restore(a){const b=new gz.a,c=
new gz.a;this.nuh(a,b,c);return c.value}nuh(a,b,c){b.value=!0;if(this.DMd.isValid)a.Tc(this.DMd),c.value=!1;else{for(let f=this.CDd.length-1;0<=f;--f){const l=this.CDd[f];if(l.anchor&&!l.anchor.vJ&&(a.set(l),a.Aba(this.AMd)||this.AMd.ppe&&a.aOh())){c.value=this.e0f(a,f+1);return}b.value=!1}a.set(this.AMd);c.value=this.e0f(a,0)}}e0f(a,b){let c=!1,f,l;f=this.BDd[b];l=this.Qob[b];const y=a.d9(l);if(f<y)a.hq(f,l);else if(c=!0,!a.DB(l))return!0;if(!this.c7g(a,l))return c;for(b+=1;b<this.BDd.length;++b){if(c){if(!a.DB(this.Qob[b]))return!0}else if(!a.Db(this.Qob[b]))return!1;
if(!this.c7g(a,this.Qob[b]))break}return c}c7g(a,b){if(this.jWb&&!this.jWb(a,this.TV)){const c=new ub.GraphIterator;c.Tc(a);let f=!0;do if(!a.Hf(b)){f=!1;break}while(!this.jWb(a,this.TV));if(!f){a.Tc(c);do if(!a.YF(b))return a.Cc(),!1;while(!this.jWb(a,this.TV))}}return!0}}Object(m.a)(Bx,"NodeReference",null,[]);var Nn=d(188);class Xj{constructor(a,b,c,f){this.mZb=this.lp=this.fh=this.qx=this.eL=this.FI=null;this.dId=!1;this.DZh=100;this.nrb=this.bNd=this.$Na=this.hd=this.aE=this.pp=this.ILh=null;
this.ekl=()=>{this.dId&&this.yzc&&Uj.a.instance.Kg(this.yzc);this.yzc||(this.yzc=new pd.a(3,1,this.DZh,()=>{this.YYd();this.dId=!1},215));Uj.a.instance.Hb(this.yzc);this.dId=!0;return!1};this.MAb=a;this.B9d=this.rjb=null;this.ag=b;this.transaction=c;this.Wia=f}get fa(){return w.AFrameworkApplication.fa}get GP(){return this.eL||(this.eL=Fb.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.qx||(this.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}get gK(){return this.FI||
(this.FI=Fb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get dC(){return Xj.ey||(Xj.ey=Fb.a.instance.resolve("Box4.IOutlineEditor"))}get Vf(){return this.fh||(this.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}get kq(){return this.lp||(this.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}get Uuc(){return this.mZb||(this.mZb=Fb.a.instance.rb("Box4.List.ISingleLevelListEditor"))}get g7(){return this.pp||(this.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get Twc(){return this.aE||
(this.aE=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Xf(){return this.hd||(this.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get AZd(){return this.$Na||(this.$Na=Fb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get ehh(){return this.zca||(this.zca=Fb.a.instance.resolve("Box4.IPasteFloatieEventSource"))}get Umb(){return this.Xai||(this.Xai=Fb.a.instance.resolve("Box4.ITextPasteFloatieManager"))}get qmd(){return this.bNd||
(this.bNd=Fb.a.instance.rb("Box4.IPastedParagraphSpaceHandler"))}set qmd(a){this.bNd=a}get Chh(){return!1}get VCh(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}H_f(){}nhh(a){var b=void 0===this.ag.Jp||null===this.ag.Jp?"not available":Object(oC.a)(Gv,this.ag.Jp);ha.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.ag.Jp,b);ha.ULS.shipAssertTag(6305487,307,Jb.SelectionEditor.Xg(this.MAb));if(this.Fid)return ha.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.ag.Ata=Vd.SelectionFactory.Qu(this.MAb),
a.gh(Object(H.a)(this,this.L_a,"pasteTeardown")),!0;b=new ub.GraphIterator;b.set(this.MAb.node);Jb.SelectionEditor.Pt(b);rc.OutlineElementNavigator.Se(b);this.ILh=b.origin;if(this.Chh)return b.gC(10),this.H_f(b,a),a.gh(Object(H.a)(this,this.Ksl,"setSelectionAfterPastingOutlines")),!0;if(Je.b(b)){if(this.fpg)return this.ag.Ata=this.RRk(this.MAb,this.bPf),a.gh(Object(H.a)(this,this.L_a,"pasteTeardown")),!0;this.MAb=this.bBk(b).ga(0)}this.PEl(this.MAb);const c=new Nn.a;c.Tc(b);rc.OutlineElementNavigator.cK(c,
!1,!1);this.rjb=new Bx(b);this.B9d=new Bx(c);a.gh(Object(H.a)(this,this.IRk,"pasteExecution"));return!0}IRk(a){kf.a.mark(5568);this.G_f(a);let b=Object(H.a)(this,this.Ezk,"mergeAfterPaste");if(this.Qrg){const c=this.JDh();c&&(b=Object(H.a)(this,this.L_a,"pasteTeardown"));ha.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.gh(b);return!0}JDh(){return!1}get Qrg(){return this.fa.ka("PptCcpFix2IsEnabled")}get hxl(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}Ezk(a){kf.a.mark(5569);
var b=new ub.GraphIterator;this.rjb.restore(b);this.rjb=null;var c=new ub.GraphIterator;this.B9d.restore(c);this.B9d=null;ha.ULS.shipAssertTag(6305489,307,he.OutlineElementReader.hh(b));ha.ULS.shipAssertTag(6305490,307,he.OutlineElementReader.hh(c));rc.OutlineElementNavigator.yi(b);zb.ParagraphReader.vl(b)&&zb.ParagraphReader.textLength(b.currentNode);rc.OutlineElementNavigator.Se(b);rc.OutlineElementNavigator.yi(c);ha.ULS.shipAssertTag(6305491,307,zb.ParagraphReader.vl(c));var f=zb.ParagraphReader.textLength(c.currentNode);
rc.OutlineElementNavigator.Se(c);const l=this.hDh;var y=new Nn.a;y.Tc(b);rc.OutlineElementNavigator.cK(y,!1,!1);var G=y.currentNode===c.currentNode;var R=!!this.ag&&!!(this.ag.Jp&8192);let ja=!1;!R&&this.ag.vd&&Object(Sa.a)(J.DictionaryPropertySet,this.ag.vd)&&2===Sc.App.mode&&(R=(R=this.ag.vd.Sh(we.a.Yib))&&""!==R?!0:!1);if(G)y=ub.GraphIterator.pb(b.currentNode),zb.ParagraphReader.zs(rc.OutlineElementNavigator.yi(y))||(b=c),b.currentNode.id!==c.currentNode.id&&(ha.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Bb.ListReader.Hk(b),Bb.ListReader.Hk(c)),y=Xj.Xh.merge(b,c,!0,R),ha.ULS.shipAssertTag(6305492,307,y)),c=b,R=!0;else{var za=!!(this.ag.Jp&4);G=this.Xf.gg&&this.Xf.nz&&za&&this.ag.pcb;this.qmd&&this.ag&&2===Sc.App.mode&&!za&&(this.qmd.tJj(b,!1),this.qmd.tJj(c,!0));rc.OutlineElementNavigator.yi(y);zb.ParagraphReader.vl(y)&&zb.ParagraphReader.textLength(y.currentNode);rc.OutlineElementNavigator.Se(y);this.Cpi(y,
b,c);if(this.AZd.M1b||this.hxl)if(za=new Nn.a,za.Tc(y),rc.OutlineElementNavigator.cK(za,!1,!1),za.Dq.id!==c.Dq.id){for(;y.currentNode.id!==c.currentNode.id;)rc.OutlineElementNavigator.yi(y,!1),bb.a.create(y.currentNode),y.Cc(),rc.OutlineElementNavigator.cK(y,!1,!1);y.Tc(b);rc.OutlineElementNavigator.cK(y,!1,!1)}else ja=!0;if(this.ag.Dqd&&(ha.ULS.shipAssertTag(6305493,307,this.ag.EBb),za=new ub.GraphIterator,za.Tc(y),za=rc.OutlineElementNavigator.yi(za))){var Va=this.ag.Dqd.ge(za.Sa.ga(0));za.Sa.ga(0).formatting=
Va}Bb.ListReader.Hk(b)?(Xj.hM.Icc&&this.Uuc&&this.Uuc.p1l(b),za=Bb.ListReader.Hk(y)?this.iDh:!0):he.OutlineElementReader.isEmpty(b,!0)?(Xj.Xh.SDa(b),za=!1):za=Bb.ListReader.Gx||!Bb.ListReader.Hk(y);this.ag.gwd=null;if(this.ag.tNb||this.ag.mNa)this.ag.gwd=this.Jwj(za?b.currentNode:y.currentNode,za);if(za&&(Va=Bb.ListReader.Hk(b),ha.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Va,Bb.ListReader.Hk(c)),Xj.Xh.merge(b,y,!0,R,c,void 0,
ja,G),Bb.ListReader.Hk(b)&&this.Vf.Ypc)){var hb=new Nn.a;hb.Tc(b);rc.OutlineElementNavigator.cK(hb,!1,!1);if(hb.Dq.id!==c.Dq.id){var Cb=this.Vf.Hv(b);this.Vf.Yna(b);const yc=b.currentNode.sa(sb.a.listID,0);b.Cc();for(Cb.VA=Ba.a.ex;hb.currentNode.id!==c.currentNode.id;){if(!Bb.ListReader.Hk(hb))({Hbb:Cb}=this.kq.vtb(Cb.propertySet,hb,Cb));else if(Va){var lc=this.Vf.Jnj(hb),ic=this.Vf.qce(b.currentNode,yc,lc);ic=ic?cb.a.yDa(ic,null):Cb;lc=cb.a.SN(ic.listType,Cb.listStyle,null,0,lc,"","");lc.VDk=b.currentNode;
this.kq.Grl(lc);this.kq.S0e(hb,!0)}rc.OutlineElementNavigator.cK(hb,!1,!1)}}}l?(Va=new Nn.a,Va.Tc(c),rc.OutlineElementNavigator.xxa(Va,!1,!1),hb=Bb.ListReader.Hk(Va),Cb=Bb.ListReader.Hk(c),R=Xj.Xh.merge(Va,c,!0,R,void 0,!0,void 0,G),ha.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",hb,Cb,R?"True":"False, will cause IP to reset to zero."),c=R?Va:c):(R=!1,ha.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.AZd.M1b&&ja&&(za?(y=new ub.GraphIterator,y.Tc(b),rc.OutlineElementNavigator.yi(y)):l?(b=new ub.GraphIterator,b.Tc(y),rc.OutlineElementNavigator.yi(b)):(b=new ub.GraphIterator,b.Tc(y),b=rc.OutlineElementNavigator.yi(b),bb.a.create(b)))}ha.ULS.shipAssertTag(6305494,307,c.isValid);b=rc.OutlineElementNavigator.yi(c);f=R?zb.ParagraphReader.textLength(b)-f:0;y=!1;Object(Sa.a)(10,this.ag.vd)&&(y=this.ag.vd.sa(we.a.z2c,!1));y&&M.a.instance.ga(11)?this.ag.Ata=Vd.SelectionFactory.R3(b,f-1,f):this.ag.Ata=
Vd.SelectionFactory.Qg(b,f);M.a.instance.ga(71)&&this.ag&&this.ag.EBb&&zb.ParagraphReader.fe(b)&&this.ag.xld&&((f=this.ag.xld.stylePropertySet)&&this.GP.fba(f,b,!0),(f=this.ag.xld.BQk)&&this.paragraphEditor.kEf(b,f));a.gh(Object(H.a)(this,this.L_a,"pasteTeardown"));return!0}Cpi(a,b,c){var f=!1;this.Xf.gg&&this.Xf.nz&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){rc.OutlineElementNavigator.yi(a,!1);f=this.Twc.IEl(bb.a.create(a.currentNode));f.Weg();for(let l=0;l<f.length;l++){let y;const G=({Zug:y}=
f.getContext(l)).returnValue;y&&Xj.hyperlinkEditor.PIb(G,1)}a.Cc();rc.OutlineElementNavigator.cK(a,!1,!1)}a.Tc(b);rc.OutlineElementNavigator.cK(a,!1,!1)}}Jwj(a,b){a=ub.GraphIterator.pb(a);rc.OutlineElementNavigator.yi(a);return zb.ParagraphReader.fe(a.currentNode)?(b=b?zb.ParagraphReader.textLength(a.currentNode):0,Vd.SelectionFactory.Qg(a.currentNode,b)):Hd.TableReader.Zcb(a.currentNode)?Vd.SelectionFactory.rl(a.currentNode):null}Ksl(a){const b=ub.GraphIterator.pb(this.ILh);b.DB(1);this.ag.Ata=Vd.SelectionFactory.Ej(b.currentNode,
!1);a.gh(Object(H.a)(this,this.L_a,"pasteTeardown"));return!0}L_a(a){var b=void 0===this.ag.Jp||null===this.ag.Jp?"not available":Object(oC.a)(Gv,this.ag.Jp);ha.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.ag.Jp,b);ha.ULS.shipAssertTag(6305497,307,!!this.ag.Ata);this.transaction.dispose();b=this.Wia.jL;if(!b.Uh||!b.editingView.lm)return!1;b.editingView.sJl();return!this.fa.ka("IsPasteTextFloatieEnabled")||this.ag&&this.ag.Jp&&this.ag.Jp&4&&this.ag.Jp&2?!1:(a.gh(this.ekl,"scheduleCallPasteFloatieTask"),
!0)}YYd(){if(this.Umb.Qua){const a=new Cj.a;a.zuc=!0;this.ehh.SLb(a)}else this.ehh.hVe(new Pj(1,w.AFrameworkApplication.isRtl));this.ag&&this.ag.Jp&&(1===this.ag.Jp?this.Umb.zH=C.a.z8:257===this.ag.Jp?this.Umb.zH=C.a.paste:8449===this.ag.Jp?this.Umb.zH=C.a.u6:4097===this.ag.Jp?this.Umb.zH=C.a.reformatPastedContent:12289==this.ag.Jp?this.Umb.zH=C.a.y0a:this.fa.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.ag.Jp&16384&&(this.Umb.zH=C.a.aMb))}uwl(a,b){const c=new ub.GraphIterator;c.Tc(a);
a=rc.OutlineElementNavigator.yi(c);b=zb.ParagraphReader.fe(a)&&b===zb.ParagraphReader.textLength(a);ha.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}PEl(a){ha.ULS.shipAssertTag(6305498,307,Jb.SelectionEditor.Xg(a));const b=ub.GraphIterator.pb(a.node);var c=b.kf();rc.OutlineElementNavigator.Se(b);ha.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=Xj.Xh.Dac(b,!0);const f=
this.uwl(b,a.Ra);Xj.Xh.zPb(b,c,a,!1,!1,f)}RRk(a,b){ha.ULS.shipAssertTag(6305500,307,a.contextId===rb.a.Mf);const c=a.node;b=b.replace(na.a.SDc," ");Xj.characterPropertiesEditor.replaceTextRange(a,b);return Vd.SelectionFactory.Qg(c,a.Ra+b.length)}bBk(a){a.mv();Xj.tm.uLa(a);const b=Xj.Vk.Zag(a),c=this.gK.K3b(a);b?Dq.c(a.currentNode,b+1,b+2):this.dC.Gtd(c,Sc.App.Mb.Ld.Rn.v9b());this.dC.Cac(a,null,!0);return Vd.SelectionFactory.Ej(a.currentNode,!0)}static get tm(){return Hy.PageNavigator.instance}static get characterPropertiesEditor(){return Xj.mh||
(Xj.mh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return Xj.Mn||(Xj.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Vk(){return fx.PageReader.instance}static get Xh(){return Xj.Mi||(Xj.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hM(){return Xj.XK||(Xj.XK=Fb.a.instance.rb("Box4.List.ListSettings"))}static get Fe(){return Xj.kd||(Xj.kd=Fb.a.instance.rb("Box4.IFeatureHelper"))}}Xj.ey=null;Xj.kd=null;Xj.Mi=null;Xj.mh=null;
Xj.Mn=null;Xj.XK=null;Object(m.a)(Xj,"APasteExecutionManager",null,[]);var SQ=d(1281);class rI{constructor(){this.Jp=0;this.p3b=6;this.c$d=this.b$d=this.s4f=this.a$d=this.$9d=this.Z9d=this.Y9d=!1;this.eTe=null;this.r4f=this.z$a=this.k7b=this.q4f=this.u4f=!1;this.vhh=this.$Jb=0;this.oPe=this.platform=null;this.O4a={}}get b5e(){if(this.c$d)return"Word Online";if(this.a$d)return"Google Docs";if(this.b$d||this.Z9d||this.$9d)return"PowerPoint Online";if(this.Y9d)return"Excel Online";switch(this.eTe){case "Word.Document":return"Word";
case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}yfk(){ha.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.Vui()))}zfk(){const a=this.O4a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.b5e,f.Browser=SQ.a[this.$Jb],f.TagName=b,f.OperationId=this.oPe,ha.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}zPj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.O4a||(this.O4a[a]={}),
this.O4a[a][b]=this.exj(a,b)+1)}exj(a,b){if(!(a&&a.length&&b&&b.length&&this.O4a&&a in this.O4a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.O4a[a])&&b in a?a[b]:0}Vui(){const a={};a.ActionIdFlags=this.Jp;a.FoundDataCcpTimestampAttribute=this.Y9d;a.FoundDataClipserviceCcpidAttribute=this.Z9d;a.FoundDataShapeIdsAttribute=this.$9d;a.FoundGoogleDocsInternalGuidId=this.a$d;a.FoundOneNoteOnlineSequenceClass=this.s4f;a.FoundPowerPointOnlineSequenceClass=this.b$d;a.FoundWordOnlineSequenceClass=
this.c$d;a.ProgId=this.eTe;a.SourceApp=this.b5e;a.FoundText=this.u4f;a.FoundEquation=this.q4f;a.FoundList=this.k7b;a.FoundTable=this.z$a;a.FoundImage=this.r4f;a.CopySourceBrowser=this.p3b;a.PasteBrowser=this.$Jb;a.IsSameBrowserPaste=this.i6j(this.p3b,this.$Jb);a.IsCrossBrowserPaste=this.YYj(this.p3b,this.$Jb);a.IsUncategorizedBrowserPaste=this.h9j(this.p3b,this.$Jb);a.Platform=this.platform;a.PastedHtmlLength=this.vhh;a.OperationId=this.oPe;return a}i6j(a,b){return 5===a||6===a?!1:a===b}YYj(a,b){return 6===
a?!1:a!==b}h9j(a,b){return 5===a&&5===b}}Object(m.a)(rI,"HtmlContentMetadata",null,[]);class hz{constructor(a,b,c=!1){this.Yf=a;this.zw=b;this.xoi=c}}Object(m.a)(hz,"TagEventParam",null,[]);class rC{constructor(a,b=null){this.VAc=this.vsf=this.SRd=this.Cxf=null;this.Nc=a;this.ZS=b||dn.a.O9f("");this.lul()}get Ob(){return this.ZS}FDk(a,b,c){this.SRd[b]?this.N8g():(this.Ob.e++,(b=this.VAc[b])&&b(new hz(a,c,!1)),this.Ob.b++)}N8g(){this.Ob.d++}yDk(){this.Ob.c++}oDk(a,b,c){if(this.SRd[b])this.N8g();else{if(b=
this.VAc[b])return this.Ob.b++,b(new hz(a,c,!1));this.Ob.f++}return 2}lul(){this.Cxf=ta.a.kI("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.SRd=ta.a.kI("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.vsf=ta.a.kI("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",
!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Nc,b=this.Nc,c=this.Nc,f=this.Nc,l=this.Nc,y=this.Nc,G=this.Nc,R=this.Nc,ja=this.Nc,za=this.Nc,Va=this.Nc,hb=this.Nc,Cb=this.Nc,lc=this.Nc,ic=this.Nc,yc=this.Nc,ec=this.Nc,jc=this.Nc,xd=this.Nc,Xd=this.Nc;this.VAc=ta.a.kI("A",Object(H.a)(this.Nc,this.Nc.Tid,"onAOpen"),"ABBR",Object(H.a)(this.Nc,this.Nc.iMe,"onAbbrOpen"),"ACRONYM",Object(H.a)(this.Nc,this.Nc.jMe,
"onAcronymOpen"),"ADDRESS",Object(H.a)(this.Nc,this.Nc.lMe,"onAddressOpen"),"APPLET",Object(H.a)(this.Nc,this.Nc.sMe,"onAppletOpen"),"AREA",Object(H.a)(this.Nc,this.Nc.vMe,"onAreaTag"),"B",Object(H.a)(this.Nc,this.Nc.Xid,"onBOpen"),"BASE",Object(H.a)(this.Nc,this.Nc.wMe,"onBaseTag"),"BASEFONT",Object(H.a)(this.Nc,this.Nc.xMe,"onBasefontTag"),"BDO",Object(H.a)(this.Nc,this.Nc.yMe,"onBdoOpen"),"BIG",Object(H.a)(this.Nc,this.Nc.cjd,"onBigOpen"),"BLOCKQUOTE",Object(H.a)(this.Nc,this.Nc.djd,"onBlockquoteOpen"),
"BODY",Object(H.a)(this.Nc,this.Nc.KMe,"onBodyOpen"),"BR",Object(H.a)(this.Nc,this.Nc.ejd,"onBrTag"),"BUTTON",Object(H.a)(this.Nc,this.Nc.PMe,"onButtonOpen"),"CAPTION",Object(H.a)(this.Nc,this.Nc.fjd,"onCaptionOpen"),"CENTER",Object(H.a)(this.Nc,this.Nc.hjd,"onCenterOpen"),"CITE",Object(H.a)(this.Nc,this.Nc.kjd,"onCiteOpen"),"CODE",Object(H.a)(this.Nc,this.Nc.mjd,"onCodeOpen"),"COL",Object(H.a)(this.Nc,this.Nc.$Me,"onColTag"),"COLGROUP",Object(H.a)(this.Nc,this.Nc.aNe,"onColgroupOpen"),"DD",Object(H.a)(this.Nc,
this.Nc.pjd,"onDdOpen"),"DEL",Object(H.a)(this.Nc,this.Nc.qjd,"onDelOpen"),"DFN",Object(H.a)(this.Nc,this.Nc.sjd,"onDfnOpen"),"DIR",Object(H.a)(this.Nc,this.Nc.tjd,"onDirOpen"),"DIV",Object(H.a)(this.Nc,this.Nc.vjd,"onDivOpen"),"DL",Object(H.a)(this.Nc,this.Nc.wjd,"onDlOpen"),"DT",Object(H.a)(this.Nc,this.Nc.xjd,"onDtOpen"),"EM",Object(H.a)(this.Nc,this.Nc.Ajd,"onEmOpen"),"FIELDSET",Object(H.a)(this.Nc,this.Nc.xNe,"onFieldsetOpen"),"FONT",Object(H.a)(this.Nc,this.Nc.Ijd,"onFontOpen"),"FORM",Object(H.a)(this.Nc,
this.Nc.DNe,"onFormOpen"),"FRAME",Object(H.a)(this.Nc,this.Nc.ENe,"onFrameTag"),"FRAMESET",Object(H.a)(this.Nc,this.Nc.FNe,"onFramesetOpen"),"H1",Object(H.a)(this.Nc,this.Nc.Njd,"onH1Open"),"H2",Object(H.a)(this.Nc,this.Nc.Ojd,"onH2Open"),"H3",Object(H.a)(this.Nc,this.Nc.Pjd,"onH3Open"),"H4",Object(H.a)(this.Nc,this.Nc.Qjd,"onH4Open"),"H5",Object(H.a)(this.Nc,this.Nc.Rjd,"onH5Open"),"H6",Object(H.a)(this.Nc,this.Nc.Sjd,"onH6Open"),"HEAD",Object(H.a)(this.Nc,this.Nc.KNe,"onHeadOpen"),"HR",Object(H.a)(this.Nc,
this.Nc.Tjd,"onHrTag"),"HTML",Object(H.a)(this.Nc,this.Nc.MNe,"onHtmlOpen"),"I",Object(H.a)(this.Nc,this.Nc.Ujd,"onIOpen"),"IFRAME",Object(H.a)(this.Nc,this.Nc.ONe,"onIframeOpen"),"IMG",Object(H.a)(this.Nc,this.Nc.Vjd,"onImgTag"),"INPUT",Object(H.a)(this.Nc,this.Nc.RNe,"onInputTag"),"INS",Object(H.a)(this.Nc,this.Nc.Wjd,"onInsOpen"),"ISINDEX",Object(H.a)(this.Nc,this.Nc.YNe,"onIsindexOpen"),"KBD",Object(H.a)(this.Nc,this.Nc.Xjd,"onKbdOpen"),"LABEL",Object(H.a)(this.Nc,this.Nc.Zjd,"onLabelOpen"),"LEGEND",
Object(H.a)(this.Nc,this.Nc.akd,"onLegendOpen"),"LI",Object(H.a)(this.Nc,this.Nc.bkd,"onLiOpen"),"LINK",Object(H.a)(this.Nc,this.Nc.aOe,"onLinkTag"),"MAP",Object(H.a)(this.Nc,this.Nc.bOe,"onMapOpen"),"MATH",Object(H.a)(this.Nc,this.Nc.fkd,"onMathOpen"),"MENU",Object(H.a)(this.Nc,this.Nc.lJb,"onMenuOpen"),"META",Object(H.a)(this.Nc,this.Nc.eOe,"onMetaTag"),"NOFRAMES",Object(H.a)(this.Nc,this.Nc.hOe,"onNoframesOpen"),"NOSCRIPT",Object(H.a)(this.Nc,this.Nc.iOe,"onNoscriptOpen"),"OBJECT",Object(H.a)(this.Nc,
this.Nc.jOe,"onObjectOpen"),"OL",Object(H.a)(this.Nc,this.Nc.mkd,"onOlOpen"),"OPTGROUP",Object(H.a)(this.Nc,this.Nc.kOe,"onOptgroupOpen"),"OPTION",Object(H.a)(this.Nc,this.Nc.qkd,"onOptionOpen"),"P",Object(H.a)(this.Nc,this.Nc.tkd,"onPOpen"),"PARAM",Object(H.a)(this.Nc,this.Nc.lOe,"onParamTag"),"PRE",Object(H.a)(this.Nc,this.Nc.Fkd,"onPreOpen"),"Q",Object(H.a)(this.Nc,this.Nc.tOe,"onQOpen"),"S",Object(H.a)(this.Nc,this.Nc.Nkd,"onSOpen"),"SAMP",Object(H.a)(this.Nc,this.Nc.Okd,"onSampOpen"),"SCRIPT",
Object(H.a)(this.Nc,this.Nc.EOe,"onScriptOpen"),"SELECT",Object(H.a)(this.Nc,this.Nc.FOe,"onSelectOpen"),"SMALL",Object(H.a)(a,a.Xkd,"onSmallOpen"),"SPAN",Object(H.a)(b,b.Ykd,"onSpanOpen"),"STRIKE",Object(H.a)(c,c.Zkd,"onStrikeOpen"),"STRONG",Object(H.a)(f,f.$kd,"onStrongOpen"),"STYLE",Object(H.a)(l,l.LOe,"onStyleOpen"),"SUB",Object(H.a)(y,y.ald,"onSubOpen"),"SUP",Object(H.a)(G,G.dld,"onSupOpen"),"TABLE",Object(H.a)(R,R.hld,"onTableOpen"),"TBODY",Object(H.a)(ja,ja.OOe,"onTbodyOpen"),"TD",Object(H.a)(za,
za.Unc,"onTdOpen"),"TEXTAREA",Object(H.a)(Va,Va.QOe,"onTextareaOpen"),"TFOOT",Object(H.a)(hb,hb.ROe,"onTfootOpen"),"TH",Object(H.a)(Cb,Cb.ild,"onThOpen"),"THEAD",Object(H.a)(lc,lc.SOe,"onTheadOpen"),"TITLE",Object(H.a)(ic,ic.UOe,"onTitleOpen"),"TR",Object(H.a)(yc,yc.jld,"onTrOpen"),"TT",Object(H.a)(ec,ec.mld,"onTtOpen"),"U",Object(H.a)(jc,jc.nld,"onUOpen"),"UL",Object(H.a)(xd,xd.old,"onUlOpen"),"VAR",Object(H.a)(Xd,Xd.qld,"onVarOpen"))}}Object(m.a)(rC,"AHtmlProcessor",null,[]);class sC{constructor(a,
b){this.childNodes=a.childNodes;this.zw=b;this.i3d=0;this.H1c=!1}}Object(m.a)(sC,"HtmlProcessorArguments",null,[]);class lr extends rC{constructor(a,b=null){super(a,b);this.bJd=null}get k4j(){null==this.bJd&&(this.bJd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.bJd}process(a,b=null){a&&(this.Nc.reset(),this.Jkh(new sC(a,new lu),b))}Jkh(a,b){a.childNodes.length&&(a=new xf.a(b,Object(H.a)(this,this.lYk,"processChild"),a),a.$l("HTML Processing Operation"),
b||(a.Zi=!0),a.run())}lYk(a,b){const c=b.childNodes[b.i3d];if(3===c.nodeType)return this.Nc.Zid(),this.Nc.E1(c.nodeValue,new hz(c,b.zw.G7f())),lr.cRb(b);if(1!==c.nodeType)return lr.cRb(b);if(!b.H1c){const l=na.a.pC(c.tagName);if(!lr.BKj(c))if(this.vsf[l])this.yDk();else{lr.eyk(c);this.Nc.Zid();var f=c.id;const y=c.tagName,G=b.zw.G7f(),R=c.getAttribute?c.getAttribute("class"):null;f=new mu(f,y,R?R:"",c.attributes?c.attributes.length:0);f.isValid&&G.add(f);if(this.Cxf[l])return this.FDk(c,l,G),lr.cRb(b);
f=!1;switch(this.oDk(c,l,G)){case 1:f=!0;break;case 3:return lr.cRb(b)}switch(this.Nc.oge(c)){case 1:f=!0}b.H1c=f;this.Jkh(new sC(c,G),a);if(!a.Zi)return!0}}if(b.H1c){if(this.k4j&&!this.VAc[na.a.pC(c.tagName)])return lr.cRb(b);this.Nc.onClose()}return lr.cRb(b)}static eyk(a){3!==a.nodeType&&N.a.dw(a,"alreadyPasted",!0)}static BKj(a){return 3!==a.nodeType&&N.a.Be(a,"alreadyPasted")}static cRb(a){a.i3d++;a.H1c=!1;return a.i3d<a.childNodes.length}}Object(m.a)(lr,"HtmlProcessor",rC,[]);var es=d(955);
class sI{constructor(a,b=null,c=null,f=null){this.je=a;this.ZS=b||dn.a.N9f(z.a.c8a,"");this.zq=c;this.zra=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):!1}get Ob(){return this.ZS}get fo(){return this.zq}Lf(a){return a?a+1:1}reset(){this.je.reset()}Zid(){this.je.Zid()}oge(a){if(a&&this.fo&&(a.getAttribute&&(a.getAttribute(es.a.kTf)&&(this.fo.Y9d=!0),a.getAttribute(es.a.lTf)&&(this.fo.Z9d=!0),a.getAttribute(es.a.pTf)&&(this.fo.$9d=!0)),a.id&&a.id.startsWith&&a.id.startsWith(es.a.Xfg)&&(this.fo.a$d=!0),
a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(es.a.Xeh)&&(this.fo.s4f=!0);b.startsWith(es.a.ijh)&&(this.fo.b$d=!0);b.startsWith(es.a.zTh)&&(this.fo.c$d=!0);if(b.startsWith(z.a.e1b)&&b.length===z.a.e1b.length+1){const c=parseInt(na.a.substring(b,b.length-1,b.length));isNaN(c)||(this.fo.p3b=c)}if(b===es.a.A7g||b===es.a.B7g)this.fo.k7b=!0}return this.je.oge(a)}onClose(){this.je.onClose()}E1(a,b){this.fo&&(this.fo.u4f=!0);this.Ob.d=this.Lf(this.Ob.d);this.zra&&this.cya(b);
this.je.E1(a,b)}Tid(a){this.Ob.e=this.Lf(this.Ob.e);this.zra&&this.cya(a);return this.je.Tid(a)}iMe(a){this.Ob.f=this.Lf(this.Ob.f);return this.je.iMe(a)}jMe(a){this.Ob.g=this.Lf(this.Ob.g);return this.je.jMe(a)}lMe(a){this.Ob.h=this.Lf(this.Ob.h);return this.je.lMe(a)}sMe(a){this.Ob.i=this.Lf(this.Ob.i);return this.je.sMe(a)}vMe(a){this.Ob.j=this.Lf(this.Ob.j);this.je.vMe(a)}Xid(a){this.Ob.k=this.Lf(this.Ob.k);return this.je.Xid(a)}wMe(a){this.Ob.l=this.Lf(this.Ob.l);this.je.wMe(a)}xMe(a){this.Ob.m=
this.Lf(this.Ob.m);this.je.xMe(a)}yMe(a){this.Ob.n=this.Lf(this.Ob.n);return this.je.yMe(a)}cjd(a){this.Ob.o=this.Lf(this.Ob.o);return this.je.cjd(a)}djd(a){this.Ob.p=this.Lf(this.Ob.p);return this.je.djd(a)}KMe(a){this.Ob.q=this.Lf(this.Ob.q);return this.je.KMe(a)}ejd(a){this.Ob.r=this.Lf(this.Ob.r);this.je.ejd(a)}PMe(a){this.Ob.s=this.Lf(this.Ob.s);return this.je.PMe(a)}fjd(a){this.Ob.t=this.Lf(this.Ob.t);return this.je.fjd(a)}hjd(a){this.Ob.u=this.Lf(this.Ob.u);return this.je.hjd(a)}kjd(a){this.Ob.v=
this.Lf(this.Ob.v);return this.je.kjd(a)}mjd(a){this.Ob.w=this.Lf(this.Ob.w);return this.je.mjd(a)}$Me(a){this.Ob.x=this.Lf(this.Ob.x);this.je.$Me(a)}aNe(a){this.Ob.y=this.Lf(this.Ob.y);return this.je.aNe(a)}pjd(a){this.Ob.z=this.Lf(this.Ob.z);return this.je.pjd(a)}qjd(a){this.Ob.ba=this.Lf(this.Ob.ba);return this.je.qjd(a)}sjd(a){this.Ob.bb=this.Lf(this.Ob.bb);return this.je.sjd(a)}tjd(a){this.Ob.bc=this.Lf(this.Ob.bc);return this.je.tjd(a)}vjd(a){this.Ob.bd=this.Lf(this.Ob.bd);return this.je.vjd(a)}wjd(a){this.Ob.be=
this.Lf(this.Ob.be);return this.je.wjd(a)}xjd(a){this.Ob.bf=this.Lf(this.Ob.bf);return this.je.xjd(a)}Ajd(a){this.Ob.bg=this.Lf(this.Ob.bg);return this.je.Ajd(a)}xNe(a){this.Ob.bh=this.Lf(this.Ob.bh);return this.je.xNe(a)}Ijd(a){this.Ob.bi=this.Lf(this.Ob.bi);return this.je.Ijd(a)}DNe(a){this.Ob.bj=this.Lf(this.Ob.bj);return this.je.DNe(a)}ENe(a){this.Ob.bk=this.Lf(this.Ob.bk);this.je.ENe(a)}FNe(a){this.Ob.bl=this.Lf(this.Ob.bl);return this.je.FNe(a)}Njd(a){this.Ob.bm=this.Lf(this.Ob.bm);return this.je.Njd(a)}Ojd(a){this.Ob.bm=
this.Lf(this.Ob.bm);return this.je.Ojd(a)}Pjd(a){this.Ob.bm=this.Lf(this.Ob.bm);return this.je.Pjd(a)}Qjd(a){this.Ob.bm=this.Lf(this.Ob.bm);return this.je.Qjd(a)}Rjd(a){this.Ob.bm=this.Lf(this.Ob.bm);return this.je.Rjd(a)}Sjd(a){this.Ob.bm=this.Lf(this.Ob.bm);return this.je.Sjd(a)}KNe(a){this.Ob.bn=this.Lf(this.Ob.bn);return this.je.KNe(a)}Tjd(a){this.Ob.bo=this.Lf(this.Ob.bo);this.je.Tjd(a)}MNe(a){this.Ob.bp=this.Lf(this.Ob.bp);return this.je.MNe(a)}Ujd(a){this.Ob.bq=this.Lf(this.Ob.bq);return this.je.Ujd(a)}ONe(a){this.Ob.br=
this.Lf(this.Ob.br);return this.je.ONe(a)}Vjd(a){this.fo&&(this.fo.r4f=!0);this.zra&&this.cya(a);this.Ob.bs=this.Lf(this.Ob.bs);this.je.Vjd(a)}RNe(a){this.Ob.bt=this.Lf(this.Ob.bt);this.je.RNe(a)}Wjd(a){this.Ob.bu=this.Lf(this.Ob.bu);return this.je.Wjd(a)}YNe(a){this.Ob.bv=this.Lf(this.Ob.bv);return this.je.YNe(a)}Xjd(a){this.Ob.bw=this.Lf(this.Ob.bw);return this.je.Xjd(a)}Zjd(a){this.Ob.bx=this.Lf(this.Ob.bx);return this.je.Zjd(a)}akd(a){this.Ob.by=this.Lf(this.Ob.by);return this.je.akd(a)}bkd(a){this.fo&&
(this.fo.k7b=!0);this.Ob.bz=this.Lf(this.Ob.bz);this.zra&&this.cya(a);return this.je.bkd(a)}aOe(a){this.Ob.ca=this.Lf(this.Ob.ca);this.je.aOe(a)}bOe(a){this.Ob.cb=this.Lf(this.Ob.cb);return this.je.bOe(a)}fkd(a){this.fo&&(this.fo.q4f=!0);this.Ob.cc=this.Lf(this.Ob.cc);return this.je.fkd(a)}lJb(a){this.Ob.cd=this.Lf(this.Ob.cd);return this.je.lJb(a)}eOe(a){this.Ob.ce=this.Lf(this.Ob.ce);this.je.eOe(a)}hOe(a){this.Ob.cf=this.Lf(this.Ob.cf);return this.je.hOe(a)}iOe(a){this.Ob.cg=this.Lf(this.Ob.cg);
return this.je.iOe(a)}jOe(a){this.Ob.ch=this.Lf(this.Ob.ch);return this.je.jOe(a)}mkd(a){this.fo&&(this.fo.k7b=!0);this.Ob.ci=this.Lf(this.Ob.ci);this.zra&&this.cya(a);return this.je.mkd(a)}kOe(a){this.Ob.cj=this.Lf(this.Ob.cj);return this.je.kOe(a)}qkd(a){this.Ob.ck=this.Lf(this.Ob.ck);return this.je.qkd(a)}tkd(a){this.Ob.cl=this.Lf(this.Ob.cl);this.zra&&this.cya(a);return this.je.tkd(a)}lOe(a){this.Ob.cm=this.Lf(this.Ob.cm);this.je.lOe(a)}Fkd(a){this.Ob.cn=this.Lf(this.Ob.cn);return this.je.Fkd(a)}tOe(a){this.Ob.co=
this.Lf(this.Ob.co);return this.je.tOe(a)}Nkd(a){this.Ob.cp=this.Lf(this.Ob.cp);return this.je.Nkd(a)}Okd(a){this.Ob.cq=this.Lf(this.Ob.cq);return this.je.Okd(a)}EOe(a){this.Ob.cr=this.Lf(this.Ob.cr);return this.je.EOe(a)}FOe(a){this.Ob.cs=this.Lf(this.Ob.cs);return this.je.FOe(a)}Xkd(a){this.Ob.ct=this.Lf(this.Ob.ct);return this.je.Xkd(a)}Ykd(a){this.Ob.cu=this.Lf(this.Ob.cu);this.zra&&this.cya(a);return this.je.Ykd(a)}Zkd(a){this.Ob.cv=this.Lf(this.Ob.cv);return this.je.Zkd(a)}$kd(a){this.Ob.cw=
this.Lf(this.Ob.cw);return this.je.$kd(a)}LOe(a){this.Ob.cx=this.Lf(this.Ob.cx);return this.je.LOe(a)}ald(a){this.Ob.cy=this.Lf(this.Ob.cy);return this.je.ald(a)}dld(a){this.Ob.cz=this.Lf(this.Ob.cz);return this.je.dld(a)}hld(a){this.fo&&(this.fo.z$a=!0);this.Ob.da=this.Lf(this.Ob.da);this.zra&&this.cya(a);return this.je.hld(a)}OOe(a){this.fo&&(this.fo.z$a=!0);this.Ob.db=this.Lf(this.Ob.db);this.zra&&this.cya(a);return this.je.OOe(a)}Unc(a){this.fo&&(this.fo.z$a=!0);this.Ob.dc=this.Lf(this.Ob.dc);
this.zra&&this.cya(a);return this.je.Unc(a)}QOe(a){this.Ob.dd=this.Lf(this.Ob.dd);return this.je.QOe(a)}ROe(a){this.Ob.de=this.Lf(this.Ob.de);return this.je.ROe(a)}ild(a){this.fo&&(this.fo.z$a=!0);this.Ob.df=this.Lf(this.Ob.df);return this.je.ild(a)}SOe(a){this.fo&&(this.fo.z$a=!0);this.Ob.dg=this.Lf(this.Ob.dg);return this.je.SOe(a)}UOe(a){this.Ob.dh=this.Lf(this.Ob.dh);return this.je.UOe(a)}jld(a){this.fo&&(this.fo.z$a=!0);this.Ob.di=this.Lf(this.Ob.di);return this.je.jld(a)}mld(a){this.Ob.dj=this.Lf(this.Ob.dj);
return this.je.mld(a)}nld(a){this.Ob.dk=this.Lf(this.Ob.dk);return this.je.nld(a)}old(a){this.fo&&(this.fo.k7b=!0);this.Ob.dl=this.Lf(this.Ob.dl);return this.je.old(a)}qld(a){this.Ob.dm=this.Lf(this.Ob.dm);return this.je.qld(a)}cya(a){if((a=a.Yf)&&a.style&&this.fo){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.fo.zPj(a.tagName,c)}}}Object(m.a)(sI,"HtmlEventUsageCollector",null,[750]);class tI{constructor(a,b=null,c=null){this.je=a;this.ZS=b||dn.a.Jcg("");this.wai=c||dn.a.Kcg("")}get Ob(){return this.ZS}get b7e(){return this.wai}NY(a){this.b7e.b++;
this.je.NY(a)}KY(){this.je.KY()}MY(a){this.b7e.c++;this.je.MY(a)}LY(){this.je.LY()}JY(a){this.b7e.d++;this.je.JY(a)}IY(){this.je.IY()}reset(){this.je.reset()}get w4b(){return this.je.w4b}E1(a,b){this.Ob.b++;this.je.E1(a,b)}roa(a){this.Ob.c++;this.je.roa(a)}C_a(a){this.Ob.b++;this.je.C_a(a)}qoa(a){this.Ob.d++;this.je.qoa(a)}poa(a){this.Ob.f++;this.je.poa(a)}Exa(a,b){this.Ob.g++;this.je.Exa(a,b)}Dxa(){this.je.Dxa()}QA(a){this.Ob.h++;this.je.QA(a)}PA(){this.je.PA()}x_a(){this.je.x_a()}w_a(){this.je.w_a()}Jxa(a,
b){this.Ob.i++;this.je.Jxa(a,b)}ZJa(){this.je.ZJa()}uoa(a){this.Ob.j++;this.je.uoa(a)}soa(){this.je.soa()}Ixa(a){this.Ob.k++;this.je.Ixa(a)}toa(){this.je.toa()}y_a(a){this.Ob.l++;this.je.y_a(a)}}Object(m.a)(tI,"SemanticEventUsageCollector",null,[659,333]);class tC{constructor(a){this.Bh=a}reset(){this.Bh.reset()}get w4b(){return this.Bh.w4b}E1(a,b){this.Bh.E1(a,b)}roa(a){this.Bh.roa(a)}C_a(a){this.Bh.C_a(a)}qoa(a){this.Bh.qoa(a)}poa(a){this.Bh.poa(a)}Exa(a,b){this.Bh.Exa(a,b)}Dxa(){this.Bh.Dxa()}QA(a){this.Bh.QA(a)}PA(){this.Bh.PA()}x_a(){this.Bh.x_a()}w_a(){this.Bh.w_a()}uoa(a){this.Bh.uoa(a)}soa(){this.Bh.soa()}Ixa(a){this.Bh.Ixa(a)}toa(){this.Bh.toa()}y_a(a){this.Bh.y_a(a)}NY(a){this.Bh.NY(a)}KY(){this.Bh.KY()}MY(a){this.Bh.MY(a)}LY(){this.Bh.LY()}JY(a){this.Bh.JY(a)}IY(){this.Bh.IY()}Jxa(a,
b){this.Bh.Jxa(a,b)}ZJa(){this.Bh.ZJa()}}Object(m.a)(tC,"AHtmlNormalizer",null,[659,333]);class uC extends tC{constructor(a){super(a);this.ED=!1}E1(a,b){this.ED?this.xG.OF(()=>{this.aTe(a,b)}):this.aTe(a,b)}aTe(a,b){this.Bh.E1(a,b)}roa(a){this.ED?this.xG.OF(()=>{this.BSe(a)}):this.BSe(a)}BSe(a){this.Bh.roa(a)}qoa(a){this.ED?this.xG.OF(()=>{this.Spc(a)}):this.Spc(a)}Spc(a){this.Bh.qoa(a)}poa(a){this.ED?this.xG.OF(()=>{this.ASe(a)}):this.ASe(a)}ASe(a){this.Bh.poa(a)}Exa(a,b){this.ED?this.xG.OF(()=>
{this.vSe(a,b)}):this.vSe(a,b)}vSe(a,b){this.Bh.Exa(a,b)}Dxa(){this.ED?this.xG.OF(Object(H.a)(this,this.uSe,"processAnchorEnd")):this.uSe()}uSe(){this.Bh.Dxa()}QA(a){this.ED?this.xG.OF(()=>{this.LSe(a)}):this.LSe(a)}LSe(a){this.Bh.QA(a)}PA(){this.ED?this.xG.OF(Object(H.a)(this,this.KSe,"processParagraphEnd")):this.KSe()}KSe(){this.Bh.PA()}x_a(){this.ED?this.xG.OF(Object(H.a)(this,this.NSe,"processPreFormattedTextStart")):this.NSe()}NSe(){this.Bh.x_a()}w_a(){this.ED?this.xG.OF(Object(H.a)(this,this.MSe,
"processPreFormattedTextEnd")):this.MSe()}MSe(){this.Bh.w_a()}uoa(a){this.ED?this.xG.OF(()=>{this.FSe(a)}):this.FSe(a)}FSe(a){this.Bh.uoa(a)}soa(){this.ED?this.xG.OF(Object(H.a)(this,this.CSe,"processListEnd")):this.CSe()}CSe(){this.Bh.soa()}Ixa(a){this.ED?this.xG.OF(()=>{this.ESe(a)}):this.ESe(a)}ESe(a){this.Bh.Ixa(a)}toa(){this.ED?this.xG.OF(Object(H.a)(this,this.DSe,"processListItemEnd")):this.DSe()}DSe(){this.Bh.toa()}NY(a){this.ED?this.xG.OF(()=>{this.$Se(a)}):this.$Se(a)}$Se(a){this.Bh.NY(a)}KY(){this.ED?
this.xG.OF(Object(H.a)(this,this.XSe,"processTableEnd")):this.XSe()}XSe(){this.Bh.KY()}MY(a){this.ED?this.xG.OF(()=>{this.ZSe(a)}):this.ZSe(a)}ZSe(a){this.Bh.MY(a)}LY(){this.ED?this.xG.OF(Object(H.a)(this,this.YSe,"processTableRowEnd")):this.YSe()}YSe(){this.Bh.LY()}JY(a){this.ED?this.xG.OF(()=>{this.WSe(a)}):this.WSe(a)}WSe(a){this.Bh.JY(a)}IY(){this.ED?this.xG.OF(Object(H.a)(this,this.VSe,"processTableCellEnd")):this.VSe()}VSe(){this.Bh.IY()}Jxa(a,b){this.ED?this.xG.OF(()=>{this.GSe(a,b)}):this.GSe(a,
b)}GSe(a,b){this.Bh.Jxa(a,b)}ZJa(){this.ED?this.xG.OF(Object(H.a)(this,this.Wkh,"processMathEnd")):this.Wkh()}Wkh(){this.Bh.ZJa()}}Object(m.a)(uC,"AQueuingHtmlNormalizer",tC,[]);class uI{constructor(a){this.next=null;this.data=a}}Object(m.a)(uI,"QueueNode",null,[]);class vC{constructor(){this.C4a=this.L3a=null;this.pn=0}get count(){return this.pn}get isEmpty(){return!this.pn||!this.L3a||!this.C4a}enqueue(a){a=new uI(a);this.isEmpty?this.C4a=this.L3a=a:this.L3a=this.L3a.next=a;this.pn++}back(){return this.isEmpty?
null:this.L3a.data}dequeue(){if(this.isEmpty)return null;const a=this.C4a;this.C4a=a.next;this.pn--;this.C4a||(this.L3a=null);return a.data}clear(){this.C4a=this.L3a=null;this.pn=0}toArray(){const a=Array(this.count);let b=this.C4a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(m.a)(vC,"Queue",null,[]);class Cx{constructor(){this.NNd=new vC}OF(a){this.NNd.enqueue(a)}flush(a=!1){for(a&&this.mtd();!this.NNd.isEmpty;)this.NNd.dequeue()();a&&this.Nqd()}mtd(){}Nqd(){}}Object(m.a)(Cx,
"QueuedEventManager",null,[]);class iz extends Cx{constructor(a){super();this.id=void 0;this.n3d=null;this.F2c=!1;this.yoc="";this.E2c=this.x3c=!1;this.l3d=this.Yvb=null;this.Dmc=0;this.Nbc=this.edc=this.Wre=!1;this.table=null;this.lLe=0;this.aQ=a}get g0b(){return!!this.table}mtd(){this.aQ.IJb.push(this.aQ.currentState);this.aQ.currentState=this}Nqd(){this.aQ.currentState=this.aQ.IJb.pop()}}iz.nextId=void 0;Object(m.a)(iz,"ContentState",Cx,[]);class vI{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.qGa=a.qGa;this.Utc=a.Utc;this.verticalAlignment=a.verticalAlignment;this.X6=a.X6;this.Swd=a.Swd;this.eCb=a.eCb;this.NMc=a.NMc;this.contents=c;this.LBj=b}}Object(m.a)(vI,"TableCell",null,[]);class wI extends Cx{constructor(a,b){super();this.aQ=a;this.Zvf=new lu;this.MG=new lu;this.fLd=[];this.CGc=[];this.Aqa=-1;this.NAa=0;this.B2h=b.Cog;this.A2h=b.lXj;this.oai=b.S6e;this.k7a=b.width;this.nmf=b.qGa;this.g1h=new vn(new mu(b.ZU.okg,b.ZU.J$b),b.zw,
b.r6,b.cultureName,b.Xia);this.Y1h=b.fje;this.JHc=b.sIh;this.uai=b.tableLook}get Bh(){return this.aQ.Bh}kXk(a){this.Aqa++;this.Zvf.add(a);this.CGc[this.Aqa]=a.height;this.NAa=0}get DTi(){for(;this.NAa>=this.MG.count;)this.MG.add(Array(this.Aqa+1));return this.MG.ga(this.NAa)}jTd(a,b,c,f,l,y,G){if(0>this.Aqa)return!1;for(;this.fLd[this.NAa]>=this.Aqa;)this.NAa++;a=new vI(a,new vn(b,c,f,l,y),G);this.DTi[this.Aqa]=a;if(1<a.rowSpan)for(b=this.Aqa+a.rowSpan-1,f=this.NAa,c=this.NAa+a.colSpan-1;f<=c;f++)this.fLd[f]>=
b||(this.fLd[f]=b);this.NAa+=a.colSpan;this.CGc[this.Aqa]<a.height&&(this.CGc[this.Aqa]=a.height);return!0}mtd(){this.aQ.currentState.table=this}Nqd(){this.aQ.currentState.table=null}y3f(){this.flush(!0);const a=this.Aqa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.MG.count);c=!0;var f=0;for(var l=0;l<this.MG.count;l++){var y=this.MG.ga(l),G=!0;for(var R=0;R<a;R++){var ja=y[R];ja&&(G=!1,b[R][l+f]=new dz(ja.colSpan,ja.rowSpan,ja.width,ja.height,void 0,void 0,void 0,void 0,ja.qGa,ja.eCb))}G?
(this.MG.removeAt(l),l--,++f):c=!1}if(!c){(b=this.nmf?this.aQ.xJf(b,this.k7a/100):this.aQ.xJf(b))&&b.length!==this.MG.count&&(b=null);this.aQ.hEa(!0);this.aQ.yNc();this.Bh.NY(new mC(a,this.MG.count,this.k7a,this.nmf,b,this.B2h,this.A2h,this.oai,this.Y1h,this.JHc,this.uai,this.g1h));for(b=0;b<a;b++){c=this.Zvf.ga(b);this.Bh.MY(new lC(this.CGc[b],new vn(c.ZU,c.zw,c.r6,c.cultureName,c.Xia)));for(c=0;c<this.MG.count;c++){f=this.MG.ga(c)[b];var za=!!this.JHc&&""!==this.JHc&&"Custom"!==this.JHc;l=f?f.colSpan:
0;y=f?f.rowSpan:0;G=f?f.width:0;R=f?f.height:0;ja=f?f.NMc:0;const Va=f?f.qGa:!1,hb=f&&(65536&ja||!za)?f.Utc:"",Cb=f?f.verticalAlignment:0,lc=f?f.eCb:!1;za=f?this.aQ.Vpj(f.X6,c,b,this.MG,za,f.NMc):new hC;const ic=f?f.Swd:new iC,yc=f?f.LBj:null;this.Bh.JY(new dz(l,y,G,R,hb,Cb,za,ic,Va,lc,ja,new vn(yc?yc.ZU:null,yc?yc.zw:null,yc?yc.r6:null,yc?yc.cultureName:null,yc?yc.Xia:null)));f&&!f.eCb&&(f.contents.mtd(),f.contents.flush(),this.aQ.hEa(!1),this.aQ.yNc(),f.contents.Nqd());this.Bh.IY()}this.Bh.LY()}this.Bh.KY();
this.aQ.currentState.Nbc=!1;this.aQ.FZf(!1)}}}Object(m.a)(wI,"NormalizedTable",Cx,[]);class wC{constructor(a=!1,b=!1){this.Z2h=a;this.HI=b}get n1j(){return this.Z2h}get tV(){return this.HI}}Object(m.a)(wC,"HtmlNormalizerSettings",null,[431]);class fs extends uC{constructor(a,b=null){super(a);this.currentState=null;this.IJb=new yx;this.Vpb=b||new wC}reset(){super.reset();this.currentState=new iz(this);this.IJb.clear();this.ED=!1}get xG(){return this.currentState&&this.currentState.g0b?this.currentState.table:
this.currentState}nSc(a=!1){this.currentState.F2c||(this.yNc(),this.Bh.QA(this.currentState.n3d),this.currentState.F2c=!0,this.currentState.Nbc=!1);a||!this.currentState.Yvb||this.currentState.E2c||(this.Bh.Exa(this.currentState.Yvb,this.currentState.l3d),this.currentState.E2c=!0)}W5b(){this.currentState.E2c&&(this.Bh.Dxa(),this.currentState.E2c=!1)}z2i(){this.currentState.F2c&&(this.Bh.PA(),this.currentState.F2c=!1,this.currentState.yoc="")}FZf(a){this.currentState.edc&&(this.currentState.Nbc?a||
(this.Bh.QA(null),this.Bh.PA(),this.Bh.toa(),this.currentState.edc=!1):(this.Bh.toa(),this.currentState.edc=!1,this.currentState.Nbc=!0))}hEa(a){this.W5b();this.z2i();this.FZf(a)}mOk(a){this.Bh.uoa(new zx(2,1,a));this.currentState.Dmc++;this.currentState.Wre=!0}yNc(){!this.currentState.edc&&this.currentState.Wre&&(this.Bh.soa(),this.currentState.Dmc--,this.currentState.Wre=!1)}aTe(a,b){a=this.JCk(a);if(""!==a)if(this.nSc(),this.currentState.x3c)this.bTe(a,b);else{a=a.split(fs.gyi);for(let c=0;c<a.length-
1;c++)this.bTe(a[c],b),this.Bh.C_a(b);this.bTe(a[a.length-1],b)}}GSe(a,b){""!==a&&(this.nSc(),this.Bh.Jxa(a,b))}BSe(a){this.Vpb.tV||this.W5b();this.nSc(!0);this.Bh.roa(a)}ASe(a){this.currentState.g0b||this.Bh.poa(a)}Spc(a){this.currentState.Yvb&&(a.href=this.currentState.Yvb);super.Spc(a)}vSe(a,b){this.W5b();this.currentState.Yvb=a;this.currentState.l3d=b}uSe(){this.W5b();this.currentState.Yvb=null;this.currentState.l3d=null}LSe(a){this.currentState.n3d=a;this.hEa(!0)}KSe(){this.currentState.n3d=
null;this.hEa(!0)}NSe(){this.currentState.x3c=!0}MSe(){this.currentState.x3c=!1}FSe(a){this.hEa(!1);this.yNc();this.Bh.uoa(a);this.currentState.Dmc++}CSe(){this.hEa(!1);this.Bh.soa();this.currentState.Dmc--}ESe(a){this.hEa(!1);this.currentState.Dmc||this.mOk(a);this.Bh.Ixa(a);this.currentState.edc=!0;this.currentState.Nbc=!0}DSe(){this.hEa(!1)}NY(a){this.currentState.g0b||(this.ED=!0,this.currentState.table=new wI(this,a))}$Se(){}KY(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.IJb.isEmpty?(this.ED=!1,a.y3f()):this.xG.OF(Object(H.a)(a,a.y3f,"flushTable"))}}XSe(){}MY(a){this.currentState.g0b&&this.currentState.table.kXk(a)}ZSe(){}LY(){}YSe(){}JY(a){let b=!1;if(this.currentState.g0b){const c=new iz(this);this.currentState.table.jTd(a,new mu(a.ZU.okg,a.ZU.J$b),a.zw,a.r6,a.cultureName,a.Xia,c)?(this.IJb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.lLe++}WSe(){}IY(){0<this.currentState.lLe?this.currentState.lLe--:this.currentState=
this.IJb.pop()}VSe(){}xJf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const y=Array(f+1);for(var G=0;G<y.length;G++)y[G]=!1;G=new Oa.a;for(let ja=0;ja<f;ja++){for(var R=0;R<c;R++)if(a[R][ja]&&0<a[R][ja].width){const za=Math.min(ja+a[R][ja].colSpan,f);l[za]=l[ja]+a[R][ja].width*(a[R][ja].qGa?b:1);y[za]=!0}if(y[ja+1]){R=l[ja+1]-l[ja];if(0>=R)return null;G.add(R)}else l[ja+1]=l[ja]}return G.toArray()}Eyk(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}Vpj(a,b,c,f,l,y){if(!a)return null;l&&(a=this.Eyk(a,y));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.X6.borderRightStyle&&(a.borderLeftStyle=l.X6.borderRightStyle,a.borderLeftColor=l.X6.borderRightColor,a.borderLeftWidth=l.X6.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.X6.borderBottomStyle&&(a.borderTopStyle=b.X6.borderBottomStyle,a.borderTopColor=b.X6.borderBottomColor,a.borderTopWidth=b.X6.borderBottomWidth);return a}JCk(a){this.currentState.x3c||(a=this.Vpb.n1j?a.replace(fs.rNj," "):a.replace(fs.qNj," "));a.startsWith(" ")&&(this.currentState.yoc.endsWith(" ")||""===this.currentState.yoc)&&(a=na.a.substring(a,1,a.length));return a}bTe(a,b){""!==a&&(this.Bh.E1(a,b),this.currentState.yoc+=a)}}fs.qNj=RegExp("[ \t\f\u200b\r\n]+","g");fs.rNj=RegExp("[ \f\u200b\r\n]+",
"g");fs.gyi="\t";Object(m.a)(fs,"DefaultHtmlNormalizer",uC,[]);class xI extends fs{constructor(a,b,c){super(a,c);this.Gjf=!1;this.R4a=b}Spc(a){this.R4a.Bmd&&(w.AFrameworkApplication.dR?this.Gjf||(a=new sh.StandardDialog,a.Ad=0,a.Le(1,CommonUIStrings.l_DialogClose),a.Tx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.Gjf=!0):this.R4a.ozk?this.R4a.J5g=!0:a.src&&""!==a.src?ug.a.KQ(a.src)===ug.a.KQ(window.location.href)?w.AFrameworkApplication.Qa.processAction(C.a.Ahh,
2):a.src.startsWith("data:")&&19922944<a.src.length?w.AFrameworkApplication.Qa.processAction(C.a.yhh,2):a.src.startsWith("webkit-fake-url")?w.AFrameworkApplication.Qa.processAction(C.a.xhh,2):(M.a.instance.ga(1)?this.hEa(!1):M.a.instance.ga(11)&&(this.W5b(),this.nSc(!0)),this.Bh.qoa(a)):w.AFrameworkApplication.Qa.processAction(C.a.zhh,2))}}Object(m.a)(xI,"Box4HtmlNormalizer",fs,[]);class yI{constructor(a,b,c,f,l,y,G,R,ja,za){this.htmlProcessor=a;this.Iie=b;this.yTh=c;this.laj=f;this.Lll=l;this.Mll=
y;this.n_c=G;this.kNj=R;this.mNj=ja;this.pck=za}}Object(m.a)(yI,"ExecutePasteArguments",null,[]);class zI extends Xj{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){super(b,c,f,Va);this.J7=null;this.Fia=a;this.SCd=l;this.GHd=y;this.SQd=G;this.BSd=R;this.Xpb=ja;this.Vpb=Cb;this.Ma=za;this.vHd=Object.assign(new jC,{gbc:2===this.ag.aSa||3===this.ag.aSa});this.PFd=hb;this.aZb=za.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.L9h=za.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get Fid(){return!1}get fpg(){return!na.a.NJl(na.a.SDc,
this.Fia.innerText)}get bPf(){return this.Fia.innerText}G_f(a){this.J7=new ub.GraphIterator;this.rjb.restore(this.J7);ha.ULS.shipAssertTag(6305550,307,he.OutlineElementReader.hh(this.J7));this.ag.G1&&this.ag.G1.RKc("external");var b=this.ag.Jp&8192?1:0,c=this.GHd.value.create(b,this.J7);const f=this.SQd.value.create(b,this.J7),l=dn.a.Ofe(w.AFrameworkApplication.userSessionId),y=dn.a.Dbe(z.a.c8a,this.ag.E_d),G=dn.a.Jcg(w.AFrameworkApplication.userSessionId),R=dn.a.Kcg(w.AFrameworkApplication.userSessionId),
ja=this.aZb?this.YRj():null,za=dn.a.N9f(z.a.c8a,this.ag.E_d),Va=dn.a.O9f(w.AFrameworkApplication.userSessionId),hb=this.Xpb.TCh?dn.a.Unj(w.AFrameworkApplication.userSessionId):null;b=this.SCd.value.create(b,this.J7,c,f,null,y);b=new tI(b,G,R);b=new xI(b,c,this.Vpb);this.Xpb.sqe&&(this.vHd.rqe=this.ag.Jp&16384?!0:!1);b=new Jl(b,this.Xpb,this.vHd,hb);b=new sI(b,za,ja,this.Ma);b=new lr(b,Va);c=new yI(b,c,l,y,G,R,ja,za,Va,hb);c=new xf.a(a,Object(H.a)(this,this.mXk,"preprocessStyle"),c);c.$l("paste and request pictures");
c.Zi=!a||a.Zi;c.run()}mXk(a){if(this.L9h){const b=this.Fia.getElementsByTagName("style");if(b&&0<b.length){ha.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.PFd.lLi(this.Fia,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.gh(Object(H.a)(this,this.DLi,"convertWordListHtml"));return!0}DLi(a,b){this.BSd.value.create(b.yTh).process(this.Fia,a);a.gh(Object(H.a)(this,this.AYk,"processHtml"));return!0}AYk(a,
b){b.htmlProcessor.process(this.Fia,a);b=b.Iie&&b.Iie.Bmd?Object(H.a)(this,this.Lqd,"requestImages"):Object(H.a)(this,this.UYf,"endPasteOperation");a.gh(b);return!0}Lqd(a,b){if(b=b.Iie){let c=!1,f=!1,l=!1,y=!1,G=-1;const R=new J.DictionaryPropertySet,ja=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Sa.a)(10,this.ag.vd)){c=this.ag.vd.sa(sb.a.wpe,!1);const za=this.ag.vd.sa(we.a.aV,"");l=this.ag.vd.sa(we.a.z2c,!1);y=this.ag.vd.sa(Ya.a.sO,!1);ja.test(za)&&(f=!0);this.VCh&&(G=this.ag.vd.sa(ct.a.u5b,
-1))}else this.ag.Jp&256&&this.Fia&&(c=!0,ja.test(this.Fia.innerHTML)&&(f=!0));R.setValue(sb.a.wpe,c);R.setValue(we.a.p9j,f);R.setValue(we.a.z2c,l);R.setValue(ct.a.u5b,G);R.setValue(Ya.a.sO,y);b.V8g&&(this.ag.Kbc=!0,this.ag.Yie=b.CQc,this.ag.ZLe=b.V8g,w.AFrameworkApplication.Qa.processAction(C.a.Lqd,2))}a.gh(Object(H.a)(this,this.UYf,"endPasteOperation"));return!0}UYf(a,b){dn.a.Ahk(b.yTh);dn.a.Bfk(b.mNj);dn.a.Ngk(b.Lll);dn.a.Ogk(b.Mll);dn.a.Tfk(b.pck);a="Others";b.n_c&&(b.n_c.yfk(),b.n_c.zfk(),a=
b.n_c.b5e);dn.a.Afk(b.kNj,a);dn.a.qfk(b.laj,a);return!1}YRj(){const a=new rI;a.$Jb=z.a.c8a;this.ag&&(a.Jp=this.ag.Jp,a.oPe=this.ag.E_d,this.ag.vd&&(a.eTe=this.ag.vd.sa(we.a.whh,"")));this.Fia&&this.Fia.innerHTML&&(a.vhh=this.Fia.innerHTML.length);w.AFrameworkApplication.Md&&(a.platform=w.AFrameworkApplication.Md.Platform);return a}get iDh(){return!0}get hDh(){ha.ULS.shipAssertTag(6305551,307,!!this.J7);if(this.Xpb.UCh(this.vHd)){let a=!1;he.OutlineElementReader.hh(this.J7)&&(this.J7.B9b(),a=!0);const b=
zb.ParagraphReader.vl(this.J7)&&!this.J7.currentNode.sa(we.a.$pg,!1);a&&this.J7.Cc();return b}return zb.ParagraphReader.vl(this.J7)}}Object(m.a)(zI,"ExternalPasteExecutionManager",Xj,[]);class AI{constructor(a,b,c,f,l,y,G,R){this.SCd=a;this.GHd=b;this.SQd=c;this.BSd=f;this.Xpb=l;this.Ma=y;this.PFd=G;this.Vpb=R}create(a,b,c,f){return new zI(a,b,c,f,this.SCd,this.GHd,this.SQd,this.BSd,this.Xpb,this.Ma,Sc.App.Mb.Ld,this.PFd,this.Vpb)}}Object(m.a)(AI,"Factory",null,[523]);class jz{constructor(a){this.xla=
a.Gmj();this.Yab=a.xWc("intCopy");this.Old=a.lde("intCopy");this.z8a=a.oVc("intCopy");this.oRa=a.dVc("intCopy")}static ZW(){return jz.Kr()}static Kr(){return new jz(le.a.instance)}}Object(m.a)(jz,"InternalCopyUsageHelper",null,[]);class Dx{constructor(a,b,c){this.GN=jz.ZW();this.cNc=null;this.Lud=this.bAd=!1;this.Xhf=null;this.source=a;this.target=b;this.NPe=c}get n7(){return this.GN}get AL(){return this.Xhf}set AL(a){this.Xhf=a}}Object(m.a)(Dx,"InternalCopyArguments",null,[]);class BI extends Dx{constructor(a,
b,c,f){super(a,b,{});this.wNb=[];for(a=0;a<c.length;a++)Array.addRange(this.wNb,c.ga(a).toArray());this.Ksa=0;this.kCj=f}}Object(m.a)(BI,"BasicInternalCopyArguments",Dx,[]);class CI extends Sys.EventArgs{constructor(a){super();this.AL=a}}Object(m.a)(CI,"BeforePasteArguments",Sys.EventArgs,[]);class kz extends Dx{constructor(a,b){super(a.source,a.target,a.NPe);this.ag=a;this.insertAfter=b}get n7(){return this.ag.n7}get AL(){return this.ag.AL}set AL(a){this.ag.AL=a}}Object(m.a)(kz,"CoreInternalCopyArguments",
Dx,[]);class lz{constructor(a,b,c,f,l=null){this.source=a;this.target=b;this.insertAfter=c;this.zld=f;this.AL=l||{}}}Object(m.a)(lz,"CoreInternalPasteArguments",null,[]);class DI{constructor(a,b,c,f,l,y,G,R,ja){this.eQb=a;this.source=b;this.target=c;this.zld=f;this.rowIndex=l;this.Kja=y;this.khh=R;this.Nf=ja}}Object(m.a)(DI,"CoreInternalTablePasteArguments",null,[]);class mz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.AL=l}}Object(m.a)(mz,"ParagraphCopyPasteArguments",
Sys.EventArgs,[]);var mr=d(211);class Ci{static Ar(){Ci.aNb=new Pb.a;Ci.aNb.$(88,!0);Ci.aNb.$(4,!0)}static Jta(a,b,c){const f=[];if(M.a.instance.ga(104)&&a.Sl&&Vd.SelectionFactory.n8j(a))a=ub.GraphIterator.pb(a.nb.og.Ua.node),a.rc(14),c=bb.a.create(a.origin),c=Ci.gLc(c,!0,!0,null),a.set(c),Jb.SelectionEditor.Pt(a),Ci.HTa(a,f);else for(let za=0;za<a.length&&!(c&&0<f.length);++za){var l=a.ga(za),y=Ci.pWc(l,!0),G=Ci.pWc(l,!1);if(!y||!G)continue;if(y===G&&y.contextId===rb.a.Mf){l=ub.GraphIterator.pb(y.node);
l.rc(11)&&Ci.HTa(l,f);continue}var R=void 0;R=l=null;var ja=-1;let Va;if(y.node===G.node)Va=y.node,G=G.node;else{R=Ci.I5f(y.node);l=Ci.I5f(G.node);for(ja=0;ja<R.length&&ja<l.length&&R[ja]===l[ja];++ja);R=R[ja-1];--ja;Va=Ci.gLc(y,!0,!1,R);G=Ci.gLc(G,!1,!0,R)}if(Va===G)l=Va===y.node?y:bb.a.create(Va),l=Ci.gLc(l,!0,!0,null),y=new Nn.a,y.set(l),Jb.SelectionEditor.Pt(y),Ci.HTa(y,f);else{y=new Nn.a;y.set(Va);Jb.SelectionEditor.Pt(y);Va===R&&y.Ri();for(Ci.HTa(y,f);y.parentNode!==R;){for(;y.xp();)Ci.HTa(y,
f);y.Cc()}if(G===R)for(;y.xp();)Ci.HTa(y,f);else{y.xp();for(R=ja+1;R<l.length;++R){for(;y.currentNode!==l[R];)Ci.HTa(y,f),y.xp();if(G===l[R])break;y.Ri()}Ci.HTa(y,f)}}}if(0>=f.length)return null;if(b)for(b=new ub.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),rc.OutlineElementNavigator.yi(b),f[a]=bb.a.create(b.currentNode);return nb.a.jSa(f)}static pWc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).Rk)return a.ga(b);if(a.ga(b).Cx){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).Rk)return c.getContext(f)}}else for(b=
a.length-1;0<=b;--b){if(a.ga(b).Rk)return a.ga(b);if(a.ga(b).Cx)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).Rk)return c.getContext(f)}return null}static HTa(a,b){Ci.Gsg(a)?Ci.F7i(a,b):Ci.aNb.Gb(a.role)||(a=a.jx(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,bb.a.create(a)))}static I5f(a){const b=[],c=new ub.GraphIterator;c.set(a);Jb.SelectionEditor.Pt(c);for(Array.add(b,a);c.Cc();)Array.add(b,c.currentNode);b.reverse();return b}static gLc(a,b,c,f){let l=a.node;if(Jb.SelectionEditor.tk(a)&&
(b&&0<a.Ra||c&&a.Lb<zb.ParagraphReader.textLength(l))||Jb.SelectionEditor.nm(a)&&b&&0<zb.ParagraphReader.textLength(l))return l;a=new Nn.a;a.set(l);for(Jb.SelectionEditor.Pt(a);!a.pr;){l=a.currentNode;if(f===l||b&&!Ci.E_j(a)||c&&!Ci.S1j(a))return l;a.Cc()}return a.currentNode}static S1j(a){let b=!0;if(a.xp())for(b=!1;Ci.aNb.Gb(a.role)||M.a.instance.ga(77)&&16===a.Bi&&Oc.isGhostCell(a);)if(!a.xp()){b=!0;break}return b}static E_j(a){const b=a.currentNode;let c=!0;if(a.pua())for(c=!1;Ci.aNb.Gb(a.role);)if(!a.pua()){c=
!0;break}a.Cc();a.el(b);return c}static F7i(a,b){a=He.a.zv(a);for(a.wm(Ci.t7i,null);a.moveNext();)he.OutlineElementReader.O9(a.currentNode)&&Array.add(b,bb.a.create(a.currentNode))}static t7i(a){return Ci.Gsg(a)}static Gsg(a){return a.pr||1===a.role||27===a.role}}Ci.aNb=null;Object(m.a)(Ci,"OutlineElementGeneralizer",null,[]);Ci.Ar();class EI{constructor(){this.controlCell=this.vn=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(m.a)(EI,"ComplexCellData",null,[]);var Ex=d(180);class xC{constructor(a){this.qn=
a;a.Wdk()}dispose(){this.qn.IQl()}static pb(a){return new xC(a.hk)}}Object(m.a)(xC,"TempGraphAlgorithmLock",null,[108]);class Yh{constructor(a,b,c){this.Mgf=this.FI=null;this.pFc=[];this.IAc=[];this.DHc=[];this.oTb={};this.mMd={};this.kCd={};this.$D=null;this.O6a=Yh.fzj(a);this.O6a.Jyk();this.Pai=xC.pb(this.O6a);Yh.epb=this;this.Z7=1;this.BEd=b;this.k4a=c}get Yq(){return this.$D||(this.$D=Fb.a.instance.resolve("Box4.ITableEditor"))}get gK(){return this.FI||(this.FI=Fb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<
--this.Z7)){var a=new pf.GraphTransaction(7);a.ld(this.O6a);this.PZk();this.Gzk();this.m9i();M.a.instance.ga(63)&&this.BDi();this.o9i();a.dispose();this.G3()}}ytl(a){this.Mgf=a}o9i(){var a=ub.GraphIterator.pb(this.O6a);if(!a.qFa()){const b=this.gK.K3b(a);Yh.dC.vW(a,!0);a=Sc.App.Mb.Ld.Rn;a.yp&&Yh.dC.Gtd(b,a.v9b())}}cancel(){if(!(0<--this.Z7)){var a=Ex.a.gA(this.O6a);for(a.wm(Yh.oef,null);a.moveNext();)a.iterator.pr||a.iterator.DZ(16,!1);this.G3()}}G3(){this.O6a.JQl();this.Pai.dispose();Yh.epb=null}Tpa(a){a.Rk?
(Yh.k9j(a)&&Array.add(this.pFc,a.node),this.VLh(a.node)):a.Cx&&this.hMl(a)}hMl(a){for(let b=0;b<a.length;++b)this.Tpa(a.getContext(b))}VLh(a){a.anchor.aU(16)}Gzk(){for(let b=0;b<this.pFc.length;++b){var a=this.pFc[b];if(!a.anchor||a.anchor.vJ)continue;const c=new ub.GraphIterator;c.set(a);if(!Jb.SelectionEditor.Pt(c))continue;rc.OutlineElementNavigator.Se(c);if(this.k4a.Ozi(c)){Yh.Xh.SDa(c);continue}a=new Nn.a;a.Tc(c);if(!rc.OutlineElementNavigator.cK(a,!1,!1))continue;if(36===a.role)continue;rc.OutlineElementNavigator.yi(a);
if(a.currentNode.nX)continue;if(Hd.TableReader.jq(a))continue;rc.OutlineElementNavigator.Se(a);const f=new ub.GraphIterator;f.Tc(a);f.Cc();Yh.Xh.merge(c,a,!1,!1);he.OutlineElementReader.uJ(f)&&!f.qFa()&&a.Qi()}Array.clear(this.pFc)}BDi(){for(let a=0;a<this.DHc.length;++a){const b=this.DHc[a];if(!b.anchor||b.anchor.vJ)continue;if(Oc.isGhostCellNode(b))continue;const c=new ub.GraphIterator;c.set(b);c.DB(1);c.Db(2);Hd.TableReader.jq(c)&&(c.Cc(),Yh.Xh.rea(c,!1,!0,null))}Array.clear(this.DHc)}ggj(a){const b=
a.id.toString();if(this.oTb[b])return this.oTb[b];const c=Array(Hd.TableReader.Gi(a));for(let f=0;f<Hd.TableReader.Gi(a);++f)c[f]=0;this.oTb[b]=c;this.mMd[b]=Hd.TableReader.Ek(a);return c}PZk(){const a=Ex.a.gA(this.O6a);a.wm(Yh.oef,null);var b=a.moveNext();const c=new ub.GraphIterator;let f=0;for(;b;)if(a.iterator.pr)this.oDi(a.iterator),b=a.moveNext();else if(this.k4a.e4j(a.iterator)&&Array.add(this.IAc,a.iterator.currentNode),M.a.instance.ga(63)&&Oc.isTableCell(a.iterator)&&Array.add(this.DHc,a.iterator.currentNode),
Yh.Zzi(a.iterator))switch(a.iterator.Bi){case 16:b=ae.getContainingTable(a.iterator);if(this.BEd&&!Hd.TableReader.yt(b)&&!Oc.isGhostCell(a.iterator)){b=this.ggj(b);var l=eo.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=ae.getContainingTable(a.iterator);this.BEd&&!Hd.TableReader.yt(b)?(this.kCd[b.id.toString()]=!0,c.Tc(a.iterator),b=a.moveNext(),this.Yq.oQc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.Mgf?(a.moveNext(),c.Tc(a.iterator),b=a.moveNext(),Yh.Xh.SDa(c)):(a.iterator.DZ(16,
!1),b=a.moveNext());break;case 23:c.Tc(a.iterator);b=a.moveNext();c.Qi();break;case 11:f++;Je.b(a.iterator)?(a.iterator.DZ(16,!1),b=a.moveNext()):(c.Tc(a.iterator),Bb.ListReader.Hk(c)&&!this.k4a.U2e(c,f)&&Yh.kq.Soa(c),c.kJ(2)?this.k4a.uxl(c,f)?b=a.moveNext():(c.Tc(a.iterator),b=a.moveNext(),Yh.Xh.SDa(c)):(b=a.moveNext(),Yh.Xh.SDa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(Hd.TableReader.jq(a.iterator)&&this.BEd){var y=a.currentNode;let G=y.id.toString();const R=this.oTb[G];
let ja=!1;if(R){const za=this.mMd[G];for(y=Hd.TableReader.Gi(y)-1;0<=y;--y)R[y]===za&&(this.Yq.mQc(a.iterator,y),ja=!0)}Hd.TableReader.Gi(a.iterator.currentNode)?M.a.instance.ga(30)&&(ja||this.kCd[G])&&Hd.TableReader.nre(a.iterator.currentNode)&&(c.Tc(a.iterator),ae.moveToFirstRow(c),ae.moveToFirstColumn(c),b=a.moveNext(),Yh.Xh.Bsh(a.iterator,c)):(a.moveNext(),c.Tc(a.iterator),b=a.moveNext(),c.Qi(),l=!1)}l&&(a.iterator.DZ(16,!1),b=a.moveNext())}this.oTb={};this.mMd={};this.kCd={}}oDi(a){if(a.Ri()){do a.DZ(16,
!1);while(a.nFa())}}m9i(){for(let b=0;b<this.IAc.length;++b){var a=this.IAc[b];if(a.anchor&&!a.anchor.vJ){const c=new ub.GraphIterator;c.set(a);Sg.OutlineNavigator.zaa(c)||(c.currentNode.setValue(Ya.a.WE,rn.a.first),M.a.instance.ga(41)&&10===c.Bi&&(a=Yh.Xh.cke(c,null,1),c.el(a)),Yh.dC.vW(c,!0))}}Array.clear(this.IAc)}static get kq(){return Yh.lp||(Yh.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}static get dC(){return Yh.ey||(Yh.ey=Fb.a.instance.resolve("Box4.IOutlineEditor"))}static get Xh(){return Yh.Mi||
(Yh.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get nI(){return cj.a.instance}static get ij(){return Mh.a.instance}static jXc(a,b){Yh.epb?Yh.epb.Z7++:Yh.epb=new Yh(a,b,Fb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Yh.epb}static fzj(a){a=ub.GraphIterator.pb(a);Jb.SelectionEditor.Pt(a);a.VMb(b=>b.bdc);return a.currentNode}static k9j(a){let b=!1;Jb.SelectionEditor.nm(a)&&(b=!M.a.instance.ga(14)||!Yh.ij.a2c(a));!b&&zb.ParagraphReader.Im(a)&&(b=!M.a.instance.ga(14)||
!Yh.ij.g3c(a)&&!a.node.sa(sb.a.Ucb,!1));return b}static Zzi(a){switch(a.Bi){case 12:return a.currentNode.yMc}if(!a.Ri())return Yh.nI.ivg(a)?Yh.nI.dZd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.lX&16||16===a.Bi&&Oc.isGhostCell(a)||(b=!1)}a.DZ(16,!0)}while(a.nFa());b&&Yh.nI.ivg(a)&&(b=Yh.nI.dZd(a.currentNode));return b}static Nzi(a){return a.pr||!!(a.lX&16)}}Yh.oef=Yh.Nzi;Yh.epb=null;Yh.Oa=new Wc.a;Yh.ey=null;Yh.lp=null;Yh.Mi=null;Object(m.a)(Yh,"GraphStructureNormalizer",
null,[]);class gs{constructor(){this.Z1a=this.vn=this.UA=null;this.KJa=0;this.response=2}}Object(m.a)(gs,"TableGeneralizeData",null,[]);class qi{static get Cm(){return Th.ContextSetEditor.instance}static v6(a,b,c,f,l,y,G){let R=!1;y&&y[qi.VRb]&&y[qi.VRb]&&(R=!0);if(!b.view.Uh)return 2;const ja=b.view;var za=ja.Nb;if(1===c){if(!za||!za.Pa.nb)return 8;b=0===G?b.RE:qi.Cm.o7b(b.RE,G,!0);return w.AFrameworkApplication.Qa.ii(b,a,c,!0,f,l)}y&&y[qi.dqa]&&kf.a.mark(y[qi.dqa]);const Va=Ul.SelectionReferenceFactory.instance.Psa(),
hb=za.Pa.nb.Ua;za=new pf.GraphTransaction(15);za.ld(hb.node);za.$ya();b=0===G?b.RE:qi.Cm.o7b(b.RE,G);a=w.AFrameworkApplication.Qa.ii(b,a,c,!0,f,l);32===a&&Va.hV(R);t.FocusManager.instance().wf(ja.$I);za.dispose();Sc.App.Mb.updateCommandUI();y&&y[qi.cqa]&&kf.a.mark(y[qi.cqa]);return a}static $ib(a,b,c,f,l,y){var G=ze.a.instance;let R,ja=!1;y&&y[qi.VRb]&&y[qi.VRb]&&(ja=!0);if(1===c)return G&&G.Pa.nb?(R=Ci.Jta(G.Pa,!1,!0))?w.AFrameworkApplication.Qa.ii(R,a,c,!0,f,l):8:8;y&&y[qi.dqa]&&kf.a.mark(y[qi.dqa]);
const za=Ul.SelectionReferenceFactory.instance.Psa(),Va=G.Pa.nb.Ua;R=Ci.Jta(G.Pa,!1);if(!R)return 8;G=new pf.GraphTransaction(15);G.ld(Va.node);G.$ya();a=w.AFrameworkApplication.Qa.ii(R,a,c,!0,f,l);32===a&&za.hV(ja);(b=b.view)&&t.FocusManager.instance().wf(b.$I);G.dispose();Sc.App.Mb.updateCommandUI();y&&y[qi.cqa]&&kf.a.mark(y[qi.cqa]);return a}}qi.dqa="PerfMarkStart";qi.cqa="PerfMarkEnd";qi.VRb="CollapseIp";Object(m.a)(qi,"ViewActionHandler",null,[]);var FI=d(568);class GI{constructor(){this.controlCell=
null;this.tNf=this.jvh=0;this.Q2f=this.R2f=null}}Object(m.a)(GI,"MergedCellInfo",null,[]);var Fx=d(322),HI=d(686),TQ=d(739),fo=d(372);class Hv extends Oi.a{constructor(a){super(0,0,0);this.K3=a;this.bOa=Array(a)}jgj(a){return this.bOa[a]}Nyh(a,b){this.bOa[a]=b}copy(){const a=new Hv(this.K3);for(let b=0;b<this.K3;++b)a.bOa[b]=this.bOa[b];return a}Ozk(){let a=fo.a.Mmb;for(let b=0;b<this.K3;++b)a+=this.bOa[b]+1;return a}static fGi(a,b){const c=new Hv(a.K3);for(let f=0;f<c.K3;f++)c.bOa[f]=Math.max(a.bOa[f],
b.bOa[f]);return c}}Object(m.a)(Hv,"TableRowViewSizeConstraints",Oi.a,[]);class nu extends wk.a{constructor(a,b,c,f,l,y=null){super(a,b,c);this.K3a=null;this.cEd=0;this.Ezc=-1;this.kd=f;this.hd=l;this.jc(this.Od.vp(Fa.a.tr));this.htmlElement.className="TableRow";xb.d(this.htmlElement,wa.a.role,"row");this.qsh();this.Ygf=y}az(){this.gb.Agh=[];this.htmlElement.style.height=this.hvh;this.qsh()}qsh(){this.kd&&this.kd.VFa(65)&&(this.gb.e3b?Sys.UI.DomElement.addCssClass(this.htmlElement,Lb.B4):Sys.UI.DomElement.removeCssClass(this.htmlElement,
Lb.B4))}pol(a){const b=this.Ezc!==a;this.Ezc=a;return b}MUl(){this.htmlElement.style.height=this.ivh+"px"}get ivh(){let a=0>=this.Ezc?nu.y6g:this.Ezc;this.gb.Ta(sb.a.Ku)&&(a=Math.max(a,this.Od.Nd.Pe(this.gb.eb(sb.a.Ku),1)));return a}get hvh(){return this.gb.Ta(sb.a.Ku)?this.Od.Nd.Pe(this.gb.eb(sb.a.Ku),1)+"px":"auto"}fV(a){super.fV(a);var b=Hd.TableReader.Gi(ae.getContainingTable(a));let c=0;b=new Hv(b);if(a.Db(1)){do b.Nyh(c,a.ir.lMa.total),c++;while(a.Pj(1))}return b}AK(a){super.AK(a);this.fS.UU(this.htmlElement)}get author(){return this.K3a}I$e(a){let b=
!0;if(this.Qc.yp&&this.Qc.QWj){a=He.a.zv(a);for(var c={};a.moveNext();){if(!he.OutlineElementReader.hh(a.iterator)||he.OutlineElementReader.Bhe(a.iterator))continue;const f=he.OutlineElementReader.bVc(a.currentNode,Ya.a.S0b);f&&(c[f]="")}a=ta.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.K3a=a,this.cEd=c.height,b=!1)}b&&(this.K3a="",this.cEd=-1)}get S0d(){return this.cEd}idl(){this.Ygf&&this.Ygf.O2l(this)}}nu.y6g=20;Object(m.a)(nu,
"TableRowViewElement",wk.a,[726]);class Zh{constructor(a,b){Zh.ey=a;Zh.Mi=b}Sfl(a){const b=a.Ywd.currentNode;this.hTl(b);let c=this.kMi(b);var f=this.$xj(b,c);let l=f.length;a.tQc=this.r8i(f);a.rQc=this.I7i(f);f=a.tQc.toArray().length;const y=a.rQc.toArray().length;if(0<f||0<y)l-=f,c-=y,this.AVl(a);this.lOb(Object(sa.a)(Ig.a,b),l);this.WNb(Object(sa.a)(Ig.a,b),c);this.vfl(a)}I7i(a){const b=new Oa.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}r8i(a){const b=
new Oa.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}kMi(a){let b=0;a=ub.GraphIterator.pb(a);ae.moveToFirstRow(Object(sa.a)(ub.GraphIterator,a));ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,a));let c=Object(sa.a)(131,a.Dq),f=!1;for(;c;)!c.isGhostCell||Oc.isSkippedCell(Object(sa.a)(Ig.a,c))?(b+=c.hbb?c.colSpan:1,f=!0):f||b++,c=Object(sa.a)(131,ae.moveToNextColumn(Object(sa.a)(ub.GraphIterator,a)));return b}AVl(a){const b=
ub.GraphIterator.pb(a.Ywd.Dq);let c=0;ae.moveToFirstRow(Object(sa.a)(ub.GraphIterator,b));var f=b.Dq;const l=ve.a.gf(nu.y6g,1);for(;f;){for(;a.tQc.contains(c);)c++;var y=1,G=a.bvc?a.bvc.rowIndex:0,R=a.MGh[G+c];for(R<l&&(R=l);a.tQc.contains(c+y);){var ja=a.MGh[G+c+y];ja<l&&(ja=l);R+=ja;y++}f.setValue(sb.a.Ku,R);f=y-1;y=0;ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,b));for(G=Object(sa.a)(131,b.Dq);G;){R=G.hbb?G.colSpan:1;if(!G.isGhostCell||1<R){0<f&&(G.rowSpan-=f,1>G.rowSpan&&(G.rowSpan=1));
ja=0;for(let za=1;za<R;za++)a.rQc.contains(y+za)&&ja++;0<ja&&(G.colSpan-=ja,1>G.colSpan&&(G.colSpan=1))}y+=R;G=Object(sa.a)(131,ae.moveToNextColumn(Object(sa.a)(ub.GraphIterator,b)))}c++;ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,b));b.Cc();f=ae.moveToNextRow(Object(sa.a)(ub.GraphIterator,b))}}hTl(a){const b=new Oa.a;a=ub.GraphIterator.pb(a);ae.moveToFirstRow(Object(sa.a)(ub.GraphIterator,a));for(var c=a.Dq;c;){c=!1;let l=0;ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,a));for(var f=
Object(sa.a)(Fx.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.hbb?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.e_d())):Oc.isSkippedCell(Object(sa.a)(Ig.a,f))||b.contains(l)&&(c||M.a.instance.ga(77))||(f.isGhostCell=!1,f.e_d());else{c=!0;f=f.hbb?f.colSpan:1;for(let y=0;y<f;y++)b.contains(l+y)||b.add(l+y)}l++;f=Object(sa.a)(Fx.TableCellNode,ae.moveToNextColumn(Object(sa.a)(ub.GraphIterator,a)))}ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,a));a.Cc();c=ae.moveToNextRow(Object(sa.a)(ub.GraphIterator,
a))}}$xj(a,b){const c=[];let f=0;a=ub.GraphIterator.pb(a);ae.moveToFirstRow(Object(sa.a)(ub.GraphIterator,a));for(var l=a.Dq;l;){l=0;ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,a));for(var y=Object(sa.a)(131,a.Dq);y;){if(!y.isGhostCell||Oc.isSkippedCell(Object(sa.a)(Ig.a,y))){const G=y.hbb?y.colSpan:1;for(y=y.xhe?y.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let R=0;R<y;R++){const ja=f+R;ja===c.length&&Array.add(c,Array(b));for(let za=0;za<G;za++)c[ja][l+za]=0<R||0<za?2:1}l+=G}y=
Object(sa.a)(131,ae.moveToNextColumn(Object(sa.a)(ub.GraphIterator,a)))}ae.moveToFirstColumn(Object(sa.a)(ub.GraphIterator,a));a.Cc();l=ae.moveToNextRow(Object(sa.a)(ub.GraphIterator,a));f++}return c}vfl(a){if(Hd.TableReader.jq(a.Ywd)&&a.bvc&&a.KGh){var b=Object(sa.a)(129,a.Ywd.Dq),c=a.KGh,f=Array(b.K3),l=a.bvc.Kja;for(let y=0;y<f.length;y++)for(f[y]=c[l],l++;a.rQc.contains(l-a.bvc.Kja);)f[y]+=c[l],l++;b.URa=f}}jAa(a){if(M.a.instance.ga(77)||M.a.instance.ga(63))ae.forEachCellInTable(a,b=>{b.currentNode.zJa=
null;return!0}),ae.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.BPi(b,f,l):c.vYe()}return!0})}BPi(a,b,c){const f=a.currentNode,l=new ub.GraphIterator;l.Tc(a);ae.forEachCell(l,b,c,(y,G,R)=>{const ja=y.currentNode;if(ja!==f){ja.isGhostCell=!0;let Va=!1;var za=!0;const hb=Zh.Fe;hb&&(Va=hb.isFeatureEnabled(136),hb.Edb(136));do{y.Db(1);if(Object(Sa.a)(FI.a,y.currentNode)){if((za=za&&he.OutlineElementReader.isEmpty(y,!1))||!Va)za=ub.GraphIterator.pb(y.Dq),
za.rc(16),za=!za.Hf(1);za||a.Gl(y.currentNode,1);y.Qi()}za=!1}while(Va&&y.kJ(1))}ja.zJa=Object.assign(new GI,{controlCell:f,jvh:G,tNf:R});1!==G||R||(f.zJa.Q2f=ja);G||1!==R||(f.zJa.R2f=ja);ja.vYe();R||(ja.colSpan=c)});f.rowSpan=b;f.colSpan=c}Vje(a){const b=new ub.GraphIterator;b.Tc(a);ae.returnToContainingRow(b);var c=b.currentNode;b.Db(1);const f=new ub.GraphIterator;f.Tc(a);ae.returnToContainingTable(f);a=f.currentNode;this.jAa(f);const l=Us.a.instance.createInstance(393251);this.Eac(f,l,c,c,!1);
f.el(l);c=Hd.TableReader.Gi(a);for(let y=0;y<c;++y){const G=b.currentNode,R=this.Rsa();this.D_b(f,R,G,!1,!0);if(!R.isGhostCell)if(G.isGhostCell){let ja;(ja=G.zJa.controlCell).rowSpan=ja.rowSpan+1}else G.rowSpan=2;b.Hf(1)}this.lOb(a,Hd.TableReader.Ek(a)+1);ae.returnToContainingTable(f);this.jAa(f);return l}Uje(a){const b=ub.GraphIterator.pb(a.YRh());let c=Hd.TableReader.Gi(b.currentNode);a=eo.a(a);const f=a+1;this.jAa(b);b.Db(1);do{const y=b.hq(a,1);b.Cc();const G=this.Rsa();this.pac(b,G,y,!1,!1);
if(!G.isGhostCell)if(y.isGhostCell){var l=void 0;(l=y.zJa.controlCell).colSpan=l.colSpan+1}else y.colSpan=2}while(b.Pj(1));this.jAa(b);(l=b.currentNode.sa(Ya.a.gv,null))&&(l=Ub.a.clone(l));this.WNb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(Ya.a.gv,l));this.nnc(b.currentNode,f,!1,1,null)}Wpd(a,b){Hd.TableReader.yt(a.currentNode)&&M.a.instance.ga(63)&&this.Zph(a,c=>this.Dlj(c,b),(c,f)=>{c.Ae(sb.a.Ku,f)},sb.a.complexTable)}CFj(a,b,c,f){let l=b;const y=b.zJa;M.a.instance.ga(77)&&
(a.isGhostCell=!1);if(y)if(Zh.lXc(y,!f))a.isGhostCell=!0;else{const G=Zh.$xb(y.controlCell,f);!b.isGhostCell&&c||!c&&Zh.lXc(y,f)===G-1?(l=y.controlCell,!f&&l.xhe&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Zh.nlb(y.controlCell,f,G+1));f&&l.hbb&&(a.colSpan=l.colSpan)}return l}eEj(a,b,c){var f=a.zJa;if(f)if(a.isGhostCell)this.fFj(f,b);else if(f=Zh.$xb(a,b),1<f){const l=Zh.$xb(a,!b),y=new ub.GraphIterator;y.set(a);y.rc(14);a=new ub.GraphIterator;a.Tc(y);const G=b?ae.moveToNextRow(a):a.Hf(1);Zh.nlb(G,b,
f-1);Zh.nlb(G,!b,l);c(a,y)}}fFj(a,b){Zh.lXc(a,!b)||Zh.nlb(a.controlCell,b,Zh.$xb(a.controlCell,b)-1)}tRb(a,b){let c=!1;ae.forEachCellInTable(a,f=>Oc.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.Ae(b,c)}Zph(a,b,c,f){var l=Hd.TableReader.Ek(a.currentNode);const y=Hd.TableReader.Gi(a.currentNode);if(l&&y){var G=!1,R=!1,ja=Array(l);ae.forEachCellInTable(a,(lc,ic,yc)=>{yc||(ja[ic]=Array(y));lc=lc.currentNode;lc.isGhostCell?Oc.isSkippedCell(lc)?ja[ic][yc]=2:ja[ic][yc]=1:ja[ic][yc]=0;return!0});var za=Array(l),
Va=Array(l);for(var hb=0;hb<l;hb++){var Cb=!!hb;let lc=!0;for(let ic=0;ic<y;ic++)if(ja[hb][ic])1===ja[hb][ic]?lc=!1:hb&&2===ja[hb-1][ic]||(Cb=!1);else{lc=Cb=!1;break}za[hb]=Cb;Va[hb]=lc}for(--l;0<=l;l--)Va[l]?(a.hq(l,1),this.oQc(a),Array.removeAt(ja,l),G=!0):za[l]&&b&&(a.hq(l,1),G=a.x8b(1),hb=b(a.currentNode),Cb=b(G),c(G,hb+Cb),this.oQc(a),Array.removeAt(ja,l),G=!0);l=ja.length;if(0<l){za=Array(y);Va=Array(y);for(b=0;b<y;b++){c=!!b;hb=!0;for(Cb=0;Cb<l;Cb++)if(ja[Cb][b])1===ja[Cb][b]?hb=!1:b&&2===
ja[Cb][b-1]||(c=!1);else{hb=c=!1;break}za[b]=c;Va[b]=hb}b=a.currentNode.sa(Ya.a.gv,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=y-1;0<=l;l--)Va[l]?(b&&Array.removeAt(b,l),this.mQc(a,l),R=!0):za[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.mQc(a,l),R=!0);R&&b&&a.currentNode.setValue(Ya.a.gv,b)}(G||R)&&this.tRb(a,f)}}Dlj(a,b){let c=Dk.b(a);c||(a=a.qc(b))&&(c=Oe.a.VH(a.htmlElement.offsetHeight));return c}lOb(a,b){Hd.TableReader.Ek(a)!==b&&a.properties.setValue(Ya.a.Lza,
b)}WNb(a,b){const c=Hd.TableReader.Gi(a);c!==b&&(b&&c&&a.properties.yo(Ya.a.gv,Ya.a.v2a),a.properties.setValue(Ya.a.hha,b))}Q3(a,b,c,f=null,l=!1,y=!1){a=this.nSf(a);M.a.instance.ga(71);this.D2f(a,b,c,f,l,y);M.a.instance.ga(71);return a}nSf(a){M.a.instance.ga(63)&&Hd.TableReader.Ks(a)&&ae.getContainingTable(a);const b=Us.a.instance.createInstance(393250);a.Gl(b,2);a.el(b);return b}a6k(a,b,c,f,l){a=this.nSf(a);M.a.instance.ga(71);this.D2f(a,b,c,f,!1,l);ha.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}D2f(a,b,c,f=null,l=!1,y=!1){const G=ub.GraphIterator.pb(a);this.WRf(G,b,c,f,l);this.lOb(a,b);this.WNb(a,c);M.a.instance.ga(63);a.setValue(Ya.a.Lmb,!y)}WRf(a,b,c,f=null,l=!1){for(var y=0;y<b;++y){var G=new TQ.a;a.Gl(G,1);M.a.instance.ga(55)&&G.setValue(sb.a.zo,Xg.a.t0a())}b=null;y=!0;a.Db(1);do for(G=0;G<c;++G){const R=this.Rsa();a.Gl(R,1);({exh:b,isFirst:y}=this.C2f(a,R,l,f,b,y));ae.returnToContainingRow(a)}while(a.Pj(1))}C2f(a,b,c,f,l,y){a.el(b);l&&c?Zh.Mi.XEi(a,l):
(Zh.ey.vW(a,!0,f),!y&&c&&(l=new ub.GraphIterator,l.Tc(a)),y=!1);return{exh:l,isFirst:y}}fke(a,b,c,f){const l=new ub.GraphIterator;l.Tc(a);var y=l.currentNode;l.Db(1);let G=Dk.c(a);if(b)var R=a.YF(1);else R=a.currentNode,G++;const ja=a.Cc();M.a.instance.ga(63);this.jAa(a);let za=null,Va=null;for(var hb=0;hb<c;++hb){var Cb=Us.a.instance.createInstance(393251);Va||(Va=Cb);za=Cb;this.Eac(a,Cb,R,y,b)}y=Hd.TableReader.Gi(a.currentNode);R=!0;do{R?(a.el(za),R=!1):a.Hf(1);for(hb=0;hb<y;++hb){Cb=this.Rsa();
const lc=this.D_b(a,Cb,l.currentNode,b,!0);this.pDf(a,Cb,f(lc));l.Hf(1)}l.dla(1)}while(a.currentNode!==Va);this.lOb(ja,Hd.TableReader.Ek(ja)+c);this.TNe(ja,b,G,c)}oQc(a){const b=Dk.c(a);var c=b+1;a.Cc();M.a.instance.ga(63);this.jAa(a);for(--c;c>=b;--c){a.hq(c,1);let f=a.Db(1);for(;f;)this.RMe(f,!0),f=a.Pj(1);a.Qi()}this.lOb(a.currentNode,Hd.TableReader.Ek(a.currentNode)-1);this.kNe(a,b,1)}ymg(a,b,c,f,l){M.a.instance.ga(63);this.jAa(a);let y=Hd.TableReader.Gi(a.currentNode);-1===b&&(b=y);const G=c?
b:b-1;a.Db(1);do{const R=a.hq(G,1);a.Cc();for(let ja=0;ja<f;++ja){const za=this.Rsa(),Va=this.pac(a,za,R,c,!1);this.pDf(a,za,l(Va))}}while(a.Pj(1));this.N4k(a,y+f,f,b,c);this.nnc(a.currentNode,b,c,f,l)}N4k(a,b,c,f,l){let y=a.currentNode.sa(Ya.a.v2a,null),G=a.currentNode.sa(Ya.a.gv,null);y&&(y=Ub.a.clone(y));G&&(G=Ub.a.clone(G));this.WNb(a.currentNode,b);if(M.a.instance.ga(30)&&y){const R=Array(b);let ja=0;for(;ja<f;++ja)R[ja]=y[ja];for(;ja<f+c;++ja)R[ja]=!1;for(;ja<b;++ja)R[ja]=y[ja-c];a.currentNode.setValue(Ya.a.v2a,
R)}G&&(b=this.vCf(a,G,b,f,l,c),a.currentNode.setValue(Ya.a.gv,b))}vCf(a,b,c,f,l,y){a=Array(c);let G=l=0;for(;l<f;++l)a[l]=b[l],G+=a[l];for(;l<c;++l)a[l]=0>l-y?b[0]:b[l-y],G+=a[l];if(M.a.instance.ga(63)&&0<G)for(b=0/G,l=0;l<c;++l)a[l]=Math.max(ve.a.gf(fo.a.Twd,0),a[l]*b);return a}nnc(){}TNe(){}Eac(a,b,c){a.c0c(b,c,1,Zh.D4a?Zh.D4a():null)}pac(a,b,c,f){a.el(c);f=f?a.x8b(1):c;a.Cc();a.c0c(b,f,1,Zh.D4a?Zh.D4a():null);return c}D_b(a,b,c){a.Qyf(b,1,Zh.D4a?Zh.D4a():null);return c}pDf(a,b,c){Oc.isGhostCellNode(b)||
(a.el(b),Zh.ey.vW(a,!0,c),ae.returnToContainingRow(a))}mQc(a,b){M.a.instance.ga(63);this.jAa(a);let c=Hd.TableReader.Gi(a.currentNode);-1===b&&(b=c-1);a.Db(1);do for(let f=b+1-1;f>=b;--f)a.hq(f,1),this.RMe(a.currentNode,!1),a.Qi();while(a.Pj(1));this.M4k(a,c-1,b);this.jNe(a,b,1)}M4k(a,b,c){var f=a.currentNode.sa(Ya.a.v2a,null);let l=a.currentNode.sa(Ya.a.gv,null);f&&(f=Ub.a.clone(f));l&&(l=Ub.a.clone(l));this.WNb(a.currentNode,b);if(f){var y=Array(b);let G=0;for(;G<c;++G)y[G]=f[G];for(;G<b;++G)y[G]=
f[G+1];a.currentNode.setValue(Ya.a.v2a,y)}if(l){f=Array(b);for(y=0;y<c;++y)f[y]=l[y];for(;y<b;++y)f[y]=l[y+1];a.currentNode.setValue(Ya.a.gv,f)}}mergeCells(){}RMe(){}kNe(){}jNe(){}EVi(a){const b=eo.a(a);a.Cc();a.Cc();this.mQc(a,b)}Rsa(){const a=Us.a.instance.createInstance(393252);a.setValue(Ya.a.WE,rn.a.first);(new aG.OutlineIndentInfo(!0)).Gwh(a);return a}pK(a,b){a.setValue(Ya.a.Vl,b);a.setValue(Ya.a.CJ,b)}kMf(){}u1a(a,b,c){const f=Hd.TableReader.Gi(a);let l=a.sa(Ya.a.v2a,null);l=l?Ub.a.clone(l):
Array(f);let y=a.sa(Ya.a.gv,null);y=y?Ub.a.clone(y):Array(f);l[b]=!0;y[b]=c;a.setValue(Ya.a.gv,y);a.setValue(Ya.a.v2a,l)}static get oh(){return Zh.Jf||(Zh.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}static get Fe(){return Zh.kd||(Zh.kd=Fb.a.instance.rb("Box4.IFeatureHelper"))}static abg(a,b=!0){const c=new HI.a;if(a){let f=null;a=Vd.SelectionFactory.Ej(a,b);if(!a)ha.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(wb.a.POf(a.ga(b))){f=a.ga(b);break}f&&
(a=wb.a.Es(f),a.cache.zt&&(a=a.ge(null),Zh.oh.lK(a)),c.formatting=a.Fm,c.languageId=wb.a.language(a),M.a.instance.ga(71)&&(c.style=Ka.StyleReader.qE(f.node)))}return c}static nlb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static $xb(a,b){return b?a.rowSpan:a.colSpan}static lXc(a,b){return b?a.jvh:a.tNf}static Gkj(a,b){return b?a.R2f:a.Q2f}static RDi(a,b,c){let f=a.sa(Ya.a.gv,null);f=f?Ub.a.clone(f):Array(c);f[b]=0;a.setValue(Ya.a.gv,f)}}Zh.Jf=null;Zh.kd=null;Zh.ey=null;Zh.Mi=null;Zh.D4a=null;Object(m.a)(Zh,
"TableEditor",null,[678]);class nr{constructor(a){this.Nob=this.bQ=0;Jb.SelectionEditor.Ex(a)||(a=Jb.SelectionEditor.im(a,!0,!1));a=a.Ua;const b=new ub.GraphIterator;b.set(a.node);Jb.SelectionEditor.Pt(b);Jb.SelectionEditor.Xg(a)&&(this.bQ=a.Ra,this.Nob=a.oT);Jb.SelectionEditor.B9(a)&&b.Jg(12);this.$pf=new Bx(b)}restore(){var a=new ub.GraphIterator;this.$pf.wm(Object(H.a)(this,this.pll,"selectableFilter"),null);var b=new gz.a;const c=new gz.a;this.$pf.nuh(a,c,b);if(zb.ParagraphReader.zs(a.currentNode)){if(!c.value&&
b.value)return Vd.SelectionFactory.Ej(a.currentNode,!1);b=bb.a.Oj(a.currentNode,this.bQ);-1!==this.Nob&&(a=zb.ParagraphReader.WTa(a.currentNode,this.bQ),0<this.Nob&&this.Nob<=a&&(b.oT=this.Nob,b.xsa=this.Nob));return Vd.SelectionFactory.Qu(b)}return a.currentNode.HB?Jb.SelectionEditor.im(Vd.SelectionFactory.rl(a.currentNode),!b.value,!1):(a=Jb.SelectionEditor.xka(a,!b.value))?zb.ParagraphReader.zs(a)?Vd.SelectionFactory.Qg(a,b.value?zb.ParagraphReader.textLength(a):0):Vd.SelectionFactory.rl(a):null}pll(a){return a.currentNode.tGa||
a.currentNode.wJ}}Object(m.a)(nr,"IpReference",null,[]);class II{constructor(){this.tableNode=null;this.columns=this.rows=0;this.W5j=!1}}Object(m.a)(II,"TableActionData",null,[]);var UQ=d(186);class dt{constructor(){this.j7b=!1}}Object(m.a)(dt,"TrackChangeDeletionActionData",null,[]);class Gc{static get Wca(){return Gc.ov||(Gc.ov=Fb.a.instance.rb("Box4.IAutoCorrectScheduler"))}static get XM(){return Gc.TG||(Gc.TG=Fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get bIl(){return Gc.Xvf||
(Gc.Xvf=Fb.a.instance.rb("Box4.UI.TableAltTextDialogFactory"))}static get OVi(){return Gc.Zff||(Gc.Zff=Fb.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static mr(){return Gc.Um||(Gc.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static get Iyb(){return Gc.F4a||(Gc.F4a=a=>Zh.abg(a))}static set Iyb(a){Gc.F4a=a}static get Ide(){return Gc.FGd||(Gc.FGd=Gc.Usj)}static set Ide(a){Gc.FGd=a}static get Fde(){return Gc.CGd||(Gc.CGd=Gc.Nsj)}static set Fde(a){Gc.CGd=a}static get Gde(){return Gc.DGd||
(Gc.DGd=Gc.Psj)}static set Gde(a){Gc.DGd=a}static get Hde(){return Gc.EGd||(Gc.EGd=Gc.Rsj)}static set Hde(a){Gc.EGd=a}static get Jde(){return Gc.GGd||(Gc.GGd=Gc.Wsj)}static set Jde(a){Gc.GGd=a}static get age(){return Gc.JGd||(Gc.JGd=Gc.bCj)}static set age(a){Gc.JGd=a}static get Ude(){return Gc.HGd||(Gc.HGd=Gc.Itj)}static set Ude(a){Gc.HGd=a}static get UBb(){return Gc.lJd||(Gc.lJd=Gc.b6j)}static set UBb(a){Gc.lJd=a}static get Fe(){return Gc.kd||(Gc.kd=Fb.a.instance.rb("Box4.IFeatureHelper"))}static get oh(){return Gc.Jf||
(Gc.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}static get Xf(){return Gc.hd||(Gc.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g7(){return Gc.pp||(Gc.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get AZd(){return Gc.$Na||(Gc.$Na=Fb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get nI(){return cj.a.instance}static get ij(){return Mh.a.instance}static get Vf(){return Gc.fh||(Gc.fh=
Fb.a.instance.resolve("Box4.List.IListReader"))}static get kq(){return Gc.lp||(Gc.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}static get Xh(){return Gc.Mi||(Gc.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Cm(){return Gc.Oha||(Gc.Oha=Th.ContextSetEditor.instance)}static set Cm(a){Gc.Oha=a}static get Xc(){return cc.a.instance}static get Yq(){return Gc.$D||(Gc.$D=Fb.a.instance.resolve("Box4.ITableEditor"))}static get qu(){null==Gc.AF&&(Gc.AF=w.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!M.a.instance.ga(30));return Gc.AF}static vb(a){const b=y=>Ci.Jta(y.Pa,!1),c=(y,G,R,ja,za)=>{const Va=Sc.App.NMa.KQf(b);za[Gc.ISf]={};return Va(y,G,R,ja,za)};Gc.hRj();const f=w.AFrameworkApplication.Qa;a=a.LQf();f.ya(C.a.Q3,rb.a.view,Gc.xSi);f.ya(C.a.Q3,rb.a.Mf,Gc.Q3);f.ie(C.a.Q3,1028);f.ya(C.a.Fua,rb.a.view,Gc.s0c);f.ya(C.a.Fua,rb.a.tableRow,Gc.insertRow);f.ie(C.a.Fua,1028);f.ya(C.a.xVa,rb.a.view,Gc.s0c);f.ya(C.a.xVa,rb.a.tableRow,Gc.insertRow);f.ie(C.a.xVa,1028);f.ya(C.a.Qbb,rb.a.view,Gc.s0c);f.ya(C.a.Qbb,
rb.a.tableRow,Gc.insertRow);f.ie(C.a.Qbb,1028);f.ya(C.a.uVa,rb.a.view,Gc.tAb);f.ya(C.a.uVa,rb.a.tableCell,Gc.insertColumn);f.ie(C.a.uVa,4);f.ya(C.a.tac,rb.a.view,Gc.tAb);f.ie(C.a.tac,4);f.ya(C.a.Obb,rb.a.view,Gc.tAb);f.ya(C.a.Obb,rb.a.tableCell,Gc.insertColumn);f.ie(C.a.Obb,4);f.ya(C.a.sac,rb.a.view,Gc.tAb);f.ie(C.a.sac,4);f.ya(C.a.wVa,rb.a.view,Gc.tAb);f.ya(C.a.wVa,rb.a.tableCell,Gc.insertColumn);f.ie(C.a.wVa,1028);f.ya(C.a.LDa,rb.a.view,Gc.zUf);f.ya(C.a.LDa,rb.a.tableCell,Gc.LDa);f.ie(C.a.LDa,4);
f.ya(C.a.deleteRow,rb.a.view,Gc.zUf);f.ya(C.a.deleteRow,rb.a.tableRow,Gc.deleteRow);f.ie(C.a.deleteRow,1028);f.ya(C.a.N8,rb.a.view,Gc.PVi);f.ya(C.a.N8,rb.a.table,Gc.N8);f.ie(C.a.N8,1028);f.ya(C.a.L8a,rb.a.table,Gc.L8a);f.ya(C.a.L8a,rb.a.view,a);f.ie(C.a.L8a,4);f.ya(C.a.insertTable,rb.a.view,Gc.kUj);f.ya(C.a.insertTable,rb.a.Mf,Gc.insertTable);f.ie(C.a.insertTable,1036);f.ya(C.a.mergeCells,rb.a.view,Gc.Jzk);f.ya(C.a.mergeCells,rb.a.tableCell,Gc.mergeCells);f.ie(C.a.mergeCells,4);f.ya(C.a.splitCells,
rb.a.view,Gc.MEl);f.ya(C.a.splitCells,rb.a.tableCell,Gc.splitCells);f.ie(C.a.splitCells,4);f.ra(C.a.i0k,rb.a.view,Qr.a.P1,96);f.ra(C.a.k0k,rb.a.view,Qr.a.P1,96);f.ya(C.a.DIl,rb.a.view,Qr.a.sH);f.ya(C.a.QIl,rb.a.view,Qr.a.sH);f.ya(C.a.F0c,rb.a.view,Gc.F0c);f.ie(C.a.F0c,1124);f.ya(C.a.DRc,rb.a.view,Gc.DRc);f.ie(C.a.DRc,100);f.ya(C.a.uNb,rb.a.view,Gc.uNb);f.ya(C.a.Ysc,rb.a.view,Gc.kll);f.ya(C.a.esd,rb.a.view,Gc.esd);f.ya(C.a.r_e,rb.a.view,Gc.r_e);f.ya(C.a.Hwc,rb.a.view,a);f.ya(C.a.Hwc,rb.a.table,Gc.Hwc);
f.ie(C.a.Hwc,4);f.ya(C.a.cqc,rb.a.view,a);f.ya(C.a.cqc,rb.a.table,Gc.cqc);f.ie(C.a.cqc,96);M.a.instance.ga(30)&&(f.ya(C.a.c2a,rb.a.view,Gc.tAb),f.ya(C.a.c2a,rb.a.Mf,Gc.insertColumn),f.ie(C.a.c2a,4),f.ya(C.a.dvc,rb.a.Mf,Gc.insertRow),f.ya(C.a.dvc,rb.a.view,Gc.s0c),f.ie(C.a.dvc,4));f.ya(C.a.MLb,rb.a.view,Gc.MLb);M.a.instance.ga(63)?f.ie(C.a.MLb,96):f.ie(C.a.MLb,1124);a=[C.a.$vg,C.a.Yvg,C.a.bwg,C.a.Zvg,C.a.cwg,C.a.awg,C.a.Xvg,C.a.W4c,C.a.V4c,C.a.X4c,C.a.T4c,C.a.S4c,C.a.U4c,C.a.P4c,C.a.O4c,C.a.Q4c];for(var l of a)f.ya(l,
rb.a.view,Gc.Ika),f.ya(l,rb.a.tableCell,Gc.upi),f.ie(l,4);l=[C.a.OTe,C.a.NTe,C.a.PTe,C.a.LTe,C.a.KTe,C.a.MTe,C.a.ITe,C.a.HTe,C.a.JTe];for(const y of l)f.ya(y,rb.a.view,c),f.ya(y,rb.a.paragraph,Gc.e_k),f.ie(y,68)}static hRj(){Gc.PD.$(C.a.cwg,Gc.PD.$(C.a.W4c,Gc.PD.$(C.a.V4c,Gc.PD.$(C.a.X4c,Gc.PD.$(C.a.OTe,Gc.PD.$(C.a.NTe,Gc.PD.$(C.a.PTe,Gc.HLh)))))));Gc.PD.$(C.a.awg,Gc.PD.$(C.a.T4c,Gc.PD.$(C.a.S4c,Gc.PD.$(C.a.U4c,Gc.PD.$(C.a.LTe,Gc.PD.$(C.a.KTe,Gc.PD.$(C.a.MTe,Gc.qAk)))))));Gc.PD.$(C.a.Xvg,Gc.PD.$(C.a.P4c,
Gc.PD.$(C.a.O4c,Gc.PD.$(C.a.Q4c,Gc.PD.$(C.a.ITe,Gc.PD.$(C.a.HTe,Gc.PD.$(C.a.JTe,Gc.pti)))))));Gc.sC.$(C.a.$vg,Gc.sC.$(C.a.W4c,Gc.sC.$(C.a.T4c,Gc.sC.$(C.a.P4c,Gc.sC.$(C.a.OTe,Gc.sC.$(C.a.LTe,Gc.sC.$(C.a.ITe,1)))))));Gc.sC.$(C.a.Yvg,Gc.sC.$(C.a.V4c,Gc.sC.$(C.a.S4c,Gc.sC.$(C.a.O4c,Gc.sC.$(C.a.NTe,Gc.sC.$(C.a.KTe,Gc.sC.$(C.a.HTe,2)))))));Gc.sC.$(C.a.bwg,Gc.sC.$(C.a.X4c,Gc.sC.$(C.a.U4c,Gc.sC.$(C.a.Q4c,Gc.sC.$(C.a.PTe,Gc.sC.$(C.a.MTe,Gc.sC.$(C.a.JTe,3)))))));Gc.sC.$(C.a.Zvg,6)}static DRc(a,b,c){if(1===
c)return 32;if(!b.view.Uh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;a=a.Nb.ak;a=Gc.Cm.A3(a,14);if(!a)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),8;Gc.bIl.create(a);return 32}static uNb(a,b,c){kf.a.mark(5756);if(!b.view.Uh)return 2;const f=b.view;if(!f.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;a=f.Nb.ak;a=Gc.Cm.A3(a,14);if(!a)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),8;if(2===c){let l=null;b=a.node;c=Hd.TableReader.yt(b);const y=Gc.qu;if(!M.a.instance.ga(104)||
c&&!y)l=Vd.SelectionFactory.rl(a.node);else if(M.a.instance.ga(77))c=Vd.SelectionFactory.APc(b,y),f.Nb.nOb(c,null);else{a=ub.GraphIterator.pb(b);a.Db(1);for(b=[mr.TableNodeContext.create(a.currentNode)];a.Hf(1);)c&&Dk.h(a)||Array.add(b,mr.TableNodeContext.create(a.currentNode));l=new Wb.Selection(b,!0)}l&&(c=new xf.a(null,G=>{f.Nb.setSelection(l,G);return!1},null),c.$l("SelectTable"),c.run())}kf.a.mark(5757);return 32}static kll(a,b,c){kf.a.mark(5752);if(!b.view.Uh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Yb(Yd.a.Ah,
{["Reason"]:ce.a.eoa}),8;b=a.Nb.Pa;if(!b)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),2;b=Gc.Jde(b);if(32!==b.response)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),b.response;if(2===c){var f=b.UA;b=c=f[0].node;var l=ub.GraphIterator.pb(c);l.rc(14);let R=null;var y=ae.getContainingTable(l);y=Hd.TableReader.yt(y);var G=Gc.qu;G=M.a.instance.ga(104)&&(!y||G);const ja=[];for(let za=0;za<f.length;++za){const Va=l.currentNode===f[za].node;if(Va||y&&Dk.d(l))b=l.currentNode,!G||y&&Dk.h(l)||Array.add(ja,
mr.TableNodeContext.create(l.currentNode)),ae.moveToNextRow(l),Va||--za}f=a.Nb.Pa.nb;l=null;G?M.a.instance.ga(77)?(l=new ub.GraphIterator,G=new ub.GraphIterator,f.Cf?(l.set(c),G.set(b)):(l.set(b),G.set(c)),l.rc(14),ae.moveToFirstColumn(l),G.rc(14),ae.moveToLastColumn(G),l=y?Vd.SelectionFactory.T3b(l,G):Vd.SelectionFactory.lSf(l,G)):R=new Wb.Selection(ja,M.a.instance.ga(63)||f.Cf):R=Vd.SelectionFactory.ZRf(c,b);R&&(l=new oa.SelectionCollection([R],0));a.Nb.nOb(l,null)}kf.a.mark(5753);return 32}static esd(a,
b,c){kf.a.mark(5754);if(!b.view.Uh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;b=a.Nb.Pa;if(!b)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),2;b=Gc.Hde(b);if(32!==b.response)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),b.response;if(2===c){c=[];var f=b.UA,l=new ub.GraphIterator;l.set(f[0].node);l.rc(14);b=ae.getContainingTable(l);var y=Number.MAX_VALUE,G=0;if(f.length===Hd.TableReader.Gi(ae.getContainingTable(l)))G=null,M.a.instance.ga(104)&&(G=Vd.SelectionFactory.APc(b,
Gc.qu))?c=G.toArray():(G=Vd.SelectionFactory.rl(b),Array.add(c,G)),y=0,G=Hd.TableReader.Gi(b)-1;else{for(l=0;l<f.length;++l){var R=ub.GraphIterator.pb(f[l].node);R.rc(14);R=eo.a(R);y=Math.min(y,R);G=Math.max(G,R)}f=ub.GraphIterator.pb(b);ae.moveToFirstRow(f);ae.moveToColumnByIndex(f,y);l=new ub.GraphIterator;l.Tc(f);ae.moveToColumnByIndex(l,G);var ja;R=b.Op();R=M.a.instance.ga(104)&&(!R||Gc.qu);do(ja=R?Vd.SelectionFactory.xPc(f,l,!0,!0):Vd.SelectionFactory.ZRf(f.currentNode,l.currentNode))&&Array.add(c,
ja),ja=!ae.moveToNextRow(f),ae.moveToNextRow(l);while(!ja)}f=ub.GraphIterator.pb(b);ae.moveToCell(f,0,y);y=Hd.TableReader.Ek(b);b=ub.GraphIterator.pb(b);ae.moveToCell(b,y-1,G);c=new oa.SelectionCollection(c,c.length-1,0,f,b);a.Nb.nOb(c,null)}kf.a.mark(5751);return 32}static r_e(a,b,c){kf.a.mark(5750);if(!b.view.Uh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;b=a.Nb.ak;if(!b)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),2;var f=Gc.Cm.sB(b);b={};for(var l=0;l<
f.length;++l)if(f[l].Rk){var y=ub.GraphIterator.pb(f[l].node);y.kf();if(!Oc.isTableCellOrInside(y))return 8;ae.returnToCell(y);b[y.currentNode.id.toString()]=y}if(2===c){if(M.a.instance.ga(104)){c=a.Nb.Pa;if(c.nb.og)return kf.a.mark(5751),32;f=c.nb;y=f.Cf?f.Ua:f.jf;l=f.Cf?f.jf:f.Ua;c=new ub.GraphIterator;c.set(y.node);c.kf();y=new ub.GraphIterator;y.set(l.node);y.kf();l=null;if((l=ae.returnToLowestCommonTable(c,y))&&!l.Op()){var G=Jb.SelectionEditor.im(f,!0,!1);G=mr.TableNodeContext.create(c.currentNode,
G.Ua);G=Vd.SelectionFactory.P3b(Vd.SelectionFactory.Qu(G));a.Nb.gF(G);kf.a.mark(5751);return 32}}c=[];for(G in b)f=Vd.SelectionFactory.rl(b[G].currentNode),Array.add(c,f);0<c.length&&(G=new oa.SelectionCollection(c,c.length-1),a.Nb.nOb(G,null))}kf.a.mark(5751);return 32}static Oxj(){return w.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static upi(a,b,c,f,l){f=Gc.sni();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(Oc.isGhostCellNode(b))return 32;Gc.PD.Gb(a)&&(c=
Gc.PD.ga(a),b.Ae(sb.a.V6e,c));Gc.sC.Gb(a)&&(a=Gc.sC.ga(a),Gc.eEf(b,a));return 32}static eEf(a,b){if(!Oc.isGhostCellNode(a)&&(a=ub.GraphIterator.pb(a),Sg.OutlineNavigator.zaa(a))){do if(a.Db(2)){const c=a.currentNode;12===c.type?c.Ae(Ya.a.Vl,b):14===c.type?Hd.TableReader.i4f(c,f=>{Gc.eEf(f,b)}):ha.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",UQ.a[c.type]);a.Cc()}while(a.xp())}}static e_k(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[Gc.ISf];if(Gc.D0d in c&&!c[Gc.D0d])return 32;
f=Gc.sC.ga(a);a=Gc.PD.ga(a);if(!b||!b.node)return 2;var y=b.node;b=zb.ParagraphReader.IL(y);y=ub.GraphIterator.pb(y);y.rc(16);y.Jg(16);y=y.currentNode.sa(sb.a.V6e,Gc.HLh);c[Gc.D0d]=l[Ih.a.On]=f===b&&a===y;return 32}static PVi(a,b,c,f,l){if(!b.view.Uh)return 2;a=b.view;if(!a.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;let y=a.Nb.ak;y=Gc.Cm.A3(y,14);if(!y)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),8;if(1===c)return w.AFrameworkApplication.Qa.ii(y,C.a.N8,c,!0,f,l);kf.a.mark(7117);const G=
new nr(Jb.SelectionEditor.im(Vd.SelectionFactory.Qu(y),!0,!1)),R=new pf.GraphTransaction(15);try{R.ld(b.view.Ag);const ja=Yh.jXc(y.node,!0);ja.Tpa(y);const za=Object(sa.a)(dt,l)||new dt;let Va=w.AFrameworkApplication.Qa.ii(y,C.a.N8,c,!0,f,Gc.Xf.gg?za:l);const hb=!Gc.Xf.gg||!Gc.Xf.nz||za.j7b;32===Va&&2===c&&hb?(ja.normalize(),a.Nb.setSelection(G.restore()),t.FocusManager.instance().wf(a.$I)):ja.cancel()}finally{R&&R.dispose()}kf.a.mark(7118);return 32}static xSi(a,b,c,f,l){kf.a.mark(4943);let y=null;
2===c&&(y=new pf.GraphTransaction(15),y.ld(b.view.Ag));a=w.AFrameworkApplication.Qa.ii(b.RE,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Uh)return 2;b=b.view;c=b.Nb.ak;c=Gc.Cm.A3(c,16);f=new ub.GraphIterator;f.set(c.node);f.rc(14);ae.moveToNextOrPreviousCell(f,!1);b.Nb.setSelection(Vd.SelectionFactory.Ej(f.currentNode,!0))}y&&y.dispose();kf.a.mark(4944);return a}static tAb(a,b,c,f){if(!b.view.Uh)return 2;var l=b.view;if(!l.Nb||!l.Nb.Pa.nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;kf.a.mark(4945);
var y=l.Nb.ak;if(!y)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;var G=a===C.a.uVa||a===C.a.c2a;l=a===C.a.wVa;var R=Gc.Cm.sB(y);if(!R||0>=R.length)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;R=R[0].node;if(!R)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;G=Hd.TableReader.Jm(R)?a===C.a.sac||G:a===C.a.tac||G;const ja=Gc.Fde(y,l,G);if(32!==ja.response)return ja.response;y=ja.vn;R=Hd.TableReader.yt(y);const za=a;let Va;Va=G?Object(sa.a)(167,ja.UA[ja.UA.length-1]):Object(sa.a)(167,
ja.UA[0]);a!==C.a.c2a&&(a=l?C.a.wVa:G?C.a.uVa:C.a.Obb);G=null;2===c&&(G=new pf.GraphTransaction(15),G.ld(b.view.Ag));a=w.AFrameworkApplication.Qa.ii(Va,a,c,!0,f,ja.KJa);if(l){b={MenuItemId:"buttonFirstColumn"};b[Ih.a.On]=!0;f=w.AFrameworkApplication.Qa.ii(bb.a.create(y),2===c?C.a.iT:C.a.Laa,2,!0,f,b);if(32!==f)return f;if(1===c&&b[Ih.a.On])return 2}G&&G.dispose();2===c&&ha.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
za,C.a.uy(za)||"Unknown",M.a.instance.ga(77),R,a,y.id.toString(),Hd.TableReader.Gi(y)));kf.a.mark(4946);return a}static s0c(a,b,c,f){if(!b.view.Uh)return 2;var l=a===C.a.dvc,y=a===C.a.Qbb;const G=y||a===C.a.xVa;kf.a.mark(4947);var R=b.view;if(!R.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;const ja=R.Nb.ak;if(!ja)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;R=Gc.Ide(ja,y,G);if(32!==R.response)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),R.response;const za=Hd.TableReader.yt(R.vn);
let Va=null;2===c&&(Va=new pf.GraphTransaction(15),Va.ld(b.view.Ag));b=G?Object(sa.a)(167,R.UA[0]):Object(sa.a)(167,R.UA[R.UA.length-1]);l=w.AFrameworkApplication.Qa.ii(l?ja:b,a,c,!1,f,R.KJa);if(y){y={MenuItemId:"buttonFirstRow"};y[Ih.a.On]=!0;f=w.AFrameworkApplication.Qa.ii(bb.a.create(R.vn),2===c?C.a.iT:C.a.Laa,2,!0,f,y);if(32!==f)return f;if(1===c&&y[Ih.a.On])return 2}Va&&Va.dispose();2===c&&ha.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",
a,C.a.uy(a)||"Unknown",M.a.instance.ga(77),za,l,R.vn.id.toString(),Hd.TableReader.Ek(R.vn)));kf.a.mark(4948);return l}static d7g(a){for(ae.moveToFirstColumn(a);Oc.isGhostCell(a)&&ae.moveToPreviousRow(a););}static lBk(a){for(ae.moveToFirstRow(a);Oc.isGhostCell(a)&&ae.moveToPreviousColumn(a););}static Jzk(a,b,c,f){if(M.a.instance.ga(30)||!b.view.Uh)return 2;const l=b.view;if(!l.Nb||!l.Nb.Pa.nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;const y=Gc.woj(l.Nb.ak);if(32!==y.response)return Gc.Xc.Yb(Yd.a.Ah,
{["Reason"]:ce.a.wta}),y.response;let G=null,R=null;2===c&&(G=new nr(l.Nb.Pa.nb),G.restore(),R=new pf.GraphTransaction(15),R.ld(b.view.Ag));a=w.AFrameworkApplication.Qa.ii(bb.a.create(y.controlCell),a,c,!1,f,y);2===c&&32===a&&(b=ub.GraphIterator.pb(y.vn),b.kf()&&Gc.Yq.Wpd(b,l.Na),G&&(l.Nb.setSelection(Vd.SelectionFactory.Ej(y.controlCell,!0)),t.FocusManager.instance().wf(l.$I)));R&&R.dispose();2===c&&ha.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static woj(a){const b=
new EI;b.vn=null;b.controlCell=null;if(!a)return b.response=8,b;var c=Gc.Cm.sB(a);if(1>=c.length)return b.response=2,b;const f=new Oa.a;a={};for(let R=0;R<c.length;++R)if(c[R].Rk){const ja=ub.GraphIterator.pb(c[R].node);ja.kf();if(!Oc.isTableCellOrInside(ja))return b.response=8,b;var l=Object(sa.a)(Kf.AParagraphNode,ja.currentNode);if(l&&!l.sa(sb.a.mpe,!0))return b.response=8,b;ae.returnToCell(ja);l=ja.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var y=ae.getContainingTable(ja),
G=ae.getContainingTableRow(ja).id.toString();if(b.vn)if(b.vn!==y)if(ja.VUa(b.vn))continue;else if(ub.GraphIterator.pb(b.vn).Aba(y))a={},b.vn=y,b.controlCell=l,a[G]=l.colSpan;else return b.response=8,b;else a[G]=G in a?a[G]+l.colSpan:l.colSpan;else a={},b.vn=y,b.controlCell=l,a[G]=l.colSpan;for(y=1;y<l.rowSpan;y++)ae.moveToNextRow(ja),G=ae.getContainingTableRow(ja).id.toString(),a[G]=G in a?a[G]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=
a[c[0]];for(const R of c)if(b.colSpan!==a[R])return b.response=2,b;b.response=32;return b}static MEl(a,b,c,f,l){if(M.a.instance.ga(30)||!b.view.Uh)return 2;const y=b.view;if(!y.Nb||!y.Nb.Pa.nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;if(Jb.SelectionEditor.Ex(y.Nb.Pa.nb))var G=y.Nb.Pa.nb.Ua.node;else{G=y.Nb.ak;if(!G)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),8;G=Gc.Cm.sB(G);if(1!==G.length||!Object(Sa.a)(bb.a,G[0]))return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.UOf}),8;G=G[0].node}G=
ub.GraphIterator.pb(G);G.kf();if(!Oc.isInTableCell(G))return 2;ae.returnToContainingCell(G);G=G.currentNode;let R=null,ja=null;2===c&&(R=new nr(y.Nb.Pa.nb),R.restore(),ja=new pf.GraphTransaction(15),ja.ld(b.view.Ag));b=bb.a.create(G);a=w.AFrameworkApplication.Qa.ii(b,a,c,!1,f,l);2===c&&32===a&&R&&(y.Nb.setSelection(Vd.SelectionFactory.Ej(G,!0)),t.FocusManager.instance().wf(y.$I));ja&&ja.dispose();2===c&&ha.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));
return a}static zUf(a,b,c,f,l){if(!b.view.Uh)return 2;const y=a===C.a.deleteRow;y?kf.a.mark(4951):kf.a.mark(4949);const G=b.view;if(!G.Nb||!G.Nb.Pa.nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;var R=G.Nb.ak;const ja=Gc.Ude(R,y,G.Nb);if(32!==ja.response)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.wta}),ja.response;const za=Hd.TableReader.yt(ja.vn);var Va=null,hb=null,Cb=null;let lc=!1;var ic=!1;2===c&&(Va=new nr(G.Nb.Pa.nb),ic=Va.restore(),Cb=ub.GraphIterator.pb(ic.Ua.node),Cb.rc(14),ae.returnToContainingCell(Cb),
ic=Oc.isLastCellInRow(Cb),ae.returnToContainingRow(Cb),lc=Dk.j(Cb),hb=Yh.jXc(b.view.Ag,!0),za&&(R=Gc.OVi.s_f(R)),hb.Tpa(R),Cb=new pf.GraphTransaction(15),Cb.ld(b.view.Ag));b=Object(sa.a)(dt,l)||new dt;f=w.AFrameworkApplication.Qa.ii(nb.a.jSa(ja.UA),a,c,!1,f,Gc.Xf.gg&&y?b:l);R=!Gc.Xf.gg||!Gc.Xf.nz||!y||b.j7b;b=l=!1;if(2===c&&32===f&&R){let yc=ub.GraphIterator.pb(ja.vn);yc.kf()&&Gc.Yq.Wpd(yc,G.Na)}2===c&&32===f&&M.a.instance.ga(30)&&Hd.TableReader.nre(ja.vn)&&R&&ub.GraphIterator.pb(ja.vn).kf()&&(Va=
y?new nr(Vd.SelectionFactory.Ej(ja.vn,!lc)):new nr(Vd.SelectionFactory.Ej(ja.vn,!ic)),G.Nb.setSelection(Jb.SelectionEditor.im(Vd.SelectionFactory.rl(ja.vn),!1,!1)),w.AFrameworkApplication.Qa.processAction(C.a.L8a,2),b=l=!0);if(32===f&&2===c&&R){if(!l&&0>=Hd.TableReader.Gi(ja.vn)||0>=Hd.TableReader.Ek(ja.vn))l=!0;hb.normalize();if(Va){Va=Va.restore();if(l)Va=b&&!y?Vd.SelectionFactory.Ej(Va.Ua.node,!ic):Vd.SelectionFactory.Ej(Va.Ua.node,!0);else if(hb=ub.GraphIterator.pb(Va.Ua.node),hb.rc(14),y)ae.returnToContainingRow(hb),
lc&&!M.a.instance.ga(77)?(hb.kf(),rc.OutlineElementNavigator.Se(hb),Gc.Xh.rea(hb,!1,!0)):Gc.d7g(hb),Va=Vd.SelectionFactory.Ej(hb.currentNode,!0);else if(ae.returnToCell(hb),ic&&M.a.instance.ga(30))ae.moveToLastRow(hb),Va=Vd.SelectionFactory.Ej(hb.currentNode,!1);else if(M.a.instance.ga(63)||M.a.instance.ga(77))Gc.lBk(hb),Va=Vd.SelectionFactory.Ej(hb.currentNode,!0);G.Nb.setSelection(Va);t.FocusManager.instance().wf(G.$I)}}else hb&&hb.cancel();Cb&&Cb.dispose();2===c&&ha.ULS.sendTraceTag(9011549,324,
50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,C.a.uy(a)||"Unknown",M.a.instance.ga(77),za,f,ja.vn.id.toString()));y?kf.a.mark(4952):kf.a.mark(4950);return f}static bCj(a,b){ae.moveToFirstRow(a);const c=Object(sa.a)(Fx.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)ae.moveToNextColumn(a);else ae.moveToPreviousColumn(a)}static Usj(a){return Gc.p7b(a,!1,!0)}static Nsj(a){return Gc.p7b(a,!0,!0)}static Psj(a,b){let c=eo.a(a);
b&&(c+=a.currentNode.colSpan-1);return c}static Rsj(a){a=ze.a.kub(a);return Gc.p7b(a,!0,M.a.instance.ga(104)&&Gc.qu)}static Wsj(a){a=ze.a.kub(a);return Gc.p7b(a,!1,M.a.instance.ga(104)&&Gc.qu)}static Itj(a,b){return Gc.p7b(a,!b,!0)}static p7b(a,b,c){const f=new gs;f.vn=null;if(!a)return f.response=8,f;var l={};let y=[],G=!1;a=Gc.Cm.sB(a);1===a.length&&(G=!0);for(let Va=0;Va<a.length;++Va)if(a[Va].Rk){const hb=[];let Cb=ub.GraphIterator.pb(a[Va].node);Cb.kf();if(!Oc.isTableCellOrInside(Cb))return f.response=
8,f;if(b)ae.returnToCell(Cb),c&&1<Oc.getColSpan(Cb.currentNode)?Oc.foreachMergedCells(Cb.currentNode,lc=>{lc=ub.GraphIterator.pb(lc);lc.kf();ae.moveToFirstRow(lc);Array.add(hb,lc)},2):Array.add(hb,Cb),ae.moveToFirstRow(Cb);else{Oc.isTableCell(Cb)||ae.returnToCell(Cb);var R=Cb.currentNode.rowSpan;ae.returnToContainingRow(Cb);if(1<R)for(var ja=1;ja<R;ja++){var za=ub.GraphIterator.pb(Cb.currentNode);za.kf();Array.add(hb,za);ae.moveToNextRow(Cb)}Array.add(hb,Cb)}for(R=0;R<hb.length;++R)if(Cb=hb[R],ja=
ae.getContainingTable(Cb),za=Cb.currentNode.id.toString(),!l[za])if(l[za]=!0,f.vn)if(f.vn!==ja)if(Cb.VUa(f.vn))Gc.Z4f(Cb,f.vn,b),za=Cb.currentNode.id.toString(),l[za]||(l[za]=!0,Array.add(y,Cb));else if(l[za]=!1,ub.GraphIterator.pb(f.vn).Aba(ja)){const lc=[];for(let ic=0;ic<y.length;ic++){const yc=y[ic];Gc.Z4f(yc,ja,b);za=yc.currentNode.id.toString();l[za]||(l[za]=!0,Array.add(lc,yc))}za=Cb.currentNode.id.toString();l[za]||(l[za]=!0,Array.add(lc,Cb));f.vn=ja;Array.clear(y);y=lc}else return f.response=
8,f;else Array.add(y,Cb);else f.vn=ja,Array.add(y,Cb);Array.clear(hb)}if(!y.length)return f.response=8,f;f.Z1a=y[0].currentNode;b=[];for(l=0;l<y.length;l++){a=y[l];if(!c&&Hd.TableReader.kBb(a))return f.response=8,f;Array.add(b,bb.a.create(a.currentNode))}f.KJa=G?1:b.length;f.UA=b;f.response=32;return f}static Z4f(a,b,c){do c?ae.returnToContainingCell(a):ae.returnToContainingRow(a);while(ae.getContainingTable(a)!==b);c&&ae.moveToFirstRow(a)}static F0c(a,b,c,f,l){return 1===c?(a=b.RE)&&Jb.SelectionEditor.Xg(a)?
w.AFrameworkApplication.Qa.ii(a,C.a.insertTable,c,!0,f,l):2:32}static kUj(a,b,c,f,l){f.PC=0;f.XN=0;let y=-1,G=null,R=null,ja=null;if(!b.view.Uh)return 2;const za=b.view;if(!za.Nb)return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;kf.a.mark(4941);if(2===c){const Va=za.Nb.ak;Va.Rk&&(ja=new pf.GraphTransaction(15),R=$F.a.instance.uzj(Va.node),ja.Xy(R),G=new ub.GraphIterator,G.Tc(R),G.Cc(),y=G.TTa(R.currentNode))}a=w.AFrameworkApplication.Qa.ii(b.RE,a,c,!0,f,l);32===a&&2===c&&(R.isValid?(rc.OutlineElementNavigator.cK(R,
!1,!1),rc.OutlineElementNavigator.yi(R),c=Vd.SelectionFactory.Ej(R.currentNode,!0)):(G.$fe(y),rc.OutlineElementNavigator.yi(G),c=Vd.SelectionFactory.Ej(G.currentNode,!0)),za.Nb.setSelection(c),t.FocusManager.instance().wf(za.$I));ja&&ja.dispose();kf.a.mark(4942);return a}static MLb(a,b){if(!b.view.Uh)return 8;a=b.view;if(!a.Nb)return 8;a=Gc.Cm.sB(a.Nb.ak);if(0>=a.length)return 8;b=new ub.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.kf(),!Hd.TableReader.Ks(b))return 8;return 32}static Q3(a,
b,c){var f=b.contextId===rb.a.Mf;let l=null,y=null;if(f){l=b;if(jb.HyperlinkReader.Jla(l,!0))return Gc.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.QOf}),8;y=new ub.GraphIterator;y.set(l.node);Jb.SelectionEditor.Pt(y);Je.b(y)&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.M0d}),f=!1);!l.Ra&&y.yqg&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.tng}),f=!1)}if(1===c||!f)return f?32:8;kf.a.mark(4929);b=new pf.GraphTransaction(7);b.Xy(y);rc.OutlineElementNavigator.Se(y);c=y.currentNode;Gc.Xh.rea(y,!1,!1);f=Gc.Yq.Q3(y,1,2);const G=new ub.GraphIterator;
G.set(c);G.kf();ae.moveToCellContent(y,0,1);Gc.Xh.zPb(G,y,l,!0,!0);ae.returnToContainingTable(y);ae.moveToCellContent(y,0,0);y.Qi();Qm.i(G,y,null,G.role);Gc.kq.$Qa(G,null);ae.returnToContainingTable(y);rc.OutlineElementNavigator.Se(y);G.Db(1)&&Qm.h(y,null,1,1,G,-1);Gc.Wca&&Gc.Wca.gxc(c,B.a.$q);b.dispose();ha.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,C.a.uy(a)||"Unknown",M.a.instance.ga(77),f.id.toString()));kf.a.mark(4930);return 32}static insertColumn(a,
b,c,f,l){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?ha.ULS.sendTraceTag(509092047,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):ha.ULS.sendTraceTag(509092046,324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var y=Jb.SelectionEditor.Xg(b)&&a===C.a.c2a||b.contextId===rb.a.tableCell;f=null;if(y&&(f=new ub.GraphIterator,f.set(b.node),f.rc(14),Oc.isTableCellOrInside(f)||(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.d3b}),
y=!1),y&&!Gc.UBb(f,a)&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.c3b}),y=!1),y)){ae.returnToContainingCell(f);var G=M.a.instance.ga(63)?63:255;if(Hd.TableReader.Gi(ae.getContainingTable(f))>=G)return Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.B5g}),8}if(1===c||!y)return y?32:8;kf.a.mark(4931);c=a!==C.a.Obb&&a!==C.a.wVa;G=a===C.a.wVa;y=new pf.GraphTransaction(15);y.Xy(f);b.node.nH().graphTransactionOperations.uja(2);const R=new ub.GraphIterator;R.set(f.currentNode);R.rc(15);ae.returnToContainingTable(f);let ja=Gc.Gde(R,
G,c);c&&ja++;Gc.Yq.ymg(f,ja,!c,!G&&l?l:1,Gc.Iyb);f.set(b.node);f.rc(16);a===C.a.c2a?(ae.moveToNextColumn(R),Sg.OutlineNavigator.zaa(R),rc.OutlineElementNavigator.Se(f),Gc.Xh.Erc(R),Gc.Xh.zPb(f,R,b,!0,!0),Gc.Wca&&Gc.Wca.gxc(f.currentNode,B.a.$q)):(a=Sc.App.Mb.Ld,b=ub.GraphIterator.pb(b.node),b.kf(),Gc.age(b,c),a.Rn.Nb.setSelection(Vd.SelectionFactory.Ej(b.currentNode,!0)));y.dispose();kf.a.mark(4932);return 32}static b6j(a){return!(M.a.instance.ga(14)&&Hd.TableReader.h1j(a))&&!(M.a.instance.ga(30)&&
Hd.TableReader.kBb(a))}static insertRow(a,b,c,f,l){const y=a===C.a.dvc,G=(f=a===C.a.Qbb)||a===C.a.xVa;var R=b.node;const ja=new ub.GraphIterator;ja.set(R);ja.kf();let za=!0;Dk.m(R)||Hd.TableReader.Ks(ja)||(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.A5d}),za=!1);za&&!Gc.UBb(ja,a)&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.c3b}),za=!1);if(1===c||!za)return za?32:8;kf.a.mark(4933);a=new pf.GraphTransaction(15);a.Xy(ja);b.node.nH().graphTransactionOperations.uja(2);y?(l=new ub.GraphIterator,l.Tc(ja),rc.OutlineElementNavigator.Se(l),
ae.returnToContainingRow(ja),Gc.Yq.fke(ja,G,1,Gc.Iyb),ae.moveToFirstColumn(ja),Sg.OutlineNavigator.zaa(ja),Gc.Xh.zPb(l,ja,b,!1,!0),ae.returnToContainingRow(ja),Gc.Wca&&Gc.Wca.gxc(l.currentNode,B.a.$q)):Gc.Yq.fke(ja,G,!f&&l?l:1,Gc.Iyb);b=Sc.App.Mb.Ld;R=ub.GraphIterator.pb(R);R.rc(14);Dk.l(R)||ae.returnToContainingRow(R);f?ae.moveToFirstRow(R):G?ae.moveToPreviousRow(R):ae.moveToNextRow(R);Gc.d7g(R);b.Rn.Nb.setSelection(Vd.SelectionFactory.Ej(R.currentNode,!0));a.dispose();kf.a.mark(4934);return 32}static Ika(a,
b,c,f,l){b=qi.v6(a,b,c,f,l,{},16);2===c&&Gc.Dpa(a)&&ha.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,C.a.uy(a)||"Unknown",b));return b}static Dpa(a){return a===C.a.W4c||a===C.a.V4c||a===C.a.X4c||a===C.a.T4c||a===C.a.S4c||a===C.a.U4c||a===C.a.P4c||a===C.a.O4c||a===C.a.Q4c}static LDa(a,b,c){const f=new ub.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.kf()||(Gc.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.cTc}),l=!1),Oc.isTableCellNode(b.node)||(Gc.Xc.Yb(Yd.a.fp,
{["Reason"]:ce.a.d3b}),l=!1));l&&!Gc.UBb(f,a)&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.c3b}),l=!1);if(l&&!Gc.nI.tWd()){a=new ub.GraphIterator;a.Tc(f);do if(!Gc.nI.G1b(a.currentNode)){Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.qOc});l=!1;break}while(ae.moveToNextRow(a))}if(l&&(a=new ub.GraphIterator,a.Tc(f),1!==c&&M.a.instance.ga(50)&&Sc.App.Oh.Ew)){do for(b=He.a.gA(a.currentNode);b.moveNext();){const y=b.currentNode;zb.ParagraphReader.fe(y)&&Sc.App.Oh.vZ.Sra(y)}while(ae.moveToNextRow(a))}if(1===c)return l?32:8;
if(l){kf.a.mark(4935);c=new pf.GraphTransaction(7);try{c.Xy(f),Gc.Yq.EVi(f)}finally{c&&c.dispose()}kf.a.mark(4936);return 32}return 2}static mergeCells(a,b,c,f,l){a=new ub.GraphIterator;if(f=b.isValid){a.set(b.node);a.kf()||(Gc.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.cTc}),f=!1);Oc.isTableCellNode(b.node)||(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.d3b}),f=!1);if(f&&!Gc.nI.tWd()){b=new ub.GraphIterator;b.Tc(a);var y=new ub.GraphIterator;y.Tc(a);for(var G=0;G<l.rowSpan;G++){for(var R=0;R<l.colSpan;R++){if(!Gc.nI.G1b(b.currentNode)){Gc.Xc.Yb(Yd.a.fp,
{["Reason"]:ce.a.qOc});f=!1;break}b.Hf(1)}if(!f)break;ae.moveToNextRow(y);b.Tc(y)}}if(f&&1!==c&&M.a.instance.ga(50)&&Sc.App.Oh.Ew)for(b=new ub.GraphIterator,b.Tc(a),y=new ub.GraphIterator,y.Tc(a),G=0;G<l.rowSpan;G++){for(R=0;R<l.colSpan;R++)Sc.App.Oh.vZ.Sra(b.currentNode),b.Hf(1);if(!f)break;ae.moveToNextRow(y);b.Tc(y)}}if(1===c)return f?32:8;if(f){c=new pf.GraphTransaction(7);try{c.Xy(a),Gc.Yq.mergeCells(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static splitCells(a,b,c){a=
new ub.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.kf()||(Gc.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.cTc}),f=!1),Oc.isTableCellNode(b.node)||(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.d3b}),f=!1),f&&1!==c&&M.a.instance.ga(50)&&Sc.App.Oh.Ew&&(b=new ub.GraphIterator,b.Tc(a),Sc.App.Oh.vZ.Sra(b.currentNode)));if(1===c)return f?32:8;if(f){c=new pf.GraphTransaction(7);try{c.Xy(a)}finally{c&&c.dispose()}return 32}return 2}static N8(a,b,c,f,l){b=b.node;f=!0;Hd.TableReader.Zcb(b)||(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.pOc}),
f=!1);Gc.nI.G1b(b)||(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.qOc}),f=!1);f&&(M.a.instance.ga(14)||M.a.instance.ga(63))&&Gc.ij.Kre(b)&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),f=!1);if(1===c)return f?32:8;if(f){if(M.a.instance.ga(50)&&Sc.App.Oh.Ew)for(c=He.a.gA(b);c.moveNext();)f=c.currentNode,12===f.type&&Sc.App.Oh.vZ.Sra(f);l=Object(sa.a)(dt,l);c=new pf.GraphTransaction(7);c.ld(b);f=new ub.GraphIterator;f.set(b);f.kf();f.Cc();Gc.Xh.SDa(f);c.dispose();l&&(l.j7b=!0);ha.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",
a,C.a.uy(a)||"Unknown",M.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!Gc.nI.G1b(b))return 8;f=new ub.GraphIterator;f.set(b);f.kf();let y=Dk.m(b);y||Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.XOf});y&&!Gc.UBb(f,a)&&(Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.c3b}),y=!1);if(1===c)return y?32:8;if(y){if(M.a.instance.ga(50)&&!Sc.App.Oh.amIAlone)for(a=He.a.gA(b);a.moveNext();)c=a.currentNode,12===c.type&&Sc.App.Oh.vZ.Sra(c);kf.a.mark(4937);l=Object(sa.a)(dt,l);a=new pf.GraphTransaction(7);
a.ld(b);Gc.Yq.oQc(f);a.dispose();l&&(l.j7b=!0);kf.a.mark(4938);return 32}return 2}static L8a(a,b,c){let f=!1;a=null;b.Rk&&(a=new ub.GraphIterator,a.set(b.node),(f=Hd.TableReader.jq(a)&&Hd.TableReader.nre(a.currentNode))?a.kf():Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.WOf}));return 1===c?f?32:8:f?(kf.a.mark(4939),b=new ub.GraphIterator,b.Tc(a),ae.moveToCell(b,0,0),rc.OutlineElementNavigator.Se(a),c=new pf.GraphTransaction(7),c.Xy(b),Gc.Xh.Bsh(a,b),c.dispose(),kf.a.mark(4940),32):2}static insertTable(a,b,
c,f,l){if(!b.Rk||!Jb.SelectionEditor.Xg(b))return 2;if(M.a.instance.ga(14)&&Gc.ij.Vua(b))return Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),2;if(Gc.mr()&&Gc.mr().instance&&Gc.mr().instance.qX(b))return 2;var y=new ub.GraphIterator;y.set(b.node);Jb.SelectionEditor.Pt(y);if(Je.b(y))return Gc.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.M0d}),2;if(1===c)return 32;c=1;y=2;l&&(c=l.rows,y=l.columns);f.PC=y;f.XN=c;if(Jb.SelectionEditor.Xg(b)){f=new pf.GraphTransaction(7);kf.a.mark(4927);f.ld(b.node);b.node.nH().graphTransactionOperations.uja(2);
const R=new HI.a;M.a.instance.ga(50)&&Sc.App.Oh.Ew&&Sc.App.Oh.vZ.Sra(b.node);var G=wb.a.Es(b);M.a.instance.ga(49)&&(G.cache.zt&&(G=G.ge(null),Gc.oh.lK(G)),R.formatting=G.Fm);R.languageId=wb.a.language(G);M.a.instance.ga(71)&&(R.style=Ka.StyleReader.qE(b.node),Gc.Vf.e5b(R.style)&&(G=Ka.StyleReader.OL(b.node)))&&(R.style=G.oH(Ka.StyleReader.wNa));M.a.instance.ga(54)?(G=ub.GraphIterator.pb(b.node),G.rc(11),Gc.XM.k9(G.currentNode)):new xv.a(1,-1);b=Gc.Xh.TTj(b);G=l&&l.W5j?Gc.Yq.Q3(b,c,y,R):Gc.Yq.Q3(b,
c,y,R,!0);l&&(l.tableNode=G);rc.OutlineElementNavigator.Se(b);M.a.instance.ga(56)&&R.style&&!he.OutlineElementReader.Wqe(b.currentNode)&&R.style.sa(Ya.a.PY,!1)&&Gc.Xh.VLa(b.currentNode,!0);Gc.kq.$Qa(b,null,!0,!1,-1);he.OutlineElementReader.Hcb(b)&&Gc.Xh.rea(b,!1,!0,R);f.dispose();ha.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,C.a.uy(a)||"Unknown",M.a.instance.ga(77),G.id.toString(),c,y));kf.a.mark(4928);
w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static Hwc(a,b,c){if(1===c)return 32;kf.a.mark(5748);a=b.node;b=new pf.GraphTransaction(15);b.ld(a);a.setValue(Ya.a.Lmb,!a.sa(Ya.a.Lmb,!0));b.dispose();kf.a.mark(5749);return 32}static cqc(a,b,c,f,l){l.setValue(Ya.a.Lmb,!b.node.sa(Ya.a.Lmb,!0));return 32}}Gc.HLh="top";Gc.qAk="center";Gc.pti="bottom";Gc.ISf="__cumulative__";Gc.D0d="__consistent__";Gc.sC=new rj.a;Gc.PD=
new rj.a;Gc.Mi=null;Gc.ov=null;Gc.TG=null;Gc.Xvf=null;Gc.Zff=null;Gc.AF=null;Gc.Um=null;Gc.F4a=null;Gc.sni=Gc.Oxj;Gc.FGd=null;Gc.CGd=null;Gc.DGd=null;Gc.EGd=null;Gc.GGd=null;Gc.JGd=null;Gc.HGd=null;Gc.lJd=null;Gc.kd=null;Gc.Jf=null;Gc.hd=null;Gc.pp=null;Gc.$Na=null;Gc.fh=null;Gc.lp=null;Gc.Oha=null;Gc.$D=null;Object(m.a)(Gc,"TableActor",null,[]);var JI=d(312),VQ=d(841),KI=d(901),WQ=d(412),XQ=d(827);class LI{constructor(a,b,c,f){this.tQc=this.rQc=null;this.bvc=a;this.Ywd=b;this.KGh=c;this.MGh=f}}Object(m.a)(LI,
"TableSimplificationInformation",null,[]);var Iv=d(427),YQ=d(459),ou=d(257),Iq=d(220);class fi{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){this.fh=this.F4a=this.GN=this.Ip=null;this.LLd=!1;this.Z5h=y;this.TG=G;this.Zpb=a;this.$D=b;this.ey=c;this.Mi=f;this.lp=l;this.Ma=R;this.Mk=za;this.jSd=ja.create(2097162);this.gWe(this.jSd);this.$gf=ja.create(2097162);this.gWe(this.$gf);this.yxf=ja.create(2097162);this.gWe(this.yxf);this.O2=this.jSd;this.QQd=Va;this.aE=hb;this.hd=Cb;this.WYb=lc;this.z9h=
lc.substr(0,3);this.Lqa=ic}get Vf(){return this.fh||(this.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}get hs(){return this.Ip?this.Ip.hs:0}get R8a(){return this.Ip.nb.R8a}get rka(){return this.Ip.nb.rka}get Y7e(){return this.O2}get L0d(){return this.Ip.yH&&!this.LLd}sBh(){this.LLd=!0}get $eh(){return!this.Ip.yH}get Gba(){return le.a.instance}get j4j(){return this.Ma.ka("InternalPasteTableWithReplacingCellIsEnabled")&&M.a.instance.ga(63)||M.a.instance.ga(77)}gWe(a){var b=new YQ.a(-1);this.Z5h.AV.Rsb(b);
const c=new ub.GraphIterator;c.set(b);b=this.Mk.ke(3);b.Xy(c);c.Gl(a,80);b.dispose()}s1d(a,b=null){a=a.Nb;this.Ip=a.Pa.clone();this.LLd=!1;a=ub.GraphIterator.pb(a.Ymb);const c=ub.GraphIterator.pb(this.O2),f=this.Mk.ke(3);f.Xy(c);a.Db(82);do a.currentNode.m3a(null);while(a.Pj(82));a=new xf.a(b,Object(H.a)(this,this.fEi,"clearInternalClipboard"),new BI(a,c,this.Ip,f));a.$l("InternalCopy");a.Zi=!b||b.Zi;a.run()}fEi(a,b){kf.a.mark(5566);b=b.target;if(b.Ri())return b.Qi(),!0;a.gh(Object(H.a)(this,this.CSc,
"executeCopy"));return!0}CSc(a,b){b=new kz(b,null);b=new xf.a(a,Object(H.a)(this,this.r3b,"coreCopySetup"),b);b.$l("ExecuteCoreCopyToInternalClipboard");b.run();a.gh(Object(H.a)(this,this.KNl,"trimNewText"));return!0}r3b(a,b){if(!b.source.Ri())return b.ag&&(b.ag.cNc=null),ha.ULS.shipAssertTag(6305560,307,!1),!1;a.gh(Object(H.a)(this,this.YPf,"coreCopyIteration"));return!0}YPf(a,b){const c=b.insertAfter,f=b.source,l=b.target,y=f.currentNode;var G=this.$eh;if(!y.uqe)return a.gh(Object(H.a)(this,this.IOc,
"coreCopyIncrement")),!0;b.ag.Lud&&(b.Lud=!0);if(!b.Lud&&(y.d6b()&&b.n7.xla.c++,y.d6b()||G&&!y.HBb(this.hs)))return a.gh(Object(H.a)(this,this.IOc,"coreCopyIncrement")),!0;if(!b.Lud&&G&&!y.Vy)return f.qFa()&&(b.bAd=!0,b=new xf.a(a,Object(H.a)(this,this.r3b,"coreCopySetup"),new kz(b,c)),b.$l("RecursiveCoreCopyToInternalClipboard"),b.run()),a.gh(Object(H.a)(this,this.IOc,"coreCopyIncrement")),!0;G=l.currentNode.Xo().Fi;G=Qm.a(y,G,!0);this.Gba.irc(b.n7.Yab,G);l.SL(G,c,18===f.parentNode.type?1:f.role);
l.el(G);b.insertAfter=G;zb.ParagraphReader.fe(G)&&(this.rYk(a,Object(H.a)(this,this.r3b,"coreCopySetup"),y,G,b),this.qYk(y,G));this.RZf(y,G);f.qFa()&&(ha.ULS.shipAssertTag(6305562,307,!b.bAd),b=new xf.a(a,Object(H.a)(this,this.r3b,"coreCopySetup"),new kz(b,null)),b.$l("RecursiveCoreCopyToInternalClipboard"),b.run());a.gh(Object(H.a)(this,this.YLi,"coreCopyIterationPostProcessing"));return!0}YLi(a,b){var c=b.source;const f=b.target;var l=f.currentNode,y=c.currentNode;zb.ParagraphReader.vl(f)&&(b.NPe[y.id.toString()]=
l);if(M.a.instance.ga(54)&&zb.ParagraphReader.fe(l)){if(0<zb.ParagraphReader.Ydg(y))if(0<this.TG.gab(y).qN)y.setValue(sb.a.uoc,0);else{var G=this.TG.syb(y).qN;fi.paragraphEditor.Jv.slb(l,G)}if(!this.ecb&&this.Lqa.hmd){c.Cc();if(!Hd.TableReader.Ks(f)&&c.oBb&&!this.rka)for(var R of this.Lqa.UPk)l.removeProperty(R);c.el(y)}}if(M.a.instance.ga(57)&&zb.ParagraphReader.fe(l)){G=[];R=[];for(let ja=0;ja<l.wordRunProperties.length;ja++)l.wordRunProperties.aZ.$(ja,JI.CharacterPropertiesEditor.aga),l.wordRunProperties.oga.$(ja,
JI.CharacterPropertiesEditor.$fa),G[ja]=!0,R[ja]=!1;l.Ae(sb.a.pid,G);ha.ULS.shipAssertTag(6305563,307,G.length===l.wordRunProperties.length);ha.ULS.shipAssertTag(6305564,307,M.a.instance.ga(50));ha.ULS.shipAssertTag(6305565,307,!!Sc.App.Oh);M.a.instance.ga(50)&&Sc.App.Oh.Ew&&(l.Ae(ct.a.Vw,R),ha.ULS.shipAssertTag(6305566,307,R.length===l.wordRunProperties.length));(this.hd.gg&&this.hd.nz||M.a.instance.ga(45)&&Sc.App.eE.MQb)&&l.setValue(sb.a.Vbc,!0);M.a.instance.ga(14)&&l.yo(sb.a.n8d,sb.a.JPk,sb.a.LPk);
M.a.instance.ga(45)&&zb.ParagraphReader.fe(l)&&l.yo(sb.a.Ucb)}this.Yeh(f)&&(G=f.currentNode.nH(),l=ba.ImageReader.AXc(f.currentNode.properties,G.Fi,!1),G=ba.ImageReader.AXc(f.currentNode.properties,G.Fi,!0),R=null,vc.EmbeddedFileReader.X1c(f)&&(R=vc.EmbeddedFileReader.cWc(f.currentNode)),this.p8d(l,y),this.p8d(G,y),this.p8d(R,y));this.$eh&&(this.QZf(f),Hd.TableReader.jq(f)&&(y=this.Ip.OW(),y.moveNext(),(y=Oc.getCellLocation(c,y.current.node))||(y=new XQ.a(0,0)),c=new LI(y,f,Hd.TableReader.kgj(c),
Hd.TableReader.Ftj(c)),this.$D.Sfl(c)));he.OutlineElementReader.hh(f)&&!f.kJ(2)&&(this.Mi.pda(f),f.Cc());f.Cc();b.ag&&(b.ag.cNc=b.insertAfter);a.gh(Object(H.a)(this,this.IOc,"coreCopyIncrement"));return!0}IOc(a,b){b.bAd&&(b.insertAfter=b.cNc,b.bAd=!1);if(!b.source.nFa()){b.ag&&(b.ag.cNc=b.insertAfter);const c=b.source;11!==c.Bi||c.iXc(-1)||this.KYk(a,c.currentNode,b.target.currentNode,b);return!1}a.gh(Object(H.a)(this,this.YPf,"coreCopyIteration"));return!0}qYk(a,b){a=Ee.f(a);Ee.f(b);for(b=0;b<a.length;b++)Object(H.a)(this,
this.r3b,"coreCopySetup")}KNl(a,b){if(b.Ksa>=b.wNb.length)return a.gh(Object(H.a)(this,this.XLi,"copyTeardown")),!0;a=b.wNb[b.Ksa];var c=a.node,f=a.Ra,l=a.Lb;if(!Jb.SelectionEditor.ou(a))if(!b.Ksa&&Jb.SelectionEditor.nm(a))l=f=zb.ParagraphReader.textLength(c);else if(zb.ParagraphReader.Im(a))f=0,l=zb.ParagraphReader.textLength(c);else if(Jb.SelectionEditor.B9(a)){ha.ULS.shipAssertTag(6305568,307,!b.Ksa);var y=ub.GraphIterator.pb(c);f=y.rc(12);ha.ULS.shipAssertTag(6305569,307,f);c=y.origin;l=f=zb.ParagraphReader.textLength(c)}else{if(uj.OutlineReader.ccc(a))for(a=
Ex.a.gA(a.node);a.moveNext();)y=a.currentNode,zb.ParagraphReader.fe(y)&&Array.add(b.wNb,bb.a.createTextRange(y,0,zb.ParagraphReader.textLength(y)));b.Ksa++;return!0}y=b.NPe[c.id.toString()];ha.ULS.shipAssertTag(6305570,307,!!y);if(!y)return ha.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Ksa,["SelectedContextsLength"]:b.wNb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Ksa++,!0;c=Ee.f(y);let G,R=!1;for(G=c.length-1;0<=G;G--)if(!c[G].xMc)if(4===
c[G].Cq)c[G].Ke.blob=null,c[G].Ke.blob=new Iv.a(c[G].Ke,Iv.a.gQc),b.n7.xla.e++;else{c[G].Ke.blob=null;if(M.a.instance.ga(57)&&-1!==c[G].tg){var ja=c[G].Ke.formatting,za=void 0,Va=void 0;ja&&-1===ja.tg?(Va=c[G].tg+1,za=c[G].Baa-1,ja.tg=c[G].tg):(za=c[G].Baa,Va=c[G].tg);for(ja=0;ja<za;ja++)y.wordRunProperties.removeAt(Va,16);0<za&&(R=!0)}za="";ou.f(c[G])?(za=" ",b.n7.xla.f++):ou.g(c[G])&&(Va=ou.b(c[G]))&&(za=ou.a(Va),b.n7.xla.g++);Va=c[G].Ke.cp;Va>=f&&Va<l&&(fi.characterPropertiesEditor.replaceTextRange(bb.a.createTextRange(y,
Va,Va+1),za),l=l-1+za.length,b.n7.xla.i++)}R&&y.nv();this.eal(y);c=zb.ParagraphReader.textLength(y);l<c&&fi.characterPropertiesEditor.replaceTextRange(bb.a.createTextRange(y,l,c),"");0<f&&fi.characterPropertiesEditor.replaceTextRange(bb.a.createTextRange(y,0,f),"");f=0;l=ub.GraphIterator.pb(y);for(l.Db(6);!l.pr;)c=l.currentNode,l.Pj(6),ba.ImageReader.xH(c)?ba.ImageReader.Sqe(c)?(fi.paragraphEditor.tPf(c,bb.a.Oj(y,f)),f++,b.n7.xla.d++):(c=ub.GraphIterator.pb(c),c.rc(12),c.Qi(),b.n7.xla.h++):ha.ULS.shipAssertTag(6305571,
307,!1);!zb.ParagraphReader.textLength(y)&&b.Ksa===b.wNb.length-1&&Jb.SelectionEditor.ou(a)&&(a=ub.GraphIterator.pb(y),a.rc(25)&&(rc.OutlineElementNavigator.Se(a),this.Mi.SDa(a),b.Ksa&&(this.Ip.nb.rka=!0)));this.Gba.v0a(b.n7.Old,b.n7.z8a,b.n7.oRa,y);b.Ksa++;return!0}eal(a){const b=M.a.instance.ga(14),c=!this.hd.gg&&M.a.instance.ga(45),f=fi.rO,l=a.Sa;if(M.a.instance.ga(57)&&l&&(b||c)){var y=new Oa.a,G=new Oa.a;for(let ja=0;ja<l.length;ja++){const za=l.ga(ja);if(b){za.Jl&&y.add(za);if(f){if(za.ai){for(var R=
0;R<za.ai.length;R++)G.add(za.ai.ga(R).tg);za.ai=null}}else za.fieldRangeEnd&&(G.add(za.fieldRangeEnd.tg),za.fieldRangeEnd=null),za.Vo&&(G.add(za.Vo.tg),za.Vo=null);if(za.Ak){for(R=0;R<za.Ak.length;R++)G.add(za.Ak.ga(R).tg);za.Ak=null}}if(c){if(Sc.App.eE.MQb){za.formatting&&fi.oh.lK(za.formatting);if(za.hyperlink){for(R=0;R<za.hyperlink.Baa;R++)G.add(za.hyperlink.tg+R);za.hyperlink=null}za.Cn=!1}za.trackedChange=null;za.xJ=!1}}a.fLa(!0,G);for(let ja of y)ja.Jl=null;c&&1<l.length&&(a=l.first,a.trackedChange=
new VQ.a(a),l.last.xJ=!0)}}XLi(a,b){this.O2.m3a(null);b.kCj.dispose();kf.a.mark(5567);this.DCk();this.GN=b.n7;this.eyg("Copy");this.eYj&&ha.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get eYj(){return!ub.GraphIterator.pb(this.O2).Ri()}BWl(){this.O2=this.yxf}AWl(){this.O2=this.jSd}oWl(){this.O2=this.$gf}oMf(){const a=ub.GraphIterator.pb(this.O2);for(;a.Ri();)a.Qi()}eyg(a){const b=this.GN.xla.b;a+="-"+b;this.GN.xla.b=a;this.GN.Yab.b=a;this.GN.Old.b=a;this.GN.z8a.b=a;this.GN.oRa.b=
a;this.Gba.Kfk(this.GN.xla);this.Gba.Pte(this.GN.Yab);this.Gba.Eyg(this.GN.Old);this.Gba.Jte(this.GN.z8a);this.Gba.Ite(this.GN.oRa);this.GN.xla.b=b;this.GN.Yab.b=b;this.GN.Old.b=b;this.GN.z8a.b=b;this.GN.oRa.b=b}fhh(a,b,c,f,l=null,y=null){this.eyg("Paste");b=ub.GraphIterator.pb(b);const G=ub.GraphIterator.pb(this.O2);var R=null;l&&(R=new gx.a(uj.OutlineReader.fQc,uj.OutlineReader.VTf),R=l.equals(new gx.a(-1,-1))?new gx.a(0,0):l.xV(R));if(this.L0c())if(G.Ri(),ba.ImageReader.xH(G.currentNode))l=G.currentNode,
G.Cc(),G.SL(this.Mi.q2d(),null,1),G.Ri(),G.SL(l,null,2),G.Cc(),G.el(l),G.Qi(),this.Zpb.uHk(),this.sBh();else if(vc.EmbeddedFileReader.tcb(G.currentNode)){l=G.currentNode;G.Cc();G.SL(this.Mi.q2d(),null,1);G.Ri();var ja=this.Mi.pda(G);ja=bb.a.Oj(ja,0);fi.characterPropertiesEditor.replaceTextRange(ja,"<<"+vc.EmbeddedFileReader.dWc(l)+">>");G.Cc();G.Cc();G.el(l);G.Qi();this.sBh()}this.j4j&&this.Yug(G,b)?(G.currentNode.m3a(null),ha.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),
this.Zdl(y,G,b,R,a),ha.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(kf.a.mark(5564),G.currentNode.m3a(null),a={},a[fi.MOj]=f,Bb.ListReader.XVa(c)&&this.Vf.Ypc&&(a[KI.a.hng]=!0),c=new lz(G,b,c,R,a),f=new xf.a(y,Object(H.a)(this,this.t3b,"corePasteSetup"),c),f.$l("ExecuteCorePasteFromInternalClipboard"),f.Zi=!y||y.Zi,this.hYk(c),f.run())}zug(a){if(a&&a.isValid){const b=ub.GraphIterator.pb(this.O2);return this.Yug(b,a)}return!1}Yug(a,b){if(Oc.isTableCellOrInside(b)&&
1===a.R$a()){a.Db(1);if(he.OutlineElementReader.hh(a)){rc.OutlineElementNavigator.yi(a);if(Hd.TableReader.jq(a)){Hd.TableReader.yt(a.currentNode)&&ha.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.rc(14)&&!Hd.TableReader.yt(ae.getContainingTable(b)))return ha.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!0;ha.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.ecb)return!0}rc.OutlineElementNavigator.Se(a)}a.Cc()}return!1}Zdl(a,
b,c,f,l){c.rc(14);const y=Dk.c(c),G=eo.a(c);c.Jg(14);var R=Hd.TableReader.Ek(c.currentNode);const ja=Hd.TableReader.Gi(c.currentNode),za=Hd.TableReader.Ek(b.currentNode),Va=Hd.TableReader.Gi(b.currentNode);ha.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",R,ja,za,Va);this.F4a=Gc.Iyb;if(this.k8j(y+za,G+Va)){var hb=y+za-R;0<hb&&(ae.moveToLastRow(c),ha.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+hb),this.$D.fke(c,!1,hb,this.F4a),
ha.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Jg(14));hb=G+Va-ja;if(0<hb){ha.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+hb);try{this.$D.ymg(c,ja,!1,hb,this.F4a)}catch(Cb){throw ha.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Cb.toString()),Cb;}ha.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}R=this.kfj(R,ja,za,Va,y,G);ha.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new xf.a(this.ecb?a:null,Object(H.a)(this,this.XRk,
"pasteTableOperationRun"),new DI(null,b,c,f,y,G,R,null,l));a.$l("ExecuteCorePasteTableInTable");a.Zi=!1;a.run()}}k8j(a,b){if(!this.bsg)return!0;const c={};a>fi.eMc&&(c.rowCount=a,c.c_maxTableRowColCount=fi.eMc);b>fi.eMc&&(c.columnCount=b,c.c_maxTableRowColCount=fi.eMc);const f=a*b;f>fi.GIf&&(c.rowCount=a,c.columnCount=b,c.cellsCount=f,c.c_maxTableCellCount=fi.GIf);0<Iq.a(c).length&&ha.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!Iq.a(c).length}XRk(a,b){if(b.eQb){if(b.eQb.inProgress)return!0;
Oc.isTableCell(b.source)||b.source.Jg(16);this.bsg&&Oc.isFirstCellInTable(b.source)&&this.a0b(b.Nf,b.target.currentNode);if(Oc.isLastCellInTable(b.source))return this.FCk(ae.getContainingTable(b.target)),ha.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Oc.isTableCell(b.target)||b.target.Jg(16);const c=!this.ecb;Oc.isLastCellInRow(b.source)?(ae.moveToNextRow(b.target),ae.moveToColumnByIndex(b.target,b.Kja),ha.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):
ae.moveToNextOrPreviousCell(b.target,!1,c);ae.moveToNextOrPreviousCell(b.source,!1,c)}else Hd.TableReader.jq(b.target)||b.target.Jg(14),Hd.TableReader.jq(b.source)||b.source.Jg(14),ae.moveToCell(b.target,b.rowIndex,b.Kja),ae.moveToCell(b.source,0,0);for(;b.target.Ri();)b.target.Qi();b.eQb=new xf.a(a,b.khh?b.khh:Object(H.a)(this,this.t3b,"corePasteSetup"),new lz(b.source,b.target,null,b.zld));b.eQb.$l("ExecuteCorePasteCellContentInCell");b.eQb.Zi=!1;b.eQb.run();return!0}DCk(){if(this.ecb){for(var a=
ub.GraphIterator.pb(this.Y7e),b=a.currentNode;14!==a.Bi;)if(b=a.Ri(),!b){ha.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.q8g(b)}}FCk(a){this.ecb&&this.q8g(a)}fLl(a){const b=ub.GraphIterator.pb(a);this.ey.Cac(b,null,!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}q8g(a){if(a&&14===a.type){ha.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=Hd.TableReader.Ek(a),f=Hd.TableReader.Gi(a),
l=ub.GraphIterator.pb(a);ae.forEachCellInTable(l,(y,G,R)=>{const ja={};y=y.currentNode;if(16===y.type)if(y.isGhostCell)fi.uOf(G,R)in b||(this.fLl(y),ja.IsGhostCell="->false");else{M.a.instance.ga(77);fi.s6k(a,y,G,R,c,(Va,hb,Cb)=>{ja.rowSpan=String.format("{0}:{1}->{2}",Va,hb,Cb)});fi.r6k(a,y,R,G,f,(Va,hb,Cb)=>{ja.colSpan=String.format("{0}:{1}->{2}",Va,hb,Cb)});const za=String.format("{0},{1}-{2},{3}",G,R,G+y.rowSpan,R+y.colSpan);for(let Va=0;Va<y.rowSpan;Va++)for(let hb=0;hb<y.colSpan;hb++)if(Va||
hb)b[fi.uOf(G+Va,R+hb)]=za}if(0<Iq.a(ja).length){if(void 0===ja.IsGhostCell||null===ja.IsGhostCell){if(void 0===ja.rowSpan||null===ja.rowSpan)ja.rowSpan=y.rowSpan;if(void 0===ja.colSpan||null===ja.colSpan)ja.colSpan=y.colSpan}ha.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",G,R,ja)}return!0});fi.p_i(b)}}get bsg(){return M.a.instance.ga(77)}get ecb(){return!!this.Ma&&this.Ma.ka("ComplexTableCellPasteWithFormattingIsEnabled")}a0b(a,b){a?(b=ub.GraphIterator.pb(b),b.DB(1)?(b=b.Db(2))?
(b=Vd.SelectionFactory.Qg(b,0),a.Nb.setSelection(b)):ha.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):ha.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):ha.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}kfj(a,b,c,f,l,y){const G=[];for(let R=0;R<Math.max(l+c,a);R++){let ja=0,za=y+f;for(R<l?ja=b:R>=l&&R<Math.min(l+c,a)?ja=y:R>=l+c&&R<a?ja=b:za=Math.max(y+f,
b);ja<za;ja++)Array.add(G,Array(2)),G[G.length-1][0]=R,G[G.length-1][1]=ja}return G}t3b(a,b){if(!b.source.Ri())return a.gh(Object(H.a)(this,this.L_a,"pasteTeardown")),!0;a.gh(Object(H.a)(this,this.ZPf,"corePasteIteration"));return!0}jel(a,b){if(this.ecb)if(!b||!a)ha.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=
a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.Vlb!==a.Vlb&&(b.Vlb=a.Vlb,c.ShouldRenderCell=b.Vlb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);Iq.a(c)}}ZPf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.uqe||!l.Eub)return a.gh(Object(H.a)(this,
this.JOc,"corePasteIncrement")),!0;if(this.hd.gg&&he.OutlineElementReader.hh(c)){if(!rc.OutlineElementNavigator.yi(c).Eub)return rc.OutlineElementNavigator.Se(c),a.gh(Object(H.a)(this,this.JOc,"corePasteIncrement")),!0;rc.OutlineElementNavigator.Se(c)}ha.ULS.shipAssertTag(6305608,307,!l.d6b());var y=f.currentNode.Xo().Fi;y=Qm.a(l,y,!0);y.nib();this.jel(c,f);f.SL(y,b.insertAfter,c.role);f.el(y);b.insertAfter=y;M.a.instance.ga(50)&&Sc.App.Oh.Ew&&Sc.App.Oh.vZ.Sra(y);this.RZf(l,y);b=new xf.a(a,Object(H.a)(this,
this.t3b,"corePasteSetup"),new lz(c,f,null,b.zld,b.AL));b.$l("RecursiveCorePasteOperation");b.run();a.gh(Object(H.a)(this,this.bMi,"corePasteIterationPostProcessing"));return!0}QYk(a,b,c){b=Ee.f(b);c=Ee.f(c);for(let f=b.length-1;0<=f;f--)b[f].IMe(c[f],a,Object(H.a)(this,this.t3b,"corePasteSetup"))}p8d(a,b){a&&(ha.ULS.shipAssertTag(6305610,307,a.Ta(Xp.a.goc)),a.Ta(Xp.a.goc)||a.setValue(Xp.a.goc,a.sa(Xp.a.c9g,"")),b=(b=WQ.SectionNavigator.Acg(b))?b.fileId:Sc.App.Mb.Ld.j8?Sc.App.Mb.Ld.j8.fileId:null,
!a.Ta(Xp.a.fileId)&&b&&a.setValue(Xp.a.fileId,b))}q8d(a){a&&this.Zpb.drl()}bMi(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;zb.ParagraphReader.fe(f)&&(this.RYk(a,Object(H.a)(this,this.t3b,"corePasteSetup"),l,f,b),this.QYk(a,l,f));f.P9g();b.AL[KI.a.hng]&&22===f.type&&f.setValue(sb.a.listID,Number.MAX_VALUE);if(M.a.instance.ga(11)&&zb.ParagraphReader.fe(f)){var y=Ee.j(f,5);if(0<y.length){for(var G of y)!G.properties.Ta(sb.a.iih)&&G.properties.Ta(sb.a.gih)&&G.properties.setValue(sb.a.iih,
G.properties.eb(sb.a.gih)),ba.ImageReader.Pqe(G.properties)||this.Zpb.Vjl();f.Xo().contentReplicator.forceOutbound(null,null,null)}}M.a.instance.ga(25)&&he.OutlineElementReader.hh(c)&&this.Mi.H$e(c.currentNode);M.a.instance.ga(10)&&uj.OutlineReader.b3c(f)&&(y=Dq.b(f),b=b.zld,Dq.c(f,y.x+b.x,y.y+b.y));if(this.Yeh(c)){b=c.currentNode.nH();y=ba.ImageReader.AXc(c.currentNode.properties,b.Fi,!1);G=ba.ImageReader.AXc(c.currentNode.properties,b.Fi,!0);let R=null;vc.EmbeddedFileReader.X1c(c)&&(R=vc.EmbeddedFileReader.cWc(c.currentNode));
this.q8d(y);this.q8d(G);this.q8d(R);if(y||G||R)b.u3j=!0,b.v3j=!0}M.a.instance.ga(24)&&vc.EmbeddedFileReader.X1c(c)&&(b=c.currentNode,vc.EmbeddedFileReader.J_j(c)?(c.Cc(),y=this.ey.gQi(),y.setValue(Ya.a.CJ,fi.Vk.isRtl(b)?11:9),G=Dq.b(f),Dq.c(y,G.x,G.y),c.SL(y,b,1),c.el(b),c.YVf(),this.ey.vW(c,!1)):c.Qi(),y=this.Mi.pda(c),y=bb.a.Oj(y,0),fi.characterPropertiesEditor.replaceTextRange(y,"<<"+vc.EmbeddedFileReader.dWc(b)+">>"));this.QZf(c);this.BVl(l,f);c.Cc();a.gh(Object(H.a)(this,this.JOc,"corePasteIncrement"));
return!0}Yeh(a){return M.a.instance.ga(1)&&ba.ImageReader.Hbc(a)||M.a.instance.ga(24)&&vc.EmbeddedFileReader.X1c(a)}BVl(a,b){if(this.hd.gg&&Hd.TableReader.Zcb(a)){let c=0;const f=Hd.TableReader.Ek(a);for(let l of Hd.TableReader.OXc(a,0,f-1))l.Uwc&&c++;a=this.Mk.ke(4);a.ld(b);b.properties.setValue(Ya.a.Lza,f-c);a.dispose()}}JOc(a,b){if(!b.source.nFa())return a.gh(Object(H.a)(this,this.L_a,"pasteTeardown")),!0;a.gh(Object(H.a)(this,this.ZPf,"corePasteIteration"));return!0}L_a(){kf.a.mark(5565);return!1}Fid(){return!ub.GraphIterator.pb(this.O2).Ri()}L0c(){return this.L0d?
1===ub.GraphIterator.pb(this.O2).R$a():!1}CUj(){const a=ub.GraphIterator.pb(this.O2);this.L0c()&&a.Ri();return 1===a.R$a()&&(a.Ri(),he.OutlineElementReader.hh(a)&&1===a.R$a()&&a.Db(2))?zb.ParagraphReader.vl(a)&&!fi.nI.YOf(a):!1}Jfj(){const a=ub.GraphIterator.pb(this.O2);this.L0c()&&a.Ri();a.Ri();a.Ri();ha.ULS.shipAssertTag(6305614,307,zb.ParagraphReader.vl(a));return zb.ParagraphReader.text(a.currentNode)}I7f(a){try{return this.ihj(a)}catch(b){return ha.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",
b.message),0}}ihj(a){let b=0;if(a&&(b=this.hhj(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.I7f(a.childNodes[c]),0===b);c++);return b}hhj(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.z9h))return b.startsWith(this.WYb)?this.hs&&b===this.WYb+this.hs?3:2:1}return 0}rYk(a,b,c,f,l){l.AL||(l.AL={});fi.Oa.raiseEvent("OnParagraphCopy",new mz(a,b,c,f,l.AL))}KYk(a,b,c,f){f.AL||(f.AL={});fi.Oa.raiseEvent("OnCopyComplete",
new mz(a,null,b,c,f.AL))}hYk(a){a.AL||(a.AL={});fi.Oa.raiseEvent("BeforePaste",new CI(a.AL))}RYk(a,b,c,f,l){fi.Oa.raiseEvent("OnParagraphPaste",new mz(a,b,c,f,l.AL))}QZf(a){Oc.isTableCell(a)&&(a.Db(1)||this.ey.vW(a,!0),a.Cc())}RZf(a,b){this.QQd.isTableCellNode(b)&&(b.width=a.width)}static get oh(){return fi.Jf||(fi.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return fi.mh||(fi.mh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return fi.qx||
(fi.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}static get rO(){const a=Fb.a.instance.rb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get nI(){return cj.a.instance}static get Vk(){return fx.PageReader.instance}static p_i(a){const b={};for(const c of Iq.a(a)){const f=a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=Iq.a(b).length&&ha.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static r6k(a,b,c,f,l,y){b.colSpan>l-c&&(y&&y("A",b.colSpan,l-c),
b.colSpan=l-c);a=fi.xCl(a,b,f,c);b.colSpan!==a&&(y&&y("B",b.colSpan,a),b.colSpan=a)}static s6k(a,b,c,f,l,y){b.rowSpan>l-c&&(y&&y("A",b.rowSpan,l-c),b.rowSpan=l-c);a=fi.yCl(a,b,c,f);b.rowSpan!==a&&(y&&y("B",b.rowSpan,a),b.rowSpan=a)}static xCl(a,b,c,f){return fi.DFh(a,b.colSpan,(l,y)=>{ae.moveToCell(l,c,f+y)})}static yCl(a,b,c,f){return fi.DFh(a,b.rowSpan,(l,y)=>{ae.moveToCell(l,c+y,f)})}static DFh(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");
for(let l=1;l<b;l++){var f=ub.GraphIterator.pb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static uOf(a,b){return a+","+b}}fi.Oa=new Wc.a;fi.Jf=null;fi.mh=null;fi.qx=null;fi.eMc=50;fi.GIf=1225;fi.MOj="PasteConstrainingWidth";Object(m.a)(fi,"InternalClipboard",null,[]);class MI extends Xj{constructor(a,b,c,f,l,y){super(a,b,c,l);this.us=f;this.uKd=y}get cxl(){return w.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get uh(){return this.uKd.value}get Fid(){return this.us.Fid()}get Chh(){const a=
this.us;return a.L0d&&!a.L0c()}H_f(a,b){ha.ULS.shipAssertTag(6305616,307,uj.OutlineReader.pu(a));const c=Dq.b(a.currentNode);if(uj.OutlineReader.isEmpty(a)){var f=bb.a.create(a.currentNode);a.gC(8);w.AFrameworkApplication.Qa.ii(f,C.a.uL,2,!0,null,null)}else a.gC(8);(f=a.DB(1))&&a.Cc();this.us.fhh(this.ag.Nf,a.currentNode,f,-1,c,b)}get fpg(){return this.us.CUj()}get bPf(){return this.us.Jfj()}G_f(a){const b=new ub.GraphIterator;this.rjb.restore(b);ha.ULS.shipAssertTag(6305618,307,he.OutlineElementReader.hh(b));
this.ag.G1&&this.ag.G1.RKc("internal");let c=-1;if(this.VCh&&Object(Sa.a)(10,this.ag.vd))c=this.ag.vd.sa(ct.a.u5b,-1);else if(this.cxl){const f=this.aij(b.currentNode);c=f?f.clientWidth:c}this.us.fhh(this.ag.Nf,b.parentNode,b.currentNode,c,null,a);this.Qrg&&(this.rjb.restore(b),he.OutlineElementReader.hh(b)&&this.us.zug(b)&&(a=rc.OutlineElementNavigator.yi(b)))&&(this.ag.Ata=Vd.SelectionFactory.Qg(a,0))}aij(a){return a?(a=a?a.qc(this.uh.Na):null)?a.htmlElement:null:null}JDh(){const a=new ub.GraphIterator;
this.rjb.restore(a);return this.us.zug(a)}get iDh(){return Bb.ListReader.Gx}get hDh(){return!this.us.rka&&!this.us.L0d}}Object(m.a)(MI,"InternalPasteExecutionManager",Xj,[]);class NI{constructor(a,b){this.us=a;this.uKd=b}create(a,b,c){return new MI(a,b,c,this.us,Sc.App.Mb.Ld,this.uKd)}}Object(m.a)(NI,"Factory",null,[524]);var nz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=
3]="sameBox4AppSameSession"})(nz||(nz={}));Object(m.b)("CopySource",nz);class hs{constructor(a,b,c){this.us=a;this.Lkf=b;this.W_h=c}FRk(a,b,c){ha.ULS.shipAssertTag(6305620,307,!!a);ha.ULS.shipAssertTag(6305621,307,Jb.SelectionEditor.Xg(b));ha.ULS.shipAssertTag(6305622,307,!!c);ha.ULS.shipAssertTag(6305623,307,Object(Sa.a)(sp,c.p6));const f=c.p6;f.aSa=this.us.I7f(a);this.Jfk(a,f);const l=this.Dpe(a,b,f);if(l||this.L2e(a,b,f)){var y=new pf.GraphTransaction(7);y.ld(b.node);b.node.nH().graphTransactionOperations.uja(8);
l?(ha.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.Jp,f.browserName),a=this.Lkf.create(b,f,y)):(ha.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.Jp,f.aSa,f.browserName),hs.Dfk(a),a=this.W_h.create(a,b,f,y));c=new xf.a(c,Object(H.a)(a,a.nhh,"pasteSetup"),null);c.$l("Paste");c.run()}else f.Ata=Vd.SelectionFactory.Qu(b)}Dpe(a,b,c){return!this.Jsg(c)&&3===c.aSa}L2e(){return!0}Jsg(a){return 1===(a.Jp&8192?1:0)}jng(a,b){ha.ULS.shipAssertTag(6305624,
307,Jb.SelectionEditor.Xg(a));ha.ULS.shipAssertTag(6305625,307,!!b);ha.ULS.shipAssertTag(6305626,307,Object(Sa.a)(sp,b.p6));const c=new pf.GraphTransaction(7);c.ld(a.node);a=this.Lkf.create(a,b.p6,c);b=new xf.a(b,Object(H.a)(a,a.nhh,"pasteSetup"),null);b.$l("InternalPasteAtIp");b.run()}Jfk(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),
ha.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",nz[b.aSa],c,f)}}static Dfk(a){a&&hs.yci.test(a.innerText)&&ha.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}hs.yci=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(hs,"PasteCoordinator",null,[]);class yC{constructor(a,b){this.lk=a;this.A7=b}}Object(m.a)(yC,"PasteFloatieFeatureSetBuilder",
null,[]);class Bo{constructor(a,b){this.UTb=a;this.qYh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get n4f(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get YPc(){return CommonUIStrings.l_ClipboardCut}get yJe(){return CommonUIStrings.l_ClipboardCut_Mac}get HOc(){return CommonUIStrings.l_ClipboardCopy}get xJe(){return CommonUIStrings.l_ClipboardCopy_Mac}get mKa(){return CommonUIStrings.l_ClipboardPaste}get zJe(){return CommonUIStrings.l_ClipboardPaste_Mac}get u6(){return CommonUIStrings.l_ClipboardPasteText}get AJe(){return CommonUIStrings.l_ClipboardPasteText_Mac}get D_d(){return this.qYh}get PMf(){return CommonUIStrings.l_ClipboardExtensionLink}get ORa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}k0f(){ha.ULS.sendTraceTag(8716421,
307,50,null);Cd.a.In(this.D_d,"_blank",void 0,"ClipboardAccessExtensionLink")}Y1(a,b){let c=z.a.fl;w.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=z.a.Yi||c);return c?String.format(b,"\u2318"):a}dispose(){this.UTb=null}rVe(a){this.SPf(a)}Bbk(a){this.SPf(a)}SPf(a){this.UTb&&this.UTb(a)}}Bo.id="CopyPasteShortcutDialog";Bo.JKh="CopyPasteText";Object(m.a)(Bo,"ACopyPasteShortcutDialog",null,[108]);class OI extends Bo{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=Bo.JKh;var f=document.createElement("span");f.innerText=this.n4f;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.Y1(this.YPc,this.yJe);const y=document.createElement("span");y.className="UIFontBold";y.innerText=this.Y1(this.HOc,this.xJe);const G=document.createElement("span");G.className="UIFontBold";G.innerText=this.Y1(this.mKa,this.zJe);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(y);b.appendChild(G);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(z.a.ik||z.a.mg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.Y1(this.u6,this.AJe),b.appendChild(c));a.appendChild(b);this.D_d?(ha.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.PMf,md.a.addHandler(b,"click",Object(H.a)(this,this.k0f,"extensionLinkHandler")),c.appendChild(b),l=this.ORa.indexOf("{0}"),
-1!==l&&(f=this.ORa.substring(l+3,this.ORa.length),l=document.createTextNode(this.ORa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):ha.ULS.sendTraceTag(8716422,307,50,null);c=new sh.StandardDialog;c.Ad=0;c.ig=Bo.id;c.Tx(this.titleText,null,0,Object(H.a)(this,this.Bbk,"legacyCopyPasteShortcutDialogHandler"),a);c.J6(Bo.JKh)}}Object(m.a)(OI,"CopyPasteShortcutDialog",Bo,[]);class PI extends Bo{constructor(a,
b){super(a,b);b={};a=this.yUj;b.extensionStartText=this.z4i;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.gwl;b.cutText=this.Y1(this.YPc,this.yJe);b.copyText=this.Y1(this.HOc,this.xJe);b.pasteText=this.Y1(this.mKa,this.zJe);4!==w.AFrameworkApplication.Aa.mb.Ti&&(b.pasteTextOnly=this.Y1(this.u6,this.AJe));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new ei.a(!1,!1,!0);c.ig="CopyPasteInstallDialog";c.Ad=0;c.Le(1,this.xUj);c.cza(1);c.sj(a,Object(H.a)(this,
this.rVe,"reactCopyPasteShortcutDialogHandler"),b)}get gwl(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get xUj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get yUj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get z4i(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(m.a)(PI,"ReactCopyPasteInstallDialog",Bo,[]);class QI extends Bo{constructor(a){super(a,null);this.Ywg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.rCk;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.$Ti;b.copyText=this.NLi;b.pasteText=this.NRk;b.cutShortcutText=this.Y1(this.aUi,this.rxk);b.copyShortcutText=this.Y1(this.VLi,this.qxk);b.pasteShortcutText=this.Y1(this.TRk,this.txk);b.imageSrc=hh.a.PN("NoClipboardAccessDialogImage.svg");b.imageAltText=this.wFa;b.primaryButtonLabel=this.TKb;this.Ywg&&(ha.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.HWa,["onExecute"]:()=>{this.ybk()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new ei.a(!1,!1,!0);c.Ad=0;c.ig="CopyPasteNoClipboardAccessDialog";c.sj(a,Object(H.a)(this,this.rVe,"reactCopyPasteShortcutDialogHandler"),b)}get rCk(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get HWa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get wFa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get TKb(){return CommonUIStrings.l_DialogOk}get $Ti(){return CommonUIStrings.l_CutString}get aUi(){return CommonUIStrings.l_CutShortcut}get rxk(){return CommonUIStrings.l_CutShortcut_Mac}get NLi(){return CommonUIStrings.l_CopyString}get VLi(){return CommonUIStrings.l_CopyShortcut}get qxk(){return CommonUIStrings.l_CopyShortcut_Mac}get NRk(){return CommonUIStrings.l_PasteString}get TRk(){return CommonUIStrings.l_PasteShortcut}get txk(){return CommonUIStrings.l_PasteShortcut_Mac}ybk(){ha.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Cd.a.In(this.Ywg,"_blank",void 0,"learnMoreLink")}}Object(m.a)(QI,"ReactCopyPasteNoClipboardAccessDialog",Bo,[]);class RI extends Bo{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.n4f;a.cutText=this.Y1(this.YPc,this.yJe);a.copyText=this.Y1(this.HOc,this.xJe);a.pasteText=this.Y1(this.mKa,this.zJe);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(z.a.ik||z.a.mg)&&(a.pasteTextOnly=this.Y1(this.u6,this.AJe));this.D_d?(ha.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.PMf,["onExecute"]:f=>{this.k0f(f)}},c=this.ORa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.ORa.substring(0,c),a.suggestionSuffixElement=this.ORa.substring(c+3,this.ORa.length))):ha.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:Bo.id,["bodyControls"]:a};a=new ei.a(!1,!1,!0);a.Ad=0;a.ig=Bo.id;a.sj(this.titleText,Object(H.a)(this,this.rVe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(m.a)(RI,"ReactCopyPasteShortcutDialog",
Bo,[]);class Jq{constructor(){this.Rqa=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.gD}Jvb(a,b,c=!1,f=!1){ha.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.Rqa,c));f?new QI(a):this.Rqa?c?new PI(a,b):new RI(a,b,w.AFrameworkApplication.fa):new OI(a,b,w.AFrameworkApplication.fa)}static get instance(){return Jq.La||(Jq.La=new Jq)}}Jq.La=null;Object(m.a)(Jq,"CopyPasteShortcutDialogFactory",null,[643]);class SI{constructor(a,b,c,f,l,
y,G){this.Hlf=this.sQd=!1;this.AZb=a;this.Pf=b;this.Wia=c;this.Pd=f;this.jd=l;this.xf=y;this.ud=G}get jN(){return this.AZb}get aGa(){return this.Hlf}set aGa(a){this.Hlf=a;this.xf.u_c=a}Eda(a){this.jN.Eda(a);a||this.JMa(!0)}y8a(a){this.jN.y8a(a)}get y2i(){return this.jN.G6}get f2i(){return this.jN.zy}prepareForPaste(a){this.aGa=!0;this.jN.prepareForPaste(a,!1,this.f7e)}Sda(a,b){this.jN.Sda(a,!1,b)}reset(){this.aGa=!1}paste(){var a=this.Pf.Rd;a&&this.Pd.wf(a.$I);var b=this.Wia.jL;if(!b.Uh||!b.editingView.lm)return null;
a=b.editingView;let c=this.jd.Gm();this.aGa=!0;b.pAa();b=null;try{a.$Wk(),b=c=this.jN.W9a(this.f7e,c)}catch(f){ha.ULS.shipAssertTag(6305672,307,!1),this.N9b(!0)}this.aGa=!1;return b}copy(){var a=this.Pf.Rd;a&&this.Pd.wf(a.$I);a=this.Wia.jL;if(!a.Uh||1!==a.editingView.mode)return!1;this.aGa=!0;let b;try{this.jN.DSc(this.f7e),b=!0}catch(c){ha.ULS.shipAssertTag(6305673,307,z.a.mg),ha.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",z.a.mz),b=!1}this.aGa=
!1;return b?!0:!1}JMa(a){if(this.sQd)return!0;var b=this.Wia.jL;if(!b.Uh||!b.editingView.lm)return!1;const c=b.editingView;b=this.jd.Gm();this.aGa=!0;const f=new hd.a(b);let l=!1;try{l=this.jN.JMa(b,()=>{c.sEi()},()=>{c.zLa()})}catch(y){ha.ULS.shipAssertTag(6305674,307,!z.a.Yj)}f.restore();this.aGa=!1;l?this.sQd=!0:(ha.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",z.a.mz),z.a.Yj||this.N9b(a));return l}N9b(){this.sQd=!1;if(w.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)Jq.instance.Jvb(null,
null);else{const a=new sh.StandardDialog;a.Ad=0;a.zP(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get f7e(){const a=this.jd.Vta();return a?a.Il:null}}Object(m.a)(SI,"SystemClipboard",null,[514]);class zC{constructor(a){this.$nb=2147483647;this.kTb=null;this.Pl=0;this.nLg=!0;this.Kpf=window.navigator.clipboard;this.Lpf=window.navigator.permissions;this.QS=a}getData(a,b){ha.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.kTb){var c=this.Kfj(this.kTb,
a);c?this.kTb[0].getType(c).then(f=>{"image/png"===c?this.QS.j3b([f],l=>{this.PNe(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.p9i(l):l;ha.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.FX(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.FX(!1,"getDataFailed");b(a,null)}):(this.FX(!1,"unSupportedType"),b(a,null))}else this.FX(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.FX(!1,"getDataFailed"),b(a,null)}}Kfj(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}PNe(a,b,c){a&&this.QS.suc&&(a=String.format('<img src="{0}">',a));ha.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}p9i(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}L9e(a,b,c){this.kTb=b;a(c)}Gyd(a){try{this.kTb=null,this.Kpf.read().then(b=>{let c;this.Pl&&(c=Date.now()-this.Pl,ha.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.FX(!0,"none");this.L9e(a,b,!0)},()=>{this.FX(!1,"clipboardReadFailed");this.L9e(a,null,!1)}).catch(()=>{this.FX(!1,"clipboardReadFailed");this.L9e(a,null,!1)})}catch(b){this.FX(!1,"clipboardReadNotSupported"),a(!1)}}zLf(a,
b){this.nLg=a?!0:!1;if(this.Kpf)if(this.Lpf)try{this.Lpf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.Pl=Date.now(),this.Gyd(b)):"prompt"===c&&a?this.Gyd(b):(this.FX(!1,"permissionDenied"),b(!1))):(this.FX(!1,"invalidPermissionStatus"),b(!1))},()=>{this.FX(!1,"permissionQueryFailed");a?this.Gyd(b):b(!1)}).catch(()=>{this.FX(!1,"permissionQueryFailed");b(!1)})}catch(c){this.FX(!1,"permissionQueryNotSupported"),b(!1)}else this.FX(!1,"navigatorPermissionNotSupported"),a&&
this.Gyd(b);else this.FX(!1,"navigatorClipboardNotSupported"),b(!1)}FX(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.nLg;"none"!==b&&(c.AsyncAPIFailureReason=b);ha.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(m.a)(zC,"AsyncClipboardAPI",null,[]);class oz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(m.a)(oz,"ExtensionClipboardData",null,[]);class TI{constructor(a,b,c,f){this.e3=
this.dA=this.Hnf=this.sqa=null;this.Hzc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.h1h=a.Ha("ChromeClipboardAccessExtensionLink");this.vOa=b;this.lk=c;this.d6h=a.Ha("ChromeClipboardAccessExtensionId");this.QS=f;this.J2=new zC(this.QS);this.AUb=null;this.kBc=a.ka("EnhancedTextCCPEnabled");this.Xkf=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}Eda(a){a?this.dA=!0:(this.e3=
this.dA=null,chrome.runtime&&chrome.runtime.sendMessage?(this.AUb=this.vOa.gWc(),this.vOa.jza?this.oLf(!0,null):(this.dA=!0,ha.ULS.sendTraceTag(19256732,307,50,ia.a.create().toString()))):this.J2?this.Zub(!0,null):(this.eRe(),this.dA=!1))}y8a(a){this.e3=this.dA=null;chrome.runtime&&chrome.runtime.sendMessage?(this.AUb=this.vOa.gWc(),this.vOa.jza?this.oLf(!1,a):(this.dA=!0,ha.ULS.sendTraceTag(19256732,307,50,ia.a.create().toString()),a(this.G6))):this.J2?this.Zub(!1,a):(this.dA=!1,a(this.G6))}get G6(){return this.dA}get zy(){return this.e3}JMa(){return!0}DSc(a){ha.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");Cd.a.U9a(a,"copy")||ha.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}W9a(a,b){this.sqa&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.sqa,b=a.body,this.sqa=null);return b}fij(a){var b=this.lk.tcg(a.html);if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}Z7f(a,b){const c=ia.a.create();this.Hnf=c;this.vOa.jza?
ha.ULS.sendTraceTag(7377737,307,50,c.toString()):ha.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.AUb,f,l=>{c.equals(this.Hnf)?this.sqa=this.kBc?this.fij(l):l:ha.ULS.sendTraceTag(7385868,307,50,null);ha.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.k_i(),this.vOa.jza?ha.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):ha.ULS.sendTraceTag(19256737,307,
10,chrome.runtime.lastError.message));a(l)}):(ha.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},f=(l,y)=>{this.sqa=y;a(!0)};null!=this.zy&&this.zy?this.J2.getData(b?"image/png":null,f):this.Z7f(c,this.kBc?"getClipboardData":"paste")}Sda(a,b,c){a=(f,l)=>{const y=new oz;"image/png"==f?y.img=l:y.html=l;c(y)};null!=this.zy&&this.zy?this.J2.getData(b?"image/png":null,a):this.Z7f(c,"getClipboardData")}eRe(){ha.ULS.sendTraceTag(8716423,
307,50,null);Jq.instance.Jvb(Object(H.a)(this,this.GUk,"popupInstallDialogHandler"),this.Hzc?this.h1h+this.AUb:null)}GUk(a){1===a?ha.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Hzc)):0===a&&ha.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.Hzc))}DUk(){ha.ULS.sendTraceTag(509666773,307,50,null);Jq.instance.Jvb(Object(H.a)(this,this.EUk,"popupClipboardAccessDialogHandler"),null,!1,!0)}EUk(){ha.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",
this.Hzc))}k_i(){this.vOa.xYe();this.eRe()}ayh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(ha.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}Zub(a,b){ha.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.J2.zLf(a,c=>{this.e3=c;this.dA=this.zy;a&&this.hAl();b&&b(this.G6)})}hAl(){null==this.zy||this.zy||this.DUk()}oLf(a,b){const c=ia.a.create();ha.ULS.sendTraceTag(7726105,
307,50,c.toString());this.ayh(this.AUb,f=>{ha.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.dA=!0:(f?"ping"!==f&&ha.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):ha.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.J2?this.Zub(a,b):(a&&this.eRe(),this.dA=!1));b&&b(this.G6)})}tyg(a,
b){const c={};c.OfficeOnlineExtensionInstallationStatus=a;c.OfficeClipboardExtensionInstallationStatus=b;ha.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}$ek(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.vOa.jza;this.ayh(this.d6h,b=>{this.tyg(a,!!b)})}else this.tyg(!1,!1)}}Object(m.a)(TI,"ChromeSystemClipboardAccessManager",null,[513]);class UI{constructor(a,b,c,f){this.e3=this.dA=this.SHc=this.sqa=this.J2=null;this.ud=a;this.Ma=b;this.Ldf=!this.Ma.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&
this.Ma.ka("BlockCopyCutOnFirefoxIsEnabled");this.QS=c;this.lk=f;this.YKd=b.uc("ClipboardDataImageBlobLimitaton",10);z.a.s6e||(this.J2=new zC(this.QS))}Eda(a){this.Ldf&&a&&this.ud.mg?(Jq.instance.Jvb(null,null),this.dA=!1):(this.dA=!0,this.e3=!1,this.J2&&(this.e3=this.dA=null,this.Zub(!0,null)))}y8a(a){this.Ldf&&this.ud.mg&&(this.dA=!1,a(this.G6));this.dA=!0;this.e3=!1;this.J2?(this.e3=this.dA=null,this.Zub(!1,a)):a(this.G6)}Zub(a,b){ha.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");
this.J2.zLf(a,c=>{this.e3=c;this.dA=this.zy;a&&this.Ezl();b&&b(this.G6)})}Ezl(){null==this.zy||this.zy||this.CUk()}CUk(){Jq.instance.Jvb(null,null)}get G6(){return this.dA}get zy(){return this.e3}DSc(a){Cd.a.U9a(a,"copy")}W9a(a,b){if(this.sqa&&null!=this.zy&&this.zy)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.sqa,b=a.body,this.sqa=null,b;const c=Date.now(),f=Cd.a.U9a(a,"paste");b&&""===b.innerHTML&&(this.Gfj(a),b.innerHTML=this.SHc?this.SHc:"",this.SHc="");ha.ULS.sendTraceTag(512356673,
307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",Date.now()-c,f);return b}Gfj(a){const b=c=>{if(c){c=c.clipboardData;const f=this.lk.c8b(c);this.SHc=f&&""!==f?f:this.lk.rde(c)}};window.addEventListener("paste",b,!1);Cd.a.U9a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.sqa=l;a(!0)};null!=this.zy&&this.zy?this.J2.getData(b?"image/png":null,c):a(!1)}Sda(a,b,c){if(c){var f=(l,y)=>{const G=new oz;"image/png"==l?G.img=y:G.html=y;c(G)};null!=this.zy&&
this.zy?this.J2.getData(null,f):z.a.s6e&&this.Hfj(a,b,c)}else ha.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}Hfj(a,b,c){ha.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;Ga.a.yv(a.body);try{const f=l=>{const y=new oz;l=l.clipboardData;if(b){var G=null;({V$b:G}=this.lk.zyd(l,this.YKd,this.QS.Mlc));G&&0<G.length&&(y.isImageAvailable=!0)}else G=this.lk.getData(l,"ppt/slides"),y.pptSlide=G,G&&""!==G||(l=(G=this.lk.c8b(l))&&
""!==G?G:this.lk.rde(l),y.html=l);c(y)};a.addEventListener("paste",f,!1);Cd.a.U9a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){ha.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}JMa(a,b,c){if(this.ud.dU&&!this.Ma.ka("ElectronClipboardAccessFix"))return this.dA=!1;b();c();a=this.W9a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=oh.a.create().toString();c();a=this.W9a(a.ownerDocument,a);a=b===a.innerHTML;
this.J2?a&&(this.dA=!0):this.dA=a;return a}}Object(m.a)(UI,"DefaultSystemClipboardAccessManager",null,[513]);class VI{constructor(a,b,c,f){this.e3=this.dA=this.$V=this.arb=this.X7=this.xBa=this.Kzc=null;this.lk=b;this.QS=c;this.YKd=a.uc("ClipboardDataImageBlobLimitaton",10);this.I2h=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.o_h=f;this.e$h=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Eda(a){this.e$h&&a&&(this.dA=!0);this.e3=!1}y8a(a){a(!0)}get G6(){return this.dA}get zy(){return this.e3}DSc(a){a&&
Cd.a.U9a(a,pa.a.copy)}W9a(a,b){this.xBa&&(b=this.xBa,this.xBa=null);return b}Sda(a,b,c){c?c(null):ha.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.Kzc=a;this.arb=c;$addHandler(this.arb,pa.a.paste,Object(H.a)(this,this.zch,"onPasteEvent"));this.$V=this.X7=null;this.I2h&&this.o_h.Y5b();if(this.Hyd(this.arb)){if(this.$V&&0<this.$V.length&&(!this.X7||this.lk.cAd(this.X7))){this.QS.j3b(this.$V,Object(H.a)(this,this.PNe,"onImageConverted"));
this.xBa&&!this.xBa.hasChildNodes()&&ha.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.X7&&this.X7.innerHTML&&((this.xBa=this.pkg(this.X7.innerHTML))&&!this.xBa.hasChildNodes()&&ha.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Ga.a.yv(this.X7))}this.G2f()}else a&&a(!1)}JMa(a){return this.dA=a=this.Hyd(a.ownerDocument)}zch(a){try{a&&a.rawEvent&&((this.X7=a.rawEvent.target)&&this.X7.id&&-1<this.X7.id.indexOf("Paste")?(ha.ULS.sendTraceTag(40690080,
307,15,"The pasted target element of paste event: "+this.X7.id),this.X7=null):this.$V=this.$lj(a.rawEvent))}catch(b){ha.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}PNe(a){a&&(this.QS.suc&&(a=String.format('<img src="{0}">',a)),this.xBa=this.pkg(a));this.G2f()}G2f(){this.arb&&($removeHandler(this.arb,pa.a.paste,Object(H.a)(this,this.zch,"onPasteEvent")),this.arb=null);this.Kzc&&(this.Kzc(!1),this.Kzc=null)}$lj(a){let b=null;(a=this.lk.lae(a))&&
({V$b:b}=this.lk.zyd(a,this.YKd,this.QS.Mlc));return b}Hyd(a){return Cd.a.U9a(a,pa.a.paste)}pkg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(m.a)(VI,"EdgeSystemClipboardAccessManager",null,[513]);class WI{constructor(a,b,c,f){this.Ma=a;this.mYh=b;this.lk=c;this.ud=f}create(){var a=null;a=this.ud.dU&&this.Ma.ka("ElectronClipboardAccessFix"),w.AFrameworkApplication.dvd()&&this.ud.ik&&window.chrome&&!a?(ha.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),
a=new TI(this.Ma,this.mYh,this.lk,Fb.a.instance.resolve("Box4.IProcessImageStrategy")),this.Ma.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.$ek()):this.Ma.ka("EdgeContextMenuPasteFixIsEnabled")&&this.ud.Io?(ha.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new VI(this.Ma,Fb.a.instance.resolve("Box4.IClipboardDataHelper"),Fb.a.instance.resolve("Box4.IProcessImageStrategy"),Fb.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(ha.ULS.sendTraceTag(7377744,
307,50,"DefaultSystemClipboardAccessManager"),a=new UI(this.ud,this.Ma,Fb.a.instance.resolve("Box4.IProcessImageStrategy"),this.lk));return a}}Object(m.a)(WI,"SystemClipboardAccessManagerFactory",null,[512]);class XI{s_f(a){return a}}Object(m.a)(XI,"DeleteTableSegmentStrategy",null,[441]);var ZQ=d(1264),$Q=d(649);class Kq{constructor(a,b){this.ll=new J.DictionaryPropertySet;this.FId=!1;this.Sia=this.Dia=this.$3a=null;this.XV=a;this.A0h=b}get A2a(){return this.Sia||(this.Sia=Fb.a.instance.rb("Box4.ITextFormattingCommands"))}get oh(){return Kq.Jf||
(Kq.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}R0a(){this.FId||(this.ll.EWe(),this.$3a=null,this.O$k())}ULi(a){a=wb.a.Es(a);if(!a.cache.zt){var b=a.iA;if(b){var c=new J.DictionaryPropertySet;c.oy(b);c.oy(this.ll);c.Ta(V.a.F3)&&(this.$3a=a.paragraph.Nh);this.ll=c}}}Ta(a){return this.ll.Ta(a)}whe(){return 0<this.ll.M2}get Zbb(){return this.ll}freeze(){this.FId=!0}X7e(){this.FId=!1}fJ(a,b){return this.Zbb.sa(a,b)}Xq(a){this.ll.setValue(Ya.a.fontSize,this.oh.Z2b(a));this.kS()}fontSize(){return this.ll.sa(Ya.a.fontSize,
be.Font.SI)}wtd(a){this.ll.setValue(Ya.a.font,a);this.A0h.wtd(this.ll,a);this.XV&&this.XV.enabled&&(lf.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.XV.t2l(this.ll,a));this.kS()}$La(a){this.ll.setValue(sb.a.DV,a);this.XV&&this.XV.enabled&&(lf.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.XV.x2l(this.ll,a));this.kS()}vr(a){a=$Q.a.instance.V_d(ze.a.instance.Pa.nb.Ua.node,a);this.ll.setValue(Ya.a.fontColor,a);this.kS()}IW(){this.ll.setValue(Ya.a.fontColor,
oc.a.auto);this.kS()}fontColor(){return this.ll.sa(Ya.a.fontColor,oc.a.nil)}qpa(a){this.ll.setValue(Ya.a.highlight,parseInt(a,16));this.kS()}m2b(){this.ll.setValue(Ya.a.highlight,oc.a.auto);this.kS()}isBold(){return this.ll.sa(Ya.a.bold,!1)}eI(a){this.ll.setValue(Ya.a.bold,a);this.kS()}isItalic(){return this.ll.sa(Ya.a.italic,!1)}setItalic(a){this.ll.setValue(Ya.a.italic,a);this.kS()}uE(){return this.ll.sa(Ya.a.underline,!1)}iZ(a){this.ll.setValue(Ya.a.underline,a);this.ll.setValue(Ya.a.iw,a?be.Font.azd:
be.Font.IV);this.kS()}iw(){return this.ll.sa(Ya.a.iw,be.Font.IV)}wpa(a){a<be.Font.azd||a>be.Font.IV||(this.ll.setValue(Ya.a.underline,a!==be.Font.IV),this.ll.setValue(Ya.a.iw,a),this.kS())}isSuperscript(){return this.ll.sa(Ya.a.superscript,!1)}hZ(a){this.ll.setValue(Ya.a.superscript,a);a&&this.isSuperscript()&&this.ll.setValue(Ya.a.subscript,!1);this.kS()}dG(){return this.ll.sa(Ya.a.subscript,!1)}M6(a){this.ll.setValue(Ya.a.subscript,a);a&&this.dG()&&this.ll.setValue(Ya.a.superscript,!1);this.kS()}cG(){return this.ll.sa(Ya.a.strikethrough,
!1)}gZ(a){this.ll.setValue(Ya.a.strikethrough,a);this.kS()}j0(){return this.ll.sa(V.a.rt,!1)}qlb(a){this.ll.setValue(V.a.rt,a);this.kS()}V6f(){return this.ll.sa(V.a.F3,null)}Nga(a,b){this.ll.EWe();this.ll.setValue(V.a.F3,a.id);this.$3a=b.Nh;this.kS()}rV(a){let b=Ya.a.At;if(M.a.instance.ga(13)){const c=ZQ.a.Fdc(a);switch(c){case 1:b=sb.a.zCb;break;case 2:b=sb.a.ACb}this.ll.setValue(sb.a.languageHint,c)}this.ll.setValue(b,a);this.kS()}language(){let a=Ya.a.At;if(M.a.instance.ga(13))switch(this.ll.sa(sb.a.languageHint,
0)){case 1:a=sb.a.zCb;break;case 2:a=sb.a.ACb}return this.ll.sa(a,0)}frl(a){this.ll.setValue(Kq.zLe,a);this.kS()}dWa(){return this.ll.sa(Kq.zLe,!1)}c3j(){return this.ll.Ta(Kq.zLe)}Q1j(){return M.a.instance.ga(13)?this.ll.Ta(Ya.a.At)||this.ll.Ta(sb.a.zCb)||this.ll.Ta(sb.a.ACb):this.ll.Ta(Ya.a.At)}kS(){if(z.a.WPb){var a=ze.a.instance.Pa.nb.Ua,b=a.node;if(b===this.Dia)this.Dia.Kv(16,!0);else{this.Dia=b;b=this.Dia.s2a();try{this.Dia.Vwb(a.Ra).N4=!0}finally{b&&b.dispose()}}}}O$k(){if(z.a.WPb&&this.Dia){var a=
0,b=this.Dia.s2a();try{for(let c=this.Dia.Sa.length-1;0<=c;c--){const f=this.Dia.Sa.ga(c);f.N4&&(f.N4=!1,a++,f.isEmpty&&this.Dia.Sa.removeAt(c))}}finally{b&&b.dispose()}this.Dia=null}}CKi(a){if(a.Ra!==a.Lb)return!1;a=a.node.Sa.NT(a.Ra);return!!a&&a.N4}Roi(a){if(this.A2a){this.freeze();var b=new pf.GraphTransaction(7);b.ld(a.node);this.A2a.aOb(a);this.X7e();this.R0a();b.dispose()}}M8b(a){const b=zb.ParagraphReader.text(a.node);return a.Ra&&a.Ra!==b.length&&!na.a.yz(b.charCodeAt(a.Ra))&&Br.a.instance.tWc(b,
a.Ra-1)!==a.Ra&&Jb.SelectionEditor.$Bb(a)?(a=Jb.SelectionEditor.gTa(a,!1))?1<a.length||Jb.SelectionEditor.tk(a.Ua)?a:null:null:null}static get zLe(){return M.a.instance.ga(20)?sb.a.noProof:we.a.zxa}}Kq.Jf=null;Object(m.a)(Kq,"InsertionPointFormatting",null,[429]);class YI{constructor(a){this.Ca=a}get un(){return this.Ca}lwi(a){return 32===this.un.Ja(C.a.kN,2,a)}numbering(a){return 32===this.un.Ja(C.a.JP,2,a)}}Object(m.a)(YI,"ListCommands",null,[525]);class AC{constructor(a){this.rf=a}x8a(a){a=Object(sa.a)(pC.a,
a);return!!a&&!!a.view&&a.view.Uh}Lkh(){return!0}JSe(){return!0}Mkh(){}RGh(a){if(a.pr)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}fsj(a){if(!a||!this.rf)return a;const b=new Nn.a;b.set(a);if(this.rf.Pt(b)){for(;!b.pr;)b.Cc();return b.currentNode}return a}}Object(m.a)(AC,"SimpleProofingWholeDocumentCallBacks",null,[920]);class ZI{constructor(a){this.value=a}}Object(m.a)(ZI,"RefBool",null,[]);class pz{constructor(){this.vSc=this.JIb=null;this.BOh=new ZI(!1)}}Object(m.a)(pz,"FindNextErrorOperationParam",
null,[]);class $I extends AC{constructor(a,b){super(b);this.Tm=a}Lkh(a,b){return!this.Cte(a.node,a.Ra,b)}JSe(a,b){return!this.Cte(a,0,b)}Mkh(a,b){this.Cte(a.node,0,b);Object(sa.a)(pz,b)}Cte(a,b,c){c=Object(sa.a)(pz,c);if(zb.ParagraphReader.fe(a)&&!a.nX)if(wb.a.Es(bb.a.Oj(a,b)).cache.dWa)c.BOh.value=!0;else{const f=w.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.Tm.VF(a);for(let y=0;y<l.length;y++){const G=l[y],R=f&&G.Fh.vpe();if(G.begin>=b&&!R)return c.JIb=G,c.vSc=a,!0}}return!1}}
Object(m.a)($I,"FindNextErrorCallbackSteps",AC,[]);class aJ extends bt.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va){super();this.hrb=this.Wi=this.PAa=null;this.init(a);this.$l(Va);this.yFa(R,b,f,l,y);this.HG=y;this.Rt=c;this.Uc=ja;this.rf=za;this.hra=G;this.EI=0}run(){this.x8a();0===this.EI&&this.i2e();1===this.EI&&this.TSe();2===this.EI&&this.k7e();3===this.EI&&this.b9d()}x8a(){this.Uc.Pa&&this.Uc.Pa.nb?1===this.behavior&&(this.hra.x8a(this.Rt)?this.np=32:this.np=2,this.EI=3):(ha.ULS.sendTraceTag(20321351,
324,15,"No selection for ignore all"),this.np=2,this.EI=3)}i2e(){this.yvi();this.Uui();this.EI=1}TSe(){this.ux||new xf.a(this,Object(H.a)(this,this.sYk,"processCurrentNodeAtBegin"),this.HG);do if(this.ux.run(),this.ux.inProgress&&!this.Zi)return;while(this.ux.inProgress);this.jNc();this.EI=2}k7e(){this.np=32;this.EI=3}b9d(){this.eZ()}sYk(a,b){b=this.hra.Lkh(this.PAa,b);a.gh(Object(H.a)(this,this.Naj,"fromHereToEnd"));return b}Naj(a,b){if(this.Wi.moveNext())return a=this.Wi.currentNode,12!==a.type||
a===this.PAa.node?!0:this.hra.JSe(a,b);this.Rvi();a.gh(Object(H.a)(this,this.Xaj,"fromStartToHere"));return!0}Xaj(a,b){if(this.Wi.moveNext()){const c=this.Wi.currentNode;return 12!==c.type?!0:c===this.PAa.node?(a.gh(Object(H.a)(this,this.tYk,"processCurrentNodeAtEnd")),!0):this.hra.JSe(c,b)}return!1}tYk(a,b){this.hra.Mkh(this.PAa,b);return!1}yvi(){let a=this.Uc.Pa.nb;if(a=this.rf.im(a,!0,!1))this.PAa=a.Ua;this.PAa&&this.PAa.node&&(this.hrb=this.hra.fsj(this.PAa.node))}Uui(){if(!this.hrb)throw Error.argumentNull("_proofingWholeDocumentRootNode");
const a=new Nn.a;a.set(this.PAa.node);a.rc(this.hrb.type);this.Wi=Ex.a.P3(a,this.hrb);this.Wi.wm(Object(H.a)(this.hra,this.hra.RGh,"spellErrorFilter"),null)}Rvi(){if(!this.hrb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new Nn.a;a.set(this.hrb);this.Wi=Ex.a.zv(a);this.Wi.wm(Object(H.a)(this.hra,this.hra.RGh,"spellErrorFilter"),null)}}Object(m.a)(aJ,"ProofingWholeDocumentOperation",bt.a,[]);class BC{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){this.Ca=b;this.Tm=a;this.h4h=
c;this.mh=f;this.Mk=l;this.Uc=y;this.Um=G;this.rf=R;this.q6a=ja;this.XD=za;this.qd=Va;this.kDc=Cb.Fqe;this.psf=lc;this.MP=ic;this.Jyc=new Pb.a;this.Jyc.$(1,C.a.SGh);this.Jyc.$(2,C.a.$fg);this.Jyc.$(3,C.a.gIh);this.iGc=new Pb.a;this.iGc.$(1,C.a.TGh);this.iGc.$(2,C.a.agg);this.iGc.$(3,C.a.hIh)}vb(){const a=this.Ca,b=Object(H.a)(this,this.dMi,"correctError"),c=Object(H.a)(this,this.SFi,"collapseIp");a.ra(C.a.hOk,rb.a.view,Object(H.a)(this,this.iOk,"openLanguageDialogView"),1028);a.ya(C.a.ODa,rb.a.Mf,
Object(H.a)(this,this.ODa,"deleteRepeatedWord"));a.ya(C.a.ola,rb.a.Mf,Object(H.a)(this,this.ola,"ignoreSpellingError"));a.ya(C.a.Nza,rb.a.Mf,b);a.ya(C.a.Oza,rb.a.Mf,b);a.ya(C.a.Pza,rb.a.Mf,b);a.ya(C.a.EMa,rb.a.Mf,b);a.ya(C.a.FMa,rb.a.Mf,b);a.ya(C.a.ODa,rb.a.view,c);a.ya(C.a.ola,rb.a.view,c);a.ya(C.a.Nza,rb.a.view,c);a.ya(C.a.Oza,rb.a.view,c);a.ya(C.a.Pza,rb.a.view,c);a.ya(C.a.EMa,rb.a.view,c);a.ya(C.a.FMa,rb.a.view,c);a.ie(C.a.ODa,1028);a.ie(C.a.ola,1028);a.ie(C.a.Nza,1028);a.ie(C.a.Oza,1028);a.ie(C.a.Pza,
1028);a.ie(C.a.EMa,1028);a.ie(C.a.FMa,1028);a.ya(C.a.cxd,ye.a.frame,zf.ActionManager.Sg);this.kDc&&a.ra(C.a.bRe,rb.a.view,Object(H.a)(this,this.bRe,"populateProofingSecondaryMenu"),1124);w.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&w.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.ra(C.a.vid,rb.a.view,Object(H.a)(this,this.g8i,"findNextProofingError"),1028);this.r8k([C.a.zEl,C.a.SGh,C.a.TGh,C.a.dCj,C.a.$fg,C.a.agg,C.a.KGl,C.a.gIh,C.a.hIh])}r8k(a){for(let b=0;b<a.length;b++)this.Ca.ra(a[b],
rb.a.view,zf.ActionManager.Cv,1028)}SFi(a,b,c,f,l){b=this.Uc.Pa.nb;if(!b)return this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),2;b=this.rf.im(b,!0,!1);return this.Ca.ii(b.Ua,a,c,!1,f,l)}iOk(a,b,c){if(1===c)return this.Ca.processAction(C.a.rV,1);this.h4h().Kuc();return 32}F9e(a){return a?a.Fh?!1:(ha.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.qd.Yb(Yd.a.i$a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),kf.a.mark(4671),!0):(ha.ULS.sendTraceTag(7660828,
324,10,"Ignore Spelling Error: No flagged word"),this.qd.Yb(Yd.a.i$a,{["Reason"]:"RequestedErrorRangeNotFound"}),kf.a.mark(4671),!0)}ODa(a,b,c){if(1===c)return 32;kf.a.mark(4670);c=this.Tm.bUa(b);if(this.F9e(c))return 8;b=b.node;const f=this.Mk.ke(15);let l=c.begin;" "===zb.ParagraphReader.text(b).charAt(l-1)&&l--;f.ld(b);const y=this.mh.replaceTextRange(bb.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Uc.setSelection(Vd.SelectionFactory.Qg(b,y+l));f.dispose();c.Fh.XMa(a);kf.a.mark(4671);
return 32}Bgk(a){let b;({value:b}=this.iGc.vg(a.Fh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}ola(a,b,c){if(1===c)return 32;ha.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");kf.a.mark(4670);c=this.Tm.bUa(b);if(this.F9e(c))return 8;b=b.node;const f=this.Mk.ke(15);f.ld(b);this.Tm.hLa(b,[c],!0);b.setValue(Ya.a.SOf,!0);f.dispose();c.Fh.XMa(a,1);kf.a.mark(4671);ha.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.Bgk(c);return 32}mhj(a){switch(a){case C.a.Nza:return 0;
case C.a.Oza:return 1;case C.a.Pza:return 2;case C.a.EMa:return 3;case C.a.FMa:return 4;default:return-1}}Xdk(a){let b;({value:b}=this.Jyc.vg(a.Fh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}dMi(a,b,c){var f=!0;this.MP.ga(14)&&(f=!this.XD.Vua(b));this.Um&&this.Um.instance&&this.Um.instance.qX(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.processAction(C.a.cxd,2);kf.a.mark(4670);f=this.mhj(a);if(0>f)return 8;c=this.Tm.bUa(b);if(this.F9e(c))return 8;b=b.node;var l=c.Fh.suggestions;if(!l)return this.qd.Yb(Yd.a.i$a,
{["Reason"]:"NoSuggestionsFound"}),kf.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.qd.Yb(Yd.a.i$a,{["Reason"]:"RequestedSuggestionIsNull"}),kf.a.mark(4671),8;this.MP.ga(50)&&Sc.App.Oh.Ew&&Sc.App.Oh.vZ.Sra(b);f=f.replace("  "," \u00a0");l=this.Mk.ke(15);l.ld(b);const y=this.mh.replaceTextRange(bb.a.createTextRange(b,c.begin,c.end),f,!0,!1,C.a.cxd);this.Uc.setSelection(Vd.SelectionFactory.Qg(b,c.begin+f.length+y));l.dispose();c.Fh.XMa(a);kf.a.mark(4671);this.Xdk(c);return 32}Bkl(a,b,c,f){a.Tya();
(a=c.qc(a.Na))?(f=T.a.eu(a,w.AFrameworkApplication.isRtl?f.begin:f.end),this.q6a.lba(new Sys.UI.Point(f.x,f.y+f.height),b)):ha.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}g8i(a,b,c,f,l){if(!b.view.Uh)return 2;const y=b.view;if(!this.Uc.Pa.nb)return this.qd.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),2;if(1===c)return 32;const G=new pz,R=new $I(this.Tm,this.rf);b=new aJ(null,a,b,c,f,G,R,this.Ca,this.Uc,this.rf,null);b.Zi=!0;b.run();if(b.isCompleted&&G.JIb){if(b=Vd.SelectionFactory.Qg(G.vSc,
G.JIb.begin),b=Vd.SelectionFactory.aO(b,bb.a.Oj(G.vSc,G.JIb.end)),!this.psf.instance||!this.psf.instance.R1l(G.JIb,b,y)){this.Uc.setSelection(b);let ja=0;l&&(ja=l.Uu);y.Sud=!1;Uj.a.instance.Hb(new pd.a(1,1,1,()=>{this.Bkl(y,ja,G.vSc,G.JIb)}))}}else{const ja=new sh.StandardDialog;ja.Ad=0;Sc.App.uS.xre?ja.dmb(CommonUIStrings.l_DefaultDialogTitle,G.BOh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(ja.dmb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),Sc.App.uS.lgi(()=>{ja.aR&&(ja.hide(),this.Ca.processAction(a,2))}))}return 32}bRe(){return 32}}Object(m.a)(BC,"ProofingActor",null,[]);var bJ=d(736),aR=d(1135);class xh{static vBj(){xh.iN||(xh.iN=Array(xh.OGl),xh.iN[0]=Ya.a.fontColor,xh.iN[1]=V.a.lS,xh.iN[2]=Ya.a.At,xh.iN[3]=Ya.a.underline,xh.iN[4]=Ya.a.iw,xh.iN[5]=V.a.rt,xh.iN[6]=Ya.a.font,xh.iN[7]=Ya.a.fontSize,xh.iN[8]=Ya.a.superscript,xh.iN[9]=Ya.a.subscript,xh.iN[10]=Ya.a.Wm,xh.iN[11]=sb.a.noProof,
xh.iN[12]=we.a.zxa,xh.iN[13]=V.a.capitalization,xh.iN[14]=Ya.a.bold,xh.iN[15]=Ya.a.italic,xh.iN[16]=Ya.a.underline);return xh.iN}static tBj(){xh.DD||(xh.DD=Array(xh.RPk),xh.DD[0]=sb.a.xo,xh.DD[1]=sb.a.gKa,xh.DD[2]=sb.a.um,xh.DD[3]=sb.a.$xa,xh.DD[4]=sb.a.QY,xh.DD[5]=sb.a.Sib,xh.DD[6]=sb.a.MJb,xh.DD[7]=sb.a.Rib,xh.DD[8]=V.a.WJb,xh.DD[9]=V.a.VJb,xh.DD[10]=sb.a.SJb,xh.DD[11]=sb.a.PJb,xh.DD[12]=sb.a.KWa,xh.DD[13]=sb.a.Jx,xh.DD[14]=sb.a.Vib,xh.DD[15]=sb.a.Uib,xh.DD[16]=sb.a.toc,xh.DD[17]=sb.a.soc,xh.DD[18]=
Ya.a.Vl,xh.DD[19]=Ya.a.CJ,xh.DD[20]=V.a.tpd,xh.DD[21]=Ya.a.PY);return xh.DD}}xh.OGl=17;xh.RPk=22;xh.iN=null;xh.DD=null;Object(m.a)(xh,"StyleConstants",null,[]);class or{static get JZk(){return or.OP||(or.OP=new aR.a)}static bre(a,b){if(!a||!a.node||!b)return!1;const c=wb.a.Es(a);if(or.Iqg(c?c.iA:null,b,xh.vBj()))return ha.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.h9();return or.Iqg(a,b,xh.tBj())?(ha.ULS.sendTraceTag(51218399,324,
50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Iqg(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Ta(l)?b.Ta(l)?!or.JZk.compare(a,b,l):!0:!1)||f;return f}}or.OP=null;Object(m.a)(or,"StyleUtils",null,[]);class CC{constructor(a,b,c,f,l,y,G,R,ja,za){this.d5a=this.OPb=null;this.mh=a;this.eL=b;this.fL=c;this.Jf=f;this.Oha=l;this.Ut=y;this.XD=G;this.qd=R;this.qQa=ja;this.oci=za}get characterPropertiesEditor(){return this.mh}get GP(){return this.eL}get V6(){return this.fL}get Cm(){return this.Oha}get insertionPointFormatting(){return this.Ut}get oh(){return this.Jf}get ij(){return this.XD}get Xc(){return this.qd}get I7e(){return this.qQa}get eyc(){return this.oci}get SVa(){null==
this.d5a&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.d5a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.d5a}vb(){const a=w.AFrameworkApplication.Qa,b=Sc.App.NMa.ZOc(12);M.a.instance.ga(61)&&(a.ya(C.a.M7a,rb.a.textRange,Object(H.a)(this,this.rpi,"applyStyleToTextRange")),a.ya(C.a.Oqc,rb.a.textRange,Object(H.a)(this,this.c0k,"queryStyleTextRange")),
a.ya(C.a.M7a,rb.a.Mf,Object(H.a)(this,this.ppi,"applyStyleToIp")),a.ya(C.a.Oqc,rb.a.Mf,Object(H.a)(this,this.a0k,"queryStyleIp")));a.ya(C.a.M7a,rb.a.paragraph,Object(H.a)(this,this.qpi,"applyStyleToParagraph"));a.ya(C.a.M7a,rb.a.view,Object(H.a)(this,this.spi,"applyStyleView"));a.ie(C.a.M7a,1036);a.ya(C.a.Oqc,rb.a.view,Object(H.a)(this,this.d0k,"queryStyleView"));a.ya(C.a.Oqc,rb.a.paragraph,Object(H.a)(this,this.b0k,"queryStyleParagraph"));a.ie(C.a.Oqc,99|(M.a.instance.ga(7)?0:4));a.ya(C.a.hpc,rb.a.view,
b);a.ya(C.a.hpc,rb.a.paragraph,Object(H.a)(this,this.hpc,"populateMenuMoreStyles"));a.ie(C.a.hpc,1127);a.ra(C.a.dWd,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.eWd,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.fWd,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.gWd,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.hWd,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.iWd,rb.a.view,Object(H.a)(this,
this.ksa,"applyStyleShortcut"),4);a.ra(C.a.jWd,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.tEf,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.uEf,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);a.ra(C.a.vEf,rb.a.view,Object(H.a)(this,this.ksa,"applyStyleShortcut"),4);this.OPb=Array(10);this.V6.D1e(this.OPb)}dxj(a){switch(a){case C.a.dWd:return 0;case C.a.eWd:return 1;case C.a.fWd:return 2;case C.a.gWd:return 3;case C.a.hWd:return 4;case C.a.iWd:return 5;
case C.a.jWd:return 6;case C.a.tEf:return 7;case C.a.uEf:return 8;case C.a.vEf:return 9;default:return-1}}ksa(a,b,c,f){a=this.dxj(a);return 0>a||a>this.OPb.length?2:(a=this.OPb[a])?w.AFrameworkApplication.Qa.ii(b,C.a.M7a,c,!0,f,a):2}hpc(a,b,c,f,l){a=!0;b.contextId!==rb.a.paragraph&&b.contextId!==rb.a.textRange&&b.contextId!==rb.a.Mf&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.V6.OL(b.node);c=M.a.instance.ga(61);w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp&&(l.MenuItems=
bJ.StylePreviewGenerator.oag(b,c));l.PopulationXML=bJ.StylePreviewGenerator.dcj(b,c);return 32}b0k(a,b,c,f,l){a=!0;b.contextId!==rb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.V6.qE(c);if(!a||!l)return ha.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.d6e.oy(a);this.SVa&&(l.rpe=or.bre(b,a));return 32}qpi(a,b,c,f,l){if(b.contextId!==rb.a.paragraph)return 8;if(M.a.instance.ga(14)&&this.ij.lGa(b))return this.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.Mee(l,a);if(!b)return this.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.q6b}),8;if(2!==this.V6.kua(b))return 2;c=new pf.GraphTransaction(15);c.ld(a);this.insertionPointFormatting.R0a();this.GP.fba(b,a,!1);c.dispose();l=na.a.nL(l);f.PC=l>>>16^l&65535;return 32}c0k(a,b,c,f,l){a=!0;b.contextId!==rb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=wb.a.Es(b);a=wb.a.ayb(a);if(this.SVa){if(!l||!c)return ha.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.V6.qE(c);if(!a)return ha.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.rpe=or.bre(b,a)}else{if(!a)return 2;if(!l)return 8}l.d6e.oy(a);return 32}rpi(a,b,c,f,l){if(b.contextId!==rb.a.textRange||!M.a.instance.ga(61))return 8;if(this.ij.lGa(b))return this.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const y=this.Mee(l,b.node);if(!y)return this.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.q6b}),8;if(1!==this.V6.kua(y))return 2;
c=this.V6.OL(a);if(!c)return this.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.a1f}),8;if(!c.oH(this.V6.OQ(y)))return this.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.q6b}),8;const G=new pf.GraphTransaction(7);try{G.ld(a),this.GP.Gxc(a,c),this.I7e.UKc(b,R=>{this.oh.aDa(R);this.oh.Nga(R,y)})}finally{G&&G.dispose()}b=na.a.nL(l);f.PC=b>>>16^b&65535;return 32}a0k(a,b,c,f,l){a=!0;b.contextId!==rb.a.Mf&&(a=!1);if(1===c&&!a)return 2;c=this.GP.Jee(b);a=b.node;if(this.SVa){if(!l||!a)return ha.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.V6.qE(a);if(!c)return ha.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.rpe=or.bre(b,c)}else{if(!c)return 2;if(!l)return 8}l.d6e.oy(c);return 32}ppi(a,b,c,f,l){if(b.contextId!==rb.a.Mf||!M.a.instance.ga(61))return 8;if(this.ij.lGa(b))return this.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const y=this.Mee(l,b.node);if(!y)return this.Xc.Yb(Yd.a.t2,{["Reason"]:ce.a.q6b}),8;const G=this.V6.kua(y);if(1!==G&&2!==
G)return 2;(b=this.insertionPointFormatting.M8b(b))?(c=ze.a.fSa(b),a=w.AFrameworkApplication.Qa.ii(c,a,2,!1,f,l)):(a=new pf.GraphTransaction(7),a.ld(c),this.GP.E1e(y,c),a.dispose(),a=32);l=na.a.nL(l);f.PC=l>>>16^l&65535;return a}d0k(a,b,c,f,l){if(M.a.instance.ga(61)){const y=this.eyc.v6(a,b,c,f,l,null,0);if(2!==y)return y}return this.eyc.v6(a,b,c,f,l,null,12)}spi(a,b,c,f,l){const y={};y[this.eyc.dqa]=6168;y[this.eyc.cqa]=6169;let G=12;if(M.a.instance.ga(61)){if(!b.view.Uh)return 2;var R=b.view.Nb,
ja=R?R.ak:null;if(!ja)return this.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;if(M.a.instance.ga(11)&&this.Cm.Jsa(ba.ImageReader.RAb,ja))return this.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.b3b}),8;if(M.a.instance.ga(14)&&this.ij.D1c(ja))return this.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),8;ja=this.V6.kzb();if(l&&ja){var za=ja.oH(l);za&&(ja=this.V6.ice(za,ja),za=this.V6.kua(za),ja&&(R=R.Pa.ga(0),R.ida&&R.Ua.contextId===rb.a.textRange||2===R.length&&R.Ua.contextId===rb.a.textRange&&R.jf.contextId===rb.a.endOfParagraph)&&
(za=1,l=ja.eb(V.a.XJb)),1===za?G=0:3===za&&(G=14))}}return this.eyc.v6(a,b,c,f,l,y,G)}Mee(a,b){if(a&&b&&zb.ParagraphReader.fe(b))b=this.V6.OL(b);else return null;return b.oH(a)}}Object(m.a)(CC,"StyleActor",null,[]);const cJ=a=>a.contextId===rb.a.o9d;class Ug{static get Cm(){return Th.ContextSetEditor.instance}static get ij(){return Mh.a.instance}static get Xc(){return cc.a.instance}static get Fe(){return Ug.kd||(Ug.kd=Fb.a.instance.resolve("Box4.IFeatureHelper"))}static mr(){return Ug.Um||(Ug.Um=
Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static get XM(){return Ug.TG||(Ug.TG=Fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static qcc(a){return w.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===C.a.HKa||a===C.a.W0a||a===C.a.y6||a===C.a.vLa)}static u8(a,b,c,f,l){var y=!0;if(!b.view.Uh)return 2;var G=b.view,R=G.Nb;R&&R.Pa.nb||(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),y=!1);if(M.a.instance.ga(11)&&(Ug.Cm.Jsa(ba.ImageReader.Ibc,G.Nb.ak)&&(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.K0d}),
y=!1),Ug.Cm.Jsa(ba.ImageReader.RAb,G.Nb.ak)))return Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.b3b}),8;M.a.instance.ga(14)&&Ug.ij.D1c(G.Nb.ak)&&(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),y=!1);Ug.Cm.Jsa(ba.ImageReader.cpe,G.Nb.ak)&&(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.NOf}),y=!1);Ug.Cm.Jsa(ou.c,G.Nb.ak)&&(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.OOf}),y=!1);Ug.Cm.Jsa(cJ,G.Nb.ak)&&(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.MOf}),y=!1);Ug.mr()&&Ug.mr().instance&&Ug.mr().instance.qX(G.Nb.ak)&&(Ug.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.externalSelection}),
y=!1);a!==C.a.f2||M.a.instance.ga(54)||M.a.instance.ga(84)||(y=!1);var ja=null;R&&R.Pa.nb&&(ja=R.Pa.nb);a===C.a.qEl&&ja&&ja.ida&&zb.ParagraphReader.rX(ja.Ua.node)&&!Bb.ListReader.Gx&&(y=!1);if(1===c||!y||!ja)return y?32:8;y=a===C.a.$la||a===C.a.Dja||a===C.a.gpa||a===C.a.BEa;G=a===C.a.rZk||a===C.a.SVi||a===C.a.iqh;const za=a===C.a.Elb||a===C.a.Flb||a===C.a.f2,Va=new pf.GraphTransaction(15);Va.ld(ja.Ua.node);ja=new Oa.a;let hb=!1;if(y||G||za)kf.a.mark(7121),b=Ug.Cm.sbj(b.RE);else{kf.a.mark(7119);b=
Ci.Jta(R.Pa,!0);if(!b)return Ug.Xc.Yb(Yd.a.vka,{["Reason"]:ce.a.bTc}),Va.dispose(),8;R=a===C.a.BPj||a===C.a.CPj;b.Cx&&R&&(hb=Ug.eLj(ja,b))}b.Cx&&1<b.length&&Ug.fLj(b)&&(l||(l={}),l.InContextSet=!0);w.AFrameworkApplication.Qa.ii(b,a,c,!0,f,l);hb&&Ug.ECk(ja,b,l);Va.dispose();Sc.App.Mb.updateCommandUI();y||G||za?kf.a.mark(7122):kf.a.mark(7120);return 32}static eLj(a,b){if(!b.Cx)return!1;let c=!1,f=!1;for(let y=0;y<b.length;y++)if(b.getContext(y).Rk){var l=b.getContext(y).node;if(l)if(l=Ug.XM.Ayb(l),
2===l.specialIndentType)c=!0,a.add(y);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static ECk(a,b,c){if(b.Cx)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.Rk)continue;f=f.node;const y=Ug.XM.Ayb(f);2!==y.specialIndentType||Xg.a.vz(c.value,y.mO)||f.setValue(sb.a.um,y.mO-y.yPb)}}static Vwl(a,b){let c=!0;b.contextId!==rb.a.paragraph?c=!1:M.a.instance.ga(14)&&Ug.ij.lGa(b)?(Ug.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),c=!1):Ug.mr()&&Ug.mr().instance&&Ug.mr().instance.qX(b)&&
(Ug.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,IF:c?32:8}}static OCh(a,b){let c=!0;b.contextId!==rb.a.image&&b.contextId!==rb.a.embeddedFile&&(c=!1);M.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,IF:c?32:8}}static fLj(a){if(!a.Cx)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).Rk){var c=a.getContext(f).node;if(c)if(c=zb.ParagraphReader.IL(c),!f)b=c;else if(c!==b)return!0}return!1}}Ug.kd=null;Ug.Um=null;Ug.TG=null;Object(m.a)(Ug,"FormattingActionHelper",
null,[]);class et extends bt.a{constructor(a,b,c,f,l,y,G,R){super();this.wuf=this.yC=null;this.init(a);this.$l("FormattingViewOperation");this.yFa(w.AFrameworkApplication.Qa,b,f,l,y);this.Rt=c;this.DNa=0;this.kB=!0;this.t0h=G;this.Um=R}get rta(){return this.Um.instance}run(){const a=this.Rt.view;var b=null;a.Uh&&(b=a.Nb);if(b){var c=b.Pa.nb;!c||M.a.instance.ga(14)&&et.ij.gre(c)?(et.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),this.kB=!1):this.rta&&this.rta.gBb(c)&&(et.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.externalSelection}),
this.kB=!1)}else et.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),this.kB=!1;1!==this.behavior&&this.kB||(this.kB&&(c=b.Pa.nb,1===b.Pa.length&&1===c.length&&Jb.SelectionEditor.tk(c.Ua)&&Ee.b(c.Ua)&&(et.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.nOc}),this.kB=!1)),(c=this.kB)&&this.actionId===C.a.rV&&((c=Za.AT(b.Pa.nb,wb.a.POf))||et.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.z5d})),this.np=c?32:8,this.DNa=3);0===this.DNa&&(kf.a.mark(5730),this.wuf=Ul.SelectionReferenceFactory.instance.Psa(),c=b.Pa.nb.Ua,this.yC=new pf.GraphTransaction(15),
this.yC.ld(c.node),this.DNa=1);if(1===this.DNa){this.ux||this.plb(this.Rt.RE);if(1===this.Ioa())return;this.DNa=2}if(2===this.DNa){if(this.actionId===C.a.rV)if(b=b.ak,b.Cx)for(c=0;c<b.length;c++){let f=b.getContext(c);this.XNh(f)}else this.XNh(b);b=this.actionId===C.a.e2||this.actionId===C.a.Hja||this.actionId===C.a.clearFormatting||this.actionId===C.a.IW;Ug.qcc(this.actionId)||this.wuf.hV(b);(b=Object(sa.a)(140,this.vd))&&!b.iba||t.FocusManager.instance().wf(a.$I);this.yC.dispose();this.yC=null;
Ug.qcc(this.actionId)||Sc.App.Mb.updateCommandUI();kf.a.mark(5731);this.DNa=3;this.np=32}3===this.DNa&&(this.t0h.process(this.actionId,this.Rt,this.behavior,this.response),this.eZ())}XNh(a){(Jb.SelectionEditor.ou(a)||Jb.SelectionEditor.nm(a))&&Sc.App.uS.oS(a.node)}static get ij(){return Mh.a.instance}static get Xc(){return cc.a.instance}}Object(m.a)(et,"FormattingViewOperation",bt.a,[]);var bR=d(489),cR=d(420);class Ld{constructor(a,b,c,f,l){this.jBa=new Eb.ScriptSharpLegacyMap;this.hul=y=>{y=jb.HyperlinkReader.Slj(y,
this.VD);for(let G of y)(y=G.paragraph)&&y.Sa&&(y=y.Sa.NT(G.Ra))&&y.formatting&&Ld.oh.auh(y.formatting)};this.F0h=a;this.Chf=b;this.qw=c;this.VD=f;if(!l)throw Error.argumentNull("interactiveViewManager");Ld.Pf=l;this.hqb=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("FontPreviewEnabled")}vb(){const a=w.AFrameworkApplication.Qa,b=Object(H.a)(this,this.C_k,"queryNonParagraphFormatting");M.a.instance.ga(105)&&(Ld.Fe?Ld.Fe.VFa(55):w.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(C.a.font,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.Xq,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.qH,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.fI,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.vr,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.IW,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.e2,rb.a.endOfParagraph,
Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.Hja,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.bold,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.setItalic,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.underline,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.wpa,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.superscript,rb.a.endOfParagraph,
Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.subscript,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.strikethrough,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.rt,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.rV,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP")),a.ya(C.a.clearFormatting,rb.a.endOfParagraph,Object(H.a)(this,this.nQ,"applyFormattingEOP"))):Sc.App.sdb&&(a.ya(C.a.font,
rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.Xq,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.vr,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.IW,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),Bb.ListReader.Gx&&(a.ya(C.a.bold,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.setItalic,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),
a.ya(C.a.superscript,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.subscript,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.strikethrough,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.rt,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP"))),M.a.instance.ga(94)||M.a.instance.ga(96))&&(a.ya(C.a.qH,rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")),a.ya(C.a.fI,
rb.a.endOfParagraph,Object(H.a)(this,this.Sca,"applyListFormattingEOP")));const c=Sc.App.NMa.KQf(f=>Ci.Jta(f.Pa,!0));a.ra(C.a.Rxd,rb.a.textRange,Object(H.a)(this,this.Rxd,"toggleChangeCase"),1028);M.a.instance.ga(77)||a.ya(C.a.pya,rb.a.table,Object(H.a)(this,this.j0k,"queryTableFormatting"));a.ya(C.a.hLb,rb.a.view,Object(H.a)(this,this.Glh,"queryCharacterFormatting"));a.ya(C.a.zTe,rb.a.view,Object(H.a)(this,this.Glh,"queryCharacterFormatting"));a.ya(C.a.pya,rb.a.view,c);a.ya(C.a.pya,rb.a.paragraph,
Object(H.a)(this,this.pya,"queryParagraphFormatting"));a.ya(C.a.pya,rb.a.image,Object(H.a)(this,this.s_k,"queryImageFormatting"));a.ya(C.a.pya,rb.a.unsupportedObject,b);a.ie(C.a.hLb,99|(M.a.instance.ga(7)?0:1028));a.ie(C.a.zTe,1127);a.ie(C.a.pya,97|(M.a.instance.ga(7)?0:1028));w.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(C.a.kLb,rb.a.view,c),a.ya(C.a.kLb,rb.a.paragraph,Object(H.a)(this,this.kLb,"queryParagraphIndentation")),a.ie(C.a.kLb,97|(M.a.instance.ga(7)?0:1028)));this.BC(a,C.a.font);
this.BC(a,C.a.Xq);this.hqb&&(this.BC(a,C.a.HKa),this.BC(a,C.a.W0a),this.BC(a,C.a.y6),this.BC(a,C.a.vLa));if(M.a.instance.ga(94)||M.a.instance.ga(96))this.BC(a,C.a.qH),this.BC(a,C.a.fI);a.rCa(C.a.T3f,rb.a.view,Object(H.a)(this,this.QVd,"applyCharacterFormattingViewAsync"));a.ie(C.a.T3f,1092);this.BC(a,C.a.vr);this.BC(a,C.a.IW);this.BC(a,C.a.e2);this.BC(a,C.a.O1b);this.BC(a,C.a.Rub);this.BC(a,C.a.Tub);this.BC(a,C.a.t8a);this.BC(a,C.a.P1b);this.BC(a,C.a.Hja);this.BC(a,C.a.bold);a.hlb(C.a.bold,Object(H.a)(this,
this.D$a,"generateActionArguments"));this.BC(a,C.a.setItalic);a.hlb(C.a.setItalic,Object(H.a)(this,this.D$a,"generateActionArguments"));this.BC(a,C.a.underline);a.hlb(C.a.underline,Object(H.a)(this,this.D$a,"generateActionArguments"));this.BC(a,C.a.wpa);this.BC(a,C.a.superscript);a.hlb(C.a.superscript,Object(H.a)(this,this.D$a,"generateActionArguments"));this.BC(a,C.a.subscript);a.hlb(C.a.subscript,Object(H.a)(this,this.D$a,"generateActionArguments"));this.BC(a,C.a.strikethrough);a.hlb(C.a.strikethrough,
Object(H.a)(this,this.D$a,"generateActionArguments"));this.BC(a,C.a.rt);a.hlb(C.a.rt,Object(H.a)(this,this.D$a,"generateActionArguments"));a.ra(C.a.Zbb,rb.a.textRange,Object(H.a)(this,this.TKc,"applyCharacterFormatting"),96);a.rCa(C.a.rV,rb.a.view,Object(H.a)(this,this.QVd,"applyCharacterFormattingViewAsync"));a.ya(C.a.rV,rb.a.paragraph,Object(H.a)(this,this.XVd,"applyParagraphFormatting"));a.ya(C.a.rV,rb.a.textRange,Object(H.a)(this,this.TKc,"applyCharacterFormatting"));a.ya(C.a.rV,rb.a.Mf,Object(H.a)(this,
this.RVd,"applyFormattingIp"));a.ya(C.a.clearFormatting,rb.a.view,Object(H.a)(this,this.cEi,"clearFormattingView"));a.ya(C.a.clearFormatting,rb.a.paragraph,Object(H.a)(this,this.bEi,"clearFormattingParagraph"));a.ya(C.a.clearFormatting,rb.a.textRange,Object(H.a)(this,this.TKc,"applyCharacterFormatting"));a.ya(C.a.clearFormatting,rb.a.Mf,Object(H.a)(this,this.RVd,"applyFormattingIp"));a.ie(C.a.clearFormatting,1028);a.ya(C.a.B8a,rb.a.textRange,Object(H.a)(this,this.B8a,"clearFormattingParagraphLevel"));
a.ya(C.a.B8a,rb.a.Mf,Object(H.a)(this,this.B8a,"clearFormattingParagraphLevel"));a.ya(C.a.j_d,rb.a.view,Object(H.a)(this,this.j_d,"clearFormattingMultiParagraphLevel"));a.ya(C.a.ZLa,rb.a.view,Ug.u8);a.ya(C.a.ZLa,rb.a.paragraph,Object(H.a)(this,this.XVd,"applyParagraphFormatting"));a.ya(C.a.ZLa,rb.a.image,Object(H.a)(this,this.zEf,"applyTextDirectionToImage"));a.ya(C.a.ZLa,rb.a.unsupportedObject,Object(H.a)(this,this.AEf,"applyTextDirectionToNonParagraph"));a.ie(C.a.ZLa,1028);a.ya(C.a.K1a,rb.a.view,
Ug.u8);a.ya(C.a.K1a,rb.a.paragraph,Object(H.a)(this,this.XVd,"applyParagraphFormatting"));a.ya(C.a.K1a,rb.a.image,Object(H.a)(this,this.zEf,"applyTextDirectionToImage"));a.ya(C.a.K1a,rb.a.unsupportedObject,Object(H.a)(this,this.AEf,"applyTextDirectionToNonParagraph"));a.ie(C.a.K1a,1028)}BC(a,b){a.rCa(b,rb.a.view,Object(H.a)(this,this.QVd,"applyCharacterFormattingViewAsync"));a.ya(b,rb.a.textRange,Object(H.a)(this,this.TKc,"applyCharacterFormatting"));a.ya(b,rb.a.Mf,Object(H.a)(this,this.RVd,"applyFormattingIp"));
a.ie(b,1028)}D$a(){return new Q(2)}Rxd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Ra,b.Lb-b.Ra);return Ld.Dre(a,0,a.length)?this.RMc(b,C.a.Rub):Ld.M7j(a)?this.RMc(b,C.a.t8a):this.RMc(b,C.a.Tub)}Glh(a,b,c,f,l){f=!0;b.contextId!==rb.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===C.a.zTe)a=l.formatting,l=l.G2l;else{if(!b.view||!b.view.Uh)return 2;b=b.view;if(!b.Nb||!b.Nb.Pa.nb)return 8;a=l;l=b.Nb.Pa}this.tHi(l,a);return 32}tHi(a,b){for(let l of a){a=l.Sl;for(let y of l){let G=null;if(y.contextId===
rb.a.textRange){if(Ee.b(y))continue;G=[];var c=y.node.Sa;if(c){var f=c.length-1;const R=y.Ra,ja=y.Lb;let za=!1;for(let Va=0;Va<f;Va++){const hb=c.ga(Va).cp,Cb=c.ga(Va+1).cp;if(c.ga(Va).formatting&&Math.max(hb,R)<Math.min(Cb,ja))za=!0,Array.add(G,c.ga(Va).formatting);else if(za)break}c.ga(f).formatting&&y.Lb>c.ga(f).cp&&Array.add(G,c.ga(f).formatting)}}else if(y.contextId===rb.a.paragraph){if(G=[],c=y.node.Sa)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(G,c.ga(f).formatting)}else if(y.contextId===
rb.a.endOfParagraph)G=[wb.a.Es(y)];else if(y.contextId===rb.a.Mf){this.ZZk(y,b);return}if(G&&0<G.length)for(const R of G)if(wb.a.nzd(b,R.cache,y,a))return}}}ZZk(a,b){var c=wb.a.Es(a);if(c){c=c.cache;var f=Ld.insertionPointFormatting.fJ(Ya.a.bold,c.isBold);b.bold=f?1:0;f=Ld.insertionPointFormatting.fJ(Ya.a.italic,c.isItalic);b.italic=f?1:0;f=Ld.insertionPointFormatting.fJ(Ya.a.underline,c.uE);b.underline=f?1:0;b.iw=Ld.insertionPointFormatting.fJ(Ya.a.iw,c.iw);f=Ld.insertionPointFormatting.fJ(Ya.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=Ld.insertionPointFormatting.fJ(Ya.a.subscript,c.dG);b.subscript=f?1:0;f=Ld.insertionPointFormatting.fJ(Ya.a.strikethrough,c.cG);b.strikethrough=f?1:0;f=Ld.insertionPointFormatting.fJ(V.a.rt,c.j0);b.rt=f?1:0;b.fontName=be.Font.OEa(Ld.insertionPointFormatting.fJ(Ya.a.font,c.BL));b.Rpa=c.DV;b.fontSize=this.qw.eab(Ld.insertionPointFormatting.fJ(Ya.a.fontSize,c.fontSize),a.node);b.fontColor=Ld.insertionPointFormatting.fJ(Ya.a.fontColor,c.fontColor);b.highlight=Ld.insertionPointFormatting.fJ(Ya.a.highlight,
c.highlight)}}QVd(a,b,c,f,l,y){return new et(a,b,c,f,l,y,this.F0h,Ld.mr())}TKc(a,b,c,f,l){f=!0;let y=b;b.contextId!==rb.a.textRange&&b.contextId!==rb.a.Mf?f=!1:(M.a.instance.ga(14)&&Ld.ij.Vua(y)&&(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),f=!1),Ld.mr()&&Ld.mr().instance&&Ld.mr().instance.qX(y)&&(f=!1),f&&Jb.SelectionEditor.tk(b)&&Ee.b(y)&&(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.nOc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===rb.a.Mf)return 2;this.qw.TDh(a)&&(b=Jb.SelectionEditor.VQb(y),Jb.SelectionEditor.Xg(b)||
(y=b));b=y.node;Ug.qcc(a)&&(b.Npa=!0);a==C.a.vr&&M.a.instance.ga(119)&&w.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.hul(y);Ld.I7e.UKc(y,G=>{this.Kyh(G,a,l,y.Lb)});Ug.qcc(a)&&(b.Npa=!1);this.KXj(a)&&this.RMc(y,a);return 32}wXc(a){if(!this.hqb||!a||!a.paragraph)return null;const b=Ld.Pf.Rd;if(!b)return null;a=Object(sa.a)(340,a.paragraph.rg(b.Na));return a?(a=Object(sa.a)(646,a))?a:null:null}MZc(a){return this.hqb&&!!a&&!!a.Ui}czh(a,b,c){if(a&&a.vd){var f=b.cache,
l=a.vd,y=-1;if("string"===typeof l)this.hqb&&c===C.a.y6&&this.n8a(b,f.BL,Ya.a.font),a=l;else if(this.hqb&&c===C.a.y6&&(this.n8a(b,f.BL,Ya.a.font),this.n8a(b,f.DV,sb.a.DV)),a=l.fontName,y=l.Rpa,be.Font.bWa()){this.hqb&&c===C.a.y6&&(this.n8a(b,f.isBold,Ya.a.bold),this.n8a(b,f.isItalic,Ya.a.italic));const G=1===l.bold;l=1===l.italic;if(G||l)Ld.oh.eI(b,G),Ld.oh.setItalic(b,l)}a=a.substr(0,31);Ld.oh.pV(b,a);M.a.instance.ga(53)&&(c===C.a.y6&&this.n8a(b,f.DV,sb.a.DV),Ld.oh.$La(b,y))}}n8a(a,b,c){this.jBa.Gb(a.Ke.cp)||
this.jBa.$(a.Ke.cp,new Eb.ScriptSharpLegacyMap);this.jBa.ga(a.Ke.cp).Gb(c)||this.jBa.ga(a.Ke.cp).$(c,b)}G7b(a,b){if(!this.jBa.Gb(a.Ke.cp))return null;const c=this.jBa.ga(a.Ke.cp).ga(b);this.jBa.ga(a.Ke.cp).remove(b);this.jBa.ga(a.Ke.cp).count||this.jBa.remove(a.Ke.cp);return c}Kyh(a,b,c,f){var l=a.cache,y=Object(sa.a)(140,c);switch(b){case C.a.bold:2===c.value&&(c.value=l.isBold?0:1);Ld.oh.eI(a,1===c.value);break;case C.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);Ld.oh.setItalic(a,1===c.value);
break;case C.a.underline:2===c.value&&(c.value=l.uE?0:1);Ld.oh.iZ(a,1===c.value);break;case C.a.wpa:Ld.oh.wpa(a,c);break;case C.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);Ld.oh.hZ(a,1===c.value);break;case C.a.subscript:2===c.value&&(c.value=l.dG?0:1);Ld.oh.M6(a,1===c.value);break;case C.a.strikethrough:2===c.value&&(c.value=l.cG?0:1);Ld.oh.gZ(a,1===c.value);break;case C.a.rt:2===c.value&&(c.value=l.j0?0:1);Ld.oh.qlb(a,1===c.value);break;case C.a.font:this.czh(y,a,C.a.font);break;case C.a.y6:c=
this.wXc(a);this.MZc(c)&&(this.czh(y,a,C.a.y6),c.AK(null));break;case C.a.vLa:c=this.wXc(a);this.MZc(c)&&(y=this.G7b(a,Ya.a.font))&&(l=this.G7b(a,Ya.a.bold),f=this.G7b(a,Ya.a.italic),l&&Ld.oh.eI(a,l),f&&Ld.oh.setItalic(a,f),y=y.substr(0,31),Ld.oh.pV(a,y),l=this.G7b(a,sb.a.DV),M.a.instance.ga(53)&&l&&Ld.oh.$La(a,l),c.AK(null));break;case C.a.vr:Ld.oh.vr(a,c,null);break;case C.a.IW:Ld.oh.IW(a);break;case C.a.e2:Ld.oh.qpa(a,c);break;case C.a.Hja:Ld.oh.m2b(a);break;case C.a.Xq:Ld.oh.Xq(a,y.vd);break;
case C.a.HKa:c=this.wXc(a);this.MZc(c)&&(this.n8a(a,l.fontSize,Ya.a.fontSize),Ld.oh.Xq(a,y.vd),c.AK(null));break;case C.a.W0a:c=this.wXc(a);this.MZc(c)&&(l=this.G7b(a,Ya.a.fontSize))&&(Ld.oh.Xq(a,l),c.AK(null));break;case C.a.qH:Ld.oh.gZc(a);break;case C.a.fI:Ld.oh.Ivd(a);break;case C.a.rV:l=M.a.instance.ga(20)?sb.a.noProof:we.a.zxa;Ld.oh.ttc(a,c.eb(Ya.a.At),f,c.sa(l,!1));break;case C.a.Zbb:Ld.oh.aOb(a);break;case C.a.clearFormatting:Ld.oh.aDa(a);break;case C.a.Rub:case C.a.Tub:case C.a.O1b:case C.a.t8a:case C.a.P1b:l.YUa&&
2===l.capitalization&&Ld.oh.d_d(a)}}B8a(a,b,c){a=!0;b.contextId!==rb.a.textRange&&b.contextId!==rb.a.Mf?a=!1:(M.a.instance.ga(14)&&Ld.ij.Vua(b)&&(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),a=!1),a&&Jb.SelectionEditor.tk(b)&&Ee.b(b)&&(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.nOc}),a=!1));if(1===c||!a)return a?32:8;Ld.paragraphEditor.r2b(b.node,!1);return 32}j_d(a,b,c,f,l){a={};a[qi.dqa]=6168;a[qi.cqa]=6169;const y=b.view;var G=null;y.yp&&(G=y);var R=!0;let ja=32;G&&(G=G.Nb.Pa.nb)&&M.a.instance.ga(14)&&(Ld.ij.gre(G)?
(Ld.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),ja=8,R=!1):1===c&&(ja=32,R=!1));R&&M.a.instance.ga(54)&&(R=new pf.GraphTransaction(1===c?3:15),R.ld(y.root),ja=qi.v6(C.a.B8a,b,c,f,l,a,12),R.dispose());return ja}RVd(a,b,c,f,l){var y=!0,G=32;b.contextId!==rb.a.Mf?y=!1:M.a.instance.ga(14)&&Ld.ij.Vua(b)&&(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),y=!1);if(1===c||!y)return y?32:8;c=b.node;y=null;if(M.a.instance.ga(54)&&M.a.instance.ga(61)&&a===C.a.clearFormatting){Ld.kq.fvb(c);Ld.paragraphEditor.IMf(c);const R=Ka.StyleReader.OL(c).oH(Ka.StyleReader.wNa);
Ld.GP.fba(R,c,!0)}if(a!==C.a.clearFormatting||M.a.instance.ga(49))y=Ld.insertionPointFormatting.M8b(b);if(y)G=ze.a.fSa(y),G=w.AFrameworkApplication.Qa.ii(G,a,2,!1,f,l);else switch(f=Object(sa.a)(140,l),b=wb.a.Es(b).cache,a){case C.a.font:f&&f.vd&&(l=f.vd,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.Rpa),Ld.insertionPointFormatting.wtd(b),M.a.instance.ga(53)&&Ld.insertionPointFormatting.$La(f));break;case C.a.vr:Ld.insertionPointFormatting.vr(l);break;case C.a.IW:Ld.insertionPointFormatting.IW();
break;case C.a.e2:Ld.insertionPointFormatting.qpa(l);break;case C.a.Hja:Ld.insertionPointFormatting.m2b();break;case C.a.Xq:Ld.insertionPointFormatting.Xq(f.vd);break;case C.a.qH:l=Ld.insertionPointFormatting.fJ(Ya.a.fontSize,b.fontSize);Ld.insertionPointFormatting.Xq(Ld.oh.qH(l));break;case C.a.fI:l=Ld.insertionPointFormatting.fJ(Ya.a.fontSize,b.fontSize);Ld.insertionPointFormatting.Xq(Ld.oh.fI(l));break;case C.a.bold:Ld.insertionPointFormatting.eI(!Ld.insertionPointFormatting.fJ(Ya.a.bold,b.isBold));
break;case C.a.setItalic:Ld.insertionPointFormatting.setItalic(!Ld.insertionPointFormatting.fJ(Ya.a.italic,b.isItalic));break;case C.a.underline:Ld.insertionPointFormatting.iZ(!Ld.insertionPointFormatting.fJ(Ya.a.underline,b.uE));break;case C.a.wpa:Ld.insertionPointFormatting.wpa(l);break;case C.a.superscript:Ld.insertionPointFormatting.hZ(!Ld.insertionPointFormatting.fJ(Ya.a.superscript,b.isSuperscript));break;case C.a.subscript:Ld.insertionPointFormatting.M6(!Ld.insertionPointFormatting.fJ(Ya.a.subscript,
b.dG));break;case C.a.strikethrough:Ld.insertionPointFormatting.gZ(!Ld.insertionPointFormatting.fJ(Ya.a.strikethrough,b.cG));break;case C.a.rt:Ld.insertionPointFormatting.qlb(!Ld.insertionPointFormatting.fJ(V.a.rt,b.j0));break;case C.a.clearFormatting:Ld.insertionPointFormatting.R0a();M.a.instance.ga(54)||(Ld.kq.fvb(c),Ld.paragraphEditor.r2b(c,!0),M.a.instance.ga(71)&&Ld.GP.pNc(c));break;case C.a.rV:l.Ta(Ya.a.At)&&Ld.insertionPointFormatting.rV(l.eb(Ya.a.At)),b=M.a.instance.ga(20)?sb.a.noProof:we.a.zxa,
l.Ta(b)&&Ld.insertionPointFormatting.frl(l.eb(b))}Ug.qcc(a)||Sc.App.Mb.updateCommandUI();return G}kal(a,b){C.a.clearFormatting===b&&rc.OutlineElementNavigator.AB(a).properties.removeProperty(Ya.a.PY)}nQ(a,b,c,f,l){f=Ld.Xc.eq(C.a.kpl);var y=!0;b.contextId!==rb.a.endOfParagraph&&(y=!1);if(1===c||!y)return y?32:8;c=b.node;b=ub.GraphIterator.pb(b.node);b.kf();y=b.dla(4);if((b=!!y&&Ld.Vf.Aea(y))&&!Sc.App.sdb)return 8;const G=!zb.ParagraphReader.textLength(c);f.properties.$("Action",a.toString());f.properties.$("ListContext",
b.toString());f.properties.$("IsEmptyParagraph",G.toString());ha.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,G);this.Chf.KIh(b)?this.zQh(a,l,y):(b=c.Sa.last,this.kal(c,a),y=b.formatting,c=Ld.characterPropertiesEditor.N6d(c),this.Chf.msg(y)&&(c.ge(c.Ke),this.Kyh(c,a,l,b.cp)));f.end();return 32}zQh(a,b,c){const f=Object(sa.a)(140,b);switch(a){case C.a.vr:Ld.Iea.vr(c,b);break;case C.a.Xq:Ld.Iea.Xq(c,f.vd);break;case C.a.IW:Ld.Iea.IW(c);break;
case C.a.qH:Ld.Iea.qH(c);break;case C.a.fI:Ld.Iea.fI(c);break;case C.a.font:Ld.Iea.Lpl(c,f.vd);break;case C.a.bold:a=this.MMb(b,Ya.a.bold,c);Ld.Iea.eI(c,a);break;case C.a.setItalic:a=this.MMb(b,Ya.a.italic,c);Ld.Iea.setItalic(c,a);break;case C.a.subscript:a=this.MMb(b,Ya.a.subscript,c);Ld.Iea.M6(c,a);break;case C.a.superscript:a=this.MMb(b,Ya.a.superscript,c);Ld.Iea.hZ(c,a);break;case C.a.strikethrough:a=this.MMb(b,Ya.a.strikethrough,c);Ld.Iea.gZ(c,a);break;case C.a.rt:a=this.MMb(b,V.a.rt,c),Ld.Iea.qlb(c,
a)}}MMb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}Sca(a,b,c,f,l){f=!0;const y=ub.GraphIterator.pb(b.node);y.kf();b.contextId===rb.a.endOfParagraph&&y.dla(4)||(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.pte}),f=!1);b=y.currentNode;if(!Ld.Vf.Aea(b))return 8;if(1===c||!f)return f?32:8;this.zQh(a,l,b);return 32}pya(a,b,c,f,l){a=!0;b.contextId!==rb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.Vl?l.Vl!==zb.ParagraphReader.IL(c)&&(l.Vl=0):l.Vl=zb.ParagraphReader.IL(c);M.a.instance.ga(54)&&
(M.a.instance.ga(59)||M.a.instance.ga(34))&&(a=Ld.XM.Ayb(c),l.FB?(!l.l1l&&this.gLj(l.FB,a)&&2===l.FB.specialIndentType&&(l.FB.specialIndentType=0),l.FB.I_c===a.I_c&&Xg.a.vz(l.FB.mO,a.mO)||(l.FB.mO=Number.MAX_VALUE),l.FB.K_c===a.K_c&&Xg.a.vz(l.FB.oAb,a.oAb)||(l.FB.oAb=Number.MAX_VALUE)):l.FB=a,b=Ld.Cm.xFf(b.RE),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=bR.WordSectionNavigator.instance.fLe(b),void 0!==b&&null!==b&&(b=Ld.Gbf.eua(b)-(Ld.Gbf.Bce(b)+Ld.Gbf.Cce(b)+Sc.App.GZl),a.J_c=b-a.mO,
a.H_c=b-a.oAb,l.FB.H_c=Math.min(l.FB.H_c,a.H_c),l.FB.J_c=Math.min(l.FB.J_c,a.J_c)))));if(M.a.instance.ga(54)&&M.a.instance.ga(59)||M.a.instance.ga(84))b=Ld.Sbk.fX(c),l.spacing?(l.spacing.beforeSpacing=Ld.XBf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=Ld.XBf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.unit===b.lineSpacing.unit&&Xg.a.vz(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.unit=0,l.spacing.lineSpacing.value=0)):l.spacing=b;b=
new ub.GraphIterator;b.set(c);b.rc(11);if(c=b.Jg(11))l.isRtl=he.OutlineElementReader.Jm(c);c=Ld.Vf.Hv(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=Ld.Ihj(l.listType,b);l.mU=16===l.listType?null:c;return 32}gLj(a,b){return this.REf(a,b)||this.REf(b,a)}REf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}C_k(a,b,c,f,l){a=rc.OutlineElementNavigator.AB(b.node);l.isRtl=he.OutlineElementReader.Jm(a);return 32}AEf(a,b,c){if(a===C.a.K1a)a=!0;else if(a===C.a.ZLa)a=
!1;else return 2;a&&this.due(b);if(1===c)return 32;b=rc.OutlineElementNavigator.AB(b.node);Ld.Xh.VLa(b,a);return 32}s_k(a,b,c,f,l){a=b.node;b=rc.OutlineElementNavigator.AB(a);l.isRtl=he.OutlineElementReader.isRtl(b);l.Vl=ba.ImageReader.IL(a);return 32}j0k(a,b,c,f,l){a=b.node;b=rc.OutlineElementNavigator.AB(a);l.isRtl=he.OutlineElementReader.isRtl(b);l.Vl=Hd.TableReader.IL(a);if(-1===l.Vl||0===l.Vl)l.Vl=l.isRtl?3:1;return 32}zEf(a,b,c){if(!({IF:c}=Ug.OCh(c,b)).returnValue)return c;c=b.node;switch(a){case C.a.ZLa:case C.a.K1a:c=
rc.OutlineElementNavigator.AB(c);let f=!0;a===C.a.ZLa&&(f=!1);Ld.Xh.VLa(c,f);f&&this.due(b)}return 32}XVd(a,b,c,f,l){let y;if(!({IF:y}=Ug.Vwl(c,b)).returnValue)return y;const G=b.node;switch(a){case C.a.ZLa:Ld.Xh.BOb(G,!1);break;case C.a.K1a:this.due(b);Ld.Xh.BOb(G,!0);break;case C.a.rV:y=w.AFrameworkApplication.Qa.ii(b.RE,a,c,!0,f,l),32===y&&zb.ParagraphReader.Im(b)&&Ld.Upc&&Ld.Upc.oS(G)}return 32}cEi(a,b,c,f,l){const y={};y[qi.dqa]=6168;y[qi.cqa]=6169;var G=b.view;const R=new pf.GraphTransaction(1===
c?3:15);R.ld(G.root);let ja=qi.v6(a,b,c,f,l,y,0),za=null;G.yp&&(za=G);G=!0;let Va=null;za&&(Va=za.Nb.Pa.nb)&&M.a.instance.ga(14)&&(Ld.ij.gre(Va)?(Ld.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),ja=8,G=!1):1===c&&(ja=32,G=!1));G&&this.R7j(Va)&&(ja=M.a.instance.ga(54)?qi.v6(C.a.B8a,b,c,f,l,y,12):qi.v6(a,b,c,f,l,y,12));R.dispose();return ja}bEi(a,b,c){a=!0;b.contextId!==rb.a.paragraph&&b.contextId!==rb.a.Mf?a=!1:M.a.instance.ga(14)&&Ld.ij.lGa(b)&&(Ld.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),a=!1);if(1===c||!a)return a?
32:8;b=b.node;c=new pf.GraphTransaction(15);c.ld(b);Ld.kq.fvb(b);Ld.paragraphEditor.r2b(b,!0);Ld.GP.pNc(b);c.dispose();return 2}kLb(a,b,c,f,l){a=b.contextId===rb.a.paragraph;if(1===c&&!a)return 8;l.FB||(b=b.node,c=Ld.XM.Ayb(b),l.FB=c,c=new ub.GraphIterator,c.set(b),c.rc(11),b=c.Jg(11),l.isRtl=b?he.OutlineElementReader.Jm(b):!1);return 32}R7j(a){return!a||Jb.SelectionEditor.Ex(a)||1===a.length&&Jb.SelectionEditor.tk(a.Ua)&&!Jb.SelectionEditor.eBb(a.Ua)?!1:!0}due(a){Ld.Rtf.Gb(a.contextId)||(ha.ULS.sendTraceTag(42276747,
340,50,"RTL Usage : {0}",a.contextId),Ld.Rtf.$(a.contextId,!0))}KXj(a){return a===C.a.O1b||a===C.a.Rub||a===C.a.Tub||a===C.a.t8a||a===C.a.P1b}RMc(a,b){const c=a.node;b=Ld.UJl(c.characterData.substr(a.Ra,a.Lb-a.Ra),b);c.characterData=c.characterData.substr(0,a.Ra)+b+c.characterData.substr(a.Lb);return 32}static get oh(){return Ld.Jf||(Ld.Jf=Fb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Ld.mh||(Ld.mh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Ld.qx||
(Ld.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}static get Sbk(){return Ld.iPa||(Ld.iPa=Fb.a.instance.resolve("Box4.ILineSpacingHelper"))}static get GP(){return Ld.eL||(Ld.eL=Fb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Xh(){return Ld.Mi||(Ld.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return Ld.Ut||(Ld.Ut=Fb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Iea(){return Ld.Eqb||(Ld.Eqb=Fb.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get XM(){return Ld.TG||
(Ld.TG=Fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static mr(){return Ld.Um||(Ld.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static get Cm(){return Th.ContextSetEditor.instance}static get ij(){return Mh.a.instance}static get Xc(){return cc.a.instance}static get Fe(){return Ld.kd||(Ld.kd=Fb.a.instance.rb("Box4.IFeatureHelper"))}static get Upc(){return Sc.App.uS}static get Xf(){return Ld.hd||(Ld.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g7(){return Ld.pp||
(Ld.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get I7e(){return Ld.qQa||(Ld.qQa=Fb.a.instance.resolve("Box4.TextFormattingHelper"))}static get Vf(){return Ld.fh||(Ld.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static get kq(){return Ld.lp||(Ld.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}static get Gbf(){return cR.a.instance}static Ihj(a,b){return 42===a?b:a!==b||16===a?16:a}static XBf(a,b){a.ipg||(b.ipg?b=a:b.unit===a.unit&&Xg.a.vz(b.value,
a.value)||(b.value=-1));return b}static UJl(a,b){switch(b){case C.a.Rub:return a.toLowerCase();case C.a.Tub:return a.toUpperCase();case C.a.O1b:case C.a.t8a:return Ld.sBi(a,b===C.a.t8a);case C.a.P1b:return Ld.ALl(a);default:return a}}static ALl(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static sBi(a,b){let c,f,l=!0,y=a.length,G=0,R=Ld.Dre(a,G,y);for(;0<y;){f=c=!1;var ja=y;let Va;var za=void 0;for(za=
0;0<ja&&Ld.eDi(a.charAt(G+za));za++,ja--)f=Ld.U3c(a.charAt(G+za));for(Va=za;0<ja&&!(c=Ld.U3c(a.charAt(G+za)))&&" "!==a.charAt(G+za)&&"/"!==a.charAt(G+za);za++,ja--);ja=za-Va;if(0>=ja)break;G+=Va;za=a.substr(G,ja);za=za===za.toUpperCase();if(R||!za)a=l||f||b?a.substr(0,G)+a.charAt(G).toUpperCase()+a.substr(G+1,ja-1).toLowerCase()+a.substr(G+ja):a.substr(0,G)+a.substr(G,ja).toLowerCase()+a.substr(G+ja);y-=ja+Va;G+=ja;if(l=c)G++,y--,R=Ld.Dre(a,G,y)}return a}static Dre(a,b,c){for(;0<c&&!Ld.U3c(a.charAt(b));){if(a.charAt(b)!==
a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static M7j(a){for(var b=0;b<a.length&&!Ld.U3c(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static U3c(a){return"."===a||"!"===a||"?"===a?!0:!1}static eDi(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}Ld.Jf=null;Ld.Mi=null;Ld.Rtf=new rj.a;Ld.Pf=null;Ld.iPa=null;Ld.mh=null;Ld.qx=null;Ld.eL=null;Ld.Ut=null;Ld.Eqb=null;Ld.TG=null;Ld.Um=null;Ld.kd=null;Ld.hd=null;Ld.pp=null;Ld.qQa=null;Ld.fh=
null;Ld.lp=null;Object(m.a)(Ld,"TextFormattingActor",null,[]);class dJ{constructor(a){this.Ca=a}get un(){return this.Ca}aOb(a,b=!1){this.un.ii(a,C.a.Zbb,2,!0,null,b)}rV(a){this.un.Ja(C.a.rV,2,a)}}Object(m.a)(dJ,"TextFormattingCommands",null,[528]);class pu{get dqa(){return qi.dqa}get cqa(){return qi.cqa}get VRb(){return qi.VRb}v6(a,b,c,f,l,y,G){return qi.v6(a,b,c,f,l,y,G)}$ib(a,b,c,f,l,y){return qi.$ib(a,b,c,f,l,y)}static get instance(){pu.La||(pu.La=new pu);return pu.La}}pu.La=null;Object(m.a)(pu,
"ViewActionHandlerProxy",null,[632]);class eJ{constructor(a){this.Ca=a}get un(){return this.Ca}YAk(a){if(4===a)a=C.a.leftArrow;else if(2===a)a=C.a.rightArrow;else if(1===a)a=C.a.upArrow;else if(3===a)a=C.a.downArrow;else return;this.un.processAction(a,2)}qta(){this.un.processAction(C.a.qta,2)}}Object(m.a)(eJ,"SelectionCommands",null,[527]);class fJ{Qg(a,b){return Vd.SelectionFactory.Qg(a,b)}aO(a,b){return Vd.SelectionFactory.aO(a,b)}Qu(a,b=!0){return Vd.SelectionFactory.Qu(a,b)}R3(a,b,c){return Vd.SelectionFactory.R3(a,
b,c)}rl(a){return Vd.SelectionFactory.rl(a)}ZQb(a,b,c=!1){return Vd.SelectionFactory.ZQb(a,b,c)}}Object(m.a)(fJ,"SelectionFactoryProxy",null,[515]);var dR=d(900),Gx=d(252),qz=d(1039);class gJ extends qz.a{constructor(a,b,c,f,l,y,G=null,R=null){super(a,y,G,R);this.Ao=this.qx=this.b3=null;this.Kqa=!1;this.z4a=w.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.F5a=0;this.WQd=new Oa.a;lf.a(8128527,307,he.OutlineElementReader.hh(a));this.FF=b;this.FF.Ytb(this);this.NHd=c;this.lp=
f;this.fh=l;this.MSk=R;this.cNd=Bb.ListReader.Hk(this.zb)}get y9(){return this.b3||(this.b3=Fb.a.instance.rb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.qx||(this.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}get oSa(){return null}get V8a(){return this.cNd&&!this.FF.uda}get j9a(){return 0<this.F5a}get Jv(){return this.NHd}get kq(){return this.lp}get Vf(){return this.fh}get ELc(){return this.MSk}E1(a,b){if(!this.KZ.E9e(b)){lf.a(8701077,307,zb.ParagraphReader.vl(this.zb));var c=
this.zb.currentNode,f=bb.a.eSa(c);this.z4a&&this.Ao.y$a&&(c=c.Sa.last,this.Kqa&&(c.formatting=this.Ao.y$a.ge(c),this.Kqa=!1),a=this.KZ.Hge(a,b),this.KZ.spa(this.zb.currentNode,this.Ao.qga,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}roa(){lf.a(8701078,307,zb.ParagraphReader.vl(this.zb));const a=bb.a.eSa(this.zb.currentNode);this.characterPropertiesEditor.a0c(a,b=>new Iv.a(b,Iv.a.gQc),Kf.AParagraphNode.L_)}C_a(){}poa(){this.z4a&&(this.Kqa=!0)}Exa(){lf.a(8701079,307,zb.ParagraphReader.vl(this.zb))}Dxa(){lf.a(8701080,
307,zb.ParagraphReader.vl(this.zb))}QA(a){this.FF.uda||(this.z4a?(this.JVd(a),this.Ao.ryd(this.zb.currentNode),a&&"P"===a.ZU.J$b&&this.ELc.TLa(this.zb.currentNode,this.Ao.Mld),this.KZ.spa(this.zb.currentNode,this.Ao.qga,a)):this.ksi(a))}PA(){this.FF.uda||this.a4()}Jxa(){}ZJa(){}uoa(){lf.a(8701081,307,he.OutlineElementReader.hh(this.zb)||uj.OutlineReader.pu(this.zb)||zb.ParagraphReader.vl(this.zb)&&this.FF.uda);let a=!1;this.j9a||(a=this.V8a||!0);a||(this.ZM+=1);this.F5a++}soa(){this.F5a--;let a=!1;
this.j9a||(a=this.V8a||!0);a||--this.ZM}Ixa(a){lf.a(8701082,307,he.OutlineElementReader.hh(this.zb)||uj.OutlineReader.pu(this.zb)||zb.ParagraphReader.vl(this.zb)&&this.FF.uda);lf.a(8701083,307,0!==a.listStyleType)}toa(){lf.a(8701084,307,he.OutlineElementReader.hh(this.zb)||zb.ParagraphReader.vl(this.zb)&&this.FF.uda);this.FF.uda||lf.a(8701085,307,this.zb.kJ(2))}NY(a){this.FF.NY(a)}KY(){this.FF.KY()}cyd(a){this.WQd.add(a)}MY(a){this.FF.MY(a)}LY(){this.FF.LY()}JY(a){this.FF.JY(a)}IY(){this.FF.IY()}ksi(a){this.vIb(!1);
(new ub.GraphIterator).Tc(this.zb);a=qz.a.Xh.pda(this.zb,this.kUa(a));lf.a(8128534,307,a===this.zb.currentNode);lf.a(8128535,307,zb.ParagraphReader.fe(a))}a4(){lf.a(8128536,307,zb.ParagraphReader.vl(this.zb));rc.OutlineElementNavigator.Se(this.zb)}reset(){this.z4a&&(super.reset(),this.Ao=this.Oae(!0))}JVd(a){this.vIb(!1);(new ub.GraphIterator).Tc(this.zb);a=qz.a.Xh.pda(this.zb,this.kUa(a));lf.a(36577367,307,a===this.zb.currentNode);lf.a(36577368,307,zb.ParagraphReader.fe(a));-1!==this.Ao.vE&&this.paragraphEditor.pK(a,
this.Ao.vE);this.Ao.lineSpacing&&this.ELc.f2(a,this.Ao.lineSpacing);this.Ao.Wga&&this.ELc.LAh(a,this.Ao.Wga);this.Ao.E5c&&this.ELc.Dzh(a,this.Ao.E5c);this.Kqa=!0;this.Ao.paragraph=a}static l1d(a,b){let c=0;switch(b){case 3:c=Oe.a.yua(a);break;case 7:c=ve.a.tga(a,0);break;case 1:c=Oe.a.wZd(a);break;case 5:c=Oe.a.yua(Oe.a.Mmd(a));break;default:ha.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(m.a)(gJ,"TextOnlyBox4PasteSteward",
qz.a,[]);class DC{constructor(a,b,c,f){this.CXb=a;this.lp=b;this.fh=c;this.KZ=f}create(a,b,c,f,l=null,y=null){return 1===a?new gJ(b,f,this.CXb,this.lp,this.fh,l,y,this.KZ):new Gx.Box4PasteSteward(b,c,f,this.CXb,this.lp,this.fh,l,y,this.KZ)}}Object(m.a)(DC,"Box4PasteStewardFactory",null,[564]);class eh{static get iNj(){return eh.C1h}static get oNj(){return eh.F1h}static get nNj(){return eh.E1h}static JYk(a,b){const c=a.currentNode;ae.forEachCell(a,b.rowSpan,b.colSpan,(f,l,y)=>{const G=f.currentNode;
G!==c&&(G.isGhostCell=!0,eh.TUf(f),!y&&1<=b.colSpan&&(G.colSpan=b.colSpan),eh.izh(f,b.X6,l,y,b.rowSpan,b.colSpan))})}static cZk(a,b){ae.forEachCell(a,b.rowSpan,b.colSpan,c=>{eh.opi(c);eh.TUf(c)})}static opi(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.Vlb=!0}static TUf(a){a&&(a.Db(1),Object(Sa.a)(FI.a,a.currentNode)&&a.Qi())}static Fpi(a,b,c){0<b&&(a=Object(sa.a)(Fx.TableCellNode,a.currentNode))&&(a.width=c?b:ve.a.gf(b,0))}static Ooi(a,b,c){if(a=Object(sa.a)(Ey.a,a.currentNode))0<b&&(a.um=
ve.a.tga(b,0)),0<c&&(a.QY=ve.a.tga(c,0))}static DEf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(sb.a.V6e,eh.oNj[b+""])}static oEf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(Ya.a.OMc,parseInt(Gx.Box4PasteSteward.X8a(b),16))}static Qzj(a){const b=new ub.GraphIterator;b.Tc(a);return(a=Sg.OutlineNavigator.hrd(b))&&uj.OutlineReader.pu(b)?a.Sh(sb.a.YR)-a.Sh(sb.a.marginLeft)-a.Sh(sb.a.marginRight):0}static J5j(a){return!(void 0===a||null===a||1===a)}static bol(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=Oe.a.Lmd(.25);break;case "initial":case "medium":b=Oe.a.Lmd(.5);break;case "thick":b=Oe.a.Lmd(1);break;default:b=eh.Twj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static l0e(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,eh.nNj[b+""])}static aol(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(Gx.Box4PasteSteward.X8a(b),16))}static Twj(a,b,c){let f=0;const l=({unit:a}=Gx.Box4PasteSteward.Wld(a)).returnValue;
switch(a){case 5:f=Oe.a.Lmd(l);break;case 1:f=Oe.a.aBi(l);break;case 3:f=Oe.a.llg(l);break;case 7:f=ve.a.fTk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static Uwj(a,b){let c=0;const f=({unit:a}=Gx.Box4PasteSteward.Wld(a)).returnValue;switch(a){case 5:c=Oe.a.VH(f);break;case 1:c=Oe.a.bBi(f);break;case 3:c=Oe.a.iX(f);break;case 7:c=ve.a.gf(f,b)}return c}static htd(a,b,c,f,l,y,G){if(l&&(!G||16===l.Bi||G||14!==l.Bi)&&12!==c){if(G)switch(f){case 7:f=sb.a.CJh;var R=sb.a.EJh;var ja=sb.a.DJh;
var za=0;break;case 6:f=sb.a.zJh;R=sb.a.BJh;ja=sb.a.AJh;za=1;break;case 0:f=sb.a.pJh;R=sb.a.rJh;ja=sb.a.qJh;za=0;break;case 5:f=sb.a.wJh;R=sb.a.yJh;ja=sb.a.xJh;za=1;break;default:return}else switch(f){case 7:f=sb.a.yIl;R=sb.a.AIl;ja=sb.a.zIl;za=0;break;case 6:f=sb.a.vIl;R=sb.a.xIl;ja=sb.a.wIl;za=1;break;case 0:f=sb.a.pIl;R=sb.a.rIl;ja=sb.a.qIl;za=0;break;case 5:f=sb.a.sIl;R=sb.a.uIl;ja=sb.a.tIl;za=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(eh.J5j(c)?(eh.aol(f,a,l),eh.l0e(R,
c,l),eh.bol(ja,b,c,za,l)):y||G||l.currentNode.properties.setValue(R,"nil"))}}static izh(a,b,c,f,l,y){f||(eh.iEf(b,a,!1,!1),eh.$Vd(b,a,!0,!1));f===y-1&&eh.$Vd(b,a,!0,!1);c||eh.BEf(b,a,!0,!1);c===l-1&&eh.cEf(b,a,!0,!1)}static aEf(a,b,c,f){a&&(eh.BEf(a,b,c,f),eh.$Vd(a,b,c,f),eh.cEf(a,b,c,f),eh.iEf(a,b,c,f))}static BEf(a,b,c,f){eh.htd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static $Vd(a,b,c,f){eh.htd(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static cEf(a,b,
c,f){eh.htd(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static iEf(a,b,c,f){eh.htd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static itd(a,b,c){if(c&&16===c.Bi&&""!==a){switch(b){case 3:b=sb.a.gQb;var f=0;break;case 2:b=sb.a.fQb;f=1;break;case 0:b=sb.a.cQb;f=0;break;case 1:b=sb.a.dQb;f=1;break;default:return}(a=eh.Uwj(a,f))&&c.currentNode.properties.setValue(b,a)}}static yoi(a,b){b&&(eh.Api(b,a),eh.ipi(b,a),eh.zoi(b,a),eh.Uoi(b,a))}static Api(a,b){eh.itd(a.WAi,
3,b)}static ipi(a,b){eh.itd(a.VAi,2,b)}static zoi(a,b){eh.itd(a.TAi,0,b)}static Uoi(a,b){eh.itd(a.UAi,1,b)}}eh.PBk=8;eh.dVi="Table Grid";eh.C1h=ta.a.kI("MsoNormalTable","Normal Table","MsoTableGrid",eh.dVi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1",
"MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4",
"Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1",
"Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4",
"Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5",
"MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6",
"MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2",
"List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6",
"List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2",
"MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4",
"List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5",
"List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");eh.F1h=ta.a.kI("0","center","1","top","2","center","3","bottom");eh.E1h=ta.a.kI("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(m.a)(eh,"Box4TableStewardHelper",null,[]);class Hx{constructor(a,b,c,f=!1,l=!1,y=!1){this.kw=null;this.G5a=0;this.zb=a;this.kq=b;this.Yq=c;this.gsb=f;this.MXb=l;this.$Md=
y}Ytb(a){this.kw=a}get uda(){return 0<this.G5a}NY(a){lf.a(7869459,307,!!this.kw);lf.a(7869460,307,he.OutlineElementReader.hh(this.zb)||uj.OutlineReader.pu(this.zb));lf.c(38563978,307,50,"Table pasting started");this.kw.vIb(!0);const b=new ub.GraphIterator;b.Tc(this.zb);Object(sa.a)(String,eh.iNj[a.sIh]);const c=this.Yq.a6k(this.zb,a.jV,a.Dsa,this.kw.kUa(a),a.Cog);if(this.gsb&&(lf.c(23938568,307,50,a.SRa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.S6e&&eh.aEf(a.S6e,this.zb,
!1,!0),eh.Ooi(this.zb,a.fje.kEl,a.fje.jEl),a.SRa)){var f=0;const R=Array(a.SRa.length);var l=0;a.qGa&&M.a.instance.ga(63)&&(l=(l=Oe.a.iOh(eh.Qzj(this.zb)))?l:1);for(var y=0;y<a.SRa.length;y++)R[y]=0<l?l/100*a.SRa[y]:ve.a.gf(a.SRa[y],0),f+=R[y];l=c.eb(Ya.a.gv);var G=new ub.GraphIterator;G.Tc(this.zb);a=0;if(Oc.isInTableCell(G)){if(l=ae.returnToContainingCell(G))a=l.width;y=eo.a(G);G=ae.returnToContainingTable(G);if(-1!==y&&y<=G.URa.length){let ja=0;for(let za=y;za<y+l.colSpan&&za<G.URa.length;za++)ja+=
G.URa[za];a=Math.min(a,ja);a===ja&&(a-=ve.a.gf(eh.PBk,0))}}else if(l)for(y=0;y<l.length;y++)a+=l[y];if(0<a&&f>a&&f)for(f=a/f,a=0;a<R.length;a++)R[a]*=f;c.setValue(Ya.a.gv,R)}this.kw.WKc(b,!1);this.G5a++;M.a.instance.ga(63)&&Bb.ListReader.Hk(b)&&this.kw.cyd(b.currentNode);lf.a(7869461,307,Hd.TableReader.jq(this.zb))}KY(){lf.a(7869462,307,!!this.kw);lf.a(7869463,307,Dk.l(this.zb));lf.c(38563979,307,50,"Table pasting finished");rc.OutlineElementNavigator.Se(this.zb);this.G5a--}MY(a){lf.a(7869464,307,
!!this.kw);Hd.TableReader.jq(this.zb)?ae.moveToFirstRow(this.zb):Dk.l(this.zb)&&ae.moveToNextRow(this.zb);this.gsb&&a.height&&this.zb.currentNode.setValue(sb.a.Ku,ve.a.gf(a.height,1));lf.a(7869465,307,Dk.l(this.zb))}LY(){lf.a(7869466,307,!!this.kw);lf.a(7869467,307,Oc.isTableCell(this.zb));ae.returnToContainingRow(this.zb)}JY(a){lf.a(7869468,307,!!this.kw);lf.a(7869469,307,!this.kw.ZM);Dk.l(this.zb)?ae.moveToFirstColumn(this.zb):Oc.isTableCell(this.zb)?ae.moveToNextColumn(this.zb):lf.a(7869471,307,
!1);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");if(this.MXb){if(!this.zb.currentNode)return;var b=Object(sa.a)(Fx.TableCellNode,this.zb.currentNode);lf.a(50689760,307,!b&&16!==this.zb.currentNode.type||!!b&&16===this.zb.currentNode.type);if(!b)return;let c=new ub.GraphIterator;c.Tc(this.zb);if(!a.colSpan||!a.rowSpan)return;if(a.eCb){eh.cZk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=ae.returnToContainingTable(c);if(!f)return;f.setValue(sb.a.complexTable,
!0);c.Tc(this.zb);eh.JYk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.gsb&&(eh.oEf(this.zb,a.Utc),eh.DEf(this.zb,a.verticalAlignment),this.$Md&&eh.yoi(this.zb,a.Swd));this.MXb&&eh.aEf(a.X6,this.zb,!a.colSpan&&!a.rowSpan,!1);this.gsb&&(this.MXb||(b=new ub.GraphIterator,b.Tc(this.zb),ae.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{eh.oEf(c,a.Utc);eh.DEf(c,a.verticalAlignment);eh.izh(c,a.X6,f,l,a.rowSpan,a.colSpan)})),eh.Fpi(this.zb,a.width,a.qGa));lf.a(7869472,307,uj.OutlineReader.pu(this.zb))}IY(){lf.a(7869473,
307,!!this.kw);lf.a(7869474,307,he.OutlineElementReader.hh(this.zb)||Oc.isTableCell(this.zb));ae.returnToCell(this.zb);lf.a(7869475,307,0>=this.kw.ZM);this.kw.m_d()}static get Xh(){return Hx.Mi||(Hx.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}}Hx.Mi=null;Object(m.a)(Hx,"Box4TableSteward",null,[332,333]);class qu{constructor(a,b,c){this.kw=null;this.G5a=0;this.zb=a;this.kq=b;this.Yq=c}Ytb(a){this.kw=a}get uda(){return 0<this.G5a}NY(){this.uda&&(lf.a(8787101,307,zb.ParagraphReader.vl(this.zb)),
rc.OutlineElementNavigator.Se(this.zb));lf.a(8701086,307,!!this.kw);lf.a(8701087,307,he.OutlineElementReader.hh(this.zb)||uj.OutlineReader.pu(this.zb));this.G5a++}KY(){lf.a(8701088,307,!!this.kw);rc.OutlineElementNavigator.Se(this.zb);this.G5a--;if(this.uda){this.kw.vIb(!0);const a=qu.Xh.pda(this.zb);lf.a(8787102,307,a===this.zb.currentNode);lf.a(8787103,307,zb.ParagraphReader.vl(this.zb))}}MY(a){lf.a(8701089,307,!!this.kw);this.kw.vIb(!0);const b=new ub.GraphIterator;b.Tc(this.zb);this.kw.WKc(b,
!1);M.a.instance.ga(63)&&Bb.ListReader.Hk(b)&&this.kw.cyd(b.currentNode);a=qu.Xh.pda(this.zb,this.kw.kUa(a));lf.a(8701090,307,a===this.zb.currentNode);lf.a(8701091,307,zb.ParagraphReader.vl(this.zb))}LY(){lf.a(8701120,307,!!this.kw);lf.a(8701121,307,zb.ParagraphReader.vl(this.zb));rc.OutlineElementNavigator.Se(this.zb)}JY(){lf.a(8701122,307,!!this.kw);lf.a(8701123,307,zb.ParagraphReader.vl(this.zb));lf.a(8701124,307,!this.kw.ZM);var a=this.zb.currentNode;zb.ParagraphReader.textLength(a)&&(a=bb.a.eSa(a),
this.kw.characterPropertiesEditor.replaceTextRange(a,", "))}IY(){lf.a(8701125,307,!!this.kw);lf.a(8701126,307,zb.ParagraphReader.vl(this.zb));lf.a(8701127,307,0>=this.kw.ZM);this.kw.m_d()}static get Xh(){return qu.Mi||(qu.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}}qu.Mi=null;Object(m.a)(qu,"TextOnlyBox4TableSteward",null,[332,333]);class EC{constructor(a,b,c=!1,f=!1,l=!1){this.lp=a;this.$D=b;this.gsb=c;this.MXb=f;this.$Md=l}create(a,b){return 1===a?new qu(b,this.lp,this.$D):new Hx(b,
this.lp,this.$D,this.gsb,this.MXb,this.$Md)}}Object(m.a)(EC,"Box4TableStewardFactory",null,[301]);class hJ{create(){return new Nn.a}}Object(m.a)(hJ,"Factory",null,[516]);var FC=d(1114);class iJ{constructor(){this.pmd=null;this.eQe=0}}Object(m.a)(iJ,"PasteFloatieAnchorData",null,[]);class jJ extends Ts{constructor(a,b){super(a,b)}u7b(){return["PasteText"]}}Object(m.a)(jJ,"PasteTextFloatie",Ts,[]);class kJ{constructor(a,b,c,f,l,y,G){this.QNg=0;this.sDe=this.lYa=this.Kfd=!1;this.Xjk=100;this.exi=61;
this.hyi="PasteTextControl";this.Xxi='[id*="PasteTextFloatie"]';this.Uxi=86;this.CAl=(R,ja)=>{this.uz()&&this.showFloatie(ja)};this.bYi=(R,ja)=>{this.iE(ja)};this.f4i=()=>{this.U_f()};this.bTl=(R,ja)=>{(null===ja||void 0===ja?0:ja.zuc)&&this.dQh()};this.Z$g=()=>{FC.a.instance.keyCode===B.a.Iba&&this.U_f()};this.W1=()=>{!this.lYa&&this.g5&&this.g5.isVisible&&this.kUi()};this.onSelectionChange=()=>{this.i0()||this.iE(new Id(!0))};this.K=a;this.zA=b;this.Lvk=c;this.vcd=f;this.pa=l;this.hdd=y;this.Ub=
G}get zH(){return this.QNg}set zH(a){this.QNg=a}get Qua(){return!this.lYa&&this.g5&&this.g5.isVisible}h9k(){this.vcd.iki(this.CAl);this.vcd.nji(this.bYi);this.vcd.tji(this.f4i);this.vcd.Nji(this.bTl)}i9k(){this.Kfd||(this.pa.FC(this.onSelectionChange),this.Ub.To.q8(this.W1),this.hdd.yUd(this.Z$g),this.Kfd=!0)}cRl(){this.Kfd&&(this.pa.sXe(this.onSelectionChange),this.Ub.To.kLa(this.W1),this.hdd.Lbl(this.Z$g),this.Kfd=!1)}m6(a){2===a.behavior&&(a=a.actionId,a===C.a.bold||a===C.a.centerJustify||a===
C.a.vr||a===C.a.e2||a===C.a.Hja||a===C.a.setItalic||a===C.a.leftJustify||a===C.a.Xq||a===C.a.fI||a===C.a.qH||a===C.a.strikethrough||a===C.a.rightJustify||a===C.a.fullJustify||a===C.a.underline||a===C.a.Ry||a===C.a.QC||a===C.a.kN||a===C.a.JP||a===C.a.subscript||a===C.a.superscript||a===C.a.font||a===C.a.paste||a===C.a.u6)&&(this.Ub.To.ape||this.iE(new Id(!0)))}l6(){}showFloatie(a){this.g5||(this.g5=new jJ(this.K.resolve("Common.IReactContextualUILauncher"),this.K.resolve("Common.IExternalUICommandDefinitionMapping")));
if((this.lYa||!this.g5.isVisible)&&a){var b=a.location?a.location:this.vyb();b&&(this.g5.G3e(b,a.Uu),this.i9k(),this.lYa=!1)}}iE(a){this.g5&&(!this.lYa||this.g5.isVisible)&&a&&(this.g5.iE(),this.lYa=!0,a.H8d&&(this.zH=null,this.cRl()))}vyb(){var a=this.frj();if(!a||!a.pmd)return null;var b=this.zA.Rd;if(!b)return null;a=this.Ulj(a,b);if(!a)return null;w.AFrameworkApplication.isRtl&&(b=this.g9f(),a.x-=b?b.width:this.Uxi);return new Sys.UI.Point(a.x+a.width,a.y+a.height)}frj(){var a;if(!this.pa||!this.pa.Pa||
!this.pa.Pa.nb)return null;var b=this.pa.Pa.nb.Ua;const c=!b.Ra&&!b.Lb;let f=b.node;if(f&&c){do f=this.Vrj(f);while(f&&f instanceof Kf.AParagraphNode&&(null===(a=f.characterData)||void 0===a||!a.trim().length))}let l="";(a=f)&&a.characterData&&(l=a.characterData.length===b.Ra||c?a.characterData.trimEnd():a.characterData.substring(0,b.Ra).trimEnd());b=a&&a.characterData?l.length:b.Ra;return Object.assign(new iJ,{pmd:a?a:f,eQe:b})}Vrj(a){const b=new ub.GraphIterator;if(!a.anchor)return null;b.set(a);
if(!b.kf())return null;b.Jg(11);return b.pua()?b.Db(2):null}g9f(){const a=document.getElementById(this.hyi);if(!a)return null;const b=a.style.visibility,c=a.style.display;a.style.visibility="hidden";a.style.display="";const f=Cd.a.mi(a);a.style.display=c;a.style.visibility=b;return f}Ulj(a,b){b=a.pmd.rg(b.Na);if(!b)return null;let c=null;if(a.pmd instanceof Kf.AParagraphNode){if(!b)return null;try{c=this.Lvk.BW(a.eQe,b,0<a.eQe,!1,!1,!1),c.height+=this.exi}catch(f){c=null}}c||(c=b.getBounds());return c}U_f(){if(!this.lYa&&
this.g5&&this.g5.isVisible){var a=document.querySelector(this.Xxi);a&&(a.getAttribute(Ne.a.O7a)||"")===Ne.a.qja&&a.click()}}i0(){return this.uz()&&(Jb.SelectionEditor.ou(this.pa.Pa.nb.Ua)||this.pa.Pa.nb.Ua.contextId===rb.a.paragraph||this.pa.Pa.nb.Ua.contextId===rb.a.endOfParagraph)}uz(){if(!this.pa.Pa||!this.pa.Pa.nb)return!1;const a=this.pa.Pa.nb;return!!a&&a.Ua.contextId!==rb.a.outline&&!(a.Ua.contextId===rb.a.notes||this.D9(a.Ua.node))}D9(a){if(!a.anchor)return!1;const b=new ub.GraphIterator;
b.set(a);return b.rc(60)}kUi(){if(!this.sDe){const a=new pd.a(3,1,this.Xjk,()=>{this.dQh();this.sDe=!1},215);Uj.a.instance.Hb(a);this.sDe=!0}}dQh(){!this.lYa&&this.g5&&this.g5.isVisible&&(this.iE(new Id(!1)),this.showFloatie(new Pj(1,w.AFrameworkApplication.isRtl)))}}Object(m.a)(kJ,"TextPasteFloatieManager",null,[510,144]);class lJ{Xb(a){a.register(DC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").na().oa(()=>new DC(wv.a.Lyb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),
a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(eC,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").na().oa(()=>new eC(w.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(YH.ClipboardActor,"Box4.Actors.ClipboardActor").na().oa(()=>new YH.ClipboardActor(a.ue("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),cc.a.instance,a.resolve("Box4.IClipboardDataHelper"),ze.a.instance,w.AFrameworkApplication.Qa,
a.resolve("Box4.IUndoManager"),w.AFrameworkApplication.fa));w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a.register(510,"Box4.ITextPasteFloatieManager").na().oa(()=>new kJ(a,a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.ITextMetricsAdapter"),a.resolve("Box4.IPasteFloatieEventHandler"),ze.a.instance,a.resolve("Common.PressOnlyKeyEvent"),Sc.App.Mb.Ld));a.register(511,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").na().oa(()=>new jB(w.AFrameworkApplication.fa));
a.register(512,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").na().oa(()=>new WI(w.AFrameworkApplication.fa,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),wc.a.instance));a.register(513,"Box4.Clipboard.ISystemClipboardAccessManager").na().oa(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(514,"Box4.Actors.ISystemClipboard").na().oa(()=>new SI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),
ra.InteractiveViewManager.instance,Sc.App.Mb.Ld,t.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),wc.a.instance));a.register(440,"Box4.Clipboard.IClipboardOperationCutStrategy").na().oa(()=>new aI);a.register(441,"Box4.Actors.IDeleteTableSegmentStrategy").na().oa(()=>new XI);a.register(515,"Box4.ISelectionFactory").na().oa(()=>new fJ);a.register(516,"Box4.IRenderOrderGraphIteratorFactory").na().oa(()=>new hJ);a.register(517,"Common.IDomElementContentStateFactory").na().oa(()=>
new FH);a.register(518,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").na().oa(()=>new mI(ze.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),M.a.instance.ga(71)));a.register(yC,"Box4.Actors.PasteFloatieFeatureSetBuilder").na().oa(()=>new yC(a.resolve("Box4.IClipboardDataHelper"),Sc.App.eE.rT));a.register(519,"Box4.Actors.IClipboardOperationPasteFactory").na().oa(()=>new kI(cc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),
le.a.instance,ze.a.instance,w.AFrameworkApplication.Qa,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.ue("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(272,"Box4.Actors.IClipboardOperationCutCopyFactory").na().oa(()=>new $H(w.AFrameworkApplication.Qa,cc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
ze.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),hi.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),wc.a.instance,a.resolve("Box4.IEditingDomManager")));a.register(520,"Box4.Actors.IClipboardOperationClipboardAccessHelper").na().oa(()=>
new ZH(cc.a.instance,wc.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),w.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(521,"Box4.Actors.IClipboardOperationPasteStrategyFactory").na().oa(()=>new pI(w.AFrameworkApplication.fa));a.register(522,"Box4.Actors.IClipboardOperationFactory").na().oa(()=>new iI(a.resolve("Box4.Actors.InternalClipboard"),w.AFrameworkApplication.Qa,w.AFrameworkApplication.dvd()&&!(z.a.dU&&
w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),cc.a.instance,hi.a.instance,wc.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(523,"Box4.Actors.IExternalPasteExecutionManagerFactory").na().oa(()=>new AI(a.ue("Box4.Actors.IBox4PasteStewardFactory"),a.ue("Box4.Actors.IBox4ImageStewardFactory"),a.ue("Box4.Actors.IBox4TableStewardFactory"),a.ue("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));a.register(fi,"Box4.Actors.InternalClipboard").na().oa(()=>new fi(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Sc.App.IP,a.resolve("Box4.IParagraphIndentationReader"),w.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").fyh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(524,"Box4.Actors.IInternalPasteExecutionManagerFactory").na().oa(()=>new NI(a.resolve("Box4.Actors.InternalClipboard"),new vb.a(()=>Sc.App.Mb.Ld.Rn)));a.register(525,"Box4.List.IListCommands").na().oa(()=>
new YI(w.AFrameworkApplication.Qa));a.register(hs,"Box4.Actors.PasteCoordinator").na().oa(()=>new hs(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));M.a.instance.ga(78)||a.register(EC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").na().oa(()=>new EC(Fb.a.instance.resolve("Box4.List.IListEditor"),Fb.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(qC,"Box4.Actors.ClipboardOperationWordStrategy").na().oa(()=>new qC(cc.a.instance,ze.a.instance,Sc.App.Oh,Mh.a.instance,M.a.instance.ga(14),M.a.instance.ga(50)));a.register(nC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").na().oa(()=>new nC(w.AFrameworkApplication.fa));a.register(526,"Box4.Actors.IExternalPasteCssConverter").na().oa(()=>
new qI(w.AFrameworkApplication.fa));a.register(527,"Box4.ISelectionCommands").na().oa(()=>new eJ(w.AFrameworkApplication.Qa));a.register(528,"Box4.ITextFormattingCommands").na().oa(()=>new dJ(w.AFrameworkApplication.Qa));a.register(cC,"Box4.Actors.AccessibilityActor").na().oa(()=>new cC(a.Ia("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(Kq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").na().oa(()=>new Kq(a.rb("Box4.IFontSlotProvider"),
a.resolve("Box4.Actors.IFontNameFormattingStrategy")));a.register(BC,"Box4.Actors.ProofingActor").na().oa(()=>new BC(Fb.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),w.AFrameworkApplication.Qa,()=>Fb.a.instance.resolve("Box4.UI.ILanguageDialog"),Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),ze.a.instance,Fb.a.instance.Ia("Box4.IExternalSelectionManager"),hi.a.instance,Fb.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
Mh.a.instance,cc.a.instance,Fb.a.instance.resolve("Box4.IContextMenuController"),Fb.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Fb.a.instance.Ia("Box4.Actors.IProofingErrorPresenter"),M.a.instance));a.register(CC,"Box4.Actors.StyleActor").na().oa(()=>new CC(Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fb.a.instance.resolve("Box4.Styles.IStyleEditor"),dR.a.instance,Fb.a.instance.resolve("Box4.IFormattingEditor"),Th.ContextSetEditor.instance,Fb.a.instance.resolve("Box4.IInsertionPointFormatting"),
Mh.a.instance,cc.a.instance,Fb.a.instance.resolve("Box4.TextFormattingHelper"),pu.instance));a.register(Ld,"Box4.Actors.TextFormattingActor").na().oa(()=>new Ld(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),ra.InteractiveViewManager.instance));a.register(dC,"Box4.Actors.AutoCorrectActor").na().oa(()=>new dC(w.AFrameworkApplication.Qa,cc.a.instance,
()=>Fb.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(m.a)(lJ,"Box4ActorsComponentConfiguration",null,[3]);const fR=(a,b,c)=>Sc.App.R4d?8:2===c?(a=new sh.StandardDialog,a.Ad=4,a.cza(1),a.Le(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Le(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.GBl(eR),32):2,eR=a=>{1===a&&w.AFrameworkApplication.Qa.processAction(C.a.F5d,2)},mJ=(a,b,c)=>{if(Sc.App.R4d)return 8;if(1===c)return b.node.Ta(Ya.a.embeddedFileContainer)?32:
2;if(2===c&&(b.contextId===rb.a.view&&b.view.Nb&&(b=b.view.Nb.ak),vc.EmbeddedFileReader.SZj(b))){a=vc.EmbeddedFileReader.mbe(b.node);Ti.a.Cul();try{gR(a)}catch(f){ha.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},gR=a=>{if(1!==Sc.App.mode||!w.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||w.AFrameworkApplication.fa.ka("IsTeamsSession")&&z.a.dU)window.open(a);else{var b=(new qj.QueryStringBuilder(a)).Sqj(),c=new XMLHttpRequest;c.onloadstart=()=>
{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const G=c.response;let R=b;R||(R="GetImage",G.type&&-1!=G.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(ja=>{-1!=G.type.indexOf(ja)&&(R="GetImage."+ja)}));R=decodeURIComponent(escape(R));if(z.a.gU)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(G,R):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(G),y=document.createElement("a");y.href=l;y.download=R;document.body.appendChild(y);
y.click();setTimeout(()=>{document.body.removeChild(y);f.revokeObjectURL(l)},0)}}catch(G){window.open(a)}};c.send()}};var hR=d(564),Lq=d(1283),Jv;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(Jv||(Jv={}));Object(m.b)("ColorMenuControls",Jv);class Ix{constructor(a){this.bXb=this.cXb=null;this.Uzc={};this.g3=a}Jac(){this.bXb=this.cXb=null}d5f(a,b){if(this.bXb)return this.bXb;
if(!a)return null;const c=Object.assign(new bo.a,{Id:String.format("menu{0}Color",this.g3),ExternalId:String.format("{0}Color",this.g3)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.Cdi());Array.add(c.MenuSectionList,this.Mdi());Array.add(c.MenuSectionList,this.jhi(a,b));Array.add(c.MenuSectionList,this.Sgi());return this.bXb=c}kNi(a,b){if(this.cXb)return this.cXb;a=this.d5f(a,b);return this.cXb=Bj.l(a)}rJc(a,b){Jv[a]in this.Uzc||(this.Uzc[Jv[a]]=b)}nhi(a){a.Oyf(Object(H.a)(this,this.Jac,
"invalidateMenu"),1)}Cdi(){if(!({actionId:b}=this.wyd(1)).returnValue)return null;const a=Object.assign(new el.a,{Id:String.format("{0}Color",this.g3),ControlsId:String.format("{0}.Color.Menu.Controls",this.g3),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new tg.a,{Command:b.toString(),LabelText:na.a.ze(Box4Intl.Box4Strings.L_Automatic),Image16by16:w.AFrameworkApplication.km,Image16by16Class:tb.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});
Array.add(a.ControlList,b);return a}Mdi(){if(!({actionId:b}=this.wyd(2)).returnValue)return null;const a=Object.assign(new el.a,{Id:String.format("{0}Color",this.g3),ControlsId:String.format("{0}.Color.Menu.Controls",this.g3),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new tg.a,{Command:b.toString(),LabelText:na.a.ze(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:w.AFrameworkApplication.km,Image16by16Class:tb.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});
Array.add(a.ControlList,b);return a}jhi(a,b){if(!({actionId:f}=this.wyd(3)).returnValue)return null;const c=Object.assign(new el.a,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this.g3),ControlList:[]});var f=Object.assign(new Uy.a,{Id:String.format("Theme{0}ColorPicker",this.g3),ExternalId:String.format("Theme{0}ColorPicker",this.g3),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.g3),McuLayout:!0,Command:f.toString(),Width:10});f.Colors=Ix.Hyj(a,b);Array.add(c.ControlList,
f);return c}Sgi(){if(!({actionId:b}=this.wyd(4)).returnValue)return null;const a=Object.assign(new el.a,{Id:String.format("{0}Colors",this.g3),ControlsId:String.format("{0}.Color.Menu.Controls",this.g3),Title:na.a.ze(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new Uy.a,{Id:String.format("Standard{0}ColorPicker",this.g3),ExternalId:String.format("Standard{0}ColorPicker",this.g3),Command:b.toString(),Width:10,Colors:[]});b.Colors=Ix.Iwj();Array.add(a.ControlList,
b);return a}wyd(a){a=Jv[a];return a in this.Uzc?{returnValue:!0,actionId:this.Uzc[a]}:{returnValue:!1,actionId:0}}static Iwj(){const a=[];a.push(Object.assign(new Lq.a,{Color:"0000C0",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new Lq.a,{Color:"0000FF",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new Lq.a,{Color:"00C0FF",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));
a.push(Object.assign(new Lq.a,{Color:"00FFFF",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new Lq.a,{Color:"50D092",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new Lq.a,{Color:"50B000",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new Lq.a,{Color:"F0B000",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));
a.push(Object.assign(new Lq.a,{Color:"C07000",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new Lq.a,{Color:"602000",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new Lq.a,{Color:"A03070",Alt:na.a.ze(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static Hyj(a,b){const c=a.properties.sa(sb.a.themeColors,null);a=a.properties.eb(sb.a.bLh).split(" ");const f=Array(10);
f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let R=0;6>R;R++)for(let ja=0;10>ja;ja++){var y=10*R+ja,G=c[y];y=y+1<<24;G=G&4278190080|
(G&255)<<16|G&65280|(G&16711680)>>>16;const za=Ix.QLl(f,R,ja,b[a[ja]],c[ja]);l.push(Object.assign(new Lq.a,{Color:na.a.vw(y,8),DisplayColor:"#"+na.a.vw(G,6),Alt:na.a.ze(za)}))}return l}static QLl(a,b,c,f,l){if(b){var y=l&255,G=(l&65280)>>>8;l=(l&16711680)>>>16;y=Math.floor((Math.min(Math.min(y,G),l)+Math.max(Math.max(y,G),l))/2);--b;y?255===y?(y=!0,b=[242,217,191,166,127][b]):204<y?(y=!1,b=[229,191,127,64,25][b]):51>y?(y=!0,b=[25,64,127,191,229][b]):(G=[51,102,153],l=[191,127],b=(y=b<G.length)?G[b]:
l[b-G.length]):(y=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(y?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(m.a)(Ix,"ColorMenu",null,[552]);class pr{constructor(a){this.Tzc=null;this.r5h=a}get S3f(){this.Tzc||(this.Tzc=new Ix(pr.$Fi),this.hSj(this.Tzc));return this.Tzc}hSj(a){a.rJc(1,C.a.IW);a.rJc(3,C.a.vr);a.rJc(4,C.a.vr);
a.rJc(5,C.a.vr);a.nhi(this.r5h)}vb(){const a=w.AFrameworkApplication.Qa;a.ya(C.a.jKb,rb.a.view,Object(H.a)(this,this.jKb,"populateFontColor"));a.ie(C.a.jKb,1127)}jKb(a,b,c,f,l){if(1===c)return 32;if(2===c&&!l)return 8;a=pr.Vk.Eqj(b);if(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp){b=this.S3f.d5f(a,Sc.App.yNf);if(!b)return 8;l.MenuItems=b}a=this.S3f.kNi(a,Sc.App.yNf);if(!a)return 8;l.PopulationXML=a;return 32}static Wkj(){return new pr(hR.a.instance)}static get instance(){return pr.Yt||
(pr.Yt=pr.Wkj())}static get Vk(){return fx.PageReader.instance}}pr.$Fi="Font";pr.Yt=null;Object(m.a)(pr,"FontColorActor",null,[]);class Df{constructor(a){this.bia=this.pp=this.b3=null;this.NVb=!1;this.Og=ra.InteractiveViewManager.instance.Rd;this.fk=a;Df.dT&&Jb.SelectionEditor.tk(a)&&(a=Jb.SelectionEditor.Zwc(this.fk),Jb.SelectionEditor.tk(a)?this.fk=a:ha.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Jb.SelectionEditor.VQb(this.fk);
Jb.SelectionEditor.tk(a)&&(this.fk=a)}get y9(){return this.b3||(this.b3=Fb.a.instance.rb("Box4.IInternalLinkManager"))}get g7(){return this.pp||(this.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get vmg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}X_f(a,b,c){if(b!==this.fk.Lb||a!==this.fk.Ra)a=Vd.SelectionFactory.R3(c,a,b),this.Og.Nb.setSelection(a),this.fk=Jb.SelectionEditor.VQb(a.Ua.clone())}m8f(a){let b,
c,f,l;l=jb.HyperlinkReader.L8b(this.fk);c=this.fk.Ra;f=this.fk.Lb;b="";if(!l.length)return this.bia=a.substring(this.fk.Ra,this.fk.Lb),{returnValue:!0,Csd:b,HSc:c,ISc:f,r_c:l};if(l[0].hyperlink){let y,G=0,R=Math.max(0,a.length-1),ja=0;for(let za=0;za<l.length;za++)l[za].Ra>=G&&({Ra:y,Lb:G}=Df.nu.X_(this.fk,l[za]),R=Math.min(y,R),ja=Math.max(G,ja));c=Math.min(R,c);f=Math.max(ja,f);this.bia=a.substring(c,f);c===R&&(b=l[0].hyperlink.url);return{returnValue:!0,Csd:b,HSc:c,ISc:f,r_c:l}}return{returnValue:!1,
Csd:b,HSc:c,ISc:f,r_c:l}}h0c(a,b){if(this.Og.Go){var c=Df.wua?jb.HyperlinkReader.L8b(this.fk):jb.HyperlinkReader.UC(this.fk,!0);var f=this.Og.Nb.Pa.nb;if(f){f=f.Ua;zb.ParagraphReader.Im(f)&&(f=bb.a.createTextRange(f.node,0,zb.ParagraphReader.textLength(f.node)));if(Df.dT&&Jb.SelectionEditor.tk(f)){var l=Jb.SelectionEditor.Zwc(f);Jb.SelectionEditor.tk(l)?f=l:ha.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=Jb.SelectionEditor.VQb(f);
Jb.SelectionEditor.tk(l)&&(f=l);0===a||M.a.instance.ga(22)&&32!==w.AFrameworkApplication.Qa.ii(f,C.a.insertHyperlink,1,!0,null,null)||this.B1j(c)||!this.fk.equals(f)?this.Og.rS():(kf.a.mark(5562),M.a.instance.ga(50)&&Sc.App.Oh&&Sc.App.Oh.Ew&&this.Og.Nb.t_b(),a=new pf.GraphTransaction(15),a.ld(this.fk.node),this.fk.node.nH().graphTransactionOperations.uja(4),f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),kf.a.mark(5563),this.G3())}else ha.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}B1j(a){return Df.wua?
!1:1<a.length||1===a.length&&(a[0].Ra>this.fk.Ra||a[0].Lb<this.fk.Lb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=jb.HyperlinkReader.$Ea(b);var l="";this.y9&&({Lph:l}=this.y9.QMh(b,!1)).returnValue&&(b=l)}this.NVb||(a=Df.hyperlinkEditor.fel(a));if((!c.length||Df.wua)&&b)(f=0<c.length)&&Df.nu.oMb(this.fk,c),c=!0,Df.N1j&&(c=zb.ParagraphReader.text(this.fk.node).substring(this.fk.Ra,this.fk.Lb)!==a),c&&Df.characterPropertiesEditor.replaceTextRange(this.fk,a,!0),
c=bb.a.createTextRange(this.fk.node,this.fk.Ra,this.fk.Ra+a.length),Df.hyperlinkEditor.Vja(c,b,f,!1),f=Vd.SelectionFactory.Qg(this.fk.node,this.fk.Ra+a.length);else if(0<c.length){l=c[0];let y;const G=({Ra:c,Lb:y}=Df.nu.X_(this.fk,l)).returnValue;if(b)if(l.hyperlink.bVa){if(b!==l.hyperlink.url)if(Df.Xf.LQb){let R=bb.a.createTextRange(this.fk.node,c,c+a.length);Df.hyperlinkEditor.H_i(R,l.hyperlink,b)}else Df.nu.mQh(b,G);a!==this.bia&&(Df.nu.gLe()&&Df.nu.oMb(this.fk,G),Df.characterPropertiesEditor.replaceTextRange(bb.a.createTextRange(this.fk.node,
c,y),a,!0),f=bb.a.createTextRange(this.fk.node,c,c+a.length),Df.nu.gLe()&&Df.hyperlinkEditor.Vja(f,b,!1),f=Vd.SelectionFactory.Qg(this.fk.node,c+a.length))}else Df.nu.oMb(this.fk,G),Df.characterPropertiesEditor.replaceTextRange(bb.a.createTextRange(this.fk.node,c,y),a,!0),f=bb.a.createTextRange(this.fk.node,c,c+a.length),Df.hyperlinkEditor.Vja(f,b,!1),f=Vd.SelectionFactory.Qg(this.fk.node,c+a.length);else Df.hyperlinkEditor.cN(l.paragraph,l.hyperlink)}f&&this.Og.Nb.setSelection(f)}static get hyperlinkEditor(){return Df.Mn||
(Df.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Df.mh||(Df.mh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Xf(){return Df.hd||(Df.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get nu(){return Df.VD||(Df.VD=Fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get wua(){null==Df.u3a&&(Df.u3a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):
!1);return Df.u3a}static get N1j(){null==Df.NId&&(Df.NId=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return Df.NId}static get xcb(){null==Df.e5a&&(Df.e5a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Df.e5a}static get dT(){null==Df.tN&&(Df.tN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Df.tN}}Df.Mn=null;Df.mh=null;Df.hd=
null;Df.VD=null;Df.u3a=null;Df.NId=null;Df.e5a=null;Df.tN=null;Df.source="Source";Df.ONf="CommandingInterface";Df.z9a="DisplayText";Df.url="Url";Df.id="InsertLinkDialog";Object(m.a)(Df,"AInsertLinkDialog",null,[108]);class Jx{static get hg(){return ei.a.pz(Jx.Fo,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Jx.Fo="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(Jx,"InsertLinkDialogHtml",null,[]);class nJ extends Df{constructor(a,b){super(a,b);this.Ff=new ei.a;this.Ff.ig=Df.id;var c=this.bia="";const f=zb.ParagraphReader.text(this.fk.node);let l=this.fk.Ra,y=this.fk.Lb,G;Df.wua?{Csd:c,HSc:l,ISc:y,r_c:G}=this.m8f(f):(G=jb.HyperlinkReader.UC(this.fk,!0),1===G.length&&G[0].Ra<=this.fk.Ra&&G[0].Lb>=this.fk.Lb&&G[0].hyperlink?(this.bia=Df.nu.CWc(a,G[0],f),c=G[0].hyperlink.url):G.length||(this.bia=f.substring(this.fk.Ra,this.fk.Lb)));(b=Object(sa.a)(Object,
b))&&(b[Df.source]&&b[Df.source]===Df.ONf||b[Df.url]&&b[Df.z9a])?this.insertLink(b[Df.z9a],b[Df.url],G):(Df.wua&&G[0]&&this.X_f(l,y,G[0].paragraph),this.Ff.hg=Jx.hg,""===c.trim()&&this.Ff.Le(1,this.vmg),c={["txtLink"]:c,["txtDisplay"]:this.bia},this.Ff.KQc=Object(H.a)(this,this.YN,"dialogDefaultEnterKeyHandler"),this.Ff.JQc=Object(H.a)(this,this.YN,"dialogDefaultEnterKeyHandler"),this.Ff.sj(this.titleText,Object(H.a)(this,this.h0c,"insertLinkDialogHandler"),c),Df.xcb&&(c=document.getElementById("txtLink"),
md.a.addHandler(c,pa.a.input,Object(H.a)(this,this.YJa,"onLinkChanged")),md.a.addHandler(c,pa.a.change,Object(H.a)(this,this.YJa,"onLinkChanged"))),document.getElementById("txtLink").focus(),Df.dT?0<Ee.h(bb.a.cSa(l,y,!1,this.fk.node)).length&&(this.NVb=!0,document.getElementById("txtDisplay").disabled=!0):1>=G.length&&Df.nu.I0d(a,G[0],1===G.length)&&(this.NVb=!0,document.getElementById("txtDisplay").disabled=!0))}YJa(){if(this.Ff){const a=document.getElementById("txtLink");this.Ff.cF(1,!a||!a.value.length||
jb.HyperlinkReader.ese(a.value))}}YN(a){return this.Ff?Df.xcb?this.Ff.v6f(this.Ff.lpb)?this.Ff.YN(a):!1:this.Ff.YN(a):!1}G3(){if(Df.xcb){const a=document.getElementById("txtLink");a&&(md.a.removeHandler(a,pa.a.change,Object(H.a)(this,this.YJa,"onLinkChanged")),md.a.removeHandler(a,pa.a.input,Object(H.a)(this,this.YJa,"onLinkChanged")))}this.Ff&&(this.Ff=null)}}Object(m.a)(nJ,"InsertLinkDialog",Df,[]);class oJ extends Df{constructor(a,b,c){super(a,b);const f=new ei.a(!1,!1,!0),l={};l.displayTextLabel=
Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;l.textDisplayInitialFocus=c;c=this.bia="";const y=zb.ParagraphReader.text(this.fk.node);let G=this.fk.Ra,R=this.fk.Lb,ja;Df.wua?{Csd:c,HSc:G,ISc:R,r_c:ja}=this.m8f(y):(ja=jb.HyperlinkReader.UC(this.fk,!0),1===ja.length&&ja[0].Ra<=this.fk.Ra&&ja[0].Lb>=this.fk.Lb&&ja[0].hyperlink?(this.bia=Df.nu.CWc(a,ja[0],y),c=ja[0].hyperlink.url):ja.length||(this.bia=y.substring(this.fk.Ra,this.fk.Lb)));(b=Object(sa.a)(Object,
b))&&(b[Df.source]&&b[Df.source]===Df.ONf||b[Df.url]&&b[Df.z9a])?this.insertLink(b[Df.z9a],b[Df.url],ja):(Df.wua&&ja[0]&&this.X_f(G,R,ja[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.vmg),f.Le(1,b),l.txtLink=c,l.txtDisplay=this.bia,Df.dT?0<Ee.h(bb.a.cSa(G,R,!1,this.fk.node)).length&&(this.NVb=!0,l.textDisplayDisabled=!0):1>=ja.length&&Df.nu.I0d(a,ja[0],1===ja.length)&&(this.NVb=!0,l.textDisplayDisabled=!0),a={["id"]:Df.id,["bodyControls"]:l},f.sj(this.titleText,Object(H.a)(this,
this.h0c,"insertLinkDialogHandler"),a))}G3(){}}Object(m.a)(oJ,"ReactInsertLinkDialog",Df,[]);class ru{constructor(){this.Rqa=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.gD}hRf(a,b,c){this.Rqa?new oJ(a,b,c):new nJ(a,b)}static get instance(){return ru.La||(ru.La=new ru)}}ru.La=null;Object(m.a)(ru,"InsertLinkDialogFactory",null,[652]);class fl extends ei.a{constructor(a){super();this.dL=a;this.Og=ra.InteractiveViewManager.instance.Rd;this.MGc=this.Og.Nb.Pa.nb;this.d9d=a[0].Ra;this.Ise=
a[a.length-1].Lb;this.ig="InsertMultiParagraphLinkDialog";a=this.YSl();this.showDialog("",a)}showDialog(a,b){ha.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.hg=Jx.hg;""===b.trim()&&this.Le(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.sj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(H.a)(this,this.h0c,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=
!0;fl.xcb&&(a=document.getElementById("txtLink"),md.a.addHandler(a,pa.a.input,Object(H.a)(this,this.YJa,"onLinkChanged")),md.a.addHandler(a,pa.a.change,Object(H.a)(this,this.YJa,"onLinkChanged")))}hide(){if(fl.xcb){const a=document.getElementById("txtLink");a&&(md.a.removeHandler(a,pa.a.change,Object(H.a)(this,this.YJa,"onLinkChanged")),md.a.removeHandler(a,pa.a.input,Object(H.a)(this,this.YJa,"onLinkChanged")))}super.hide()}YJa(){const a=document.getElementById("txtLink");this.cF(1,!a||!a.value.length||
jb.HyperlinkReader.ese(a.value))}YN(a){return fl.xcb?this.v6f(this.lpb)?super.YN(a):!1:super.YN(a)}YSl(){let a;let b;a="";const c=this.dL.length,f=jb.HyperlinkReader.UC(this.dL[0],!1);0<f.length&&({Ra:l,Lb:b}=fl.nu.X_(this.dL[0],f[0]),l<=this.dL[0].Ra&&(a=f[0].hyperlink.url),this.d9d=Math.min(this.d9d,l));var l=jb.HyperlinkReader.UC(this.dL[c-1],!1);0<l.length&&({Ra:l,Lb:b}=fl.nu.X_(this.dL[c-1],l[l.length-1]),this.Ise=Math.max(this.Ise,b));this.gOl(this.d9d,this.Ise);return a}gOl(a,b){const c=this.dL.length;
if(a!==this.dL[0].Ra||b!==this.dL[c-1].Lb){a=bb.a.Oj(this.dL[0].node,a);a=Vd.SelectionFactory.Qu(a);b=bb.a.Oj(this.dL[c-1].node,b);b=Vd.SelectionFactory.aO(a,b);a=this.ueg(b.Ua.clone());const f=this.ueg(b.jf.clone());a&&f&&(this.dL[0]=a,this.dL[c-1]=f,this.Og.Nb.setSelection(b),this.MGc=b)}}h0c(a,b){if(this.Og.Go){var c=this.Og.Nb.Pa.nb;if(c)if(c.equals(this.MGc)&&0!==a){a=new pf.GraphTransaction(15);a.ld(this.dL[0].node);for(c=0;c<this.dL.length;c++)this.dL[c].node.nH().graphTransactionOperations.uja(4);
b=b.txtLink.trim();this.zVi();this.JTj(b);this.hide();a.dispose()}else this.Og.rS()}}JTj(a){if(a){a=jb.HyperlinkReader.$Ea(a);for(let c=0;c<this.dL.length;c++){var b=this.dL[c];if(fl.dT&&Jb.SelectionEditor.tk(b)&&(b=Jb.SelectionEditor.Zwc(b),!Jb.SelectionEditor.tk(b)))continue;b=bb.a.createTextRange(this.dL[c].node,b.Ra,b.Lb);fl.hyperlinkEditor.Vja(b,a,!1)}}}ueg(a){return zb.ParagraphReader.Im(a)&&!Jb.SelectionEditor.oX(a)&&zb.ParagraphReader.textLength(a.node)?bb.a.createTextRange(a.node,0,zb.ParagraphReader.textLength(a.node)):
Jb.SelectionEditor.tk(a)?a:null}zVi(){let a=!1;for(const b of this.dL){const c=jb.HyperlinkReader.UC(b,!1);c&&(a=fl.nu.oMb(b,c)||a)}}static get nu(){return fl.VD||(fl.VD=Fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Xf(){return fl.hd||(fl.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return fl.Mn||(fl.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get dT(){null==fl.tN&&(fl.tN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):
!1);return fl.tN}static get xcb(){null==fl.e5a&&(fl.e5a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return fl.e5a}}fl.VD=null;fl.hd=null;fl.Mn=null;fl.tN=null;fl.e5a=null;Object(m.a)(fl,"InsertMultiParagraphLinkDialog",ei.a,[]);class Ze{static get ij(){return Mh.a.instance}static get hyperlinkEditor(){return Ze.Mn||(Ze.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get nu(){return Ze.VD||(Ze.VD=Fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static mr(){return Ze.Um||
(Ze.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static get Xf(){return Ze.hd||(Ze.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Twc(){return Ze.aE||(Ze.aE=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get WRb(){null==Ze.pBd&&(Ze.pBd=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return Ze.pBd}static get wua(){null==Ze.u3a&&(Ze.u3a=w.AFrameworkApplication.fa?
w.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return Ze.u3a}static get vmc(){null==Ze.v3a&&(Ze.v3a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Ze.v3a}static get dT(){null==Ze.tN&&(Ze.tN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ze.tN}static vb(){const a=w.AFrameworkApplication.Qa;a.ya(C.a.insertHyperlink,rb.a.view,Ze.aAb);a.ya(C.a.insertHyperlink,
rb.a.Mf,Ze.insertLink);a.ya(C.a.insertHyperlink,rb.a.textRange,Ze.insertLink);a.ie(C.a.insertHyperlink,1028);a.ya(C.a.cN,rb.a.view,Ze.aAb);a.ya(C.a.cN,rb.a.Mf,Ze.sqh);a.ya(C.a.cN,rb.a.textRange,Ze.sqh);a.ie(C.a.cN,1028);a.ya(C.a.fsd,rb.a.view,Ze.aAb);a.ya(C.a.fsd,rb.a.Mf,Ze.sxh);a.ya(C.a.fsd,rb.a.textRange,Ze.sxh);a.ya(C.a.cKa,rb.a.view,Ze.aAb);a.ya(C.a.cKa,rb.a.Mf,Ze.zfh);a.ya(C.a.cKa,rb.a.textRange,Ze.zfh);a.ya(C.a.cKa,rb.a.image,Ze.iPe);a.ya(C.a.cKa,rb.a.X6b,Ze.iPe);a.ya(C.a.N$b,rb.a.view,Ze.aAb);
a.ya(C.a.N$b,rb.a.Mf,Ze.linkText);a.ya(C.a.N$b,rb.a.textRange,Ze.linkText);a.ie(C.a.N$b,1028);Ze.WRb&&a.ya(C.a.cKa,rb.a.anchoredObject,Ze.iPe);a.ya(C.a.EOc,rb.a.view,Ze.aAb)}static aAb(a,b,c,f,l){if(Ze.vmc)return Ze.wNj(a,b,c,f,l);if(!b.view.Uh)return 2;var y=b.view.Nb;if(!y||!y.Pa||!y.Pa.length)return 8;var G=y.Pa.nb;let R=G.Ua.clone();if(2===G.length){if(G=G.ga(1),!Jb.SelectionEditor.tk(R)||!Jb.SelectionEditor.nm(G)||R.node!==G.node)return 8}else if(2<G.length)return 8;if(y.Pa.yH)return 8;zb.ParagraphReader.Im(R)&&
!Jb.SelectionEditor.oX(R)&&(y=R.node,R=bb.a.createTextRange(y,0,zb.ParagraphReader.textLength(y)));return a===C.a.EOc?Ze.QPf(b,R,c,f,l):w.AFrameworkApplication.Qa.ii(R,a,c,!0,f,l)}static wNj(a,b,c,f,l){if(!b.view.Uh)return 2;var y=b.view.Nb;if(!y||!y.Pa||!y.Pa.length||y.Pa.yH)return 8;var G=y.Pa.nb;if(y=Ze.Kcc(G))G=Ze.hfe(G.Ua.clone(),!0);else{let R=G.ga(0).clone(),ja=1;for(;ja<G.length&&(!zb.ParagraphReader.textLength(R.node)||Jb.SelectionEditor.nm(R)||Ze.dT&&Ee.m(R));)R=G.ga(ja).clone(),ja++;G=
Ze.hfe(R,!1)}return Ze.dT&&Jb.SelectionEditor.tk(G)&&Ee.m(G)||!Jb.SelectionEditor.tk(G)&&!y?8:a===C.a.EOc?Ze.QPf(b,G,c,f,l):w.AFrameworkApplication.Qa.ii(G,a,c,!0,f,l)}static Kcc(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return Jb.SelectionEditor.tk(b)&&Jb.SelectionEditor.nm(a)&&b.node===a.node?!0:!1}return!1}static rOf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=Ze.hfe(a.ga(f).clone(),!1);if(Jb.SelectionEditor.tk(l))Ze.dT&&Ee.m(l)||Array.add(c,
l);else if(!Jb.SelectionEditor.nm(l)&&!zb.ParagraphReader.Im(l))return{returnValue:!1,a1d:b}}b=Ub.a.yQb(c);return{returnValue:!Ze.dT||0<b.length?!0:!1,a1d:b}}static Dmg(a,b,c,f){if(Ze.vmc)return Ze.OTj(a,b,c,f);if(!Ze.iZd()||!Ze.CMc(a)||ze.a.instance.Pa.yH)return 8;if(Ze.WRb&&Jb.SelectionEditor.cGa(a))return 2;let l;if(!({hyperlink:l}=Ze.CWa(a,!0)).returnValue||Ze.mOc())return 8;if(1===b)return 32;if(!l&&Jb.SelectionEditor.Xg(a)&&Jb.SelectionEditor.$Bb(a)&&(b=Jb.SelectionEditor.gTa(a,!1))&&(ze.a.instance.setSelection(b),
a=b.Ua,Ze.mOc()))return 8;ru.instance.hRf(a,c,f);return 32}static OTj(a,b,c,f){var l=ze.a.instance.Pa.nb;const y=Ze.Kcc(l);if(y)a=[a];else if(!({a1d:a}=Ze.rOf(l)).returnValue)return 8;if(!Ze.iZd())return 8;for(l=0;l<a.length;l++)if(!Ze.CMc(a[l]))return 8;if(ze.a.instance.Pa.yH)return 8;l=Array(a.length);let G=null;for(let R=0;R<a.length;R++)if(l[R]=a[R],!({hyperlink:G}=Ze.CWa(l[R],!0)).returnValue||Ze.mOc())return 8;if(f&&!Ze.T9j(l[0]))return 8;if(1===b)return 32;if(!G&&1===l.length&&y&&Jb.SelectionEditor.Xg(l[0])&&
Jb.SelectionEditor.$Bb(l[0])&&(b=Jb.SelectionEditor.gTa(l[0],!1))&&(ze.a.instance.setSelection(b),l[0]=b.Ua,Ze.mOc()))return 8;y?ru.instance.hRf(l[0],c,f):new fl(l,c);return 32}static insertLink(a,b,c,f,l){return Ze.Dmg(b,c,l,!1)}static linkText(a,b,c,f,l){return Ze.Dmg(b,c,l,!0)}static sqh(a,b,c){if(Ze.vmc)return Ze.U$k(a,b,c);if(!Ze.CMc(b)||Ze.WRb&&Jb.SelectionEditor.cGa(b))return 2;let f;if(!({hyperlink:f}=Ze.CWa(b,!1)).returnValue)return 2;if(2===c){c=new pf.GraphTransaction(15);try{c.gd=a,c.ld(f.paragraph),
Ze.wua?Ze.Jqh(b):Ze.nu.cN(b,f)}finally{c&&c.dispose()}}return 32}static U$k(a,b,c){var f=ze.a.instance.Pa.nb;if(Ze.Kcc(f))b=[b];else if(!({a1d:b}=Ze.rOf(f)).returnValue)return 8;if(!Ze.iZd())return 8;for(f=0;f<b.length;f++)if(!Ze.CMc(b[f]))return 8;if(1===c&&!Ze.CWa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!Ze.CWa(b[c],!0).returnValue)return 2;c=new pf.GraphTransaction(15);try{let l=b[0];c.gd=a;c.ld(l.node);for(a=0;a<b.length;a++)Ze.Jqh(b[a])}finally{c&&c.dispose()}}return 32}static Jqh(a){const b=
jb.HyperlinkReader.L8b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Ra>=c){const l=({Lb:c}=Ze.nu.X_(a,b[f])).returnValue;Ze.nu.oMb(a,l)}}static sxh(a,b,c){if(Ze.WRb&&ba.ImageReader.SAb(b)||!({hyperlink:a}=Ze.CWa(b,!1)).returnValue)return 2;2===c&&({Ra:b,Lb:c}=Ze.nu.X_(b,a),ze.a.instance.setSelection(Vd.SelectionFactory.R3(a.paragraph,b,c)));return 32}static zfh(a,b,c){let f;if(Ze.WRb&&({hyperlink:f}=Ze.G9j(b)).returnValue)ha.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=Ze.CWa(b,!1)).returnValue)return 2;2===c&&Sc.App.d7b(f.hyperlink.url);return 32}static iPe(a,b,c){a=ba.ImageReader.X_(b.node);if(!a)return 2;2===c&&Sc.App.d7b(a);return 32}static QPf(a,b,c,f,l){if(Ze.WRb&&ba.ImageReader.SAb(b))return 2;const y=ra.InteractiveViewManager.instance.editingView;if(!y.lm)return 2;let G;if(!({hyperlink:G}=Ze.CWa(b,!1)).returnValue)return 2;if(1===c)return 32;({Ra:b,Lb:c}=Ze.nu.X_(b,G));ze.a.instance.setSelection(Vd.SelectionFactory.R3(G.paragraph,
b,c));var R=y.ownerDocument;c=y.ho;b=new hd.a(c);Ga.a.yv(c);R=R.createElement("span");c.appendChild(R);R.innerText=G.hyperlink.url;y.zLa();y.Osl();a=w.AFrameworkApplication.Qa.ii(a,C.a.copy,2,!0,f,l);b.restore();return a}static CWa(a,b){let c;c=null;if(Jb.SelectionEditor.tk(a)){var f=Ee.h(a);const l=Ub.a.all(f,y=>6===y.Cq);if(0<f.length&&(!Ze.dT||!l))return{returnValue:!1,hyperlink:c}}if(Ze.wua)return Ze.C9j(a,b);f=jb.HyperlinkReader.UC(a,!0);return 1===f.length&&f[0].Ra<=a.Ra&&f[0].Lb>=a.Lb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static G9j(a){let b;b=null;return ba.ImageReader.SAb(a)&&(b=jb.HyperlinkReader.EWc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static C9j(a,b){let c;c=null;const f=jb.HyperlinkReader.L8b(a);return f.length?f[0].hyperlink?(c=f[0],a.Ra<f[0].Ra?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static T9j(a){if(Jb.SelectionEditor.tk(a)){var b=
Ee.h(a),c=Ub.a.all(b,f=>6===f.Cq);if(0<b.length&&!c)return!1}b=jb.HyperlinkReader.UC(a,!0);if(!(1===b.length&&b[0].Ra<=a.Ra&&b[0].Lb>=a.Lb&&b[0].hyperlink))return!1;c=zb.ParagraphReader.text(a.node);a=Ze.nu.CWc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static mOc(){if(Ze.Xf.gg)for(let a=0;a<null.count;++a)if(2===null.ga(a).G0l.changeType)return!0;return!1}static iZd(){return Ze.Xf.gg?!0:!M.a.instance.ga(45)||!Sc.App.eE.MQb}static CMc(a){return M.a.instance.ga(14)&&
Ze.ij.U8a(a)||Ze.mr()&&Ze.mr().instance&&Ze.mr().instance.qX(a)?!1:!0}static hfe(a,b){return zb.ParagraphReader.Im(a)&&!Jb.SelectionEditor.oX(a)&&(zb.ParagraphReader.textLength(a.node)||b)?bb.a.createTextRange(a.node,0,zb.ParagraphReader.textLength(a.node)):a}}Ze.Mn=null;Ze.VD=null;Ze.Um=null;Ze.hd=null;Ze.aE=null;Ze.pBd=null;Ze.u3a=null;Ze.v3a=null;Ze.tN=null;Object(m.a)(Ze,"HyperlinkActor",null,[]);class fh{static get Jv(){return wv.a.Lyb}static get Cm(){return Th.ContextSetEditor.instance}static get ij(){return Mh.a.instance}static get Xc(){return cc.a.instance}static mr(){return fh.Um||
(fh.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return fh.qx||(fh.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}static get s6(){return fh.Er||(fh.Er=Fb.a.instance.resolve("Box4.IParagraphReader"))}static get XM(){return fh.TG||(fh.TG=Fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get SPk(){return fh.paragraphEditor.Jv}static get Vf(){return fh.fh||(fh.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static vb(){const a=w.AFrameworkApplication.Qa;
a.ya(C.a.Ry,rb.a.view,fh.mEf);a.ya(C.a.Ry,rb.a.outlineElement,fh.lEf);a.ie(C.a.Ry,1028);a.ya(C.a.QC,rb.a.view,fh.mEf);a.ya(C.a.QC,rb.a.outlineElement,fh.lEf);a.ie(C.a.QC,1028)}static mEf(a,b,c,f,l){var y=b.view;if(!y.Uh)return 2;const G=y.Nb;if(!G)return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.eoa}),8;var R=G.ak;if(!R)return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.noSelection}),8;if(M.a.instance.ga(62)&&1===c)return 32;if(M.a.instance.ga(11)&&fh.Cm.Jsa(fh.uVd,R))return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.b3b}),
8;if(M.a.instance.ga(14)&&fh.ij.D1c(R))return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),8;if(fh.mr()&&fh.mr().instance&&fh.mr().instance.qX(R))return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.externalSelection}),8;R={};R[qi.dqa]=5794;R[qi.cqa]=5795;let ja=2;if(w.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){y=fh.ZJf(a===C.a.Ry,b,!0);if(1===c)return y?32:8;y&&(ja=qi.$ib(a,b,c,f,l,R))}else ja=qi.$ib(a,b,1,f,l,R),1!==c&&32===ja?(y.Nb.GOe(),y=new pf.GraphTransaction(15),y.ld(b.view.Ag),ja=fh.ZJf(a===
C.a.Ry,b,!1)?qi.$ib(a,b,c,f,l,R):8,y.dispose()):1!==c&&8===ja&&(y.Nb.GOe(),fh.ZGi(a,b,G));return ja}static ZJf(a,b,c){b=b.view.Nb;if(!b||!b.Pa.nb)return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.Aid}),!1;if(b.Pa.yH)return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.VOf}),!1;b=Ci.Jta(b.Pa,!1);if(!b)return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.bTc}),!1;let f=!1;for(let l=0;l<b.length;l++){const y=b.getContext(l),G=new ub.GraphIterator;G.set(y.node);Jb.SelectionEditor.Pt(G);if(!he.OutlineElementReader.hh(G))if(c)continue;
else return fh.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.yda}),!1;if(a?!fh.Jv.Gub(G):!fh.Jv.zMc(G))if(c)continue;else return fh.Xc.Yb(Yd.a.Z4b,{["Reason"]:ce.a.xKf}),!1;f=!0}return c?f:!0}static lEf(a,b,c,f,l){if(b.contextId!==rb.a.outlineElement)return 2;if(M.a.instance.ga(14))if(f=b.clone().g5e(),Hd.TableReader.Aug(f)){if(fh.ij.Bug(f))return fh.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),8}else if(fh.ij.lGa(f))return fh.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),2;f=new ub.GraphIterator;f.set(b.node);Jb.SelectionEditor.Pt(f);
if(!he.OutlineElementReader.hh(f))return 2;switch(a){case C.a.Ry:b=fh.Jv.Gub(f);break;case C.a.QC:b=fh.Jv.zMc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===C.a.QC&&l&&l.sa(we.a.OFf,!1)&&(c|=2);switch(a){case C.a.Ry:fh.Jv.Ajb(f,-1,c);break;case C.a.QC:fh.Jv.xQc(f,1)}return 32}static ZGi(a,b,c){const f=new pf.GraphTransaction(15);try{f.ld(b.view.Ag);b=!0;var l=Ci.Jta(c.Pa,!1);for(let y=0;y<l.length;y++){const G=l.getContext(y);let R=new ub.GraphIterator;R.set(G.node);Jb.SelectionEditor.Pt(R);
if(!he.OutlineElementReader.hh(R))b=!1;else if(a===C.a.Ry?fh.Jv.Gub(R):fh.Jv.zMc(R))switch(b=!1,a){case C.a.Ry:fh.Jv.Ajb(R,-1,0);break;case C.a.QC:fh.Jv.xQc(R,1)}}if(b){const y=c.Pa.nb;for(c=0;c<y.length;c++){const G=y.ga(c);if(G.Rk){const R=fh.XM.Ayb(G.node),ja=R.yPb;if(a===C.a.Ry?R.mO>ja:R.mO<18*ja){let za=new ub.GraphIterator;za.set(G.node);l=ja;l=a===C.a.Ry?R.mO>=2.5*ja?R.mO-2*ja:ja:R.mO<16*ja?R.mO+2*ja:18*ja;fh.SPk.tlb(za,1,l)}}}}}finally{f&&f.dispose()}}}fh.Um=null;fh.qx=null;fh.Er=null;fh.TG=
null;fh.fh=null;fh.uVd=ba.ImageReader.RAb;Object(m.a)(fh,"IndentationActor",null,[]);class Cg{static get Fie(){return Cg.Zpb||(Cg.Zpb=Fb.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return Cg.qx||(Cg.qx=Fb.a.instance.resolve("Box4.IParagraphEditor"))}static get Yq(){return Cg.$D||(Cg.$D=Fb.a.instance.resolve("Box4.ITableEditor"))}static get ij(){return Mh.a.instance}static get Xc(){return cc.a.instance}static mr(){return Cg.Um||(Cg.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static vb(){const a=
w.AFrameworkApplication.Qa;M.a.instance.ga(77)||(a.ya(C.a.leftJustify,rb.a.table,Cg.kWd),a.ya(C.a.centerJustify,rb.a.table,Cg.kWd),a.ya(C.a.rightJustify,rb.a.table,Cg.kWd));a.ya(C.a.leftJustify,rb.a.view,Ug.u8);a.ya(C.a.leftJustify,rb.a.paragraph,Cg.nja);a.ya(C.a.leftJustify,rb.a.image,Cg.ICa);a.ya(C.a.leftJustify,rb.a.embeddedFile,Cg.ICa);a.ie(C.a.leftJustify,1028);a.ya(C.a.centerJustify,rb.a.view,Ug.u8);a.ya(C.a.centerJustify,rb.a.paragraph,Cg.nja);a.ya(C.a.centerJustify,rb.a.image,Cg.ICa);a.ya(C.a.centerJustify,
rb.a.embeddedFile,Cg.ICa);a.ie(C.a.centerJustify,1028);a.ya(C.a.rightJustify,rb.a.view,Ug.u8);a.ya(C.a.rightJustify,rb.a.paragraph,Cg.nja);a.ya(C.a.rightJustify,rb.a.image,Cg.ICa);a.ya(C.a.rightJustify,rb.a.embeddedFile,Cg.ICa);a.ie(C.a.rightJustify,1028);M.a.instance.ga(54)&&(a.ya(C.a.fullJustify,rb.a.view,Ug.u8),a.ya(C.a.fullJustify,rb.a.paragraph,Cg.nja),a.ie(C.a.fullJustify,1028),a.ya(C.a.V4b,rb.a.view,Ug.u8),a.ya(C.a.V4b,rb.a.paragraph,Cg.nja),a.ie(C.a.V4b,1028),a.ya(C.a.qdc,rb.a.view,Ug.u8),
a.ya(C.a.qdc,rb.a.paragraph,Cg.nja),a.ie(C.a.qdc,1028),a.ya(C.a.Otc,rb.a.view,Ug.u8),a.ya(C.a.Otc,rb.a.paragraph,Cg.nja),a.ie(C.a.Otc,1028));a.ya(C.a.$la,rb.a.view,Ug.u8);a.ya(C.a.$la,rb.a.paragraph,Cg.nja);a.ya(C.a.$la,rb.a.image,Cg.ICa);a.ie(C.a.$la,1028);a.ya(C.a.Dja,rb.a.view,Ug.u8);a.ya(C.a.Dja,rb.a.paragraph,Cg.nja);a.ya(C.a.Dja,rb.a.image,Cg.ICa);a.ie(C.a.Dja,1028);a.ya(C.a.gpa,rb.a.view,Ug.u8);a.ya(C.a.gpa,rb.a.paragraph,Cg.nja);a.ya(C.a.gpa,rb.a.image,Cg.ICa);a.ie(C.a.gpa,1028);M.a.instance.ga(54)&&
(a.ya(C.a.BEa,rb.a.view,Ug.u8),a.ya(C.a.BEa,rb.a.paragraph,Cg.nja),a.ie(C.a.BEa,1028))}static kWd(a,b,c){let f=!0;if(!b)return 8;Hd.TableReader.Aug(b)?M.a.instance.ga(14)&&Cg.ij.Bug(b)?(Cg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),f=!1):Cg.mr()&&Cg.mr().instance&&Cg.mr().instance.qX(b)&&(Cg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.externalSelection}),f=!1):(Cg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.A5d}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case C.a.leftJustify:Cg.Yq.pK(b,1);break;case C.a.centerJustify:Cg.Yq.pK(b,
2);break;case C.a.rightJustify:Cg.Yq.pK(b,3)}return 32}static ICa(a,b,c){if(!({IF:c}=Ug.OCh(c,b)).returnValue)return c;b=b.node;switch(a){case C.a.leftJustify:case C.a.$la:Cg.Fie.pK(b,1);break;case C.a.centerJustify:case C.a.Dja:Cg.Fie.pK(b,2);break;case C.a.rightJustify:case C.a.gpa:Cg.Fie.pK(b,3)}return 32}static nja(a,b,c,f,l){f=!0;b.contextId!==rb.a.paragraph?f=!1:M.a.instance.ga(14)&&Cg.ij.lGa(b)?(Cg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),f=!1):Cg.mr()&&Cg.mr().instance&&Cg.mr().instance.qX(b)&&
(Cg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=zb.ParagraphReader.IL(b);switch(a){case C.a.leftJustify:case C.a.$la:Cg.paragraphEditor.pK(b,1===c&&Cg.r4c(l)?6:1);break;case C.a.centerJustify:case C.a.Dja:Cg.paragraphEditor.pK(b,2===c&&Cg.r4c(l)?1:2);break;case C.a.rightJustify:case C.a.gpa:Cg.paragraphEditor.pK(b,3===c&&Cg.r4c(l)?1:3);break;case C.a.fullJustify:case C.a.BEa:Cg.paragraphEditor.pK(b,6===c&&Cg.r4c(l)?1:6);break;case C.a.qdc:Cg.paragraphEditor.pK(b,
11);break;case C.a.V4b:Cg.paragraphEditor.pK(b,7);break;case C.a.Otc:Cg.paragraphEditor.pK(b,13)}return 32}static r4c(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&M.a.instance.ga(110)}}Cg.Zpb=null;Cg.$D=null;Cg.qx=null;Cg.Um=null;Object(m.a)(Cg,"JustificationActor",null,[]);class su{vb(){const a=w.AFrameworkApplication.Qa;a.ya(C.a.activateRibbonTab,rb.a.view,Object(H.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.ie(C.a.activateRibbonTab,
5);a.ya(C.a.Pvg,rb.a.view,Object(H.a)(this,this.Xak,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}Xak(){w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Sc.App.eE.rT.Ovg();return 32}static get instance(){return su.La||(su.La=su.VC())}static VC(){return new su}}su.La=null;Object(m.a)(su,"RibbonActor",null,[]);class go{constructor(a,b,c){this.Awf=!1;this.Ca=a;this.Ma=b;this.dCc=c}vb(){this.Ca.ra(F.a.lN,rb.a.view,Object(H.a)(this,this.bMl,
"touchStartHandler"),4);this.Ca&&this.Ma&&(this.Ma.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.ra(C.a.PLh,rb.a.view,Object(H.a)(this,this.EYk,"processImageOnTouchSelection"),4),this.Ca.ra(C.a.QLh,rb.a.view,Object(H.a)(this,this.DYk,"processImageOnClickSelection"),4)),this.Ma.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.ra(F.a.GFl,rb.a.application,Object(H.a)(this,this.eZk,"processStartPinchToZoom"),4),this.Ca.ra(F.a.h1i,rb.a.application,Object(H.a)(this,this.wYk,"processEndPinchToZoom"),
4)))}bMl(a,b,c){if(2!==c)return 2;this.Awf||(this.Awf=!0);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");z.a.ik&&w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}EYk(a,b,c,f,l){if(2!==c)return 2;this.Skh(l,!0);return 32}DYk(a,b,c,f,l){if(2!==c)return 2;this.Skh(l,!1);return 32}Skh(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,go.SOj)){for(a=a.firstChild;a;)this.xmi(a,b),a=a.nextSibling;break}a=a.nextSibling}}xmi(a,b){if(Sys.UI.DomElement.containsCssClass(a,go.Ukg)){b&&!Sys.UI.DomElement.containsCssClass(a,go.A_c)?Sys.UI.DomElement.addCssClass(a,go.A_c):!b&&Sys.UI.DomElement.containsCssClass(a,go.A_c)&&Sys.UI.DomElement.removeCssClass(a,go.A_c);const c="WACImageResizeHandleTouch"+this.ylj(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}zWc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==go.Ukg)return c}return""}ylj(a){a=this.zWc(a);return""!==a?na.a.substring(a,20,a.length):""}eZk(a,b,c){if(2!==c)return 2;if(!this.dCc)return 8;this.dCc.sMj();return 32}wYk(a,b,c){if(2!==c)return 2;if(!this.dCc)return 8;this.dCc.Wgl();return 32}static pzj(){return new go(w.AFrameworkApplication.Qa,
w.AFrameworkApplication.fa,yh.GrippersManager.instance)}static get instance(){return go.Yt||(go.Yt=go.pzj())}}go.Ukg="WACImageResizeHandles";go.A_c="WACImageResizeHandlesTouch";go.SOj="WACImgSelection";go.Yt=null;Object(m.a)(go,"TouchInputActor",null,[]);class qr{constructor(a){this.ot=null;this.h_=a}get Yn(){return this.ot||(this.ot=this.h_())}vb(){const a=w.AFrameworkApplication.Qa,b=Object(H.a)(this,this.undoRedo,"undoRedo");a.ra(C.a.undo,rb.a.view,b,1028);a.ra(C.a.redo,rb.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Uh)return qr.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.Aid}),8;f=a===C.a.undo?this.Yn.gX:this.Yn.kla;if(1===c)return f?32:8;if(!f)return ha.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===C.a.undo?"undo":"redo"),qr.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.qQl}),2;c=new pf.GraphTransaction(3);c.ld(b.Ag);c.klb();a=a===C.a.undo?this.Yn.undo():this.Yn.redo();c.dispose();l&&yh.GrippersManager.instance.g3a(l.Uu);if(a)return 32;qr.Xc.Yb(Yd.a.Z4b,{["Reason"]:ce.a.g8g});
return 8}static get instance(){return qr.La||(qr.La=qr.VC())}static VC(){const a=Fb.a.instance;return new qr(()=>a.resolve("Box4.IUndoManager"),a.ue("Box4.ICoauthCashTelemetry"))}static get Xc(){return cc.a.instance}}qr.La=null;Object(m.a)(qr,"UndoActor",null,[]);class GC{constructor(){this.Ea=null}get name(){return"Box4.Actors"}Xb(a){this.Ea=a;(new lJ).Xb(a)}init(){this.Ea.resolve("Box4.Actors.ClipboardActor").vb();w.AFrameworkApplication.Qa.ya(C.a.PZi,rb.a.embeddedFile,fR);w.AFrameworkApplication.Qa.ya(C.a.F5d,
rb.a.embeddedFile,mJ);w.AFrameworkApplication.Qa.ya(C.a.F5d,rb.a.W6b,mJ);pr.instance.vb();Ze.vb();fh.vb();Cg.vb();go.instance.vb();this.Ea.resolve("Box4.ISelectAllHandlers").vb();M.a.instance.ga(70)&&this.Ea.resolve("Box4.Actors.ProofingActor").vb();su.instance.vb();const a=this.Ea.rb("Box4.IFeatureHelper");a?a.gCj.continueWith(()=>{this.sph()}):this.sph();Gc.vb(Sc.App.NMa);this.Ea.resolve("Box4.Actors.TextFormattingActor").vb();qr.instance.vb();this.Ea.resolve("Box4.Actors.AccessibilityActor").hWe();
this.Ea.resolve("Box4.IClipboardCommands");w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&this.Ea.resolve("Box4.ITextPasteFloatieManager").h9k();Sc.App.Mb.updateCommandUI()}sph(){M.a.instance.ga(71)&&this.Ea.resolve("Box4.Actors.StyleActor").vb()}dispose(){}static main(){n.a.instance.Ac(new GC)}}Object(m.a)(GC,"Box4ActorsPackage",null,[2,3]);class en{constructor(a,b){this.R7=this.A4h=null;this.C4h=a;this.Ipb=b}get wnd(){return this.levelText}get Hdc(){return this.A4h}get levelText(){return this.C4h}get listStyle(){return 6}get vE(){return"left"}get Zna(){return this.R7}get font(){return this.Ipb}}
Object(m.a)(en,"ListMarkerBullet",null,[550]);class bg{static get kq(){return bg.lp||(bg.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}static get Vf(){return bg.fh||(bg.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return bg.Ut||(bg.Ut=Fb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static mr(){return bg.Um||(bg.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}static get Cm(){return Th.ContextSetEditor.instance}static get ij(){return Mh.a.instance}static get Xc(){return cc.a.instance}static get hM(){return bg.XK||
(bg.XK=Fb.a.instance.rb("Box4.List.ListSettings"))}static get Uuc(){return bg.mZb||(bg.mZb=Fb.a.instance.rb("Box4.List.ISingleLevelListEditor"))}static vb(){const a=w.AFrameworkApplication.Qa;a.ya(C.a.kN,rb.a.view,bg.x0b);a.ya(C.a.kN,rb.a.outlineElement,bg.vtb);a.ie(C.a.kN,1036);a.ya(C.a.JP,rb.a.view,bg.x0b);a.ya(C.a.JP,rb.a.outlineElement,bg.vtb);a.ie(C.a.JP,1036);bg.Vf.udb&&(a.ya(C.a.f_a,rb.a.view,bg.x0b),a.ya(C.a.f_a,rb.a.outlineElement,bg.vtb),a.ie(C.a.f_a,1036));a.ya(C.a.jEf,rb.a.view,zf.ActionManager.Sg);
a.ya(C.a.pMf,rb.a.view,zf.ActionManager.Sg);a.ya(C.a.joinList,rb.a.view,zf.ActionManager.Sg);a.ya(C.a.PVd,rb.a.view,zf.ActionManager.Sg);a.ya(C.a.WVd,rb.a.view,zf.ActionManager.Sg);a.ya(C.a.TIh,rb.a.view,zf.ActionManager.Sg);a.ya(C.a.UIh,rb.a.view,zf.ActionManager.Sg);a.ya(C.a.j$e,rb.a.view,zf.ActionManager.Sg)}static x0b(a,b,c,f,l){if(!b.view.Uh)return 2;const y=bg.Xc.eq(C.a.x0b);f.PC=42;f.XN=42;const G={};G[qi.dqa]=5796;G[qi.cqa]=5797;var R=b.view;if(M.a.instance.ga(11)){if(bg.Cm.Jsa(bg.uOj,R.Nb.ak))return bg.Xc.Yb(Yd.a.Ah,
{["Reason"]:ce.a.K0d}),y.end(),8;if(bg.Cm.Jsa(bg.uVd,R.Nb.ak))return bg.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.b3b}),y.end(),8}if(M.a.instance.ga(14)&&bg.ij.D1c(R.Nb.ak))return bg.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.hE}),y.end(),8;if(bg.mr()&&bg.mr().instance&&bg.mr().instance.qX(b))return bg.Xc.Yb(Yd.a.Ah,{["Reason"]:ce.a.externalSelection}),y.end(),8;if(1===c)return y.end(),32;l||(l=new J.DictionaryPropertySet);let ja=null;var za=2;if(2===c){ja=new pf.GraphTransaction(15);ja.ld(b.view.Ag);bg.Xcc=!1;const hb=
Ci.Jta(R.Nb.Pa,!1);if(!hb)return ja.dispose(),bg.Xc.Yb(Yd.a.vka,{["Reason"]:ce.a.bTc}),y.end(),8;w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<hb.length&&l.setValue(we.a.C7g,null);const Cb=l.sa(we.a.nU,-1),lc=l.sa(we.a.wE,-1);bg.hM.Icc&&bg.Uuc&&bg.Uuc.H0l(hb);if(bg.Vf.SIh){var Va=bg.swl(Cb,lc,hb);Va&&(l.setValue(we.a.wE,16),l.setValue(we.a.Jea,0));if(!Jb.SelectionEditor.Xg(R.Nb.ak)&&!Va&&a!==C.a.f_a&&0<hb.length&&Cb){R=new ub.GraphIterator;
Va=Array(hb.length);for(let ic=0;ic<hb.length;ic++)R.set(hb.getContext(ic).node),Va[ic]=bg.Vf.Hv(R);bg.rwl(Va,l)&&(za=new J.DictionaryPropertySet,za.setValue(we.a.wE,16),za.setValue(we.a.Jea,0),za=qi.v6(a,b,c,f,za,G,11),w.AFrameworkApplication.Qa.processAction(C.a.UIh,2),ha.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),bg.Xcc=!0)}}R=new ub.GraphIterator;R.set(hb.getContext(0).node);R=bg.Vf.Hv(R);bg.Sfk(Cb,lc,R,hb.length)}M.a.instance.ga(63)||M.a.instance.ga(77)?
za=qi.v6(a,b,c,f,l,G,11):M.a.instance.ga(30)&&(za=qi.$ib(a,b,c,f,l,G));32===za&&l.sa(we.a.OFf,!1)&&(M.a.instance.ga(62)?za=qi.v6(C.a.QC,b,c,f,l,G,11):M.a.instance.ga(29)?za=qi.$ib(C.a.QC,b,c,f,l,G):M.a.instance.ga(76));ja&&ja.dispose();y.end();return za}static rwl(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.sa(we.a.nU,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.sa(we.a.nU,-3),a=b.sa(we.a.wE,
42)!==c.listType||0<a),f||a)?!0:!1}static Sfk(a,b,c,f){0>=f||bg.Xcc||(a?c?(c=c.listType,-1===a&&b===c?(w.AFrameworkApplication.Qa.processAction(C.a.j$e,2),ha.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(w.AFrameworkApplication.Qa.processAction(0===b?C.a.WVd:C.a.PVd,2),ha.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(w.AFrameworkApplication.Qa.processAction(0===b?C.a.WVd:C.a.PVd,2),ha.ULS.sendTraceTag(39715534,
393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet")):(w.AFrameworkApplication.Qa.processAction(C.a.j$e,2),ha.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static swl(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new ub.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=bg.Vf.Hv(a));l--);return f&&b===f.listType?!0:!1}static vtb(a,b,c,f,l){if(b.contextId!==rb.a.outlineElement)return 2;if(M.a.instance.ga(14)){var y=
b.clone().g5e();if(bg.ij.lGa(y))return bg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.hE}),2}const G=new ub.GraphIterator;G.set(b.node);Jb.SelectionEditor.Pt(G);if(!he.OutlineElementReader.hh(G))return 2;if(1===c)switch(a){case C.a.kN:return 32;case C.a.JP:return 32;case C.a.f_a:return 32;default:return 2}y=bg.Vf.Hv(G);let R=l;if(!R)return 8;!Bb.ListReader.Gx&&a===C.a.JP&&G.pua()&&(G.kJ(4)||R.setValue(we.a.PWa,1),G.xp());bg.Vf.udb?(a===C.a.JP||a===C.a.kN?(R=bg.kq.TZf(a,R),b=cb.a.SN(R.eb(we.a.wE),R.eb(we.a.Jea))):
b=a===C.a.f_a?cb.a.SN(0,1):null,bg.fR(a,R),bg.Nql(b,R)):(R=bg.kq.TZf(a,R),b=cb.a.SN(R.eb(we.a.wE),R.eb(we.a.Jea)));Bb.ListReader.Gx||(b.VA=R.sa(Ya.a.RWa,Ba.a.ex));bg.Xrl(R,G);if(!({Hbb:b}=bg.kq.vtb(R,G,b,!1)).returnValue)return bg.Xc.Yb(Yd.a.fp,{["Reason"]:ce.a.pte}),2;2===c&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.sa(we.a.wE,-1),b&&-1!==a&&((l=l.sa(sb.a.B0,"Invalid MultiLevel Type"),y)?0!==b.listType&&1!==b.listType||
bg.Xcc||(w.AFrameworkApplication.Qa.processAction(C.a.TIh,2),ha.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(w.AFrameworkApplication.Qa.processAction(C.a.pMf,2),ha.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||bg.Xcc||(w.AFrameworkApplication.Qa.processAction(C.a.jEf,2),ha.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",
a?"Bullet":"Numbering",l))),l=t.FocusManager.instance(),l.Ee.name===L.AppFrame.mrd&&l.hC(D.AFrame.SW));f.PC=b.listType;f.XN=b.listStyle;return 32}static Xrl(a,b){var c=new ub.GraphIterator;c.Tc(b);(b=c.Db(2))&&zb.ParagraphReader.fe(b)&&(c=ze.a.instance.Pa.nb)&&c.Ua&&c.Ua.node===b&&Jb.SelectionEditor.T3c(c)&&(bg.Mpl(a),bg.Kpl(a))}static Nql(a,b){b.Ta(sb.a.B0)&&a.Mql(b.eb(sb.a.B0));a.nU=b.sa(we.a.nU,-1);a.Are?(b=bg.Knj(a,b),bg.Trl(a,b)):bg.Tol(a)}static Tol(a){if(a.a3c)a.GZc&&-1===a.nU||(a.levelText=
"%1.",a.propertySet.Ta(Ya.a.ej)||a.fza(0,1));else if(1===a.listType)a.GZc&&-1===a.nU||(a.font=Ba.a.BUi,a.levelText=Ba.a.defaultBullet,a.propertySet.Ta(Ya.a.ej)||a.fza(1,6));else return;a.vE="left"}static Trl(a,b){1===a.B0?bg.brl(a,b):bg.$pl(a,b)}static brl(a,b){a.Zna=b.Zna}static $pl(a,b){a.levelText=b.levelText;a.a3c?a.fza(0,b.listStyle):(a.font=b.font,a.fza(1,1));a.vE=b.vE}static Knj(a,b){let c=null;2===a.B0?c=a.a3c?Fb.a.instance.rb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Fb.a.instance.rb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):
1===a.B0&&(c=Fb.a.instance.rb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.qxg.value;a=a.nU+"";a in f||(f=c.hck);return a in f||!b.Ta(Ya.a.font)?f[a]:new en(na.a.fromCharCode(parseInt(a)),b.sa(Ya.a.font,""))}static Kpl(a){bg.insertionPointFormatting.Ta(Ya.a.fontColor)&&a.setValue(Ya.a.fontColor,bg.insertionPointFormatting.fontColor())}static Mpl(a){bg.insertionPointFormatting.Ta(Ya.a.fontSize)&&a.setValue(Ya.a.fontSize,bg.insertionPointFormatting.fontSize())}static fR(a,b){ha.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===C.a.kN?0:a===C.a.JP?1:a===C.a.f_a?2:-1,b.sa(we.a.nU,-1))}}bg.uOj=ba.ImageReader.Ibc;bg.uVd=ba.ImageReader.RAb;bg.lp=null;bg.fh=null;bg.Ut=null;bg.Um=null;bg.XK=null;bg.mZb=null;bg.Xcc=!1;Object(m.a)(bg,"ListActor",null,[]);var pJ=d(1256);class tu{constructor(){this.D4h=new vb.a(Object(H.a)(this,this.i2d,"createListMarkerDictionary"));this.E4h={}}get qxg(){return this.D4h}get hck(){return this.E4h}}Object(m.a)(tu,"AListMarkerGalleryLoader",null,[560]);var qJ=
d(1284);class rz extends ox.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(m.a)(rz,"ListGalleryButtonProps",ox.a,[]);class ft{constructor(a,b,c,f){this.GWb=null;this.MHf="BulletLibraryGallery";this.PDk="NumberingLibraryGallery";this.wBk="MultilevelGallery";this.v5a=a;this.F4h=b;switch(a){case 0:this.GWb="BulletStyle";break;case 1:this.GWb="NumberingStyle";break;case 2:this.GWb="MultilevelStyle";break;default:this.GWb="BulletStyle"}this.A3h=f}get ick(){return this.F4h}Hzf(a){let b;
var c=1;switch(this.v5a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new el.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var y=0===this.v5a?"Size40by40":"Size48by48";c=Object.assign(new Hq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.Fbe(this.v5a),Type:c,Width:6,ElementDimensions:y,GalleryItems:[]});l=this.ick.qxg.value;y=Iq.a(l);const G=Math.min(18,y.length);for(let R=0;R<G;R++){const ja=l[y[R]];this.A3h&&a&&((1===this.v5a||2===this.v5a)&&!ja.Hdc||0===this.v5a&&ja.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.Ebe(this.GWb+
b+"_"+R,ja,this.v5a))}Array.add(f.ControlList,c);return f}Fbe(a){switch(a){case 0:return this.MHf;case 1:return this.PDk;case 2:return this.wBk;default:return this.MHf}}q9f(a){const b={},c=aa.FontUtils.Rja(a.font);b.fontFamily=aa.FontUtils.Xsb(c,a.font,!0,!1,!1);return b}Ebe(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=na.a.vw(b.levelText.charCodeAt(0),4),f=ft.LWj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let y,G;switch(c){case 0:c=
C.a.kN;y=C.a.Vlh;G=Object.assign(new qJ.a,{Character:b.levelText,Style:this.q9f(b)});break;case 1:c=C.a.JP;y=C.a.y_k;G=Object.assign(new rz,{LevelInfo:b.Hdc});break;case 2:c=C.a.f_a;y=C.a.x_k;G=Object.assign(new rz,{LevelInfo:b.Hdc});b.Zna&&(f=b.Zna.description,l=!0);break;default:c=C.a.kN,y=C.a.Vlh,G=Object.assign(new qJ.a,{Character:b.levelText,Style:this.q9f(b)})}G.Id=a;G.Command=c.toString();G.QueryCommand=y.toString();G.Alt=f;G.InnerHTML=na.a.ze(this.fck(b));G.ShouldSetTitle=l.toString();return G}fck(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.oce(a),this.nce(a))}oce(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.wnd===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===ft.nng)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=aa.FontUtils.Rja(a.font);b.append(aa.FontUtils.Xsb(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}nce(a){return a.wnd}static LWj(a){for(let b=0;b<ft.hFf.length;b++)if(a===ft.hFf[b])return!0;return!1}}ft.nng="EXYdHRyjlYTe8nDSGfyW";
ft.hFf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(m.a)(ft,"ListMarkerGalleryUtility",null,[]);class HC extends tu{constructor(){super();new pJ.a(pB.a.Gk())}i2d(){const a={};a["0"]=new en(Box4Intl.Box4Strings.L_ListStyleNone,ft.nng);a["1"]=new en(String.fromCharCode(61623),"Symbol");a["2"]=new en(String.fromCharCode(111),"Courier New");a["3"]=new en(String.fromCharCode(61607),"Wingdings");a["4"]=new en(String.fromCharCode(9643),"Courier New");a["5"]=new en(String.fromCharCode(61611),
"Wingdings");a["6"]=new en(String.fromCharCode(61614),"Symbol");a["7"]=new en(String.fromCharCode(61483),"Symbol");a["8"]=new en(String.fromCharCode(61485),"Symbol");a["9"]=new en(String.fromCharCode(9830),"Courier New");a["10"]=new en(String.fromCharCode(61664),"Symbol");a["11"]=new en(String.fromCharCode(61558),"Wingdings");a["12"]=new en(String.fromCharCode(61656),"Wingdings");a["13"]=new en(String.fromCharCode(61514),"Wingdings");a["14"]=new en(String.fromCharCode(61516),"Wingdings");a["15"]=
new en(String.fromCharCode(61692),"Wingdings");a["16"]=new en(String.fromCharCode(61691),"Wingdings");a["17"]=new en(String.fromCharCode(61553),"Wingdings");return a}}Object(m.a)(HC,"ListMarkerBulletLoader",tu,[]);class gl{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(gl,"InfoAtLevel",null,[]);class uu{constructor(a){this.R7=a}get font(){return"Calibri"}get listStyle(){return 42}get vE(){return"left"}get Zna(){return this.R7}get wnd(){return this.R7?this.CXk():this.EXk()}get Hdc(){return this.R7?
this.DXk():null}get levelText(){return""}Kkj(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}CXk(){let a="";for(let b=0;3>b;b++)a+=this.XEa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',uu.Fae(),a)}DXk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new gl,{textAtLevel:this.Fbg(b),styleAtLevel:this.fxj(b)}));return a}EXk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
uu.Gae(),Box4Intl.Box4Strings.L_ListStyleNone)}Fbg(a){a=this.R7.cxg[a];for(let b=0;9>b;b++)a=na.a.replaceAll(a,"%"+(b+1),this.Kkj(this.R7.L5c[b]));return a}fxj(a){const b={};b.fontFamily=6===this.R7.L5c[a]?this.R7.Q3f[a]:this.font;return b}XEa(a){const b=this.Fbg(a),c=new Sys.StringBuilder;6===this.R7.L5c[a]&&c.append(String.format("font-family:{0};",this.R7.Q3f[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static Fae(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static Gae(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(uu,"ListMarkerMultilevel",null,[550]);class sz{constructor(a,b,c,f,l){this.cxg=a;this.L5c=b;this.O$j=f;this.Q3f=c;this.description=l}}Object(m.a)(sz,"MultilevelDefInfo",null,[]);class rJ{GNi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),y=Array(9);for(let G=0;9>G;G++)b+="%"+(G+1)+".",c[G]=b,f[G]=1,l[G]="left";return new sz(c,f,y,l,a)}TPi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new sz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}YMi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let y=0;9>y;y++)l[y]=String.fromCharCode(a[y]),c[y]=6,f[y]="left";return new sz(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(m.a)(rJ,"MultilevelDefInfoAdaptor",null,[]);class IC extends tu{constructor(){super()}i2d(){const a=new rJ,b={};b["0"]=new uu(null);b["1"]=new uu(a.GNi());b["2"]=new uu(a.TPi());b["3"]=new uu(a.YMi());return b}}Object(m.a)(IC,"ListMarkerMultilevelLoader",tu,[]);
class wn{constructor(a,b){this.R7=null;this.p5a=a;this.TDc=b}get font(){return"Calibri"}get listStyle(){return this.TDc}get vE(){switch(this.TDc){case 3:case 5:return"right";default:return"left"}}get Zna(){return this.R7}get wnd(){switch(this.TDc){case 1:return this.IKa("1","2","3");case 2:return this.IKa("a","b","c");case 3:return this.IKa("i","ii","iii");case 4:return this.IKa("A","B","C");case 5:return this.IKa("I","II","III");case 0:return this.FXk();default:return this.IKa("1","2","3")}}get Hdc(){const a=
[],b={};b.fontFamily=aa.FontUtils.Rja(this.font);switch(this.TDc){case 1:return a.push(Object.assign(new gl,{textAtLevel:this.dO("1"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("2"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new gl,{textAtLevel:this.dO("a"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("b"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new gl,{textAtLevel:this.dO("i"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("ii"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new gl,{textAtLevel:this.dO("A"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("B"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new gl,
{textAtLevel:this.dO("I"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("II"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new gl,{textAtLevel:this.dO("1"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("2"),styleAtLevel:b})),a.push(Object.assign(new gl,{textAtLevel:this.dO("3"),styleAtLevel:b})),a}}get levelText(){return this.p5a}IKa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
wn.Fae(),this.XEa(a),this.XEa(b),this.XEa(c))}FXk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',wn.Gae(),Box4Intl.Box4Strings.L_ListStyleNone)}XEa(a){a=this.dO(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}dO(a){return na.a.replaceAll(this.p5a,"%1",a)}static Fae(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static Gae(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(m.a)(wn,"ListMarkerNumbering",null,[550]);class JC extends tu{constructor(){super();new pJ.a(pB.a.Gk())}i2d(){const a={};a["0"]=new wn(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new wn("%1.",5);a["2"]=new wn("%1.",4);a["3"]=new wn("%1.",1);a["4"]=new wn("%1.",2);a["5"]=new wn("%1.",3);a["6"]=new wn("%1)",5);a["7"]=new wn("%1)",4);a["8"]=new wn("%1)",1);a["9"]=new wn("%1)",
2);a["10"]=new wn("%1)",3);a["11"]=new wn("(%1)",5);a["12"]=new wn("(%1)",4);a["13"]=new wn("(%1)",1);a["14"]=new wn("(%1)",2);a["15"]=new wn("(%1)",3);return a}}Object(m.a)(JC,"ListMarkerNumberingLoader",tu,[]);class KC{constructor(){this.Ea=null}get name(){return"Box4.ListMarker"}init(){bg.vb()}dispose(){}Xb(a){this.Ea=a;this.Ea.register(HC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").na().oa(()=>new HC);this.Ea.register(JC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").na().oa(()=>new JC);
this.Ea.register(IC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").na().oa(()=>new IC)}static main(){n.a.instance.Ac(new KC)}}Object(m.a)(KC,"Box4ListMarkerPackage",null,[2,3]);class LC{constructor(a){this.fCd=a}Lpg(a){if(!this.fCd)return!0;a=ug.a.AWc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.fCd.length;b++)if(a.endsWith(this.fCd[b]))return!0;return!1}}Object(m.a)(LC,"DomainAllowListManager",null,[]);class sJ{constructor(a,b){this.B3d=null;this.xRd=a;this.url=b}get Kaf(){return ug.a.Paa(this.url)}get oC(){return this.xRd}u8e(){const a=
{},b=this.oC;a.a=this.Kaf;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.B3d;return a}round(a){return Math.round(1E3*a)/1E3}}Object(m.a)(sJ,"PerformanceTimingEntry",null,[]);const tJ=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var ji=d(286);class is{constructor(a,b=null,c=null){this.ri=a;this.Jaf=this;this.P0h=b||(()=>window.location.href);this.dFd=new LC(c)}run(){if(is.SCa(window.performance))try{const l=
this.P0h();if(is.nbi.exec(l)&&this.dFd.Lpg(l)){var a=new sJ(window.performance.timing,l);yj.a.instance.b5k(a.oC.fetchStart);yj.a.instance.d5k(a.oC.navigationStart);yj.a.instance.VZa(ji.a.paj,"connectStart","requestStart");yj.a.instance.VZa(ji.a.vaj,"requestStart","responseStart");yj.a.instance.VZa(ji.a.xaj,"responseStart","responseEnd");this.Jaf.ydb(1,a.u8e());this.ri.$b(ji.a.zEa,a.oC.fetchStart);this.ri.$b(ji.a.taj,a.oC.domainLookupStart);this.ri.$b(ji.a.v4f,a.oC.domainLookupEnd);this.ri.$b(ji.a.raj,
a.oC.connectStart);this.ri.$b(ji.a.yaj,a.oC.secureConnectionStart);this.ri.$b(ji.a.qaj,a.oC.connectEnd);this.ri.$b(ji.a.x4f,a.oC.requestStart);this.ri.$b(ji.a.vUc,a.oC.responseStart);this.ri.$b(ji.a.w4f,a.oC.responseEnd-a.oC.responseStart);this.ri.$b(ji.a.waj,a.oC.responseStart-a.oC.requestStart);var b=0,c=0,f=0;({transferSize:b,u6d:c,K3d:f}=this.aPl(l)).returnValue&&(this.ri.$b(ji.a.zaj,b),this.ri.$b(ji.a.saj,f),this.ri.$b(ji.a.uaj,c));this.ri.$b(ji.a.m7b,a.oC.navigationStart)}}catch(l){ha.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}aPl(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,u6d:c,K3d:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,u6d:c,K3d:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,u6d:c,K3d:f}}ydb(a,b){ha.ULS.sendTraceTag(4551815,306,50,tJ(a,b))}static get instance(){return is.La||(is.La=new is(Jg.a.instance,null,w.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?w.AFrameworkApplication.fa.ty("ResourceLoggerDomainAllowList"):null))}static SCa(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}is.La=null;is.nbi=RegExp("^https?://.*","i");Object(m.a)(is,"PerformanceTimingLogger",
null,[548]);class rr{constructor(a,b){this.B3d=null;this.xRd=a;this.behavior=b;this.url=this.oC.name}get Kaf(){return 2===this.behavior?this.url:ug.a.Paa(this.url)}get oC(){return this.xRd}u8e(){const a={},b=this.oC;a.a=this.Kaf;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(rr.vUa(b,"decodedBodySize"));a.p=this.round(rr.vUa(b,"encodedBodySize"));a.q=this.round(rr.vUa(b,"transferSize"));a.n=this.B3d;return a}round(a){return Math.round(1E3*a)/1E3}static vUa(a,b){return a[b]}}Object(m.a)(rr,"ResourceTimingEntry",null,[595]);class uJ{constructor(a,b=null,c=100){this.jdf=a;this.oHc=b;this.KNa={};this.TXh=
c}TNl(a){var b=a.name.toLowerCase();const c=ug.a.xab(b);this.juh(c,b)&&(c in this.KNa?ha.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.Xug(a),b.encodedsize=rr.vUa(a,"encodedBodySize"),b.decodedsize=rr.vUa(a,"decodedBodySize"),this.KNa[c]=b))}UNl(a){var b=a.name.toLowerCase();const c=ug.a.xab(b);this.Jgl(c,b)&&(c in this.KNa?ha.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",
c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.Xug(a),b.encodedsize=rr.vUa(a,"encodedBodySize"),b.decodedsize=rr.vUa(a,"decodedBodySize"),b.it=a.initiatorType,b.ress=a.responseStart,b.cs=a.connectStart,b.ce=a.connectEnd,b.dls=a.domainLookupStart,b.dle=a.domainLookupEnd,b.rs=a.redirectStart,b.re=a.redirectEnd,b.reqs=a.requestStart,b.scs=a.secureConnectionStart,this.KNa[c]=b))}juh(a,b){if(this.jdf)return Array.contains(this.jdf,a);if(this.oHc)for(a=ug.a.jA(b),b=0;b<this.oHc.length;b++)if(this.oHc[b]&&
a.endsWith(this.oHc[b]))return!0;return!1}Jgl(a,b){return this.juh(a,b)?a.endsWith(".js")||a.endsWith(".css"):!1}Xug(a){try{const b=rr.vUa(a,"transferSize");if(void 0!==b&&null!==b)return!b;ha.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.TXh}catch(b){ha.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}Q5k(){if(ta.a.Xa(this.KNa))ha.ULS.sendTraceTag(575931855,
306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var a=w.AFrameworkApplication.flightId?w.AFrameworkApplication.flightId.split(";"):[],b=Object.assign(new Ak.a,{extendedProperties:br.a.fA()});b.extendedProperties.set("Flights",Nd.c(a));this.Pfk(b,this.KNa,Sf.Health.instance)}}B$d(a){let b=0,c=0,f=0,l=0;const y=this.KNa;for(let R in y){var G=y[R];R.endsWith(".js")&&(G=Object(sa.a)(Object,G),G.responseend<a&&(b+=1,c+=G.decodedsize,l+=G.encodedsize,f+=G.iscached?0:G.encodedsize))}a=
{};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=f;a.encodedBytes=l;return a}Pfk(a,b,c){if(b){var f=0,l=0,y=0,G=0,R=0,ja=0,za=0,Va=0,hb=0,Cb=0,lc=0;for(let yc in b){var ic=b[yc];try{const ec=Object(sa.a)(Object,ic);if(!ec)continue;const jc=ec.iscached?Boolean.parse(ec.iscached.toString()):!1,xd=ec.fetchstart?this.parseFloat(ec.fetchstart.toString()):0,Xd=(ec.responseend?this.parseFloat(ec.responseend.toString()):0)-xd,Qd=ec.encodedsize?this.parseFloat(ec.encodedsize.toString()):0,Ie=ec.decodedsize?
this.parseFloat(ec.decodedsize.toString()):0;f+=Xd;G+=Qd;za+=Ie;Cb++;jc?(y+=Xd,ja+=Qd,hb+=Ie,lc++):(l+=Xd,R+=Qd,Va+=Ie)}catch(ec){ha.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",ec.message)}}a.extendedProperties.set("StaticResources",Nd.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",
y.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",G.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",R.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ja.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",za.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Va.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",hb.toString());
a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Cb.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",lc.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(m.a)(uJ,"AppStaticResourceManager",null,[]);class vJ extends Sys.EventArgs{constructor(a){super();this.entries=
a}}Object(m.a)(vJ,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Kv{constructor(a,b,c=null,f=null,l=100,y=!1){this.DJd=!1;this.rn=null;this.FTb=0;this.Oa=new Wc.a;this.H3a=null;this.mia=!1;this.swf=0;this.ae=a;this.Qff=0;this.Jaf=this;this.dFd=new LC(c);this.ZD=b;f&&(this.H3a=new uJ(null,f,l));this.DWh=y}get aHf(){try{return!(void 0===this.ZD||null===this.ZD)&&!(void 0===this.ZD.getEntriesByType||null===this.ZD.getEntriesByType)}catch(a){return ha.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",
a),!1}}get zUi(){return this.Qff}get isActive(){return this.mia}get k8e(){return this.swf}GAf(a){this.Oa.addHandler(Kv.b7d,a)}Wqh(a){this.Oa.removeHandler(Kv.b7d,a)}Xb(a,b){const c=this.k8e!==a;this.swf=a;this.isActive&&this.ae&&c&&(this.Kg(),this.Hb());this.Qff=b}activate(){!this.isActive&&this.aHf&&(this.Hb(),this.mia=!0)}deactivate(a){this.isActive&&(this.Kg(),a&&this.flush(),this.mia=!1)}flush(){if(this.isActive&&this.aHf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.FTb&&
ha.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",a.length-this.FTb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.FTb=0);const c=[];for(let f=this.FTb;f<a.length;f++)this.dFd.Lpg(a[f].name)&&(this.H3a&&(this.DWh?this.H3a.UNl(a[f]):this.H3a.TNl(a[f])),c.push(new rr(a[f],this.zUi)));b||(this.FTb=a.length);this.Oa.raiseEvent(Kv.b7d,
new vJ(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.Jaf.ydb(0,c[a].u8e());0<c.length&&ha.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){ha.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}ydb(a,b){ha.ULS.sendTraceTag(4310804,306,50,tJ(a,b))}X4k(){this.H3a.Q5k()}B$d(a){return this.H3a.B$d(a)}Hb(){this.ae&&0<this.k8e&&(this.rn=new pd.a(3,2,1E3*this.k8e,
()=>{this.flush()},5),this.ae.Hb(this.rn),this.DJd=!0)}Kg(){this.DJd&&(this.ae.Kg(this.rn),this.rn=null,this.DJd=!1)}}Kv.b7d="EntriesAvailable";Object(m.a)(Kv,"ResourceTimingLogger",null,[508,548]);class MC{constructor(){this.Ea=null}get name(){return"Common.ResourceTiming"}init(){this.Ea.resolve("Common.NetworkTiming.IResourceTimingLogger");is.instance.run()}dispose(){}Xb(a){this.Ea=a;let b=null;if(w.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=w.AFrameworkApplication.fa.ty("ResourceLoggerDomainAllowList")}catch(y){ha.ULS.sendTraceTag(51652512,
306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=[];c.push(ug.a.jA(hh.a.EP).toLowerCase());c.push(ug.a.jA(hh.a.MOb).toLowerCase());const f=w.AFrameworkApplication.fa.uc("AppStaticResourceMonitorCacheThresholdInMs",100),l=w.AFrameworkApplication.fa.ka("PPTAggregateResourceTimingV2Enabled");a.register(508,"Common.NetworkTiming.IResourceTimingLogger").na().oa(()=>new Kv(w.AFrameworkApplication.De,window.performance,b,c,f,l))}static main(){n.a.instance.Ac(new MC)}}Object(m.a)(MC,
"ResourceTimingPackage",null,[2,3]);class Lv{}Lv.visible="visible";Lv.hidden="hidden";Object(m.a)(Lv,"PlatformVisibilityState",null,[]);var tz=d(205);class wJ extends Sys.EventArgs{constructor(a,b){super();this.uof={};this.g6h=a;this.P5h=b}get oldState(){return this.g6h}get newState(){return this.P5h}xkb(a,b){this.uof[a]=b}toString(){return Nd.c(this.uof)}}Object(m.a)(wJ,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class NC{constructor(a,b,c,f){this.qwf=this.xQa=null;this.Wuf=!0;this.Oa=new Wc.a;
this.ae=a;this.BGd=b;this.Xff=c;this.tci=f;this.jmf=!1;w.AFrameworkApplication.fa&&(this.jmf=w.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),this.Wuf=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.ldf=0;this.pwf=new Date;this.BGd()===Lv.hidden&&this.nQf();$addHandler(window,"focus",Object(H.a)(this,this.Cch,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(H.a)(this,this.Bkd,"onPlatformBlurHandler"));
$addHandler(document,"freeze",Object(H.a)(this,this.Dch,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(H.a)(this,this.Ech,"onPlatformVisibilityChangeHandler"));this.Wuf&&($addHandler(document,"pageshow",Object(H.a)(this,this.Bkd,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(H.a)(this,this.Bkd,"onPlatformBlurHandler")))}get I7a(){return this.ldf}get isVisible(){return 2!==this.I7a}YJc(a){this.Oa.addHandler("VST",a)}icl(a){this.Oa.removeHandler("VST",a)}Bkd(a){this.QQb(a.type,
this.Ife())}Cch(a){this.QQb(a.type,0)}Dch(a){3!==this.I7a&&(this.EMf(),this.QQb(a.type,2),this.QQb(a.type,3),w.AFrameworkApplication.Rg.Dyk())}Ife(){return this.BGd()===Lv.hidden?2:document.hasFocus()?0:1}QQb(a,b){const c=this.I7a;this.ldf=b;if(c!==this.I7a){3===c&&this.jmf&&this.jkl();const f=new Date,l=new wJ(c,this.I7a);l.xkb("FromState",pk[c]);l.xkb("ToState",pk[b]);l.xkb("OriginatingEvent",a);l.xkb("TimeInState",(+f-+this.pwf).toString());this.pwf=f;this.tci.Vyg(l);this.Oa.raiseEvent("VST",l)}}Ech(a){this.BGd()===
Lv.hidden?this.xQa?this.ae.U1(this.xQa,this.Xff):this.nQf():(this.EMf(),this.QQb(a?a.type:"",this.Ife()))}dispose(){$removeHandler(window,"focus",Object(H.a)(this,this.Cch,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(H.a)(this,this.Bkd,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(H.a)(this,this.Dch,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(H.a)(this,this.Ech,"onPlatformVisibilityChangeHandler"))}EMf(){this.xQa&&(this.ae.Kg(this.xQa),
this.xQa=null)}nQf(){this.xQa=new pd.a(4,1,this.Xff,Object(H.a)(this,this.jKj,"handleVisibilityUpdate"),157);this.ae.Hb(this.xQa)}jKj(){this.xQa=null;this.QQb("TaskItem",this.Ife())}jhk(a){ha.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.dzg,+new Date-+this.qwf,tz.SessionStatusManager.instance.jla)}jkl(){this.qwf=new Date;this.ae.Hb(this.U3b(0,"Realtime"));this.ae.Hb(this.U3b(1,"AboveNormal"));this.ae.Hb(this.U3b(2,"Normal"));this.ae.Hb(this.U3b(3,
"Background"));this.ae.Hb(this.U3b(4,"Low"))}U3b(a,b){return new pd.a(a,1,0,Object(H.a)(this,this.jhk,"logTimeToExecuteTask"),0,b)}}Object(m.a)(NC,"VisibilityManager",null,[546,108]);class iR{Vyg(){}}Object(m.a)(iR,"NullVisibilityManagerTelemetry",null,[544]);class uz{constructor(){this.Oa=new Wc.a}Vyg(a){ha.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new uz}}Object(m.a)(uz,"VisibilityManagerTelemetry",null,[544]);class OC{constructor(){this.Ea=null}get name(){return"Common.App.VisibilityManager"}init(){this.Ea.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=
this.Ea.rb("Common.App.VisibilityManagement.VisibilityManager");a&&a.dispose()}Xb(a){this.Ea=a;this.Ea.register(uz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").oa(()=>uz.create()).na();this.Ea.register(NC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").oa(()=>new NC(w.AFrameworkApplication.De,()=>window.document.visibilityState,6E4*w.AFrameworkApplication.fa.uc("VisibilityManagerDelayTransitionToHiddenInMin",
1),this.Ea.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).na()}static main(){n.a.instance.Ac(new OC)}}Object(m.a)(OC,"VisibilityManagerPackage",null,[2,3]);var jR=d(1271);class xJ{constructor(a,b){this.u8c=new Qe.a;this.x8c=new Qe.a;this.DIa=b;this.BXa=a}Np(a){!a||this.u8c.Gb(a.id)||this.x8c.Gb(a.id)||this.BXa.Np(a)}eph(a){this.A7k(a)}fph(a){this.C7k(a)}A7k(a){var b=null;this.DIa&&a&&(this.Np(a),b=b||Object(H.a)(this,this.pNe,"onDragOver"),this.u8c.$(a.id,b),this.BXa.ub(pa.a.drop,
a,b))}C7k(a){var b=null;this.DIa&&a&&(this.Np(a),b=b||Object(H.a)(this,this.qNe,"onDrop"),this.x8c.$(a.id,b),this.BXa.ub(pa.a.H9a,a,b))}Bb(a){this.DIa&&a&&(this.BXa.kr(a),this.u8c.ga(a.id)&&this.BXa.Bb(pa.a.H9a,a,this.u8c.ga(a.id)),this.x8c.ga(a.id)&&this.BXa.Bb(pa.a.drop,a,this.x8c.ga(a.id)))}xNj(){this.BXa&&this.BXa.dispose()}qNe(a){a=a.nc;a.preventDefault();a.stopPropagation();return!0}pNe(a){a=a.nc;a.preventDefault();a.stopPropagation();return!0}}Object(m.a)(xJ,"PPTDragDropInputHelper",null,[420]);
class PC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Xb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.K.register(420,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").na().oa(()=>new xJ(jR.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").KVd;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").eph(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").fph(a)):
(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").eph(this.K.resolve("PowerPointWebEditor.AppFrame").E2),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").fph(this.K.resolve("PowerPointWebEditor.AppFrame").E2))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Bb(this.K.resolve("PowerPointWebEditor.AppFrame").KVd);this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").xNj()}static main(){n.a.instance.Ac(new PC)}}
Object(m.a)(PC,"PPTWebEditorDragDropPackage",null,[2,3]);class yJ{constructor(a){this.C7h=a}J2e(){return Math.random()<this.C7h}}Object(m.a)(yJ,"RandomSampler",null,[1551]);class zJ{constructor(a){this.YUb=null;this.n$h=a}b0b(a,b){if("ForceSample"===b||this.n$h())this.YUb||(this.YUb=[]),Array.add(this.YUb,a)}getData(){return this.YUb}reset(){this.YUb=null}}Object(m.a)(zJ,"SampleDataAggregator",null,[1546]);var AJ=d(544);class BJ{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=
0;this.isCoauth=null}}Object(m.a)(BJ,"PPTEventTimingData",null,[]);class Mq{constructor(){this.iGe=!1;this.J$={};this.Nsk=a=>{window.requestAnimationFrame(a)};this.hEb=[];this.J$.ArrowDown=!0;this.J$.ArrowLeft=!0;this.J$.ArrowRight=!0;this.J$.ArrowUp=!0;this.J$.Backspace=!0;this.J$.Delete=!0;this.J$.End=!0;this.J$.Enter=!0;this.J$.Home=!0;this.J$.PageDown=!0;this.J$.PageUp=!0;this.J$.Tab=!0}ouc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.J$}hvi(a){const b={};b.key=
this.ouc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();return b}DHh(a){const b=new BJ;b.metadata=this.hvi(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=Mq.RRa?(!Mq.RRa.amIAlone).toString():"null";this.hEb.push(b);this.P8k()}WHh(a){if(this.hEb.length)for(const b of this.hEb)if(b.timeStamp===a.timeStamp){b.duration=window.performance.now()-a.timeStamp-
b.ths;break}}P8k(){this.iGe||(this.Nsk(()=>{this.iGe=!1;window.dispatchEvent(AJ.a.instance.create(pa.a.lVd,this.hEb.slice(0,this.hEb.length)));this.hEb=[]}),this.iGe=!0)}keyPressedEventHandlerStart(a){Mq.c2c(a)&&!this.ouc(a)&&this.DHh(a)}keyPressedEventHandlerEnd(a){Mq.c2c(a)&&!this.ouc(a)&&this.WHh(a)}keyDownEventHandlerStart(a){Mq.c2c(a)&&this.ouc(a)&&this.DHh(a)}keyDownEventHandlerEnd(a){Mq.c2c(a)&&this.ouc(a)&&this.WHh(a)}static get RRa(){return Mq.oNf||(Mq.oNf=Fb.a.instance.rb("PowerPointWebEditor.ICoauthStateGetter"))}static c2c(a){return!!a&&
a.timeStamp<window.performance.now()}}Mq.oNf=null;Object(m.a)(Mq,"PPTEventTimingMeter",null,[418]);class js{constructor(){this.Fgc=[];this.OFb=this.$ad=this.lIa=this.Mdd=null;this.Ldd=0;this.Fad=!1}start(a){if(!this.Fad){Array.clear(this.Fgc);for(let b=0;b<js.l7b.length;++b)this.Fgc.push(0);this.Mdd=window.setInterval(Object(H.a)(this,this.Msh,"reportMeasuredFrames"),1E3*a);this.Ldd=window.performance.now();this.jaf(null);$addHandler(window,"visibilitychange",Object(H.a)(this,this.jaf,"updateMeasureCurrentFrameLoop"));
this.Fad=!0}}stop(){this.Fad&&($removeHandler(window,"visibilitychange",Object(H.a)(this,this.jaf,"updateMeasureCurrentFrameLoop")),null!=this.Mdd&&(window.clearInterval(this.Mdd),this.Mdd=null),null!=this.lIa&&(window.cancelAnimationFrame(this.lIa),this.lIa=null),this.Msh(),this.Fad=!1)}Msh(){if(null!=this.OFb){var a={};for(var b=0;b<js.l7b.length;++b)a[js.l7b[b].toString()]=this.Fgc[b],this.Fgc[b]=0;b=window.performance.now();var c={};c.intervalStart=this.Ldd;c.duration=b-this.Ldd;c.maxFrameLengthMs=
this.OFb;c.frameData=a;window.dispatchEvent(AJ.a.instance.create(pa.a.dYe,c));this.OFb=null;this.Ldd=b}}jaf(){js.V3j&&null==this.lIa?(this.$ad=null,this.lIa=window.requestAnimationFrame(Object(H.a)(this,this.T5g,"measureCurrentFrame"))):null!=this.lIa&&(window.cancelAnimationFrame(this.lIa),this.lIa=null)}T5g(a){if(null!=this.$ad){const b=a-this.$ad;if(null==this.OFb||this.OFb<b)this.OFb=b;for(let c=0;c<js.l7b.length;++c)if(b<js.l7b[c]){++this.Fgc[c];break}}this.$ad=a;this.lIa=window.requestAnimationFrame(Object(H.a)(this,
this.T5g,"measureCurrentFrame"))}static get V3j(){return"visible"===window.document.visibilityState}}js.l7b=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(m.a)(js,"PPTFrameTimingMeter",null,[419]);class QC{constructor(){this.Wjc=this.sec=null;this.aKg=this.LJg=!1}Xb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&(w.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!z.a.Yj&&(a.register(418,"Common.IEventTimingMeter").na().oa(()=>
new Mq),this.LJg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&(a.register(419,"Common.IFrameTimingMeter").na().oa(()=>new js),this.aKg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.LJg){var a=new yJ(w.AFrameworkApplication.fa.uc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new zJ(Object(H.a)(a,a.J2e,"shouldBeInSample"));const b=Yp.a.ZW(16,1,a);this.sec=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};
md.a.addHandler(window.self,pa.a.lVd,this.sec)}this.aKg&&(this.Wjc=b=>{b&&(b=b.rawEvent)&&ya.a.J(39706653,306,50,Nd.c(b.detail))},md.a.addHandler(window.self,pa.a.dYe,this.Wjc))}dispose(){this.sec&&(md.a.removeHandler(window.self,pa.a.lVd,this.sec),this.sec=null);this.Wjc&&(md.a.removeHandler(window.self,pa.a.dYe,this.Wjc),this.Wjc=null)}static main(){n.a.instance.Ac(new QC)}}Object(m.a)(QC,"PPTEventTimingMeterPackage",null,[2,3]);var RC=d(460);class CJ{constructor(a){this.epf=new Qe.a(null);this.q0h=
a}ga(a){let b;({value:b}=this.epf.vg(a)).returnValue||(b=this.q0h(a),this.epf.$(a,b));return b}}Object(m.a)(CJ,"MemoizedLookup",null,[1580]);var kR=d(858),lR=d(728);class SC{constructor(a){this.xRk=0;this.kP=a}}Object(m.a)(SC,"GraphMergerResponse",null,[]);var mR=d(326);class TC extends Xf.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=
this.Source=0}ul(){return 33}static construct(a,b,c,f,l,y,G,R,ja){const za=new TC;za.BaseRevisions=a;za.TheirRevisions=b;za.YourRevisions=c;za.IgnoreConflictsInLastServerRevision=f;za.MergeHint=l;za.ObjectSpaceId=y?Ai.a(y):null;za.RequestId=G?Ai.a(G):null;za.Source=R;za.Reason=ja;return za}}Object(m.a)(TC,"CreateGraphMergeReplayRequest",Xf.a,[]);d(851);class vz{Ta(a){return a.Ta(void 0)}Nbg(a,b){return a.sa(b,null)}IXc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Ji.a(a)}Qbg(a,b){return a.sa(b,
"")}gAh(a,b,c){a.setValue(b,c)}}Object(m.a)(vz,"MergeableObjectUtilities",null,[531]);class nR{constructor(a,b=null,c=null){this.eLd=b||new vz;c||Object(H.a)(this,this.eZi,"doParagraphMergeNoOP")}eZi(a,b){return{j2l:a,i2l:b}}}Object(m.a)(nR,"GraphMergeSelectionRecordUpdater",null,[]);class DJ{constructor(){this.source=0;this.$u=this.gSb=this.QMa=null;this.Wlc=0;this.v_c=!1;this.G5e=0}}Object(m.a)(DJ,"InputState",null,[]);class EJ{constructor(){this.timeout=this.succeeded=this.crash=!1;this.kP=null}}
Object(m.a)(EJ,"OutputState",null,[]);class FJ{constructor(){this.GUc=this.$ud=this.yuc=!1;this.D2a=this.zQl=this.p6i=this.mKe=this.JOh=this.m1f=this.cGf=this.bOc=null}}Object(m.a)(FJ,"RuntimeState",null,[]);class GJ{constructor(){this.input=new DJ;this.runtime=new FJ;this.output=new EJ}}Object(m.a)(GJ,"MergeState",null,[]);var fd=d(1137);class Kx{constructor(a,b,c){this.U7h=a;this.h6h=b;this.Q5h=c;this.oId=new vb.a(Object(H.a)(this,this.cCi,"checkIfDifferent"))}get bLb(){return this.U7h}get oldValue(){return this.h6h}get newValue(){return this.Q5h}get A9(){return!!this.newValue&&
!this.oldValue}get isDeleted(){return!this.newValue&&!!this.oldValue}get kcb(){return this.A9||this.isDeleted||this.oId.value}cCi(){return this.A9||this.isDeleted?!0:!fd.a.VEf(this.bLb,this.oldValue,this.newValue)}}Object(m.a)(Kx,"PropertyDiff",null,[]);class Lx{constructor(a,b){this.e6h=a;this.N5h=b;this.oId=new vb.a(()=>this.Q1c(null));this.W7h=new vb.a(Object(H.a)(this,this.q3i,"evaluatePropertyDiffs"))}get ZIb(){return this.e6h}get h6(){return this.N5h}get A9(){return!!this.h6&&!this.ZIb}get isDeleted(){return!this.h6&&
!!this.ZIb}get kcb(){return this.A9||this.isDeleted||this.oId.value}get d0a(){return this.W7h.value}Q1c(a){let b=!1;this.d0a.forEach((c,f)=>{b=f.kcb&&(!a||7!==a.ga(c));return!b});return b}q3i(){const a=new Qe.a;var b=this.h6,c=this.ZIb;if(this.A9){c=b.pA();for(var f=0;f<c.length;f++){var l=c[f];a.$(fd.a.xb(l),new Kx(l,null,b.$ta(l)))}}else if(this.isDeleted)for(b=c.pA(),f=0;f<b.length;f++)l=b[f],a.$(fd.a.xb(l),new Kx(l,c.$ta(l),null));else{f=c.pA();for(l=0;l<f.length;l++){var y=f[l];a.$(fd.a.xb(y),
new Kx(y,c.$ta(y),b.Ta(y)?b.$ta(y):null))}f=b.pA();for(l=0;l<f.length;l++)y=f[l],c.Ta(y)||a.$(fd.a.xb(y),new Kx(y,null,b.$ta(y)))}return a}}Object(m.a)(Lx,"MergeableObjectDiff",null,[]);class Mx{constructor(a,b){this.e6=b?a.H8a():a;this.cIc=new Ma.a}Ytl(a){this.cIc=a}h6g(a){(new Lx(this.e6,a)).d0a.forEach((b,c)=>{c.kcb&&!this.cIc.contains(b)&&(this.cIc.add(b),c.isDeleted?(c=this.e6,c.Ta(fd.a.Hta(b))&&c.removeProperty(fd.a.Hta(b))):this.e6.RLa(fd.a.Hta(b),c.newValue));return!0})}}Object(m.a)(Mx,"PartialMergeResult",
null,[]);class HJ extends Xf.a{constructor(){super();this.Location=null}ul(){return 34}static construct(a){const b=new HJ;b.Location=a;return b}}Object(m.a)(HJ,"PlayGraphMergeReplayRequest",Xf.a,[]);class Mv{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.xve=new kR.a;this.wtk=a;this.zpk=b;this.GYa=c(this.p8b());this.cmk=f;this.dmk=l;this.Xdd=y;this.Ibd=G;this.AGg=R;this.$lk=Va;this.amk=ja;this.bmk=za}HL(){return(new Date).getTime()}Amb(a,...b){return String.format.apply(null,[a].concat(b))}EKl(a){throw pm.a.invalidOperation(a);
}fkj(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",a.name,a.message,a.stack)}AGj(a,b,c,f){f.$(a,new Mx(b,!1));ha.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.Xe);return!0}HUl(a,b){const c=new Oo.a;c.id=bi.a.Fga;c.RLa(va.a.krd,5===b?2:4);a.Zzf(c);a.Nxd().gza(c.id,4)}Qll(a){var b=!a.output.succeeded&&(this.amk||a.output.crash),c=!!a.input.QMa&&0<a.input.QMa.length;if(c=this.bmk&&c&&(this.$lk||
b)){b=c?ia.a.create():ia.a.nil;c=c?String.format(" [Merge Request Id: {0}]",b):"";Mv.Xfk(a,c);var f,l;({Yri:y,yKl:f,z_l:l}=this.tRi(a,Object(H.a)(this,this.aSf,"createSerializedRevisionFrom")));c=Mv.olj(a);b=TC.construct(y._list,f._list,l._list,a.input.v_c,a.input.Wlc,a.input.$u,b,a.input.source,c);var y=a.output.kP;3===c&&0<y.length&&(b.MergedRevision=this.aSf(a.output.kP.last()));a=new mR.a;a.XH=b;a.status=1;b=this.xve.C7b(0,null);b.l_(a);b.TDa()}}aSf(a){const b=a.AW,c=Sc.App.Mb.Ld.Di;return new lR.a(a,
b,c.Fi,null,c.zrc,c.contextId,b?b.id:ia.a.nil,this.Xdd,!1,!0)}khd(a,b,c,f,l,y,G){c=this.CPi(a,b,f,l,y,G);f=0;const R=c.runtime.$ud;try{if(R){const ja=a.length?a.getItemAt(a.length-1):null,za=b.length?b.getItemAt(b.length-1):null;ha.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",
a.length,ja?ja.id:ia.a.nil,ja?ja.AW?ja.AW.id:ia.a.nil:ia.a.nil,b.length,za?za.id:ia.a.nil,za?za.AW?za.AW.id:ia.a.nil:ia.a.nil,l,y,this.Ibd,this.AGg,G)}for(a=!0;f<this.GYa.length&&a;f++)a=(0,this.GYa[f])(c);return new SC(c.output.kP)}catch(ja){const za=!c.output.timeout;c.output.crash=za;const Va=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",za?"Crashed":"Timed Out",this.fkj(ja),!!c.output.kP);za?ha.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Va):
ha.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",Va);if(c.output.kP)return new SC(c.output.kP);throw ja;}finally{c.output.succeeded?R&&ha.ULS.sendTraceTag(18613138,808,50,this.X7b(c,f,"Succeeded")):c.output.timeout?ha.ULS.sendTraceTag(18641178,808,15,this.X7b(c,f,"Timeout")):c.output.crash?c.output.kP?ha.ULS.sendTraceTag(18613142,808,15,this.X7b(c,f,"Crash - Rejection")):ha.ULS.sendTraceTag(18613144,808,15,this.X7b(c,f,"Crash - Failed")):R&&ha.ULS.sendTraceTag(18613140,808,
50,this.X7b(c,f,"Rejection")),this.Qll(c)}}X7b(a,b,c){const f=a.output.kP,l=f&&f.length?f.getItemAt(f.length-1):null;return this.Amb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.HL()-a.input.G5e,b,f?f.length:0,l?l.id:ia.a.nil,l?l.AW?l.AW.id:ia.a.nil:ia.a.nil,a.input.source)}CPi(a,b,c,f,l,y){const G=new GJ,R=G.input;R.QMa=a;R.gSb=b;R.$u=c;R.Wlc=f;R.v_c=l;R.G5e=this.HL();R.source=y;a=G.runtime;a.GUc=this.AGg;a.yuc=
!0;a.$ud=!0;let ja="";a.D2a=za=>{if(this.Ibd){var Va=this.HL()-R.G5e,hb=Va>this.Ibd;ja+=this.Amb(" ({0}: {1})",za,Va);hb&&(G.output.timeout=!0,za=this.Amb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.Ibd,za,Va,ja),this.EKl(za))}};return G}p8b(){return[Object(H.a)(this,this.IOk,"otherAuthorsHaveChangesToMerge"),Object(H.a)(this,this.q1j,"isInputValid"),Object(H.a)(this,this.pSj,"initializeOutputMergeState"),Object(H.a)(this,this.JSj,"initializeRuntimeMergeState"),
Object(H.a)(this,this.bPl,"tryObjectMerge"),Object(H.a)(this,this.Gfi,"addMergeResultsToOutput")]}IOk(a){const b=a.input.QMa;a=a.output;return b?b.length?!0:(ha.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.kP=b,a.succeeded=!0,!1):(ha.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.kP=b,a.succeeded=!0,!1)}q1j(a){var b=a.input;const c=b.QMa,f=b.gSb,l=b.$u,y=b.Wlc;b=b.v_c;
a=a.output;if(!f||!f.length)return a.kP=c,!1;let G=!0;if(2!==y&&1!==y)return a.kP=c,!1;l&&l!==ia.a.nil||(G=!1);c.length<(b?2:1)&&(ha.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),G=!1);G||(a.kP=2===y?c:f);return G}JSj(a){var b=a.input,c=b.QMa,f=b.gSb;const l=b.Wlc;let y,G;({xKl:y,y_l:G,bOc:b}=this.lnj(a,c,f,b.v_c));if(!b)return ha.ULS.sendTraceTag(18613185,
808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",y.id,G.id),this.Jyg(y,c.length,"TheirChanges"),this.Jyg(G,f.length,"YourChanges"),a.output.kP=2===l?c:f,!1;a.runtime.bOc=b;({xQl:c,n6i:f}=this.XWi(l,y,G));({yQl:b,o6i:c,Zri:f}=Mv.Woj(a,c,f,b));a.runtime.cGf=f;a.runtime.JOh=b;a.runtime.m1f=c;a.runtime.mKe=new Qe.a;return!0}Jyg(a,b,c){const f=new Ji.a;for(;a;)f.add(a),a=a.AW;const l=new Sys.StringBuilder;l.append(this.Amb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
c,b,f.length));let y=f.length,G=0;f.forEach(R=>({wkg:y,czg:G}=this.Igi(l,R,f,y,G)).returnValue);ha.ULS.sendTraceTag(18613187,808,50,l.toString())}Igi(a,b,c,f,l){a.append(this.Amb(" [{0} {1} {2}]",f,b.Tla?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,wkg:f,czg:l}):{returnValue:!0,wkg:f,czg:l}}lnj(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.CVc(c);a.runtime.D2a("GetCommonBase");return{xKl:b,y_l:c,bOc:f}}XWi(a,b,c){2===a?(a=
b,b=c):a=c;return{xQl:b,n6i:a}}pSj(a){const b=a.input,c=b.QMa,f=b.gSb;a.output.kP=(2===b.Wlc?c:f).rvl();a.runtime.D2a("InitializeOutputMergeState");return!0}Gfi(a){var b=a.input.$u;const c=a.runtime.mKe,f=a.output.kP;b=this.DPi(a,f.getItemAt(f.length-1),b,ia.a.create());this.k7i(a,b,c);this.HUl(b,a.input.source);f.add(b);return a.output.succeeded=!0}DPi(a,b,c,f){a.runtime.$ud&&ha.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
c,f);a=this.wtk(f);a.msi(b,c);return a}k7i(a,b,c){a.runtime.$ud&&ha.ULS.sendTraceTag(18613191,808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{bi.a.Fga.equals(f)||b.Zzf(l.e6);return!0})}bPl(a){const b=a.runtime,c=b.cGf,f=b.JOh,l=b.m1f,y=b.mKe;let G=!0;const R=a.runtime.yuc;let ja=0,za=0,Va=0;f.forEach((hb,Cb)=>{R&&ha.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",hb,Cb.Xe);za++;50===za&&(ja++,a.runtime.D2a(this.Amb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",
ja,Va)),za=0);if(Mv.KCl(Cb.Xe))return!0;var lc=l.get(hb);if(!lc)return y.Gb(hb)?y.ga(hb).h6g(Cb):y.$(hb,new Mx(Cb,!1)),!0;if(!c.ga(hb))return G=this.AGj(hb,lc,Cb,y);const ic=y.nXc(hb,new Mx(c.ga(hb),!0));({yaa:lc,returnValue:G}=this.dmk.merge(a,this.cmk,this.zpk,ic,lc,Cb));Va++;G&&(a.runtime.D2a(this.Amb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",hb,Cb.Xe,Va,ja)),lc&&(y.Gb(lc.e6.id)?y.ga(lc.e6.id).h6g(lc.e6):y.$(lc.e6.id,lc)));return G});R&&ha.ULS.sendTraceTag(18613199,
808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",f.count,Va);return G}tRi(a,b){const c=new Ji.a,f=new Ji.a,l=new Ji.a;var y=a.runtime.bOc;const G=y?y.id:ia.a.nil;this.rte(y).forEach(R=>{c.add(b(R));return!0});y=a.input.QMa.getItemAt(a.input.QMa.length-1);this.rte(y,G).forEach(R=>{f.add(b(R));return!0});a=a.input.gSb.getItemAt(a.input.gSb.length-1);this.rte(a,G).forEach(R=>{l.add(b(R));return!0});return{Yri:c,yKl:f,z_l:l}}rte(a,b=null){const c=new Ji.a;b||(b=ia.a.nil);for(;a&&
!b.equals(a.id);)c.add(a),a=a.AW;c.reverse();return c}vb(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static Xfk(a,b){ha.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static olj(a){return a.output.crash?2:a.output.succeeded?3:1}static Woj(a,b,c,f){let l;({result:l}=b.mhd(f));a.runtime.D2a("GetUnfavoredChanges");let y;new Qe.a;({result:y}=c.mhd(f));5===a.input.source&&(a.runtime.p6i=RC.a.$bg(c.Nxd()),
a.runtime.zQl=RC.a.$bg(b.Nxd()));b=y;a.runtime.D2a("GetFavoredChanges");f=new CJ(Object(H.a)(f,f.Gyb,"getMergeableObject"));a.runtime.D2a("GetModifiedObjects");return{yQl:l,o6i:b,Zri:f}}static KCl(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(m.a)(Mv,"GraphMerger",null,[615,417]);class IJ{get KDa(){return 8}get $Ka(){return[]}get xNa(){return[fd.a.xb(va.a.hN),fd.a.xb(va.a.Xvc)]}get nNa(){return[]}get KRa(){return[fd.a.xb(Ya.a.yB)]}get vSa(){return[]}yG(a){return 1074135126===
a.Xe}M2a(){return!0}get JDa(){return[fd.a.xb(va.a.cid),fd.a.xb(va.a.sid)]}get U1a(){return!0}}Object(m.a)(IJ,"CommentContentNodeComplexMerge",null,[532]);class JJ{get KDa(){return 8}get $Ka(){return[]}get xNa(){return[fd.a.xb(va.a.ovb),fd.a.xb(va.a.k0d),fd.a.xb(va.a.mvb),fd.a.xb(va.a.P2b),fd.a.xb(va.a.YRe),fd.a.xb(va.a.XRe),fd.a.xb(va.a.hN),fd.a.xb(va.a.Xvc),fd.a.xb(va.a.y_d)]}get nNa(){return[fd.a.xb(va.a.gda),fd.a.xb(va.a.Hsa),fd.a.xb(va.a.a0d),fd.a.xb(va.a.Q2b),fd.a.xb(va.a.TNc),fd.a.xb(va.a.reactions)]}get KRa(){return[]}get vSa(){return[]}yG(a){return 1074135127===
a.Xe}M2a(){return!0}get JDa(){return[fd.a.xb(va.a.cid),fd.a.xb(va.a.sid),fd.a.xb(va.a.commentId),fd.a.xb(va.a.bya),fd.a.xb(sb.a.b0d),fd.a.xb(va.a.c0d),fd.a.xb(va.a.Q2b),fd.a.xb(va.a.TNc),fd.a.xb(va.a.reactions)]}get U1a(){return!0}}Object(m.a)(JJ,"CommentNodeComplexMerge",null,[532]);class KJ{constructor(a){this.Ied=a}get KDa(){return 8}get $Ka(){return[]}get xNa(){return this.Ied.xNa}get nNa(){return[]}get KRa(){return[fd.a.xb(Ya.a.yB)]}get vSa(){return[]}yG(a){return 393326===a.Xe}M2a(){return!0}get JDa(){const a=
new Oa.a;Wr.a(a,this.Ied.$Ka);Wr.a(a,this.Ied.JDa);Wr.a(a,this.Ied.nNa);Wr.a(a,[fd.a.xb(va.a.CBb),fd.a.xb(va.a.Eid)]);return a.toArray()}get U1a(){return!0}}Object(m.a)(KJ,"NotesContentNodeComplexMerge",null,[532]);class LJ{get KDa(){return 8}get $Ka(){return[fd.a.xb(va.a.uZi),fd.a.xb(va.a.oZi),fd.a.xb(va.a.eac),fd.a.xb(va.a.$vl)]}get xNa(){return[fd.a.xb(va.a.itb),fd.a.xb(va.a.jtb),fd.a.xb(va.a.ttb),fd.a.xb(va.a.utb),fd.a.xb(va.a.QDa),fd.a.xb(va.a.$Ke),fd.a.xb(va.a.EKe),fd.a.xb(va.a.aLe),fd.a.xb(va.a.AMb),
fd.a.xb(va.a.CMb),fd.a.xb(va.a.hAb),fd.a.xb(va.a.mwb),fd.a.xb(va.a.hKb)]}get nNa(){return[]}get KRa(){return[fd.a.xb(Ya.a.T8a),fd.a.xb(sb.a.appsNode)]}get vSa(){return[]}yG(a){return 393271===a.Xe}get JDa(){return[fd.a.xb(va.a.presentationId),fd.a.xb(va.a.slideWidth),fd.a.xb(va.a.slideHeight),fd.a.xb(va.a.XY),fd.a.xb(va.a.Saa),fd.a.xb(va.a.ibb),fd.a.xb(va.a.eIb),fd.a.xb(va.a.AY),fd.a.xb(va.a.QIb),fd.a.xb(va.a.cga),fd.a.xb(va.a.embeddedFonts),fd.a.xb(va.a.GKa)]}get U1a(){return!0}M2a(){return!0}}Object(m.a)(LJ,
"PresentationNodeComplexMerge",null,[532]);class MJ{get KDa(){return 8}get $Ka(){return[fd.a.xb(va.a.ZKa),fd.a.xb(va.a.XMb)]}get xNa(){return[fd.a.xb(Ya.a.font),fd.a.xb(va.a.$C),fd.a.xb(va.a.IMc),fd.a.xb(va.a.bjb),fd.a.xb(va.a.hN),fd.a.xb(va.a.g2a),fd.a.xb(va.a.kn),fd.a.xb(va.a.M_a),fd.a.xb(va.a.jAb),fd.a.xb(va.a.nea),fd.a.xb(va.a.iMa),fd.a.xb(va.a.X1),fd.a.xb(va.a.xha),fd.a.xb(va.a.H4b),fd.a.xb(va.a.Dxb),fd.a.xb(va.a.Iya),fd.a.xb(va.a.uza),fd.a.xb(va.a.Hpa),fd.a.xb(va.a.tza),fd.a.xb(va.a.mediaType),
fd.a.xb(va.a.bjb),fd.a.xb(va.a.qCb),fd.a.xb(va.a.Nfh),fd.a.xb(va.a.Pfh),fd.a.xb(va.a.Bpa),fd.a.xb(va.a.Pga),fd.a.xb(va.a.VBh),fd.a.xb(va.a.Cud),fd.a.xb(Ya.a.Vl),fd.a.xb(Ya.a.CJ),fd.a.xb(va.a.GKh),fd.a.xb(va.a.HKh),fd.a.xb(va.a.z2a),fd.a.xb(va.a.LMa),fd.a.xb(va.a.uba),fd.a.xb(va.a.jwc),fd.a.xb(va.a.WM),fd.a.xb(va.a.outlineWidth),fd.a.xb(Xp.a.Qrd),fd.a.xb(va.a.Hnd),fd.a.xb(sm.a.abc),fd.a.xb(va.a.ON),fd.a.xb(va.a.uQ),fd.a.xb(va.a.Xvc),fd.a.xb(va.a.uPb),fd.a.xb(va.a.sza),fd.a.xb(va.a.Wub),fd.a.xb(va.a.xCb),
fd.a.xb(va.a.IN),fd.a.xb(va.a.tGh),fd.a.xb(va.a.kAb)]}get nNa(){return[fd.a.xb(va.a.alt),fd.a.xb(va.a.gsa),fd.a.xb(va.a.Aaa),fd.a.xb(va.a.tpe),fd.a.xb(va.a.gse),fd.a.xb(va.a.ula),fd.a.xb(va.a.shapeType),fd.a.xb(va.a.mQb),fd.a.xb(va.a.rotation),fd.a.xb(va.a.Fsc),fd.a.xb(va.a.Ada),fd.a.xb(va.a.zda),fd.a.xb(Ya.a.Ix),fd.a.xb(Ya.a.iD),fd.a.xb(Ya.a.My),fd.a.xb(Ya.a.Ny),fd.a.xb(va.a.fSb),fd.a.xb(va.a.Pzb),fd.a.xb(va.a.Obf),fd.a.xb(va.a.Qbf),fd.a.xb(va.a.B3),fd.a.xb(va.a.HP),fd.a.xb(va.a.wja),fd.a.xb(va.a.vja),
fd.a.xb(va.a.yja),fd.a.xb(va.a.xja),fd.a.xb(va.a.S4e),fd.a.xb(va.a.yud),fd.a.xb(va.a.Gga),fd.a.xb(va.a.Aud),fd.a.xb(va.a.lva),fd.a.xb(va.a.qKc)]}get KRa(){return[fd.a.xb(Ya.a.yB)]}get vSa(){return[]}yG(a){return 1074135132===a.Xe}M2a(){return!0}get JDa(){return[fd.a.xb(va.a.cid),fd.a.xb(va.a.sid),fd.a.xb(va.a.shapeId),fd.a.xb(va.a.cWa),fd.a.xb(va.a.G_a),fd.a.xb(va.a.FJa),fd.a.xb(va.a.XYj),fd.a.xb(va.a.bM),fd.a.xb(va.a.isResizable),fd.a.xb(va.a.isEditable),fd.a.xb(va.a.eva),fd.a.xb(va.a.pJ),fd.a.xb(va.a.Cj),
fd.a.xb(va.a.dS),fd.a.xb(va.a.NSa),fd.a.xb(va.a.OSa),fd.a.xb(va.a.gbb),fd.a.xb(va.a.Lcc),fd.a.xb(va.a.hasText),fd.a.xb(va.a.mX),fd.a.xb(va.a.qr),fd.a.xb(va.a.isConnected),fd.a.xb(va.a.Of),fd.a.xb(va.a.bGa),fd.a.xb(va.a.nr),fd.a.xb(va.a.wz),fd.a.xb(va.a.Pp),fd.a.xb(va.a.N9),fd.a.xb(va.a.Ik),fd.a.xb(va.a.hU),fd.a.xb(va.a.tj),fd.a.xb(va.a.Wf),fd.a.xb(va.a.v0),fd.a.xb(va.a.jq),fd.a.xb(va.a.Gw),fd.a.xb(va.a.rsa),fd.a.xb(va.a.CKc),fd.a.xb(va.a.Xub),fd.a.xb(Ya.a.sO),fd.a.xb(sb.a.A0),fd.a.xb(va.a.eac),fd.a.xb(va.a.LXf),
fd.a.xb(va.a.c6d),fd.a.xb(va.a.Idl),fd.a.xb(va.a.sqd),fd.a.xb(va.a.Uf),fd.a.xb(va.a.yid),fd.a.xb(va.a.khe),fd.a.xb(va.a.$ge),fd.a.xb(va.a.mL),fd.a.xb(va.a.Kua),fd.a.xb(va.a.b1b),fd.a.xb(va.a.bR),fd.a.xb(va.a.hRb),fd.a.xb(va.a.embeddedFonts),fd.a.xb(va.a.SFa),fd.a.xb(va.a.iwc),fd.a.xb(va.a.ITh),fd.a.xb(va.a.olh),fd.a.xb(va.a.A5c),fd.a.xb(va.a.zud),fd.a.xb(va.a.bga),fd.a.xb(va.a.Yoa),fd.a.xb(va.a.D4),fd.a.xb(va.a.LIb),fd.a.xb(va.a.MIb),fd.a.xb(va.a.NIb),fd.a.xb(va.a.doa),fd.a.xb(va.a.H4)]}get U1a(){return!0}}
Object(m.a)(MJ,"ShapeNodeComplexMerge",null,[532]);class Nx{constructor(a,b){this.juk=a;this.Xuk=b}get KDa(){return this.Xuk}get $Ka(){return[]}get xNa(){return[]}get nNa(){return[]}get KRa(){return[]}get vSa(){return[]}yG(a){return this.juk(a)}M2a(){return!1}get JDa(){return[]}get U1a(){return!1}}Object(m.a)(Nx,"SimpleStrategyComplexMerge",null,[532]);class NJ{get KDa(){return 8}get $Ka(){return[]}get xNa(){return[fd.a.xb(va.a.backgroundColor),fd.a.xb(va.a.ita),fd.a.xb(va.a.a8e),fd.a.xb(va.a.Kba),
fd.a.xb(va.a.Hoa),fd.a.xb(va.a.Taa),fd.a.xb(va.a.Ww),fd.a.xb(va.a.isa),fd.a.xb(va.a.ON),fd.a.xb(va.a.uQ),fd.a.xb(va.a.hN),fd.a.xb(va.a.wza)]}get nNa(){return[fd.a.xb(va.a.I2a),fd.a.xb(va.a.mj),fd.a.xb(va.a.Qn),fd.a.xb(va.a.Fd),fd.a.xb(va.a.animations),fd.a.xb(va.a.EUc),fd.a.xb(va.a.wVd)]}get KRa(){return[fd.a.xb(Ya.a.yB),fd.a.xb(va.a.notesContentNode),fd.a.xb(sb.a.commentContentNode)]}get vSa(){return[]}yG(a){return 393227===a.Xe}M2a(){return!0}get JDa(){return[fd.a.xb(va.a.cid),fd.a.xb(va.a.sid),
fd.a.xb(va.a.kT),fd.a.xb(va.a.UFh),fd.a.xb(Ya.a.Wm),fd.a.xb(va.a.zWa),fd.a.xb(va.a.iea),fd.a.xb(va.a.pFa),fd.a.xb(va.a.sbb),fd.a.xb(va.a.title),fd.a.xb(va.a.XY),fd.a.xb(va.a.Saa),fd.a.xb(va.a.eac),fd.a.xb(va.a.rbb),fd.a.xb(va.a.jbb),fd.a.xb(va.a.Uf),fd.a.xb(va.a.Yoa)]}get U1a(){return!0}}Object(m.a)(NJ,"SlideNodeComplexMerge",null,[532]);class OJ{constructor(a,b){this.REg=a;this.ckk=b}ga(a){return this.REg.nXc(a,this.ckk)}get j7d(){return this.REg}}Object(m.a)(OJ,"PropertyMergeStrategies",null,[]);
const UC=(a,b,c,f,l)=>{if(b){f=f||new vz;if(!a){a=b=b.H8a();const y=a.pA();for(let G=0;G<y.length;G++){const R=y[G];if(qn.a.F4f(R)===qn.a.string){const ja=f.Qbg(a,R);f.gAh(a,R,ja?"Redacted: "+ja.length:"null")}}}ha.ULS.sendTraceTag(18613206,l,50,c,b.Mxd())}else ha.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class PJ{constructor(a,b,c){this.HBg=new Ma.a;this.Mbd=a;this.qwa=b;this.GYa=c(this.p8b());this.ypk=new vb.a(Object(H.a)(this,this.j7d,"evalPropertyMergeStrategies"))}afk(a){if(!a.iTh){a.iTh=
!0;var b=a.nhd.runtime.GUc,c=a.gAk;UC(b,a.W7a.value.ZIb,"Base",c,808);UC(b,a.W7a.value.h6,"Favored",c,808);UC(b,a.W0b.value.h6,"Conflict",c,808)}}XOl(a,b,c,f){this.Nea(a,c);const l=a.yaa;if(2===f||7===f||a.Ylc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:y}=a.W7a.value.d0a.vg(c)).returnValue&&y.kcb)return 4!==f;f=0}if(0===f){if(!b.isDeleted)return l.RLa(fd.a.Hta(c),b.newValue),!0;f=6}if(8===f){let G=a.hOc.value;b=!0;if(({value:y}=G.d0a.vg(c)).returnValue&&G.kcb){var y=this.Mbd.Quj(a.nhd.input.source,
y);void 0!==y&&null!==y?l.RLa(fd.a.Hta(c),y):(b=!1,f=6)}if(b)return!0}return 9===f&&(b=!0,({value:y}=a.hOc.value.d0a.vg(c)).returnValue&&(y=this.Mbd.bfg(a.nhd.input.source,y),void 0!==y&&null!==y?l.RLa(fd.a.Hta(c),y):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty(fd.a.Hta(c)),!0):1===f?this.qwa.M2a(a,c):!1}RZa(a){return a}p8b(){return[Object(H.a)(this,this.fPl,"tryPreProcessFavoredRevision"),Object(H.a)(this,this.ZEi,"cloneObjectAndRemoveNeededProperties"),Object(H.a)(this,this.WOl,"tryMergeNodeInternal")]}get Knd(){return this.ypk.value}VOl(a){const b=
a.W7a.value;ha.ULS.sendTraceTag(18659235,808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.h6.id,b.h6.Xe);for(let c=0;c<this.GYa.length;c++)if(!(0,this.GYa[c])(a))return ha.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",b.h6.id,b.h6.Xe,c),this.afk(a),a.yaa=null,!1;ha.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.h6.id,b.h6.Xe);
return!0}fPl(a){const b=a.W7a.value;if(!b.kcb)return!0;const c=this.Knd;let f=!0;b.d0a.forEach((l,y)=>{if(!y.kcb||a.Ylc.contains(l))return!0;y=c.ga(l);if(5===y)return ha.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",b.ZIb.Xe,l,y),f=!1;6===y&&a.iTe.add(l);return!0});return f}ZEi(a){a.yaa=a.W7a.value.h6.H8a();const b=a.iTe,c=a.yaa;b&&b.forEach(f=>{c.removeProperty(fd.a.Hta(f));
return!0});return!0}WOl(a){const b=a.W0b.value,c=b.ZIb.Xe,f=this.Knd;let l=!0;b.d0a.forEach((y,G)=>{if(this.qwa.U1a&&!this.Knd.j7d.Gb(y)){var R=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",y,c);ha.ULS.sendTraceTag(18970259,808,50,R)}R=f.ga(y);l=this.XOl(a,G,y,R);l||(a.yaa=null,ha.ULS.sendTraceTag(18659271,808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,y,R));return l});return l}Ylj(){return[fd.a.xb(Ya.a.bZf),fd.a.xb(Ya.a.lastModifiedTime),
fd.a.xb(Ya.a.WE),fd.a.xb(Ya.a.Mkb),fd.a.xb(Ya.a.Iuh),fd.a.xb(V.a.Lmc),fd.a.xb(sb.a.KHi),fd.a.xb(sb.a.KXf),fd.a.xb(ct.a.Vw)]}j7d(){var a=this.Ylj(),b=this.qwa.$Ka,c=this.qwa.xNa,f=this.qwa.nNa,l=this.qwa.vSa,y=this.qwa.KRa;const G=this.qwa.JDa,R=new Qe.a(0);for(let ja=0;ja<a.length;ja++)R.$(a[ja],this.RZa(7));for(a=0;a<b.length;a++)R.$(b[a],this.RZa(8));for(b=0;b<c.length;b++)R.$(c[b],this.RZa(7));for(c=0;c<f.length;c++)R.$(f[c],this.RZa(9));for(f=0;f<l.length;f++)R.$(l[f],this.RZa(1));for(l=0;l<y.length;l++)R.$(y[l],
this.RZa(9)),this.HBg.add(y[l]);for(y=0;y<G.length;y++)R.$(G[y],this.RZa(this.qwa.KDa));return new OJ(R,this.RZa(this.qwa.KDa))}Nea(a,b){this.HBg.contains(b)&&(a=a.yaa,ha.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Xe,b))}}Object(m.a)(PJ,"GraphNodeComplexMerge",null,[559]);class QJ{constructor(a,b){this.yl=a;this.a$c=b;this.Bjk=this.DOi()}DOi(){const a=[];this.yl.forEach(b=>{a.push(new PJ(this.a$c,b,c=>c))});return a}COi(a){for(let b=
0;b<this.yl.length;b++)if(this.yl[b].yG(a))return this.Bjk[b];return null}}Object(m.a)(QJ,"GraphNodeComplexMergeFactory",null,[415]);class RJ{Quj(a,b){this.FSh(a);return 5===a?b.newValue:b.oldValue}bfg(a,b){this.FSh(a);return 5===a?b.oldValue:b.newValue}FSh(a){1!==a&&5!==a&&ha.ULS.sendTraceTag(18613264,808,15,"Unexpected merge source: {0}",a)}}Object(m.a)(RJ,"GraphNodeComplexMergeHelper",null,[533]);class SJ{constructor(a,b,c,f,l,y){this.iTe=this.Ylc=null;this.Ucc=this.iTh=!1;this.yaa=null;this.yuc=
a.runtime.yuc;this.nhd=a;this.gAk=b;this.W7a=c;this.W0b=f;this.hOc=l;this.ggg=y}}Object(m.a)(SJ,"GraphNodeComplexMergeState",null,[]);class TJ{constructor(a){this.GYa=a(this.p8b())}p8b(){return[Object(H.a)(this,this.DCl,"simpleMerge"),Object(H.a)(this,this.bHi,"complexMerge")]}kvl(a,b,c,f,l,y){a=new SJ(a,c,new vb.a(()=>new Lx(f.e6,l)),new vb.a(()=>new Lx(f.e6,y)),new vb.a(()=>new Lx(y,l)),b.COi(l));a.Ylc=f.cIc;a.iTe=new Ji.a;return a}merge(a,b,c,f,l,y){a=this.kvl(a,b,c,f,l,y);b=!0;for(c=0;c<this.GYa.length&&
b;c++)b=(0,this.GYa[c])(a);(b=a.Ucc&&a.yaa?new Mx(a.yaa,!1):null)&&b.Ytl(a.Ylc);return{returnValue:a.Ucc,yaa:b}}DCl(a){var b=a.ggg.Knd;return a.W0b.value.Q1c(b)&&a.hOc.value.Q1c(b)?a.W7a.value.Q1c(b)?!0:(b=a.W0b.value.h6,a.Ucc=!0,a.yaa=b.H8a(),!1):(a.Ucc=!0,!1)}bHi(a){const b=a.W0b.value.h6;a.yuc&&ha.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Xe);const c=a.ggg.VOl(a);a.Ucc=c;ha.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
c?"Succeeded":"Failed",b.id,b.Xe,!!a.yaa);return c}}Object(m.a)(TJ,"GraphNodeMerge",null,[416]);class vu{constructor(a){this.Mbd=a}XYi(a){const b=a.hOc.value,c=a.yaa;a=a.nhd.input.source;for(const l of vu.Mrd)if(({value:f}=b.d0a.vg(l)).returnValue){var f=this.Mbd.bfg(a,f);void 0!==f&&null!==f?c.RLa(fd.a.Hta(l),f):c.removeProperty(fd.a.Hta(l))}}get $Ka(){return[fd.a.xb(va.a.hU),fd.a.xb(va.a.xoe),fd.a.xb(va.a.yoe),fd.a.xb(va.a.Yne)]}get xNa(){return[]}get nNa(){return[]}get KRa(){return[]}get vSa(){return vu.Mrd}get JDa(){return[]}get U1a(){return!1}get KDa(){return 9}yG(a){return 393230===
a.Xe}M2a(a,b){return 0<=Array.indexOf(vu.Mrd,b)?(this.XYi(a),vu.Mrd.forEach(c=>{a.Ylc.add(c)}),!0):!1}}vu.Mrd=[fd.a.xb(Ya.a.Oo),fd.a.xb(Ya.a.Vmb),fd.a.xb(Ya.a.kwc),fd.a.xb(Ya.a.sMa),fd.a.xb(Ya.a.Axa),fd.a.xb(sb.a.c0a)];Object(m.a)(vu,"ParagraphNodeComplexMerge",null,[532]);class VC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Xb(a){this.K=a;a.register(RJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").na();
const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(415,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").na().oa(()=>{const c=new MJ;return new QJ([new LJ,new NJ,c,new vu(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new IJ,new JJ,new KJ(c),new Nx(f=>Array.contains(b,f.Xe),9),new Nx(f=>131140===f.Xe,6),new Nx(f=>131164===f.Xe,8),new Nx(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(vz,
"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").na();a.register(416,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").na().oa(()=>new TJ(c=>c));a.register(417,"Box4.IBrowserGraphMerger").na().oa(()=>new Mv(c=>new RC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new pn.a(c,
f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").aZc,a.resolve("PowerPointWebEditor.IApplicationSettings").Lqg,a.resolve("PowerPointWebEditor.IApplicationSettings").u0j,a.resolve("PowerPointWebEditor.IApplicationSettings").s0j,a.resolve("PowerPointWebEditor.IApplicationSettings").t0j))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");Sc.App.OMa.Jsi(a)}dispose(){}static main(){n.a.instance.Ac(new VC)}}Object(m.a)(VC,"PPTWebEditorGraphMergePackage",null,[2,3]);class UJ{constructor(a,
b){this.yl=a;this.LR=b}Wbj(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.yl)if(f.UWj(a)){c=f;const l=this.LR.Ii("UserAction",f.name);b=f.Tbj(a);l.stop();break}b||ya.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}Vbj(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.Wbj(c))&&b.appendChild(a);return b}}Object(m.a)(UJ,"HtmlExportProcessor",null,[412]);class WC{constructor(){this.zGc=
null}get rootNode(){return this.zGc}clone(){return Object.assign(new WC,{zGc:this.rootNode})}}Object(m.a)(WC,"HtmlExportContext",null,[]);class VJ{Ubj(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new WC,{zGc:f}));return c}}Object(m.a)(VJ,"HtmlExportUtils",null,[414]);class WJ{constructor(a){this.zxe=null;this.Pq=a}get n_i(){return this.zxe=this.zxe||document.createElement("div")}Xbj(a,b){if(!a||!a.rootNode||!b)return null;b.QCa(this.n_i);const c=this.Pq.ke(3);try{c.ld(a.rootNode),
c.aMa(b.Na),b.my(a.rootNode),b.pAa()}finally{c&&c.dispose()}a=b.b0f;b.detach();return a}}Object(m.a)(WJ,"HtmlGenerator",null,[413]);class XC{constructor(a,b,c){this.vmk=a;this.wmk=b;this.Tb=c}get name(){return"PPTTableHtmlExportHandler"}UWj(a){return 14===a.rootNode.type?!0:10===a.rootNode.type?(a=Object(sa.a)(4,a.rootNode),!!a&&a.xd):!1}Tbj(a){return this.wmk.Xbj(this.Xxj(a),this.vmk)}Xxj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Tb.Lc(a.rootNode);a.Db(1);b.zGc=a.Db(2);return b}return a}}
Object(m.a)(XC,"PPTTableHtmlExportHandler",null,[601]);class YC extends ag.a{constructor(a,b){super(new Lf.a,a,b)}get b0f(){return this.WKh}}Object(m.a)(YC,"AHtmlExportView",ag.a,[542,177,172,108]);class ZC{}ZC.s4i="ExportedPPTTable";Object(m.a)(ZC,"HtmlExportConstants",null,[]);class $C extends YC{constructor(a,b){super(a,b)}get b0f(){const a=this.WKh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],ZC.s4i),a[0]):null}get lm(){return!0}get ZF(){return 480}}Object(m.a)($C,
"PPTTableHtmlExportView",YC,[]);class aD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Xb(a){this.K=a;this.K.register(412,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").na().oa(()=>new UJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(413,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").na().oa(()=>new WJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));
this.K.register(414,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").na().oa(()=>new VJ);this.MIi()}init(){}dispose(){}MIi(){this.K.register($C,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").na().oa(()=>new $C(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));this.K.register(XC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").na().oa(()=>new XC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){n.a.instance.Ac(new aD)}}Object(m.a)(aD,"HtmlExportPackage",null,[2,3]);class wz extends ei.a{constructor(a,b){super();this.tAc=0;this.SJd=null;this.Fo="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.hnf=a;this.gnf=b;this.ig="LanguageDialog"}Kuc(){this.hg=this.j$d();this.tAc=({rlh:a}=this.hnf.Ccg()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.sj(Box4Intl.Box4Strings.l_Language,Object(H.a)(this,this.Bql,"setLanguageHandler"),a);this.SJd=document.getElementById("LanguageList");this.gnf.iUk(this.SJd,this.tAc)}j$d(){return ei.a.pz(this.Fo,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}Bql(a,
b){if(M.a.instance.ga(70)){var c=cc.a.instance.eq(C.a.Aql);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.SJd.value),this.hnf.AAh(b,a),c.properties.$("PreviousLCID",this.tAc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.gnf.zql(b,this.tAc)),Sc.App.Mb.updateCommandUI(!0));c.end()}}}Object(m.a)(wz,"LanguageDialog",ei.a,[549]);class XJ{constructor(){this.A$j=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(H.a)(this,this.J$j,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){ya.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}hjl(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}J$j(a,b){b=b.toLowerCase();for(const c of this.A$j)if(b===c)return;ya.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(m.a)(XJ,"JSanityHelper",null,[410]);class bD extends wz{constructor(a,
b,c){super(a,c);this.ilk=b}j$d(){return this.ilk.DVa?ei.a.pz(this.Fo,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.j$d()}}Object(m.a)(bD,"PPTLanguageDialog",wz,[]);class YJ{constructor(a,b,c,f){this.Xtk=a;this.bkk=b;this.Hok=c;this.pG=f}getInstance(a){return new bD((a?this.Xtk:this.bkk)(),this.pG,this.Hok)}}Object(m.a)(YJ,"PPTLanguageDialogFactory",null,[408]);var gj=d(124);class ZJ{constructor(){this.D6e="rect,circle,ellipse,line,polyline,polygon,path";
this.Iwd=[];this.cha=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.LQe=96}PPl(a,b=null){try{const c=this.Xde(a);if(!c)return null;const f=b?oc.a.fH(b.ND):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const y=c[b];y.setAttribute(gj.a.C8d,f);y.setAttribute(gj.a.I1f,l)}return a}catch(c){return ya.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}fOh(a,b=null){try{const c=this.Xde(a);if(!c)return null;const f=b?oc.a.fH(b.ND):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const y=c[b];y.setAttribute(gj.a.rwd,f);y.setAttribute(gj.a.dIh,l)}return a}catch(c){return ya.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}QPl(a,b){try{const f=this.Xde(a);if(!f)return null;var c=this.Utj(b);let l="";for(const y of c)l+=
y+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const y=f[c];y.setAttribute(gj.a.cIh,l);y.setAttribute(gj.a.S5e,"miter");y.setAttribute(gj.a.JGl,"4");switch(b){case 8:y.setAttribute(gj.a.R5e,"round");break;case 2:case 0:y.setAttribute(gj.a.R5e,"butt");break;default:y.setAttribute(gj.a.R5e,"round")}}return a}catch(f){return ya.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}gOh(a,b,c,f){try{if(!a)return null;
this.QAh(c,b*this.LQe*f/Oe.a.dEa,a);return a}catch(l){return ya.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}Wtj(){if(!this.Iwd||1>this.Iwd.length)this.Iwd=this.D6e.split(",");return this.Iwd}Xde(a){if(!a)return null;a=a.querySelectorAll(this.D6e);return 1>a.length?null:a}QAh(a,b,c){if(c){var f=c.getAttribute(gj.a.OQb)?c.getAttribute(gj.a.OQb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.Wtj())if(l===a){c.setAttribute(gj.a.T5e,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.QAh(f,b,c.children[l])}}Utj(a){switch(a){case 0:return this.cha[0];case 1:return this.cha[1];case 2:return this.cha[2];case 3:return this.cha[3];case 4:return this.cha[4];
case 5:return this.cha[5];case 6:return this.cha[6];case 7:return this.cha[7];case 8:return this.cha[8];case 9:return this.cha[9];case 10:return this.cha[10];default:return ya.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.cha[0]}}}Object(m.a)(ZJ,"SVGIconLocalEditor",null,[411]);class $J{constructor(a,b){this.f0g=b;this.Vd=a}hD(a,b){if(!a)return!1;const c=a.W_(f=>!f.Ik).length;return!this.Ewl(a.M4b,c+b)}KD(a){const b=a.qe+1;this.Vd.rH(222,c=>{c.JC=1;c.jTa=[b.toString(),
this.f0g.toString()];return!1})}Ewl(a,b){if(!a&&b<this.f0g)return!1;ya.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(m.a)($J,"ShapeCountValidator",null,[409]);class cD{constructor(a,b,c,f,l,y){this.Ook=a;this.Fa=b;this.G2g=c;this.Fb=f;this.SJ=l;this.Ga=y}get Nb(){return this.Ook.value}Ccg(){let a,b=0;a=!0;const c=this.Nb.Ud();1===c.length&&c[0].z3c&&(b=this.Ga.iUa(c[0]),a=!this.Ga.Sce(c[0]));return{returnValue:b,rlh:a}}AAh(a,b){const c=this.Nb.Ud();if(1===c.length&&c[0].z3c&&
this.G2g){var f=new J.DictionaryPropertySet;f.setValue(Ya.a.At,a);f.setValue(we.a.zxa,b);a=this.Fb.yd(15);try{a.jc(c[0]);c[0].Fta();const l=Object(sa.a)(4,c[0]);l&&this.SJ&&this.SJ.vUl(l,b);this.G2g.rV(f);this.Fa.Bd()}finally{a&&a.dispose()}}}}Object(m.a)(cD,"ShapeLanguageEditor",null,[501]);class dD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Xb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(wz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").oa(()=>
new bD(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(408,"PowerPointWebEditor.IPPTLanguageDialogFactory").na().oa(()=>new YJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(cD,"PowerPointWebEditor.ShapeLanguageEditor").na().oa(()=>
new cD(this.K.ue("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.rb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(409,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").na().oa(()=>new $J(Fb.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.rd.powerPointEditServerEditableShapeCountThreshold));
this.K.register(410,"PowerPointWebEditor.IJSanityHelper").na().oa(()=>new XJ);this.K.register(411,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").na().oa(()=>new ZJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){n.a.instance.Ac(new dD)}}Object(m.a)(dD,"PPTWebEditorShapeEditPackage",null,[2,3]);var eD=d(311),Nv=d(251);class gt{static get Q_(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":
document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():ha.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?
document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ha.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get ybc(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get H9(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}
Object(m.a)(gt,"FullscreenUtils",null,[]);class aK{get Q_(){return gt.Q_}requestFullscreen(a){gt.requestFullscreen(a)}exitFullscreen(){gt.exitFullscreen()}get ybc(){return gt.ybc}get H9(){return gt.H9}get SJf(){return this.ybc&&!z.a.Fx}}Object(m.a)(aK,"FullscreenUtilsProxy",null,[399]);class bK{vmj(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(m.a)(bK,"InkButtonHelper",null,[404]);class cK{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=
null;this.autoOpenMenu=!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(m.a)(cK,"FlyoutMenuExtraProps",null,[]);class Ox{}Ox.Uwi="_136_16_N_20";Ox.Vwi="none";Object(m.a)(Ox,"InkButtonConstants",null,[]);class xz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(m.a)(xz,"InkButtonProps",null,[]);class fD{constructor(){this.onInkMenuActivity=null}}Object(m.a)(fD,"IInkButtonSettings",
null,[]);class dK extends fD{constructor(){super()}}Object(m.a)(dK,"InkButtonSettings",fD,[]);class eK{constructor(){this.color=this.item=null}}Object(m.a)(eK,"InkManagerActivity",null,[]);class yz{constructor(){this.mDe=!1;this.yHe=this.XHe=0;this.qxe=""}get P4(){return this.mDe}set P4(a){this.mDe=a}get startingSlideIndex(){return this.XHe}set startingSlideIndex(a){this.XHe=a}get Gpa(){return this.yHe}set Gpa(a){this.yHe=a}get QVf(){return this.qxe}set QVf(a){this.qxe=a}get w9k(){const a={};a.IsStartRehearsal=
this.mDe;a.StartingSlideIndex=this.XHe;a.SlideCount=this.yHe;a.DisabledRehearsalRealtimeFeaturesStr=this.qxe;return JSON.stringify(a)}}Object(m.a)(yz,"RehearsalContext",null,[402]);class zz extends ei.a{constructor(a,b,c){super(!1,!0);this.kFe=50001;this.kb=a;this.le=b;this.ap=new yz;this.Ya=c;this.kb.jja(Object(H.a)(this,this.mga,"onSlideshowExitHandler"));this.kb.Y_b(Object(H.a)(this,this.gga,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.XHa=!1}dispose(){super.dispose();this.XHa||
this.kb.restoreFocus()}Gu(){super.Gu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.kFe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}ZA(){super.ZA();var a=document.getElementById(this.Vh("WACDialogPanel"));a.style.minWidth=k.a.Pc(300);a.style.width=k.a.Pc(300);a=document.getElementById(this.Vh("WACDialogButtonPanel"));var b=document.getElementById(this.Vh("WACDialogActionButton"));a&&
b&&a.removeChild(b);if(a=document.getElementById(this.Vh("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.Vh("WACDialogPanel"))){b=k.a.ee();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=k.a.mda();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){ya.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.le.qk("SubtitleProactive_clearly.png");const b=this.le.qk("SubtitleProactive_network.png"),c=this.le.qk("SubtitleProactive_noNoise.png");this.hg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.sj("",Object(H.a)(this,this.fga,"onClickHandler"),a);this.kb.setVisibility(!0)}x8(){super.x8()}$sa(){super.$sa()}mkb(){}gga(){this.kb.nkb(Object(H.a)(this,this.gga,"onGetCurrentPositionHandler"));this.open()}mga(){this.XHa=!0;this.kb.Bga(Object(H.a)(this,
this.mga,"onSlideshowExitHandler"));this.kb.nkb(Object(H.a)(this,this.gga,"onGetCurrentPositionHandler"));this.hide()}fga(a){0===a&&(a=Date.now(),this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,3,a,this.ap))}static Jwg(a,b,c){new zz(a,b,c)}}Object(m.a)(zz,"SlideshowSubtitleProactiveDialog",ei.a,[]);var ah=d(688);class fK{constructor(){this.buttonIdDictionary=null}}Object(m.a)(fK,"SlideshowToolbarSettings",null,[]);class Px extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(m.a)(Px,"ReadOutEventArgs",Sys.EventArgs,[]);class gD{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.KEb=this.ap=this.Jc=this.Vea=this.te=this.z9c=this.NHe=this.hi=null;this.OU=this.oZa=this.qZa=this.zEb=this.RXa=this.fBe=0;this.xM=!1;this.GAe=!0;this.O$c=this.zR=this.GIe=this.Ove=!1;this.xFk=()=>{ya.a.J(509157450,830,50,"ReactSlideshowToolbar.OnCameraToggleHandler");this.A$c=!this.A$c;this.APh()};this.wFk=hb=>{hb=hb.id?hb.id:"";ya.a.J(508916299,830,50,`ReactSlideshowToolbar.onCameraSelectionChanged - triggered with ${""===
hb?"invalid":"valid"} id.`);this.kb.zPh(hb);this.PQh()};this.AQj=()=>{this.tqk.execute(this.zQj);this.hi.registerButtonCallback(ah.a.OptionsButton,this.o_i)};this.zQj=hb=>{this.IPg||(this.IPg=hb.qqj({onCameraMenuActivity:this.wFk,defaultCameraLabel:""}),ya.a.J(508916298,830,50,"ReactSlideshowToolbar.initOptionsButton - OptionsButtonManager created."));this.PQh()};this.o_i=()=>{};this.kb=c;this.tf=G;this.vu=R;this.Ya=za;this.ia=a;this.Da=b;this.kJe=l;this.Vb=y;this.Rmk=Fb.a.instance.Ia("PowerPointWebEditor.IInkButtonHelper");
this.Da.N_&&(this.tqk=Fb.a.instance.Ia("PowerPointWebEditor.IOptionsButtonLoader"));this.le=f;this.tu=Va}init(a,b){ya.a.J(512495955,830,50,"ReactSlideshowToolbar.Init");this.GAe=!0;this.Ove=!1;var c={};c[ah.a.MicButton]=this.Da.isMicButtonInSlideShowToolbarEnabled;c[ah.a.PrevButton]=!0;c[ah.a.NextButton]=!0;c[ah.a.GridButton]=!0;c[ah.a.InkButton]=!0;c[ah.a.SubtitlesButton]=!0;c[ah.a.LiveButton]=!0;c[ah.a.MoreButton]=!0;c[ah.a.CameraButton]=this.Da.N_;c[ah.a.ExitButton]=!0;c[ah.a.OptionsButton]=this.Da.N_;
c[ah.a.CoachButton]=this.Da.isCoachButtonInSlideShowToolbarEnabled;this.NHe=new fK;this.NHe.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.te=document.createElement("div");this.te.id="slideshow-toolbar";this.te.className="ReactSlideshowToolbar";this.Da.pptEditorVoiceUXEnabled&&(this.z9c=document.getElementById("slideshowfooterContainerElement"),this.te.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");c.id="slideshow-toolbar-accessibility";c.style.position=
"absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Da.pptEditorVoiceUXEnabled?this.z9c.appendChild(this.te):this.tf.appendChild(this.te);this.hi=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.NHe,this.te);if(!this.hi){ya.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const f=Of.a.Ph(359);w.AFrameworkApplication.No(f);
Sf.Health.instance.recordQosError(Of.a.kda(f),["SlideShowACE"],!1,!0,!0,!1,null)}this.hi.renderToolbar();this.te.appendChild(c);this.te.tabIndex=0}this.Vea||(this.Vea=document.createElement("div"),this.Vea.id="SlideshowToolbarCalloutMenuContainer",this.Vea.className="SlideshowToolbarCalloutMenuContainer",this.vu()&&(this.Vea.style.direction=qe.a.k2a),this.tf.appendChild(this.Vea));this.Jc=a;this.ap=b;this.hi.registerButtonCallback(ah.a.MicButton,()=>{this.rJk()});this.hi.registerButtonCallback(ah.a.CoachButton,
()=>{this.RFk()});this.Da.N_&&(this.hi.registerButtonCallback(ah.a.CameraButton,this.xFk),this.YPj(),this.hi.registerButtonCallback(ah.a.OptionsButton,this.AQj),this.hi.showToolbarButton(ah.a.OptionsButton));this.Jc.Rh||this.Vb&&this.Vb.instance&&this.Vb.instance.lr?(this.zR=!0,this.hi.setToolbarButtonToggleState(ah.a.MicButton,this.zR),this.hi.showToolbarButton(ah.a.MicButton)):(this.zR=!1,this.hi.setToolbarButtonToggleState(ah.a.MicButton,this.zR),this.hi.hideToolbarButton(ah.a.MicButton));this.hi.registerButtonCallback(ah.a.PrevButton,
f=>{this.sJb(f)});this.hi.registerButtonCallback(ah.a.NextButton,f=>{this.nJb(f)});this.hi.registerButtonCallback(ah.a.GridButton,f=>{this.iJb(f)});this.hi.showToolbarButton(ah.a.GridButton);this.Jc.hxb&&!this.ap.P4&&(this.hi.registerButtonCallback(ah.a.SubtitlesButton,f=>{this.kld(f)}),this.hi.setToolbarButtonToggleState(ah.a.SubtitlesButton,this.Jc.Rh),this.hi.showToolbarButton(ah.a.SubtitlesButton));this.hi.registerButtonCallback(ah.a.ExitButton,f=>{this.hJb(f)});this.Da.isInkingInSlideShowEnabled&&
this.Da.isInkUIInSlideShowEnabled&&(a=xz.create(),a.icon=Ox.Uwi,a.selectedColor=Ox.Vwi,this.hi.updateElementProps(ah.a.InkButton,a),this.hi.registerButtonCallback(ah.a.InkButton,()=>{this.nQj()}),this.hi.showToolbarButton(ah.a.InkButton));this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&!this.ap.P4&&(this.hi.registerButtonCallback(ah.a.LiveButton,()=>{this.$Ik()}),this.hi.updateFlyoutButtonCallback(ah.a.LiveButton,this.Vb.instance.lr),this.hi.setToolbarButtonToggleState(ah.a.LiveButton,this.Vb.instance.lr),
this.hi.showToolbarButton(ah.a.LiveButton),this.Vb.instance.iBf(Object(H.a)(this,this.tnc,"onLiveSessionStarted")),this.Vb.instance.gBf(Object(H.a)(this,this.snc,"onLiveSessionEnded")),this.Vb.instance.eBf(Object(H.a)(this,this.rnc,"onLiveRelaunchPausedSession")),this.Vb.instance.dji(Object(H.a)(this,this.Mbh,"onLiveCalloutMenuDefintionChanged")));this.mRb();this.Bxb();this.kb.jja(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.tUd(Object(H.a)(this,this.oib,"onBrowserEventHandler"));this.kb.QJc(Object(H.a)(this,
this.Gxa,"onGetCurrentSlideDimensionsHandler"));this.kb.VJc(Object(H.a)(this,this.Qxa,"onSpecialKeyHandler"));this.kb.vUd(Object(H.a)(this,this.pib,"onContextMenuHandler"));this.kb.xUd(Object(H.a)(this,this.Bjd,"onEnterEndOfShowHandler"));this.kb.zUd(Object(H.a)(this,this.$jd,"onLeaveEndOfShowHandler"));md.a.addHandler(this.te,pa.a.tq,Object(H.a)(this,this.yib,"onMouseOverHandler"));md.a.addHandler(this.te,pa.a.Zs,Object(H.a)(this,this.vnc,"onMouseOutHandler"));md.a.addHandler(this.Vea,pa.a.click,
Object(H.a)(this,this.fga,"onClickHandler"));md.a.addHandler(this.te,pa.a.Df,Object(H.a)(this,this.XJa,"onKeyDownHandler"))}kBl(){window.clearTimeout(this.fBe);this.fBe=window.setTimeout(Object(H.a)(this,this.uMj,"hideMouse"),3E3);this.kb.Tga(!0)}uMj(){this.xM||(window.clearTimeout(this.fBe),this.kb.Tga(!1))}cF(a,b){b?this.hi.showToolbarButton(a):this.hi.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.hi.setToolbarButtonToggleState(a,b)}show(){if(this.vu()){const a=document.getElementById("slideshow-toolbar");
if(a){const b=(this.qZa+this.OU-16-this.hi.getToolbarWidth()).toString()+"px";a.style.left=b}}this.hi.showToolbar();this.hi.enterFocusTrapZone();window.clearTimeout(this.RXa);window.clearTimeout(this.zEb);this.GAe?(this.RXa=window.setTimeout(Object(H.a)(this,this.hide,"hide"),2E3),this.GAe=!1,this.Ove=!0):this.RXa=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3);this.kb.Tga(!0)}zFh(){if(this.vu()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.qZa+this.OU-16-this.hi.getToolbarWidth()).toString()+
"px";a.style.left=b}}this.hi.showToolbar();this.hi.enterFocusTrapZone();window.clearTimeout(this.RXa);window.clearTimeout(this.zEb);this.zEb=window.setTimeout(Object(H.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.xM){const a=document.getElementById("slideshow-toolbar");a&&!this.hi.isAnyToolbarElementFocused()&&document.activeElement===a&&this.N2a(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.RXa);window.clearTimeout(this.zEb);this.hi.hideToolbar();this.kb.Tga(!1);this.te.style.display===
qe.a.Qe&&this.kb.restoreFocus()}}Bxb(){this.xM||(this.Ove&&this.N2a(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.RXa),window.clearTimeout(this.zEb),this.hi.forceHideToolbar(),this.kb.Tga(!1),this.te.style.display===qe.a.Qe&&this.kb.restoreFocus())}remove(){this.hi.closeToolbar();this.Vea.style.visibility=qe.a.ft;this.O$c=!1;this.kb.Bga(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.gXe(Object(H.a)(this,this.oib,"onBrowserEventHandler"));this.kb.jqd(Object(H.a)(this,this.Gxa,
"onGetCurrentSlideDimensionsHandler"));this.kb.mqd(Object(H.a)(this,this.Qxa,"onSpecialKeyHandler"));this.kb.iXe(Object(H.a)(this,this.pib,"onContextMenuHandler"));this.kb.jXe(Object(H.a)(this,this.Bjd,"onEnterEndOfShowHandler"));this.kb.lXe(Object(H.a)(this,this.$jd,"onLeaveEndOfShowHandler"));md.a.removeHandler(this.te,pa.a.tq,Object(H.a)(this,this.yib,"onMouseOverHandler"));md.a.removeHandler(this.te,pa.a.Zs,Object(H.a)(this,this.vnc,"onMouseOutHandler"));md.a.removeHandler(this.Vea,pa.a.click,
Object(H.a)(this,this.fga,"onClickHandler"));md.a.removeHandler(this.te,pa.a.Df,Object(H.a)(this,this.XJa,"onKeyDownHandler"));this.te&&(this.tf.contains(this.te)||this.z9c&&this.z9c.contains(this.te))&&(this.xM=!1);this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&(this.Vb.instance.vrh(Object(H.a)(this,this.tnc,"onLiveSessionStarted")),this.Vb.instance.urh(Object(H.a)(this,this.snc,"onLiveSessionEnded")),this.Vb.instance.srh(Object(H.a)(this,this.rnc,"onLiveRelaunchPausedSession")),this.Vb.instance.tbl(Object(H.a)(this,
this.Mbh,"onLiveCalloutMenuDefintionChanged")))}noa(){this.remove()}N2a(a){na.a.Xa(a)?ya.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.kJe.vnh(new Px(a))}Gxa(a,b){try{this.qZa=b.ZFh;this.oZa=b.VFh;this.OU=b.slideWidth;if("NaN"===this.qZa.toString()||"NaN"===this.oZa.toString()){ya.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=Of.a.Ph(359);w.AFrameworkApplication.No(c);
Sf.Health.instance.recordQosError(Of.a.kda(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Vb.instance&&this.Vb.instance.lr&&!this.O$c?26:0;if(this.Da.pptEditorVoiceUXEnabled){const f=document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.vu()?(this.qZa+this.OU-16-this.hi.getToolbarWidth()).toString()+"px":(this.qZa+2).toString()+"px";f.style.left=l;if(this.Jc.Rh&&"AboveSlide"===this.Jc.gw)f.style.bottom="0px";else{const G=Ga.a.LYc();a=0;const R=document.getElementById("AppHeaderPanel");
R&&(a=R.clientHeight);f.style.bottom=this.tu.H9?(G-this.oZa-c).toString()+"px":(G-this.oZa-a-c).toString()+"px"}f.style.top="auto";const y=document.getElementById("ReactToolbarInnerContainer");y&&(y.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.vu()?(this.qZa+this.OU-16-this.hi.getToolbarWidth()).toString()+"px":(this.qZa+2).toString()+"px";f.style.left=l;const y=this.Vb.instance&&this.Vb.instance.lr?(this.oZa+c).toString()+"px":this.oZa.toString()+
"px";"AboveSlide"===this.Jc.gw?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=y,f.style.bottom="auto");f.style.top=y}}}this.show()}catch(c){ya.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",c)}}Bjd(){this.O$c=!0}$jd(){this.O$c=!1}XJa(a){this.hi.isAnyCalloutMenuOpen()||(this.xM=!1);try{this.te.style.display===qe.a.Tj&&(a.keyCode===B.a.eob||a.keyCode===B.a.rF||a.keyCode===
B.a.B2?this.kb.prev():a.keyCode===B.a.q3a||a.keyCode===B.a.qF||a.keyCode===B.a.A2?this.kb.next():a.keyCode===B.a.BZ?this.vu()?this.kb.next():this.kb.prev():a.keyCode===B.a.JV?this.vu()?this.kb.prev():this.kb.next():a.keyCode===B.a.pNa?(this.GIe=!0,this.Bxb()):a.shiftKey&&a.keyCode===B.a.hqa||a.keyCode===B.a.oSb?this.Bxb():this.kb.T_e(a))}catch(b){ya.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}Qxa(a,b){this.hi.isAnyCalloutMenuOpen()||(this.xM=
!1);if(b.key===B.a.oSb||b.shiftKey&&b.key===B.a.hqa)a="off",this.te.style.display===qe.a.Qe?(this.zFh(),a="on"):this.Bxb(),ya.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}pib(){if(this.GIe)this.GIe=!1;else{var a="off";this.te.style.display===qe.a.Qe?(this.zFh(),a="on"):this.hi.isAnyCalloutMenuOpen()||this.Bxb();ya.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",
a)}}oib(a,b){this.kBl();b.clientY<this.oZa+8+20&&b.clientY>this.oZa-20-8&&this.show()}yib(a){(a=a.target)&&this.te.contains(a)&&(this.xM=!0)}vnc(a){a.target&&(this.hi.isAnyCalloutMenuOpen()?this.Vea.style.visibility=qe.a.Tz:(this.xM=!1,this.show()));this.hi.isAnyCalloutMenuOpen()||this.hi.enterFocusTrapZone()}fga(a){this.xM=!1;window.clearTimeout(this.RXa);window.clearTimeout(this.zEb);this.Vea.style.visibility=qe.a.ft;this.RXa=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===
a.target.id&&this.hi.enterFocusTrapZone()}sJb(){ya.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.kb.prev()}nJb(){ya.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.kb.next()}hJb(){ya.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.hi.closeToolbar();this.kb.exit()}C8e(a){const b=!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.lr;var c=this.Jc.z0f&&5!==a&&!b;5!==a&&(this.Jc.Rh&&(Ti.a.qK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",
Ti.a.aK)||ya.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Jc.Rh=!this.Jc.Rh);this.hi.setToolbarButtonToggleState(ah.a.SubtitlesButton,this.Jc.Rh);ya.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",this.Jc.Rh);this.Jc.Rh&&c&&zz.Jwg(this.kb,this.le,this.Ya);c||(c=Date.now(),b?this.zR||this.Vb.instance.lxb()?this.kb.toggleTranscriberUIVisibility(null):
(this.Vb.instance.mhg(),this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,a,c,this.ap)):this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,a,c,this.ap));this.zR=this.Jc.Rh||b;this.Bzd();this.mRb()}Bzd(){this.hi.setToolbarButtonToggleState(ah.a.MicButton,this.zR);this.zR?this.hi.showToolbarButton(ah.a.MicButton):this.hi.hideToolbarButton(ah.a.MicButton)}mRb(){const a=this.Jc.Rh,
b=!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.lr,c=this.ap.P4,f=32!==this.ia.processAction(ea.a.zga,1);a||b||c||f?this.hi.hideToolbarButton(ah.a.CoachButton):this.hi.showToolbarButton(ah.a.CoachButton)}rJk(){ya.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.zR=!this.zR;this.hi.setToolbarButtonToggleState(ah.a.MicButton,this.zR);this.kb.setMicrophoneState(!this.zR);if(this.Vb&&this.Vb.instance&&this.Vb.instance.lr&&this.zR&&!this.Vb.instance.lxb()){this.Vb.instance.mhg();
const a=this.Jc.Rh;this.Vb.instance.Ida=!this.Jc.Rh;this.Jc.Rh=!0;this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,5,Date.now(),this.ap);this.Jc.Rh=a}}Qpi(){return Object(ii.a)(this,void 0,void 0,function*(){try{return navigator.permissions?"denied"!==(yield navigator.permissions.query({name:"camera"})).state:(ya.a.J(508908556,830,10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - insecure context."),!1)}catch(a){return ya.a.J(508885084,
830,10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - exception="+a),!1}})}YPj(){Object(ii.a)(this,void 0,void 0,function*(){this.A$c=yield this.Qpi();this.APh();this.hi.showToolbarButton(ah.a.CameraButton)})}APh(){this.hi.setToolbarButtonToggleState(ah.a.CameraButton,this.A$c);this.kb.Iyh(this.A$c)}PQh(){Object(ii.a)(this,void 0,void 0,function*(){const a=yield this.IPg.getControlsInMenuAsync();this.hi.updateElementProps(ah.a.OptionsButton,{menuDefinition:a,menuHostId:"SlideshowToolbarCalloutMenuContainer"})})}RFk(){ya.a.J(512495941,
830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.Ja(ea.a.zga,2,{entryPoint:2})?this.Da.pptEditorRehearsalSpeechClientEnabled||(this.ap.P4=!0):ya.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}kld(){ya.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.C8e(3)}iJb(){ya.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.Ja(ea.a.dPb,2,null)}$Ik(){this.Vb&&this.Vb.instance&&(ya.a.J(512495937,
830,50,"FLiveBroadcastInUse is changed to: {0}",this.Vb.instance.lr),this.Vb.instance.lr||(this.Vb.instance.hvc(3,w.AFrameworkApplication.userSessionId,this.Da.podsWebServiceBase,this.Ya.podSessionId,w.AFrameworkApplication.Pg),this.Vb.instance.Ida=!this.Jc.Rh,this.Jc.hxb&&!this.Jc.Rh&&(ya.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Jc.Rh=!0,this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,
5,Date.now(),this.ap),this.Jc.Rh=!1,this.zR=!0,this.Bzd()),this.xM=!1,this.hi.setToolbarButtonToggleState(ah.a.LiveButton,!0)));this.mRb()}tnc(){this.hi.setToolbarButtonToggleState(ah.a.LiveButton,!0);this.Azd(!1,!1);this.zR=!0;this.Bzd();this.mRb();this.D7g()}snc(){this.hi.setToolbarButtonToggleState(ah.a.LiveButton,!1);this.Azd(!1,!0);this.Vb&&this.Vb.instance&&this.Vb.instance.Ida&&!this.Jc.Rh&&(ya.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(w.AFrameworkApplication.userSessionId,
this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,5,Date.now(),this.ap));this.Vb.instance.Ida=!1;this.Jc.Rh||(this.zR=!1,this.Bzd());this.mRb()}rnc(){this.Vb&&this.Vb.instance&&(this.xM=!0,this.show(),this.Vea.style.visibility=qe.a.Tz,this.Azd(!0,!1),this.D7g());this.mRb()}D7g(){this.Da.knd&&!this.Vb.instance.lxb()&&(this.zR=!1,this.hi.setToolbarButtonToggleState(ah.a.MicButton,this.zR),this.Jc.Rh=!1,this.hi.setToolbarButtonToggleState(ah.a.SubtitlesButton,this.Jc.Rh))}Mbh(){this.Azd(!1,
!1)}Azd(a,b){if(this.Vb&&this.Vb.instance){const c=new cK;c.menuDefinition=b?null:this.Vb.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.hi.updateElementProps(ah.a.LiveButton,c);this.hi.updateFlyoutButtonCallback(ah.a.LiveButton,!b)}}nQj(){this.Rmk.execute(Object(H.a)(this,this.mQj,"initInkButton"));const a=new eK;a.item="Init";this.kb.lRe(a);this.hi.registerButtonCallback(ah.a.InkButton,()=>{})}mQj(a){const b=new dK;b.onInkMenuActivity=c=>{this.wIk(c)};this.KEb=a.vmj(b);a=xz.create();
a.icon=this.KEb.getIcon();a.menuDefinition=this.KEb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.hi.updateElementProps(ah.a.InkButton,a)}wIk(a){this.kb.lRe(a);a=xz.create();a.selectedColor=this.KEb.getSelectedColor();a.icon=this.KEb.getIcon();a.menuDefinition=this.KEb.getControlsInMenu();this.hi.updateElementProps(ah.a.InkButton,a);this.Bxb()}}Object(m.a)(gD,"ReactSlideshowToolbar",null,[890,891]);class hD{constructor(a,b){this.Uk=a;this.Bgc=document.createElement("div");
this.Bgc.id="slideshowfooterContainerElement";this.Bgc.className="slideshowFooterContainer";this.ia=b}init(){ya.a.J(595198370,830,50,"SlideShowFooterContainer.Init");this.Uk&&this.Uk.appendChild(this.Bgc)}remove(){this.Uk&&this.Uk.contains(this.Bgc)&&this.Uk.removeChild(this.Bgc)}vb(){this.ia.ya(ea.a.CEh,qc.a.application,Object(H.a)(this,this.GAl,"showFooterElements"));this.ia.ya(ea.a.Gjg,qc.a.application,Object(H.a)(this,this.qMj,"hideFooterElements"))}GAl(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&
(a.style.display="flex");return 32}qMj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=qe.a.Qe);return 32}}Object(m.a)(hD,"SlideShowFooterContainer",null,[892]);class gK{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(m.a)(gK,"IVoiceActorSettings",null,[]);class hK{constructor(){this.xlc=this.Uk=this.Hhb=null}init(){ya.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.Hhb=document.createElement("div");this.Hhb.id="voiceNotificationContainerElement";
this.Hhb.className="voiceNotificationContainer";(this.Uk=document.getElementById("slideshowfooterContainerElement"))&&this.Uk.insertBefore(this.Hhb,this.Uk.firstChild);const a=new gK;a.baseZIndex=50002;a.hostElement=this.Hhb;this.xlc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.Uk&&this.Uk.contains(this.Hhb)&&this.Uk.removeChild(this.Hhb)}show(a,b){this.xlc&&this.xlc.showNotification(a,b)}hide(){this.xlc&&this.xlc.hideNotification()}}Object(m.a)(hK,"SlideShowVoiceNotification",null,
[405]);class iD extends ei.a{constructor(a,b){super(!1,!0);this.Bkc=null;this.teb=this.xXa=0;this.kFe=50001;this.sFb=null;this.kb=a;this.bqk=b;this.kb.jja(Object(H.a)(this,this.mga,"onSlideshowExitHandler"));this.kb.Y_b(Object(H.a)(this,this.gga,"onGetCurrentPositionHandler"));this.kb.getCurrentPosition();this.XHa=!1}get Ovd(){if(void 0===this.Bkc||null===this.Bkc)this.Bkc=document.getElementById("GotoDlgInput");return this.Bkc}tXl(){if(!RegExp("^[0-9]+$").test(this.Ovd.value))return this.Ovd.value=
this.xXa.toString(),!1;this.teb=Number.parseInvariant(this.Ovd.value);this.teb=Math.min(this.teb,this.bqk);this.teb=Math.max(this.teb,1);return!0}dispose(){super.dispose();this.Bkc=null;this.XHa||this.kb.restoreFocus()}Gu(){super.Gu();document.getElementById("WACDialogOverlay").style.zIndex=String(this.kFe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}ZA(){super.ZA();const a=document.getElementById(this.Vh("WACDialogPanel"));
a.style.minWidth=k.a.Pc(300);a.style.width=k.a.Pc(300)}open(){ya.a.J(24133980,830,50,"SlideshowGoToDialog: Open");this.hg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.xXa.toString()};this.sj(ResourceStrings.L_GoTo,Object(H.a)(this,this.fga,"onClickHandler"),a);this.kb.setVisibility(!0);this.Ovd.focus()}x8(){super.x8();this.sFb=Object(H.a)(this,this.XJa,"onKeyDownHandler");
w.AFrameworkApplication.Aa.DG.Ipd(pa.a.Df,window.document,this.sFb,null)}$sa(){super.$sa();void 0!==this.sFb&&null!==this.sFb&&w.AFrameworkApplication.Aa.DG.w$e(pa.a.Df,window.document,this.sFb);this.sFb=null}mkb(){}gga(a,b){this.kb.nkb(Object(H.a)(this,this.gga,"onGetCurrentPositionHandler"));this.xXa=b.slideIndex+1;this.open()}mga(){this.XHa=!0;this.kb.Bga(Object(H.a)(this,this.mga,"onSlideshowExitHandler"));this.kb.nkb(Object(H.a)(this,this.gga,"onGetCurrentPositionHandler"));this.hide()}XJa(a){a=
a.nc.keyCode;return a===B.a.jp?(this.tXl()&&(this.HUa(this.teb),this.hide()),!0):a===B.a.pSb||a===B.a.rNa||a===B.a.rSh||a===B.a.iAd?!0:!1}fga(a){1===a&&this.HUa(this.teb)}HUa(a){this.kb.HUa(a-1)}static $ak(a,b){1>=b||void 0!==zi.a.wx&&null!==zi.a.wx||new iD(a,b)}}Object(m.a)(iD,"SlideshowGoToDialog",ei.a,[]);class jD{constructor(a,b,c,f,l,y,G,R,ja){this.y5=this.K=null;this.QEb=!1;this.h5=[];this.CXa=this.CE=this.Ggc=null;this.kb=a;this.Sb=b;this.bwa=c;this.ia=f;this.$d=l;this.tf=y;this.vu=G;this.tu=
R;this.Vb=ja}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",this.K.className="SlideshowContextMenuContainer");this.y5=document.createElement("div");this.y5.className="SlideshowContextMenu cui-menu";this.y5.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.vu();let c=this.tL(ResourceStrings.L_Next,Object(H.a)(this,this.nJb,"onNextClickHandler"),b);Array.add(this.h5,c);a.appendChild(c);
c=this.tL(ResourceStrings.L_Previous,Object(H.a)(this,this.sJb,"onPrevClickHandler"),b);Array.add(this.h5,c);a.appendChild(c);c=this.tL(ResourceStrings.l_GotoCell,Object(H.a)(this,this.hIk,"onGoToClickHandler"),b);Array.add(this.h5,c);a.appendChild(c);c=this.tL(ResourceStrings.L_GridView_SeeAllSlides,Object(H.a)(this,this.iJb,"onGridViewClickHandler"),b);Array.add(this.h5,c);a.appendChild(c);this.tu.SJf&&(this.Ggc=this.tL(this.tu.H9?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,
Object(H.a)(this,this.WJa,"onFullscreenClickHandler"),b),Array.add(this.h5,this.Ggc),a.appendChild(this.Ggc),this.tu.Q_&&!this.CE&&(this.CE=Object(H.a)(this,this.knc,"onFullscreenChangeHandler"),$addHandler(this.tf,this.tu.Q_,this.CE)));c=this.tL(ResourceStrings.L_EndShow,Object(H.a)(this,this.hJb,"onExitClickHandler"),b);Array.add(this.h5,c);a.appendChild(c);this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&(this.CXa=this.tL(ResourceStrings.l_EndLivePresentation,Object(H.a)(this,this.eHk,"onEndLivePresentationClickHandler"),
b),Array.add(this.h5,this.CXa));this.y5.appendChild(a);this.K.appendChild(this.y5);this.tf.appendChild(this.K);this.bwa.addHandler(this.K,pa.a.click,Object(H.a)(this,this.fga,"onClickHandler"));this.bwa.addHandler(this.K,pa.a.contextMenu,Object(H.a)(this,this.lbh,"onHostContextMenuHandler"));this.bwa.addHandler(this.y5,pa.a.tq,Object(H.a)(this,this.yib,"onMouseOverHandler"));this.kb.vUd(Object(H.a)(this,this.pib,"onContextMenuHandler"));this.kb.jja(Object(H.a)(this,this.noa,"onExitHandler"))}show(){if(this.Vb&&
this.Vb.instance&&this.Vb.instance.lr&&this.CXa&&!this.CXa.parentNode){const a=this.y5.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.CXa)}this.QEb||(this.bwa.addHandler(window.document,pa.a.Df,Object(H.a)(this,this.XJa,"onKeyDownHandler")),this.bwa.addHandler(window.document,pa.a.Tl,Object(H.a)(this,this.qnc,"onKeyUpHandler")),this.QEb=!0);this.K.style.visibility=qe.a.Tz}hide(){this.bwa.removeHandler(window.document,pa.a.Df,Object(H.a)(this,
this.XJa,"onKeyDownHandler"));this.bwa.removeHandler(window.document,pa.a.Tl,Object(H.a)(this,this.qnc,"onKeyUpHandler"));this.QEb=!1;this.K.style.visibility=qe.a.ft;if(this.CXa&&this.CXa.parentNode){const a=this.y5.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.CXa)}}remove(){this.K&&(this.bwa.removeHandler(this.K,pa.a.click,Object(H.a)(this,this.fga,"onClickHandler")),this.bwa.removeHandler(this.K,pa.a.contextMenu,Object(H.a)(this,this.lbh,
"onHostContextMenuHandler")),this.tf.contains(this.K)&&this.tf.removeChild(this.K));this.K=null;Array.clear(this.h5)}noa(){this.kb.Bga(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.iXe(Object(H.a)(this,this.pib,"onContextMenuHandler"));this.Ggc&&($removeHandler(this.tf,this.tu.Q_,this.CE),this.CE=null);this.remove()}fga(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.kb.restoreFocus())}pib(a,b){this.cfh(b.clientX,b.clientY)}lbh(a){this.cfh(a.clientX,a.clientY)}yib(a){(a=
a.target)&&"li"===a.tagName.toLowerCase()&&(this.JWe(document.activeElement),this.jS(a))}XJa(a){const b=a.keyCode,c=a.shiftKey;b===B.a.$q||b===B.a.o7?this.E7g(!!(1^c)):b===B.a.CZ&&this.E7g(!!(0^c));a.preventDefault()}qnc(a){var b=a.keyCode;b===B.a.jp||b===B.a.BK?(b=document.activeElement,Array.contains(this.h5,b)&&b.click()):b===B.a.AZ&&this.kb.exit();a.preventDefault()}cfh(a,b){this.setPosition(a,b);this.aEi();this.show();this.y5.focus();this.$d.unh(new Px(ResourceStrings.L_ControlMenu))}setPosition(a,
b){if(this.y5){var c=this.y5.offsetWidth,f=this.y5.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&(a-=c);b+f>l&&(b-=f);this.y5.style.top=k.a.Pc(b);this.y5.style.left=k.a.Pc(a)}}tL(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.bwa.addHandler(f,pa.a.click,b);return f}sJb(){ya.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.kb.prev();this.hide();this.kb.restoreFocus()}nJb(){ya.a.J(24133959,
830,50,"SlideshowContextMenu.OnNextClickHandler");this.kb.next();this.hide();this.kb.restoreFocus()}hIk(){ya.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();iD.$ak(this.kb,this.Sb.rj())}iJb(){ya.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.Ja(ea.a.dPb,2,null)}WJa(){ya.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.kb.z8e();this.hide();this.kb.restoreFocus()}knc(){this.Ggc.innerText=this.tu.H9?ResourceStrings.L_ExitFullscreen:
ResourceStrings.L_EnterFullscreen}hJb(){ya.a.J(24133963,830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.kb.exit()}eHk(){ya.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.kb.restoreFocus();this.Vb&&this.Vb.instance&&this.Vb.instance.lr&&this.Vb.instance.showEndSessionDialog(()=>{this.Vb.instance.N5b(4)},()=>{})}E7g(a){const b=document.activeElement,c=Array.indexOf(this.h5,b);a=this.h5[((-1===c?a?0:-1:a?c+1:c-1)+this.h5.length)%this.h5.length];
void 0!==a&&null!==a&&(this.JWe(b),this.jS(a))}aEi(){this.h5.forEach(a=>{this.JWe(a)})}jS(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.$d.unh(new Px(a.innerText)))}JWe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(m.a)(jD,"SlideshowContextMenu",null,[891]);var oR=d(1034);class iK{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd){this.va=new Wc.a;this.CE=null;this.LHe=
this.MHe=this.efd=this.Fkc=-1;this.fBg=this.hBg=this.gBg=this.uFb=null;this.nec="";this.ygd=this.jfd=-1;this.eOg=new Date(0);this.RNg="";this.bEg=null;this.iGg=this.Xeb=this.gAe=this.mCe=!1;this.EIa=this.ap=this.Jc=null;this.zfc=-1;this.wFg=this.MFg=!1;this.tu=a;this.kb=b;this.ffa=c;this.Sb=ja;this.la=G;this.Hjk=f;this.ei=l;this.Qr=y;this.Yr=R;this.Ya=za;this.Hz=Va;this.Vd=hb;this.axa=Cb;this.Mc=lc;this.Fgd=ic;this.kxa=yc;this.Xu=this.Yr.UF();this.B1g=this.la.pptEditorHermesSlideShowStartTimeout;
this.qJe=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Mc.GC(Object(H.a)(this,this.UE,"onSessionEnd"));this.Hz.FUd(Object(H.a)(this,this.rJb,"onPodSessionUnavailable"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Hz.Ysb(Object(H.a)(this,this.hga,"onPodSessionRefreshed")),this.Hz.rBf(Object(H.a)(this,this.Dkd,"onPodSessionRefreshedFromBrowser")));this.ia=ec;this.Vb=jc;this.cfd=xd;this.Xl=Xd;a=document.createElement("div");
a.id="HiddenFocusTrapAnchor";w.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||w.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.Xu.insertBefore(a,this.Xu.firstChild)}dispose(){this.Mc.Qaa(Object(H.a)(this,this.UE,"onSessionEnd"));this.Hz.ncl(Object(H.a)(this,this.rJb,"onPodSessionUnavailable"));
this.Mc.Raa(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Hz.qkb(Object(H.a)(this,this.hga,"onPodSessionRefreshed")),this.Hz.Crh(Object(H.a)(this,this.Dkd,"onPodSessionRefreshedFromBrowser")))}SQj(a,b,c,f){this.bEg=b;"Legacy"==this.kb.n9()&&this.kb.init(a,b,c,this.Ya.podSessionId);this.Jc=f;this.ap=new yz}n9(){return this.kb.n9()}Occ(){return!na.a.Xa(this.nec)}get Xhe(){return this.Xeb}set Xhe(a){this.Xeb=a}$ql(){this.wFg=!0}cwd(a,b,
c,f,l,y,G,R,ja,za,Va,hb,Cb){Sf.Health.instance.addQosPillar("Present");this.Occ()&&ya.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.EIa=Fb.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.EIa.Afb&&(this.zfc=b,this.ia.processAction(ea.a.Bvd,2,null),this.EIa.Pji(Object(H.a)(this,this.AKk,"onPresenterViewSyncMessageReceivedHandler")));const lc=
c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.Fkc=za;this.efd=Date.now();const ic=document.createElement("div");ic.id="startingSlideshowHiddenDiv";ic.style.position="position: absolute";ic.style.left="-10000px";ic.style.top="auto";ic.style.width="1px";ic.style.height="1px";ic.style.overflow="hidden";ic.tabIndex=-1;ic.setAttribute("aria-live","assertive");this.Xu.insertBefore(ic,this.Xu.firstChild);ic.innerText=ResourceStrings.l_StartingSlideShow;const yc=R+za.toString();this.nec=yc;
this.axa&&this.axa.Itc(!0);this.la.o7j&&this.Fgd&&this.Fgd.Itc(!0);this.ap&&(this.ap.P4=c,this.ap.startingSlideIndex=b,this.ap.Gpa=this.Sb.rj(),this.ap.QVf=this.la.x9k);this.la.pptEditorVoiceUXEnabled&&this.cfd&&this.cfd.init();this.la.pptEditorVoiceUXEnabled&&this.Xl&&this.Xl.execute(jc=>{jc.init()});this.ffa.execute(jc=>{jc.init(this.Jc,this.ap)});this.gBg=this.Xu.style.top;this.Xu.style.top=k.a.Pc(0);this.la.fWa&&(this.hBg=this.Xu.style.width,this.fBg=this.Xu.style.height,this.Xu.style.width="100%",
this.Xu.style.height="100%");this.kb.show();this.Nwg();this.la.dGh&&$s.a.YQb(!1);w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.EIa&&this.EIa.Afb&&this.kb.RQa(Object(H.a)(this,this.Tkd,"onSlideChangedHandler"));this.kb.jja(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.aBf(Object(H.a)(this,this.WJa,"onFullscreenClickHandler"));this.kb.UJc(Object(H.a)(this,this.$dh,"onSlideshowReadyHandler"));this.kb.YAf(Object(H.a)(this,this.Djd,"onErrorHandler"));this.kb.VJc(Object(H.a)(this,
this.Qxa,"onSpecialKeyHandler"));this.kb.AUd(Object(H.a)(this,this.Ckd,"onPodSessionExpiredHandler"));this.kb.dBf(Object(H.a)(this,this.dkd,"onLogEndOfTranscriptionSessionHandler"));this.kb.cBf(Object(H.a)(this,this.ckd,"onLiveSubtitlesDockedViewHandler"));this.kb.vBf(Object(H.a)(this,this.ypd,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Hz.Ysb(Object(H.a)(this,this.hga,"onPodSessionRefreshed")),this.Hz.rBf(Object(H.a)(this,this.Dkd,"onPodSessionRefreshedFromBrowser")));
this.Gji(Object(H.a)(this,this.Yjd,"onKeydownHandler"));c=Date.now();let ec=!this.la.Qsg||Va;ec||(ec=this.ei.MVc().jO());this.MFg=ec;za=Date.now();ya.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",za-c,ec?"True":"False",Va?"True":"False");this.MHe=Date.now();this.ei.MVc().forceOutbound(()=>{ya.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.ei.flush(()=>{this.LHe=
Date.now();ya.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.LHe-this.MHe);this.nec===yc&&ec&&(Va&&hb&&(ya.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=hb.Ck,y=hb.podSessionId),this.pHh(a,b,f,l,y,G,R,ja,Cb,lc),ya.a.J(512495811,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},jc=>{ya.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",jc.ServerError);return!1})},
(jc,xd)=>{ya.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",xd)},null);this.nec!==yc||ec||(this.pHh(a,b,f,l,y,G,R,ja,Cb,lc),ya.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}pHh(a,b,c,f,l,y,G,R,ja,za=!1){const Va=oh.a.create().toString();this.la.Sqg&&this.nSk(c,l,G,Va);const hb={};hb.SlideShowKind=this.kb.n9();hb.IsFrameNull=this.kb?"false":"true";hb.slideshowClickTimeMs=this.Fkc;void 0!==window.performance.timing&&null!==window.performance.timing&&
(hb.slideshowClickTimePerformanceAPI=this.Fkc-window.performance.timing.navigationStart);ya.a.J(590976135,830,15,"SlideshowManager:startFromInternal - "+JSON.stringify(hb));this.kb.cwd(a,b,f,l,y,G,R,Va,this.Fkc);0<this.B1g&&(this.jfd=window.setTimeout(Object(H.a)(this,this.FMk,"onStartSlideshowTimeoutHandler"),this.B1g));this.Vb&&this.Vb.instance&&this.Vb.instance.Wkd(a,b,c,f,l,y,G,w.AFrameworkApplication.Pg,ja);this.Jc&&this.Jc.Ljl();za&&(this.Jc.Rh=!1);qd.a("PresenterCoachTabFix")&&this.kb.Zxh()}Qxa(a,
b){if(b.key===B.a.AZ)ya.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.ffa.execute(c=>{c.remove()}),this.kb.exit();else if(b.key===B.a.mSb)this.ia.Ja(ea.a.Vxd,2,null);else if(b.key===B.a.lBd&&this.la.Vla&&this.Jc&&this.Jc.nEa&&this.ap&&this.Sb&&!this.ap.P4&&this.la.Y8j&&this.Jc.B0f)try{this.Jc.Rh&&(Ti.a.qK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Ti.a.aK)||ya.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));
this.Jc.Rh=!this.Jc.Rh;ya.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Jc.Rh);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Jc.Rh?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.lr;if(f)this.kb.toggleTranscriberUIVisibility(null);
else{let l=Date.now();this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,4,l,this.ap)}this.ffa.execute(l=>{l.setToolbarButtonToggleState(ah.a.SubtitlesButton,this.Jc.Rh);l.cF(ah.a.CoachButton,!this.Jc.Rh&&!f)})}catch(c){ya.a.J(512495776,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",c)}else if(b.key===B.a.Cyc&&this.Vb&&this.Vb.instance&&this.Vb.instance.nEa&&this.Vb.instance.c5i&&this.ap&&
!this.ap.P4)try{if(this.Vb.instance.lr)this.Vb.instance.showWelcomeScreen();else{this.Vb.instance.Ida=!this.Jc.Rh;if(this.Jc.hxb&&!this.Jc.Rh){this.Jc.Rh=!0;let c=Date.now();this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,5,c,this.ap);this.Jc.Rh=!1}this.Vb.instance.hvc(4,w.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,this.Ya.podSessionId,w.AFrameworkApplication.Pg)}}catch(c){ya.a.J(512495775,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",
c)}}AKk(a,b){b&&(a=b.slideIndex,a!==this.zfc&&(this.zfc=a,this.kb.HUa(a)))}E_a(){ya.a.J(512495774,830,15,"SlideshowManager.OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.mCe=!0}nSk(a,b,c,f){ya.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.bEg;
this.Qr.qj(a,2,null,b,!1,2,()=>{ya.a.J(512495772,830,15,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{ya.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,Nl.a("14"))}jja(a){this.va.addHandler("OnExitSlideshow",a)}Bga(a){this.va.removeHandler("OnExitSlideshow",a)}RQa(a){this.va.addHandler("OnPositionChangeEventId",
a)}okb(a){this.va.removeHandler("OnPositionChangeEventId",a)}Gji(a){this.uFb||(this.uFb=a,md.a.addHandler(window.document.body,"keydown",this.uFb))}kXe(){this.uFb&&(md.a.removeHandler(window.document.body,"keydown",this.uFb),this.uFb=null)}knc(){if(this.tu.H9)ya.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.aMf();this.kb.qXe(Object(H.a)(this,this.E_a,"onVisibilityChangeHandler"));ya.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");
var a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.yK);a=!!a&&"teams"===a.toLowerCase();this.mCe||this.gAe||!document.hasFocus()||a||(ya.a.J(512495768,830,15,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.ffa.execute(b=>{b.remove()}),this.kb.exit());this.mCe=!1}this.gAe=!1}Tkd(a,b){b&&this.zfc!==b.slideIndex&&(this.zfc=b.slideIndex,this.EIa.Eml(b))}noa(a,b){ya.a.J(512495767,830,15,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.DMf();var c=["WACInnerFrame",
"WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.nec="";this.axa&&this.axa.Itc(!1);this.Fgd&&this.Fgd.Itc(!1);this.Jc&&this.Jc.bhl();this.kb.Bga(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.nrh(Object(H.a)(this,this.WJa,"onFullscreenClickHandler"));this.kb.lqd(Object(H.a)(this,this.$dh,"onSlideshowReadyHandler"));this.kb.krh(Object(H.a)(this,
this.Djd,"onErrorHandler"));this.kb.mqd(Object(H.a)(this,this.Qxa,"onSpecialKeyHandler"));this.kb.qXe(Object(H.a)(this,this.E_a,"onVisibilityChangeHandler"));this.kb.mXe(Object(H.a)(this,this.Ckd,"onPodSessionExpiredHandler"));this.kb.prh(Object(H.a)(this,this.dkd,"onLogEndOfTranscriptionSessionHandler"));this.kb.orh(Object(H.a)(this,this.ckd,"onLiveSubtitlesDockedViewHandler"));this.kb.Hrh(Object(H.a)(this,this.ypd,"recordQosErrorHandler"));this.kXe(Object(H.a)(this,this.Yjd,"onKeydownHandler"));
(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Hz.qkb(Object(H.a)(this,this.hga,"onPodSessionRefreshed")),this.Hz.Crh(Object(H.a)(this,this.Dkd,"onPodSessionRefreshedFromBrowser")));this.la.dGh&&($s.a.YQb(!0),this.tu.H9||GG.a.c1a(w.AFrameworkApplication.isRtl));this.aMf();gt.exitFullscreen();this.Xu.style.top=this.gBg;this.la.fWa&&(this.Xu.style.width=this.hBg,this.Xu.style.height=this.fBg);this.Yr.Du();
this.va.raiseEvent("OnExitSlideshow",b,a);this.Vb&&this.Vb.instance&&this.Vb.instance.qMk();this.ap&&this.ap.P4&&b.summary&&this.ia.Ja(ea.a.kMa,2,b.summary);w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.EIa&&this.EIa.Afb&&this.ia.processAction(ea.a.BNc,2,null);this.ap&&(this.ap.P4=!1);this.la.pptEditorVoiceUXEnabled&&this.Xl&&this.Xl.instance&&this.Xl.instance.remove();this.la.pptEditorVoiceUXEnabled&&this.cfd&&this.cfd.remove();this.TMl()}TMl(){w.AFrameworkApplication.fa.ka("798")&&
Fb.a.instance.Ia("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{ya.a.J(512495766,830,15,"SlideshowManager.Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}WJa(){this.gAe=!0;this.tu.H9?gt.exitFullscreen():this.Nwg()}Nwg(){let a=this.Xu;this.la.N_&&(a=document.documentElement);a&&this.tu.ybc&&(this.tu.Q_&&!this.CE&&(this.CE=Object(H.a)(this,this.knc,"onFullscreenChangeHandler"),$addHandler(a,this.tu.Q_,this.CE)),this.tu.requestFullscreen(a),
this.kb.oBf(Object(H.a)(this,this.E_a,"onVisibilityChangeHandler")))}$dh(){this.DMf();var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1===this.efd)ya.a.J(508924039,830,10,"SlideshowManager.onSlideshowReadyHandler returning early since slideshowStartTimeMs is -1");else{b=Date.now();ya.a.J(23098073,830,15,"SlideshowManager.slideshow ready in {0} ms",
b-this.efd);a={};a.SlideshowClickTimeMs=this.Fkc;a.SlideshowStartTimeMs=this.efd;a.SlideshowStartFlushTimeMs=this.MHe;a.SlideshowFinishFlushTimeMs=this.LHe;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.la.Qsg;a.NoBlockingOutBound=!this.MFg;ya.a.J(512495765,830,15,"SlideshowManager.onSlideshowReadyHandler"+JSON.stringify(a));this.ffa.execute(()=>{this.la.Wbc&&this.kb.getCurrentSlideDimensions()});!this.la.yg||!this.la.Ajh&&this.la.Wbc||this.Hjk.init(this.Jc,this.ap);b=!!this.Vb&&!!this.Vb.instance&&
this.Vb.instance.Jr&&this.Vb.instance.mEa;a=!!this.Vb&&!!this.Vb.instance&&(this.Vb.instance.oTa||this.Vb.instance.lr);if((this.la.Vla||this.la.ddc)&&this.Jc&&this.ap&&this.Sb&&(this.Jc.Rh||this.ap.P4||b||a)&&this.Jc.B0f){const c=Date.now();let f=2;w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp&&(f=1);const l=this.Jc.Rh;b||a?(this.Jc.Rh||(f=5),this.Vb.instance.Ida=!this.Jc.Rh,this.Jc.Rh=!0):this.Vb&&this.Vb.instance&&(this.Vb.instance.Ida=!1);this.kb.transcribe(w.AFrameworkApplication.userSessionId,
this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,f,c,this.ap);this.Jc.Rh=l}b&&(this.Vb.instance.mEa=!1);this.kXe(Object(H.a)(this,this.Yjd,"onKeydownHandler"));this.kb.Tga(!1);this.kb.setOsfLocalStorage()}}Yjd(a){27===a.keyCode&&(ya.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.kXe(Object(H.a)(this,this.Yjd,"onKeydownHandler")),this.ffa.execute(b=>{b.remove()}),this.kb.exit())}dkd(a,b){a={};try{const c=ta.a.JL(b.Yx);for(const f of c)try{a[f]=b.Yx[f]}catch(l){ya.a.J(512495763,
830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",f,l)}}catch(c){ya.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}ya.a.J(512495761,830,15,"SlideshowManager.onLogEndOfTranscriptionSessionHandler"+JSON.stringify(a));try{!(this.ap&&this.ap.P4||!this.la.kWk||this.iGg)&&a.WebSocketConnectionDurationMS&&
6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(ya.a.J(512495760,830,50,"SlideshowManager.Floodgate survey triggered for transcription."),this.iGg=!0,this.kxa.continueWith(()=>{this.kxa.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){ya.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",c)}}ckd(a,b){this.la.Wbc||((a=document.getElementById("slideshow-toolbar"))?
b.Rcc?"BelowSlide"===b.gw?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.gw?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):ya.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}Ckd(a,b){ya.a.J(512495757,830,15,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",
b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Ya.podSessionId)ya.a.J(512495756,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",this.Ya.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.eOg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);
const f=new Date,l=f>c;ya.a.J(512495755,830,15,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(ya.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",b.code),this.Vd.Gs(Object.assign(new oi.a,{Code:223,Source:4}),b.podSessionId),0<this.qJe)){ya.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",
this.qJe);this.eOg=new Date;this.RNg=b.podSessionId;this.ygd=window.setTimeout(Object(H.a)(this,this.B9k,"rehydrationTimeout"),this.qJe);return}}else if(this.RNg===b.podSessionId){ya.a.J(512495752,830,15,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",b.podSessionId);return}}w.AFrameworkApplication.No(Of.a.Ph(359));Sf.Health.instance.recordQosError("SlideShowPodSessionExpiredFailure",
["SlideShowACE"],!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(ya.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.ffa.execute(f=>{f.remove()}),this.kb.exit())}}Djd(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,b.code,b.sessionId,b.correlationId,b.message,b.ry,b.yWj.toString());ya.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",
a);w.AFrameworkApplication.No(Of.a.Ph(359));Sf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(ya.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.ffa.execute(c=>{c.remove()}),this.kb.exit())}aMf(){let a=this.Xu;this.la.N_&&(a=document.documentElement);a&&this.CE&&(ya.a.J(512495748,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(a,this.tu.Q_,
this.CE),this.CE=null)}FMk(){ya.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");w.AFrameworkApplication.No(Of.a.Ph(360));Sf.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.ffa.execute(a=>{a.remove()});this.kb.exit()}B9k(){ya.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");w.AFrameworkApplication.No(Of.a.Ph(371));Sf.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.ffa.execute(a=>
{a.remove()});this.kb.exit()}ypd(a,b){a=0<b.durationMs?Object.assign(new Ak.a,{durationMs:b.durationMs}):null;Sf.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}hga(a,b){ya.a.J(512495745,830,15,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);this.Xeb=!1;this.HMf();this.Occ()||"Legacy"!=this.kb.n9()?
(ya.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.EY,this.Ya.Ck),this.kb.refreshPodSession(b.EY,this.Ya.Ck)):ya.a.J(512495744,830,15,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}Dkd(a,b){ya.a.J(512495714,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);
this.Xeb=!1;this.HMf();this.Occ()||"Legacy"!=this.kb.n9()?(ya.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.EY,this.Ya.Ck),this.kb.refreshPodSession(b.EY,this.Ya.Ck)):ya.a.J(512495713,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}Hn(){this.Xeb=!1;ya.a.J(512495711,830,15,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}UE(){this.Xeb=!0;ya.a.J(512495710,830,15,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}rJb(){this.Xeb=!0;ya.a.J(512495709,830,15,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}DMf(){-1!==
this.jfd&&(window.clearTimeout(this.jfd),this.jfd=-1)}HMf(){-1!==this.ygd&&(window.clearTimeout(this.ygd),this.ygd=-1)}}Object(m.a)(iK,"SlideshowManager",null,[406]);class kD{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.nwa=this.Lgc=this.ihb=this.iEb=this.Feb=this.DXa=this.XFb=this.CGb=this.ap=this.Jc=this.te=null;this.Ogc=0;this.xM=!1;this.CE=null;this.kb=c;this.le=f;this.kJe=l;this.tf=G;this.vu=R;this.Ya=za;this.tu=Va;this.ia=a;this.Da=b;this.bEe=null;this.LFe=ja;this.Vb=y}init(a,b){this.te=document.createElement("div");
this.te.id="slideshow-toolbar";this.te.className="SlideshowToolbar";this.tf.appendChild(this.te);this.Jc=a;this.ap=b;this.vu()?(this.CGb=this.Nsa("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.XFb=this.Nsa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.CGb=this.Nsa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.XFb=this.Nsa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.te.appendChild(this.CGb);this.te.appendChild(this.XFb);md.a.addHandler(this.CGb,pa.a.click,Object(H.a)(this,this.sJb,"onPrevClickHandler"));md.a.addHandler(this.XFb,pa.a.click,Object(H.a)(this,this.nJb,"onNextClickHandler"));this.Lgc=this.Nsa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.te.appendChild(this.Lgc);
md.a.addHandler(this.Lgc,pa.a.click,Object(H.a)(this,this.iJb,"onGridViewClickHandler"));this.Feb=this.DXa=null;this.tu.SJf&&(this.DXa=this.Nsa("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.Feb=this.Nsa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.tu.H9,this.DXa.style.display=a?qe.a.Qe:qe.a.Tj,this.Feb.style.display=a?qe.a.Tj:qe.a.Qe,this.te.appendChild(this.DXa),
this.te.appendChild(this.Feb),md.a.addHandler(this.DXa,pa.a.click,Object(H.a)(this,this.WJa,"onFullscreenClickHandler")),md.a.addHandler(this.Feb,pa.a.click,Object(H.a)(this,this.WJa,"onFullscreenClickHandler")),this.tu.Q_&&!this.CE&&(this.CE=Object(H.a)(this,this.knc,"onFullscreenChangeHandler"),$addHandler(this.tf,this.tu.Q_,this.CE)));this.ihb=null;this.Jc.hxb&&!this.ap.P4&&(this.ihb=this.Nsa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.te.appendChild(this.ihb),md.a.addHandler(this.ihb,pa.a.click,Object(H.a)(this,this.kld,"onTranscribeHandler")));this.iEb=this.Nsa("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.te.appendChild(this.iEb);md.a.addHandler(this.iEb,pa.a.click,Object(H.a)(this,this.hJb,"onExitClickHandler"));this.nwa=null;this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&!this.ap.P4&&(this.Vb.instance.iBf(Object(H.a)(this,this.tnc,"onLiveSessionStarted")),
this.Vb.instance.gBf(Object(H.a)(this,this.snc,"onLiveSessionEnded")),this.Vb.instance.cji(Object(H.a)(this,this.Lbh,"onLiveCalloutDismissed")),this.Vb.instance.eBf(Object(H.a)(this,this.rnc,"onLiveRelaunchPausedSession")),this.Vb.instance.f$a?this.pRf():this.Vb.instance.$ji(Object(H.a)(this,this.Nbh,"onLivePresenterResourcesLoaded")));this.xM=!1;this.hide();this.kb.jja(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.tUd(Object(H.a)(this,this.oib,"onBrowserEventHandler"));md.a.addHandler(this.te,
pa.a.tq,Object(H.a)(this,this.yib,"onMouseOverHandler"));md.a.addHandler(this.te,pa.a.Zs,Object(H.a)(this,this.vnc,"onMouseOutHandler"))}show(){this.te.style.display=qe.a.Tj;window.clearTimeout(this.Ogc);this.Ogc=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3);this.kb.Tga(!0)}hide(){this.xM||(window.clearTimeout(this.Ogc),this.te.style.display=qe.a.Qe,this.kb.Tga(!1))}remove(){this.te&&this.tf.contains(this.te)&&(this.tf.removeChild(this.te),this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&
(this.Vb.instance.vrh(Object(H.a)(this,this.tnc,"onLiveSessionStarted")),this.Vb.instance.urh(Object(H.a)(this,this.snc,"onLiveSessionEnded")),this.Vb.instance.sbl(Object(H.a)(this,this.Lbh,"onLiveCalloutDismissed")),this.Vb.instance.Ybl(Object(H.a)(this,this.Nbh,"onLivePresenterResourcesLoaded")),this.Vb.instance.srh(Object(H.a)(this,this.rnc,"onLiveRelaunchPausedSession"))),this.xM=!1)}cF(){}setToolbarButtonToggleState(){}noa(){this.kb.Bga(Object(H.a)(this,this.noa,"onExitHandler"));this.kb.gXe(Object(H.a)(this,
this.oib,"onBrowserEventHandler"));md.a.removeHandler(this.te,pa.a.tq,Object(H.a)(this,this.yib,"onMouseOverHandler"));md.a.removeHandler(this.te,pa.a.Zs,Object(H.a)(this,this.vnc,"onMouseOutHandler"));md.a.removeHandler(this.CGb,pa.a.click,Object(H.a)(this,this.sJb,"onPrevClickHandler"));md.a.removeHandler(this.XFb,pa.a.click,Object(H.a)(this,this.nJb,"onNextClickHandler"));md.a.removeHandler(this.iEb,pa.a.click,Object(H.a)(this,this.hJb,"onExitClickHandler"));this.nwa&&md.a.removeHandler(this.nwa,
pa.a.click,Object(H.a)(this,this.Kbh,"onLiveBroadcastHandler"));this.ihb&&md.a.removeHandler(this.ihb,pa.a.click,Object(H.a)(this,this.kld,"onTranscribeHandler"));this.DXa&&(md.a.removeHandler(this.DXa,pa.a.click,Object(H.a)(this,this.WJa,"onFullscreenClickHandler")),md.a.removeHandler(this.Feb,pa.a.click,Object(H.a)(this,this.WJa,"onFullscreenClickHandler")),$removeHandler(this.tf,this.tu.Q_,this.CE),this.CE=null);this.Lgc&&md.a.removeHandler(this.Lgc,pa.a.click,Object(H.a)(this,this.iJb,"onGridViewClickHandler"));
this.remove()}oib(){this.show()}knc(){const a=this.tu.H9;this.DXa.style.display=a?qe.a.Qe:qe.a.Tj;this.Feb.style.display=a?qe.a.Tj:qe.a.Qe}yib(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.xM=!0}vnc(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Jc.Rh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Vb&&!this.Vb.instance.lr&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.P7d()||(this.xM=!1);this.P7d()||this.kb.restoreFocus()}sJb(){ya.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.N2a(this.CGb.title);this.kb.prev();this.kb.restoreFocus()}nJb(){ya.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.N2a(this.XFb.title);this.kb.next();this.kb.restoreFocus()}hJb(){ya.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");
this.N2a(this.iEb.title);this.kb.exit()}WJa(){ya.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.kb.z8e()}Kbh(){this.Vb&&this.Vb.instance&&(this.N2a(this.nwa.title),ya.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Vb.instance.lr),this.Vb.instance.lr?(this.kb.pausePresentation(),this.Vb.instance.showCallout(this.nwa)):(this.Vb.instance.hvc(3,w.AFrameworkApplication.userSessionId,this.LFe,this.Ya.podSessionId,w.AFrameworkApplication.Pg),this.Vb.instance.Ida=
!this.Jc.Rh,this.Jc.hxb&&!this.Jc.Rh&&(ya.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Jc.Rh=!0,this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,5,Date.now(),this.ap),this.Jc.Rh=!1)),this.faf())}C8e(a,b){this.N2a(this.ihb.title);const c=!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.lr,f=this.Jc.z0f&&5!==a&&!c;5!==a&&(this.Jc.Rh=!this.Jc.Rh);ya.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Jc.Rh);b&&(this.Jc.Rh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&zz.Jwg(this.kb,this.le,this.Ya)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.kb.toggleTranscriberUIVisibility(null):this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,a,b,this.ap))}kld(a){this.C8e(3,a.target)}iJb(){ya.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.Ja(ea.a.dPb,2,null)}pRf(){this.nwa||
(this.nwa=this.Nsa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.te.insertBefore(this.nwa,this.iEb),md.a.addHandler(this.nwa,pa.a.click,Object(H.a)(this,this.Kbh,"onLiveBroadcastHandler")))}Nsa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=tb.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Jc.Rh?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.le.qk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=tb.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Vb&&this.Vb.instance&&this.Vb.instance.lr?"Hover_40x40x32":"_40x40x32"),"prt2",this.le.qk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.bEe=a.children[0]),l;a=tb.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.le.qk("prt2.png"),null,null,!0,null);l.appendChild(a);
l.title=f;return l}N2a(a){na.a.Xa(a)?ya.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.kJe.vnh(new Px(a))}P7d(){return!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.s5i}faf(){this.Vb&&this.Vb.instance&&this.bEe&&(this.bEe.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Vb.instance.lr?"Hover_40x40x32":"_40x40x32"))}Nbh(){this.pRf()}tnc(){this.faf()}snc(){this.Vb&&this.Vb.instance&&this.Vb.instance.Ida&&!this.Jc.Rh&&(ya.a.J(41682899,
830,50,"Stopping subtitle for stopping live session."),this.kb.transcribe(w.AFrameworkApplication.userSessionId,this.Ya.podSessionId,this.Ya.Ck,w.AFrameworkApplication.Pg,5,Date.now(),this.ap));this.Vb.instance.Ida=!1;this.faf()}rnc(){this.Vb&&this.Vb.instance&&(this.xM=!0,this.show(),this.kb.pausePresentation(),this.Vb.instance.showCallout(this.nwa))}Lbh(){this.xM=this.P7d();this.xM||(window.clearTimeout(this.Ogc),this.Ogc=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3))}}Object(m.a)(kD,
"SlideshowToolbar",null,[890,891]);class wu{constructor(a){this.BEb=this.s1=this.WHb=null;this.gIe="BelowSlide";this.Heb=this.mFg=!1;this.qgc=!0;this.l9c=-1;this.KFg=this.dgc=this.dAe=!1;this.eGe=this.iIe=this.kIe=this.jIe=null;this.la=a;w.AFrameworkApplication.fa.$e(Object(H.a)(this,this.jn,"onFullAppSettingsReady"));a=Nd.b(w.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.AAg=a.Ring||"Unknown";this.XAg=w.AFrameworkApplication.buildVersion||"Unknown";this.sOg=this.la.vKa||
"Unknown";this.m4g=a.Host||"Unknown";this.l4g=a.WACDatacenter||"Unknown";this.u1g=this.Aij();this.ilc=this.Dij();this.p3g=this.JYc();this.pEb=wu.Qaf;switch(this.la.vMl){case "ByUIHostName":a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.yK);this.Heb=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.Heb=w.AFrameworkApplication.isEmbedded;break;default:this.Heb=w.AFrameworkApplication.fa.ka("IsUIEmbedMode")}ya.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.pEb,this.gIe)}jn(){this.WHb=this.getUserId();this.s1=w.AFrameworkApplication.fa.Ha("TenantId");this.BEb=this.la.hostAuthType||w.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown"}getUserId(){let a=w.AFrameworkApplication.fa.Ha("PptEditingUserId");na.a.Xa(a)&&(a=w.AFrameworkApplication.fa.Ha("LoggableUserId"),ya.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",na.a.Xa(a)));return a}get j6b(){return this.mFg}set j6b(a){ya.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
a);this.mFg=a}get Rh(){return this.la.Vla&&this.j6b&&this.pEb&&!this.Heb}set Rh(a){this.pEb!==a&&(this.pEb=a,wu.Qaf=this.pEb)}get i6b(){return this.la.Vla&&this.dgc}set i6b(a){this.dgc!==a&&(this.dgc=a)}get U0f(){return this.KFg}get B0f(){return!this.Heb}get nxb(){return this.dAe}set nxb(a){this.dAe!==a&&(this.dAe=a)}get hxb(){return this.la.Vla&&this.j6b&&this.la.V8j&&!this.Heb}get z0f(){const a=Ti.a.get("PPTLiveSubtitleEnabled");return this.la.Vla&&this.la.$8j&&na.a.Xa(a)&&!this.Heb}get q6e(){if(!this.iIe){const b=
new Oa.a;var a=this.la.pjh;if(!na.a.Xa(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.iIe=wu.CCf(b)}return this.iIe}get p6e(){if(!this.eGe){const b=new Oa.a;var a=this.la.pjh;if(!na.a.Xa(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.eGe=wu.CCf(b)}return this.eGe}get SPb(){this.jIe||(this.jIe=na.a.Xa(this.la.qjh)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.qjh,!0));return this.jIe}get a5e(){this.kIe||(this.kIe=wu.Dni(this.SPb));
return this.kIe}Ljl(){this.l9c=this.pEb?1:0}bhl(){-1!==this.l9c&&(this.Rh=1===this.l9c?!0:!1,this.l9c=-1)}Aij(){try{const a=ab.a.He(w.AFrameworkApplication.lcid);if(!a)return ya.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",w.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.q6e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.p6e)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
this.dgc=!0;return"en-us"}catch(a){ya.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",w.AFrameworkApplication.lcid,a)}this.dgc=!0;return"en-us"}Dij(){try{const a=ab.a.He(w.AFrameworkApplication.lcid);if(!a||na.a.Xa(a.name))return ya.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",w.AFrameworkApplication.lcid),
"en";const b=a.name.toLowerCase();if(!na.a.Xa(b)&&this.SPb[b])return b;const c=ab.a.He(a.languageId);if(!c||na.a.Xa(c.name))return ya.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",w.AFrameworkApplication.lcid),"en";let f=c.name.toLowerCase();this.SPb[f]||(ya.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,f,w.AFrameworkApplication.lcid),f="en");return f}catch(a){ya.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",w.AFrameworkApplication.lcid,a)}return"en"}JYc(){try{if(na.a.Xa(this.ilc))return ya.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",w.AFrameworkApplication.lcid),"en-us";const a=this.SPb[this.ilc.toLowerCase()];
if(!na.a.Xa(a))return a}catch(a){ya.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.ilc,w.AFrameworkApplication.lcid,a)}return"en-us"}Nfj(a){if(na.a.Xa(a))return ya.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return ya.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.SPb;var f=this.a5e;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;ya.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get Ipa(){return this.u1g}set Ipa(a){this.u1g=a;this.KFg=!0}get userId(){return this.WHb}set userId(a){this.WHb=a}get locale(){return this.sOg}set locale(a){this.sOg=a}get audienceGroup(){return this.AAg}set audienceGroup(a){this.AAg=
a}get buildVersion(){return this.XAg}set buildVersion(a){this.XAg=a}get identityProvider(){return this.BEb}set identityProvider(a){this.BEb=a}get wacHost(){return this.m4g}set wacHost(a){this.m4g=a}get wacDatacenter(){return this.l4g}set wacDatacenter(a){this.l4g=a}get tenantId(){return this.s1}set tenantId(a){this.s1=a}get aAa(){return this.ilc}set aAa(a){this.ilc=a}get onb(){return this.p3g}set onb(a){this.p3g=a}get gw(){return this.gIe}set gw(a){this.gIe=a}get dHl(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.gw;a.SpeechLanguage=this.Ipa;a.TranslationLanguages=this.onb;a.FUseSubtitles=this.Rh;return JSON.stringify(a)}get nEa(){return this.qgc}set nEa(a){this.qgc=a}get k5i(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.aAa)}static get Qaf(){const a=
Ti.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set Qaf(a){Ti.a.qK("PPTLiveSubtitleEnabled",a.toString(),Ti.a.aK)||ya.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static CCf(a){const b={},c=new Oa.a;for(let f of a)try{const l=ab.a.He(f).displayName;c.add(l);b[l]=f}catch(l){ya.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));
a=new Oa.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static Dni(a){const b=ta.a.JL(a);a={};const c=new Oa.a;for(var f of b)try{const l=ab.a.He(f).displayName;na.a.Xa(l)?ya.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",f,w.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){ya.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
f,l)}c.Sc((l,y)=>l.localeCompare(y));f=new Oa.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(m.a)(wu,"SubtitleContext",null,[401]);const lD=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=jK(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=jK(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},jK=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class kK{constructor(a){this.Zo=a}Xti(){return lD()}Wti(){let a=!1;const b=this.Xti();if(b&&!this.Zo.wO(1))try{const c=document.createElement("canvas"),
f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}ya.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.Zo.mz,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(m.a)(kK,"WebGLHelperProxy",null,[400]);var lK=d(655),pR=d(745);class mK{qqj(a){return optionsButton.OptionsButtonManagerFactory.createOptionsButtonManager(a)}}
Object(m.a)(mK,"OptionsButtonLoader",null,[407]);class mD{constructor(){this.la=this.ob=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Xb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.ob=b.UF();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(399,"PowerPointWebEditor.IFullscreenHelper").na().oa(()=>new aK);this.K.register(400,"PowerPointWebEditor.IWebGLHelper").na().oa(()=>new kK(this.K.resolve("Common.IBrowserUtils")));
this.K.register(401,"PowerPointWebEditor.ISubtitleContext").na().oa(()=>new wu(this.la));this.K.register(402,"PowerPointWebEditor.IRehearsalContext").na().oa(()=>new yz);this.aec({["Type"]:"CheckBrowserStart"});a={};var c=this.xXj(a);const f=lD()&&this.la.mWa&&c&&this.wXj(),l=this.la.mWa&&this.vXj(),y=!f&&l;this.aec({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:y});
if(this.la.ka("DefaultToModernSlideShow")&&(f||l)){this.K.register(403,"PowerPointWebEditor.ISlideshowFrame").na().oa(()=>new pR.SlideShowCoreFrame(this.ob,this.la,this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").xI,this.K.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ia("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),
y,this.K.resolve("PowerPoint.IPathManager"),this.K.Ia("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,w.AFrameworkApplication.Je));const za={};za.loadScriptStart=Date.now();a=eD.a.create(w.AFrameworkApplication.Ji("powerpoint-slideshow-strings",3));Nv.a.py(a);Promise.all([new Promise((Va,hb)=>{const Cb=document.createElement("script");Cb.async=!1;Cb.src=w.AFrameworkApplication.Ji(String.format("slideshowcore{0}.js",
".min"),5);Cb.addEventListener("load",()=>{ya.a.J(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");Va(Cb)});Cb.addEventListener("error",()=>{ya.a.J(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");hb(Cb)});document.head.appendChild(Cb)}),new Promise((Va,hb)=>{const Cb=document.createElement("script");Cb.async=!1;Cb.src=w.AFrameworkApplication.Ji(String.format("podsproxy{0}.js",".min"),5);Cb.addEventListener("load",()=>{ya.a.J(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");
Va(Cb)});Cb.addEventListener("error",()=>{ya.a.J(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");hb(Cb)});document.head.appendChild(Cb)}),new Promise((Va,hb)=>{const Cb=document.createElement("script");Cb.async=!1;Cb.src=w.AFrameworkApplication.Ji(String.format("pptspeechclient{0}.js",".min"),5);Cb.addEventListener("load",()=>{ya.a.J(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");Va(Cb)});Cb.addEventListener("error",()=>{ya.a.J(509636754,830,10,
"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");hb(Cb)});document.head.appendChild(Cb)})]).then(()=>{za.loadScriptEnd=Date.now();const Va={Type:"LoadedJS"};ta.a.forEach(za,(hb,Cb)=>{Va[hb]=Cb},null);this.aec(Va);this.K.resolve("PowerPointWebEditor.ISlideshowManager").wFg||(ya.a.J(509636753,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(w.AFrameworkApplication.buildVersion,
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").Ck,w.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.K.resolve("PowerPointWebEditor.ISlideshowManager").$ql());return null}).catch(Va=>{this.aec({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});ya.a.J(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Va)})}else this.la.ka("DefaultToModernSlideShow")?
this.aec({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):ya.a.J(512309319,830,15,"PPTWebEditorSlideShowPackage::PptDefaultToModernSlideShow is disabled"),this.K.register(403,"PowerPointWebEditor.ISlideshowFrame").na().oa(()=>new oR.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),this.ob,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ia("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),
this.K.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").xI));this.K.register(hD,"PowerPointWebEditor.SlideShowFooterContainer").oa(()=>new hD(this.ob,w.AFrameworkApplication.Qa));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").vb();let G;if(!this.la.Wbc||this.la.Ajh)this.K.register(kD,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").na().oa(()=>new kD(w.AFrameworkApplication.Qa,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ia("PowerPointLive.ILivePresenter"),this.ob,()=>w.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=as.a(this.K);c=new Oa.a;c.add(a("slideshowToolbar"));this.la.WVk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Va=>
ya.a.J(50907106,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the slideshowToolbar feature: {0}",Va)).then(()=>this.yMk()).catch(Va=>ya.a.J(50907136,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React slideshowToolbar: {0}",Va));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Va=>ya.a.J(51218050,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the ink button feature: {0}",Va)).then(()=>this.xIk()).catch(Va=>ya.a.J(51218052,830,10,
"PPTWebEditorSlideShowPackage::Failed to load the React ink button: {0}",Va)),this.K.register(404,"PowerPointWebEditor.IInkButtonHelper").na().oa(()=>new bK));this.la.N_&&this.fdk(a);if(this.la.pptEditorVoiceUXEnabled){const Va=this;a("voiceUI").catch(hb=>ya.a.J(595198419,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the voice UI feature: {0}",hb)).then(()=>Va.zMk()).catch(hb=>ya.a.J(595198417,830,10,"PPTWebEditorSlideShowPackage::Failed to load the voice UI script: {0}",
hb));this.K.register(405,"PowerPointWebEditor.ISlideShowVoiceNotification").na().oa(()=>new hK)}const za=this;this.K.register(gD,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").na().oa(()=>new gD(w.AFrameworkApplication.Qa,za.la,za.K.resolve("PowerPointWebEditor.ISlideshowFrame"),za.K.resolve("PowerPoint.IPathManager"),za.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),za.K.Ia("PowerPointLive.ILivePresenter"),za.ob,()=>w.AFrameworkApplication.isRtl,
za.la.podsWebServiceBase,za.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),za.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}G=this.K.Ia("PowerPointWebEditor.ISlideshowToolbar");const R=this;this.K.register(jD,"PowerPointWebEditor.SlideshowContextMenu").oa(()=>new jD(R.K.resolve("PowerPointWebEditor.ISlideshowFrame"),R.K.resolve("PowerPointWebEditor.IPresentationReader"),R.K.resolve("PowerPointWebEditor.IInputHandlerManager"),w.AFrameworkApplication.Qa,R.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
R.ob,()=>w.AFrameworkApplication.isRtl,R.K.resolve("PowerPointWebEditor.IFullscreenHelper"),R.K.Ia("PowerPointLive.ILivePresenter")));const ja=this;this.K.register(406,"PowerPointWebEditor.ISlideshowManager").na().oa(()=>new iK(ja.K.resolve("PowerPointWebEditor.IFullscreenHelper"),ja.K.resolve("PowerPointWebEditor.ISlideshowFrame"),G,ja.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),ja.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),w.AFrameworkApplication.Je,ja.la,b,ja.K.resolve("PowerPointWebEditor.IPresentationReader"),
ja.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),ja.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ja.K.resolve("PowerPointWebEditor.IErrorHandler"),Fb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),ja.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),Zm.a.Ot(Fb.a.instance.Ia("Common.ISystemInitiatedFeedback")),w.AFrameworkApplication.Qa,Fb.a.instance.Ia("PowerPointLive.ILivePresenter"),ja.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),
ja.K.Ia("PowerPointWebEditor.ISlideShowVoiceNotification")))}fdk(a){a("optionsButton").catch(b=>ya.a.J(508912669,830,10,"Failed to load the resources for the options menu button feature: {0}",b)).then(()=>this.QJk()).catch(b=>ya.a.J(508912668,830,10,"Failed to load the React options menu button: {0}",b));this.K.register(407,"PowerPointWebEditor.IOptionsButtonLoader").na().oa(()=>new mK)}aec(a){ya.a.J(594583632,830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+JSON.stringify(a))}wXj(){const a=
this.la.Ha("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());ya.a.J(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return ya.a.J(512309316,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",
b.Browser,b.BrowserMajorVersion),!1;return!0}vXj(){const a=this.la.Ha("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ha("SessionStartInfoJson").toString());ya.a.J(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return ya.a.J(512309314,
830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}xXj(a){return lK.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").$e(Object(H.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){Sd.a.get_instance().Vj(10,null).continueWith(()=>{if(!this.la.qJ&&this.la.wjh&&this.la.pXk)try{Zm.a.Ot(Fb.a.instance.Ia("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen","PresentTeachingUIEnabled")}),
ya.a.J(512495957,830,50,"PPTWebEditorSlideShowPackage::Present Teaching UI triggered")}catch(a){ya.a.J(512495956,830,10,"PPTWebEditorSlideShowPackage::Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}yMk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}xIk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}QJk(){this.K.resolve("PowerPointWebEditor.IOptionsButtonLoader")}zMk(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");
return null}dispose(){}static main(){n.a.instance.Ac(new mD)}}Object(m.a)(mD,"PPTWebEditorSlideShowPackage",null,[2,3]);var qR=d(796);class nK{constructor(){this.Qfc=null}eAl(a,b){Mj.UISurfaces.KL().then(c=>{this.Qfc=a.oYi(c,a.nQi(b),b,this.Qfc)});ya.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}m$k(a){Mj.UISurfaces.KL().then(b=>{this.Qfc=a.b$k(b,this.Qfc)});ya.a.J(523871965,843,50,"{0} Toast is removed",this.Qfc)}}Object(m.a)(nK,"DeferredNotificationCalloutVisibilityManager",
null,[]);var oK=d(1057);const rR=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=a;a={};a.telemetryGroup=b;return a},sR=(a,b,c,f)=>{const l=new sh.StandardDialog;l.Ad=0;if(w.AFrameworkApplication.iF){const y=rR(b);l.vTd(ResourceStrings.L_GiveFeedback,void 0,void 0,y)}l.Tx(c,f,0,a?y=>{1===y?(ya.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):ya.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class nD{constructor(a,b,c,f,l,y,G){this.l$={};this.cxa=new Qe.a;
this.jdd=this.fGe=null;this.Gbd=this.rEe=0;this.oFg=!1;this.Ced={};if(!G)throw Error.argumentNull("coreEventSource");this.IM=a;this.Mq=c;this.IM.gk(Object(H.a)(this,this.ydh,"onShapeNodePropertyChanged"));this.IM.kja(Object(H.a)(this,this.Knc,"onShapeNodeLoaded"));this.IM.ija(Object(H.a)(this,this.xdh,"onShapeNodeConnected"));this.ICg=new nK;this.Gg=l;b.iUd(Object(H.a)(this,this.YMe,"onClientError"));b.JUd(Object(H.a)(this,this.HOe,"onServerError"));w.AFrameworkApplication.MJc(Object(H.a)(this,this.uNe,
"onErrorDialogDisplayed"));this.VDg=f;this.Jma=y;this.ih=G;this.ih.qB(Object(H.a)(this,this.ndh,"onSessionRehydratedHandler"))}sAf(a,b){this.cxa.Gb(a)||this.cxa.$(a,new Ma.a);const c=this.cxa.ga(a);c.add(b);this.cxa.$(a,c)}jqh(a,b){if(this.cxa.Gb(a)){var c=this.cxa.ga(a);c.remove(b);this.cxa.$(a,c);this.ihe(a)||this.cxa.remove(a);Iq.a(this.l$).length||ya.a.J(509150993,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else ya.a.J(509150994,843,15,
"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",a,b)}ihe(a){return this.cxa.Gb(a)&&0<this.cxa.ga(a).count}mLf(a){if(a.slideId&&a.slideId.sid&&a.a6c){var b=a.a6c;a.H4?(this.oFg||(this.oFg=!0,ya.a.J(509150992,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Jma)),b in this.l$||(this.l$[b]=new Date),this.sAf(a.slideId.sid.toString(),b)):b in this.l$&&(delete this.l$[b],this.jqh(a.slideId.sid.toString(),
b),ya.a.J(509150991,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}Knc(a,b){(a=Object(sa.a)(4,b.node))?this.mLf(a):ya.a.J(509150990,843,10,"IDeferrable object is null")}xdh(a,b){(a=Object(sa.a)(4,b.node))?this.mLf(a):ya.a.J(509150989,843,10,"IDeferrable object is null")}ydh(a,b){var c=Object(sa.a)(4,b.node);if(!c)ya.a.J(509150988,843,10,"IDeferrable object is null");else if((b.property===va.a.H4||this.Jma&&c.a6c in this.l$&&!c.H4)&&c.slideId)if(b=
c.a6c,a=c.slideId.sid.toString(),c.H4)b in this.l$?ya.a.J(509150987,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",b,this.Jma):(ya.a.J(509150986,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.Jma),this.l$[b]=new Date,this.sAf(a,b));else{if(c=this.l$[b])c=(new Date).getTime()-c.getTime(),ya.a.J(509150985,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Jma),delete this.l$[b],this.jqh(a,b),this.Gbd=c>this.Gbd?c:this.Gbd;this.VDg&&
!this.hasDeferredContent()&&(ya.a.J(509150984,843,50,"All deferred blobs loaded"),this.Zra("AllDeferredBlobsLoaded","true"),this.jdd&&(ya.a.J(509150983,843,50,"Previously called user requested actions triggered"),this.Zra("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.jdd(),this.ICg.m$k(this.fGe),this.fGe=this.jdd=null))}}ndh(){ya.a.J(509150982,843,50,"Session rehydrated with {0} currently deferred blobs",Iq.a(this.l$).length)}z3e(a,b,c){this.VDg?(this.fGe=b,this.jdd=c,this.ICg.eAl(b,
this.Gg)):(c=Object(Sa.a)(oK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,b=Object(Sa.a)(oK.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,sR(null,a.toString(),c,b));ya.a.J(509150979,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}Zra(a,b){this.Ced[a]&&ya.a.J(509150978,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",
a,this.Ced[a]);this.Ced[a]=b}YMe(a,b){this.Ooa("ClientError",b)}HOe(a,b){this.Ooa("ServerError",b)}uNe(a,b){(a=Object(sa.a)(qR.a,b))&&this.Ooa("Crash",a.errorCode)}Ooa(a,b){this.hasDeferredContent()&&ya.a.J(509150977,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.Jma)}dispose(){this.IM.Qm(Object(H.a)(this,this.ydh,"onShapeNodePropertyChanged"));this.IM.H0a(Object(H.a)(this,this.Knc,"onShapeNodeLoaded"));this.IM.Xoa(Object(H.a)(this,
this.xdh,"onShapeNodeConnected"));this.ih.Raa(Object(H.a)(this,this.ndh,"onSessionRehydratedHandler"));this.log()}hasDeferredContent(){const a=Iq.a(this.l$),b=this.Jma&&0<a.length||0<this.Mq.p9a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.Mq.p9a.toString();c.FForceShowDeferralUI=this.Jma.toString();ya.a.J(509150976,843,50,JSON.stringify(c));this.rEe=Math.max(this.Mq.p9a,this.rEe)}return b}JKj(a){return Ub.a.any(a,b=>b.hasDeferredContent)?(ya.a.J(509150947,843,
50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Jma),!0):!1}hhe(a,b){return Ub.a.any(a,c=>c.H4)?(ya.a.J(509150946,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Jma),!0):!1}log(){const a=Iq.a(this.l$),b={};b.MaxDeferredTime=this.Gbd.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.rEe.toString();b.FForceShowDeferralUI=this.Jma.toString();ya.a.J(509150945,843,15,"SessionLogs: {0}, PersistedLogs: {1}",
JSON.stringify(b),JSON.stringify(this.Ced))}}Object(m.a)(nD,"DeferredContentManager",null,[499]);class oD{constructor(){this.Lw=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Xb(a){this.K=a;this.K.register(nD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").na().oa(()=>new nD(this.K.resolve("Box4.Graph.IGraphInstance").zd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),
this.K.resolve("Common.IF6Manager"),0<this.K.resolve("Common.IAppSettingsManager").uc("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.Lw=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.Lw&&this.Lw.dispose()}static main(){n.a.instance.Ac(new oD)}}Object(m.a)(oD,"PPTWebEditorPartialDocPackage",null,[2,3]);class Ov{constructor(a,b){this.shapeNode=a;this.position=b}}Object(m.a)(Ov,"MoveShapeData",null,[]);class pK{constructor(a,
b){this.XO=null;this.Dp=a;this.ia=b}start(){this.XO=[];for(let a=0;a<this.Dp.length;++a)Array.add(this.XO,new cd.a(this.Dp[a].x,this.Dp[a].y)),this.Dp[a].jE(!1)}fZd(a,b){if(1!==a||this.Dp.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.OZj(b[a]))return!1;return!0}OZj(a){for(let b=0;b<this.Dp.length;b++)if(a.gb.equals(this.Dp[b].gb))return!0;return!1}perform(a){for(let c=0;c<this.Dp.length;c++){var b=new cd.a(this.Dp[c].x,this.Dp[c].y);b=cd.a.add(b,a);this.Dp[c].setPosition(b.x,b.y,!0)}}end(){this.XO&&
ya.a.J(17597603,815,50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.Dp.length,this.Dp[0].x-this.XO[0].x,this.Dp[0].y-this.XO[0].y);const a=[];for(let b=0;b<this.Dp.length;++b){const c=this.Dp[b].qVc();Array.add(a,new Ov(this.Dp[b].shapeNode,c));this.Dp[b].hA(!1)}this.ia.Ja(ea.a.BJa,2,a)}}Object(m.a)(pK,"ShapeMoveAction",null,[927]);class Az{constructor(a,b,c=null,f=null){this.i2=a;this.X1=b;this.j5b=c;this.S6g=f}}Object(m.a)(Az,"ResizeShapeData",null,[]);class qK{constructor(a,
b){this.TGa=this.CDb=this.WHe=null;this.qG=a;this.ia=b}start(){this.WHe=[];this.CDb=[];this.TGa=[];for(const c of this.qG){c.aM=!0;c.jE(!1);Array.add(this.WHe,c.k_a);Array.add(this.CDb,new Gi.a);var a=c.Yxb(),b=cd.a.Ql(a.Wj(rd.a.Zu),a.Wj(rd.a.TE));a=cd.a.Ql(a.Wj(rd.a.Zu),a.Wj(rd.a.iI));Array.add(this.TGa,a?b/a:1);c.shapeNode.Of&&c.shapeNode.isEditable&&(b=c,b.Dk&&(b.Dk.visible=!0))}}fZd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].Ml||!b[a].gb.equals(this.qG[a].gb))return!1;return!0}perform(a,
b){for(let f=0;f<this.qG.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.ESl(c,l,f));let y;(y=this.CDb[f]).right=y.right+c;let G;(G=this.CDb[f]).bottom=G.bottom+l;this.qG[f].setOffsets(Gi.a.add(this.WHe[f],this.CDb[f]),!0);this.qG[f].shapeNode.Of&&this.qG[f].shapeNode.isEditable&&(c=this.qG[f],c.Nhe(),c.c_c())}}ESl(a,b,c){if(!this.qG[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.TGa[c]:b=a/this.TGa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.qG.length;b++)this.qG[b].Ml||
(this.qG[b].shapeNode.Of&&this.qG[b].shapeNode.isEditable||(this.qG[b].aM=!1),this.qG[b].hA(!1),Array.add(a,new Az(this.qG[b].shapeNode,this.CDb[b])));this.ia.Ja(ea.a.Ckb,2,a);this.qG=null}}Object(m.a)(qK,"ShapeResizeAction",null,[927]);class tp{constructor(a,b){this.shapeNode=a;this.b4d=b%tp.aoc}}tp.aoc=360;Object(m.a)(tp,"ShapeRotateData",null,[]);class rK{constructor(a,b){this.ABg=null;this.Fue=0;this.Zd=a;this.ia=b}start(){this.Zd.jE(!1);this.ABg=this.Zd.Yxb().Zf()}fZd(a,b){return 3===a&&!this.Zd.Ml&&
this.Zd.gb.equals(b[0].gb)}perform(a){this.Fue=(this.Zd.rotation+a)%tp.aoc;this.Zd.setRotation(this.Fue,this.ABg)}end(){if(!this.Zd.Ml){this.Zd.hA(!1);var a=new tp(this.Zd.shapeNode,this.Fue);this.ia.Ja(ea.a.Bsc,2,a)}}}Object(m.a)(rK,"ShapeRotateAction",null,[927]);class Pp{constructor(a){this.nJa=this.gR=null;this.ia=a}Ixc(){this.nJa&&Kc.a.evb(this.nJa);this.nJa=Kc.a.gba(Object(H.a)(this,this.HYf,"endAction"),Pp.jyi)}E6d(a,b){this.gR&&!this.gR.fZd(a,b)&&(this.gR.end(),this.gR=null);if(!this.gR){this.gR=
this.Pcj(a,b);if(!this.gR)throw Error.invalidOperation("Could not create keyboard action");this.gR.start()}this.Ixc();return this.gR}HYf(){this.gR&&(this.gR.end(),this.gR=null);this.nJa=null}move(a,b){a=this.E6d(1,a);b=this.FVf(b);a.perform(b)}resize(a,b){a=this.E6d(2,a);b=this.FVf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.E6d(3,a);c=c?Pp.Zxi:Pp.Yxi;a.perform(b?c:-1*c)}FVf(a){let b=0,c=0;a.equals(rd.a.north)?c=-1*Pp.fMc:a.equals(rd.a.east)?b=Pp.fMc:a.equals(rd.a.south)?c=Pp.fMc:a.equals(rd.a.west)&&
(b=-1*Pp.fMc);return new cd.a(b,c)}Pcj(a,b){return b?1===a?new pK(b,this.ia):2===a?new qK(b,this.ia):3===a&&(1<b.length&&ya.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new rK(b[0],this.ia):null:null}}Pp.jyi=1E3;Pp.fMc=1;Pp.Yxi=15;Pp.Zxi=1;Object(m.a)(Pp,"ShapeKeyboardDragManager",null,[896]);var Vg=d(155),ht=d(523);const On=a=>{a&&Kc.a.Kb&&(Kc.a.Kb.pgg=a.Of,Kc.a.Kb.yIh=a.Ug)};
var Nq=d(237),sK=d(507),Qx=d(332);class pD{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd){if(!yc)throw Error.argumentNull("ISessionInfoOwner is null");if(!ec)throw Error.argumentNull("IPPTUnitConversion is null");if(!jc)throw Error.argumentNull("IZoomContext is null");ic||ya.a.J(509650844,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.qf=b;this.qq=c;this.Fa=f;this.jb=l;this.Hed=y;this.Fb=G;this.Eb=R;this.Ga=ja;this.$d=za;this.Sp=Cb;this.DA=Va;
this.ged=hb;this.Da=lc;this.eic=new Eb.ScriptSharpLegacyMap;this.NZa=ic;this.Ya=yc;this.oi=ec;this.lj=jc;this.Hi=xd;this.Yva=Xd}vb(){this.ia.ra(ea.a.C8a,qc.a.application,Object(H.a)(this,this.jEj,"handleDeleteSelectedShapes"),4);this.ia.ra(ea.a.C4b,qc.a.application,Object(H.a)(this,this.kEj,"handleDeleteShapes"),4);this.ia.ra(ea.a.BJa,qc.a.application,Object(H.a)(this,this.qGj,"handleMoveShapes"),4);this.ia.ra(ea.a.Ckb,qc.a.application,Object(H.a)(this,this.BIj,"handleResizeShapes"),4);this.ia.ra(ea.a.Bsc,
qc.a.application,Object(H.a)(this,this.Pge,"handleRotateShape"),4);this.ia.ra(ea.a.evh,qc.a.application,Object(H.a)(this,this.Qge,"handleRotateShapes"),4);this.ia.ra(ea.a.cvh,qc.a.application,Object(H.a)(this,this.Shg,"handleRotateShapeAnchor"),4);this.ia.ra(ea.a.dvh,qc.a.application,Object(H.a)(this,this.Shg,"handleRotateShapeAnchor"),4);this.ia.ra(ea.a.Yaa,qc.a.application,Object(H.a)(this,this.Thg,"handleRotateShapeByDirection"),4);this.ia.ra(ea.a.oZe,qc.a.application,Object(H.a)(this,this.Thg,
"handleRotateShapeByDirection"),4);qd.a("FlipInMultiSelectEnabledV2")?(this.ia.ra(ea.a.Dsc,qc.a.application,Object(H.a)(this,this.Xgg,"handleFlipShape"),4),this.ia.ra(ea.a.Csc,qc.a.application,Object(H.a)(this,this.Xgg,"handleFlipShape"),4)):(this.ia.ra(ea.a.Dsc,qc.a.application,Object(H.a)(this,this.Ygg,"handleFlipShapeForSingleSelection"),4),this.ia.ra(ea.a.Csc,qc.a.application,Object(H.a)(this,this.Ygg,"handleFlipShapeForSingleSelection"),4));this.ia.ra(ea.a.N8a,qc.a.application,Object(H.a)(this,
this.RDj,"handleCommitKeyboardShapeManipulation"),4);this.ia.ra(ea.a.lmc,rb.a.view,Object(H.a)(this,this.oZc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.mmc,rb.a.view,Object(H.a)(this,this.oZc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.nmc,rb.a.view,Object(H.a)(this,this.oZc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.omc,rb.a.view,Object(H.a)(this,this.oZc,"handleMoveShapesKeyboard"),4);this.ia.ra(ea.a.ksc,rb.a.view,Object(H.a)(this,this.uZc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.msc,
rb.a.view,Object(H.a)(this,this.uZc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.nsc,rb.a.view,Object(H.a)(this,this.uZc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.osc,rb.a.view,Object(H.a)(this,this.uZc,"handleResizeShapesKeyboard"),4);this.ia.ra(ea.a.mZe,rb.a.view,Object(H.a)(this,this.vZc,"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.vrd,rb.a.view,Object(H.a)(this,this.vZc,"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.urd,rb.a.view,Object(H.a)(this,this.vZc,"handleRotateShapeKeyboard"),
4);this.ia.ra(ea.a.Esc,rb.a.view,Object(H.a)(this,this.vZc,"handleRotateShapeKeyboard"),4);this.ia.ra(ea.a.cUe,qc.a.application,Object(H.a)(this,this.Cge,"handleIsDirectManipulationEnabled"),97);this.ia.ra(ea.a.eSe,qc.a.application,Object(H.a)(this,this.Fhg,"handlePreviewRotate"),4);this.ia.ra(ea.a.fSe,qc.a.application,Object(H.a)(this,this.Fhg,"handlePreviewRotate"),4);this.ia.ra(ea.a.dZe,qc.a.application,Object(H.a)(this,this.EIj,"handleRevertPreviewRotate"),4)}me(){const a=this.Fa.Ic(xa.a.qg);
a.bindAction(x.KeyInputManager.Va(B.a.o7,4),ea.a.ksc);a.bindAction(x.KeyInputManager.Va(B.a.Jba,4),ea.a.msc);a.bindAction(x.KeyInputManager.Va(B.a.wha,4),ea.a.nsc);a.bindAction(x.KeyInputManager.Va(B.a.CZ,4),ea.a.osc);a.bindAction(x.KeyInputManager.Va(B.a.Jba,5),ea.a.urd);a.bindAction(x.KeyInputManager.Va(B.a.wha,5),ea.a.Esc);a.bindAction(x.KeyInputManager.Va(B.a.Jba,1),ea.a.mZe);a.bindAction(x.KeyInputManager.Va(B.a.wha,1),ea.a.vrd);a.bindAction(x.KeyInputManager.Va(B.a.vha,0),ea.a.C8a);a.bindAction(x.KeyInputManager.Va(B.a.FG,
0),ea.a.C8a);this.Fa.Ic(xa.a.$i).bindAction(x.KeyInputManager.Va(B.a.Jba,1),F.a.we)}qGj(a,b,c,f,l){if(!l||!Object(Sa.a)(Array,l)||1>l.length)return 8;for(const G of l)if(b=G.shapeNode,this.cTa(b),b.get_smartArtModelId()&&(b=this.Ga.Lr(b)),!this.VJf(b)||this.qf.fd(G.shapeNode))return 16;if(1===c)return 32;if(Kc.a.Kb){Kc.a.Kb.Qj=!0;for(var y of l)if((c=y.shapeNode)&&(c.Of||c.Ug)){On(c);break}}y=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{y.jc(l[0].shapeNode);y.gd=a;const G=this.Eb.Nd;
for(const R of l){const ja=new cd.a(G.gf(R.position.x,0),G.gf(R.position.y,1));Dq.c(R.shapeNode.get_smartArtModelId()?this.Ga.Lr(R.shapeNode):R.shapeNode,ja.x,ja.y)}}finally{y&&y.dispose()}return 32}BIj(a,b,c,f,l){if(!l||!Object(Sa.a)(Array,l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.K1b(l[b].i2))return ya.a.J(509650842,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].i2.get_shapeId()),16;if(this.qf.fd(l[b].i2))return 16}if(1===
c)return 32;if(Kc.a.Kb){Kc.a.Kb.Qj=!0;for(var y of l)if((c=y.i2)&&(c.Of||c.Ug)){On(c);break}}y=this.Fb.yd(15,void 0,()=>{this.jb.nj();const G=this.Fa.Ee;!G||G.name!==xa.a.qg&&G.name!==xa.a.Qz||this.Fa.Bd()});try{for(y.jc(l[0].i2),y.gd=a,a=0;a<l.length;a++)l[a].i2.UBh=l[a].X1}finally{y&&y.dispose()}if(this.jb.dM()&&(a=this.jb.cFa(),(a=this.rk(a))&&Object(Sa.a)(ht.a,a.Dk)&&Object(sa.a)(ht.a,a.Dk).clearChildSelection(),this.NZa&&this.Da.HDl))for(const G of l)this.Aml(G);return 32}Aml(a){const b=a.i2;
if(b&&b.Wf&&!b.Ug){var c=Kc.a.Kb?Kc.a.Kb.actionId:oh.a.create().toString(),f=w.AFrameworkApplication.userSessionId,l=this.Ya.podSessionId,y=this.ADl,G=this.imb,R=G/y,ja=ve.a.RY(this.oi.cI(a.X1.left,R),0),za=ve.a.RY(this.oi.cI(a.X1.top,R),1),Va=ve.a.RY(this.oi.cI(a.X1.right,R),0);a=ve.a.RY(this.oi.cI(a.X1.bottom,R),1);R=Math.abs(b.get_widthPersisted()+Va-ja);var hb=Math.abs(b.get_heightPersisted()+a-za);Va=Kk.o(b.slideCid,b.slideSid);a=Kk.b(b.get_shapeId(),null);var Cb=Kk.f(Va,a);ja=Kk.m((b.get_xPersisted()+
ja).toString(),(b.get_yPersisted()+za).toString());ja=Kk.n(R,hb,ja);ja=Kk.c(Cb,ja);za=null;this.Hi&&this.Hi.highContrastColors&&(za=Kk.k(Kk.j(this.Hi.highContrastColors.foregroundTextColor),Kk.j(this.Hi.highContrastColors.backgroundColor),Kk.j(this.Hi.highContrastColors.linkColor)));f=Kk.d(Va,a,1,b.Uf,0,0,c,f,this.Hi.isInHighContrastMode,za,this.Da.Uxh&&this.Yva?this.Yva.Wmj():null);l=Kk.e(f,[],l);l.editOps.push(ja);l=Kk.q(null,l,null,null,this.Ya.Ck);f=Kc.a.xZ();Kc.a.Kb&&f&&(Kc.a.Kb.Wa("editOpCorrelationId",
c),Kc.a.Kb.Wa("editOpRequestStartTick",f.toString()));this.NZa.Xx(l);ya.a.J(509650841,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",c,b.slideSid,b.slideCid,b.get_shapeId(),y,G,this.Da.Uxh)}}get ADl(){let a=this.lj.$G;this.qq&&this.qq.Ba&&this.qq.Ba.lx&&null!=this.qq.Ba.lx.ps&&(a=this.qq.Ba.lx.ps);a||(ya.a.J(509650840,815,
15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get imb(){let a=1;if(this.qq&&this.qq.Ba){const b=Object(sa.a)(424,this.qq.Ba.rg(this.Eb.Na));b?a=b.$T:ya.a.J(509650839,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else ya.a.J(509650838,815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(ya.a.J(509650837,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}Thg(a,
b,c,f,l){return 1===c?32:Vg.a("Rotate",a,()=>{ya.a.J(509650836,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const y=this.jb.Qf();if(!y)return ya.a.J(509650835,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.ged&&1===y.length&&this.cTa(y[0]);switch(a){case ea.a.Yaa:ya.a.J(509650834,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");if(qd.a("FixUndoRotateMultipleShapes")){var G={};G.selectedNodes=
y;G.rotateLeft=!0;this.Qge(a,b,c,f,G)}else for(G of y)l=new tp(G,Math.round(G.get_shapeRotation()+270)),this.Pge(a,b,c,f,l);break;case ea.a.oZe:ya.a.J(509650833,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");if(qd.a("FixUndoRotateMultipleShapes"))G={},G.selectedNodes=y,G.rotateRight=!0,this.Qge(a,b,c,f,G);else for(const R of y)l=new tp(R,Math.round(R.get_shapeRotation()+90)),this.Pge(a,b,c,f,l);break;default:return 8}return 32})}Qge(a,b,c,f,l){if(!l)return 8;b=l.selectedNodes;
f=l.rotateData?l.rotateData:[];for(const y of b){const G=this.Hub(y);if(1===c)return G?32:8;if(!G||this.qf.fd(y))return 16}if(l.rotateLeft||l.rotateRight)for(const y of b)Kc.a.Kb&&(Kc.a.Kb.Qj=!0,y&&(y.Of||y.Ug)&&On(y)),c=new tp(y,Math.round(y.get_shapeRotation()+(l.rotateLeft?270:90))),f.push(c);l=this.Fb.yd(15,void 0,()=>{this.jb.nj();const y=this.Fa.Ee;!y||y.name!==xa.a.qg&&y.name!==xa.a.Qz||this.Fa.Bd()});try{for(l.jc(b[0]),l.gd=a,a=0;a<b.length;a++)b[a].set_shapeRotation(f[a].b4d)}finally{l&&
l.dispose()}return 32}Pge(a,b,c,f,l){if(!l||!Object(Sa.a)(tp,l))return 8;b=l.shapeNode;f=this.Hub(b);if(1===c)return f?32:8;if(!f||this.qf.fd(b))return 16;Kc.a.Kb&&(Kc.a.Kb.Qj=!0,b&&(b.Of||b.Ug)&&On(b));c=this.Fb.yd(15,void 0,()=>{this.jb.nj();const y=this.Fa.Ee;!y||y.name!==xa.a.qg&&y.name!==xa.a.Qz||this.Fa.Bd()});try{c.jc(b),c.gd=a,b.set_shapeRotation(l.b4d)}finally{c&&c.dispose()}return 32}Shg(){const a=this.jb.Qf();return 0<a.length&&this.a6j(a)?32:8}Fhg(a,b,c){return this.Da.Fpc?1===c?32:Vg.a("HandlePreviewRotate:",
a,()=>{var f=this.jb.Qf();for(const l of f){if(!l){ya.a.J(509650831,822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.xd)continue;this.eic.Gb(l.get_shapeId())?this.eic.$(l.get_shapeId(),l.get_shapeRotation()):this.eic.add(l.get_shapeId(),l.get_shapeRotation());f=this.rk(l);if(!f){ya.a.J(509650830,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const y=f.Yxb().Zf();switch(a){case ea.a.eSe:f.setRotation((l.get_shapeRotation()+
270)%tp.aoc,y);break;case ea.a.fSe:f.setRotation((l.get_shapeRotation()+90)%tp.aoc,y)}}return 32}):2}EIj(a,b,c){if(!this.Da.Fpc)return 2;if(1===c)return 32;a=this.jb.Qf();for(const f of a)if(!f)ya.a.J(509650829,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());else if(!f.xd)if(a=this.rk(f))if(b=a.Yxb().Zf(),this.eic.Gb(f.get_shapeId()))a.setRotation(this.eic.ga(f.get_shapeId()),b);else return ya.a.J(509650827,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",
f.get_shapeId()),8;else ya.a.J(509650828,822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}jEj(a,b,c,f,l){b=this.jb.Qf();if(1===b.length&&this.jb.uz())return 16;f=1===b.length&&!!b[0]&&b[0].$bb();f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Kc.a.Kb){Kc.a.Kb.actionName="ClearPlaceholders";Kc.a.Kb.Qj=!0;for(const y of b)if(y.Of||y.Ug){On(y);break}}if(this.jb.dM()&&qd.a("EnableSmartArtSubShapeDeletion")&&this.wge(b[0],a,l))return 32;
c=null;if(l=this.Ga.cab(b))qd.a("SmartArtSubNodeEditing")?c=this.Ga.Lr(l):(this.jb.Cqd(l),b=this.jb.Qf());return this.C4b(a,b,this.jb.Fk(),c)?32:16}kEj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.qq.presentation;if(!b)throw Error.argumentNull("Presentation is null");l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Kc.a.Kb&&(Kc.a.Kb.actionName="DeleteShapes",Kc.a.Kb.Qj=!0);return l.length&&this.C4b(a,l,Object(sa.a)(116,b.XC(l[0].slideId)))?32:16}C4b(a,b,c,f=
null){if(!c||!b.length||this.qf.dD(b))return!1;let l=!1;for(var y of b)if(y.SFa){l=!0;break}y=this.Fb.yd(15,void 0,()=>{this.jb.nh()});try{f?y.ld(f):y.ld(c);y.gd=a;y.ry[Nq.a.Fzb]=l;for(const G of b)if(G&&G.Ug){const R=this.Ga.Fs(G);if(R){const ja=vg.c(R,this.Eb.Na);ja&&(ja.Dk.visible=!1)}}f?f.Nqh(b):c.cS(b)}finally{y&&y.dispose()}for(const G of b)this.Sp.lnh(new sK.a(G));return!0}Ygg(a,b,c){b=this.jb.Qf();const f=0<b.length?b[0]:null,l=1===b.length&&this.gZd(f);if(1===c)return l?32:8;if(!l||this.qf.fd(f))return 16;
this.cTa(f);for(const y of b)if(y.Of||y.Ug){On(y);break}return Vg.a("Rotate",a,()=>{let y,G;switch(a){case ea.a.Csc:G=f.get_isVerticallyFlipped();y=!f.get_isHorizontallyFlipped();break;case ea.a.Dsc:G=!f.get_isVerticallyFlipped();y=f.get_isHorizontallyFlipped();break;default:return 8}const R=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{R.jc(f),R.gd=a,f.set_isVerticallyFlipped(G),f.set_isHorizontallyFlipped(y)}finally{R&&R.dispose()}return 32})}Xgg(a,b,c){const f=this.jb.Qf();b=!0;if(!f||
f&&!f.length)b=!1;for(const G of f)if(b=this.gZd(G),!b)break;if(1===c)return b?32:8;if(!b)return ya.a.J(509650822,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const G of f){if(this.qf.fd(G))return 16;this.cTa(G)}for(const G of f)if(G.Of||G.Ug){On(G);break}const l=a===ea.a.Csc,y=a===ea.a.Dsc;return l||y?Vg.a("Rotate",a,()=>{const G=Array(f.length),R=Array(f.length);for(var ja=0;ja<f.length;ja++)R[ja]=!!(y^f[ja].get_isVerticallyFlipped()),
G[ja]=!!(l^f[ja].get_isHorizontallyFlipped());ja=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{ja.jc(f[0]);ja.gd=a;for(let za=0;za<f.length;za++)f[za].set_isVerticallyFlipped(R[za]),f[za].set_isHorizontallyFlipped(G[za])}finally{ja&&ja.dispose()}return 32}):(ya.a.J(509650821,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}RDj(){this.Hed.HYf();return 32}oZc(a,b,c){const f=vg.b(b);if(!f)return 16;b=this.jb.Qf();if(!b.length)return 16;let l=!0;const y=[];for(const G of b)if(G.get_smartArtModelId()){y.push(this.Ga.Lr(G));
break}else y.push(G);for(const G of y)if(!this.VJf(G)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=vg.d(y,f.Na);if(this.qf.dD(b))return 16;switch(a){case ea.a.lmc:a=rd.a.south;break;case ea.a.mmc:a=rd.a.west;break;case ea.a.nmc:a=rd.a.east;break;case ea.a.omc:a=rd.a.north;break;default:return 8}this.Hed.move(c,a);this.DA&&this.jb.dM()&&(a=this.jb.cFa(),this.$d.Ujb(new Qx.a(a)));Kc.a.Kb&&(Kc.a.Kb.Qj=!0,Kc.a.Kb.HF=new Date);return 32}uZc(a,b,c){const f=vg.b(b);b=this.jb.Qf();const l=[];for(var y of b){if(y.get_smartArtModelId()){this.jb.Cqd(y);
Array.add(l,this.Ga.Lr(y));break}!y.isResizable||y.pJ||y.xd||Array.add(l,y)}y=vg.d(l,f.Na);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.qf.dD(l))return 16;switch(a){case ea.a.ksc:a=rd.a.south;break;case ea.a.msc:a=rd.a.west;break;case ea.a.nsc:a=rd.a.east;break;case ea.a.osc:a=rd.a.north;break;default:return 8}this.Hed.resize(y,a);this.DA&&this.jb.dM()&&(a=this.jb.cFa(),this.$d.Ujb(new Qx.a(a)));Kc.a.Kb&&(Kc.a.Kb.Qj=!0,Kc.a.Kb.HF=new Date);return 32}vZc(a,b,c){var f=this.jb.Qf();const l=0<
f.length?f[0]:null,y=1===f.length&&this.Hub(l);if(1===c)return y?32:8;if(!y||this.qf.fd(l))return 16;b=vg.b(b);f=vg.d(f,b.Na);c=a===ea.a.vrd||a===ea.a.Esc;a=a===ea.a.urd||a===ea.a.Esc;0<f.length&&f[0].shapeNode.Of&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.rg(b.Na))&&b.c_c();this.Hed.rotate(f,c,a);Kc.a.Kb&&(Kc.a.Kb.Qj=!0,Kc.a.Kb.HF=new Date);return 32}Cge(a,b,c,f,l){return l&&Object(Sa.a)(9,l)?this.qf.fd(l)?16:32:8}a6j(a){for(const b of a)if(!this.Hub(b)&&!this.gZd(b))return!1;return!0}VJf(a){return!!a&&
a.tJ&&a.HB&&!a.pJ}K1b(a){return!!a&&a.isResizable&&a.HB&&!a.pJ}Hub(a){return!!a&&a.bM&&!a.pJ}gZd(a){return!!a&&a.I_j&&!a.pJ}rk(a){return a?Object(sa.a)(117,a.qc(this.Eb.Na)):null}cTa(a){a&&a.Lv&&(a=this.rk(a))&&a.cZ(!1)}wge(a,b,c){return(a=this.rk(a))&&Object(Sa.a)(ht.a,a.Dk)&&(a=Object(sa.a)(ht.a,a.Dk))?a.Poc(ea.a.uy(b),c):!1}}Object(m.a)(pD,"ShapeManipulationActor",null,[]);var Pv=d(429),Ui=d(68);class qD extends Pv.DragSelectionDragAdapter{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){super(a,b,
c);this.pa=f;this.Fa=l;this.la=R;this.Ga=y;this.Zwk=G;this.wD=ja;this.Tb=za;this.mq=Va;this.Efa=hb;this.zc=Cb;this.vzc=this.wzc=null}get pMc(){return this.wzc}get oMc(){return this.vzc}av(a){for(var b=this.D9e(),c=a.Bc,f=c,l=this.wD.eJ(f);!l&&f;){l=this.wD.eJ(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||ya.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+
" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.gb;c=this.Tb.Lc(l);if(b===l||c.kf()&&c.l3a()===b){l=super.av(a);if(!l)return l;this.Ga.K4(b)&&(c=this.zc.eO(Object(sa.a)(4,b)))&&c.Op()&&(c=this.Efa.Q8d(a.clientPoint,c,null,null))&&(f=c.qc(this.Nf.Na),this.Nf.i7(a.clientPoint,f,c,this.Nf,a.shiftKey));null!==this.mq&&(a=this.Ga.xd(b),this.mq.bza(Ui.a.rba),a&&(this.wzc=this.Efa.uce(b),this.vzc=this.Efa.V$f(b)));return l}return!1}Fu(a){super.Fu(a);this.wZf();null!==this.mq&&this.mq.Eya();this.pMc&&
(this.wzc=null);this.oMc&&(this.vzc=null)}vo(a){super.vo(a);this.wZf();null!==this.mq&&this.mq.Eya();this.pMc&&(this.wzc=null);this.oMc&&(this.vzc=null)}OIb(a,b,c){({ns:b,graphNode:c}=super.OIb(a,b,c));if(this.la.Ltg&&(a=this.D9e())){const f=this.Fgj(c);f&&f===a||(c=a,b=c.qc(this.Nf.Na))}return{ns:b,graphNode:c}}ixc(a){let b=super.ixc(a);if(!b&&this.la.Ltg){let c=this.D9e();if(c&&this.Ga.xd(c.node)){const f=this.pa.zn();this.Efa.v1c(a.clientPoint,f)&&(c=this.Efa.Q8d(a.clientPoint,f,this.pMc,this.oMc))}c&&
(b=c.qc(this.Nf.Na))}return b}Fgj(a){return a?this.Ga.An(a):null}D9e(){const a=this.Zwk.Fcg(this.Nf.Na);return!a||a.yH?null:this.pa.Ll()}wZf(){(this.pa.vH()||this.pa.Js())&&this.Fa.Bd()}}Object(m.a)(qD,"PPTDragSelectionDragAdapter",Pv.DragSelectionDragAdapter,[895,235]);class tK{constructor(a,b,c){this.We=a;this.n$=b;this.zc=c}v1c(a,b){if(!a||!b)return!1;b=b.qc(this.We);return b?(b=Cd.a.mi(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}Q8d(a,b,c=null,f=null){return(a=
this.f2f(a,b,c,f))?a.rz():null}f2f(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.V$f(b),c=this.uce(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.qc(this.We);if(!l)return null;var y=Cd.a.mi(l.htmlElement);if(!y)return null;l=a.x-y.x;y=a.y-y.y;var G=0;for(a=0;a<c.length&&!(G+=c[a],G>=y);a++);for(G=y=0;G<f.length&&!(y+=f[G],y>=l);G++);a=Math.min(a,c.length-1);G=Math.min(G,f.length-1);return 0>a||a>=c.length||0>G||G>=f.length?null:b.ff(a,G)}uce(a){if(a){a=this.zc.ala(a);if(!a||!a.length)return null;
const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].qc(this.We);if(!b)return null;b=Cd.a.mi(b.htmlElement);f[l]=b.height}return f}return null}V$f(a){if(a){a=eo.b(Object(sa.a)(Ig.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.n$.Pe(a[f],0);return c}return null}}Object(m.a)(tK,"PptTableDragSelectionHelper",null,[398]);var ks=d(660),Bz=d(349);class uK{constructor(a,b,c,f,l,y,G){this.ta=this.Ym=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!y)throw Error.argumentNull("insertShapeOverlayViewElement");if(!G)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Kc=b;this.oi=c;this.Eb=f;this.bYa=l;this.nfa=y;this.ua=G}Mv(a){try{return a?a.OA===Sys.UI.MouseButton.rightButton?!1:2===this.bYa.Nmg?!0:!1:(ya.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),
!1)}catch(b){throw ya.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}av(a){try{if(!a)return ya.a.J(512336008,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.Mv(a))return!1;this.nfa.Bl(Ui.a.GPb);this.Ym=ks.a(a.clientPoint,this.Kc.Hc);const b=new Gi.a;b.left=this.Ym.x;b.top=this.Ym.y;b.bottom=this.Ym.y+5;b.right=this.Ym.x+5;a={};a.offsets=b;a.insertShapeActionId=this.nfa.zAb;a.insertLocalShape=!0;if(32!=this.ia.Ja(ea.a.t0c,2,a))return!1;this.ta=
a.node;return!0}catch(b){throw ya.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}Sw(a){try{if(!a)return ya.a.J(512336006,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Eb.isActive)return!1;const b=ks.a(a.clientPoint,this.Kc.Hc),c=ks.b(this.Oxd(Math.min(this.Ym.y,b.y)-this.Ym.y),this.Oxd(Math.max(this.Ym.y,b.y)-this.Ym.y-5),this.Oxd(Math.min(this.Ym.x,b.x)-this.Ym.x),this.Oxd(Math.max(this.Ym.x,b.x)-this.Ym.x-5));Object(sa.a)(Bz.a,this.ta.qc(0)).setOffsets(c,
!0);return!0}catch(b){throw ya.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}vo(a){try{if(a)if(this.Ym){var b=ks.a(a.clientPoint,this.Kc.Hc),c=ks.b(Math.min(this.Ym.y,b.y),Math.max(this.Ym.y,b.y),Math.min(this.Ym.x,b.x),Math.max(this.Ym.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.nfa.zAb;a.insertLocalShape=!1;this.rUf();this.ia.Ja(ea.a.t0c,2,a);this.qL()}else ya.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else ya.a.J(512336004,
822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw ya.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",f),f;}}Fu(){this.qL()}dispose(){this.qL()}Oxd(a){return this.oi.tK(a,this.Kc.Hc.$T)}qL(){this.Ym=null;this.ta&&(this.rUf(),this.bYa.A8e(0),this.ta=null)}rUf(){this.ua.Ba.cS([this.ta])}}Object(m.a)(uK,"ShapeDrawDragAdapter",null,[235,108]);class Rx{constructor(a,b){this.iEg=null;this.ZDb=-1;this.vFe=a;this.Ukk=b}av(a){return this.tah(a)?(this.vFe.smd(),!0):
!1}Sw(a){if(!a)return!1;this.Ukk?(this.iEg=a,this.fkl()):this.oNe(a);return!0}vo(a){this.NMh()&&this.jXf(0);this.qah(a);this.vFe.tsc()}Fu(){this.NMh();this.oah();this.vFe.tsc()}fkl(){-1===this.ZDb&&(this.ZDb=window.requestAnimationFrame(Object(H.a)(this,this.jXf,"dragMoveTask")))}NMh(){return-1!==this.ZDb?(window.cancelAnimationFrame(this.ZDb),this.ZDb=-1,!0):!1}jXf(){this.oNe(this.iEg);this.ZDb=-1}}Object(m.a)(Rx,"ShapeDragAdapter",null,[235]);class Cz extends Sys.EventArgs{constructor(a){super();
this.w4e=!1;this.w4e=a}}Object(m.a)(Cz,"RewriteViewElementsStateEventArgs",Sys.EventArgs,[]);class vK extends Rx{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd){super(lc,yc);this.Vfc=0;this.Sfc=this.Dp=this.XO=this.eEg=null;this.WHa=!1;if(!xd)throw Error.argumentNull("viewEventSourceNotifier");this.Eb=a;this.ia=b;this.M0=c;this.Uq=f;this.Xs=l;this.pD=y;this.jb=G;this.LB=R;this.wD=ja;this.Ga=za;this.zc=Va;this.$d=hb;this.Hkc=Cb;this.mq=ic;this.DA=ec;this.Wp=jc;this.ugd=xd;this.Aad=
Xd}Mv(a){return this.rJ(a).returnValue}rJ(a){let b;var c=[];b=!1;if(!a||a.OA!==Sys.UI.MouseButton.leftButton||this.pD.t0)return{returnValue:!1,gmc:c,rdc:b};const f=Object(sa.a)(425,this.wD.eJ(a.Bc));if(!f||!f.Hoe(a.Bc))return{returnValue:!1,gmc:c,rdc:b};if((b=f.isSelected)||f.shapeNode.Ug){c=[];a=Object(sa.a)(117,this.wD.eJ(a.Bc));a.shapeNode.Of&&this.jb.DUf(a.shapeNode);a=this.jb.Qf();for(const l of a)if(l.get_smartArtModelId()){c.push(this.Ga.Lr(l));break}else c.push(l);c=vg.d(c,this.Eb.Na);for(const l of c)if(!this.Vpg(l))return{returnValue:!1,
gmc:c,rdc:b}}else{if(!this.Vpg(f))return{returnValue:!1,gmc:c,rdc:b};Array.add(c,f)}return{returnValue:!0,gmc:c,rdc:b}}Vpg(a){return a&&a.gb&&a.gb.tJ&&a.gb.HB&&!a.shapeNode.pJ&&32===this.ia.Ja(ea.a.cUe,1,a.gb)?!0:!1}tah(a){var b;let c;if(!({gmc:b,rdc:c}=this.rJ(a)).returnValue)return!1;this.ia.processAction(ea.a.N8a,2);this.eEg=cd.a.GTa(a.clientPoint);this.Sfc=Object(sa.a)(425,this.wD.eJ(a.Bc));null!==this.M0&&this.M0.Bl(3);if(!this.Sfc||!b||!b.length)return!1;this.Aad&&this.ugd.oVe(new Cz(!1));null!==
this.mq&&this.mq.bza(Ui.a.Bza);this.Sfc.shapeNode.Lv||(this.jb.nj(),this.LB.Bd());for(a=0;a<b.length;++a)this.sJc(b[a]);c||(this.jb.setSelection(Vd.SelectionFactory.rl(this.Dp[0].gb)),this.Xs.Dw());for(b=0;b<this.Dp.length;++b)this.Dp[b].jE(!0);this.WHa=1<this.Dp.length?!1:!0;this.Vfc=Date.now();this.DA&&this.jb.dM()&&this.$d.kVe();this.Wp&&this.ia.processAction(C.a.Eka,2);return!0}sJc(a){this.Dp||(this.Dp=[]);this.XO||(this.XO=[]);Array.add(this.Dp,a);Array.add(this.XO,new cd.a(a.x,a.y))}oNe(a){if(a){var b=
this.fXc(cd.a.GTa(a.clientPoint),this.eEg);a=null;var c=this.WHa&&!this.Sfc.shapeNode.Lv;for(let f=0;f<this.Dp.length;++f)a=cd.a.add(this.XO[f],b),this.Dp[f].setPosition(a.x,a.y,!c);b=this.Hkc.sdh(!1,this.WHa,this.Dp[0],null);c&&!b&&a&&this.Dp[0].setPosition(a.x,a.y,!0)}}fXc(a,b){a=cd.a.xV(a,b);return new cd.a(this.Uq.vm(a.x),this.Uq.vm(a.y))}qah(a){const b=[];for(var c=0;c<this.Dp.length;++c){var f=this.Dp[c].qVc();Array.add(b,new Ov(this.Dp[c].shapeNode,f));this.Dp[c].hA(!1);if(f=this.zc.eO(this.Dp[c].shapeNode))f=
f.Op(),ya.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.Sfc.shapeNode.Lv||(c={},a&&a.nc&&a.nc.rawEvent&&(c[Ii.a.lEa]=a.nc.rawEvent.timeStamp),this.ia.Ja(ea.a.BJa,2,b,c));1===b.length&&(ya.a.J(512497683,815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.Dp[0].shapeNode?this.Dp[0].shapeNode.Xm:"",(Date.now()-this.Vfc).toString()),this.DA&&this.jb.dM()&&(a=this.jb.cFa(),this.$d.Ujb(new Qx.a(a))));this.Aad&&this.ugd.oVe(new Cz(!0));this.W3()}oah(){if(this.Dp){for(let a=
0;a<this.Dp.length;++a)this.Dp[a].setPosition(this.XO[a].x,this.XO[a].y,!0),this.Dp[a].hA(!0);this.W3()}}W3(){this.Hkc.vdh(this.WHa);null!==this.M0&&this.M0.T1();this.Eb.rS();this.XO=this.Dp=null;null!==this.mq&&this.mq.Eya()}}Object(m.a)(vK,"ShapeMoveDragAdapter",Rx,[]);class rD{constructor(a){this.l8c=this.X0=this.u1=this.Uic=this.e1=null;this.Zd=a}qrl(a,b,c,f,l){this.e1=a;this.Uic=b;this.u1=c;this.X0=f;this.l8c=l}}Object(m.a)(rD,"ResizeShapesCalculationData",null,[]);var sD=d(636);class hl{static TYd(a,
b,c,f,l){return f?hl.pJf(a,c):hl.Wyi(a,b,c,l)}static pJf(a,b){const c=new Gi.a;if(a.equals(rd.a.Zu)||a.yBb(rd.a.Zu))c.left=b.x,c.top=b.y;else if(a.equals(rd.a.jF)||a.yBb(rd.a.jF))c.right=b.x,c.bottom=b.y;return c}static Wyi(a,b,c,f){b=a.hbc()?hl.Myi(a,b,c,f):hl.Yyi(a,b,c);c=new Gi.a;if(a.yBb(rd.a.north)||a.equals(rd.a.north))c.top=-1*b.y;if(a.yBb(rd.a.east)||a.equals(rd.a.east))c.right=b.x;if(a.yBb(rd.a.south)||a.equals(rd.a.south))c.bottom=b.y;if(a.yBb(rd.a.west)||a.equals(rd.a.west))c.left=-1*b.x;
return c}static Myi(a,b,c,f){var l=b.Wj(a),y=b.Wj(a.t$a()),G=b.Wj(a.S9i());a=b.Wj(a.T9i());var R=new cd.a(l._x+c.x,l._y+c.y);const ja=sD.b(y,G,R);b=sD.b(y,a,R);c=hl.TZd(y,G,ja);l=hl.TZd(y,a,b);b=cd.a.Ql(b,R);R=cd.a.Ql(ja,R);G=cd.a.Ql(y,G);y=cd.a.Ql(y,a);f?(y||(ya.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),y=1),G||(ya.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),G=1),f=G/y,!R||b/R>f?(b<hl.E3&&(b=hl.E3),R=b/f,R<hl.E3&&(R=hl.E3,b=R*f)):(R<hl.E3&&(R=hl.E3),b=R*f,b<hl.E3&&(b=hl.E3,
R=b/f))):(b<hl.E3&&(b=hl.E3),R<hl.E3&&(R=hl.E3));return new cd.a(b*c-G,R*l-y)}static Yyi(a,b,c){var f=a.hXc();a=a.Hyb();f=b.Wj(f);var l=b.Wj(a);b=b.Wj(a.t$a());a=cd.a.sab(f,l);a.NM(c.x,c.y);c=sD.b(b,f,a);a=cd.a.Ql(b,c);l=cd.a.Ql(f,b);a<hl.E3&&(a=hl.E3);f=a*hl.TZd(b,f,c)-l;return new cd.a(f,f)}static TZd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}hl.E3=6;Object(m.a)(hl,"ResizeHelper",null,[]);class it extends Rx{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,
Cb,lc,ic,yc,ec,jc){super(Va,lc);this.oma=this.b1=this.bIa=this.vve=this.wve=this.Zd=this.qG=null;this.WHa=!1;this.FR=this.qR=null;if(!ec)throw Error.argumentNull("viewEventSourceNotifier");this.Eb=a;this.ia=b;this.pD=c;this.hZa=f;this.LB=l;this.wD=y;this.oi=G;this.$d=R;this.Ga=ja;this.Hkc=za;this.DA=ic;this.mq=hb;this.af=Cb;this.Wp=yc;this.ugd=ec;this.Aad=jc}Mv(a){if(!a||a.OA===Sys.UI.MouseButton.rightButton)return!1;this.FR=[];this.Zd=Object(sa.a)(117,this.wD.eJ(a.Bc));if(!this.Zd||!this.Zd.ZC(a.Bc))return!1;
a=this.Zd.shapeNode;if(!a||!a.isResizable||this.pD.t0)return!1;this.qG=[];if(a.wz)Array.add(this.qG,this.Zd);else{var b=this.hZa.Ud();(b=this.Ga.cab(b))&&this.hZa.Cqd(b);a.Of&&this.hZa.DUf(a);b=this.hZa.Qf();this.qG=vg.d(b,this.Eb.Na)}if(this.Ga.K4(this.Zd.shapeNode))Array.add(this.FR,new rD(this.Zd));else for(const c of this.qG){if(!this.V6j(c))return this.FR=null,!1;c.shapeNode.isResizable&&!c.shapeNode.xd&&Array.add(this.FR,new rD(c))}return!0}V6j(a){return 32!==this.ia.Ja(ea.a.cUe,1,a.gb)||this.pD.t0||
!a.TQ?!1:!0}tah(a){if(!a||!this.Mv(a))return!1;this.hZa.nj();this.LB.Bd();this.ia.processAction(ea.a.N8a,2);this.oma=this.Zd.E7b();if(!this.Zd.ZC(a.Bc))return!1;null!==this.mq&&this.mq.bza(Ui.a.GPb);this.qR=this.Lbg(this.Zd.ZC(a.Bc),this.Zd,this.oma,!1);this.Aad&&this.ugd.oVe(new Cz(!1));this.bIa=this.Msa(a.clientPoint);({width:this.wve,height:this.vve}=this.zJf(this.oma,this.Zd.shapeNode.v0));this.b1=new cd.a(0,0);for(const c of this.FR){var b=c.Zd.E7b();a=c.Zd;let f,l;({width:f,height:l}=this.zJf(b,
this.Zd.shapeNode.v0));const y=this.Lbg(this.qR,a,b,!0);c.qrl(b,a.k_a,f,l,y);a.aM=!0;a.jE(!0);b=vg.c(a.shapeNode,this.Eb.Na);a.shapeNode.Of&&b.Dk&&(b.Dk.visible=!0)}this.WHa=this.Ga.K4(this.Zd.shapeNode)?!0:1<this.qG.length?!1:!0;this.DA&&this.hZa.dM()&&this.$d.kVe();this.Wp&&this.ia.processAction(C.a.Eka,2);return!0}oNe(a){if(a){var b=this.Msa(a.clientPoint),c=cd.a.xV(b,this.bIa);this.b1=cd.a.add(this.b1,this.Mbg(c,this.oma,!1));var f=null;c=this.WHa&&!this.Zd.shapeNode.Lv;for(const l of this.FR){let y=
new cd.a(l.u1/this.wve*this.b1.x,l.X0/this.vve*this.b1.y);new Gi.a;if(l.Zd.shapeNode.wz){this.Zd.shapeNode.wz&&(y=this.b1);if(!l.l8c)continue;f=hl.pJf(l.l8c,y)}else f=hl.TYd(l.l8c,l.e1,this.Mbg(y,l.e1,!0),l.Zd.shapeNode.wz,l.Zd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Gi.a.add(l.Uic,this.o3f(f,l.e1));l.Zd.setOffsets(f,!c);l.Zd.shapeNode.Of&&l.Zd.shapeNode.isEditable&&l.Zd.Nhe()}this.bIa=b;a=this.Hkc.sdh(!0,this.WHa,this.Zd,this.qR);c&&!a&&f&&this.Zd.setOffsets(f,!0)}}o3f(a,b){if(this.Ga.K4(this.Zd.shapeNode))return a;
const c=new Gi.a;c.left=b.j2c?a.right:a.left;c.right=b.j2c?a.left:a.right;c.top=b.scb?a.bottom:a.top;c.bottom=b.scb?a.top:a.bottom;return c}qah(a){const b=[];for(var c=0;c<this.FR.length;c++){let f=Gi.a.xV(this.FR[c].Zd.k_a,this.FR[c].Uic);f=this.o3f(f,this.FR[c].e1);Array.add(b,new Az(this.FR[c].Zd.shapeNode,f,this.qR,this.b1));this.FR[c].Zd.shapeNode.Of&&this.FR[c].Zd.shapeNode.isEditable||(this.FR[c].Zd.aM=!1);this.FR[c].Zd.hA(!1)}this.Zd.shapeNode.Lv?Sc.App.Mb.updateCommandUI():(c={},a&&a.nc&&
a.nc.rawEvent&&(c[Ii.a.lEa]=a.nc.rawEvent.timeStamp),this.Ga.K4(this.Zd.shapeNode)?(this.Zd.iEa(),this.ia.Ja(ea.a.Zth,2,b,c)):this.ia.Ja(ea.a.Ckb,2,b,c));this.DA&&this.hZa.dM()&&(a=this.hZa.cFa(),this.$d.Ujb(new Qx.a(a)));this.qL()}oah(){if(this.FR){for(const a of this.FR)a.Zd.setOffsets(a.Uic,!0),a.Zd.aM=!1,a.Zd.hA(!0);this.qL()}}qL(){this.Hkc.vdh(this.WHa);this.oma=this.vve=this.wve=this.Zd=this.qG=this.FR=this.qR=this.b1=this.bIa=null;null!==this.mq&&this.mq.Eya()}zJf(a,b){let c;var f=b?this.$$d(a):
a;c=cd.a.Ql(f.ga(0),f.ga(1));f=cd.a.Ql(f.ga(0),f.ga(3));b||(a=Oe.a.bN(cd.a.LF(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(ya.a.J(508851873,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Zd.shapeNode.Xm),c=1),f||(ya.a.J(508851872,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Zd.shapeNode.Xm),f=1));return{width:c,height:f}}Lbg(a,b,c,f){if(b.shapeNode.wz){if(this.Zd.shapeNode.wz)return a;if(a.equals(rd.a.TE)||a.equals(rd.a.iI))return null;if(a.equals(rd.a.Zu)||
a.equals(rd.a.jF))return c.ga(0).x>c.ga(1).x?a.t$a():a;if(b.shapeNode.v0){f=Oe.a.bN(cd.a.LF(c.ga(0),c.ga(1)));if(a.equals(rd.a.north)||a.equals(rd.a.south))return Math.abs(f-90)<it.zic||Math.abs(f-270)<it.zic?c.ga(0).y<c.ga(1).y?a:a.t$a():null;if(a.equals(rd.a.east)||a.equals(rd.a.west))if(Math.abs(f-180)<it.zic||360-f<it.zic||f<it.zic)return c.ga(0).x<c.ga(1).x?a:a.t$a()}return null}c=cd.a.LF(c.ga(0),c.ga(1));c=Math.floor((c+Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.hXc().hXc():a.Hyb().Hyb();
return a}Mbg(a,b,c){if(this.Zd.shapeNode.wz||this.Ga.K4(this.Zd.shapeNode))return a;var f=cd.a.LF(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=cd.a.LF(f,b);return c?new cd.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new cd.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}Msa(a){var b=this.Zd.I3(this.oi.vm(a.x)),c=this.Zd.I3(this.oi.vm(a.y));if(this.Ga.K4(this.Zd.shapeNode)){c=this.qR;this.qR.hbc()||(c=c.Hyb());
b=this.af.mi(this.Zd.kRa);b.x+=Pd.a.tud;b.y+=Pd.a.tud;b.width-=2*Pd.a.tud;b.height-=2*Pd.a.tud;var f=Ce.a.Pda(b);b=f.Wj(c);f=f.Wj(c.t$a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Zd.I3(this.oi.vm(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Zd.I3(this.oi.vm(c))}return new cd.a(b,c)}$$d(a){const b=cd.a.sab(a.ga(0),a.ga(3));a=cd.a.sab(a.ga(1),a.ga(2));return new Ce.a(new cd.a(b.x,b.y),new cd.a(a.x,b.y),new cd.a(a.x,a.y),new cd.a(b.x,a.y))}}it.zic=3;Object(m.a)(it,"ShapeResizeDragAdapter",
Rx,[]);var wK=d(197);class Dz{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.HDe=this.hFe=null;this.Tic=0;this.PGe=this.qkc=null;this.f8c=0;this.APg=8;this.SYg=4;this.tik="AngleUIRendered";this.HE=this.Zd=null;this.Eb=a;this.ia=b;this.pD=f;this.M0=c;this.pa=l;this.LB=y;this.wD=G;this.oi=R;this.lc=ja;this.le=za;this.mq=Va;this.Wp=hb;this.FHa=Cb}Mv(a){if(!a||a.OA!==Sys.UI.MouseButton.leftButton||this.pD.t0)return!1;this.Zd=Object(sa.a)(117,this.wD.eJ(a.Bc));return this.Zd&&this.Zd.Vqe(a.Bc)?(this.HE=
this.Zd.shapeNode)&&this.HE.bM&&this.Zd.TQ?!0:!1:!1}av(a){if(!a||!this.Mv(a))return!1;this.pa.nj();this.LB.Bd();this.ia.processAction(ea.a.N8a,2);null!==this.mq&&this.mq.bza(k.a.WN(this.le.qk("rotatehandlecursor.cur"),Ui.a.iIh));this.Tic=this.HE.get_shapeRotation();this.qkc=this.Zd.E7b().Zf();this.PGe=this.Zd.Yxb().Zf();this.hFe=this.Msa(a.clientPoint);this.Zd.Sla=!0;this.FHa&&this.r1e(!0);this.Zd.jE(!0);this.Wp&&this.ia.processAction(C.a.Eka,2);return!0}Sw(a){if(!a)return!1;this.HDe=this.Msa(a.clientPoint);
if(!this.HDe)return!1;this.f8c=Oe.a.bN(cd.a.LF(this.HDe,this.qkc))-Oe.a.bN(cd.a.LF(this.hFe,this.qkc));let b=this.Tic+this.f8c;this.FHa&&(b=this.DGh(b));this.Zd.setRotation(Math.round(b),this.PGe);this.FHa&&(a=this.Msa(a.clientPoint,!1),this.JUl(a,Math.round(b)));return!0}DGh(a){return this.usi(a)?10*Math.round(a/10):a}usi(a){0>a&&(a=(a+360)%360);return(a+this.SYg/2)%90<=this.SYg?!0:!1}JUl(a,b){var c=this.lc.jg(this.Zd.gb);c=vg.e(c,this.Eb.Na);c.Gsc.lC(2);c.Gsc.setPosition(a.x+this.APg,a.y+this.APg);
c.Gsc.xa.style.position="absolute";0>b&&(b+=360);c.Gsc.xa.innerText=(b%360).toString()+"\u00b0"}r1e(a){const b=this.lc.jg(this.Zd.gb);vg.e(b,this.Eb.Na).Gsc.Sd(a)}vo(a){this.FHa&&this.r1e(!1);this.Zd.Sla=!1;this.Zd.hA(!1);var b=this.Tic+this.f8c;this.FHa&&(b=this.DGh(b));b=new tp(this.HE,Math.round(b));const c={};a&&a.nc&&a.nc.rawEvent&&(c[Ii.a.lEa]=a.nc.rawEvent.timeStamp);this.FHa&&(c[this.tik]=1);this.ia.Ja(ea.a.Bsc,2,b,c);this.W3()}Fu(){this.qkc&&(this.Zd.setRotation(this.Tic,this.PGe),this.FHa&&
this.r1e(!1),this.Zd.Sla=!1,this.Zd.hA(!0),this.W3())}Msa(a,b=!0){var c=this.lc.jg(this.Zd.gb);return(c=vg.e(c,this.Eb.Na).WA)?(a=cd.a.GTa(wK.a.ZTa(a,c)),b?new cd.a(this.Zd.I3(this.oi.vm(a.x)),this.Zd.I3(this.oi.vm(a.y))):a):null}W3(){null!==this.M0&&this.M0.T1();null!==this.mq&&this.mq.Eya();this.Eb.rS();this.hFe=null;this.Tic=0;this.qkc=null;this.f8c=0;this.Zd=this.HE=null}static getInstance(a){return Dz.VC(a)}static VC(a){return new Dz(a,Fb.a.instance.resolve("Common.IActionManagerExtended"),Fb.a.instance.resolve("Common.ICursorPinningTool"),
Fb.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),Fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Fb.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),Fb.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),Fb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Fb.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Fb.a.instance.resolve("PowerPoint.IPathManager"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?
Fb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").MRe)}}Object(m.a)(Dz,"ShapeRotateDragAdapter",null,[235]);var Sx=d(387);class xK{constructor(a,b,c,f,l){this.Ym=this.Wr=null;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");
if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Kc=b;this.Eb=c;this.bYa=f}r2i(){if(this.Wr)return this.Wr;this.Wr=new dm.a;this.Wr.Fr("MarqueeDiv");this.Wr.ek(0);this.Wr.xa.style.borderStyle="solid";this.Wr.xa.style.borderWidth="thin";this.Wr.xa.style.borderColor="black";this.Wr.xa.style.opacity="0.5";this.Wr.Sd(!1);return this.Wr}cOh(a,b){this.Wr&&this.Wr.ah(a,b)}bOh(a,b){this.Wr&&this.Wr.setPosition(a,
b)}qL(){this.Ym=null;this.Wr&&(this.Wr.Sd(!1),this.Wr.Eq())}QWd(a){const b=this.Kc.Hc;if(!b||!b.ye||!b.ye.xa)return ya.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),!1;b.ye.xa.appendChild(a.xa);a.lC(2+Sx.a.Bha);a.Sd(!0);return!0}Mv(a){try{return a?a.OA===Sys.UI.MouseButton.rightButton?!1:1===this.bYa.Nmg?!0:!1:(ya.a.J(512497681,822,10,"Event argument is null in isDragPossible"),!1)}catch(b){throw ya.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",
b),b;}}av(a){try{if(!a)return ya.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.Mv(a))return!1;this.Ym=ks.a(a.clientPoint,this.Kc.Hc);const b=this.r2i();if(!this.QWd(b))return!1;this.bOh(this.Ym.x,this.Ym.y);this.cOh(0,0);return!0}catch(b){throw ya.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}Sw(a){try{if(!a)return ya.a.J(512497677,822,10,"Event argument is null in OnDragMove"),!1;if(!this.Eb.isActive)return!1;const b=ks.a(a.clientPoint,this.Kc.Hc),
c=Math.min(this.Ym.x,b.x),f=Math.min(this.Ym.y,b.y),l=Math.max(this.Ym.x,b.x),y=Math.max(this.Ym.y,b.y);this.bOh(c,f);this.cOh(l-c,y-f);return!0}catch(b){throw ya.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",b),b;}}vo(a){try{if(a)if(this.Ym){var b=ks.a(a.clientPoint,this.Kc.Hc),c=ks.b(Math.min(this.Ym.y,b.y),Math.max(this.Ym.y,b.y),Math.min(this.Ym.x,b.x),Math.max(this.Ym.x,b.x));this.ia.Ja(ea.a.D0c,2,c);qd.a("TelemetryForClickAndDragOperation")&&ya.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");
this.qL()}else ya.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else ya.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw ya.a.J(512497672,822,10,"Exception {0} occured in OnDragEnd",f),f;}}Fu(){this.qL()}dispose(){this.qL();this.Wr=null}}Object(m.a)(xK,"TextboxDrawDragAdapter",null,[235,108]);class jt{constructor(a,b,c){this.qcd=0;this.XO=null;this.gec=!1;this.$Ee=this.v8c=null;this.bGb=new cd.a(0,0);this.Ana=1;this.lj=a;this.Kc=b;this.Nkk=c;
this.Nkk.eT(Object(H.a)(this,this.B_a,"onSlideNavigation"))}Fub(a){return a?!0:!1}B_a(){this.Ana=1;this.bGb=new cd.a(0,0);this.setTransform(new cd.a(0,0))}xBb(a){if(!a)return!1;a=this.Oeg(a.nc);return!!a&&1<a.length}VOe(a){if(!a)return!1;this.qcd=this.lj.kV;if(!this.xBb(a))return!1;this.XO=this.CXc(a.nc);return!1}Xnc(a){if(!a)return!1;this.xBb(a)?(a=this.CXc(a.nc),this.XO||(this.XO=a),this.XAd(this.lzi(this.XO,a))):this.aNk(a);return!0}aNk(a){a&&(a=this.CXc(a.nc),this.gec?(a=this.iJf(this.v8c,a),
this.setTransform(a)):(this.gec=!0,this.v8c=a))}vo(a){if(this.gec&&a){a=this.CXc(a.nc);var b=this.iJf(this.v8c,a);a=b.x+this.bGb.x;b=b.y+this.bGb.y;this.gec=!1;this.bGb=new cd.a(a,b)}}iJf(a,b){return!a||1>a.length||!b||1>b.length?new cd.a(0,0):new cd.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Kc&&this.Kc.Hc&&this.Kc.Hc.$U){var b=this.Kc.Hc.$U;this.$Ee||(this.$Ee=b.style.cssText);b.style.cssText=this.$Ee+"  width:100%;height:100%; transform:translate("+(a.x+this.bGb.x+"px,"+(a.y+this.bGb.y)+
"px) scale("+this.Ana+","+this.Ana+")")}}zsl(){this.setTransform(new cd.a(0,0))}AJb(a){if(!a)return!1;this.vo(a);this.YLl();return!1}XAd(a){this.qcd&&(a*=this.qcd,a<jt.p6g?a=jt.p6g:a>jt.N5g&&(a=jt.N5g),this.lj.Fla=!1,this.Ana=this.lj.kV=a,this.zsl())}hJf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}lzi(a,b){a=this.hJf(a);b=this.hJf(b);return-1!==a&&-1!==b&&a?b/a:0}Oeg(a){let b=null;if(!a)return null;a=a.rawEvent?a.rawEvent:
a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}CXc(a){let b=null;a=this.Oeg(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new cd.a(c.screenX,c.screenY));return b}YLl(){this.qcd=0;this.XO=null;this.gec=!1;this.v8c=null}}jt.p6g=1;jt.N5g=5;Object(m.a)(jt,"ZoomSettingTouchAdapter",null,[894]);var tR=d(430);class yK{constructor(a,b,c,f,l,y,G){this.pEe=!1;this.Ym=null;this.gDe=!1;this.Eb=a;this.$J=b;this.jb=c;this.Kc=f;this.Fa=l;this.ua=y;this.fEg=G;this.Wr=
new dm.a;this.Wr.Fr("Marquee");this.Wr.ek(0);this.Wr.xa.style.backgroundColor="darkgrey";this.Wr.xa.style.opacity="0.5";this.Wr.Sd(!1)}QWd(){this.Wr&&(this.Kc.Hc.ye.xa.appendChild(this.Wr.xa),this.pEe=!0)}qL(){this.Ym=null;this.Wr&&(this.Wr.Sd(!1),this.Wr.Eq(),this.pEe=!1);this.gDe=!1}Mv(a){if(!a||this.fEg.instance&&this.fEg.instance.isDisabled()||a.OA===Sys.UI.MouseButton.rightButton)return!1;a=new tR.a(a,this.Eb);return this.Eb.Ncc(a)}av(a){if(!a||!this.Eb.isActive||!this.Mv(a))return!1;this.$J.rnh(new Yo(!0));
a.ctrlKey||a.shiftKey?ya.a.J(508895445,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.jb.nh();this.Fa.Bd();this.gDe=a.shiftKey?!0:!1;this.Ym=this.Msa(a.clientPoint);this.pEe||this.QWd();this.Wr.setPosition(this.Ym.x,this.Ym.y);this.Wr.ah(0,0);this.Wr.lC(1+Sx.a.Bha);this.Wr.Sd(!0);return!0}Sw(a){if(!a||!this.Eb.isActive)return!1;var b=this.Msa(a.clientPoint);a=Math.min(this.Ym.x,b.x);const c=Math.min(this.Ym.y,b.y),f=Math.max(this.Ym.x,b.x);b=Math.max(this.Ym.y,
b.y);this.Wr.setPosition(a,c);this.Wr.ah(f-a,b-c);return!0}vo(a){if(a){var b=this.Msa(a.clientPoint);a=Math.min(this.Ym.x,b.x);var c=Math.min(this.Ym.y,b.y),f=Math.max(this.Ym.x,b.x);b=Math.max(this.Ym.y,b.y);var l=this.ua.Ba,y=l?l.yj():[];l=[];var G=[],R=this.jb.Ud();for(const ja of y)(y=Object(sa.a)(117,ja.qc(this.Eb.Na)))&&y.TQ&&(y.iq?y.yvd():(y=y.Jfe(!1),y.kc>=a&&y.mc>=c&&y.hc<=f&&y.Zb<=b&&(this.gDe?Array.contains(R,ja)?G.push(ja):l.push(ja):Array.contains(R,ja)||l.push(ja))));0<l.length&&this.jb.j1a(l,
!1);0<G.length&&this.jb.eka(G);this.qL()}}Fu(){this.Ym&&this.qL()}Msa(a){const b=this.Kc.Hc.WA;return b?cd.a.GTa(wK.a.ZTa(a,b)):cd.a.GTa(a)}dispose(){this.Ym&&this.qL();this.Wr=null}}Object(m.a)(yK,"MarqueeSelectDragAdapter",null,[235,108]);class zK{constructor(a){this.TX=null;this.Bui(a);this.ghe=!1}Bui(a){null!==a&&(this.TX=k.a.ee(),this.TX.style.position=Ui.a.absolute,this.TX.style.top="0px",this.TX.style.left="0px",a.appendChild(this.TX))}bza(a){null!==a&&null!==this.TX&&null!==this.TX.parentNode&&
(this.TX.style.cursor=a,this.TX.style.zIndex=String(Ui.a.A_l),this.TX.style.height="100%",this.TX.style.width="100%",this.ghe=!0)}Eya(){if(null!==this.TX||this.ghe)this.TX.style.height="0px",this.TX.style.width="0px",this.TX.style.cursor=Ui.a.iIh,this.TX.style.zIndex="-1",this.ghe=!1}}Object(m.a)(zK,"CursorContainerManager",null,[397]);class tD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Xb(a){this.K=a;a.register(397,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").na().oa(()=>
new zK(a.resolve("PowerPointWebEditor.AppFrame").E2));a.register(pD,"PowerPointWebEditor.ShapeManipulationActor").na().oa(()=>new pD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new Pp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").nZe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(qD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").na().oa(()=>new qD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),ra.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(398,"PowerPointWebEditor.IPptTableDragSelectionHelper").na().oa(()=>new tK(a.resolve("Box4.IPageView").Na,a.resolve("Box4.IPageView").Nd,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.eQj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.ZQj();this.RPj()}ZQj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").z7k(new jt(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}eQj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),y=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),G=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),R=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja=this.K.resolve("PowerPointWebEditor.ISlideReader"),
za=this.K.resolve("PowerPointWebEditor.IShapeReader"),Va=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),hb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Cb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),lc=this.K.resolve("PowerPoint.IPathManager"),ic=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,yc=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").fMb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").fMb(1,new vK(a,b,l,R,this.K.resolve("Box4.IUndoManager"),c,f,y,G,za,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Va,hb,Cb,ic,yc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").fZe),new it(a,b,c,f,y,G,R,Va,za,hb,Cb,ic,this.K.resolve("PowerPoint.IBrowserHelperManager"),yc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").fZe),
new Dz(a,b,l,c,f,y,G,R,ja,lc,ic,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").MRe),new yK(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.Ia("PowerPointWebEditor.WetInkView")));c=
new uK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").hph(c);this.K.resolve("PowerPointWebEditor.IApplicationSettings").AAb&&(a=new xK(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").hph(a));ya.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}RPj(){const a=this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.me();a.vb()}dispose(){}static main(){n.a.instance.Ac(new tD)}}Object(m.a)(tD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var uR=
d(1199),Tx=d(1258),sr=d(116);class Ux{constructor(a,b,c,f,l,y,G,R){this.PDe=null;this.DDe=new Date;this.gR=a;this.Cpk=b;this.cwk=c;this.fjk=f;this.mpk=l;this.pIa=y;G.Hb(new pd.a(R,2,this.fjk,Object(H.a)(this,this.DLf,"checkTask"),90,"61"))}DLf(){this.iPl()}iPl(){var a=new Date;const b=+new Date-+this.PDe>this.cwk;if(!(this.DDe<this.PDe)||b){if(+a-+this.DDe<this.Cpk)return;this.gR()}a=+new Date-+a;a>this.mpk&&ya.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",
a,this.pIa)}ixd(){this.PDe=new Date}exd(){this.DDe=new Date}}Object(m.a)(Ux,"PrefetchThrottler",null,[]);class iq{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec){this.Nrd=250;this.Wgc=this.pfc=null;this.zhc=this.ihc=!1;this.MGb=[];this.wxi=5;this.EIf=10;this.NGb=[];this.xxi=5;this.OYa=!1;this.N3g=this.EJ=this.G6c=null;this.Oad=!1;this.ZFe=[];this.Ub=a;this.ua=b;this.NB=c;this.uj=f;this.pXa=l;this.Dz=ec;this.Rfa=y;this.Da=G;this.wb=R;this.lc=ja;this.Qv=za;this.JM=Va;this.od=hb;this.wuk=Cb;
this.Mc=lc;this.Kk=ic;this.By=yc;this.luk=this.Da.Z4j;this.qsk=w.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.psk=w.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");!z.a.Yi||this.Da.$4j?this.setEnabled(this.Da.DYj,this.Da.b1j):this.setEnabled(!1,!1);this.cdd=this.Da.prefetchSlideForwardMax;this.bdd=this.Da.prefetchSlideBackwardMax;this.mkk=w.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.Wil=w.AFrameworkApplication.fa.uc("SlidePrefetchLookaheadCount",
0);this.OH=!1;this.Mc.GC(Object(H.a)(this,this.TM,"onSessionClosed"));this.Mc.C7a(Object(H.a)(this,this.lga,"onSessionRehydrating"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));w.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&(this.Nrd=125);this.By&&this.By.MFa(()=>{this.IFl()})}IFl(){this.N3g=new pd.a(2,1,this.Nrd,Object(H.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.Oad=!1;const a=this.qsk?2:3;this.pfc=new Ux(Object(H.a)(this,
this.gPl,"tryPrefetchContentModel"),this.Nrd,iq.Xil,iq.ewh,iq.Zvh,"content model",this.wb,a);this.od.atb(Object(H.a)(this,this.F_a,"onVisibleThumbnailsChanged"));this.Kk.LI(Object(H.a)(this,this.aC,"onActiveSlideChanged"));this.Wgc=new Ux(Object(H.a)(this,this.jPl,"tryPrefetchImages"),this.Nrd,iq.Vil,iq.ewh,iq.Zvh,"image",this.wb,3);this.JM&&(this.JM.kja(Object(H.a)(this,this.Nxg,"loadedHandler")),this.JM.gk(Object(H.a)(this,this.tlh,"propertyChangedHandler")))}get Gf(){this.G6c&&this.G6c.isConnected||
(this.G6c=this.Ub.Gf);return this.G6c}get Ba(){this.EJ||(this.EJ=this.ua.Ba);return this.EJ}setEnabled(a,b){this.ihc=a;this.zhc=b}Wid(){this.MGb=[];this.NGb=[];this.OYa=!1}dispose(){this.od.Vrh(Object(H.a)(this,this.F_a,"onVisibleThumbnailsChanged"));this.Kk.E6(Object(H.a)(this,this.aC,"onActiveSlideChanged"));this.Mc.Qaa(Object(H.a)(this,this.TM,"onSessionClosed"));this.Mc.tXe(Object(H.a)(this,this.lga,"onSessionRehydrating"));this.Mc.Raa(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.JM&&
(this.JM.H0a(Object(H.a)(this,this.Nxg,"loadedHandler")),this.JM.Qm(Object(H.a)(this,this.tlh,"propertyChangedHandler")))}TM(){this.OH=!0}lga(){this.Wid()}Hn(){this.OH=!1}gPl(){this.ihc&&this.qDh()&&this.IWk()}IWk(){var a=this.Efe();const b=this.OYa?null:Wr.b(a,c=>c?c.Cb:null);(a=this.Zhh(0,a))?(a=a.Cb,this.pfc&&this.pfc.ixd(),this.Qv.prefetchSlide(a,b,(c,f)=>{this.OYa=!0;qd.a("InvalidateThumbAfterSlideFetch")&&(ya.a.J(508903936,813,50,"prefetchBestSlide: Successfully fetched slide:{0}, isSlideStale:{1}",
c,f),(f=this.Rfa.XF(c))?(f=f.getImageId(),this.NB.Mac(c,f)):ya.a.J(508903907,813,10,"prefetchBestSlide: ThumbnailViewElement null for prefetched slide : {0}",c))}),this.SZk(a)):this.OYa||this.Qv.prefetchSlide(nc.a.empty,b,()=>{this.OYa=!0})}aC(){this.EJ=null;this.OYa=!1}F_a(){this.ANl();this.OYa=!1}Nxg(a,b){(a=Object(sa.a)(116,b.node))&&a.rE&&this.enc(a)}tlh(a,b){a=b.property;b.node&&a===va.a.cid&&(this.OYa=!1)}enc(a){if(a.isConnected){var b=Object(sa.a)(116,a);b&&(b.nGa=!0,this.wb.Hb(new pd.a(2,
1,0,Object(H.a)(this.Wgc,this.Wgc.DLf,"checkTask"),90,"60")),w.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&(Array.clear(this.ZFe),this.ZTd(b.U2f),this.ZTd(b.dLh),this.ZTd(b.MOh),b=new pd.a(3,1,0,Object(H.a)(this,this.hPl,"tryPrefetchFonts"),90,"114"),b.customData=this.ZFe,this.wb.Hb(b)))}this.pfc&&(this.pfc.exd(),this.MGb=[]);a.Wza=!0;this.Rfa.J2a()}SZk(a){this.MGb.length>=this.EIf&&(this.MGb=[]);Array.add(this.MGb,a)}ZTd(a){if(!na.a.Xa(a)){a=a.split(",");for(const b of a)this.ZFe.push(b)}}Zhh(a,
b=null){const c=this.Ba;if(!c||!c.isConnected)return null;b||(b=this.Efe());return this.Dpj(c,a,b)}Dpj(a,b,c){for(const f of c)if(f)if(c=f.Cb,this.CLj(c))ya.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.Oxl(f,b)){const l=a.Cb;a=this.lc.U8b(a);const y=this.lc.U8b(f);ya.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",
c,y,y-a,l,a,b);return f}return null}CLj(a){let b=0;for(const c of this.MGb)a.equals(c)&&(b+=1);if(b>=this.wxi)return!0;b=0;for(const c of this.NGb)a.equals(c)&&(b+=1);return b>=this.xxi}Oxl(a,b){if(!a)return!1;const c=a.Cb;if(nc.a.Fw(c))return!1;const f=!!a&&a.rE;if(0===b)return!f;if(!f||!a.nGa)return!1;b=a.pVa(new sr.a(a.Xp,a.Xk));if(null===b)return ya.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.NB.W$b.usc(l).data)return!0;return a.nGa=
!1}jPl(){if(this.zhc&&this.qDh()){const b=this.Zhh(1);if(b){var a=b.Cb;this.Wgc.ixd();this.J6i(b);this.TZk(a)}}}hPl(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.Dz.RZi(b)}qDh(){return this.OH||!this.luk&&2===this.uj.sda||!this.Gf||this.pXa.I4(this.Gf)||!this.Ba||this.Ba.$L?!1:!0}TZk(a){this.NGb.length>=this.EIf&&(this.NGb=[]);Array.add(this.NGb,a)}J6i(a){if(a){var b=a.pVa(new sr.a(a.Xp,a.Xk));b&&0<b.length?this.NB.rxb(b,!0,()=>{this.Wgc.exd();this.NGb=[];a.nGa=!1},w.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):
a.nGa=!1}}ANl(){this.Oad||(this.wb.Hb(this.N3g),this.Oad=!0)}updateSlidePrefetchRange(){this.Oad=!1;this.Qv.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.Rfa.eqa,null)}kAj(){return Wr.b(this.Efe(),a=>a?a.Cb:null)}Efe(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.lc.U8b(a);var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.mkk)for(var y of this.Rfa.eqa.A4)y!==a&&y<c&&(Array.add(l,b[y]),f[y]=!0);if(this.psk&&
!f.length)for(y=1;y<=this.Wil;y++){const G=this.Rfa.eqa.lastIndex+y;G!==a&&G<c&&(Array.add(l,b[G]),f[G]=!0)}if(0<=a){a=this.wuk.bdg(a,b.length,this.cdd,this.bdd);for(const G of a)if(void 0===f[G]||null===f[G])f[G]=!0,Array.add(l,b[G])}return l}}iq.ewh=1E3;iq.Xil=2E3;iq.Vil=6E4;iq.Zvh=500;Object(m.a)(iq,"PrefetchManager",null,[396,108]);class uD{constructor(a,b,c,f){this.ei=b;this.KE=c;this.pa=f;this.Mc=a;this.Mc.CCa(Object(H.a)(this,this.Fib,"onSessionEnding"))}Fib(a,b){if(this.pa.uz()){a=this.pa.Ud();
if(!a.length){const c=this.pa.Dcg();c&&a.push(c)}for(const c of a)this.ei.I8a(c)}this.KE.$$i(b.iC)}dispose(){this.Mc.oqd(Object(H.a)(this,this.Fib,"onSessionEnding"))}}Object(m.a)(uD,"SessionCleanupHandler",null,[108]);var AK=d(380),vR=d(969);class vD{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.tJd=this.oDc=this.tHe=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Da=a;this.jkc=a.sessionTimeoutInMs;this.wb=b;this.BE=c;this.pa=f;this.MXa=l;this.lD=
y;this.Vd=G;this.ua=R;this.fc=ja;this.$m=za;this.d0g=Va;this.$o=hb;this.$Bg=Cb;this.ikc=0}get Tda(){return this.MXa.instance}get s0(){return w.AFrameworkApplication.Yg}get Ttg(){return 1===this.ikc}get aCb(){return this.oDc}get Y3c(){return this.tJd}get iC(){return this.ikc}set iC(a){this.ikc=a}get aKf(){return this.Da.podsSeamlessFailoverEnabled&&!!this.$o.instance}start(){if(!this.s0){var a=new pd.a(4,2,3E4,Object(H.a)(this,this.V4g,"manageLifetime$p"),90,"56");this.wb.Hb(a)}}Rxk(){this.V4g(null)}V4g(){if(!this.tHe){var a=
+new Date-+Kc.a.Adc;a>this.jkc&&this.p4i(a);w.AFrameworkApplication.zz&&w.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Da.wopiTokenRefreshMaxDurationInMs&&this.lD.E3k()}}p4i(a){this.s0||(this.cNf(2),this.aKf?this.$Bg.instance&&this.$Bg.instance.fbb&&(ya.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),Sf.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.d0g.jCl()):this.d0g.iCl(),this.lD.E2k(),ya.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.jkc,this.aKf,!!this.$o.instance,this.Da.podsSeamlessFailoverEnabled))}closeSession(a=1){this.cNf(a)}cNf(a){0===a&&ya.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.s0)try{this.oDc=!0,ya.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
AK.a[a]),this.ikc=a,this.pa.setSelection(null),w.AFrameworkApplication.Yg=!0,this.BE.wab().Cjd=!0,this.Vd.disabled=!0,zi.a.wx&&4!==a&&zi.a.wx.hide(),this.lD.WUe(new vR.a(a)),this.Tda&&0<this.Tda.rEa.count&&this.Tda.Arc(this.BE.tUa().presentationId,"instanceId",!0,!1),this.Da.podsSeamlessFailoverEnabled&&this.$o.instance&&(1===a?this.$o.instance.OSd("abortedOnExitApp"):this.$o.instance.OSd("SessionClose_"+a)),this.wb.stop(),this.$m.isPaused||this.$m.pause(),4!==a&&2!==a&&this.fc.blockContent(this.ua.presentation,
"CloseSession",!0),this.lD.hpd(new nm.a(a))}finally{this.tJd=this.oDc=!1}}QCl(){this.tHe=!0}lhl(){this.tHe=!1}markSessionClosingAtForceSave(a){ya.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",AK.a[a]);this.tJd=this.oDc=!0;this.ikc=a}}Object(m.a)(vD,"SessionLifetimeManager",null,[1100]);var Ag=d(432);class BK{constructor(){this.trigger=null;this.yba=this.tmb=this.p2a=0;this.v1d={}}}Object(m.a)(BK,"SuggestionsInfo",null,[]);class CK{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(m.a)(CK,"StartRtcConnectionRequest",null,[]);class DK{constructor(){this.SessionID=null}}Object(m.a)(DK,"StopRtcConnectionRequest",null,[]);var wR=d(283);class EK{constructor(a,b){this.slideId=a;this.imageId=wR.a.iPc(b)}}Object(m.a)(EK,"ThumbnailImageId",null,[]);var kt=d(293);const FK=a=>{let b,c,f;var l;let y,G;b=null;f=c=0;y=l=null;G=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&
8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new kt.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new nc.a(l),y=a[6],G=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,suggestionCount:c,yba:f,slideID:l,trigger:y,tmb:G}):{returnValue:!1,correlationID:b,suggestionCount:c,yba:f,slideID:l,trigger:y,tmb:G}},xR=a=>{const b=new Oa.a;try{const c=Nd.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){ya.a.J(42342594,
829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};var Ez;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(Ez||(Ez={}));Object(m.b)("CoauthorStatus",Ez);class GK extends Sys.EventArgs{constructor(a){super();this.mja=a}}Object(m.a)(GK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class HK extends Sys.EventArgs{constructor(a){super();this.rTc=a}}Object(m.a)(HK,"FileRevisionHistoryEventArgs",Sys.EventArgs,
[]);class IK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.cZc=a;this.fTc=b;this.o0j=c;this.confidence=f;this.imageDescription=l}}Object(m.a)(IK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class JK extends Sys.EventArgs{constructor(a){super();this.Qbc=a}}Object(m.a)(JK,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class KK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(KK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class LK extends Sys.EventArgs{constructor(a){super();
this.Z8d=a}}Object(m.a)(LK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class MK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(MK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class NK extends Sys.EventArgs{constructor(){super()}}Object(m.a)(NK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class wD extends Sys.EventArgs{constructor(a,b=null){super();this.dvk=a;this.Qkk=b}get gJh(){return this.dvk}get F4i(){return this.Qkk}}Object(m.a)(wD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,
[]);class OK extends Sys.EventArgs{constructor(a){super();this.tXk=a}}Object(m.a)(OK,"PresentationLastModifiedTimeReceivedEventArgs",Sys.EventArgs,[]);var yR=d(897);class PK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(m.a)(PK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class Fz extends Sys.EventArgs{constructor(a,b,c,f,l,y,G){super();this.Xie=!1;this.uvc=null;this.correlationId=a;this.p2a=b;this.yba=c;this.trigger=l;this.slideId=y;this.XDa=G;this.uMa=f}}Object(m.a)(Fz,
"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Vx extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=a;this.slideId=b;this.XDa=c}}Object(m.a)(Vx,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class QK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.qZ=c;this.shapeId=b;this.XDa=f}}Object(m.a)(QK,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class RK extends Sys.EventArgs{constructor(a,b,c,f,l,y){super();this.correlationId=a;this.Eea=
b;this.slideId=c;this.shapeId=f;this.lLa=l;this.XDa=y}}Object(m.a)(RK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class SK extends Sys.EventArgs{constructor(a){super();this.Uqe=!1;this.Uqe=a}}Object(m.a)(SK,"ToggleChatPPTPaneEventArgs",Sys.EventArgs,[]);class TK extends Sys.EventArgs{constructor(a){super();this.t4j=a}}Object(m.a)(TK,"PictureRenderSuccessEventArgs",Sys.EventArgs,[]);var zR=d(388);class xD{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff){this.aze=
this.Uye=!1;this.INg=null;this.lPg={};this.Rfa=b;this.wl=ff;this.Mq=l;this.J7c=y;this.Ub=R;this.ua=ja;this.Qv=za;this.$cd=Va;this.Vd=hb;this.lD=Cb;this.$d=lc;this.O7c=ic;this.Gt=yc;this.Ya=a;this.CR=ec;this.sGb=jc;this.Mc=xd;this.q8c=c;this.Da=Xd;this.su=Qd;this.wb=Ie;this.Uv=Pe;this.pc=ig;this.RKg=this.Da.yg&&this.Da.pptNoRtcConnectWhenReadOnlyEnabled;this.Mc.CCa(Object(H.a)(this,this.UE,"onSessionEnd"));this.Mc.GC(Object(H.a)(this,this.q9d,"flushOnSessionEnd"));this.q8c.bBf(Object(H.a)(this,this.ech,
"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.bBf(Object(H.a)(this,this.ech,"onNormalChannelDocNotifyClientItemsUpdated"));this.Da.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&this.Mc.qB(Object(H.a)(this,this.Daa,"onPodSessionRehydrated"));this.RKg&&this.Mc.Qca(Object(H.a)(this,this.Oy,"onUnifiedAppStateChanged"))}ech(a,b){this.TGk(b,this.J7c)}TGk(a,b){let c=!1;const f=[],l=[],y=new BK;for(const jc of a.items){const xd=new Date,Xd=this.su.$Fa;var G=void 0,R=void 0,ja=void 0,za=void 0,
Va=void 0,hb=void 0;if(jc.Key===Ag.a.Yjh)b.cce(Ag.a.Yjh)>jc.TimeStamp||(ya.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var Cb=void 0;Cb=null;(R=jc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&5===R.length?(Cb=new kt.a,Cb.Sid=Number.parseInvariant(R[3]),Cb.Cid=Number.parseInvariant(R[4]),Cb=new nc.a(Cb),R={returnValue:!0,slideId:Cb}):R={returnValue:!1,slideId:Cb};if(({slideId:R}=R).returnValue)R=Ag.a.mfe(R.sid,R.cid),b.cce(R)>=jc.TimeStamp||(R=
Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),Array.add(f,new yR.a(R,0<R.SnapshotTimeStamp?R.SnapshotTimeStamp:jc.TimeStamp)));else if(jc.Key.startsWith(Ag.a.SXf))R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),this.Mq.GQh(R),ya.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",R);else if(jc.Key===Ag.a.i0i)R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),ya.a.J(512497795,817,50,
"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",jc.LastRequestCorrelationID,jc.TimeStamp,R.length),this.Mq.VPh(R);else if(jc.Key===Ag.a.BFi)R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),ya.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",jc.LastRequestCorrelationID,jc.TimeStamp,Ez[R]),this.Mq.wxc(R);
else if(jc.Key===Ag.a.BKi)ya.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",jc.LastEditorID,jc.LastRequestCorrelationID,jc.TimeStamp,jc.Value,!1),this.lD.b1k(),this.Qv.SF(this.Ub.Di),this.Da.ccb&&Object(qd.a)("showChatPPTPane")&&this.$d.s3k(new SK(!1));else{if(Cb=jc.Key.startsWith(Ag.a.HUf)){a:{Cb=void 0;R=jc.Value;try{const Qd=R?R.split(","):[];
if(3!==Qd.length){Cb=nc.a.ax(0,0);ya.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",R);var lc={returnValue:!1,slideId:Cb};break a}const Ie=Number.parseInvariant(Qd[0]),Pe=Number.parseInvariant(Qd[1]),ig=Qd[2];Cb=nc.a.ax(Number.parseInvariant(Qd[0]),Number.parseInvariant(Qd[1]));ya.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",
Ie,Pe,ig)}catch(Qd){ya.a.J(23089481,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",R,Qd.toString());Cb=nc.a.ax(0,0);lc={returnValue:!1,slideId:Cb};break a}lc={returnValue:!0,slideId:Cb}}Cb=({slideId:R}=lc).returnValue}if(Cb)ya.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",jc.Value),this.$d.g1k(new PK(R));else{if(Cb=
jc.Key.startsWith(Ag.a.BIh)){{var ic=void 0;let Qd;R=null;G=0;ic=Qd=null;(Cb=jc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===Cb.length?(R=Cb[1],G=Number.parseInvariant(Cb[2]),ic=Object.assign(new kt.a,{Sid:Number.parseInvariant(Cb[3]),Cid:Number.parseInvariant(Cb[4])}),Qd=new nc.a(ic),ic=Cb[6],G={returnValue:!0,correlationID:R,suggestionCount:G,slideID:Qd,trigger:ic}):G={returnValue:!1,correlationID:R,suggestionCount:G,slideID:Qd,trigger:ic}}Cb=({correlationID:G,
suggestionCount:y.p2a,slideID:R,trigger:y.trigger}=G).returnValue}if(Cb)ya.a.J(512497792,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",G),R=new Fz(G,y.p2a,y.p2a,0,y.trigger,R,jc.Value),R.uvc=new Oa.a,this.USe(R);else if(this.Da.designerIncrementalRenderEnabled&&jc.Key.startsWith(Ag.a.Zie)&&({correlationID:G,suggestionCount:y.p2a,yba:y.yba,slideID:R,trigger:y.trigger,tmb:y.tmb}=FK(jc.Key)).returnValue)ya.a.J(512497763,
829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",G,y.tmb,y.p2a,y.yba),R=new Fz(G,y.p2a,y.yba,y.tmb,y.trigger,R,jc.Value),G in y.v1d||(y.v1d[G]=this.yxj(G,a.items)),R.uvc=y.v1d[G],R.Xie=!0,this.USe(R);else{if(Cb=jc.Key.startsWith(Ag.a.e3f))R=G=null,(Cb=jc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===Cb.length?
(G=Cb[1],R=Object.assign(new kt.a,{Sid:Number.parseInvariant(Cb[2]),Cid:Number.parseInvariant(Cb[3])}),R=new nc.a(R),G={returnValue:!0,correlationID:G,slideID:R}):G={returnValue:!1,correlationID:G,slideID:R},Cb=({correlationID:G,slideID:R}=G).returnValue;if(Cb)ya.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",G),this.USe(new Vx(G,R,jc.Value));else{if(Cb=jc.Key.startsWith(Ag.a.Ymg))hb=null,ja=0,Cb=null,G=R=0,
(za=jc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===za.length?(hb=za[1],ja=Number.parseInvariant(za[2]),G=Object.assign(new kt.a,{Sid:Number.parseInvariant(za[3]),Cid:Number.parseInvariant(za[4])}),Cb=new nc.a(G),R=Number.parseInvariant(za[5]),G=Number.parseInvariant(za[6]),ja={returnValue:!0,correlationID:hb,Eea:ja,slideID:Cb,shapeId:R,lLa:G}):ja={returnValue:!1,correlationID:hb,Eea:ja,slideID:Cb,shapeId:R,lLa:G},Cb=({correlationID:G,Eea:ja,slideID:R,shapeId:za,
lLa:hb}=ja).returnValue;if(Cb)ya.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",G),this.$d.v2k(new RK(G,ja,R,za,hb,jc.Value));else if(jc.Key===Ag.a.r_l)this.nKj();else if(jc.Key===Ag.a.f1f&&this.INg!==jc.Value)this.REj(jc);else if(jc.Key===Ag.a.hJh)!na.a.Xa(jc.Value)&&na.a.DBb(jc.Value)?(R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),ya.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",
R,this.Ya.Wk,this.Ya.podSessionId),240===R?this.CR.Aga(1):(432!==R||this.aze||this.oWf(),this.sGb.wnh(new wD(R)))):(R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),ya.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",R.Code,!!R.ExtraErrorParam,this.Ya.Wk,this.Ya.podSessionId),240===R.Code?this.CR.Aga(1):(432!==R.Code||this.aze||this.oWf(),this.sGb.wnh(new wD(R.Code,
R.ExtraErrorParam))));else if(jc.Key===Ag.a.Fwg)this.SFj(jc);else if(jc.Key===Ag.a.eNj)ya.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",this.Ya.Wk),this.CR.Aga(1);else if(jc.Key===Ag.a.uXk)R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),this.Ub.Gf.WRe=R,this.Gt.m2k(new OK(R));else if(jc.Key.startsWith(Ag.a.dOf)){ya.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",
jc.Key);a:{R=jc.Key;try{const Qd=R.match(RegExp("\\d+","g"));if(Qd&&0<Qd.length&&!(Qd.length%2)){Cb=[];for(ic=0;ic<Qd.length;ic+=2)Cb.push(Object.assign(new kt.a,{Sid:Number.parseInvariant(Qd[ic]),Cid:Number.parseInvariant(Qd[ic+1])}));var yc=Cb;break a}}catch(Qd){ya.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",R,Qd)}yc=null}(R=yc)&&0<R.length&&this.lD.X0k(new KK(R))}else if(jc.Key.startsWith(Ag.a.Tkg))this.pFj(jc);
else if(jc.Key===Ag.a.G1f)this.O7c.p1k(new HK(jc.Value));else{if(Cb=jc.Key.startsWith(Ag.a.ykg)){a:{Va=jc.Key;Cb=null;R=0;za="";try{const Qd=Va.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));if(Qd&&5===Qd.length){const Ie=Object.assign(new kt.a,{Sid:Number.parseInvariant(Qd[1]),Cid:Number.parseInvariant(Qd[2])});Cb=new nc.a(Ie);R=Number.parseInvariant(Qd[3]);za=Qd[4];var ec={returnValue:!0,slideID:Cb,shapeId:R,nodeId:za};break a}}catch(Qd){ya.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",
Va,Qd.toString())}ec={returnValue:!1,slideID:Cb,shapeId:R,nodeId:za}}Cb=({slideID:R,shapeId:za,nodeId:Va}=ec).returnValue}if(Cb)ya.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.$d.B1k(new QK(R,za,Va,jc.Value));else if(jc.Key===Ag.a.s8i)this.sGb.q1k(new LK(jc.Value));else{if(Cb=jc.Key.startsWith(Ag.a.iLh))Cb=null,(R=jc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===R.length?(Cb=new kt.a,Cb.Sid=Number.parseInvariant(R[1]),
Cb.Cid=Number.parseInvariant(R[2]),Cb=new nc.a(Cb),R={returnValue:!0,slideId:Cb}):R={returnValue:!1,slideId:Cb},Cb=({slideId:R}=R).returnValue;if(Cb)R=new EK(R,jc.Value),R.imageId&&l.push(R);else if(jc.Key===Ag.a.qZi)this.Uv.S$e(parseInt(jc.Value));else if(jc.Key===Ag.a.ZDf)this.O7c.N0k(new GK(jc.Value));else if(jc.Key===Ag.a.Nrg)this.O7c.J1k(new JK("true"===jc.Value.toLowerCase()));else if(jc.Key===Ag.a.eil)this.Mq.mvh=jc.Value,this.Mq.Jch();else if(jc.Key===Ag.a.cil)try{this.Mq.Kud=Boolean.parse(jc.Value)}catch(Qd){ya.a.J(512497755,
817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Qd)}else if(jc.Key===Ag.a.wwg)R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),ya.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",R.toString()),this.lD.N1k(new MK(R));else if(jc.Key===Ag.a.$nh)R=Sys.Serialization.JavaScriptSerializer.deserialize(jc.Value),ya.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",
R.toString()),this.lD.p2k(new NK(R));else if(jc.Key===Ag.a.jPj)try{this.Mq.loe=Boolean.parse(jc.Value),ya.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.Mq.loe)}catch(Qd){ya.a.J(512497751,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",Qd)}else if(jc.Key===Ag.a.cNj)this.Mq.cpc=jc.Value,ya.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",
this.Mq.cpc);else if(jc.Key===Ag.a.B_l)ya.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.Mq.WTh=!0;else if(jc.Key===Ag.a.Udk)ya.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",jc.Value),this.Mq.R4=jc.Value;else if(jc.Key===Ag.a.Vdk)ya.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",jc.Value),this.Mq.Uxg=
Boolean.parse(jc.Value);else if(jc.Key===Ag.a.ZTf)try{this.Mq.p9a=Number.parseInvariant(jc.Value),ya.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.Mq.p9a)}catch(Qd){ya.a.J(512497745,843,15,"Can't parse the notification message: {0}",Qd)}else if(jc.Key===Ag.a.ACf){let Qd;try{Qd=Boolean.parse(jc.Value),this.Mq.minorVersionLimitReached=Qd}catch(Ie){Qd=this.Mq.minorVersionLimitReached=!1}Qd&&!this.Uye&&(this.yYi(),this.Uye=!0);ya.a.J(512497744,
817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",jc.Value,this.Uye)}else ya.a.J(512497743,817,50,"Notification key ignored {0}",jc.Key)}}}}}}}ya.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",jc.Key,Kc.a.vf(xd),(+new Date-+xd).toString());Xd&&!this.su.$Fa&&ya.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",
jc.Key);y.trigger===zR.a.insertPicture&&this.SYk(new TK(!0))}this.tSl(c,f,b,l)}yxj(a,b){const c=new Oa.a;b=lj.e(b,f=>f.Key.startsWith(Ag.a.Zie));for(const f of b)b=FK(f.Key),b.returnValue&&b.correlationID===a&&(1===b.suggestionCount?c.add(b.tmb):1<b.suggestionCount&&c.addRange(xR(f.Value)));return c}yYi(){this.wl.wL(24);ya.a.J(512497740,809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}oWf(){this.aze=!0;this.wl.wL(25);ya.a.J(512497739,809,
15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}SYk(a){this.$d.i2k(a)}USe(a){let b;b=Object(Sa.a)(Vx,a)?()=>{this.$d.raiseFixItSuggestionUpdatedEvent(Object(sa.a)(Vx,a))}:()=>{this.$d.raiseDesignerSuggestionsUpdatedEvent(Object(sa.a)(Fz,a))};if(this.su.$Fa&&this.Da.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new pd.a(2,1,0,()=>{b()},90,Object(Sa.a)(Vx,a)?"114":"92");this.wb.Hb(c)}else b()}tSl(a,
b,c,f){a&&(this.Rfa.GCj(),this.$cd.instance&&this.$cd.instance.Wid());b.forEach(l=>{const y=l.v5b.Id;c.rSl(Ag.a.mfe(y.Sid,y.Cid),l.Mga)});this.Rfa.SEj(b,f)}nKj(){ya.a.J(512497738,817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Ub.Di&&this.Ub.Di.contentReplicator&&(this.Ub.Di.contentReplicator.enabled=0);this.Vd.rH(158,a=>{a.JC=1;return!1})}REj(a){ya.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");
this.lD.o1k(new nj(!1,!0));let b=null;this.$cd.instance&&(b=this.$cd.instance.kAj());this.Qv.syncCurrentSlideIdAndPrefetchRange(this.ua.Ba,b,null,null);this.INg=a.Value}SFj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Ya.podSessionId!==a)if(this.Da.ignorePodSessionRefreshedFromPops)ya.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");else{const b=this.Ya.podSessionId;this.Ya.podSessionId=a;this.sGb.Tmh(new Gk.a(b,
a))}else ya.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}pFj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)ya.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=ia.a.Kf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);this.O7c.C1k(new IK(c,f,l,parseFloat(b[4]),b[5]))}}else ya.a.J(512497734,
817,15,"Response data is null")}catch(b){ya.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}f$i(){let a=0;const b=[],c=(new Date).getTime(),f=this.lPg;for(let y in f){var l=y;0<c-f[y]&&(a++,delete this.lPg[l])}(0<a||0<b.length)&&ya.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Ub.a.join(b,","))}q9d(){this.f$i()}zHh(){if(this.RKg&&!this.pc.YL)ya.a.J(512497730,801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");
else{var a=Fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=oh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",this.Da.podsWebServiceBase),f=Object.assign(new CK,{BaseDocQueryStringWithoutVersion:w.AFrameworkApplication.Pg,SerializedUser:this.Da.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;l["X-CorrelationID"]=b;a=Nd.c(f);w.AFrameworkApplication.Je.qW(c,2,
a,l,[Yg.a.t6],0,y=>{this.Oyg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",y.data.PF,y.data.Is,y.data.fu,y.data.Wd))},y=>{const G=Fb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");this.Oyg(10,G.j9(y))},null,void 0,void 0,void 0,void 0,Nl.a("3"))}}UHh(){var a=Fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=oh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",this.Da.podsWebServiceBase),
f={};f.PodSID=a;f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new DK,{SessionID:a});a=Nd.c(a);w.AFrameworkApplication.Je.qW(c,2,a,f,[Yg.a.t6],0,()=>{ya.a.J(38904456,801,50,"StopServerRtcConnection - request succeeded")},l=>{const y=Fb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");ya.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",y.j9(l))},null,void 0,void 0,void 0,void 0,Nl.a("9"))}Oyg(a,b){ya.a.J(512497729,
801,a,"StartServerRtcResult: {0}",b)}Daa(){this.zHh()}Oy(a,b){b.zpe&&!this.pc.YL&&(ya.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.UHh())}UE(){this.UHh()}}Object(m.a)(xD,"CoauthNotificationManager",null,[]);class UK{constructor(a,b){this.AYh=a;this.Zef=b}get coauthoringStartTime(){return this.AYh}get pNf(){return this.Zef}wol(a){this.Zef=a}}Object(m.a)(UK,"CoauthoringDurationRecord",null,[]);var AR=d(967);class VK extends Sys.EventArgs{constructor(a,
b,c=!1){super();this.gFf=a;this.Zwg=b;this.C_j=c}}Object(m.a)(VK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Gz{constructor(a,b,c){this.Pna=this.Rfb=null;this.ceb=[];this.UBg=new Bk.a;this.bPg=new Bk.a;this.HEe=null;this.hFg=!1;this.zEe=0;this.vFg=this.W8c=!1;this.Pcd="";this.mvh=null;this.minorVersionLimitReached=this.WTh=this.Ssg=this.Kud=this.T0f=!1;this.hEe=null;this.Uxg=!1;this.p9a=0;this.y3c=!1;this.aHa=a;this.Mc=b;this.T7c=0;this.Aeb=[];this.Mc.GUd(Object(H.a)(this,this.Bib,"onPopSessionClosed"));
this.Nok=c}get AD(){return this.Rfb}set AD(a){this.Rfb!==a&&(this.Rfb&&0<this.Rfb.length&&2===this.T7c&&ya.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.Rfb,a)),this.Rfb=a)}get userName(){return this.Pna}get loe(){return this.W8c}set loe(a){(this.W8c=a)&&!this.vFg&&Sf.Health.instance&&(this.vFg=!0,Sf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.W8c.toString()))}get cpc(){return this.Pcd}set cpc(a){a!==this.Pcd&&(this.Pcd=a,ya.a.J(509670558,804,50,
"CoauthStateCache - PopsHostProtocol:{0}",this.Pcd))}get R4(){return this.hEe}set R4(a){this.hEe=a;(a=this.Nok.value.instance)?(a.Q_d=this.hEe,ya.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",a.Q_d)):ya.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.aHa.P1k()}get K_(){const a=[];Array.addRange(a,this.Aeb);return a}get MWl(){return this.K_.length?this.K_.length:1}get amIAlone(){return 2!==this.sda}get Ew(){return this.Uxg}get sda(){return this.T7c}set sda(a){this.T7c!==
a&&(ya.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.T7c=a)}get kDa(){return this.UBg.task}get Ehd(){return this.bPg.task}get OTc(){return this.HEe}set OTc(a){this.HEe||(this.HEe=a,this.bPg.Ng(a.getTime()))}VPh(a){let b;({LWd:a,leaving:b}=this.SSl(a)).returnValue&&(a=new VK(a,b,!this.y3c),this.o5k(),this.aHa.k1k(a))}o5k(){const a=[],b=this.K_;for(const c of b)Array.add(a,c.ID)}wxc(a){const b=this.sda;2===a&&(this.OTc=new Date);0!==b||this.hFg||(ya.a.J(509670553,
804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.hFg=!0,this.UBg.Ng(1===a?1:0));this.sda=a;b!==this.sda&&(this.aHa.V0k(new AR.a(this.sda)),this.eSl(this.sda))}eSl(a){var b=new Date;2===a?(b=new UK(b,new Date(9999,12,31)),Array.add(this.ceb,b)):(a=this.ceb.length,0<a&&this.ceb[a-1].wol(b))}GQh(a){this.AD=a;ya.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.AD,this.K_.length);this.aHa.U0k()}xnb(a){let b;a&&(a=a.toLowerCase());b=null;
for(let c=0;c<this.Aeb.length;c++){const f=this.Aeb[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}SSl(a){let b,c;const f=[];b=[];c=[];let l=!1;const y=a?a.length:0;for(let G=0;G<y;G++){const R=a[G];R&&R.ID&&(R.ID=R.ID.toLowerCase());let ja;({editor:ja}=this.xnb(R.ID)).returnValue?(l=l||!Gz.l0i(R,ja),Array.remove(this.Aeb,ja)):(R.ID!==this.Rfb?Array.add(b,R):this.Pna=R.Name,l=!0);Array.add(f,R)}Array.addRange(c,this.Aeb);l=l||0<c.length;this.Aeb=f;this.zEe=Math.max(this.zEe,this.Aeb.length);
Sf.Health.instance&&Sf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.zEe.toString());return{returnValue:l,LWd:b,leaving:c}}sVc(a,b){let c=0;const f=this.ceb.length;if(0<f&&a<this.ceb[f-1].pNf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const y=Math.max(this.ceb[l].coauthoringStartTime.getTime(),a),G=Math.min(this.ceb[l].pNf.getTime(),b);y<G&&(c+=G-y)}}return c}Jch(){this.Ssg=!0;this.aHa.l2k()}Bib(){this.cpc=""}static l0i(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===
b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(m.a)(Gz,"CoauthStateCache",null,[1098,1099]);var xu=d(384);class Kl{constructor(){this.KeyRoot=null;this.TimeStamp=0}}Object(m.a)(Kl,"KeyRootSubscription",null,[]);class Qv{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.alc=xu.a.empty;this.Us=[];this.BHa=[];this.yFg=this.Gye=!1;this.q8c=a;this.iBe=b;this.Hg=c;this.f7c=za.Jti;this.Rfa=f;this.J7c=l;this.uj=y;this.exk=G.Y1d(1E3,Object(H.a)(this,this.X2i,"ensureVisibleThumbnailsSubscriptionImpl"));
this.Mc=R;this.od=ja;this.Ya=za;Va.gTd(this);this.wdd=hb;this.Phc=Cb;this.OH=!1;this.wdd&&this.Mc.Wii(Object(H.a)(this,this.cFk,"onBackendChanged"));this.Mc.GC(Object(H.a)(this,this.TM,"onSessionClosed"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"))}Mxa(){this.OH=!1;this.J7c.reset();this.emg()}emg(){Array.clear(this.Us);this.alc=xu.a.empty;this.Bxd=this.Rfa.eqa;this.od.atb(()=>{this.Bxd=this.Rfa.eqa});const a=new Kl;a.KeyRoot=Ag.a.q6f(this.f7c);a.TimeStamp=0;this.Us.push(a);var b=new Kl;
b.KeyRoot=Ag.a.Xjh;b.TimeStamp=0;this.Us.push(b);b=new Kl;b.KeyRoot=Ag.a.AFi;this.Us.push(b);var c=new Kl;c.KeyRoot=Ag.a.BIh;this.Us.push(c);c=new Kl;c.KeyRoot=Ag.a.Zie;this.Us.push(c);c=new Kl;c.KeyRoot=Ag.a.Ymg;this.Us.push(c);c=new Kl;c.KeyRoot=Ag.a.HUf;this.Us.push(c);c=new Kl;c.KeyRoot=Ag.a.f1f;this.Us.push(c);c=new Kl;c.KeyRoot=Ag.a.hJh;this.Us.push(c);const f=new Kl;f.KeyRoot=Ag.a.Fwg;this.Us.push(f);const l=new Kl;l.KeyRoot=Ag.a.gNj;this.Us.push(l);var y=new Kl;y.KeyRoot=Ag.a.dOf;this.Us.push(y);
y=new Kl;y.KeyRoot=Ag.a.Tkg;this.Us.push(y);y=Object.assign(new Kl,{KeyRoot:Ag.a.G1f,TimeStamp:0});this.Us.push(y);y=new Kl;y.KeyRoot=Ag.a.ykg;this.Us.push(y);this.Phc&&(y=new Kl,y.KeyRoot=Ag.a.iLh,this.Us.push(y));y=new Kl;y.KeyRoot=Ag.a.ZDf;this.Us.push(y);y=new Kl;y.KeyRoot=Ag.a.Nrg;this.Us.push(y);y=new Kl;y.KeyRoot=Ag.a.wwg;this.Us.push(y);y=new Kl;y.KeyRoot=Ag.a.$nh;this.Us.push(y);y=new Kl;y.KeyRoot=Ag.a.e3f;this.Us.push(y);y=new Kl;y.KeyRoot=Ag.a.ACf;this.Us.push(y);const G=new Kl;G.KeyRoot=
Ag.a.ZTf;this.Us.push(G);this.q8c.aud(this.Us);this.iBe&&(Array.clear(this.BHa),this.BHa.push(b),this.BHa.push(a),this.BHa.push(c),this.BHa.push(f),this.BHa.push(l),this.BHa.push(y),this.Hg.tG?(this.iBe.aud(this.BHa),this.Gye=!0):(this.Mc.HUd(Object(H.a)(this,this.v_a,"onPopSessionInitialized")),this.yFg=!0))}v_a(){this.Gye||(this.iBe.aud(this.BHa),this.Gye=!0)}get Bxd(){return this.alc}set Bxd(a){xu.a.equals(this.alc,a)||(xu.a.equals(a,xu.a.empty)?this.alc=xu.a.empty:this.alc=xu.a.Jxb(a.JT,a.lastIndex),
this.exk.perform())}cFk(a,b){this.OH||(a=b.COk)&&0<a.length&&(ya.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",a,this.Ya.qLc),this.Mxa())}TM(){this.OH=!0}Hn(){this.Mxa()}X2i(){const a=this.Us;var b=this.J7c;const c=[];var f=null;for(const y of this.Bxd.A4){var l=Ag.a.Uyj(y);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new Kl,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);if(l=this.Rfa.hzb(y))l=b.cce(Ag.a.mfe(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=
l)}f&&c.push(f);lj.d(a,Object(H.a)(this,this.J5i,"fNeedResetBrowserKeySubscription"),y=>{y.TimeStamp=0},1);b=lj.e(a,y=>y.KeyRoot.startsWith(Ag.a.kLh));f=lj.a(c,b,Qv.zse);lj.a(b,f,Qv.zse);if(b.length||c.length)lj.a(a,b,Qv.zse),Array.addRange(a,c),this.q8c.aud(a)}J5i(a){return a.KeyRoot.startsWith(Ag.a.q6f(this.f7c))&&!this.uj.AD?(ya.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),!0):!1}dispose(){this.Mc.Qaa(Object(H.a)(this,
this.TM,"onSessionClosed"));this.Mc.Raa(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.yFg&&this.Mc.rXe(Object(H.a)(this,this.v_a,"onPopSessionInitialized"))}static zse(a,b){return a.KeyRoot===b.KeyRoot}}Object(m.a)(Qv,"CoauthSubscriptionManager",null,[1096,108,677]);class WK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(m.a)(WK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class XK{constructor(a,b,c,f,l,y){this.id=oh.a.create();this.t7c=a;this.Ve=b;this.Ya=c;this.Da=l;this.Vd=
f;this.rY=y}vIj(a,b){this.rY&&!this.t7c.q0&&this.rY.EQc(a.YY);a&&a.telemetry&&0<a.telemetry.length&&this.Ve.YZa(a.telemetry);Kc.a.qy(this.Ve,()=>{this.t7c.ddh(this.id,a.result,a.YY,b)})}uIj(a,b,c){if(!this.t7c.q0&&(this.rY&&this.rY.EQc(a.YY),a&&a.error&&this.Da.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Vm===Of.a.Ph(223))){ya.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",this.Ya.podSessionId||"NULL");this.Vd.Gs(Object.assign(new oi.a,
{Code:223,Source:6}),c);return}Kc.a.qy(this.Ve,()=>{this.t7c.ddh(this.id,null,a.YY,b)})}}Object(m.a)(XK,"LongPollingResponseHandler",null,[]);var BR=d(896);class yD{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.dIa=this.$Ha=null;this.VNg=oh.a.nil;this.wHb=this.IXa=0;this.NCg=[10,100,1E3,1E4];this.zYa=null;this.fY=[];this.d5=Va?"GetPopWacUpdates":"GetUpdates";this.O5=a;this.Ya=c;this.Hg=f;this.Mc=l;this.bfa=y;this.Vd=G;this.pc=R;this.rY=ja;this.Mc.GC(Object(H.a)(this,this.TM,"onSessionClosed"));this.Mc.C7a(Object(H.a)(this,
this.lga,"onSessionRehydrating"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));Va&&(this.Mc.HUd(Object(H.a)(this,this.v_a,"onPopSessionInitialized")),this.Mc.GUd(Object(H.a)(this,this.Bib,"onPopSessionClosed")));this.CIe=a.QKl;this.oad=a.N3j;this.uGb=a.Aih;this.tFb=[];b.wab().gTd(this);this.uwk=za;this.r3h=Va;this.uma=!1;this.pGb=Va?3E4:6E4}TM(){this.close("SessionClosed")}lga(){this.zYa&&this.zYa.syd()}Hn(){this.Vjb("SessionRehydrated")}ddh(a,b,c,f){this.$Ha=null;const l=+new Date-
+this.dIa;if(this.uma)ya.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",this.d5);else if(a.equals(this.VNg))if(this.O5.clientIgnoreClosePopsErrorCodeEnable&&this.q0&&this.uma)ya.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.d5);else if(a=this.Hg.Fea,f&&f.length&&a!==f)ya.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",
this.d5,b?"Success":"Failure",this.Ya.Wk,this.Hg.Fea,f,this.wHb,this.CIe),this.wHb++,this.M0f(l,this.wHb)||this.Tsc(this.CIe);else if(this.wHb=0,b){this.dIa=new Date;this.IXa=0;this.Hg.Rse=this.dIa;this.Hg.Qse=f;ya.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",this.d5,l,Kc.a.vf(new Date),this.q0?this.Ya.Wk:"Not Applicable");c=0;f={};for(const y of b.Items)y.TimeStamp>c&&(c=y.TimeStamp),f[y.LastRequestCorrelationID]=
y.LastRequestCorrelationID in f?String.format("{0},{1}",f[y.LastRequestCorrelationID].toString(),y.Key):y.Key,lj.d(this.tFb,G=>y.Key.startsWith(G.KeyRoot),G=>{y.TimeStamp>G.TimeStamp&&(G.TimeStamp=y.TimeStamp)},1);this.Tsc(this.CIe);0<Object.keys(f).length&&Kc.a.yk("RequestCorrelationIDsAndKeyRoots",kh.c(f));c=new Date;Kc.a.qy(Kc.a.Kb,()=>{const y=Object.assign(new WK,{items:b.Items});for(const G of this.fY)try{G(this,y)}catch(R){ya.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",
this.d5,R.toString(),R.stack)}});Kc.a.yk("ProcessItemStartTime",Kc.a.vf(c));Kc.a.yk("ProcessItemDurationInMS",(+new Date-+c).toString());Kc.a.Kb.finish()}else ya.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",this.d5,l,c?c.status:3,c?c.Oe:-1,this.Ya.podSessionId,this.q0?this.Ya.Wk:"Not Applicable"),this.M0f(l,this.IXa)||(f=3<=this.IXa?this.NCg[3]:this.NCg[this.IXa],
this.IXa++,this.Tsc(f),Kc.a.yk("FailureCountSinceLastSuccess",this.IXa.toString()),Kc.a.yk("NextDelayInMS",f.toString()),c&&(Kc.a.yk("RequestStatus",ik.a[c.status]),Kc.a.yk("HttpStatus",c.Oe.toString()),Kc.a.yk("Duration",(+c.fu-+c.Is).toString())),Kc.a.Kb.finish());else ya.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",this.d5)}M0f(a,b){return this.q0&&(a>=this.uGb||b>this.O5.getHostSessionInfoMaxRetryCount)?(ya.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",
this.d5,b,this.Ya.Wk,this.Hg.tG),!0):!1}close(a){ya.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.d5,a);this.uma=!0;this.zYa&&this.zYa.syd()}Tsc(a){const b=Kc.a.Jj(this.d5,2);b.Wa("DelayInMS",a.toString());this.oad?Kc.a.gba(()=>{Kc.a.qy(b,Object(H.a)(this,this.Rhh,"performCall"))},a,0):window.setTimeout(()=>{Kc.a.qy(b,Object(H.a)(this,this.Rhh,"performCall"))},a)}Rhh(){if(!this.enabled||w.AFrameworkApplication.Yg||this.$Ha&&+new Date-+this.$Ha<this.pGb||this.q0&&!this.pc.YL||
this.bfa.U2c)ya.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",this.d5,this.enabled,w.AFrameworkApplication.Yg,this.$Ha?Kc.a.vf(this.$Ha):"null",Kc.a.vf(new Date),this.pGb,this.bfa.U2c,!this.pc.Ho,!this.pc.YL);else{var a=oh.a.create().toString();ya.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",
this.d5,this.$Ha?Kc.a.vf(this.$Ha):"null",Kc.a.vf(new Date),this.pGb,this.q0?this.Ya.Wk:"Not Applicable",a);if(!this.q0){var b=lj.e(this.tFb,y=>y.KeyRoot===Ag.a.Xjh);b&&b.length&&ya.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.$Ha=new Date;b=Kc.a.Kb;var c=new XK(this,b,this.Ya,this.Vd,this.O5,this.q0?null:this.rY);this.VNg=c.id;this.zYa=new BR.a;var f=this.q0?this.Ya.Wk:"",l=this.q0?"":this.Ya.podSessionId;b.Wa(Ii.a.Hvb,a);this.uwk(f,this.Ya.presentationId.string,this.tFb,
y=>{c.vIj(y,f)},y=>{c.uIj(y,f,l)},this.zYa,{["X-CorrelationId"]:a},null,this.pGb)}}get enabled(){return 0<this.tFb.length&&!this.uma}get q0(){return this.r3h}v_a(){this.Vjb("PopSessionInitialized")}Bib(){this.close("PopsUninitialized")}aud(a){a||(a=[]);ya.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.d5,a.length);for(const b of a);this.tFb=a;this.dIa=new Date;this.wHb=this.IXa=0;this.Tsc(0)}bBf(a){Array.add(this.fY,a)}Mxa(){this.Vjb("AppListener:OnReboot")}Vjb(a){ya.a.J(512360718,
801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.d5,a,this.q0?this.Ya.Wk:"Not Applicable");this.q0&&"PopSessionInitialized"===a&&this.Yfl();this.uma=!1;this.$Ha=null;this.dIa=new Date;this.wHb=this.IXa=0;this.zYa&&this.zYa.syd();this.Tsc(0)}Yfl(){for(const a of this.tFb)a.TimeStamp=0}dispose(){this.Mc.Qaa(Object(H.a)(this,this.TM,"onSessionClosed"));this.Mc.tXe(Object(H.a)(this,this.lga,"onSessionRehydrating"));this.Mc.Raa(Object(H.a)(this,this.Hn,"onSessionRehydrated"));
this.q0&&(this.Mc.Drh(Object(H.a)(this,this.Bib,"onPopSessionClosed")),this.Mc.rXe(Object(H.a)(this,this.v_a,"onPopSessionInitialized")))}}Object(m.a)(yD,"DocNotifyClient",null,[381,108,382,677]);class zD{constructor(){this.q5c=0}}Object(m.a)(zD,"TimeStampData",null,[]);class YK{constructor(){this.fHa={}}reset(){this.fHa={}}copy(a){this.reset();a=a.fHa;for(let f in a){var b=f,c=a[f];const l=new zD;l.q5c=c.q5c;this.fHa[b]=l}}rSl(a,b){var c=a in this.fHa?this.fHa[a]:new zD;this.fHa[a]=c;c=this.fHa;
for(let l in c){var f=c[l];l.startsWith(a)&&(f.q5c=b)}}cce(a){return a in this.fHa?this.fHa[a].q5c:0}}Object(m.a)(YK,"HermesContentTimeStampManager",null,[383]);var Wx=d(299);class Xx{constructor(a,b,c,f=null){this.Ipe=a;this.Xfa=b;this.hmc=c;this.Ba=f}}Object(m.a)(Xx,"SlideMoveData",null,[]);var CR=d(658),bk=d(297);class ZK{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){this.Tfc=this.Sva=null;this.xU=0;this.jG=null;this.VAe=0;this.u7c=null;this.CBe=this.Vad=this.AIg=this.CIg=0;this.EJ=this.WIa=this.VX=
null;this.Bna=this.cbd=0;this.rq=a;this.Fa=b;this.ia=c;this.Ub=f;this.ua=l;this.su=y;this.ic=G;this.pc=R;this.vu=ja;this.f1=this.rq.I1;this.iwa=za;this.pa=Va;this.Pq=hb;this.En=Cb;this.sva=lc}kRj(){this.xU=-1;this.Sva=document.createElement("div");this.Sva.style.visibility=qe.a.ft;this.Sva.className=bk.a.c_i;this.f1.appendChild(this.Sva);this.VAe=this.Bna=this.cbd=0;if(this.sva){this.Tfc=document.createElement("div");this.Tfc.className=bk.a.HBj;const a=document.createElement("span");a.className=bk.a.IBj;
this.Tfc.appendChild(a)}}dispose(){this.f1.removeChild(this.Sva);this.su.oF(this.f1,this);this.Sva=this.jG=null}Mv(a){return a?this.rJ(a).returnValue:!1}rJ(a){var b=null;if(3===a.kg||a.OA!==Sys.UI.MouseButton.leftButton||!this.f1.contains(a.Bc)||!this.pc.Ho)return{returnValue:!1,Ewb:b,y4:null};var c=a.clientPoint.y-this.I8e+this.f1.scrollTop;b=a.clientPoint.x-this.f1.offsetLeft;this.vu&&(b-=this.f1.offsetWidth-this.f1.clientWidth);b=this.Syj(b,c);if(!b||!b.XL)return{returnValue:!1,Ewb:b,y4:null};
if(this.sva){a=this.pa.Re();if(1>a.length)return{returnValue:!1,Ewb:b,y4:null};for(var f of a)if(f.pO||32!==this.ia.Ja(ea.a.fUe,1,f.Cb))return{returnValue:!1,Ewb:b,y4:null};f=this.rq.wZ-this.pa.Re().length+1;this.AIg=Math.min(this.F6f(c),f);this.CIg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,nc.a.Fw(c)||32!==this.ia.Ja(ea.a.fUe,1,c))return{returnValue:!1,Ewb:b,y4:null};return{returnValue:!0,Ewb:b,y4:null}}av(a){if(!a)return!1;this.Sva||this.kRj();this.u7c=CR.a(0,0);if(!({Ewb:this.VX,y4:G}=this.rJ(a)).returnValue)return!1;
if(this.En){var b=!1,c=this.VX.slideId,f=this.pa.Re();for(var l of f)if(l.Cb.equals(c)){b=!0;break}if(b){if(this.EJ=this.ua.Ba,1<f.length&&!this.sva)return!1}else this.pa.nh(),this.EJ=this.VX.$c,this.pa.yP(this.VX.$c)}if(this.sva){this.BRh();var y=this.VX.fAb;var G=y.cloneNode(!0);b=G.getElementsByTagName("img")[0];this.kzh(b,bk.a.Wfe,bk.a.Vfe,bk.a.S2f,bk.a.S2f);G.className=bk.a.Gfg;c=this.pa.Re();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.VX.slideIndex!==c[l].slideIndex){f++;y=this.rq.fO(c[l].slideIndex).fAb;
y=(y=y.getElementsByTagName("img"))&&0<y.length?y[0].cloneNode(!0):b.cloneNode(!0);const R=bk.a.Vfe*f;this.kzh(y,bk.a.Wfe-f,bk.a.Vfe-1,R,R);G.appendChild(y);if(3===f)break}G.appendChild(this.Tfc);this.Tfc.firstChild.innerText=this.pa.Re().length.toString()}this.jG?this.rq.I1.replaceChild(G,this.jG):this.rq.I1.appendChild(G);this.jG=G}else b=this.VX.fAb,this.jG?(b=this.jG.getElementsByTagName("img"),G=G.cloneNode(!0),G.style.zIndex=String(bk.a.Wfe),this.jG.replaceChild(G,b[0]),this.jG.style.zIndex=
String(bk.a.FBj)):(this.jG=b.cloneNode(!0),this.rq.I1.appendChild(this.jG),this.jG.className=bk.a.Gfg);this.VAe=parseInt(tf.a.wt(this.jG).height);k.a.ppa(this.jG,bk.a.mgh+bk.a.Kfh+bk.a.rmg,this.vu);this.jG.style.visibility=qe.a.Tz;this.jG.style.cursor=qe.a.Bmb;w.AFrameworkApplication.uk("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");ya.a.J(512497671,819,50,"PPT drag slide start.");this.Sw(a);return!0}BRh(){this.Vad=this.AIg;this.CBe=this.CIg;let a=0;for(let b=0;b<
this.rq.wZ;b++){const c=this.rq.fO(b);c.isSelected?c.Hxc(-2):(a===this.VX.slideIndex&&(a+=1),c.Hxc(a),a++)}}kzh(a,b,c,f,l){a.className=bk.a.EBj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}Sw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.I8e+this.f1.scrollTop,f=this.VAe/2;if(this.iwa){if(z.a.gU&&!a.nc.rawEvent.buttons)return ya.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),
!1;this.jG.style.top=Math.min(c-f,this.sva?Wx.a.GV+(this.rq.wZ-this.pa.Re().length)*this.rq.fta:Wx.a.GV+this.rq.wZ*this.rq.fta)+"px"}else{a=this.w9b(this.rq.wZ)+this.rq.fta/2;if(this.L5i(b.x)||c>a)return this.Pzh(),!0;this.jG.style.top=c-f+"px"}this.jzh(!0);this.GBi(b.y);this.Zol(Math.min(this.F6f(c),this.sva?this.rq.wZ-this.pa.Re().length+1:this.rq.wZ));this.Sva.style.visibility=this.t3c(b)&&!this.sva?qe.a.Tz:qe.a.ft;if(this.sva&&0<=this.xU)if(this.t3c(b)){this.jG.style.visibility=qe.a.Tz;if(this.Vad===
this.xU)return!0;b=this.Vad<this.xU?0>this.xU-1?0:this.xU-1:0>this.xU?0:this.xU;c=0;for(f=0;f<this.rq.wZ;f++)a=this.rq.fO(f),a.isSelected||(c<b?a.Hxc(c):a.Hxc(c+1),c++);this.Vad=this.xU;this.CBe=b}else this.BRh(),this.jG.style.visibility=qe.a.ft;return!0}vo(a){if(!this.ua.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;if(this.sva){if(a=this.pa.Re(),0<a.length&&0<=this.xU&&this.t3c(b)){b=[];for(const c of a)c&&b.push(Object(sa.a)(115,c));this.KKl(b,this.iwj(this.CBe));
ya.a.J(512497669,819,50,"PPT drag slide succeed.")}}else 0<=this.xU&&this.VX&&this.t3c(b)&&this.VX.slideIndex!==this.xU&&this.VX.slideIndex+1!==this.xU&&(this.FKl(this.VX.slideIndex,this.xU),ya.a.J(512497668,819,50,"PPT drag slide succeed."));this.qL()}iwj(a){let b=0;for(let c=0;c<this.rq.wZ;c++)if(!this.rq.fO(c).isSelected&&(b++,a===b))return c+1;return 0}t3c(a){a=a.x>=this.f1.offsetLeft&&a.x<=this.f1.offsetLeft+this.f1.offsetWidth;return!this.iwa||a}Fu(){this.qL()}Syj(a,b){if(!this.rq.fta)return null;
var c=Math.floor((b-Wx.a.GV)/this.rq.fta);if(0<=c&&c<=this.rq.wZ-1){c=this.rq.fO(c);if(!c)return null;const f=c.anb;a=this.vu?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}L5i(a){return this.vu?this.u7c.width-bk.a.kXf>a||this.u7c.width<a:0>a||bk.a.kXf<a}GBi(a){const b=a-this.I8e,c=this.u7c.height;if(bk.a.RFf>b)this.Bna=-bk.a.QFf;else if(bk.a.TFf>
b)this.Bna=-bk.a.SFf;else if(bk.a.VFf>b)this.Bna=-bk.a.UFf;else if(c-bk.a.RFf<a)this.Bna=bk.a.QFf;else if(c-bk.a.TFf<a)this.Bna=bk.a.SFf;else if(c-bk.a.VFf<a)this.Bna=bk.a.UFf;else{this.Bna=0;return}this.Qhh()}Qhh(){if(0!==this.Bna){const a=this.cbd,b=(new Date).getTime();0<a&&(this.f1.scrollTop=Math.max(0,this.f1.scrollTop+Math.floor((b-a)*this.Bna/1E3)));this.cbd=b;window.setTimeout(Object(H.a)(this,this.Qhh,"performAutoScrolling"),bk.a.Dri)}else this.cbd=0}w9b(a){return this.rq.fta*a+Wx.a.GV*(this.iwa?
.75:1)}F6f(a){a+=this.rq.fta/2;a-=Wx.a.GV;a=Math.floor(a/this.rq.fta);return this.iwa?Math.max(0,a):a}Zol(a){this.xU!==a&&(this.xU=a,0>this.xU||(this.Sva.style.top=k.a.Pc(this.w9b(a))))}Pzh(){this.jzh(!1)}jzh(a){this.jG.style.cursor=a?qe.a.Bmb:qe.a.MGl}FKl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if((this.WIa=Ub.a.clone(this.ua.presentation.hI))&&!(b>this.WIa.length||a>=this.WIa.length)){var f=null;a=c.vee(a);b&&(f=c.vee(b-1));b=new Xx(!1,[a],f);this.ia.Ja(ea.a.pmc,
2,b)}}KKl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.WIa=Ub.a.clone(this.ua.presentation.hI))||b>this.WIa.length||!this.F2j(a,b)||(b=b?c.vee(b-1):null,a=new Xx(!1,a,b,this.EJ),this.ia.Ja(ea.a.pmc,2,a))}F2j(a,b){const c=Object.assign(new Oa.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);c.Sc((l,y)=>l-y);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}qL(){this.uRl();this.Pzh();this.jG.style.visibility=
qe.a.ft;this.jG.style.top="0px";this.jG.style.cursor=qe.a.aB;this.Sva.style.visibility=qe.a.ft;if(this.sva){const a=this.Pq.ke(3);try{const b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.ld(b);a.aMa(this.rq.Na);const c=b.slides||[];for(const f of c){const l=Object(sa.a)(116,f);l&&l.anchor.sk(this.rq.Na,16)}}finally{a&&a.dispose()}this.rq.e1a()}this.Bna=0;this.VX&&(this.VX=null);this.Fa.Ee&&this.Fa.Ee.name===xa.a.lF||this.Fa.wf(xa.a.lF)}uRl(){this.En?this.EJ&&(this.Ub.Ba=
this.ic.Qk(this.EJ.Cb)):this.VX&&(this.Ub.Ba=this.VX.$c)}get I8e(){let a=this.f1,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(m.a)(ZK,"ThumbnailNavPaneDragAdapter",null,[391,235,108]);class AD{}AD.adi=[ea.a.print,ea.a.find,ea.a.S1,ea.a.I9a,ea.a.gnd,ea.a.fnd,ea.a.bringForward,ea.a.bringToFront,ea.a.sendBackward,ea.a.sendToBack,ea.a.Nja,ea.a.Cxd,ea.a.Dxd,ea.a.F2a,ea.a.E2a,ea.a.cnb,ea.a.bnb,ea.a.$1a,ea.a.rPb,ea.a.gRb,ea.a.Wsc,ea.a.P6,ea.a.oZ,ea.a.yVa,ea.a.jmb,ea.a.kmb,ea.a.lmb,ea.a.mmb,
ea.a.ksc,ea.a.msc,ea.a.nsc,ea.a.osc,ea.a.urd,ea.a.Esc,ea.a.mZe,ea.a.vrd,ea.a.C8a,ea.a.CTa,ea.a.Dka,ea.a.G1a,ea.a.H1a,ea.a.I1a,ea.a.cuc,ea.a.LOb,ea.a.pOb,ea.a.JOb,ea.a.Dlb,ea.a.Qlb,ea.a.TI,ea.a.BQ,ea.a.i6,ea.a.Zhb,ea.a.Whb,ea.a.Yhb,ea.a.Xhb,ea.a.$_a,ea.a.Z_a,ea.a.jCk,ea.a.HXk,ea.a.PFi,ea.a.QFi,ea.a.HKe,ea.a.IKe,ea.a.JKe,ea.a.KKe,ea.a.RNk,ea.a.vGi,ea.a.deleteComment,ea.a.uAb,ea.a.e0c,ea.a.oel,ea.a.kCk,ea.a.IXk,ea.a.wwc,ea.a.pwc,ea.a.rwc,ea.a.qwc,ea.a.vwc,ea.a.uwc];Object(m.a)(AD,"ActionHandledList",
null,[]);class lt{constructor(a,b,c,f){this.o1=new rj.a;this.fHe=new rj.a;this.ia=a;this.Da=b;this.pa=c;this.Gg=f;this.NQj();this.OQj()}yFj(a,b,c=null){this.Da.remapShapeEditCommandEnabled&&((this.pa.vH()||this.pa.Js())&&this.o1.Gb(a)?a=this.o1.ga(a):this.pa.uz()&&this.fHe.Gb(a)&&(a=this.fHe.ga(a)));if(this.Da.podsTableRTTEnabled&&this.Da.podsTableCellLockEnabled&&Array.contains(lt.Hil,a)&&(this.pa.J9()||this.pa.p2j()))return 32;if(!Array.contains(AD.adi,a))return this.ia.Ja(a,2,b,c);const f=this.ia.Lp,
l=this.ia.bU;let y=this.ia.Ja(a,1,b);32===y&&(this.Da.pptDragCancelFix&&(this.ia.Lp=f,this.ia.bU=l),y=this.ia.Ja(a,2,b,c));return y}Wwl(a){return this.Gg.dxb!==a&&this.Gg.exb!==a}uxb(a,b,c){return b&&b.name===xa.a.qg&&!this.pa.Js()&&1===this.pa.Ud().length&&this.pa.uz()&&this.Wwl(c)?a.uxb(a.Ic(b.parent),c):a.uxb(b,c)}NQj(){this.o1.$(C.a.upArrow,ea.a.mmb);this.o1.$(C.a.downArrow,ea.a.jmb);this.o1.$(C.a.leftArrow,ea.a.kmb);this.o1.$(C.a.rightArrow,ea.a.lmb);this.o1.$(C.a.NOb,ea.a.osc);this.o1.$(C.a.Rlb,
ea.a.ksc);this.o1.$(C.a.P1a,ea.a.msc);this.o1.$(C.a.Q1a,ea.a.nsc);this.o1.$(C.a.qta,ea.a.Wsc);this.o1.$(C.a.c_a,ea.a.cnb);this.o1.$(C.a.b_a,ea.a.bnb);this.o1.$(ea.a.Nja,ea.a.X7a);for(const a of lt.$il)this.o1.$(a,F.a.we)}OQj(){for(const a of lt.ajl)this.fHe.$(a,F.a.we)}}lt.$il=[C.a.CDa,C.a.DDa,C.a.f4b,C.a.Vvb,C.a.lSa,C.a.mSa,C.a.e9a,C.a.kSa,C.a.Vhb,C.a.iTa,C.a.a$a,C.a.Uhb,C.a.hTa,C.a.$9a];lt.ajl=[ea.a.I9a,ea.a.CTa,ea.a.Dka,ea.a.gRb];lt.Hil=[C.a.backspace,C.a.uL,ea.a.C8a];Object(m.a)(lt,"ProcessInputStrategy",
null,[388]);class $K{get PNc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(m.a)($K,"PPTColorTable",null,[380]);var DR=d(968);class aL{constructor(){this.ied={}}Uae(a){return a&&a in this.ied?this.ied[a]:null}yHf(a,b){a&&b&&a!==b&&(a in this.ied||(this.ied[a]=b))}}Object(m.a)(aL,"PresenceEmailConverter",null,[916]);var bL=d(916),Yx;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";
a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";
a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=
19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=
28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=
38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Yx||(Yx={}));Object(m.b)("EntryName",Yx);class cL{constructor(a,b,c,f){this.$o=null;this.aGe=this.Ecd=0;this.nDe=this.rJg=this.ECe=this.zad=!1;this.Yue=this.Zue=this.eBe=this.sve=this.DAe=0;this.x7c=this.Fye=null;this.gdd=new Bk.a;this.VYg=new Bk.a;this.FQg=new Bk.a;this.vze=this.Aze=!1;this.ajc=a;this.FGe=b;this.uj=c;f.execute(l=>
{this.$o=l});this.pY={};oo.Task.WAA(this.uj.kDa,this.gdd.task,this.VYg.task).continueWith(()=>{try{this.Myh(),this.fSc(this.pY),0<ta.a.count(this.pY)&&ha.ULS.sendTraceTag(51242144,814,15,ta.a.toJSON(this.pY)),this.Aze=!0}catch(l){ha.ULS.sendTraceTag(51242145,814,10,l.toString())}});oo.Task.WAA(this.uj.kDa,this.FQg.task).continueWith(()=>{try{this.Myh(),this.fSc(this.pY),0<ta.a.count(this.pY)&&ha.ULS.sendTraceTag(594879178,814,15,ta.a.toJSON(this.pY)),this.vze=!0}catch(l){ha.ULS.sendTraceTag(594879177,
814,10,l.toString())}});this.k8c={};this.KAe={}}g2i(a){this.pJc(a,8,"g_hermesPresenceJS");this.pJc(a,20,"g_hermesPresence1JS");this.pJc(a,18,"g_JquerySignalRMergeJS");this.pJc(a,19,"g_JquerySignalRMergeJSEnd")}pJc(a,b,c){b=Yx[b];b in a||(c=this.Nmj(c),0<c&&this.bja(a,b,c))}Nmj(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.w3f();this.i$i();this.zOh();this.pY=this.KAe=this.k8c=null}p2i(){this.uCa(25)}o2i(){this.uCa(12)}qgk(){this.uCa(15);0<this.appInitChromeReady&&this.uCa(16)}k2i(a){try{this.Ecd||
(this.Ecd=a,this.li(17,this.Ecd),this.li(13,this.K9f(this.B2I,this.Ecd)),this.FQg.wK(!0))}catch(b){ha.ULS.sendTraceTag(594879176,814,10,b.toString())}}Tek(a,b){this.li(6,a);this.li(5,b)}l2i(){this.aGe||(this.aGe=Date.now(),this.li(31,this.aGe),this.w3f())}m2i(){this.uCa(28)}n2i(){this.uCa(27)}HQk(a){const b=[];for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}q2i(a){a&&(a=this.HQk(a),this.li(38,a.length),this.li(37,0<a.length),this.uCa(39));this.VYg.Ng(!0)}kfk(a){try{this.gdd.task.isCompleted||
ta.a.Xa(a)||(this.uCa(34),this.gdd.wK(!0))}catch(b){ha.ULS.sendTraceTag(51242146,814,10,b.toString())}}lfk(a){if(!(ta.a.Xa(a)||"presenceUpdateNotificationReceived"in this.pY)){var b=Date.now();this.li(33,b);this.eBe=this.K9f(this.B2I,b);this.li(32,this.eBe);this.li(30,ta.a.count(a));this.$o&&this.li(29,this.$o.e1f)}}R5i(){return!this.gdd.task.isCompleted&&(!this.$o||!this.$o.e1f)&&!this.eBe}jfk(){this.uCa(35);this.uj.OTc&&this.li(36,this.uj.OTc.getTime())}E2i(){this.FGe&&!this.zad&&(this.zad=!0,this.FGe.GAf(Object(H.a)(this,
this.Fnc,"onResourceTimingEntriesAvailable")))}Fnc(a,b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=ug.a.Paa(f.url);!this.ECe&&l.endsWith("rtc2/signalr/negotiate")?(this.ECe=!0,this.GJc(a,"Negotiate",f.oC)):l.endsWith("rtc2/signalr/connect")?(this.rJg=!0,this.GJc(a,"Connect",f.oC)):!this.nDe&&l.endsWith("rtc2/signalr/start")?(this.nDe=!0,this.GJc(a,"Start",f.oC)):l.endsWith("rtc2/findsession")&&(this.GJc(a,this.DAe.toString()+"_FindSession",f.oC),this.DAe++)}if(this.ECe||this.rJg||
this.nDe||0<this.DAe)this.zOh(),this.v3f(a)}catch(c){ha.ULS.sendTraceTag(51242147,814,10,c.toString())}}GJc(a,b,c){this.bja(a,b+"FS",c.fetchStart);this.bja(a,b+"RS",c.responseStart);this.bja(a,b+"RE",c.responseEnd)}zOh(){this.zad&&(this.zad=!1,this.FGe.Wqh(Object(H.a)(this,this.Fnc,"onResourceTimingEntriesAvailable")))}uCa(a){this.li(a,Date.now())}li(a,b){this.Gei(Yx[a],b)}Gei(a,b){this.bja(this.k8c,a,b);this.bja(this.pY,a,b)}bja(a,b,c){b in a||(a[b]=c)}fSc(a){this.g2i(a);this.bja(a,"B2I",this.B2I);
null!=this.fHasTabSwitch&&this.bja(a,"fHasTabSwitch",this.fHasTabSwitch);null!=this.x7c&&this.bja(a,"firstCoauthoringStatus",this.x7c);this.appInitInteractivityReady&&this.bja(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.bja(a,"appInitChromeReady",this.appInitChromeReady)}Myh(){null==this.x7c&&(this.x7c=this.uj.kDa.result)}w3f(){this.v3f({})}v3f(a){try{this.fSc(this.k8c),ta.a.forEach(this.k8c,(b,c)=>{b in this.KAe||(this.KAe[b]=c,a[b]=c)},null),0<ta.a.count(a)&&
ha.ULS.sendTraceTag(41239941,828,50,ta.a.toJSON(a))}catch(b){ha.ULS.sendTraceTag(51242176,814,10,b.toString())}}i$i(){ha.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.Aze,this.vze);if(!this.Aze||!this.vze)try{this.fSc(this.pY),0<ta.a.count(this.pY)&&ha.ULS.sendTraceTag(51242178,814,50,ta.a.toJSON(this.pY))}catch(a){ha.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.sve&&Jg.a.instance.xn(ji.a.contentEditable)&&(this.sve=
Jg.a.instance.Tg(ji.a.contentEditable));return this.sve}get appInitInteractivityReady(){!this.Zue&&Jg.a.instance.xn("AppInitStatus_interactivityReady")&&(this.Zue=Jg.a.instance.Tg("AppInitStatus_interactivityReady"));return this.Zue}get appInitChromeReady(){!this.Yue&&Jg.a.instance.xn("AppInitStatus_chromeReady")&&(this.Yue=Jg.a.instance.Tg("AppInitStatus_chromeReady"));return this.Yue}get fHasTabSwitch(){null==this.Fye&&Jg.a.instance.xn(ji.a.BAd)&&(this.Fye=Jg.a.instance.Tg(ji.a.BAd));return this.Fye}K9f(a,
b){return this.ajc?this.ajc.fbg(new Date(a),new Date(b)):-1}}Object(m.a)(cL,"PresencePerfLogger",null,[385,108]);class dL{constructor(a,b,c){this.r_g=this.Yfc=this.F8c=this.Pna=null;this.Xxe=!1;this.UGe=null;this.vi=a;this.O5=b;this.Mq=c}HYc(){this.Wwb();return this.Pna}Ajj(){this.Wwb();return this.F8c}getFindSessionResponse(){return this.vi?this.vi.FindSessionResponse:null}F8f(){this.Wwb();return this.Yfc}Ntj(){this.Wwb();return this.r_g}Ltj(){this.Wwb();return this.UGe}Kud(){this.Wwb();return this.Xxe}ogk(){if(this.vi){const a=
!!this.vi.PresenceException,b=!isNaN(this.vi.PresenceDownloadEditorTableHttpStatus)&&200!==this.vi.PresenceDownloadEditorTableHttpStatus||!isNaN(this.vi.PresenceFindSessionHttpStatus)&&200!==this.vi.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.O5.presenceEarlyFindSessionEnabled;c.EditorCount=this.F8c?this.F8c.length:0;c.ShouldConnectToRtcByDefault=this.Xxe;c.EditorTableHttpStatus=this.vi.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.vi.PresenceFindSessionHttpStatus;
c.CachedException=this.vi.PresenceException;c.IsFindSessionResponseEmpty=!this.vi.FindSessionResponse;c.IsEditorTableResponseEmpty=!this.vi.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.UGe;ya.a.J(41501202,804,a||b?15:50,ta.a.toJSON(c))}}Wwb(){if(this.vi&&!this.Pna)try{if(this.vi.CoauthHandlerResponse){const a=Sys.Serialization.JavaScriptSerializer.deserialize(this.vi.CoauthHandlerResponse);this.F8c=a.EditorTable;this.Pna=a.UserName;this.Yfc=a.Email;this.r_g=a.RtcEndpointUrl;this.Xxe=a.FConnectByDefault;
this.UGe=a.RtcBootToken;this.Mq.Jch()}}catch(a){ya.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+a)}}}Object(m.a)(dL,"PresencePrepCacheParser",null,[394]);class BD{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=w.AFrameworkApplication.userSessionId;this.Brd=w.AFrameworkApplication.Brd;this.eda=w.AFrameworkApplication.Je;this.gx=b;this.myh=c;this.lvh=f}}Object(m.a)(BD,"RtcParams",null,[]);class eL{constructor(a,
b,c){this.Whk=a;this.RGe=b;this.o6c=c}ZDi(a,b,c){Ga.a.yv(a);Ga.a.yv(b);Ga.a.yv(c)}eVd(a,b,c,f){return f=!a&&0>b?f+Math.abs(b):this.Whk?(c-b)/4:(c-b)/2}fVd(a,b,c){if(!this.o6c||!b)return c;if(0<=b.className.indexOf(uc.a.$N))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.jYc(b,da.a.J5c),l=this.jYc(b,da.a.dUc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const y=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,y.y+=c,y.height-=2*c,y;a=this.Rvj(b,a);if(isNaN(a)||
!a)return c;c=(a-f)/2;y.y+=c;y.height-=2*c;return y}Awj(a,b){if(!this.o6c)return 0;a=this.jYc(a,da.a.J5c);b=Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}Rvj(a,b){let c=Object(sa.a)(908,b);b||(c=Object(sa.a)(908,this.RGe.I8b(a)));if(c&&this.RGe.hYj(c))return this.jYc(a,da.a.dUc);b=0;const f=a.getClientRects();f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.RGe.mha(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}jYc(a,
b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=N.a.Be(c,b),c=0<=c.className.indexOf(uc.a.Idc)?c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(m.a)(eL,"PptMeasureBoundsUsingSpansStrategy",null,[389]);class CD{constructor(){this.bJa=null}get Mlc(){return this.bJa?this.bJa.Mlc:0}get suc(){return this.bJa?this.bJa.suc:!1}get Oud(){return this.bJa?this.bJa.Oud:!1}j3b(a,b){b&&(this.bJa?this.bJa.j3b(a,b):b(null))}Gsi(a){this.bJa=a}}Object(m.a)(CD,"PPTProcessImageStrategyProxy",
null,[907,578]);class DD{constructor(a,b){this.N6h=a;this.nrf=b}get xPk(){return this.N6h}get EPe(){return this.nrf}yrl(a){this.nrf=a}}Object(m.a)(DD,"PageHiddenRecord",null,[]);class fL{constructor(){this.kna=[];ya.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.MCe=window.document.hidden){const a=new DD(new Date,new Date(9999,12,31));this.kna.push(a)}Fb.a.instance.rb("Common.ITaskManager").Hb(new pd.a(4,2,9E5,Object(H.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));
$addHandler(window,"visibilitychange",Object(H.a)(this,this.onVisibilityChange,"onVisibilityChange"))}fbg(a,b){const c=this.kna.length;let f=0;if(0<c&&a<this.kna[c-1].EPe){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const y=Math.max(this.kna[l].xPk.getTime(),a),G=Math.min(this.kna[l].EPe.getTime(),b);y<G&&(f+=G-y)}}return f}onVisibilityChange(){ya.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.G5k()}G5k(){var a=window.document.hidden,b=new Date;this.MCe!==a&&((this.MCe=a)?
(b=new DD(b,new Date(9999,12,31)),this.kna.push(b)):(a=this.kna.length,0<a&&this.kna[a-1].yrl(b)))}maintainPageHiddenRecords(){const a=new Date;for(;0<this.kna.length&&9E5<+a-+this.kna[0].EPe;)Array.removeAt(this.kna,0)}}Object(m.a)(fL,"PageHiddenMeter",null,[379]);class ED{F6(a){let b=ea.a.uy(a);return b||(b=C.a.uy(a))?b:(b=F.a.uy(a))?b:""}}Object(m.a)(ED,"ActionNameResolver",null,[906]);class FD{constructor(){this.va=new Wc.a}U0k(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}V0k(a){this.va.raiseEvent("CSC",
a)}k1k(a){this.va.raiseEvent("ETC",a)}Anh(a){this.va.raiseEvent("TLSC",a)}n3k(a){this.va.raiseEvent("TCVEL",a)}l2k(){this.va.raiseEvent("PRTCC",null)}P1k(){this.va.raiseEvent("LCK",null)}LJc(a){this.va.addHandler("CSC",a)}fqd(a){this.va.removeHandler("CSC",a)}jUd(a){this.va.addHandler("ETC",a)}Vqh(a){this.va.removeHandler("ETC",a)}Hli(a){this.va.addHandler("TLSC",a)}Xcl(a){this.va.removeHandler("TLSC",a)}yli(a){this.va.addHandler("TCVEL",a)}Aki(a){this.va.addHandler("PRTCC",a)}Erh(a){this.va.removeHandler("PRTCC",
a)}Jii(a){this.va.addHandler("LCK",a)}}Object(m.a)(FD,"CoauthEventSource",null,[903,904,905]);class GD{constructor(){this.va=new Wc.a}c3k(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}C1k(a){this.va.raiseEvent("OnImageDescriptionReady",a)}p1k(a){this.va.raiseEvent("FRHRE",a)}N0k(a){this.va.raiseEvent("APIRE",a)}J1k(a){this.va.raiseEvent("IMARE",a)}kBf(a){this.va.addHandler("OnShowHideAltTextPane",a)}xrh(a){this.va.removeHandler("OnShowHideAltTextPane",a)}Cji(a){this.va.addHandler("OnImageDescriptionReady",
a)}Ibl(a){this.va.removeHandler("OnImageDescriptionReady",a)}vji(a){this.va.addHandler("FRHRE",a)}Dbl(a){this.va.removeHandler("FRHRE",a)}Uii(a){this.va.addHandler("APIRE",a)}nbl(a){this.va.removeHandler("APIRE",a)}Fji(a){this.va.addHandler("IMARE",a)}Kbl(a){this.va.removeHandler("IMARE",a)}}Object(m.a)(GD,"CoreExtEventSource",null,[900,901,902]);var gL=d(1063);class HD extends gL.a{constructor(a,b,c,f,l,y,G){super(f,c,a,y,G);this.h7c=new Qe.a(0);this.lXa=b;this.iEe=l}CQj(a,b){let c;(c=this.h7c).$(b,
c.ga(b)+1);this.dZf(a.name,Object(H.a)(this,this.Hlg,"initPackageCallback"),a)}DQj(a,b){let c;(c=this.h7c).$(b,c.ga(b)+1);this.eZf(a.name,Object(H.a)(this,this.Hlg,"initPackageCallback"),1,a)}Hlg(a){a.BQj()}eEh(a,b){return!!a&&!!b&&a.context.RHf!==b.context.RHf}zNe(a,b){if(b>=this.iEe){const c=new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,Xg.a.$Y(a[f].duration,0)));ha.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),
Xg.a.$Y(b,0))}}onIdle(a){const b=[];this.h7c.forEach((c,f)=>{0<f&&(b.push(c),this.h7c.$(c,0),this.lXa.g6c(c));return!0});ha.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),Xg.a.$Y(a,0))}}Object(m.a)(HD,"DelayLoadedPackageInitializer",gL.a,[]);class Zx{constructor(a,b,c,f,l,y,G,R,ja){this.sHe=this.rHe=null;this.Da=a;this.yE=b;this.Mq=c;this.uj=f;this.ia=l;this.BH=y;this.Rb=G;this.le=ja;this.quk=R;this.yE.jUd(Object(H.a)(this,this.cYf,"editorTableUpdate"))}dispose(){this.yE.Vqh(Object(H.a)(this,
this.cYf,"editorTableUpdate"))}cYf(){const a=this.uj.K_;this.GZf();this.Mq.y3c&&(ya.a.J(512496593,814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.uj.AD,a.length),this.ia.processAction(F.a.J8a,2))}GZf(){if(!this.Mq.y3c&&this.uj.AD){ya.a.J(23437903,814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Rb)throw Error.create("Presence is being loaded before the app frame");this.cNl()}catch(a){ya.a.J(512496591,
814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}cNl(){ya.a.J(512496590,814,50,"App::EnsurePresence: trigger download js");if(this.Da.rxc)Fb.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.presence",null,()=>d.e(10).then(d.bind(null,1303)));else{const a=Tx.a.create("pptedit.presence",this.GQi(),()=>d.e(10).then(d.bind(null,1303)));Nv.a.py(a)}}GQi(){this.IFh.sW((a,b)=>{this.quk.$3c=b.succeeded});return[this.IFh]}get BCl(){this.sHe||(this.sHe=
this.gag());return this.sHe}get IFh(){this.rHe||(this.rHe=this.FRi());return this.rHe}FRi(){return this.Aoj()}Aoj(){return eD.a.create(this.gag(),null,null,Sc.App.$tg)}gag(){return this.Da.podsUseVersionLessJqueryAndSignalR?this.le.wAj("jquery.signalr.merge.1.1"+Zx.EYd):w.AFrameworkApplication.Ji("jquery.signalr.merge.1.1",2)}}Zx.EYd=".min.js";Object(m.a)(Zx,"PresenceLoader",null,[]);class hL{constructor(a,b,c,f,l,y,G,R,ja){this.IHa=this.KHa=!1;this.Bma=this.vma=null;this.Da=a;this.By=b;this.WX=c;
this.Ga=f;this.Oeb=l;this.QAe=y;this.wb=G;this.Dy=R;this.Cz=ja;this.q5=this.Da.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.Oeb.pug}Kpd(a){if(this.q5&&a&&!a.Ml&&a.OBb)if(a.Vre)a.Vre=!1;else if(this.Ga.Y1c(a.shapeNode)){var b=this.Ga.DYc(a.shapeNode);b.length&&(this.Cz&&this.Cz.isEnabled||this.Cz&&this.Cz.isEnabled?(this.vma=this.Bma=null,this.IHa=this.KHa=!1,this.Cz&&this.Cz.isEnabled&&this.Cz.xT&&(this.Cz.Wbb(c=>{ya.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");
this.Bma=c;this.hRc(a,b)}),this.Cz.xT.Xbb(()=>{ya.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.KHa=!0;this.hRc(a,b)})),this.Dy&&this.Dy.isEnabled&&this.Dy.xT&&(this.Dy.Wbb(c=>{ya.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.vma=c;this.hRc(a,b)}),this.Dy.xT.Xbb(()=>{ya.a.J(41494535,801,15,"CloudFontWebRequestFailed");this.IHa=!0;this.hRc(a,b)}))):this.LNh(a,b,null,null))}}TFa(a){return a?!0:!1}hRc(a,b){(this.TFa(this.vma)&&this.TFa(this.Bma)||this.TFa(this.vma)&&this.KHa||
this.IHa&&this.TFa(this.Bma)||this.IHa&&this.KHa)&&this.LNh(a,b,this.vma,this.Bma)}LNh(a,b,c,f){a&&!a.Ml&&b&&b.length&&(ya.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),Promise.all(this.QAe.mTh(b,c,Object(H.a)(this.Dy,this.Dy.createFontUrl,"createFontUrl"),f,Object(H.a)(this.Cz,this.Cz.createFontUrl,"createFontUrl"),this.WX.tSh,Object(H.a)(this.WX,this.WX.createFontUrl,"createFontUrl"))).then(()=>{ya.a.J(41521288,801,50,"WebFontsLoadCompleted");this.By.MFa(()=>{this.wb.Hb(new pd.a(2,
1,0,()=>{a&&!a.Ml&&(ya.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.iEa(),a.Vre=!0,a.dB())},90,"109"))})},l=>{ya.a.J(41494541,801,10,"WebFontsLoad failed: {0}",l.toString());a&&!a.Ml&&a.shapeNode&&(a.shapeNode.eVa=!0)}))}}Object(m.a)(hL,"RemoveShapeFidelityViewForEmbeddedFontController",null,[393]);class iL{constructor(a,b,c,f,l,y,G,R,ja){this.IHa=this.KHa=!1;this.Bma=this.vma=null;this.lna=new Oa.a;this.xva=a;this.Dn=b;this.WX=c;this.Ga=f;this.Oeb=l;this.QAe=y;this.wb=
G;this.Dy=R;this.Cz=ja}v$k(a){window.self.Promise&&this.Oeb.pug?this.wb.Hb(new pd.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){ya.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",b),this.UQb(a)}},90,"102")):this.UQb(a)}UQb(a){if(a&&a.length){for(var b of a)b.Ml||(b.OBb=!0,b.dB()),this.Dn.$zh();b=0;Jg.a.instance.xn(ji.a.wQ)&&(b=(new Date).getTime()-Jg.a.instance.Tg(ji.a.wQ));ya.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",
this.lna.count,b);if(0<this.lna.count){const c=new Map;c.set("PendingFontsCount",this.lna.count.toString());c.set("FidelityViewDuration",b.toString());Sf.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",["MissingFont"],!1,!1,!0,!1,Object.assign(new Ak.a,{extendedProperties:c}))}a.length=0;ya.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){ya.a.J(40429067,801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.Ml&&
b.GB&&b.iEa();b=new Date;for(const c of a)if(!c.Ml){const f=this.Ga.Pab(c.shapeNode);for(const l of f)this.lna.contains(l)||this.lna.add(l)}ya.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.lna.count){if(!this.Cz||!this.Cz.isEnabled)if(!qd.a("EnableRemoveFidelityCloudServiceCheck")||!this.Dy||!this.Dy.isEnabled){this.hqh(a,this.lna,null,null);return}this.vma=this.Bma=null;this.IHa=this.KHa=!1;this.Cz&&this.Cz.isEnabled&&(this.Cz.Wbb(c=>{ya.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");
this.Bma=c;this.iRc(a,this.lna)}),this.Cz.xT&&this.Cz.xT.Xbb(()=>{ya.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.KHa=!0;this.iRc(a,this.lna)}));this.Dy&&this.Dy.isEnabled&&(this.Dy.Wbb(c=>{ya.a.J(40429075,801,50,"CloudFontListDownloadAndParseCompleted");this.vma=c;this.iRc(a,this.lna)}),this.Dy.xT&&this.Dy.xT.Xbb(()=>{ya.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.IHa=!0;this.iRc(a,this.lna)}))}else ya.a.J(40429071,801,50,"No unsupported fonts"),this.UQb(a)}TFa(a){return a?!0:
!1}iRc(a,b){(this.TFa(this.vma)&&this.TFa(this.Bma)||this.TFa(this.vma)&&(this.KHa||qd.a("FidelityCustomServiceDisableCheck")&&!this.Cz.isEnabled)||this.IHa&&this.TFa(this.Bma)||this.IHa&&this.KHa)&&this.hqh(a,b,this.vma,this.Bma)}hqh(a,b,c,f){b&&b.count?(ya.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.QAe.mTh(b.toArray(),c,Object(H.a)(this.Dy,this.Dy.createFontUrl,"createFontUrl"),f,Object(H.a)(this.Cz,this.Cz.createFontUrl,"createFontUrl"),this.WX.tSh,Object(H.a)(this.WX,
this.WX.createFontUrl,"createFontUrl"))).then(l=>{ya.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let y=0;y<l.length;y++)if(l[y])for(let G=0;G<l[y].length;G++)if(l[y][G]){ya.a.J(40429081,801,50,"Status {0}",l[y][G].status);const R=l[y][G].family;na.a.Xa(R)||l[y][G].status!==Qg.loaded||-1===R.lastIndexOf("_")||b.remove(R.substring(0,R.lastIndexOf("_")))}this.UQb(a)},l=>{ya.a.J(41521304,801,10,"WebFontsLoad failed: {0}",l.toString());this.wb.Hb(new pd.a(2,1,this.xva.pptWaitForWebFontsLoadingTimeoutMs,
()=>{ya.a.J(40429073,801,50,"Check removing Fidelity View");this.UQb(a)},90,"103"))})):this.UQb(a)}}Object(m.a)(iL,"RemoveShapeFidelityViewOnBootController",null,[392]);class jL{constructor(a){this.ia=a}iCl(){this.xFh(ResourceStrings.l_SessionTimeoutErrorMessage)}jCl(){this.xFh(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}xFh(a){const b=new sh.StandardDialog;b.Ad=4;b.ig="PPTTimeoutDialog";b.Le(1,ResourceStrings.L_Refresh);b.Le(2,ResourceStrings.L_Close);b.zP(ResourceStrings.l_GenericDialogTitle,
a,Object(H.a)(this,this.rnl,"sessionTimeoutDialogHandler"))}rnl(a,b){1===a?(ya.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.Uxl()?(ya.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(ea.a.refreshPage,2)):this.ia.Ja(ea.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):(ya.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(ea.a.Axb,2))}Uxl(){const a=w.AFrameworkApplication.gm,
b=w.AFrameworkApplication.Yia;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(m.a)(jL,"SessionTimeoutIndicator",null,[386]);class kL{constructor(){this.Thc=!1;this.ycd=[]}vVj(a){this.Thc?a():Array.contains(this.ycd,a)||Array.add(this.ycd,a)}get $3c(){return this.Thc}set $3c(a){if(!this.Thc&&(this.Thc=a)){for(const b of this.ycd)b();Array.clear(this.ycd)}}}Object(m.a)(kL,"SignalRLoadCompletedListener",null,[387]);class Hz{constructor(a,b,c,f,l,y,G){this.d1g=this.yMg=!1;this.Nfa=this.EHe=null;this.DPg=
this.lDe=!1;this.e1g=this.f1g=this.gQg=this.hQg=0;this.ia=a;this.dkk=b;this.Vp=f;this.RHe=y;this.Fc=l;this.zh=G;this.Fc.KAf(Object(H.a)(this,this.XIk,"onLazySorterViewActorActionRegistrationHandler"))}vb(){this.zh||(this.ia.ya(ea.a.Uga,rb.a.application,Object(H.a)(this,this.YBl,"showStatusBarSorterView")),this.ia.ya(ea.a.ivb,rb.a.application,Object(H.a)(this,this.tFi,"closeStatusBarSorterView")))}YBl(a,b,c,f,l){if(2!==c)return 32;if(this.lDe)return this.RHe.instance.Uga(a,b,c,f,l);this.Fc.KAf(Object(H.a)(this,
this.IGh,"sorterViewEventHandler"));this.mdk();this.yMg||(this.xte(),this.DPg=!0);return 32}tFi(a,b,c,f,l){if(2!==c)return 32;this.Fc.fbl(Object(H.a)(this,this.IGh,"sorterViewEventHandler"));(this.Nfa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Nfa);return this.lDe?this.RHe.instance.ivb(a,b,c,f,l):32}xte(){this.d1g||(this.d1g=!0,this.EHe=this.ldk(),this.EHe.sW(Object(H.a)(this,this.sMk,"onSlideSorterGridLoaded")),Nv.a.py(this.EHe),
this.hQg=Date.now())}sMk(){this.yMg=!0;this.Vp&&this.Vp.A6("SlideSoterGridDownloadFinished");this.gQg=Date.now();const a=Jg.a.instance;a&&(a.$b("SlideSorterOnDemandLoad",this.DPg),a.$b("SlideSorterPkgST",this.hQg),a.$b("SlideSorterPkgET",this.gQg))}mdk(){this.ia.processAction(ea.a.C2b,2);this.Nfa=k.a.ee();this.Nfa.id="SlideSorterViewLoadingElementId";this.Nfa.className="sorterview-ui-loading-element-class";const a=k.a.ee();a.className="sorterview-ui-loading-textmessage-class";a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;
const b=k.a.ee();b.className="sorterview-ui-loading-spinner-class";const c=k.a.ee();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.Nfa.appendChild(b);this.Nfa.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.Nfa);this.f1g=Date.now()}IGh(){(this.Nfa=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Nfa);this.e1g=Date.now();this.RHe.instance.Uga(ea.a.Uga,null,2,null,null);
const a=Jg.a.instance;a&&(a.$b("SlideSorterLoadingExpST",this.f1g),a.$b("SlideSorterLoadingExpET",this.e1g))}XIk(){this.lDe=!0}ldk(){var a=w.AFrameworkApplication.Ji("slidegrid"+Hz.EYd,5);a=this.dkk.Pvb(a);return Tx.a.create("pptedit.sorterGrid",this.zh?null:[a],()=>d.e(17).then(d.bind(null,1309)))}dispose(){}}Hz.EYd=".min.js";Object(m.a)(Hz,"SorterViewActorMain",null,[108,395]);class Rv{constructor(a){this.Vpf=a}onBlur(a,b){this.Ute("OnBlur",a,b);(a=ra.InteractiveViewManager.instance.Rd)&&t.FocusManager.oN()&&
a.endEditing(!1,20)}setFocus(a,b){this.Ute("SetFocus",a,b);const c=this.Vpf();c&&!c.isActive&&(a.name!==L.AppFrame.$Lj&&a.name!==L.AppFrame.N$i||b.name!==D.AFrame.SW||(c.Sud=!1),c.W2i())}onFocus(a,b){this.Ute("OnFocus",a,b);if(t.FocusManager.oN()&&(b=this.Vpf())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";z.a.Yi&&(a.startsWith(zi.a.J4b)&&(yh.GrippersManager.instance.y$b=!0),a.startsWith(zi.a.J4b)||a===D.AFrame.Shb||a===D.AFrame.cJh)&&(c=!1);c&&this.V2i(b,a)}}V2i(a,b){const c=a.editingView,f=
t.FocusManager.instance();f.Sie=!0;a.rS();1===c.mode&&3!==w.AFrameworkApplication.Qa.mode&&b===D.AFrame.Shb&&(a.Nb.Qpa.O9d(),c.alb());f.Sie=!1}Ute(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);Uj.a.instance.Hw&&ha.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static FOf(a){const b=new Rv(()=>a),c=a.$I,f=t.FocusManager.instance();
f.Ic(c).vCa(Object(H.a)(b,b.onBlur,"onBlur"));f.Ic(c).n8(Object(H.a)(b,b.setFocus,"setFocus"));f.Ic(c).Oca(Object(H.a)(b,b.onFocus,"onFocus"))}}Object(m.a)(Rv,"InteractiveViewFocusScopeActions",null,[]);class ID extends Rv{constructor(a){super(()=>a);this.Eb=a}DPk(){this.Eb.isActive||this.Eb.A2i()}static uJi(a,b){const c=new ID(a);a=a.$I;b.Ic(a).vCa(Object(H.a)(c,c.onBlur,"onBlur"));b.Ic(a).n8(Object(H.a)(c,c.DPk,"pageViewSetFocus"));b.Ic(a).Oca(Object(H.a)(c,c.onFocus,"onFocus"))}}Object(m.a)(ID,
"PageViewInteractiveViewFocusScopeActions",Rv,[]);class Iz{constructor(){this.Da=this.K=null;this.eMg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Xb(a){this.K=a;this.Da=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Da.Xng&&a.register(379,"PowerPointWebEditor.IPageHiddenMeter").na().oa(()=>new fL);Iz.RIi(this.K);a.register(FD,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").na().oa(()=>
new FD);a.register(GD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").na().oa(()=>new GD);a.register(380,"Common.IColorTable").na().oa(()=>new $K);a.register(Gz,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").na().oa(()=>new Gz(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new vb.a(()=>Fb.a.instance.Ia("Common.IRenameProps"))));a.register(381,"PowerPointWebEditor.IDocNotifyClient").na().oa(()=>new yD(this.Da,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Da.yg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,y,G)=>{a.resolve("PowerPointWebEditor.IPPTWebService").yfe(c,f,l,y,G)},!1));a.register(382,"PowerPointWebEditor.IPodsDocNotifyClient").na().oa(()=>new yD(this.Da,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,y,G,R,ja,za)=>{a.resolve("PowerPointWebEditor.IPopWebService").FXc(b,c,f,l,y,G,R,ja,za)},!0));a.register(383,"PowerPointWebEditor.IContentTimeStampManager").na().oa(()=>new YK);a.register(Qv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").na().oa(()=>new Qv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Da.yg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Da.RVe,this.Da.podsPushThumbnailImageIds));a.register(xD,"PowerPointWebEditor.CoauthNotificationManager").na().oa(()=>new xD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Da.yg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ia("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Da,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Zx,"PowerPointWebEditor.PresenceLoader").na().oa(()=>new Zx(this.Da,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(aL,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").na();
a.register(384,"PowerpointPresence.IPresenceColorProvider").na().oa(()=>new DR.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").c5j,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(385,"PowerpointPresence.IPresencePerfLogger").na().oa(()=>new cL(a.rb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(BD,"PowerpointPresence.RtcParams").na().oa(()=>new BD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").AD,a.resolve("PowerPointWebEditor.IApplicationContext").Jdg(),a.Ia("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").uc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(386,"PowerPointWebEditor.ISessionTimeoutIndicator").na().oa(()=>
new jL(a.resolve("Common.IActionManager")));a.register(387,"PowerPointWebEditor.ISignalRLoadCompletedListener").na().oa(()=>new kL);a.register(vD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").na().oa(()=>new vD(this.Da,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ia("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ia("PowerPointWebEditor.ICommentSessionManager")));a.register(uD,"PowerPointWebEditor.SessionCleanupHandler").na().oa(()=>new uD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(388,"Common.IProcessInputStrategy").na().oa(()=>new lt(a.resolve("Common.IActionManager"),this.Da,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Da.Xn||a.register(bL.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").na().oa(()=>
new bL.a);a.register(389,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").na().oa(()=>new eL(this.Da.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Da.Vsg));a.register(390,"Box4.TextMetricsApi.ITextMetricsHelper").na().oa(()=>new Y);a.register(391,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").na().oa(()=>new ZK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),w.AFrameworkApplication.isRtl,this.Da.dtg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Da.fD,this.Da.Dqe));a.register(392,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").na().oa(()=>
new iL(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(393,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").na().oa(()=>
new hL(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(ED,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").na().oa(()=>
new ED);a.register(CD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").na().oa(()=>new CD);a.register(HD,"PowerPointWebEditor.DelayLoadedPackageInitializer").na().oa(()=>{let b=2;const c=Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:ya.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new HD(Fb.a.instance.resolve("Common.ITaskManager"),
Fb.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),Fb.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(394,"PowerpointPresence.IPresencePrepCacheParser").na().oa(()=>new dL(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(395,"PowerPointWebEditor.ISorterViewActorMain").oa(()=>new Hz(w.AFrameworkApplication.Qa,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").pse,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ia("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Xn)).na();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&Jg.a.instance.$b("FirstExtJsExecTime",a);a=new BB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Ala&&this.y$g();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").MFa(()=>{this.K.resolve("Common.ITaskManager").Hb(new pd.a(0,1,0,Object(H.a)(this,this.qFk,"onBootComplete_DelayExecuted"),90,"21"))});this.Da.Xng&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");ID.uJi(b,this.K.resolve("Common.IFocusManager"));b.WNi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").qGk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}y$g(){const a=new BB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.eMg=!0;qd.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").f1a(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}mMj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}Goi(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.HVd("WACDocumentPanelContent","Horizontal"),this.HVd("EditingThumbnailsPanel","Horizontal"),this.HVd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}HVd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}jne(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new pf.GraphTransaction(2);
try{b.ld(a),a.sea(16)}finally{b&&b.dispose()}}}Qdc(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.sW(()=>{c&&c.A6(b+"DownloadFinished")});Nv.a.py(a)}Bck(){if(this.Da.rxc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.comment",null,()=>d.e(9).then(d.bind(null,1299)));else{const a=Tx.a.create("pptedit.comment",null,()=>d.e(9).then(d.bind(null,1299)));this.Qdc(a,"comment")}}Ack(){if(this.Da.rxc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1296)));else{const a=Tx.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1296)));this.Qdc(a,"chronosslim")}}qFk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.eMg||this.y$g();this.mMj();this.Goi();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Da.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda(this.K.resolve("PowerPointWebEditor.PresenceLoader").BCl,(f,l)=>{Sc.App.$tg()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").$3c=l.succeeded)},null);const b=()=>{ya.a.J(512360582,809,50,"Start to download chronos.js file");this.Bck();this.Ack();this.Da.gGh||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").xte()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Kng(()=>{b()})};(new Ar.a(this.Da.Haa)).e6j?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").Ixg().continueWith(()=>{this.jne()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").j9e();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.A6("ChronosStartDownloadTime");try{if(this.Da.wacAirSpaceResourceLink){const f=hh.a.qvb("wacairspaceanimationlibrary.js"),l=eD.a.create(f,null,null);Nv.a.py(l)}}catch(f){ya.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Da.yg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").TRj();
w.AFrameworkApplication.fa.$e(()=>{uR.a.instance.YCi()});MSOJS.ClientUtils.InitUrls(w.AFrameworkApplication.Lhl,w.AFrameworkApplication.Jhl,w.AFrameworkApplication.Khl)}static main(){w.AFrameworkApplication.Yg&&z.a.mg?ya.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):n.a.instance.Ac(new Iz)}static RIi(a){a.register(396,"PowerPointWebEditor.IPrefetchManager").na().oa(()=>new iq(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").zd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(m.a)(Iz,"CoreExtPackage",null,[2,3]);class lL{constructor(){this.d8c=this.tf=this.Rc=this.ob=null;this.va=new Wc.a;this.Ab=!1}init(a,b){this.tf=a;this.Rc=b;this.tB()}dispose(){this.ob&&(this.visible=!1,this.Rc.Bb(pa.a.click,
this.ob,Object(H.a)(this,this.PJa,"onBackgroundClick")),this.tf&&this.ob&&(this.tf.removeChild(this.ob),this.ob=null),this.va&&(this.va.dispose(),this.va=null))}tB(){this.ob=document.createElement("div");this.ob.className="EditingNotesDefaultView";w.AFrameworkApplication.isRtl&&(this.ob.style.direction=qe.a.k2a);this.tf.appendChild(this.ob);this.d8c=document.createElement("p");this.d8c.className="EditingNotesDefaultViewContent";this.d8c.innerText=ResourceStrings.l_ClickToAddNotes;this.ob.appendChild(this.d8c);
this.Rc.ub(pa.a.click,this.ob,Object(H.a)(this,this.PJa,"onBackgroundClick"))}PJa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}RAf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Ab}set visible(a){this.Ab=a;this.ob.style.display=a?Ui.a.block:Ui.a.none}get xa(){return this.ob}}Object(m.a)(lL,"NotesPromptView",null,[942,943,108]);class mL{constructor(a){this.tdd=this.tf=this.ob=null;this.l$c=this.Ab=!1;this.eok=a}init(a,b){b.BBb&&(this.tf=a,this.ob=document.createElement("div"),
this.ob.className="EditingNotesReadOnlyView",this.eok&&(this.ob.style.direction=qe.a.k2a),this.tf.appendChild(this.ob),this.tdd=document.createElement("div"),this.tdd.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.Eid,b=jSanity.sanitize(a),this.tdd.appendChild(b),this.ob.appendChild(this.tdd),this.l$c=!0)}dispose(){this.l$c&&(this.visible=!1,this.tf&&this.ob&&(this.tf.removeChild(this.ob),this.ob=null),this.l$c=!1)}get visible(){return this.Ab}set visible(a){this.l$c&&(this.Ab=a,
this.ob.style.display=a?Ui.a.block:Ui.a.none)}get xa(){return this.ob}}Object(m.a)(mL,"NotesReadOnlyView",null,[941,108]);var Jz=d(499),JD=d(654);class tr extends Jz.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd){super(a,b);this.YFb=this.ng=this.xh=this.Sfb=null;this.hYa=!1;this.kwa=Sc.App.tn;this.qIa=Object(sa.a)(302,b);this.ob=this.Od.container;this.jc(this.ob);this.Rc=c;this.Fa=f;this.Hgb=l;this.JGb=za;this.om=y;this.ei=G;this.Xs=R;this.SJ=ja;this.jb=Va;this.Gdb=hb;this.C$=
Object(sa.a)(423,a);this.Kgc=Cb;this.pc=lc;this.RFe=ic;this.Fwa=yc;this.ZJ=ec;this.le=jc;this.Scd=xd;this.Wp=Xd;this.D9c=this.le.qk("formatpaintertext.cur");this.Wp&&this.ZJ.QUd(Object(H.a)(this,this.Wnc,"onTextFPActiveChanged"));this.xh||this.tB()}dispose(){this.Rc.Bb(pa.a.click,this.ob.parentNode,Object(H.a)(this,this.PJa,"onBackgroundClick"));this.Wp&&this.ZJ.yXe(Object(H.a)(this,this.Wnc,"onTextFPActiveChanged"));this.Hgb&&(this.Hgb.dispose(),this.Hgb=null);this.JGb&&(this.JGb.dispose(),this.JGb=
null);super.dispose()}az(a){super.az(a);this.yxc()}Dba(a){this.kE(this.ng,a,-1)}m7(){this.zvd()}tB(){this.Scd&&(this.YFb=this.Od.createElement("div"),this.YFb.className="NotesResizeHandle",rf.c(this.YFb,!0),Sys.UI.DomElement.addCssClass(this.YFb,"NotesResizeHandle"),this.htmlElement.appendChild(this.YFb),this.hp(this.YFb));this.Sfb=this.Od.createElement("div");this.Sfb.className="NotesContentContainer";this.Sfb.id="NotesContentContainer";this.hp(this.Sfb);this.htmlElement.appendChild(this.Sfb);this.xh=
this.Od.createElement("div");Sys.UI.DomElement.addCssClass(this.xh,"NotesView");Sys.UI.DomElement.addCssClass(this.xh,"NotesEditViewVisible");this.Sfb.appendChild(this.xh);this.hp(this.xh);this.ng=this.Od.createElement("div");Sys.UI.DomElement.addCssClass(this.ng,"NotesViewContent");this.xh.appendChild(this.ng);this.hp(this.ng);w.AFrameworkApplication.isRtl&&(this.xh.style.direction=qe.a.k2a);this.Rc.ub(pa.a.click,this.ob.parentNode,Object(H.a)(this,this.PJa,"onBackgroundClick"));this.Hgb.init(this.ob.parentNode,
this.Rc);this.JGb.init(this.ob.parentNode,this.qIa);this.zvd();this.Hgb.RAf(Object(H.a)(this,this.uGk,"onDefaultViewClick"))}zvd(){if(this.qIa.BBb)this.fMa(!1),this.e4e(!1),this.HBl();else{var a=this.om.bqe(this.qIa);a=this.hYa||!a;this.fMa(a);this.e4e(!a);this.Wp&&this.kC(tr.dfa)}}Wnc(a,b){tr.dfa=b.uUc;this.kC(tr.dfa)}kC(a){const b=this.ob.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.ob.style.cursor=k.a.WN(this.D9c,Ui.a.aB),this.ng.style.cursor=k.a.WN(this.D9c,Ui.a.aB),
a=0;a<b.length;a++)if(b[a].style.cursor!==k.a.WN(this.D9c,Ui.a.aB))b[a].style.cursor=k.a.WN(this.D9c,Ui.a.rba);else break;else for(this.ob.style.cursor=Ui.a.aB,this.ng.style.cursor=Ui.a.aB,a=0;a<b.length;a++)b[a].style.cursor=Ui.a.rba}yxc(){this.htmlElement.style.zIndex="0";const a=this.om.pUa(this.qIa,this.Od.Nd),b=this.om.h8b(this.qIa,this.Od.Nd);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);tr.f1e(this.xh,b);tr.f1e(this.Hgb.xa,b);tr.f1e(this.JGb.xa,
b);this.Fwa.zlb(new cd.a(a.x,a.y),w.AFrameworkApplication.isRtl,this.xh,!0)}Nib(){this.hYa=!0;this.UU();this.startEditing()}Oib(){this.hYa=!1;this.UU();this.endEditing()}mJ(){return this.hYa}startEditing(){this.Bxa.BBb?this.jb.nj():(this.zvd(),this.fsg()||(this.kwa=this.Bxa.EGa,this.SJ.Xzh(this.qIa,!1),this.SJ.tZk(this.qIa)))}endEditing(){if(!this.Bxa.BBb&&(this.Gdb.setVisibility(!1),this.zvd(),!this.fsg())){this.z8g.endEditing(!0,14);this.Kgc.O6d(this.C$);var a=this.RFe.Nua(this.Bxa,this.kwa),b=
!!this.Bxa&&this.Bxa.isConnected;a&&(b&&this.Bxa.Wtd(),this.ei.I8a(this.Bxa),this.Xs.b_d());this.SJ.Xzh(this.qIa,b&&this.Bxa.d2c)}}uGk(a,b){this.PJa(b)}PJa(){this.Fa.wj(Si.a.D3,!0);this.fMa(!0);this.e4e(!1);this.z8g.rS();this.s4e();this.kwa=this.Bxa.EGa;return!0}fsg(){return!this.pc.Ho}get xa(){return this.htmlElement}get Bxa(){return this.qIa}get z8g(){return this.Qc}s4e(){this.Fba(!0)}HBl(){this.JGb.visible=!0}e4e(a){this.Hgb.visible=a}fMa(a){JD.b(a,this.Sfb,"NotesContentContainerHidden","NotesContentContainerVisible")}Fba(a){JD.b(a,
this.xh,"NotesEditViewHidden","NotesEditViewVisible")}static f1e(a,b){a&&(a.style.paddingTop=k.a.Pc(b[0]),a.style.paddingRight=k.a.Pc(b[1]),a.style.paddingBottom=k.a.Pc(b[2]),a.style.paddingLeft=k.a.Pc(b[3]))}static g3j(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}tr.dfa=0;Object(m.a)(tr,"NotesViewElement",Jz.a,[543,231]);var ls=d(393),ER=d(623),FR=d(854),nL=d(497),Kz=d(496);class oL extends Kz.a{constructor(a,b){super(a,b);this.afa=[];this.Ufc=0}fMb(a,...b){Array.addRange(this.afa,
b);this.Ufc=a}trc(){if(this.afa)for(const a of this.afa)this.ku.rrc(this.container,a,this.Ufc);this.ku.jK(this.container,this.X3)}txc(){this.ku.oF(this.container,this.X3);for(const a of this.afa)this.ku.oF(this.container,a)}}Object(m.a)(oL,"NotesViewDomManager",Kz.a,[]);var Lz=d(562);class pL extends Lz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.pa=b}Qvb(){return[Object(H.a)(this,this.Inc,"onSetup"),Object(H.a)(this,this.fnc,"onEnsurePageViewElementsCreated"),Object(H.a)(this,this.gnc,
"onEnsureSelectedContentViewElementsCreated"),Object(H.a)(this,this.unc,"onMainLoop"),Object(H.a)(this,this.IJk,"onNotesContentSelect"),Object(H.a)(this,this.bnc,"onCommit"),Object(H.a)(this,this.Vnc,"onTearDown")]}IJk(a,b){this.Oga(b);a=Object(sa.a)(302,this.Eh.Ag);if(!a)return!0;a=Object(sa.a)(543,a.qc(this.Eh.Na));if(!a)return!0;this.pa.Lla()?a.mJ()||a.Nib():a.mJ()&&a.Oib();return!0}}Object(m.a)(pL,"NotesViewSelectionChangedHandler",Lz.ViewSelectionChangedHandler,[]);class KD extends Pv.DragSelectionDragAdapter{constructor(a,
b,c,f,l,y){super(a,b,c);this.mq=f;this.zue=y;this.om=l}av(a){if(this.zue){var b=this.ixc(a);const c=b?b.gb:null;if(c){const f=this.om.hGa(c)?Object(sa.a)(302,c):this.om.Qyb(c);if(f&&this.om.bqe(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Nf.O2a(a.clientPoint,b,c,this.Nf,!1))&&jb.HyperlinkReader.Jla(b,!0))return!1}a=super.av(a);null!==this.mq&&a&&this.mq.bza(Ui.a.rba);return a}Fu(a){super.Fu(a);null!==this.mq&&this.mq.Eya()}vo(a){super.vo(a);null!==this.mq&&this.mq.Eya()}rJ(a){return this.Nf.isActive?
super.rJ(a):!1}static i8b(a){return new KD(a,Fb.a.instance.resolve("Common.IActionManagerExtended"),Fb.a.instance.resolve("Common.IActivityManager"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Fb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Fb.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(m.a)(KD,
"NotesDragSelectionDragAdapter",Pv.DragSelectionDragAdapter,[]);var Mz=d(236);class LD{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.XPg=this.Nic=this.$Dg=this.ZEe=this.cIa=0;this.eaa=this.Pfc=this.acd=null;this.Uec=this.kBg=this.Jbd=0;this.uxe=!1;this.C$=a;this.M0=b;this.oi=c;this.Rb=f;this.GA=l;this.Ig=y;this.ic=G;this.Kc=R;this.Fb=ja;za.PQa(Object(H.a)(this,this.znc,"onOutboundReplication"));this.ia=Va}Mv(a){return a&&a.OA!==Sys.UI.MouseButton.rightButton?tr.g3j(a.Bc):!1}av(a){if(!this.Mv(a))return!1;
this.uxe=!0;this.acd=this.GA.xa;if(!this.acd)return!1;this.eaa=this.Kc.Hc;if(this.eaa&&(this.Pfc=this.Ig.xa))this.$Dg=this.Pfc.clientHeight;else return!1;this.Jbd=Math.floor(.75*(this.acd.clientHeight+this.Pfc.clientHeight));this.ZEe=this.acd.clientHeight;this.Nic=this.cIa=a.clientPoint.y;this.XPg=this.eaa.$T;this.M0.Bl(7);this.C$.endEditing(!0,14);return!0}Sw(a){if(!a)return!1;this.cIa=a.clientPoint.y;a=this.rJf(this.cIa);this.GA.cga=a;this.Rb.Du();a=this.$Dg+this.ZEe-a;this.Pfc.style.height=a+"px";
this.eaa.xrl(a-1);this.eaa.Htl(this.XPg);return!0}vo(a){this.M0.T1();this.C$.rS();this.Uec=this.rJf(a?a.clientPoint.y:this.cIa);this.ia.Ja(ea.a.a1e,2,this.Uec)}Fu(){this.uxe&&(this.uxe=!1,this.vo(null))}znc(){this.Uec!==this.kBg&&2===Sc.App.Mb.mode&&(this.kBg=this.Uec,this.QOk(this.Uec))}QOk(a){const b=this.ic.yn,c=this.Fb.yd(4);try{c.jc(b),b.QIb=4320,b.cga=this.Syi(a)}finally{c&&c.dispose()}}rJf(a){a=this.ZEe+this.oi.vm(this.Nic-a);0<this.Jbd&&a>this.Jbd?a=this.Jbd:a<Mz.a.PSa&&a>Pd.a.CRc?a=Mz.a.PSa:
a<Pd.a.CRc&&(a=Pd.a.EXf);return a}Syi(a){return this.oi.MQe(a,1)}static i8b(a){return new LD(a,Fb.a.instance.resolve("Common.CursorManager"),Fb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),Fb.a.instance.resolve("Box4.IAppFrame"),Fb.a.instance.resolve("PowerPointWebEditor.INotesPane"),Fb.a.instance.resolve("PowerPointWebEditor.ISlidePane"),Fb.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Fb.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Fb.a.instance.resolve("Common.Transaction.ITransactionFactory"),
Fb.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Fb.a.instance.resolve("Common.IActionManagerExtended"))}}Object(m.a)(LD,"NotesResizeDragAdapter",null,[235]);class qL extends ls.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){super(Si.a.D3,a,b,c,f,l,G,R,hb);this.JCe=!1;this.rJa=y;this.pc=ja;this.$f=za;this.LO=Va;this.zue=Cb;this.Wp=lc}get FVd(){return w.AFrameworkApplication.fa}my(a,b=null){this.Wp&&this.$f.ub(pa.a.bK,this.container,Object(H.a)(this,this.Ghd,"mouseUpHandlerFilter"));
super.my(a,b);(a=Object(sa.a)(302,a))&&a.BBb&&this.Cg&&this.Cg.ho&&this.Cg.ho.setAttribute("aria-readonly","true")}detach(){this.Wp&&this.Go&&this.$f.Bb(pa.a.bK,this.container,Object(H.a)(this,this.Ghd,"mouseUpHandlerFilter"));super.detach()}i1b(a,b){return new oL(a,b)}pea(a){a=super.pea(a);a.X3=KD.i8b(this);a.fMb(1,LD.i8b(this));return a}Aib(a){this.HDc=a.kg;if(!this.erc||this.isActive||!this.zue||(a.nc.type===pa.a.mouseDown||a.nc.type===pa.a.sRa)&&a.OA!==Sys.UI.MouseButton.leftButton)return!1;var b=
a.Bc;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;ls.a.F8&&(c=ls.a.F8.dta());Sc.App.eE.rT&&Sc.App.eE.rT.hZe(f=>{f&&(c=!0)});b=!qd.a("DeprecateIE.NotesView")&&c&&z.a.tX;a=new ER.a(a,this,!0,b);this.TYk(a);return!1}TYk(a){this.SRe();this.L6(z.a.mg||z.a.VVa);this.Ir.raiseEvent(ls.a.K0c,new FR.a(a.graphNode));this.iUc(a.graphNode);this.ibf();const b=[Object(H.a)(this,this.ELe,"noneClickHandler"),Object(H.a)(this,this.bDk,"notesSnapToContentClickHandler"),Object(H.a)(this,
this.XCk,"notesDefaultClickHandler")];for(const c of b)if(c(a).v4){this.JCe=!0;break}}Ghd(){return this.JCe&&this.LO.yWa?(this.Ca.processAction(C.a.Dka,2),!0):this.JCe=!1}XCk(a){const b=ls.a.Xc.eq(C.a.gvb);b.properties.$(Jf.a.source,"DefaultClickHandler");this.i7(a.yV,a.ns,a.graphNode,a.Qc,a.Fj.shiftKey,a.Fj.ctrlKey,a.Fj.kg);b.end();a.Cxb&&this.L6(!0);this.editingView.odb(a.Fj.shiftKey,a.yV,a.Fj.kg);return Vh.a.jm(!0)}bDk(a){if(!a.ns){const b=a.ns,c=a.graphNode,f=ls.a.Xc.eq(C.a.gvb);f.properties.$(Jf.a.source,
"SnapToContentClickHandler");this.i7(a.yV,b,c,this,a.Fj.shiftKey,a.Fj.ctrlKey,a.Fj.kg);f.end();a.Cxb&&this.L6(!0);this.editingView.odb(a.Fj.shiftKey,a.yV,a.Fj.kg);return Vh.a.jm(!0)}return Vh.a.notHandled}koa(){super.koa();this.Cg&&this.Cg.ho&&(this.FVd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Cg.otc(Ne.a.fLc):this.Cg.e0e(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Ne.a.fLc),this.Cg.ho.setAttribute(Ne.a.fr,ResourceStrings.l_NotesPane))}Hwd(){this.zF.Rd===this&&
this.suspend()}$qd(){this.zF.Rd===this&&this.resume()}WXc(){return new pL(this,Fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}pVc(){return[Object(H.a)(this,this.ELe,"noneClickHandler"),Object(H.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(H.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(H.a)(this,this.defaultClickHandler,"defaultClickHandler")]}YVc(){return[Object(H.a)(this,this.ELe,"noneClickHandler"),Object(H.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}ELe(a){return this.CBb(a)||this.h3j()?Vh.a.jm(!0):Vh.a.notHandled}LVc(){return[Object(H.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(H.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(H.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}oza(a){this.CBb(a)||super.oza(a)}noContextMenuHandler(a){return this.CBb(a)?gn.a.jm(null):gn.a.notHandled}CBb(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.BBb}h3j(){return!this.pc.Ho}Fab(){return nL.a.rKe}get ZF(){return super.ZF|96}get SOb(){return!0}p7(a,b,c=null){this.rJa.CY(this)&&super.p7(a,b,c)}}Object(m.a)(qL,"NotesView",ls.a,[378,493,177,172,108,423,494,495,496,497]);var rL=d(498),Nz=d(202);class MD{constructor(a,b,c,f){this.pPg=null;this.swa=a;this.ua=b;this.Vq=c;this.XAe=f}jSj(){this.pPg=new rL.a(Nz.App.p7a.$Ck,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.swa.QCa(this.pPg.sAa);Rv.FOf(this.swa);
this.rFf(this.ua.Ba);this.Vq.Whi(Object(H.a)(this,this.h$g,"onAttachNotesView"))}h$g(a,b){this.x2i();this.rFf(b.$c)}rFf(a){this.ua.presentation&&a&&a.isConnected&&(a=this.XAe.Y8f(a,27),this.swa.my(a))}x2i(){this.swa.Go&&(this.swa.editingView.disable(!0,14),this.swa.detach())}dispose(){this.Vq.Hal(Object(H.a)(this,this.h$g,"onAttachNotesView"))}}Object(m.a)(MD,"NotesViewHelper",null,[108]);class ND{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Xb(a){this.K=a;this.K.register(378,
"PowerPointWebEditor.INotesView").na().oa(()=>new qL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ia("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(MD,"PowerPointWebEditor.Notes.NotesViewHelper").na().oa(()=>new MD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new km.a((a,b)=>Object(Sa.a)(378,a)?new tr(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new lL,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new mL(w.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").cjh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").jSj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){n.a.instance.Ac(new ND)}}Object(m.a)(ND,"PPTWebEditorNotesPackage",null,[2,3]);class OD extends Pv.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.mq=f}av(a){a=super.av(a);null!==this.mq&&a&&this.mq.bza(Ui.a.rba);return a}Fu(a){super.Fu(a);null!==this.mq&&this.mq.Eya()}vo(a){super.vo(a);null!==this.mq&&this.mq.Eya()}rJ(a){return this.Nf.isActive?super.rJ(a):!1}static i8b(a){return new OD(a,Fb.a.instance.resolve("Common.IActionManagerExtended"),Fb.a.instance.resolve("Common.IActivityManager"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?Fb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(m.a)(OD,"SmartArtTextViewDragSelectionDragAdapter",Pv.DragSelectionDragAdapter,[]);class sL extends Kz.a{constructor(a,b){super(a,b);this.afa=[];this.Ufc=0}fMb(a,...b){Array.addRange(this.afa,b);this.Ufc=a}trc(){if(this.afa)for(const a of this.afa)this.ku.rrc(this.container,a,this.Ufc);this.ku.jK(this.container,this.X3)}txc(){this.ku.oF(this.container,this.X3);for(const a of this.afa)this.ku.oF(this.container,a)}}Object(m.a)(sL,"SmartArtTextViewDomManager",Kz.a,[]);class tL extends Lz.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.pa=b;this.We=c;this.dP=f}Qvb(){return[Object(H.a)(this,this.Inc,"onSetup"),Object(H.a)(this,this.fnc,"onEnsurePageViewElementsCreated"),Object(H.a)(this,this.gnc,"onEnsureSelectedContentViewElementsCreated"),Object(H.a)(this,this.unc,"onMainLoop"),Object(H.a)(this,this.BMk,"onSmartArtContentSelect"),Object(H.a)(this,this.bnc,"onCommit"),Object(H.a)(this,this.Vnc,"onTearDown")]}BMk(a,b){this.Oga(b);b=Object(sa.a)(4,this.Eh.Ag);if(!b)return!1;a=Object(sa.a)(492,b.qc(this.Eh.Na));
b=Object(sa.a)(117,b.qc(this.We));if(!a)return!1;this.pa.rWa()?a.mJ()||(a.Nib(),this.dP.Zp(!0),b&&b.Nib()):a.mJ()&&(a.Oib(),this.dP.Zp(!1),b&&b.Oib());return!0}}Object(m.a)(tL,"SmartArtTextViewSelectionChangedHandler",Lz.ViewSelectionChangedHandler,[]);class uL extends ls.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){super(xa.a.nS,a,c,f,l,G,ja,za,Va);this.rJa=R;this.pa=b;this.Pq=y;this.We=hb;this.dP=Cb;this.Fa=lc;this.Nd.Raf=!0;this.Nd.S9d=!1}get FVd(){return w.AFrameworkApplication.fa}i1b(a,b){return new sL(a,
b)}pea(a){a=super.pea(a);a.X3=OD.i8b(this);return a}koa(){super.koa();this.Cg&&this.Cg.ho&&(this.FVd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.Cg.otc(Ne.a.fLc):this.Cg.e0e(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Ne.a.fLc),this.Cg.ho.setAttribute(Ne.a.fr,ResourceStrings.l_SmartArtTextPane))}Hwd(){this.zF.Rd===this&&this.suspend()}$qd(){this.zF.Rd===this&&this.resume()}WXc(){return new tL(this,
Fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.We,this.dP)}$ub(){this.zF.Rd===this&&this.pa.QZd();return!1}pVc(){return[Object(H.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(H.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(H.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(H.a)(this,this.defaultClickHandler,"defaultClickHandler")]}YVc(){return[Object(H.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}LVc(){return[Object(H.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(H.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.wj(xa.a.nS,!0);return a}Fab(){return nL.a.rKe}get ZF(){let a=super.ZF;return a=qd.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get SOb(){return!0}p7(a,b,c=null){this.rJa.CY(this)&&super.p7(a,b,c)}Nsl(a){const b=this.Pq.ke(2);try{b.ld(a);let c=null;c=Vd.SelectionFactory.Ej(a,!0);
this.setSelection(c)}finally{b&&b.dispose()}}}Object(m.a)(uL,"SmartArtTextView",ls.a,[376,493,177,172,108,423,494,495,496,497]);class vL extends Jz.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va){super(a,b);this.ng=this.xh=null;this.hYa=!1;this.kwa=Sc.App.tn;this.ffd=b;this.ob=this.Od.container;this.jc(this.ob);this.Rc=c;this.Fa=f;this.ia=l;this.ei=y;this.Xs=G;this.SJ=R;this.Gdb=ja;this.C$=a;this.Kgc=za;this.od=Va;this.tB()}dispose(){this.Rc.Bb(pa.a.click,this.ob.parentNode,Object(H.a)(this,this.PJa,"onBackgroundClick"));
this.od.Ocl(Object(H.a)(this,this.deh,"onSmartArtTextPaneWidthChanged"));super.dispose()}az(a){super.az(a)}Dba(a){this.kE(this.ng,a,-1)}m7(){this.fMa(!0)}tB(){this.xh=this.Od.createElement("div");Sys.UI.DomElement.addCssClass(this.xh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.xh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.xh);this.hp(this.xh);this.ng=this.Od.createElement("div");Sys.UI.DomElement.addCssClass(this.ng,"SmartArtTextViewContent");this.ng.style.width=k.a.Pc(Pd.a.Yuc-
2*Pd.a.tPb-2*Pd.a.U4e-Pd.a.uGh);this.xh.appendChild(this.ng);this.hp(this.ng);w.AFrameworkApplication.isRtl&&(this.xh.style.direction=qe.a.k2a);this.fMa(!0);this.Rc.ub(pa.a.click,this.ob.parentNode,Object(H.a)(this,this.PJa,"onBackgroundClick"));this.od.sli(Object(H.a)(this,this.deh,"onSmartArtTextPaneWidthChanged"))}Nib(){this.hYa=!0;this.UU();this.startEditing()}Oib(){this.hYa=!1;this.UU();this.endEditing()}mJ(){return this.hYa}startEditing(){this.fMa(!0);this.kwa=this.b2a.EGa;this.SJ.xtc(this.ffd,
!1);this.SJ.Gnd(this.ffd)}endEditing(){this.Gdb.setVisibility(!1);this.fMa(!0);this.wGh.endEditing(!0,14);this.Kgc.O6d(this.C$);const a=new ww.a(this.b2a,this.kwa);this.ia.Ja(ea.a.Gjb,2,a);const b=!!this.b2a&&this.b2a.isConnected;a.Nua&&(b&&this.b2a.Wtd(),this.ei.I8a(this.b2a),this.Xs.b_d());this.SJ.xtc(this.ffd,b&&this.b2a.d2c)}PJa(){this.Fa.wj(xa.a.nS,!0);this.wGh.rS();this.fMa(!0);this.kwa=this.b2a.EGa;return!0}get xa(){return this.htmlElement}get b2a(){return this.ffd}get wGh(){return this.Qc}fMa(a){JD.b(a,
this.xh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}deh(a,b){this.ng.style.width=k.a.Pc(k.a.Sn(b.width))}}Object(m.a)(vL,"SmartArtTextViewElement",Jz.a,[492,231]);class wL{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.o1g=this.Sdb=null;this.dP=a;this.ZIa=b;this.od=c;this.Fa=f;this.Xs=l;this.IM=y;this.pa=G;this.Eb=Object(sa.a)(423,R);this.Vq=ja;this.Gg=za;this.pc=Va;this.Z0=hb}NSj(){this.o1g=new rL.a(this.dP.GXf,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.ZIa.QCa(this.o1g.sAa);Rv.FOf(this.ZIa);this.od.jli(Object(H.a)(this,this.Ldh,"onSingleSmartArtShapeViewElementSelected"));this.od.kli(Object(H.a)(this,this.Mdh,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.od.rli(Object(H.a)(this,this.ceh,"onSmartArtShapeViewElementDeselected"));this.od.Z_b(Object(H.a)(this,this.Ukd,"onSlideHtmlUpdated"));this.od.dii(Object(H.a)(this,this.beh,"onSmartArtCommentsVisibilityChanged"));this.IM.p8(Object(H.a)(this,this.Jnc,"onShapeDisconneted"));
this.Vq.SJc(Object(H.a)(this,this.YU,"onFocusChanged"));this.Vq.NJc(Object(H.a)(this,this.YU,"onFocusChanged"));this.Eb.UQa((a,b)=>{this.Ukd(a,b)})}dva(){return!this.pc.Ho}n4e(a){if(this.Z0){if(this.dva()||a.doa)return}else if(this.dva())return;a&&a.Wf&&!a.get_smartArtModelId()&&a.isConnected?(ya.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.R4e||(this.Sdb!==a&&(this.Sdb=a,this.W6d(),this.sFf(a)),this.dP.raf(a),this.dP.Zp(!0))):ya.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}VBl(a){this.dva()||(a&&a.Wf&&!a.get_smartArtModelId()&&a.isConnected?(ya.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.R4e||(this.Sdb!==a&&(this.Sdb=a,this.W6d(),this.sFf(a)),this.Fa.wj(xa.a.nS,!0),this.Xs.Dw(),this.ZIa.Nsl(a),this.dP.raf(a),this.dP.Zp(!0))):ya.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}gWf(){this.dP.isVisible&&
(ya.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.dP.Zp(!1))}Ldh(a,b){this.dva()||this.n4e(b.shapeNode)}Mdh(a,b){this.dva()||this.VBl(b.shapeNode)}ceh(){this.dva()||this.gWf()}Ukd(){if(!this.dva()&&this.pa.dM()){const a=this.pa.cFa();ya.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.dP.raf(a)}}YU(a,b){this.dva()||(a=b.fib,a===xa.a.nS?this.Gg.hL(xa.a.nS):this.Gg.vbc(a)&&this.Gg.Eo(xa.a.nS))}sFf(a){a&&a.isConnected&&this.ZIa.my(a)}W6d(){this.ZIa.Go&&
(this.ZIa.editingView.disable(!0,14),this.ZIa.detach())}Jnc(a,b){this.dva()||b.node!==this.Sdb||(this.Sdb=null,this.W6d(),this.dP.Zp(!1))}beh(a,b){this.dva()||((a=b.xvl)?a.Wf&&this.n4e(a):(a=this.pa.cFa())?this.Sdb!==a&&this.n4e(a):this.gWf())}dispose(){this.od.Gcl(Object(H.a)(this,this.Ldh,"onSingleSmartArtShapeViewElementSelected"));this.od.Hcl(Object(H.a)(this,this.Mdh,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.od.Ncl(Object(H.a)(this,this.ceh,"onSmartArtShapeViewElementDeselected"));
this.od.Mal(Object(H.a)(this,this.beh,"onSmartArtCommentsVisibilityChanged"));this.IM.jLa(Object(H.a)(this,this.Jnc,"onShapeDisconneted"));this.Vq.nXe(Object(H.a)(this,this.YU,"onFocusChanged"));this.Vq.gqd(Object(H.a)(this,this.YU,"onFocusChanged"));this.od.Urh(Object(H.a)(this,this.Ukd,"onSlideHtmlUpdated"));this.Eb.Mrc((a,b)=>{this.Ukd(a,b)})}}Object(m.a)(wL,"SmartArtTextViewHelper",null,[377,108]);class PD{constructor(){this.K=null;this.DA=!1}get name(){return"PowerPointWebEditor.SmartArt"}Xb(a){this.K=
a;this.K.register(376,"PowerPointWebEditor.ISmartArtTextView").na().oa(()=>new uL(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Ia("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(377,"PowerPointWebEditor.ISmartArtTextViewHelper").na().oa(()=>new wL(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").zd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").gla))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.$e(()=>{if(this.DA=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new km.a((b,c)=>Object(Sa.a)(376,b)?(c=Object(sa.a)(4,c))&&c.Wf?new vL(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").NSj()})}dispose(){this.DA&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){n.a.instance.Ac(new PD)}}Object(m.a)(PD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class xL{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(m.a)(xL,"CT_WebTextListStyle",null,[]);var up=d(351);class yL{constructor(a){this.rma=a}s_(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,y=!!(f&64)&&!!c.lastRowField,G=!!(f&128)&&!!c.firstColField,R=!!(f&256)&&
!!c.lastColField,ja=l&&G&&!!c.nwCellField,za=l&&R&&!!c.neCellField,Va=y&&G&&!!c.swCellField,hb=y&&R&&!!c.seCellField,Cb=!!(f&512)&&!!c.band1HField,lc=!!(f&512)&&!!c.band2HField,ic=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var yc=!b.ve,ec=b.eg===a.jV,jc=!b.oe;a=b.Tf===a.Dsa;var xd=1===b.ve%2===l;b=1===b.oe%2===G;var Xd=!(l&&yc)&&!(y&&ec),Qd=!(G&&jc)&&!(R&&a);c.wholeTblField&&this.apply(c.wholeTblField);Xd&&(Cb&&xd||lc&&!xd)&&(xd?this.apply(c.band1HField):this.apply(c.band2HField));
Qd&&(ic&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&R&&this.apply(c.lastColField);jc&&G&&this.apply(c.firstColField);ec&&y&&(this.apply(c.lastRowField),a&&hb&&this.apply(c.seCellField),jc&&Va&&this.apply(c.swCellField));yc&&l&&(this.apply(c.firstRowField),a&&za&&this.apply(c.neCellField),jc&&ja&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=kh.a(b);Hf.Box4ColorHelper.dcb(a)||(up.g(this.rma),this.rma.solidFillField=new cv.a,Hf.Box4ColorHelper.Moi(this.rma.solidFillField,
a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.rma;0===b||1===b?(f.latinField=jf.Svb(b,0),f.eaField=jf.Svb(b,1),f.csField=jf.Svb(b,2)):ya.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.rma.latinField=b.latinField),null!==b.eaField&&(this.rma.eaField=b.eaField),null!==b.csField&&(this.rma.csField=b.csField));if(0===a||1===a)this.rma.bFieldSpecified=
!0,this.rma.bField=0===a;if(0===c||1===c)this.rma.iFieldSpecified=!0,this.rma.iField=0===c}}}Object(m.a)(yL,"CellTextStylePartApplier",null,[]);class mt{constructor(a){this.U2g=a}get value(){return this.U2g.valField/1E5}set value(a){this.U2g.valField=Math.floor(1E5*a)}get type(){return mt.C1b}}mt.C1b="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(mt,"LineSpacingPercent",null,[672,673]);class ur{constructor(a){this.V2g=a}get value(){return this.V2g.valField/
100}set value(a){this.V2g.valField=Math.floor(100*a)}get type(){return ur.C1b}}ur.C1b="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(m.a)(ur,"LineSpacingPoint",null,[672,673]);class GR{constructor(){this.valField=0}}Object(m.a)(GR,"CT_TextSpacingPoint",null,[]);class nt{constructor(a){this.Wve=a}get lineSpacing(){return this.Wve}get value(){return this.Wve.value}set value(a){this.Wve.value=a}static I3b(a){if(a.__type===mt.C1b)return new nt(new mt(a));if(a.__type===
ur.C1b)return new nt(new ur(a));ya.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(m.a)(nt,"LineSpacingWrapper",null,[]);const zL=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},AL=
(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},HR=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class $x{constructor(){this.Vub=Array($x.LLh);this.KPe=Array($x.LLh)}}$x.LLh=9;Object(m.a)($x,"TextListStyleCache",null,[]);class BL{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(m.a)(BL,"NumberingData",null,[]);class Sv{}Sv.gYd="\u2022";Sv.hwi="p";Sv.iwi="n";Object(m.a)(Sv,"ListFormats",null,[]);class CL{constructor(a,b,c,f){this.Z3g=this.$3g=Sc.App.tn;this.jBg=null;this.lc=a;this.om=b;this.DM=c;this.EA=f}get caches(){return this.jBg||
(this.jBg={})}L6f(a,b,c){const f=c-1;let l=a.A0;var y;const G=!!l&&!ia.a.nil.equals(l[f]);if(G&&(y=this.caches[l[f].toString()]))return y=y.clone(),b=ia.a.create(),a.Nh.YE(y,b),y;if(!G)if(l)l=Array.clone(l);else for(l=Array(9),y=0;y<l.length;y++)l[y]=ia.a.nil;const R=G?l[f]:ia.a.create();y=this.dHi(a,b,c);l[f]=R;this.caches[R.toString()]=y;G||(a.A0=l);a.Nh.YE(y,R);G&&(y=y.clone(),a.Nh.YE(y,ia.a.create()));return y}dHi(a,b,c){const f=Ap.a.instance.createInstance(131073);if(b){var l=b.A6f(a.rowIndex,
a.Ai,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?zL(b,c):null)||new Ms;if(l){var y=c-1;c=l.Vub[y];y=l.KPe[y];if(c||y){l=b.defRPrField||new er;if(y){const G=Nd.a(Nd.c(y));y=G;b.algnFieldSpecified&&(y.algnFieldSpecified=!0,y.algnField=b.algnField);b.indentFieldSpecified&&(y.indentFieldSpecified=!0,y.indentField=b.indentField);b.lvlFieldSpecified&&(y.lvlFieldSpecified=!0,y.lvlField=b.lvlField);b.marLFieldSpecified&&(y.marLFieldSpecified=!0,y.marLField=b.marLField);b.marRFieldSpecified&&(y.marRFieldSpecified=
!0,y.marRField=b.marRField);b.rtlFieldSpecified&&(y.rtlFieldSpecified=!0,y.rtlField=b.rtlField);b.buAutoNumField&&(y.buAutoNumField=b.buAutoNumField);b.buCharField&&(y.buCharField=b.buCharField);b.buClrField&&(y.buClrField=b.buClrField);b.buClrTxField&&(y.buClrTxField=b.buClrTxField);b.buFontField&&(y.buFontField=b.buFontField);b.buFontTxField&&(y.buFontTxField=b.buFontTxField);b.buNoneField&&(y.buNoneField=b.buNoneField);b.buSzPctField&&(y.buSzPctField=b.buSzPctField);b.buSzPtsField&&(y.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(y.buSzTxField=b.buSzTxField);b.defRPrField&&(y.defRPrField=b.defRPrField);b.lnSpcField&&(y.lnSpcField=b.lnSpcField);b.spcAftField&&(y.spcAftField=b.spcAftField);b.spcBefField&&(y.spcBefField=b.spcBefField);b=G}c&&(c=Nd.a(Nd.c(c)),AL(c,l),b.defRPrField=c)}}a=Object(sa.a)(115,this.lc.jg(a));this.kHi(f,b,a?a.Fd:null)}f.Ae(va.a.fac,!0);return f}kHi(a,b,c){this.jHi(a,b);if(b){if(b.algnFieldSpecified){var f=HR(b.algnField);a.setValue(Ya.a.Vl,f);a.setValue(Ya.a.CJ,f)}b.marLFieldSpecified&&
a.Ae(sb.a.um,Oe.a.Owb(b.marLField));b.marRFieldSpecified&&a.Ae(sb.a.QY,Oe.a.Owb(b.marRField));b.indentFieldSpecified&&a.Ae(sb.a.xo,Oe.a.Owb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(sb.a.hwb,Oe.a.Owb(b.defTabSzField));b.spcAftField&&(f=nt.I3b(b.spcAftField.itemField),Object(Sa.a)(mt,f.lineSpacing)?a.setValue(va.a.bma,2):Object(Sa.a)(ur,f.lineSpacing)&&a.setValue(va.a.bma,4),a.setValue(va.a.Gea,f.value));b.spcBefField&&(f=nt.I3b(b.spcBefField.itemField),Object(Sa.a)(mt,f.lineSpacing)?a.setValue(va.a.cma,
2):Object(Sa.a)(ur,f.lineSpacing)&&a.setValue(va.a.cma,4),a.setValue(va.a.Hea,f.value));b.lnSpcField&&(f=nt.I3b(b.lnSpcField.itemField),Object(Sa.a)(mt,f.lineSpacing)?a.setValue(va.a.CX,2):Object(Sa.a)(ur,f.lineSpacing)&&a.setValue(va.a.CX,4),a.setValue(va.a.Jx,f.value))}else ya.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Wm.eHi(a,b.defRPrField,c)}tfl(a){if(a=a.A0)for(let b=0;b<a.length;b++){const c=a[b];c&&!ia.a.nil.equals(c)&&
delete this.caches[c.toString()]}}jHi(a,b){var c=this.Hv(b);a.oy(c.propertySet);b.marLFieldSpecified&&a.setValue(sb.a.um,Oe.a.Owb(b.marLField));b.indentFieldSpecified&&a.setValue(sb.a.xo,Oe.a.Owb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(Ya.a.fontSize,Wm.xPf(b.defRPrField.szField));b.spcAftField&&(c=nt.I3b(b.spcAftField.itemField),Object(Sa.a)(ur,c.lineSpacing)&&(a.setValue(va.a.bma,4),a.setValue(va.a.Gea,c.value)));b.spcBefField&&(b=nt.I3b(b.spcBefField.itemField),
Object(Sa.a)(ur,b.lineSpacing)&&(a.setValue(va.a.cma,4),a.setValue(va.a.Hea,b.value)))}Hv(a){let b;({que:b,Ohk:c}=this.rce(a));var c=cb.a.SN(b,c);0===b&&(c.VA=c.AX=a.buAutoNumField.startAtField);return c}rce(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Sv.hwi:case Sv.iwi:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{que:b,Ohk:c}}validate(a){if(Object(sa.a)(Ig.a,a)&&(this.om.hGa(a)||uj.OutlineReader.wX(a))&&a.isConnected){this.$3g=new Date;var b=Array(mp.a.A8);for(var c=0;c<mp.a.A8;++c)b[c]=new BL;c=-1;var f=0,l=!1;a=He.a.gA(a);for(a.wm(Object(H.a)(this,this.kck,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.P0c(b,0),this.hne(b,0,0));if(11!==a.iterator.currentNode.type)continue;const y=a.iterator,G=this.Wda(y);let R=b[G].nextListId,
ja=null;if(Bb.ListReader.Hk(y)){this.EA.Yna(y);ja=this.EA.kce(y);const za=this.eej(y);y.Cc();if(!ja){cc.a.instance.Yb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===ja.listType){if(ja.VA!==Ba.a.ex&&b[G].restartInfo!==ja.VA||ja.listStyle!==b[G].listStyle||za!==b[G].autonumberBulletType)l=!0,b[G].restartInfo=b[G].nextNumber=ja.VA===Ba.a.ex?1:ja.VA,R=b[G].nextListId=0,b[G].listStyle=ja.listStyle,b[G].autonumberBulletType=za;ja.AX=b[G].nextNumber;c!==G||l?(ja.nka=b[G].nextNumber,
l=!1):ja.nka=Ba.a.ex;this.DM.isEmpty(y,!1)?l=!0:b[G].nextNumber++}else 1!==ja.listType&&cc.a.instance.Yb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});R||(R=b[G].nextListId=++f);y.currentNode.listID=R}c=G;ja?(0===ja.listType?this.P0c(b,G+1):this.P0c(b,G),this.hne(b,G+1,R)):(this.P0c(b,G),this.hne(b,G,0))}this.Z3g=new Date;ya.a.J(22344988,820,50,"ListCore::Validate {0}",+this.Z3g-+this.$3g)}}Wda(a){this.DM.hh(a)||cc.a.instance.Yb("PossibleListLevelIncorrect",{["Reason"]:ce.a.yda});
return a.currentNode.sa(sb.a.listLevel,Ke.a.xFa)}Enj(a){this.DM.hh(a)||cc.a.instance.Yb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:ce.a.yda});return a.currentNode.listID}kck(a){return this.DM.hh(a)||Hd.TableReader.jq(a)||Dk.l(a)||Oc.isTableCell(a)}P0c(a,b){for(;b<mp.a.A8;++b)a[b].nextNumber=a[b].restartInfo=1}hne(a,b,c){for(;b<mp.a.A8;++b)a[b].nextListId=c}eej(a){return a.currentNode.sa(va.a.autonumberBulletType,8)}}Object(m.a)(CL,"ListCore",null,[372]);class jq{constructor(a,b,c=null){this.Vf=
a;this.Mi=b;this.Wt=null;this.Eqb=c}get Xxl(){return!1}C4k(a){return a}fOb(a){let b,c,f;b=Bb.ListReader.d$a;c=a.propertySet.sa(sb.a.listID,0);f=a.propertySet.sa(sb.a.listLevel,-1);if(M.a.instance.ga(85)||b&&0<c&&0<=f)this.Wt=a;else{let l=1;const y=a.listStyle;b&&42!==y&&0<y&&(l=y);this.Wt=cb.a.SN(a.listType,l,null,c,f,void 0,"")}}Grl(a){a&&(this.Wt=a)}R5d(){}createList(a){const b=cc.a.instance.eq(C.a.createList);he.OutlineElementReader.hh(a)||cc.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:ce.a.yda});
Bb.ListReader.Hk(a)&&cc.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:ce.a.bKi});const c=this.mPi();a.Gl(c,4);a.el(c);b.end();return c}mPi(){return Us.a.instance.createInstance(393234)}Soa(a){const b=cc.a.instance.eq(C.a.Soa);he.OutlineElementReader.hh(a)||cc.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:ce.a.yda});Bb.ListReader.Hk(a)&&this.Z$k(a);b.end()}Z$k(a){this.Vf.Yna(a);a.Qi()}vtb(a,b,c,f=!1){const l=cc.a.instance.eq(C.a.Aoi);if(!this.NJf(b,c))return{returnValue:!1,Hbb:c};
this.qAh(a,c,f);f=a.Ta(we.a.C7g);var y=a.sa(we.a.Log,!1);let G=!1;1===c.B0&&c.Are&&!c.nU&&(G=!0);const R=c.propertySet.sa(sb.a.Ldc,null);R&&R===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?G=c.Are&&!c.nU:0===c.listType&&(G=0===c.listStyle));y?G&&(c.fza(16,0),a.setValue(we.a.wE,16),a.setValue(we.a.Jea,0)):(y=this.Vf.Hv(b),this.QDh(c,y,f,G,a)&&(l.properties.$("ToggledOff","true"),c.fza(16,0),this.Pql(a)),0===c.listType&&a.Ta(we.a.PWa)&&(c.VA=a.eb(we.a.PWa),a.removeProperty(we.a.PWa)));if(f&&
(l.properties.$("MultipleOESelection","true"),({Hbb:c}=this.HDh(b,c)).returnValue))return l.end(),{returnValue:!1,Hbb:c};this.hmi(b,c,a);a.setValue(we.a.Log,!0);l.end();return{returnValue:!0,Hbb:c}}QDh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.VA===Ba.a.ex;a=a.listStyle===b.listStyle&&a.VA===b.VA;this.Vf.udb&&(a=a&&!c);return f&&(l||a)}return!1}Pql(a){a.setValue(we.a.wE,16);a.setValue(we.a.Jea,0)}qAh(){}NJf(){return!0}HDh(a,b){return{returnValue:16!==b.listType&&
he.OutlineElementReader.isEmpty(a,!0),Hbb:b}}fvb(a){const b=cc.a.instance.eq(C.a.fvb);zb.ParagraphReader.fe(a)||cc.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:ce.a.z5d});const c=new ub.GraphIterator;c.set(a);c.kf();c.gC(12);rc.OutlineElementNavigator.Se(c);this.$Qa(c,null);b.end()}UVd(){}merge(a,b,c){const f=cc.a.instance.eq(C.a.jck);he.OutlineElementReader.hh(b)||cc.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});he.OutlineElementReader.hh(a)||cc.a.instance.Yb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(Bb.ListReader.Hk(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=Bb.ListReader.d$a;c&&this.Xxl&&Bb.ListReader.Hk(a)&&this.Soa(a);if(!Bb.ListReader.Hk(a)||c&&l)c&&(w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.jce(b),this.Vf.SIh&&c.propertySet.Ae(Ya.a.RWa,Ba.a.ex),1===c.B0&&c.ELf(),this.$Qa(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
jq.hM.A3c&&this.FAi(b,a);this.Soa(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}FAi(a,b){a=zb.ParagraphReader.tyb(a.currentNode);b=this.Vf.R$f(b);this.Dtd(b,a,null)}jce(a){return this.Vf.Hv(a)}Dtd(a,b,c){if(a){b=bb.a.create(b);b=wb.a.Es(b);this.B1a(a,Ya.a.fontColor,c,b);this.B1a(a,Ya.a.fontSize,c,b);if(this.Eqb){let f,l;({value:f}=this.getPropertyValue(Ya.a.font,c,b,"")).returnValue&&this.Eqb.pV(a,f);({value:l}=this.getPropertyValue(sb.a.DV,c,b,-1)).returnValue&&this.Eqb.$La(a,
l)}else this.B1a(a,Ya.a.font,c,b),this.B1a(a,sb.a.DV,c,b);w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");jq.hM.A3c&&(this.B1a(a,Ya.a.bold,c,b),this.B1a(a,Ya.a.italic,c,b),this.B1a(a,Ya.a.superscript,c,b),this.B1a(a,Ya.a.subscript,c,b))}}eAh(){}B1a(a,b,c,f){c&&c.Ta(b)?a.setValue(b,c.eb(b)):f&&f.cache&&(c=f.cache,c.Ta(b)&&a.setValue(b,c.eb(b)))}getPropertyValue(a,b,c,f){if(b&&b.Ta(a))return f=b.eb(a),{returnValue:!0,value:f};if(!c||
!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Ta(a)?(f=b.eb(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}TZf(a,b){b.Ta(we.a.wE)||(a===C.a.kN?b.setValue(we.a.wE,1):a===C.a.JP&&b.setValue(we.a.wE,0));b.Ta(we.a.Jea)||b.setValue(we.a.Jea,0);return b}iRa(a,b,c,f,l,y,G){a=cc.a.instance.eq(C.a.iRa);const R=this.Vf.Hv(b);c=cb.a.SN(0,c);c.VA=f;c.ssa=y;R&&c.nhe(R)&&c.VA===R.AX||(f=new pf.GraphTransaction(15),f.Xy(b),b=this.bqj(c),null!=b&&G.numbering(b)&&(ha.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+y),jq.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}bqj(a){var b;let c=null===(b=null===zv||void 0===zv?void 0:zv[a.listType])||void 0===b?void 0:b[a.ssa];if(null==c)return null;b=new J.DictionaryPropertySet;b.setValue(we.a.wE,a.listType);b.setValue(we.a.Jea,a.listStyle);b.setValue(we.a.PWa,a.VA);b.setValue(Ya.a.ej,c.ej);this.Unl(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return jq.mh||(jq.mh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hM(){return jq.XK||
(jq.XK=Fb.a.instance.rb("Box4.List.ListSettings"))}}jq.mh=null;jq.XK=null;Object(m.a)(jq,"ListEditor",null,[371]);class ho{}ho.HJe=80640;ho.IJe=0;ho.bje=80640;ho.cje=-80640;Object(m.a)(ho,"ParagraphConstants",null,[]);var im=d(189);class DL extends jq{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){super(a,b);this.g7c=[Ya.a.ej,Ya.a.font];this.xbd=[Ya.a.ej,Ya.a.font,Ya.a.fontColor,va.a.autonumberBulletType,va.a.zxb];this.uIa=c;this.lic=f;this.fFb=l.wsg;this.DM=y;this.om=G;this.KH=ja;this.MA=za;this.wi=
Va;this.wwa=hb;this.Ihc=l.mqe;this.sfb=l.ysg;this.vM=Cb;this.Tb=lc;this.Ga=ic;this.hwa=l.pptCopyPasteListMarkerEnabled;this.Hhc=l.pptCopyPasteMarginAndIndentationEnabled;this.zLg=l.pptCopyPasteTextWithSpacingFromExternal}fOb(a){super.fOb(a);this.sfb&&this.FOc(a.propertySet,this.Wt.propertySet)}S0e(a){if(this.fFb&&this.Wt&&this.Wt.propertySet){const b=this.Wt.propertySet.sa(sb.a.listLevel,-1);-1!==b&&this.T0e(a,b)}this.hwa&&this.Wt&&(this.Wt.Ixb=!0);this.zLg&&this.Vzh(a);this.VVd(a,this.Wt);this.Wt=
null}Hzh(a,b,c){b=this.Mi.Dac(a);this.Mi.zPb(a,b,c,!1,!0)}NJf(a,b){if(!a||!b)return!1;if(a.Db(4)){var c=this.Vf.kce(a);this.uIa.Se(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Db(2);const f=c.sa(sb.a.xo,Ke.a.indent),l=c.sa(sb.a.um,Ke.a.leftMargin);this.uIa.Se(a);a=f;let y=l;({indent:a,margin:y}=this.QYd(Wm.HGf(zb.ParagraphReader.wka(c,Ya.a.fontSize,0)),b.listType,f,l,a,y));return!!(this.s2j(y)&this.k1j(a))}$9f(a,b,c,f){if(!a)return ya.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{dte:c,aje:f};b&&(c=b.sa(va.a.x4b,Ke.a.leftMargin),f=b.sa(va.a.V3d,Ke.a.indent),(a=this.Ga.An(a))&&a.xd&&(c=b.sa(sb.a.um,Ke.a.leftMargin),f=b.sa(sb.a.xo,Ke.a.indent)));return{dte:c,aje:f}}fJf(a,b,c,f){if(!a||!this.DM.hh(b))return ya.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{J8d:c,I8d:f};var l=this.JQ(b,this.KH.Wda(b));if(l){const y=a.sa(sb.a.um,Ke.a.leftMargin),G=a.sa(sb.a.xo,Ke.a.indent);c=y;f=G;let R=Ke.a.leftMargin,
ja=Ke.a.indent;({dte:R,aje:ja}=this.$9f(a,l,R,ja));l=cb.a.yDa(l,null).listType;const za=y+(0<=G?0:G),Va=R+(0<=ja?0:ja),hb=b.Db(4);let Cb=16;hb&&(Cb=this.lic.Fyb(hb),b.Cc());ja&&za===Va&&l===Cb?(c=R,f=ja):({indent:f,margin:c}=this.QYd(this.eab(a),Cb,G,y,f,c),c=Math.max(Math.min(c,ho.HJe),ho.IJe),f=Math.max(Math.min(f,ho.bje),ho.cje))}return{J8d:c,I8d:f}}wij(a,b){if(!a||!this.DM.hh(b))return ya.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
Ke.a.leftMargin;let c=Ke.a.leftMargin,f=Ke.a.indent;({J8d:c,I8d:f}=this.fJf(a,b,c,f));0<c&&ya.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}sij(a,b){if(!a||!this.DM.hh(b))return ya.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),Ke.a.indent;let c=Ke.a.leftMargin,f=Ke.a.indent;({J8d:c,I8d:f}=this.fJf(a,b,c,f));0<f&&ya.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}HDh(a,b){return{returnValue:!1,
Hbb:b}}QDh(a,b,c,f,l){return f?!0:!b||l&&l.Ta(Ya.a.ej)?!1:a.listType===b.listType}s2j(a){return a<ho.HJe&&a>=ho.IJe}k1j(a){return a<ho.bje&&a>=ho.cje}Unl(a,b){a.setValue(va.a.autonumberBulletType,b)}azl(a){return a}R5d(a,b){a.Ta(sb.a.listLevel)&&b.Ae(sb.a.listLevel,a.Sh(sb.a.listLevel))}Rnj(a,b){return Object(Sa.a)(im.TableCellNode,a)?this.KH.L6f(a,this.MA.rYc(a),b):this.Mpj(a,b)}Mpj(a,b){--b;const c=a.sa(sb.a.A0,[]);return 0>b||b>=c.length?(ya.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",
b),cc.a.instance.Yb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Nh.Be(c[b])}Dtd(){}T0e(a,b){if(this.DM.hh(a)&&0<=b&&b<mp.a.A8){const c=a.currentNode,f=a.Db(2);c&&c.setValue(sb.a.listLevel,b);f&&(f.setValue(sb.a.listLevel,b),a.Cc())}}grl(a,b){if(this.DM.hh(a)&&b&&b.propertySet){var c=a.Db(4);c&&(b.Hzb&&b.Y9&&(this.sfb?(this.FOc(b.propertySet,c),this.hwa&&b.propertySet.Ta(va.a.autonumberBulletType)&&c.setValue(va.a.autonumberBulletType,b.propertySet.eb(va.a.autonumberBulletType))):
c.setValue(Ya.a.ej,b.Y9)),a.Cc())}}eAh(a){if(this.DM.hh(a)){if(this.fFb&&this.Wt&&this.Wt.propertySet){const b=this.Wt.propertySet.sa(sb.a.listLevel,-1);-1!==b&&this.T0e(a,b);this.grl(a,this.Wt)}this.Hhc&&this.Gql(a);this.hwa&&(this.Wt&&this.Wt.propertySet?this.i0j(this.Wt)||(ya.a.J(512496285,820,50,"Copied from external, such as website."),this.U0e(a)):(ya.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.U0e(a)));this.zLg&&this.Vzh(a);this.Wt=null}else ya.a.J(512496288,820,10,
"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}Vzh(a){const b=this.KH.Wda(a),c=this.JQ(a,b),f=a.Db(2);c&&f&&0<=b&&b<mp.a.A8&&(this.Wt&&this.Wt.propertySet&&this.Wt.propertySet.Ta(va.a.Jx)||(ya.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(va.a.Jx,c.sa(va.a.LUi,Ke.a.lineSpacing)),f.setValue(va.a.CX,c.sa(va.a.MUi,2))),this.Wt&&this.Wt.propertySet&&this.Wt.propertySet.Ta(va.a.Hea)||(ya.a.J(512496283,820,50,"Get master defined line-spacing before"),
f.setValue(va.a.Hea,c.sa(va.a.aVi,Ke.a.fxg)),f.setValue(va.a.cma,c.sa(va.a.bVi,4))),this.Wt&&this.Wt.propertySet&&this.Wt.propertySet.Ta(va.a.Gea)||(ya.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(va.a.Gea,c.sa(va.a.ZUi,Ke.a.exg)),f.setValue(va.a.bma,c.sa(va.a.$Ui,4))));a.Cc()}i0j(a){if(a.propertySet.Ta(Ya.a.ej)){const b=a.propertySet.eb(Ya.a.ej).length;if(1===b&&a.propertySet.Ta(Ya.a.font)||3===b&&a.propertySet.Ta(va.a.autonumberBulletType))return!0}return!1}Gql(a){var b=
this.KH.Wda(a);const c=this.JQ(a,b),f=a.Db(2);c&&f&&0<=b&&b<mp.a.A8&&(this.Wt&&this.Wt.propertySet&&this.Wt.propertySet.Ta(sb.a.um)||(ya.a.J(512496281,820,50,"Get master defined indent-left."),c.Ta(va.a.x4b)&&f.setValue(sb.a.um,c.eb(va.a.x4b)),(b=this.Ga.An(f))&&b.xd&&f.setValue(sb.a.um,c.sa(sb.a.um,Ke.a.leftMargin))),this.Wt&&this.Wt.propertySet&&this.Wt.propertySet.Ta(sb.a.xo)||(ya.a.J(512496280,820,50,"Get master defined firstline indent."),c.Ta(va.a.V3d)&&f.setValue(sb.a.xo,c.eb(va.a.V3d)),(b=
this.Ga.An(f))&&b.xd&&f.setValue(sb.a.xo,c.sa(sb.a.xo,Ke.a.leftMargin))));a.Cc()}U0e(a){const b=this.KH.Wda(a),c=this.JQ(a,b),f=a.Db(4);c&&f&&0<=b&&b<mp.a.A8&&(ya.a.J(512496279,820,50,"Get master defined list marker"),c.Ta(Ya.a.ej)?(f.setValue(Ya.a.ej,c.eb(Ya.a.ej)),c.Ta(Ya.a.font)?f.setValue(Ya.a.font,c.eb(Ya.a.font)):c.Ta(va.a.autonumberBulletType)&&f.setValue(va.a.autonumberBulletType,c.eb(va.a.autonumberBulletType))):(f.setValue(Ya.a.font,De.LHf),f.setValue(Ya.a.ej,[De.gYd])));a.Cc()}I2c(a){return a?
16!==this.KH.rce(a).que:!1}fvb(){ya.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");cc.a.instance.Yb("FormattingNotCleared",{["Reason"]:ce.a.lng})}Y9k(a){if(this.DM.hh(a)){var b=a.Db(4);b&&(1===this.lic.Fyb(b)&&b.removeProperty(va.a.autonumberBulletType),a.Cc())}}Erl(a){this.DM.hh(a)&&(a=a.currentNode)&&a.setValue(va.a.D3j,!0)}merge(a,b,c,f){const l=this.KH.Wda(b),y=this.JQ(a,this.KH.Wda(a)),G=this.JQ(b,l);y&&a&&(a.Db(2),a.currentNode&&(a.currentNode.Ta(sb.a.um)&&
y.Ta(sb.a.um)&&!bB.APropertySet.f0a(sb.a.um.type,a.currentNode.Sh(sb.a.um),y.Sh(sb.a.um))&&y.Ae(sb.a.um,a.currentNode.Sh(sb.a.um)),a.currentNode.Ta(sb.a.xo)&&y.Ta(sb.a.xo)&&!bB.APropertySet.f0a(sb.a.xo.type,a.currentNode.Sh(sb.a.xo),y.Sh(sb.a.xo))&&y.Ae(sb.a.xo,a.currentNode.Sh(sb.a.xo))),a.Cc());super.merge(a,b,c);c&&this.fFb&&(this.T0e(a,l),this.Erl(a),this.Y9k(a));this.umi(b,G,y);if(f&&(a.Db(2),c=a.currentNode.sa(va.a.ZKa,""),a.Cc(),c.length))for(a=this.Tb.Ibe(b);a.Hf(1)&&a.currentNode!==f.currentNode;)a.Db(2),
a.currentNode.setValue(va.a.ZKa,c),a.Cc();return!0}hmi(a,b,c){const f=Kc.a.Kb;f&&(f.Qj=!0);this.VVd(a,b,c)}CMl(a,b){var c=ub.GraphIterator.pb(b);this.Vf.Yna(c);b=c.currentNode;c.Cc();c=this.createList(a);a.Cc();c.Y8a(b,va.a.shapeId,va.a.aya)}$Qa(a,b){this.VVd(a,b)}bCf(a,b,c){this.DM.hh(a)||cc.a.instance.Yb("PossibleIndentNotAdjusted",{["Reason"]:ce.a.yda});const f=a.Db(2),l=f.sa(sb.a.xo,Ke.a.indent),y=f.sa(sb.a.um,Ke.a.leftMargin);this.uIa.Se(a);if(16===b)this.wwa.Jv.slb(f,0),0>l&&(cc.a.instance.Yb("UnexpectedlyChangingLeftIdent",
{["Reason"]:"NegativeLeftIndent"}),this.Mi.tlb(a,1,Math.max(y+l,0)));else{var G=this.JQ(a,this.KH.Wda(a));G||(G=new J.DictionaryPropertySet,ya.a.J(512496273,820,50,"listStyle is null"));var R=Ke.a.indent;let ja=Ke.a.leftMargin;c?{dte:ja,aje:R}=this.$9f(f,G,ja,R):(R=G.sa(sb.a.xo,Ke.a.indent),ja=G.sa(sb.a.um,Ke.a.leftMargin));G=cb.a.yDa(G,null).listType;const za=ja+(0<=R?0:R);R&&y+(0<=l?0:l)===za&&G===b?(this.wwa.Jv.slb(f,R),this.Mi.tlb(a,1,ja)):(R=l,G=y,{indent:R,margin:G}=this.QYd(this.eab(f),b,l,
y,R,G),0<this.KH.Wda(a)&&c&&(G+=ja),G=Math.max(Math.min(G,ho.HJe),ho.IJe),R=Math.max(Math.min(R,ho.bje),ho.cje),this.wwa.Jv.slb(f,R),this.Mi.tlb(a,1,G))}}eab(a){if(!a)return 0;a=this.om.D9(a)?this.om.ryj(this.om.Qyb(a)):zb.ParagraphReader.wka(a,Ya.a.fontSize,0);return Wm.HGf(a)}QYd(a,b,c,f,l,y){let G=(b=1===b)?.3125:.375;0<a&&(G=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);
a=-1*Oe.a.yua(G);0>=c&&a<c?(y=a-c,l=c+y,y=f-y):0<c&&(l=a,y=f-a);return{indent:l,margin:y}}umi(a,b,c){if(b&&c){rc.OutlineElementNavigator.yi(a);var f=a.Dq;if(zb.ParagraphReader.vl(a)){b=b.sa(Ya.a.fontSize,Vr.fontSize);c=c.sa(Ya.a.fontSize,Vr.fontSize);for(let l=0;l<f.Sa.length;++l){const y=f.Sa.ga(l);y&&y.formatting&&y.formatting.iA&&y.formatting.iA.Ta(Ya.a.fontSize)&&y.formatting.iA.eb(Ya.a.fontSize)===b&&this.wi.Xq(y.formatting,c)}}rc.OutlineElementNavigator.Se(a)}}jce(a){if(this.hwa){if(a=this.Vf.Hv(a))a.Ixb=
!0;return a}return super.jce(a)}VVd(a,b,c=null){if(this.DM.hh(a)){this.Ami(b,c,a);var f=a.Db(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?cb.a.yDa(f,f).q2b():f=this.createList(a);a.Cc();const l=a.Db(2);a.Cc();this.Ihc&&l.sa(we.a.hcc,!1)||this.hwa&&b.Ixb?f.Y8a(b.propertySet,va.a.shapeId,va.a.aya,sb.a.listLevel,Ya.a.ej,we.a.wE):f.Y8a(b.propertySet,va.a.shapeId,va.a.aya,sb.a.listLevel,va.a.gGa);c&&c.Ta(va.a.autonumberBulletType)&&f.setValue(va.a.autonumberBulletType,c.eb(va.a.autonumberBulletType));
this.hwa&&b.Ixb&&b.Hzb&&(3===b.Y9.length&&b.propertySet.Ta(va.a.autonumberBulletType)?(f.setValue(Ya.a.ej,b.Y9),f.setValue(va.a.autonumberBulletType,b.propertySet.eb(va.a.autonumberBulletType)),ya.a.J(512496267,826,50,"Support CCP customized number list")):1===b.Y9.length&&b.lbb?(f.setValue(Ya.a.ej,b.Y9),f.setValue(Ya.a.font,b.font),ya.a.J(512496266,826,50,"Support CCP customized bullet")):(ya.a.J(512496265,826,50,"Set list use dst master liststyle."),this.U0e(a)))}else return;else a.Qi();b&&b.B4f||
(this.Ihc?(c=this.Vf.Hv(a),this.bCf(a,c?c.listType:16,b?b.Ixb:!1)):this.bCf(a,b?b.listType:16,b?b.Ixb:!1))}else ya.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),cc.a.instance.Yb("FailedToApplyListProperties",{["Reason"]:ce.a.yda})}Ami(a,b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.vM.oy(b,a.propertySet,this.g7c),c=this.JQ(c,this.KH.Wda(c))||new J.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(we.a.Jea,6),b.Ta(Ya.a.ej)||(a.propertySet.setValue(Ya.a.font,
De.LHf),a.propertySet.setValue(Ya.a.ej,[De.gYd]),c.Ta(Ya.a.ej)&&(b=c.eb(Ya.a.ej)[0],b!==De.A3d&&b!==De.JJa&&this.vM.oy(c,a.propertySet,this.g7c)))))}JQ(a,b){this.DM.hh(a)||cc.a.instance.Yb("PossibleLossOfListStyle",{["Reason"]:ce.a.yda});a=this.oyj(a);return a?this.Rnj(a,1+b):(ya.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),cc.a.instance.Yb("PossibleLossOfListStyle",{["Reason"]:ce.a.LOf}),null)}oyj(a){a=ub.GraphIterator.jH(a);a.h7(uj.OutlineReader.ecc);const b=a.jx(16);
return b?b:a.l3a()}Fyb(a){return this.KH.rce(a).que}qAh(a,b,c){c||0!==b.listType||(b.VA=a.sa(Ya.a.RWa,Ba.a.ex))}FOc(a,b){this.vM.SLi(a,b,this.xbd)}}Object(m.a)(DL,"ListEditor",jq,[370,371]);class ot{constructor(a,b){this.o1b=a;this.lub=b}}Object(m.a)(ot,"BulletMarker",null,[]);class pt{constructor(a,b){this.OHf=a;this.b9g=b}}Object(m.a)(pt,"ListMarkerPreview",null,[]);class qt{constructor(a,b,c){this.S8g=a;this.Y8g=b;this.jXd=c}}Object(m.a)(qt,"NumberingMarker",null,[]);class EL{constructor(a,b){this.Tb=
a;this.JHb=b;this.Uok=new vb.a(Object(H.a)(this,this.hPi,"createListBulletDictionary"));this.Zok=new vb.a(Object(H.a)(this,this.nPi,"createListNumberingDictionary"));this.Yok=new vb.a(Object(H.a)(this,this.lPi,"createListMarkerPreviewDictionary"));this.Wok=new vb.a(Object(H.a)(this,this.kPi,"createListMarkerAltTextDictionary"))}hPi(){const a=new Qe.a;a.$(3,new ot(8226,"Arial"));a.$(4,new ot(111,"Courier New"));a.$(5,new ot(167,"Wingdings"));a.$(6,new ot(113,"Wingdings"));a.$(7,new ot(118,"Wingdings"));
a.$(8,new ot(216,"Wingdings"));a.$(9,new ot(252,"Wingdings"));return a}nPi(){const a=new Qe.a;a.$(11,new qt(0,".",8));a.$(12,new qt(0,")",7));a.$(13,new qt(1,".",15));a.$(14,new qt(3,".",5));a.$(15,new qt(4,")",2));a.$(16,new qt(4,".",4));a.$(17,new qt(2,".",14));return a}lPi(){const a=new Qe.a;a.$(1,new pt("\u2022",["1.","2.","3."]));a.$(2,new pt("o",["1)","2)","3)"]));a.$(3,new pt("\uf0a7",["I.","II.","III."]));a.$(4,new pt("\uf071",["A.","B.","C."]));a.$(5,new pt("\uf076",["a)","b)","c)"]));a.$(6,
new pt("\uf0d8",["a.","b.","c."]));a.$(7,new pt("\uf0fc",["i.","ii.","iii."]));return a}kPi(){const a=new Qe.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);
a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);return a}get NWa(){return this.Uok.value}get Oid(){return this.Zok.value}get K5c(){return this.Yok.value}get nxg(){return this.Wok.value}JEf(a,b){const c=this.Tb.Lc(a);c.set(a);
for(a=c.Db(1);a;){var f=c.Db(4);if(f){if(1===b){if(1!==f.sa(we.a.wE,16))return!1}else if(2===b){if(0!==f.sa(we.a.wE,16))return!1}else if(a=f.sa(Ya.a.ej,null),this.JHb.k1c(b)){f=f.sa(Ya.a.font,"");const l=this.NWa.ga(b);if(!a||1!==a.length||l.o1b!==a[0]||l.lub!==f)return!1}else if(this.JHb.l1c(b)){if(f=this.Oid.ga(b),!a||3!==a.length||f.S8g!==a[1]||f.Y8g!==na.a.fromCharCode(a[2]))return!1}else return!1;c.Cc()}else if(0!==b)return!1;a=c.Hf(1)}return!0}k1c(a){return this.JHb.k1c(a)}l1c(a){return this.JHb.l1c(a)}m9b(a){return this.JHb.m9b(a)}vYc(a){return this.JHb.vYc(a)}}
Object(m.a)(EL,"PptListMarkersLoader",null,[374,373]);class FL{zWl(a,b){if(!a)return!1;b.Db(2);a=b.currentNode.sa(we.a.hcc,!1);b.Cc();return!a}}Object(m.a)(FL,"PptMergeListEditorInOutlineElementStrategy",null,[375]);class Oz{constructor(){this.gwi=[0,3,4,5,6,7,8,9];this.ODk=[0,11,12,13,14,15,16,17]}k1c(a){return 3<=a&&9>=a}l1c(a){return 11<=a&&17>=a}m9b(a){return Oz.qeg(a,this.gwi,1)}vYc(a){return Oz.qeg(a,this.ODk,2)}static qeg(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(m.a)(Oz,"TextBulletTypeHelper",
null,[373]);class QD{get name(){return"PowerPointWebEditor.ListEditor"}Xb(a){a.register(370,"PowerPointWebEditor.IPptListEditor").na().oa(()=>new DL(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),
a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(371,"Box4.List.IListEditor").na().oa(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(372,"PowerPointWebEditor.IPptListCore").na().oa(()=>new CL(a.resolve("PowerPointWebEditor.ISlideReader"),
a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(373,"PowerPointWebEditor.ITextBulletTypeHelper").na().oa(()=>new Oz);a.register(374,"PowerPointWebEditor.IPptListMarkersLoader").na().oa(()=>new EL(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(375,"Box4.IMergeListEditorInOutlineElementStrategy").na().oa(()=>new FL)}init(){}dispose(){}static main(){n.a.instance.Ac(new QD)}}
Object(m.a)(QD,"PPTWebEditorListEditorPackage",null,[2,3]);var IR=d(902);class GL{Ek(a){return Hd.TableReader.Ek(a)}Gi(a){return Hd.TableReader.Gi(a)}OXc(a,b,c){return Hd.TableReader.OXc(a,b,c)}yt(a){return Hd.TableReader.yt(a)}Zcb(a){return Hd.TableReader.Zcb(a)}Ks(a){return Hd.TableReader.Ks(a)}IL(a){return Hd.TableReader.IL(a)}}Object(m.a)(GL,"TableReaderProxy",null,[1332]);class HL{yrg(){return Dk.j(void 0)}Gtj(a){return Dk.c(a)}}Object(m.a)(HL,"TableRowReaderProxy",null,[1331]);class IL extends wk.a{constructor(a,
b,c,f,l){super(a,b);this.X3h=l;this.fL=f;a=l&&this.gb.sa(sb.a.skippedCell,!1);b=this.Od.vp(Fa.a.td);this.jc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.fL.yr?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText="\u00a0";this.RVf()}fV(){return Oi.a.Jmc}az(){this.X3h&&this.gb.sa(sb.a.skippedCell,!1)&&this.Zsl()}Zsl(){this.fL.yr&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft=
"",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(m.a)(IL,"GhostTableCellViewElement",wk.a,[1336,340,305,108]);class JL{constructor(a,b,c){this.QQd=a;this.fL=b;this.mpb=c}create(a,b){return Oc.isGhostCellNode(b.node)?Oc.shouldRenderGhostCellNode(b.node)?new IL(a,b,this.QQd,this.fL,M.a.instance.ga(63),M.a.instance.ga(77)):null:this.mpb.create(a,b)}}Object(m.a)(JL,"GhostTableCellViewElementFactory",null,[498]);class KL{constructor(a,b,c){this.zc=a;this.Efa=b;this.wUg=
c;this.hG=null;this.vEb=this.wEb=-1}Btl(a,b=null){this.Dtl(a);this.hG&&this.Rpl(b)}tEi(){this.hG=null;this.vEb=this.wEb=-1}c7f(a,b,c){if(!a||!this.hG)return{row:b,column:c};var f=this.Efa.f2f(a,this.hG,this.wUg.pMc,this.wUg.oMc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.Ai;l===b||this.Efa.v1c(a,this.hG)||(l=b);var y=0,G=this.zc.Gi(this.hG)-1;let R=0,ja=this.zc.Ek(this.hG)-1;this.Efa.v1c(a,this.hG)&&b>=R&&b<=ja&&c>=y&&c<=G&&(a=(y=(y=this.hG.ff(b,c))?y.rz():null)?y.rowSpan:0,G=y?y.colSpan:0,
y=c,G=c+G-1,R=b,ja=b+a-1);l>=R&&l<=ja&&f>=y&&f<=G&&(b=l,c=f);return{row:b,column:c}}LBk(a){a=this.ceg(a);return!!a&&14===a.type&&a.Op()}Gmi(a,b,c,f,l,y){if(!this.hG||!a||14!==a.type||this.hG!==a||!b)return{K4f:c,z4f:f,vLh:l,tLh:y};this.hG.ff(c,f).isControllingCell&&({rowIndex:c,Kja:f}=this.dlj(c,f));if(this.hG.ff(l,y).isControllingCell||!this.Efa.v1c(b,this.hG))({row:l,column:y}=this.c7f(b,l,y));ya.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{K4f:c,z4f:f,vLh:l,tLh:y}}Dtl(a){(a=
this.ceg(a))&&14===a.type&&(this.hG=a)}ceg(a){return 1074135132===a.Xe&&a.xd?this.zc.eO(a):this.zc.h9b(a)}Rpl(a){this.hG&&a&&({row:this.wEb,column:this.vEb}=this.c7f(a,this.wEb,this.vEb))}dlj(a,b){if(!this.hG)return{rowIndex:a,Kja:b};let c=null;0<=a&&a<this.zc.Ek(this.hG)&&0<=b&&b<this.zc.Gi(this.hG)&&(c=this.hG.ff(a,b));this.g0j(c)&&(a=this.wEb,b=this.vEb);return{rowIndex:a,Kja:b}}g0j(a){if(!this.hG)return!1;let b=0;var c=this.zc.Gi(this.hG)-1;let f=0;var l=this.zc.Ek(this.hG)-1;if(a){l=a.rowIndex;
c=a.Ai;const y=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+y-1}return this.wEb>=f&&this.wEb<=l&&this.vEb>=b&&this.vEb<=c}}Object(m.a)(KL,"PptTableDragSelectionCellExtendStrategy",null,[358]);var LL=d(849),xn=d(243);class ML{constructor(){this.TZc=this.colSpan=this.yrd=0}}Object(m.a)(ML,"HeightInfo",null,[]);class NL{constructor(){this.ERa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.zig=this.djg=this.brg=this.drg=this.crg=!1}}Object(m.a)(NL,"TableCellInfo",null,
[]);class OL{constructor(){this.dYh=[]}get cells(){return this.dYh}jTd(a){this.cells.push(a)}}Object(m.a)(OL,"TableRowInfo",null,[]);class PL{constructor(){this.ERa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.sqg=this.xrg=this.xqg=!1}}Object(m.a)(PL,"UpdateInfo",null,[]);var JR=d(1105),QL=d(566);class Tv extends QL.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){super(a,b,hb);this.aPa=!1;this.Y4a=this.Ltf=this.JOd=this.X4a=this.cHa=null;this.lLd=0;this.$Ai=1;this.YAi=16;
this.PAi=256;this.SAi=4096;this.ZAi=65536;this.JCc=this.bDc=this.nDc=this.xDc=!1;this.Ndf=this.wwf=this.xGc=this.RDc=this.Iha=0;this.jxe=this.kxe=null;this.qai=Object(sa.a)(131,b);this.nca=c;this.Hca=lc;this.kd=Va;this.kW=Cb;this.fL=za;this.FHc=R;this.Aia=ja;this.zia=G;this.Er=y;this.L$c=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Od.vp(Fa.a.td);this.jc(a);this.OZ=this.Od.vp(Fa.a.div);a.appendChild(this.OZ);this.OZ.className="TableCellContent";
this.hp(this.OZ)}I7b(){return this.OZ.offsetHeight+this.OZ.offsetTop}Dxc(a,b,c,f){a=this.aPa?a:a+c;this.cHa||(this.cHa=this.WOc());this.cHa.style.left=a-2.5+"px";this.cHa.style.top=b+"px";this.cHa.style.height=f+"px"}TRf(){const a=this.Od.vp(Fa.a.div);rf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);return a}WOc(){const a=this.TRf();a.className="TableColumnResizeHandle";return a}z2d(){const a=this.Od.vp(Fa.a.div);rf.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
a.className=zd.a.F9k;return a}gSl(a,b,c,f){f?(a=this.aPa?a:a+b,this.X4a||(this.X4a=this.lNi()),b=this.X4a.style,b.top=c+"px",b.left=a+"px"):this.X4a&&(this.cMf(this.X4a,!1),this.X4a=null);return this.X4a}lNi(){const a=this.z2d(),b=this.Od.vp(Fa.a.div);rf.c(b,!0);b.className=zd.a.Qje;a.appendChild(b);return a}LUl(a,b,c,f){this.G2i();const l=this.JOd.style;l.top=c+"px";l.left=f+"px";c=this.Ltf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}G2i(){if(!this.JOd){const a=this.z2d(),b=this.Od.vp(Fa.a.div);
rf.c(b,!0);b.className=zd.a.omg;a.appendChild(b);this.JOd=a;this.Ltf=b}}PUl(a,b,c){c?(this.Y4a||(this.Y4a=this.gRi()),c=this.Y4a.style,c.top=a+b-10+"px",this.aPa?c.right="-15px":c.left="-15px"):this.Y4a&&(this.cMf(this.Y4a,!0),this.Y4a=null);return this.Y4a}gRi(){const a=this.z2d(),b=this.Od.vp(Fa.a.div);rf.c(b,!0);b.className=zd.a.Rje;a.appendChild(b);return a}aqh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}cMf(a,b){b?xn.a.HDi(a):xn.a.DDi(a);this.htmlElement.removeChild(a)}irg(a){a=
a?C.a.Fua:w.AFrameworkApplication.isRtl?C.a.Obb:C.a.uVa;return 8!==w.AFrameworkApplication.Qa.ii(bb.a.create(this.gb),a,1,!0,new JR.a,null)}fV(a){super.fV(a);const b=super.fV(a);this.lLd=this.Rxj(a);if(this.Hca.Gx&&!this.Qc.lm){var c=wf.a.pb(a.D2,a.currentNode);c.kf();this.zia.Se(c);a=this.FHc.getContainingTable(a);this.Aia.hh(c)&&a&&!this.Er.oDa(a)&&(c=c.ir)&&c.htmlElement&&this.nca.qQf(c.htmlElement,a,this.Na)}return new Oi.a(b.Wna+this.RDc+fo.a.Mmb,Math.max(b.minWidth,this.lLd),b.Xna+this.xGc+
fo.a.Mmb)}Rxj(a){return Hd.TableReader.kBb(a)?(a=this.Hca.jqe?this.gb.sa(V.a.tZd,1):1,a*fo.a.U6e+(a-1)*(this.RDc+this.xGc+fo.a.Mmb)):fo.a.U6e}m7(a){this.OZ.style.paddingLeft=a.Wna-fo.a.Mmb+"px";this.OZ.style.paddingRight=a.Xna-fo.a.Mmb+"px";this.Hca.Z2c&&this.Hca.jqe&&(this.OZ.style.minWidth=this.lLd+"px")}Dba(a){this.kE(this.OZ,a,1)}az(){this.CPh();this.Jyh();var a=ub.GraphIterator.pb(this.gb);a.rc(14);const b=ae.getContainingTable(a),c=Oc.isFirstCellInColumn(a);a=Oc.isFirstCellInRow(a);let f="";
c&&Tv.Dug(b,32)&&(f="columnheader");a&&!c&&Tv.Dug(b,128)&&(f="rowheader");""!==f?xb.d(this.htmlElement,wa.a.role,f):this.htmlElement.removeAttribute(Ne.a.hf);this.kd&&this.kd.VFa(65)&&(this.gb.e3b?Sys.UI.DomElement.addCssClass(this.htmlElement,Lb.B4):Sys.UI.DomElement.removeCssClass(this.htmlElement,Lb.B4));this.fL.yr&&(this.htmlElement.style.border="",this.sfl(),this.nol(b),this.htmlElement.style.verticalAlign=this.fL.yr.hfj(this.gb));this.vsl();this.Hca.Z2c&&this.Hca.jqe&&(this.gb.Ta(V.a.PKf)?this.vAh():
this.htmlElement.removeAttribute("rowspan"),this.gb.Ta(V.a.tZd)?this.Oyh():this.htmlElement.removeAttribute("colspan"));this.Qc.lm&&this.Hca.i8j&&(this.htmlElement.style.width=this.Od.Nd.Pe(this.qai.width,0)+"px")}vsl(){if(this.Hca.L4j||this.Hca.v$j)this.gb.xhe?this.vAh():this.htmlElement.removeAttribute("rowspan"),this.gb.hbb?this.Oyh():this.htmlElement.removeAttribute("colspan")}CPh(){let a=null;if(this.kd&&this.kd.VFa(65)){var b=ub.GraphIterator.pb(this.gb);b.rc(15);b=b.jx(15);if(b.Uwc){Sys.UI.DomElement.addCssClass(this.htmlElement,
Lb.VJh);return}if(b.dyd){Sys.UI.DomElement.addCssClass(this.htmlElement,Lb.YJh);return}}this.gb.Ta(Ya.a.OMc)?(a=oc.a.fH(this.gb.sa(Ya.a.OMc,oc.a.nil)),this.Iha|=this.ZAi):this.Hca.L7j&&this.fL.yr&&(a=this.fL.yr.Q6f(this.gb));a=a||"transparent";this.htmlElement.style.backgroundColor=a;"transparent"!==a&&4.5>oc.a.agj(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.kd&&this.kd.VFa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,
Lb.VJh),Sys.UI.DomElement.removeCssClass(this.htmlElement,Lb.YJh))}vAh(){xb.d(this.htmlElement,wa.a.rowSpan,this.Hca.Z2c?this.gb.sa(V.a.PKf,1):this.gb.rowSpan)}Oyh(){xb.d(this.htmlElement,wa.a.colSpan,this.Hca.Z2c?this.gb.sa(V.a.tZd,1):this.gb.colSpan)}sfl(){this.JCc=this.nDc=this.bDc=this.xDc=!1}nol(a){this.fL.yr&&(this.uql(),this.htmlElement.style.border="0px none",this.TNb(this.gb,a,7),this.TNb(this.gb,a,5),this.TNb(this.gb,a,0),this.TNb(this.gb,a,6),this.L$c&&(this.TNb(this.gb,a,2),this.TNb(this.gb,
a,1)),xb.d(this.htmlElement,wa.a.G3d,this.Iha),this.qdl())}Jyh(){var a=new ub.GraphIterator;a.set(this.gb);a.rc(14);a.Jg(14);a=a.currentNode;this.RDc=fo.a.qYc(this.gb,a,sb.a.dQb,this.fL.yr,sb.a.YIl,0);this.xGc=fo.a.qYc(this.gb,a,sb.a.fQb,this.fL.yr,sb.a.ZIl,0);this.wwf=fo.a.qYc(this.gb,a,sb.a.gQb,this.fL.yr,sb.a.$Il,1);this.Ndf=fo.a.qYc(this.gb,a,sb.a.cQb,this.fL.yr,sb.a.UIl,1);this.OZ.style.paddingLeft=this.RDc+"px";this.OZ.style.paddingRight=this.xGc+"px";this.OZ.style.paddingTop=this.wwf+"px";
this.OZ.style.paddingBottom=this.Ndf+"px"}uql(){var a=ub.GraphIterator.pb(this.gb);a.rc(14);a=this.FHc.getContainingTable(a);this.aPa=Hd.TableReader.Jm(a)}TNb(a,b,c){this.kW&&this.kW.JXj(b);a=this.fL.yr.Fjj(a,c);b=a.oti;const f=a.qCj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,f),c){case 7:this.htmlElement.style.borderTop=b;this.w2c(b)&&(this.xDc=!0);a.PQc&&(this.Iha|=this.$Ai);break;case 5:this.Dyh(5,b);this.w2c(b)&&(this.bDc=!0);a.PQc&&(this.Iha|=this.SAi);break;case 0:this.htmlElement.style.borderBottom=
b;this.w2c(b)&&(this.JCc=!0);a.PQc&&(this.Iha|=this.PAi);break;case 6:this.Dyh(6,b);this.w2c(b)&&(this.nDc=!0);a.PQc&&(this.Iha|=this.YAi);break;case 2:this.kxe=b;break;case 1:this.jxe=b}}w2c(a){return!a||a.startsWith("0px none")?!1:!0}Dyh(a,b){if(5===a&&!this.aPa||6===a&&this.aPa)this.htmlElement.style.borderLeft=b;if(5===a&&this.aPa||6===a&&!this.aPa)this.htmlElement.style.borderRight=b}qdl(){if(this.yyl()){var a=ub.GraphIterator.pb(this.gb);if(a.rc(14)){var b=Oc.isFirstCellInRow(a),c=Oc.isLastCellInRow(a);
this.xDc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.xDc=!0);this.JCc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.JCc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.jx(14);a=!Hd.TableReader.Jm(a);this.bDc||(this.htmlElement.style.borderLeft=a?b:c,this.bDc=!0);this.nDc||(this.htmlElement.style.borderRight=a?c:b,this.nDc=!0)}}}yyl(){const a=this.Qc;return a.Uh&&a.features.Gyl?!0:!1}get Qja(){return this.OZ}AK(a){super.AK(a);
this.UU()}UU(){if(!this.Od.lm&&this.HB){const a=Object(sa.a)(712,this.fS);a&&a.l5g(this.OZ)}}get lvb(){return this.cHa}static Dug(a,b){return null!==a&&a.Ta(sb.a.tableLook)?!!(a.properties.eb(sb.a.tableLook)&b):!1}}Object(m.a)(Tv,"TableCellViewElement",QL.a,[766,340,305,108]);class xm extends wk.a{constructor(a,b,c,f=null){super(a,b);this.AS=null;this.mzc=!0;this.Sm=[];this.pv=[];this.pIc=this.PG=null;this.aff=this.Ktf=0;xm.QWa=c;this.kW=f;b=this.Od.vp(Fa.a.div);b.className="TableContainer";this.nk=
this.Od.vp(Fa.a.table);b.appendChild(this.nk);this.nk.className="Table";Sys.UI.DomElement.addCssClass(this.nk,xm.Qwd);this.uxf=a;this.ZBa=this.Od.vp(Fa.a.div);this.ZBa.id=ia.a.create().toString();this.ZBa.className=xm.EIl;this.ZBa.setAttribute(Ne.a.NI,Ne.a.rB);b.insertBefore(this.ZBa,this.nk);rf.c(this.ZBa,!0);a.lm&&xb.d(this.nk,wa.a.border,this.gb.sa(Ya.a.Lmb,!0)?"1":"0");this.jc(b);a.lm||(this.AS=this.Od.vp(Fa.a.JFi),this.nk.appendChild(this.AS));this.XS=this.Od.vp(Fa.a.oKh);this.nk.appendChild(this.XS);
this.hp(this.nk)}get m2(){return this.XS}get table(){return this.nk}get RNc(){return this.AS}az(a){this.nk.style.borderCollapse="collapse";if(Ka.StyleReader.yr)Sys.UI.DomElement.removeCssClass(this.nk,xm.Qwd),Sys.UI.DomElement.removeCssClass(this.nk,xm.X6e);else{var b=this.gb.sa(Ya.a.Lmb,!0);b&&!this.mzc?(Sys.UI.DomElement.removeCssClass(this.nk,xm.X6e),Sys.UI.DomElement.addCssClass(this.nk,xm.Qwd),this.mzc=!0):!b&&this.mzc&&(Sys.UI.DomElement.removeCssClass(this.nk,xm.Qwd),Sys.UI.DomElement.addCssClass(this.nk,
xm.X6e),this.mzc=!1)}M.a.instance.ga(71)&&Ka.StyleReader.yr&&(xb.d(this.nk,wa.a.I3d,"Custom"),xb.d(this.nk,wa.a.H3d,0));var c=this.AS?Hd.TableReader.Gi(this.gb):0;b=this.AS?c-this.AS.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Od.vp(Fa.a.col);this.AS.appendChild(l)}for(f=0;f>b;--f)this.AS.removeChild(this.AS.firstChild);f=eo.b(this.gb);var y=0;this.kW&&(y=this.kW.Mde(this.gb));l=Array(c);var G=!0;b=0;for(var R=0;R<c;++R){let ja=this.l9(R);0<=f[R]?(l[R]=Math.max(ja,this.Od.Nd.Pe(f[R],0)-y),
this.AS.childNodes[R].style.width=l[R]+"px",b+=l[R]):(l[R]=-1,G=!1,this.AS.childNodes[R].style.width="",b+=ja)}if(M.a.instance.ga(63)||M.a.instance.ga(77))G?Sys.UI.DomElement.addCssClass(this.nk,xm.FTh):Sys.UI.DomElement.removeCssClass(this.nk,xm.FTh);if(this.Sm.length===c)for(y=this.mVc(),G=0;G<c;++G)R=this.l9(G),this.Sm[G].childNodes[y].style.width=0<=f[G]?Math.max(R,l[G])+"px":R+"px";c=Hd.TableReader.Jm(this.gb);if(this.gb.Ta(Ya.a.Vl))switch(Hd.TableReader.IL(this.gb)){case 1:this.nk.style.marginLeft=
"";this.nk.style.marginRight="auto";break;case 2:this.nk.style.marginLeft="auto";this.nk.style.marginRight="auto";break;case 3:this.nk.style.marginLeft="auto";this.nk.style.marginRight="";break;case 14:this.nk.style.marginLeft=c?"auto":"";this.nk.style.marginRight=c?"":"auto";break;case 15:this.nk.style.marginLeft=c?"":"auto";this.nk.style.marginRight=c?"auto":"";break;default:this.nk.style.marginLeft="",this.nk.style.marginRight=""}else this.nk.style.marginLeft="",this.nk.style.marginRight="",M.a.instance.ga(63)&&
this.gb.Ta(sb.a.um)&&(f=({unit:a}=Hd.TableReader.Qka(a)).returnValue,a=(new xv.a(a,f)).PRb+"px",c?this.nk.style.marginRight=a:this.nk.style.marginLeft=a);(M.a.instance.ga(71)||M.a.instance.ga(77))&&this.ztl(Ka.StyleReader.yr,this.gb,this.nk);this.gb.properties.sa(Ya.a.Zog,!1)?(Sys.UI.DomElement.addCssClass(this.nk,xm.DOf),xb.d(this.nk,wa.a.oqi,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.nk,xm.DOf),this.nk.removeAttribute(Ne.a.Uca));(a=Hd.TableReader.Xee(this.gb))&&this.nk.setAttribute("title",
a);(a=Hd.TableReader.Wee(this.gb))?this.uxf.lm&&1===this.uxf.mode?this.nk.removeAttribute(Ne.a.Uca):(this.ZBa.innerText=a,this.nk.setAttribute(Ne.a.Uca,this.ZBa.id)):(this.ZBa.innerText="",this.nk.removeAttribute(Ne.a.Uca));wc.a.instance.ik&&!M.a.instance.ga(30)&&(this.nk.style.width="0px");M.a.instance.ga(30)&&(this.nk.style.minWidth=b+"px");this.rol();this.Etl()}rol(){if(this.kW){const a=this.kW.T1l(this.gb);""!==a&&(this.nk.style["border-spacing"]=a);this.$ne&&(this.nk.style.borderCollapse="separate")}}get $ne(){return!!this.kW&&
this.kW.JXj(this.gb)}gae(a){return this.kW?this.kW.i1l(this.gb,a):0}Etl(){this.nk.style.borderTop="";this.nk.style.borderBottom="";this.nk.style.borderLeft="";this.nk.style.borderRight=""}l9(a){return(Ka.StyleReader.yr?Ka.StyleReader.yr.l9(this.gb,a):fo.a.Twd)+(this.kW?this.kW.Mde(this.gb):0)}ztl(a,b,c){a&&(c.style.background=a.Yxj(b))}Dba(a){this.kE(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.nk&&(this.Drc(this.htmlElement,this.nk),this.htmlElement.appendChild(this.nk));
this.kE(this.XS,a,1);let b=!1;this.XS.firstChild!==this.PG&&(this.PG=this.XS.firstChild,b=!0);M.a.instance.ga(30)&&Hd.TableReader.yt(a.currentNode)||!this.AS||(w.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?(a=!1,(this.Sm&&this.Sm.length?this.Sm[0].parentNode:null)!==(this.PG?this.PG.firstChild:null)&&(a=!0),this.csh(b||a)):this.gdl(b),xn.a.qu||this.GXe(b))}mVc(){let a=1;(M.a.instance.ga(63)||M.a.instance.ga(30))&&Hd.TableReader.yt(this.gb)&&(a=0);return a}dispose(){M.a.instance.ga(50)&&
Sc.App.Oh&&Sc.App.Oh.Ew&&this.Xph();this.pv=this.Sm=this.nk=this.XS=this.AS=this.ZBa=this.PG=null;super.dispose()}fV(a){var b=eo.b(this.gb),c=null;if(a.Db(1)){do{var f=a.ir.lMa;c=c?Hv.fGi(c,f):f.copy()}while(a.Pj(1))}c||(c=new Hv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.Nyh(f,Math.max(c.jgj(f),this.Od.Nd.Pe(b[f],0)));b=fo.a.Mmb;c=new Oi.a(b,Math.max(0,c.Ozk()-2*b),b);b=new ub.GraphIterator;b.set(this.gb);f=!1;b.rc(16)&&(f=!0);c=f?new Oi.a(0,c.total,0):new Oi.a(c.Wna,c.minWidth,c.Xna);a.Db(88)&&
(c=Oi.a.max(c,a.ir.lMa),a.Cc());return c}VUj(){this.Xph();this.Sm=[];this.pv=[]}Xph(){if(this.pv)for(var a=0;a<this.pv.length;++a)N.a.eLa(this.pv[a]),Ga.a.sP(this.pv[a]);if(this.Sm)for(a=0;a<this.Sm.length;++a)N.a.eLa(this.Sm[a]),this.pv&&this.pv[a]&&this.pv[a].parentNode&&Ga.a.sP(this.Sm[a])}csh(a){if(this.Sm&&this.PG&&this.PG.firstChild){var b=z.a.Fx||z.a.Io?"":" 16 20",c=String.format("url('{0}'){1}, pointer",Fy.a.box4Image("ColumnSelect.cur"),b);b=eo.b(this.gb);var f=b.length,l=this.PG.firstChild;
if(a){a=Math.min(f,this.Sm.length);for(var y=0;y<a;y++)l.insertBefore(this.Sm[y],l.firstChild)}if(f>this.Sm.length)for(a=this.Sm.length;a<f;a++){y=this.Od.createElement("div");y.className="TableColumnHandleAnchor";rf.c(y,!0);Array.add(this.Sm,y);var G=this.Od.createElement("div");G.className=xn.a.W6e;G.style.cursor=c;y.appendChild(G);G=this.Od.createElement("div");G.className="TableColumnWidthSpacer";y.appendChild(G);l.insertBefore(this.Sm[a],l.firstChild)}if(f<this.Sm.length){for(c=f;c<this.Sm.length;c++)N.a.eLa(this.Sm[c]),
Ga.a.sP(this.Sm[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.Sm[l]);this.Sm=c}c=this.mVc();l=0;for(a=0;a<f;a++)y=this.l9(a),y=Math.max(y,this.Od.Nd.Pe(b[a],0)),this.Sm[a].childNodes[c].style.width=y+"px",this.Sm[a].style.left=l+"px",this.Sm[a].setAttribute("ColumnIndex",a.toString()),l+=y}}gdl(a){var b=z.a.Fx||z.a.Io?"":" 16 20";b=String.format("url('{0}'){1}, pointer",Fy.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.PG.firstChild;var c=Math.min(this.PG.childNodes.length,this.Sm.length);for(var f=
0;f<c;++f)a.insertBefore(this.Sm[f],a.firstChild),a=a.nextSibling}a=this.PG.childNodes.length;if(a>this.Sm.length){c=this.PG.firstChild;for(f=0;f<this.Sm.length;++f)c.insertBefore(this.Sm[f],c.firstChild),c=c.nextSibling;for(f=this.Sm.length;f<a;++f){const y=this.Od.createElement("div");y.className="TableColumnHandleAnchor";rf.c(y,!0);Array.add(this.Sm,y);var l=this.Od.createElement("div");l.className=xn.a.W6e;l.style.cursor=b;y.appendChild(l);l=this.Od.createElement("div");l.className="TableColumnWidthSpacer";
y.appendChild(l);c.insertBefore(y,c.firstChild);c=c.nextSibling}}else if(a<this.Sm.length){for(b=a;b<this.Sm.length;++b)N.a.eLa(this.Sm[b]),Ga.a.sP(this.Sm[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Sm[c]);this.Sm=b;b=this.PG.firstChild;for(a=0;a<this.Sm.length;++a)b.insertBefore(this.Sm[a],b.firstChild),b=b.nextSibling}b=this.mVc();a=eo.b(this.gb);for(c=0;c<this.Sm.length;++c)f=this.l9(c),this.Sm[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Od.Nd.Pe(a[c],0))+"px":f+"px"}GXe(a){if(!this.pv.length){a=
this.Od.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Od.createElement("div");b.className=xn.a.Xwd+" Last";a.appendChild(b);Array.add(this.pv,a);rf.c(a,!0);a=!0}if(a){a=Math.min(this.pv.length,this.PG.childNodes.length);for(b=1;b<a;++b){var c=this.PG.childNodes[b];c.insertBefore(this.pv[b],c.firstChild)}(a=this.PG.lastChild)?a.insertBefore(this.pv[0],a.firstChild):ha.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.PG.childNodes.length;
if(a>this.pv.length){for(b=1;b<this.pv.length;++b)c=this.PG.childNodes[b],c.insertBefore(this.pv[b],c.firstChild);for(b=this.pv.length;b<a;++b){c=this.Od.createElement("div");c.className=xn.a.Xwd;rf.c(c,!0);Array.add(this.pv,c);let f=this.PG.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.PG.lastChild;a.insertBefore(this.pv[0],a.firstChild)}else if(a<this.pv.length){for(b=a;b<this.pv.length;++b)N.a.eLa(this.pv[b]),Ga.a.sP(this.pv[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.pv[c]);this.pv=b;for(a=
1;a<this.pv.length;++a)b=this.PG.childNodes[a],b.insertBefore(this.pv[a],b.firstChild);(a=this.PG.lastChild)?a.insertBefore(this.pv[0],a.firstChild):ha.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}s_e(a,b){let c=-1;if(Hd.TableReader.Jm(this.gb))if(b<=Sys.UI.DomElement.getLocation(this.XS.firstChild.lastChild).x)c=this.XS.firstChild.childNodes.length-1;else for(var f=0;f<this.XS.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.XS.firstChild.childNodes[f]);
if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.XS.firstChild.firstChild).x)c=0;else for(f=this.XS.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.XS.firstChild.childNodes[f]),b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=ub.GraphIterator.pb(this.gb);const y=new ub.GraphIterator;b=new pf.GraphTransaction(2);b.Xy(l);ae.moveToFirstRow(l);ae.moveToColumnByIndex(l,a);y.Tc(l);ae.moveToColumnByIndex(y,c);do(a=Vd.SelectionFactory.xPc(l,y))&&Array.add(f,a),
ae.moveToNextRow(y);while(ae.moveToNextRow(l));a=new oa.SelectionCollection(f,f.length-1,0);this.Qc.Nb.gF(a);b.dispose()}Mtc(a,b){const c=this.mVc();this.Sm&&a<this.Sm.length&&this.Sm[a]&&(this.Sm[a].childNodes[c].style.width=Math.max(this.l9(a),b)+"px");this.AS.childNodes[a].style.width=Math.max(1,b)+"px"}Lhj(a){return this.XS.firstChild.childNodes[a]?this.XS.firstChild.childNodes[a].offsetWidth:(ha.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",
a,this.XS.childNodes.length,this.XS.firstChild.childNodes.length),0)}tVc(a){a=parseInt(this.AS.childNodes[a].style.width);return isNaN(a)?fo.a.U6e:a}m7(a){super.m7(a);M.a.instance.ga(63)&&this.NUl();this.Eaf()}Eaf(){this.pIc||(this.pIc=new pd.a(3,1,0,Object(H.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),w.AFrameworkApplication.De.Hb(this.pIc))}updateTableDOMElements(){this.pIc=null;this.m2&&(M.a.instance.ga(63)?this.mZk(this.w4k()):xn.a.qu&&this.QSe(this.Pde()),w.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&
this.csh(!1))}vzd(){this.Adl()}ifj(a){return a.offsetWidth+this.gae(0)/2}Pde(){const a=this.xUa(),b=a.length,c=[];let f=0,l=!1;const y=Hd.TableReader.yt(this.gb);for(let R=0;R<b;R++){const ja=a[R];if(y){let Va;({Ard:Va}=this.Ayd(ja)).returnValue&&(l=Dk.f(Va.gb))}const za=ja.childNodes;for(let Va=0;Va<za.length;Va++){var G=za[Va];if(void 0!==G.colSpan&&null!==G.colSpan&&void 0!==G.rowSpan&&null!==G.rowSpan){let hb;({vZd:hb}=this.v9e(G)).returnValue&&(G=Object.assign(new PL,{ERa:hb,left:G.offsetLeft,
top:this.$ne?ja.offsetTop:f,width:this.ifj(G),height:G.offsetHeight,xqg:!R,xrg:R+G.rowSpan===b,sqg:!l&&!Va}),c.push(G))}}f+=ja.offsetHeight}return c}NUl(){if(this.m2){var a=new ub.GraphIterator;a.set(this.gb);if(Hd.TableReader.ZOf(a)&&this.AS){a=this.AS.childNodes.length;var b=Array(a),c=[],f=this.xUa(),l=f.length,y=0;for(let G=0;G<l;G++){let R=0;const ja=f[G],za=ja.childNodes;let Va=0;for(let hb=0;hb<a;hb++){let Cb;if(b[hb]){let lc;(lc=b[hb]).TZc=lc.TZc-y;let ic;(ic=b[hb]).yrd=ic.yrd-1;Cb=b[hb].colSpan;
1===b[hb].yrd&&(R=Math.max(R,b[hb].TZc),b[hb]=null)}else{const lc=za[Va];Va++;if(!lc)continue;let ic=0,yc;({vZd:yc}=this.v9e(lc)).returnValue&&(ic=yc.I7b());Cb=lc.colSpan;1<lc.rowSpan?b[hb]=Object.assign(new ML,{colSpan:lc.colSpan,TZc:ic,yrd:lc.rowSpan}):R=Math.max(R,ic)}hb+=Cb-1}({Ard:y}=this.Ayd(ja)).returnValue?(y.pol(R)&&c.push(y),y=y.ivh):y=0}for(const G of c)G.MUl()}}}Adl(){const a=this.xUa();if(Sc.App.instance.U1c&&a.length&&!(a.length<=this.Ktf&&a[0].childNodes.length===this.aff)){this.Ktf=
a.length;this.aff=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!Ga.a.Rda(a[c].firstChild,"DragHandle")&&({Ard:b}=this.Ayd(a[c])).returnValue&&b.idl()}}Qog(a,b){b=a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}QSe(a){if(a)for(const b of a)b.ERa.Dxc(b.left,b.top,b.width,b.height,b.xqg,b.xrg,b.sqg)}xUa(){return this.m2.children}v9e(a){let b;b=null;a&&(a=rf.a(a),b=Object(sa.a)(Tv,a));return{returnValue:!!b,vZd:b}}Ayd(a){let b;b=null;a&&(a=rf.a(a),b=Object(sa.a)(nu,a));return{returnValue:!!b,
Ard:b}}w4k(){let a=0;const b=Hd.TableReader.yt(this.gb),c=this.$ne,f=this.xUa(),l=[];let y=!1;for(let R=0,ja=f.length;R<ja;R++){const za=f[R];if(!za)continue;if(b){let lc;({Ard:lc}=this.Ayd(za)).returnValue&&(y=Dk.f(lc.gb))}const Va=new OL,hb=!R,Cb=za.childNodes;for(let lc=0,ic=Cb.length;lc<ic;lc++){var G=Cb[lc];let yc;if(({vZd:yc}=this.v9e(G)).returnValue){const ec=G.offsetTop,jc=G.rowSpan,xd=!lc;G=Object.assign(new NL,{ERa:yc,left:G.offsetLeft,offsetTop:ec,top:c?ec:a,width:G.offsetWidth,height:G.offsetHeight,
rowSpan:jc,crg:hb,drg:R+jc===ja,brg:!y&&xd,djg:!xd&&this.Qog(G,zd.a.Rje),zig:!hb&&this.Qog(G,zd.a.Qje)});Va.jTd(G)}}a+=za.offsetHeight;l.push(Va)}return l}mZk(a){if(a.length){var b=this.gae(1)/2,c=this.gae(0)/2,f=a[0].cells[0].ERa,l=f.irg(!1);f=f.irg(!0);var y=[];for(var G of a[0].cells){var R=G.ERa.gSl(G.left,G.width+c,G.offsetTop,l);R&&y.push(R)}xn.a.i7k(y);l=[];for(G=0;G<a.length;G++)y=a[G].cells[0],(R=y.ERa.PUl(y.height+b,y.offsetTop,f))&&l.push(R),1<y.rowSpan&&(G+=y.rowSpan-1);xn.a.Y8k(l);for(const ja of a)for(const za of ja.cells)a=
za.ERa,f=za.width,l=za.height,a.LUl(f,l+b,za.offsetTop,za.left),a.Dxc(za.left,za.top,f+c,l,za.crg,za.drg,za.brg),za.djg&&a.aqh(zd.a.Rje),za.zig&&a.aqh(zd.a.Qje)}}}xm.Qwd="Border";xm.X6e="NoBorder";xm.DOf="Conflict";xm.FTh="TableWordWrap";xm.EIl="WACAltTextDescribedBy";xm.QWa=null;Object(m.a)(xm,"TableViewElement",wk.a,[1325,340,305,108]);class Uv extends nu{constructor(a,b,c){super(a,b,c,null,null)}AOb(a){this.htmlElement.style.height=a+"px"}get hvh(){return this.Od.Nd.Pe(this.gb.sa(va.a.Ku,0),1)+
"px"}static kfg(a){a=rf.a(a);let b=null;a&&(b=Object(sa.a)(Uv,a));return b}}Object(m.a)(Uv,"TableRowViewElement",nu,[]);class ay{constructor(a,b,c=!1){this.oti=a;this.qCj=b;this.PQc=c}}Object(m.a)(ay,"TableBorderProperty",null,[]);var Ll=d(509);class kq{constructor(a,b,c,f,l){this.n$=a;this.lc=c;this.Tb=b;this.GHb=f;this.Mnk=l}Grj(a){switch(a){case 0:a=sb.a.cQb;break;case 1:a=sb.a.dQb;break;case 2:a=sb.a.fQb;break;case 3:a=sb.a.gQb;break;default:a=null}return{returnValue:!!a,cyk:a}}Pta(a,b){let c=
0;if(!a)return c;let f;({cyk:f}=this.Grj(b)).returnValue&&(c=3===b||0===b?a.sa(f,.1):a.sa(f,kq.wVk));return c}nJf(a){return.0555555555555556+this.Pta(a,1)+this.Pta(a,2)}RYd(a,b){const c=Hd.TableReader.Ek(a);if(0>b||b>=c)return.0555555555555556;a=this.Tb.Lc(a).hq(b,1);return this.rMc(a)}rMc(a){let b=.0555555555555556;a=this.Tb.Lc(a);a.Db(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.Pta(c,0)+this.Pta(c,3))}while(a.Hf(1));return b}wub(a,b){var c=Hd.TableReader.Gi(a);if(0>b||b>=c)return.0555555555555556;
c=.0555555555555556;a=this.Tb.Lc(a);a.Db(1);do{const f=a.hq(b,1);c=Math.max(c,this.nJf(f));a.Cc()}while(a.Hf(1));return c}nbe(a){return a&&a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:Ll.a.gwb}Yee(a,b){let c=b;if(this.Mnk&&b&&b.cellShading){let f;({ama:f}=this.A9e(a,b.cellShading)).returnValue&&(b=Object(sa.a)(115,this.lc.jg(b)),c=this.GHb.euh(a,b?b.Fd:null,f))}return c}D7b(a,b){let c=Ll.a.fwb;const f=kq.sUa(b);
f.returnValue&&(a=this.Yee(b,a),a.Ta(f.pRa)&&(c=a.eb(f.pRa)));return c}i$d(a,b,c){if(c&&c.ND===oc.a.auto)return gj.a.none;a=this.dij(a);b=this.Y$d(b);c=c.FV();return String.format("{0} {1}px {2}",a,b,c)}Y$d(a){a=this.n$.Pe(a,0);z.a.kva&&0<a&&1>a&&(a=1);return a}Rtb(a,b,c=!1){let f=oc.a.xSa.FV();if(a.solidFillField){var l=Hf.Box4ColorHelper.YH(Hf.Box4ColorHelper.Vga(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.FV()}else if(a.gradFillField){a=up.f(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=
l.color.g=l.color.b=255;f=a.FV()}return f}RBj(a){const b=a.currentNode.Ai;a.Cc();const c=a.YF(1);a.hq(b,1);return c?a.currentNode:null}WBj(a){return a.YF(1)}A9e(a,b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,ama:a}}dij(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static sUa(a){let b,c;switch(a){case 7:a=
va.a.Iza;b=va.a.zMa;c=va.a.iIl;break;case 0:a=va.a.fha;b=va.a.dha;c=va.a.dIl;break;case 5:a=va.a.Hza;b=va.a.yMa;c=va.a.gIl;break;case 6:a=va.a.gha;b=va.a.eha;c=va.a.hIl;break;case 2:a=va.a.Kmb;b=va.a.Imb;c=va.a.fIl;break;case 1:a=va.a.Jmb;b=va.a.Hmb;c=va.a.eIl;break;default:c=b=a=null}return{returnValue:!!a,pRa:a,b8a:b,$tb:c}}}kq.wVk=.2;Object(m.a)(kq,"TableStyleReaderHelper",null,[297]);class RD{constructor(a,b,c=-1){this.vY=a;this.wBg=b;this.vIg=c}}Object(m.a)(RD,"TableStyle",null,[]);var vr=d(337);
class Pz{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie){this.vY=new Qe.a;this.Cfd=new Qe.a;this.Bfd=new Qe.a;this.xfd=new Qe.a;this.c7e=[];this.Tb=a;this.KH=c;this.lc=b;this.il=f;this.n$=l;this.r1=y;this.hJa=G;this.ic=R;this.mIe=ja;this.wvk=za;this.rvk=Va;this.ivk=hb;this.zc=Cb;this.CZa=lc;this.WJ=ic;this.Zo=yc;this.Vq=ec;this.jfb=jc;this.Had=xd;this.iFb=Xd;this.UHa=Qd;this.uYa=Ie;this.hJa.ija(Object(H.a)(this,this.gld,"onTableConnectedOrDisconnected"));this.hJa.p8(Object(H.a)(this,
this.gld,"onTableConnectedOrDisconnected"));this.hJa.gk(Object(H.a)(this,this.veh,"onTablePropertyChanged"));this.Vq.Mji(Object(H.a)(this,this.sch,"onPageViewBeforeValidate"))}dispose(){this.hJa.Xoa(Object(H.a)(this,this.gld,"onTableConnectedOrDisconnected"));this.hJa.jLa(Object(H.a)(this,this.gld,"onTableConnectedOrDisconnected"));this.hJa.Qm(Object(H.a)(this,this.veh,"onTablePropertyChanged"));this.Vq.Pbl(Object(H.a)(this,this.sch,"onPageViewBeforeValidate"))}P6f(a){if(!a||!a.length)return null;
const b=this.kVc(Object(sa.a)(Ig.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.kVc(Object(sa.a)(Ig.a,a[c]));if(!f||f.ND!==b.ND)return null}return b}Kee(a){let b=null;if(a=this.i9b(a))b=new Cq.a,b.Ae(va.a.tableStyle,new RD(a,Number.MAX_VALUE));return b}rYc(a){if(14!==a.type){a=this.Tb.Lc(a);a.rc(14);var b=a.Jg(14)}else b=a;a=b.id;this.Bfd.Gb(a)||(b=this.Lee(b),this.Bfd.$(a,this.rvk(b)));return this.Bfd.ga(a)}Snj(a){return(a=this.ic.W8b(Object(sa.a)(115,this.lc.jg(a))))?a.TableListStyle:
null}Lee(a){const b=Object(sa.a)(115,this.lc.jg(a));return this.mIe(()=>a.jV,()=>a.K3,()=>a.tableLook,()=>this.Snj(a),()=>b?b.Fd:null,()=>this.i9b(a))}gld(a,b){this.Bng(b.node)}veh(a,b){a=b.property;b=b.node;if(a===va.a.Mza||a===va.a.Nvc||a===Ya.a.Lza||a===Ya.a.hha||a===Ya.a.yB){if(a===Ya.a.Lza||a===Ya.a.yB)b.Ovc=!1;a!==va.a.Mza&&a!==va.a.Nvc||this.Bng(b);this.Iac(b)}}Fyk(a){Array.contains(this.c7e,a)||(this.Iac(a),this.c7e.push(a))}sch(){Array.clear(this.c7e)}iVj(a){this.xfd.remove(a.id)}Bng(a){a=
a.id;this.vY.remove(a);this.Cfd.remove(a);this.Bfd.remove(a)}pYc(a){const b=a.id;this.xfd.Gb(b)||this.xfd.$(b,this.ivk(this.Lee(a)));return this.xfd.ga(b)}i9b(a){const b=a.id;if(this.vY.Gb(b))return this.vY.ga(b);var c=a.sa(va.a.Mza,null);if(!c)return null;let f=null;const l=ir.g0f(c);l&&a.Nh&&(f=a.Nh.Be(l));a=null;if(f)a=Eg.a.VTa(f,va.a.tableStyle);else if(c=this.r1.eeg("{"+c.toString()+"}"))a=c.vY;a&&this.vY.$(b,a);return a}zce(a){return a.tableLook}l9(a,b){a=this.il.wub(a,b);return this.n$.Pe(a,
0)}hfj(a){if(a.Ta(va.a.HP))switch(a.sa(va.a.HP,0)){case 2:return"bottom";case 1:return"middle"}return"top"}Q6f(a){var b=null;if(!a)return null;if(a.cellShading){var c=up.a(a.cellShading);up.e(c)||(b=c)}b||(b=this.bla(a,va.a.cellShading,Ll.a.gwb));c=Object(sa.a)(115,this.lc.jg(a));b=this.il.Rtb(b,c?c.Fd:null,this.jfb);a.rowIndex||1!==a.Ai||ya.a.J(509137695,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}kVc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=up.a(a.cellShading);
up.e(f)||(b=f)}b||(b=this.bla(a,va.a.cellShading,Ll.a.gwb));a=(a=Object(sa.a)(115,this.lc.jg(a)))?a.Fd:null;(b=b.solidFillField)&&(c=Hf.Box4ColorHelper.GEa(b,a));return c}Lab(a){var b=null;var c=Object(sa.a)(5,a);c&&(a=c.sa(sb.a.listLevel,Ke.a.xFa),c=this.Tb.Lc(c),c.rc(7)&&Hd.TableReader.Ks(c)&&(c=Object(sa.a)(im.TableCellNode,c.Jg(16))))&&(this.Rjh(c),b=1+a,b=this.KH.L6f(c,this.rYc(c),b));return{tableStyle:b,P8a:null}}Yxj(a){let b=Eg.a.ui(a,va.a.cellShading,Ll.a.gwb);if(up.e(b)){const c=this.i9b(a);
c&&(b=this.il.nbe(c))}a=Object(sa.a)(115,this.lc.jg(a));return this.il.Rtb(b,a?a.Fd:null)}lij(a){return!qd.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?Ll.a.fwb:Ll.a.EUi}Fjj(a,b){if(this.Had&&this.Zo.gU&&!this.mXj(a,b))return new ay("","");var c=Object(sa.a)(130,a);if(({pRa:y,b8a:G,$tb:R}=kq.sUa(b)).returnValue)if(this.uYa&&qd.a("TableBordersLocalRenderingFix")){var f=this.bla(c,y,this.lij(b),!0);var l=this.bla(c,R,Ll.a.ewb,!0);var y=c.sa(y,f);f={};if(qd.a("FixClearTableBorder")){let ja=this.Tb.Lc(c);
ja.rc(14);if(ja.Jg(14).Ta(va.a.Mza)){f.Color="##T,0,0,0";f=Hf.Box4ColorHelper.vS(f);f=this.bla(c,G,f,!0);var G=Eg.a.ui(c,G,f);G=Hf.Box4ColorHelper.Vga(G);a=this.lc.jg(a);a=(a=Hf.Box4ColorHelper.YH(G,a?a.Fd:null))?Hf.Box4ColorHelper.nha(a):null}else qd.a("FixTableBorderColor")?(f.Color="##T,1,0,0",f=Hf.Box4ColorHelper.vS(f),f=this.bla(c,G,f,!0),G=Eg.a.ui(c,G,f),G=Hf.Box4ColorHelper.Vga(G),a=this.lc.jg(a),a=(a=Hf.Box4ColorHelper.YH(G,a?a.Fd:null))?Hf.Box4ColorHelper.nha(a):null):(f.Color="#000000",
a=Hf.Box4ColorHelper.vS(f),a=Hf.Box4ColorHelper.Ita(a))}else f.Color="##T,0,0,0",f=Hf.Box4ColorHelper.vS(f),f=this.bla(c,G,f,!0),G=Eg.a.ui(c,G,f),G=Hf.Box4ColorHelper.Vga(G),a=this.lc.jg(a),a=(a=Hf.Box4ColorHelper.YH(G,a?a.Fd:null))?Hf.Box4ColorHelper.nha(a):null;l=c.sa(R,l)}else l=this.il.Yee(b,c),y=l.Ta(y)?l.eb(y):this.bla(c,y,Ll.a.fwb,!0),a=this.I6f(l,c,G),l=l.Ta(R)?l.eb(R):this.bla(c,R,Ll.a.ewb,!0);else y=Ll.a.fwb,a=Ll.a.eQc,l=Ll.a.ewb;5!==b||a.ND===oc.a.auto||c.rowIndex||1!==c.Ai||ya.a.J(509137694,
822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.ND,a.alpha);var R=!1;a.ND!==oc.a.auto||7!==b&&5!==b||(f=this.Tb.Lc(c),f.rc(14),7===b?(G=va.a.dha,f=this.il.RBj(f)):(G=va.a.eha,f=this.il.WBj(f)),f&&(c=this.il.Yee(b,c),this.I6f(c,f,G).ND===oc.a.auto&&(l=Ll.a.ewb,y=Ll.a.pCj,a=Ll.a.oCj,R=!0)));c=this.il.i$d(l,y,a);return R&&7===b?new ay(c,"Top"):R&&5===b?new ay(c,"Left"):new ay(c,"")}aWc(a,b){switch(b){case 7:b=va.a.Iza;break;case 6:b=va.a.gha;break;case 0:b=va.a.fha;break;case 5:b=va.a.Hza;break;
default:b=null}const c=this.bla(a,b,Ll.a.fwb,!0);return a.sa(b,c)}mXj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Tb.Lc(a);if(!c.rc(14))return!0;var f=c.jx(14);if(!f.Op())return!0;const l=a.rowSpan,y=a.colSpan;if(1===l&&1===y)return!0;f=this.zc.Vxj(f);const G=new vr.a;G.ve=this.CZa.Gtj(c);G.eg=G.ve+l;G.oe=this.WJ.uVc(Object(sa.a)(130,a));G.Tf=G.oe+y;switch(b){default:ya.a.J(509137693,822,15," Unknown position type: {0} ",b);break;case 5:if(!G.oe||1===l)break;if(4!==(f.Ds(G.ve,G.oe-
1)&4)||8!==(f.Ds(G.eg-1,G.oe-1)&8))break;for(a=G.ve+1;a<G.eg;++a)if(4===(f.Ds(a,G.oe-1)&4))return!1;break;case 6:if(G.Tf===f.WR||1===l)break;if(4!==(f.Ds(G.ve,G.Tf)&4)||8!==(f.Ds(G.eg-1,G.Tf)&8))break;for(a=G.ve+1;a<G.eg;++a)if(4===(f.Ds(a,G.Tf)&4))return!1;break;case 7:if(!G.ve||1===y)break;if(1!==(f.Ds(G.ve-1,G.oe)&1)||2!==(f.Ds(G.ve-1,G.Tf-1)&2))break;for(a=G.oe+1;a<G.Tf;++a)if(1===(f.Ds(G.ve-1,a)&1))return!1;break;case 0:if(G.eg!==f.mP&&1!==y&&1===(f.Ds(G.eg,G.oe)&1)&&2===(f.Ds(G.eg,G.Tf-1)&2))for(a=
G.oe+1;a<G.Tf;++a)if(1===(f.Ds(G.eg,a)&1))return!1}return!0}I6f(a,b,c){if(this.uYa){const f=Hf.Box4ColorHelper.vS({Color:"##T,0,0,0"});a=Eg.a.ui(a,c,f);a=Hf.Box4ColorHelper.Vga(a);b=this.lc.jg(b);b=(b=Hf.Box4ColorHelper.YH(a,b?b.Fd:null))?Hf.Box4ColorHelper.nha(b):null}else a.Ta(c)?(b=a.Sh(c),b=Object(Sa.a)(oc.a,b)?b:new oc.a(a.eb(c))):b=this.bla(b,c,Ll.a.eQc,!0);this.jfb&&(b=new oc.a(0,b.alpha));return b}Iac(a){const b=this.UHa?this.Tb.tce(a):this.Tb.Lc(a);let c=Object(sa.a)(157,b.Ri());for(a=Object(sa.a)(161,
a);c;)c.wrd=!1,c=Object(sa.a)(157,b.xp());this.iVj(a);this.UHa?this.SUj(a):a.sea(4)}SUj(a){if(a&&a.isConnected)for(a=this.Tb.tce(a),a=He.a.zv(a);a.moveNext();)a.currentNode.anchor.Nr(4)}aZl(a){a&&(this.rYc(a),this.i9b(a),this.pYc(a))}bla(a,b,c,f=!1){if(!a)return c;var l=this.Tb.Lc(a);l.rc(14);l=l.Jg(14);var y=l.id;if(this.iFb&&f){if(!l.Ta(va.a.Mza))return c;y=a.rowIndex;a=a.Ai;return(a=this.pYc(l).Aej(l,y,a))&&a.Ta(b)?a.Sh(b):c}this.Rjh(a);f=a.wV;if(!f){if(!l.Ta(va.a.Mza))return c;f=a.rowIndex;let G=
a.Ai;const R=a.rowSpan,ja=a.colSpan;this.Cfd.Gb(y)||this.Cfd.$(y,this.wvk(this.Lee(l)));f=this.Cfd.ga(y).dae(f,G,R,ja);a.wV=f}return f&&f.Ta(b)?f.Sh(b):c}Dyi(a){const b=this.Tb.fUa();b.set(a);let c=0,f=Object(sa.a)(157,b.Db(1));for(;f;)f.rowIndex=c,c++,f=Object(sa.a)(157,b.xp());a.Ovc=!0}jXk(a){let b=0;const c=a.rowIndex,f=this.Tb.fUa();f.set(a);let l=Object(sa.a)(130,f.Db(1));for(;l;)l.rowIndex=c,l.Ai=b,l.wV=null,this.KH.tfl(l),l.mZf(),l=Object(sa.a)(130,f.xp()),b++;a.wrd=!0}Rjh(a){var b=this.Tb.Lc(a);
b.rc(14);a=Object(sa.a)(157,b.Jg(15));(b=Object(sa.a)(161,b.Jg(14)))&&!b.Ovc&&this.Dyi(b);a&&!a.wrd&&this.jXk(a)}}Object(m.a)(Pz,"TableStyleReader",null,[1326,1327,1328]);class Wl extends xm{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){super(a,b,c);this.Uad=this.Wv=this.bHb=this.Jva=this.DH=null;this.Okc=l;this.il=y;this.Zo=G;this.af=R;this.m1=[];this.ic=f;this.ugb=hb;this.pc=Cb;this.lc=lc;this.lj=ic;this.lFb=za.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.$Be=za.pptComplexTableLayoutSyncEnabled;
this.Z0=za.gla;this.rXg=Va;this.zc=yc;this.Tb=ec;this.pDe=za.Jaa;this.Jad=za.UJh;if(jc)this.Wv=jc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Qc.yp){if(this.DH=ja?ja(a):null)this.DH.xOh(),this.Pk&&this.Pk.nV&&(this.DH.Ksi(this,this.Pk.nV,this.table),this.DH.Xw(!this.pc.Ho));qd.a("DeprecateIE.TableViewElement.ctor")||!this.Zo.Ccb&&!this.Zo.Ecb||(this.htmlElement.style.backgroundColor="rgba(0,0,0,0)")}this.Pk&&(this.Pk.qji(Object(H.a)(this,this.tdh,"onShapeEnterTextEditing")),this.Pk.ABf(Object(H.a)(this,
this.Cdh,"onShapeSelectionChanged")),this.Pk.sji(Object(H.a)(this,this.udh,"onShapeExitTextEditing")),this.Pk.Sii(Object(H.a)(this,this.L9g,"onAfterDraw")),this.Pk.Hki(Object(H.a)(this,this.Och,"onReadModeChanged")),this.Pk.oji(Object(H.a)(this,this.lah,"onDisplayOnActiveSlide")))}get hDi(){return this.DH}lah(){this.P6e()}get Pk(){if(this.Jva)return this.Jva;if(this.Qc.yp){const a=wf.a.pb(this.Qc.Na,this.gb);a.kf();a.V0a();this.Jva=Object(sa.a)(117,a.tSa)}return this.Jva}sde(){if(!this.Jad)return 1;
var a=this.lc.jg(this.gb);if(!a)return 1;var b=a.qc(this.Na);if(!b)return 1;b=b.hda?b.hda.xa.style.visibility===Ui.a.visible:!1;var c=new sr.a(a.Xp,a.Xk);if(!this.Wv)return 1;b=this.Wv.T8b(c,b).xP;c=this.lj.$G;a=this.ic.eYc(a)*c;return b/a}Mwh(a){if(1!==a&&this.Jad){var b=this.zc.ala(this.gb);for(var c of b)b=this.Od.Nd.Pe(c.sa(va.a.Ku,0),1)*a,c.qc(this.Na).htmlElement.style.height=b+"px";c=eo.b(this.gb);for(b=0;b<c.length;b++){const f=this.Od.Nd.Pe(c[b],0)*a;this.RNc.childNodes[b].style.width=f+
"px"}}}az(a){super.az(a);this.Mwh(this.sde());this.CLh(this.ugb.$Ab?!!this.Pk&&this.Pk.mJ()&&(this.Pk.GB||this.Pk.lo):!!this.Pk&&this.Pk.lo)}fV(){const a=this.Okc,b=eo.b(this.gb),c=Hd.TableReader.Gi(this.gb);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.l9(this.gb,l),this.Od.Nd.Pe(b[l],0));return new Oi.a(0,f,0)}m7(a){super.m7(a);if(this.Qc.yp&&(a=this.rXg.YXc(this.gb,this.Na))&&0!==a.R0c){const b=this.gb;if(b.tO)return;this.$Be?a.xQh(b):a.R0c&2?a.xQh(b):a.GTl(b,c=>{c&&this.P6e()})}this.P6e()}P6e(){this.DH&&
this.Pk&&this.Pk.lo&&this.O6e()}XAh(a,b){Object(sa.a)(Pz,Ka.StyleReader.yr);if(1!==b)for(var c=0;c<this.m2.childNodes.length;c++){var f=this.m2.childNodes[c];if(!f||"TR"!==f.tagName.toUpperCase())continue;const y=f.offsetHeight*b;var l=this.il.RYd(this.gb,c);l=this.Od.Nd.Pe(l,1);f.style.height=(y<l?0:y)+"px"}if(1!==a)for(b=0;b<this.RNc.childNodes.length;b++)c=k.a.Sn(this.RNc.childNodes[b].style.width),f=this.il.wub(this.gb,b),f=this.Od.Nd.Pe(f,0),this.Mtc(b,Math.max(c*a,f))}ztj(a){a>this.m2.childNodes.length&&
Error.argumentOutOfRange("rowIdx");const b=this.m2.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return k.a.Sn(b.style.height)}f9b(){return Ce.a.Pda(this.af.mi(this.table))}get V1j(){const a=this.rXg.YXc(this.gb,this.Na);return!a||0===a.R0c}rcg(){const a=[0];for(let b=1;b<=this.m2.childNodes.length;++b)a[b]=a[b-1]+this.m2.childNodes[b-1].offsetHeight;return a}i7f(){const a=[0];for(let b=1;b<=this.RNc.childNodes.length;++b)a[b]=
a[b-1]+this.tVc(b-1);return a}GXe(a){if(14!==this.gb.type)ya.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.gb.type);else if(this.gb.sa(va.a.complexTable,!0))ya.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.GXe(a);a=new ub.GraphIterator;a.set(this.gb);ae.moveToFirstRow(a);ae.moveToFirstColumn(a);let b=1;const c=this.Od.Nd.Pe(this.il.D7b(a.currentNode,6),0);for(;!Oc.isLastCellInRow(a);){ae.moveToNextColumn(a);
const f=this.pv[b++],l=k.a.Pc(-1*c);Hd.TableReader.Jm(this.gb)?f.style.marginRight=l:f.style.marginLeft=l}this.pv.length!==b&&ya.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.pv.length,b)}}Dba(a){super.Dba(a);this.Qc.lm||this.Cdl();this.gb.sa(va.a.complexTable,!0)||xn.a.qu||this.Bdl()}dispose(){super.dispose();this.DH&&(this.DH.dispose(),this.DH=null);this.Pk&&(this.Pk.Bbl(Object(H.a)(this,this.tdh,"onShapeEnterTextEditing")),this.Pk.Krh(Object(H.a)(this,
this.Cdh,"onShapeSelectionChanged")),this.Pk.Cbl(Object(H.a)(this,this.udh,"onShapeExitTextEditing")),this.Pk.kbl(Object(H.a)(this,this.L9g,"onAfterDraw")),this.Pk.qcl(Object(H.a)(this,this.Och,"onReadModeChanged")),this.Pk.zbl(Object(H.a)(this,this.lah,"onDisplayOnActiveSlide")));this.Jva=null}L9g(){this.Pk.fM&&this.O6e(!0)}dBi(){if(this.pDe){var a=this.gb,b=a.Kab();if(a.Ovc)for(const c of b){a=c;if(!a)continue;a=a.qc(this.Na);if(!a)continue;b=this.Okc.aWc(c,7);const f=this.Okc.aWc(c,6),l=this.Okc.aWc(c,
0),y=this.Okc.aWc(c,5);0===b&&a.Epd("Top");0===f&&a.Epd("Right");0===l&&a.Epd("Bottom");0===y&&a.Epd("Left")}}}Cdh(a,b){this.CLh(b.isSelected);a=this.table;this.dBi();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}Och(a,b){this.DH&&this.DH.Xw(b.x5j)}CLh(a){if(this.DH)if(this.Z0){const b=this.Tb.Lc(this.gb);b.kf();b.V0a().eb(va.a.isResizable)?
this.DH.visible=a:this.DH.visible=!1}else this.DH.visible=a;this.Pk&&this.Pk.Rd&&this.Pk.shapeNode&&this.Pk.shapeNode.bR&&(this.Pk.Rd.visible=a)}Bdl(){if(!this.m1.length){var a=this.iSa();Sys.UI.DomElement.addCssClass(a,"First");this.m1.push(a);a=this.iRi();Sys.UI.DomElement.addCssClass(Wl.F9f(a),"Last");this.m1.push(a)}var b=this.xUa();a=b.length;var c=a+1-this.m1.length;if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.iSa();this.m1.splice(this.m1.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.nMb(this.m1[f+
1]);this.m1.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.m1[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.m1[a],b.firstChild);this.wmi()}}wmi(){const a=new ub.GraphIterator;a.set(this.gb);ae.moveToFirstRow(a);ae.moveToFirstColumn(a);let b=1;for(;b<this.m1.length;){var c=this.Od.Nd.Pe(this.il.D7b(a.currentNode,5),0),f=this.Od.Nd.Pe(this.il.D7b(a.currentNode,0),1);let l=this.m1[b];Wl.s8j(l)&&(l=Wl.F9f(l));c=k.a.Pc(-1*c);f=k.a.Pc(-1*f-(b===this.m1.length-1?4:0));Hd.TableReader.Jm(this.gb)?
l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;ae.moveToNextRow(a);b++}}Cdl(){if(!this.bHb){const a=String.format("url('{0}'), pointer",Fy.a.box4Image("RowSelect.cur"));this.bHb=this.Od.createElement("div");this.bHb.className=wj.a.SIl;rf.c(this.bHb,!0);const b=this.Od.createElement("div");b.className=wj.a.Y6e;b.style.cursor=a;this.bHb.appendChild(b);this.table.appendChild(this.bHb)}}Atj(){return this.xUa()}iSa(){const a=this.Od.createElement("div");a.className="TableRowResizeHandle";
a.style.width="100%";rf.c(a,!0);return a}iRi(){const a=this.Od.createElement("div");a.className="TableRowResizeAnchor";const b=this.iSa();a.appendChild(b);rf.c(a,!0);return a}nMb(a){N.a.eLa(a);Ga.a.sP(a)}Nxj(a){var b=this.lc.jg(this.gb);let c=this.lj.$G;b&&b.lx&&null!=b.lx.ps&&(c=b.lx.ps);b=this.ic.eYc(this.lc.jg(this.gb))*c;a=a.copy();a.move(-a.kc,-a.mc);a.scale(1/b,1/b);return a}tdh(){this.table.clientWidth&&this.O6e(!0);!this.ugb.$Ab&&this.DH&&(this.DH.visible=!0,this.Pk&&this.Pk.Rd&&(this.Pk.Rd.visible=
!0));this.Pk&&this.Pk.mJ()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}udh(){this.DH&&(this.DH.visible=!1);this.Pk&&this.Pk.Rd&&(this.Pk.Rd.visible=!1)}O6e(a=!1){var b=this.f9b();let c=Gi.a.WAd;this.Uad&&(c=Ce.a.s8b(b,this.Uad));const f=cd.a.Rbf;a=!!this.Pk&&(!this.Uad||!f.equals(cd.a.Rbf)||!c.equals(Gi.a.WAd)||a);this.Uad=b;if(a&&(a=this.Pk.C$e,b=Ce.a.s8b(this.Nxj(b),a),this.Pk.setOffsets(b,!0),!qd.a("DeprecateIE.TableViewElement.SynchronizeViews")&&
this.Zo.Ccb&&0<this.m2.childNodes.length))for(b=this.m2.childNodes[0].offsetWidth,a=0;a<this.m1.length;a++)this.m1[a].style.width=b+"px";this.DH&&this.DH.em();this.lFb||this.Eaf()}Pde(){return this.lFb?null:super.Pde()}QSe(a){if(this.lFb){var b=this.zc.Ek(this.gb);a=Object(sa.a)(ub.GraphIterator,this.Tb.Lc(this.gb));ae.forEachCellInTable(a,(c,f,l)=>{c=c.currentNode;const y=c.qc(this.Na);y&&y.Dxc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.QSe(a)}qpj(a){let b=-1;var c=Hd.TableReader.Gi(this.gb),
f=eo.b(this.gb);const l=Array(c);for(let y=0;y<c;y++)l[y]=Math.floor(this.Od.Nd.Pe(f[y],0));if(Hd.TableReader.Jm(this.gb))if(a<=Sys.UI.DomElement.getLocation(this.m2.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.m2.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=Sys.UI.DomElement.getLocation(this.m2.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.m2.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=
l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}wxh(a,b,c=!0){const f=ub.GraphIterator.pb(this.gb),l=new ub.GraphIterator,y=new pf.GraphTransaction(2);y.Xy(f);ae.moveToFirstRow(f);c?(ae.moveToRowByIndex(f,a),ae.moveToFirstColumn(f)):ae.moveToColumnByIndex(f,a);l.Tc(f);c?(ae.moveToRowByIndex(l,b),ae.moveToLastColumn(l)):(ae.moveToColumnByIndex(l,b),ae.moveToLastRow(l));a=Vd.SelectionFactory.T3b(f,l);this.Qc.Nb.gF(a);y.dispose()}static Ctj(a){return Wl.Dtj(a,xn.a.qu)}static Dtj(a,b){return b?Wl.Btj(a):
Wl.Etj(a)}static Etj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Wl.Xoe(a)||Wl.Kpe(a)||(b=b.previousSibling);break}b=b.parentNode}return Uv.kfg(b)}static Btj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Wl.Kpe(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Wl.Xoe(a)||(b=b.previousSibling);break}b=b.parentNode}return b?Uv.kfg(b):null}static Q4(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static uWa(a){return Sys.UI.DomElement.containsCssClass(a,
"TableRowResizeHandle")}static s8j(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static gva(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static Zcc(a){return Sys.UI.DomElement.containsCssClass(a,wj.a.Y6e)}static Uxj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;a=a.parentNode}return null}static Xoe(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static Kpe(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static tqg(a){return Sys.UI.DomElement.containsCssClass(a,
"FirstLeft")}static F9f(a){return a.firstChild}}Object(m.a)(Wl,"TableViewElement",xm,[1323,1324,1325,340,305,108]);class RL extends LL.a{constructor(a,b,c,f,l,y,G,R,ja,za,Va){super(a,b);this.lIf="ShowDashedLine";this.ina=this.he=this.Zd=this.TPg=this.NPg=this.aQg=this.dgb=this.gFe=this.fFe=this.te=this.VPg=null;this.IZg=this.HZg=this.L5=this.K5=this.Kgb=this.Hfa=0;this.iaa=c;this.tfb=f;this.Vs=l;this.zc=y;this.pa=G;this.MA=R;this.ia=ja;this.Wp=Va;this.Bhc=this.fCe=!1;this.sok=za}get IYe(){this.yLf();
return this.te.offsetLeft}set IYe(a){this.yLf();this.te.style.left=k.a.Pc(a)}get zoom(){return 1}av(a){const b=super.av(a);if(b&&this.CN){this.MYd(a.Bc);Sys.UI.DomElement.addCssClass(this.te,this.lIf);if(this.hca=Wl.tqg(a.Bc))this.zi=0,this.CF=this.Fl.tVc(this.zi);this.Zd=this.Fl.Pk;this.he=this.zc.h9b(this.Zd.gb);this.Bhc=!1;this.G2e()&&this.igj(a)}else b&&!this.CN&&(a=a.Bc,Wl.gva(a)&&(ya.a.J(512497184,816,50,"Drag from table column handle"),this.zi=parseInt(a.parentNode.getAttribute("columnindex").toString())));
b&&this.Wp&&this.ia.processAction(C.a.Eka,2);return b}Sw(a){this.CN?(a=this.oJf(a.clientPoint.x),this.IYe=this.VPg+(a-this.CF)*(this.hca?-1:1)):(a=this.Fl.qpj(a.clientPoint.x),this.Fl.wxh(this.zi,a,!1));return!0}vo(a){if(this.CN){const f=this.iaa.Ii("UserAction","PPTColumnResize");a&&ya.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.Fl.gb.sa(va.a.pIb,""),this.Fl.gb.Op()));const l=new pf.GraphTransaction(15);l.ld(this.Fl.gb);const y=this.Fl.gb.sa(Ya.a.gv,
null);var b=this.oJf(a.clientPoint.x),c=this.Fl.Od.Nd;const G=c.gf(b,0);(this.hca||this.zi===this.MG-1)&&this.Vs.u1a(this.Fl.gb,this.zi,G);if(this.hca&&b!==this.CF&&(b=this.CF-b)){this.Zd.setPosition(this.Zd.x+b,this.Zd.y,!0);b=c.gf(this.Zd.x,0);c=c.gf(this.Zd.y,1);const R=this.Fl.Pk.shapeNode;R.My=b;R.Ny=c}!this.hca&&this.zi<this.MG-1&&this.F1e(G,y);this.Qwc();l.dispose();Sc.App.Mb.updateCommandUI();this.end();this.he?this.Vs.x0a(this.he):ya.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");
f&&f.stop();a&&ya.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.Fl.gb.sa(va.a.pIb,""),this.Fl.gb.Op(),this.hca))}else a&&Sc.App.Mb.O6(a.clientPoint,a.kg),super.vo(a)}Fu(a){super.Fu(a);this.CN&&this.Qwc()}$dg(){return null}yLf(){if(!this.te)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!xn.a.Q4(this.te))throw Error.invalidOperation("Element is not the table column resize handle");
}MYd(a){this.te=a;this.VPg=this.IYe;this.fFe=this.te.style.marginLeft;this.gFe=this.te.style.marginRight;this.dgb=this.te.style.height;this.aQg=this.te.style.top;this.NPg=this.te.style.bottom;this.TPg=this.te.style.left;this.te.style.marginLeft=this.te.style.marginRight="auto";this.te.style.top="0";this.te.style.height="auto";this.te.style.bottom="0";this.tfb&&(a=xn.a.j9b(a))&&(this.te.style.top=-a.offsetTop+"px",this.te.style.bottom=-(this.Fl.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}Qwc(){this.te&&
(Sys.UI.DomElement.removeCssClass(this.te,this.lIf),this.te.style.marginLeft=this.fFe,this.te.style.marginRight=this.gFe,this.fFe=this.gFe="auto",this.te.style.left=this.sok?this.TPg:"auto",this.te.style.top=this.aQg,this.te.style.height=this.dgb,this.te.style.bottom=this.NPg,this.te=null)}igj(a){this.Bhc=this.fCe=!1;a=a.Bc;if(xn.a.Q4(a)){var b=null,c=null;({qdb:b,Nkb:c}=this.hgj(a,b,c)).returnValue&&this.Wgj(b,c)&&this.Ode()&&this.he&&(a=this.zc.Gi(this.he),b=this.zc.Ek(this.he),0<=this.Hfa&&this.Hfa<
b&&0<=this.Kgb&&this.Kgb<b&&0<=this.K5&&this.K5<a&&0<=this.L5&&this.L5<a&&(this.Bhc=!0))}}hgj(a,b,c){if(!xn.a.Q4(a)||!this.he)return{returnValue:!1,qdb:b,Nkb:c};var f=xn.a.j9b(a);f=rf.a(f);this.ina=Object(sa.a)(im.TableCellNode,f.gb);if(!this.ina)return{returnValue:!1,qdb:b,Nkb:c};f=this.TWc(this.ina);if(0>f||f>=this.zc.Gi(this.he))return{returnValue:!1,qdb:b,Nkb:c};const l=this.ina.rowIndex;if(0>l||l>=this.zc.Ek(this.he))return{returnValue:!1,qdb:b,Nkb:c};if(Wl.tqg(a))return{returnValue:!1,qdb:null,
Nkb:c};b=this.he.ff(l,f);if(f===this.zc.Gi(this.he)-1)return{returnValue:!1,qdb:b,Nkb:null};c=this.he.ff(l,f+1);return{returnValue:!0,qdb:b,Nkb:c}}Wgj(a,b){if(!this.he||!a||!b)return!1;this.Hfa=a.rowIndex;if(0>this.Hfa||this.Hfa>=this.zc.Ek(this.he))return!1;this.Kgb=this.Hfa;this.K5=this.S7b(a);if(0>this.K5||this.K5>=this.zc.Gi(this.he))return!1;this.L5=this.TWc(b);if(0>this.L5||this.L5>=this.zc.Gi(this.he))return!1;var c=this.Icj(a,b);a=c?this.pej(a,b):!1;if(c=c&&a)this.fCe=this.zZj(b.Ai);return c}zZj(a){let b=
!0;if(0<this.Hfa)for(var c=this.Hfa-1;0<=c;){var f=this.he.ff(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.Kgb<this.he.jV-1)for(c=this.Hfa+1;c<=this.he.jV-1;){if((f=this.he.ff(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}Ode(){if(!this.he)return!1;const a=this.zc.Gi(this.he);if(0>this.K5||this.K5>=a||0>this.L5||this.L5>=a||0>this.zi||this.zi>=a||0>this.zi+1||this.zi+1>=a)return!1;this.HZg=this.Mfe(this.he,this.K5,this.zi)-this.Lce(this.he,this.K5);this.IZg=this.Mfe(this.he,this.L5,this.zi+
1)-this.Lce(this.he,this.L5);return!0}Mfe(a,b,c){if(b>c)return this.Mfe(a,c,b);if(!a||0>b||b>=this.zc.Gi(a)||0>c||c>=this.zc.Gi(a))return-1;a=a.oae;let f=0;for(;b<=c;b++)f+=a[b];return Math.floor(this.Fl.Od.Nd.Pe(f,0))}Lce(a,b){return Ka.StyleReader.yr?Ka.StyleReader.yr.l9(a,b):fo.a.Twd}TEa(a,b){return this.Fl.Od.Nd.gf(this.Lce(a,b),0)}Icj(a,b){if(!a||!b)return!1;a=a.K7b();const c=b.Ai;for(b=b.K7b();b&&(!b.isGhostCell||this.S7b(b)===c);)this.Hfa--,this.K5=Math.max(this.K5,this.S7b(a)),this.L5=Math.min(this.L5,
this.TWc(b)),a=a.K7b(),b=b.K7b();return!0}pej(a,b){if(!a||!b)return!1;a=a.iVc();const c=b.Ai;for(b=b.iVc();b&&(!a.isGhostCell||this.S7b(b)===c);)this.Kgb++,this.K5=Math.max(this.K5,this.S7b(a)),this.L5=Math.min(this.L5,this.TWc(b)),a=a.iVc(),b=b.iVc();return!0}S7b(a){return a?(a=a.rz())?a.Ai:-1:-1}TWc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.rz());a=null;b&&(a=b.$be(2));return a?a.Ai:-1}oJf(a){this.G2e()&&this.Bhc?(a=this.Fl.gb.c6j?Math.floor((this.U7-a)/this.zoom)+this.CF:Math.floor((a-this.U7)/
this.zoom)+this.CF,a=Math.min(a,this.CF+this.IZg),a=Math.max(a,this.CF-this.HZg)):a=this.SYd(a);return a}F1e(a,b){if(this.G2e()&&this.Bhc){if(!this.pa.vH()){var c=Vd.SelectionFactory.Qg(Object(sa.a)(Ig.a,this.ina.M6b),0);this.pa.setSelection(c)}let f=c=-1,l=-1;({fXf:c,yWf:f,zWf:l}=this.ojj(a-b[this.zi],b,c,f,l));this.fCe&&(c===this.zi&&Math.abs(f)>=this.TEa(this.he,c)||c===this.zi+1&&c<this.zc.Gi(this.he)-1&&Math.abs(l)>=this.TEa(this.he,c+1)||c===this.zi+1&&c===this.zc.Gi(this.he)-1)?(ya.a.J(512497182,
815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.zi.toString(),c.toString(),f.toString(),l.toString()),a=b[this.zi]+b[this.zi+1],c===this.zi?(f=Math.max(f,this.TEa(this.he,c)),l=a-f):c===this.zi+1&&(l=Math.max(l,this.TEa(this.he,c)),f=a-l),this.Vs.u1a(this.he,this.zi,f),this.Vs.u1a(this.he,this.zi+1,l)):(c>this.K5&&Math.abs(f)<this.TEa(this.he,c)?(ya.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.zi.toString(),c.toString(),f.toString(),l.toString()),this.Qhb(c,this.zi+1)):c<this.L5&&Math.abs(l)<this.TEa(this.he,c+1)?(ya.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.zi.toString(),c.toString(),f.toString(),l.toString()),this.Qhb(c+1,this.zi+1)):(ya.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.zi.toString(),c.toString(),f.toString(),l.toString()),this.GEl(c,f,l)),this.Vs.$We(this.he),a=ub.GraphIterator.pb(this.he),this.Vs.K$e(a),this.he.sea(511),this.MA.Iac(this.he))}else this.Vs.u1a(this.he,this.zi,a),this.Vs.u1a(this.he,this.zi+1,b[this.zi]+b[this.zi+1]-a)}ojj(a,b,c,f,l){if(!a)return c=this.zi,f=b[this.zi],{fXf:c,yWf:f,zWf:0};f=0;if(0<a){for(c=this.zi;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.zi+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{fXf:c,yWf:f,zWf:l}}Qhb(a,b){if(b!==a){var c=
this.Ygj(b-1);for(let f=this.Hfa;f<=this.Kgb;f++){const l=this.he.ff(f,b),y=this.he.ff(f,a);this.GKe(c[f],l,y)}}}GKe(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.Ai-b.Ai,y=a.colSpan+b.colSpan-l;Qm.c(Object(sa.a)(Ig.a,b),Object(sa.a)(Ig.a,c),this.Vs.uZd);Qm.c(Object(sa.a)(Ig.a,b),Object(sa.a)(Ig.a,c),[va.a.ZKa]);var G=ub.GraphIterator.pb(c);G.kf();var R=new ub.GraphIterator;R.set(Object(sa.a)(Ig.a,b));R.Db(1)&&Qm.h(G,null,1,1,R,-1);c.isGhostCell=b.isGhostCell;this.h9d(G);b.yo(va.a.rowSpan,
va.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=y,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}h9d(a){const b=a.currentNode.eb(va.a.rowId),c=a.currentNode.eb(va.a.cellId);for(a=He.a.zv(a);a.moveNext();){const f=a.currentNode.sa(va.a.cellId,null);a.currentNode.sa(va.a.rowId,null)&&a.currentNode.setValue(va.a.rowId,b);f&&a.currentNode.setValue(va.a.cellId,c)}}GEl(a,b,c){var f=ub.GraphIterator.pb(this.he);ae.moveToFirstRow(f);f.hq(a,1);this.Vs.Uje(f);if(f=this.he.sa(Ya.a.gv,null))f=
Ub.a.clone(f),b<this.TEa(this.he,a)?(b=this.TEa(this.he,a),c=f[a]-b):(c=Math.max(c,this.TEa(this.he,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.he.setValue(Ya.a.gv,f);b=this.zi+1;a+=1;a<=b&&(b+=1);this.Qhb(a,b)}Ygj(a){const b=Array(this.zc.Ek(this.he));for(let c=this.Hfa;c<=this.Kgb;c++){const f=this.he.ff(c,a);b[c]=f.rz()}return b}G2e(){return!!this.he&&this.he.Op()&&!this.hca&&this.zi<this.MG-1}}Object(m.a)(RL,"PowerPointColumnDragAdapter",LL.a,[]);class SD{constructor(a,b){this.Sx=this.Y5=null;this.Nic=
this.Zfb=0;this.SGb=!1;this.C$=a;this.M0=b}Mv(a){if(3===a.kg)return!1;a=a.Bc;return Wl.uWa(a)||Wl.Zcc(a)}Fu(){if(this.SGb){const a=new pf.GraphTransaction(3);a.ld(this.Y5.gb);this.Y5.source.Kv(4,!0);a.dispose()}this.end()}end(){this.C$.rS()}dispose(){this.Y5=null}}Object(m.a)(SD,"CommonRowHandleDragAdapter",null,[235,108]);class SL extends SD{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){super(a,b);this.yCe=this.YEb=!1;this.QPg=this.cIa=0;this.ina=this.he=this.Zd=this.Qwa=this.UPg=this.SPg=this.OPg=
this.RPg=this.PPg=null;this.$Pg=this.We=this.GZg=this.FZg=this.J5=this.I5=this.IIa=this.j1=this.IA=0;this.iaa=f;this.Uq=c;this.il=l;this.tfb=y;this.Vs=G;this.zc=R;this.pa=ja;this.MA=za;this.nvk=Va;this.ia=Cb;this.Wp=lc;this.AZa=null;this.Chc=this.M$c=this.v$c=!1;this.ur=hb}av(a){if(!this.Mv(a))return!1;const b=a.Bc;if(Wl.Zcc(b)){ya.a.J(512497178,816,50,"drag from table row handle");this.SGb=!1;var c=Wl.Uxj(b);if(!c)return!1;this.he=rf.a(c).gb;this.Sx=this.he.qc(this.We);if(!this.Sx)return ya.a.J(512497177,
816,10,"OnDragStart : m_tableViewElement is null"),!1;this.$Pg=this.ur.Pce(this.Sx,a.clientPoint);this.M0.Cmd(b);return!0}this.Y5=Wl.Ctj(b);if(!this.Y5)return!1;c=Object(sa.a)(157,this.Y5.gb);this.We=this.Y5.Na;this.he=c?c.getContainingTable():null;if(!this.he)return!1;this.Sx=this.he.qc(this.We);this.AZa=this.nvk.uce(this.he);if(!this.Sx||!this.AZa)return!1;this.YEb=Wl.Xoe(b);this.yCe=Wl.Kpe(b);this.Zfb=this.Y5.htmlElement.offsetHeight;this.Nic=this.cIa=a.clientPoint.y;this.M0.Bl(21);this.C$.endEditing(!0,
14);this.Zd=this.Sx.Pk;this.M$c=this.v$c=this.Chc=!1;this.SGb=!0;this.H2e()&&this.Ktj(b);this.MYd(b);this.Wp&&this.ia.processAction(C.a.Eka,2);return!0}Sw(a){this.SGb?(this.cIa=a.clientPoint.y,a=(this.sJf(this.cIa)-this.Zfb)*(this.YEb?-1:1)+this.QPg,this.Qwa.style.top=a+"px"):(a=this.ur.Pce(this.Sx,a.clientPoint),this.Sx.wxh(this.$Pg,a));return!0}vo(a){let b=null;a&&(b=this.iaa.Ii("UserAction","PPTRowResize"),ya.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",
this.Sx.gb.sa(va.a.pIb,""),this.Sx.gb.Op())));if(this.SGb){var c=this.sJf(a?a.clientPoint.y:this.cIa),f=new pf.GraphTransaction(15);if(this.H2e()&&this.Chc&&this.M$c)kf.a.mark(11077),f.ld(this.he),this.F1e(c);else{this.Y5.AOb(c);var l=this.Y5.htmlElement.offsetHeight;kf.a.mark(11077);var y=this.Y5.gb;f.ld(y);c=this.C$.Nd;y.setValue(va.a.Ku,c.gf(l,1));this.YEb&&l!==this.Zfb&&(l=this.Zfb-l)&&(this.Zd.setPosition(this.Zd.x,this.Zd.y+l,!0),l=c.gf(this.Zd.x,0),c=c.gf(this.Zd.y,1),y=this.Sx.Pk.shapeNode,
y.My=l,y.Ny=c)}this.Qwc();f.dispose();Sc.App.Mb.updateCommandUI();kf.a.mark(11078);this.end();this.he?this.Vs.x0a(this.he):ya.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&ya.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",this.Sx.gb.sa(va.a.pIb,""),this.Sx.gb.Op()))}else a&&Sc.App.Mb.O6(a.clientPoint,a.kg),this.M0.T1()}Fu(a){a.k9e?(super.Fu(a),this.SGb&&this.Qwc()):this.vo(null)}end(){this.M0.T1();super.end()}sJf(a){a=
this.Zfb+this.Uq.vm(a-this.Nic)*(this.YEb?-1:1);if(this.H2e()&&this.Chc&&this.M$c)a=Math.min(a,this.Zfb+this.GZg),a=Math.max(a,this.Zfb-this.FZg);else{var b=this.il.rMc(this.Y5.gb);b=this.Y5.Od.Nd.Pe(b,1);a=Math.max(b,a)}return a}MYd(a){this.Qwa=a;Sys.UI.DomElement.addCssClass(this.Qwa,"ShowDashedLine");this.QPg=a.offsetTop;this.UPg=a.style.marginTop;this.SPg=a.style.width;this.PPg=a.style.left;this.RPg=a.style.top;this.OPg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=
a.style.left="0";a.style.bottom="auto";if(this.tfb){const b=xn.a.j9b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.Y5.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}Qwc(){Sys.UI.DomElement.removeCssClass(this.Qwa,"ShowDashedLine");this.Qwa.style.marginTop=this.UPg;this.Qwa.style.width=this.SPg;this.Qwa.style.left=this.PPg;this.Qwa.style.right="auto";this.Qwa.style.top=this.RPg;this.Qwa.style.bottom=this.OPg}Ktj(a){this.Chc=this.v$c=!1;if(this.he&&Wl.uWa(a)){var b=null,c=null;({m7a:b,
a8a:c}=this.Jtj(a,b,c)).returnValue&&this.Xgj(b,c)&&this.Ode()&&(a=this.zc.Gi(this.he),b=this.zc.Ek(this.he),0<=this.j1&&this.j1<a&&0<=this.IIa&&this.IIa<a&&0<=this.I5&&this.I5<b&&0<=this.J5&&this.J5<b&&(this.Chc=!0),this.M$c=0<this.j1||this.IIa<a-1?!0:!1)}}Jtj(a,b,c){if(!Wl.uWa(a)||!this.he)return{returnValue:!1,m7a:b,a8a:c};a=xn.a.j9b(a);a=rf.a(a);this.ina=Object(sa.a)(im.TableCellNode,a.gb);if(!this.ina)return{returnValue:!1,m7a:b,a8a:c};a=this.IA=this.ina.rowIndex-1;if(0>a||a>=this.zc.Ek(this.he))return{returnValue:!1,
m7a:b,a8a:c};const f=this.ina.Ai;if(0>f||f>=this.zc.Gi(this.he))return{returnValue:!1,m7a:b,a8a:c};if(this.YEb)return{returnValue:!1,m7a:null,a8a:c};b=this.he.ff(a,f);if(this.yCe)return{returnValue:!1,m7a:b,a8a:null};c=this.he.ff(a+1,f);return{returnValue:!0,m7a:b,a8a:c}}Xgj(a,b){if(!this.he||!a||!b)return!1;this.j1=a.Ai;if(0>this.j1||this.j1>=this.zc.Gi(this.he))return!1;this.IIa=this.j1;var c=a.rz();this.I5=c?c.rowIndex:-1;if(0>this.I5||this.I5>=this.zc.Ek(this.he))return!1;this.J5=this.ace(b);
if(0>this.J5||this.J5>=this.zc.Ek(this.he))return!1;a=(c=this.qnj(a,b))?this.stj(a,b):!1;if(a=c&&a)this.v$c=this.AZj(b.rowIndex);return a}Ode(){if(!this.he)return!1;const a=this.zc.Ek(this.he);if(0>this.I5||this.I5>=a||0>this.J5||this.J5>=a)return!1;this.FZg=this.Mbe(this.he,this.I5,this.IA)-this.jUa(this.he,this.I5);this.GZg=this.Mbe(this.he,this.J5,this.IA+1)-this.jUa(this.he,this.J5);return!0}qnj(a,b){if(!a||!b)return!1;a=a.Q$a();const c=b.rowIndex;for(b=b.Q$a();b&&a;){var f=b.rz();if(b.isGhostCell&&
f&&f.rowIndex!==c)break;this.j1--;if(f=a.rz())this.I5=Math.max(this.I5,f.rowIndex);this.J5=Math.min(this.J5,this.ace(b));a=a.Q$a();b=b.Q$a()}return!0}stj(a,b){if(!a||!b)return!1;a=a.U_();const c=b.rowIndex;for(b=b.U_();b&&(!b.isGhostCell||b.rz().rowIndex===c);)this.IIa++,this.I5=Math.max(this.I5,a.rz().rowIndex),this.J5=Math.min(this.J5,this.ace(b)),a=a.U_(),b=b.U_();return!0}AZj(a){let b=!0,c;if(0<this.j1)for((c=this.he.ff(a,this.j1))&&(c=c.Q$a());c;){if(!c.isGhostCell){b=!1;break}c=c.Q$a()}if(this.IIa<
this.he.K3-1)for((c=this.he.ff(a,this.IIa))&&(c=c.U_());c;){if(!c.isGhostCell){b=!1;break}c=c.U_()}return b}ace(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.rz());return b&&(b=b.$be(1))?b.rowIndex:-1}Mbe(a,b,c){if(b>c)return this.Mbe(a,c,b);if(!a||0>b||b>=this.zc.Ek(a)||0>c||c>=this.zc.Ek(a))return-1;for(a=0;b<=c;b++)a+=this.AZa[b];return Math.floor(a)}jUa(a,b){a=this.il.RYd(a,b);return Math.floor(this.C$.Nd.Pe(a,1))}F1e(a){if(!this.pa.vH()){var b=this.ina.K7b().rz().M6b;b=Vd.SelectionFactory.Qg(Object(sa.a)(Ig.a,
b),0);this.pa.setSelection(b)}let c=b=-1;var f=-1;({gXf:b,wWf:c,xWf:f}=this.pjj(a-this.AZa[this.IA],this.AZa,b,c,f));if(this.v$c&&(b===this.IA&&Math.abs(c)>=this.jUa(this.he,this.IA)||b===this.IA+1&&b<this.zc.Ek(this.he)&&Math.abs(f)>=this.jUa(this.he,this.IA+1)||b===this.IA+1&&b===this.zc.Ek(this.he)-1)){ya.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.IA.toString(),b.toString(),c.toString(),
f.toString());f=ub.GraphIterator.pb(this.he);this.umc(f,this.IA);a=f.currentNode;var l=this.AZa[this.IA];const G=a.qc(this.We);ae.moveToNextRow(f);f=f.currentNode;var y=this.AZa[this.IA+1];const R=f.qc(this.We);y=l+y;l=this.C$.Nd;b===this.IA+1&&(c+=this.AZa[this.IA]);G.AOb(Math.floor(c));b=G.htmlElement.offsetHeight;a.setValue(va.a.Ku,l.gf(b,1));b=y-b;b=Math.max(b,this.jUa(this.he,this.IA+1));R.AOb(Math.floor(b));f.setValue(va.a.Ku,l.gf(R.htmlElement.offsetHeight,1))}else b>this.I5&&Math.abs(c)<this.jUa(this.he,
b)?(ya.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.IA.toString(),b.toString(),c.toString(),f.toString()),this.Qhb(b,this.IA+1)):b<this.J5&&Math.abs(f)<this.jUa(this.he,b+1)?(ya.a.J(512497170,815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.IA.toString(),b.toString(),c.toString(),f.toString()),
this.Qhb(b+1,this.IA+1)):(ya.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.IA.toString(),b.toString(),c.toString(),f.toString()),this.HEl(b,c,f)),this.Vs.$We(this.he),b=ub.GraphIterator.pb(this.he),this.Vs.K$e(b),this.he.sea(511),this.MA.Iac(this.he)}pjj(a,b,c,f,l){if(!a)return c=this.IA,f=b[this.IA],{gXf:c,wWf:f,xWf:0};f=0;if(0<a){for(c=this.IA;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=
this.IA+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{gXf:c,wWf:f,xWf:l}}Qhb(a,b){if(b!==a){var c=this.Zgj(b-1);b=this.he.ff(b,this.j1);a=this.he.ff(a,this.j1);for(let f=this.j1;f<=this.IIa;f++)this.GKe(c[f],b,a),b=b.U_(),a=a.U_()}}GKe(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,y=a.rowSpan+b.rowSpan-l;Qm.c(Object(sa.a)(Ig.a,b),Object(sa.a)(Ig.a,c),this.Vs.uZd);Qm.c(Object(sa.a)(Ig.a,b),Object(sa.a)(Ig.a,c),[va.a.ZKa]);var G=ub.GraphIterator.pb(c);G.kf();var R=new ub.GraphIterator;
R.set(Object(sa.a)(Ig.a,b));R.Db(1)&&Qm.h(G,null,1,1,R,-1);c.isGhostCell=b.isGhostCell;this.h9d(G);b.yo(va.a.rowSpan,va.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=y);a.Ai===G.Dq.Ai&&(a.rowSpan=l)}}h9d(a){const b=a.currentNode.eb(va.a.rowId),c=a.currentNode.eb(va.a.cellId);for(a=He.a.zv(a);a.moveNext();){const f=a.currentNode.sa(va.a.cellId,null);a.currentNode.sa(va.a.rowId,null)&&a.currentNode.setValue(va.a.rowId,b);f&&a.currentNode.setValue(va.a.cellId,c)}}HEl(a,b,c){var f=
ub.GraphIterator.pb(this.he);this.umc(f,a);const l=f.currentNode;f=this.Vs.Vje(f);const y=this.C$.Nd,G=l.qc(this.We);G.AOb(Math.floor(b));l.setValue(va.a.Ku,y.gf(G.htmlElement.offsetHeight,1));c=Math.max(c,this.jUa(this.he,a+1));f.setValue(va.a.Ku,y.gf(Math.floor(c),1));b=this.IA+1;a+=1;a<=b&&(b+=1);this.Qhb(a,b)}umc(a,b){if(!(14!==a.Bi||0>b||b>=this.zc.Ek(a.currentNode)))for(ae.moveToFirstRow(a);0<b--;)ae.moveToNextRow(a)}Zgj(a){a=this.he.ff(a,this.j1);const b=Array(this.zc.Gi(this.he));for(let c=
this.j1;c<=this.IIa;c++)b[c]=a.rz(),a=a.U_();return b}H2e(){return!!this.he&&this.he.Op()&&!this.YEb&&!this.yCe}}Object(m.a)(SL,"PowerpointRowHandleDragAdapter",SD,[]);class TD{constructor(a,b,c,f){this.MA=f;this.yHa=a;this.yHa.gk(Object(H.a)(this,this.$g,"onPropertyChanged"))}$g(a,b){a=b.property;(b=Object(sa.a)(130,b.node))&&(a===va.a.colSpan||a===va.a.rowSpan)&&(b=b.getContainingTable())&&(this.MA.Fyk(b),b.tZ=null)}dispose(){this.yHa.Qm(Object(H.a)(this,this.$g,"onPropertyChanged"))}}Object(m.a)(TD,
"TableCellNodeBehavior",null,[108]);class TL extends Tb.a{constructor(a,b){super(a,b,"TableCellSelected")}l5g(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.k1a)?Sys.UI.DomElement.addCssClass(a,this.k1a):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.k1a)&&Sys.UI.DomElement.removeCssClass(a,this.k1a)}}Object(m.a)(TL,"TableCellSelectionBehavior",Tb.a,[712,477]);class UL extends Sys.EventArgs{constructor(a){super();this.sai=a}get tableCellNode(){return this.CIl.tableCellNode}get CIl(){return this.sai}}
Object(m.a)(UL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class UD extends Sys.EventArgs{constructor(a){super();this.NTi=a}}Object(m.a)(UD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var lq=d(192);class rt extends Tv{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){super(a,b,f,l,Fb.a.instance.resolve("Box4.ITableCellReader"),Fb.a.instance.resolve("Box4.IParagraphReader"),Fb.a.instance.resolve("Box4.IOutlineElementNavigator"),Fb.a.instance.resolve("Box4.ITableNavigator"),Fb.a.instance.resolve("Box4.IOutlineElementReader"),
Fb.a.instance.resolve("Box4.Styles.IStyleReader"),Fb.a.instance.rb("Box4.IFeatureHelper"),new TL(a,b),Fb.a.instance.rb("Box4.Styles.ITableCellspacingReader"),Fb.a.instance.resolve("Box4.TableCellViewElementSettings"));this.YDe=this.ZDe=this.sfd=this.yfd=this.EHb=this.Ih=this.mhb=this.JO=this.UO=this.l1=null;this.Vma=!1;this.yma=null;this.vj=Object(sa.a)(130,b);this.Ga=c;this.MA=y;this.il=G;this.Fc=R;this.aHa=ja;this.zc=za;this.tfb=Va;this.lFb=hb;this.Z0=Cb;this.Iad=lc;this.ohc=qd.a("PPTOEnableTableDiagonalBorders");
this.pa=ic;this.Jva=this.C7f();(this.tfb||this.lFb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}m7(){}az(a){super.az(a);this.tfb&&!this.Od.lm&&this.ool()}FEa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}Hsg(){const a=this.pa.tdj(),b=this.vj.getContainingTable();return b?Array.contains(a,b):!1}G6k(a){switch(a){case "Top":this.Ih.style.top="-0.5px";this.Ih.style.borderTopWidth="1px";break;case "Right":this.Ih.style.right=
"-0.5px";this.Ih.style.borderRightWidth="1px";break;case "Bottom":this.Ih.style.bottom="-0.5px";this.Ih.style.borderBottomWidth="1px";break;case "Left":this.Ih.style.left="-0.5px",this.Ih.style.borderLeftWidth="1px"}}F6k(a){switch(a){case "Top":this.Ih.style.top="0px";this.Ih.style.borderTopWidth="0px";break;case "Right":this.Ih.style.right="0px";this.Ih.style.borderRightWidth="0px";break;case "Bottom":this.Ih.style.bottom="0px";this.Ih.style.borderBottomWidth="0px";break;case "Left":this.Ih.style.left=
"0px",this.Ih.style.borderLeftWidth="0px"}}Epd(a){this.Ih&&(this.Hsg()?this.G6k(a):this.F6k(a))}mol(a,b,c){const f=!qd.a("TableBorderOutsideBorderHalfClippingDisabled");this.X6d();var l=ub.GraphIterator.pb(this.gb);l.rc(14);var y=l.Jg(14);l=this.zc.Ek(y);y=this.zc.Gi(y);c=c?c.FV():"";switch(a){case "Top":b=this.Od.Nd.Pe(b,1);!this.vj.rowIndex&&f?(this.Ih.style.top="0px",this.Ih.style.borderTopWidth=b/2+"px"):(this.Ih.style.top=-b/2+"px",this.Ih.style.borderTopWidth=b+"px");this.Ih.style.borderTopColor=
c;break;case "Bottom":b=this.Od.Nd.Pe(b,1);this.vj.rowIndex+this.vj.rowSpan===l&&f?(this.Ih.style.bottom="0px",this.Ih.style.borderBottomWidth=b/2+"px"):(this.Ih.style.bottom=-b/2+"px",this.Ih.style.borderBottomWidth=b+"px");this.Ih.style.borderBottomColor=c;break;case "Left":b=this.Od.Nd.Pe(b,0);!this.vj.Ai&&f?(this.Ih.style.left="0px",this.Ih.style.borderLeftWidth=b/2+"px"):(this.Ih.style.left=-b/2+"px",this.Ih.style.borderLeftWidth=b+"px");this.Ih.style.borderLeftColor=c;break;case "Right":b=this.Od.Nd.Pe(b,
0);this.vj.Ai+this.vj.colSpan===y&&f?(this.Ih.style.right="0px",this.Ih.style.borderRightWidth=b/2+"px"):(this.Ih.style.right=-b/2+"px",this.Ih.style.borderRightWidth=b+"px");this.Ih.style.borderRightColor=c;break;case "DiagonalUp":this.ohc&&(b=this.Od.Nd.Pe(b,0),this.qXf(a,b,c));break;case "DiagonalDown":this.ohc&&(b=this.Od.Nd.Pe(b,0),this.pXf(a,b,c))}this.pBh()}qXf(a,b,c){this.oZf();this.ZDe||(this.ZDe=this.OQf());this.Wyh(this.ZDe,a,b,c)}pXf(a,b,c){this.oZf();this.YDe||(this.YDe=this.OQf());this.Wyh(this.YDe,
a,b,c)}OQf(){const a=new Vm.a;this.yfd.appendChild(a.xa);this.hp(a.xa);return a}Wyh(a,b,c,f){b=this.ENi(b);a.dZ(b);a.fv(f);a.xr(c)}ENi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.fae(),this.hae());case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.hae(),this.fae())}ya.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}oZf(){this.X6d();this.EHb||(this.EHb=this.Od.vp(Fa.a.div),this.EHb.className="PPTTableDiagonalBorder",this.mhb.appendChild(this.EHb),
this.hp(this.EHb));this.sfd||(this.sfd=new ln.a,this.yfd=this.sfd.xa,this.EHb.appendChild(this.yfd),this.hp(this.yfd));this.sfd.ypa(String.format("0 0 {0} {1}",this.hae(),this.fae()))}X6d(){this.mhb||(this.mhb=this.Od.vp(Fa.a.div),this.mhb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.mhb,this.htmlElement.firstChild),this.hp(this.mhb));this.Ih||(this.Ih=this.Od.vp(Fa.a.div),this.Ih.className="PPTTableBorder",this.mhb.appendChild(this.Ih),this.hp(this.Ih))}pBh(){this.Iad&&
qd.a("MergeDifferentBordersFixEnabled")?this.Ih.style.zIndex=this.nCb(this.vj)?"1":(this.IVa(this.vj.Iza)||this.IVa(this.vj.fha))&&(this.IVa(this.vj.Hza)||this.IVa(this.vj.gha))?"3":"2":this.Ih.style.zIndex=(this.IVa(this.vj.Iza)||this.IVa(this.vj.fha))&&(this.IVa(this.vj.Hza)||this.IVa(this.vj.gha))?"1":"0"}nCb(a){return 1<a.rowSpan||1<a.colSpan}nZj(a){return"DiagonalUp"===a||"DiagonalDown"===a}ILa(a,b,c,f){const l=this.Iad&&qd.a("MergeDifferentBordersFixEnabled")&&this.nCb(this.vj);this.Iad&&!this.nZj(a)&&
this.Hsg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.xWj()&&(b=0);this.Ih.style.borderTopWidth=b+"px";this.Ih.style.borderTopColor=c;this.Ih.style.borderTopStyle=f;this.Ih.style.top=-b/2+"px";break;case "Right":l&&!this.wWj()&&(b=0);this.Ih.style.borderRightWidth=b+"px";this.Ih.style.borderRightColor=c;this.Ih.style.borderRightStyle=f;this.Ih.style.right=-b/2+"px";break;case "Bottom":l&&!this.qWj()&&(b=0);this.Ih.style.borderBottomWidth=b+"px";this.Ih.style.borderBottomColor=
c;this.Ih.style.borderBottomStyle=f;this.Ih.style.bottom=-b/2+"px";break;case "Left":l&&!this.sWj()&&(b=0);this.Ih.style.borderLeftWidth=b+"px";this.Ih.style.borderLeftColor=c;this.Ih.style.borderLeftStyle=f;this.Ih.style.left=-b/2+"px";break;case "DiagonalUp":this.ohc&&this.qXf(a,b,c);break;case "DiagonalDown":this.ohc&&this.pXf(a,b,c)}}hae(){var a=0;for(let b=0;b<this.vj.colSpan;b++)a+=this.vj.getContainingTable().oae[this.vj.Ai+b];a=this.Od.Nd.Pe(a,0);return Math.round(100*a)/100}fae(){var a=this.zc.OXc(this.vj.getContainingTable(),
this.vj.rowIndex,this.vj.rowIndex+this.vj.rowSpan-1);let b=0;for(let c of a)Object(Sa.a)(157,c)?b+=c.sa(va.a.Ku,0):ya.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",c));this.vj.marginTop+this.vj.marginBottom>b&&ya.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.vj.marginTop,this.vj.marginBottom));b=Math.max(b,this.vj.marginTop+this.vj.marginBottom);
a=this.Od.Nd.Pe(b,1);return Math.round(100*a)/100}xWj(){if(!this.vj.rowIndex)return!0;const a=this.vj.getContainingTable();if(!a)return!0;const b=this.vj.rowIndex-1;var c=this.vj.Ai;const f=c+this.vj.colSpan-1;for(;c<=f;c++){const l=a.ff(b,c);if(l&&(l.isGhostCell||this.nCb(l)))return!0}return!1}sWj(){if(!this.vj.Ai)return!0;const a=this.vj.getContainingTable();if(!a)return!0;const b=this.vj.Ai-1;var c=this.vj.rowIndex;const f=c+this.vj.rowSpan-1;for(;c<=f;c++){const l=a.ff(c,b);if(l&&(l.isGhostCell||
this.nCb(l)))return!0}return!1}wWj(){const a=this.vj.getContainingTable();if(!a||this.vj.Ai+this.vj.colSpan===this.zc.Gi(a))return!0;const b=this.vj.Ai+this.vj.colSpan;var c=this.vj.rowIndex;const f=c+this.vj.rowSpan-1;for(;c<=f;c++){const l=a.ff(c,b);if(l&&(l.isGhostCell||this.nCb(l)))return!0}return!1}qWj(){const a=this.vj.getContainingTable();if(!a||this.vj.rowIndex+this.vj.rowSpan===this.zc.Ek(a))return!0;const b=this.vj.rowIndex+this.vj.rowSpan;var c=this.vj.Ai;const f=c+this.vj.colSpan-1;for(;c<=
f;c++){const l=a.ff(b,c);if(l&&(l.isGhostCell||this.nCb(l)))return!0}return!1}ool(){var a=!qd.a("TableBorderOutsideBorderHalfClippingDisabled");this.X6d();if(a){a=ub.GraphIterator.pb(this.gb);a.rc(14);var b=a.Jg(14);a=this.zc.Ek(b);b=this.zc.Gi(b);var c=this.FEa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.ILa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.vj.Ai?this.Ih.style.left=-c/2+"px":(this.Ih.style.left="0px",this.Ih.style.borderLeftWidth=
c/2+"px");c=this.FEa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.ILa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);this.vj.Ai+this.vj.colSpan===b?(this.Ih.style.right="0px",this.Ih.style.borderRightWidth=c/2+"px"):this.Ih.style.right=-c/2+"px";b=this.FEa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.ILa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);
this.vj.rowIndex?this.Ih.style.top=-b/2+"px":(this.Ih.style.top="0px",this.Ih.style.borderTopWidth=b/2+"px");b=this.FEa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);this.ILa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.vj.rowIndex+this.vj.rowSpan===a?(this.Ih.style.bottom="0px",this.Ih.style.borderBottomWidth=b/2+"px"):this.Ih.style.bottom=-b/2+"px"}else a=this.FEa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),
this.ILa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.FEa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),this.ILa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.FEa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.ILa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.FEa(this.htmlElement.style.borderBottom,
this.htmlElement.style.borderBottomWidth),this.ILa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.oXf();this.Iad&&this.pBh();this.htmlElement.style.border=""}oXf(){this.ohc&&(this.kxe&&this.Vyh("DiagonalUp",this.kxe),this.jxe&&this.Vyh("DiagonalDown",this.jxe))}IVa(a){return!!a}Vyh(a,b){const c=b.split(" ");if(3!==c.length)ya.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",
b));else{var f=c[0];b=this.FEa(b,c[1]);this.ILa(a,b,c[2],f)}}Dxc(a,b,c,f,l,y,G){if(!this.Z0||this.Ga.An(this.vj).eb(va.a.isResizable))this.lFb?this.FUl(l,y,G):this.EUl(a,b,c,f,l,y,G)}FUl(a,b,c){this.cHa||(this.cHa=this.WOc(),this.hp(this.cHa));this.l1||(this.l1=this.iSa(),this.hp(this.l1));a?Sys.UI.DomElement.addCssClass(this.l1,"First"):Sys.UI.DomElement.removeCssClass(this.l1,"First");b^!!this.UO&&(b?(this.UO=this.iSa(),this.hp(this.UO)):(this.nMb(this.UO),this.UO=null));this.UO&&Sys.UI.DomElement.addCssClass(this.UO,
"Last");c^!!this.JO&&(c?(this.JO=this.WOc(),this.hp(this.JO)):(this.nMb(this.JO),this.JO=null));this.JO&&Sys.UI.DomElement.addCssClass(this.JO,"FirstLeft")}EUl(a,b,c,f,l,y,G){super.Dxc(a,b,c,f,l,y,G);this.lvb&&this.hp(this.lvb);this.l1||(this.l1=this.iSa(),this.hp(this.l1));this.l1.style.left=a+"px";this.l1.style.top=b+"px";this.l1.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.l1,"First"):Sys.UI.DomElement.removeCssClass(this.l1,"First");y^!!this.UO&&(y?(this.UO=this.iSa(),this.hp(this.UO)):
(this.nMb(this.UO),this.UO=null));this.UO&&(this.UO.style.bottom="0",this.UO.style.left=a+"px",this.UO.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.UO,"Last"));G^!!this.JO&&(G?(this.JO=this.WOc(),this.hp(this.JO)):(this.nMb(this.JO),this.JO=null));this.JO&&(this.JO.style.left="0",this.JO.style.top=b+"px",this.JO.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.JO,"FirstLeft"));this.tfb&&(this.l1.style.left="0",this.l1.style.top="0",this.lvb&&(this.lvb.style.left=c+"px",this.lvb.style.top=
"0",this.lvb.style.height=f+"px"),this.UO&&(this.UO.style.left="0"),this.JO&&(this.JO.style.top="0"))}Jyh(){var a=this.Od.Nd,b=a.Pe(this.il.Pta(this.gb,3),1);this.Qja.style.paddingTop=b+"px";b=a.Pe(this.il.Pta(this.gb,0),1);this.Qja.style.paddingBottom=b+"px";b=a.Pe(this.il.Pta(this.gb,1),0);this.Qja.style.paddingLeft=b+"px";a=a.Pe(this.il.Pta(this.gb,2),0);this.Qja.style.paddingRight=a+"px"}qol(a,b){const c=this.Od.Nd;switch(b){case ea.a.Lvc:a=c.f0(a.marginTop,1);this.Qja.style.paddingTop=a+"px";
break;case ea.a.Fvc:a=c.f0(a.marginBottom,1);this.Qja.style.paddingBottom=a+"px";break;case ea.a.Gvc:a=c.f0(a.marginLeft,0);this.Qja.style.paddingLeft=a+"px";break;case ea.a.Kvc:a=c.f0(a.marginRight,0),this.Qja.style.paddingRight=a+"px"}}fV(){var a=this.il.Pta(this.gb,1),b=this.il.Pta(this.gb,2);const c=this.il.D7b(this.gb,5),f=this.il.D7b(this.gb,6);var l=this.Od.Nd;a=l.Pe(a+c,0);b=l.Pe(b+f,0);l=l.Pe(this.il.nJf(this.gb),0);return new Oi.a(a,l,b)}CPh(){this.htmlElement.style.background=this.MA.Q6f(this.gb)}UU(){if(!this.Ih)super.UU();
else if(!this.Od.lm&&this.HB){const a=Object(sa.a)(712,this.fS);a&&a.l5g(this.Ih)}}iSa(){const a=this.TRf();a.className="TableRowResizeHandle";return a}nMb(a){N.a.eLa(a);Ga.a.sP(a)}get tableCellNode(){return this.vj}get T5c(){return this.yma}get Pk(){this.Jva||(this.Jva=this.C7f());return this.Jva}set Pk(a){this.Jva=a}get iq(){return this.Vma}GOb(a){this.Vma=a;this.tableCellNode.VAb=a}lock(a){this.iq&&this.yma===a||(this.Pk.Jwd(),this.yma=a,this.GOb(!0),this.Fc.Uy(new lq.a(7)),this.aHa.Anh(new UD(a)),
this.aHa.n3k(new UL(this)))}unlock(){this.iq&&(this.yma=null,this.GOb(!1),this.Fc.Uy(new lq.a(7)),this.aHa.Anh(new UD(null)))}C7f(){let a=null;const b=this.Ga.An(this.vj);b&&(a=Object(sa.a)(117,b.rg(this.Na)));return a}}Object(m.a)(rt,"TableCellViewElement",Tv,[713,340,305,108]);var Qz=d(296),KR=d(511);class ym extends Zh{constructor(a,b,c,f,l,y,G,R,ja,za,Va){super(a,b);Zh.D4a=()=>ir.g0f(oh.a.create());this.il=c;this.Yl=f;this.WJ=y;this.CZa=l;this.zc=G;this.X5=R;this.zZa=ja;this.iFb=za;this.We=Va;
this.L$c=qd.a("PPTOEnableTableDiagonalBorders")}kMf(a,b){Zh.RDi(a,b,Hd.TableReader.Gi(a))}WRf(a,b,c,f=null,l=!1){const y=a.parentNode.eb(va.a.shapeId);a.currentNode.setValue(va.a.shapeId,y);for(var G=0;G<b;++G){var R=new KR.a;a.Gl(R,1);R.setValue(va.a.shapeId,y);R.setValue(va.a.rowId,oh.a.create())}b=null;G=!0;a.Db(1);do{R=a.currentNode.eb(va.a.rowId);for(let ja=0;ja<c;++ja){const za=this.Rsa();a.Gl(za,1);za.setValue(va.a.shapeId,y);za.setValue(va.a.rowId,R);za.setValue(va.a.cellId,oh.a.create());
({exh:b,isFirst:G}=this.C2f(a,za,l,f,b,G));ae.returnToContainingRow(a)}}while(a.Pj(1))}x0a(a){if(this.L$c&&a&&(a=this.zc.WF(a)))for(const b of a)b&&!b.isGhostCell&&(a=Object(sa.a)(rt,b.qc(this.We)))&&a.oXf()}JYe(a,b,c,f,l){var y=this.WJ.vVc(a);for(var G=0;G<y.length;G++){const R=this.il.wub(a,G);y[G]=Math.max(R,y[G]*b)}a.setValue(Ya.a.gv,y);if(1!==c)for((new ub.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){y=l.gf(f.ztj(c),1);G=this.il.RYd(a,c);y<=G&&(y=0);b.setValue(va.a.Ku,y);if(b.yrg())break;
else b=b.EJa;c++}this.x0a(a)}lol(a,b){a=this.zc.WF(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].Ppa=b}}kol(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let y=0;y<l.length;y++){var c=l.ga(y).iterator;c.rc(16);c.Jg(16);c=c.Dq;const G=c.cellShading;G.anchorField=b;c.cellShading=G;c.Ppa=b}}}Eac(a,b,c,f,l){super.Eac(a,b,c,f,l);c=[];Array.add(c,va.a.Ku);Qm.b(f,b,c);c=a.currentNode.eb(va.a.shapeId);const y=a.Dq.eb(va.a.sid);a=a.Dq.eb(va.a.cid);const G=
ir.JPf(oh.a.create());b.setValue(va.a.sid,y);b.setValue(va.a.cid,a);b.setValue(va.a.shapeId,c);b.setValue(va.a.rowId,G);this.OUl(f,b,l)}pac(a,b,c,f,l){super.pac(a,b,c,f,l);return this.gjd(a.currentNode,b,c,f,!1,!1)}D_b(a,b,c,f,l){super.D_b(a,b,c,f,l);return this.gjd(a.currentNode,b,c,f,l,!1)}get uZd(){if(!ym.$aa){ym.$aa=[];let a,b,c;for(const f of ym.c7c)if(this.L$c||2!==f&&1!==f)({pRa:b,b8a:a,$tb:c}=kq.sUa(f)),Array.add(ym.$aa,b),Array.add(ym.$aa,a),Array.add(ym.$aa,c);Array.add(ym.$aa,Ya.a.WE);
Array.add(ym.$aa,va.a.cellShading);Array.add(ym.$aa,sb.a.dQb);Array.add(ym.$aa,sb.a.fQb);Array.add(ym.$aa,sb.a.gQb);Array.add(ym.$aa,sb.a.cQb);Array.add(ym.$aa,va.a.HP)}return ym.$aa}gjd(a,b,c,f,l,y){c=y?this.BFj(b,c,l):this.CFj(b,c,f,l);Qm.c(c,b,this.uZd);f=a.eb(va.a.cid);y=a.eb(va.a.shapeId);const G=c.eb(va.a.cellId),R=a.eb(va.a.rowId);b.setValue(va.a.sid,a.eb(va.a.sid));b.setValue(va.a.cid,f);b.setValue(va.a.shapeId,y);b.setValue(va.a.rowId,R);l?b.setValue(va.a.cellId,G):b.setValue(va.a.cellId,
b.id.guid);return c}vCf(a,b,c,f,l,y){a=a.currentNode;const G=Array(c);let R=0,ja=0,za=0;for(;R<f;R++)G[R]=b[R],ja+=G[R];for(l=l?b[f]:b[f-1];R<f+y;R++)G[R]=l,za+=G[R];for(;R<c;R++)G[R]=b[R-y],ja+=G[R];b=ja/(za+ja);for(R=0;R<c;R++)G[R]=Math.max(G[R]*b,this.il.wub(a,R));return G}nnc(a,b,c,f,l){super.nnc(a,b,c,f,l);var y=a.eb(va.a.Nmb);l=Array(y.length+f);let G=0;for(;G<b;G++)l[G]=y[G];for(;G<b+f;G++)l[G]=ym.LPi();for(;G<l.length;G++)l[G]=y[G-f];a.setValue(va.a.Nmb,l);y=c?l[b+f]:l[b-1];a=Object(sa.a)(Qz.TableNode,
a);this.fSl(a,y,l.slice(b,f+b),b,c);if(this.iFb)for(l=this.zZa.create(a),f=b+f,y=(!c||!b)&&b<this.zc.Gi(a)-1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.X5.k9d(a,l,c,0,this.zc.Ek(a),y)}TNe(a,b,c,f){super.TNe(a,b,c,f);if(this.iFb){a=Object(sa.a)(161,a);const l=this.zZa.create(a);f=c+f;const y=(!b||!c)&&c<this.zc.Ek(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.X5.i9d(a,l,b,0,this.zc.Gi(a),y)}}kNe(a,b,c){super.kNe(a,b,c);this.tRb(a,va.a.complexTable);this.iFb&&(a=Object(sa.a)(161,a.currentNode),c=this.zZa.create(a),
this.X5.i9d(a,c,b,0,this.zc.Gi(a),!0))}jNe(a,b,c){super.jNe(a,b,c);const f=a.currentNode.eb(va.a.Nmb),l=Array(f.length-c);let y=0;for(;y<b;y++)l[y]=f[y];for(;y<l.length;y++)l[y]=f[y+c];a.currentNode.setValue(va.a.Nmb,l);this.tRb(a,va.a.complexTable);this.iFb&&(a=Object(sa.a)(161,a.currentNode),c=this.zZa.create(a),this.X5.k9d(a,c,b,0,this.zc.Ek(a),!0))}OUl(a,b,c){b.setValue(va.a.j6k,a.eb(va.a.rowId));b.setValue(va.a.insertBefore,c)}fSl(a,b,c,f,l){a=a.firstRow;do for(let y=0;y<c.length;++y){const G=
ub.GraphIterator.pb(a),R=G.hq(f+y,1);R.setValue(va.a.i6k,b);R.setValue(va.a.insertBefore,l);R.setValue(va.a.cellId,c[y]);ym.hAh(G,va.a.cellId,c[y])}while(a=a.EJa)}Rsa(){const a=super.Rsa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}RMe(a,b){this.eEj(a,b,c=>{c.currentNode.isGhostCell=!1;Zh.ey.Cac(c,null,!0);const f=c.currentNode.eb(va.a.rowId),l=c.currentNode.eb(va.a.cellId);for(c=He.a.zv(c);c.moveNext();){const y=c.currentNode.sa(va.a.cellId,null);c.currentNode.sa(va.a.rowId,null)&&c.currentNode.setValue(va.a.rowId,
f);y&&c.currentNode.setValue(va.a.cellId,l)}})}Wpd(a){Hd.TableReader.yt(a.currentNode)&&this.Zph(a,b=>b.Sh(va.a.Ku),(b,c)=>{b.Ae(va.a.Ku,c)},va.a.complexTable)}$We(a){a&&(a=ub.GraphIterator.pb(a),this.Wpd(a,0))}upa(a,b){if(a)for(a=this.Yl.Osa(a),a.wm(c=>15===c.Bi,null);a.moveNext();){const c=Object(sa.a)(157,a.iterator.currentNode),f=this.CZa.hab(c);c.setValue(va.a.Ku,f*b)}}YLa(a,b){if(a&&14===a.type){const c=this.WJ.vVc(a);for(let f=0;f<c.length;f++){const l=this.il.wub(a,f);c[f]=Math.max(l,c[f]*
b)}a.setValue(Ya.a.gv,c)}}UAh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(va.a.Ku,Oe.a.iX(b))}TAh(a,b,c){if(a&&b&&0<b.length){const f=this.WJ.vVc(a);for(let l=0;l<b.length;l++)f[b[l]]=Oe.a.iX(c);a.setValue(Ya.a.gv,f)}}Vje(a){const b=new ub.GraphIterator;b.Tc(a);var c=b.currentNode;b.Db(1);const f=a.Cc();this.jAa(a);const l=Us.a.instance.createInstance(393251);this.Eac(a,l,c,c,!1);a.el(l);c=this.zc.Gi(f);for(let y=0;y<c;++y){const G=this.Rsa();super.D_b(a,G,b.currentNode,!1,!0);this.gjd(l,G,
b.currentNode,!1,!0,!0);b.Hf(1)}this.lOb(f,this.zc.Ek(f)+1);return a.currentNode}Uje(a){const b=ub.GraphIterator.pb(a.YRh());let c=this.zc.Gi(b.currentNode);var f=this.WJ.uVc(Object(sa.a)(130,a.currentNode));a=f+1;this.jAa(b);b.Db(1);do{const l=b.hq(f,1);b.Cc();const y=this.Rsa();super.pac(b,y,l,!1,!1);this.gjd(b.currentNode,y,l,!1,!1,!0)}while(b.Pj(1));(f=b.currentNode.sa(Ya.a.gv,null))&&(f=Ub.a.clone(f));this.WNb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(Ya.a.gv,f));this.nnc(b.currentNode,
a,!1,1,null)}K$e(a){this.tRb(a,va.a.complexTable)}BFj(a,b,c){let f=b;const l=b.zJa;if(l)if(b.isGhostCell)Zh.lXc(l,!c)||Zh.nlb(l.controlCell,c,Zh.$xb(l.controlCell,c)+1);else{let y=Zh.$xb(b,c);1<y&&(f=Zh.Gkj(l,!c));Zh.nlb(b,c,y+1)}else Zh.nlb(b,c,2);a.isGhostCell=!0;return f}static hAh(a,b,c){a.currentNode.Ae(b,c);let f=a.Ri();if(f){for(;f;)ym.hAh(a,b,c),f=a.xp();a.Cc()}}static LPi(){return ir.JPf(oh.a.create())}}ym.$aa=null;ym.c7c=[5,6,7,0,2,1];Object(m.a)(ym,"TableEditor",Zh,[1330]);const VL=(a,
b,c,f,l)=>{const y=l.jV,G=l.Dsa;var R=l.tableLook;const ja=0<(R&32);l=0<(R&128);const za=0<(R&64),Va=0<(R&256),hb=ja?1:0,Cb=l?1:0;R=a?a===y-c?za?3:(a-hb)%2+hb:(a-hb)%2+hb:0;y-c||(R=ja?0:za?3:(a-hb)%2+hb);a=b?b===G-f?Va?3:(b-Cb)%2+Cb:(b-Cb)%2+Cb:0;G-f||(a=l?0:Va?3:(b-Cb)%2+Cb);return{bJf:R,$If:a}};class VD{constructor(a){this.q1=a;this.ybd=Array(4);for(a=0;4>a;a++)this.ybd[a]=Array(4)}A6f(a,b,c,f){let l,y;({bJf:l,$If:y}=VL(a,b,c,f,this.q1));if(!this.ybd[l][y]){c=Object.assign(new vr.a,{oe:b,Tf:b+f,
ve:a,eg:a+c});a=this.ybd[l];b=y;f=this.q1;var G=f.tableStyle,R=new er;R.latinField=jf.Svb(1,0);R.eaField=jf.Svb(1,1);R.csField=jf.Svb(1,2);R.solidFillField=Object.assign(new cv.a,{schemeClrField:Object.assign(new ci.a,{valField:1})});G&&(new yL(R)).s_(f,c);c=R;G=f.ock;f=new $x;G=G||new xL;for(R=1;9>=R;R++){var ja=zL(G,R);const za=R-1;f.KPe[za]=ja?Nd.a(Nd.c(ja)):new Ms;ja=f.KPe[za].defRPrField;f.Vub[za]=ja?Nd.a(Nd.c(ja)):new er}for(G=1;9>=G;G++)AL(f.Vub[G-1],c);a[b]=f}return this.ybd[l][y]}d8f(a,b,
c,f,l){let y=oc.a.xSa;a&&(b=this.A6f(b,c,f,l))&&b.Vub&&0<b.Vub.length&&(b=b.Vub[0])&&(y=Hf.Box4ColorHelper.LMb(b,a));return y}}Object(m.a)(VD,"TableListStyleCache",null,[584]);class WD{constructor(a,b,c,f){this.yHa=a;this.g2g=b;this.yHa.gk(Object(H.a)(this,this.$g,"onPropertyChanged"));this.yHa.ija(Object(H.a)(this,this.onConnected,"onConnected"));this.We=c;this.pCe=f}onConnected(a,b){a=Object(sa.a)(161,b.node);this.g2g.LRh(a)}$g(a,b){a=b.property;b=Object(sa.a)(161,b.node);a===Ya.a.gv?this.g2g.LRh(b):
a===Ya.a.Lza||a===Ya.a.hha||a===Ya.a.yB?b.tZ=null:!this.pCe||a!==va.a.cWa&&a!==va.a.isResizable&&a!==va.a.bM||b.qc(this.We).Eaf()}dispose(){this.yHa.Qm(Object(H.a)(this,this.$g,"onPropertyChanged"));this.yHa.Xoa(Object(H.a)(this,this.onConnected,"onConnected"))}}Object(m.a)(WD,"TableNodeBehavior",null,[108]);var XD=d(181);class Vv{constructor(a,b,c,f,l,y,G,R){this.e1=this.qR=this.Wn=this.bIa=this.b1=this.Afd=this.rHa=null;this.dgb=this.pcd=0;this.WPg=this.Uic=this.Zd=this.Sx=null;this.LO=a;this.ia=
c;this.Uq=f;this.Vs=l;this.wD=y;this.iaa=b;this.mq=G;this.Wp=R}qL(){this.e1=this.qR=this.Wn=this.b1=this.bIa=null;null!==this.mq&&this.mq.Eya()}Mv(a){if(!a||a.OA===Sys.UI.MouseButton.rightButton||this.LO.t0)return!1;this.Zd=(this.Sx=Object(sa.a)(1324,this.wD.eJ(a.Bc)))?this.Sx.Pk:null;if(!this.Zd)return!1;this.rHa=this.Sx.hDi;if(!this.rHa)return!1;this.qR=this.rHa.Hkg(a.Bc);if(!this.qR)return!1;this.Wp&&this.ia.processAction(C.a.Eka,2);return!0}av(a){if(!a||!this.Mv(a))return!1;this.Afd=this.Sx=this.wD.eJ(this.rHa.xa);
if(!this.Sx)return ya.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),!1;this.ia.processAction(ea.a.N8a,2);this.rHa.jE(!0);this.Zd.jE(!0);null!==this.mq&&this.mq.bza(Ui.a.GPb);this.e1=this.Afd.f9b();this.pcd=this.Uq.vm(cd.a.Ql(this.e1.ga(0),this.e1.ga(1)));this.dgb=this.Uq.vm(cd.a.Ql(this.e1.ga(0),this.e1.ga(3)));this.bIa=this.HPf(a.clientPoint);this.b1=new cd.a(0,0);this.Wn=new Gi.a;this.WPg=new cd.a(this.Zd.x+this.pcd,this.Zd.y+this.dgb);return!0}Sw(a){if(!a)return!1;
a=this.HPf(a.clientPoint);var b=cd.a.xV(a,this.bIa);this.b1=cd.a.add(this.b1,b);b=hl.TYd(this.qR,this.e1,this.b1,!1,!1);this.Wn=Object.assign(new Gi.a,{bottom:this.Uq.vm(b.bottom),left:this.Uq.vm(b.left),right:this.Uq.vm(b.right),top:this.Uq.vm(b.top)});let c;({QTh:b,UTh:c}=this.tJf());const f=new XD.a;f.Pca(b,c);f.DC(this.Wn.left,this.Wn.top);this.rHa.wq(f);this.bIa=a;return!0}vo(a){let b=null;a&&(b=this.iaa.Ii("UserAction","PPTTableResize"),ya.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",
this.Sx.gb.sa(va.a.pIb,""),Hd.TableReader.yt(this.Sx.gb))));this.rHa.hA(!1);({QTh:l,UTh:y}=this.tJf());this.Sx.XAh(l,y);this.N6e();const c=new pf.GraphTransaction(15);c.ld(this.Sx.gb);var f=this.Sx.Od.Nd;this.Vs.JYe(Object(sa.a)(Qz.TableNode,this.Sx.gb),l,y,this.Afd,f);if(Vv.NFa(this.qR)||Vv.NFa(this.qR,!0)){var l=this.Sx.Pk.shapeNode;var y=f.gf(this.Zd.x,0);f=f.gf(this.Zd.y,1);l.My=y;l.Ny=f}this.Zd.hA(!1);c.dispose();this.qL();Sc.App.Mb.updateCommandUI();b&&b.stop();a&&ya.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",
this.Sx.gb.sa(va.a.pIb,""),Hd.TableReader.yt(this.Sx.gb)))}N6e(){var a=Vv.NFa(this.qR),b=Vv.NFa(this.qR,!0);if(a||b){b=this.Afd.f9b();a=this.Uq.vm(b.hc-b.kc);b=this.Uq.vm(b.Zb-b.mc);const c=this.WPg;c._x+=this.Wn.right;c._y+=this.Wn.bottom;this.Zd.setPosition(c.x-a,c.y-b,!0)}}Fu(){this.b1&&(this.rHa.hA(!0),this.rHa.wq(null),this.Zd.hA(!0),this.qL())}tJf(){return{QTh:this.pcd?1+(this.Wn.right-this.Wn.left)/this.pcd:1,UTh:this.dgb?1+(this.Wn.bottom-this.Wn.top)/this.dgb:1}}HPf(a){a=cd.a.GTa(a);var b=
this.qR;this.qR.hbc()||(b=b.Hyb());const c=this.e1.Wj(b);b=this.e1.Wj(b.t$a());return a=new cd.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static NFa(a,b=!1){return a.equals(rd.a.Zu)?!0:b?a.equals(rd.a.north)||a.equals(rd.a.TE):a.equals(rd.a.west)||a.equals(rd.a.iI)}}Object(m.a)(Vv,"TableResizeDragAdapter",null,[235]);class YD{constructor(a,b){this.q1=a;this.GHb=b;this.vi=Array(4);for(a=0;4>a;a++)this.vi[a]=Array(4);this.tJe=Array(16)}dae(a,b,c,f){let l,
y;({bJf:l,$If:y}=VL(a,b,c,f,this.q1));this.vi[l][y]||(this.vi[l][y]=this.GHb.igl(this.q1,a,b,c,f));c=this.vi[l][y].clone();if(a=this.OAj(a,b))for(const G of a.pA())c.Ta(G)||c.Ae(G,a.Sh(G));return c}clear(){for(let a=0;4>a;a++)this.vi[a]=Array(4);this.tJe=Array(16)}OAj(a,b){var c=a===this.q1.jV-1;const f=b===this.q1.Dsa-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.tJe[l])||(this.tJe[l]=c=this.GHb.Egl(this.q1,a,b));return c}}Object(m.a)(YD,"TableStyleCache",null,[583]);class XL{constructor(a){this.uYa=
a}igl(a,b,c,f,l){const y=a.jV;var G=a.Dsa,R=a.tableLook;const ja=a.tableStyle;a=a.Fd;const za=new Cq.a,Va=0<(R&32),hb=0<(R&128),Cb=!b&&Va,lc=!c&&hb;f=b===y-f&&0<(R&64);l=c===G-l&&0<(R&256);G=!(R&512)&&!Cb&&!f;R=!(R&1024)&&!lc&&!l;this.Fgl(ja.wholeTblField,za);G&&this.Kya((Va?1!==(b&1):b&1)?ja.band2HField:ja.band1HField,a,za);R&&this.Kya((hb?1!==(c&1):c&1)?ja.band2VField:ja.band1VField,a,za);l&&this.Kya(ja.lastColField,a,za);lc&&this.Kya(ja.firstColField,a,za);f&&(this.Kya(ja.lastRowField,a,za),l&&
this.Kya(ja.seCellField,a,za),lc&&this.Kya(ja.swCellField,a,za));Cb&&(this.Kya(ja.firstRowField,a,za),l&&this.Kya(ja.neCellField,a,za),lc&&this.Kya(ja.nwCellField,a,za));return za}Egl(a,b,c){var f=a.jV;const l=a.Dsa;var y=a.tableStyle;a=a.Fd;const G=new Cq.a;if(y&&0<=b&&b<f&&0<=c&&c<l){const R=!c;f=b===f-1;c=c===l-1;(y=y.wholeTblField)&&y.tcStyleField&&(y=y.tcStyleField.tcBdrField)&&(this.S0a(7,b?y.insideHField:y.topField,a,G),this.S0a(0,f?y.bottomField:y.insideHField,a,G),this.S0a(5,R?y.leftField:
y.insideVField,a,G),this.S0a(6,c?y.rightField:y.insideVField,a,G))}return G}euh(a,b,c){const f=new Cq.a;this.buh(a,c,b,f);return f}Fgl(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.Ae(va.a.cellShading,a.tcStyleField.fillField)}Kya(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.Ae(va.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.S0a(7,a.topField,b,c),this.S0a(0,a.bottomField,b,c),this.S0a(5,a.leftField,b,c),this.S0a(6,a.rightField,b,c))}S0a(a,b,c,f){b&&b.itemField&&
this.buh(a,b.itemField,c,f)}buh(a,b,c,f){let l;({pRa:l,b8a:a}=kq.sUa(a));b.wFieldSpecified&&f.Ae(l,Oe.a.n6d(b.wField));if(b.solidFillField)if(this.uYa)f.Ae(a,b.solidFillField);else{if(b=Hf.Box4ColorHelper.Dkb(b.solidFillField,c))b=Hf.Box4ColorHelper.nha(b),f.Ae(a,b)}else b.noFillField&&(this.uYa&&qd.a("TableBordersLocalRenderingFix")?(b=Hf.Box4ColorHelper.vS({Color:"##T,0,0,0"}),f.Ae(a,b),f.Ae(l,0)):f.Ae(a,oc.a.xSa))}}Object(m.a)(XL,"TableStyleResolver",null,[363]);var YL=d(334),Rz=d(191);class by{constructor(a,
b,c,f=null){this.sxa=!1;this.MB=this.so=this.ob=this.KBg=this.g4g=null;this.sD=[];this.Tk=this.AA=!1;this.HR=null;this.Vn=this.kfb=!1;this.Fa=b;this.sQg=a;this.Rc=f;this.zU=(this.C$c=c)?10:6;this.$Ge=c?2:Pd.a.hF}get visible(){return this.sxa}set visible(a){this.sxa!==a&&(this.sxa=a,this.rAh())}get xa(){return this.ob.viewport.xa}Ksi(a,b,c){this.g4g=a;this.KBg=c;this.Bm();this.Rc.ub(pa.a.click,this.xa,Object(H.a)(this,this.M8g,"notifySelectShapeByClick"));b.appendChild(this.ob.viewport);this.g4g.uK(this.xa,
!0);this.kfb=!0;this.setZIndex(2+Sx.a.Bha+1)}xOh(){this.kfb&&this.ob&&this.Rc.Bb(pa.a.click,this.xa,Object(H.a)(this,this.M8g,"notifySelectShapeByClick"));this.kfb=!1}setZIndex(a){this.kfb&&this.ob.lC(a)}Bm(){this.ob||(this.ob=new Rz.a,this.so=new Vm.a,this.so.dF(gj.a.none),this.so.fv(Pd.a.h2),this.so.xr(Pd.a.hF),this.ob.Bl(Ui.a.aB),this.ob.appendChild(this.so),this.MB=new Ko.a,this.Q3b(this.MB),this.ob.appendChild(this.MB),this.ob.Sd(!1),this.ob.viewport.xa.setAttribute(gj.a.fKb,gj.a.none))}em(){if(this.kfb){var a=
this.Juj(this.KBg);this.AA?(this.HR&&this.HR.ql(a),this.so.Mt(a.points)):(a=a.points,this.so.Mt(a),a=new Ce.a(a[0],a[1],a[2],a[3]));this.SY(a);this.ob.em()}}Q3b(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new Ko.a;l.xa.id=b;if(z.a.wMa){var c=new YL.a;c.xa.id=b;c.xa.setAttribute("class",wj.a.Zwd);c.setVisibility(!1);c.setPosition(-10,-10);c.ah(20,20);l.appendChild(c)}c=new YL.a;c.xa.id=b;c.xa.setAttribute("class",wj.a.Zwd);b=this.zU/2*-1;c.setPosition(b,b);c.ah(this.zU,this.zU);this.C$c&&
c.uAh(this.zU/2,this.zU/2);c.dF("white");c.fv(Pd.a.h2);c.xr(this.$Ge);c.PAh();l.appendChild(c);l.ek(1);this.sD[f]=l;a.appendChild(l)}}SY(a){for(let b=0;8>b;++b){const c=this.sD[b];c.Bl(by.Msc[b]);this.NLa(c,a.Wj(new rd.a(b)))}}Juj(a){return new Ce.a(new cd.a(0,0),new cd.a(a.offsetWidth,0),new cd.a(a.offsetWidth,a.offsetHeight),new cd.a(0,a.offsetHeight))}JD(a){this.Vn||((this.AA=a)?(this.so.dF(Pd.a.lXf),this.so.fv(Pd.a.h2),this.so.xr(Pd.a.hF),this.MB.Sd(!1),this.sQg.endEditing(!0,14)):(this.so.dF(gj.a.none),
this.so.fv(Pd.a.h2),this.so.xr(Pd.a.hF),this.MB.Sd(!0),this.Fa.wf(xa.a.qg),this.sQg.rS()))}dispose(){this.Tk||(this.xOh(),this.so=this.ob=null,Array.clear(this.sD),this.MB=null,this.kfb=!1,this.Tk=!0)}Hkg(a){if(!this.kfb)return null;for(let b=0;8>b;++b)if(this.sD[b].xa.id===a.id)return new rd.a(b);return null}NLa(a,b){a.setPosition(b.x,b.y)}M8g(a){return this.Hkg(a.Bc)?!0:!1}jE(a){this.JD(!0,a)}hA(){this.JD(!1)}wq(a){this.HR&&this.HR.clear();this.HR=a;this.em()}Xw(a){this.Vn=a;this.rAh()}rAh(){this.ob&&
this.ob.Sd(!this.Vn&&this.sxa)}static A3b(a){return new by(a,Fb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,w.AFrameworkApplication.Aa.$y)}}by.Msc=[Ui.a.Y5e,Ui.a.X5e,Ui.a.W5e,Ui.a.V5e,Ui.a.Z5e,Ui.a.$5e,Ui.a.a6e,Ui.a.b6e];Object(m.a)(by,"DraggablePandoraChromeView",null,[1329]);class ZL{}Object(m.a)(ZL,"TableStyleCategoryInfo",null,[]);class Zf{static L2i(){if(Zf.lh)return Zf.lh;Zf.lh=new Yc.a;
Zf.lh.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);Zf.lh.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));Zf.lh.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));Zf.lh.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));Zf.lh.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,4));Zf.lh.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));Zf.lh.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));Zf.lh.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);Zf.lh.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));Zf.lh.$("Themed Style 2 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));Zf.lh.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));Zf.lh.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));Zf.lh.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));Zf.lh.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,6));Zf.lh.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));Zf.lh.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));Zf.lh.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));Zf.lh.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,3));Zf.lh.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));Zf.lh.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));Zf.lh.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));Zf.lh.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));Zf.lh.$("Light Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));Zf.lh.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));Zf.lh.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));Zf.lh.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));Zf.lh.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,5));Zf.lh.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));Zf.lh.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));Zf.lh.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));Zf.lh.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,2));Zf.lh.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));Zf.lh.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));Zf.lh.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));Zf.lh.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));Zf.lh.$("Medium Style 1",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));Zf.lh.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));Zf.lh.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));Zf.lh.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));Zf.lh.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,4));Zf.lh.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));Zf.lh.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));Zf.lh.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));Zf.lh.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,1));Zf.lh.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));Zf.lh.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));Zf.lh.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));Zf.lh.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));
Zf.lh.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));Zf.lh.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));Zf.lh.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));Zf.lh.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));Zf.lh.$("Medium Style 3 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));Zf.lh.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));Zf.lh.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));Zf.lh.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));Zf.lh.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleMedium,4));Zf.lh.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));Zf.lh.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));Zf.lh.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));Zf.lh.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,4));Zf.lh.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));Zf.lh.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));Zf.lh.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Zf.lh.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));Zf.lh.$("Dark Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));Zf.lh.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));Zf.lh.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));Zf.lh.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));Zf.lh.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,6));Zf.lh.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));Zf.lh.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));Zf.lh.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));Zf.lh.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,4,5));return Zf.lh}static feg(a){const b=Zf.L2i();return b.Gb(a)?b.ga(a):a}}Zf.lh=null;Object(m.a)(Zf,"TableStyleNameReader",null,[]);class $L{constructor(a){this.gFg=!1;this.BDb=[];this.nBe=new Qe.a(0);this.Lve=[];this.KZg=a}H6d(){this.gFg||(this.gFg=this.MTk())}MTk(){const a=this.KZg.instance?this.KZg.instance.WIl:null;if(a&&a.tblStyleCategoriesField){let b=0;this.BDb=[];this.nBe=new Qe.a(0);this.Lve=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=
a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.Lve,Object.assign(new ZL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const y=f.tblStylesField[l],G=new J.DictionaryPropertySet,R=new RD(y,f.idField,l);G.Ae(va.a.tableStyle,R);this.BDb.push(G);this.nBe.$(y.styleIdField.toLowerCase(),b++)}}}return!0}return!1}TUc(){return this.BDb}jzb(a){return 0<=a&&a<this.BDb.length?this.BDb[a]:null}$wj(a,b){let c=null;
for(const f of this.Lve)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.jzb(a):null}jxj(a){return this.b9b(a).vY.styleIdField}kxj(a){return(a=this.b9b(a).vY.styleNameField)?qd.a("TableStyleNameLocalization")?Zf.feg(a):a:""}cxj(a){return this.b9b(a).wBg}b9b(a){return a.Sh(va.a.tableStyle)}eeg(a){return(a=this.byj(a))?a.Sh(va.a.tableStyle):null}byj(a){this.H6d();return this.BDb[this.nBe.ga(a.toLowerCase())]}}Object(m.a)($L,"TableStyleGalleryManager",null,[364]);class aM{constructor(a,b,
c,f,l){this.lM=0;f||(f=Object.assign(new vr.a,{ve:0,eg:c.mP,oe:0,Tf:c.WR}));this.Uve=a;this.hvk=b;this.Kna=c;this.GE=f;this.tA=new vr.a;this.bP=this.lM=-1;this.r9c=l}get wtg(){return-1===this.bP||-1===this.lM}moveNext(){this.wtg&&(this.bP=this.GE.ve,this.tA.Tf=this.GE.oe);for(;;){this.lM=this.tA.Tf;if(this.lM>=this.GE.Tf&&(this.lM=this.GE.oe,++this.bP>=this.GE.eg))return this.reset(),!1;this.tA=this.Uve.ZI(this.Kna,this.bP,this.lM);if(this.bP===this.GE.ve||this.bP===this.tA.ve)if(!this.r9c||this.r9c.PSd(this))return!0}}gBk(){this.wtg&&
(this.lM=this.GE.oe,this.tA.eg=this.GE.ve);for(;;){this.bP=this.tA.eg;if(this.bP>=this.GE.eg&&(this.bP=this.GE.ve,++this.lM>=this.GE.Tf)){this.reset();break}this.tA=this.Uve.ZI(this.Kna,this.bP,this.lM);if(this.lM===this.GE.oe||this.lM===this.tA.oe)if(!this.r9c||this.r9c.PSd(this))break}}moveTo(a,b){this.tA=this.Uve.ZI(this.Kna,a,b);if(!this.tA.p5i(this.GE))return this.reset(),!1;this.bP=Math.min(Math.max(a,this.GE.ve),this.GE.eg-1);this.lM=Math.min(Math.max(b,this.GE.oe),this.GE.Tf-1);return!0}reset(){this.bP=
this.lM=-1}H7b(){return this.hvk.ff(this.tA.ve,this.tA.oe)}}Object(m.a)(aM,"CellIterator",null,[1335]);class bM{constructor(a){this.Sq=a}jEa(a,b,c,f=null){return new aM(this.Sq,a,b,c,f)}}Object(m.a)(bM,"CellIteratorFactory",null,[359]);class ZD{constructor(a,b,c){this.Sq=b;this.Kna=c;this.oD=this.Sq.JSc(this.Kna,a.GE);this.d$=Array(this.oD.WR*(this.oD.mP+1));this.bP=this.oD.ve;this.deb=this.oD.oe;this.GDb=this.oD.oe-1;this.Tq=0;this.yje(a)}yje(a){const b=a.GE;for(;a.moveNext();){const f=a.tA;for(let l=
f.oe;l<f.Tf;l++){var c=this.EEa(f.ve,l);this.d$[c]=0!==this.d$[c]?2:l<b.oe&&f.ve>b.ve?16:l>=b.Tf&&f.ve>b.ve?64:1;c=this.EEa(f.eg,l);this.d$[c]=0!==this.d$[c]?2:l<b.oe&&f.eg<b.eg?16:l>=b.Tf&&f.eg<b.eg?64:4}}}EEa(a,b){return this.oD.WR*(a-this.oD.ve)+(b-this.oD.oe)}moveNext(){this.deb=this.GDb;do{this.deb++;this.deb>=this.oD.Tf&&(this.bP++,this.deb=this.oD.oe);if(this.bP>this.oD.eg)return!1;this.Tq=this.d$[this.EEa(this.bP,this.deb)]}while(0===this.Tq);for(this.GDb=this.deb;this.GDb+1<this.oD.Tf&&this.d$[this.EEa(this.bP,
this.GDb+1)]===this.Tq;)this.GDb++;return!0}Yfj(){return this.GDb+1}O$a(){return this.Tq}static hoe(a){return!!(a&87)}}Object(m.a)(ZD,"HorizontalTableBorderIterator",null,[1205,539]);class cM{constructor(a){this.Sq=a}IOi(a,b){return new ZD(a,this.Sq,b)}}Object(m.a)(cM,"HorizontalTableBorderIteratorFactory",null,[360]);var Sz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=
4]="rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Sz||(Sz={}));Object(m.b)("LayoutInvalidateTrigger",Sz);class dM{constructor(){this.Kja=this.HXd=this.Pwc=
this.S0d=0}get rowSpan(){return this.HXd-this.Pwc}toString(){return String.format("C[{0}][{1}]",this.Pwc,this.Kja)}}Object(m.a)(dM,"CellInfo",null,[]);class wr{constructor(){this.n1c=!1;this.Vc=this.QKf=this.telemetry=null;this.pdb=this.vuc=!1;this.axd=null;this.Q5g=0;this.tableNode=this.$se=this.yza=null;this.V7d=!1}}Object(m.a)(wr,"LayoutContext",null,[]);class eM{constructor(){this.SFh=this.CAd=0}}Object(m.a)(eM,"LayoutTelemtry",null,[]);class $D{constructor(){this.offset=this.amc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",
this.index,this.amc,this.offset)}}Object(m.a)($D,"RowSeamInfo",null,[]);class Qh{constructor(a,b,c,f,l,y,G){this.rD=null;this.PEb=[];this.NIa=[];this.bY=0;this.Tk=this.kbd=!1;this.qgb=null;this.fad=!1;this.pbd=0;this.Ve=null;this.Nz=a;this.wb=f;this.il=y;this.Tb=c;this.tY=G;this.Hac(1)}TUj(a,b){if(!this.kbd&&!this.fad)try{2!==this.bY&&(1===this.bY?this.PEb[0]!==a&&this.Hac(b):(this.PEb[this.PEb.length]=a,this.bY=1,this.pbd=b))}catch(c){this.Hac(0),ya.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",
c.toString())}}Hac(a){this.fad||2===this.bY||this.kbd||(this.bY=2,this.PEb=[],this.pbd=a)}uhe(){return 0!==this.bY&&!this.kbd}get R0c(){return this.bY}xQh(a){this.uhe()&&(a=Object.assign(new wr,{tableNode:a}),this.layout(a))}GTl(a,b){this.uhe()?this.qgb||(this.qgb=new pd.a(3,1,0,Object(H.a)(this,this.CSk,"performLayout"),90,"9"),this.qgb.customData=Object.assign(new wr,{tableNode:a,n1c:!0,$se:b}),this.wb.Hb(this.qgb)):b&&b(!1)}CSk(a){this.layout(Object(sa.a)(wr,a.customData))}layout(a){this.fad=!0;
const b=new xf.a(null,Object(H.a)(this,this.dSj,"initializeLayoutState"),a);b.Zi=!a.n1c;b.run()}dSj(a,b){b=Object(sa.a)(wr,b);try{this.i2i();b.Vc=this.Ve;b.telemetry=new eM;this.IXl();if(!this.uhe())return a.gh(Object(H.a)(this,this.Rza,"tearDownLayout")),!0;this.bY=0;if(!b.tableNode.isConnected)return a.gh(Object(H.a)(this,this.Rza,"tearDownLayout")),!0;const c=Object(sa.a)(1324,b.tableNode.qc(this.Nz));if(!c)return a.gh(Object(H.a)(this,this.Rza,"tearDownLayout")),!0;b.axd=c;b.Vc.Wa(Qh.Jqi,b.n1c.toString());
b.tableNode.Op()?(b.Vc.Wa(Qh.Wwg,Sz[this.pbd]),a.gh(Object(H.a)(this,this.iXk,"prepareTableMetrics"))):(b.Vc.Wa(Qh.Wwg,"tableComplexityChange"),b.vuc=!0,b.pdb=!0,a.gh(Object(H.a)(this,this.Rza,"tearDownLayout")))}catch(c){b.Vc.Wa(Qh.Edc,c.message),a.gh(Object(H.a)(this,this.Rza,"tearDownLayout"))}return!0}iXk(a,b){b=Object(sa.a)(wr,b);try{b.yza=new Date,this.tY.Ujh(b.tableNode,this.Nz),b.Vc.Wa(Qh.cXk,(+new Date-+b.yza).toString()),b.Vc.Wa(Qh.nAk,this.tY.gZj.toString()),a.gh(Object(H.a)(this,this.gbk,
"layoutBaselineTable"))}catch(c){b.Vc.Wa(Qh.Edc,c.message),a.gh(Object(H.a)(this,this.Rza,"tearDownLayout"))}return!0}gbk(a,b){b=Object(sa.a)(wr,b);try{b.yza=new Date;b.V7d=!0;b.Q5g=Qh.wzk;this.rD=[];this.rD[this.rD.length]=Object.assign(new $D,{index:0,amc:0,offset:0});const c=new wf.a(this.Nz);c.set(b.tableNode);if(!c.Db(1))throw Error.invalidOperation(Qh.g1f);const f=b.tableNode;let l=c.currentNode,y=l,G=0,R=0,ja=0;for(;l;){15===l.type&&(y=l,ja=G=0,l=c.Db(1));const za=l;if(!za)throw ya.a.J(512495690,
808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===za.rowSpan){const Va=Object(sa.a)(rt,l.qc(this.Nz));G=Math.max(G,this.tY.I7b(f,Va.Qja,R,ja))}l=c.Pj(1);ja++;if(!l){const Va=Object.assign(new $D,{index:this.rD.length});let hb=y.sa(va.a.Ku,0);hb=Math.max(hb,this.il.rMc(y));let Cb=b.axd.Od.Nd.Pe(hb,1);Cb=Math.max(Cb,G);Va.offset=Cb+this.rD[Va.index-1].offset;Va.amc=Cb;this.rD[this.rD.length]=Va;l=c.Hf(1);R++}}a.gh(Object(H.a)(this,
this.lbk,"layoutRowSeams"));b.Vc.Wa(Qh.jbk,(+new Date-+b.yza).toString())}catch(c){b.Vc.Wa(Qh.Edc,c.message),b.vuc=!0,a.gh(Object(H.a)(this,this.Rza,"tearDownLayout"))}return!0}lbk(a,b){b=Object(sa.a)(wr,b);try{if(1===this.rD.length)throw Error.create(Qh.d6i);let c=b.QKf;if(!c){b.yza=new Date;c=new wf.a(this.Nz);c.set(b.tableNode);if(!c.Db(1))throw Error.invalidOperation(Qh.g1f);b.QKf=c}const f=b.tableNode;let l=c.currentNode,y=0,G=0,R=0;for(;l&&y<b.Q5g;){15===l.type&&(l=c.Db(1),G=0);const ja=l;if(!ja)throw ya.a.J(512495687,
808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");y++;b.telemetry.CAd++;1===ja.rowSpan||uj.OutlineReader.isEmpty(c)?b.telemetry.SFh++:this.nbk(this.bNi(f,ja,R,G),b.Vc);l=c.Pj(1);G++;l||(l=c.Hf(1),R++)}l||(this.UHl(),a.gh(Object(H.a)(this,this.M9i,"fixupTableMinRowHeight")),b.Vc.Wa(Qh.mbk,(+new Date-+b.yza).toString()))}catch(c){b.Vc.Wa(Qh.Edc,c.message),b.vuc=!0,a.gh(Object(H.a)(this,this.Rza,"tearDownLayout"))}return!0}M9i(a,b){b=
Object(sa.a)(wr,b);try{const l=b.axd;b.yza=new Date;const y=[];var c=new wf.a(this.Nz);c.set(b.tableNode);for(var f=c.Db(1);f;)y[y.length]=c.ir,f=c.Pj(1);if(this.NIa.length===y.length){c=[];for(f=0;f<y.length;++f)c[f]=0,1<Math.abs(this.NIa[f]-y[f].htmlElement.offsetHeight)&&(c[f]=this.NIa[f]);for(f=0;f<c.length;++f)0<c[f]&&y[f].AOb(c[f]*l.sde())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.NIa.length,y.length));a.gh(Object(H.a)(this,this.Rza,"tearDownLayout"));b.Vc.Wa(Qh.I9i,
(+new Date-+b.yza).toString());b.pdb=!0}catch(l){b.Vc.Wa(Qh.Edc,l.message),b.vuc=!0,a.gh(Object(H.a)(this,this.Rza,"tearDownLayout"))}return!0}Rza(a,b){a=Object(sa.a)(wr,b);a.yza=new Date;a.vuc?(this.Zgl(a.Vc,a.tableNode,a.axd),a.V7d=!0):a.Vc&&(a.Vc.Wa(Qh.pbk,a.telemetry.CAd.toString()),a.Vc.Wa(Qh.obk,a.telemetry.SFh.toString()));this.qgb&&!a.n1c&&this.wb.Kg(this.qgb);this.fad=!1;this.qgb=null;this.pbd=0;a.Vc&&(a.Vc.Wa(Qh.pdb,a.pdb.toString()),!a.pdb&&a.Vc&&a.Vc.Wa(Qh.tableLayout,this.tY.Q5d(a.tableNode)),
a.Vc.Wa(Qh.tJl,(+new Date-+a.yza).toString()),a.Vc.finish());a.pdb||(this.kbd=!0);this.rD=null;this.PEb=[];this.Ve=null;this.tY.reset();a.$se&&a.$se(a.V7d);return!1}Zgl(a,b,c){if(b.isConnected)try{const f=new wf.a(this.Nz);f.set(b);let l=f.Db(1);for(;l;){const y=Object(sa.a)(Uv,f.tSa);if(!y)throw Error.argument("tableRowViewElement");let G=c.Od.Nd.Pe(l.sa(va.a.Ku,0),1);const R=c.sde();G*=R;y.AOb(G);l=f.Pj(1)}}catch(f){a&&a.Wa(Qh.Ygl,f.message)}}nbk(a,b){if(!a)throw Error.create(Qh.c6i);var c=this.rD[a.Pwc];
const f=this.rD[a.HXd];c=Math.max(this.Joj(c,f),a.S0d)-(f.offset-c.offset);if(!(0>=c)&&(this.Imi(f.index,c),f.offset<=this.rD[f.index-1].offset)){b.Wa(Qh.RAi,a.toString());for(a=0;a<=f.index;++a)b.Wa(Qh.Dkl,this.rD[a].toString());throw Error.create(Qh.e6i);}}UHl(){if(this.rD){this.NIa=[];for(let a=1;a<this.rD.length;++a)this.NIa[this.NIa.length]=this.rD[a].offset-this.rD[a-1].offset}else this.NIa=null}Imi(a,b){if(b)for(var c=a,f=0;c<this.rD.length;){b=c===a?b:b+this.rD[c].amc-this.rD[c].offset+f;
if(0>=b)break;f=this.rD[c].offset;this.rD[c].offset+=b;c++}}Joj(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.rD[a+1].amc,a++;return c}bNi(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(sa.a)(rt,b.qc(this.Nz)),y=this.Tb.Lc(b);y.rc(14);a=Object.assign(new dM,{S0d:this.tY.I7b(a,l.Qja,c,f),Pwc:Dk.c(y),Kja:f});a.HXd=a.Pwc+b.rowSpan;return a}dispose(){this.Tk||(this.PEb=this.rD=this.NIa=null,this.bY=0,this.Tk=!0)}IXl(){if(this.Tk)throw Error.invalidOperation("table layout service is already disposed");
}i2i(){this.Ve||(this.Ve=Kc.a.Jj("TableLayout"))}get Na(){return this.Nz}}Qh.wzk=25;Qh.Edc="FailureReason";Qh.Ygl="RestoreFailureReason";Qh.tableLayout="Layout";Qh.Dkl="SI";Qh.RAi="CI";Qh.Jqi="FAsync";Qh.pbk="CellVisited";Qh.obk="CellSkipped";Qh.pdb="Succeeded";Qh.jbk="LETD";Qh.mbk="LRST";Qh.I9i="FMTR";Qh.tJl="TDLD";Qh.cXk="PM";Qh.Wwg="Trigger";Qh.nAk="MC";Qh.c6i="CellDisconnected";Qh.d6i="ChildOfTableNotLoaded";Qh.e6i="SeamPositionInvariant";Qh.g1f="NoRowViewElement";Object(m.a)(Qh,"PPTTableLayoutService",
null,[1334,108]);class fM{constructor(a,b,c,f,l){this.Tb=a;this.wb=b;this.lvk=c;this.il=f;this.tY=l}create(a,b){return new Qh(a,b,this.Tb,this.wb,this.lvk,this.il,this.tY)}}Object(m.a)(fM,"PPTTableLayoutServiceFactory",null,[366]);class gM{constructor(a,b,c,f,l,y,G,R,ja){this.jsk=a;this.Zo=b;this.Tb=c;this.BZa=f;this.k2g=l;this.nhb=y;this.ejc=G;this.Ys=R;this.y$c=!0;this.$Be=ja;this.mwa=new Yc.a;this.Zo.eG&&!this.Zo.ik&&(this.y$c=!1);this.y$c&&(this.BZa.sUd(Object(H.a)(this,this.t$g,"onBeforeTableViewElementDisconnected")),
this.BZa.ija(Object(H.a)(this,this.seh,"onTableNodeConnected")),this.BZa.gk(Object(H.a)(this,this.ueh,"onTableNodePropertyChanged")),this.BZa.p8(Object(H.a)(this,this.teh,"onTableNodeDisconnected")),this.k2g.gk(Object(H.a)(this,this.weh,"onTableRowNodePropertyChanged")),this.nhb.gk(Object(H.a)(this,this.eld,"onTableCellNodePropertyChanged")),this.nhb.KF(Object(H.a)(this,this.reh,"onTableCellNodeChildTopoChanged")),this.ejc.gk(Object(H.a)(this,this.vch,"onParagraphNodePropertyChanged")),this.Ys.oli(Object(H.a)(this,
this.Pdh,"onSlideInvalidateRenderSize")))}YXc(a,b){if(!this.y$c)return null;var c=a.id.toString();this.mwa.Gb(c)||this.mwa.$(c,new Yt.a);c=this.mwa.ga(c);var f=a.Op();f=this.$Be?f&&Hd.TableReader.ZOf(Object(sa.a)(ub.GraphIterator,this.Tb.Lc(a))):f;if(c.Gb(b))return b=c.ga(b),f||0!==b.R0c||(this.rqh(a),b=null),b;if(f)c.$(b,this.jsk.create(b,a.id));else return null;return c.ga(b)}GAb(a,b,c){a.Op()?this.ong(a.id.toString(),b,c):10===c&&this.ong(a.id.toString(),b,c)}ong(a,b,c){if(this.mwa.Gb(a))for(let f of this.mwa.ga(a).values)b?
f.TUj(b,c):f.Hac(c)}cne(a,b,c){a.isConnected&&(a=this.Tb.Lc(a),a.rc(14)&&this.GAb(a.jx(14),b,c))}LUj(a){a.isConnected&&(a=this.Tb.Lc(a),a.rc(14)&&this.GAb(a.jx(14),a.jx(16),2))}t$g(a,b){b.ns.Qc.yp&&this.GAb(b.ns.gb,null,9)}seh(a,b){this.GAb(b.node,null,8);a=Object(sa.a)(Qz.TableNode,b.node);a=!!a&&a.Op();ya.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}teh(a,b){this.rqh(b.node)}rqh(a){a=a.id.toString();if(this.mwa.Gb(a)){const b=this.mwa.ga(a);for(let c of b.values)c&&c.dispose();this.mwa.remove(a)}}ueh(a,
b){a=b.property;b.node.isConnected&&(a===Ya.a.gv||a===Ya.a.hha||a===Ya.a.yB||a===va.a.Nmb||a===va.a.cid||a===va.a.Mza||a===va.a.Nvc?this.GAb(b.node,null,7):a===va.a.complexTable&&this.GAb(b.node,null,10))}weh(a,b){a=b.property;b.node.isConnected&&a===va.a.Ku&&this.cne(b.node,null,4)}eld(a,b){a=b.property;!b.node.isConnected||a!==va.a.rowSpan&&a!==va.a.colSpan||this.cne(b.node,null,5)}reh(a,b){b.node.isConnected&&1===b.HW&&this.cne(b.node,b.node,3)}vch(a,b){a=Object(sa.a)(5,b.node);b=b.property;a&&
a.isConnected&&a.Ta(va.a.cellId)&&!a.Vpc&&(b===Ya.a.Oo||b===Ya.a.Vmb)&&this.LUj(a)}Pdh(){for(let a of this.mwa.keys)for(let b of this.mwa.ga(a).values)b.Hac(11)}dispose(){this.y$c&&(this.BZa.fXe(Object(H.a)(this,this.t$g,"onBeforeTableViewElementDisconnected")),this.BZa.Xoa(Object(H.a)(this,this.seh,"onTableNodeConnected")),this.BZa.Qm(Object(H.a)(this,this.ueh,"onTableNodePropertyChanged")),this.BZa.jLa(Object(H.a)(this,this.teh,"onTableNodeDisconnected")),this.k2g.Qm(Object(H.a)(this,this.weh,"onTableRowNodePropertyChanged")),
this.nhb.Qm(Object(H.a)(this,this.eld,"onTableCellNodePropertyChanged")),this.nhb.vP(Object(H.a)(this,this.reh,"onTableCellNodeChildTopoChanged")),this.ejc.Qm(Object(H.a)(this,this.vch,"onParagraphNodePropertyChanged")),this.Ys.Kcl(Object(H.a)(this,this.Pdh,"onSlideInvalidateRenderSize")))}}Object(m.a)(gM,"PPTTableLayoutServiceManager",null,[367,108]);class aE{constructor(a,b,c){this.Sq=b;this.Kna=c;this.oD=this.Sq.JSc(this.Kna,a.GE);this.d$=Array(this.oD.mP*(this.oD.WR+1));this.lM=this.oD.oe;this.Qgb=
this.oD.ve;this.aHb=this.oD.ve-1;this.Tq=0;this.yje(a)}yje(a){const b=a.GE;for(;a.moveNext();){const f=a.tA;for(let l=f.ve;l<f.eg;l++){var c=this.EEa(l,f.oe);this.d$[c]=0!==this.d$[c]?32:l<b.ve&&f.oe>b.oe?1:l>=b.eg&&f.oe>b.oe?4:16;c=this.EEa(l,f.Tf);this.d$[c]=0!==this.d$[c]?32:l<b.ve&&f.Tf<b.Tf?1:l>=b.eg&&f.Tf<b.Tf?4:64}}}EEa(a,b){return this.oD.mP*(b-this.oD.oe)+(a-this.oD.ve)}moveNext(){this.Qgb=this.aHb;do{this.Qgb++;this.Qgb>=this.oD.eg&&(this.lM++,this.Qgb=this.oD.ve);if(this.lM>this.oD.Tf)return!1;
this.Tq=this.d$[this.EEa(this.Qgb,this.lM)]}while(0===this.Tq);for(this.aHb=this.Qgb;this.aHb+1<this.oD.eg&&this.d$[this.EEa(this.aHb+1,this.lM)]===this.Tq;)this.aHb++;return!0}Htj(){return this.aHb+1}O$a(){return this.Tq}static hoe(a){return!!(a&117)}}Object(m.a)(aE,"VerticalTableBorderIterator",null,[538,539]);class Ml{constructor(a,b,c,f,l,y,G){this.il=a;this.Sq=b;this.Tb=c;this.MA=f;this.Wea=l;this.qmk=y;this.Owk=G}bSl(a,b,c){const f=b.getContainingTable();f&&(this.cOl(b,f,a,c.Tf,c.ve),this.bOl(b,
f,a,c.eg,c.oe))}i9d(a,b,c,f,l,y){if(c&&c!==b.mP)for(;f<l;f++)if(9===(b.Ds(c-1,f)&9)&&5===(b.Ds(c,f)&5)){var G=this.Sq.ZI(b,c-1,f),R=this.Sq.ZI(b,c,f);G=a.ff(G.ve,G.oe);R=a.ff(R.ve,R.oe);y?this.Fvb(R,G,7,0):this.Fvb(G,R,0,7)}}l0e(a,b,c,f,l){l=this.Wea.jEa(a,b,c,l);c=f.Bej();if(aE.hoe(c)){let y=this.Owk.RSi(l,b);for(;y.moveNext();)0!==(c&y.O$a())&&this.U1e(a,b,y.lM,y.Qgb,y.Htj(),f.jzb(y.O$a()),!0)}if(ZD.hoe(c))for(l=this.qmk.IOi(l,b);l.moveNext();)0!==(c&l.O$a())&&this.N0e(a,b,l.bP,l.deb,l.Yfj(),f.jzb(l.O$a()),
!0)}U1e(a,b,c,f,l,y,G=!1){let R=this.MA.pYc(a),ja=null;0<c&&(ja=a.ff(f,c-1));let za=null;for(c<b.WR&&(za=a.ff(f,c));f<l;){if(ja){if(6===(b.Ds(f,c-1)&6)){var Va=this.Sq.ZI(b,f,c-1),hb=a.ff(Va.ve,Va.oe);G&&R?R=this.UNb(R,hb,Va.ve,Va.oe,6,y):Ml.Ltc(6,hb,y)}f+1<l&&(ja=a.ff(f+1,c-1))}za&&(5===(b.Ds(f,c)&5)&&(Va=this.Sq.ZI(b,f,c),hb=a.ff(Va.ve,Va.oe),G&&R?R=this.UNb(R,hb,Va.ve,Va.oe,5,y):Ml.Ltc(5,hb,y)),f+1<l&&(za=a.ff(f+1,c)));f+=1}}k9d(a,b,c,f,l,y){if(c&&c!==b.WR)for(;f<l;f++)if(6===(b.Ds(f,c-1)&6)&&
5===(b.Ds(f,c)&5)){var G=this.Sq.ZI(b,f,c-1),R=this.Sq.ZI(b,f,c);G=a.ff(G.ve,G.oe);R=a.ff(R.ve,R.oe);y?this.Fvb(R,G,5,6):this.Fvb(G,R,6,5)}}N0e(a,b,c,f,l,y,G=!1){let R=this.MA.pYc(a),ja=null;0<c&&(ja=a.ff(c-1,f));let za=null;for(c<b.mP&&(za=a.ff(c,f));f<l;){if(ja){if(9===(b.Ds(c-1,f)&9)){var Va=this.Sq.ZI(b,c-1,f),hb=a.ff(Va.ve,Va.oe);G&&R?R=this.UNb(R,hb,Va.ve,Va.oe,0,y):Ml.Ltc(0,hb,y)}f+1<l&&(ja=a.ff(c-1,f))}za&&(5===(b.Ds(c,f)&5)&&(Va=this.Sq.ZI(b,c,f),hb=a.ff(Va.ve,Va.oe),G&&R?R=this.UNb(R,hb,
Va.ve,Va.oe,7,y):Ml.Ltc(7,hb,y)),f+1<l&&(za=a.ff(c,f)));f+=1}}ZMh(a,b,c,f){var l=null;if(!({ve:f}=Ml.lNh(b,c,f)).returnValue)return{returnValue:!1,ama:l};l=6;0<c&&Ml.iBb(b,f,c-1)?(b=this.Sq.ZI(b,f,c-1),a=this.Tb.Lc(a.ff(b.ve,b.oe))):(l=5,b=this.Sq.ZI(b,f,c),a=this.Tb.Lc(a.ff(b.ve,b.oe)));l=this.I$f(a,l);return{returnValue:!0,ama:l}}VMh(a,b,c,f){const l=Ml.eNh(b,c,f);if(!l.returnValue)return{returnValue:!1,ama:null};f=0;0<c&&Ml.edb(b,l.oe,c-1)?(b=this.Sq.ZI(b,c-1,l.oe),a=this.Tb.Lc(a.ff(b.ve,b.oe))):
(f=7,b=this.Sq.ZI(b,c,l.oe),a=this.Tb.Lc(a.ff(b.ve,b.oe)));return{returnValue:!0,ama:this.I$f(a,f)}}UNb(a,b,c,f,l,y){const G=b.rowSpan;b=b.colSpan;for(let R=c;R<c+G;R++)for(let ja=f;ja<f+b;ja++)a.UNb(R,ja,l,y);return a}I$f(a,b){a=a.Dq;if(!a||!a.cellShading)return null;let c=null;({ama:c}=this.il.A9e(b,a.cellShading));return c}Fvb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=Eg.a.VTa(b,va.a.cellShading));l&&({ama:b}=this.il.A9e(f,l),Ml.Ltc(c,a,b))}}cOl(a,b,c,f,l){let y;({ve:y}=
Ml.lNh(c,f,l)).returnValue&&(l=6,0<f&&Ml.iBb(c,y,f-1)?c=this.Sq.ZI(c,y,f-1):(l=5,c=this.Sq.ZI(c,y,f)),b=b.ff(c.ve,c.oe),this.Fvb(a,b,6,l))}bOl(a,b,c,f,l){let y;({oe:y}=Ml.eNh(c,f,l)).returnValue&&(l=0,0<f&&Ml.edb(c,y,f-1)?c=this.Sq.ZI(c,f-1,y):(l=7,c=this.Sq.ZI(c,f,y)),b=b.ff(c.ve,c.oe),this.Fvb(a,b,0,l))}static Ltc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static lNh(a,
b,c){let f,l;f=c;l=c+1;if(!Ml.edb(a,b,c))return{returnValue:!1,ve:f,eg:l};for(;0<f&&!(0<b&&Ml.iBb(a,f,b-1))&&!(b<a.WR&&Ml.iBb(a,f,b));f--);for(;l<a.mP&&!(0<b&&Ml.iBb(a,l,b-1))&&!(b<a.WR&&Ml.iBb(a,l,b));l++);return{returnValue:!0,ve:f,eg:l}}static eNh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&Ml.edb(a,f,b-1))&&!(b<a.mP&&Ml.edb(a,f,b));f--);for(;c<a.WR&&!(0<b&&Ml.edb(a,c,b-1))&&!(b<a.mP&&Ml.edb(a,c,b));c++);return{returnValue:!0,oe:f,Tf:c}}static edb(a,b,c){return 0<b&&!(a.Ds(c,b-1)&2)||b<a.WR&&!(a.Ds(c,
b)&1)?!1:!0}static iBb(a,b,c){return 0<b&&!(a.Ds(b-1,c)&8)||b<a.mP&&!(a.Ds(b,c)&4)?!1:!0}}Object(m.a)(Ml,"TableBorderEditor",null,[1184,1185]);class hM{constructor(a,b,c,f){this.Kve=!1;this.q1=a;this.jvk=b;this.GHb=c;this.pDe=f;this.vi=Array(this.q1.jV);for(a=0;a<this.q1.jV;a++)for(this.vi[a]=Array(this.q1.Dsa),b=0;b<this.q1.Dsa;b++)this.vi[a][b]=new Cq.a}Aej(a,b,c){this.Kve||(this.jvk.vgl(a,this.q1),this.Kve=!0);if(qd.a("BugFixCacheInvalidIndex")){if(this.vi&&0<=b&&b<this.vi.length&&this.vi[b]&&
0<=c&&c<this.vi[b].length)return this.vi[b][c];a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.vi,b,c);this.vi&&(a+=String.format(" m_cache.Length : {0} ",this.vi.length),a=this.vi[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.vi[b].length):a+" m_cache[ row ] is null ");ya.a.J(559724692,822,15,a);return null}return this.vi[b][c]}UNb(a,b,c,f){var l=this.GHb.euh(c,this.q1.Fd,f);a=this.vi[a][b];for(var y of l.pA())a.Ae(y,l.Sh(y));
this.pDe&&qd.a("TableBordersLocalRenderingFix")&&({pRa:l,b8a:c,$tb:y}=kq.sUa(c),f.wFieldSpecified&&(f.noFillField?a.Ae(l,0):a.Ae(l,Oe.a.n6d(f.wField))),f.solidFillField&&a.Ae(c,f.solidFillField),f.prstDashField&&a.Ae(y,f.prstDashField))}dispose(){this.vi=null;this.Kve=!1}}Object(m.a)(hM,"TableBorderStyleCache",null,[1183,108]);class bE{constructor(a){this.sFe=a?1:0}PSd(a){const b=a.tA;a=a.GE;return b.oe%2===this.sFe&&a.gxb(b)}}Object(m.a)(bE,"BandedColumnFilter",null,[1206]);class cE{constructor(a){this.sFe=
a?1:0}PSd(a){const b=a.tA;a=a.GE;return b.ve%2===this.sFe&&a.gxb(b)}}Object(m.a)(cE,"BandedRowFilter",null,[1206]);class iM{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}Bej(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}jzb(a){switch(a){case 1:return this.top;case 2:return this.insideHor;
case 4:return this.bottom;case 8:return this.diagTL2BR;case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(m.a)(iM,"TableBorderSet",null,[]);class jM{constructor(a,b){this.X5=a;this.pvk=b}vgl(a,b){const c=b.jV,f=b.Dsa;var l=b.tableLook;b=b.tableStyle;const y=this.pvk.create(a),G=!!(l&32)&&!!b.firstRowField,R=!!(l&64)&&!!b.lastRowField,ja=!!(l&128)&&!!b.firstColField,za=!!(l&256)&&!!b.lastColField,Va=G&&ja&&!!b.nwCellField,
hb=G&&za&&!!b.neCellField,Cb=R&&ja&&!!b.swCellField,lc=R&&za&&!!b.seCellField;var ic=!(l&512)&&!!b.band1HField,yc=!(l&512)&&!!b.band2HField,ec=!(l&1024)&&!!b.band1VField;const jc=!(l&1024)&&!!b.band2VField;l=new vr.a;b.wholeTblField&&(l.ve=0,l.eg=c,l.oe=0,l.Tf=f,this.apply(a,y,b.wholeTblField,l));l.ve=G?1:0;l.eg=c-(R?1:0);l.oe=0;l.Tf=f;ic&&(ic=new cE(G),this.apply(a,y,b.band1HField,l,ic));yc&&(yc=new cE(!G),this.apply(a,y,b.band2HField,l,yc));l.ve=0;l.eg=c;l.oe=ja?1:0;l.Tf=f-(za?1:0);ec&&(ec=new bE(ja),
this.apply(a,y,b.band1VField,l,ec));jc&&(ec=new bE(!jc),this.apply(a,y,b.band2VField,l,ec));za&&(l.ve=0,l.eg=c,l.oe=f-1,l.Tf=f,this.apply(a,y,b.lastColField,l));ja&&(l.ve=0,l.eg=c,l.oe=0,l.Tf=1,this.apply(a,y,b.firstColField,l));R&&(l.ve=c-1,l.eg=c,l.oe=0,l.Tf=f,this.apply(a,y,b.lastRowField,l),lc&&(l.oe=f-1,l.Tf=f,this.apply(a,y,b.seCellField,l)),Cb&&(l.oe=0,l.Tf=1,this.apply(a,y,b.swCellField,l)));G&&(l.ve=0,l.eg=1,l.oe=0,l.Tf=f,this.apply(a,y,b.firstRowField,l),hb&&(l.oe=f-1,l.Tf=f,this.apply(a,
y,b.neCellField,l)),Va&&(l.oe=0,l.Tf=1,this.apply(a,y,b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.mTa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const y=new iM;c.topField&&c.topField.itemField&&(y.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(y.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(y.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(y.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(y.right=
c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&(y.insideVer=c.insideVField.itemField);this.X5.l0e(a,b,f,y,l)}}}Object(m.a)(jM,"TableBorderStyleResolver",null,[362]);class Wv{constructor(){}wAi(a,b){const c=new vr.a;if(a.mTa())return c;const f=Wv.q2f(b,a,a.ve,!0),l=Wv.q2f(b,a,a.eg-1,!1),y=Wv.S1f(b,a,a.oe,!0);a=Wv.S1f(b,a,a.Tf-1,!1);c.ve=f;c.eg=l+1;c.oe=y;c.Tf=a+1;return c}IXj(a,b){for(var c=a.ve;c<a.eg;++c)if(!(b.Ds(c,a.oe)&1&&b.Ds(c,a.Tf-1)&2))return!1;for(c=a.oe;c<a.Tf;++c)if(!(b.Ds(a.ve,
c)&4&&b.Ds(a.eg-1,c)&8))return!1;return!0}N6f(a){let b;b=null;const c=new vr.a;if(!(a&&a.Sl&&a.nb&&a.Y6))return{returnValue:c,tableNode:b};var f=a.ga(0).og.Ua,l=Object(sa.a)(im.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.Ai;var y=Object(sa.a)(im.TableCellNode,a.ga(0).og.jf.node);var G=0;y&&(G=y.Ai+1);if(b.Op()&&1!==a.length){G=Object(sa.a)(im.TableCellNode,a.h2a.currentNode);f=Object(sa.a)(im.TableCellNode,a.qka.currentNode);if(!G||
!f)return{returnValue:c,tableNode:b};l=G.rowIndex;a=G.Ai;y=f.rowIndex;G=f.Ai;f=Math.min(l,y);y=Math.max(l,y)+1;l=Math.min(a,G);G=Math.max(G,a)+1}else y=f+a.length;c.ve=f;c.eg=y;c.oe=l;c.Tf=G;return{returnValue:c,tableNode:b}}ZI(a,b,c){b=Object.assign(new vr.a,{ve:b,eg:b+1,oe:c,Tf:c+1});return this.JSc(a,b)}JSc(a,b){const c=new vr.a;let f=b.ve,l=b.eg-1;for(var y=b.oe;y<b.Tf;y++){for(var G=b.ve;0<G&&!(a.Ds(G,y)&4);G--);G<f&&(f=G);G=b.eg-1;for(var R=a.mP-1;G<R&&!(a.Ds(G,y)&8);G++);G>l&&(l=G)}y=b.oe;
G=b.Tf-1;for(R=b.ve;R<b.eg;R++){let ja=b.oe;for(;0<ja&&!(a.Ds(R,ja)&1);ja--);ja<y&&(y=ja);ja=b.Tf-1;for(const za=a.WR-1;ja<za&&!(a.Ds(R,ja)&2);ja++);ja>G&&(G=ja)}c.ve=f;c.oe=y;c.Tf=G+1;c.eg=l+1;return c}static q2f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.oe;f<b.Tf;++f){if(a.Ds(c,f)&4)return c}else for(f=a.mP-1;c<f;c++)for(let l=b.oe;l<b.Tf;++l)if(a.Ds(c,l)&8)return c;return c}static S1f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.ve;f<b.eg;++f){if(a.Ds(f,c)&1)return c}else for(f=a.WR-1;c<f;++c)for(let l=b.ve;l<
b.eg;++l)if(a.Ds(l,c)&2)return c;return c}}Object(m.a)(Wv,"TableCellSelectionHelper",null,[357]);class kM{constructor(a,b,c){this.kR=null;this.c5=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.he=a;this.zc=b;this.tY=c;this.bY=3}gbf(){try{var a=ub.GraphIterator.pb(this.he);ae.forEachCellInTable(a,(b,c,f)=>{var l=Object(sa.a)(130,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let y=c;y<b;++y)for(let G=f;G<l;++G)y===c&&(this.kR[y][G]|=4),y===b-1&&(this.kR[y][G]|=
8),G===f&&(this.kR[y][G]|=1),G===l-1&&(this.kR[y][G]|=2)}return!0})}catch(b){a=this.tY.Q5d(this.he),ya.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.c5)throw Error.invalidOperation("cache disposed");if(0!==this.bY){if(3===(this.bY&3)){const a=this.zc.Ek(this.he),b=this.zc.Gi(this.he);this.kR=Array(a);for(let c=0;c<a;++c){this.kR[c]=Array(b);for(let f=0;f<b;++f)this.kR[c][f]=0}}1===(this.bY&1)&&this.gbf();this.bY=0}}Ds(a,b){try{this.validate();var c=this.kR[a][b]}catch(f){c=
this.tY.Q5d(this.he),ya.a.J(38043911,822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.mP,this.WR,a,b,c,f.message),c=0}return c}CVa(a){this.bY|=a}dispose(){this.c5=!0;this.kR=null}get mP(){this.validate();return this.kR?this.kR.length:0}get WR(){this.validate();return this.kR&&this.kR.length?this.kR[0].length:0}}Object(m.a)(kM,"TableInfoCache",null,[1204,108]);class lM{constructor(a,b){this.zc=a;this.tY=b}create(a){return new kM(a,this.zc,this.tY)}}Object(m.a)(lM,
"TableInfoCacheFactory",null,[368]);class Tz{constructor(a,b,c,f,l,y){this.Ftk=a;this.tjk=b;this.svk=c;this.$ok=f;this.Rvk=l;this.xvk=y}get jV(){return this.Ftk()}get Dsa(){return this.tjk()}get tableLook(){return this.svk()}get ock(){return this.$ok()}get Fd(){return this.Rvk()}get tableStyle(){return this.xvk()}static oSf(a,b,c,f,l,y){return new Tz(a,b,c,f,l,y)}}Object(m.a)(Tz,"TableListStyleParams",null,[547]);class mM{constructor(a){this.Sna=null;this.X$c=!1;this.lIe=this.FDb=null;this.Tb=a}get gZj(){return!!this.FDb}Ujh(a,
b){this.lIe=a.id.toString();this.X$c=!this.Tb.nlj(a).currentNode.qc(b).e3c();this.FDb=null;this.X$c&&(a=a.qc(b),this.v2i(),Ga.a.m3b(a.htmlElement,this.Sna),this.FDb=this.E8i(this.Sna))}I7b(a,b,c,f){if(a.id.toString()!==this.lIe)throw Error.argument("table","Wrong table metrics");if(this.X$c){if(!this.FDb)throw Error.invalidOperation("m_clonedTableNode is null");a=this.FDb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(ha.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",
c.className),c=Ga.a.Rda(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){Ga.a.TVa(this.Sna)&&this.Sna.parentNode.removeChild(this.Sna);this.FDb=this.Sna=null;this.X$c=!1;this.lIe=null}Q5d(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa(Ya.a.Lza,0),a.properties.sa(Ya.a.hha,0)));const c=this.Tb.Lc(a);ae.forEachCellInTable(c,(f,l,y)=>{var G=f.currentNode;f=G.rowSpan;G=G.colSpan;(1<f||1<G)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",
l,y,f,G));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}v2i(){this.Sna||(this.Sna=document.createElement("div"),this.Sna.className="TableMetricsWorkingDiv",document.body.appendChild(this.Sna));Ga.a.bDa(this.Sna)}E8i(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;a=a.nextSibling}return null}}Object(m.a)(mM,"TableMetrics",null,[365]);class nM{constructor(a){this.MA=a}wgl(a,b,c){return b&&a&&c&&(a=this.MA.rYc(a).d8f(c,b.rowIndex,b.Ai,b.rowSpan,
b.colSpan))&&a!==oc.a.auto?a.ND:-1}}Object(m.a)(nM,"TableThemeColorHelper",null,[369]);class oM{constructor(a){this.Sq=a}RSi(a,b){return new aE(a,this.Sq,b)}}Object(m.a)(oM,"VerticalTableBorderIteratorFactory",null,[361]);class dE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Xb(a){this.K=a;this.K.register(357,"PowerPointWebEditor.ITableCellSelectionHelper").na().oa(()=>new Wv);a.register(358,"Box4.ITableDragSelectionCellExtendStrategy").na().oa(()=>new KL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(Ml,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").na().oa(()=>new Ml(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(359,"PowerPointWebEditor.ICellIteratorFactory").na().oa(()=>new bM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(360,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").na().oa(()=>new cM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(361,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").na().oa(()=>new oM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(362,"PowerPointWebEditor.ITableBorderStyleResolver").na().oa(()=>new jM(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(ym,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").na().oa(()=>
new ym(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Na));this.K.register(WD,"PowerPointWebEditor.TableNodeBehavior").na().oa(()=>new WD(this.K.resolve("Box4.Graph.IGraphInstance").zd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Na,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ige));this.K.register(297,"PowerPointWebEditor.ITableStyleReaderHelper").na().oa(()=>new kq(this.K.resolve("Box4.IPageView").Nd,
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").j4c));this.K.register(Pz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").na().oa(()=>new Pz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Nd,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").zd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Tz.oSf,b=>new YD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new VD(b),b=>new hM(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),
a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").Jaa),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Bog,this.K.resolve("PowerPointWebEditor.IApplicationSettings").g8j,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jaa));this.K.register(363,"PowerPointWebEditor.ITableStyleResolver").na().oa(()=>new XL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jaa));this.K.register(364,"PowerPointWebEditor.ITableStyleGalleryManager").na().oa(()=>new $L(this.K.Ia("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(365,"PowerPointWebEditor.ITableMetrics").na().oa(()=>
new mM(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(366,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").na().oa(()=>new fM(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(367,"PowerPointWebEditor.IPPTTableLayoutServiceManager").na().oa(()=>new gM(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").zd(14),this.K.resolve("Box4.Graph.IGraphInstance").zd(15),this.K.resolve("Box4.Graph.IGraphInstance").zd(16),this.K.resolve("Box4.Graph.IGraphInstance").zd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(TD,"PowerPointWebEditor.TableCellNodeBehavior").na().oa(()=>
new TD(this.K.resolve("Box4.Graph.IGraphInstance").zd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(GL,"Box4.TableReaderProxy").as("Box4.ITableReader").na();this.K.register(HL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").na();this.K.register(IR.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").na();this.K.register(368,"PowerPointWebEditor.ITableInfoCacheFactory").na().oa(()=>
new lM(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(369,"PowerPointWebEditor.ITableThemeColorHelper").na().oa(()=>new nM(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").fMb(1,
new Vv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a),new SL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new RL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new km.a((c,f)=>new Wl(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>by.A3b(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new km.a((c,f)=>new Uv(c,f,new Tb.a(c,f,Tb.a.RIl))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new JL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),
new km.a((c,f)=>new rt(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").gla,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Jaa,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));Ka.StyleReader.yr=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){n.a.instance.Ac(new dE)}}
Object(m.a)(dE,"PPTWebEditorTablePackage",null,[2,3]);var LR=d(1285),gi=d(112);class pM{constructor(){this.podsUrl=this.fileUrl=null}}Object(m.a)(pM,"IFileInfo",null,[]);class qM extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(m.a)(qM,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class rM{constructor(){this.messageType=0;this.data=this.sender=null}}Object(m.a)(rM,"IPresentationMessage",null,[]);class sM{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=
!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(m.a)(sM,"IPresenterViewSettings",null,[]);class tM{constructor(){this.uiHost=this.userSessionId=null}}Object(m.a)(tM,"ISessionInfo",null,[]);var MR=d(545);class uM{constructor(a,b,c){this.IO="";this.O0=null;this.Afb=!1;this.BGb=null;this.va=new Wc.a;this.ia=a;this.la=b;this.Fc=c;this.ZWk()}vb(){this.ia.ra(ea.a.RLb,qc.a.application,Object(H.a)(this,this.RLb,"queryUsePresenterView"),96);this.ia.ya(ea.a.Saf,qc.a.application,Object(H.a)(this,
this.DLl,"toggleUsePresenterView"));this.ia.ya(ea.a.Bvd,rb.a.application,Object(H.a)(this,this.Bvd,"showPresenterView"));this.ia.ya(ea.a.BNc,qc.a.application,Object(H.a)(this,this.BNc,"closePresenterView"));this.Afb=w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}RLb(a,b,c,f,l){(a=Object(sa.a)(gi.a,l))&&a.If(this.Afb);return 32}DLl(a,b,c){if(1===c&&!w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return ya.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),
8;2===c&&(this.Afb=!this.Afb,this.Fc.Uy(new lq.a(1)));return 32}Bvd(a,b,c){try{if(!w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return ya.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.IO.length){if(!this.BGb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),y=new pM;y.fileUrl=this.IO;y.podsUrl=f;const G=new tM;G.userSessionId=w.AFrameworkApplication.userSessionId;G.uiHost="UnifiedApp";
const R=new sM;R.presenterWindowWidth=1024;R.presenterWindowHeight=576;this.BGb=new PresenterView.PresentationProxy(2,l,y,G,R)}this.BGb.startPresentation();this.BGb.subscribe(Object(H.a)(this,this.xKk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return ya.a.J(512496090,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}BNc(a,b,c){2===c&&(ya.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.BGb.terminatePresentation());return 32}Pji(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",
a)}Eml(a){a=this.Aqi(a);this.BGb.sendMessage(a)}Aqi(a){const b=new rM;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.Dwc});return b}xKk(a){try{if(!a||0>=a.length)ya.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||ya.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=
JSON.parse(l).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new qM({["SlideIndex"]:f}))}}}}catch(l){ya.a.J(512496086,830,10,"Exception: {0}",l)}}ZWk(){var a=Fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new LR.a(w.AFrameworkApplication.Je);this.O0=MR.b(b.S_e(a));this.O0.then(c=>
{try{const f=JSON.parse(c),l=f.downloadUrl;na.a.Xa(l)?ya.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.IO=l}catch(f){ya.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(m.a)(uM,"PresenterViewManager",null,[356]);class eE{constructor(){this.ob=this.la=this.K=null;this.TLg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Xb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.ob=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").UF()}init(){w.AFrameworkApplication.fa.$e(Object(H.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){try{(this.TLg=w.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").xI.loadScript("presenterView").catch(a=>ya.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.zKk()).catch(a=>ya.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){ha.ULS.sendTraceTag(594031830,
811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}zKk(){this.B3b();return null}B3b(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",w.AFrameworkApplication.fa.Ha("PPTPresenterViewCssUrl"));this.ob.appendChild(a);this.K.register(356,"PowerPointWebEditor.PresenterView.IPresenterViewManager").oa(()=>new uM(w.AFrameworkApplication.Qa,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).na();
this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").vb()}dispose(){}static main(){n.a.instance.Ac(new eE)}}Object(m.a)(eE,"PPTWebEditorPresenterViewPackage",null,[2,3]);class vM{constructor(a){this.Wea=a}sSi(a,b,c){if(c.mTa())return null;a=this.Wea.jEa(a,b,c);for(b=Array(b.mP);a.moveNext();){c=a.H7b();var f=a.tA;b[f.ve]||(b[f.ve]=[]);f=b[f.ve];f[f.length]=mr.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new Wb.Selection(b[c],!0));return new oa.SelectionCollection(a,
a.length-1,0)}}Object(m.a)(vM,"PPTSelectionFactory",null,[227]);class wM{constructor(a,b,c,f){this.WCe=this.Kna=this.Pve=null;this.vai=a;this.cYh=b;this.Sq=c;this.zZa=f}get XAi(){return this.cYh}get Mub(){this.Pve||(this.Pve=this.Sq.wAi(this.XAi,this.tZ));return this.Pve}get tableNode(){return this.vai}get tZ(){this.Kna||(this.Kna=this.zZa.create(this.tableNode));return this.Kna}get F5j(){this.WCe||(this.WCe=this.Sq.IXj(this.Mub,this.tZ));return this.WCe}}Object(m.a)(wM,"TableCellSelectionInfo",null,
[]);class xM{constructor(a,b){this.zZa=a;this.Sq=b}create(a,b){return new wM(b,a,this.Sq,this.zZa)}}Object(m.a)(xM,"TableCellSelectionInfoFactory",null,[225]);var NR=d(1042);class yM{constructor(a,b,c){this.a2g=a;this.Sq=b;this.gHa=c}g9b(a){let b=null;const c=new Date,f=({tableNode:a}=this.Sq.N6f(a)).returnValue,l=!f.mTa();l&&(b=this.a2g.create(f,a),Kc.a.Kb&&Kc.a.Kb.Wa("CellRange",f.toString()));ya.a.J(512495623,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}Qvj(a){if(!a)return null;
var b=this.gHa.sB(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].Rk){var f=Object(sa.a)(5,b[l].node);if(f){f=f.GL();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new vr.a,{ve:a.rowIndex,oe:a.Ai});b.eg=b.ve+1;b.Tf=b.oe+1;return this.a2g.create(b,a.getContainingTable())}}Object(m.a)(yM,"TableSelectionAdapter",null,[226]);class fE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Xb(a){this.K=
a;this.K.register(225,"PowerPointWebEditor.ITableCellSelectionInfoFactory").na().oa(()=>new xM(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(226,"PowerPointWebEditor.ITableSelectionAdapter").na().oa(()=>new yM(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(227,"PowerPointWebEditor.ISelectionFactory").na().oa(()=>new vM(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(228,"PowerPointWebEditor.ITableMergeSplitEditor").na().oa(()=>new NR.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){n.a.instance.Ac(new fE)}}Object(m.a)(fE,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class zl{constructor(a,b,c,f,l,y,G,R){this.isb=a;this.VQd=b;this.Ca=c;this.TQd=f;this.Mk=l;this.Ut=y;this.hd=G;this.I3h=R}vb(){this.Fpd(Sc.App.NMa.LQf())}Fpd(a){this.Ca.ya(C.a.LLb,rb.a.view,a);this.Ca.ya(C.a.LLb,rb.a.table,Object(H.a)(this,this.LLb,"queryTableStyle"));this.Ca.ie(C.a.LLb,
103);this.Ca.ya(C.a.s_,rb.a.view,Object(H.a)(this,this.$6e,"tableStyleGenericViewActionHandler"));this.Ca.ya(C.a.s_,rb.a.table,Object(H.a)(this,this.s_,"applyTableStyle"));this.Ca.ie(C.a.s_,6);this.Ca.ya(C.a.M7a,rb.a.table,Object(H.a)(this,this.s_,"applyTableStyle"));this.Ca.ya(C.a.iT,rb.a.view,Object(H.a)(this,this.$6e,"tableStyleGenericViewActionHandler"));this.Ca.ya(C.a.iT,rb.a.table,Object(H.a)(this,this.iT,"applyTableStyleOption"));this.Ca.ie(C.a.iT,14);this.Ca.ya(C.a.Laa,rb.a.view,a);this.Ca.ya(C.a.Laa,
rb.a.table,Object(H.a)(this,this.Laa,"queryTableStyleOption"));this.Ca.ie(C.a.Laa,103);this.Ca.ya(C.a.lKb,rb.a.view,a);this.Ca.ya(C.a.lKb,rb.a.table,Object(H.a)(this,this.lKb,"populateMenuMoreTableStyles"));this.Ca.ie(C.a.lKb,102);this.Ca.ya(C.a.D8a,rb.a.view,Object(H.a)(this,this.$6e,"tableStyleGenericViewActionHandler"));this.Ca.ya(C.a.D8a,rb.a.table,Object(H.a)(this,this.D8a,"clearTableFormatting"));this.Ca.ie(C.a.D8a,4)}LLb(a,b,c,f,l){if(!({IF:a}=this.kuc(b,c,l,!0,!0)).returnValue)return a;this.VQd.uOi(l,
b.node);return 32}Laa(a,b,c,f,l){return this.iig(b,c,f,l,!0)}lKb(a,b,c,f,l){if(!({IF:a}=this.kuc(b,c,l,!1,!0)).returnValue)return a;this.VQd.zPi(l,b.node);ha.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}s_(a,b,c,f,l){if(!({IF:c}=this.kuc(b,c,l,!1,!0)).returnValue)return c;const y=b.node;let G=null;(G=a===C.a.s_?this.VQd.$wd(l[Ih.a.SourceControlId],y):null)?(this.rQe(y,()=>{this.TQd.ptl(G,y)}),c=32):c=8;a===C.a.s_&&32===c&&ha.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");
ha.ULS.shipAssertTag(541172699,324,32===c);return c}iT(a,b,c,f,l){return this.iig(b,c,f,l,!1)}iig(a,b,c,f,l){if(!({IF:b}=this.kuc(a,b,f,l,!0)).returnValue)return b;a=a.node;b=this.isb.zce(a);const y=f[Ih.a.On],G=zl.Wxj(w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp?f.MenuItemId:f[Ih.a.SourceControlId]);l?f[Ih.a.On]=zl.oyl(b,G):(this.vpi(b,G,y,a),c.PC=G,c.XN=y?0:1,ha.ULS.shipAssertTag(541172700,324,0!==G));return 32}$6e(a,b,c,f,l){return qi.v6(a,b,c,f,l,{},14)}rQe(a,b){const c=this.Mk.ke(15);
try{c.ld(a),this.Ut.R0a(),b()}finally{c&&c.dispose()}}kuc(a,b,c,f,l){return this.t8j(a,b,c,f,l)?{returnValue:f||2===b,IF:32}:{returnValue:!1,IF:8}}t8j(a,b,c,f,l){if(a.contextId!==rb.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Sa.a)(Ey.a,a.node)||this.I3h(a.node))return!1;return!0}vpi(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.rQe(f,()=>{this.TQd.Qql(l,f)})}D8a(a,b,c,f,l){if(!({IF:a}=this.kuc(b,c,l,!1,!1)).returnValue)return a;const y=b.node;this.rQe(y,()=>{this.TQd.vEi(y)});
return 32}static Ar(){zl.mQa[zl.e9i]=32;zl.mQa[zl.$8i]=128;zl.mQa[zl.Cak]=64;zl.mQa[zl.uak]=256;zl.mQa[zl.Wri]=512;zl.mQa[zl.Vri]=1024}static oyl(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static Wxj(a){let b=0;a in zl.mQa&&(b=zl.mQa[a]);return b}}zl.e9i="buttonFirstRow";zl.$8i="buttonFirstColumn";zl.Cak="buttonLastRow";zl.uak="buttonLastColumn";zl.Wri="buttonBandedRow";zl.Vri="buttonBandedColumn";zl.mQa={};Object(m.a)(zl,"TableStyleActor",null,[]);zl.Ar();class Qp{constructor(a){this.r1=a}ptl(a,
b){a=this.r1.b9b(a);Qp.lMf(b);b.setValue(va.a.Mza,oh.a.Kf(a.vY.styleIdField))}Qql(a,b){b.setValue(va.a.Nvc,a)}vEi(a){Qp.lMf(a);a.removeProperty(va.a.Mza)}static lMf(a){if(a=Object(sa.a)(Qz.TableNode,a)){a=a.Kab();for(const b of a){b.cellShading&&((a=up.d(b.cellShading))?(up.c(a),b.cellShading=a):ya.a.J(22078240,822,15,"Encountered null cell shading."));for(const c of Qp.nti){let f,l;({pRa:f,b8a:a,$tb:l}=kq.sUa(c));b.removeProperty(a);b.removeProperty(f);b.removeProperty(l)}Qp.WDi(Object(sa.a)(Ig.a,
b))}}else ya.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static WDi(a){const b=new VF.a;b.set(a);for(a=b.Db(1);a;){for(a=b.Db(2);a;)12===a.type&&Qp.XDi(a),a=b.Pj(2);a=b.Pj(1)}}static XDi(a){if(a.Sa&&0<a.Sa.length)for(let b=0;b<a.Sa.length;b++)a.Sa.ga(b)&&Qp.YDi(a.Sa.ga(b))}static YDi(a){if(a=a.formatting){const f=a.paragraph.Nh;if(f){var b=a.iA,c=!1;if(b){for(let l=0;l<Qp.NZe.length;l++)b.Ta(Qp.NZe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(Qp.NZe[l]));c&&(b=f.dLa(b),a.Fm=
b.id)}}}}}Qp.NZe=[Ya.a.font,va.a.latinFont,va.a.eastAsianFont,va.a.complexScriptFont,va.a.bQb,Ya.a.fontColor,Ya.a.bold,Ya.a.italic,va.a.schemeColor];Qp.nti=[5,6,7,0];Object(m.a)(Qp,"PPTTableStyleEditor",null,[269]);class gE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Xb(a){this.K=a}init(){(new zl(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),this.K.resolve("Common.IActionManagerExtended"),new Qp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).vb()}dispose(){}static main(){n.a.instance.Ac(new gE)}}Object(m.a)(gE,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class hE{constructor(a,b,c){this.PIe=0;this.bBe=!1;this.Kk=a;this.Ur=b;this.pa=c;this.Kk.IAf(Object(H.a)(this,this.gGf,"beforeForceOutboundGraphTransactionInitialize"));this.Kk.zCa(Object(H.a)(this,
this.ngg,"graphTransactionDisposed"));this.Ur.hja(Object(H.a)(this,this.p_a,"onBeforeValidatePersistence"))}dispose(){this.Kk.Xqh(Object(H.a)(this,this.gGf,"beforeForceOutboundGraphTransactionInitialize"));this.Kk.G0a(Object(H.a)(this,this.ngg,"graphTransactionDisposed"));this.Ur.wMb(Object(H.a)(this,this.p_a,"onBeforeValidatePersistence"))}gGf(){this.PIe++}p_a(){0<this.PIe&&(this.bBe=!0)}ngg(){if(!(0<--this.PIe)&&this.bBe){this.bBe=!1;var a=Kc.a.Kb;if(a){const b=this.pa.Ud();let c=0;for(const f of b)f.cM&&
c++;a.Wa("ShapeCount",b.length.toString());a.Wa("SupportSVGCount",c.toString())}}}}Object(m.a)(hE,"SVGShapeTelemetry",null,[108]);class iE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Xb(a){this.K=a;this.K.register(hE,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").na().oa(()=>new hE(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").zd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){n.a.instance.Ac(new iE)}}
Object(m.a)(iE,"PPTWebEditorTelemetryPackage",null,[2,3]);class Uz{}Uz.slh="faProofing";Object(m.a)(Uz,"ContextMenuControlId",null,[]);class jE{constructor(a,b,c,f,l,y,G){this.BN=b;this.sYb=a;this.PCc=b.tZj;this.kDc=b.Fqe;this.U2h=y;this.zCc=f;this.ACc=l;this.ROa=c;this.VP=G;this.NOa=new Pb.a;this.NOa.$(1,"SpellingIssue_16x16x32");this.NOa.$(2,"GrammarIssue_16x16x32");this.NOa.$(3,"WritingIssue_16x16x32");this.NOa.$(4,null);this.NOa.$(0,null)}create(a,b,c){b=Object(sa.a)(dl.a,b);if(!b)return ha.ULS.sendTraceTag(25007833,
375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.w$f(a);this.R3b(f,b,c,a);this.d2d(f,b);this.JQi(f,b,a);return f.toString()}hu(a,b,c){b=Object(sa.a)(dl.a,b);if(!b)return ha.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.w$f(a);this.K2d(f,b,c,a);this.e2d(f,b);this.KQi(f,b,a);return f}R3b(a,b,c,f=null){0===b.errorType?a.append(this.sYb.build()):1===b.errorType&&(this.eTa(b)||a.append(this.XXd(b,c,f)))}K2d(a,b,c,f=null){0===
b.errorType?a.push(this.sYb.AHf()):1===b.errorType&&(this.eTa(b)||a.push(this.yui(b,c,f)))}d2d(a,b){if(!M.a.instance.ga(92)){const c=new Sys.StringBuilder;this.lFh(b)?c.append(Bj.a("btnIgnoreAllSpellingError",(2===b.errorType?C.a.gzd:C.a.xie).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.eTa(b)||c.append(Bj.a("btnIgrnoreSpellingError",this.U9f(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.pFh(b)&&(this.BN.Doe&&c.append(Bj.a("btnDoNotCheckForThisIssue",
"2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(Bj.a("btnGrammarOptions","3380187414",na.a.ze(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(c.toString()),a.append("</Controls></MenuSection>"))}}e2d(a,b){if(!M.a.instance.ga(92)){const f=Object.assign(new el.a,{ControlList:[]});if(this.lFh(b)){var c=Object.assign(new tg.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":
"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.eTa(b)||(c=Object.assign(new tg.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.U9f(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,c));this.pFh(b)&&(this.BN.Doe&&(b=Object.assign(new tg.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new tg.a,{ExternalId:"GrammerSettingsContext",
Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}w$f(a){if(!this.VP)return null;a=this.VP.language(this.VP.Es(a.Ua));return ab.a.He(a).name}U9f(a){return 2===a?C.a.gzd:this.BN.Vqg?C.a.x_c:C.a.ola}JQi(a,b,c=null){if(this.N2e(b)){var f=na.a.ze(b.UN.CategoryTitle);f=Bj.j(Uz.slh,F.a.s8,this.NOa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.zCc,this.ACc);f=Bj.c("cgProofingOuter",[f]);
a.clear();a.append(Bj.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));ha.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}KQi(a,b,c=null){if(this.N2e(b)){var f=na.a.ze(b.UN.CategoryTitle);c=Object.assign(new AA.a,{ExternalId:String.format("{0}_{1}",Uz.slh,b.proofingType),Command:"798637440",Image16by16Class:this.NOa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,
Menu:Object.assign(new bo.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Xdj(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,a);Array.clear(a);f=Object.assign(new el.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);ha.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}XXd(a,b,c=null){const f=this.Tjj(a);
var l=[];let y=!1;var G=a.UN.Suggestions;if(G)if(G=G.slice(0,Math.min(3,G.length)),this.PCc&&(y=!Ub.a.any(G,R=>!R||!R.Description)),1===G.length&&0===G[0].Action)b=na.a.ze(G[0].Text),l.push(Bj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let R=0,ja=null;y&&(ja="font-weight: bold;");for(const za of G){if(!za)continue;G=null;let Va="",hb=na.a.ze(za.Text);y&&(G=this.u6f(za.Description),
Va=this.t6f(za.Description));l.push(Bj.a("btnCorrectWord"+R,b[R].toString(),hb,null,null,null,null,null,ja,null,G,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,hb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.FPf(a.token)),"ariaDescribedById",Va));R++}}b="Menu16";0<l.length?y&&(b="Menu16DescriptionEnabled"):l=[Bj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,
null)];return Bj.e("msUnknownWord",Bj.c(null,l),b,f,this.uoj(a),c,"ariaLabelledById")}yui(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.UN.ExplanationTitle:"";f=Object.assign(new el.a,{Title:f,Lang:c,ControlList:[]});let l=!1;var y=a.UN.Suggestions;if(y)if(y=y.slice(0,Math.min(3,y.length)),this.PCc&&(l=!Ub.a.any(y,G=>!G||!G.Description)),1===y.length&&0===y[0].Action)a=y[0],a=Object.assign(new tg.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,
a);else{let G=0;for(const R of y){if(!R)continue;y=null;let ja="";l&&(y=this.u6f(R.Description),ja=this.t6f(R.Description));if(G>=b.length)break;y?(y=Object.assign(new vB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",G,a.proofingType),Command:b[G].toString(),LabelText:R.Text,Description:y,Lang:c,AriaDescription:ja}),Array.add(f.ControlList,y)):(y=Object.assign(new tg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",G,a.proofingType),Command:b[G].toString(),
LabelText:R.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,y));G++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new tg.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return f}Tjj(a){return na.a.ze(1!==a.proofingType&&0!==a.proofingType?a.UN.ExplanationTitle:"")}uoj(a){return this.N2e(a)?null:this.NOa.ga(a.proofingType)}N2e(a){return this.kDc&&2!==a.errorType&&(1!==a.errorType||!this.eTa(a))}lFh(a){return this.U2h&&
0!==a.errorType&&1===a.proofingType&&!this.eTa(a)}Xdj(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.FPf(a.token)):""}pFh(a){return this.BN.hWa&&this.kDc&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}eTa(a){return 0!==a.errorType&&!!this.ROa&&this.ROa.contains(a.token,a.lcid)}u6f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}t6f(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,
a):""}FPf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(m.a)(jE,"EditorServiceProofingContextMenuCreator",null,[]);class mq{lba(a,b){this.fAi&&this.$zl(a,b,mq.gKe,mq.nb)}$zl(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:mq.M_i.show(f,a,b)}}Z5g(){switch(mq.gKe){case 5:case 1:return!0;default:return!1}}qSa(){return mq.gKe}get fAi(){return 1!==Sc.App.Mb.state}static get M_i(){return mq.fhf||(mq.fhf=Fb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static voj(a){if(!a)return 0;
if(2===Sc.App.Mb.mode)if(M.a.instance.ga(17)&&1===a.length&&uj.OutlineReader.ccc(a.Ua)&&Sc.App.Mb.Ld.Rn&&Sc.App.Mb.Ld.Rn.yp){if(a=ub.GraphIterator.pb(a.Ua.node),a.mv(),!Je.b(a))return 5}else{const b=a.Ua.node;let c=ub.GraphIterator.pb(b);c.mv();return ou.e(c.currentNode)?2:w.AFrameworkApplication.Mnb||!vc.EmbeddedFileReader.ocb(b)||vc.EmbeddedFileReader.ZL(b)?a.Ua.contextId===rb.a.iFrame||cJ(a.Ua)?6:1:3}else return 4;return 0}static get nb(){return ze.a.instance.Pa.nb}static get gKe(){return mq.voj(mq.nb)}}
mq.fhf=null;Object(m.a)(mq,"SelectionContextMenuProvider",null,[220]);class zM{constructor(a){this.la=a}s9d(a,b,c,f,l){const y=c?w.AFrameworkApplication.km:"";c=c?tb.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',a,b,y,c,na.a.ze(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',
a,b)}ZRi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new tx.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=na.a.Hx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,b));return a}lCi(){var a=(new tx.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}pSi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;
var b=(new tx.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=na.a.Hx(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(m.a)(zM,"ContextMenuHelper",null,[224]);class cy extends Ts{constructor(a,b,c,f){super(a,c);this.YBg=b;this.tXa=f}u7b(a){let b=null,c=!1;var f=ze.a.instance.Pa.nb;f=Fb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").ehe(f,
a);switch(this.tXa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.YBg&&this.YBg.ytg("1898844988"),y=Fb.a.instance.resolve("Box4.ISelectionContextMenuProvider").Z5g(),G=w.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=G?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting",
"Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:y&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static HRj(a,b,c,f){a.Fsi(()=>cy.HJi(b,c,f))}static HJi(a,b,c){return new cy(a,b,c,0)}}Object(m.a)(cy,"PowerPointReactFloatie",Ts,[]);class AM{constructor(a,b){this.lEg=b;this.Dwe=a}dispose(){}SA(){}fWf(){this.Dwe.dta()}N6(a,
b,c,f){this.lEg.Ryh(f);this.Dwe.N6(a,b,c)}aAl(a,b,c,f){14===f?this.N6(a,b,c,f):(this.lEg.Ryh(f),a=new cy(Fb.a.instance.rb("Common.IReactContextualUILauncher"),Sc.App.eE.rT,Fb.a.instance.rb("Common.IExternalUICommandDefinitionMapping"),f),this.Dwe.ivd(b,c,a,Fb.a.instance.rb("Box4.ISelectionContextMenuProvider")))}}Object(m.a)(AM,"ReactContextMenuUser",null,[222]);var OR=d(1048),PR=d(928);class kE{constructor(){this.Itf=null}get $uh(){return this.Itf||(this.Itf=Fb.a.instance.rb("Common.IRootManager"))}vb(){}me(){}Ovg(){}Shl(){this.$uh&&
this.$uh.$Nc()}}Object(m.a)(kE,"ABox4BridgeCommandUi",null,[223,108]);class BM extends kE{constructor(a,b,c,f){super();this.rCg=a;this.Vv=b;this.ia=c;this.ced=f}pF(a){Object(sa.a)(299,this.Vv).oRb(a)}v2(a){return 32===this.ia.Ja(ea.a.v2,2,a)}CTk(){this.rCg.clearCache();this.Vv.SA()}vRb(){this.Vv.vRb()}hZe(a){a?a(this.ced.dta()):this.ced.dta()}ytg(a){return this.rCg.Acc(a)}Ovg(){const a=Object(sa.a)(299,this.Vv);a&&a.Wak()}dispose(){}}Object(m.a)(BM,"Box4BridgeCommandUi",kE,[]);var lE=d(1163);class xr{static get F8(){return xr.B7||
(xr.B7=Fb.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){xr.F8.showContextMenu(a,b)}static N6(a,b,c){xr.F8.N6(a,b,c)}static hvd(a,b,c,f=null){xr.F8.hvd(a,b,c,f)}}xr.B7=null;Object(m.a)(xr,"BaseContextMenu",null,[]);var CM=d(1280);class Rp extends CM.a{constructor(){super();this.kTd();this.XTd()}kTd(){this.addCommandToMaps(Object.assign(new ke.a("AlignCenter","4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new ke.a("AlignLeft",
"2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new ke.a("AlignRight","393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableTopCenter","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));
this.addCommandToMaps(Object.assign(new ke.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableCenterRight",
"4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",
queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableTopLeft_MLR","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableTopRight_MLR","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));
this.addCommandToMaps(Object.assign(new ke.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableBottomLeft_MLR",
"12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new ke.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new ke.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",
populationProps:new Ao.a("681481568",!1),previewControlIds:["buttonStyle0","buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new ke.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new ke.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new ke.a("Bold","4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));
this.addCommandToMaps(Object.assign(new ke.a("BulletLibrary","3552651681"),{queryCommandId:"3827179399",populationProps:new Ao.a("2466004410",!1)}));this.addCommandToMaps(Object.assign(new ke.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new ke.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new Ao.a("462656847",!1)}));this.addCommandToMaps(Object.assign(new ke.a("ClearFormatting",
"2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new ke.a("ClearShadingColor","3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new ke.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new ke.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new ke.a(Rp.JLi,"3383614517"),{legacyControlId:"fseaCopy"}));this.addCommandToMaps(Object.assign(new ke.a(Rp.ZTi,
"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new ke.a("DecreaseIndent","3376107472"),{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new ke.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new ke.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new ke.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));
this.addCommandToMaps(Object.assign(new ke.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",populationProps:new Ao.a("1546254036",!0)}));this.addCommandToMaps(Object.assign(new ke.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new ke.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",populationProps:new Ao.a("3836866597",!0)}));
this.addCommandToMaps(new ke.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new ke.a("DictationSettingsHelpShowCommands","2729830074"));this.addCommandToMaps(Object.assign(new ke.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new ke.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new ke.a("EditingView","329275380"),{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));
this.addCommandToMaps(Object.assign(new ke.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new ke.a("FlipHorizontal","2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new ke.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new ke.a("FontColor","1970784898"),{legacyControlId:"fontColor",
populationProps:new Ao.a("2077552168",!1)}));w.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new ke.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Ao.a("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new ke.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",commandRevertId:"1250696292"}))):
(this.addCommandToMaps(Object.assign(new ke.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Ao.a("179506844",!1)})),this.addCommandToMaps(Object.assign(new ke.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new ke.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new ke.a("GrammarSettings",
"3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new ke.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));this.addCommandToMaps(Object.assign(new ke.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new ke.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new ke.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new ke.a("IncreaseIndent",
"4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new ke.a("IndentFirstLine","682091331"),{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new ke.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new ke.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));
this.addCommandToMaps(Object.assign(new ke.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));this.addCommandToMaps(Object.assign(new ke.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new ke.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new ke.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));
this.addCommandToMaps(Object.assign(new ke.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new ke.a("InsertEmoji","2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new Ao.a("1124716226",!0)}));this.addCommandToMaps(Object.assign(new ke.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new ke.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));
this.addCommandToMaps(Object.assign(new ke.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new ke.a("InsertPicture","2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new ke.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new ke.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",
queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new ke.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new Ao.a("1256496096",!0),a));let b;this.addCommandToMaps((b=new ke.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new ke.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new ke.a("Justify","1733835213"),f.legacyControlId=
"FullJustify",f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new ke.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",l));let y;this.addCommandToMaps((y=new ke.a("LineSpacing","2222099814"),y.legacyControlId="flyLineSpacing",y.populationProps=new Ao.a("2818132660",!0),y));let G;this.addCommandToMaps((G=new ke.a("LineSpacingOptions","2465215107"),G.legacyControlId="grpParagraphDialogLauncherButton",G));let R;this.addCommandToMaps((R=
new ke.a("LockAspectRatio","3369422509"),R.legacyControlId="toggleBtnLockAspectRatio",R.queryCommandId="4201275867",R));let ja;this.addCommandToMaps((ja=new ke.a("Margins","1451516907"),ja.legacyControlId="flyMargins",ja));let za;this.addCommandToMaps((za=new ke.a("MergeCells","4127468093"),za.legacyControlId="btnMergeTableCells",za));this.addCommandToMaps(new ke.a("MoreEmojis","1145444901"));this.addCommandToMaps(new ke.a("MoreStyles","3340688468"));let Va;this.addCommandToMaps((Va=new ke.a("MoreSymbols",
"3574218963"),Va.legacyControlId="btnMoreSymbols",Va));let hb;this.addCommandToMaps((hb=new ke.a("MultilevelStyle1","3062940477"),hb.queryCommandId="1240192421",hb.menuItemId="MultilevelStyleMultilevelLibrary_1",hb));let Cb;this.addCommandToMaps((Cb=new ke.a("MultilevelStyle2","3062940477"),Cb.queryCommandId="1240192421",Cb.menuItemId="MultilevelStyleMultilevelLibrary_2",Cb));let lc;this.addCommandToMaps((lc=new ke.a("MultilevelStyle3","3062940477"),lc.queryCommandId="1240192421",lc.menuItemId="MultilevelStyleMultilevelLibrary_3",
lc));let ic;this.addCommandToMaps((ic=new ke.a("NoHighlight","562361573"),ic.legacyControlId="noFontBackgroundColor",ic));let yc;this.addCommandToMaps((yc=new ke.a("NumberingLibrary","2213049770"),yc.queryCommandId="3488367157",yc.populationProps=new Ao.a("3149136033",!1),yc));let ec;this.addCommandToMaps((ec=new ke.a("Orientation","1451516907"),ec.legacyControlId="flyOrientation",ec));let jc;this.addCommandToMaps((jc=new ke.a("ParagraphOptions","2465215107"),jc.legacyControlId="grpLayoutParagraphDialogLauncherButton",
jc));this.addCommandToMaps(new ke.a(Rp.JRk,"237279923"));let xd;this.addCommandToMaps((xd=new ke.a(Rp.ERk,"1656143904"),xd.legacyControlId="fseaNewPaste",xd));this.addCommandToMaps(new ke.a(Rp.DRk,"1656143904"));let Xd;this.addCommandToMaps((Xd=new ke.a("PageSize","1451516907"),Xd.legacyControlId="flySize",Xd));this.addCommandToMaps(new ke.a("Photos","2670646631"));let Qd;this.addCommandToMaps((Qd=new ke.a("PictureAbsoluteHeight","2808088361"),Qd.legacyControlId="spnAbsoluteHeight",Qd.queryCommandId=
"2181343285",Qd));let Ie;this.addCommandToMaps((Ie=new ke.a("PictureAbsoluteWidth","3108736954"),Ie.legacyControlId="spnAbsoluteWidth",Ie.queryCommandId="1960824158",Ie));this.addCommandToMaps(new ke.a("Print","1588554917"));let Pe;this.addCommandToMaps((Pe=new ke.a("PrintToWeb","1997662572"),Pe.legacyControlId="jbtnDigitalPrint",Pe));let ig;this.addCommandToMaps((ig=new ke.a("ReadingView","3849298593"),ig.legacyControlId="btnReadingMode",ig));let ff;this.addCommandToMaps((ff=new ke.a("Redo","4183277502"),
ff.legacyControlId="btnRedo",ff));let bh;this.addCommandToMaps((bh=new ke.a("ResetPicture","2916220093"),bh.legacyControlId="btnResetPicture",bh));let ch;this.addCommandToMaps((ch=new ke.a("RightToLeftTextDirection","2632572640"),ch.legacyControlId="TextDirRTL",ch.queryCommandId="1154760330",ch));let of;this.addCommandToMaps((of=new ke.a("RotatePictureMenu","2545543284"),of.legacyControlId="flyRotate",of));let sg;this.addCommandToMaps((sg=new ke.a("RotateLeft90","2545543284"),sg.legacyControlId="buttonRotateLeft90",
sg.menuItemId="buttonRotateLeft90",sg));let Fg;this.addCommandToMaps((Fg=new ke.a("RotateRight90","2545543284"),Fg.legacyControlId="buttonRotateRight90",Fg.menuItemId="buttonRotateRight90",Fg));let og;this.addCommandToMaps((og=new ke.a("SelectCell","111222446"),og.legacyControlId="btnSelectCell",og));let pi;this.addCommandToMaps((pi=new ke.a("SelectColumn","2341852628"),pi.legacyControlId="btnSelectColumn",pi));let Wj;this.addCommandToMaps((Wj=new ke.a("SelectRow","3508003794"),Wj.legacyControlId=
"btnSelectRow",Wj));let wg;this.addCommandToMaps((wg=new ke.a("SelectTable","2306914518"),wg.legacyControlId="btnSelectTable",wg));let Tg;this.addCommandToMaps((Tg=new ke.a("ShrinkFontSize","3575191971"),Tg.legacyControlId="fseaShrinkFontSize",Tg));let Dh;this.addCommandToMaps((Dh=new ke.a("SetProofingLanguage","510284732"),Dh.legacyControlId="fseaOpenLanguageDialog",Dh));let Mm;this.addCommandToMaps((Mm=new ke.a("SpacingAfter","2322582597"),Mm.legacyControlId="spnSpacingAfter",Mm.queryCommandId=
"2340669283",Mm));let Jj;this.addCommandToMaps((Jj=new ke.a("SpacingBefore","1804274502"),Jj.legacyControlId="spnSpacingBefore",Jj.queryCommandId="26138520",Jj));let Nm;this.addCommandToMaps((Nm=new ke.a("SpecialIndent","2798144440"),Nm.legacyControlId="flySpecialIndent",Nm));let so;this.addCommandToMaps((so=new ke.a("Spelling","2646312425"),so.legacyControlId="fseaNextSpellingError",so));let an;this.addCommandToMaps((an=new ke.a("StandardShadingColorPicker","2765388691"),an.legacyControlId="cellShadingColorTable",
an));this.addCommandToMaps(new ke.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new ke.a("RecentFontColorPicker","1970784898"));let to;this.addCommandToMaps((to=new ke.a("Strikethrough","4169095173"),to.legacyControlId="fsbcStrikethrough",to.queryCommandId="2742230607",to));let hm;this.addCommandToMaps((hm=new ke.a("StyleOptionsBandedColumns","1583455318"),hm.legacyControlId="buttonBandedColumn",hm.queryCommandId="1762426222",hm.menuItemId="buttonBandedColumn",hm));let Vl;this.addCommandToMaps((Vl=
new ke.a("StyleOptionsBandedRows","1583455318"),Vl.legacyControlId="buttonBandedRow",Vl.queryCommandId="1762426222",Vl.menuItemId="buttonBandedRow",Vl));let um;this.addCommandToMaps((um=new ke.a("StyleOptionsFirstColumn","1583455318"),um.legacyControlId="buttonFirstColumn",um.queryCommandId="1762426222",um.menuItemId="buttonFirstColumn",um));let Kn;this.addCommandToMaps((Kn=new ke.a("StyleOptionsHeaderRow","1583455318"),Kn.legacyControlId="buttonFirstRow",Kn.queryCommandId="1762426222",Kn.menuItemId=
"buttonFirstRow",Kn));let wl;this.addCommandToMaps((wl=new ke.a("StyleOptionsLastColumn","1583455318"),wl.legacyControlId="buttonLastColumn",wl.queryCommandId="1762426222",wl.menuItemId="buttonLastColumn",wl));let ui;this.addCommandToMaps((ui=new ke.a("StyleOptionsTotalRow","1583455318"),ui.legacyControlId="buttonLastRow",ui.queryCommandId="1762426222",ui.menuItemId="buttonLastRow",ui));let Ln;this.addCommandToMaps((Ln=new ke.a("Subscript","1455408143"),Ln.legacyControlId="fsbcSubscript",Ln.queryCommandId=
"3960255053",Ln));let uo;this.addCommandToMaps((uo=new ke.a("Superscript","1107614"),uo.legacyControlId="fsbcSuperscript",uo.queryCommandId="692901994",uo));let Lp;this.addCommandToMaps((Lp=new ke.a("Table","28738965"),Lp.legacyControlId="flyInsertTable",Lp));let bn;this.addCommandToMaps((bn=new ke.a("TableStyles","4171428777"),bn.queryCommandId="2135594455",bn.populationProps=new Ao.a("3359297384",!1),bn.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),
bn));this.addCommandToMaps(Object.assign(new ke.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));this.addCommandToMaps(Object.assign(new ke.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new ke.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new ke.a("TextAlignmentLeftJustify",
"2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new ke.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new ke.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new ke.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new ke.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new ke.a("ThemeFontColorPickerMCU",
"1970784898"));this.addCommandToMaps(new ke.a("ToggleChangeCase","1208649786"));this.addCommandToMaps(Object.assign(new ke.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new ke.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new ke.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new ke.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new ke.a("EditInClient",
"3588168074"),{legacyControlId:"btnjEditInClient"}));this.addCommandToMaps(Object.assign(new ke.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let cn;this.addCommandToMaps((cn=new ke.a("PrintDocument","1588554917"),cn.legacyControlId="jbtnDirectPrint",cn));let Kj;this.addCommandToMaps((Kj=new ke.a("PrintToPdf","1588554917"),Kj.legacyControlId="jbtnPrintToPdf",Kj));let vh;this.addCommandToMaps((vh=new ke.a("ProtectDocument","1642700244"),vh.legacyControlId="btnProtectDocument",
vh.queryCommandId="3993403020",vh));let tj;this.addCommandToMaps((tj=new ke.a("TransformToWebPage","1997662572"),tj.legacyControlId="jbtnTransformToWeb",tj));let zg;this.addCommandToMaps((zg=new ke.a("OpenInClientWithIcon","3588168074"),zg.legacyControlId="btnOpenInClient",zg));let $d;this.addCommandToMaps(($d=new ke.a("BulletLibrary_MLR","3552651681"),$d.queryCommandId="3827179399",$d.populationProps=new Ao.a("2466004410",!1),$d));let nf;this.addCommandToMaps((nf=new ke.a("InsertPicture_MLR","2670646631"),
nf.legacyControlId="fseaInsertPicture",nf));let Pf;this.addCommandToMaps((Pf=new ke.a("NumberingLibrary_MLR","2213049770"),Pf.queryCommandId="3488367157",Pf.populationProps=new Ao.a("3149136033",!1),Pf));let Fe;this.addCommandToMaps((Fe=new ke.a("PasteStandalone","237279923"),Fe.legacyControlId="fseaPaste",Fe));let Eh;this.addCommandToMaps((Eh=new ke.a("Clipboard_MLR","237279923"),Eh.legacyControlId="fseaNewPaste",Eh));let Aj;this.addCommandToMaps((Aj=new ke.a("InsertOnlinePictureStandalone","1685987254"),
Aj.legacyControlId="fseaInsertOnlinePicture",Aj));let Lj;this.addCommandToMaps((Lj=new ke.a("InsertPictureFromHostStandalone","720118144"),Lj.legacyControlId="fseaInsertOnlinePictureFromHost",Lj.queryCommandId="3612507612",Lj))}XTd(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}Rp.ZTi="Cut";Rp.JLi="Copy";Rp.JRk="Paste";Rp.ERk="PasteAsTextOnly";Rp.DRk="PasteAsTextOnlyContextMenu";Object(m.a)(Rp,"Box4ReactCommandDefinitionMapping",CM.a,[]);class Yj extends xr{constructor(a,
b,c){super();this.osf=b;this.Tm=c;this.vb(a)}vb(a){a.ra(C.a.Smd,rb.a.application,Object(H.a)(this,this.Cih,"populateContextMenu"),96);a.ra(C.a.Hih,rb.a.application,Object(H.a)(this,this.Cih,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const y=this.esj(a);if(y&&(a=a.Ua.node)&&(a=a.qc(ra.InteractiveViewManager.instance.Rd.Na))){l=T.a.eu(a,y.end);if(w.AFrameworkApplication.isRtl&&l.x>b.x||!w.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=T.a.eu(a,y.end-
1);b.x=l.x+(w.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}xr.hvd("mnuSpellingError",new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}Cih(a,b,c,f,l){if(1===c)return 32;a=l.Uu;l=l.vd;b=Object.assign(new bo.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.APi(b,a);l.MenuItems=b;return 32}ehe(a,b){return this.rFh(a)||Yj.fLf(C.a.mergeCells)||Yj.fLf(C.a.splitCells)||this.dCl(a,b)||this.Rzl(a,b)||Yj.cBl()||Yj.SEh(a).returnValue}rFh(a){return 2===Sc.App.Mb.mode&&
this.P2c(a)}R3b(a,b,c,f=null){if(this.rFh(a)){c=this.dsj(a);var l=ab.a.He(c.lcid);l=l?l.name:"UNKNOWN";var y=Object(Sa.a)(dl.a,c)?c.typeId:"";ha.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,y,l);f?(a=this.osf.N3b(a,c))&&f.push.apply(f,a):b.append(this.osf.create(a,c))}}dsj(a){return this.Tm.bUa(a.Ua).Fh}P2c(a){return this.Tm.$sc(a)}p8f(){return null}esj(a){return this.P2c(a)?this.Tm.bUa(a.Ua):(a=this.p8f(a))?new Lk.a(a.RN,
a.Lb):null}dCl(a,b){if(2!==Sc.App.Mb.mode||!a||!Yj.s3j&&this.eCl(a,b))return!1;a=nb.a.jSa(a.toArray());return!!Yj.Cm.A3(a,14)}eCl(a,b){return 2===b||3===b&&!this.P2c(a)}Rzl(a,b){return 3!==b||this.P2c(a)}static get Vf(){return Yj.fh||(Yj.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static get Cm(){return Th.ContextSetEditor.instance}static get s3j(){return 1===Sc.App.mode}static get U0j(){null==Yj.HId&&(Yj.HId=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):
!1);return Yj.HId}static get vmc(){null==Yj.v3a&&(Yj.v3a=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Yj.v3a}static get dT(){null==Yj.tN&&(Yj.tN=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Yj.tN}static fLf(a){return 32===w.AFrameworkApplication.Qa.processAction(a,1)}static cBl(){return 2===Sc.App.Mb.mode&&!!Sc.App.eE.rT&&Sc.App.eE.rT.ytg("510284732")}static SEh(a){let b,
c;b=c=!1;if(!a)return{returnValue:!1,dVa:b,L$b:c};if(Yj.vmc)return Yj.SAl(a);if(!(a.ida||Yj.U0j&&2===a.length&&a.jf.contextId===rb.a.endOfParagraph))return{returnValue:!1,dVa:b,L$b:c};a=a.Ua.clone();b=32===w.AFrameworkApplication.Qa.ii(a,C.a.cKa,1,!0,null,null);c=32===w.AFrameworkApplication.Qa.ii(a,C.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,dVa:b,L$b:c}}static SAl(a){let b;let c;var f=a.Ua.clone();c=Yj.dT&&Ee.m(f);b=!c&&32===w.AFrameworkApplication.Qa.ii(f,C.a.cKa,1,!0,null,null);
if(a.ida||2===a.length&&a.jf.contextId===rb.a.endOfParagraph)f=!c&&32===w.AFrameworkApplication.Qa.ii(f,C.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let y=0;y<l;y++){const G=a.ga(y).clone();if(G.contextId===rb.a.paragraph||G.contextId===rb.a.textRange)(c=Yj.dT&&Ee.m(G))||(f=32===w.AFrameworkApplication.Qa.ii(G,C.a.insertHyperlink,1,!0,null,null)&&f);else if(G.contextId!==rb.a.endOfParagraph)return f=b=!1,{returnValue:!1,dVa:b,L$b:f}}}return{returnValue:b||f,dVa:b,L$b:f}}static OOi(a,
b){let c=!1,f=!1;({dVa:c,L$b:f}=Yj.SEh(a)).returnValue&&(c?f?b.push(Yj.Hce(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(Yj.Hce(["OpenHyperlink"])):f&&b.push(Yj.Hce(["InsertLink"])))}static Hce(a){const b=Object.assign(new el.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:c}));return b}}Yj.HId=null;Yj.fh=null;Yj.v3a=null;Yj.tN=null;Object(m.a)(Yj,"AEditSurfaceContextMenu",xr,[]);class Vz extends Yj{constructor(a,
b,c,f,l,y,G,R,ja,za){super(a,c,b,void 0,za);this.tXa=0;this.Ewe=f;this.gHa=l;this.la=y;this.qdd=this.la.$Kb;this.Xgc=this.la.aac;this.e2g=this.la.j4c;this.l2g=this.la.Lre;this.cZa=this.la.Qkb;this.pkk=this.la.Epc;this.xWg=za;this.nD=b;this.wYg=G;this.JE=R;this.Sb=ja;this.Jcd=this.la.bTk}APi(a,b){const c=[];switch(this.tXa){case 4:this.Vra(c,!0);this.Fzf(c);this.Uei(c);this.lfi(c);this.cZa&&this.wgi(c);this.J_b(c);this.LQa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.Vra(c,!1);
this.UTd(c,this.tXa);this.J_b(c);this.LQa(c);this.Ovb(c);break;case 6:case 5:this.la.W4e&&this.Rzf(c);this.Vra(c,!1);this.UTd(c,this.tXa);this.la.$Kb&&this.la.TBh&&this.Czf(c);this.LQa(c);this.Ovb(c);break;case 2:this.Vra(c,!0);this.CJc(c,!0);this.la.Xn&&this.BJc(c);break;case 1:this.Vra(c,!1);this.CJc(c,!1);this.la.CIh&&this.Wgi(c);this.Fzf(c);this.wzf(c);rx.MCh&&this.jAf(c);this.la.Xn&&this.BJc(c);this.J_b(c);this.LQa(c);this.Ovb(c);break;case 3:this.Edi(c);this.Ovb(c);break;case 19:this.Ogi(c);
this.CJc(c,!1);this.wzf(c);rx.MCh&&this.jAf(c);w.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.BJc(c);this.J_b(c);break;case 21:this.Chi(c);break;case 20:this.Vra(c,!0);this.CJc(c,!0);w.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.BJc(c);this.J_b(c);break;case 9:this.Vra(c,!1);this.LQa(c);break;case 22:this.Vra(c,!1);this.UTd(c,this.tXa);this.LQa(c);break;case 10:this.Vra(c,!1);this.Jfi(c);this.LQa(c);this.Ovb(c);break;case 17:this.Efi(c);break;case 18:this.Ffi(c);
break;case 0:if(this.Sb.rj()){this.la.W4e&&this.Rzf(c);var f=ra.InteractiveViewManager.instance.Rd.Nb.Pa.nb;this.R3b(f,null,b,c);this.Vra(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.Ngi(c),this.ahi(c));3===b&&this.A2j(f)&&this.vei(c);this.Zfi(c);Yj.OOi(f,c);this.uSi(f,c);this.tSi(f,c);this.qdd&&this.Czf(c);this.uNi(c);this.LQa(c);this.Ovb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.tXa=0}Ryh(a){this.tXa=a}hu(){return Object.assign(new el.a,{ControlList:[]})}cCl(a){if(!this.e2g&&
!this.l2g||2!==Sc.App.Mb.mode)return!1;a=nb.a.jSa(a.toArray());return!!this.gHa.A3(a,14)}bCl(a){if(!a||!this.pkk||2!==Sc.App.Mb.mode)return!1;a=nb.a.jSa(a.toArray());return!!this.gHa.A3(a,14)}Vra(a,b){const c=this.hu();b||(Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"Cut"})),Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"Copy"})));this.Pzf(a,c)}Pzf(a,b){const c=Object.assign(new el.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,
ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new Hq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);for(let l=1;5>=l;l++)f.GalleryItems.push(this.Rxb(l));a.push(b);a.push(c)}Rxb(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;
break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;
break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new lE.a,{Id:l,Icon:a,Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}Chi(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"CopyInVersionHistory"}));a.push(b)}Ogi(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"Copy"}));this.Pzf(a,b)}CJc(a,b){const c=this.hu();
Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"DeleteSlide"})));a.push(c)}Uei(a){if(this.Jcd){const b=this.hu();b.ControlList.push(Object.assign(new tg.a,{ExternalId:"FormatBackground"}));a.push(b)}}Edi(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"Paste"}));Array.add(b.ControlList,Object.assign(new tg.a,
{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}wzf(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"HideSlide"}));this.la.Whe&&Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"UnhideSlide"}));a.push(b)}jAf(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"ShareSlide"}));a.push(b)}Ffi(a){const b=this.w7f();a.push(b)}BJc(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"AddSection"}));a.push(b)}UTd(a,
b){const c=this.hu();7===b?(this.la.FKa?Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"ChangePicture"})),this.la.Exb&&this.Vei(c),this.la.Uua&&!this.la.w3&&Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"AlternativeText"}))):13===b?this.la.FKa&&Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new tg.a,
{ExternalId:"SmartArtEditText"})):14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.uzf(c),this.la.STc&&this.nzf(c));this.la.Uua&&this.la.w3&&14!==b&&(b=new tg.a,b.ExternalId="AlternativeText",c.ControlList.push(b));this.azf(c);this.SGf(c);this.cyh(c);a.push(c)}Fzf(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:this.la.u0a?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}Czf(a){const b=
this.hu();this.Xgc&&Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}J_b(a){if(this.Xgc){var b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}cyh(a){Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"SendToBackFlyout"}))}SGf(a){Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"BringToFrontFlyout"}))}uzf(a){Array.add(a.ControlList,
Object.assign(new tg.a,{ExternalId:"GroupAnchor"}))}azf(a){Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"ShowHideFormatShapePane"}))}Vei(a){Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"FormatPicture"}))}nzf(a){Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"FixIt"}))}Jfi(a){const b=this.hu();this.uzf(b);this.la.STc&&this.nzf(b);this.azf(b);this.SGf(b);this.cyh(b);if(this.la.Uua&&this.la.w3){let c=new tg.a;c.ExternalId="AlternativeText";b.ControlList.push(c)}a.push(b)}LQa(a){const b=
this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"InsertComment"}));a.push(b)}lfi(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"DesignerHome"}));a.push(b)}wgi(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"ShowHideRuler"}));a.push(b)}XOi(){const a=this.Ewe.ZRi();return Object.assign(new tg.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}Ngi(a){const b=this.hu();Array.add(b.ControlList,this.XOi());a.push(b)}ahi(a){if(!this.Ewe.lCi()){var b=
this.Ewe.pSi();if(b){var c=this.hu();Array.add(c.ControlList,Object.assign(new tg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}Rzf(a){const b=this.hu();b.ControlList.push(Object.assign(new tg.a,{ExternalId:"RecommendationContextMenuFlyout"}));a.push(b)}Zfi(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"ParagraphOptions"}));a.push(b)}vei(a){const b=this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"Delete"}));a.push(b)}Wgi(a){const b=
this.hu();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"SummarizeSlides"}));a.push(b)}uNi(a){var b=Fb.a.instance.rb("PowerPointWebEditor.IContextMenuExtensibilityHandler");b&&(b=b.Jbj())&&a.push(b)}uSi(a,b){a&&this.cCl(a)&&(a=this.hu(),this.e2g&&Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"MergeTableCells"})),this.l2g&&Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"SplitTableCells"})),b.push(a))}tSi(a,b){this.bCl(a)&&(a=this.hu(),Array.add(a.ControlList,Object.assign(new tg.a,
{ExternalId:"SetSizeAnchor"})),Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"TableDistribute"})),b.push(a))}A2j(a){return this.nD.$sc(a)}Efi(a){const b=this.w7f();Array.add(b.ControlList,Object.assign(new tg.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}w7f(){const a=this.hu();Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"MoveSectionUp"}));
Array.add(a.ControlList,Object.assign(new tg.a,{ExternalId:"MoveSectionDown"}));return a}Ovb(a){this.wYg&&this.wYg.N3b(this.w7b(),a)}w7b(){return this.JE.instance?this.JE.instance.w7b():[]}}Object(m.a)(Vz,"EditSurfaceContextMenu",Yj,[]);class DM{constructor(a,b,c,f,l,y,G,R,ja,za){this.kkc=null;this.$Gb=0;this.eP=b;this.Vv=c;this.X4=f;this.wb=y;this.Qjk=G;this.ia=ja;this.Fc=R;this.Fc.fii(Object(H.a)(this,this.C$g,"onCUIStatusChanged"));this.Fc.NJc(Object(H.a)(this,this.YU,"onFocusChanged"));this.Fc.SJc(Object(H.a)(this,
this.Gib,"onSetFocus"));this.ced=za}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Fc.Nal(Object(H.a)(this,this.C$g,"onCUIStatusChanged"));this.Fc.gqd(Object(H.a)(this,this.YU,"onFocusChanged"));this.Fc.nXe(Object(H.a)(this,this.Gib,"onSetFocus"))}initialize(){this.vb();this.SA()}YU(){}Gib(a,b){b.fib!==xa.a.Waa||b.QKb===D.AFrame.Shb||b.QKb.endsWith("/modal")||appChrome.api.enterKeytipMode()}pNl(a){this.$Gb|=a;this.kkc||(this.kkc=new pd.a(0,1,0,Object(H.a)(this,this.Qtl,"setTimeOutWithCurrentActionContext"),
90,"11"),this.kkc.customData=new Date,this.wb.Hb(this.kkc))}vb(){this.ia.ra(ea.a.v2,qc.a.application,Object(H.a)(this,this.DGj,"handleOpenMenu"),64)}DGj(a,b,c,f,l){return this.v2(l)?32:8}Qtl(a){Kc.a.A3i(Object(H.a)(this,this.SA,"poll"),Object(sa.a)(Date,a.customData));this.kkc=null}C$g(a,b){this.pNl(b.cGl)}SA(){this.Qjk.clearCache();0!==(this.$Gb&1)&&this.Vv.SA();0!==(this.$Gb&2)&&this.eP.SA();0!==(this.$Gb&4)&&this.X4.SA();this.$Gb=0}v2(a){return this.ced.v2(a)}}Object(m.a)(DM,"CUIManager",null,
[221,108]);var mE=d(1286),nE=d(1257),QR=d(1106),oE=d(1128);class st{constructor(){this.italic=0;this.K4c=!1;this.underline=0;this.IV=this.Yyd=!1;this.superscript=0;this.Cwd=!1;this.subscript=0;this.ywd=!1;this.strikethrough=0;this.qwd=!1;this.rt=0;this.uRc=!1;this.fontName=null;this.e7b=this.zxd=this.cUc=this.bUc=!1;this.highlight=0;this.g_c=!1;this.bold=this.italic=this.underline=this.strikethrough=this.rt=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.iw=be.Font.QUj;
this.Rpa=-1;this.EXd=this.K4c=this.Yyd=this.IV=this.Cwd=this.ywd=this.qwd=this.uRc=this.bUc=this.cUc=this.zxd=this.e7b=this.g_c=!1}}Object(m.a)(st,"FormattingData",null,[]);var pE=d(845),RR=d(812);class Wk{constructor(){this.hm=this.Vxa=0;this.vd=null;this.zD=!1;this.yL=null}}Object(m.a)(Wk,"CuiEnabledInfo",null,[]);class ih{constructor(){this.hm=this.Vxa=0;this.vd=null;this.zD=this.Gqe=this.Hqe=this.xX=this.Fq=this.Ghe=!1;this.yL=null}}Object(m.a)(ih,"CuiExecuteInfo",null,[]);class SR{constructor(){this.d6e=
new Cq.a;this.rpe=!1}}Object(m.a)(SR,"TextRangeStyleData",null,[]);class Pg{constructor(){this.hb=new Qe.a;this.Zc=new Qe.a;this.Lif=new st;this.srf=new pE.a;this.WGd=this.VGd=!1}initialize(){Pg.dJh=Pg.L2d();this.hb.$(C.a.undo,Pg.oac);this.hb.$(C.a.redo,Pg.oac);this.hb.$(C.a.vid,Pg.oac);this.hb.$(C.a.Hih,Pg.$Ll);this.hb.$(C.a.openInClient,Pg.aOk);this.hb.$(F.a.close,Pg.mFi);this.hb.$(C.a.uL,Pg.AXi);this.hb.$(C.a.font,Pg.D9d);this.hb.$(C.a.Xq,Object(H.a)(this,this.s$d,"genericFontSizeExecuteBridge"));
w.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.hb.$(C.a.y6,Pg.D9d),this.hb.$(C.a.vLa,Pg.D9d),this.hb.$(C.a.HKa,Object(H.a)(this,this.s$d,"genericFontSizeExecuteBridge")),this.hb.$(C.a.W0a,Object(H.a)(this,this.xhl,"revertPreviewFontSizeExecuteBridge")));this.hb.$(C.a.bold,Pg.Fxb);this.hb.$(C.a.setItalic,Pg.Fxb);this.hb.$(C.a.underline,Pg.Fxb);this.hb.$(C.a.strikethrough,Pg.Fxb);this.hb.$(C.a.superscript,Pg.Fxb);this.hb.$(C.a.subscript,Pg.Fxb);this.hb.$(C.a.bqc,Object(H.a)(this,this.oya,
"queryFormattingExecuteBridge"));this.hb.$(C.a.lqc,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Xqc,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Nqc,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Pqc,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.jUe,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Qqc,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Tnd,
Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.fqc,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.Und,Object(H.a)(this,this.oya,"queryFormattingExecuteBridge"));this.hb.$(C.a.yTe,Object(H.a)(this,this.p_k,"queryFormatPainterExecuteBridge"));this.hb.$(C.a.mqc,Object(H.a)(this,this.dod,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.zqc,Object(H.a)(this,this.dod,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.eqc,Object(H.a)(this,this.dod,"queryParaFormattingExecuteBridge"));
this.hb.$(C.a.gqc,Object(H.a)(this,this.dod,"queryParaFormattingExecuteBridge"));this.hb.$(C.a.QC,Pg.u_f);this.hb.$(C.a.Ry,Pg.u_f);this.hb.$(F.a.T_d,Pg.dqc);this.hb.$(C.a.KCb,Pg.oac);this.Zc.$(C.a.jKb,Pg.NQc);this.Zc.$(C.a.kKb,Pg.NQc);this.Zc.$(C.a.fpc,Pg.NQc);this.Zc.$(C.a.epc,Pg.NQc);this.Zc.$(C.a.bqc,Pg.Cya);this.Zc.$(C.a.lqc,Pg.Cya);this.Zc.$(C.a.Xqc,Pg.Cya);this.Zc.$(C.a.Nqc,Pg.Cya);this.Zc.$(C.a.Pqc,Pg.Cya);this.Zc.$(C.a.jUe,Pg.Cya);this.Zc.$(C.a.Qqc,Pg.Cya);this.Zc.$(C.a.Tnd,Pg.Cya);this.Zc.$(C.a.fqc,
Pg.Cya);this.Zc.$(C.a.Und,Pg.Cya);this.Zc.$(C.a.mqc,Pg.Rpd);this.Zc.$(C.a.eqc,Pg.Rpd);this.Zc.$(C.a.zqc,Pg.Rpd);this.Zc.$(C.a.gqc,Pg.Rpd);this.hb.$(C.a.JNf,Object(H.a)(this,this.HTj,"insertHyperLinkBridge"));this.hb.$(C.a.Z_d,Object(H.a)(this,this.INf,"commandingInputMethodExecuteBridge"));this.hb.$(C.a.NNf,Object(H.a)(this,this.INf,"commandingInputMethodExecuteBridge"));this.hb.$(C.a.KNf,Object(H.a)(this,this.QTj,"insertOnLinePictureExecuteBridge"));this.hb.$(C.a.LNf,Object(H.a)(this,this.fUj,"insertSymbolBridge"));
this.hb.$(C.a.MNf,Object(H.a)(this,this.tGi,"commandingInsertTableExecuteBridge"));this.hb.$(C.a.uGi,Object(H.a)(this,this.BBk,"navToPageExecuteBridge"));this.hb.$(C.a.HNf,Pg.GNf);this.hb.$(C.a.Y_d,Pg.GNf);w.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Zc.$(F.a.lNb,Pg.Ikl)}clearCache(){this.Lif=new st;this.srf=new pE.a;this.WGd=this.VGd=!1}K8f(a,b,c){const f=this.hb.ga(a);f?c=f(a,b,c):(c=new ih,c.vd=b);c.Vxa=a;c.hm||(c.hm=Pg.Vxk(a));Zg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&this.mGi(a,b)&&(c.vd||(c.vd={}),"object"===typeof c.vd&&(c.vd.MappedCommand=!0));return c}fWc(a,b=null){const c=this.Zc.ga(a);b=c?c(a,b):new Wk;b.Vxa=a;b.hm||(b.hm=a);return b}oya(){const a=new ih;a.Ghe=this.WGd;this.WGd=!0;a.hm=C.a.hLb;a.vd=this.Lif;a.xX=!0;return a}dod(){const a=new ih;a.Ghe=this.VGd;this.VGd=!0;a.hm=C.a.pya;a.vd=this.srf;a.Gqe=!0;a.xX=!0;return a}s$d(a,b){const c=new ih;c.Fq=!0;let f=
0;({number:f}=na.a.eRk(b.CommandValueId||b.Value,w.AFrameworkApplication.numberFormat));if(isNaN(f))return Sc.App.Mb.updateCommandUI(),c.yL=!1,c;a===C.a.HKa&&(b[tn.a.iba]=!1);c.vd=Pg.B1d(Math.floor(2*f),b);return c}xhl(a,b){a=new ih;a.Fq=!0;b[tn.a.iba]=!1;a.vd=Pg.B1d(0,b);return a}INf(a){var b={Visible:!0};a===C.a.Z_d?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new nE.a(b,2);b=new ih;b.vd=a;return b}QTj(a,b){a=new ih;const c=new J.DictionaryPropertySet;
b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(we.a.aV,b);a.vd=c;return a}HTj(a,b){a=new ih;b.Source="CommandingInterface";a.vd=b;return a}tGi(a,b){a=new ih;a.Fq=!0;const c=new II;c.rows=b.Row;c.columns=b.Col;a.vd=c;return a}fUj(a,b){a=new ih;a.Fq=!0;b=b.Value;a.vd=new J.DictionaryPropertySet;const c=this.oYc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',
c);a.vd=f;return a}BBk(a,b){a=new ih;a.vd=b.Value?b.Value:"";return a}p_k(){const a=new ih;a.vd=Fb.a.instance.rb("Box4.IFormatPainter");a.xX=!0;return a}oYc(a){return Pg.dJh[a.toString()]}mGi(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Zc.ga(a)||!!this.hb.ga(a);return!w.AFrameworkApplication.Qa.MT(a)&&b}static L2d(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",
15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static A0b(a,b){var c=Object(sa.a)(st,a.vd),f=Object(sa.a)(pE.a,a.vd);let l=!0;switch(a.Vxa){default:l=!1;break;case C.a.Flh:b[Ih.a.On]=!0;break;case C.a.bqc:b[Ih.a.On]=1===c.bold;break;case C.a.lqc:b[Ih.a.On]=1===c.italic;break;case C.a.Xqc:b[Ih.a.On]=1===c.underline;break;case C.a.jUe:b[aH.a.On]=1===c.subscript;break;case C.a.Pqc:b[Ih.a.On]=1===c.subscript;break;case C.a.Qqc:b[Ih.a.On]=
1===c.superscript;break;case C.a.Nqc:b[Ih.a.On]=1===c.strikethrough||1===c.rt;break;case C.a.Tnd:b[zo.a.IsFreeForm]=!0;b[zo.a.Value]=void 0!==c.fontName&&null!==c.fontName?wb.a.r8f(c.fontName,c.Rpa):"";break;case C.a.fqc:a="";-1!==c.fontSize&&(a=na.a.pUc(c.fontSize/2,0,w.AFrameworkApplication.numberFormat));b[zo.a.IsFreeForm]=!0;b[zo.a.Value]=a;break;case C.a.Und:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=aa.FontUtils.q_k(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:
a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===c.fontName)a=wb.a.r8f(c.fontName,c.Rpa),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=aa.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[co.SelectedFont]=a;break;case C.a.mqc:b[Ih.a.On]=1===f.Vl;break;case C.a.eqc:b[Ih.a.On]=
2===f.Vl;break;case C.a.zqc:b[Ih.a.On]=3===f.Vl;break;case C.a.gqc:b[Ih.a.On]=6===f.Vl;break;case C.a.yTe:if(c=Object(sa.a)(309,a.vd))b[Ih.a.On]=c.TL;case F.a.T_d:}return l}static u_f(){return new ih}static dqc(a,b){a=new ih;a.vd=b;a.xX=!0;return a}static oac(a,b,c){a=new nE.a(b,c.InvocationMethod);b=new ih;b.vd=a;return b}static $Ll(a,b){a=new nE.a(b,3);b=new ih;b.vd=a;return b}static aOk(a,b,c){a=new ih;QR.a.Txg(c.CommandLocation)||26===c.CommandLocation||(a.vd=!1);return a}static sTe(){const a=
new ih;a.vd=new J.DictionaryPropertySet;a.xX=!0;return a}static AXi(){const a=new ih;a.vd=new J.DictionaryPropertySet;return a}static mFi(){const a=new ih;a.vd=Uh.b;return a}static NQc(){const a=new Wk;a.vd=new J.DictionaryPropertySet;return a}static Ikl(a,b=null){a=new Wk;a.vd=b;return a}static Fxb(){const a=new ih;a.vd=new Q(2);a.Fq=!0;return a}static Rpd(){const a=new Wk;a.hm=C.a.pya;return a}static Cya(){const a=new Wk;a.hm=C.a.hLb;return a}static D9d(a,b){const c=new ih;c.Fq=!0;var f=b.CommandValueId?
b.CommandValueId:b.Value;c.vd=f;if(be.Font.bWa()){const y=new st;var l=b.MenuItemId;l&&(y.Rpa=be.Font.Iyj(l));(l=Object(sa.a)(RR.a,b[co.Formatting]))&&(l.isBold||l.isItalic)&&(y.bold=l.isBold?1:0,y.italic=l.isItalic?1:0);y.fontName=f;c.vd=y}Pg.pfk(b);(a=w.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===C.a.y6||a===C.a.vLa))&&(b[tn.a.iba]=!1);c.vd=Pg.B1d(c.vd,b);a||(aa.FontUtils.tJc(f),f=b[co.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,
f)));return c}static pfk(a){void 0!==a[zo.a.IsFreeForm]&&null!==a[zo.a.IsFreeForm]&&a[zo.a.IsFreeForm]?ha.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&ha.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static GNf(a,b){a=new ih;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.vd=Pg.X8a(b);a.Fq=!0;return a}static X8a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,
4)+a.substring(0,2)}static Vxk(a){switch(a){case C.a.Z_d:return C.a.undo;case C.a.NNf:return C.a.redo;case C.a.MNf:return C.a.insertTable;case C.a.KNf:return C.a.z8;case C.a.LNf:return C.a.zVa;case C.a.JNf:return C.a.insertHyperlink;case C.a.HNf:return C.a.vr;case C.a.Y_d:return C.a.e2;default:return a}}static B1d(a,b){const c=new oE.a(a);return w.AFrameworkApplication.Aa.mb.Rp?new oE.a(a,b[tn.a.iba]):c}}Pg.dJh={};Object(m.a)(Pg,"CuiActionBridge",null,[]);class EM{constructor(){this.cWd=this.A0b=
this.iRe=this.NRe=null}}Object(m.a)(EM,"GeneralCuiUserHooks",null,[]);var TR=d(508);class Xv{constructor(){this.sV=this.p0a=null;this.menuItemId=0}}Object(m.a)(Xv,"QueryData",null,[]);let Cf;class Kd extends Pg{constructor(a,b,c,f,l,y,G,R,ja){super();this.CWe=za=>{let Va=new ih;({DY:za}=this.qPl(za)).returnValue&&(Va.zD=!0,Va.hm=za);return Va};this.la=a;this.pa=b;this.Zhk=c;this.xGb=f;this.zc=l;this.Sb=y;this.Eb=G;this.YXa=R;if(this.la.ka("IsPasteTextFloatieEnabled")&&!ja)throw Error.argumentNull("textPasteFloatieManager");
this.wY=ja}initialize(){super.initialize();this.ISj();this.ERj();this.$Sj();this.aSj();this.MSj();this.oRj();this.XSj();this.sSj();this.rRj();this.SRj();this.zRj()}fWc(a,b=null){if(w.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=this.Zc.ga(a);b=c?c(a,b):new Wk;b.Vxa=a;b.hm||(b.hm=a);b&&this.Eb&&1===this.Eb.al&&!Kd.foe(a)&&(b.yL=!1);return b}(b=super.fWc(a))&&this.Eb&&1===this.Eb.al&&!Kd.foe(a)&&(b.yL=!1);return b}ERj(){this.Zc.$(ea.a.LMc,this.jMb.bind(this));
this.Zc.$(ea.a.PMc,this.jMb.bind(this));this.Zc.$(ea.a.QSc,this.jMb.bind(this));this.Zc.$(ea.a.OSc,this.jMb.bind(this));this.Zc.$(ea.a.PSc,this.jMb.bind(this));this.Zc.$(ea.a.RSc,this.jMb.bind(this));this.hb.$(ea.a.LMc,this.kMb.bind(this));this.hb.$(ea.a.PMc,this.kMb.bind(this));this.hb.$(ea.a.QSc,this.kMb.bind(this));this.hb.$(ea.a.OSc,this.kMb.bind(this));this.hb.$(ea.a.PSc,this.kMb.bind(this));this.hb.$(ea.a.RSc,this.kMb.bind(this))}jMb(a,b){let c=new Wk;b.originalActionId=a;c.hm=ea.a.sge;c.vd=
b;c.Vxa=a;c.zD=!0;return c}kMb(a,b){let c=new ih;b.originalActionId=a;c.hm=ea.a.sge;c.vd=b;c.Vxa=a;return c}ISj(){this.Zc.$(ea.a.gMa,Object(H.a)(this,this.Crc,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.eMa,Object(H.a)(this,this.Crc,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.Uga,Object(H.a)(this,this.Crc,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.xza,Object(H.a)(this,this.Crc,"remapRumTrackerEnabledBridge"));this.Zc.$(ea.a.qyc,Object(H.a)(this,this.Crc,"remapRumTrackerEnabledBridge"))}$Sj(){this.hb.$(ea.a.pLb,
Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.tLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.wLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.OKa,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.PKa,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.RKa,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.Jjb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.UKa,Object(H.a)(this,
this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.TKa,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.SKa,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.Hjb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.Ijb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.qLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.uLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.QKa,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));
this.hb.$(ea.a.Kjb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.sLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.rLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.VTe,Kd.ef);this.hb.$(ea.a.vLb,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.rya,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.YTe,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.iod,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));
this.hb.$(ea.a.n0a,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.hb.$(ea.a.o0a,Object(H.a)(this,this.ZE,"remapTextQueryExecute"));this.Zc.$(ea.a.pLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.tLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.wLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.OKa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.PKa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.RKa,
Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.Jjb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.UKa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.TKa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.SKa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.Hjb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.Ijb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.qLb,Object(H.a)(this,
this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.uLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.QKa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.Kjb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.sLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.rLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.vLb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.rya,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));
this.Zc.$(ea.a.YTe,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.iod,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.n0a,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.o0a,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.hb.$(ea.a.pKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.vKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.IKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.hya,Object(H.a)(this,
this.R4c,"justifyExecuteBridge"));this.hb.$(ea.a.jya,Object(H.a)(this,this.R4c,"justifyExecuteBridge"));this.hb.$(ea.a.lya,Object(H.a)(this,this.R4c,"justifyExecuteBridge"));this.hb.$(ea.a.T_a,Object(H.a)(this,this.R4c,"justifyExecuteBridge"));this.hb.$(ea.a.R_a,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.zKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.CKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.S_a,Object(H.a)(this,this.Kt,"remapTextExecute"));
this.hb.$(ea.a.AKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.DKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.ojb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.kjb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.M1,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.L1,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.K1,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.FKb,Object(H.a)(this,this.Kt,"remapTextExecute"));
this.hb.$(ea.a.xKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.njb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.spc,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.yKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.tpc,Kd.oxg);this.hb.$(ea.a.upc,Kd.oxg);this.hb.$(ea.a.Goa,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.CKa,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.IOb,Object(H.a)(this,this.pxg,"listMarkerGalleryShapeExecuteBridge"));
this.hb.$(ea.a.qOb,Object(H.a)(this,this.pxg,"listMarkerGalleryShapeExecuteBridge"));this.hb.$(ea.a.npc,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.opc,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.iya,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.uKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.ppc,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.tKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.BKb,Object(H.a)(this,
this.Kt,"remapTextExecute"));this.hb.$(ea.a.xpc,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.EKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.insertHyperlink,Object(H.a)(this,this.L9k,"remapInsertHyperlinkExecute"));this.hb.$(ea.a.kya,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.ljb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.GKb,Object(H.a)(this,this.Kt,"remapTextExecute"));this.hb.$(ea.a.HKb,Object(H.a)(this,this.Kt,"remapTextExecute"));
this.Zc.$(ea.a.pKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.vKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.IKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.hya,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.jya,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.lya,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.T_a,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.R_a,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));
this.Zc.$(ea.a.zKb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.CKb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.S_a,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.AKb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.DKb,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.Zc.$(ea.a.ojb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.kjb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.M1,Object(H.a)(this,
this.$s,"remapTextEnabled"));this.Zc.$(ea.a.L1,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.K1,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.FKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.xKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.njb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.spc,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.yKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.Goa,
Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.CKa,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.npc,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.opc,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.iya,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.uKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.ppc,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.tKb,Object(H.a)(this,this.$s,"remapTextEnabled"));
this.Zc.$(ea.a.BKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.xpc,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.EKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.kya,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.ljb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.insertHyperlink,Object(H.a)(this,this.K9k,"remapInsertHyperlinkEnabled"));this.Zc.$(ea.a.n0a,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.o0a,Object(H.a)(this,
this.$s,"remapTextEnabled"));this.Zc.$(ea.a.GKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.HKb,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.n0a,Object(H.a)(this,this.$s,"remapTextEnabled"));this.Zc.$(ea.a.o0a,Object(H.a)(this,this.$s,"remapTextEnabled"))}aSj(){this.hb.$(ea.a.GTe,Object(H.a)(this,this.Fjb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.ATe,Object(H.a)(this,this.Fjb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.DTe,Object(H.a)(this,
this.Fjb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.BTe,Object(H.a)(this,this.Fjb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.ETe,Object(H.a)(this,this.Fjb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.FTe,Object(H.a)(this,this.Fjb,"queryInkControlToggledExecuteBridge"));this.hb.$(ea.a.CTe,Object(H.a)(this,this.Fjb,"queryInkControlToggledExecuteBridge"))}MSj(){this.hb.$(ea.a.Fqc,Kd.ef);this.hb.$(ea.a.Gqc,Kd.ef);this.hb.$(ea.a.Iqc,Kd.ef);this.hb.$(ea.a.qod,Kd.ef);this.hb.$(ea.a.pod,
Kd.ef);this.hb.$(ea.a.rod,Kd.ef);this.hb.$(ea.a.sod,Kd.ef);this.hb.$(ea.a.uod,Kd.ef);this.hb.$(ea.a.ood,Kd.ef);this.hb.$(ea.a.wod,Kd.ef);this.hb.$(ea.a.tod,Kd.ef);this.hb.$(ea.a.Cod,Kd.ef);this.hb.$(ea.a.Bod,Kd.ef);this.hb.$(ea.a.Aod,Kd.ef);this.hb.$(ea.a.Njb,Kd.ef);this.hb.$(ea.a.Ojb,Kd.ef);this.hb.$(ea.a.l0a,Object(H.a)(this,this.Ynd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.m0a,Object(H.a)(this,this.Ynd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.DLb,Kd.ef);this.hb.$(ea.a.CLb,
Kd.ef);this.hb.$(ea.a.Hqc,Kd.ef);this.hb.$(ea.a.yod,Kd.ef);this.hb.$(ea.a.zod,Kd.ef);this.Zc.$(ea.a.Blb,Kd.Sy);this.Zc.$(ea.a.Clb,Kd.Sy);this.Zc.$(ea.a.oOb,Kd.Sy);this.Zc.$(ea.a.Nlb,Kd.Sy);this.Zc.$(ea.a.KOb,Kd.Sy);this.Zc.$(ea.a.m2e,Kd.Sy);this.hb.$(ea.a.Blb,Object(H.a)(this,this.A$i,"fontNameExecuteBridge"));this.hb.$(ea.a.Clb,Object(H.a)(this,this.s$d,"genericFontSizeExecuteBridge"));this.hb.$(ea.a.oOb,Kd.J6e);this.hb.$(ea.a.Nlb,Kd.J6e);this.hb.$(ea.a.KOb,Kd.J6e);this.Zc.$(ea.a.pEf,Kd.N1a);this.Zc.$(ea.a.qEf,
Kd.N1a);this.Zc.$(ea.a.$Kc,Kd.N1a);this.Zc.$(ea.a.XKc,Kd.N1a);this.Zc.$(ea.a.ZKc,Kd.N1a);this.Zc.$(ea.a.YKc,Kd.N1a);this.Zc.$(ea.a.bWd,Kd.N1a);this.Zc.$(ea.a.SVd,Kd.N1a);this.hb.$(ea.a.Std,Kd.gxg);this.hb.$(ea.a.k0a,Kd.Tlh);this.hb.$(ea.a.vod,Kd.Tlh);this.hb.$(ea.a.zoa,Kd.gxg)}oRj(){this.hb.$(ea.a.Sj,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Moa,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.uya,Object(H.a)(this,this.sya,
"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.QLb,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Tjb,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Pod,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.tya,Kd.eV);this.hb.$(ea.a.kk,Object(H.a)(this,this.lyd,"transitionExecuteBridge"));this.hb.$(ea.a.Hlb,Object(H.a)(this,this.lyd,"transitionExecuteBridge"));this.Zc.$(ea.a.kk,Kd.Sy);
this.Zc.$(ea.a.vpa,Kd.Sy);this.Zc.$(ea.a.iza,Kd.Sy);this.Zc.$(ea.a.Ptc,Kd.Sy);this.Zc.$(ea.a.Ilb,Kd.Sy);this.hb.$(ea.a.Koa,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.g0a,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.h0a,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Loa,Object(H.a)(this,this.sya,"queryQueryTransitionResultExecuteBridge"));this.hb.$(ea.a.Ww,Object(H.a)(this,this.lyd,
"transitionExecuteBridge"));this.hb.$(ea.a.ONb,Object(H.a)(this,this.lyd,"transitionExecuteBridge"));this.Zc.$(ea.a.Ww,Kd.Sy);this.Zc.$(ea.a.aza,Kd.Sy);this.Zc.$(ea.a.ONb,Kd.Sy);this.Zc.$(ea.a.RNb,Kd.Sy);this.Zc.$(ea.a.s1a,Kd.Sy);this.hb.$(ea.a.MKa,Kd.eV);this.Zc.$(ea.a.PNb,Kd.Sy);this.Zc.$(ea.a.q1a,Kd.Sy);this.hb.$(ea.a.NKa,Kd.eV);this.Zc.$(ea.a.QNb,Kd.Sy);this.Zc.$(ea.a.r1a,Kd.Sy);this.Zc.$(ea.a.k0b,Kd.Sy);this.hb.$(ea.a.eLb,Kd.ef);this.Zc.$(ea.a.ctd,Kd.Sy);this.Zc.$(ea.a.dtd,Kd.Sy);this.Zc.$(ea.a.etd,
Kd.Sy);this.Zc.$(ea.a.ftd,Kd.Sy)}XSj(){this.hb.$(C.a.MLb,Pg.sTe);this.hb.$(ea.a.ZTe,Pg.sTe);this.hb.$(ea.a.JLb,Kd.eV);this.hb.$(ea.a.KLb,Kd.eV);this.hb.$(ea.a.Vqc,Kd.eV);this.hb.$(ea.a.Nod,Kd.eV);this.hb.$(ea.a.Sqc,Kd.eV);this.hb.$(ea.a.Tqc,Kd.eV);this.hb.$(ea.a.Uqc,Kd.eV);this.hb.$(ea.a.Rqc,Kd.eV);this.hb.$(ea.a.qpc,Object(H.a)(this,this.Qpd,"remapTableExecute"));this.hb.$(C.a.N8,Object(H.a)(this,this.Qpd,"remapTableExecute"));this.hb.$(C.a.uNb,Object(H.a)(this,this.Qpd,"remapTableExecute"));this.hb.$(C.a.insertTable,
Object(H.a)(this,this.Qpd,"remapTableExecute"));this.Zc.$(C.a.insertTable,Object(H.a)(this,this.oCi,"checkInsertTableRibbonEnabledBridge"));this.Zc.$(C.a.N8,Object(H.a)(this,this.bvb,"checkWholeTableLockEnabledBridge"));this.Zc.$(C.a.s_,Object(H.a)(this,this.bvb,"checkWholeTableLockEnabledBridge"));this.Zc.$(C.a.iT,Object(H.a)(this,this.bvb,"checkWholeTableLockEnabledBridge"));this.Zc.$(ea.a.bjh,Object(H.a)(this,this.bvb,"checkWholeTableLockEnabledBridge"));this.Zc.$(ea.a.w6,Object(H.a)(this,this.bvb,
"checkWholeTableLockEnabledBridge"));this.Zc.$(ea.a.EKa,Object(H.a)(this,this.bvb,"checkWholeTableLockEnabledBridge"));this.hb.$(C.a.s_,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(C.a.iT,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(C.a.D8a,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.Apc,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.zpc,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.ypc,
Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.w6,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.EKa,Object(H.a)(this,this.JRa,"checkSelectionBeforeExecute"));this.hb.$(ea.a.zUe,Kd.ef);this.hb.$(ea.a.AUe,Kd.ef);this.hb.$(ea.a.BUe,Kd.ef);this.hb.$(ea.a.CUe,Kd.ef);this.hb.$(ea.a.DUe,Kd.ef);this.hb.$(ea.a.EUe,Kd.ef);this.hb.$(ea.a.FUe,Kd.ef);this.hb.$(ea.a.GUe,Kd.ef);this.hb.$(ea.a.HUe,Kd.ef);this.hb.$(ea.a.nUe,Kd.ef);this.hb.$(ea.a.oUe,Kd.ef);this.hb.$(ea.a.pUe,
Kd.ef);this.hb.$(ea.a.qUe,Kd.ef);this.hb.$(ea.a.rUe,Kd.ef);this.hb.$(ea.a.sUe,Kd.ef);this.hb.$(ea.a.tUe,Kd.ef);this.hb.$(ea.a.uUe,Kd.ef);this.hb.$(ea.a.vUe,Kd.ef);this.hb.$(ea.a.wUe,Kd.ef);this.hb.$(ea.a.xUe,Kd.ef);this.hb.$(ea.a.yUe,Kd.ef);this.hb.$(ea.a.Lod,Kd.ef);this.hb.$(ea.a.Kod,Kd.ef);this.hb.$(ea.a.Jod,Kd.ef);this.hb.$(ea.a.Mod,Kd.ef)}sSj(){this.Zc.$(ea.a.lod,Kd.Sy);this.hb.$(ea.a.lod,Kd.ef);this.Zc.$(ea.a.Xme,Kd.J9k);this.hb.$(ea.a.IFa,Object(H.a)(this,this.$ld,"parseSmartArtParametersBridge"));
this.hb.$(ea.a.Z1b,Object(H.a)(this,this.$ld,"parseSmartArtParametersBridge"));this.hb.$(ea.a.$1b,Object(H.a)(this,this.$ld,"parseSmartArtParametersBridge"));this.hb.$(ea.a.oL,Object(H.a)(this,this.$ld,"parseSmartArtParametersBridge"));this.Zc.$(ea.a.Qnd,Kd.Sy);this.hb.$(ea.a.Qnd,Kd.ef);this.hb.$(ea.a.ysa,Object(H.a)(this,this.oBi,"changePictureStyleExecuteBridge"));this.hb.$(ea.a.GLb,Kd.ef);this.hb.$(ea.a.lLb,Kd.eV);this.hb.$(ea.a.nLb,Kd.eV);this.hb.$(ea.a.mLb,Kd.eV);this.hb.$(ea.a.sqc,Kd.eV)}rRj(){this.hb.$(ea.a.amh,
Pg.sTe);this.hb.$(ea.a.aqc,Kd.ef);this.hb.$(ea.a.uqc,Kd.ef);this.hb.$(ea.a.qqc,Kd.ef);this.hb.$(ea.a.Cqc,Kd.ef);this.hb.$(ea.a.Dqc,Kd.ef);this.hb.$(ea.a.Bqc,Kd.ef);this.hb.$(ea.a.Eqc,Kd.ef);this.hb.$(ea.a.Mqc,Kd.ef);this.hb.$(ea.a.tqc,Kd.ef);this.hb.$(ea.a.oqc,Kd.ef);this.hb.$(ea.a.iqc,Kd.ef);this.hb.$(ea.a.yqc,Kd.ef)}SRj(){this.hb.$(ea.a.Ond,Kd.ef);this.hb.$(ea.a.cod,Kd.ef);this.hb.$(ea.a.wqc,Object(H.a)(this,this.Ynd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.xqc,Object(H.a)(this,
this.Ynd,"queryListMarkerQueryDataExecuteBridge"));this.hb.$(ea.a.PLb,Kd.ef);this.hb.$(ea.a.OLb,Kd.ef);this.hb.$(ea.a.NLb,Kd.ef);this.hb.$(ea.a.Fod,Kd.ef);this.hb.$(ea.a.h0k,Kd.ef);this.hb.$(ea.a.Ty,Kd.jod);this.hb.$(ea.a.Wqc,Kd.jod);this.hb.$(ea.a.xod,Kd.jod);this.hb.$(ea.a.Vnd,Kd.jod);this.hb.$(ea.a.HLb,Object(H.a)(this,this.M9k,"remapRumTrackerExecuteQueryBridge"));this.hb.$(ea.a.jLb,Kd.ef);this.hb.$(ea.a.nod,Pg.dqc);this.hb.$(ea.a.bod,Kd.ef);this.hb.$(ea.a.rqc,Kd.ef);this.hb.$(ea.a.fLb,Kd.ef);
this.hb.$(ea.a.ALb,Kd.ef);this.hb.$(ea.a.ILb,Kd.ef);this.hb.$(ea.a.OUe,Pg.dqc);this.hb.$(ea.a.Hod,Kd.ef);this.hb.$(ea.a.God,Kd.ef);this.hb.$(ea.a.hUe,Kd.ef);this.hb.$(ea.a.r0a,Kd.ef);this.hb.$(ea.a.Rjb,Kd.ef);this.hb.$(ea.a.Sjb,Kd.ef);this.hb.$(ea.a.Qjb,Kd.ef);this.hb.$(ea.a.Pjb,Kd.ef);this.hb.$(ea.a.xLb,Kd.ef);this.hb.$(ea.a.ELb,Kd.ef);this.hb.$(ea.a.yLb,Kd.ef);this.hb.$(F.a.dLb,Pg.dqc);this.Zc.$(ea.a.JPe,Kd.Sy);this.hb.$(ea.a.xv,Kd.Tvd);this.hb.$(ea.a.YCa,Kd.Tvd);this.hb.$(ea.a.Ctb,Kd.Tvd);this.hb.$(ea.a.z0b,
Kd.Tvd);this.Zc.$(ea.a.k4f,Kd.aaj);this.hb.$(ea.a.yc,Kd.B_k);this.Zc.$(ea.a.hod,Kd.Sy);this.hb.$(ea.a.hod,Kd.ef);this.Zc.$(ea.a.CTa,Object(H.a)(this,this.Tw,"remapTextQueryEnabled"));this.hb.$(ea.a.VKa,Pg.dqc);this.hb.$(ea.a.eUe,Kd.ef);this.hb.$(ea.a.Kqc,Kd.ef);this.hb.$(ea.a.WTe,Kd.ef);this.hb.$(ea.a.XTe,Kd.ef);this.hb.$(ea.a.RLb,Kd.ef);this.hb.$(ea.a.xTe,Kd.ef);this.hb.$(C.a.Smd,Pg.oac);this.hb.$(C.a.cut,Object(H.a)(this,this.XPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.copy,Object(H.a)(this,
this.XPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.paste,Object(H.a)(this,this.XPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.u6,Object(H.a)(this,this.XPc,"cutCopyPasteExecuteBridge"));this.hb.$(C.a.openInClient,Object(H.a)(this,this.gOk,"openInPowerPointExecuteBridge"));this.hb.$(C.a.Xnd,Kd.ef);this.hb.$(ea.a.nqc,Kd.ef);this.hb.$(ea.a.Bpc,Object(H.a)(this,this.Oph,"remapUndoRedoExecute"));this.hb.$(ea.a.vpc,Object(H.a)(this,this.Oph,"remapUndoRedoExecute"));this.hb.$(ea.a.rKb,Object(H.a)(this,
this.Ppd,"remapCutCopyPasteExecute"));this.hb.$(ea.a.qKb,Object(H.a)(this,this.Ppd,"remapCutCopyPasteExecute"));this.hb.$(ea.a.DKa,Object(H.a)(this,this.Ppd,"remapCutCopyPasteExecute"));this.hb.$(ea.a.mjb,Object(H.a)(this,this.Ppd,"remapCutCopyPasteExecute"));this.la.ka("IsPasteTextFloatieEnabled")&&(this.hb.$(ea.a.mmd,this.CWe),this.hb.$(ea.a.omd,this.CWe),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.hb.$(ea.a.nmd,this.CWe));this.Zc.$(ea.a.Bpc,Object(H.a)(this,this.Nph,"remapUndoRedoEnabled"));
this.Zc.$(ea.a.vpc,Object(H.a)(this,this.Nph,"remapUndoRedoEnabled"));this.Zc.$(ea.a.rKb,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));this.Zc.$(ea.a.qKb,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));this.Zc.$(ea.a.DKa,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));this.Zc.$(ea.a.mjb,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));this.Zc.$(C.a.cut,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));this.Zc.$(C.a.paste,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));
this.Zc.$(C.a.u6,Object(H.a)(this,this.fkb,"remapCutCopyPasteEnabled"));this.hb.$(C.a.e2,Kd.mFf);this.hb.$(C.a.vr,Kd.mFf);this.hb.$(C.a.kN,Object(H.a)(this,this.xxg,"listsExecuteBridge"));this.hb.$(C.a.JP,Object(H.a)(this,this.xxg,"listsExecuteBridge"));this.hb.$(ea.a.W1a,Kd.MAl);this.hb.$(ea.a.Bjb,Kd.eV);this.hb.$(ea.a.Cjb,Kd.eV);this.hb.$(ea.a.BLb,Kd.ef);this.hb.$(ea.a.gLb,Kd.ef);this.hb.$(ea.a.hqc,Kd.ef);this.hb.$(ea.a.zLb,Kd.ef);this.la.ntb&&this.hb.$(ea.a.$pc,Kd.ef);this.hb.$(ea.a.Jqc,Kd.ef);
this.la.$me&&this.hb.$(ea.a.kqc,Kd.ef);this.la.L3d&&this.hb.$(ea.a.pqc,Kd.ef);this.la.w3&&this.hb.$(ea.a.Djb,Kd.ef)}zRj(){this.Zc.$(ea.a.Kmg,Object(H.a)(this,this.$4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.DZd,Object(H.a)(this,this.$4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.yZd,Object(H.a)(this,this.$4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.Mmg,Object(H.a)(this,this.$4b,"doPresentationCheckEnableRemap"));this.Zc.$(ea.a.Rmg,Object(H.a)(this,this.$4b,"doPresentationCheckEnableRemap"))}$4b(a){const b=
new Wk;this.Eb&&1===this.Eb.al&&!Kd.foe(a)?b.yL=!1:(b.zD=!0,b.hm=ea.a.B9a);return b}Fhj(){const a=new EM;a.A0b=Kd.WUk;a.cWd=Kd.XUk;a.NRe=Object(H.a)(this,this.uVk,"powerPointPreExecCommand");a.iRe=null;return a}uVk(a,b){var c=this.pa.Ud();c=1===c.length&&c[0].xd&&this.pa.vH()&&!c[0].bR;switch(a.hm){case C.a.font:case C.a.y6:case C.a.vLa:case C.a.bold:case C.a.setItalic:case C.a.underline:case C.a.strikethrough:case C.a.vr:case C.a.e2:case C.a.Hja:case C.a.qH:case C.a.fI:case C.a.HKa:case C.a.W0a:case C.a.QC:case C.a.Ry:case C.a.kN:case C.a.JP:case C.a.Dja:case C.a.$la:case C.a.gpa:case C.a.BEa:case ea.a.zoa:case ea.a.M1:case ea.a.L1:case ea.a.K1:case C.a.ODa:case C.a.ola:case C.a.Nza:case C.a.Oza:case C.a.Pza:case C.a.EMa:case C.a.FMa:case C.a.iT:case C.a.s_:case ea.a.w6:case ea.a.EKa:case ea.a.J1a:case ea.a.XLa:case ea.a.upa:case ea.a.YLa:case ea.a.Wvd:case ea.a.Vvd:b||
(b={}),b[Ii.a.ZIc]=!(this.pa.rWa()||c),b[Ii.a.jyf]=!!this.pa.$ka()}return null}pxg(a,b,c){const f=new ih;b=b.MenuItemId;f.vd=this.GJe(b,a);b&&ya.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}GJe(a,b){a=a?parseInt(a):-1;switch(b){case ea.a.IOb:case C.a.kN:case ea.a.wqc:case ea.a.l0a:return this.xGb.m9b(a);case ea.a.qOb:case C.a.JP:case ea.a.xqc:case ea.a.m0a:return this.xGb.vYc(a);default:return 18}}A$i(a,b){a=new ih;a.vd=b.CommandValueId;return a}Ynd(a,b){const c=
new ih,f=new Xv;f.p0a=new gi.a;f.menuItemId=this.GJe(b.MenuItemId,a);c.vd=f;c.xX=!0;return c}sya(a,b){a=new ih;const c={};c.queryResult=new gi.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.vd=c;a.xX=!0;return a}lyd(a,b){a=new ih;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.vd=c;return a}oBi(a,b){a=new ih;a.vd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}Fjb(a){const b=new ih,c={},f=new gi.a;switch(a){case ea.a.GTe:f.If(this.YXa.isEnabled(Te.a.DFa));break;case ea.a.ATe:f.If(this.YXa.isEnabled(Te.a.Bua));break;case ea.a.DTe:f.If(this.YXa.isEnabled(Te.a.w9));break;case ea.a.BTe:f.If(this.YXa.isEnabled(Te.a.v9));break;case ea.a.ETe:f.If(this.YXa.isEnabled(Te.a.lA));break;case ea.a.FTe:f.If(this.YXa.isEnabled(Te.a.bD));break;case ea.a.CTe:f.If(this.YXa.isEnabled(Te.a.aD));break;case ea.a.Plh:f.If(this.YXa.isEnabled(Te.a.vla))}c.queryResult=
f;b.vd=c;b.xX=!0;return b}xxg(a,b,c){const f=new ih;f.vd=new J.DictionaryPropertySet;b=b.MenuItemId;this.LTl(f.vd,a,this.GJe(b,a));b&&ya.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}oCi(){return Object.assign(new Wk,{vd:new gi.a,yL:!!this.Zhk.Ba})}bvb(){const a=new Wk,b=this.pa.zn();if(!b)return a;this.zc.Kne(b)&&(a.zD=!1,a.yL=!1,a.hm=zf.ActionManager.G5b);return a}LTl(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===C.a.kN?(l=f=1,this.xGb.k1c(c)&&(b=this.xGb.NWa.ga(c),
a.setValue(Ya.a.ej,[b.o1b]),a.setValue(Ya.a.font,b.lub))):b===C.a.JP&&(f=0,l=1,a.setValue(Ya.a.RWa,1),a.setValue(va.a.autonumberBulletType,8),this.xGb.l1c(c)&&(b=this.xGb.Oid.ga(c),a.setValue(va.a.autonumberBulletType,b.jXd),a.setValue(Ya.a.ej,[65533,b.S8g,na.a.charCodeAt(b.Y8g,0)])));a.setValue(we.a.wE,f);a.setValue(we.a.Jea,l)}Kyd(a){let b;if(this.gDh()||this.pa.$ka()){if(({Ge:b}=Kd.Eyd(a,this.pa.uz())).returnValue)return{returnValue:!0,DY:b}}else if(this.Axl()&&({Ge:b}=Kd.vNh(a)).returnValue)return{returnValue:!0,
DY:b};return{returnValue:!1,DY:0}}S9e(a){let b;b=0;a===ea.a.Bpc?b=ea.a.$_a:a===ea.a.vpc&&(b=ea.a.Z_a);return{returnValue:!!b,DY:b}}R9e(a){let b;b=0;this.gDh()?a===ea.a.rKb?b=C.a.cut:a===ea.a.qKb?b=C.a.copy:a===ea.a.DKa?b=C.a.paste:a===ea.a.mjb&&(b=C.a.u6):(a===ea.a.rKb&&(b=ea.a.cwb),a===ea.a.qKb?b=ea.a.q3b:a===ea.a.DKa?b=ea.a.Coa:w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")&&a===ea.a.mjb&&(b=ea.a.pasteAsPlainText));return{returnValue:!!b,DY:b}}JNh(a){switch(a){case C.a.N8:return a=ea.a.sKb,
{returnValue:!0,Ge:a};case C.a.uNb:return a=ea.a.yRe,{returnValue:!0,Ge:a};case C.a.insertTable:return a=ea.a.fjh,{returnValue:!0,Ge:a}}a=zf.ActionManager.k6;return{returnValue:!1,Ge:a}}Kt(a){let b=new ih;if(({result:b}=this.PAb(a)).returnValue)return b;({DY:a}=this.Kyd(a)).returnValue&&(b.zD=!0,b.hm=a);return b}ACh(a){switch(a){case ea.a.S_a:case ea.a.AKb:case ea.a.DKb:case ea.a.kjb:case ea.a.ojb:case ea.a.ljb:if(this.pa.Lla()||this.pa.dM())return Object.assign(new Wk,{zD:!1,yL:!1});break;case ea.a.sLb:case ea.a.rLb:case ea.a.zKb:case ea.a.CKb:case ea.a.R_a:if(this.pa.Lla())return Object.assign(new Wk,
{zD:!1,yL:!1});break;case ea.a.CKa:case ea.a.Goa:case ea.a.hnd:case ea.a.hya:case ea.a.jya:case ea.a.lya:case ea.a.T_a:case ea.a.BKb:case ea.a.tKb:if(this.pa.dM())return Object.assign(new Wk,{zD:!1,yL:!1});break;case ea.a.EKb:case ea.a.xpc:if(this.pa.dM()){var b=this.pa.Pa.nb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(sb.a.listLevel,0),a===ea.a.EKb&&!b||mp.a.vqg(c.node)))return Object.assign(new Wk,{zD:!1,yL:!1})}}return null}$s(a){let b;new Wk;if(({result:b}=this.Dne(a)).returnValue)return this.Etd(b,
a);b=this.ACh(a);if(!b){let c;b=new Wk;({DY:c}=this.Kyd(a)).returnValue&&(b.zD=!0,b.hm=c)}return this.Etd(b,a)}Crc(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Wk,{Vxa:a,hm:ea.a.vZe,vd:c})}M9k(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new ih,{hm:ea.a.vZe,vd:c,xX:!0})}ZE(a){let b=new ih;if(({result:b}=this.PAb(a)).returnValue)return b;({DY:a}=this.Kyd(a)).returnValue?(b.zD=!0,b.hm=a):(b.vd=new gi.a,b.xX=!0);return b}Tw(a){let b;new Wk;
if(({result:b}=this.Dne(a)).returnValue)return this.Etd(b,a);b=this.ACh(a);if(!b){let c;b=new Wk;({DY:c}=this.Kyd(a)).returnValue?(b.zD=!0,b.hm=c):b.vd=new gi.a}return this.Etd(b,a)}Oph(a){const b=new ih;({DY:a}=this.S9e(a)).returnValue&&(b.zD=!0,b.hm=a);return b}Nph(a){const b=new Wk;({DY:a}=this.S9e(a)).returnValue&&(b.zD=!0,b.hm=a);return b}K9k(){const a=new Wk;a.zD=!0;a.hm=ea.a.sRe;return a}L9k(){const a=new ih;a.zD=!0;a.hm=ea.a.sRe;return a}qPl(a){let b;b=0;const c=this.wY.zH;if(c===ea.a.Coa||
c===ea.a.pasteAsPlainText||c===ea.a.fya)a==ea.a.mmd?b=ea.a.nrc:a==ea.a.omd?b=ea.a.lrc:a==ea.a.nmd&&(b=ea.a.mrc);return{returnValue:!!b,DY:b}}Ppd(a){let b=new ih;if(({result:b}=this.PAb(a)).returnValue)return b;({DY:a}=this.R9e(a)).returnValue&&(b.zD=!0,b.hm=a);return b}Qpd(a){let b=new ih;if(({result:b}=this.PAb(a)).returnValue)return b;({Ge:a}=this.JNh(a)).returnValue&&(b.zD=!0,b.hm=a);return b}JRa(a,b){let c=new ih;if(({result:c}=this.PAb(a)).returnValue)return c;if(this.pa.Js())return c.zD=!0,
c.hm=zf.ActionManager.G5b,c;c.hm=a;c.vd=b;return c}fkb(a){let b=new Wk;if(!this.Sb.rj())return b.yL=!1,b;if(({result:b}=this.Dne(a)).returnValue)return b;({DY:a}=this.R9e(a)).returnValue&&(b.zD=!0,b.hm=a);return b}gDh(){return this.pa.uz()}Axl(){return this.pa.vH()}$ld(a,b){const c=new ih;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new TR.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==ea.a.IFa&&a!==ea.a.$1b||ya.a.J(512493024,801,50,(a===
ea.a.IFa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.vd=b;return c}R4c(a,b,c){return this.Kt(a,b,c)}XPc(a){let b=new ih;if(({result:b}=this.PAb(a)).returnValue)return b;b.Fq=this.la.t1c||this.la.Rpg&&this.la.EZj&&z.a.Io;return b}gOk(a,b,c){a=new ih;ya.a.J(512493023,801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}PAb(a){let b;b=new ih;return this.Qng(a)?(b.zD=!1,b.yL=!1,b.hm=zf.ActionManager.G5b,{returnValue:!0,result:b}):
{returnValue:!1,result:b}}Dne(a){let b;b=new Wk;return this.Qng(a)?(b.zD=!1,b.yL=!1,b.hm=zf.ActionManager.G5b,{returnValue:!0,result:b}):{returnValue:!1,result:b}}Qng(a){return this.KVj(a)}KVj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&Kd.Qwi.contains(a)?this.pa.J9()?!0:!1:!1}Etd(a,b){if(qd.a("SetMappedCommandActionData")){let c=0;if(({Ge:c}=Kd.Eyd(b,this.pa.uz())).returnValue||({Ge:c}=Kd.vNh(b)).returnValue||({DY:c}=this.S9e(b)).returnValue||({DY:c}=this.R9e(b)).returnValue||
({Ge:c}=this.JNh(b)).returnValue)a.vd||(a.vd={}),a.vd.MappedCommand=c}return a}static foe(a){const b=Kd.zwj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static zwj(){Kd.Ikc||(Kd.Ikc=[ea.a.Bpc,ea.a.vpc,ea.a.DKa,ea.a.kKa,ea.a.lKa,ea.a.qKb,ea.a.deleteObject,ea.a.S5d,ea.a.B9a,ea.a.boa,ea.a.z$b,ea.a.q$e,ea.a.BQ,ea.a.print,ea.a.QXk,ea.a.kSe,ea.a.mSe,ea.a.wpc,ea.a.wRe,ea.a.xRe,ea.a.downloadACopy,ea.a.g5b,ea.a.h5b,ea.a.i5b,ea.a.xv,ea.a.$nd,ea.a.YCa,ea.a.Ztd,ea.a.Ytd,ea.a.kPe,ea.a.nKb,ea.a.QLb,
ea.a.tya,ea.a.Tjb,ea.a.Sj,ea.a.Moa,ea.a.kk,ea.a.Hlb,ea.a.Ptc,ea.a.Ilb,ea.a.vpa,ea.a.BPb,ea.a.xza,ea.a.VMa,ea.a.r0a,ea.a.vjb,ea.a.X_a,ea.a.Lpc,ea.a.yLb,ea.a.Y_a,ea.a.xLb,ea.a.ELb,ea.a.Iod,ea.a.hjb,ea.a.ijb,ea.a.DQb,ea.a.Rjb,ea.a.EQb,ea.a.Sjb,ea.a.CQb,ea.a.Qjb,ea.a.BQb,ea.a.Pjb,ea.a.AQb,ea.a.ALb,ea.a.zga,ea.a.wrc,ea.a.RLb,ea.a.Saf,ea.a.Lie,F.a.s8,F.a.Nnd,ea.a.openInClient,F.a.Puc,F.a.GJb,F.a.UKb,F.a.lPb,F.a.mPb,ea.a.eMa,ea.a.Uga,ea.a.uld,ea.a.jLb,ea.a.Avc,ea.a.Bvc,C.a.Smd,ea.a.STk,ea.a.i6,ea.a.k4f,
ea.a.BQ,ea.a.TI,ea.a.rqd,ea.a.VWe,ea.a.Nhd,ea.a.Mhd,ea.a.waf,ea.a.x7a,ea.a.immersiveReader,C.a.copy,C.a.paste,ea.a.cwb,ea.a.q3b,ea.a.Coa,ea.a.$_a,ea.a.Z_a,ea.a.Dud,F.a.Jda,F.a.renameFile,F.a.aOc,F.a.f4e,ea.a.Kpc,ea.a.aSe,ea.a.Uoc,ea.a.Mpc,ea.a.xrc,ea.a.q2a,F.a.y8e,F.a.we]);Kd.Ikc.push(ea.a.Jtc);if(w.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=[ea.a.mKb,ea.a.aod,ea.a.E0c];let b;(b=Kd.Ikc).push.apply(b,a)}return Kd.Ikc}static XUk(a,b){const c=a.Vxa;let f=!0,l=null;if(null===a||
null===a.vd)return!1;a=a.vd;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.nba)switch(c){case ea.a.tya:case ea.a.JLb:case ea.a.KLb:case ea.a.Vqc:case ea.a.Nod:case ea.a.Sqc:case ea.a.Tqc:case ea.a.Uqc:case ea.a.Rqc:case ea.a.lLb:case ea.a.nLb:case ea.a.mLb:case ea.a.sqc:case ea.a.Bjb:case ea.a.Cjb:case ea.a.MKa:case ea.a.NKa:a=parseFloat(l.nba);0<a||c===ea.a.tya||c===ea.a.lLb||c===ea.a.nLb||c===ea.a.mLb||c===ea.a.sqc||c===ea.a.Bjb||c===ea.a.Cjb||c===ea.a.MKa||c===ea.a.NKa||0<=a&&(c===
ea.a.Sqc||c===ea.a.Tqc||c===ea.a.Uqc||c===ea.a.Rqc)?(b[un.Text]=l.nba,b[un.Number]=a):(b[un.Text]="",b[un.Number]=Number.NaN);b[un.UnitType]=c===ea.a.tya||c===ea.a.MKa||c===ea.a.NKa?8:3;break;default:f=!1}return f}static WUk(a,b){if(Pg.A0b(a,b))return!0;if(!a||!a.vd)return!1;var c=null;Object(Sa.a)(gi.a,a.vd)?c=a.vd:Object(Sa.a)(Xv,a.vd)?(c=a.vd,b.SourceControlId=c.sV,c=c.p0a):Object(Sa.a)(Object,a.vd)&&(a=a.vd,a.queryResult&&(c=a.queryResult));c&&(b[Ih.a.On]=c.Qxd?c.Qxd.value:!1,c.SNc&&(b[zo.a.IsFreeForm]=
c.SNc.value),c.CEa&&(b[vm.a.InnerHTML]=c.CEa),c.Pxb&&(b[vm.a.Alt]=c.Pxb),c.KUc&&(b[vm.a.On]=c.KUc.value),void 0!==c.C_&&null!==c.C_&&(b[zo.a.Value]=c.C_),void 0!==c.TLc&&null!==c.TLc&&(b[mE.a.LabelText]=c.TLc),c.j4&&(b[vm.a.GalleryButtonProps]=c.j4),c.XHf&&(b[mE.a.Image32by32Class]=c.XHf),void 0!==c.C$a&&null!==c.C$a&&(b[wm.a.labelText]=c.C$a));return!0}static Sy(){const a=new Wk;a.vd=new gi.a;return a}static ef(){const a=new ih;a.vd=new gi.a;a.xX=!0;return a}static oxg(a,b,c){ya.a.J(512493021,820,
50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new ih;a.vd=b;return a}static J6e(a,b){a=new ih;a.vd=b.Color;return a}static mFf(a,b){a=new ih;a.vd=b.Color;a.Fq=!0;return a}static MAl(){const a=new ih;a.vd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static jod(a,b){a=new ih;const c=new Xv;c.p0a=new gi.a;c.sV=b.SourceControlId;a.vd=c;a.xX=!0;return a}static Tvd(a,b){a=new ih;a.vd=b.SourceControlId;return a}static eV(){const a=new ih,b={},c=new gi.a;b.queryResult=c;a.vd=b;a.Hqe=!0;
return a}static N1a(a){const b=new Wk;switch(a){case ea.a.pEf:b.hm=ea.a.JCa;break;case ea.a.qEf:b.hm=ea.a.oja;break;case ea.a.$Kc:b.hm=ea.a.bRa;break;case ea.a.XKc:b.hm=ea.a.K7a;break;case ea.a.ZKc:b.hm=ea.a.L7a;break;case ea.a.YKc:b.hm=ea.a.pja;break;case ea.a.bWd:b.hm=ea.a.Ctb;break;case ea.a.SVd:b.hm=ea.a.z0b}return b}static aaj(){const a=new Wk;a.hm=ea.a.Gta;return a}static B_k(){const a=new ih,b={},c=new gi.a;c.If(!1);b.queryResult=c;a.vd=b;a.xX=!0;return a}static Eyd(a,b){switch(a){case ea.a.pKb:return a=
C.a.bold,{returnValue:!0,Ge:a};case ea.a.hya:return a=C.a.Dja,{returnValue:!0,Ge:a};case ea.a.R_a:return a=C.a.font,{returnValue:!0,Ge:a};case ea.a.zKb:return a=C.a.y6,{returnValue:!0,Ge:a};case ea.a.CKb:return a=C.a.vLa,{returnValue:!0,Ge:a};case ea.a.iya:return a=C.a.vr,{returnValue:!0,Ge:a};case ea.a.uKb:return a=C.a.e2,{returnValue:!0,Ge:a};case ea.a.ppc:return a=C.a.Hja,{returnValue:!0,Ge:a};case ea.a.vKb:return a=C.a.setItalic,{returnValue:!0,Ge:a};case ea.a.jya:return a=C.a.$la,{returnValue:!0,
Ge:a};case ea.a.xKb:return a=ea.a.JPe,{returnValue:!0,Ge:a};case ea.a.njb:return a=C.a.kKb,{returnValue:!0,Ge:a};case ea.a.S_a:return a=C.a.Xq,{returnValue:!0,Ge:a};case ea.a.AKb:return a=C.a.HKa,{returnValue:!0,Ge:a};case ea.a.DKb:return a=C.a.W0a,{returnValue:!0,Ge:a};case ea.a.ojb:return a=C.a.fI,{returnValue:!0,Ge:a};case ea.a.kjb:return a=C.a.qH,{returnValue:!0,Ge:a};case ea.a.FKb:return a=C.a.strikethrough,{returnValue:!0,Ge:a};case ea.a.spc:return a=ea.a.lgh,{returnValue:!0,Ge:a};case ea.a.yKb:return a=
ea.a.xKa,{returnValue:!0,Ge:a};case ea.a.lya:return a=C.a.gpa,{returnValue:!0,Ge:a};case ea.a.T_a:return a=C.a.BEa,{returnValue:!0,Ge:a};case ea.a.IKb:return a=C.a.underline,{returnValue:!0,Ge:a};case ea.a.BKb:return a=C.a.Ry,{returnValue:!0,Ge:a};case ea.a.tKb:return a=C.a.QC,{returnValue:!0,Ge:a};case ea.a.EKb:return a=C.a.Ry,{returnValue:!0,Ge:a};case ea.a.xpc:return a=C.a.QC,{returnValue:!0,Ge:a};case ea.a.Goa:return a=C.a.kN,{returnValue:!0,Ge:a};case ea.a.CKa:return a=C.a.JP,{returnValue:!0,
Ge:a};case ea.a.kya:return a=ea.a.zoa,{returnValue:!0,Ge:a};case ea.a.ljb:return a=ea.a.hte,{returnValue:!0,Ge:a};case ea.a.CTa:return a=C.a.qUc,{returnValue:!0,Ge:a};case ea.a.GKb:return a=C.a.subscript,{returnValue:!0,Ge:a};case ea.a.HKb:return a=C.a.superscript,{returnValue:!0,Ge:a}}return b?Kd.UOl(a):Kd.uNh(a)}static vNh(a){switch(a){case ea.a.pKb:return a=ea.a.G1a,{returnValue:!0,Ge:a};case ea.a.hya:return a=ea.a.JOb,{returnValue:!0,Ge:a};case ea.a.R_a:return a=ea.a.Blb,{returnValue:!0,Ge:a};
case ea.a.S_a:return a=ea.a.Clb,{returnValue:!0,Ge:a};case ea.a.vKb:return a=ea.a.H1a,{returnValue:!0,Ge:a};case ea.a.jya:return a=ea.a.Dlb,{returnValue:!0,Ge:a};case ea.a.lya:return a=ea.a.Qlb,{returnValue:!0,Ge:a};case ea.a.T_a:return a=ea.a.pOb,{returnValue:!0,Ge:a};case ea.a.IKb:return a=ea.a.I1a,{returnValue:!0,Ge:a};case ea.a.Goa:return a=ea.a.IOb,{returnValue:!0,Ge:a};case ea.a.npc:return a=ea.a.buc,{returnValue:!0,Ge:a};case ea.a.opc:return a=ea.a.xud,{returnValue:!0,Ge:a};case ea.a.iya:return a=
ea.a.oOb,{returnValue:!0,Ge:a};case ea.a.uKb:return a=ea.a.Nlb,{returnValue:!0,Ge:a};case ea.a.ppc:return a=ea.a.KOb,{returnValue:!0,Ge:a};case ea.a.CKa:return a=ea.a.qOb,{returnValue:!0,Ge:a};case ea.a.njb:return a=ea.a.m2e,{returnValue:!0,Ge:a};case ea.a.ojb:return a=ea.a.LOb,{returnValue:!0,Ge:a};case ea.a.kjb:return a=ea.a.cuc,{returnValue:!0,Ge:a};case ea.a.FKb:return a=ea.a.rOb,{returnValue:!0,Ge:a};case ea.a.M1:return a=ea.a.Vtd,{returnValue:!0,Ge:a};case ea.a.L1:return a=ea.a.Utd,{returnValue:!0,
Ge:a};case ea.a.K1:return a=ea.a.Ttd,{returnValue:!0,Ge:a};case ea.a.spc:case ea.a.xKb:return Kd.Eyd(a,!0);case ea.a.yKb:return Kd.Eyd(a,!0);case ea.a.kya:return a=ea.a.Std,{returnValue:!0,Ge:a};case ea.a.ljb:return a=ea.a.k2e,{returnValue:!0,Ge:a};case ea.a.GKb:return a=ea.a.fuc,{returnValue:!0,Ge:a};case ea.a.HKb:return a=ea.a.guc,{returnValue:!0,Ge:a}}return Kd.uNh(a)}static UOl(a){switch(a){case ea.a.pLb:return a=C.a.bqc,{returnValue:!0,Ge:a};case ea.a.OKa:return a=C.a.eqc,{returnValue:!0,Ge:a};
case ea.a.tLb:return a=C.a.lqc,{returnValue:!0,Ge:a};case ea.a.sLb:return a=F.a.s8,{returnValue:!0,Ge:a};case ea.a.rLb:return a=F.a.s8,{returnValue:!0,Ge:a};case ea.a.Hjb:return a=C.a.Tnd,{returnValue:!0,Ge:a};case ea.a.Ijb:return a=C.a.fqc,{returnValue:!0,Ge:a};case ea.a.PKa:return a=C.a.mqc,{returnValue:!0,Ge:a};case ea.a.RKa:return a=C.a.zqc,{returnValue:!0,Ge:a};case ea.a.Jjb:return a=C.a.gqc,{returnValue:!0,Ge:a};case ea.a.UKa:return a=ea.a.PLb,{returnValue:!0,Ge:a};case ea.a.TKa:return a=ea.a.OLb,
{returnValue:!0,Ge:a};case ea.a.SKa:return a=ea.a.NLb,{returnValue:!0,Ge:a};case ea.a.wLb:return a=C.a.Xqc,{returnValue:!0,Ge:a};case ea.a.qLb:return a=ea.a.Ond,{returnValue:!0,Ge:a};case ea.a.uLb:return a=ea.a.cod,{returnValue:!0,Ge:a};case ea.a.QKa:return a=ea.a.wqc,{returnValue:!0,Ge:a};case ea.a.Kjb:return a=ea.a.xqc,{returnValue:!0,Ge:a};case ea.a.vLb:return a=C.a.Nqc,{returnValue:!0,Ge:a};case ea.a.rya:return a=ea.a.k0a,{returnValue:!0,Ge:a};case ea.a.n0a:return a=C.a.Pqc,{returnValue:!0,Ge:a};
case ea.a.o0a:return a=C.a.Qqc,{returnValue:!0,Ge:a}}a=zf.ActionManager.k6;return{returnValue:!1,Ge:a}}static uNh(a){switch(a){case ea.a.pLb:return a=ea.a.Fqc,{returnValue:!0,Ge:a};case ea.a.OKa:return a=ea.a.ood,{returnValue:!0,Ge:a};case ea.a.tLb:return a=ea.a.Gqc,{returnValue:!0,Ge:a};case ea.a.Hjb:return a=ea.a.rod,{returnValue:!0,Ge:a};case ea.a.Ijb:return a=ea.a.sod,{returnValue:!0,Ge:a};case ea.a.PKa:return a=ea.a.uod,{returnValue:!0,Ge:a};case ea.a.RKa:return a=ea.a.wod,{returnValue:!0,Ge:a};
case ea.a.Jjb:return a=ea.a.tod,{returnValue:!0,Ge:a};case ea.a.UKa:return a=ea.a.Cod,{returnValue:!0,Ge:a};case ea.a.TKa:return a=ea.a.Bod,{returnValue:!0,Ge:a};case ea.a.SKa:return a=ea.a.Aod,{returnValue:!0,Ge:a};case ea.a.wLb:return a=ea.a.Iqc,{returnValue:!0,Ge:a};case ea.a.qLb:return a=ea.a.Njb,{returnValue:!0,Ge:a};case ea.a.sLb:return a=ea.a.qod,{returnValue:!0,Ge:a};case ea.a.rLb:return a=ea.a.pod,{returnValue:!0,Ge:a};case ea.a.uLb:return a=ea.a.Ojb,{returnValue:!0,Ge:a};case ea.a.QKa:return a=
ea.a.l0a,{returnValue:!0,Ge:a};case ea.a.Kjb:return a=ea.a.m0a,{returnValue:!0,Ge:a};case ea.a.vLb:return a=ea.a.Hqc,{returnValue:!0,Ge:a};case ea.a.rya:return a=ea.a.vod,{returnValue:!0,Ge:a};case ea.a.n0a:return a=ea.a.yod,{returnValue:!0,Ge:a};case ea.a.o0a:return a=ea.a.zod,{returnValue:!0,Ge:a}}a=zf.ActionManager.k6;return{returnValue:!1,Ge:a}}static J9k(a){const b=new Wk;switch(a){case ea.a.Xme:b.hm=ea.a.IFa}return b}static gxg(a,b){a=new ih;if(!b)throw Error.argumentNull();a.vd=Kd.J$f(b.MenuItemId);
return a}static Tlh(a,b){a=new ih;const c={},f=new gi.a;f.If(!1);c.queryResult=f;c.MenuItemId=Kd.J$f(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.vd=c;a.xX=!0;a.Gqe=!0;return a}static J$f(a){return parseFloat(a)}}Kd.Ikc=null;Kd.Qwi=(Cf=new Oa.a,Cf.add(C.a.cut),Cf.add(C.a.paste),Cf.add(C.a.u6),Cf.add(C.a.N8),Cf.add(C.a.e2),Cf.add(C.a.Y_d),Cf.add(C.a.Hja),Cf.add(C.a.y6),Cf.add(C.a.vLa),Cf.add(C.a.HKa),Cf.add(C.a.W0a),Cf.add(ea.a.pLb),Cf.add(ea.a.tLb),Cf.add(ea.a.wLb),Cf.add(ea.a.OKa),Cf.add(ea.a.PKa),
Cf.add(ea.a.RKa),Cf.add(ea.a.Jjb),Cf.add(ea.a.UKa),Cf.add(ea.a.TKa),Cf.add(ea.a.SKa),Cf.add(ea.a.Hjb),Cf.add(ea.a.Ijb),Cf.add(ea.a.qLb),Cf.add(ea.a.uLb),Cf.add(ea.a.QKa),Cf.add(ea.a.Kjb),Cf.add(ea.a.sLb),Cf.add(ea.a.rLb),Cf.add(ea.a.vLb),Cf.add(ea.a.rya),Cf.add(ea.a.n0a),Cf.add(ea.a.o0a),Cf.add(ea.a.bmh),Cf.add(ea.a.dmh),Cf.add(ea.a.cmh),Cf.add(ea.a.YTe),Cf.add(ea.a.iod),Cf.add(ea.a.pKb),Cf.add(ea.a.vKb),Cf.add(ea.a.IKb),Cf.add(ea.a.hya),Cf.add(ea.a.jya),Cf.add(ea.a.lya),Cf.add(ea.a.T_a),Cf.add(ea.a.uKb),
Cf.add(ea.a.ppc),Cf.add(ea.a.R_a),Cf.add(ea.a.zKb),Cf.add(ea.a.CKb),Cf.add(ea.a.S_a),Cf.add(ea.a.AKb),Cf.add(ea.a.DKb),Cf.add(ea.a.ojb),Cf.add(ea.a.kjb),Cf.add(ea.a.M1),Cf.add(ea.a.L1),Cf.add(ea.a.K1),Cf.add(ea.a.FKb),Cf.add(ea.a.xKb),Cf.add(ea.a.njb),Cf.add(ea.a.spc),Cf.add(ea.a.yKb),Cf.add(ea.a.tpc),Cf.add(ea.a.upc),Cf.add(ea.a.Goa),Cf.add(ea.a.CKa),Cf.add(ea.a.IOb),Cf.add(ea.a.Nlb),Cf.add(ea.a.KOb),Cf.add(ea.a.qOb),Cf.add(ea.a.npc),Cf.add(ea.a.opc),Cf.add(ea.a.iya),Cf.add(ea.a.tKb),Cf.add(ea.a.BKb),
Cf.add(ea.a.insertHyperlink),Cf.add(ea.a.kya),Cf.add(ea.a.ljb),Cf.add(ea.a.GKb),Cf.add(ea.a.HKb),Cf.add(ea.a.rKb),Cf.add(ea.a.DKa),Cf.add(ea.a.mjb),Cf.add(ea.a.sKb),Cf.add(ea.a.$md),Cf.add(ea.a.qpc),Cf.add(ea.a.Apc),Cf.add(ea.a.zpc),Cf.add(ea.a.ypc),Cf);Object(m.a)(Kd,"CuiActionBridge",Pg,[]);class qE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Xb(a){this.K=a;this.K.register(220,"Box4.ISelectionContextMenuProvider").na().oa(()=>new mq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").GBb;
z.a.ik&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").jza);this.K.register(Vz,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").na().oa(()=>new Vz(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Ia("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(221,"PowerPointWebEditor.ICUIManager").na().oa(()=>new DM(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),
a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(Kd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").na().oa(()=>new Kd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),
a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager"),w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):null));w.AFrameworkApplication.fa.ka("StatusBarPRIEnabled")||(this.K.register(98,"PowerPointWebEditor.IStatusBarUserHelper").na().oa(()=>new PR.a(a.resolve("PowerPointWebEditor.IApplicationSettings"))),
a.register(99,"PowerPointWebEditor.IStatusBarUser").na().oa(()=>new OR.a(a.resolve("PowerPointWebEditor.IStatusBarPane").xa,a.resolve("Box4.Graph.IGraphInstance").zd(7),a.rb("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),!1,a.resolve("Common.IAppSettingsManager").getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RenderStatusBarIndependentOfFullAppSettings",
!1))));a.register(qx,"CommandUI.ReactRibbonRoot").na().oa(()=>new qx($r.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("Box4.IGeneralCuiUser")));a.register(222,"PowerPointWebEditor.IContextMenuUser").na().oa(()=>new AM(a.resolve("Box4.IContextMenuController"),Object(sa.a)(Vz,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(223,"Box4.IBox4BridgeCommandUi").na().oa(()=>new BM(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),
a.resolve("Common.IRibbonExternal")));this.K.register(224,"PowerPointWebEditor.IContextMenuHelper").na().oa(()=>new zM(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(jE,"Box4.UI.EditorServiceProofingContextMenuCreator").na().oa(()=>new jE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.rb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").qk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){Jg.a.instance.$b("PPTWebEditorUIPackageInit",
(new Date).getTime());this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").Csi(this.K.resolve("Box4.IBox4BridgeCommandUi"));this.K.resolve("PowerPointWebEditor.View.IViewEventSource").R0k()}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();
this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){n.a.instance.Ac(new qE)}}Object(m.a)(qE,"PPTWebEditorUIPackage",null,[2,3]);class FM{constructor(a){this.GYh="FontPicker";this.OId=null;this.MNa=a;this.tBc=this.MNa.C0a(Zr.a.IWa,Object(H.a)(this,this.pxb,"featureStateChangeCallback"));this.MNa.isFeatureEnabled(Zr.a.IWa,!1).then(b=>{this.OId=b})}get isLicensed(){return this.OId}pxb(a){this.OId=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.GYh,a.isEnabled);
appChrome.api.dispatch(a)}dispose(){this.MNa.lkb(Zr.a.IWa,this.tBc)}}Object(m.a)(FM,"ModernFontPickerFeatureHelper",null,[217,108]);class Wz{constructor(a){this.BIa=null;a?Object.getType(a)===String?this.BIa=Wz.deserialize(a):this.BIa=a:(ha.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.BIa=[]);this.MHa=!1}get isDirty(){return this.MHa}get Dmd(){return Array.clone(this.BIa)}Qei(a){Array.contains(this.BIa,a)||(Array.add(this.BIa,a),this.MHa=!0)}z$k(a){Array.contains(this.BIa,
a)&&(Array.remove(this.BIa,a),this.MHa=!0)}serialize(){return JSON.stringify(this.BIa)}yfl(){this.MHa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return ha.ULS.sendTraceTag(543475147,3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(m.a)(Wz,"PinnedFontStore",null,[]);class GM{constructor(a,b,c,f){this.ia=a;this.la=c;this.m_g=b;this.wb=f;this.D5=null}initialize(){this.ia.ya(F.a.Toc,ye.a.frame,Object(H.a)(this,this.Toc,"pinOrUnpinFont"));this.ia.ra(F.a.V3f,ye.a.frame,Object(H.a)(this,
this.dbh,"onFontPickerMenuClose"),96);this.m_g.Dfe("getPPTPinnedFontsSettings").continueWith(Object(H.a)(this,this.mLk,"onRoamingSettingLoaded"))}Y5j(a){return a.jo?!1:a.Hm?(ha.ULS.sendTraceTag(543273993,3021,10,"Load setting failed with exception {0}",a.hj),!1):!0}mLk(a){this.Y5j(a)?this.D5=new Wz(a.result||this.Cbg()):this.D5=new Wz(this.Cbg());this.Clh()}Clh(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.Dmd))}get Dmd(){return this.D5?this.D5.Dmd:[]}Cbg(){return this.la.Ha("RecommendedFonts")}Toc(a,
b,c,f,l){if(!this.D5)return ha.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.D5.Qei(a):this.D5.z$k(a));return 32}dbh(){if(!this.D5||!this.D5.isDirty)return 32;const a=pd.a.sPc(10,Object(H.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.wb.Hb(a);return 32}updatePinnedFonts(){this.D5&&(this.Clh(),this.Bwh(),this.D5.yfl())}Bwh(){if(this.D5&&this.D5.isDirty){var a=this.D5.serialize();this.m_g.pul(a)}}dispose(){this.Bwh();
this.ia.kK(F.a.Toc,ye.a.frame,Object(H.a)(this,this.Toc,"pinOrUnpinFont"));this.ia.kK(F.a.V3f,ye.a.frame,Object(H.a)(this,this.dbh,"onFontPickerMenuClose"))}}Object(m.a)(GM,"FontPinningHandler",null,[218,108]);class Oq{static get Jld(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}Oq.xEa="fontInfoTaskPane";Oq.n4i="modernfontpicker";Object(m.a)(Oq,"FontInfoPaneConstants",null,[]);class HM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=
!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(m.a)(HM,"FontInfoTaskPaneProps",null,[]);var yu=d(659);class Xz{constructor(a,b,c,f=null){this.X6a=this.VV=this.tBc=null;this._state=this.zqb=0;this.l4h=a;this.MNa=b;this.xXh=c;this.Pd=f}get un(){return this.l4h.value}initialize(){this.un.ya(F.a.kYe,ye.a.frame,Object(H.a)(this,this.kYe,"requestFontInfo"));this.tBc=this.MNa.C0a(Zr.a.IWa,Object(H.a)(this,this.pxb,"featureStateChangeCallback"));this.Llb()}kl(a=!1){const b=Mj.UISurfaces.Iq(),
c=this.MNa.isFeatureEnabled(Zr.a.IWa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(Oq.xEa,this.rda(l[1]));a&&this.Zq()})}UQh(a){Mj.UISurfaces.Iq().then(b=>{b.updateTaskPane(Oq.xEa,this.rda(a));return null})}pxb(a){this.UQh(a.isEnabled)}kYe(a,b,c,f,l){this.VV=l.CommandValueId;this.X6a=l.Trigger;this.zqb=l.InputMethod;this.kl(2===this._state&&1===this.zqb);return 32}rda(a){const b=new HM;b.onUpsellButtonClicked=Object(H.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");
b.fontName=this.VV;b.isLicensed=a;b.trigger=this.X6a;b.helpArticleUrl=this.KJi();b.paneId=Oq.xEa;a=this.XQj();a.contentProps=b;return a}XQj(){return Object.assign(new yu.a,{title:Oq.Jld,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(H.a)(this,this.onOpen,"onOpen"),onClose:Object(H.a)(this,this.onClose,"onClose"),onShow:Object(H.a)(this,this.onShow,"onShow"),onHide:Object(H.a)(this,this.onHide,"onHide")})}Llb(){if(this.Pd){var a=
this.Pd.Ic(Oq.xEa);a.parent=D.AFrame.$i;a.zJ=!0}}onOpen(){this._state=2;this.Zq()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.zqb=a),this.Zq())}onClose(){this.zqb=this._state=0;this.blur()}onHide(){this._state=1;this.zqb=0}Zq(){this.Pd&&1===this.zqb&&this.Pd.wf(Oq.xEa)}blur(){this.Pd&&this.Pd.Ee&&this.Pd.Ee.name===Oq.xEa&&this.Pd.wf(this.Pd.M8)}onUpsellButtonClicked(){this.MNa.launchUpsellExperience(Oq.n4i)}dispose(){this.MNa.lkb(Zr.a.IWa,this.tBc)}KJi(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",
this.xXh,this.Elj(),"PPWAENDUSER",w.AFrameworkApplication.lcid)}Elj(){switch(this.X6a){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Xz.iui(this.VV)}static iui(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=na.a.charAt(a,c);if(255<a.charCodeAt(c)||na.a.bog(f))b+=f}return b}}Object(m.a)(Xz,"FontInfoPane",null,[219,108]);class IM extends Xz{constructor(a,
b,c,f){super(a,b,c.Ha("FontInfoHelpBaseUrl"),f)}pxb(a){this.UQh(a.isEnabled)}}Object(m.a)(IM,"PPTFontInfoPane",Xz,[]);class rE{constructor(){this.Sbd=this.zgc=this.Agc=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Xb(a){this.K=a;this.K.register(217,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").na().oa(()=>new FM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(218,"Box4.IFontPinningStore").na().oa(()=>new GM(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.ITaskManager")));this.K.register(219,"Common.ModernFontPicker.IFontInfoPane").na().oa(()=>new IM(new vb.a(()=>w.AFrameworkApplication.Qa),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.$e(()=>{this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>
{a.ka("PPTOModernFontPickerIsEnabled")&&(this.Sbd=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.zgc=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.zgc.initialize(),b.isFeatureEnabled(Zr.a.IWa,!1).then(c=>{!w.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.Agc=this.K.resolve("Box4.IFontPinningStore"),this.Agc.initialize())}),Sc.App.Mb.updateCommandUI())})})}dispose(){this.zgc&&(this.zgc.dispose(),this.zgc=null);this.Agc&&(this.Agc.dispose(),this.Agc=
null);this.Sbd&&(this.Sbd.dispose(),this.Sbd=null)}static main(){n.a.instance.Ac(new rE)}}Object(m.a)(rE,"PPTModernFontPickerPackage",null,[2,3]);var sE=d(1115);class JM{constructor(a){this.iaa=a;this.hhb=this.iaa.hIb("UserAction","ImageProcessor");this.Sik=67}Cxg(a,b){if(b)if(a&&this.g9j){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}CFh(a,b,c){c-=this.Sik;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=
l)return null;let y=null,G=1,R=0;try{const ja=Math.ceil(1.37*b);if(c<=ja){const za=Math.sqrt(c/(1.3*ja));f=Math.floor(a.width*za);l=Math.floor(a.height*za)}if(y=this.LWf(a,f,l))if(R=y.length,y.length>=c){const za=this.adg(a.width,a.height);za*Math.floor(a.width)*za*Math.floor(a.height)>=f*l?y=null:(G++,(y=this.wCl(a))&&y.length>=c&&(y=null))}}catch(ja){y=null,ha.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+ja.message+", Call stack: "+ja.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,G,R,y?y.length:0);ha.ULS.sendTraceTag(20841026,826,50,a);return y}wCl(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.adg(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.LWf(a,c,f)}catch(y){ha.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+y.message+", Call stack: "+y.stack)}}return b}LWf(a,b,c){if(0>=b||0>=c)return null;let f;this.hhb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var y=l.getContext("2d");f=this.hhb.er;
y.drawImage(a,0,0,b,c);y=this.hhb.er-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,y,this.hhb.er-(f+y));ha.ULS.sendTraceTag(20841028,813,50,a);return l}adg(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get g9j(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(m.a)(JM,"ImageProcessor",null,
[460]);class tE{constructor(a,b,c,f,l){this.Ca=a;this.IXh=b;this.HXh=c;this.Udf=f;this.X6h=l}get un(){return this.Ca}Fti(a){this.un.Bnd(a,this.IXh,null,null)}Dti(a){this.un.Bnd(a,this.HXh,null,null)}z8(a,b,c){c?this.un.Bnd(a,this.Udf,b,null):this.un.Ja(this.Udf,2,b)}hhh(a,b=!1){const c=new J.DictionaryPropertySet;c.setValue(we.a.aV,a);c.setValue(we.a.rmd,!0);c.setValue(we.a.pcb,b);this.un.Ja(this.X6h,2,c)}}Object(m.a)(tE,"ClipboardCommands",null,[430]);class uE{Y5b(){}}Object(m.a)(uE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[875]);class Pq{constructor(a,b,c,f,l,y){this.XD=a;this.mh=b;this.ov=c;this.Um=f;this.pp=l;this.hd=y}NTj(a,b){a=b.view;b=b.RE;if(!b||M.a.instance.ga(14)&&!this.XD.Zpg(b,!0)||this.Um&&this.Um.instance&&this.Um.instance.qX(b))return 2;var c=Pq.tV?!Pq.nu.Jla(b):!0;this.ov&&c&&this.ov.gxc(b.node,B.a.jp,b.Ra);this.mh.a0c(b,l=>new Iv.a(l,Iv.a.gQc),Kf.AParagraphNode.L_);if(this.hd.gg&&this.hd.nz){c=new pf.GraphTransaction(15);try{c.ld(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Lb+1;" "===zb.ParagraphReader.text(f).charAt(c)&&
(f=bb.a.createTextRange(f,c,c+1),this.mh.replaceTextRange(f,"\u00a0"));b=bb.a.Oj(b.node,c);a.Nb.setSelection(Vd.SelectionFactory.Qu(b));return 32}static get nu(){return Pq.VD||(Pq.VD=Fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get tV(){null==Pq.HI&&(Pq.HI=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Pq.HI}}Pq.VD=null;Pq.HI=null;Object(m.a)(Pq,"InsertLineBreakStrategy",null,[]);class io{static get Xh(){return io.Mi||(io.Mi=
Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Cm(){return Th.ContextSetEditor.instance}static get g7(){return io.pp||(io.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Xf(){return io.hd||(io.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static UTj(a,b,c,f,l){if(l&&l.Ta(we.a.targetObject)){var y=b.view.Ag.Nh.Be(l.eb(we.a.targetObject));y=bb.a.create(y)}else y=io.Cm.A3(b.RE,11);if(!y)return 8;a=w.AFrameworkApplication.Qa.ii(y,
a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Uh)return 2;b=b.view;f=b.Nb.ak;if(f=io.Cm.A3(f,11)){c=new Nn.a;c.set(f.node);c.kf();if(l&&l.Ta(we.a.targetObject))for(l=l.Sh(we.a.targetObject);!c.currentNode.id.equals(l)&&c.Cc()&&(rc.OutlineElementNavigator.Se(c),11===c.Bi););rc.OutlineElementNavigator.xxa(c,!1,!1);l=Jb.SelectionEditor.xka(c,!0);l=zb.ParagraphReader.zs(l)?Vd.SelectionFactory.Qg(l,0):Vd.SelectionFactory.rl(l);b.Nb.setSelection(l)}}return a}static bke(a,b,c,f,l){a=a===C.a.zac;b=b.node;if(l&&
l.Ta(we.a.targetObject)&&!b.id.equals(l.Sh(we.a.targetObject)))return 2;if(1===c)return 32;c=new ub.GraphIterator;c.set(b);c.rc(10);io.Xh.rea(c,a,!0);io.Xf.gg&&io.Xf.nz&&rc.OutlineElementNavigator.yi(c);return 32}}io.Mi=null;io.pp=null;io.hd=null;Object(m.a)(io,"InsertOutlineElementStrategy",null,[]);var UR=d(422);class Yz{constructor(a,b,c,f,l,y,G,R){this.ov=b;this.L_h=a;this.Ut=l;this.lp=f;this.Mi=c;this.XD=y;this.Uc=G;this.r6a=R}aCk(a,b,c,f,l){if(!b.view.Uh)return 2;b=b.view;let y=null;b.yp&&(y=
b);const G=b.Nb.ak;let R=!0,ja=!1,za=null;if(!G)return 2;const Va=new pf.GraphTransaction(15);Va.ld(b.Ag);let hb=null;2===c&&(hb=new Nn.a,hb.set(G.node),hb.kf(),za=new Bx(hb),2===Sc.App.mode&&Jb.SelectionEditor.Xg(G)&&(hb.gC(11)&&Bb.ListReader.Hk(hb)&&he.OutlineElementReader.isEmpty(hb,!1)&&(R=!1),R&&Sc.App.Oh.Ew&&he.OutlineElementReader.eD(hb,G,!1)&&!he.OutlineElementReader.eD(hb,G,!0)&&(R=!1)),rc.OutlineElementNavigator.Se(hb),he.OutlineElementReader.isEmpty(hb,!1)&&(UR.a.F3j(hb)&&(R=!1),1===Sc.App.mode&&
Bb.ListReader.Hk(hb)&&(ja=!0)));a=w.AFrameworkApplication.Qa.ii(G,a,c,!1,f,l);R&&32===a&&2===c&&(ja||rc.OutlineElementNavigator.CJa(hb,!1,!Jb.SelectionEditor.Xg(G),!1),ja&&za&&za.restore(hb),M.a.instance.ga(101)&&this.Ut.freeze(),b.Nb.setSelection(Vd.SelectionFactory.Ej(hb.currentNode,!0)),M.a.instance.ga(101)&&this.Ut.X7e(),this.L_h.Yn.Dw());y&&(R||y.Tya());yh.GrippersManager.instance.g3a(1);Va.dispose();return a}$B(a,b,c){a=!1;if(ba.ImageReader.cGa(b)||ba.ImageReader.RAb(b))b=this.cLi(b),a=!0;const f=
b;b=Jb.SelectionEditor.Xg(b);if(1===c)return 32;const l=f.node,y=new ub.GraphIterator;y.set(l);y.kf();rc.OutlineElementNavigator.Se(y);c=new pf.GraphTransaction(15);c.Xy(y);b?(b=!0,M.a.instance.ga(101)&&zb.ParagraphReader.fe(l)&&f.Ra===zb.ParagraphReader.textLength(l)&&Ee.n(f)&&9===zb.ParagraphReader.rXc(l)&&this.Ut.ULi(f),1===Sc.App.mode&&he.OutlineElementReader.isEmpty(y,!1)&&Bb.ListReader.Hk(y)&&(b=!1),this.lp.Hzh(y,b,f,l),this.ov&&this.ov.gxc(l,B.a.jp,f.Ra),a&&(rc.OutlineElementNavigator.cK(y,
!1,!1),a=y.Db(2),(a=this.r6a.Qg(a,0))&&this.Uc.setSelection(a))):this.Mi.rea(y,!0,!0);c.dispose();Sc.App.Mb&&Sc.App.Mb.updateCommandUI();return 32}cLi(a){if(ba.ImageReader.cGa(a))var b=bb.a.Oj(a.node,a.Ra);else b=zb.ParagraphReader.oDa(a.node),a=Yz.thj(a.node.properties.eb(sb.a.runId),b.properties.Sh(sb.a.aZ),b.Sa),b=bb.a.Oj(b,a);return b}static t8i(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static thj(a,b,c){let f=0;a=Yz.t8i(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<c.length;){b=
c.ga(l);if(b.formatting&&b.formatting.tg===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(m.a)(Yz,"NewLineStrategy",null,[]);class zu{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.ot=null;this.h_=a;this.mBc=y;this.DEc=new Yz(this,b,c,f,l,G,za,Va);this.Jkf=new Pq(G,R,b,ja,hb,Cb)}get Yn(){return this.ot||(this.ot=this.h_())}vb(){const a=w.AFrameworkApplication.Qa,b=Object(H.a)(this.DEc,this.DEc.$B,"newLine");a.ra(C.a.enter,rb.a.view,Object(H.a)(this.mBc.value,this.mBc.value.a3i,"enterView"),
1124);a.ra(C.a.Fud,rb.a.view,Object(H.a)(this.mBc.value,this.mBc.value.ewl,"shiftEnterView"),1124);a.ya(C.a.$B,rb.a.view,Object(H.a)(this.DEc,this.DEc.aCk,"newLineView"));a.ya(C.a.$B,rb.a.Mf,b);a.ya(C.a.$B,rb.a.image,b);a.ya(C.a.$B,rb.a.textRange,b);a.ya(C.a.$B,rb.a.anchoredObject,b);a.ya(C.a.$B,rb.a.embeddedFile,b);a.ya(C.a.$B,rb.a.ink,b);a.ya(C.a.$B,rb.a.paragraph,b);a.ya(C.a.$B,rb.a.iFrame,b);a.ya(C.a.$B,rb.a.unsupportedObject,b);a.ie(C.a.$B,1124);a.ra(C.a.xac,rb.a.view,Object(H.a)(this.Jkf,this.Jkf.NTj,
"insertLineBreakView"),1028);a.ya(C.a.zac,rb.a.view,io.UTj);a.ya(C.a.zac,rb.a.outlineElement,io.bke);a.ie(C.a.zac,1092)}static get instance(){return zu.La||(zu.La=zu.VC())}static VC(){return new zu(()=>Fb.a.instance.resolve("Box4.IUndoManager"),Fb.a.instance.rb("Box4.IAutoCorrectScheduler"),Fb.a.instance.resolve("Box4.IOutlineElementEditor"),Fb.a.instance.resolve("Box4.List.IListEditor"),Fb.a.instance.resolve("Box4.IInsertionPointFormatting"),Fb.a.instance.ue("Box4.Actors.IEnterViewStrategy"),Mh.a.instance,
Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Fb.a.instance.Ia("Box4.IExternalSelectionManager"),ze.a.instance,Fb.a.instance.resolve("Box4.ISelectionFactory"),Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}zu.La=null;Object(m.a)(zu,"EnterActor",null,[]);class KM{KIh(a){return a}msg(){return!0}}Object(m.a)(KM,"EopFormattingStrategy",null,[436]);var LM=d(156);class vE{constructor(a,
b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.KPa=this.LXb=this.Oob=null;this.cQd=0;this.bId=!1;this.Oa=new Wc.a;this.UUb=null;this.eL=a;this.Ut=b;this.Jf=c;this.qx=f;this.Er=l;this.lp=y;this.fh=G;this.mh=R;this.XD=ja;this.kd=za;this.hd=Va;this.pp=hb;this.qQa=Cb}get f1i(){return M.a.instance.ga(105)?this.kd?this.kd.isFeatureEnabled(55):w.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get Oda(){return this.UUb||(this.UUb=Fb.a.instance.resolve("Box4.IFormatPainterStrategy"))}get TL(){return this.bId}set TL(a){this.bId!==
a&&(this.bId=a,this.Oa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}aii(a){this.Oa.addHandler("FormatPainterBrushActiveStatusChanged",a)}aih(a){const b=a.Ua;ha.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.Urg(a);if(this.Oda.oDh(b.contextId,a))try{this.KPa=this.Er.fua(c)}catch(f){throw ha.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.LXb=Ka.StyleReader.qE(c);c=wb.a.Es(b);c.iA&&(this.Oob=
Object(sa.a)(Cq.a,c.iA.clone()));this.cQd=a?rb.a.paragraph:b.contextId;this.Oda.aCf(b.node,this.KPa,this.Oob)}gEf(a){const b=M.a.instance.ga(14),c=this.Urg(a);for(let R=0;R<a.length;R++){var f=a.ga(R);if(f.Rk){var l=void 0;if(f.contextId===rb.a.Mf||f.contextId===rb.a.textRange)l=b&&this.XD.Vua(f);else if(f.contextId===rb.a.paragraph)l=b&&this.XD.g3c(f);else if(f.contextId===rb.a.endOfParagraph)l=b&&this.XD.a2c(f);else{ha.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);
continue}ha.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)ha.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(sa.a)(Kf.AParagraphNode,f.node);var y=!1;l&&(y=f.contextId===rb.a.textRange&&!!l&&!f.Ra&&f.Lb===this.Er.textLength(l));if(y=this.Oda.DCh(this.cQd,f.contextId,c,y))try{zb.ParagraphReader.fe(l)?(this.LXb&&this.eL.fba(this.LXb,l,!0),this.qx.kEf(l,this.KPa)):ha.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
f.node.type)}catch(ja){throw ha.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",ja.message),ja;}var G=f;f.contextId===rb.a.paragraph?G=bb.a.createTextRange(l,0,zb.ParagraphReader.textLength(l)):f.contextId===rb.a.Mf&&(G=this.Ut.M8b(f),G=ze.a.fSa(G));if(G&&G.contextId===rb.a.textRange)try{this.Loi(G,this.Oob,y?null:this.LXb)}catch(ja){throw ha.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",ja.message),ja;}if(f.contextId===rb.a.paragraph||f.contextId===
rb.a.endOfParagraph){y=new ub.GraphIterator;y.set(l);y.kf();y.Jg(11);G=Bb.ListReader.Hk(y);const ja=!zb.ParagraphReader.textLength(l);ha.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",G,ja);G?(this.fh.Yna(y),f=y.currentNode,this.fh.Aea(f)&&this.lp.Dtd(f,l,this.Oob)):this.f1i&&this.Koi(f,this.Oob)}}}else ha.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}Koi(a,b){b&&(a=this.mh.N6d(a.node),a.ge(a.Ke),this.hEf(a,
b,null))}Loi(a,b,c){if(b||c)0<Ee.h(a).length&&ha.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.qQa.UKc(a,f=>{this.hEf(f,b,c)})}hEf(a,b,c){this.Jf.aDa(a);a.iA&&a.iA.removeProperty(Ya.a.highlight);this.Jf.iNc(a);this.oy(a,c);this.oy(a,b)}oy(a,b){if(b){var c=a.paragraph.Nh;if(c){var f=a.iA;f=f?Object(sa.a)(LM.a,f.clone()):Cq.a.mDa(1179725);for(const y of b.pA())if(y!==sb.a.bH&&y!==sb.a.fieldInstruction&&y!==Ya.a.zt&&y!==Ya.a.m0&&y!==sb.a.hcb&&y!==Ya.a.At&&y!==sb.a.languageHint&&
y!==sb.a.noProof){if(y===V.a.F3){var l=b.sa(V.a.F3,ia.a.nil);if(l!==ia.a.nil&&(l=Object(sa.a)(Cq.a,c.Be(l)),l=Ka.StyleReader.nYc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=Ka.StyleReader.OL(a.paragraph).bxj(l);f.oy(l);continue}}f.setValue(y,b.Sh(y))}f.Vcb?b=c.dLa(f):(c.YE(f),b=f);a.Fm=b.id}}}Urg(a){return!a.ida&&a.jf.contextId!==rb.a.endOfParagraph}reset(){this.KPa=this.LXb=this.Oob=null;this.cQd=rb.a.none}}Object(m.a)(vE,"FormatPainter",null,[309]);class Zz{constructor(a){this.jl=this.transaction=
null;this.Nf=a;this.Bvb=this.xq=0}}Object(m.a)(Zz,"SelectAllArguments",null,[]);class ms{constructor(a,b,c,f,l){this.M6h=a;this.pia=b;this.Mk=c;this.uId=f;this.hWb=l}get CPe(){return this.M6h}get Yn(){return this.pia.value}get Ukl(){return this.uId?this.hWb?Object(H.a)(this,this.j4i,"expandSelectionOneNote"):Object(H.a)(this,this.k4i,"expandSelectionWord"):Object(H.a)(this,this.lxh,"selectAllInOutline")}get mxh(){return this.hWb?Object(H.a)(this,this.csd,"selectAllOutlines"):null}vb(){const a=w.AFrameworkApplication.Qa;
this.mxh&&a.ra(C.a.csd,rb.a.view,this.mxh,2);a.ya(C.a.lba,ye.a.frame,ms.nEh);a.ya(C.a.Gud,ye.a.frame,ms.nEh);a.ra(C.a.qta,rb.a.view,this.Ukl,2);a.ra(C.a.ICf,rb.a.view,D.AFrame.we,100);a.ra(C.a.PKe,rb.a.view,ms.PKe,4)}j4i(a,b,c){return this.qta(b,c,null)}qta(a,b,c){if(1===b)return 32;if(!a.view.Uh)return 2;b=a.view;if(!b.Nb)return 8;const f=b.Nb.Pa;if(!f||!f.length)return 8;kf.a.mark(5798);Sc.App.Mb.Ld.isEditingAllowed||Sc.App.Mb.Ld.xz?a=Jb.SelectionEditor.Rce(f):(t.FocusManager.instance().hC(D.AFrame.SW),
a=Vd.SelectionFactory.q_e(b.Ag));if(!a)return 8;this.uId&&!f.Ssa&&ha.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.CPe.Lcb(Jb.SelectionEditor.S7f(a))?c=c(b):(c=new Zz(b),c.jl=a,c=new xf.a(null,Object(H.a)(this,this.WKb,"processSetSelection"),c),c.$l("ExpandSelection"),c.run());return c.inProgress?1:32}k4i(a,b,c,f,l){return b.view.yp?this.qta(b,c,Object(H.a)(this,this.uHh,"startOperationOfSelectAllInOutline")):this.lxh(a,b,c,f,l)}WKb(a,b){return 0===b.xq?(b.transaction=this.Mk.ke(2),
b.transaction.ld(b.Nf.Ag),b.xq=1,!0):1===b.xq?(b.Nf.Nb.nOb(b.jl,a),b.xq=2,!0):2===b.xq?(b.Nf.Nb.Pa.Ssa=b.jl.Ssa,this.Yn.Dw(),b.transaction.oV(a),b.xq=3,b.transaction.dispose(),kf.a.mark(5799),!0):!1}lxh(a,b,c){if(1===c)return 32;if(!b.view.Uh)return 2;a=b.view;return a.Nb&&a.Nb.Pa&&a.Nb.Pa.nb?this.uHh(a).inProgress?1:32:8}uHh(a){w.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.uId&&a.yp&&ha.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new xf.a(null,Object(H.a)(this,this.ZYk,"processSelectAllInOutline"),new Zz(a));a.$l("SelectAllInOutline");a.run();return a}ZYk(a,b){if(0===b.xq)return b.jl=Vd.SelectionFactory.Vkl(b.Nf.Nb.Pa.nb),b.transaction=this.Mk.ke(2),b.transaction.ld(b.Nf.Ag),b.xq=1,!0;if(1===b.xq){if(!b.Bvb)return M.a.instance.ga(77)&&M.a.instance.ga(104)&&b.jl.Sl?(b.Nf.Nb.nOb(b.jl,a),b.Bvb=b.jl.length):(b.Nf.Nb.setSelection(b.jl.ga(0),a),++b.Bvb),!0;if(b.Bvb<b.jl.length)return b.Nf.Nb.eAf(b.jl.ga(b.Bvb),a),++b.Bvb,!0;b.xq=
2}return 2===b.xq?(b.Nf.Nb.Pa.Ssa=b.jl.Ssa,this.Yn.Dw(),b.transaction.oV(a),b.xq=3,b.transaction.dispose(),!0):!1}csd(a,b,c){if(1===c)return 32;if(!b.view.Uh)return 2;b=b.view;a=Vd.SelectionFactory.q_e(b.Ag);if(!a)return 8;b=new Zz(b);b.jl=a;a=new xf.a(null,Object(H.a)(this,this.WKb,"processSetSelection"),b);a.$l("ExpandSelection");a.run();return a.inProgress?1:32}static get dlb(){return ms.q6a||(ms.q6a=Fb.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static PKe(a,b,c){if(1===c)return 32;
if(!b.view.Uh)return 8;a=b.view;b=Vd.SelectionFactory.Ej(a.root.graphNode,!0);if(!b)return 8;a.Nb.setSelection(b);return 32}static nEh(){if(!M.a.instance.ga(75))return 2;var a=Sc.App.Mb.Ld.jL;if(!a.Uh)return 2;if(a.Uh&&1!==Sc.App.Mb.state){kf.a.mark(4668);var b=a.Nb.Pa.nb;if(!b&&w.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=Jb.SelectionEditor.zja(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;ms.dlb.lba(new Sys.UI.Point(c,f),1);kf.a.mark(4669)}return 32}}ms.q6a=null;Object(m.a)(ms,"SelectAllHandlers",null,[437]);class MM extends sh.StandardDialog{constructor(a,b,c=null){super();this.Ad=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.vTd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.jIb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(m.a)(MM,"ToggleRibbonUXDialog",
sh.StandardDialog,[]);const YR=()=>{const a=w.AFrameworkApplication.Qa;a.ra(F.a.R_k,ye.a.frame,VR,101);a.ya(F.a.wLl,ye.a.frame,WR)},WR=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==ye.a.frame)return 2;ha.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",w.AFrameworkApplication.Aa.mb.Rp?"Single Line Ribbon":"Classic Ribbon");new MM(f=>{1===f&&w.AFrameworkApplication.Qa.processAction(F.a.GLh,2)},w.AFrameworkApplication.Aa.mb.Rp);return 32},VR=(a,b,c,f,l)=>{l[Ih.a.On]=
w.AFrameworkApplication.Aa.mb.Rp;return 32};class wE{constructor(a){this.Jf=a}K0e(a,b){this.Jf.pV(a,b.cache.BL);this.Jf.Xq(a,b.cache.fontSize)}v0e(){}gce(){return null}fX(){return null}BUa(){return null}k9(){return null}IDh(){return!1}}Object(m.a)(wE,"FormattingStewardBridge",null,[426]);var NM=d(749),ZR=d(700);class OM{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){this.me=()=>{};this.gFa=()=>{const ec=this.jb.Fk();return ec?ec.gFa():null};this.onShapeSelected=(ec,jc)=>{this.Sp.uXe(this.onShapeSelected);
jc.shapeNode.x0?32!==this.ia.processAction(ea.a.X7a,2)&&ya.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):ya.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")};this.nxh=()=>{const ec=this.gFa();return ec?(this.Sp.OUd(this.onShapeSelected),this.jb.selectShape(ec,!0),!0):!1};this.Tpg=()=>{const ec=this.jb.Re();return!!ec&&1===ec.length&&!!this.gFa()};this.Utg=()=>{var ec=this.jb.Ud();if(1!==ec.length)return!1;ec=
ec[0];return!ec.x0&&!ec.Of&&!ec.Ug&&!ec.Wf&&ec.hasText&&0<ec.textLength()};this.xCj=(ec,jc,xd,Xd,Qd)=>{if(1===xd)return 32;var Ie=this.gFa();const Pe=this.jb.Ud(),ig=1===Pe.length?Pe[0]:null;0<Pe.length&&ig!==Ie?this.Utg()?(Ie=3,ec=this.Xhg(ec,jc,xd,Xd,Qd)):(Ie=4,ec=32):this.Tpg()?(Ie=1,ec=this.Qgg(ec,jc,xd,Xd,Qd)):this.Wng()?(Ie=2,ec=this.tgg(ec,jc,xd,Xd,Qd)):(ya.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),Ie=5,ec=8);Object(qd.a)("RefactorSlideTitleTelemetry")?
Xd&&(Xd.PC=Ie):kk.a("AddEditOrSetAsSlideTitle",32===ec,void 0,[Object.assign(new Fn.a,{name:"SubAction",int64:Ie})]);return ec};this.Qgg=(ec,jc,xd)=>1===xd?this.Tpg()?32:2:this.nxh()?32:8;this.ugg=(ec,jc,xd)=>{if(1===jc)return this.Wng()?32:2;jc=new Date;const Xd=this.Fb.yd(15,void 0,void 0,()=>{const Qd=this.jb.Re();if(Qd&&1===Qd.length){const Ie=new Date;let Pe=0;Pe=window.setInterval(()=>{this.nxh()?window.clearInterval(Pe):2E3<+new Date-+Ie&&(ya.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",
2E3),window.clearInterval(Pe))},100)}});try{ya.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",xd);Xd.jc(this.E5.Gf);Xd.gd=ec;for(const Qd of this.jb.Re())Qd&&!Qd.gFa()&&(Qd.iGa=xd)}finally{Xd&&Xd.dispose()}ec=new Date;ya.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",xd);if(xd=Kc.a.Kb)xd.zm("AddSlideTitleStart",jc),xd.zm("AddSlideTitleEnd",ec),xd.Qj=!1,xd.$p=!0,Kc.a.Naa(xd);return 32};this.tgg=(ec,jc,xd)=>this.ugg(ec,xd,!1);this.zCj=(ec,jc,
xd)=>this.ugg(ec,xd,!0);this.Xhg=(ec,jc,xd)=>{if(1===xd)return this.Utg()?32:2;xd=this.jb.Fk();const Xd=this.jb.Ud();if(1!==Xd.length)return ya.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;jc=new Date;const Qd=this.Fb.yd(15);try{ya.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",xd.Cb.cid,Xd[0].get_shapeId()),Qd.jc(xd),Qd.gd=ec,xd.bMa=Xd[0].get_shapeId()}finally{Qd&&Qd.dispose()}ec=new Date;ya.a.J(509724639,822,50,
"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",xd.Cb.cid,Xd[0].get_shapeId());if(xd=Kc.a.Kb)xd.zm("SetAsSlideTitleStart",jc),xd.zm("SetAsSlideTitleEnd",ec),xd.Qj=!1,xd.$p=!0,Kc.a.Naa(xd);32!==this.ia.processAction(ea.a.X7a,2)&&ya.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32};this.lFj=(ec,jc,xd)=>this.jb.i0()?this.ia.processAction(C.a.N$b,xd):this.ia.processAction(this.jma?ea.a.BRc:ea.a.hsa,xd);this.vCj=(ec,jc,xd)=>{if(1===xd)return 32;
ec={};this.x6c&&(ec.query="AssetID="+this.x6c);jc={};jc.cB=ResourceStrings.L_Help;jc.assetId="FA000000012";jc.nonPersistedSettings=ec;jc.Uaf=!1;return this.ia.Ja(ea.a.Sga,2,jc)};this.t1j=()=>{if(!this.tlc)return!1;const ec=this.jb.Qf();return 1!==ec.length?!1:ec[0].yO};this.mig=(ec,jc,xd)=>{const Xd=this.ua.Ba;if(!Xd||this.fc.fd(Xd))return 8;if(1===xd)return this.t1j()?32:2;jc=Kc.a.Jj("Captions::Insert");try{return ZR.a.t4e(".vtt",NM.e,()=>NM.d(ec,this.BTj,"captions",this.Ie,Xd),"captions",Xd,this.ua.presentation,
this.fc,this.Vd,jc,!1,this.Qfb,50,10,3),jc&&jc.Wa("CaptionsDialogInitialized","true"),32}catch(Qd){ya.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}jc&&(jc.Wa("CaptionsDialogInitialized","false"),jc.finish(),jc=null);return 8};this.BTj=(ec,jc,xd,Xd,Qd,Ie,Pe)=>{Xd.qO(xd)&&ya.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+xd.Pja);Xd.zK(xd);Qd&&Qd.Wa("CaptionsUploadToRC","true");Object(qd.a)("FixForInsertMediaSlideNavigationIssue")||
(Pe=this.ua.Ba);if(Pe&&Pe.isConnected&&(Ie=Ie.files[0].name,Xd=xd="",Pe=Ie.split("."),2<=Pe.length&&(Xd=Pe[Pe.length-2]),ab.a.He(Xd)||(xd=Ie.lastIndexOf("."),xd=0<=xd?Ie.substring(0,xd):Ie,Xd=""),Ie=this.jb.Qf(),1===Ie.length)){Ie=Ie[0];Pe=this.Fb.yd(15);try{Pe.jc(Ie),Pe.gd=ec,Qd&&Qd.Wa("InsertCaptionsInProgress","true"),Ie.Pub=jc,Ie.Nub=xd,Ie.Oub=Xd}finally{Pe&&Pe.dispose()}Qd&&(Qd.Wa("InsertCaptionsSuccessful","true"),Qd.finish())}};this.G5j=()=>{if(!this.tlc)return!1;const ec=this.jb.Qf();return 1!==
ec.length?!1:ec[0].yO};this.oIj=(ec,jc,xd)=>{if(1===xd)return this.G5j()?32:2;jc=this.jb.Qf();if(1!==jc.length)return 16;xd=jc[0];jc=new Date;const Xd=this.Fb.yd(15);try{ya.a.J(509724635,822,50,"RemoveAllCaptions started"),Xd.jc(xd),Xd.gd=ec,xd.QBb=!0}finally{Xd&&Xd.dispose()}ec=new Date;ya.a.J(509724634,822,50,"RemoveAllCaptions completed");if(xd=Kc.a.Kb)xd.zm("RemoveAllCaptionsStart",jc),xd.zm("RemoveAllCaptionsEnd",ec),xd.Qj=!1,xd.$p=!0,Kc.a.Naa(xd);return 32};this.isInHighContrastMode=()=>window.matchMedia("screen and (forced-colors: active)").matches;
this.MFj=(ec,jc,xd,Xd)=>{if(this.isInHighContrastMode())return 2;if(1===xd)return 32;ec=document.getElementById("WACDocumentPanel");(jc=Sys.UI.DomElement.containsCssClass(ec,"GrayscaleDocumentContent"))?Sys.UI.DomElement.removeCssClass(ec,"GrayscaleDocumentContent"):Sys.UI.DomElement.addCssClass(ec,"GrayscaleDocumentContent");this.Vv.SA();Xd&&(Xd.PC=jc?0:1);return 32};this.kqc=(ec,jc,xd,Xd,Qd)=>{Qd.If(Sys.UI.DomElement.containsCssClass(document.getElementById("WACDocumentPanel"),"GrayscaleDocumentContent")&&
!this.isInHighContrastMode());return 32};this.Dxh=()=>{const ec=this.jb.Qf();return 0===ec.length?!1:!ec.some(jc=>!jc||!jc.UL)};this.aGj=(ec,jc,xd,Xd)=>{jc=this.jb.Qf();if(1===xd)return 0<jc.length?32:2;xd=new Date;const Qd=this.Fb.yd(15);try{ya.a.J(509092049,822,50,"handleMarkAsDecorative started");Qd.jc(this.jb.Fk());Qd.gd=ec;let Ie=this.Dxh();for(const Pe of jc)Pe&&Pe.UL===Ie&&(Pe.UL=!Ie);Xd&&(Xd.PC=Ie?0:1)}finally{Qd&&Qd.dispose()}ec=new Date;ya.a.J(509092048,822,50,"HandleMarkAsDecorative completed");
if(Xd=Kc.a.Kb)Xd.zm("MarkAsDecorativeStart",xd),Xd.zm("MarkAsDecorativeEnd",ec),Xd.Qj=!1,Xd.$p=!1,Kc.a.Naa(Xd);return 32};this.pqc=(ec,jc,xd,Xd,Qd)=>{Qd.If(this.Dxh());return 32};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("pptSelectionManager");if(!c)throw Error.argumentNull("transactionFactory");if(!f)throw Error.argumentNull("pptWorkspace");if(!l)throw Error.argumentNull("graphOperationEventSource");if(!y)throw Error.argumentNull("graphTopologyManager");if(!G)throw Error.argumentNull("graphActionBlockingManager");
if(!R)throw Error.argumentNull("errorHandler");if(!ja)throw Error.argumentNull("sessionInfo");if(!za)throw Error.argumentNull("ribbonUser");this.ia=a;this.jb=b;this.Fb=c;this.E5=f;this.Sp=l;this.ua=y;this.fc=G;this.Vd=R;this.Ie=ja;this.Vv=za;this.x6c=Va;this.tlc=hb;this.p$c=Cb;this.c8c=lc;this.jma=ic;this.Qfb=yc}vb(){this.ia.ra(ea.a.czf,qc.a.application,this.xCj,12);this.ia.ra(ea.a.editSlideTitle,qc.a.application,this.Qgg,4);this.ia.ra(ea.a.addSlideTitle,qc.a.application,this.tgg,4);this.ia.ra(ea.a.vzf,
qc.a.application,this.zCj,4);this.ia.ra(ea.a.setAsSlideTitle,qc.a.application,this.Xhg,4);this.ia.ra(ea.a.ejh,qc.a.application,this.lFj,4);this.ia.ya(ea.a.dyf,qc.a.application,this.vCj);this.ia.ra(ea.a.wmg,rb.a.application,this.mig,4);this.ia.ra(ea.a.xmg,rb.a.application,this.mig,4);this.ia.ra(ea.a.Sph,qc.a.application,this.oIj,4);this.p$c&&(this.ia.ra(ea.a.Umg,rb.a.application,this.MFj,12),this.ia.ra(ea.a.kqc,rb.a.application,this.kqc,96));this.c8c&&(this.ia.ra(ea.a.NJe,rb.a.application,this.aGj,
12),this.ia.ra(ea.a.pqc,rb.a.application,this.pqc,96))}Wng(){for(const a of this.jb.Re())if(a&&!a.gFa())return!0;return!1}}Object(m.a)(OM,"AccessibleAuthoringActor",null,[268]);var $R=d(146),aS=d(184);class PM{constructor(a,b,c,f){this.u$c=!1;this.k$="";this.UEb=!1;this.mZa=null;this.K7c=-1;this.bFb=!1;this.fma=[];this.Ib=b;this.la=c;this.igd=f;a&&this.Ib.$e(()=>{a.FC(Object(H.a)(this,this.HLk,"onSelectionChangeFinished"))})}vb(){}me(){}J8b(a,b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",
{["type"]:b,["controlId"]:l},c));return f}HXc(a){const b=[];for(let c=0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}xcg(a){const b=[];let c=!1;if(a){switch(this.k$){case "FormatPicture":Array.addRange(b,this.HXc("PictureStyles"));c=!0;break;case "Table":this.bFb||Array.addRange(b,
this.HXc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.HXc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.HXc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.J8b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.J8b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",0)),Array.addRange(b,this.J8b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&
(a=null,this.bFb&&(a=0),Array.addRange(b,this.J8b(this.mZa,"DropLabel",a)),a=this.mZa.slice(0,this.mZa.length).reverse(),Array.addRange(b,this.J8b(a,"MoveToOverflow",null)))}else for(const f of this.mZa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}Bae(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.MGa("Error","GetModelType failed for "+c),null}return b}Nae(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font",
"Paragraph","Drawing"]}return[]}nRb(a){this.igd&&(a=this.Bae(a))&&this.igd(a)}yRl(a){if(a.length){if(this.igd){var b=this.Bae(a);if(!b)return;var c=this.Nae(this.k$);if(0<c.length&&!this.UEb){for(var f of c)this.fma.push(appChrome.actions.updateGroupHiddenState(f,!0));this.UEb=!0}else if(this.UEb&&!c.length){c=[];f=this.Nae("FormatPicture");for(var l of f)this.fma.push(appChrome.actions.updateGroupHiddenState(l,!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.Bae(c))for(let y in l)b[y]=
l[y];this.UEb=!1}this.igd(b)}this.mZa=a;b=[];for(const y of a)appChrome.selectors.isControlDisabled(y)&&b.push(y);0<b.length&&this.MGa("Disabled",b.join(","));0<this.mZa.length&&(this.fma.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.fma.push(appChrome.actions.updateControlsInGroup("Adaptive",this.mZa)),Array.addRange(this.fma,this.xcg(!0)),this.u$c=!0)}}Hth(a){""!==this.k$&&this.k$!==a&&Array.addRange(this.fma,this.xcg(!1))}F$e(a,b){if(a||this.u$c)if(this.fma.push(appChrome.actions.updateGroupHiddenState("Adaptive",
!a)),this.u$c=a,b=this.Nae(b),a&&0<b.length||this.UEb){for(var c of b)this.fma.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.nRb(c));this.UEb=a}}iWf(){0<this.fma.length&&(appChrome.api.dispatch(this.fma),this.fma=[])}FCi(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.nRb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;
a=!1;if("Table"===b&&Yk.a.instance.nb){const c=!Yk.a.instance.nb.Sl&&!Yk.a.instance.nb.l4c;if(a=(""===this.k$||this.k$===b)&&c!==this.bFb)this.bFb=c}a?this.Hth("TableCellEdit"):this.Hth(b);this.k$=b;return!0}cll(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();for(const f of a)if(this.FCi(c,f)){b=!0;break}return b?this.k$:""}Wdj(){switch(this.k$){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Table":return this.bFb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");
case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}HLk(a,
b){if(!this.la.lza&&"Home"===appChrome.selectors.getSelectedTabId()&&b.jl&&b.jl.nb&&b.jl.length){var c=()=>{const f=this.k$;""===this.cll()?this.F$e(!1,f):this.bFb||""===f||f!==this.k$?this.yRl(this.Wdj()):this.u$c||(this.nRb(this.mZa),this.F$e(!0,this.k$));this.iWf()};-1!==this.K7c&&window.clearTimeout(this.K7c);this.K7c=window.setTimeout(()=>{this.K7c=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.F$e(!1,this.k$),this.iWf()}MGa(a,
b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};$R.a.sendActivityEvent(Object.assign(new aS.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:sB.a.VI(a),durationMs:window.performance.now()}))}}Object(m.a)(PM,"AdaptiveTabGroupUpdaterActor",null,[268]);class QM extends du{constructor(a,b){super(a);this.lbi=b;this.Rt=a}getAltText(a){return(a=this.PT(a))?a.get_altTitle():""}i8f(a){return(a=this.PT(a))?a.get_alt():""}qVd(a,b){if(1===a)if(this.hide(),
a=this.PT(this.Rt)){const c=this.lbi.ke(15);c.jc(a);a.sza=!1;a.set_altTitle(b[kp.sVd]);a.set_alt(b[kp.BKc]);c.dispose()}else ya.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}PT(a){let b;return(a=(a=vg.b(a))?a.Nb:null)&&(b=a.Ud())&&1===b.length?b[0]:null}}Object(m.a)(QM,"ShapeAltTextDialog",du,[]);class RM{constructor(a,b,c,f,l,y,G){this.Qda=()=>this.CHa?this.CHa:this.CHa=Fb.a.instance.rb("PowerPointWebEditor.IImageDescriptionPane");this.Eni=(R,ja,za)=>{if(R!==ea.a.hsa)return 16;
R=this.jb.Ud();if(!R||1!==R.length||this.fc.fd(R[0]))return ya.a.J(509088275,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===za)return 32;ya.a.J(509088274,822,50,"Begin setting the alternative text for shape.");R[0].tj&&!R[0].get_isSVGBlipFilled()&&this.la.Uua?this.Kva.c3k():this.Adj(ja);return 32};this.JCj=(R,ja,za,Va)=>{if(R!==ea.a.hsa)return 16;if(!this.Qda())return 8;if(1===za)return 32;this.Qda().I3e();Va&&(Va.PC=this.Qda().isVisible?
1:0);return 32};this.Djb=(R,ja,za,Va,hb)=>{if(R!==ea.a.Djb)return 16;hb&&hb.If(this.Qda()?this.Qda().isVisible:!1);return 32};this.jDj=(R,ja,za,Va)=>{if(R!==ea.a.aLc)return 16;if(!this.Qda())return 8;if(1===za)return 32;this.Qda().GEf();Va&&(Va.PC=1);return 32};this.zEj=(R,ja,za)=>{if(R!==ea.a.BRc)return 16;if(!this.Qda())return 8;if(1===za)return 32;this.Qda().Y5d();return 32};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("appSettings");if(!c)throw Error.argumentNull("coreExtEventSource");
if(!f)throw Error.argumentNull("selectionManager");if(!l)throw Error.argumentNull("transactionFactory");if(!y)throw Error.argumentNull("graphActionBlockingManager");this.ia=a;this.la=b;this.Kva=c;this.jb=f;this.Fb=l;this.fc=y;this.jma=G}vb(){this.ia.ra(ea.a.hsa,rb.a.view,this.jma?this.JCj:this.Eni,12);this.la.cog&&(this.ia.ra(ea.a.Djb,rb.a.application,this.Djb,96),this.ia.ra(ea.a.aLc,rb.a.view,this.jDj,12),this.ia.ra(ea.a.BRc,rb.a.view,this.zEj,4))}me(){}Adj(a){new QM(a,this.Fb)}}Object(m.a)(RM,"AltTextActor",
null,[268]);class SM{constructor(a,b,c,f,l,y,G,R){this.xE=null;this.ia=a;this.jb=b;this.Fa=c;this.Fb=f;this.Tdb=l;this.dwa=y;this.pc=R;this.Tdb&&this.Tdb.execute(ja=>{this.xE=ja})}vb(){this.ia.ra(ea.a.kLc,qc.a.application,Object(H.a)(this,this.lDj,"handleAudioPlay"),96);this.ia.ra(ea.a.O0b,qc.a.application,Object(H.a)(this,this.kDj,"handleAudioPause"),96);this.ia.ra(ea.a.DFf,qc.a.application,Object(H.a)(this,this.jri,"audioPlayPauseCommandHandler"),96);this.ia.ra(ea.a.Byh,qc.a.application,Object(H.a)(this,
this.V9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.aqc,qc.a.application,Object(H.a)(this,this.aqc,"queryAudioOptions"),96);this.ia.ra(ea.a.playAcrossSlides,qc.a.application,Object(H.a)(this,this.V9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.tqc,qc.a.application,Object(H.a)(this,this.tqc,"queryPlayAcrossSlides"),96);this.ia.ra(ea.a.loopUntilStopped,qc.a.application,Object(H.a)(this,this.V9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.oqc,qc.a.application,Object(H.a)(this,this.oqc,"queryLoopUntilStopped"),
96);this.ia.ra(ea.a.hideDuringShow,qc.a.application,Object(H.a)(this,this.V9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.iqc,qc.a.application,Object(H.a)(this,this.iqc,"queryHideDuringShow"),96);this.ia.ra(ea.a.rewindAfterPlaying,qc.a.application,Object(H.a)(this,this.V9b,"handleSetAudioOptions"),96);this.ia.ra(ea.a.yqc,qc.a.application,Object(H.a)(this,this.yqc,"queryRewindAfterPlaying"),96);this.ia.ya(ea.a.playInBackground,qc.a.application,Object(H.a)(this,this.Yhg,"handleSetAudioStyles"));this.ia.ya(ea.a.noAudioStyle,
qc.a.application,Object(H.a)(this,this.Yhg,"handleSetAudioStyles"));this.ia.ra(ea.a.uqc,qc.a.application,Object(H.a)(this,this.uqc,"queryPlayInBackground"),96);this.ia.ra(ea.a.qqc,qc.a.application,Object(H.a)(this,this.qqc,"queryNoAudioStyle"),96);this.ia.ra(ea.a.setVolume,qc.a.application,Object(H.a)(this,this.W9b,"handleSetVolume"),96);this.ia.ra(ea.a.mud,qc.a.application,Object(H.a)(this,this.W9b,"handleSetVolume"),96);this.ia.ra(ea.a.Cqc,qc.a.application,Object(H.a)(this,this.Cqc,"querySetVolumeLow"),
96);this.ia.ra(ea.a.nud,qc.a.application,Object(H.a)(this,this.W9b,"handleSetVolume"),96);this.ia.ra(ea.a.Dqc,qc.a.application,Object(H.a)(this,this.Dqc,"querySetVolumeMedium"),96);this.ia.ra(ea.a.lud,qc.a.application,Object(H.a)(this,this.W9b,"handleSetVolume"),96);this.ia.ra(ea.a.Bqc,qc.a.application,Object(H.a)(this,this.Bqc,"querySetVolumeHigh"),96);this.ia.ra(ea.a.oud,qc.a.application,Object(H.a)(this,this.W9b,"handleSetVolume"),96);this.ia.ra(ea.a.Eqc,qc.a.application,Object(H.a)(this,this.Eqc,
"querySetVolumeMute"),96);this.ia.ra(ea.a.eHh,qc.a.application,Object(H.a)(this,this.wJj,"handleStartAudio"),96);this.ia.ra(ea.a.Mqc,qc.a.application,Object(H.a)(this,this.Mqc,"queryStartAudio"),96)}me(){}lDj(a,b,c,f,l){b=this.jb.Ud();if(1<b.length||!this.xE)return 16;const y=this.xE.EL(b[0]);if(!y||!y.isPlayerReady())return 16;if(1===c)return 32;let G=!1;l&&(G=!!l.ActionFromPlayer);return Vg.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",G.toString(),a,()=>{y&&!G&&y.startPlaying();
const R=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(R);return 32})}kDj(a,b,c,f,l){const y=this.jb.Ud();if(1<y.length||!this.xE)return 16;if(1===c)return 32;let G=!1;l&&(G=!!l.ActionFromPlayer);return Vg.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",G.toString(),a,()=>{var R=this.xE.EL(y[0]);R&&!G&&R.pause();R=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",
!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(R);return 32})}jri(){var a=this.jb.dYc();if(!a||!this.xE)return 2;(a=this.xE.EL(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(ea.a.O0b,2):this.ia.processAction(ea.a.kLc,2));return 32}V9b(a,b,c,f,l){if(1===c)return 32;if(!l)return ya.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const y=
l.On;return Vg.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const G=this.jb.Qf();if(G&&0<G.length){const R=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{R.jc(G[0]);for(const ja of G){if(!ja||!ja.media)continue;const za=ja.media;switch(a){case ea.a.playAcrossSlides:za.plyAcrssSldsField=y;break;case ea.a.loopUntilStopped:za.repeatField=y;break;case ea.a.hideDuringShow:za.hideDrngShwField=y;break;case ea.a.rewindAfterPlaying:za.rewindField=y}ja.media=
za;if(this.dwa&&this.xE&&(a===ea.a.loopUntilStopped||a===ea.a.rewindAfterPlaying)){const Va=this.xE.EL(ja);Va&&(a===ea.a.loopUntilStopped?Va.setRepeat(za.repeatField):a===ea.a.rewindAfterPlaying&&Va.setRewind(za.rewindField))}}}finally{R&&R.dispose()}}return 32})}Yhg(a,b,c,f,l){return 1===c?32:l?Vg.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const y=this.jb.Qf();if(y&&0<y.length){const G=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{G.jc(y[0]);for(const R of y){if(!R||
!R.media||R.Ug)continue;const ja=R.media;switch(a){case ea.a.playInBackground:ja.plyAcrssSldsField=!0;ja.repeatField=!0;ja.hideDrngShwField=!0;ja.strtField=0;break;case ea.a.noAudioStyle:ja.plyAcrssSldsField=!1,ja.repeatField=!1,ja.hideDrngShwField=!1,ja.strtField=2}R.media=ja}}finally{G&&G.dispose()}}return 32}):(ya.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),8)}wJj(a,b,c,f,l){if(1===c)return 32;if(!l)return ya.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),
8;const y=l.CommandValueId;return Vg.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",y,a,()=>{if(!y||""===y.trim())return 32;const G=this.jb.Qf();if(G&&0<G.length){const R=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{R.jc(G[0]);for(const ja of G){if(!ja||!ja.media||ja.Ug)continue;const za=ja.media;za.strtField="Automatically"===y?0:2;ja.media=za}}finally{R&&R.dispose()}}return 32})}uqc(a,b,c,f,l){return this.qya(l,1)}qqc(a,b,c,f,l){return this.qya(l,0)}W9b(a,b,c,f,l){return 1===
c?32:l?Vg.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const y=this.jb.Qf();if(y&&0<y.length){const G=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{G.jc(y[0]);for(const R of y){if(!R||!R.media)continue;const ja=R.media;switch(a){case ea.a.oud:ja.mteField=!0;break;case ea.a.mud:ja.vlmField=.2;ja.mteField=!1;break;case ea.a.nud:ja.vlmField=.5;ja.mteField=!1;break;case ea.a.lud:ja.vlmField=.8,ja.mteField=!1}this.pc.YL&&(R.media=ja);const za=l.ActionFromPlayer;
if(this.dwa&&this.xE&&!za){const Va=this.xE.EL(R);Va&&(Va.setMute(ja.mteField),Va.setVolume(ja.vlmField))}}}finally{G&&G.dispose()}}return 32}):(ya.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}Cqc(a,b,c,f,l){return this.qya(l,2)}Dqc(a,b,c,f,l){return this.qya(l,3)}Bqc(a,b,c,f,l){return this.qya(l,4)}Eqc(a,b,c,f,l){return this.qya(l,5)}Mqc(a,b,c,f,l){if(a=Object(sa.a)(gi.a,l))c=this.jb.Qf(),b=this.Osg(c,2),c=this.Osg(c,0),b?(a.C_=ResourceStrings.L_AudioStartWhenClickedOn,
a.jtc()):c&&(a.C_=ResourceStrings.L_AudioStartAutomatically,a.jtc());return 32}aqc(){this.Hcc()&&Sc.App.Mb.pF({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}tqc(a,b,c,f,l){return this.qya(l,6)}oqc(a,b,c,f,l){return this.qya(l,7)}iqc(a,b,c,f,l){return this.qya(l,9)}yqc(a,b,c,f,l){return this.qya(l,8)}M0i(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}L0i(a){return!a.media.plyAcrssSldsField&&
!a.media.repeatField&&!!a.media.strtField}Osg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}qya(a,b){if(a=Object(sa.a)(gi.a,a)){const c=this.jb.Qf();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.L0i(l);break;case 1:f=this.M0i(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=
!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.If(f)}}return 32}Hcc(){return!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp}}Object(m.a)(SM,"AudioPlaybackOptionsActor",null,[268]);class TM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=
this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(m.a)(TM,"AudioSettingsTaskPaneProps",null,[]);class Au{constructor(){this.text=this.key=null;this.itemType=0;this.selected=!1}}Object(m.a)(Au,"DropdownOption",null,[]);class UM{constructor(a,b,c,f,l){this.HM=null;this.RHa=this.Ab=!1;a("audio-settings-strings").then(()=>{this.RHa=
!0;ya.a.J(509138197,833,50,"audio-settings-strings loaded successfully")}).catch(y=>{ya.a.J(509138196,833,10,"Failed to load audio-settings-strings "+y.toString())});this.ia=b;this.LB=f;this.Jc=c;this.EO=l}vb(){this.ia.ya(ea.a.mvd,qc.a.application,Object(H.a)(this,this.mvd,"showHideAudioSettingsPane"));this.ia.ra(ea.a.ELb,qc.a.application,Object(H.a)(this,this.ELb,"queryShowHideAudioSettingsPane"),96)}me(){}mvd(a,b,c){return b.contextId===qc.a.application&&this.RHa?1===c?32:Vg.a("AudioSettingsPaneToggle",
a,()=>{(this.Ab=!this.Ab)?(this.kl(),this.EO.Xhi(Object(H.a)(this,this.i$g,"onAudioDevicesChanged")),ya.a.J(509138195,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.EO.Ial(Object(H.a)(this,this.i$g,"onAudioDevicesChanged")),this.eH(),ya.a.J(509138194,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));return 32}):2}ELb(a,b,c,f,l){if(!Object(Sa.a)(gi.a,l))return 8;l.If(this.Ab);return 32}kl(a=!1){a||this.kA();const b=Object.assign(new yu.a,{title:ResourceStrings.L_AudioSettings,
hideHeader:!1,width:320,location:2,contentProps:this.HM,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.LB.C4(xa.a.LCa,xa.a.$i,c,()=>{this.XA(!0)},()=>{this.XA(!1)});Mj.UISurfaces.Iq().then(f=>{a?this.Ab&&f.updateTaskPane(xa.a.LCa,b):f.showTaskPane(xa.a.LCa,b);return null}).catch(f=>{ya.a.J(509138193,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}eH(){Mj.UISurfaces.Iq().then(a=>{a.hideTaskPane(xa.a.LCa,
2);return null}).catch(a=>{ya.a.J(509138192,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}kA(){this.HM=Object.assign(new TM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.Gwj(),availableSubtitleLanguages:this.sxj(),onMicrophoneUpdated:Object(H.a)(this,this.UTl,"updateMicrophone"),onSpeakersUpdated:Object(H.a)(this,this.oVl,"updateSpeaker"),onSpokenLanguageUpdated:Object(H.a)(this,this.rVl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(H.a)(this,
this.xVl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.EO.enumerateDevices(Object(H.a)(this,this.hnc,"onEnumerateDevicesSuccess"),Object(H.a)(this,this.t_a,"onDevicesFailure"),Object(H.a)(this,this.D_a,"onUnsupported"))}XA(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");a&&b&&b.focus()}hnc(a){if(0!==a.length)if(na.a.Xa(a[0].label))this.EO.requestPermission(Object(H.a)(this,this.fLk,"onRequestPermissionSuccess"),
Object(H.a)(this,this.t_a,"onDevicesFailure"),Object(H.a)(this,this.D_a,"onUnsupported")),ya.a.J(509138191,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Oa.a,c=new Oa.a;for(const f of a)na.a.Xa(f.deviceId)||(a=Object.assign(new Au,{key:f.deviceId,text:na.a.Xa(f.label)?f.deviceId:f.label}),"audiooutput"===f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.HM.deviceMicrophones=
b.toArray();this.HM.deviceSpeakers=c.toArray();this.HM.disableDeviceDropdown=!1;this.HM.showDeviceErrorMessage=!1;this.kl(!0)}}fLk(){this.EO.enumerateDevices(Object(H.a)(this,this.hnc,"onEnumerateDevicesSuccess"),Object(H.a)(this,this.t_a,"onDevicesFailure"),Object(H.a)(this,this.D_a,"onUnsupported"));ya.a.J(509138190,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}t_a(a){this.HM.disableDeviceDropdown=!0;this.HM.showDeviceErrorMessage=!0;this.kl(!0);
ya.a.J(509138189,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}D_a(){this.HM.disableDeviceDropdown=!0;this.kl(!0);ya.a.J(509138188,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",z.a.mz)}UTl(a){this.EO.microphoneDeviceId=a.key;ya.a.J(509138187,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}oVl(){ya.a.J(509138186,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}i$g(a,
b){b.Bzk&&this.EO.enumerateDevices(Object(H.a)(this,this.hnc,"onEnumerateDevicesSuccess"),Object(H.a)(this,this.t_a,"onDevicesFailure"),Object(H.a)(this,this.D_a,"onUnsupported"))}Gwj(){const a=new Oa.a;for(let b of this.Jc.q6e)a.add(Object.assign(new Au,{key:b,text:ab.a.He(b).displayName,selected:this.Jc.Ipa.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new Au,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new Au,{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,
itemType:2}));for(let b of this.Jc.p6e)a.add(Object.assign(new Au,{key:b,text:ab.a.He(b).displayName,selected:this.Jc.Ipa.toLowerCase()===b.toLowerCase()}));return a.toArray()}sxj(){const a=new Oa.a;for(let b of this.Jc.a5e)a.add(Object.assign(new Au,{key:b,text:ab.a.He(b).displayName,selected:this.Jc.aAa.toLowerCase()===b.toLowerCase()}));return a.toArray()}rVl(a){this.Jc.Ipa=a.key;ya.a.J(509138185,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}xVl(a){this.Jc.aAa=
a.key;this.Jc.onb=this.Jc.JYc();ya.a.J(509138184,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(m.a)(UM,"AudioSettingsPaneActor",null,[268]);class VM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(m.a)(VM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Yv{constructor(a,b,
c,f,l,y,G,R,ja,za){this.EMg=!1;a("powerpoint-discoverability-strings").then(()=>{this.EMg=!0;ya.a.J(509138209,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Va=>{ya.a.J(509138208,801,10,"Failed to load powerpoint-discoverability-strings "+Va.toString())});this.ia=b;this.Fc=c;this.ic=f;this.le=l;this.LB=y;this.Jc=G;this.EO=R;this.Jok=za;this.Iuk=ja;this.x0g=Ti.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.shc=!1;this.Fc.B7a(Object(H.a)(this,this.kga,"onRibbonTabSwitched"))}dispose(){this.Fc.Lrc(Object(H.a)(this,
this.kga,"onRibbonTabSwitched"))}vb(){this.ia.ya(ea.a.Duc,qc.a.application,Object(H.a)(this,this.Duc,"showCaptionDiscoverabilityPane"))}me(){}Duc(a,b,c){if(b.contextId!==qc.a.application||!this.EMg)return 2;if(1===c)return 32;if(Yv.ype||Yv.q5d||!this.H5i()||!this.G5i())return 8;this.shc||this.FBi(a);return 32}FBi(a){Vg.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.shc=!0;this.EO.enumerateDevices(Object(H.a)(this,this.$Ek,"onAudioInputAvailable"),Object(H.a)(this,this.t_a,
"onDevicesFailure"),Object(H.a)(this,this.D_a,"onUnsupported"));return 32})}$Ek(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.Iuk.qWa()){Yv.ype=!0;this.kl();break}this.shc=!1}}t_a(a){this.shc=!1;ya.a.J(509138207,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}D_a(){this.shc=!1;ya.a.J(509138206,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",z.a.mz)}kl(){const a=this.kA(),b=Object.assign(new yu.a,
{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{ya.a.J(509138205,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{ya.a.J(509138204,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.LB.C4(xa.a.ARa,xa.a.$i,null,()=>{},()=>{});Mj.UISurfaces.Iq().then(c=>{c.showTaskPane(xa.a.ARa,b);return null}).catch(c=>{ya.a.J(509138203,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",c.toString())})}Kq(){Mj.UISurfaces.Iq().then(a=>
{a.hideTaskPane(xa.a.ARa,2);return null}).catch(a=>{ya.a.J(509138202,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}kA(){return Object.assign(new VM,{podiumPresentationImageUrl:this.le.qk("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.x0g,onTurnOnButtonClicked:Object(H.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(H.a)(this,this.onDismissButtonClicked,"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(H.a)(this,
this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){Vg.a("CaptionDiscoverabilityPaneTurnOn",ea.a.VMa,()=>{let a=8;this.Jc.Rh||(a=this.ia.Ja(ea.a.VMa,2,{}));this.Jok&&8!==a||this.Kq();return a})}onDismissButtonClicked(){this.x0g&&(Yv.q5d=!0,ya.a.J(509138201,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Kq()}onLaunchSlideShowButtonClicked(){Vg.a("CaptionDiscoverabilityPaneLaunchSlideshow",ea.a.BPb,()=>{this.Kq();return this.ia.processAction(ea.a.BPb,
2)})}kga(a,b){2!==b.Uu&&3!==b.Uu&&4!==b.Uu||!b.Zfa||"SlideShow"!==b.Zfa||Vg.a("OnRibbonTabSwitched",ea.a.Duc,()=>this.ia.processAction(ea.a.Duc,2))}G5i(){let a=0,b=!1,c=!1;for(var f of this.ic.MTa()){if(f.Wm){b=!0;break}if(f.pFa&&(a+=f.CQ.length,4<=a))break;if(f.sbb){c=!0;break}}f=c||b||4<=a;ya.a.J(509138200,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",f.toString(),a.toString(),b.toString(),c.toString());return f}H5i(){return!this.Jc.Rh&&
this.o5i()}o5i(){const a=ab.a.He(w.AFrameworkApplication.lcid);return!a||na.a.Xa(a.name)?!1:a.name.toLowerCase()===this.Jc.Ipa}static get ype(){var a=Ti.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set ype(a){Ti.a.qK("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),Ti.a.aK)||ya.a.J(509138199,822,10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get q5d(){const a=
Ti.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set q5d(a){Ti.a.qK("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),Ti.a.aK)||ya.a.J(509138198,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(m.a)(Yv,"CaptionDiscoverabilityPaneActor",null,[268]);var WM=d(747);class tt{constructor(a,b){this.id=a;this.version=b}}Object(m.a)(tt,"PackageAccessKey",null,[]);const Zv=a=>a?Nd.c({["I"]:a.id,["V"]:a.version}):null;var Sp=
d(339),XM=d(973);class dy extends XM.a{constructor(a,b,c){super(a,b);this.hba=c}}Object(m.a)(dy,"ClipServiceShapeCopyParams",XM.a,[]);var xE=d(691),yE=d(729),zE=d(451);class ey{constructor(a,b,c){this.ia=a;this.Fa=b;this.xIa=c}FQ(a){a=ey.Z7b(a);return this.xIa.Uac(this.Fa)&&!!a&&!!a.src}paste(a){w.AFrameworkApplication.dR?zE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.ia.Ja(ea.a.Ioc,2,a)}static Z7b(a){if(!a||!a.kn)return ya.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),
null;a=a.kn.getElementsByTagName(k.a.z4);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(m.a)(ey,"ImagePasteHandler",null,[484]);var zm=d(441);class AE{constructor(){this.jkh=this.B5d=null}}Object(m.a)(AE,"PasteSlideAsImageData",null,[]);class BE{constructor(){this.pastedContent=this.dya=null}}Object(m.a)(BE,"PasteSlideAsImageFromRibbonData",null,[]);var CE=d(696);class DE extends Sys.EventArgs{constructor(a,b,c){super();this.Kp=a;this.LAi=b;this.MAi=c}}Object(m.a)(DE,"UpdateCcpInfoEventArgs",
Sys.EventArgs,[]);class YM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(m.a)(YM,"CopiedShape",null,[]);class ZM{constructor(){this.Cid=this.Sid=0}}Object(m.a)(ZM,"CopiedSlide",null,[]);class EE extends Xf.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=null}ul(){return 65}}Object(m.a)(EE,"CopyRequest",Xf.a,[]);class fy{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,
ff,bh,ch,of){this.IDe=this.rwa=null;this.ia=a;this.FO=f;this.Fa=l;this.fc=y;this.ua=G;this.Fb=R;this.uM=jc;this.ei=ja;this.Ub=za;this.Mx=Va;this.iHa=hb;this.Eb=Cb;this.kj=lc;this.la=b;this.pa=ic;this.yBg=yc;this.Jqk=xd;this.xe=ec;this.Sb=Xd;this.Kqk=Qd;this.Ps=Ie;this.uFe=this.la.etg;this.MGe=this.la.Ruh;this.Sp=Pe;this.Dc=ig;this.HA=ff;this.Tv=bh;this.AQg=ch;this.CH=of;if(!this.HA)throw ya.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");
}vb(){this.ia.ra(ea.a.t1d,qc.a.application,Object(H.a)(this,this.$Dj,"handleCopySlidesToClipService"),0);this.ia.ra(ea.a.lmd,qc.a.application,Object(H.a)(this,this.Kge,"handlePasteSlidesFromClipService"),4);this.ia.ra(ea.a.Joc,qc.a.application,Object(H.a)(this,this.UGj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.ra(ea.a.bKb,qc.a.application,Object(H.a)(this,this.VGj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.ra(ea.a.UTe,qc.a.application,Object(H.a)(this,
this.fod,"queryPasteOptions"),97);this.ia.ra(ea.a.VPf,qc.a.application,Object(H.a)(this,this.ZDj,"handleCopyShapesToClipService"),0);this.ia.ra(ea.a.phh,qc.a.application,Object(H.a)(this,this.RGj,"handlePasteShapesFromClipService"),4);this.ia.ra(ea.a.rhh,qc.a.application,Object(H.a)(this,this.Jge,"handlePasteSlideFromDesktop"),4);this.ia.ra(ea.a.kmd,qc.a.application,Object(H.a)(this,this.SGj,"handlePasteSlideAsImage"),4);this.ia.ra(ea.a.qhh,qc.a.application,Object(H.a)(this,this.TGj,"handlePasteSlideAsImageFromRibbon"),
4);this.ia.ra(ea.a.gTf,qc.a.application,Object(H.a)(this,this.aEj,"handleCutShapes"),4);this.ia.ra(ea.a.y7d,qc.a.application,Object(H.a)(this,this.y7d,"expandPasteFloatieMenu"),96);this.ia.ra(ea.a.hTf,rb.a.application,Object(H.a)(this,this.bEj,"handleCutSlides"),4);this.ia.ra(ea.a.uhh,rb.a.application,Object(H.a)(this,this.KGj,"handlePasteCancelledByUser"),2048)}me(){}TGj(a,b,c,f,l){ya.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(sa.a)(BE,l);if(!a||!a.dya)return ya.a.J(512356639,
826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===c)return 32;c=a.dya.Wb;b=this.Dc.BP(2,1,"HandlePasteSlideAsImageFromRibbon");this.Dc.li("PasteSlideAsImageFromRibbon",c,b);a.dya.Wb=b;this.HA.paste(a.dya,a.pastedContent,!0);return 32}SGj(a,b,c,f,l){a=Object(sa.a)(AE,l);if(!a||!a.B5d)return ya.a.J(512356638,826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.HA.kmd(a.B5d,a.jkh);return 32}y7d(a,b,c){if(1===c)return 32;
this.Jqk.n1k();return 32}fod(a,b,c,f,l){if(!this.Ps||!this.Ps.Wib)return 8;a=this.Ps.Wib.YA;l.SourceControlId&&("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[Ih.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[Ih.a.On]=null!=a&&a));return 32}VGj(a,b,c,f){if(1===c)return 32;const l=this.Ps.Wib;if(!l)return 8;const y=l.Pu,G=l.$M;if(!y&&!G)return 8;if(null!=l.YA&&l.YA)return 32;l.Wb=this.Dc.BP(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");
l.YA=!0;const R=this.Sb.zx(this.Ps.ZPe);ya.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");if(G)return G.skipUndo=!0,G.selectionSlide=R,this.Jge(a,b,c,f,l);y.skipUndo=!0;y.selectionSlide=R;return this.Kge(a,b,c,f,l)}UGj(a,b,c,f){if(1===c)return 32;const l=this.Ps.Wib;if(!l)return 8;const y=l.Pu,G=l.$M;if(!y&&!G)return 8;if(null!=l.YA&&!l.YA)return 32;l.Wb=this.Dc.BP(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.YA=!1;const R=this.Sb.zx(this.Ps.ZPe);
ya.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(G)return G.skipUndo=!0,G.selectionSlide=R,this.Jge(a,b,c,f,l);y.skipUndo=!0;y.selectionSlide=R;return this.Kge(a,b,c,f,l)}ZDj(a,b,c,f,l){a=Object(sa.a)(dy,l);if(!a)return ya.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.Pu;c=a.hba;if(!b||!c||!c.length)return ya.a.J(512356634,307,50,"Copied shapes are empty."),this.Dc.Lg(!1,a.Wb,23),8;if(this.fc.LVa())return this.Dc.Lg(!1,a.Wb,
2),16;if(Ub.a.any(c,G=>G.H4))return ya.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];for(var y of c)f.push(Object.assign(new YM,{Sid:y.slideSid,Cid:y.slideCid,ShapeId:y.get_shapeId()}));y=Object.assign(new EE,{CcpId:b.Kp,Location:b.location,Shapes:f,CcpCorrelation:a.Wb,PackageAccessKey:Zv(new tt(a.Pu.Py,b.version))});this.CSc(y,2,a.Wb);return 32}RGj(a,b,c,f,l){b=Object(sa.a)(zm.a,l);if(!b)return 8;3!==b.Pu.dataType?this.Dc.jC(2,b.Wb):(this.Dc.jC(7,b.Wb),
this.Dc.Yw(5,b.Wb));c=b.Pu;if(!c)return this.Dc.Lg(!1,b.Wb,16),ya.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),8;3!==b.Pu.dataType&&this.Dc.Yw(yE.ClipboardHelper.Tog(c)?2:3,b.Wb);f=this.ua.Ba;if(!f||!f.isConnected)return this.Dc.Lg(!1,b.Wb,3),ya.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",f?"not null":"null"),16;if(this.fc.fd(f))return this.Dc.Lg(!1,b.Wb,3),ya.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),
2;if(!this.kj.hD(f,c.objectCount))return this.Dc.Lg(!1,b.Wb,8),ya.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),this.kj.KD(f),16;this.iTd(c.Kp,b.Wb);Kc.a.fAa("PasteShapesFromClipService",!0);Kc.a.KP(!1,!1);this.IDe&&this.IDe===c.Kp||(this.rwa=new Qe.a(0));f.ON=c.Kp;f.uQ=c.location;f.J3=c.OD;f.y_=fy.n8e(c.sta);f.Py=Zv(new tt(c.Py,c.version));l=null;this.Dc.zcc(b.Wb)&&(l=ey.Z7b(b));if(this.MGe&&3===b.Pu.dataType)try{let y=0;this.rwa&&
this.rwa.Gb(f.Cb)&&(y=this.rwa.ga(f.Cb));this.fc.xXd(f,a,y);ya.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(y){ya.a.J(512356627,307,10,"HandlePasteShapesFromClipService: failed to show shimmer view")}this.iHa.fTi(f,c,this.rwa,a,b.Wb,l);this.IDe=c.Kp;this.Dc.Lg(!0,b.Wb);return 32}aEj(a,b,c,f,l){if(this.fc.LVa())return 16;if(1===c)return 32;Kc.a.KP(!0,!0);const y=this.pa.Qf();b=this.pa.Fk();var G=f=c=null;let R=[];l=Object(sa.a)(dy,l);if(!l)return 8;if(l.Pu){var ja=
l.Pu;R=l.hba;if(!R||!R.length)return 8;c=ja.Kp;G=ja.version;f=ja.location;G=Zv(new tt(ja.Py,G))}else for(ja of y)ja.h4c&&R.push(ja);for(var za of R)if(za.Of||za.Ug){On(za);break}za=this.Fb.yd(15,void 0,()=>{this.pa.nh()});try{za.jc(b),za.gd=a,this.yBg.Cnh(new DE(c,f,G)),b.Wb=l.Wb,b.cS(R)}finally{za&&za.dispose()}for(const Va of R)this.Sp.lnh(new sK.a(Va));this.FO.Hse=c;return 32}bEj(a,b,c,f,l){b=this.pa.Re();if(!b||!b.length||!this.ua.Ba)return 16;for(var y of b)if(!y||this.fc.fd(y)||!y.isConnected)return 16;
if(1===c)return 32;Kc.a.Kb&&(Kc.a.Kb.actionName="CutSlide",Kc.a.Kb.$p=!1,Kc.a.Kb.Qj=!0,Kc.a.Kb.HF=new Date,Kc.a.Kb.Wa("SlideCount",b.length.toString()));f=y=c=null;var G=[];l=Object(sa.a)(xE.a,l);if(!l)return 8;if(l.Pu){f=l.Pu;G=l.aGh;if(!G||!G.length)return 8;c=f.Kp;G=f.version;y=f.location;f=Zv(new tt(f.Py,G))}G=this.Ub.Gf;if(!G)return 16;const R=this.Fb.yd(15,void 0,()=>{this.pa.nh()});try{this.yBg.Cnh(new DE(c,y,f));R.jc(G);for(const ja of b)ja&&!ja.Cb.equals(this.ua.Ba.Cb)&&G.TI(ja);G.TI(this.ua.Ba);
R.gd=a;G.Wb=l.Wb}finally{R&&R.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.fc.uw(G,a);this.Sp?this.Sp.jpd(new CE.a(b)):ya.a.J(512356626,826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.FO.Hse=c;return 32}CSc(a,b){this.FO.gFk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",Sp.a.type,WM.a(b))];Kc.a.yk("CcpId",a.CcpId);c=new Hj.a(a,()=>{this.pGk(a)},f=>this.oGk(f,a,b),f=>0===f.StatusCode,void 0,c);ya.a.J(512356625,307,
50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.ei.Hb(c)}pGk(a){this.FO.K9g(!0,a)}oGk(a,b,c){ya.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",WM.a(c),b.CcpId,a.StatusCode));this.FO.K9g(!1,b);return!0}iTd(a,b){const c=Kc.a.Kb;c&&(c.Wa("CcpId",a),this.Dc.li("CcpId",a,b))}$Dj(a,b,c,f,l){a=Object(sa.a)(xE.a,l);if(!a||!a.Pu)return ya.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",
a?"not null":"null"),8;ya.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.Pu.Kp);b=a.aGh;if(!b||!b.length||0>=lj.e(b,y=>Object(Sa.a)(116,y)).length)return ya.a.J(512356621,307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Ub.a.any(b,y=>y.hasDeferredContent))return ya.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),8;b=Object.assign(new EE,{CcpId:a.Pu.Kp,Location:a.Pu.location,MultiSlideCopy:!0,
Slides:lj.c(b,y=>Object.assign(new ZM,{Sid:y.sid,Cid:y.cid})),CcpCorrelation:a.Wb,PackageAccessKey:Zv(new tt(a.Pu.Py,a.Pu.version))});this.CSc(b,1,a.Wb);return 32}Jge(a,b,c,f,l){if(1===c)return 32;b=Object(sa.a)(zm.a,l);if(!b)return ya.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.$M;if(!c||na.a.Xa(c.ccpid)||na.a.Xa(c.data))return ya.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",c?c.ccpid:"null")),this.Dc.Lg(!1,
b.Wb,28),8;Kc.a.fAa("PasteSlideFromDesktop",!0);this.iTd(c.ccpid,b.Wb);this.Dc.Yw(12,b.Wb);f={};f.CcpCorrId=b.Wb;return this.Bhg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.YA?b.YA:!0,c.ccpid,null,null,w.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}Kge(a,b,c,f,l){if(1===c)return 32;b=Object(sa.a)(zm.a,l);if(!b)return ya.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Kc.a.fAa("PasteSlidesFromClipService",!0);c=b.Pu;if(!c)return this.Dc.Lg(!1,
b.Wb,16),ya.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.Dc.Yw(yE.ClipboardHelper.Tog(c)?2:3,b.Wb);this.iTd(c.Kp,b.Wb);f=this.Mx.uoe(c);return!this.la.$sg&&f?(this.Dc.Lg(!1,b.Wb,17),ya.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.Bhg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.YA?b.YA:!0,c.Kp,c.location,c.OD,c.Py,c.version,c.sta,null,!1)}Bhg(a,b,c,f,l,y,G,R,ja,za,Va,
hb,Cb,lc){this.Dc.jC(19,a.Wb);const ic=this.ua.presentation;if(!ic)return this.Dc.Lg(!1,a.Wb,3),ya.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.fc.fd(ic))return this.Dc.Lg(!1,a.Wb,3),ya.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var yc=this.ua.Ba;if(yc&&!yc.isConnected)return this.Dc.Lg(!1,a.Wb,3),ya.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),
16;ya.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),y.toString()));this.uFe&&!this.Mx.zog(a)&&this.Kqk.Dgi();this.Ps.i5c=Date.now();this.uM.pX(this.Sb.yn)&&ya.a.J(512356612,307,50,"cross session paste slide happened before last action server result is not returned");Kc.a.KP(!1,!1);let ec;var jc=null;yc=this.la.Pvd&&!na.a.Xa(Cb)&&1!==this.Eb.al;if(c)jc=f,ec=null;else{jc=this.ua.presentation;if(!jc)throw Error.argumentNull("Presentation is null");
ec=Array.isArray(jc.gSf(l,a.Wb,yc))?jc.gSf(l,a.Wb,yc):null;f=jc=this.erj();this.Ps.position=null;this.Ps.ZPe=jc?jc.slideIndex:0}l=null;c||(l=()=>{let xd;(xd=this.pa).yP.apply(xd,ec)});l=this.Fb.yd(15,void 0,()=>{this.Fa.wf(xa.a.lF)},l);try{if(l.jc(ic),l.gd=c?ic.gdb?ea.a.bKb:ea.a.Joc:b,yc?(ic.Mua=!0,this.Tv.init(G)):(ic.ON=G,ic.gdb=y,ic.XPe=jc?jc.Cb:null,ic.uQ=R,ic.J3=ja,ic.y_=fy.n8e(hb),ic.skipUndo=c,ic.Py=Zv(new tt(za,Va)),ic.IBb=null==lc?!1:lc,ic.Koc=Cb,ic.Wb=a.Wb),!c){R=jc;for(ja=0;ja<ec.length;ja++)this.la.Xn?
ic.Tbb(ec[ja],R,null,!0):ic.Tbb(ec[ja],R,null),R=ec[ja],yc&&(ec[ja].Mua=!0,this.Tv.ela.add(ec[ja].id));this.Ub.Ba=ec[ec.length-1];this.xe.Q9a=!0}}finally{l&&l.dispose()}yc?(this.Tv.izd(!0),this.fc.blockContent(ic,b)):this.fc.uw(ic,b);this.Ps.Wib=a;this.Ps.ZOb=!0;this.Ps.oKa=null;this.xe.Q9a=!0;this.Ps.j4b=this.Sb.yn.hI;yc&&(this.Dc.li("DisplayNewPasteProgressUX","true",a.Wb),this.iUi(Cb,w.AFrameworkApplication.userSessionId,jc,c,y,G,hb,lc,a.Wb));this.Dc.Lg(!0,a.Wb);return 32}iUi(a,b,c,f,l,y,G,R,ja){const za=
this.Dc.BP(2,0,"DataUploadInit");this.Dc.Yw(13,za);this.Dc.jC(19,za);this.Dc.li("DataUploadInitOldCcpCorrId",ja,za);this.Tv.aSl(za);const Va=(new Date).getTime();this.AQg.UFl(a,b,y,()=>{const hb=(new Date).getTime()-Va;ya.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",y,hb);this.Dc.li("DataUploadTime",hb.toString(),za);this.hUi(za,b,c,f,l,y,G,R)},hb=>{ya.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",
y,Ql.a[hb.error.Code],(new Date).getTime()-Va);this.cEj();this.Dc.Lg(!1,za,30)})}hUi(a,b,c,f,l,y,G,R){const ja=this.ua.presentation;if(ja){this.Tv.kDk();Kc.a.KP(!1,!1);ya.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.Tv.ela.toArray().join(",").toString());var za=this.Fb.yd(15);try{za.jc(ja),za.gd=ea.a.bKb,ja.XPe=c?c.Cb:null,ja.i2b=b,ja.Loc=this.Tv.ela.toArray().join(",").toString(),ja.ON=y,ja.y_=fy.n8e(G),ja.skipUndo=f,ja.IBb=null==R?!1:R,ja.gdb=l,ja.Wb=a}finally{za&&za.dispose()}this.Dc.Lg(!0,
a)}else ya.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}KGj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return ya.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;ya.a.J(512356578,307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.AQg.uAi(a);this.Dc.Lg(!1,l,31);return 32}cEj(){this.Tv.oKf(!0);this.CH.kba(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,
!1,null,!1,null,0,0,null,null,!0,20,!1,null)}eEl(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}erj(){const a=this.pa.Re();return 0<a.length&&(this.eEl(a),a[0])?a[0]:this.ua.Ba}static n8e(a){return JSON.stringify(a)}}Object(m.a)(fy,"ClipServiceActor",null,[268]);class FE{constructor(){this.actionId=0;this.context=null;this.behavior=0;this.vd=this.mK=null}}Object(m.a)(FE,"AActionArgs",null,[]);class GE extends FE{constructor(){super()}}Object(m.a)(GE,"ActionArgs$2",FE,[]);class HE extends GE{constructor(){super()}}
Object(m.a)(HE,"ActionArgs$1",GE,[]);var Qq=d(401),Bu=d(394);class ut{constructor(a,b=!1){this.jpg=!0;this.Wb=null;this.dataType=0;this.E5i=a;this.vea=b}}Object(m.a)(ut,"CutCopyParams",null,[]);var $v=d(450),$M=d(389);class $z{constructor(a,b,c,f){this.ia=a;this.Sok=f;this.xIa=c;this.Fa=b}FQ(a){return this.xIa.Uac(this.Fa)&&!!$z.c9f(a)}paste(a){this.Sok?zE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(ya.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),
this.ia.Ja(ea.a.eya,2,a))}static c9f(a){return a&&a.kn?(a=a.kn.getElementsByTagName(k.a.Pmb))&&a.length?a[0]:null:null}}Object(m.a)($z,"TablePasteHandler",null,[484]);class il{static get bB(){return Fb.a.instance.rb("PowerPointWebEditor.ISystemClipboard")}}Object(m.a)(il,"SystemClipboardFactory",null,[]);class aN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og,pi,Wj){this.rwa=this.Wad=null;this.KEg=0;this.Lad=!1;this.gIj=(wg,Tg,Dh,Mm,Jj)=>{if(1===Dh)return 32;
wg=this.wY.zH;Jj&&Jj.SourceControlId&&("PasteAsPlainText"==Jj.SourceControlId?Jj[Ih.a.On]=wg===C.a.u6||wg===C.a.y0a||wg===ea.a.pasteAsPlainText:"PasteTextKeepingSourceFormatting"==Jj.SourceControlId?Jj[Ih.a.On]=wg===C.a.z8||wg===C.a.paste||wg===C.a.reformatPastedContent||wg===ea.a.Coa:this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&"PasteTextMergeFormatting"==Jj.SourceControlId&&(Jj[Ih.a.On]=wg===C.a.aMb||wg===ea.a.fya));return 32};this.aHj=(wg,Tg,Dh)=>{if(2==Dh){wg=this.wY.zH;if(wg===
C.a.u6||wg===C.a.y0a)return 32;this.ia.processAction(C.a.y0a,Dh)}return 32};this.ZGj=(wg,Tg,Dh)=>{if(2==Dh){wg=this.wY.zH;if(wg===C.a.z8||wg===C.a.paste||wg===C.a.reformatPastedContent)return 32;this.ia.processAction(C.a.reformatPastedContent,Dh)}return 32};this.kIj=(wg,Tg,Dh)=>{if(1==Dh||this.wY.zH===ea.a.pasteAsPlainText)return 32;this.aUd(wg);this.Xs.undo();return 32};this.mIj=(wg,Tg,Dh)=>{if(1==Dh||this.wY.zH===ea.a.Coa)return 32;this.aUd(wg);this.Xs.undo();return 32};this.lIj=(wg,Tg,Dh)=>{if(1==
Dh||this.wY.zH===ea.a.fya)return 32;this.aUd(wg);this.Xs.undo();return 32};this.$Gj=(wg,Tg,Dh)=>{if(1==Dh)return 32;if(2==Dh){if(this.wY.zH===C.a.aMb)return 32;this.ia.processAction(C.a.aMb,Dh)}return 32};this.zwh=(wg,Tg)=>{wg=Tg.node;null!=wg&&wg==this.zFb&&(this.zFb=wg,this.NNg=Tg.revisionId.toString())};this.Jwh=(wg,Tg)=>{Tg&&Tg.revisionId&&(this.DFb=Tg.revisionId.toString())};this.wMh=(wg,Tg)=>{Tg.GD&&Tg.GD.Id&&Tg.GD.Id==this.DFb&&(this.pXa.I4(this.Ub.Gf)||setTimeout(()=>{this.ia.processAction(ea.a.pasteAsPlainText,
2);this.aXe(ea.a.lrc);this.DFb=null},0))};this.xMh=(wg,Tg)=>{Tg.GD&&Tg.GD.Id&&Tg.GD.Id==this.DFb&&(this.pXa.I4(this.Ub.Gf)||setTimeout(()=>{this.ia.processAction(ea.a.Coa,2);this.aXe(ea.a.nrc);this.DFb=null},0))};this.vMh=(wg,Tg)=>{Tg.GD&&Tg.GD.Id&&Tg.GD.Id==this.DFb&&(this.pXa.I4(this.Ub.Gf)||setTimeout(()=>{this.ia.processAction(ea.a.fya,2);this.aXe(ea.a.mrc);this.DFb=null},0))};this.V6g=(wg,Tg)=>{Tg.GD&&Tg.GD.Id&&this.NNg==Tg.GD.Id&&(null==this.zFb||this.pXa.I4(this.zFb)||setTimeout(()=>{this.ia.processAction(ea.a.X7a,
2);if(this.wY.Qua){const Dh=new Cj.a;Dh.zuc=!0;this.lGb.SLb(Dh)}else this.lGb.hVe(new Pj(1,w.AFrameworkApplication.isRtl));this.P$k();this.NNg=this.zFb=null},0))};if(!ch)throw Error.argumentNull("DeferredContentManager");if(R.ka("IsPasteTextFloatieEnabled")){if(!sg)throw Error.argumentNull("pasteFloatieEventSource");if(!Fg)throw Error.argumentNull("coldHotManager");if(!og)throw Error.argumentNull("shapeGraphNodeEventHandlers");if(!pi)throw Error.argumentNull("graphOperationEventHandler");if(!Wj)throw Error.argumentNull("undoManager");
}this.ia=a;this.Fa=b;this.pa=c;this.Zg=Cb;this.fc=za;this.Cma=Va;this.HA=hb;this.Ub=f;this.qq=l;this.Lw=ch;this.Fb=y;this.wA=G;this.Qq=ja;this.iHa=lc;this.Sb=ic;this.wk=yc;this.Eb=ec;this.FDg=jc;this.aeb=xd;this.kj=Xd;this.lR=Qd;this.$Xa=Pe;this.wb=ig;this.B$=ff;this.Dc=bh;this.la=R;this.wY=of;this.lGb=sg;this.pXa=Fg;this.skc=og;this.Rf=pi;this.Xs=Wj}vb(){this.la.t1c?(this.ia.ra(ea.a.cwb,qc.a.application,Object(H.a)(this,this.Lgg,"handleCutCopyToSystemClipboardAsync"),4),this.ia.ra(ea.a.q3b,qc.a.application,
Object(H.a)(this,this.Lgg,"handleCutCopyToSystemClipboardAsync"),0),this.ia.ra(ea.a.Coa,qc.a.application,Object(H.a)(this,this.Azb,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(ea.a.kKa,qc.a.application,Object(H.a)(this,this.Azb,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(ea.a.lKa,qc.a.application,Object(H.a)(this,this.Azb,"handlePasteFromSystemClipboardAsync"),4),this.ia.ra(ea.a.J_a,qc.a.application,Object(H.a)(this,this.Azb,"handlePasteFromSystemClipboardAsync"),4),this.la.ka("IsPasteTextFloatieEnabled")&&
(this.ia.ra(ea.a.pasteAsPlainText,qc.a.application,Object(H.a)(this,this.Azb,"handlePasteFromSystemClipboardAsync"),4),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.ia.ra(ea.a.fya,qc.a.application,Object(H.a)(this,this.Azb,"handlePasteFromSystemClipboardAsync"),4))):(this.ia.ra(ea.a.cwb,qc.a.application,Object(H.a)(this,this.Kgg,"handleCutCopyToSystemClipboard"),4),this.ia.ra(ea.a.q3b,qc.a.application,Object(H.a)(this,this.Kgg,"handleCutCopyToSystemClipboard"),0),this.ia.ra(ea.a.Coa,
qc.a.application,Object(H.a)(this,this.zzb,"handlePasteFromSystemClipboard"),4),this.ia.ra(ea.a.kKa,qc.a.application,Object(H.a)(this,this.zzb,"handlePasteFromSystemClipboard"),4),this.ia.ra(ea.a.lKa,qc.a.application,Object(H.a)(this,this.zzb,"handlePasteFromSystemClipboard"),4),this.ia.ra(ea.a.J_a,qc.a.application,Object(H.a)(this,this.zzb,"handlePasteFromSystemClipboard"),4),this.la.ka("IsPasteTextFloatieEnabled")&&(this.ia.ra(ea.a.pasteAsPlainText,qc.a.application,Object(H.a)(this,this.zzb,"handlePasteFromSystemClipboard"),
4),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.ia.ra(ea.a.fya,qc.a.application,Object(H.a)(this,this.zzb,"handlePasteFromSystemClipboard"),4)));this.ia.ra(ea.a.UPf,qc.a.application,Object(H.a)(this,this.YDj,"handleCopyShapes"),0);this.ia.ra(ea.a.imd,rb.a.application,Object(H.a)(this,this.QGj,"handlePasteShapes"),4);this.ia.ra(ea.a.Ioc,qc.a.application,Object(H.a)(this,this.PGj,"handlePastePicture"),4);this.ia.ra(ea.a.eya,rb.a.application,Object(H.a)(this,this.XGj,"handlePasteTable"),
4);this.ia.ra(ea.a.jmd,qc.a.application,Object(H.a)(this,this.WGj,"handlePasteSlides"),4);this.ia.ra(ea.a.bQe,qc.a.application,Object(H.a)(this,this.YGj,"handlePasteTextIntoNewShape"),4);this.ia.bT(ea.a.$ih,qc.a.application,Object(H.a)(this,this.vDj,"handleBrowserCut"),4);this.ia.bT(ea.a.Ymd,qc.a.application,Object(H.a)(this,this.uDj,"handleBrowserCopy"),0);this.ia.bT(ea.a.Zmd,qc.a.application,Object(H.a)(this,this.wDj,"handleBrowserPaste"),4);this.ia.bT(ea.a.jjh,qc.a.application,Object(H.a)(this,
this.NGj,"handlePasteGivenText"),4);this.ia.ra(ea.a.bhh,qc.a.application,Object(H.a)(this,this.MGj,"handlePasteContentFromPandora"),4);this.ia.ra(ea.a.Doa,rb.a.application,Object(H.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.ra(ea.a.gmd,rb.a.application,Object(H.a)(this,this.OGj,"handlePasteHtmlAsync"),4);this.ia.ra(ea.a.r1d,ye.a.frame,Object(H.a)(this,this.LGj,"handlePasteChartAsImage"),4);this.ia.ya(ea.a.F3d,ye.a.frame,Object(H.a)(this,this.Jgg,"handleCutCopyThroughShortcuts"));this.ia.ya(ea.a.XPf,
ye.a.frame,Object(H.a)(this,this.Jgg,"handleCutCopyThroughShortcuts"));this.ia.ra(ea.a.thh,ye.a.frame,Object(H.a)(this,this.bHj,"handlePasteThroughShortcuts"),4);this.la.ka("IsPasteTextFloatieEnabled")&&(this.ia.ra(ea.a.mmd,ye.a.frame,this.ZGj,4),this.ia.ra(ea.a.omd,ye.a.frame,this.aHj,4),this.ia.ra(ea.a.Ood,ye.a.frame,this.gIj,4),this.ia.ra(ea.a.lrc,qc.a.application,this.kIj,4),this.ia.ra(ea.a.nrc,qc.a.application,this.mIj,4),this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(this.ia.ra(ea.a.nmd,
qc.a.application,this.$Gj,4),this.ia.ra(ea.a.mrc,qc.a.application,this.lIj,4)))}me(){if(qd.a("ShortcutsFixInMac")&&z.a.Dcc){const a=[this.Fa.Ic(Si.a.fE),this.Fa.Ic(xa.a.qg)];for(const b of a)b.bindAction(x.KeyInputManager.Va(B.a.tAa,x.KeyInputManager.Te),ea.a.XPf),b.bindAction(x.KeyInputManager.Va(B.a.r3a,x.KeyInputManager.Te),ea.a.thh)}}Jgg(a){a=ea.a.F3d===a;const b=this.Dc.BP(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.Cma.hta(Object.assign(new ut(!1,a),{Wb:b}));return 32}bHj(){const a=this.Dc.BP(2,
0,"OnBrowserPaste");this.HA.paste(Object.assign(new zm.a(!0),{Wb:a}),null,!1);return 32}Lgg(a,b,c,f){let l,y;if(!({IF:l,WPc:y}=this.oPf(c,a)).returnValue)return l;if(!il.bB)return this.Dc.Lg(!1,y.Wb,1),8;this.Eda(a,b,c,f,!0,y.Wb);return 32}Azb(a,b,c,f){if(1===c)return this.pa.GVa()?2:a===ea.a.kKa?2:a===ea.a.lKa?this.Slb(!1):a===ea.a.J_a?this.Slb(!0):a===ea.a.pasteAsPlainText?this.Slb(!1,!0):32;const l=this.Dc.BP(2,1,"HandlePasteFromSystemClipboardAsync");if(this.pa.J9())return this.Dc.Lg(!1,l,3),
16;if(!il.bB)return this.Dc.Lg(!1,l,1),8;this.Eda(a,b,c,f,!1,l);Kc.a.KP(!0,!1);return 32}Slb(a,b=!1){ya.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.pa.i0()?(ya.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.HA.BBi(a,b)?32:2}EWf(a,b){a===ea.a.cwb?this.Cma.hta(Object.assign(new ut(!1,!0),{Wb:b})):a===ea.a.q3b?this.Cma.hta(Object.assign(new ut(!1),{Wb:b})):a===ea.a.Coa?this.HA.paste(Object.assign(new zm.a(!1),{Wb:b}),null,!1):a===ea.a.kKa?
this.HA.paste(Object.assign(new zm.a(!1),{Wb:b,YA:!1}),null,!1):a===ea.a.lKa?this.HA.paste(Object.assign(new zm.a(!1),{Wb:b,YA:!0}),null,!1):a===ea.a.J_a?this.HA.paste(Object.assign(new zm.a(!1),{Wb:b,g$a:!0}),null,!1):a===ea.a.pasteAsPlainText?this.HA.paste(Object.assign(new zm.a(!1),{Wb:b,l6b:!0}),null,!1):a===ea.a.fya?(a=new zm.a(!1),a.Wb=b,a.m6b=!0,this.HA.paste(a,null,!1)):(ya.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.Dc.Lg(!1,b,5))}Eda(a,b,c,f,l,y){il.bB.Eda(l);l=
il.bB.G6;null!=l&&l?this.EWf(a,y):(a=new xf.a(null,Object(H.a)(this,this.wbf,"waitingForEnsureAccessOperationResult"),Object.assign(new HE,{actionId:a,context:b,behavior:c,mK:f,vd:y})),a.$l("ClipboardPreProcess"),this.KEg=Date.now(),a.run())}wbf(a,b){a=!0;let c=!1;const f=b.vd.toString(),l=il.bB.G6,y=il.bB.zy;null!=l?(a=!1,l?this.EWf(b.actionId,f):c=!0):Date.now()-this.KEg>this.la.OLf&&null!=y&&(ya.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),
a=!1,c=!0);c&&this.Dc.Lg(!1,f,29);return a}Kgg(a,b,c){if(!({IF:a,WPc:b}=this.oPf(c,a)).returnValue)return a;this.Cma.hta(b);return 32}oPf(a,b){let c;c=32;const f=ea.a.cwb===b;b=new ut(!1,f);const l=!!this.Cma&&this.Cma.FQ(b);if(1===a)return c=this.pa.GVa()?2:l?32:16,{returnValue:!1,IF:c,WPc:b};a=this.Dc.BP(f?1:0,1,"HandleCutCopyToSystemClipboard");this.Dc.Yw(1,a);b.Wb=a;return!l||this.fc.LVa()?(this.Dc.Lg(!1,a,2),{returnValue:!1,IF:16,WPc:b}):{returnValue:!0,IF:c,WPc:b}}zzb(a,b,c){if(1===c)return this.pa.GVa()?
2:a===ea.a.kKa?this.Slb(!1):a===ea.a.lKa?this.Slb(!1):a===ea.a.J_a?this.Slb(!0):a===ea.a.pasteAsPlainText?this.Slb(!1,!0):32;b=this.Dc.BP(2,1,"HandlePasteFromSystemClipboard");c=this.qq.Ba;if(!c||this.fc.fd(c)||this.pa.J9())return this.Dc.Lg(!1,b,3),16;c=null;let f=!1,l=!1,y=!1;a===ea.a.kKa?c=!1:a===ea.a.lKa?c=!0:a===ea.a.J_a?f=!0:a===ea.a.pasteAsPlainText?l=!0:a===ea.a.fya&&(y=!0);this.HA.paste(Object.assign(new zm.a(!1),{Wb:b,YA:c,g$a:f,l6b:l,m6b:y}),null,!1);return 32}YDj(a,b,c){if(this.fc.LVa())return 16;
if(1===c)return 32;a=this.pa.Qf();for(const f of a)if(f.Of||f.Ug){On(f);break}this.ETl(a);return 32}ETl(a){if(!a||!a.length)this.rwa=this.Wad=null;else if(!this.Wad||!this.aqi(this.Wad,a)){const b=[];for(const c of a)b.push(c);this.rwa=new Qe.a(0);this.rwa.$(b[0].slideId,1);this.Wad=b}}aqi(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}lvj(a,b,c,f){let l;l=b?b.Jyb(110,75):this.Sb.Uka(c.clientWidth,c.clientHeight);a=this.wk.s2d(a.Cb.cid,a.Cb.sid,!0,
l._x,l._y,c.width,c.height,a.Cs()+1,c.src,c.alt&&c.alt.length?c.alt:"image",f);b&&(a.B8=b.id);return a}PGj(a,b,c,f,l){b=this.qq.Ba;if(!b)return ya.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.fc.fd(b)?16:32;if(!l)return 16;this.Dc.jC(5,l.Wb);if(!this.kj.hD(b,1))return this.Dc.Lg(!1,l.Wb,8),this.kj.KD(b),16;Kc.a.fAa("PastePicture",!1);f=ey.Z7b(l);if(!f||!f.src)return this.Dc.Lg(!1,l.Wb,10),8;if((c=b.R_(this.pa.Ud()))&&this.fc.fd(c))return this.Dc.Lg(!1,l.Wb,3),16;const y=this.lvj(b,
c,f,l.Wb);f=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.Fa.Bd()},()=>{this.pa.selectShape(y,!0)});try{f.jc(b),f.gd=a,f.ry[Nq.a.j$b]=!0,c&&b.cS([c]),b.oB(y)}finally{f&&f.dispose()}this.Dc.Lg(!0,l.Wb);return 32}uej(){if(!this.qq.Ba)return null;const a=this.qq.Ba.yj();for(const b of a)if(b.BMc)return b;return null}XGj(a,b,c,f,l){b=this.qq.Ba;if(!b)return ya.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.fc.fd(b)?32:16;if(!l)return 8;this.Dc.jC(6,l.Wb);if(!this.kj.hD(b,1))return this.kj.KD(b),
this.Dc.Lg(!1,l.Wb,8),16;const y=this.uej();if(y){if(this.fc.fd(y))return this.Dc.Lg(!1,l.Wb,3),16;if(y.pJ)return ya.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",y.id),this.Dc.Lg(!1,l.Wb,3),32}f=$z.c9f(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName(k.a.Uwd).length))return this.Dc.Lg(!1,l.Wb,24),8;c=document.createElement("div");if(!c)return this.Dc.Lg(!1,l.Wb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.Dc.Lg(!1,
l.Wb,24),8;ya.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",f.rows.length,c.length);var G=this.l$f();f=G.x-55;G=G.y-37.5;if(y){b=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(y,!0)});try{b.jc(y),b.gd=a,b.ry[Nq.a.k$b]=!0,y.Wb=l.Wb,y.M_a=c}finally{b&&b.dispose()}this.fc.uw(y,a)}else c=b.oQi(f,G,b.Cs()+1,c,l.Wb),c.Wb=l.Wb,this.wA.HT([Object(sa.a)(4,c)],Object(sa.a)(116,b),a);this.Dc.Lg(!0,l.Wb);return 32}OGj(a,b,c,f,l){if(1===c)return 32;
b=l?Object(sa.a)($M.a,l):null;if(!b)return ya.a.J(512356569,826,50,"Html paste context should not be null."),8;c=this.qq.Ba;if(!c)return ya.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.fc.fd(c))return this.Dc.Lg(!1,b.Wb,3),16;Kc.a.fAa("PasteHtmlAsync",!0);ya.a.J(512356567,826,50,"Paste html start");return this.JWf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.pa.GVa()?2:32;const y=l?Object(sa.a)($M.a,l):null;if(!y)return ya.a.J(512356566,826,50,"Html paste context should not be null"),
8;b=this.qq.Ba;if(!b)return ya.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.fc.fd(b))return this.Dc.Lg(!1,y.Wb,3),16;ya.a.J(512356564,826,50,"Paste html start");Kc.a.KP(!1,!1);Kc.a.fAa("PasteHtml",!0);Kc.a.yk(Ii.a.ORk,"Image:"+y.lea.length.toString()+",Table:"+y.w2a.length.toString()+",Text:"+(y.zV?y.zV.length.toString():"0"));f=this.pa.Ud();a=Qq.a.Fth(0<y.lea.length?!0:!1,!1,0<y.w2a.length?!0:!1,!1,this.la.cAa,a);if(y.Wlb)return ya.a.J(512356563,826,50,"Will replace text"),this.Dc.jC(1,
y.Wb),a=this.hZi(y,f[0],a),16!==a?this.Dc.Lg(!0,y.Wb):this.Dc.Lg(!1,y.Wb,15),a;ya.a.J(512356562,826,50,"Will paste html into new shapes");if(y.n3c){if(this.la.Ysg){const G=Kc.a.Kb;this.wb.Hb(new pd.a(2,1,0,()=>{Kc.a.qy(G,()=>{this.ia.Ja(ea.a.gmd,c,y)})},90,"66"));return 64}return this.JWf(y,b,a)}return this.fZi(y,b,f,a)}hZi(a,b,c){if(this.fc.fd(b))return 16;if(a.zV&&0<a.zV.length){ya.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.iHa.UYd([b])));if(this.Sug(a.zV))return 16;this.fc.uw(b,
c);const f=this.Fb.yd(15);try{b.Wb=a.Wb,f.jc(b),f.gd=c,b.DMb=a.zV,Object(Sa.a)(874,f)&&b.id&&(Object(sa.a)(874,f).ry[Nq.a.Bhh]=b.id.toString())}finally{f&&f.dispose()}}return 32}fZi(a,b,c,f){const l=[],y=b.Cs();var G=this.l$f(),R=G.x,ja=G.y;G=0;for(var za=0;za<a.w2a.length;++za)G=this.wk.t2d(!0,b.cid,b.sid,!1,R,ja,110,75,y+1,a.w2a[za],a.Wb),l.push(G),G=6;R=a.lea;ja=1===R.length?0:Qq.a.nT;for(za=0;za<R.length;za++){const Va=this.wk.s2d(b.cid,b.sid,!1,ja,ja,R[za].width,R[za].height,y+1,R[za].src,R[za].alt,
a.Wb);l.push(Va);ja+=Qq.a.nT;G=0===G?5:20}if(a.zV&&0<a.zV.length)if(ya.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.iHa.UYd(c))),!this.Sug(a.zV))c=this.wk.u2d(b.cid,b.sid,y+1,a.zV,a.Wb),l.push(c),G=0===G?1:20;else if(!l.length)return this.Dc.jC(1,a.Wb),this.Dc.Lg(!1,a.Wb,7),16;this.Dc.jC(G,a.Wb);if(0<l.length){if(!this.kj.hD(b,l.length))return this.kj.KD(b),this.Dc.Lg(!1,a.Wb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.zV,this.B$.vvg(c)?(this.Dc.jC(8,
a.Wb),ya.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.wA.HT(l,b,f),this.B$.ROl(c,Object(H.a)(this,this.mYl,"videoInsertionFail"))):(this.la.ka("IsPasteTextFloatieEnabled")&&1===G&&(this.Dzf(),this.zFb=l[0],a.icc?this.wY.zH=ea.a.pasteAsPlainText:this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&a.jcc?this.wY.zH=ea.a.fya:this.wY.zH=ea.a.Coa),this.wA.HT(l,b,f),this.fc.uw(b,f))):(this.la.ka("IsPasteTextFloatieEnabled")&&1===G&&1===
l.length&&a&&(this.Dzf(),this.zFb=l[0],a.icc?this.wY.zH=ea.a.pasteAsPlainText:this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&a.jcc?this.wY.zH=ea.a.fya:this.wY.zH=ea.a.Coa),this.wA.HT(l,b,f),this.fc.uw(b,f));this.Dc.Lg(!0,a.Wb)}else this.Dc.Lg(!1,a.Wb,9);return 32}Dzf(){this.wCe||(this.skc.hja(this.zwh),this.Rf.TQa(this.V6g),this.wCe=!0)}aUd(a){this.Lad||(this.Rf.JBf(this.Jwh),a===ea.a.lrc?this.Rf.TQa(this.wMh):a===ea.a.nrc?this.Rf.TQa(this.xMh):a===ea.a.mrc&&this.Rf.TQa(this.vMh),
this.Lad=!0)}aXe(a){this.Lad&&(this.Rf.Wrh(this.Jwh),a===ea.a.lrc?this.Rf.yMb(this.wMh):a===ea.a.nrc?this.Rf.yMb(this.xMh):a===ea.a.mrc&&this.Rf.yMb(this.vMh),this.Lad=!1)}P$k(){this.wCe&&(this.skc.wMb(this.zwh),this.Rf.yMb(this.V6g),this.wCe=!1)}mYl(){ya.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}JWf(a,b,c){this.Dc.jC(5,a.Wb);if(Ub.a.Xa(a.lea))return this.Dc.Lg(!1,a.Wb,10),16;if(!b)return 16;var f=Object(sa.a)(424,b.qc(this.Eb.Na));if(!f)return this.Dc.Lg(!1,
a.Wb,3),8;var l=Kc.a.Kb;l&&(l.actionName="SinglePicturePaste",l.$p=!0,l.Qj=!0,l.Wa("PreloadImageDuration",a.aQe.toString()));l=a.lea[0];const y=b.R_(this.pa.Ud());var G=b.Cs();let R,ja;({m8d:ja,mC:R}=this.$Xa.z0d(y,l.width,l.height));G=this.wk.s2d(b.cid,b.sid,!1,R.x,R.y,ja.width,ja.height,G+1,l.src,l.alt,a.Wb);Kc.a.yk("ImageSrcSize",l.src.length.toString());f=this.$Xa.IXd(this.Eb.Nd,ja,R,f.$T);G.dS=f;y&&(G.B8=y.id);G.isResizable=!0;G.Ubc=!0;G.bM=!0;G.FJa=!0;G.Mea=l.src;this.wA.HT([G],b,c,null,y);
this.Dc.Lg(!0,a.Wb);return 32}Sug(a){return 65535<a.length?(ya.a.J(512356556,826,50,"Exceed text size limit: {0}",a.length),!0):!1}QGj(a,b,c,f,l){b=this.qq.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(sa.a)(zm.a,l);if(!c)return 8;f=c.kX;if(Ub.a.Xa(f))return this.Dc.Lg(!1,c.Wb,11),8;this.Dc.jC(2,c.Wb);this.Dc.Yw(2,c.Wb);l=this.qq.Ba;if(!l||this.fc.fd(l))return this.Dc.Lg(!1,c.Wb,3),16;Kc.a.fAa("PasteShape",!1);if(!this.kj.hD(l,f.length))return this.kj.KD(l),
this.Dc.Lg(!1,c.Wb,8),16;ya.a.J(512356555,826,50,"Start Handle paste shapes");var y=Wr.b(f,ja=>ja.shapeNode);this.Lw.hhe(y,"HandlePasteShapes");for(var G of f){if(!G||!G.shapeNode.isConnected)return ya.a.J(512356554,826,50,"Paste deleted shapes"),this.FDg.Ruc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.Dc.Lg(!1,c.Wb,12),16;if(this.fc.qO(G.shapeNode))return this.Dc.Lg(!1,c.Wb,3),16;if(!G.shapeNode.get_shapeId())return this.Dc.Lg(!1,
c.Wb,12),16}G=[];for(y=0;y<f.length;y++)G.push(f[y].shapeNode);for(var R of G)if(R.Of||R.Ug){On(R);break}R=Object(sa.a)(116,b.XC(f[0].shapeNode.slideId));this.iHa.ohh(R,l,G,this.rwa,a,c.Wb);ya.a.J(512356553,826,50,({contentType:a}=this.iHa.VYd(G)).returnValue);this.Dc.jC(a,c.Wb);Kc.a.KP(!0,!0);this.Dc.Lg(!0,c.Wb);return 32}LGj(a,b,c,f,l){(a=Object(sa.a)(zm.a,l))&&this.HA.GRk(a.Wb);return 32}WGj(a,b,c,f,l){if(1===c)return 32;b=Object(sa.a)(zm.a,l);if(!b)return 8;this.Dc.jC(19,b.Wb);this.Dc.Yw(2,b.Wb);
if(Ub.a.Xa(b.kX))return this.Dc.Lg(!1,b.Wb,11),8;Kc.a.fAa("PasteSlide",!0);if(c=Array.isArray(b.kX)?b.kX:null){let G=0;c.forEach(R=>{R.$c&&R.$c.hasDeferredContent&&G++});0<G&&ya.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,G)}c=[];for(var y of b.kX){f=Object(sa.a)($v.a,y);if(!f)return this.Dc.Lg(!1,b.Wb,11),8;f=f.$c;if(!f||!f.isConnected)return ya.a.J(512356551,826,50,"Paste deleted slide"),this.FDg.Ruc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),
null),b.bfh&&(this.Qq.jr=null),this.Dc.Lg(!1,b.Wb,13),16;if(this.fc.fd(f))return this.Dc.Lg(!1,b.Wb,3),16;Array.add(c,f)}y=Array.clone(this.pa.Re());y.sort((G,R)=>G.qe-R.qe);y=y[y.length-1];if(!y)return ya.a.J(512356550,826,50,"Paste slides with no slide selected"),this.Dc.Lg(!1,b.Wb,13),8;Kc.a.yk("SlideCount",c.length.toString());y=this.wA.z_f(c,a,y,b.Wb,!1);c=!0;for(const G of y)if(!G.vO){c=!1;break}c||this.fc.uw(this.Ub.Gf,a);Kc.a.KP(!0,!0);this.Dc.Lg(!0,b.Wb);return 32}Z2e(){return this.pa.Js()||
this.pa.vH()}Bxl(){if(this.pa.Js())return!0;if(this.pa.vH()){const a=this.pa.Ud();return 1!==a.length||!a[0].isEditable}return!1}vDj(a,b,c,f,l,y){const G=this.Dc.BP(1,0,"HandleBrowserCut");this.Dc.jC(1,G);this.Z2e()?(a=this.aeb(a,this.ia,b,c,f,l,y,this.Dc,G),a.O8a(16)):(Kc.a.KP(!0,!0),this.Dc.Ilc(G),a=this.aeb(a,this.ia,C.a.f1b,c,f,l,y,this.Dc,G),a.N_c());return a}uDj(a,b,c,f,l,y){const G=this.Dc.BP(0,0,"HandleBrowserCopy");this.Dc.jC(1,G);this.Z2e()?(a=this.aeb(a,this.ia,b,c,f,l,y,this.Dc,G),2===
f&&this.Cma.hta(Object.assign(new ut(!0),{jpg:!1,Wb:G})),a.O8a(32)):(this.Dc.Ilc(G),a=this.aeb(a,this.ia,C.a.GLc,c,f,l,y,this.Dc,G),a.N_c());return a}wDj(a,b,c,f,l,y){const G=this.Dc.BP(2,0,"HandleBrowserPaste"),R=this.Z2e();a=this.aeb(a,this.ia,R?b:C.a.z8,c,f,l,y,this.Dc,G);y=Object(sa.a)(10,y);Kc.a.KP(!0,!1);if(this.pa.J9())return a.O8a(16),this.Dc.Lg(!1,G,3),a;y&&y.Ta(we.a.aV)?2===f&&this.Hyd(y,G)?a.O8a(32):R?(2===f&&this.HA.paste(Object.assign(new zm.a(!0),{Isg:!1}),y.eb(we.a.aV),!1),a.O8a(32)):
a.N_c():(ya.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),a.O8a(16),this.Dc.Lg(!1,G,14));return a}NGj(a,b,c,f,l,y){Kc.a.fAa("PasteGivenText",!1);this.Bxl()?(a=this.aeb(a,this.ia,b,c,f,l,y,this.Dc,""),a.O8a(16)):(Kc.a.KP(!0,!0),a=this.aeb(a,this.ia,C.a.fmd,c,f,l,y,this.Dc,""),a.N_c());return a}YGj(a,b,c,f,l){if(1===c)return 32;if((b=this.pa.Ud())&&0<b.length)return ya.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",
this.iHa.UYd(b)),16;ya.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");if(!(l&&l.kn&&l.kn.innerHTML&&l.kn.innerHTML.length))return ya.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Kc.a.fAa("PasteTextIntoNewShape",!0);b=this.qq.Ba;if(!b)return ya.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.kj.hD(b,1))return this.kj.KD(b),16;l=this.wk.u2d(b.cid,b.sid,b.Cs()+1,l.kn.innerHTML,l.Wb);this.wA.HT([l],
b,a);return 32}l$f(){const a=this.Sb.Tu();return new cd.a(Math.floor(a.width/2),Math.floor(a.height/2))}MGj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(Bu.a.LKf).toString());this.Dc.rCb(a)||(a=this.Dc.BP(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(ea.a.Nja,2);if(32!==b)return this.Dc.Lg(!1,a,15),ya.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new zm.a(!0),{Wb:a});this.lR.p0j(l)?a.kn=l:(k.a.n2b(this.Zg),this.Zg.contentWindow.document.body.appendChild(l));
this.HA.paste(a,null,!1);ya.a.J(512356515,826,50,null);return 32}Hyd(a,b){if(a){if(this.la.Xne){const c=a.sa(we.a.z_c,"");if(c.startsWith("data:image/"))return this.Dc.jC(5,b),this.HA.$Pe(c,b)}a=a.eb(we.a.aV);na.a.Xa(a)||(a=this.lR.iKa(a),this.Dc.Gtl(a,b))}return!1}}Object(m.a)(aN,"ClipboardActor",null,[268]);var Tp=d(1171);class bN{constructor(a,b){this.ia=a;this.Mq=b;this.vb()}vb(){this.ia.ra(ea.a.Hlh,ye.a.frame,Object(H.a)(this,this.wxc,"updateCoauthStatus"),96)}me(){}wxc(a,b,c,f,l){if(1===c)return 32;
a=this.Mq.cpc;na.a.Xa(a)&&(a="NotConnected");this.Mq.p9a&&(a=String.format("{0} ~:{1}",a,this.Mq.p9a));l[Tp.a.Value]=a;l[wm.a.labelText]=a;l[Tp.a.Visible]=!0;return 32}}Object(m.a)(bN,"CoauthActor",null,[268]);var Cu=d(232),jl=d(356);class cN{constructor(a,b,c,f){this.QHa=!1;a("powerpoint-editor-intl").then(()=>{ya.a.J(509117583,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{ya.a.J(509117582,801,50,"Color Picker Manager script is loaded successfully");
this.QHa=!0}).catch(l=>{ya.a.J(509117581,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>{ya.a.J(509117580,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Fa=c;this.Ub=f}vb(){this.ia.ya(ea.a.renderColorPicker,qc.a.application,Object(H.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(ea.a.sge,qc.a.application,this.NEj.bind(this));this.ia.ya(ea.a.xCa,qc.a.application,Object(H.a)(this,this.xCa,"addRecentColor"))}me(){}renderColorPicker(a,
b,c,f,l){if(1===c)return this.QHa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.fdl(b,c,a);return 32}xCa(a,b,c,f,l){if(a=Cu.a.parse(l.Color)){b=this.Ub.Gf;if(!b)return ya.a.J(509117579,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.Ae(va.a.STi,a.RGBColor);b.Ae(va.a.fda,JSON.stringify(jl.g(b.fda,a.RGBColor)))}else return ya.a.J(509117578,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}NEj(a,b,c,f,l){let y;switch(l.originalActionId){case ea.a.LMc:y=
ea.a.xMa;break;case ea.a.PMc:y=ea.a.mpc;break;case ea.a.OSc:y=ea.a.B0b;break;case ea.a.PSc:y=ea.a.wKb;break;case ea.a.RSc:y=ea.a.C0b;break;case ea.a.QSc:y=ea.a.dnd;break;default:return ya.a.J(508847688,822,15,"handleEyeDropperColor: unrecognized original action id: {0}",l.Vxa),8}a=window.EyeDropper;if(!a)return 8;if(1===c)return this.ia.Ja(y,1,l);c=new a;l=new AbortController;let G=this;c.open({signal:l.signal}).then(R=>{const ja={};ja.Color=R.sRGBHex;ja.sourceControlId="EyeDropper";Vg.a("EyeDropper_ColorApplied",
y,function(){return G.ia.Ja(y,2,ja)})}).catch(R=>{ya.a.J(508847687,822,10,"handleEyeDropperColor: Failed to apply eyedropper color. Exception: {0}",R.toString())});return 32}fdl(a,b,c){let f="#000000",l=100;a&&(f=oc.a.fH(a.ND),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),this.Fa.S_c(xa.a.H2b,xa.a.$i,a));const y=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();
if(y)if(y.addEventListener("onColorChange",ja=>{const za={};za.Color=ja;za.sourceControlId="CustomColors";let Va=8;Vg.a("ColorPicker_ColorApplied",b,()=>Va=this.ia.Ja(b,2,za));32===Va?ya.a.J(509117576,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):ya.a.J(509117575,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",b);this.Fa.wj(xa.a.H2b,!1)}),y.addEventListener("onCancel",()=>
{this.Fa.wj(xa.a.H2b,!1)}),Vg.a("ColorPicker_DialogInvocation",b,()=>{y.render("colorPickerDiv",f,l,c);return 32}),ya.a.J(509117574,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Fa.wj(xa.a.H2b,!0),a=this.Fa.Ic(xa.a.H2b)){a.zJ=!0;var G=x.KeyInputManager.Va(B.a.$q,0),R=x.KeyInputManager.Va(B.a.$q,4);a.hw(G);a.hw(R);a.bindAction(G,F.a.gta);a.bindAction(R,F.a.gta)}else ya.a.J(509117573,822,10,"RenderColorPickerDialog: colorPickerScope is null");else ya.a.J(509117577,
822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(m.a)(cN,"ColorPickerActor",null,[268]);var bS=d(1077);class dN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb=!1,Cb=!1){this.ia=a;this.Hfc=b;this.oR=c;this.FZa=l.twc;this.X4=f;this.ua=y;this.Ga=G;this.pa=R;this.Fa=ja;this.d1=za;this.vnk=hb;this.Eb=Va;this.zh=Cb}vb(){this.ia.ya(ea.a.sOc,qc.a.application,Object(H.a)(this,this.QJj,"handleThumbnailPanelContextMenu"));this.ia.ya(ea.a.$0d,qc.a.application,Object(H.a)(this,this.rJj,"handleSorterViewThumbnailContextMenu"));
this.ia.ya(ea.a.kPf,qc.a.application,Object(H.a)(this,this.qJj,"handleSorterViewBlankSpaceMenu"));this.ia.ya(ea.a.X0d,qc.a.application,Object(H.a)(this,this.LIj,"handleSectionContextMenu"));this.ia.ya(ea.a.Z0d,rb.a.view,Object(H.a)(this,this.iJj,"handleSlidePanelContextMenu"));this.ia.ya(ea.a.Y0d,rb.a.view,Object(H.a)(this,this.tGj,"handleMultiSelectShapeContextMenu"));this.ia.ya(ea.a.mPf,qc.a.application,Object(H.a)(this,this.iKj,"handleVersionHistoryThumbnailContextMenu"));this.ia.ie(ea.a.sOc,2048)}me(){this.vnk&&
z.a.ik&&(this.Fa.Ic(L.AppFrame.UW).bindAction(x.KeyInputManager.Va(B.a.pNa,0),C.a.lba),this.Fa.Ic(L.AppFrame.uVe).bindAction(x.KeyInputManager.Va(B.a.pNa,0),C.a.lba))}QJj(a,b,c,f,l){if(1===c)return 32;if(this.ia.vX)return this.d1.show(1,-1),32;this.Hfc.v$a();if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Jh.a.HCa))return 16;if(this.oR.h0||!l.Bc)return 32;2===l.kg||3===l.kg?(a=l.clientPoint.y-qe.a.mqj(this.FZa.I1)+this.FZa.I1.scrollTop,a=this.FZa.Z7d(a),b=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y)):
(a=0>this.FZa.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.FZa.I1),b=new Sys.UI.Point(b.x+Pd.a.Lsa,b.y+Pd.a.Lsa));this.X4.value.N6(Pd.a.jta,b,l.kg,a);return 32}iKj(a,b,c,f,l){if(1===c)return 32;if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Jh.a.HCa))return 16;if(!l.Bc)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.X4.value.N6(Pd.a.jta,a,l.kg,21);return 32}qJj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);b=20;this.zh&&0===this.Eb.al&&
(b=2);this.X4.value.N6(Pd.a.jta,a,l.kg,b);return 32}rJj(a,b,c,f,l){if(1===c)return 32;if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Jh.a.HCa))return 16;if(this.oR.h0||!l.Bc)return 32;if(2===l.kg||3===l.kg||1===l.kg)a=19,this.zh&&0===this.Eb.al&&(a=1),b=qd.a("ContextMenuPositionBugFixed")&&1===l.kg?this.B5f():new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.X4.value.N6(Pd.a.jta,b,l.kg,a);return 32}LIj(a,b,c,f,l){if(1===c)return 32;w.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
(a=l.contextMenuArgs,b=qd.a("ContextMenuPositionBugFixed")&&1===a.kg?this.B5f():new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.X4.value.N6(Pd.a.jta,b,a.kg,17):this.X4.value.N6(Pd.a.jta,b,a.kg,18));return 32}iJj(a,b,c,f,l){if(1===c)return 32;this.Hfc.v$a();if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Jh.a.HCa))return 16;if(this.oR.h0||!l.Bc)return 32;if(2===l.kg||3===l.kg)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=vg.b(b);a=vg.e(this.ua.Ba,a.Na);if(!a)return 16;
a=Sys.UI.DomElement.getLocation(a.WA);a=new Sys.UI.Point(a.x+Pd.a.Lsa,a.y+Pd.a.Lsa)}this.X4.value.N6(Pd.a.jta,a,l.kg,4);return 32}tGj(a,b,c,f,l){if(1===c||l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Pd.a.Oni))return 32;this.Hfc.v$a();if(l.Bc&&Sys.UI.DomElement.containsCssClass(l.Bc,Jh.a.HCa))return 16;if(this.oR.h0||!l.Bc)return 32;b=vg.b(b);var y;if(!(b&&b.Nb&&(y=this.pa.Qf())&&y.length))return 16;a=this.Kpj(y);if(2===l.kg||3===l.kg)y=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{y=vg.c(y[0],
b.Na);if(!y||!y.xa)return 16;y=Cd.a.mi(y.xa.xa);b=Cd.a.mi(b.container);c=y.x+Pd.a.Lsa<b.x?b.x:y.x+Pd.a.Lsa;y=y.y+Pd.a.Lsa<b.y?b.y:y.y+Pd.a.Lsa;c=c>b.x+b.width?b.x+b.width:c;y=y>b.y+b.height?b.y+b.height:y;y=new Sys.UI.Point(c,y)}1===l.kg||4===a?this.X4.value.N6(Pd.a.jta,y,l.kg,a):this.X4.value.aAl(Pd.a.jta,y,l.kg,a);return 32}B5f(){const a=document.activeElement.getBoundingClientRect();return new Sys.UI.Point(a.x,a.y)}Kpj(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ga.Lr(b));return 1<a.length?
this.Ga.xKc(a)?11:10:b.wz||!b.eva||b.Of?5:b.get_isSVGBlipFilled()?13:b.tj||1===b.mediaType?7:b.Wf?8:b.Gw?6:b.nr?22:b.qr?9:b.xd?14:b.Pp?15:b.D4?16:0}}Object(m.a)(dN,"ContextMenuActor",null,[268]);class eN{constructor(a,b,c,f,l,y,G,R,ja){this.Qda=()=>this.CHa?this.CHa:this.CHa=Fb.a.instance.rb("PowerPointWebEditor.IImageDescriptionPane");if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("selectionManager");if(!c)throw Error.argumentNull("shapeReader");if(!f)throw Error.argumentNull("accCheckPane");
this.ia=a;this.pa=b;this.Ga=c;this.Hdb=f;this.Xnk=l;this.SBe=y;this.BU=G;this.jma=R;this.Wnk=ja}vb(){this.ia.ra(ea.a.hih,qc.a.application,Object(H.a)(this,this.YSk,"pictureToolsTabViewHandler"),this.Wnk?2052:4);this.ia.ra(ea.a.sXf,qc.a.application,Object(H.a)(this,this.i_i,"drawingToolsTabViewHandler"),4);this.ia.ra(ea.a.EFf,qc.a.application,Object(H.a)(this,this.kri,"audioPlaybackToolsTabViewHandler"),4);this.ia.ra(ea.a.CFf,qc.a.application,Object(H.a)(this,this.iri,"audioFormatToolsTabViewHandler"),
4);this.ia.ra(ea.a.FFf,qc.a.application,Object(H.a)(this,this.lri,"audioSettingsTabViewHandler"),4);this.ia.ra(ea.a.Mlh,qc.a.application,Object(H.a)(this,this.nCj,"graphicsTabViewHandler"),100);this.ia.ra(ea.a.ZTe,qc.a.application,Object(H.a)(this,this.aJl,"tableTabViewHandler"),100);this.ia.ra(ea.a.amh,qc.a.application,Object(H.a)(this,this.hri,"audioContextualGroupHandler"),100);this.ia.ra(ea.a.PIc,qc.a.application,Object(H.a)(this,this.Uci,"accessibleAuthoringViewHandler"),4)}me(){}YSk(){return this.x0j()?
32:this.Nsg(this.pa.Qf())?32:8}i_i(){const a=this.pa.Qf();return a&&a.length?1===a.length?this.Hqg(a)?32:16:this.tni(a)||this.PWj(a)&&this.Hqg(a)?32:this.ktb(a)||this.w2j(a)?16:32:16}kri(){return this.SBe?this.s2c()?32:this.ktb(this.pa.Qf())?32:8:2}iri(){return this.BU?this.s2c()?32:this.ktb(this.pa.Qf())?32:8:2}lri(){return this.BU&&this.SBe?this.s2c()?32:this.ktb(this.pa.Qf())?32:8:2}nCj(){return this.Xnk?this.y0j()?32:this.Ga.zvc(this.pa.Qf())?32:16:2}aJl(){const a=this.pa.Ud();return a&&1===a.length&&
a[0].xd?32:8}hri(){return this.BU||this.SBe?this.s2c()?32:this.ktb(this.pa.Qf())?32:8:2}Uci(){const a=this.jma&&this.Qda()&&this.Qda().isVisible;return this.Hdb&&this.Hdb.isVisible||a?32:2}w2j(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Pp||1===c.mediaType)return!0;c.tj||(b=!1)}return b}tni(a){if(!a)return!1;for(const b of a)if(!b.Pp)return!1;return!0}Nsg(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.tj&&!c.get_isSVGBlipFilled())b=!0;else if(c.Pp)return!1;return b}ktb(a){if(!a||!a.length)return!1;
for(const b of a)if(b&&1!==b.mediaType)return!1;return!0}PWj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}Hqg(a){if(!a)return!1;for(const b of a)if(b&&(b.Rua||b.D4))return!0;return!1}x0j(){return this.qpe(this.pa.Qf())&&this.Nsg(this.pa.tP(this.pa.Ud()))}y0j(){return this.qpe(this.pa.Qf())&&this.f6j(this.pa.tP(this.pa.Ud()))}s2c(){return this.qpe(this.pa.Qf())&&this.ktb(this.pa.tP(this.pa.Ud()))}f6j(a){if(!a)return!1;for(const b of a)if(b&&b.Ug&&b.get_isSVGBlipFilled())return!0;
return!1}qpe(a){if(!a)return!1;for(const b of a)if(b&&b.Of)return!0;return!1}}Object(m.a)(eN,"ContextualTabsActor",null,[268]);class fN{constructor(a,b,c,f){this.LGe=null;this.ia=a;this.ua=b;this.Fb=c;this.cFg=f;this.cFg.gk(Object(H.a)(this,this.hdh,"onRichApiResponseReceived"))}vb(){this.ia.ra(ea.a.BSc,rb.a.application,Object(H.a)(this,this.LEj,"handleExecuteAddinBatchOperation"),4)}me(){}dispose(){this.cFg.Qm(Object(H.a)(this,this.hdh,"onRichApiResponseReceived"))}hdh(a,b){this.LGe&&(a=Object(sa.a)(767,
b.node))&&a.Fkb&&this.LGe(a.Fkb)}LEj(a,b,c,f,l){b=this.ua.presentation;if(1===c)return b?32:8;if(!b)return ya.a.J(509364444,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return ya.a.J(509364443,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.LGe=l.promiseToResolve;c=this.Fb.yd(15,void 0,void 0,void 0,!0);try{c.jc(b),c.gd=a,b.JTd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(m.a)(fN,"ExtensibilityActor",null,[268]);var gy;(function(a){a[a.height=
0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(gy||(gy={}));Object(m.b)("FormatPaneProperty",gy);class aA{constructor(a,b){this.i2=a;this.waa=b}}Object(m.a)(aA,"MarginShapeData",null,[]);class IE{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=
this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(m.a)(IE,"FormatShapeTaskPaneProps",null,[]);class gN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec){this.nJa=this.bZa=this.gY=this.Pwa=null;this.YNg=0;this.Ab=!1;this.OIa=null;this.GHa=this.cwa=!1;this.Onk=!0;this.jb=b;this.Rb=c;this.ia=f;this.Fa=l;this.Rf=G;this.od=R;this.Fc=ja;this.Eb=
za;this.NGa=Va;this.Ub=hb;this.Rf.LI(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.Rf.zCa(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.Fc.SQa(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.od.DCa(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.Rb.MI(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"));this.hJg=lc;this.L8c=ic;this.Ga=Cb;this.Z0=yc;this.Dn=ec;qd.a("FixHeightAndWidthButtonValues")&&this.Dn&&this.Dn.kUd(Object(H.a)(this,
this.Fxa,"onChangeRenderFormatShapePane"))}dispose(){this.Rf.E6(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.Rf.G0a(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.Fc.pkb(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.od.rkb(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"));this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"));qd.a("FixHeightAndWidthButtonValues")&&this.Dn.hqd(Object(H.a)(this,this.Fxa,"onChangeRenderFormatShapePane"))}vb(){this.ia.ra(ea.a.Huc,
qc.a.application,Object(H.a)(this,this.Huc,"showHideFormatShapePane"),4);this.ia.ra(ea.a.Ysd,qc.a.application,Object(H.a)(this,this.Ysd,"setAbsoluteHeight"),4);this.ia.ra(ea.a.i5e,qc.a.application,Object(H.a)(this,this.i5e,"spinAbsoluteHeight"),4);this.ia.ra(ea.a.Bjb,qc.a.application,Object(H.a)(this,this.Bjb,"queryAbsoluteHeight"),100);this.ia.ra(ea.a.Zsd,qc.a.application,Object(H.a)(this,this.Zsd,"setAbsoluteWidth"),4);this.ia.ra(ea.a.j5e,qc.a.application,Object(H.a)(this,this.j5e,"spinAbsoluteWidth"),
4);this.ia.ra(ea.a.Cjb,qc.a.application,Object(H.a)(this,this.Cjb,"queryAbsoluteWidth"),100);this.ia.ra(ea.a.gLb,qc.a.application,Object(H.a)(this,this.gLb,"queryFormatShapePane"),96)}me(){}Fxa(){this.Ab&&this.kl(!0)}Eu(a){1===a.mode&&this.Ab&&(this.Ab=!1,this.Kq(),this.Fa.wj(xa.a.YW,this.Ab))}b0j(a){return this.Ub.isEditingAllowed&&this.Onk&&!this.b3e(a)}gLb(a,b,c,f,l){(a=Object(sa.a)(gi.a,l))&&a.If(this.Ab);return 32}Huc(a,b,c){b=this.jb.Qf();return 1===c?b.length&&this.b0j(b)?32:8:Vg.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",
this.Ab.toString(),a,()=>{(this.Ab=!this.Ab)?this.kl():this.Kq();return 32})}Ysd(a,b,c,f,l){b=this.jb.Qf();return 1===c?this.KCh(b)?8:32:Vg.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return ya.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const y=l.Number;void 0===y||null===y||isNaN(y)||this.Lxa(y,0);return 32})}i5e(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.Lxa(0,0),this.J7a());return 32}Bjb(a,b,c,f,l){if(!l)return ya.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),
8;if(a=l.queryResult)b=this.kA(),a.nba=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.nba="");return 32}Zsd(a,b,c,f,l){b=this.jb.Qf();return 1===c?this.KCh(b)?8:32:Vg.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return ya.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const y=l.Number;void 0===y||null===y||isNaN(y)||this.Lxa(y,1);return 32})}j5e(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.Lxa(0,1),this.J7a());return 32}Cjb(a,b,c,
f,l){if(!l)return ya.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.kA(),a.nba=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.nba="");return 32}kl(a=!1){const b=this.kA(),c=Object.assign(new yu.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Mj.UISurfaces.Iq().then(f=>{a?f.updateTaskPane(xa.a.YW,c):f.showTaskPane(xa.a.YW,
c);return null})}Kq(){Mj.UISurfaces.Iq().then(a=>{a.hideTaskPane(xa.a.YW,2);return null})}kA(){const a=this.jb.Qf();var b=[];for(var c of a)c.Of?b=Array.isArray(b.concat.apply(b,this.Ga.yx(c)))?b.concat.apply(b,this.Ga.yx(c)):null:b.push(c);if(!(c=this.rk(a[0]))||this.b3e(a))return this.GHa=!0,this.fzh(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.nd;c=this.Nbe(f);c=this.yOc(c,1,l);f=this.Nfe(f);f=this.yOc(f,0,l);this.GHa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());l=0>l&&qd.a("fixBugOfNegativeAngle")?
l+360:l;b=this.rk(b[0]);let y=0,G=0,R=0,ja=0;b&&(y=b.rVa[0],G=b.rVa[1],R=b.rVa[2],ja=b.rVa[3]);c=this.fzh(c,f,l,y,G,R,ja,this.cjj(a),0);this.yUl(a,c);return c}cjj(a){let b=[];for(var c of a)c.Of?b=Array.isArray(b.concat.apply(b,this.Ga.yx(c)))?b.concat.apply(b,this.Ga.yx(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.Hub(a[f])||(c|=4),this.Z0&&!this.K1b(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].pCb){c|=120;break}return c}Hub(a){return!!a&&a.bM&&!a.pJ}K1b(a){return!!a&&a.isResizable&&
!a.pJ}KCh(a){if(0>=a.length)return!0;let b=!1;if(this.Z0){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.K1b(a[c])){b=!1;break}}return b||this.b3e(a)}b3e(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].xd){b=!0;break}return b}yUl(a,b){if(this.L8c){var c=[];for(var f of a)f.Of?c=Array.isArray(c.concat.apply(c,this.Ga.yx(f)))?c.concat.apply(c,this.Ga.yx(f)):null:c.push(f);var l=f=!0,y=!0,G=!0;if(2<=c.length)for(var R=1;R<c.length;R++){var ja=c[R];if(!ja)continue;if(!this.getBounds(ja))continue;
ja=this.rk(ja);let za=0,Va=0,hb=0,Cb=0;ja&&(za=ja.rVa[0],Va=ja.rVa[1],hb=ja.rVa[2],Cb=ja.rVa[3]);f&&b.leftMargin!==za&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Va&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);y&&b.topMargin!==hb&&(b.topMargin=0,b.emptyValueFields|=32,y=!1);G&&b.bottomMargin!==Cb&&(b.bottomMargin=0,b.emptyValueFields|=64,G=!1);if(!(f||l||y||G))break}}if(!(2>a.length))for(l=f=c=!0,y=1;y<a.length;y++)if(G=a[y])if(R=this.getBounds(G))if(ja=this.rk(G).nd,G=this.Nbe(R),
G=this.yOc(G,1,ja),R=this.Nfe(R),R=this.yOc(R,0,ja),ja=a[y].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(G.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(R.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==ja&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}Opl(a,b,c,f,l,y,G,R,ja){const za=new IE,Va=Object(sa.a)(Object,Zg.e().numberFormatInfo);za.numberFormatInfo=Va;za.height=a;za.width=b;za.rotation=c;za.leftMargin=
f;za.rightMargin=l;za.topMargin=y;za.bottomMargin=G;za.disabled=R;za.onChange=Object(H.a)(this,this.Lxa,"onPropertyChange");za.emptyValueFields=ja;za.isAspectRatioLocked=this.cwa;za.isAspectRatioDisabled=this.GHa;za.onToggleAspectRatio=Object(H.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");za.isAspectRatioFeatureEnabled=this.hJg;za.isMarginFieldEnabled=this.L8c;return za}Ppl(a,b,c,f,l){const y=new IE,G=Object(sa.a)(Object,Zg.e().numberFormatInfo);y.numberFormatInfo=G;y.height=a;y.width=
b;y.rotation=c;y.disabled=f;y.onChange=Object(H.a)(this,this.Lxa,"onPropertyChange");y.emptyValueFields=l;y.isAspectRatioLocked=this.cwa;y.isAspectRatioDisabled=this.GHa;y.onToggleAspectRatio=Object(H.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");y.isAspectRatioFeatureEnabled=this.hJg;return y}fzh(a,b,c,f,l,y,G,R,ja){return this.L8c?this.Opl(a,b,c,f,l,y,G,R,ja):this.Ppl(a,b,c,R,ja)}Lxa(a,b){const c=this.jb.Qf();this.YNg!==b&&(this.J7a(),this.YNg=b);switch(b){case 0:case 1:this.resize(a,
c,b);break;case 3:case 4:case 5:case 6:this.hBi(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.cwa=a}gJf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}hBi(a,b,c){let f=[];for(const y of b)y.Of?f=Array.isArray(f.concat.apply(f,this.Ga.yx(y)))?f.concat.apply(f,this.Ga.yx(y)):null:f.push(y);this.OIa=b=f;let l=!0;this.gY||(this.gY=[],l=!1);Vg.b("FormatShapePaneActor::ChangeMargin Property:",gy[c]+"; AspectRatioLocked: "+(!this.GHa&&this.cwa),ea.a.Ntc,()=>{for(let y=0;y<b.length;y++){const G=
b[y],R=this.rk(G);if(!R)continue;l||this.gY.push(new aA(G,new Gi.a));this.gY.length===y&&this.gY.push(new aA(G,new Gi.a));this.gY[y]||(this.gY[y]=new aA(G,new Gi.a));const ja=this.gY[y];ja.waa.left=G.wja;ja.waa.right=G.xja;ja.waa.top=G.yja;ja.waa.bottom=G.vja;3===c&&(this.gY[y].waa.left=a);4===c&&(this.gY[y].waa.right=a);5===c&&(this.gY[y].waa.top=a);6===c&&(this.gY[y].waa.bottom=a);R.kAa(this.gY[y].waa)}return 32});this.Ixc()}resize(a,b,c){this.OIa=b;let f=!0;const l=[],y=[];this.Pwa||(this.Pwa=
[],f=!1);0===a&&(this.GHa=!0);Vg.b("FormatShapePaneActor::Resize Property:",gy[c]+"; AspectRatioLocked: "+(!this.GHa&&this.cwa),ea.a.Ckb,()=>{for(let za=0;za<b.length;za++){var G=b[za];const Va=this.rk(G);if(this.Z0){if(!Va||!this.K1b(G))continue}else if(!Va)continue;var R=this.getBounds(G),ja=this.Nbe(R);R=this.Nfe(R);f||(Array.add(this.Pwa,new Az(G,new Gi.a)),Va.aM=!0,Va.jE(!1));Array.add(l,Va.k_a);Array.add(y,new Gi.a);Va.shapeNode.Of&&Va.shapeNode.isEditable&&Va.Dk&&(Va.Dk.visible=!0);G=Va.nd;
if(0===c){G=this.APf(a,1,G);G=Math.round(G-ja);y[za].bottom=G;let hb;(hb=this.Pwa[za].X1).bottom=hb.bottom+G;if(!this.GHa&&this.cwa){ja=this.gJf(R,ja,0,G);y[za].right=ja;let Cb;(Cb=this.Pwa[za].X1).right=Cb.right+ja}}else{G=this.APf(a,0,G);G=Math.round(G-R);y[za].right=G;let hb;(hb=this.Pwa[za].X1).right=hb.right+G;if(!this.GHa&&this.cwa){ja=this.gJf(R,ja,G,0);y[za].bottom=ja;let Cb;(Cb=this.Pwa[za].X1).bottom=Cb.bottom+ja}}Va.setOffsets(Gi.a.add(l[za],y[za]),!0);Va.shapeNode.Of&&Va.shapeNode.isEditable&&
(Va.Nhe(),Va.c_c())}return 32});this.Ixc()}rotate(a,b){this.OIa=b;let c=!0;a=Math.round(a);this.bZa||(this.bZa=[],c=!1);Vg.a("FormatShapePaneActor::Rotate",ea.a.Bsc,()=>{for(let f=0;f<b.length;f++){const l=b[f],y=this.rk(l);if(!y)continue;const G=y.Yxb().Zf(),R=a%tp.aoc;c||(y.jE(!1),Array.add(this.bZa,new tp(l,R)));this.bZa[f].b4d=R;y.setRotation(R,G)}return 32});this.Ixc()}rk(a){return a?Object(sa.a)(Bz.a,a.rg(this.Eb.Na)):(ya.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.rk(a);
if(!b)return ya.a.J(512500575,822,10,"shapeViewElement == null"),null;b=b.E7b();a.v0&&(b=this.$$d(b));return b}APf(a,b,c){return this.NGa.tK(this.Eb.Nd.f0(a,b),c)}yOc(a,b,c){a=this.Eb.Nd.gf(this.NGa.cI(a,c),b);return Oe.a.$v(a)}Nbe(a){a=cd.a.Ql(a.Wj(rd.a.Zu),a.Wj(rd.a.iI));return 1>=a?0:a}Nfe(a){a=cd.a.Ql(a.Wj(rd.a.Zu),a.Wj(rd.a.TE));return 1>=a?0:a}J7a(){this.L8c&&this.gY&&(this.ia.Ja(ea.a.Ntc,2,this.gY),this.gY=null);if(this.Pwa){for(var a=0;a<this.OIa.length;a++){var b=this.rk(this.OIa[a]);b&&
!b.Ml&&(b.shapeNode.Of&&b.shapeNode.isEditable||(b.aM=!1),b.hA(!1))}this.ia.Ja(ea.a.Ckb,2,this.Pwa);this.Pwa=null}if(this.bZa){a=[];for(b=0;b<this.OIa.length;b++){let c=this.rk(this.OIa[b]);c&&!c.Ml&&(c.hA(!1),qd.a("FixUndoRotateMultipleShapes")?a.push(this.OIa[b]):this.ia.Ja(ea.a.Bsc,2,this.bZa[b]))}qd.a("FixUndoRotateMultipleShapes")&&(b={},b.selectedNodes=a,b.rotateData=this.bZa,this.ia.Ja(ea.a.evh,2,b));this.bZa=null}this.nJa=this.OIa=null}Ixc(){this.nJa&&Kc.a.evb(this.nJa);this.nJa=Kc.a.gba(Object(H.a)(this,
this.J7a,"applyPendingChangesToServerIfRequired"),1E3)}$$d(a){const b=cd.a.sab(a.ga(0),a.ga(3));a=cd.a.sab(a.ga(1),a.ga(2));return new Ce.a(new cd.a(b.x,b.y),new cd.a(a.x,b.y),new cd.a(a.x,a.y),new cd.a(b.x,a.y))}}Object(m.a)(gN,"FormatShapePaneActor",null,[108,268]);class bA{constructor(a,b,c,f,l,y,G){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=
null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const R=Object(sa.a)(Object,Zg.e().numberFormatInfo);if(!R)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=R;this.cellHeight=b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=y;this.emptyValueFields=G}}Object(m.a)(bA,"FormatTableTaskPaneProps",
null,[]);class hN{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.ckh=this.fkh=this.ekh=this.dkh=-1}}Object(m.a)(hN,"Margins",null,[]);class iN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){this.cwa=this.Ab=!1;this.jxi=320;this.eZa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");
if(!y)throw Error.argumentNull("graphOperationEventHandler");if(!G)throw Error.argumentNull("viewElementEventHandlers");if(!R)throw Error.argumentNull("viewEventSource");if(!ja)throw Error.argumentNull("pageView");if(!za)throw Error.argumentNull("unitConversion");if(!Va)throw Error.argumentNull("workspace");if(!Cb)throw Error.argumentNull("tableReader");if(!lc)throw Error.argumentNull("rowReader");if(!ic)throw Error.argumentNull("columnReader");if(!hb)throw Error.argumentNull("loadScript");hb("powerpoint-editor-intl").then(()=>
{this.eZa=!0}).catch(yc=>{ya.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+yc.toString())});this.jb=a;this.Rb=b;this.ia=c;this.Fa=f;this.Rf=y;this.od=G;this.Fc=R;this.Rf.LI(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.Rf.zCa(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.Fc.SQa(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.od.DCa(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.Rb.MI(Object(H.a)(this,this.Eu,
"onAppFrameModeSwitched"));this.WJ=ic;this.CZa=lc;this.zc=Cb}dispose(){this.Rf.E6(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.Rf.G0a(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.Fc.pkb(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.od.rkb(Object(H.a)(this,this.q_a,"onChangeRenderFormatTablePane"));this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"))}vb(){this.ia.ra(ea.a.Iuc,qc.a.application,Object(H.a)(this,this.Iuc,"showHideReactFormatTablePane"),
4);this.ia.ra(ea.a.zLb,qc.a.application,Object(H.a)(this,this.zLb,"queryReactFormatTablePane"),96)}me(){}q_a(){this.Ab&&this.kl(!0)}Eu(a){1===a.mode&&this.Ab&&(this.Ab=!1,this.Kq(),this.Fa.wj(xa.a.Kza,this.Ab))}zLb(a,b,c,f,l){(a=Object(sa.a)(gi.a,l))&&a.If(this.Ab);return 32}Iuc(a,b,c){if(!this.eZa)return 8;b=this.jb.Qf();if(1===c)return b.length?32:8;this.Ab=!this.Ab;return Vg.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Ab.toString(),a,()=>{this.Ab?this.kl():this.Kq();return 32})}kl(a=
!1){const b=this.kA(),c=Object.assign(new yu.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.jxi,location:2,contentProps:b,onOpen:()=>{ya.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},onClose:()=>{this.Ab=!1;ya.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});Mj.UISurfaces.Iq().then(f=>{a?f.updateTaskPane(xa.a.Kza,c):f.showTaskPane(xa.a.Kza,c);return null}).catch(f=>{ya.a.J(512500571,
822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}Kq(){Mj.UISurfaces.Iq().then(a=>{a.hideTaskPane(xa.a.Kza,2);return null}).catch(a=>{ya.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+a.toString())})}kA(){var a=this.jb.zn();const b=new hN;if(!a)return a=new bA(b,0,0,0,0,!0,255),this.I0e(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.lsj(a,c,f));const l=Oe.a.$v(this.zc.bfe(a)),y=Oe.a.$v(this.zc.dfe(a));
let G=this.jb.Fv();G&&G.length||(G=this.zc.WF(a));if(!G||!G.length)return a=new bA(b,c,f,l,y,!0,255),this.I0e(a);this.ksj(G,b);a=new bA(b,c,f,l,y,!1,0);this.I0e(a);this.xUl(a);return a}I0e(a){a.onChange=Object(H.a)(this,this.Lxa,"onPropertyChange");a.isAspectRatioLocked=this.cwa;a.onToggleAspectRatio=Object(H.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}lsj(a,b,c){let f=this.jb.UXc(),l=this.jb.czb();f&&f.length||(f=this.zc.ala(a));l&&l.length||(l=this.mzb(a));f.length&&(b=Oe.a.$v(this.CZa.v7f(f)));
l.length&&(c=Oe.a.$v(this.WJ.x7f(a,l)));return{cellHeight:b,cellWidth:c}}ksj(a,b){let c=!0,f=!0,l=!0,y=!0;for(const G of a)G&&!G.isGhostCell&&({q1c:c,cellMargin:b.leftMargin,vnd:b.dkh}=this.kzd(c,b.leftMargin,G.marginLeft,b.dkh),{q1c:f,cellMargin:b.rightMargin,vnd:b.ekh}=this.kzd(f,b.rightMargin,G.marginRight,b.ekh),{q1c:l,cellMargin:b.topMargin,vnd:b.fkh}=this.kzd(l,b.topMargin,G.marginTop,b.fkh),{q1c:y,cellMargin:b.bottomMargin,vnd:b.ckh}=this.kzd(y,b.bottomMargin,G.marginBottom,b.ckh))}kzd(a,b,
c,f){a&&(b=Oe.a.$v(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{q1c:a,cellMargin:b,vnd:f}}xUl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}Lxa(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.Ja(ea.a.J1a,2,c);break;case 1:this.ia.Ja(ea.a.XLa,2,c);break;case 2:this.ia.Ja(ea.a.upa,2,c);break;case 3:this.ia.Ja(ea.a.YLa,
2,c);break;case 4:this.ia.Ja(ea.a.Gvc,2,c);break;case 5:this.ia.Ja(ea.a.Kvc,2,c);break;case 6:this.ia.Ja(ea.a.Lvc,2,c);break;case 7:this.ia.Ja(ea.a.Fvc,2,c)}}onToggleAspectRatio(a){this.cwa=a;this.ia.Ja(ea.a.utc,2,null)}mzb(a){let b=null;a&&14===a.type&&(b=this.zc.$ee(a.firstRow));return b}}Object(m.a)(iN,"FormatTablePaneActor",null,[108,268]);class cA{constructor(a,b,c){this.pa=a;this.Eb=b;this.Ga=c}process(a,b,c,f){2===c&&32===f&&b.contextId===rb.a.view&&Array.contains(cA.Pil,a)&&(a=this.pa.Ud(),
0<a.length&&0<this.Ga.textLength(a[0])&&this.HBi(a[0]))}HBi(a){if(!a.Aaa){var b=Vd.SelectionFactory.rl(a);b=Jb.SelectionEditor.E6b(b);var c=Jb.SelectionEditor.D6b(b,!1);b=Vd.SelectionFactory.aO(b,c.Ua,!1);if((c=this.pa.Pa)&&c.nb&&c.nb.contains(b)&&2===a.Sz){var f=Object(sa.a)(117,a.qc(this.Eb.Na));if(f){b=a.Sz;c=a.k2;var l=a.l2;a.Sz=1;a.k2=1;a.l2=0;f=f.hZf();f.pGf();f.tFf();f.pAa();f.x0f()&&(a.Sz=b,a.k2=c,a.l2=l);f.detach();f.o$e()}}}}}cA.Pil=[C.a.Xq,C.a.qH,C.a.fI];Object(m.a)(cA,"FormattingViewOperationFinishedStageProcessor",
null,[462]);var cS=d(630);class jN extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(m.a)(jN,"SectionNodeChangedArgs",Sys.EventArgs,[]);class kN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.mR=null;this.nq=a;this.Fb=b;this.Ub=c;this.pa=f;this.Fa=l;this.la=R;this.En=this.la.fD;this.xe=G;this.tfa=this.la.Dqe;this.Sb=y;this.Nad=this.la.gdc;this.fc=ja;this.Gt=za;this.ua=Va;this.Eb=hb;Cb.execute(lc=>{this.mR=lc})}R3i(a,b,c){if(a&&a.length){for(var f of a)if(!f||nc.a.Fw(f.Cb))return;
f=this.la.Xn?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Eb&&1===this.Eb.al;var l=this.Fb.yd(15,void 0,()=>{this.Fa.wf(Si.a.fE);this.pa.nh()});try{l.jc(this.nq),this.tfa?this.nq.VKe(a,b,c,f):this.nq.UKe(a[0],b,c,f)}finally{l&&l.dispose()}}}E_f(a,b){var c=this.Sb.yn;if(c&&c.Yp)if(b&&!a||!b&&a===c.Yp.length-1)ya.a.J(509364431,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=qd.a("FixSectionMoveBug")?c.Nkl:c.Yp;var l=Date.now(),
y=this.Fb.yd(15,void 0,()=>{},()=>{});try{y.jc(this.nq);const G=f[a],R=b?f[a-1]:f[a+1];c.setValue(va.a.oBk,G);c.setValue(va.a.UAk,R);if(G&&R){let ja=-1,za=-1;for(let Va=0;Va<f.length&&!(G===f[Va]&&(ja=Va),R===f[Va]&&(za=Va),0<=ja&&0<=za);Va++);Array.removeAt(f,ja);Array.insert(f,za,G);c.anchor?c.anchor.Gmb(f,34,!1):ya.a.J(509364430,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{y&&y.dispose()}this.ua.Ru=b?0<=a-1?a-1:0:a+1;c=Date.now();ya.a.J(509364429,
822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.Gt?this.Gt.fVe():ya.a.J(509364428,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(509364432,808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}x3i(a,b){if(a||qd.a("AllowSectionAfterLastSlide")){var c=this.Sb.yn;if(c){var f=c.Yp;f&&
f.length||ya.a.J(509364425,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Fb.yd(15,void 0,()=>{},()=>{});try{l.jc(this.nq);l.gd=b;const y=f&&f.length?a?this.xe.NQ(a.Cb):f.length-1:0;this.nq.x7a(a,y)}finally{l&&l.dispose()}this.fc.uw(this.nq,b);b=Date.now();ya.a.J(509364424,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",a.slideIndex,c,b,b-c);this.Gt?this.Gt.fVe():
ya.a.J(509364423,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(509364426,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else ya.a.J(509364427,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}d4i(a){var b=this.Sb.yn;if(b&&b.Yp){var c=b.Yp;if(!a||a.sectionIndex>=c.length)ya.a.J(509364421,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=b.Bcg(a.sectionIndex);c=null;f&&(c=Object(sa.a)(cS.a,
b.iuj(f.aF)));b=Date.now();f=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{});try{f.jc(c),c.title=a.fWl}finally{f&&f.dispose()}c=Date.now();ya.a.J(509364420,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",a.sectionIndex,b,c,c-b)}}else ya.a.J(509364422,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}W3i(a,b){const c=this.Sb.yn;if(c&&c.Yp){var f=c.Yp,l=this.ua.j8,
y=Date.now(),G=f.length,R=this.Fb.yd(15,void 0,()=>{},()=>{});try{R.jc(this.nq);R.gd=b;if(a){const ja=this.Sb.azb(a-1);let za=l.$A;if(ja&&za){const Va=ja.$A?ja.$A:[];for(let hb=0;hb<za.length;hb++)Array.insert(Va,Va.length,za[hb]);za=[];ja.$A=Va}}Array.removeAt(f,a);c.vUf(l)}finally{R&&R.dispose()}this.ua.Ru=0<=a-1?a-1:0;this.fc.uw(this.nq,b);b=Date.now();ya.a.J(509364418,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",
a,y,b,b-y,G,f.length);this.Gt?this.Gt.B2k(new jN(l)):ya.a.J(509364417,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else ya.a.J(509364419,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}FSc(a,b,c,f){if(!b||!this.Nad&&!c)return null;let l=null;const y=this.Fb.yd(15,void 0,()=>{qd.a("FixDocumentFocusIssue")||this.Fa.Bd();this.pa.nh()},()=>{1!==this.Eb.al&&(qd.a("FixDocumentFocusIssue")?this.Fa.wf(this.Fa.Ee.name):
this.Fa.wf(Si.a.fE))});try{let G;G=this.la.Xn?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Eb&&1===this.Eb.al;let R;R=qd.a("SlideSorterInsertionAfterFirstSlide")?!!this.Eb&&1===this.Eb.al&&-1===this.Ub.gya:!!this.Eb&&1===this.Eb.al&&!this.Ub.gya;const ja=this.ua.j8;if(G&&ja&&(!ja.hI||!ja.hI.length)||R)R&&(this.Ub.gya=-1),a=null;y.jc(this.Ub.Gf);y.gd=f;l=Object(sa.a)(116,this.nq.L_b(a,ja,b,c,G));this.En&&this.pa.yP(l);this.Ub.Ba=l;this.Ub.Gf.removeProperty(va.a.YPe)}finally{y&&
y.dispose()}return l}Q3i(a,b,c,f,l,y){if(5!==f)throw Error.invalidOperation();const G=Object(sa.a)(116,this.nq.I2d(a,b,c));if(!G)return ya.a.J(509364416,822,10,"CreateSlideNodeForInsertion returned null"),null;b=this.la.Xn?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Eb&&1===this.Eb.al;c=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{this.En&&this.pa.yP(G);this.Fa.wf(Si.a.fE)});try{c.jc(this.Ub.Gf),c.gd=y,this.nq.Tbb(G,a,null,b),l&&(this.Ub.Ba=G)}finally{c&&c.dispose()}return G}K3i(a,
b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");c||(c=a);let f;f=this.la.Xn?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Eb&&1===this.Eb.al;let l=null;const y=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Eb.al&&(this.la.Xn?this.Fa.wf(xa.a.nC):this.Fa.wf(Si.a.fE))});try{y.jc(this.Ub.Gf),y.gd=b,l=Object(sa.a)(116,this.nq.BQ(Object(sa.a)(115,a),Object(sa.a)(115,c),f,!0)),this.mR&&this.mR.cVf([l]),this.En&&this.pa.yP(l),this.Ub.Ba=l}finally{y&&y.dispose()}return l}z_f(a,
b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const y=[];a=Array.clone(a);a.sort((ja,za)=>za.qe-ja.qe);c||(c=a[0]);let G;G=this.la.Xn?!0:w.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Eb&&1===this.Eb.al;const R=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Eb.al&&(this.la.Xn?this.Fa.wf(xa.a.nC):this.Fa.wf(Si.a.fE))});try{R.jc(this.Ub.Gf);R.gd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const za=Object(sa.a)(116,this.nq.BQ(Object(sa.a)(115,
a[b]),Object(sa.a)(115,c),G,l));na.a.Xa(f)||(za.Wb=f);Array.add(y,za)}0<y.length&&this.mR&&this.mR.cVf(y);let ja;(ja=this.pa).yP.apply(ja,y);this.Ub.Ba=y[y.length-1];this.xe.Q9a=!0}finally{R&&R.dispose()}return y}HT(a,b,c,f=null,l=null,y=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");if(f&&a.length!==f.length)throw Error.invalidOperation();let G=null;y&&1!==this.Eb.al&&(G=()=>{this.pa.j1a(a,
!0)});y=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},G);try{y.jc(b);y.gd=c;this.uhi(y,a);const R=new Sys.StringBuilder;for(c=0;c<a.length;c++){const ja=f?f[c]:null;a[c]&&(b.oB(a[c],ja),a[c].id&&R.append(a[c].id.toString()+";"))}y.ry[Nq.a.Bhh]=R.toString();l&&b.cS([l])}finally{y&&y.dispose()}}uhi(a,b){if(1!==b.length||!b[0].xd&&na.a.Xa(b[0].M_a))for(const c of b){if(c.Ncb||c.tj)a.ry[Nq.a.j$b]=!0;if(c.Pp||2===c.mediaType||1===c.mediaType)a.ry[Nq.a.JZc]=!0;c.qr&&(a.ry[Nq.a.IZc]=
!0)}else a.ry[Nq.a.k$b]=!0}Y9a(a,b){if(!(1>b.length)){var c=this.Fb.yd(15);try{c.jc(b[0]);const f=this.pa.tP(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&c.dispose()}}}ska(a,b){this.Y9a(c=>{(c=Object(sa.a)(4,c))&&a(c)},b)}}Object(m.a)(kN,"GraphTransactionHelperProxy",null,[427]);var JE=d(294),nq=d(295);class lN{constructor(a,b,c,f){this.Jsc=a;this.Ksc=b;this.b5c=c;this.c5c=f}naf(a,b,c,f){a<this.Jsc&&(this.Jsc=a);b<this.Ksc&&(this.Ksc=b);a+c>this.b5c&&(this.b5c=a+c);b+f>this.c5c&&(this.c5c=
b+f)}}Object(m.a)(lN,"GroupShapeOffset",null,[]);class mN{constructor(a,b,c,f,l,y,G,R,ja,za){this.ia=a;this.Fb=b;this.pa=c;this.Ga=f;this.ua=l;this.wk=y;this.Eb=G;this.oi=R;this.MO=ja;this.la=za}vb(){this.ia.ra(ea.a.rRe,qc.a.application,Object(H.a)(this,this.hFj,"handleGroupShapes"),4);this.ia.ra(ea.a.zRe,qc.a.application,Object(H.a)(this,this.WJj,"handleUngroupShapes"),4);this.ia.ra(ea.a.qRe,qc.a.application,Object(H.a)(this,this.gFj,"handleGroupFlyoutAnchor"),4)}me(){const a=this.MO.Wo.Ic(xa.a.qg);
a.bindAction(x.KeyInputManager.Va(B.a.mSb,x.KeyInputManager.Te),ea.a.rRe);a.bindAction(x.KeyInputManager.Va(B.a.mSb,x.KeyInputManager.Te|4),ea.a.zRe)}RJf(a){let b=1<a.length&&!a[0].Ug&&!a[1].Ug;if(b)for(const c of a)if(this.la.gla){if(c.MIb||c.Ik||c.xd){b=!1;break}}else if(c.Ik||c.xd){b=!1;break}return b}Upj(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=0);return a}hFj(a,b,c){const f=this.pa.Ud();return this.RJf(f)?1===c?32:Vg.a("GroupOperations_GroupShapes",a,
()=>{const l=[];for(var y of f)l.push(y.id);y=Object(sa.a)(116,this.ua.Ba);if(!y)throw Error.argumentNull("ActiveSlide is null");const G=y.Cs(),R=new lN(y.Xp,y.Xk,0,0);var ja=0;let za=ja=0;for(var Va of f)(ja=this.Upj(Va),Va.wz)?(ja=Va.My,za=Va.Ny,R.naf(ja,za,Va.Ada,Va.zda)):ja?90===ja&&(ja=Va.My+Va.Ix/2-Va.iD/2,za=Va.Ny+Va.iD/2-Va.Ix/2,R.naf(ja,za,Va.iD,Va.Ix)):(ja=Va.My,za=Va.Ny,R.naf(ja,za,Va.Ix,Va.iD));const hb=this.wk.BDa(!1,y.Cb.cid,y.Cb.sid,0,10,R.Jsc,R.Ksc,R.b5c-R.Jsc,R.c5c-R.Ksc,G+1);ya.a.J(595359714,
822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.YTj(hb,y.Cb,R.b5c-R.Jsc,R.c5c-R.Ksc);y.oB(hb);Va=this.Fb.yd(15,void 0,void 0,()=>{this.pa.selectShape(hb,!0)});try{Va.jc(y),Va.gd=a,1<l.length&&(y.s9=l)}finally{Va&&Va.dispose()}return 32}):8}gKf(a){for(const b of a)if(this.la.gla){if(b.Of&&!b.NIb)return!0}else if(b.Of)return!0;return!1}WJj(a,b,c){const f=this.pa.Ud();return this.gKf(f)?1===c?32:Vg.a("GroupOperations_UngroupShapes",a,()=>{const l=[];
var y=[];for(const R of f)if(R.Of){l.push(R.id);const ja=this.Ga.yx(R);for(const za of ja)y.push(za);this.pa.O8(R)}for(var G of y)y=vg.c(G,this.Eb.Na),this.pa.O8(G),y.lla(),y.sNb=!0;G=this.ua.Ba;ya.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);y=this.Fb.yd(15);try{y.jc(G),y.gd=a,G.Xpa=l}finally{y&&y.dispose()}return 32}):8}gFj(a,b,c){b=this.pa.Ud();a=this.RJf(b);b=this.gKf(b);return 1===c?a||b?32:8:32}YTj(a,b,c,f){var l=Object(sa.a)(424,
Object(sa.a)(116,this.ua.Ba).rg(this.Eb.Na));const y=this.Eb.Nd,G=Math.round(this.oi.tK(y.Pe(c,0),l.$T));l=Math.round(this.oi.tK(y.Pe(f,1),l.$T));a.setValue(Ya.a.Ix,c);a.setValue(Ya.a.iD,f);a.setValue(va.a.fSb,c);a.setValue(va.a.Pzb,f);a.isEditable=!0;a.Of=!0;a.setValue(va.a.mL,4);a.setValue(va.a.sqd,!0);a.Ada=ve.a.tKa(G,0);a.zda=ve.a.tKa(l,1);a.setValue(va.a.NSa,0);a.setValue(va.a.OSa,0);a.setValue(va.a.cWa,!0);a.setValue(va.a.isResizable,!0);a.setValue(va.a.bM,!0);a.sO=!0;a.YVa=!0;a.bM=!0;a.isResizable=
!0;a.CG=nc.a.ax(b.sid,b.cid);a.qmb=a.get_shapeId();a.setValue(va.a.Kua,!0);b=Object.assign(new JE.a,{TopLeft:Object.assign(new nq.a,{X:0,Y:0}),TopRight:Object.assign(new nq.a,{X:G,Y:0}),BottomLeft:Object.assign(new nq.a,{X:0,Y:l}),BottomRight:Object.assign(new nq.a,{X:G,Y:l})});a.dS=b;this.Ga.cM(a)&&Kc.a.Kb&&(Kc.a.Kb.Qj=!0)}}Object(m.a)(mN,"GroupUngroupShapesActor",null,[268]);class nN{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=
!1}}Object(m.a)(nN,"FooterPaneInfo",null,[]);var oN=d(628);class KE{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(m.a)(KE,"PresFooterInfo",null,[]);var pN=d(656);class qN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.Oma=null;a("powerpoint-editor-intl").then(()=>{ya.a.J(509117598,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{ya.a.J(509117597,
801,50,"Header Footer Pane Manager script is loaded successfully");this.Oma=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();this.b8k()}).catch(lc=>{ya.a.J(509117596,801,10,"Failed to load headerfooter pane manager "+lc.toString())})}).catch(lc=>{ya.a.J(509117595,801,10,"Failed to load powerpoint-editor-intl "+lc.toString())});this.jb=b;this.Rb=c;this.ia=f;this.Ub=l;this.ua=y;this.Fa=G;this.Pv=R;this.Rf=ja;this.od=za;this.Fc=Va;this.Fb=hb;this.Rf.LI(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));
this.Rf.E7a(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rf.zCa(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Fc.SQa(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.od.DCa(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rb.MI(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"));this.Ez=null;this.TFb=!1;this.nHb=Cb}dispose(){this.Rf.E6(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rf.Orc(Object(H.a)(this,this.eK,
"onChangeRenderHeaderFooterPane"));this.Rf.G0a(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Fc.pkb(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.od.rkb(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"))}me(){}vb(){this.ia.ra(ea.a.Pbb,qc.a.application,Object(H.a)(this,this.Pbb,"insertFooterFlyoutMenu"),4);this.ia.ra(ea.a.oZ,qc.a.application,Object(H.a)(this,this.oZ,"showHideHeaderFooterPane"),
4);this.ia.ra(ea.a.yVa,qc.a.application,Object(H.a)(this,this.yVa,"insertSlideNumber"),4);this.ia.ra(ea.a.hqc,qc.a.application,Object(H.a)(this,this.hqc,"queryHeaderFooterPane"),96)}hqc(a,b,c,f,l){(a=Object(sa.a)(gi.a,l))&&a.If(this.Pv.isVisible);return 32}Pbb(){return this.Oma&&this.Ub&&this.ua.Ba&&this.Ub.isEditingAllowed?32:8}oZ(a,b,c){if(1===c)return this.Pv&&this.ua.Ba?32:8;if(!this.Pv)return 8;this.Ez=null;this.Pv.isVisible=!this.Pv.isVisible;this.Pv.isVisible?(Vg.a("FooterPaneOpen",a,()=>{this.Rrc();
return 32}),this.nHb||(this.Fa.wj(xa.a.nJ,!0),this.Oma.focus())):this.Fa.wj(xa.a.nJ,!1);return 32}yVa(a,b,c,f,l){return 1===c?this.ua.Ba?32:8:Vg.a("FooterPaneInsertSldNumber",a,()=>{const y=this.gpc();this.Exc(y.OmitOnTitlePh,y.IsFooterInsert,y.SFooterName,!0);return this.oZ(a,b,c,f,l)})}Eu(a){1===a.mode&&this.Pv&&this.Pv.isVisible&&(this.Ez=null,this.Pv.isVisible=!1,this.Fa.wj(xa.a.nJ,!1))}ode(a){const b=new Oa.a;a=a.vy();for(const c of a)(a=zb.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}gpc(){const a=
new oN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.yj(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.Ik&&(5===c.Cj?a.IsSlideNumInsert=!0:6===c.Cj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.mA?this.ode(c):"",0<b.length?a.SFooterName=b:ya.a.J(509117594,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Ub.Gf.OJa;return a}isMultipleSlidesSelected(){const a=this.jb.Re();return a&&1<a.length?!0:!1}Rrc(){if(this.Pv.isVisible)if(this.ua.Ba){var a=
this.gpc(),b=this.isMultipleSlidesSelected();if(!this.Ez||a.IsFooterInsert!==this.Ez.IsFooterInsert||a.IsSlideNumInsert!==this.Ez.IsSlideNumInsert||a.OmitOnTitlePh!==this.Ez.OmitOnTitlePh||a.SFooterName.localeCompare(this.Ez.SFooterName)||b!==this.TFb){this.Ez=a;this.TFb=b;var c=new nN;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.Oma.renderHeaderFooterTaskPane(pN.a.sie,c)}}else this.Pv.isVisible=
!1,this.Ez=null}eK(){this.Rrc()}b8k(){this.Oma.addCloseHeaderFooterPaneEventListener(()=>{this.Pv.isVisible=!1;this.Ez=null});this.Oma.addFocusHeaderFooterPaneListener(()=>{this.Fa.wj(xa.a.nJ,!0)});this.Oma.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.Z$e(a,b,c,f,l)});this.Oma.addUpdateMultiSlideHeaderFooterListener((a,b,c,f)=>{this.kaf(a,b,c,f)})}Z$e(a,b,c,f,l){this.ua.Ba&&(l?this.saf(a,b,c,f):this.Exc(a,b,c,f))}kaf(a,b,c,f){this.ua.Ba&&Vg.a("FooterPaneMultiSlide",ea.a.oZ,()=>{const l=this.Fb.yd(15,
void 0,()=>{this.jb.nj()});try{l.jc(this.ua.Ba);const y=this.jb.Re();if(y&&1<y.length){for(const G of y){const R=G.Y8;R.IsSlideNumInsert=f;R.IsFooterInsert=b;R.OmitOnTitlePh=a;R.SFooterName=c;R.IsToggled=!R.IsToggled;G.Y8=R}this.Ub.Gf.OJa=a}}finally{l&&l.dispose()}return 32})}Exc(a,b,c,f){let l="FooterPaneSingleSlide";const y=this.ua.Ba,G=y.Y8;if(a||b||f)G.OmitOnTitlePh!==a?l+="_OPH":G.IsSlideNumInsert!==f?l+="_ISN":G.IsFooterInsert!==b&&(l+="_IFT");Vg.a(l,ea.a.oZ,()=>{const R=this.Fb.yd(15,void 0,
()=>{this.jb.nj()});try{R.jc(this.ua.Ba),G.IsSlideNumInsert=f,G.IsFooterInsert=b,G.OmitOnTitlePh=a,G.SFooterName=c,G.IsToggled=!G.IsToggled,this.Ub.Gf.OJa=a,y.Y8=G}finally{R&&R.dispose()}return 32})}saf(a,b,c,f){Vg.a("FooterPaneAllSlides",ea.a.oZ,()=>{const l=this.Fb.yd(15,void 0,()=>{this.jb.nj()});try{const y=this.Ub.Gf;l.jc(y);let G=y.GKa;G||(G=new KE);const R=this.ua.Ba;G.ActiveSlideCid=R.cid;G.ActiveSlideSid=R.sid;G.IsSlideNumInsert=f;G.IsFooterInsert=b;G.IsOmitOnTitlePh=a;G.SFooterName=c;G.IsToggled=
!G.IsToggled;y.OJa=a;y.GKa=G}finally{l&&l.dispose()}return 32})}}Object(m.a)(qN,"HeaderFooterPaneActor",null,[268]);class rN{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(m.a)(rN,"FooterPaneInfo",null,[]);class sN{constructor(){this.type="HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(m.a)(sN,"HeaderFooterContentProps",
null,[]);class tN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.$9c=!1;Cb?this.$9c=!0:a("powerpoint-editor-intl").then(()=>{ya.a.J(509117590,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{ya.a.J(509117589,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>{ya.a.J(509117588,801,50,"Header Footer Pane script is loaded successfully");this.$9c=!0}).catch(()=>{ya.a.J(509117587,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>
{ya.a.J(509117586,801,10,"Failed to load Ribbon script")})}).catch(lc=>{ya.a.J(509117585,801,10,"Failed to load powerpoint-editor-intl "+lc.toString())});this.jb=b;this.Rb=c;this.ia=f;this.Ub=l;this.ua=y;this.Pv=R;this.Rf=ja;this.od=za;this.Fc=Va;this.Fb=hb;this.Rf.LI(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rf.E7a(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rf.zCa(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Fc.SQa(Object(H.a)(this,
this.eK,"onChangeRenderHeaderFooterPane"));this.od.DCa(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rb.MI(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"));this.Ez=null;this.TFb=!1;this.nHb=Cb}dispose(){this.Rf.E6(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rf.Orc(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rf.G0a(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Fc.pkb(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));
this.od.rkb(Object(H.a)(this,this.eK,"onChangeRenderHeaderFooterPane"));this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"))}me(){}vb(){this.ia.ra(ea.a.Pbb,qc.a.application,Object(H.a)(this,this.Pbb,"insertFooterFlyoutMenu"),4);this.ia.ra(ea.a.oZ,qc.a.application,Object(H.a)(this,this.oZ,"showHideHeaderFooterPane"),4);this.ia.ra(ea.a.yVa,qc.a.application,Object(H.a)(this,this.yVa,"insertSlideNumber"),4)}Pbb(){return this.Ub&&this.ua.Ba&&this.Ub.isEditingAllowed?32:8}oZ(a,b,c){if(1===c)return this.$9c?
32:8;if(!this.Pv)return 8;this.Ez=null;this.Pv.isVisible=!this.Pv.isVisible;this.Pv.isVisible?Vg.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.nHb.toString(),a,()=>{this.Rrc();return 32}):this.Kq();return 32}Eu(a){1===a.mode&&this.Pv&&this.Pv.isVisible&&(this.Ez=null,this.Pv.isVisible=!1,this.Kq())}kl(a=!1){const b=this.kA(),c=Object.assign(new yu.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Pv.isVisible=!1},isModernPane:!0});
this.nHb?Mj.UISurfaces.Iq().then(f=>{a?f.updateTaskPane(xa.a.nJ,c):f.showTaskPane(xa.a.nJ,c);return null}):(this.Pv.isVisible=!0,taskPanes.taskPane.renderTaskPane(pN.a.sie,c))}Kq(){this.nHb&&Mj.UISurfaces.Iq().then(a=>{a.hideTaskPane(xa.a.nJ,2);return null})}kA(){const a=new rN;a.isFooterInsert=this.Ez.IsFooterInsert;a.sFooterName=this.Ez.SFooterName;a.isSlideNumInsert=this.Ez.IsSlideNumInsert;a.omitOnTitle=this.Ez.OmitOnTitlePh;a.isMultipleSlidesSelected=this.TFb;const b=new sN;b.activeSlideFooterInfo=
a;b.onUpdateHeaderFooter=Object(H.a)(this,this.Z$e,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(H.a)(this,this.kaf,"updateMultiSlidesFooterInfo");return b}yVa(a,b,c,f,l){return 1===c?this.$9c?32:8:Vg.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.nHb.toString(),a,()=>{const y=this.gpc();this.Exc(y.OmitOnTitlePh,y.IsFooterInsert,y.SFooterName,!0);return this.oZ(a,b,c,f,l)})}ode(a){const b=new Oa.a;a=a.vy();for(const c of a)(a=zb.ParagraphReader.text(c))&&0<a.length&&b.add(a);
return b.toArray().join(" ")}gpc(){const a=new oN.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.yj(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.Ik&&(5===c.Cj?a.IsSlideNumInsert=!0:6===c.Cj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.mA?this.ode(c):"",0<b.length?a.SFooterName=b:ya.a.J(509117584,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Ub.Gf.OJa;return a}isMultipleSlidesSelected(){const a=this.jb.Re();return a&&1<a.length?!0:!1}Rrc(a=
!1){if(this.Pv.isVisible)if(this.ua.Ba){var b=this.gpc(),c=this.isMultipleSlidesSelected();if(!this.Ez||b.IsFooterInsert!==this.Ez.IsFooterInsert||b.IsSlideNumInsert!==this.Ez.IsSlideNumInsert||b.OmitOnTitlePh!==this.Ez.OmitOnTitlePh||b.SFooterName.localeCompare(this.Ez.SFooterName)||c!==this.TFb)this.Ez=b,this.TFb=c,this.kl(a)}else this.Pv.isVisible=!1,this.Ez=null}eK(){this.Rrc(!0)}Z$e(a,b,c,f,l){this.ua.Ba&&(f?this.saf(a,b,l,c):this.Exc(a,b,l,c))}kaf(a,b,c,f){this.ua.Ba&&Vg.a("FooterPaneMultiSlide",
ea.a.oZ,()=>{const l=this.Fb.yd(15,void 0,()=>{this.jb.nj()});try{l.jc(this.ua.Ba);const y=this.jb.Re();if(y&&1<y.length){for(const G of y){const R=G.Y8;R.IsSlideNumInsert=c;R.IsFooterInsert=b;R.OmitOnTitlePh=a;R.SFooterName=f;R.IsToggled=!R.IsToggled;G.Y8=R}this.Ub.Gf.OJa=a}}finally{l&&l.dispose()}return 32})}Exc(a,b,c,f){let l="FooterPaneSingleSlide";const y=this.ua.Ba,G=y.Y8;if(a||b||f)G.OmitOnTitlePh!==a?l+="_OPH":G.IsSlideNumInsert!==f?l+="_ISN":G.IsFooterInsert!==b&&(l+="_IFT");Vg.a(l,ea.a.oZ,
()=>{const R=this.Fb.yd(15,void 0,()=>{this.jb.nj()});try{R.jc(this.ua.Ba),G.IsSlideNumInsert=f,G.IsFooterInsert=b,G.OmitOnTitlePh=a,G.SFooterName=c,G.IsToggled=!G.IsToggled,this.Ub.Gf.OJa=a,y.Y8=G}finally{R&&R.dispose()}return 32})}saf(a,b,c,f){Vg.a("FooterPaneAllSlides",ea.a.oZ,()=>{const l=this.Fb.yd(15,void 0,()=>{this.jb.nj()});try{const y=this.Ub.Gf;l.jc(y);let G=y.GKa;G||(G=new KE);const R=this.ua.Ba;G.ActiveSlideCid=R.cid;G.ActiveSlideSid=R.sid;G.IsSlideNumInsert=f;G.IsFooterInsert=b;G.IsOmitOnTitlePh=
a;G.SFooterName=c;G.IsToggled=!G.IsToggled;y.OJa=a;y.GKa=G}finally{l&&l.dispose()}return 32})}}Object(m.a)(tN,"HeaderFooterPaneWacActor",null,[268]);class uN{constructor(a,b,c,f,l){this.sr=a;this.ia=b;this.Ub=c;this.ua=f;this.fc=l}vb(){this.ia.ra(ea.a.e0c,rb.a.application,Object(H.a)(this,this.DFj,"handleInsertContentFromStream"),4)}me(){}DFj(a,b,c,f,l){b=this.ua.Ba;if(this.fc.fd(b))return 16;if(1===c)return 32;Kc.a.yk("SlideCount","1");c=this.sr.Q3i(b,l.streamUrl,l.formatType,l.objectType,l.renderAfterInsert,
a);l.renderAfterInsert&&c&&!c.vO&&this.fc.uw(this.Ub.Gf,a);return 32}}Object(m.a)(uN,"InsertContentFromStreamActor",null,[268]);class vN{constructor(a,b){this.oi=a;this.Sb=b}IXd(a,b,c,f){const l=G=>this.oi.tK(a.Pe(ve.a.gf(G,0),0),f),y=Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new JE.a,{TopLeft:Object.assign(new nq.a,{X:0,Y:0}),TopRight:Object.assign(new nq.a,{X:y,Y:0}),BottomLeft:Object.assign(new nq.a,{X:0,Y:b}),BottomRight:Object.assign(new nq.a,
{X:y,Y:b})})}z0d(a,b,c){var f=a?a.Jhe:9;const l=ve.a.Pe(a?a.Bbf:6,0,!1);f=ve.a.Pe(f,1,!1);b=this.EHi(l,f,b,c);a=a?a.Jyb(b.width,b.height,!0):this.Sb.Uka(b.width,b.height);return{m8d:b,mC:a}}EHi(a,b,c,f){let l=0,y=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),y=Math.max(f*a,1));return new sr.a(l,y)}}Object(m.a)(vN,"InsertImageHelper",null,[467]);var se=d(695),dA=d(694);class wN{Rcg(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);qd.a("FixInkDotInsertionAtHighZooms")?
(a=f.tK(b,c),c=f.tK(l,c)):(a=Math.round(f.tK(b,c)),c=Math.round(f.tK(l,c)));return{XBh:a,PBh:c}}xQf(a,b,c){return Object.assign(new JE.a,{TopLeft:Object.assign(new nq.a,{X:0,Y:0}),TopRight:Object.assign(new nq.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new nq.a,{X:0,Y:b*c}),BottomRight:Object.assign(new nq.a,{X:a*c,Y:b*c})})}Fzh(){}Qzh(){}}Object(m.a)(wN,"InsertInkActorHelper",null,[557]);var dS=d(512);class eA{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.A$=Cb;this.sr=a;this.ia=b;this.ua=c;this.fc=
f;this.Eb=l;this.Rq=R;this.wk=ja;this.kj=za;this.Ga=Va;this.oi=hb}dispose(){}vb(){this.ia.ra(ea.a.Cmg,rb.a.application,Object(H.a)(this,this.EFj,"handleInsertInk"),4)}me(){}EFj(a,b,c,f,l){if(!l)return 16;b=l.$c;if(!b)return ya.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;f=b.Cb;if(nc.a.Fw(f)||this.fc.fd(b))return 16;if(1===c)return 32;c=this.N$a(a);if(!c)return 8;if(!this.kj.hD(b,1))return this.kj.KD(b),16;var y=l.MTj;if(!y)return ya.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),
8;if(!y.count)return ya.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Oa.a;for(let Va of y){y=Va.rti;if(!y)return 16;var G=b.lx;G=G&&null!=G.ps?G.ps:1;y.right=y.left+(y.right-y.left)/(1/G);y.bottom=y.top+(y.bottom-y.top)/(1/G);var R=y.right-y.left,ja=y.bottom-y.top;R=Math.max(R,1);ja=Math.max(ja,1);var za=this.Eb.Nd;R=ve.a.gf(R,0);ja=ve.a.gf(ja,1);const hb=za.gf(y.left,0);za=za.gf(y.top,1);const Cb=b.Cs();y=dA.a.yPc(f,c,G,y,new wN,hb,za,R,ja,Cb,this.Ga,this.wk,this.Eb,
this.ua,this.oi);y.setValue(va.a.ula,Va.json);y.setValue(va.a.bGa,!0);Kc.a.Kb&&(Kc.a.Kb.actionName=eA.fZc);y.OI=new dS.a([Va.stroke],Va.json,!1);l.add(y)}this.sr.HT(l.toArray(),b,a,void 0,void 0,!1);for(let Va of l)this.A$.registerInkWithStrokeCollection(Va.OI.zza,Va.id);this.Rq.oA=l.ga(l.count-1);return 32}N$a(){return new se.a(4,10,1,1)}}eA.fZc="InsertInk";Object(m.a)(eA,"InsertInkActor",null,[268,108]);class xN{constructor(a,b,c,f,l,y,G,R,ja,za,Va){this.Nj=null;this.H$c=!1;this.Eb=a;this.wk=b;
this.Fa=c;this.ua=f;this.Sb=l;this.pa=G;this.Rq=R;this.kj=ja;this.Fb=za;this.fc=Va;this.la=y;this.nWl=y.insertOnlineVideoUrlPatterns;this.wth=y.insertOnlineVideoEndpoint;this.Qr=w.AFrameworkApplication.Je;this.$Kl=3E4}get startTime(){return this.Nj}X4i(a){if(!a)return null;const b=a.trim();this.X0j(b)&&(ya.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),a=this.Y4i(b));return a}vvg(a){if(!a)return!1;a=a.trim();for(const b of this.nWl)if((new RegExp(b)).test(a))return!0;return!1}a$j(a){if(!a)return!1;
a=a.trim();a=ug.a.jA(a).toLowerCase();return!this.la.rcb&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===a||!this.la.mCb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}ROl(a,b){this.requestVideoData(a,c=>{this.Smg(c)},b)}requestVideoData(a,b,c){this.H$c?ya.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):(this.H$c=!0,c=c||Object(H.a)(this,this.dZi,"doNothingCallback"),this.Nj=new Date,a=na.a.Ne(a),a=this.wth+(0<this.wth.indexOf("?")?
"&":"?")+"url="+a,this.Qr.qj(a,1,null,null,!1,2,f=>{b(f);this.H$c=!1},f=>{c(f);this.H$c=!1},null,void 0,void 0,void 0,this.$Kl,Nl.a("1")))}Smg(a){var b=+new Date-+this.startTime;ya.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Kc.a.yk("HubbleCallDuration",b.toString());if((b=this.ua.Ba)&&!this.fc.fd(b)&&this.kj.hD(b,1))try{const R=b.R_(this.pa.Ud());if(!R||!this.fc.fd(R)){var c=this.Gab(b,R),f=JSON.parse(a.data.Wd),l=f.width,y=f.height;c.d1e(f.embed_url,
f.thumbnail_url,f.title,f.description,0<l?l:0,0<y?y:0);var G=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(c,!0)});try{G.ld(b),this.la.YMl&&(G.gd=ea.a.Eua,G.ry[Nq.a.pka]=Nq.a.online),R&&b.cS([R]),b.oB(c)}finally{G&&G.dispose()}this.fc.uw(b,"InsertOnlineVideo");this.Rq.oA=c;ya.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(R){ya.a.J(38322706,352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",
R.message,R.stack)}else this.kj.KD(b)}dZi(){}Gab(a,b){if(!a)return null;var c=a.Cb;a=a.Cs();let f;const l=Pd.a.UR,y=Pd.a.BY;f=b?b.Jyb(Pd.a.UR,Pd.a.BY):this.Sb.Uka(Pd.a.UR,Pd.a.BY);const G=b?0:0*Qq.a.nT;c=this.wk.Xja(!0,c.cid,c.sid,0,f.x+G,f.y+G,l,y,a+1,!0);b&&(c.B8=b.id);return c}Y4i(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return ya.a.J(38322708,352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=
a.substr(b+1)}X0j(a){return a?RegExp(".*iframe.*").test(a):!1}y8f(a){if(!a)return"NA";let b=a.indexOf(".com/");if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(m.a)(xN,"InsertOnlineVideoDialogHelper",null,[428]);var yN=d(1058);class ck{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff){this.QFb=this.kIa=0;if(!jc)throw Error.argumentNull("insertShapeOverlayViewStateManager");
if(!Ie)throw Error.argumentNull("appFrame");if(!Pe)throw Error.argumentNull("viewEventNotifier");this.sr=a;this.ia=b;this.Fa=c;this.pa=f;this.HO=0;this.ua=ja;this.fc=l;this.Eb=y;this.iHa=G;this.Rq=Va;this.tYg=R;this.Rf=za;this.nq=ja.presentation;this.wk=hb;this.kj=Cb;this.$$c=lc;this.jZa=ic;this.Ga=yc;this.oi=ec;this.bYa=jc;this.nfa=xd;this.Ahc=Xd;this.n$c=Qd;this.Rb=Ie;this.$d=Pe;this.pXa=ig;this.skc=ff;this.Rf.LI(Object(H.a)(this,this.B_a,"onSlideNavigation"));this.tYg.gk(Object(H.a)(this,this.Dib,
"onPresentationPropertyChanged"));this.Ahc&&(this.Rb.MI(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched")),this.$d.B7a(Object(H.a)(this,this.kga,"onRibbonTabSwitched")),this.$d.mii(Object(H.a)(this,this.Eah,"onEscapeKeyPressed")));ck.Did.push(ea.a.A0c);ck.Did.push(ea.a.y0c);this.lJf()}dispose(){this.tYg.Qm(Object(H.a)(this,this.Dib,"onPresentationPropertyChanged"));this.Rf.E6(Object(H.a)(this,this.B_a,"onSlideNavigation"));this.Ahc&&(this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched")),
this.$d.Lrc(Object(H.a)(this,this.kga,"onRibbonTabSwitched")),this.$d.Qal(Object(H.a)(this,this.Eah,"onEscapeKeyPressed")))}vb(){for(const a of ck.WJl)this.ia.ra(a,rb.a.application,Object(H.a)(this,this.hhg,"handleInsertShape"),4);for(const a of ck.Bid)this.ia.ra(a,rb.a.application,Object(H.a)(this,this.hhg,"handleInsertShape"),4);this.ia.ra(ea.a.t0c,rb.a.application,Object(H.a)(this,this.GFj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.ra(ea.a.D0c,rb.a.application,Object(H.a)(this,this.HFj,
"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.ra(ea.a.qAi,rb.a.application,Object(H.a)(this,this.Bgg,"handleCancelInsertShape"),4);this.ia.ra(ea.a.nKf,rb.a.application,Object(H.a)(this,this.Bgg,"handleCancelInsertShape"),4);this.ia.ra(ea.a.I9a,rb.a.application,Object(H.a)(this,this.wEj,"handleDuplicateShape"),4)}me(){this.Fa.Ic(xa.a.qg).bindAction(x.KeyInputManager.Va(B.a.BNa,x.KeyInputManager.Te),ea.a.I9a);this.Fa.Ic(xa.a.DQ).bindAction(x.KeyInputManager.Va(B.a.BNa,x.KeyInputManager.Te),
ea.a.I9a)}lJf(){if(this.nq){var a=Math.min(this.nq.kGh,this.nq.XFh);a=Math.max(a-50,0);this.kIa=Math.floor(a/(2*Qq.a.nT))-1;this.kIa=Math.max(this.kIa,0);this.QFb=-1*this.kIa}else this.kIa=1,this.QFb=-1}Dib(a,b){b.property!==va.a.slideWidth&&b.property!==va.a.slideHeight||this.lJf()}B_a(){this.HO=0;this.Ahc&&this.oha(0)}Eu(a){1===a.mode&&this.oha(0)}kga(){this.oha(0)}Eah(){this.oha(0)}oha(a){1===a&&this.Fa.Bd();this.bYa.A8e(a)}hhg(a,b,c,f,l){b=this.ua.Ba;if(!b)return 16;f=b.Cb;if(nc.a.Fw(f)||this.fc.fd(b))return 16;
if(1===c)return 32;c=this.N$a(a);if(!c)return 8;if(!this.kj.hD(b,1))return this.kj.KD(b),16;const y=this.$$c&&this.jZa.sJ;var G=b.Fd.HasDefaultShape,R=b.Fd.HasDefaultLine,ja=95===c.Yga||97===c.Yga||Array.contains(dA.a.gte,c.Yga);R=R&&ja;G=G&&!ja;ja=!1;l&&(tn.a.Uu in l?l=l[tn.a.Uu]:(ya.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),l=0),ja=!Array.contains(ck.RCk,l));if(ja){if(a===ea.a.HFa)return this.oha(1),this.nfa.instance.zAb=-1,32;if(y&&!Array.contains(ck.Did,a)&&!G&&
!R){this.oha(2);if(null==this.nfa.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.nfa.instance.zAb=a;return 32}}this.oha(0);let za,Va;var hb=this.nq.slideWidth,Cb=this.nq.slideHeight;ja=new cd.a((hb-c.width*Oe.a.yD)/2,(Cb-c.height*Oe.a.yD)/2);l=ja.x+ve.a.gf(this.HO*Qq.a.nT,0);Va=ja.y+ve.a.gf(this.HO*Qq.a.nT,1);y?(ja=c.width*Oe.a.yD,za=c.height*Oe.a.yD):(ja=ve.a.gf(ck.A1b,0),za=ve.a.gf(ck.z1b,1),l=hb/2-ve.a.gf(ck.A1b/2-this.HO*Qq.a.nT,0),Va=Cb/2-ve.a.gf(ck.z1b/2-this.HO*Qq.a.nT,
1));this.HO++;this.HO>this.kIa&&(this.HO=this.QFb);hb=b.Cs();Cb=Object(sa.a)(424,this.ua.Ba.rg(this.Eb.Na));Kc.a.Kb&&(R||G)&&Kc.a.Kb.Wa(Ii.a.e8d,R?"HasDefaultLine":"HasDefaultShape");!y||a===ea.a.HFa||Array.contains(ck.Did,a)||G||R?f=this.wk.BDa(!1,f.cid,f.sid,0,c.shapeType,l,Va,ja,za,hb+1):(f=dA.a.yPc(f,c,Cb.$T,null,new yN.a,l,Va,ja,za,hb,this.Ga,this.wk,this.Eb,this.ua,this.oi),Kc.a.Kb&&(Kc.a.Kb.actionName=ck.fZc));qd.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===ea.a.HFa&&(this.Ezf(),this.Ffb=
f);f.isEditable=!Array.contains(ck.Bid,a);this.sr.HT([f],b,a);this.Rq.oA=f;this.Xwc();return 32}Ezf(){this.xCe||(this.skc.hja(this.Awh.bind(this)),this.Rf.TQa(this.U6g.bind(this)),this.xCe=!0)}Q$k(){this.xCe&&(this.skc.wMb(this.Awh.bind(this)),this.Rf.yMb(this.U6g.bind(this)),this.xCe=!1)}Awh(a,b){a=b.node;null!=a&&a==this.Ffb&&(this.Ffb=a,this.ONg=b.revisionId.toString())}U6g(a,b){b.GD&&b.GD.Id&&this.ONg==b.GD.Id&&(null==this.Ffb||this.pXa.I4(this.Ffb)||setTimeout(()=>{this.ia.Ja(ea.a.mRa,2,new Zl.a(this.Ffb,
!0,null));this.Q$k();this.ONg=this.Ffb=null},0))}HFj(a,b,c,f,l){if(1===c)return 2;this.oha(0);b=this.ua.Ba;if(!b)return 16;f=b.Cb;if(nc.a.Fw(f)||this.fc.fd(b))return 16;c=this.N$a(a);if(!c)return 16;if(!this.kj.hD(b,1))return this.kj.KD(b),16;this.HO++;this.HO>this.kIa&&(this.HO=this.QFb);if(!qd.a("IsAnyOffsetZeroForTextbox")){if(!(l&&l.left&&l.right&&l.bottom&&l.top))return ya.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return ya.a.J(512336011,829,10,"Invalid offsets"),16;const y=
this.ua.Ba.lx.ps;let G=ve.a.gf(this.oi.tK(l.right-l.left,y),0),R=ve.a.gf(this.oi.tK(l.bottom-l.top,y),1);R||G||(this.n$c?(G=c.width*Oe.a.yD,R=c.height*Oe.a.yD):(G=ve.a.gf(ck.Xwi,0),R=ve.a.gf(ck.Wwi,1)));G=G?G:ve.a.gf(ck.Bxi,0);R=R?R:ve.a.gf(ck.Axi,1);const ja=ve.a.gf(this.oi.tK(l.left,y),0);l=ve.a.gf(this.oi.tK(l.top,y),1);l=this.wk.BDa(!1,f.cid,f.sid,0,c.shapeType,ja,l,G,R,b.Cs()+1);if(!l)return ya.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;qd.a("FixNarratorTextBoxBug")&&
(l.setValue(va.a.mL,c.Yga),l.setValue(va.a.Gw,!0));qd.a("MoveCursorToTextboxAfterInsert")&&this.Ezf();l.isEditable=!Array.contains(ck.Bid,a);this.Ffb=l;this.sr.HT([l],b,a);this.Rq.oA=l;this.Xwc();ya.a.J(512349789,829,50,"Successfully inserted the textbox at specified location");return 32}GFj(a,b,c,f,l){if(1===c)return ya.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.oha(0);b=this.ua.Ba;if(!b)return ya.a.J(512349510,829,10,"slideNode is null"),16;c=b.Cb;if(nc.a.Fw(c))return ya.a.J(512349509,
829,10,"slideNode is fake"),16;if(this.fc.fd(b))return ya.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;f=this.N$a(l.insertShapeActionId);if(!f)return ya.a.J(512349507,829,10,"autoShapeProps is null"),16;if(!this.kj.hD(b,1))return this.kj.KD(b),16;var y=l.offsets;if(!y)return ya.a.J(512349788,829,10,"Invalid offsets"),16;const G=this.ua.Ba.rg(this.Eb.Na);let R=this.Eb.Nd.gf(y.right-y.left,0),ja=this.Eb.Nd.gf(y.bottom-y.top,1);ja||R||(R=f.width*Oe.a.yD,ja=f.height*Oe.a.yD);const za=this.Eb.Nd.gf(y.left,
0);y=this.Eb.Nd.gf(y.top,1);f.height=ja/Oe.a.yD;f.width=R/Oe.a.yD;const Va=b.Cs();c=dA.a.yPc(c,f,G.$T,null,new yN.a,za,y,R,ja,Va,this.Ga,this.wk,this.Eb,this.ua,this.oi);Kc.a.Kb&&(Kc.a.Kb.actionName=ck.fZc);if(!c)return ya.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(ck.Bid,a);l.insertLocalShape?b.oB(c,null):(this.sr.HT([c],b,a),this.nfa.instance.zAb=-1,this.Rq.oA=c,this.Xwc());l.node=c;ya.a.J(512349786,829,50,"Successfully inserted the shape at specified location");
return 32}Bgg(a,b,c){if(1===c)return 32;this.oha(0);return 32}N$a(a){switch(a){case ea.a.HFa:return new se.a(4,16,.5,3);case ea.a.D0c:return new se.a(4,16,.5,3);case ea.a.Uke:return new se.a(34,9,1,1);case ea.a.Pme:return new se.a(2,17,1,1.16);case ea.a.kme:return new se.a(3,55,1,1);case ea.a.Vle:return new se.a(6,56,1,1.33);case ea.a.Ome:return new se.a(7,57,1.33,1);case ea.a.Ike:return new se.a(5,58,1,1);case ea.a.qme:return new se.a(9,59,1,1.05);case ea.a.cle:return new se.a(10,60,1,1.16);case ea.a.ble:return new se.a(11,
61,1,1);case ea.a.Rle:return new se.a(12,62,1,1);case ea.a.Eke:return new se.a(13,63,1,1);case ea.a.Mke:return new se.a(14,64,1,1);case ea.a.Xle:return new se.a(39,65,1,1);case ea.a.pke:return new se.a(87,66,1,1);case ea.a.Mme:return new se.a(35,67,1,1);case ea.a.Zke:return new se.a(83,68,1,1);case ea.a.$ke:return new se.a(84,69,1,1);case ea.a.gle:return new se.a(85,70,1,1);case ea.a.Hke:return new se.a(86,71,1,1);case ea.a.vke:return new se.a(130,72,1,1);case ea.a.Yle:return new se.a(33,73,1,1);
case ea.a.mke:return new se.a(73,7,1.33,1);case ea.a.wke:return new se.a(72,8,1.33,1.33);case ea.a.kke:return new se.a(82,74,1.14,1.14);case ea.a.Nke:return new se.a(41,75,1,1);case ea.a.Ple:return new se.a(42,76,1,1);case ea.a.lke:return new se.a(40,77,1,1);case ea.a.Yke:return new se.a(81,78,1,1);case ea.a.sme:return new se.a(78,79,1,1);case ea.a.ale:return new se.a(75,18,1,1);case ea.a.qle:return new se.a(74,80,1,1);case ea.a.Lme:return new se.a(76,81,1,1);case ea.a.Nle:return new se.a(77,82,1,
.5);case ea.a.rke:return new se.a(120,83,1,1);case ea.a.hke:return new se.a(88,84,1,1);case ea.a.Pke:return new se.a(93,85,1,1);case ea.a.Oke:return new se.a(94,86,1,1.17);case ea.a.kle:return new se.a(89,87,1,.08);case ea.a.jme:return new se.a(90,88,1,.08);case ea.a.jle:return new se.a(91,89,1,.17);case ea.a.ime:return new se.a(92,90,1,.17);case ea.a.Lle:return new se.a(175,19,1,1);case ea.a.Ile:return new se.a(176,20,1,1);case ea.a.Jle:return new se.a(177,21,1,1);case ea.a.Gle:return new se.a(178,
22,1,1);case ea.a.Hle:return new se.a(179,23,1,1);case ea.a.Kle:return new se.a(180,24,1,1);case ea.a.A0c:return new se.a(95,12,1,1);case ea.a.B0c:return new se.a(95,13,1,1);case ea.a.C0c:return new se.a(95,14,1,1);case ea.a.y0c:return new se.a(97,26,1,1);case ea.a.x0c:return new se.a(97,155,1,1);case ea.a.z0c:return new se.a(97,156,1,1);case ea.a.v0c:return new se.a(101,25,1,1);case ea.a.u0c:return new se.a(101,153,1,1);case ea.a.w0c:return new se.a(101,154,1,1);case ea.a.Rke:return new se.a(46,
0,1.07,.53);case ea.a.hle:return new se.a(44,1,.53,1.07);case ea.a.lle:return new se.a(50,2,.53,1.33);case ea.a.gme:return new se.a(43,3,.53,1.07);case ea.a.Rme:return new se.a(45,4,1.07,.53);case ea.a.Tme:return new se.a(51,5,1.33,.53);case ea.a.nle:return new se.a(53,27,.93,1.33);case ea.a.ike:return new se.a(62,28,.95,.89);case ea.a.Qme:return new se.a(63,29,.96,.97);case ea.a.ple:return new se.a(52,30,.93,.93);case ea.a.jke:return new se.a(49,31,.8,.93);case ea.a.Ake:return new se.a(67,32,1.33,
.8);case ea.a.zke:return new se.a(68,33,1.33,.8);case ea.a.Bke:return new se.a(69,34,.8,1.33);case ea.a.xke:return new se.a(70,46,.8,1.33);case ea.a.Jme:return new se.a(47,35,.53,1.07);case ea.a.Qle:return new se.a(48,36,.53,1.07);case ea.a.Wle:return new se.a(36,37,.53,1.07);case ea.a.oke:return new se.a(37,38,.53,.53);case ea.a.hme:return new se.a(56,39,1,1);case ea.a.Ske:return new se.a(58,40,1,1);case ea.a.ile:return new se.a(55,41,1,1);case ea.a.Sme:return new se.a(57,42,1,1);case ea.a.mle:return new se.a(59,
43,.63,1.33);case ea.a.dme:return new se.a(61,44,1.33,1.33);case ea.a.qke:return new se.a(64,45,1.07,1.07);case ea.a.cme:return new se.a(54,47,1.33,1.33);case ea.a.eme:return new se.a(4,10,1,1);case ea.a.ome:return new se.a(25,11,1,1);case ea.a.lme:return new se.a(28,48,1,1);case ea.a.mme:return new se.a(27,49,1,1);case ea.a.nme:return new se.a(26,50,1,1);case ea.a.ume:return new se.a(29,51,1,1);case ea.a.tme:return new se.a(32,52,1,1);case ea.a.vme:return new se.a(31,53,1,1);case ea.a.wme:return new se.a(30,
54,1,1);case ea.a.fme:return new se.a(116,91,.67,1);case ea.a.pme:return new se.a(117,6,.67,1);case ea.a.Ule:return new se.a(118,92,.67,1);case ea.a.ske:return new se.a(119,93,.67,1);case ea.a.rle:return new se.a(104,94,.67,1);case ea.a.vle:return new se.a(105,95,.67,1);case ea.a.zle:return new se.a(106,96,.67,1);case ea.a.sle:return new se.a(107,97,.67,1);case ea.a.wle:return new se.a(108,98,.67,1);case ea.a.Ale:return new se.a(109,99,.67,1);case ea.a.tle:return new se.a(110,100,.67,1);case ea.a.xle:return new se.a(111,
101,.67,1);case ea.a.Ble:return new se.a(112,102,.67,1);case ea.a.ule:return new se.a(113,103,.67,1);case ea.a.yle:return new se.a(114,104,.67,1);case ea.a.Cle:return new se.a(115,105,.67,1);case ea.a.Vke:return new se.a(79,106,1,1);case ea.a.Wke:return new se.a(80,107,1,1);case ea.a.Dme:return new se.a(15,108,1,1);case ea.a.Eme:return new se.a(16,15,1,1);case ea.a.Fme:return new se.a(17,109,1,1);case ea.a.Gme:return new se.a(18,110,1,1);case ea.a.Hme:return new se.a(19,111,1,1);case ea.a.yme:return new se.a(20,
112,1,1);case ea.a.zme:return new se.a(21,113,1,1);case ea.a.Ame:return new se.a(22,114,1,1);case ea.a.Bme:return new se.a(23,115,1,1);case ea.a.Cme:return new se.a(24,116,1,1);case ea.a.Ume:return new se.a(122,117,.67,1.33);case ea.a.Tke:return new se.a(121,118,.67,1.33);case ea.a.Cke:return new se.a(124,119,.83,1.33);case ea.a.yke:return new se.a(123,120,.83,1.33);case ea.a.Vme:return new se.a(126,121,1.25,1.13);case ea.a.ele:return new se.a(127,122,1.13,1.25);case ea.a.Wme:return new se.a(128,
123,1,1);case ea.a.Qke:return new se.a(129,124,1,1);case ea.a.ame:return new se.a(131,125,.67,1);case ea.a.gke:return new se.a(158,126,.67,1);case ea.a.Fke:return new se.a(132,127,.67,1);case ea.a.Dke:return new se.a(133,128,.67,1);case ea.a.Zle:return new se.a(134,129,.67,1);case ea.a.fle:return new se.a(135,130,.67,.67);case ea.a.Lke:return new se.a(136,131,.67,1);case ea.a.Ole:return new se.a(137,132,.83,1.16);case ea.a.Nme:return new se.a(138,133,.33,1);case ea.a.$le:return new se.a(139,134,.67,
1.16);case ea.a.Ele:return new se.a(140,135,.5,1);case ea.a.Fle:return new se.a(141,136,.67,1);case ea.a.uke:return new se.a(142,137,.5,.5);case ea.a.Sle:return new se.a(159,138,.67,.67);case ea.a.nke:return new se.a(143,139,.88,1);case ea.a.bme:return new se.a(144,140,.88,1);case ea.a.Kme:return new se.a(145,141,.67,.67);case ea.a.Tle:return new se.a(146,142,.67,.67);case ea.a.tke:return new se.a(147,143,1,.5);case ea.a.xme:return new se.a(148,144,1,.5);case ea.a.Xke:return new se.a(149,145,.75,
.75);case ea.a.Mle:return new se.a(150,146,.75,.75);case ea.a.Ime:return new se.a(152,147,.67,1);case ea.a.Gke:return new se.a(157,148,.67,.67);case ea.a.rme:return new se.a(153,149,.67,.67);case ea.a.Dle:return new se.a(154,150,.67,1);case ea.a.Jke:return new se.a(155,151,.75,1);case ea.a.Kke:return new se.a(156,152,.67,1);default:return null}}wEj(a,b,c){b=this.pa.Qf();if(!(b&&0<b.length&&Qq.a.rll(b)))return 16;if(1===c)return 32;c=this.ua.Ba;if(!c)return 16;if(!this.kj.hD(c,b.length))return this.kj.KD(c),
16;if(this.fc.fd(c))return 16;this.iHa.ohh(c,c,b,null,a);return 32}Xwc(){try{const a=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){ya.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}ck.A1b=110;ck.z1b=75;ck.Xwi=19;ck.Wwi=38;ck.Bxi=4;ck.Axi=4;ck.fZc="InsertShape";ck.WJl=[ea.a.Lle,ea.a.Ile,ea.a.Jle,ea.a.Gle,ea.a.Hle,ea.a.Kle,ea.a.HFa,ea.a.Uke,ea.a.Pme,ea.a.kme,ea.a.Vle,ea.a.Ome,
ea.a.Ike,ea.a.qme,ea.a.cle,ea.a.ble,ea.a.Rle,ea.a.Eke,ea.a.Mke,ea.a.Xle,ea.a.pke,ea.a.Mme,ea.a.Zke,ea.a.$ke,ea.a.gle,ea.a.Hke,ea.a.vke,ea.a.Yle,ea.a.mke,ea.a.wke,ea.a.kke,ea.a.Nke,ea.a.Ple,ea.a.lke,ea.a.Yke,ea.a.sme,ea.a.ale,ea.a.qle,ea.a.Lme,ea.a.Nle,ea.a.rke,ea.a.hke,ea.a.Pke,ea.a.Oke,ea.a.kle,ea.a.jme,ea.a.jle,ea.a.ime,ea.a.eme,ea.a.ome,ea.a.lme,ea.a.mme,ea.a.nme,ea.a.ume,ea.a.tme,ea.a.vme,ea.a.wme,ea.a.fme,ea.a.pme,ea.a.Ule,ea.a.ske,ea.a.rle,ea.a.vle,ea.a.zle,ea.a.sle,ea.a.wle,ea.a.Ale,ea.a.ule,
ea.a.yle,ea.a.Cle,ea.a.tle,ea.a.xle,ea.a.Ble,ea.a.Vke,ea.a.Wke,ea.a.Dme,ea.a.Eme,ea.a.Fme,ea.a.Gme,ea.a.Hme,ea.a.yme,ea.a.zme,ea.a.Ame,ea.a.Bme,ea.a.Cme,ea.a.Ume,ea.a.Tke,ea.a.Cke,ea.a.yke,ea.a.Vme,ea.a.ele,ea.a.Wme,ea.a.Qke,ea.a.ame,ea.a.gke,ea.a.Fke,ea.a.Dke,ea.a.Zle,ea.a.fle,ea.a.Lke,ea.a.Ole,ea.a.Nme,ea.a.$le,ea.a.Ele,ea.a.Fle,ea.a.uke,ea.a.Sle,ea.a.nke,ea.a.bme,ea.a.Kme,ea.a.Tle,ea.a.tke,ea.a.xme,ea.a.Xke,ea.a.Mle,ea.a.Ime,ea.a.Gke,ea.a.rme,ea.a.Dle,ea.a.Jke,ea.a.Kke,ea.a.gme,ea.a.Rke,ea.a.hle,
ea.a.Rme,ea.a.Tme,ea.a.lle,ea.a.nle,ea.a.ike,ea.a.Qme,ea.a.ple,ea.a.jke,ea.a.Ake,ea.a.zke,ea.a.xke,ea.a.Bke,ea.a.Jme,ea.a.Qle,ea.a.Wle,ea.a.oke,ea.a.hme,ea.a.Ske,ea.a.ile,ea.a.Sme,ea.a.mle,ea.a.dme,ea.a.qke,ea.a.cme];ck.Bid=[ea.a.A0c,ea.a.B0c,ea.a.C0c,ea.a.v0c,ea.a.u0c,ea.a.w0c,ea.a.y0c,ea.a.x0c,ea.a.z0c];ck.Did=[ea.a.B0c,ea.a.C0c,ea.a.v0c,ea.a.u0c,ea.a.w0c,ea.a.x0c,ea.a.z0c];ck.RCk=[1,5];Object(m.a)(ck,"InsertShapeActor",null,[268,108]);class zN{constructor(a,b,c,f){this.xDe=null;this.JIk=(l,y)=>
{this.xDe&&((l=Object(sa.a)(765,y.node))&&l.Fkb?this.xDe(l.Fkb):ya.a.J(508901219,803,10,"onJOfcCommandPayloadResponseReceived: Cannot resolve promise"))};this.MEj=(l,y,G,R,ja)=>{y=this.ua.presentation;if(1===G)return y?32:8;if(!y)return ya.a.J(508908367,803,10,"handleExecuteInternalBatchCommands with null IPageManifestNode."),16;if(!ja)return ya.a.J(508908366,803,10,"handleExecuteInternalBatchCommands with null action data."),16;this.xDe=ja.promiseToResolve;G=this.Fb.yd(15,void 0,void 0,void 0,!0);
try{G.jc(y),G.gd=l,y.KTd(ja.requestBody)}catch(za){return ya.a.J(508901218,803,10,"handleExecuteInternalBatchCommands: Exception: {0}.",za.toString()),16}finally{G&&G.dispose()}return 32};this.ia=a;this.ua=b;this.Fb=c;this.Cok=f;this.Cok.gk(this.JIk)}vb(){this.ia.ra(ea.a.V9a,rb.a.application,this.MEj,4)}me(){}}Object(m.a)(zN,"JOfcCommandPayloadActor",null,[268]);class AN{constructor(){this.type="LivePollTaskPaneProps";this.formsUrl=this.onCloseButtonClicked=null}}Object(m.a)(AN,"LivePollTaskPaneProps",
null,[]);class BN{constructor(a,b,c,f,l,y,G,R){this.HM=null;this.RHa=this.Ab=!1;a("powerpoint-live-strings").then(()=>{this.RHa=!0;ya.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(ja=>{ya.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+ja.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");
if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!y)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!G)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!R)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.Glk=b;this.Hlk=c;this.ia=f;this.ua=y;this.qf=l;this.pa=G;this.kj=R;this.pQg=Object(H.a)(this,this.lJl,"taskPaneMessageHandler")}vb(){this.ia.ya(ea.a.nvd,qc.a.application,
Object(H.a)(this,this.nvd,"showHideLivePollPane"))}me(){}nvd(a,b,c){return b.contextId===qc.a.application&&this.RHa?1===c?32:Vg.a("LivePollPaneToggle",a,()=>{(this.Ab=!this.Ab)?(this.kl(),ya.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.eH(),ya.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}kl(){this.kA();const a=Object.assign(new yu.a,{title:ResourceStrings.L_LivePollTaskPane,hideHeader:!1,width:320,location:2,contentProps:this.HM,
onOpen:()=>{},onClose:()=>{this.Ab=!1},isModernPane:!0});Mj.UISurfaces.Iq().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.pQg,!1);return null}).catch(b=>{ya.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}eH(){Mj.UISurfaces.Iq().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.pQg);return null}).catch(a=>{ya.a.J(512500511,833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}kA(){this.HM=
Object.assign(new AN,{onCloseButtonClicked:Object(H.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.alj()})}alj(){return String.format("{0}{1}{2}",this.Glk,"&auth_upn=",w.AFrameworkApplication.fa.Ha("UserPrincipalName"))}onCloseButtonClicked(){this.eH()}lJl(a){if("data"in a){var b;({Su:b}=Nd.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&(a=String.format("{0}{1}{2}{3}{4}",this.Hlk,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",
w.AFrameworkApplication.fa.Ha("UserPrincipalName")),this.FFj(a)))}}FFj(a){const b=this.ua.Ba;if(b&&!this.qf.fd(b))if(this.kj.hD(b,1)){var c=b.Cb;b.UPi(c.sid,c.cid,a,b.Cs());b.R_(this.pa.Ud())}else this.kj.KD(b)}}Object(m.a)(BN,"LivePollPaneActor",null,[268]);var eS=d(986);class hy{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.GA=f;this.swa=l;this.ia=a;this.fc=b;this.Fa=c;this.MO=R;this.Ub=y;this.ua=G;this.Kc=ja;this.Rb=za;this.axa=Va;this.Eb=hb}vb(){this.ia.ya(ea.a.gMa,qc.a.application,Object(H.a)(this,
this.gMa,"showHideNotes"));this.ia.ra(ea.a.bod,qc.a.application,Object(H.a)(this,this.D_k,"queryNotesPaneState"),96);this.ia.ra(ea.a.gnd,qc.a.application,Object(H.a)(this,this.ggh,"pageScrollNotesPane"),64);this.ia.ra(ea.a.fnd,qc.a.application,Object(H.a)(this,this.ggh,"pageScrollNotesPane"),64);this.ia.ya(ea.a.a1e,qc.a.application,Object(H.a)(this,this.aDk,"notesResize"))}me(){const a=this.Fa.Ic(Si.a.D3);a.bindAction(x.KeyInputManager.Va(B.a.rF,0),ea.a.gnd);a.bindAction(x.KeyInputManager.Va(B.a.qF,
0),ea.a.fnd)}gMa(a,b,c,f,l){if(this.Eb&&0!==this.Eb.al)return 2;a=this.Ub.Gf;if(!this.ua.Ba||!a||this.fc.qO(a))return 16;if(1===c)return 32;l&&Object(Sa.a)(eS.a,l)?l.wuc?this.GA.$3e():this.GA.vMj():(this.GA.YMk(),this.GA.E0b()&&this.swa.Go?this.Fa.wj(Si.a.D3,!0):this.Fa.wj(Si.a.D3,!1));this.MO.dbb();return 32}D_k(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return 8;l.If(this.GA.E0b());return 32}ggh(a,b,c){return 1===c?32:this.GA?(a===ea.a.fnd?this.GA.xa.scrollTop+=hy.RIf:a===ea.a.gnd&&(this.GA.xa.scrollTop-=
hy.RIf),32):8}aDk(a,b,c,f,l){ya.a.J(37524685,822,50,"Notes Resize Begin");if(!this.GA||!l||"number"!==typeof l)return ya.a.J(37524687,822,50,"Notes Resize Fail"),8;this.GA.cga=l;this.Kc.Hc.IAh(1);this.Rb.Du();this.axa.PXl();ya.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.GA.ZCk?"On":"Off",this.GA.cga);return 32}}hy.RIf=80;Object(m.a)(hy,"NotesActor",null,[268]);class CN{constructor(a,b,c,f){this.ia=a;this.Mic=b;this.la=c;this.cOg=0;this.eP=f}me(){}vb(){this.ia.ra(ea.a.Wlh,
ye.a.frame,Object(H.a)(this,this.E_k,"queryOfflineStatusHandler"),2144)}E_k(a,b,c,f,l){if(1===c)return 32;switch(this.Mic.status){case 0:1===this.cOg&&(l[Tp.a.Value]=CommonUIStrings.L_Connected,l[wm.a.labelText]=CommonUIStrings.L_Connected,l[Tp.a.Visible]=!0,this.hideIcon(),Uj.a.instance.Hb(new pd.a(2,1,this.la.offlineLabelTimeoutInMs,()=>{this.UAl();this.eP.iS("GetOfflineStatus",!1);this.eP.SA()},90,"108")));break;case 2:l[Tp.a.Value]=CommonUIStrings.L_Disconnected;l[wm.a.labelText]=CommonUIStrings.L_Disconnected;
l[Tp.a.Visible]=!0;break;case 1:l[Tp.a.Value]=CommonUIStrings.L_Reconnecting,l[wm.a.labelText]=CommonUIStrings.L_Reconnecting,l[Tp.a.Visible]=!0}this.cOg=this.Mic.status;return 32}hideIcon(){this.rzh(Ui.a.hidden)}UAl(){this.rzh(Ui.a.visible)}rzh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(m.a)(CN,"OfflineStatusLabelActor",null,[268]);class DN{constructor(a,b,c,f,l,y,G,R){this.lMg=!1;this.$we=null;this.ia=a;this.qf=b;this.MO=c;this.Fa=
c.Wo;this.Fb=f;this.pa=l;this.Ga=y;this.qq=G;this.U0=R}vb(){this.ia.ra(ea.a.bringForward,qc.a.application,Object(H.a)(this,this.pZc,"handleOrganizeAction"),4);this.ia.ra(ea.a.bringToFront,qc.a.application,Object(H.a)(this,this.pZc,"handleOrganizeAction"),4);this.ia.ra(ea.a.sendBackward,qc.a.application,Object(H.a)(this,this.pZc,"handleOrganizeAction"),4);this.ia.ra(ea.a.sendToBack,qc.a.application,Object(H.a)(this,this.pZc,"handleOrganizeAction"),4);this.ia.ra(ea.a.QGf,qc.a.application,Object(H.a)(this,
this.Zgg,"handleFrontBackFlyout"),4);this.ia.ra(ea.a.byh,qc.a.application,Object(H.a)(this,this.Zgg,"handleFrontBackFlyout"),4);w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&qd.a("DelayRegisterArrangeShapesAction")?this.$we=()=>{this.ia.ra(ea.a.Htb,qc.a.application,Object(H.a)(this,this.yhg,"handleOrganizeShapeAnchor"),4)}:this.ia.ra(ea.a.Htb,qc.a.application,Object(H.a)(this,this.yhg,"handleOrganizeShapeAnchor"),4)}me(){const a=this.MO.Wo.Ic(xa.a.qg);
a.bindAction(x.KeyInputManager.Va(B.a.$xc,x.KeyInputManager.Te),ea.a.bringForward);a.bindAction(x.KeyInputManager.Va(B.a.$xc,x.KeyInputManager.Te|4),ea.a.bringToFront);a.bindAction(x.KeyInputManager.Va(B.a.Yxc,x.KeyInputManager.Te),ea.a.sendBackward);a.bindAction(x.KeyInputManager.Va(B.a.Yxc,x.KeyInputManager.Te|4),ea.a.sendToBack)}Zgg(a,b,c){return 1===c?this.pa.F4()?32:8:32}yhg(){return this.lMg?32:this.pa.F4()?32:16}pZc(a,b,c){b=this.qq.presentation;if(!b)throw Error.argumentNull("Presentation is null");
let f=this.pa.Qf();var l=this.Ga.cab(f);l&&(this.pa.Cqd(l),f=this.pa.Qf());if(!this.pa.F4()||this.qf.dD(f))return 16;if(1===c)return 32;switch(a){case ea.a.bringForward:c=1;break;case ea.a.bringToFront:c=0;break;case ea.a.sendBackward:c=3;break;case ea.a.sendToBack:c=2;break;default:return 8}Kc.a.Kb&&(Kc.a.Kb.$p=!1,Kc.a.Kb.Qj=!0);1===f.length?ya.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&ya.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",
f.length);l=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{l.jc(f[0]);l.gd=a;const y=Object(sa.a)(116,b.XC(f[0].slideId));this.BOk(y,f,c)}finally{l&&l.dispose()}return 32}hBk(a,b){const c=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{const f=this.qq.Ba,l=f.WC(a),y=f.WC(b);c.jc(l);this.iBk(f,l.id,y.id)}finally{c&&c.dispose()}}Msl(){this.lMg=!0;qd.a("DelayRegisterArrangeShapesAction")&&this.$we&&this.$we()}BOk(a,b,c){a&&b&&0<b.length&&ya.a.J(51164099,815,50,"OrganizeShapes has invalid params");
let f=Ub.a.clone(a.eb(Ya.a.yB));const l=[];let y=null;Ub.a.fqa(b,G=>!G.Ug).length||(y=this.Ga.Fs(b[0]))&&(f=Ub.a.clone(y.eb(Ya.a.yB)));for(const G of b)l.push(G.id);a.k6b(c,f,l)&&(y&&y.anchor?y.anchor.Gmb(f,1,!1):a.anchor?a.anchor.Gmb(f,1,!1):ya.a.J(51164101,815,50,"slideNode/groupNode should have valid anchor"))}AOk(a,b,c){var f=this.pa.Ud(),l=this.Hjj(f,b);a.reverse();b=new Oa.a;f=[];let y=-1,G=!1;for(let ja=0;ja<a.length;ja++){let za=!1;for(var R of l)if(R.equals(a[ja])){b.add(R);za=G=!0;break}za||
f.push(a[ja]);c.equals(a[ja])&&(y=ja)}if(G)if(-1===y)ya.a.J(593514880,815,10,"Invalid param endShapeId"),G=!1;else{c=0;R=a.length;for(l=0;c<y;)a[c++]=f[l++];for(let ja of b)a[c++]=ja;for(;c<R;)a[c++]=f[l++]}a.reverse();return G}Hjj(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}iBk(a,b,c){if(a){var f=Ub.a.clone(a.eb(Ya.a.yB));var l=this.U0.Zda(b);var y=this.U0.Zda(c);l=this.Ga.Fs(l);y=this.Ga.Fs(y);l?y===l&&(f=Ub.a.clone(l.eb(Ya.a.yB))):y&&(c=
y.id);this.AOk(f,b,c)&&(ya.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.Gmb(f,1,!1):ya.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.Gmb(f,1,!1):ya.a.J(51385987,815,10,"slideNode should have valid anchor"))}else ya.a.J(51385955,815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(m.a)(DN,"OrganizeShapesActor",null,[268]);class EN extends bt.a{constructor(a,b,c,f,l,y,G,R,ja){super();this.hfd=0;this.Ve=f;this.Dc=R;this.xBg=
ja;this.init(a);this.$l("PPTClipboardActionOperation");(a=Object(sa.a)(10,G))||(a=new J.DictionaryPropertySet);a.setValue(sm.a.Wb,ja);this.yFa(b,c,l,y,a)}N_c(){this.plb(this.Ve)}O8a(a){this.np=a;this.hfd=1}run(){if(0===this.hfd){if(1===this.Ioa())return;this.hfd=1}1===this.hfd&&this.eZ();this.Dc.rXj(this.xBg)&&this.Dc.Lg(!0,this.xBg)}}Object(m.a)(EN,"PPTClipboardActionOperation",bt.a,[764,485,486]);var FN=d(378),LE=d(546);class Du{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,
Ie,Pe,ig,ff,bh,ch,of,sg){this.ia=a;this.pa=b;this.Fa=c;this.EA=f;this.Kfb=l;this.Fb=y;this.jHg=G;this.Tb=R;this.Afa=ja;this.eGb=za;this.Ga=Va;this.gHa=hb;this.yM=Cb;this.sad=lc;this.qYa=ic;this.vjk=yc;this.Ohc=ec;this.zc=jc;this.Wp=xd;this.Vs=Xd;this.jR=Qd;this.Rb=Ie;this.Ub=Pe;this.LO=ig;this.cYa=ff;this.LU=bh;if(qd.a("RulerIndentBugFix")){if(!ch)throw Error.argumentNull("paragraphIndentationReader");if(!of)throw Error.argumentNull("paragraphEditor");}this.Q$=ch;this.wwa=of;this.cZa=sg}vb(){this.ia.ra(ea.a.JPe,
qc.a.application,Object(H.a)(this,this.iHj,"handlePopulateFontColorDropdown"),101);this.ia.ra(ea.a.lgh,qc.a.application,Object(H.a)(this,this.kHj,"handlePopulateFontSizeDropdown"),100);this.ia.ra(ea.a.Nja,qc.a.application,Object(H.a)(this,this.TDj,"handleCommitShapeText"),4);this.ia.ra(ea.a.Ond,qc.a.application,Object(H.a)(this,this.Ulh,"queryListCommonLevel"),96);this.ia.ra(ea.a.cod,qc.a.application,Object(H.a)(this,this.Ulh,"queryListCommonLevel"),96);this.ia.ra(ea.a.wqc,qc.a.application,Object(H.a)(this,
this.nmh,"queryTextListMarkerGallery"),96);this.ia.ra(ea.a.xqc,qc.a.application,Object(H.a)(this,this.nmh,"queryTextListMarkerGallery"),96);this.ia.ra(ea.a.tpc,qc.a.application,Object(H.a)(this,this.Ehg,"handlePopulateListMarkerDropdown"),100);this.ia.ra(ea.a.upc,qc.a.application,Object(H.a)(this,this.Ehg,"handlePopulateListMarkerDropdown"),100);this.ia.ra(ea.a.hte,rb.a.view,Object(H.a)(this,this.ZFj,"handleLineSpacingMenuOpen"),68);this.ia.ra(ea.a.O6g,qc.a.application,Object(H.a)(this,this.iGj,"handleMoreFontColors"),
96);this.ia.ra(ea.a.wKb,qc.a.application,Object(H.a)(this,this.jGj,"handleMoreFontColorsResponse"),96);this.ia.ya(ea.a.k0a,rb.a.paragraph,Object(H.a)(this,this.k0a,"queryLineSpacing"));this.ia.ya(ea.a.k0a,rb.a.view,this.Afa);this.ia.ie(ea.a.k0a,96);this.ia.ya(ea.a.zoa,rb.a.paragraph,Object(H.a)(this,this.f2,"setLineSpacing"));this.ia.ya(ea.a.zoa,rb.a.view,this.Afa);this.ia.ie(ea.a.zoa,68);this.ia.ya(ea.a.xKa,qc.a.application,Object(H.a)(this,this.xKa,"populateLineSpacingFlyout"));this.ia.ya(ea.a.kgh,
qc.a.application,Object(H.a)(this,this.HGj,"handlePandoraEscapeKeyPressed"));this.ia.ya(ea.a.Flb,rb.a.paragraph,Object(H.a)(this,this.sEf,"applySpacingToParagraph"));this.ia.ya(ea.a.Flb,rb.a.view,this.Afa);this.ia.ie(ea.a.Flb,4);this.ia.ya(ea.a.Elb,rb.a.paragraph,Object(H.a)(this,this.sEf,"applySpacingToParagraph"));this.ia.ya(ea.a.Elb,rb.a.view,this.Afa);this.ia.ie(ea.a.Elb,4);this.ia.ya(ea.a.qla,rb.a.paragraph,Object(H.a)(this,this.Atb,"applyIndentationToParagraph"));this.ia.ya(ea.a.qla,rb.a.view,
this.Afa);this.ia.ie(ea.a.qla,4);this.ia.ya(ea.a.tOb,rb.a.paragraph,Object(H.a)(this,this.Atb,"applyIndentationToParagraph"));this.ia.ya(ea.a.tOb,rb.a.view,this.Afa);this.ia.ie(ea.a.tOb,4);this.ia.ya(ea.a.vOb,rb.a.paragraph,Object(H.a)(this,this.Atb,"applyIndentationToParagraph"));this.ia.ya(ea.a.vOb,rb.a.view,this.Afa);this.ia.ie(ea.a.vOb,4);this.ia.ya(ea.a.xOb,rb.a.paragraph,Object(H.a)(this,this.Atb,"applyIndentationToParagraph"));this.ia.ya(ea.a.xOb,rb.a.view,this.Afa);this.ia.ie(ea.a.xOb,4);
this.cZa&&(this.ia.ya(ea.a.uOb,rb.a.paragraph,Object(H.a)(this,this.Atb,"applyIndentationToParagraph")),this.ia.ya(ea.a.uOb,rb.a.view,this.Afa),this.ia.ie(ea.a.uOb,4),this.ia.ya(ea.a.wOb,rb.a.paragraph,Object(H.a)(this,this.Atb,"applyIndentationToParagraph")),this.ia.ya(ea.a.wOb,rb.a.view,this.Afa),this.ia.ie(ea.a.wOb,4));this.ia.ra(ea.a.Yih,qc.a.application,Object(H.a)(this,this.rHj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.ra(ea.a.hnd,qc.a.application,Object(H.a)(this,this.sHj,"handlePowerPointTextAnchoringAnchor"),
4);this.ia.ya(ea.a.M1,rb.a.view,this.eGb);this.ia.ya(ea.a.L1,rb.a.view,this.eGb);this.ia.ya(ea.a.K1,rb.a.view,this.eGb);this.ia.ya(ea.a.M1,rb.a.outline,Object(H.a)(this,this.Mge,"handlePowerPointTextAnchoring"));this.ia.ya(ea.a.L1,rb.a.outline,Object(H.a)(this,this.Mge,"handlePowerPointTextAnchoring"));this.ia.ya(ea.a.K1,rb.a.outline,Object(H.a)(this,this.Mge,"handlePowerPointTextAnchoring"));this.ia.ie(ea.a.M1,4);this.ia.ie(ea.a.L1,4);this.ia.ie(ea.a.K1,4);this.ia.ya(ea.a.PLb,rb.a.view,this.eGb);
this.ia.ya(ea.a.PLb,rb.a.outline,Object(H.a)(this,this.JUe,"queryTextAnchoring"));this.ia.ie(ea.a.PLb,96);this.ia.ya(ea.a.OLb,rb.a.view,this.eGb);this.ia.ya(ea.a.OLb,rb.a.outline,Object(H.a)(this,this.JUe,"queryTextAnchoring"));this.ia.ie(ea.a.OLb,96);this.ia.ya(ea.a.NLb,rb.a.view,this.eGb);this.ia.ya(ea.a.NLb,rb.a.outline,Object(H.a)(this,this.JUe,"queryTextAnchoring"));this.ia.ie(ea.a.NLb,96);this.Wp&&(this.ia.ra(C.a.qUc,rb.a.view,Object(H.a)(this,this.$Ej,"handleFormatPainterPick"),4),this.ia.ra(ea.a.W9d,
rb.a.view,Object(H.a)(this,this.VCj,"handleApplyFormatToText"),4),this.ia.ra(C.a.Eka,rb.a.view,Object(H.a)(this,this.ZEj,"handleFormatPainterCancel"),4),this.jR.aii(()=>{this.LO.yWa=this.jR.TL;this.Rb.updateCommandUI()}))}me(){var a=this.Fa.Ic(xa.a.DQ);const b=this.Fa.Ic(Si.a.D3),c=this.Fa.Ic(xa.a.nS),f=x.KeyInputManager.Va(B.a.AZ,0);a.bindAction(x.KeyInputManager.Va(B.a.xyc,0),ea.a.Nja);a.bindAction(f,ea.a.kgh);c.bindAction(f,ea.a.Nja);b.bindAction(x.KeyInputManager.Va(B.a.Eyc,2),F.a.we);a.bindAction(x.KeyInputManager.Va(B.a.Eyc,
2),F.a.we);this.qYa&&(a.bindAction(x.KeyInputManager.Va(B.a.wha,5),ea.a.QC),a.bindAction(x.KeyInputManager.Va(B.a.Jba,5),ea.a.Ry));this.Wp&&(a=this.Fa.Ic(Si.a.fE),a.hw(f),a.bindAction(f,C.a.Eka))}$Ej(a,b,c){a=this.pa.Ll();b=!1;let f=null,l=this.pa.Pa.nb;const y=!!this.pa.Pa&&this.pa.Pa.Sl;y&&(l=this.pa.Pa.ga(0));l&&(f=l.Ua);if(f){switch(f.contextId){case rb.a.textRange:case rb.a.paragraph:case rb.a.endOfParagraph:case rb.a.Mf:b=!0}b&&Jb.SelectionEditor.tk(f)&&Ee.b(f)&&(b=!1);f.contextId===rb.a.outline&&
a.xd&&(b=!0);a&&!a.IIh&&(b=!1)}if(1===c||!b)return b?32:8;6!==this.ia.Lp?(this.jR.TL?ya.a.J(40703699,820,50,"User deactivated the Format Painter button"):(ya.a.J(40703697,820,50,"User activated the Format Painter button"),this.$hh(l,y,a)),this.jR.TL=!this.jR.TL):(ya.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.$hh(l,y,a));return 32}$hh(a,b,c){this.jR.aih(a);var f=a.Ua;const l=Object(sa.a)(Kf.AParagraphNode,f.node);var y=Object(sa.a)(763,this.Rb.Ld);let G=null;if(l&&y&&(G=
y.Di)){y=this.Fb.ke(4);const ja=G.Fi;y.jc(G);var R=this.Tb.Lc(l);R.rc(8);const za=this.zc.Ks(R);let Va=f.Ra,hb=f.Lb-f.Ra;a=!a.ida&&a.jf.contextId!==rb.a.endOfParagraph;b?(Va=0,hb=zb.ParagraphReader.textLength(l)+1):({selectionStart:Va,Exh:hb}=this.uJf(f,l,R,Va,hb,null,!1),a&&f.contextId===rb.a.textRange&&hb++);b=this.LU.ZEa(ja);f=null;za&&(R.Jg(16),f=Object(sa.a)(130,R.currentNode));R.gC(8);R=Object(sa.a)(116,R.currentNode);this.LU.vaf(b,!0,l.sa(va.a.gGa,!1),R,c,f,null,Va,hb);(c=ja.Xpc(b))&&G.SCb(c);
y.dispose()}}uJf(a,b,c,f,l,y,G){switch(a.contextId){case rb.a.Mf:l=null;G&&(l=this.cYa.M8b(a))?(l=l.Ua,f=l.Ra,l=l.Lb-l.Ra):(f=0<f?f-1:0,l=1);break;case rb.a.paragraph:f=0;l=zb.ParagraphReader.textLength(b)+1;break;case rb.a.endOfParagraph:f=zb.ParagraphReader.textLength(b),l=1}for(c.gC(11);c.pua();)c.Db(2),(a=Object(sa.a)(Kf.AParagraphNode,c.currentNode))&&(f+=zb.ParagraphReader.textLength(a)+1),c.gC(11);if(G)for(c=1;c<y.length;c++)if((G=Object(sa.a)(bb.a,y.ga(c)))&&zb.ParagraphReader.fe(G.node))switch(G.contextId){case rb.a.textRange:l+=
G.Lb-G.Ra;break;case rb.a.Mf:l+=1;break;case rb.a.paragraph:l+=zb.ParagraphReader.textLength(G.node)+1;break;case rb.a.endOfParagraph:l+=1}return{selectionStart:f,Exh:l}}VCj(a){if(6===this.ia.Lp||this.jR.TL){ya.a.J(40703703,820,50,"User applied the Format Painter from command location: {0}",this.ia.Lp);const G=this.pa.Ll();if(G&&!Du.Z6j(G))return 2;var b=this.pa.Pa.nb;if(b&&b.Ua){var c=b.Ua;const R=Object(sa.a)(Kf.AParagraphNode,c.node);var f=Object(sa.a)(763,this.Rb.Ld),l=null;if(R&&f&&(l=f.Di)){f=
this.Fb.ke(15);f.jc(l);f.gd=a;const ja=this.pa.Pa.Sl;a=R.sa(va.a.gGa,!1);if(ja)for(var y of this.pa.Pa)this.jR.gEf(y);else this.jR.gEf(b);Kc.a.Kb&&(Kc.a.Kb.Qj=!1,Kc.a.Kb.actionName="FormatPainterApplyToText",Kc.a.Kb.HF=new Date);const za=this.Tb.Lc(R);za.rc(8);y=c.Ra;let Va=c.Lb-c.Ra;ja?y=Va=-1:{selectionStart:y,Exh:Va}=this.uJf(c,R,za,y,Va,b,!0);za.Jg(8);b=Object(sa.a)(116,za.currentNode);c=this.pa.Fv();l=this.LU.ZEa(l.Fi);this.LU.vaf(l,!1,a,b,G,null,c,y,Va);6!==this.ia.Lp&&(this.jR.TL=!1);f.dispose()}}}return 32}HGj(a,
b,c,f,l){this.Wp&&this.ia.Ja(C.a.Eka,c,l);qd.a("PandoraEscapeKeyPressed")&&this.ia.Ja(ea.a.Nja,c,l);return 32}ZEj(){this.LO.yWa&&(this.jR.TL=!1);return 32}rHj(){return this.AYf()}sHj(){return this.AYf()}Mge(a,b,c){let f=!1;b=this.jHg.mvj(b);var l=this.pa.zn();if(b&&b.pCb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case ea.a.M1:c=0;break;case ea.a.L1:c=1;break;case ea.a.K1:c=2;break;default:return 8}if(l)this.pa.vH()?this.Vs.lol(l,c):(b=this.Fb.ke(15),b.jc(l),b.gd=a,this.Vs.kol(this.pa.Pa,
c),b.dispose());else{l=this.Fb.ke(15);try{l.jc(b),l.gd=a,b.setValue(va.a.HP,c)}finally{l&&l.dispose()}}return 32}JUe(a,b,c,f,l){c=!1;b=this.jHg.B9f(b);f=this.pa.Pa;let y=0;const G=this.pa.zn();if(b.Ta(va.a.HP)||G){switch(a){case ea.a.PLb:c=G?({Xxa:y}=this.zc.yyd(f)).returnValue&&0===y:0===b.eb(va.a.HP);break;case ea.a.OLb:c=G?({Xxa:y}=this.zc.yyd(f)).returnValue&&1===y:1===b.eb(va.a.HP);break;case ea.a.NLb:c=G?({Xxa:y}=this.zc.yyd(f)).returnValue&&2===y:2===b.eb(va.a.HP)}l.If(c);return 32}return 8}Ulh(a,
b,c,f,l){if(this.pa.Js())return l.If(!1),32;b=this.gHa.sB(this.pa.ak);c=!0;for(const y of b)if((b=y.Rk?y.node:null)?(c=this.Tb.Lc(b),c.set(b),c.rc(11),c.Jg(11),c=(b=this.EA.Hv(c))?a===ea.a.Ond?1===b.listType:a===ea.a.cod?0===b.listType:!1:!1):c=!1,!c)break;l.If(c);return 32}nmh(a,b,c,f,l){b=l.p0a;l=l.menuItemId;if(this.pa.Js())return b.If(!1),32;f=this.gHa.sB(this.pa.ak);c=!0;for(const G of f){if(f=G.Rk?G.node:null){var y=this.Tb.Lc(f);y.set(f);y.rc(11);y.Jg(11);if(f=this.EA.Hv(y)){if(0===l){c=!1;
break}a===ea.a.wqc?(c=this.yM.NWa.ga(l).o1b,y=this.yM.NWa.ga(l).lub,c=f.Hzb&&0<f.Y9.length&&f.Y9[0]===c&&f.lbb&&f.font===y):a===ea.a.xqc?(c=this.yM.Oid.ga(l).jXd,c=!!f.propertySet&&f.propertySet.Ta(va.a.autonumberBulletType)&&f.propertySet.eb(va.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.If(c);return 32}kHj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}iGj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.renderColorPicker,1,l);w.AFrameworkApplication.Qa.Ja(C.a.hLb,2,l);a=new oc.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=ea.a.wKb;b.hideAlphaSlider=!0;return this.ia.Ja(ea.a.renderColorPicker,2,b)}jGj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.vr,c,l);if(!l)return ya.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=Cu.a.parse(l.Color))return a=this.ia.Ja(ea.a.vr,
c,"@"+a.RGBColor),32===a&&this.ia.Ja(ea.a.xCa,c,l),a;ya.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}iHj(a,b,c,f,l){if(1===c)return 32;a=(a=this.pa.Fk())?a.Fd:null;b=ea.a.iya;var y=ea.a.wKb;c=this.Ub.Gf.fda;if(!l.MenuId||0>na.a.ug(l.MenuId).indexOf("floatie")){f=b.toString();y=y.toString();b=Object.assign(new bo.a,{Id:"menuFontColor",MenuSectionList:[]});const G=qd.a("ColorPickerHighlighterFix")?LE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
jl.e(a,G,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.Ohc));Array.add(b.MenuSectionList,jl.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,jl.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",y,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,jl.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(qd.a("ColorPickerHighlighterFix")&&(c=new st,32===w.AFrameworkApplication.Qa.Ja(C.a.hLb,2,c)&&c&&!c.e7b))if(c=c.fontColor,-1===c)jl.h(b,null,a);else if(c=Xh.i(c)||"",c=Cu.a.parse(c))c=Hf.Box4ColorHelper.GEa(c.UMa(),a),jl.h(b,c,a);l.MenuItems=b}else a=
this.vjk.l7f(a,!this.Ohc),l.PopulationXML=a.fwi(b,c,ea.a.wKb);return 32}TDj(a,b,c){if(!this.pa.uz())return 16;if(1===c)return 32;a=this.pa.Ud();if(!a||1!==a.length)return 16;this.pa.selectShape(a[0],!0);this.Fa.Bd();return 32}ZFj(){return 32}xKa(a,b,c,f,l){if(1===c)return 32;a=new bo.a;a.MenuSectionList=[];b=Object.assign(new el.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new Wy.a,{Id:"buttonLineSpacing"+Du.ite[c].replace(".","_"),LabelText:Du.ite[c].substring(0,3),ExternalId:"LineSpacingButton"+
Du.ite[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}Ehg(a,b,c,f,l){if(1===c)return 32;a=a===ea.a.tpc?1:a===ea.a.upc?0:14;Kc.a.Kb&&(1===a?Kc.a.Kb.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Kc.a.Kb.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>na.a.ug(l.MenuId).indexOf("floatie")?l.MenuItems=this.fHi(a):l.PopulationXML=this.gHi(a);return 32}k0a(a,b,c,f,l){var y=l.MenuItemId;a=l.queryResult;
c=l.LineSpacingValue;f=l.LineSpacingUnit;let G=!1;b=this.Kfb.fX(b.node);y=Xg.a.vz(b.lineSpacing.value,y)&&2===b.lineSpacing.unit;if(-1===c)f=b.lineSpacing.unit,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.unit)c=f=0;0!==f&&(G=y);a.If(G);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}f2(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return ya.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Fb.ke(15);b=b.node;c.jc(b);c.gd=
a;b.setValue(va.a.CX,2);a=l;this.sad&&(a+=this.Ga.N$d(this.Ga.An(b)));b.setValue(va.a.Jx,a);c.dispose();return 32}sEf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new FN.a(l.unit,l.value);l=c.unit;c=c.value;switch(a){case ea.a.Flb:b.setValue(va.a.Hea,c);b.setValue(va.a.cma,l);break;case ea.a.Elb:b.setValue(va.a.Gea,c),b.setValue(va.a.bma,l)}return 32}Atb(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new xv.a(l.unit,l.value)).qN;c=this.Q$.k9(b).qN;f=this.Q$.BUa(b);switch(a){case ea.a.qla:b.setValue(sb.a.um,
l);break;case ea.a.tOb:b.setValue(sb.a.xo,l);break;case ea.a.vOb:b.setValue(sb.a.xo,-l);break;case ea.a.xOb:b.setValue(sb.a.xo,0);break;case ea.a.uOb:this.cZa&&b.setValue(sb.a.xo,l-c);break;case ea.a.wOb:this.cZa&&(this.wwa.Jv.slb(b,(1===f.specialIndentType?c+f.qN:c-f.qN)-l),this.wwa.Jv.ztd(b,1,l))}return 32}gHi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');
b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=ea.a.Goa;l=ea.a.QKa;break;case 0:c="NumberingLibrary_";f=ea.a.CKa;l=ea.a.Kjb;break;default:c="BulletsLibrary_",f=ea.a.Goa,l=ea.a.QKa}for(let y=0;8>y;++y)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+y,f,l,na.a.ze(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.oce(a,y),this.nce(a,y))),this.N$f(a,y),y));b.append("</Gallery>");b.append("</MenuSection>");b.append("</Menu>");return b.toString()}fHi(a){const b=Object.assign(new bo.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.Hzf(a));return b}Hzf(a){var b="",c="";let f="",l=ea.a.Goa,y=ea.a.QKa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=ea.a.Goa;y=ea.a.QKa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=ea.a.CKa,
y=ea.a.Kjb,c="NumberingLibrarySection"}b=Object.assign(new el.a,{Id:"msListMarkersPosition",Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new Hq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.Fbe(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let G=0;8>G;++G)c.GalleryItems.push(this.Ebe(a,G,f+G,l.toString(),y.toString(),this.N$f(a,G)));Array.add(b.ControlList,c);return b}Fbe(a){switch(a){case 1:return"BulletLibraryGallery";
case 0:return"NumberingLibraryGallery";default:return""}}Ebe(a,b,c,f,l,y){a=Object.assign(new rz,{LevelInfo:this.tnj(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=y;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}tnj(a,b){const c=[],f={};f.fontFamily=aa.FontUtils.Rja("Calibri");if(!b)return Object.assign(new gl,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=aa.FontUtils.Rja(this.P$f(a,b));1===a?(a=this.yM.K5c.ga(b).OHf,c.push(Object.assign(new gl,{textAtLevel:a,
styleAtLevel:f})),c.push(Object.assign(new gl,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new gl,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.yM.K5c.ga(b).b9g,c.push(Object.assign(new gl,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new gl,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new gl,{textAtLevel:a[2],styleAtLevel:f})));return c}N$f(a,b){return 1===a?this.yM.nxg.ga(this.yM.m9b(b)):0===a?this.yM.nxg.ga(this.yM.vYc(b)):""}nce(a,b){return b?1===a?(a=this.yM.K5c.ga(b).OHf,
this.IKa([a,a,a])):0===a?(a=this.yM.K5c.ga(b).b9g,this.IKa(a)):"":Box4Intl.Box4Strings.L_ListStyleNone}IKa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.XEa(a[0]),this.XEa(a[1]),this.XEa(a[2])):""}XEa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}oce(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?
(c.append("font-family: "),c.append(aa.FontUtils.Rja(this.P$f(a,b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}P$f(a,b){return 1===a?this.yM.NWa.ga(this.yM.m9b(b)).lub:0===a?"Calibri":""}AYf(){let a=16;if(this.pa.J9())return 16;const b=this.pa.Ll(),c=this.pa.zn();if(b&&b.pCb||c)a=32;return a}static Z6j(a){return!!a&&(a.HIh||a.xd)}}Du.ite=["1.00","1.50","2.00","2.50","3.00"];Object(m.a)(Du,"PandoraActor",
null,[268]);const GN=a=>{const b=new Sys.StringBuilder;for(let c of a.keys)b.append(String.format('"{0}": "{1}"',c,a.ga(c)));return"{"+b.toString(",")+"}"};var fS=d(766);class ns{constructor(a,b){this.sHd=this.M4a=null;this.Ca=a;this.fBa=b;if(this.YAe=w.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.sHd=fS.a.create();this.DN=Fb.a.instance.Ia("Common.ISystemInitiatedFeedback")}get UQ(){return this.M4a}vb(){this.Ca.ra(F.a.close,ye.a.frame,Object(H.a)(this,this.closeDocument,
"closeDocument"),2176);this.Ca.ra(F.a.v6b,ye.a.frame,Object(H.a)(this,this.v6b,"fileProperties"),128);this.Ca.ya(F.a.Jda,ye.a.frame,Object(H.a)(this,this.Jda,"fileSharing"));this.Ca.ya(F.a.O_d,ye.a.frame,Object(H.a)(this,this.O_d,"coEditInTeams"));this.Ca.ra(F.a.copyAndEdit,ye.a.frame,Object(H.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.ra(F.a.GMb,ye.a.frame,Object(H.a)(this,this.GMb,"replyWithChanges"),128);this.Ca.ra(F.a.Fuc,ye.a.frame,Object(H.a)(this,this.h7i,"fileVersion"),128);this.Ca.ya(F.a.downloadACopy,
ye.a.frame,Object(H.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.ya(F.a.MZi,ye.a.frame,zf.ActionManager.Sg);this.Ca.ra(F.a.aYe,ye.a.frame,Object(H.a)(this,this.aYe,"reportAbuseLink"),128);this.Ca.ra(F.a.Kvd,ye.a.frame,Object(H.a)(this,this.Suc,"signInInternal"),128);this.Ca.ya(F.a.workflow,ye.a.frame,Object(H.a)(this,this.workflow,"workflow"));w.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.ra(F.a.Nnd,ye.a.frame,Object(H.a)(this,this.Nnd,"queryBreadcrumbDocName"),
96);this.Ca.ra(F.a.qTe,ye.a.frame,Object(H.a)(this,this.qTe,"queryCopyAndEditButton"),96);w.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.ra(F.a.nTe,ye.a.frame,Object(H.a)(this,this.nTe,"queryBuildVersion"),2144),this.Ca.ra(F.a.bUe,ye.a.frame,Object(H.a)(this,this.bUe,"querySessionId"),2144));this.Ca.ya(F.a.h3b,ye.a.frame,Object(H.a)(this,this.h3b,"conversation"));this.fBa.execute(Object(H.a)(this,this.mnc,"onHostPostmessengerCreated"));ha.ULS.sendTraceTag(536987588,
306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}mnc(a){this.M4a=a;this.YAe&&(this.sHd.instance=a);ha.ULS.sendTraceTag(536987589,306,this.UQ?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.UQ))}closeDocument(a,b,c,f,l){a=2===c;c=Uh.h;l&&(c=l);return b&&a&&!this.wLc(c)?8:this.lFi(a,c)}wLc(){return!0}lFi(a,b){if(w.AFrameworkApplication.Aa.mb.K2e("3033402446"))return ha.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),
this.lpa(a,ma.a.z1f,!0,{});if(w.AFrameworkApplication.$rc&&b&&b===Uh.f)return ha.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),w.AFrameworkApplication.Aa.PM(a,w.AFrameworkApplication.$rc);if(w.AFrameworkApplication.isEmbedded)return a&&ha.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(w.AFrameworkApplication.gNf){if(!a)return 32;ha.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");
try{return window.top.close(),32}catch(l){return ha.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=w.AFrameworkApplication.CNc;if(!c)return a&&ha.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=Uh.h);if(b===Uh.c||b===Uh.h)return w.AFrameworkApplication.Aa.PM(a,c);let f;if(w.AFrameworkApplication.J0a)return a&&ha.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),
f=b===Uh.d||b===Uh.b?this.lpa(a,ma.a.GMb,w.AFrameworkApplication.Rxc,{["event_source"]:b}):2,32!==f?(c=b?ug.a.Pi(w.AFrameworkApplication.J0a,Uh.e,b):w.AFrameworkApplication.J0a,w.AFrameworkApplication.Aa.PM(a,c)):f;a&&ha.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===Uh.b?this.lpa(a,ma.a.z1f,w.AFrameworkApplication.Maf,null):2;return 32!==f?w.AFrameworkApplication.Aa.PM(a,c):f}Suc(a,b,c,f,l){a=this.lpa(2===c,ma.a.Kvd,!0,l);8===a&&(window.top.location=
w.AFrameworkApplication.signInUrl,a=32);return a}v6b(a,b,c){a=this.lpa(2===c,ma.a.v6b,w.AFrameworkApplication.XRh,null);return 32!==a?w.AFrameworkApplication.Aa.PM(2===c,w.AFrameworkApplication.E1f):a}Jda(a,b,c,f,l){if(1===c)return tz.SessionStatusManager.instance.jla?8:32;a=F.a.Ovl;b=oh.a.create().toString();f={};f.event_source=l;f[uh.a.huc]=b;var y=l?l.nav:null;y&&(f[uh.a.Rvl]=y);(y=l?l.scenarioId:null)&&(f[uh.a.Svl]=y);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=F.a.Nvl);l&&"ManageAccess"===
l.SourceControlId&&(l.mode="manageAccess",a=F.a.Pvl);l&&"ShareTopBar"===l.SourceControlId&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",!1)&&ns.Ir.raiseEvent(ns.PBi);(y=l?l.mode:null)&&(f[uh.a.Qvl]=y);if(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",!1)){var G=l?l.additionalData:null;G&&(f[uh.a.dmi]=G)}2===c&&(G={},G[uh.a.huc]=b,y&&(G.mode=y),ha.ULS.sendTraceTag(38278995,306,50,Nd.c(G)));
b=this.lpa(2===c,ma.a.bwl,w.AFrameworkApplication.Oaf,f);if(32!==b){if(w.AFrameworkApplication.w6b)return l=l?ug.a.Pi(w.AFrameworkApplication.w6b,Uh.e,l):w.AFrameworkApplication.w6b,w.AFrameworkApplication.Aa.PM(2===c,l,!0);ha.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}c=Ti.a.S_("PPTIsSimplifiedRibbonOn",!1);ha.ULS.sendTraceTag(509441175,306,15,"ActionName=FileSharing;SimplifiedRibbonMode={0}",c);kk.c(a);w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.OnlineSharingSurveyEnabled",
!1)&&this.DN&&this.DN.execute(R=>{R.logActivity("WordWebOnlineShareActivity",null)});return b}O_d(a,b,c){ha.ULS.sendTraceTag(509613976,230,50,"Attempting to Launch the currently active document in the browser tab in a Word Live Teams Meeting");try{var f=oh.a.create().toString(),l=ns.FZl,y=w.AFrameworkApplication.fa.Ha("LiveInTeamsWordAppSharingUrl");const ic=new qj.QueryStringBuilder("https://teams.microsoft.com/l/meeting-share");ic.xg("deeplinkId",f);ic.xg("lm","deeplink");a=ic;var G=a.xg;const yc=
new Yc.a;var R=yc.$;const ec=new qj.QueryStringBuilder(y);ec.xg("auth","2");ec.xg("flight","officeunihost");ec.xg("source","TEAMS-ELECTRON.meetingStage.deeplink");const jc=new Yc.a;jc.$("fileType",na.a.IQ(w.AFrameworkApplication.fileName).substring(1,w.AFrameworkApplication.fileName.length));jc.$("objectUrl",w.AFrameworkApplication.fa.Ha("EditDocInClientUrl"));jc.$("baseUrl",w.AFrameworkApplication.ju.breadcrumbBrandUrl);y=jc;var ja=y.$;{let Xd=w.AFrameworkApplication.fa.Ha("RootFileId"),Qd=decodeURIComponent(Xd);
for(;Xd!==Qd;)Xd=Qd,Qd=decodeURIComponent(Xd);if(32>Xd.length){ha.ULS.sendTraceTag(509440723,230,15,"Decoded fileId does not match expected format. Decoded id: ${fullyDecodedId}");var za=""}else{var Va=Xd.substring(Xd.length-32,Xd.length),hb=Va.substring(0,8)+"-"+Va.substring(8,12)+"-"+Va.substring(12,16)+"-"+Va.substring(16,20)+"-"+Va.substring(20,32);RegExp("^(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}$").test(hb)?za=hb:(ha.ULS.sendTraceTag(509203084,
230,15,"Unable to parse the fileId from the WOPISrc ParsedFileId: ${fileIdGuid}"),za="")}}ja.call(y,"fileId",za);const xd=Nd.c(GN(jc));ec.xg("subEntityId",xd.substring(1,xd.length-1));R.call(yc,"appSharingUrl",ec.toString());yc.$("appId",l);var Cb=GN(yc);G.call(a,"appContext",Cb);var lc=ic.toString();ha.ULS.sendTraceTag(509138050,230,50,"Launched the currently active document in the browser tab in a Word Live Teams Meeting");return w.AFrameworkApplication.Aa.PM(2===c,lc)}catch(ic){return ha.ULS.sendTraceTag(509138049,
230,10,"Failed to launch the currently active document in a Word Live Teams Meeting {0}",ic),8}}h3b(a,b,c){return this.lpa(2===c,ma.a.h3b,!0,{})}workflow(a,b,c){a=this.lpa(2===c,ma.a.workflow,w.AFrameworkApplication.Waf,{["WorkflowType"]:w.AFrameworkApplication.nyc});if(32!==a){if(w.AFrameworkApplication.RAd)return w.AFrameworkApplication.Aa.PM(2===c,w.AFrameworkApplication.RAd,!0);ha.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}aYe(a,b,c){a=2===
c;return b&&a&&!this.wLc(Uh.f)?8:w.AFrameworkApplication.Aa.PM(a,w.AFrameworkApplication.$rc)}copyAndEdit(a,b,c){a={};2===c&&(a=w.AFrameworkApplication.Aa.mb.H7f());a=this.lpa(2===c,ma.a.copyAndEdit,w.AFrameworkApplication.WRh,a);return 32!==a?w.AFrameworkApplication.Aa.PM(2===c,w.AFrameworkApplication.p1d,w.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?w.AFrameworkApplication.Vx||w.AFrameworkApplication.$Q||tz.SessionStatusManager.instance.jla?8:32:w.AFrameworkApplication.Aa.PM(2===
c,w.AFrameworkApplication.JSa,!0)}GMb(a,b,c){a=2===c;if(b&&a&&!this.wLc(Uh.d))return 8;b=this.lpa(a,ma.a.GMb,w.AFrameworkApplication.Rxc,{["event_source"]:Uh.d});return 32!==b?(b=ug.a.Pi(w.AFrameworkApplication.J0a,Uh.e,Uh.d),w.AFrameworkApplication.Aa.PM(a,b)):b}h7i(a,b,c){a=this.lpa(2===c,ma.a.i7i,w.AFrameworkApplication.Paf,null);return 32!==a?w.AFrameworkApplication.Aa.PM(2===c,w.AFrameworkApplication.B8d):a}Nnd(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=na.a.mH(w.AFrameworkApplication.ju.rx)}return 32}nTe(a,
b,c,f,l){if(2===c){if(!l)return 8;l.Text=w.AFrameworkApplication.instance.ZWi}return 32}bUe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=w.AFrameworkApplication.instance.$Wi}return 32}lpa(a,b,c,f){return this.YAe?this.sml(a,b,c,f):c?a?this.UQ.sendMessage(b,f)?32:8:32:2}sml(a,b,c,f){return c?a?this.UQ?this.UQ.sendMessage(b,f)?32:8:(ha.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),this.sHd.execute(()=>{ha.ULS.sendTraceTag(528234242,
306,50,"HostPostmessenger now available. Executing the request.");this.UQ.sendMessage(b,f)}),32):32:2}qTe(a,b,c,f,l){if(2===c){if(!l)return 8;w.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}ns.Ir=new Wc.a;ns.PBi="CheckEditorSuggestions";ns.FZl="d7958adf-f419-46fa-941b-1b946497ef84";Object(m.a)(ns,"WebAppFrameCommandUIActor",null,[]);class HN extends ns{constructor(a,b,c,f,l,y,G){super(a,b);this.Yu=c;this.KE=f;this.pa=l;this.Da=y;this.Ya=
G}vb(){super.vb();this.Da.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.ya(ea.a.ljh,ye.a.frame,Object(H.a)(this,this.IRe,"pptoShowFileVersion"))}IRe(a,b,c){return 1===c&&this.Ya.yea?2:this.Ca.processAction(F.a.Fuc,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.pa.nh();this.Yu.x4e(!0,ResourceStrings.l_Loading,a);ya.a.J(20187205,801,50,"PPT save and launch workflow");this.KE.h4(!1,!0,()=>{this.xzi(l)},Object(H.a)(this,this.Qya,"saveFailureCallback"));return 32}wLc(a){return a!==Uh.a||
w.AFrameworkApplication.isEmbedded||w.AFrameworkApplication.gNf||w.AFrameworkApplication.CNc||this.m3j()?!0:(ya.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.Ja(ea.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}m3j(){var a=w.AFrameworkApplication.fa.Ha(w.AFrameworkApplication.yK);a=w.AFrameworkApplication.cdb&&!!a&&"teams"===a.toLowerCase();return qd.a("ReactDialogsProtocolLaunchingTeamsFix")&&
this.Da.q6d&&a&&w.AFrameworkApplication.Aa.mb.K2e("3033402446")}xzi(a){this.Yu.hide();super.workflow(0,null,2,null,a)}Qya(){this.Yu.hide();return!1}}Object(m.a)(HN,"PptWebAppFrameCommandUIActor",ns,[]);class IN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.ic=c}vb(){this.ia.ra(ea.a.yqd,qc.a.application,Object(H.a)(this,this.yqd,"replaceFonts"),4)}me(){const a=
[this.Fa.Ic(Si.a.fE),this.Fa.Ic(Si.a.D3),this.Fa.Ic(xa.a.qg),this.Fa.Ic(xa.a.DQ)];for(const b of a)b.bindAction(x.KeyInputManager.Va(B.a.nSb,x.KeyInputManager.Te),ea.a.yqd)}yqd(a,b,c){return b.contextId!==qc.a.application?2:1===c?this.ic.rj()?32:8:32}}Object(m.a)(IN,"ReplaceFontsActor",null,[]);class JN extends Sys.EventArgs{constructor(a,b,c){super();this.x9g=a;this.Zfa=b;this.Uu=c}}Object(m.a)(JN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class KN{constructor(a,b,c,f,l,y,G,R){if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");if(!G)throw Error.argumentNull("ribbonExternal");this.Fa=f;this.ia=a;this.MO=b;this.Vv=c;this.qCg=l;this.$d=y;this.sik=R}vb(){this.ia.ya(F.a.iZe,ye.a.frame,Object(H.a)(this,this.kLk,"onRibbonFocus"));this.ia.ra(F.a.Fhl,ye.a.frame,Object(H.a)(this,this.HIj,"handleRibbonStateChanged"),64);this.ia.ya(F.a.Xxd,qc.a.application,Object(H.a)(this,this.Xxd,"toggleRibbonState"));
this.ia.ya(F.a.Quh,rb.a.view,Object(H.a)(this,this.IIj,"handleRibbonTabSwitched"));this.ia.ya(F.a.nrd,rb.a.view,Object(H.a)(this,this.nrd,"ribbonModeToggledToMLR"));this.ia.ya(F.a.ord,rb.a.view,Object(H.a)(this,this.ord,"ribbonModeToggledToSLR"));Sd.a.get_instance().Vj(7,Object(H.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}me(){const a=t.FocusManager.instance().Ic(Si.a.hIf);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.yyc,x.KeyInputManager.Te),F.a.Xxd);D.AFrame.zk(a,x.KeyInputManager.Va(z.a.fl?
B.a.Iba:B.a.pAd,1),F.a.iZe);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.rNa,z.a.fl?2:1),F.a.iZe);this.sik&&(this.MO.hdb.Ipd(pa.a.Tl,window.document,Object(H.a)(this,this.mOj,"ignoreAltKeyUpOnDocument")),sE.a.instance().yUd(Object(H.a)(this,this.OJk,"onOnlyAltKeyPressed")))}nrd(a,b,c){try{if(1===c)return 32;qd.a("ReactMLRReuseSLRCookieForMLR")?this.xAh(!1):this.Btc(!0);ya.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.MO.dbb()}catch(f){ya.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",
f)}return 32}ord(a,b,c){try{if(1===c)return 32;qd.a("ReactMLRReuseSLRCookieForMLR")||this.Btc(!1);this.xAh(!0);ya.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.MO.dbb()}catch(f){ya.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}xAh(a){Ti.a.qK(w.AFrameworkApplication.fa.Ha("IsSimplifiedRibbonOnCookieName"),a.toString(),Ti.a.aK)}Btc(a){Ti.a.qK(w.AFrameworkApplication.fa.Ha("ReactRibbonMLRPreferenceCookieName"),a.toString(),Ti.a.aK)}HIj(a,
b,c){if(1===c)return 32;this.MO.dbb();return 32}Xxd(){return 32}IIj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[tn.a.Uu]&&(a=l[tn.a.Uu]),this.$d.z2k(new JN(l.OldContextId,l.NewContextId,a)));this.Fa.Ee&&2===l[tn.a.Uu]&&this.Fa.Ee.name===xa.a.Waa&&(b=b.view)&&!na.a.Xa(b.$I)&&this.Fa.wf(b.$I);return 32}OJk(){FC.a.instance.keyCode===B.a.oNa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.Rhg())}mOj(a){return a.nc.keyCode===
B.a.oNa}Rhg(){if(document.activeElement&&document.activeElement.id!==Pd.a.z2b)return this.Fa.ELh(!this.qCg.inKeytipMode,!1),32;this.Fa.Ee&&this.Fa.ELh(this.Fa.Ee.name===xa.a.Waa||this.qCg.inKeytipMode,!0);return 32}kLk(a,b,c){return 1===c?32:this.Rhg()}registerOnShyRibbonStateChange(){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Qp&&Zg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)ya.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),
this.MO.dbb()})}}Object(m.a)(KN,"RibbonStateActor",null,[268]);class fA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(m.a)(fA,"SelectSectionAndSlidesData",null,[]);class LN{constructor(a,b,c,f,l,y,G,R,ja,za){this.gZa=null;if(ja){if(!y)throw Error.argumentNull("SectionActor.workspace");if(!G)throw Error.argumentNull("SectionActor.presentationReader");if(!R)throw Error.argumentNull("SectionActor.selectionManager");}this.ia=a;this.wA=b;this.ua=c;this.Cjc=f;this.Gt=l;this.Ub=y;this.ic=
G;this.pa=R;this.P5=ja;this.En=za;this.Cjc.KF(Object(H.a)(this,this.cC,"onChildTopologyChanged"));this.ua.presentation&&(this.gZa=this.ua.presentation.Yp)}vb(){this.ia.ra(ea.a.VWe,rb.a.application,Object(H.a)(this,this.qIj,"handleRemoveSection"),4);this.ia.ra(ea.a.Nhd,rb.a.application,Object(H.a)(this,this.oGj,"handleMoveSectionUp"),4);this.ia.ra(ea.a.Mhd,rb.a.application,Object(H.a)(this,this.nGj,"handleMoveSectionDown"),4);this.ia.ra(ea.a.waf,rb.a.application,Object(H.a)(this,this.bKj,"handleUpdateSectionTitle"),
4);this.ia.ra(ea.a.x7a,rb.a.application,Object(H.a)(this,this.CCj,"handleAddSection"),4)}me(){}bKj(a,b,c,f,l){if(1===c)return(a=this.ua.presentation)&&a.Yp&&a.Yp.length?32:8;if(!l)return ya.a.J(509368192,822,10,"HandleUpdateSectionTitle with null action data."),8;this.wA.d4i(l);return 32}qIj(a,b,c){b=this.ua.Ru;const f=this.ua.j8;if(1===c){const l=this.ua.presentation;if(!l||!l.Yp||!l.Yp.length)return 8;if(!b&&1<l.Yp.length)return f&&!f.hI.length?32:8}if(2===c){ya.a.J(509368163,822,50,"HandleRemoveSection called.");
try{f&&this.wA.W3i(b,a),this.gZa=this.ua.presentation.Yp,this.ia.Ja(ea.a.wsd,2,new fA(this.ua.Ru,this.ua.Ba.slideIndex))}catch(l){ya.a.J(509368162,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}oGj(a,b,c){a=this.ua.Ru;if(1===c)return c=this.ua.presentation,!c||!c.Yp||!c.Yp.length||0>=a?8:32;if(2===c){ya.a.J(509368161,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.wA.E_f(a,!0),this.ia.Ja(ea.a.wsd,2,new fA(this.ua.Ru,this.ua.Ba.slideIndex)))}catch(f){ya.a.J(509368160,
822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}nGj(a,b,c){a=this.ua.Ru;if(1===c)return(c=this.ua.presentation)&&c.Yp&&c.Yp.length&&a!==c.Yp.length-1&&-1!==a?32:8;if(2===c){ya.a.J(509368159,822,50,"HandleMoveSectionDown called.");try{-1!==a&&(this.wA.E_f(a,!1),this.ia.Ja(ea.a.wsd,2,new fA(this.ua.Ru,this.ua.Ba.slideIndex)))}catch(f){ya.a.J(509368158,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",f)}}return 32}CCj(a,b,c){var f;if(1===c)return 0!=(null===
(f=this.ua.presentation)||void 0===f?void 0:f.Gpa)&&this.ull()?32:8;if(2===c){b=-1;c=this.ua.Ru;ya.a.J(509368157,822,50,"HandleAddSection called.");try{let l;l=this.P5&&0<=this.Ub.gya?this.ic.zx(this.Ub.gya+1):this.ua.Ba;this.wA.x3i(l,a);b=this.ua.Ru;if(this.P5&&(-1!==this.Ub.gya&&(this.Ub.gya=-1,this.Ub.Ba=l),this.En)){const y=this.ic.DEa(b).map(R=>this.ic.zx(R));let G;(G=this.pa).yP.apply(G,y)}}catch(l){ya.a.J(509368156,822,10,"SectionActor: Exception in HandleAddSection: {0}.",l)}-1!==b&&b!==c&&
this.ia.processAction(ea.a.i9e,2)}return 32}ull(){if(!qd.a("AddSectionOptionCheck"))return!0;const a=this.pa.sdj();var b=this.pa.Re().map(c=>c.slideIndex);if(2>b.length)return!0;b=b.slice().sort((c,f)=>c-f);if(b[b.length-1]-b[0]!==b.length-1)return!1;b=this.ic.NQ(a[0]);for(const c of a)if(this.ic.NQ(c)!=b)return!1;return!0}cC(a,b){try{if(34===b.HW&&!b.node.isDirty){const c=this.gZa?Array.clone(this.gZa):null;this.gZa=Array.clone(this.ua.presentation.Yp);if(!c&&this.gZa||c.length<this.gZa.length)2===
this.gZa.length&&-1===this.ua.Ru&&(this.ua.Ru=1),this.Gt?this.Gt.fVe():ya.a.J(509368155,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(ea.a.i9e,2)}}catch(c){ya.a.J(509368154,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.Cjc.vP(Object(H.a)(this,this.cC,"onChildTopologyChanged"))}}Object(m.a)(LN,"SectionActor",null,[268]);var MN=d(641);class NN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd){if(!jc)throw Error.argumentNull("viewEventNotifier");
this.ia=a;this.qf=b;this.Fa=c;this.oR=f;this.Ub=l;this.ua=y;this.jb=G;this.pD=R;this.Sb=ja;this.gXa=za;this.xe=Va;this.En=hb;this.$J=Cb;this.Ga=lc;this.Nw=ic;this.saa=yc;this.dwa=ec;this.$d=jc;this.qnk=xd}vb(){this.ia.ya(ea.a.Cxd,qc.a.application,Object(H.a)(this,this.rNb,"selectNextSlideHandler"));this.ia.ya(ea.a.Dxd,qc.a.application,Object(H.a)(this,this.rNb,"selectNextSlideHandler"));this.ia.ya(ea.a.F2a,qc.a.application,Object(H.a)(this,this.rNb,"selectNextSlideHandler"));this.ia.ya(ea.a.E2a,qc.a.application,
Object(H.a)(this,this.rNb,"selectNextSlideHandler"));this.ia.ya(ea.a.cnb,qc.a.application,Object(H.a)(this,this.rNb,"selectNextSlideHandler"));this.ia.ya(ea.a.bnb,qc.a.application,Object(H.a)(this,this.rNb,"selectNextSlideHandler"));this.En&&(this.ia.ya(ea.a.wwc,qc.a.application,Object(H.a)(this,this.xzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.pwc,qc.a.application,Object(H.a)(this,this.xzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.rwc,qc.a.application,Object(H.a)(this,this.xzb,
"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.qwc,qc.a.application,Object(H.a)(this,this.xzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.vwc,qc.a.application,Object(H.a)(this,this.xzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.uwc,qc.a.application,Object(H.a)(this,this.xzb,"handleKeyboardMultiSelectSlides")),this.ia.ya(ea.a.dsd,qc.a.application,Object(H.a)(this,this.Xkl,"selectAllSlidesHandler")),this.ia.ya(ea.a.e1a,qc.a.application,Object(H.a)(this,this.KIj,"handleScrollSelectedThumbnailsIntoView")));
this.ia.ya(ea.a.Wkb,qc.a.application,Object(H.a)(this,this.JIj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(ea.a.$1a,qc.a.application,Object(H.a)(this,this.txh,"selectNextShapeHandler"));this.ia.ya(ea.a.rPb,qc.a.application,Object(H.a)(this,this.txh,"selectNextShapeHandler"));this.ia.ya(ea.a.gRb,qc.a.application,Object(H.a)(this,this.lRl,"unselectShapesHandler"));this.ia.ya(ea.a.Wsc,qc.a.application,Object(H.a)(this,this.Wkl,"selectAllShapesHandler"));this.ia.ya(ea.a.OBh,qc.a.application,
Object(H.a)(this,this.vvl,"shapeEscapeKeyPressedHandler"));this.ia.ya(ea.a.jmb,qc.a.application,Object(H.a)(this,this.xZc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.kmb,qc.a.application,Object(H.a)(this,this.xZc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.lmb,qc.a.application,Object(H.a)(this,this.xZc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.mmb,qc.a.application,Object(H.a)(this,this.xZc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ea.a.NGh,qc.a.application,Object(H.a)(this,
this.sJj,"handleSpaceKeyPressed"));this.ia.ya(ea.a.kih,qc.a.application,Object(H.a)(this,this.kTk,"playVideoCommandHandler"))}me(){var a=this.Fa.Ic(Si.a.fE);const b=this.Fa.Ic(xa.a.qg),c=this.Fa.Ic(xa.a.DQ);a.bindAction(x.KeyInputManager.Va(B.a.$q,0),ea.a.Cxd);a.bindAction(x.KeyInputManager.Va(B.a.$q,4),ea.a.Dxd);a.bindAction(x.KeyInputManager.Va(B.a.rF,0),ea.a.F2a);a.bindAction(x.KeyInputManager.Va(B.a.B2,0),ea.a.F2a);a.bindAction(x.KeyInputManager.Va(B.a.qF,0),ea.a.E2a);a.bindAction(x.KeyInputManager.Va(B.a.A2,
0),ea.a.E2a);a.bindAction(x.KeyInputManager.Va(B.a.oI,0),ea.a.cnb);a.bindAction(x.KeyInputManager.Va(B.a.ez,0),ea.a.bnb);this.En&&(a.bindAction(x.KeyInputManager.Va(B.a.B2,4),ea.a.wwc),a.bindAction(x.KeyInputManager.Va(B.a.A2,4),ea.a.pwc),a.bindAction(x.KeyInputManager.Va(B.a.oI,4),ea.a.rwc),a.bindAction(x.KeyInputManager.Va(B.a.ez,4),ea.a.qwc),a.bindAction(x.KeyInputManager.Va(B.a.rF,4),ea.a.vwc),a.bindAction(x.KeyInputManager.Va(B.a.qF,4),ea.a.uwc),a.bindAction(x.KeyInputManager.Va(B.a.ANa,2),ea.a.dsd));
b.bindAction(x.KeyInputManager.Va(B.a.rF,0),ea.a.F2a);b.bindAction(x.KeyInputManager.Va(B.a.qF,0),ea.a.E2a);b.bindAction(x.KeyInputManager.Va(B.a.oI,0),ea.a.cnb);b.bindAction(x.KeyInputManager.Va(B.a.ez,0),ea.a.bnb);b.bindAction(x.KeyInputManager.Va(B.a.$q,0),ea.a.$1a);b.bindAction(x.KeyInputManager.Va(B.a.$q,4),ea.a.rPb);b.bindAction(x.KeyInputManager.Va(B.a.AZ,0),ea.a.OBh);b.bindAction(x.KeyInputManager.Va(B.a.ANa,2),ea.a.Wsc);b.bindAction(x.KeyInputManager.Va(B.a.o7,0),ea.a.jmb);b.bindAction(x.KeyInputManager.Va(B.a.Jba,
0),ea.a.kmb);b.bindAction(x.KeyInputManager.Va(B.a.wha,0),ea.a.lmb);b.bindAction(x.KeyInputManager.Va(B.a.CZ,0),ea.a.mmb);a=x.KeyInputManager.Va(B.a.rF,0);c.hw(a);c.bindAction(a,ea.a.F2a);a=x.KeyInputManager.Va(B.a.qF,0);c.hw(a);c.bindAction(a,ea.a.E2a);b.bindAction(x.KeyInputManager.Va(B.a.BK,0),ea.a.NGh)}rNb(a,b,c){if(this.oR.h0||this.qf.fd(this.Ub.Gf))return 16;if(1===c)return 32;if(!this.Ub.Gf||!this.ua.Ba)return 16;32===this.ia.processAction(ea.a.rmc,1)&&this.ia.processAction(ea.a.qmc,2);b=this.Jpj(this.ua.Ba,
a);if(b===this.ua.Ba.qe)return 32;if(this.Nw&&a!==ea.a.cnb&&a!==ea.a.bnb&&(a=this.xe.fO(b),!a||!a.XL))return 16;this.Fa.I8===xa.a.qg&&this.Fa.Bd();return this.xe.dK(b)}Jpj(a,b){a=a.qe;const c=this.Sb.rj();switch(b){case ea.a.E2a:a=Math.min(a+1,c-1);break;case ea.a.Cxd:a=a+1>c-1?0:a+1;break;case ea.a.F2a:a=Math.max(a-1,0);break;case ea.a.Dxd:a=0>a-1?c-1:a-1;break;case ea.a.cnb:a=0;break;case ea.a.bnb:a=c-1}return a}xzb(a,b,c){if(this.oR.h0||this.qf.fd(this.Ub.Gf)||!this.Ub.Gf||!this.ua.Ba)return 16;
if(1===c)return 32;32===this.ia.processAction(ea.a.rmc,1)&&this.ia.processAction(ea.a.qmc,2);if(1>=this.Sb.rj())return 32;ya.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case ea.a.wwc:case ea.a.pwc:case ea.a.rwc:case ea.a.qwc:this.$Jj(a);break;case ea.a.vwc:case ea.a.uwc:this.GGj(a);break;default:return ya.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}lwj(a,b){const c=
[];var f=this.Sb.rj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Sb.zx(a))&&c.push(f);return c}$Jj(a){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.jb.Re();b.sort((Va,hb)=>Va.qe-hb.qe);const c=b[0].qe,f=b[b.length-1].qe,l=this.ua.Ba.qe,y=this.Sb.rj();var G=[];let R=l,ja=l,za=l;G=!0;switch(a){case ea.a.wwc:1===b.length?za=R=0<=l-1?l-1:l:l===c?ja=0<=f-1?f-1:f:c?za=R=c-1:G=!1;break;case ea.a.pwc:1===b.length?za=ja=l<y-1?l+1:l:l===c&&f<y-1?za=ja=f+1:l===c&&f===y-1?G=!1:R=c+1;break;
case ea.a.rwc:R=0;break;case ea.a.qwc:ja=y-1}if(this.Nw&&za!==l&&(a=this.xe.fO(za),!a||!a.XL))return;if(G){G=this.lwj(R,ja);let Va;(Va=this.jb).yP.apply(Va,G);this.xe.Uya(R===l?ja:R)}}GGj(a){const b=this.jb.Re();b.sort((ja,za)=>ja.qe-za.qe);const c=b[0].qe,f=b[b.length-1].qe,l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");const y=l.qe,G=this.Sb.rj();let R=null;if(!(1>=G)){switch(a){case ea.a.vwc:if(!y)break;(R=this.Sb.zx(y-1))&&1<b.length&&y===f&&this.Etb(b)&&this.jb.Hrc(l);break;
case ea.a.uwc:y!==G-1&&(R=this.Sb.zx(y+1))&&1<b.length&&y===c&&this.Etb(b)&&this.jb.Hrc(l)}if(R){if(this.Nw&&(a=R.rg(this.xe.Na),!a||!a.XL))return;this.Ub.Ba=R;this.jb.y7a(R);this.xe.Uya(R.qe)}}}Etb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].qe-a[b].qe)return!1;return!0}KIj(a,b,c){if(!this.Ub.Gf||!this.ua.Ba||this.qf.fd(this.Ub.Gf))return 16;2===c&&this.xe.e1a();return 32}JIj(a,b,c){if(!this.Ub.Gf||!this.ua.Ba||this.qf.fd(this.Ub.Gf))return 16;2===c&&this.xe.Zrd();
return 32}xZc(a,b,c){return this.jb.F4()?this.pGj(a,c):this.RIj(a,c)}RIj(a,b){if(this.En&&1!==this.jb.Re().length)return 8;let c;switch(a){case ea.a.jmb:case ea.a.lmb:a=ea.a.E2a;c="ThumbnailPageDownNavigation";break;case ea.a.mmb:case ea.a.kmb:a=ea.a.F2a;c="ThumbnailPageUpNavigation";break;default:return ya.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),8}Kc.a.Kb&&(Kc.a.Kb.actionName=c,Kc.a.Kb.Qj=!1,Kc.a.Kb.$p=!0);return this.ia.processAction(a,b)}pGj(a,
b){switch(a){case ea.a.jmb:a=ea.a.lmc;break;case ea.a.kmb:a=ea.a.mmc;break;case ea.a.lmb:a=ea.a.nmc;break;case ea.a.mmb:a=ea.a.omc;break;default:return ya.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,b)}txh(a,b,c,f,l){if(this.oR.h0)return 16;if(1===c)return 32;b=this.ua.Ba;if(!b)return 16;c=b.yj();if(!c||!c.length)return 16;this.Bd();f=this.jb.Qf();if(this.jb.xNb){if(c=this.jb.xNb.rg(this.Ub.jL.Na))c.The(),c.ryh(!1);
f.length||f.push(this.jb.xNb);this.jb.xNb=null}f&&this.jMa(f,!1);c=null;a===ea.a.$1a?c=l?l:b.vab(f,!1,0):a===ea.a.rPb&&(c=b.vab(f,!0,0));if(!c)return ha.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.qnk){l=Object(sa.a)(Bz.a,c.rg(this.Ub.jL.Na));if(c.Wua&&l&&a===ea.a.rPb){const y=document.getElementById(MN.a.vPe+l.YT);if(y&&document.activeElement!==y)return l.jMa(),y.focus(),32}if(f.length&&(l=f[0],f=Object(sa.a)(Bz.a,l.rg(this.Ub.jL.Na)),
l.Wua&&f&&a===ea.a.$1a&&(a=document.getElementById(MN.a.vPe+f.YT))&&document.activeElement!==a))return a.focus(),32}return this.elh(c,b)}Wkl(a,b,c){if(this.oR.h0)return 16;if(1===c)return 32;a=this.ua.Ba;if(!a)return 16;b=a.yj();if(!b.length)return 16;a=[];for(const f of b)(b=Object(sa.a)(117,f.rg(this.Ub.jL.Na)))&&b.iq?b.jMa():(b&&b.shapeNode&&b.shapeNode.Lv&&b.cZ(!1),a.push(f));this.jb.j1a(a,!0);this.$J.b3k();this.jMa(a,!0);this.Bd();return 32}Xkl(a,b,c){if(1===c)return 32;a=this.ua.presentation;
if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;ya.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.jb).yP.apply(f,a);this.xe.Uya(this.Sb.rj()-1);return 32}vvl(a,b,c){if(1===c)return 32;this.ia.processAction(ea.a.Pje,2);this.ia.processAction(ea.a.gRb,2);qd.a("RaiseEscapeKeyPressedEvent")&&this.$d.l1k();return 32}lRl(a,b,c){if(!this.jb.vH())return 16;if(1===c)return 32;this.pD.zRa();a=this.jb.Ud();if(b=this.Ga.cab(a))return a=this.Ga.Lr(b),this.elh(a,
this.ua.Ba);this.jMa(a,!1);this.jb.nh();this.Bd();return 32}sJj(){this.ia.processAction(ea.a.kih,2);this.dwa&&this.ia.processAction(ea.a.DFf,2);return 32}kTk(){if(!this.jb.Mpi()&&!this.jb.Npi())return 2;const a=this.jb.Ud();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.saa.GUa(a[b]);c&&c.startPlaying()}return 32}elh(a,b){const c=a.rg(this.Ub.jL.Na);if(c){if(c.iq)return this.jb.nh(),c.jMa(),c.ryh(!0),c.jS(),b=null,c.T5c?b=String.format(ResourceStrings.L_CannotEditHint,c.T5c.userName):
ya.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.gXa.Znh(a,b),this.jb.xNb=a,32}else return ha.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),8;this.jb.selectShape(a,!0);(a=b.rg(this.Ub.jL.Na))&&a.Tya();c&&(c.jMa(),c.jS());return 32}Bd(){this.Ub.jL.yp||this.Fa.Bd()}jMa(a,b){for(const c of a)(a=c.rg(this.Ub.jL.Na))&&(b?a.jMa():a.The())}}Object(m.a)(NN,
"SelectionActor",null,[268]);class gA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(m.a)(gA,"SelectionPaneShapeNode",null,[]);var gS=d(909);class ON{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec){this.Eic=this.JR=null;a("powerpoint-editor-intl").then(()=>{ya.a.J(512500438,801,50,"Icons and strings script is loaded successfully");a("selectionPaneManager").then(()=>{ya.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");
this.JR=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.$8k();ja.Msl()}).catch(jc=>{ya.a.J(512500436,801,10,"Failed to load selectionPaneManager "+jc.toString())})}).catch(jc=>{ya.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+jc.toString())});this.jb=b;this.Rb=c;this.ia=f;this.ua=l;this.Fa=y;this.KA=G;this.q0g=R;this.uqk=ja;this.Rf=za;this.od=Va;this.Fc=hb;this.iaa=Cb;this.MO=lc;this.Ga=ic;this.Nz=yc;this.Fb=ec;this.mzg=!1;this.Rf.LI(Object(H.a)(this,this.r_a,
"onChangeRenderSelectionPane"));this.Rf.zCa(Object(H.a)(this,this.r_a,"onChangeRenderSelectionPane"));this.Fc.SQa(Object(H.a)(this,this.r_a,"onChangeRenderSelectionPane"));this.od.DCa(Object(H.a)(this,this.r_a,"onChangeRenderSelectionPane"));this.Rb.MI(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"));this.ZWa=!1;this.HYg=null}dispose(){this.Rf.E6(Object(H.a)(this,this.r_a,"onChangeRenderSelectionPane"));this.Rf.G0a(Object(H.a)(this,this.r_a,"onChangeRenderSelectionPane"));this.Fc.pkb(Object(H.a)(this,
this.r_a,"onChangeRenderSelectionPane"));this.od.rkb(Object(H.a)(this,this.r_a,"onChangeRenderSelectionPane"));this.Rb.WY(Object(H.a)(this,this.Eu,"onAppFrameModeSwitched"))}me(){const a=this.Fa.Ic(xa.a.aI);a.bindAction(x.KeyInputManager.Va(B.a.lSb,6),ea.a.Isd);a.bindAction(x.KeyInputManager.Va(B.a.CNa,6),ea.a.FLc)}Isd(a){return Vg.a("SelectionPaneBringBackward",a,()=>{this.ZWa=!0;this.ia.processAction(ea.a.sendBackward,2);ya.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");
return 32})}FLc(a){return Vg.a("SelectionPaneBringForward",a,()=>{this.ZWa=!0;this.ia.processAction(ea.a.bringForward,2);ya.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}vb(){this.ia.ra(ea.a.P6,qc.a.application,Object(H.a)(this,this.P6,"showHideSelectionPane"),4);this.ia.ra(ea.a.BLb,qc.a.application,Object(H.a)(this,this.BLb,"querySelectionPane"),96);this.ia.ya(ea.a.Isd,qc.a.application,Object(H.a)(this,this.Isd,"sendBackwardSelectionPane"));this.ia.ya(ea.a.FLc,
qc.a.application,Object(H.a)(this,this.FLc,"bringForwardSelectionPane"))}BLb(a,b,c,f,l){(a=Object(sa.a)(gi.a,l))&&a.If(this.KA.isVisible);return 32}P6(a,b,c){return 1===c?this.JR&&this.ua.Ba?32:8:Vg.a("SelectionPaneOpen",a,()=>{this.KA.isVisible=!this.KA.isVisible;this.psh();this.KA.isVisible?(this.MO.notesPane&&this.MO.notesPane.E0b()&&this.Fa.Bd(),this.Fa.wj(xa.a.aI,!0),this.JR.focusShowAllButton()):this.Fa.wj(xa.a.aI,!1);return 32})}Eu(a){1===a.mode&&this.KA&&this.KA.isVisible&&(this.KA.isVisible=
!1,this.Fa.wj(xa.a.aI,!1))}RJi(){const a={};this.Eic=new Eb.ScriptSharpLegacyMap;var b=this.ua.Ba,c=b?b.yj(!0):null;b=this.jb.Qf();const f=new Oa.a;let l=0;if(c){c.reverse();for(const G of c)if(!G.isLocal)if(c=this.Hcg(G,b),G.Of){if(l++,c=this.Ga.yx(G)){c.reverse();for(const R of c){c=this.Hcg(R,b);let ja=null;for(const za of R.EB){var y=void 0;za.ShapeId.toString()in a?(y=Object(sa.a)(gA,a[za.ShapeId.toString()]),this.Eic.ga(za.ShapeId).push(R.get_shapeId())):(y=[R.get_shapeId()],this.Eic.add(za.ShapeId,
y),y=this.Iuj(za,b),a[za.ShapeId.toString()]=y,ja?ja.children.push(y):f.add(y));ja=y}ja.children.push(c)}}}else f.add(c)}0<l&&!this.mzg&&(ya.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.mzg=!0);return f}Hcg(a,b){const c=new gA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}Iuj(a,b){const c=new gA;c.shapeId=a.ShapeId;c.shapeName=a.ShapeName;c.isHiddenShape=
a.IsHidden;c.isFocussedShape=!1;const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.WC(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}psh(){if(!this.ua.Ba)this.KA.isVisible=!1;else if(this.KA.isVisible){var a=this.RJi();if(this.SEf(a?a.toArray():null,this.HYg)){this.HYg=a?a.toArray():null;var b=this.iaa.Ii("UserAction","SelectionPane Rendering started");this.JR.renderSelectionPane(gS.a.Fxh,
a.toArray());a=b.er.toString();b.stop();ya.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else ya.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}SEf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||f.isFocussedShape!==l.isFocussedShape||
this.SEf(f.children,l.children))return!0}return!1}r_a(){this.psh();this.ZWa&&(this.KA.isVisible?this.Fa.wj(xa.a.aI,!0):this.Fa.wj(xa.a.aI,!1));this.ZWa=!1}M3e(a,b,c){let f;const l=c.EB.length,y=[];f=!1;for(let G=0;G<l;G++){const R=c.EB[G];R.ShapeId===a&&(2===b?(R.IsHidden=!R.IsHidden,f=R.IsHidden):0===b?f=R.IsHidden=!0:1===b&&(f=R.IsHidden=!1));y.push(R)}return{returnValue:y,O2j:f}}iBi(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=this.Eic.ga(a);if(!c||1>=c.length)ya.a.J(512500429,
801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.WC(c[0]);if(f){var l=!1;a=({O2j:l}=this.M3e(a,2,f)).returnValue;for(const y of c){const G=(c=b.WC(y))?Object(sa.a)(117,c.qc(this.Nz)):null;G&&(l?(G.lla(),this.jb.yX(c)&&this.jb.O8(c)):!l&&G.gAa())}b=this.Fb.yd(15);try{b.jc(f),f.EB=a}finally{b&&b.dispose()}}else ya.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}IEh(a){const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
var c=b.yj(!0),f=[];for(const l of c)if(l.Of){const y=this.Ga.yx(l);f=f.concat.apply(f,y)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.jb.nj(),this.jb.eka(c));for(const l of c)!a&&l.isHiddenShape?Object(sa.a)(117,l.qc(this.Nz)).gAa():a&&!l.isHiddenShape&&Object(sa.a)(117,l.qc(this.Nz)).lla();f=this.Fb.yd(15);try{f.jc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.Eic)if(!b.WC(l.key)){const y=l.value;if(!y||1>=y.length){ya.a.J(512500427,
801,10,"There should be atleast 2 child shapes in the nested group");continue}const G=b.WC(y[0]);G?(c=[],c=a?this.M3e(l.key,0,G).returnValue:this.M3e(l.key,1,G).returnValue,G.EB=c):ya.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&f.dispose()}}}$8k(){this.JR.addCloseSelectionPaneEventListener(()=>{ya.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.KA.isVisible=!1});this.JR.addFocusSelectionPaneListener(()=>
{ya.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.wj(xa.a.aI,!0)});this.JR.addSelectShapeEventListener(a=>{ya.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");(a=b.WC(a))&&(a.isHiddenShape||this.jb.selectShape(a,!0))});this.JR.addSelectMultipleShapesEventListener(a=>{ya.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");
const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");Vg.a("SelectionPaneMultiSelect",ea.a.P6,()=>{if(!a.length){var c=this.jb.Ud();this.jb.eka(c)}c=0;for(const f of a){const l=b.WC(f);l&&!l.isHiddenShape&&(c?this.jb.selectShape(l,!1):(this.jb.selectShape(l,!0),c++))}return 32})});this.JR.addToggleVisibilityListener(a=>{ya.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=
b.WC(a);b="";if(!c||c.Ug||c.Of)b="Group";Vg.b("SelectionPaneToggleVisibilty",b,ea.a.P6,()=>{c?this.q0g.yLl(a):this.iBi(a);return 32})});this.JR.addShapeRenameListener((a,b)=>{ya.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");c=c.WC(a);let f="";if(!c||c.Ug||c.Of)f="Group";Vg.b("SelectionPaneRename",f,ea.a.P6,()=>{this.q0g.Tsl(a,b);return 32})});this.JR.addShapeReorderListener((a,b)=>{ya.a.J(512500419,
822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.WC(a);let l="";if(!f||f.Ug||f.Of)l="Group";else if(c=c.WC(b),!c||c.Ug||c.Of)l="Group";Vg.b("SelectionPaneReorder",l,ea.a.P6,()=>{this.uqk.hBk(a,b);return 32})});this.JR.addShowAllButtonEventListener(()=>{this.ZWa=!0;ya.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");Vg.a("SelectionPaneShowAll",ea.a.P6,()=>{this.IEh(!1);return 32})});
this.JR.addHideAllButtonEventListener(()=>{this.ZWa=!0;ya.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");Vg.a("SelectionPaneHideAll",ea.a.P6,()=>{this.IEh(!0);return 32})});this.JR.addBringForwardButtonEventListener(()=>{this.ZWa=!0;ya.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");Vg.a("SelectionPaneBringForward",ea.a.P6,()=>{this.ia.processAction(ea.a.bringForward,2);return 32})});this.JR.addBringBackwardButtonEventListener(()=>
{this.ZWa=!0;ya.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");Vg.a("SelectionPaneBringBackward",ea.a.P6,()=>{this.ia.processAction(ea.a.sendBackward,2);return 32})});ya.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(m.a)(ON,"SelectionPaneActor",null,[268]);class PN{constructor(a,b,c,f){this.Sea=!1;this.jic="ShapeAlignToSelectedObjects";this.ia=a;this.Eb=c;this.jb=b;this.Z0=f}vb(){ya.a.J(50630811,822,50,"ShapeAlignmentActor::RegisterActions() - OptIn: True");
this.ia.ra(ea.a.wCf,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.KBh,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.rud,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.Ztc,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.sud,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.Wtc,qc.a.application,Object(H.a)(this,
this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.Xtc,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.Ytc,qc.a.application,Object(H.a)(this,this.UUa,"handleShapesAlignment"),4);this.ia.ra(ea.a.WDa,qc.a.application,Object(H.a)(this,this.$hg,"handleShapesDistribution"),4);this.ia.ra(ea.a.U4b,qc.a.application,Object(H.a)(this,this.$hg,"handleShapesDistribution"),4);this.ia.ra(ea.a.DLb,qc.a.application,Object(H.a)(this,this.DLb,"queryShapeAlignToSlide"),96);this.ia.ya(ea.a.Lwc,
qc.a.application,Object(H.a)(this,this.Lwc,"toggleShapeAlignToSlide"));this.ia.ra(ea.a.CLb,qc.a.application,Object(H.a)(this,this.CLb,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(ea.a.Kwc,qc.a.application,Object(H.a)(this,this.Kwc,"toggleShapeAlignToSelectedObjects"))}me(){}Hcc(){return w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp?!0:!1}UUa(a,b,c){if(this.Z0){b=this.jb.Ud();for(const l of b)if(!l.eb(va.a.cWa))return 16}const f=this.jb.Qf();return f?1===c?f.length?32:8:Vg.a("Align",
a,()=>{ya.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],y=1===f.length||this.Sea?this.o2f(a):this.n2f(a,f);if(null===y)return ya.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const G of f)l.push(new Ov(G,this.epj(a,G,y)));if(!l[0].shapeNode.Ug)for(const G of l)this.rk(G.shapeNode).setPosition(G.position.x,G.position.y,!0);this.ia.Ja(ea.a.BJa,2,l);return 32}):(ya.a.J(50598726,822,
10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}DLb(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return ya.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.If(this.Sea);ya.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");return 32}Lwc(a,b,c,f,l){a=this.jb.Qf();if(1===c)return 2>a.length&&(this.Sea=!0,this.jic="ShapeAlignToSlide",ya.a.J(50598736,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),
32;if(!l||"object"!==typeof l)return ya.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.mPh(l)&&(this.Sea=!0,ya.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}CLb(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return ya.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),8;l.If(!this.Sea);ya.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");
return 32}Kwc(a,b,c,f,l){a=this.jb.Qf();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return ya.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.mPh(l)&&(this.Sea=!1,ya.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}epj(a,b,c){let f=null;var l=this.rk(b);b=l.qVc();l=l.Bs();switch(a){case ea.a.rud:ya.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");
f=new cd.a(b.x-l.kc+c,b.y);break;case ea.a.Ztc:ya.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new cd.a(b.x+(c-l.hc),b.y);break;case ea.a.sud:ya.a.J(50598754,822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new cd.a(b.x,b.y-l.mc+c);break;case ea.a.Wtc:ya.a.J(50598784,822,50,"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new cd.a(b.x,b.y+(c-l.Zb));break;case ea.a.Xtc:ya.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");
f=new cd.a(b.x+(c-l.Zf().x),b.y);break;case ea.a.Ytc:ya.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new cd.a(b.x,b.y+(c-l.Zf().y))}return f}$hg(a,b,c){const f=this.jb.Qf();return f?1===c?!f.length||2===f.length&&!this.Sea?8:32:Vg.a("Align",a,()=>{ya.a.J(50902275,822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.$4e(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.Sea?this.o2f(a):this.n2f(a,f);if(null===
l)return ya.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var y=l-this.gzi(a,f);l=this.Qyi(f,y);y=this.Uyi(a,f,y,l);this.RYi(a,f,f.length-1,l,y);return 32}):(ya.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),16)}gzi(a,b){return a===ea.a.WDa?this.hzi(b):this.izi(b)}hzi(a){let b=0;for(const c of a)a=this.rk(c),b+=a.Bs().Zb-a.Bs().mc;return b}izi(a){let b=0;for(const c of a)a=this.rk(c),b+=a.Bs().hc-
a.Bs().kc;return b}Uyi(a,b,c,f){if(1===b.length||this.Sea)return 0<c?f:0;b=this.rk(b[0]);return a===ea.a.WDa?b.Bs().Zb+f:b.Bs().hc+f}Qyi(a,b){return(1===a.length||this.Sea)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}RYi(a,b,c,f,l){var y=0;const G=[];1<b.length&&!this.Sea?(ya.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),y++,c--):ya.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===ea.a.WDa?ya.a.J(50902281,
822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):ya.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");y<=c;y++){const ja=b[y];if(!ja)continue;let za=this.rk(ja);if(za){var R=za.qVc();a===ea.a.WDa?(R=new cd.a(R.x,l),G.push(new Ov(ja,R)),l+=za.Bs().Zb-za.Bs().mc+f):(R=new cd.a(l,R.y),G.push(new Ov(ja,R)),l+=za.Bs().hc-za.Bs().kc+f)}}if(G[0]&&!G[0].shapeNode.Ug)for(const ja of G)this.rk(ja.shapeNode).setPosition(ja.position.x,ja.position.y,!0);
this.ia.Ja(ea.a.BJa,2,G)}o2f(a){const b=Object(sa.a)(424,this.jb.Fk().qc(this.Eb.Na));if(!b)return ya.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",a),null;switch(a){case ea.a.Ztc:case ea.a.U4b:return b.WA.clientWidth;case ea.a.Wtc:case ea.a.WDa:return b.WA.clientHeight;case ea.a.Xtc:return b.WA.clientWidth/2;case ea.a.Ytc:return b.WA.clientHeight/2;default:return ya.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",
a),0}}n2f(a,b){switch(a){case ea.a.rud:var c=Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.min(b.Bs().kc,c);return c;case ea.a.Ztc:c=-Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.max(b.Bs().hc,c);return c;case ea.a.sud:c=Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.min(b.Bs().mc,c);return c;case ea.a.Wtc:c=-Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.max(b.Bs().Zb,c);return c;case ea.a.Xtc:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.rk(c),f=Math.min(b.Bs().kc,
f),l=Math.max(b.Bs().hc,l);return f+(l-f)/2;case ea.a.Ytc:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.rk(f),c=Math.min(b.Bs().mc,c),l=Math.max(b.Bs().Zb,l);return c+(l-c)/2;case ea.a.WDa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.rk(l),c=Math.min(c,b.Bs().mc),f=Math.max(b.Bs().Zb,f);return f-c;case ea.a.U4b:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const y of b)b=this.rk(y),c=Math.min(c,b.Bs().kc),f=Math.max(b.Bs().hc,f);return f-c;default:return ya.a.J(51500960,822,10,
"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}$4e(a,b,c,f){if(!(c>=f)){var l=this.zRk(a,b,c,f);this.$4e(a,b,c,l-1);this.$4e(a,b,l+1,f)}}zRk(a,b,c,f){if(b===ea.a.WDa)return this.BRk(a,c,f);if(b===ea.a.U4b)return this.ARk(a,c,f);ya.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}BRk(a,b,c){var f=this.rk(a[c]).Bs().Zf().y;
let l=b-1;for(;b<=c-1;b++)if(this.rk(a[b]).Bs().Zf().y<f){l++;const y=a[l];a[l]=a[b];a[b]=y}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}ARk(a,b,c){var f=this.rk(a[c]).Bs().Zf().x;let l=b-1;for(;b<=c-1;b++)if(this.rk(a[b]).Bs().Zf().x<f){l++;const y=a[l];a[l]=a[b];a[b]=y}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}mPh(a){const b=a.SourceControlId;return a[Ih.a.On]&&this.jic!==b?(this.Sea="ShapeAlignToSelectedObjects"===this.jic,this.Hcc()&&(a={},a[b]="ToggleButtonModel",a[this.jic]="ToggleButtonModel",Sc.App.Mb.pF(a)),
this.jic=b,!0):!1}rk(a){return a?Object(sa.a)(117,a.qc(this.Eb.Na)):null}}Object(m.a)(PN,"ShapeAlignmentActor",null,[268]);var QN=d(510),hS=d(979);class iy{}Object(m.a)(iy,"CT_NoFillProperties",null,[]);var iS=d(980);class hA{constructor(a,b){this.IJl=a;this.Wvc=b}}Object(m.a)(hA,"FormatPainterData",null,[]);var RN=d(748);class vi{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie){this.FHl="data:image/svg+xml;charset=utf8,";this.LQe=96;this.ia=a;this.pa=G;this.le=f;this.Fb=c;this.Fa=
b;this.pD=l;this.fc=y;this.gBe=ja;this.FJ=R;this.yDe=Va;this.FMg=(a=!jc||!jc.isInHighContrastMode)&&ec.Sne;this.cY=ec.powerPointGraphicToolTabIsEnabled;this.bDe=a&&ec.svgIconLocalEditingIsEnabled;this.khb=za;this.Nz=Ie;this.Ga=hb;this.jR=Cb;this.LU=lc;this.Ub=ic;this.ua=yc;this.zc=xd;this.Wp=ec.pptTextFormatPainterIsEnabled;this.rGg=ec.formatPainterApplyRemappedIsEnabled;this.sMg=ec.a4c;this.zfb=ec.xWk;this.BU=ec.KKb;this.la=ec;this.lj=Xd;this.dic=new Eb.ScriptSharpLegacyMap;this.MA=Qd}vb(){this.ia.ra(ea.a.cRe,
qc.a.application,Object(H.a)(this,this.mHj,"handlePopulateShapeFillMenu"),96);this.ia.ra(ea.a.yKe,qc.a.application,Object(H.a)(this,this.hGj,"handleMoreFillColors"),96);this.ia.ra(ea.a.zKe,qc.a.application,Object(H.a)(this,this.mGj,"handleMoreOutlineColors"),96);this.ia.ra(ea.a.JCa,qc.a.application,Object(H.a)(this,this.xgg,"handleApplyShapeFillColor"),4);this.ia.ra(ea.a.B0b,qc.a.application,Object(H.a)(this,this.bDj,"handleApplyShapeFillCustomColor"),4);this.ia.ra(ea.a.ytb,qc.a.application,Object(H.a)(this,
this.xgg,"handleApplyShapeFillColor"),4);this.ia.ra(ea.a.aqd,qc.a.application,Object(H.a)(this,this.Ihg,"handleRemoveShapeFill"),4);this.ia.ra(ea.a.KWe,qc.a.application,Object(H.a)(this,this.Ihg,"handleRemoveShapeFill"),4);this.ia.ra(ea.a.Vmd,qc.a.application,Object(H.a)(this,this.nHj,"handlePopulateShapeOutlineMenu"),96);this.ia.ra(ea.a.oja,qc.a.application,Object(H.a)(this,this.ygg,"handleApplyShapeOutlineColor"),4);this.ia.ra(ea.a.C0b,qc.a.application,Object(H.a)(this,this.cDj,"handleApplyShapeOutlineCustomColor"),
4);this.ia.ra(ea.a.ztb,qc.a.application,Object(H.a)(this,this.ygg,"handleApplyShapeOutlineColor"),4);this.ia.ra(ea.a.bRa,qc.a.application,Object(H.a)(this,this.gDj,"handleApplyShapeOutlineWidth"),4);this.ia.ra(ea.a.K7a,qc.a.application,Object(H.a)(this,this.dDj,"handleApplyShapeOutlineDashStyle"),4);this.sMg&&this.ia.ra(ea.a.L7a,qc.a.application,Object(H.a)(this,this.fDj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.ra(ea.a.pja,qc.a.application,Object(H.a)(this,this.eDj,"handleApplyShapeOutlineEndStyle"),
4);this.ia.ra(ea.a.bqd,qc.a.application,Object(H.a)(this,this.Jhg,"handleRemoveShapeOutline"),4);this.ia.ra(ea.a.LWe,qc.a.application,Object(H.a)(this,this.Jhg,"handleRemoveShapeOutline"),4);this.ia.ra(ea.a.CTa,qc.a.application,Object(H.a)(this,this.SJj,"handleToggleFormatPainterActive"),4);this.ia.ra(ea.a.Dka,qc.a.application,Object(H.a)(this,this.TCj,"handleApplyFormat"),4);this.ia.ra(ea.a.V9d,qc.a.application,Object(H.a)(this,this.UCj,"handleApplyFormatToShape"),5);this.ia.ra(ea.a.hod,qc.a.application,
Object(H.a)(this,this.FHj,"handleQueryFormatPainter"),97);this.ia.ra(ea.a.RKb,qc.a.application,Object(H.a)(this,this.tHj,"handlePreviewShapeFillColor"),4);this.ia.ra(ea.a.WMb,qc.a.application,Object(H.a)(this,this.FIj,"handleRevertPreviewShapeFillColor"),4)}me(){const a=this.Fa.Ic(xa.a.qg);a.bindAction(x.KeyInputManager.Va(B.a.tAa,6),ea.a.CTa);const b=this.Fa.Ic(xa.a.DQ);let c=x.KeyInputManager.Va(B.a.tAa,6);b.hw(c);this.Wp?b.bindAction(c,C.a.qUc):b.bindAction(c,ea.a.CTa);ya.a.J(512500379,815,50,
"formatPainterApplyRemapped: {0}",this.rGg);this.rGg||(c=x.KeyInputManager.Va(B.a.r3a,6),a.bindAction(c,ea.a.Dka),b.hw(c),this.Wp?b.bindAction(c,ea.a.W9d):b.bindAction(c,ea.a.Dka))}wyb(a,b){const c=[];if(a)for(const f of a)(f.Rua||b&&f.get_isSVGBlipFilled()||f.tj||this.BU&&1===f.mediaType)&&Array.add(c,f);return c}fab(a,b){const c=[];if(a)for(const f of a)(f.Rua&&!f.wz||b&&f.get_isSVGBlipFilled()||this.zfb&&f.xd)&&Array.add(c,f);return c}mHj(a,b,c,f,l){if(!this.pa.F4()||this.fc.dD(this.pa.Ud()))return 16;
if(1===c)return 32;if(!l)return 8;b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.fda;b=(c=this.pa.Ll())?b.XC(c.slideId):null;if(!b)return 16;var y=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=y?ea.a.ytb:ea.a.JCa;f=y?ea.a.KWe:ea.a.aqd;const G=ea.a.yKe;if(l.MenuId&&"fill"===l.MenuId){var R=new RN.a(b.Fd);y=new Sys.StringBuilder;y.append(String.format(vi.IIf,"PptRibbon.Drawing.ShapeFill"));if(!b.Fd)return 8;y.append(R.Qfe(c,a,ea.a.B0b));y.append(vi.OIf);y.append(String.format(vi.MIf,
f,w.AFrameworkApplication.km,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));y.append(vi.NIf);y.append(vi.Gxi);y.append(String.format(vi.Exi,G,w.AFrameworkApplication.km,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));y.append(vi.Fxi);y.append(vi.HIf);l.PopulationXML=y.toString()}else{R=Object.assign(new bo.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const ja=y?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",za=y?"GraphicNoFill":
"ShapeNoFill";Array.add(R.MenuSectionList,jl.f(b.Fd,LE.a.themeColors,"Color.Menu.Controls","themeColor",y?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(R.MenuSectionList,jl.d("Standard Colors","Color.Menu.Controls","standardColor",ja,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(R.MenuSectionList,jl.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors",
"3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(R.MenuSectionList,jl.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",za,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(R.MenuSectionList,jl.a("More Fill Color","Color.Menu.Controls",G.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",
CommonUIStrings.l_MoreFillColorsKeytip));qd.a("ColorPickerHighlighterFix")&&(a=this.tuj(b.Fd),jl.h(R,a,b.Fd));l.MenuItems=R}return 32}nHj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.pa.F4()||this.fc.dD(this.pa.Ud()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.pa.Ll())?a.XC(c.slideId):null;if(!c||!c.Fd)return 8;a=a.fda;var y=this.le.qk("pegal.png"),G=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=G?ea.a.ztb:ea.a.oja;f=G?ea.a.LWe:ea.a.bqd;
const R=ea.a.zKe;if(l.MenuId&&"outline"===l.MenuId){var ja=new Sys.StringBuilder;ja.append(String.format(vi.IIf,"PptRibbon.Drawing.ShapeOutline"));c=new RN.a(c.Fd);ja.append(c.Qfe(b,a,ea.a.C0b));ja.append(vi.OIf);ja.append(String.format(vi.MIf,f,w.AFrameworkApplication.km,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));ja.append(vi.NIf);ja.append(vi.Jxi);ja.append(String.format(vi.Hxi,R,w.AFrameworkApplication.km,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));
ja.append(vi.Ixi);c=this.pa.Ud();a=vi.Vtj(c,this.cY);if(!a||!a.length||c&&c.length!==a.length)ja.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.$Kc,ea.a.bRa,w.AFrameworkApplication.km,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,y,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.XKc,ea.a.K7a,w.AFrameworkApplication.km,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,y,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.sMg&&ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.ZKc,ea.a.L7a,w.AFrameworkApplication.km,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,y,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),ja.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ea.a.YKc,ea.a.pja,w.AFrameworkApplication.km,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,y,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),ja.append("</Controls></MenuSection>");
ja.append(vi.HIf);l.PopulationXML=ja.toString()}else{y=G?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";ja=G?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const za=G?"GraphicNoOutline":"ShapeNoOutline";G=Object.assign(new bo.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(G.MenuSectionList,jl.f(c.Fd,"Theme Colors","Color.Menu.Controls","themeColor",y,b.toString(),1));Array.add(G.MenuSectionList,jl.d("Standard Colors","standardColor","Standard Colors",
ja,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(G.MenuSectionList,jl.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(G.MenuSectionList,jl.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
za,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(G.MenuSectionList,jl.a("More Outline Color","Color.Menu.Controls",R.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));qd.a("ColorPickerHighlighterFix")&&(a=this.suj(c.Fd),jl.h(G,a,c.Fd));l.MenuItems=G}return 32}tHj(a,b,c,f,l){if(!l)return ya.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.Dpc)return 2;b=this.pa.Qf();const y=this.fab(b,this.cY);return y&&y.length?this.zfb&&1===y.length&&y[0].xd?(ya.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):Vg.a("HandlePreviewShapeFillColor:",a,()=>{const G=this.pa.tP(y),R=this.FJ.vS(l),ja=Object.assign(new QN.a,{});ja.solidFillField=R;for(const za of G)za?za.xd||(this.dic.Gb(za.get_shapeId())?this.dic.$(za.get_shapeId(),za.fill):this.dic.add(za.get_shapeId(),za.fill),za.fill=
ja,za.Gga=null):ya.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",za.get_shapeId());return 32}):(ya.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}FIj(a,b,c,f,l){if(!l)return ya.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.Dpc)return 2;a=this.pa.Qf();a=this.fab(a,this.cY);if(!a||!a.length)return ya.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.zfb&&1===a.length&&a[0].xd)return ya.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.pa.tP(a);for(const y of a)if(!y)ya.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",y.get_shapeId());else if(!y.xd)if(this.dic.Gb(y.get_shapeId()))y.fill=this.dic.ga(y.get_shapeId()),y.Gga=null;else return ya.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}xgg(a,b,c,f,l){var y=this.ua.presentation;if(!y)throw Error.argumentNull("Presentation is null");f=this.pa.Qf();b=this.fab(f,this.cY);const G={type:"ColorPickerPayload",color:""};l&&(G.color=l.Color);if(!(b&&0<b.length||this.pa.dM()&&this.fug(f[0],a,G))||this.fc.dD(b))return 16;const R=this.pa.Ll();y=R?y.XC(R.slideId):null;if(!y||!y.Fd||!y.Fd.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.zfb&&1===b.length&&b[0].xd)return ya.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.Ja(ea.a.w6,c,l);c=vi.Uld(l);if(!c)return 8;1<f.length?ya.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):ya.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var ja of f)if(ja.Of||ja.Ug){On(ja);break}if(this.pa.dM()&&this.fug(f[0],a,G)&&this.wge(f[0],a,G))return 32;ja=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{ja.jc(b[0]);ja.gd=a;const za=this.FJ.vS(l),Va=this.pa.tP(b);
for(const hb of Va)if(hb.xd){if(!this.zfb)continue;ya.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const Cb=this.zc.eO(hb);if(!Cb){ya.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const lc=Cb.Kab();for(const ic of lc){const yc=ic.cellShading;up.b(yc);yc.solidFillField=za;ic.cellShading=yc}}else{const Cb=this.NZf(hb);Cb&&(this.FJ.XSa(Cb),Cb.solidFillField=za,hb.fill=Cb,hb.Gga=null,this.iRh(hb,Cb));hb.Pga=JSON.stringify(c);this.LNb(hb)}}finally{ja&&
ja.dispose()}return 32}hGj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.renderColorPicker,1,l);a=this.ruj();b={};b.currentColor=a;b.handleCommand=ea.a.B0b;return this.ia.Ja(ea.a.renderColorPicker,2,b)}bDj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.JCa,c,l);if(!l)return ya.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.Ja(ea.a.JCa,c,l);32===a&&this.ia.Ja(ea.a.xCa,c,l);return a}mGj(a,b,c,f,l){a=this.pa.Qf();a=qd.a("FixColorPickerPictureBorderColor")?this.wyb(a,
this.cY):this.fab(a,this.cY);a=this.pa.tP(a);if(1===c)return this.ia.Ja(ea.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].lva&&(c=Hf.Box4ColorHelper.Ita(a[0].lva));l={};l.currentColor=c;l.handleCommand=ea.a.C0b;return this.ia.Ja(ea.a.renderColorPicker,2,l)}Ihg(a,b,c,f,l){f=this.pa.Qf();b=this.fab(f,this.cY);const y=!!b&&0<b.length;if(this.fc.dD(b))return 16;if(1===c)return y?32:8;if(!y)return 16;1<f.length?ya.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",
f.length):ya.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.zfb&&1===b.length&&b[0].xd)return ya.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.Ja(ea.a.EKa,c,l);c=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{c.jc(b[0]);c.gd=a;const G=this.pa.tP(b);for(const R of G)if(R.xd){if(!this.zfb)continue;ya.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const ja=this.zc.eO(R);if(!ja){ya.a.J(512500353,
815,10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const za=ja.Kab();for(const Va of za){const hb=Va.cellShading;up.b(hb);hb.noFillField=new iy;Va.cellShading=hb}}else{const ja=this.NZf(R);ja&&(this.FJ.XSa(ja),ja.noFillField=new iy,R.fill=ja,R.Gga=null,this.iRh(R,ja));R.w$k();this.LNb(R)}}finally{c&&c.dispose()}return 32}ygg(a,b,c,f,l){var y=this.ua.presentation;if(!y)throw Error.argumentNull("Presentation is null");f=this.pa.Qf();b=this.wyb(f,this.cY);if(!(b&&0<b.length)||this.fc.dD(b))return 16;
const G=this.pa.Ll();y=G?y.XC(G.slideId):null;if(!y||!y.Fd||!y.Fd.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=vi.Uld(l);if(!c)return 8;1<f.length?ya.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):ya.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var R of f)if(R.Of||R.Ug){On(R);break}R=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{R.jc(b[0]);
R.gd=a;const ja=this.pa.tP(b);for(const za of ja){const Va=this.V6d(za);if(Va){this.FJ.XSa(Va);const hb=this.FJ.vS(l);Va.solidFillField=hb;za.lineStyle=Va;za.lva=null;this.Nzd(za,Va)}za.Bpa=JSON.stringify(c);this.LNb(za)}}finally{R&&R.dispose()}return 32}cDj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.oja,c,l);if(!l)return ya.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.Ja(ea.a.oja,c,l);32===a&&this.ia.Ja(ea.a.xCa,c,l);return a}gDj(a,b,c,f,l){f=this.pa.Qf();
b=this.wyb(f,this.cY);if(!(b&&0<b.length)||this.fc.dD(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.CYc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=vi.iwh.length||0>c)return 8;1<f.length?ya.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):ya.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{l.jc(b[0]);
l.gd=a;const y=this.pa.tP(b);for(const G of y){const R=this.V6d(G);R&&(R.wField=vi.gjl[c],R.wFieldSpecified=!0,this.Nzd(G,R),this.EZf(R),G.lineStyle=R);G.outlineWidth=vi.iwh[c];this.LNb(G)}}finally{l&&l.dispose()}return 32}LNb(a){this.Ga.cM(a)&&Kc.a.Kb&&(Kc.a.Kb.Qj=!0)}NZf(a){if(!this.FMg)return null;let b=a.fill;b||!a.cM&&!a.get_isSVGBlipFilled()||(b=new QN.a);return b}V6d(a){var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.FMg)return null;let c=a.lineStyle;
if(this.bDe&&a.I3c()&&c&&c.wFieldSpecified){b=Object(sa.a)(116,b.XC(a.slideId));var f=this.lj.$G;b&&b.lx&&null!=b.lx.ps&&(f=b.lx.ps);b=c.wField/f;f=this.P8b(a);if(!f||!f.kRa||!f.pLc)return c.wField=b,c;var l;(l=f.Dk&&f.Dk.AH&&f.Dk.AH.WL()&&1===f.Dk.AH.xa.childNodes.length?f.Dk.AH.xa.childNodes[0].getAttribute("width"):f.kRa.getAttribute("width"))&&!na.a.Xa(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.Hri*f.pLc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.cM&&!a.get_isSVGBlipFilled()||
(c=new hS.a);return c}EZf(a){if(a.noFillField||up.e(a))a.noFillField=null,a.solidFillField=Object.assign(new cv.a,{schemeClrField:Object.assign(new ci.a,{valField:1})})}dDj(a,b,c,f,l){f=this.pa.Qf();b=this.wyb(f,this.cY);if(!(b&&0<b.length)||this.fc.dD(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.CYc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?ya.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):ya.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{l.jc(b[0]);l.gd=a;const y=this.pa.tP(b);for(const G of y){const R=this.V6d(G);R&&(R.prstDashField=R.prstDashField||new iS.a,R.prstDashField.valField=this.Rrj(c),R.prstDashField.valFieldSpecified=!0,R.custDashField=null,this.Nzd(G,R),this.EZf(R),G.lineStyle=R);G.WM=c;this.LNb(G)}}finally{l&&l.dispose()}return 32}Rrj(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}eDj(a,b,c,f,l){f=this.pa.Qf();b=vi.Anj(f);if(!(b&&0<b.length)||this.fc.dD(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.CYc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=vi.Vvh.length)return 8;c=vi.Vvh[l];l=vi.cjl[l];1<f.length?ya.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):ya.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{f.jc(b[0]);f.gd=a;const y=this.pa.tP(Array.isArray(b)?b:null);for(const G of y)G.Usl(c,l)}finally{f&&f.dispose()}return 32}Jhg(a,b,c){const f=this.pa.Qf();b=this.wyb(f,this.cY);if(!(b&&0<b.length)||this.fc.dD(b))return 16;if(1===c)return 32;1<f.length?ya.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):ya.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{c.jc(b[0]);c.gd=a;const l=this.pa.tP(b);for(const y of l){const G=y.lineStyle;G&&(this.FJ.XSa(G),G.noFillField=new iy,y.lineStyle=G,y.lva=null,this.Nzd(y,G));y.cal();this.LNb(y)}}finally{c&&c.dispose()}return 32}fDj(a,b,c,f,l){f=this.pa.Qf();b=this.wyb(f,this.cY);if(!(b&&0<b.length)||vi.sll(f))return 8;if(this.fc.dD(b))return 16;if(1===c)return 32;if(!l)return ya.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.CYc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return ya.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?ya.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):ya.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{l.jc(b[0]);l.gd=a;for(const y of b)y.joc=c,
y.setValue(va.a.Lcc,!0)}finally{l&&l.dispose()}return 32}SJj(a,b,c){b=this.pa.Qf();a=this.pa.Ll();if(!(this.pD.isActive||1===b.length&&a&&a.IIh||this.Wp&&this.pa.Lla()))return 16;if(1===c)return 32;if(this.fc.fd(a))return 16;c=32;if(this.pD.isActive)this.pD.zRa();else if(this.Wp)if(this.jR.TL)this.jR.TL=!1;else{b=this.pa.Pa.nb;var f=null;if(b&&(f=b.Ua)&&(f.contextId===rb.a.Mf||f.contextId===rb.a.textRange||f.contextId===rb.a.endOfParagraph||f.contextId===rb.a.paragraph))c=this.ia.processAction(C.a.qUc,
2);else if(a.xd&&this.pa.u0(this.pa.Pa)){if(b=a.lzb())if(b=b.ff(0,0)){b.Npl(this.jR);var l=b.M6b;f=-1;l&&(f=zb.ParagraphReader.textLength(Object(sa.a)(Ig.a,l))+1);if(l=this.Ub.Di){const y=this.Fb.ke(4),G=l.Fi;y.jc(l);const R=this.LU.ZEa(G),ja=Object(sa.a)(116,this.gBe.idg(b));this.LU.vaf(R,!0,!1,ja,a,b,null,0,f);(a=G.Xpc(R))&&l.SCb(a);y.dispose()}}}else this.pD.dih(a)}else this.pD.dih(a);Sc.App.Mb.updateCommandUI();return c}TCj(a,b,c){return this.Wp&&(a=this.pa.Pa.nb)&&(a=a.Ua)&&(a.contextId===rb.a.Mf||
a.contextId===rb.a.textRange||a.contextId===rb.a.endOfParagraph||a.contextId===rb.a.paragraph)?(this.pD.zRa(),this.ia.processAction(ea.a.W9d,2)):(a=this.pa.Ll())?this.ia.Ja(ea.a.V9d,c,new hA(this.pD.HJl,a)):16}UCj(a,b,c,f,l){if(!l||!Object(Sa.a)(hA,l))return ya.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.Wp&&this.jR.TL)return this.jR.TL=!1,16;b=l.Wvc;if(!(this.pD.isActive&&b&&b.HIh))return this.pD.zRa(),16;if(this.fc.fd(b))return 16;if(1===
c)return 32;Kc.a.Kb&&(Kc.a.Kb.Qj=!1,Kc.a.Kb.actionName="FormatPainterApplyToShape",Kc.a.Kb.$p=!0);c=this.Fb.yd(15,void 0,()=>{this.pa.nj();this.Fa.Bd()});try{c.jc(l.Wvc),c.gd=a,l.Wvc.Dxb=l.IJl.id}finally{c&&c.dispose()}this.pD.zRa();return 32}FHj(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return 8;l.If(this.pD.isActive||(this.Wp?this.jR.TL:!1));return 32}r_k(a,b,c){return(a=this.P8b(a))&&Object(Sa.a)(ht.a,a.Dk)&&(a=Object(sa.a)(ht.a,a.Dk))?a.pTe(ea.a.uy(b),c):!1}wge(a,b,c){return(a=this.P8b(a))&&Object(Sa.a)(ht.a,
a.Dk)&&(a=Object(sa.a)(ht.a,a.Dk))?a.Poc(ea.a.uy(b),c):!1}CYc(a){return a.split(",")[1]}iRh(a,b){if(this.bDe&&a.I3c()){var c=this.P8b(a),f=this.EPf(c,a);a=b.noFillField?null:this.YH(b,a);f=this.khb.PPl(f,a);this.nDf(c,f)}}Nzd(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.bDe&&a.I3c()){var f=this.P8b(a),l=this.EPf(f,a);if(null!==l){if(b.noFillField)l=this.khb.fOh(l);else{if(b.wFieldSpecified){var y=Object(sa.a)(116,c.XC(a.slideId)),G=this.lj.$G;y&&y.lx&&
null!=y.lx.ps&&(G=y.lx.ps);l=this.khb.gOh(l,b.wField,f.nd,G)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.khb.QPl(l,b.prstDashField.valField));if(b.solidFillField){b=this.YH(b,a);l=this.khb.fOh(l,b);if(!l)return;b=l.querySelectorAll(this.khb.D6e);y=!0;for(G=0;G<b.length;++G){const R=b[G].getAttribute("stroke-width");if(R&&!na.a.Xa(R.toString())){y=!1;break}}y&&(a=Object(sa.a)(116,c.XC(a.slideId)),c=this.lj.$G,a&&a.lx&&null!=a.lx.ps&&(c=a.lx.ps),l=this.khb.gOh(l,Oe.a.TQe/this.LQe,f.nd,
c))}}this.nDf(f,l)}}}YH(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.XC(b.slideId);return this.FJ.LMb(a,b.Fd)}nDf(a,b){if(b&&a&&a.Dk){a.Dk.v_.Sd(!1);var c=a.Dk.AH.xa.childNodes;for(let f=0;f<c.length;++f)a.Dk.AH.xa.removeChild(c[f]);a.Dk.AH.xa.appendChild(b);(b=a.kRa.getAttribute("transform"))&&a.Dk.AH.xa.setAttribute("transform",b.toString());a.Dk.AH.Sd(!0);Kc.a.Kb&&(Kc.a.Kb.Qj=!0,Kc.a.Kb.HF=new Date)}}fug(a,b,c){return qd.a("EnableSmartArtFillColor")&&
this.r_k(a,b,c)}ruj(){var a=this.pa.Qf();a=this.fab(a,this.cY);var b=this.pa.tP(a),c=null;a=null;qd.a("FixColorPickerSelectedColor")&&(a=this.ua.Ba);if(1===b.length){if(b[0].Gga)c=Hf.Box4ColorHelper.Ita(b[0].Gga);else if(b[0].xd&&qd.a("FixColorPickerSelectedColor")){const f=this.pa.Fv();if(!f||!f.length){if(b=this.pa.zn())b=b.ff(0,0),c=Hf.Box4ColorHelper.GEa(b.cellShading.solidFillField,a.Fd);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?Hf.Box4ColorHelper.GEa(c.cellShading.solidFillField,
a.Fd):this.MA.kVc(Object(sa.a)(Ig.a,c))}!c&&qd.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=Hf.Box4ColorHelper.GEa(b[0].fill.solidFillField,a.Fd))}return c}yLl(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.WC(a).isHiddenShape;this.Wsl(a,b)}xLl(a,b){a.isHiddenShape=!b;const c=Object(sa.a)(117,a.qc(this.Nz));b?c.gAa():(c.lla(),this.pa.yX(a)&&this.pa.O8(a))}Wsl(a,b){const c=this.Fb.yd(15,void 0,()=>{this.pa.nj()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.WC(a);c.jc(l);this.xLl(l,b)}finally{c&&c.dispose()}}Tsl(a,b){const c=this.Fb.yd(15,void 0,()=>{this.pa.nj()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.WC(a);c.jc(l);l.shapeName=b}finally{c&&c.dispose()}}puj(){var a=this.pa.Qf();a=this.fab(a,this.cY);return this.pa.tP(a)}tuj(a){const b=this.puj();return b&&1===b.length?b[0].xd?this.MA.P6f(this.pa.Fv()):b[0].fill&&b[0].fill.solidFillField?Hf.Box4ColorHelper.GEa(b[0].fill.solidFillField,a):null:
null}suj(a){const b=this.pa.Qf();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?Hf.Box4ColorHelper.GEa(b[0].lineStyle.solidFillField,a):null}P8b(a){return a?Object(sa.a)(117,a.qc(this.Nz)):null}EPf(a,b){try{if(!(a&&a.kRa&&a.Dk&&a.Dk.AH))return null;if(a.Dk.AH.WL()){if(!a.Dk.AH.xa)return null;const l=a.Dk.AH.xa.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.kRa.getAttribute(gj.a.Y$b))return null;let c=a.kRa.getAttribute(gj.a.Y$b).toString();
if(!c.toLowerCase().startsWith(this.FHl))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.yDe.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.gVa=!0,null)}catch(c){return ya.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static Vtj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static Anj(a){if(!a)return null;const b=[];for(const c of a)c.wz&&
Array.add(b,c);return b}static sll(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static Uld(a){return Cu.a.parse(a.Color)}}vi.iwh=[.5,1,2.25,4.5];vi.gjl=[6350,12700,28575,57150];vi.Vvh=[0,0,2,2,0,1,1];vi.cjl=[0,2,0,2,1,0,1];vi.IIf='<Menu Id="{0}">';vi.OIf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';vi.MIf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
vi.NIf="</Controls> </MenuSection>";vi.Gxi='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';vi.Exi='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';vi.Fxi="</Controls> </MenuSection>";vi.Jxi='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';vi.Hxi='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
vi.Ixi="</Controls> </MenuSection>";vi.HIf="</Menu>";Object(m.a)(vi,"ShapesFormatActor",null,[268]);var vj=d(231);class Di{constructor(a,b,c){this.Ged=Array(Di.EW);this.vbd=Array(Di.EW);this.Bue=Array(Di.EW);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.NJ=a;this.Pm=b;this.sgd=c;this.Lwa={}}dispose(){Array.clear(this.Ged);Array.clear(this.vbd);this.Pm=this.NJ=null;const a=ta.a.JL(this.Lwa);
a.length&&appChrome.api.unregisterIcons(a);this.Lwa=null}get mj(){return this.NJ.MasterId}B8b(a,b,c){const f=Object.assign(new bo.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new el.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var y=c?"GraphicsStyleSection":"ApplyShapeStyleSection",G=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";y=
Object.assign(new Hq.a,{Id:"ControlsShapeStyles",ExternalId:y,ExternalGalleryId:G,Type:4,Width:Di.EW,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,y);l=Di.EW*(a?Di.gIf:Di.kIf);c&&(l=Di.EW*Di.jIf);for(G=0;G<l;++G){const R=c?"ApplyGraphicsStyle"+G:"ApplyShapeStyle"+G;Array.add(y.GalleryItems,c?this.q$d(R,G,a,b,!0):this.q$d(R,G,a,b,!1))}return f}q$d(a,b,c,f,l){if(l){var y=this.NJ?this.NJ.SVGStyles[b]:null;c="SVGStyle";y=y?y.ToolTip:""}else y=this.NJ?this.NJ.ShapeStyles[b]:
null,c=c?"LineStyle":"ShapeStyle",y=y?this.pee(y.StyleId):"";return Object.assign(new lE.a,{Id:a,ExternalId:a,Icon:Di.C8b(c,f,b),PreviewIconStyle:Di.Trj(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:y})}Jpd(a){this.addIconToMap(this.NJ.ShapeStyles,"ShapeStyle");this.addIconToMap(this.NJ.LineStyles,"LineStyle");a&&this.addIconToMap(this.NJ.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.Lwa)}bvj(a){if(a<Di.EW&&this.Ged[a])return this.Ged[a];if(a>=
this.NJ.ShapeStyles.length)return"";var b=this.NJ.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.pee(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.Xae(this.sgd.resolve(Yg.a.Gwb,
b.Icon.ImgId,"StyleGallery")),l,f);a<Di.EW&&(this.Ged[a]=b);return b}Ttj(a){if(a<Di.EW&&this.Bue[a])return this.Bue[a];if(a>=this.NJ.SVGStyles.length)return"";var b=this.NJ.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),
l=this.scg(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.Xae(this.sgd.resolve(Yg.a.Gwb,b.Icon.ImgId,"StyleGallery")),l,f);a<Di.EW&&(this.Bue[a]=b);return b}ynj(a){if(a<Di.EW&&this.vbd[a])return this.vbd[a];if(a>=this.NJ.LineStyles.length)return"";var b=this.NJ.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-
b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.K$f(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.Xae(this.sgd.resolve(Yg.a.Gwb,b.Icon.ImgId,"StyleGallery")),l,f);a<Di.EW&&(this.vbd[a]=b);return b}pee(a){let b=null;switch(parseInt(String(a/Di.EW))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;
break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,ZKh:c}=this.k7f(a));return String.format(b,a.toString(),c)}scg(a){return(a=this.NJ?this.NJ.SVGStyles[a]:null)?a.ToolTip:""}K$f(a){let b=null;switch(parseInt(String(a/Di.EW))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;
break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,ZKh:c}=this.k7f(a));return String.format(b,a.toString(),c)}Xae(a){return null===a?"":na.a.I$b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=Di.C8b(b,this.mj,f),y={},G={};G.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);G.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);G.position="absolute";y.root=G;c=appChrome.buildImageIconFromUrl(this.sgd.resolve(Yg.a.Gwb,c.Icon.ImgId,"StyleGallery"),y);this.Lwa[l]=
c}}k7f(a){let b,c;c=b=null;a%=Di.EW;switch(a){case 0:b=vj.Color.fj(this.Pm.Dark1);c=String.format(ResourceStrings.l_DarkFormat,1);break;case 1:b=vj.Color.fj(this.Pm.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=vj.Color.fj(this.Pm.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=vj.Color.fj(this.Pm.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=vj.Color.fj(this.Pm.Accent4);c=String.format(ResourceStrings.L_AccentFormat,
a);break;case 5:b=vj.Color.fj(this.Pm.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=vj.Color.fj(this.Pm.Accent6),c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,ZKh:c}}static get Nsi(){return Di.Fil}static get Lsi(){return Di.Dil}static get Msi(){return Di.Eil}static Trj(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;
return a}static V$d(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');a*=Di.EW;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?ea.a.z0b:ea.a.Ctb,b?ea.a.Vnd:ea.a.xod));c.append("</Gallery> </MenuSection>");c.append("</Menu>");
return c.toString()}static C8b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}Di.EW=7;Di.kIf=6;Di.jIf=4;Di.gIf=3;Di.Fil=Di.V$d(Di.kIf,!1);Di.Eil=Di.V$d(Di.gIf,!1);Di.Dil=Di.V$d(Di.jIf,!0);Object(m.a)(Di,"StyleGalleryBuilder",null,[108]);class SN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.AHb="";this.xEb=[];this.ia=a;this.qq=b;this.qf=c;this.Fa=l;this.Fb=f;this.Wu=y;this.TGb=G;this.pa=R;this.Ga=ja;this.Ya=za;this.cY=Va;hb.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.Ya.hBf(Object(H.a)(this,
this.Qkd,"onSessionInfoChanged"))}vb(){this.ia.ra(ea.a.xod,qc.a.application,Object(H.a)(this,this.IHj,"handleQueryShapesStyle"),97);this.ia.ra(ea.a.dRe,qc.a.application,Object(H.a)(this,this.oHj,"handlePopulateShapesStyles"),96);this.ia.ra(ea.a.Ctb,qc.a.application,Object(H.a)(this,this.hDj,"handleApplyShapesStyle"),4);this.ia.ra(ea.a.Vnd,qc.a.application,Object(H.a)(this,this.GHj,"handleQueryGraphicsStyle"),97);this.ia.ra(ea.a.aRe,qc.a.application,Object(H.a)(this,this.lHj,"handlePopulateGraphicsStyles"),
96);this.ia.ra(ea.a.z0b,qc.a.application,Object(H.a)(this,this.WCj,"handleApplyGraphicsStyle"),4)}me(){}GHj(a,b,c,f,l){return this.K_f(l,!0)}IHj(a,b,c,f,l){return this.K_f(l,!1)}K_f(a,b){var c=this.qq.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(!a||!Object(Sa.a)(Xv,a))return 8;var f=a.sV.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.sV.substr(f.length));if(isNaN(f)||0>f)return ya.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",
b?"Graphics":"Shapes"),8;var l=this.pa.Qf();if(!l||!l.length)return 16;const y=a.p0a;if(!y)return 8;var G=c.XC(l[0].slideId);if(!G)return 16;c=G.mj;G=this.z9f(G);a.sV.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.AHb=(l=this.d0b(l))?"SGT_Line":"SGT_Shape",y.j4=G?G.q$d(a.sV,f,l,c,b?!0:!1):null):G?(this.d0b(l)?(this.AHb="SGT_Line",y.CEa=G.ynj(f),y.Pxb=G.K$f(f)):b?(this.AHb="SGT_SVG",y.CEa=G.Ttj(f),y.Pxb=G.scg(f)):(this.AHb="SGT_Shape",y.CEa=G.bvj(f),y.Pxb=G.pee(f)),y.qV(!1)):(y.CEa="",
y.Pxb="");return 32}lHj(a,b,c,f,l){return this.I_f(c,l,!0)}oHj(a,b,c,f,l){return this.pa.GVa()?8:this.I_f(c,l,!1)}I_f(a,b,c){var f=this.qq.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return ya.a.J(509678937,822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.pa.Qf();f=a[0]?f.XC(a[0].slideId):null;const l=this.z9f(f);if(b.MenuId&&"style"===b.MenuId)this.d0b(a)?b.PopulationXML=Di.Msi:b.PopulationXML=c?Di.Lsi:Di.Nsi;
else{this.AHb=(a=this.d0b(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.B8b(a,f.mj,c?!0:!1):null}return 32}WCj(a,b,c,f,l){if(qd.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.uuj().length)return 8}else if(!this.Ga.zvc(this.pa.Qf()))return 16;return this.zgg(a,c,l,!0)}uuj(){var a=this.pa.Ud();const b=[];let c=!1;for(const f of a){if(!f)return b.length=0,b;f.Ug&&(c=!0)}if(c)for(const f of a)f.Ug&&this.Ga.zvc([f])&&b.push(f);else for(const f of a)if(this.Ga.zvc([f]))b.push(f);
else if(f.Of){a=this.Ga.yx(f);for(const l of a)this.Ga.zvc([l])&&b.push(l)}return b}hDj(a,b,c,f,l){return this.Avl(this.pa.Qf())?this.zgg(a,c,l,!1):16}zgg(a,b,c,f){var l=this.qq.presentation;if(!l)throw Error.argumentNull("Presentation is null");const y=this.pa.Qf();if(!y||!y.length||this.qf.dD(y))return 16;l=l.XC(y[0].slideId);var G=this.Wu.bag(l);if(!G)return this.Wu.zFl(l),ya.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;
if(!c)return ya.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.d0b(y)?G.LineStyles.length:G.ShapeStyles.length;G=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(G.length));if(isNaN(c)||0>c||c>=b)return ya.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===y.length?ya.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",
f?"Graphics":"Shapes",f?"SVG":"Shape"):1<y.length&&ya.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":"Shapes",y.length,f?"SVGs":"Shapes");f=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nj()});try{f.jc(Object(sa.a)(116,l));f.gd=a;const R=this.pa.tP(Array.isArray(y)?y:null);for(const ja of R)ja&&ja.Vsl(c,this.AHb)}finally{f&&f.dispose()}return 32}Qkd(){for(const a of this.xEb)a.dispose();Array.clear(this.xEb)}z9f(a){const b=this.Wu.bag(a);if(!b||
!a)return ya.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.xEb)if(c.mj===a.mj)return c;a=new Di(b,a.Fd,this.TGb);Array.add(this.xEb,a);a.Jpd(this.cY);return a}Avl(a){if(!a||!a.length||this.Ga.xKc(a))return!1;for(const b of a)if(b.Rua)return!0;return!1}d0b(a){if(!a)return!1;for(const b of a)if(!b.wz)return!1;return!0}Hn(){this.Mxa()}Mxa(){this.Wu.clearCache();for(const a of this.xEb)a.dispose();Array.clear(this.xEb)}}
Object(m.a)(SN,"ShapesStyleActor",null,[268,677]);class aw{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.Nx=this.Pl=-1;this.sr=a;this.ia=b;this.Fa=c;this.qf=f;this.Dz=l;this.pa=y;this.wi=G;this.Ga=R;this.snk=ja;this.xnk=za;this.Uma=Va;this.zc=hb}get Nb(){return this.pa}vb(){this.ia.ra(ea.a.G1a,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.H1a,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.I1a,qc.a.application,Object(H.a)(this,
this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.cuc,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.LOb,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.rOb,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.oOb,qc.a.application,Object(H.a)(this,this.P9b,"handleFont"),5);this.ia.ra(ea.a.Blb,qc.a.application,Object(H.a)(this,this.P9b,"handleFont"),5);this.ia.ra(ea.a.Clb,qc.a.application,
Object(H.a)(this,this.P9b,"handleFont"),5);this.ia.ra(ea.a.m2e,qc.a.application,Object(H.a)(this,this.jHj,"handlePopulateFontNameDropdown"),97);this.ia.ra(ea.a.Nlb,qc.a.application,Object(H.a)(this,this.P9b,"handleFont"),4);this.ia.ra(ea.a.KOb,qc.a.application,Object(H.a)(this,this.P9b,"handleFont"),4);this.ia.ra(ea.a.guc,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.fuc,qc.a.application,Object(H.a)(this,this.LUa,"handleFontFormatAction"),4);this.ia.ra(ea.a.Fqc,
qc.a.application,Object(H.a)(this,this.Bzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.Gqc,qc.a.application,Object(H.a)(this,this.Bzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.Iqc,qc.a.application,Object(H.a)(this,this.Bzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.Hqc,qc.a.application,Object(H.a)(this,this.Bzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.qod,qc.a.application,Object(H.a)(this,this.qZc,"handleQueryFont"),100);this.ia.ra(ea.a.pod,qc.a.application,Object(H.a)(this,
this.qZc,"handleQueryFont"),100);this.ia.ra(ea.a.rod,qc.a.application,Object(H.a)(this,this.qZc,"handleQueryFont"),97);this.ia.ra(ea.a.sod,qc.a.application,Object(H.a)(this,this.qZc,"handleQueryFont"),97);this.ia.ra(ea.a.zod,qc.a.application,Object(H.a)(this,this.Bzb,"handleQueryFontToggleButton"),97);this.ia.ra(ea.a.yod,qc.a.application,Object(H.a)(this,this.Bzb,"handleQueryFontToggleButton"),97)}me(){const a=this.Fa.Ic(xa.a.qg);a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_Bold),ea.a.G1a);
a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_Italic),ea.a.H1a);a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_Underline),ea.a.I1a);a.bindAction(x.KeyInputManager.Va(B.a.rNa,x.KeyInputManager.Te|4),ea.a.cuc);a.bindAction(x.KeyInputManager.Va(B.a.iAd,x.KeyInputManager.Te|4),ea.a.LOb)}qZc(a,b,c,f,l){c=this.Nb.Qf();if(!c||1>c.length)return 16;f=this.Ga.a0(c);var y=this.Nb.$ka();if(1>f.length&&!y)return 16;b=null;this.Pl=Date.now();y&&(b=this.zc.B7f(y,new st),this.Nx=Date.now(),ya.a.J(512500294,
815,50,"Query table shape font timespan by {0}",(this.Nx-this.Pl).toString()));c=y?[c[0]]:f;for(const G of c){switch(a){case ea.a.qod:case ea.a.pod:break;case ea.a.rod:c=this.Dz.m8b(G.xd&&b?b.fontName:G.nQb);if(l.C_&&l.C_!==c){l.C_="";break}l.C_=c;l.jtc();break;case ea.a.sod:c="";G.xd&&b?-1!==b.fontSize&&(c=na.a.pUc(b.fontSize/2,0,w.AFrameworkApplication.numberFormat)):c=G.uba?aw.z7f(G).toString():"";f=parseFloat(c);if(!isNaN(f)&&(y=l.C_)&&y!==c){y=Math.min(f,parseFloat(y)).toString()+"+";l.C_=y;
break}l.C_=c;l.jtc();break;default:return ya.a.J(512500293,820,10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.C_&&!l.C_.length)break}return 32}Bzb(a,b,c,f,l){b=this.Nb.Qf();if(!b||1>b.length)return 16;b=this.Ga.a0(b);c=this.Nb.$ka();if(1>b.length&&!c)return 16;a=c?this.l0k(c,a,new st):this.emh(b,a);l.If("select"===a);return"disable"!==a?32:8}P9b(a,b,c,f,l){b=this.Nb.Qf();if(!b||1>b.length)return 16;const y=this.Nb.$ka();f=this.Ga.a0(b);if(1>f.length&&!y||this.qf.dD(f)||this.qf.dD([y]))return 16;
if(1===c)return 32;this.Nb.nj();this.Fa.Bd();switch(a){case ea.a.oOb:const R=this.iua(l,!0);if(!R)return 8;1<b.length?ya.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):ya.a.J(512500291,815,50,"Set one shape font color.");for(const hb of b)if(hb.Of||hb.Ug){On(hb);break}this.sr.ska(hb=>{hb.LMa=R},f);break;case ea.a.Nlb:case ea.a.KOb:let ja;if(a===ea.a.Nlb){if(ja=this.iua(l,!1),!ja)return 8}else ja="";1<b.length?ya.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):ya.a.J(512500289,
815,50,"Set one shape highlight.");this.sr.ska(hb=>{hb.highlight=ja},f);break;case ea.a.Blb:if(!l)return 8;const za=this.Dz.m8b(l);if(za.length){1<b.length?ya.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):ya.a.J(512500259,815,50,"Set one shape font name.");var G=null;for(const hb of b)if(hb.Of||hb.Ug)On(hb),hb.Of&&(G=hb);if(1>this.nag(f,a,za).length)return 16;this.sr.ska(hb=>{hb.nQb=za},f);G&&(G.nQb=za);this.Dz.tJc(l)}break;case ea.a.Clb:l=Object(sa.a)(oE.a,l);if(!l||!l.vd)return 8;const Va=
this.wi.Z2b(l.vd);if(isNaN(Va))return 8;1<b.length?ya.a.J(512500258,815,50,"Set {0} shapes font size.",b.length):ya.a.J(512500257,815,50,"Set one shape font size.");l=null;for(G of b)if(G.Of||G.Ug)On(G),G.Of&&(l=G);if(1>this.nag(f,a,Va*qg.a.wbb).length)return 16;this.sr.ska(hb=>{hb.ZAh(Va)},f);l&&l.ZAh(Va);break;default:return ya.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}LUa(a,b,c){b=this.Nb.Qf();if(!b||1>b.length)return 16;const f=this.Nb.$ka(),l=this.Ga.a0(b);if(1>l.length&&
!f||this.qf.dD(l)||this.qf.dD([f]))return 16;if(1===c)return 32;const y="select"!==this.emh(this.Ga.a0(b),a);this.Nb.nj();this.Fa.Bd();switch(a){case ea.a.G1a:1<b.length?ya.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):ya.a.J(512500254,815,50,"Set one shape bold.");f&&Object(qd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ea.a.bold,2);this.sr.ska(R=>{R.isBold=y},l);break;case ea.a.H1a:1<b.length?ya.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):ya.a.J(512500252,815,50,
"Set one shape italic.");f&&Object(qd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ea.a.setItalic,2);this.sr.ska(R=>{R.isItalic=y},l);break;case ea.a.I1a:1<b.length?ya.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):ya.a.J(512500250,815,50,"Set one shape underline.");f&&Object(qd.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ea.a.underline,2);this.sr.ska(R=>{R.uE=y},l);break;case ea.a.rOb:1<b.length?ya.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):
ya.a.J(512500248,815,50,"Set one shape strikethrough.");this.sr.ska(R=>{R.cG=y},l);break;case ea.a.cuc:case ea.a.LOb:const G=a===ea.a.LOb?!1:!0;1<b.length?ya.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):ya.a.J(512500246,815,50,"Step one shape font size.");this.sr.ska(R=>{R.qCb=G},l);break;case ea.a.guc:1<b.length?ya.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):ya.a.J(512500244,815,50,"Step one shape superscript.");this.sr.ska(R=>{R.IN=y?3E4:0},l);break;case ea.a.fuc:1<
b.length?ya.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):ya.a.J(512500242,815,50,"Step one shape subscript.");this.sr.ska(R=>{R.IN=y?-25E3:0},l);break;default:return 8}return 32}jHj(a,b,c,f,l){if(1===c)return 32;be.Font.Eje(b);l.MenuItems=aa.FontUtils.h5f(aw.Yud,aw.sUc,this.snk,this.Uma,this.xnk);return 32}emh(a,b){let c="select";for(const f of a){switch(b){case ea.a.Fqc:case ea.a.G1a:c=f.isBold?"select":"normal";break;case ea.a.Gqc:case ea.a.H1a:c=f.isItalic?"select":"normal";break;
case ea.a.Iqc:case ea.a.I1a:c=f.uE?"select":"normal";break;case ea.a.Hqc:case ea.a.rOb:c=f.cG?"select":"normal";break;case ea.a.zod:case ea.a.guc:c=0<f.IN?"select":"normal";break;case ea.a.yod:case ea.a.fuc:c=0>f.IN?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}l0k(a,b,c){this.Pl=Date.now();c=this.zc.B7f(a,c);switch(b){case ea.a.Fqc:a=1===c.bold?"select":"normal";break;case ea.a.Gqc:a=1===c.italic?"select":"normal";break;case ea.a.Iqc:a=1===c.underline?"select":"normal";
break;case ea.a.Hqc:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.Nx=Date.now();ya.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.Nx-this.Pl).toString());return a}nag(a,b,c){const f=[];for(const l of a)switch(b){case ea.a.G1a:l.isBold!==c&&Array.add(f,l);break;case ea.a.H1a:l.isItalic!==c&&Array.add(f,l);break;case ea.a.I1a:l.uE!==c&&Array.add(f,l);break;case ea.a.rOb:l.cG!==c&&Array.add(f,l);break;case ea.a.Blb:l.nQb!==c&&Array.add(f,l);break;
case ea.a.Clb:aw.z7f(l)!==c&&Array.add(f,l);break;case ea.a.guc:0<l.IN!==c&&Array.add(f,l);break;case ea.a.fuc:0>l.IN!==c&&Array.add(f,l);break;default:ya.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return f}iua(a,b){if(b)return b=bm.SchemeColor.parse(a),b&&b.qua?Xh.i(Xh.g(b.tQ)):(ya.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=Cu.a.parse(a);return b&&b.RGBColor?b.RGBColor:(ya.a.J(512500238,820,10,"Color '{0}' is incorrect",
a),null)}static sUc(a,b){return b}static Yud(){return!1}static z7f(a){const b=a.B3;return Xg.a.vz(b,1)?a.uba:Math.round(a.uba)*b}}Object(m.a)(aw,"ShapesTextFontActor",null,[268]);class TN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.Nx=this.Pl=-1;this.sr=a;this.ia=b;this.Fa=c;this.qf=f;this.pa=l;this.Ga=y;this.Kfb=G;this.yM=R;this.Tb=ja;this.Fb=za;this.p6c=Va;this.zc=hb;this.EA=Cb}get Nb(){return this.pa}vb(){this.ia.ra(ea.a.IOb,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),
4);this.ia.ra(ea.a.qOb,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Dlb,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.JOb,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Qlb,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.pOb,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.buc,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),
4);this.ia.ra(ea.a.xud,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Vtd,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Utd,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Ttd,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Std,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.k2e,qc.a.application,Object(H.a)(this,this.Ghg,
"handleQueryLineSpacing"),4);this.ia.ra(ea.a.Ntc,qc.a.application,Object(H.a)(this,this.t9,"handleFormatAction"),4);this.ia.ra(ea.a.Njb,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.Ojb,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.l0a,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.m0a,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.uod,
qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.ood,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.wod,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.tod,qc.a.application,Object(H.a)(this,this.MUa,"handleQueryToggleButton"),97);this.ia.ra(ea.a.Cod,qc.a.application,Object(H.a)(this,this.Nge,"handleQueryTextAnchoring"),97);this.ia.ra(ea.a.Bod,qc.a.application,Object(H.a)(this,
this.Nge,"handleQueryTextAnchoring"),97);this.ia.ra(ea.a.Aod,qc.a.application,Object(H.a)(this,this.Nge,"handleQueryTextAnchoring"),97);this.ia.ra(ea.a.vod,qc.a.application,Object(H.a)(this,this.Ghg,"handleQueryLineSpacing"),97)}me(){const a=this.Fa.Ic(xa.a.qg);a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_FullJustify),ea.a.pOb);a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_CenterJustify),ea.a.JOb);z.a.fl?(a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_LeftJustify_Mac),ea.a.Dlb),
a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_RightJustify_Mac),ea.a.Qlb)):(a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_LeftJustify),ea.a.Dlb),a.bindAction(x.KeyInputManager.yw(ResourceStrings.l_HK_RightJustify),ea.a.Qlb))}MUa(a,b,c,f,l){const y=this.Nb.Qf();if(!y||1>y.length)return 16;b=this.Nb.$ka();const G=this.Ga.a0(y);if(1>G.length&&!b)return 16;f=c=null;let R=a===ea.a.Njb?1:a===ea.a.Ojb?2:18;Object(Sa.a)(gi.a,l)?f=l:Object(Sa.a)(Xv,l)&&(f=l.p0a,R=l.menuItemId);l=b?[y[0]]:
G;this.Pl=Date.now();for(const ja of l){switch(a){case ea.a.Njb:c=ja.xd?this.cfe(R,a):this.lee(R,ja,a);break;case ea.a.Ojb:c=ja.xd?this.cfe(R,a):this.lee(R,ja,a);break;case ea.a.l0a:case ea.a.m0a:c=ja.xd?this.cfe(R,a):this.lee(R,ja,a);break;case ea.a.uod:c=ja.xd?1===this.zc.DVc(b)?"select":"normal":1===ja.Vl?"select":"normal";break;case ea.a.ood:c=ja.xd?2===this.zc.DVc(b)?"select":"normal":2===ja.Vl?"select":"normal";break;case ea.a.wod:c=ja.xd?3===this.zc.DVc(b)?"select":"normal":3===ja.Vl?"select":
"normal";break;case ea.a.tod:c=ja.xd?6===this.zc.DVc(b)?"select":"normal":4===ja.Vl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.If("select"===c);this.Nx=Date.now();b&&ya.a.J(512500237,815,50,"Query table shape timespan by {0}",(this.Nx-this.Pl).toString());return"disable"!==c?32:8}lee(a,b,c){return c===ea.a.l0a||c===ea.a.Njb||c===ea.a.m0a||c===ea.a.Ojb?this.yM.JEf(b,a)?"select":"normal":"normal"}cfe(a,b){var c=!0,f=this.Nb.$ka();f=Vd.SelectionFactory.fPc(Object(sa.a)(Ig.a,
f));for(const l of f){if(c=l.Rk?l.node:null)if(f=this.Tb.Lc(c),f.set(c),f.rc(11),f.Jg(11),c=this.EA.Hv(f)){if(0===a){c=!1;break}if(b===ea.a.Njb)c=1===c.listType;else if(b===ea.a.Ojb)c=0===c.listType;else if(b===ea.a.l0a){f=this.yM.NWa.ga(a).o1b;const y=this.yM.NWa.ga(a).lub;c=c.Hzb&&0<c.Y9.length&&c.Y9[0]===f&&c.lbb&&c.font===y}else b===ea.a.m0a?(f=this.yM.Oid.ga(a).jXd,c=!!c.propertySet&&c.propertySet.Ta(va.a.autonumberBulletType)&&c.propertySet.eb(va.a.autonumberBulletType)===f):c=!1}else c=0===
a?b===ea.a.l0a||b===ea.a.m0a?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}t9(a,b,c,f,l){f=this.Nb.Qf();if(!f||1>f.length)return 16;b=this.Ga.a0(f);const y=this.Nb.$ka(),G=!!y&&(a===ea.a.buc||a===ea.a.xud);if(!b.length&&!y||G||this.qf.dD(b)||this.qf.dD([y]))return 16;if(1===c)return 32;this.Nb.nj();a!==ea.a.Ntc&&this.Fa.Bd();switch(a){case ea.a.IOb:case ea.a.qOb:if(Object.getType(l)!==Number)return 8;this.Ssl(f,b,l);break;case ea.a.Dlb:case ea.a.JOb:case ea.a.Qlb:case ea.a.pOb:var R=this.CUf(b);
this.Qsl(b,a,l);R&&this.pa.selectShape(R,!1);Kc.a.KP(!0,!1);break;case ea.a.buc:case ea.a.xud:l=[];const ja=a===ea.a.buc?1:2;for(R of b)Array.add(l,R);1<f.length?ya.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):ya.a.J(512500235,815,50,"Set one shape text direction.");this.sr.Y9a(Va=>{if(Va=Object(sa.a)(4,Va))Va.mQb=ja},l);break;case ea.a.Ntc:if(!l||!Object(Sa.a)(Array,l)||1>l.length)return 8;Kc.a.Kb&&(Kc.a.Kb.Qj=!0);b=this.Fb.yd(15);try{for(b.jc(l[0].i2),b.gd=a,a=0;a<l.length;a++)l[a].i2.wja=
l[a].waa.left,l[a].i2.xja=l[a].waa.right,l[a].i2.yja=l[a].waa.top,l[a].i2.vja=l[a].waa.bottom}finally{b&&b.dispose()}Kc.a.KP(!0,!1);break;case ea.a.Vtd:case ea.a.Utd:case ea.a.Ttd:l=[];let za=1;switch(a){case ea.a.Vtd:za=0;break;case ea.a.Utd:za=1;break;case ea.a.Ttd:za=2}for(const Va of b)Array.add(l,Va);ya.a.J(512500234,815,50,"Set text anchoring, shape count: {0}.",f.length);this.sr.Y9a(Va=>{if(Va=Object(sa.a)(4,Va))Va.Ppa=za},l);Kc.a.KP(!0,!1);break;case ea.a.Std:if(!l||Object.getType(l)!==Number)return 8;
R=this.CUf(b);this.Rsl(b,l,a);R&&this.pa.selectShape(R,!1);Kc.a.KP(!0,!1);break;default:return 8}return 32}Nge(a,b,c,f,l){b=this.Nb.Qf();if(!b||1>b.length)return 16;b=this.Nb.rWc(b);f=b.pCb;c=0;const y=this.Nb.$ka();if(!f&&!y)return 16;switch(a){case ea.a.Cod:a=y?({Xxa:c}=this.zc.w9e(y)).returnValue&&0===c?"select":"normal":0===b.Ppa?"select":"normal";break;case ea.a.Bod:a=y?({Xxa:c}=this.zc.w9e(y)).returnValue&&1===c?"select":"normal":1===b.Ppa?"select":"normal";break;case ea.a.Aod:a=y?({Xxa:c}=
this.zc.w9e(y)).returnValue&&2===c?"select":"normal":2===b.Ppa?"select":"normal";break;default:a="disable"}l.If("select"===a);return"disable"!==a?32:8}Ghg(a,b,c,f,l){c=this.Nb.Qf();if(!c||1>c.length)return 16;b=this.Nb.$ka();c=this.Ga.a0(c);if(!c.length&&!b)return 16;this.Pl=Date.now();switch(a){case ea.a.k2e:break;case ea.a.vod:a=new FN.a;a.unit=2;a.value=l.MenuItemId;f=!0;b&&(f=this.$yl(b,l),this.Nx=Date.now(),ya.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.Nx-this.Pl).toString()));
for(const y of c){b=this.Ga.kee(y);if(!b||!this.Kfb.PEf(b,a)){f=!1;break}this.p6c&&2===b.unit&&(b.value=Math.max(0,b.value-this.Ga.N$d(y)))}l.queryResult.If(f);break;default:return 8}return 32}Rsl(a,b,c){const f=this.Fb.yd(15);try{f.jc(a[0]);f.gd=c;for(const l of a)l.Fta();this.ia.Ja(ea.a.zoa,2,b)}finally{f&&f.dispose()}}Qsl(a,b,c){const f=[];let l=0,y=0;switch(b){case ea.a.Dlb:l=1;y=C.a.$la;break;case ea.a.JOb:l=2;y=C.a.Dja;break;case ea.a.Qlb:l=3;y=C.a.gpa;break;case ea.a.pOb:l=4,y=C.a.BEa}a=this.pa.tP(a);
for(const G of a)G.Vl!==l&&Array.add(f,G);if(y&&f.length){for(const G of a)if(G.Of||G.Ug){On(G);break}a=this.Fb.yd(15);try{a.jc(f[0]);for(const G of f)G.Fta(),G.Itl(l);this.ia.Ja(y,2,c)}finally{a&&a.dispose()}}}Ssl(a,b,c){const f=[];let l=1===c||2===c;for(const G of b)this.yM.JEf(G,c)||(l=!1,Array.add(f,G));1<a.length?ya.a.J(512500231,815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):ya.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const G of a)if(G.Of||G.Ug){On(G);
break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const y=this.yM.NWa.ga(c);0<a.length&&this.sr.Y9a(G=>{G.setValue(va.a.z2a,c);y&&(G.setValue(va.a.HKh,y.lub),G.setValue(va.a.GKh,y.o1b))},a)}$yl(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=Vd.SelectionFactory.fPc(Object(sa.a)(Ig.a,a));for(const y of a){if(a=y.Rk?y.node:null){a=this.Kfb.fX(a);const G=Xg.a.vz(a.lineSpacing.value,f)&&2===a.lineSpacing.unit;if(-1===l)b=a.lineSpacing.unit,l=a.lineSpacing.value;else if(l!==
a.lineSpacing.value||b!==a.lineSpacing.unit)l=b=0,c=!1;0!==b&&(c=G)}if(!c)break}return c}CUf(a){return 0<a.length&&a[0].Ug&&(a=this.Ga.Fs(a[0]))?(this.pa.O8(a),a):null}}Object(m.a)(TN,"ShapesTextParagraphActor",null,[268]);var jS=d(697);class UN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){this.ia=a;this.qf=b;this.Fb=c;this.wA=f;this.Fa=l;this.pa=y;this.Ub=G;this.ua=R;this.Sb=ja;this.Da=za;this.Gt=Va;this.Eb=hb;this.Ijk=lc;if(!Cb)throw Error.argumentNull("GraphOperationEventHandler is null");this.Rf=
Cb}vb(){this.ia.ra(ea.a.deleteObject,rb.a.application,Object(H.a)(this,this.dEj,"handleDelete"),4);this.Da.podsEnableSlideScoreCard&&this.ia.ra(ea.a.gmh,ye.a.frame,Object(H.a)(this,this.jVl,"updateSlideScore"),96);this.ia.ra(ea.a.S5d,qc.a.application,Object(H.a)(this,this.vEj,"handleDuplicate"),4);this.ia.ra(ea.a.lzf,qc.a.application,Object(H.a)(this,this.yCj,"handleAddFirstSlide"),4);this.Da.U4j?(this.ia.ra(ea.a.TI,rb.a.application,Object(H.a)(this,this.mEj,"handleDeleteSlides"),4),this.ia.ra(ea.a.BQ,
qc.a.application,Object(H.a)(this,this.yEj,"handleDuplicateSlides"),4),this.Da.Whe?(this.ia.ra(ea.a.z$b,qc.a.application,Object(H.a)(this,this.kFj,"handleHideSlides"),4),this.ia.ra(ea.a.q$e,qc.a.application,Object(H.a)(this,this.XJj,"handleUnhideSlides"),4),this.Rf.E7a(Object(H.a)(this,this.CDl,"slidesSelectionChangedHandler"))):this.ia.ra(ea.a.z$b,qc.a.application,Object(H.a)(this,this.xge,"handleHideSlidesOld"),4),this.ia.ra(ea.a.Fod,rb.a.application,Object(H.a)(this,this.LHj,"handleQuerySlidesHidden"),
96)):(this.ia.ra(ea.a.TI,rb.a.application,Object(H.a)(this,this.lEj,"handleDeleteSlide"),4),this.ia.ra(ea.a.BQ,qc.a.application,Object(H.a)(this,this.xEj,"handleDuplicateSlide"),4),this.ia.ra(ea.a.z$b,qc.a.application,Object(H.a)(this,this.jFj,"handleHideSlide"),4),this.ia.ra(ea.a.Fod,rb.a.application,Object(H.a)(this,this.KHj,"handleQuerySlideHidden"),96));this.ia.ra(ea.a.k4d,rb.a.application,Object(H.a)(this,this.fEj,"handleDeleteFakeSlides"),2048);this.ia.ra(ea.a.gMf,rb.a.application,Object(H.a)(this,
this.LDj,"handleClearAndResizeSlideCanvas"),2048);this.ia.ya(ea.a.Dud,qc.a.application,Object(H.a)(this,this.dJj,"handleShareSlide"));this.ia.ra(ea.a.fUe,rb.a.application,Object(H.a)(this,this.Cge,"handleIsDirectManipulationEnabled"),97)}me(){const a=this.Fa.Ic(Si.a.fE);a.bindAction(x.KeyInputManager.Va(B.a.vha,0),ea.a.TI);a.bindAction(x.KeyInputManager.Va(B.a.FG,0),ea.a.TI);a.bindAction(x.KeyInputManager.Va(B.a.BNa,x.KeyInputManager.Te),ea.a.BQ)}dEj(a,b,c,f,l){if(this.Fa.Ee)if(this.Fa.I8===Si.a.fE||
1===this.Eb.al||this.Da.Xn&&this.Fa.I8===xa.a.nC)a=ea.a.TI;else if(this.Fa.I8===xa.a.qg)a=ea.a.C8a;else return 8;else return 8;return this.ia.Ja(a,c,l)}lEj(a,b,c){b=this.ua.Ba;if(!b||this.qf.fd(b)||this.Da.fD&&1!==this.pa.Re().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Kc.a.Kb&&(Kc.a.Kb.actionName="DeleteSlide",Kc.a.Kb.$p=!1,Kc.a.Kb.Qj=!0,Kc.a.Kb.Wa("SlideCount","1"));c=this.Ub.Gf;if(!c)return 16;const f=this.Fb.yd(15,void 0,()=>{this.pa.nh()});try{f.jc(c),f.gd=a,c.TI(b)}finally{f&&
f.dispose()}this.qf.uw(c,a);a=[];a.push(b);this.Gt?this.Gt.jpd(new CE.a(a)):ya.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}LDj(a,b,c){a=this.Sb.zx(this.ua.h5c?this.ua.h5c.slideIndex:0);if(!a)return ya.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(sa.a)(424,a.qc(this.Eb.Na));if(!a)return ya.a.J(512313373,822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;ya.a.J(512313372,
822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.g1e(!1);a.updateOffSlideView(0,!0);return 32}fEj(a,b,c){b=[];for(const f of this.Sb.MTa())f.pO&&Array.add(b,f);if(!b.length||!this.ua.Ba)return ya.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;ya.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");return this.yUf(b,"DeleteFakeSlide",a)}mEj(a,b,c){b=this.pa.Re();if(!b||!b.length||!this.ua.Ba)return 16;for(const f of b)if(!f||
this.qf.fd(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;return this.yUf(b,"DeleteSlide",a)}yUf(a,b,c){Kc.a.Kb&&(Kc.a.Kb.actionName=b,Kc.a.Kb.$p=!1,Kc.a.Kb.Qj=!0,Kc.a.Kb.Wa("SlideCount",a.length.toString()));1<a.length?ya.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):ya.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");b=this.Ub.Gf;if(!b)return 16;this.NVi(b,a,c,()=>{this.pa.nh()});return 32}NVi(a,b,c,f){f=this.Fb.yd(15,
void 0,f);try{f.jc(a);for(const l of b)l&&!l.Cb.equals(this.ua.Ba.Cb)&&a.TI(l);a.TI(this.ua.Ba);this.Da.ka("CopilotDesignerEnableMetricsTracker")&&this.Ijk.e1k();f.gd=c}finally{f&&f.dispose()}this.Da.unblockContentWhenDeletingSlideEnabled||this.qf.uw(a,c);this.Gt?this.Gt.jpd(new CE.a(b)):ya.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}KHj(a,b,c,f,l){a=this.ua.Ba;if(!a)return 16;l.If(a.Wm);return 32}LHj(a,b,c,f,l){a=this.pa.Re();if(!a||!a.length)return 16;
a=this.vWd(a);l.If(a);return 32}dJj(a,b,c,f,l){a=this.ua.Ba;if(!a||this.qf.fd(a)||1!==this.pa.Re().length)return 16;if(1===c)return 32;Kc.a.Kb&&(Kc.a.Kb.$p=!1,Kc.a.Kb.Wa("SlideCount","1"));c=a.Cb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=jS.a(c);l.mode="copy";ya.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.Ja(F.a.Jda,2,l);return 32}jFj(a,b,c){b=this.ua.Ba;if(!b||this.qf.fd(b)||this.Da.fD&&1!==this.pa.Re().length)return 16;if(1===c)return 32;Kc.a.Kb&&(Kc.a.Kb.$p=
!1,Kc.a.Kb.Wa("SlideCount","1"));c=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Eb.al&&(this.Da.Xn?this.Fa.wf(xa.a.nC):this.Fa.wf(Si.a.fE))});try{c.jc(b),c.gd=a,b.Wm=!b.Wm}finally{c&&c.dispose()}return 32}xge(a,b,c){b=this.pa.Re();if(!b||!b.length)return 16;for(var f of b)if(!f||this.qf.fd(f))return 8;if(1===c)return 32;ya.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Kc.a.Kb&&(Kc.a.Kb.$p=!1,Kc.a.Kb.Wa("SlideCount",b.length.toString()));c=!this.vWd(b);
f=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{1!==this.Eb.al&&(this.Da.Xn?this.Fa.wf(xa.a.nC):this.Fa.wf(Si.a.fE))});try{f.jc(this.Ub.Gf);f.gd=a;for(const l of b)l.Wm=c}finally{f&&f.dispose()}return 32}kFj(a,b,c,f,l){const y=this.pa.Re();if(!y||!y.length)return 16;for(const G of y)if(!G||this.qf.fd(G))return 8;if(this.vWd(y))return this.AZc(),32;this.xge(a,b,c,f,l);this.AZc();return 32}XJj(a,b,c,f,l){const y=this.pa.Re();if(!y||!y.length)return 16;for(const G of y)if(!G||this.qf.fd(G))return 8;
if(1===c)return 32;this.xge(a,b,c,f,l);this.AZc();return 32}AZc(){var a=this.pa.Re();if(a&&a.length){for(var b of a)if(!b||this.qf.fd(b))return;if(Zg.c()){b=!0;for(const c of a)if(!c.Wm){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else ya.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}CDl(){this.AZc()}jVl(a,
b,c,f,l){if(1===c)return 32;this.ua.Ba&&(a="Slide Complex: "+this.ua.Ba.sa(va.a.Yoa,0).toString(),l[Tp.a.Value]=a,l[wm.a.labelText]=a,l[Tp.a.Visible]=!0);return 32}vEj(a,b,c,f,l){if(this.Fa.Ee)if(this.Fa.I8===Si.a.fE)a=ea.a.BQ;else if(this.Fa.I8===xa.a.qg)a=ea.a.I9a;else return 8;else return 8;return this.ia.Ja(a,c,l)}xEj(a,b,c){b=this.ua.Ba;if(!b||this.qf.fd(b)||this.Da.fD&&1!==this.pa.Re().length)return 16;if(1===c)return 32;Kc.a.yk("SlideCount","1");this.wA.K3i(b,a).vO||this.qf.uw(this.Ub.Gf,a);
return 32}yEj(a,b,c){b=this.pa.Re();if(!b||!b.length)return 16;for(var f of b)if(!f||this.qf.fd(f))return 16;if(1===c)return 32;1<b.length?ya.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):ya.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Kc.a.yk("SlideCount",b.length.toString());c=this.wA.z_f(b,a,null,null,!0);f=!0;for(const l of c)if(!l.vO){f=!1;break}f||this.qf.uw(this.Ub.Gf,a);return 32}yCj(){try{ya.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");
const a=this.Sb.bJ();a&&0<a.length&&this.wA.FSc(null,a[0].Id,this.Da.gdc?0:a[0].ContentMasters[0].Id,ea.a.HIb);return 32}catch(a){return ya.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}Cge(a,b,c,f,l){return l&&Object(Sa.a)(nc.a,l)?this.qf.fd(this.Sb.Qk(l))?16:32:8}vWd(a){for(const b of a)if(!b.Wm)return!1;return!0}}Object(m.a)(UN,"SlideActor",null,[268]);var kS=d(1170);const ME=()=>{appChrome.PRIToastManager.dismissToast()};class NE{constructor(a,b,c){this.slideId=a;this.wxk=
b;this.uKi=c}}Object(m.a)(NE,"NewSlideWithLayoutData",null,[]);class mj{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){this.lwa=0;this.g$c={};this.N_g=this.O_g=0;this.ia=a;this.fc=b;this.Fa=c;this.Ank=mj.DZj(f);this.pa=l;this.Fb=y;this.wA=G;this.Ub=R;this.ua=ja;this.Sb=za;this.lxe=Va;this.Wu=hb;this.Wu.RJc(Object(H.a)(this,this.hfh,"openIgnoredDialog"));this.Da=Cb;this.TGb=lc;this.Lwa={}}vb(){this.Da.T4j?this.ia.ra(ea.a.Eja,qc.a.application,Object(H.a)(this,this.eig,"handleSlidesChangeLayout"),4):
this.ia.ra(ea.a.Eja,qc.a.application,Object(H.a)(this,this.DDj,"handleChangeLayout"),4);this.ia.ra(ea.a.boa,qc.a.application,Object(H.a)(this,this.thg,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(ea.a.i6,qc.a.application,Object(H.a)(this,this.shg,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(ea.a.HIb,qc.a.application,Object(H.a)(this,this.shg,"handleNewSlideWithDefaultLayout"),4);this.ia.ra(ea.a.hid,qc.a.application,Object(H.a)(this,this.yGj,"handleNewSlideWithLayout"),4);this.ia.ra(ea.a.mKb,
qc.a.application,Object(H.a)(this,this.thg,"handleNewSlideWithLayoutOptions"),4);this.ia.ra(ea.a.E0c,qc.a.application,Object(H.a)(this,this.iIj,"handleReactInsertSlideWithLayout"),4);this.ia.ra(ea.a.XQe,qc.a.application,Object(H.a)(this,this.eig,"handleSlidesChangeLayout"),4);this.ia.ra(ea.a.EZd,qc.a.application,Object(H.a)(this,this.hIj,"handleReactChangeSlideLayout"),4);this.ia.ra(ea.a.aod,qc.a.application,Object(H.a)(this,this.aod,"queryNewSlideLayout"),4);this.ia.ra(ea.a.oTe,qc.a.application,
Object(H.a)(this,this.oTe,"queryChangeSlideLayout"),4)}me(){const a=this.Fa.Ic(Si.a.fE),b=this.Fa.Ic(Si.a.D3),c=this.Fa.Ic(xa.a.qg),f=this.Fa.Ic(xa.a.DQ);a.bindAction(x.KeyInputManager.Va(B.a.jp,0),ea.a.i6);a.bindAction(x.KeyInputManager.Va(B.a.vAa,x.KeyInputManager.Te),ea.a.i6);c.bindAction(x.KeyInputManager.Va(B.a.vAa,x.KeyInputManager.Te),ea.a.i6);b.bindAction(x.KeyInputManager.Va(B.a.vAa,x.KeyInputManager.Te),ea.a.i6);f.bindAction(x.KeyInputManager.Va(B.a.vAa,x.KeyInputManager.Te),ea.a.i6)}xuc(){return this.Ank||
this.Sb.jhe()}DDj(a,b,c){const f=this.ua.Ba;if(!f||this.fc.fd(f)||this.Da.fD&&1!==this.pa.Re().length)return 16;a=f.mj;if(!a)return 8;b=this.Sb.bJ();if(!this.Da.pWa){if(!b)return ya.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.Onb(b,a))return 8}if(1===c)return 32;if((!this.Da.pWa||b&&this.Onb(b,a))&&this.Wu.jP.Gb(a)&&this.ate()){this.lwa=0;c=f.Qn;if(!c)return ya.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),
8;this.lxe.R1d(0,this.Sb.Tu(),b,this.Wu.jP,a,Object(H.a)(this,this.EZd,"changeSlideLayout"),this.xuc(),w.AFrameworkApplication.isRtl).xvd(c)}else ya.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.Wu.w5e(a),this.lwa=ea.a.Eja;return 32}eig(a,b,c,f,l){b=this.pa.Re();if(!b||!b.length)return 8;f=0;const y=[],G=this.Sb.bJ();if(!G)return ya.a.J(512500226,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var R of b){if(this.fc.fd(R)||
!R)return 16;f=R.mj;if(!f)return ya.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;y.push(f);if(!this.Da.pWa&&!this.Onb(G,f))return ya.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),8}if(1===c&&!this.Da.u0a)return 32;for(const ja of y)if(this.Da.pWa&&!this.Onb(G,f)||!this.Wu.jP.Gb(ja)){ya.a.J(512500195,822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.Wu.w5e(f);
if(this.Da.u0a)return this.Wge(a,c,()=>{this.Wu.RJc(ME)},l);this.lwa=ea.a.Eja;return 32}R=this.lwa=0;for(const ja of b)if(R=ja.Qn,!R)return ya.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?ya.a.J(512500193,822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):ya.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");1<b.length&&(R=0);if(!this.ate())return ya.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),
qd.a("RaiseFirstMasterRetrievedEvent")?this.Wge(a,c,()=>{this.Wu.wji(ME)},l):8;if(this.Da.u0a){if(1===c)return 32;if(!l)return 8;this.N_g=R;this.Tmd(l,G,f,!0)}else this.lxe.R1d(0,this.Sb.Tu(),G,this.Wu.jP,f,Object(H.a)(this,this.WKf,"changeSlidesLayout"),this.xuc(),w.AFrameworkApplication.isRtl).xvd(R);return 32}EZd(a,b){const c=this.ua.Ba;if(c){var f=()=>{this.Fa.Bd();this.pa.nh()},l=()=>{this.Fa.wf(Si.a.fE)};a=parseInt(a);b=parseInt(b);if(a!==c.mj||b!==c.Qn){const y=Kc.a.Kb;Kc.a.Nyd("ChangeSlideLayout");
Kc.a.Kb&&(Kc.a.Kb.$p=!0,Kc.a.Kb.Wa("SlideCount","1"));f=this.Fb.yd(15,void 0,f,l);try{f.jc(c),f.gd=ea.a.Eja,c.mj=a,c.Qn=b}finally{f&&f.dispose()}this.fc.uw(c,"ChangeSlideLayout");Kc.a.Kb=y}}}WKf(a,b){const c=this.pa.Re();if(c&&c.length){a=parseInt(a);b=parseInt(b);var f=Kc.a.Kb;Kc.a.Nyd("ChangeSlidesLayout");Kc.a.Kb.$p=!0;var l=[];for(var y of c)a===y.mj&&b===y.Qn||l.push(y);if(l.length){Kc.a.yk("SlideCount",l.length.toString());y=this.Fb.yd(15,void 0,()=>{this.Fa.Bd();this.pa.nh()},()=>{this.Fa.wf(Si.a.fE)});
try{y.jc(this.ua.Ba);y.gd=ea.a.Eja;for(const G of l)G.mj=a,G.Qn=b}finally{y&&y.dispose()}for(const G of c)this.fc.uw(G,"ChangeSlidesLayout");Kc.a.Kb=f}}}hIj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let y,G;if(!({masterId:y,layoutId:G}=this.O9e(l.SourceControlId)).returnValue)return 8;ya.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");this.WKf(y,G)}catch(y){return ya.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",
y),8}return 32}thg(a,b,c,f,l){f=this.Ub.Gf;if((b=this.ua.Ba)&&this.fc.fd(b)||this.fc.fd(f))return ya.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;f=this.Sb.bJ();if(!f||!f.length)return ya.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let y=0;if(b){if(y=b.mj,!y)return ya.a.J(512500185,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else y=f[0].Id;let G=0;({mj:y,Qn:G}=
this.QVc(f,b));if(!this.Da.pWa&&!this.Onb(f,y))return ya.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Sb.rj())return 8;if(!this.Da.u0a)return 32}if(this.Da.pWa&&!this.Onb(f,y)||!this.Wu.jP.Gb(y)||!this.ate()){ya.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");this.Wu.w5e(y);if(this.Da.u0a)return this.Wge(a,c,()=>{this.Wu.RJc(ME)},l);this.lwa=ea.a.boa}else if(this.lwa=
0,this.Da.u0a){if(1===c)return 32;if(!l)return 8;this.O_g=G;this.Tmd(l,f,y,!1)}else this.lxe.R1d(1,this.Sb.Tu(),f,this.Wu.jP,y,Object(H.a)(this,this.E0c,"insertSlideWithLayout"),this.xuc(),w.AFrameworkApplication.isRtl).xvd(G);return 32}Tmd(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=qd.a("ReactSlideLayoutSectionsAPIEnabled")?this.B8b(b,c,f):this.Bsj(b,c,f));ya.a.J(512500182,822,50,"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}Zde(){const a=this.Sb.Tu();
if(!a||!a.width||!a.height)return ya.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new sr.a(mj.CIf,mj.pxi);const b=mj.CIf;return new sr.a(b,a.height/a.width*b)}uWc(){const a={},b={},c=this.Zde();b.root=this.C2d(c.width+mj.KIf,c.height+mj.KIf+mj.ixi+mj.vxi);b.flexContainer={flexDirection:"column"};b.label=mj.h2d();a.galleryButtonInExpanded=b;return a}C2d(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}Bsj(a,b,c){this.Jpd();const f=Object.assign(new bo.a,
{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,y=!1;const G=a.length;if(!G||1===G&&a&&a[0]&&!a[0].InContent)return f;for(var R=0;R<G;R++)a[R].Id===b&&(l=R,y=!0);y&&(b=this.fag(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<G;b++)y&&b===l||(R=this.fag(a[b],a[b].Id,c,b),Array.add(f.MenuSectionList,R));return f}fag(a,b,c,f){const l=Object.assign(new el.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.Wu.jP&&this.Wu.jP.Gb(a.Id)))return l;
var y=this.uWc(),G=c?"ChangeLayout":"NewSlide",R=c?"ChangeLayoutControls":"NewSlideLayoutControls";mj.fgd++;f=qd.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+"_"+mj.fgd.toString();y=Object.assign(new Hq.a,{Id:R,ExternalId:G+"_"+f,Type:4,Title:a.Name,GalleryStyle:y,Width:3,GalleryItems:[]});a=a.ContentMasters;if(!a)return l;G=a.length;for(R=0;R<G;R++)f=a[R],!f||!this.xuc()&&this.Sb.lcb(f)||Array.add(y.GalleryItems,this.Rxb(f,b,c));Array.add(l.ControlList,y);return l}eEi(){try{const a=
[],b=this.Lwa;for(let c in b)a.push(c);this.Lwa={};this.g$c={};appChrome.api.unregisterIcons(a)}catch(a){ya.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",a)}}Jpd(){this.eEi();try{const a=this.Sb.bJ();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.Wu.jP&&this.Wu.jP.count&&this.Wu.jP.Gb(c.Id)&&this.addIconToMap(this.Wu.jP.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.Lwa)}}catch(a){ya.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",
a)}}C8b(a,b){a=String.format("{0}_{1}_{2}",mj.ENj,a,b);a in this.g$c||(mj.fgd++,this.g$c[a]=a+"_"+mj.fgd.toString());return this.g$c[a]}addIconToMap(a,b){if(this.ua.Ba&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.C8b(b,c.LayoutId),y={},G={};c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(G.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),w.AFrameworkApplication.isRtl&&qd.a("ReactSlideLayoutRTLFix")?G.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):G.left=String.format("-{0}px",
c.Icon.Clip.Bounds.Left));G.position="absolute";const R={},ja={},za=this.Zde();ja.height=za.height.toString()+"px";ja.width=za.width.toString()+"px";ja.position="relative";ja.overflow="hidden";ja.display="inline-block";R.root=ja;y.root=G;this.TGb&&c.Icon&&(c=appChrome.buildLayoutImageIconFromUrlWithStyles(this.TGb.resolve(Yg.a.Gwb,c.Icon.ImgId,mj.eyi),y,R),this.Lwa[l]=c)}}B8b(a,b,c){this.Jpd();const f=Object.assign(new bo.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],
UpdateDynamically:!0});var l=Object.assign(new el.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var y=this.uWc();y=Object.assign(new Hq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:y,Width:3,Type:4,GallerySections:[]});
Array.add(l.ControlList,y);l=0;let G=!1;const R=a.length;ya.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",R);if(!R||1===R&&a&&a[0]&&!a[0].InContent)return ya.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",c,R,1===R&&!!a&&!!a[0]&&a[0].InContent),f;for(var ja=0;ja<R;ja++)a[ja].Id===b&&(l=ja,G=!0);G&&(b=this.Iih(a[l],b,c),y.GallerySections.push(b));for(b=0;b<R;b++)G&&b===l||(ja=this.Iih(a[b],
a[b].Id,c),y.GallerySections.push(ja));return f}Iih(a,b,c){const f=Object.assign(new kS.a,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});if(!(a.InContent&&this.Wu.jP&&this.Wu.jP.Gb(a.Id)))return ya.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",c,a.InContent,!!this.Wu.jP&&this.Wu.jP.Gb(a.Id)),f;a=a.ContentMasters;if(!a)return ya.a.J(512500175,
822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;for(let y=0;y<l;y++){const G=a[y];!G||!this.xuc()&&this.Sb.lcb(G)||Array.add(f.GalleryButtons,this.Rxb(G,b,c))}return f}KEa(a,b,c){return qd.a(mj.UKf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}Rxb(a,b,c){const f=a.Id,l=this.KEa(b.toString(),f.toString(),c),y={},G={},R=this.Zde();G.width=R.width.toString()+"px";G.height=R.height.toString()+"px";
qd.a("ReactNewSlideLayoutIconBorderFix")||(G.border="#858585 1px solid");y.root=G;return Object.assign(new lE.a,{Id:l,ExternalId:l,Icon:this.C8b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:qd.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:y,Alt:a.Name})}shg(a,b,c){if(this.fc.qO(this.Ub.Gf))return 16;b=this.Sb.bJ();if(!b)return 8;let f=null;if(this.Da.fD){var l=this.pa.Re();1<=l.length&&(l.sort((G,R)=>G.qe-R.qe),a!==ea.a.HIb&&(f=l[l.length-
1]))}else a!==ea.a.HIb&&(f=this.ua.Ba);if(this.fc.fd(f))return 16;let y;({mj:l,Qn:y}=this.QVc(b,this.ua.Ba));if(!this.Onb(b,l))return 8;if(1===c)return 32;c=this.wA.FSc(Object(sa.a)(116,f),l,y,a);this.zzf(l,y);c.vO||this.fc.uw(c,a);return 32}yGj(a,b,c,f,l){if(this.fc.qO(this.Ub.Gf))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.wxk;l=l.uKi;f=null;this.Da.fD?(c=this.pa.Re(),1<=c.length&&(c.sort((y,G)=>y.qe-G.qe),f=c[c.length-1])):f=this.Sb.Qk(c);c=this.wA.FSc(f,b,l,a);this.zzf(b,l);c.vO||
this.fc.uw(c,a);return 32}dispose(){this.Wu.Nbl(Object(H.a)(this,this.hfh,"openIgnoredDialog"));this.Lwa=null}E0c(a,b){const c=this.ua.Ba;let f=nc.a.empty;c&&(f=c.Cb);const l=this.Sb.bJ();l&&("0"===a||"0"===b?{mj:a,Qn:b}=this.QVc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.Ja(ea.a.hid,2,new NE(f,a,b)))}iIj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.O9e(l.SourceControlId)).returnValue)return 8;f=this.ua.Ba;a=nc.a.empty;f&&(a=f.Cb);l=this.Sb.bJ();if(!l)return 8;"0"===c||"0"===
b?{mj:c,Qn:b}=this.QVc(l,f):(c=parseInt(c),b=parseInt(b));ya.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.Ja(ea.a.hid,2,new NE(a,c,b))}QVc(a,b){let c,f;f=c=0;if(!this.h5i(a))return{mj:c,Qn:f};if(b){c=b.mj;if(!c)return{mj:c,Qn:f};if(!this.Da.gdc||this.F5i(c)){f=b.Qn;if(!f)return{mj:c,Qn:f};if(b.zWa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Da.gdc?
0:a[0].ContentMasters[0].Id;return{mj:c,Qn:f}}J_f(a,b,c){if(1===a)return 32;a=this.O9e(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[vm.a.On]=a.layoutId===(c?this.N_g.toString():this.O_g.toString()));return 32}aod(a,b,c,f,l){return this.J_f(c,l,!1)}oTe(a,b,c,f,l){return this.J_f(c,l,!0)}O9e(a){let b,c;c=b=null;if(!a)return ya.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");
const f=qd.a(mj.UKf),l=f?1:0,y=f?2:1;if(!a||a.length!==(f?3:2))return ya.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[y];return{returnValue:!0,masterId:b,layoutId:c}}h5i(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}hfh(){this.lwa&&(ya.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",this.lwa===ea.a.Eja?
"ChangeLayout":"NewSlide"),this.ia.processAction(this.lwa,2));this.lwa=0}Onb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}zzf(a,b){Kc.a.yk("MainMasterId",a.toString());Kc.a.yk("ContentMasterId",b.toString());const c=this.Sb.bJ(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));ya.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",
c.length,f,a,b)}}ate(){return this.Wu.pFf()}F5i(a){if(0===a)return!1;const b=this.Sb.Txb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}Wge(a,b,c,f){this.Da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},w.AFrameworkApplication.eKb.handleCommand(zf.ActionManager.n7a(a),b),f||c(),a=2):a=8:a=8;return a}static DZj(a){return a===mj.sxi||a===
mj.txi||a===mj.qxi||a===mj.uxi||a===mj.rxi}static h2d(){return{"margin-top":"5px","max-width":"100px","font-size":"10px"}}}mj.sxi=1041;mj.txi=1042;mj.qxi=2052;mj.uxi=1028;mj.rxi=3076;mj.ENj="LayoutIcon";mj.UKf="ReactSlideLayoutButtonIdChange";mj.eyi="SlideLayoutActor";mj.CIf=145;mj.pxi=82;mj.KIf=24;mj.ixi=14;mj.vxi=5;mj.fgd=1;Object(m.a)(mj,"SlideLayoutActor",null,[268,108]);class VN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.oG=this.S$=this.rgb=this.T$=null;this.ia=a;this.oR=b;this.Fa=c;this.fc=
f;this.wA=l;this.Ub=y;this.ua=G;this.ic=R;this.xe=ja;this.bxe=za(500,Object(H.a)(this,this.wmd,"performKeyboardThumbnailReorder"));this.pa=Va;this.En=hb;this.tfa=Cb}vb(){this.ia.ra(ea.a.pmc,rb.a.application,Object(H.a)(this,this.rGj,"handleMoveSlide"),4);this.ia.ra(ea.a.a7g,rb.a.application,Object(H.a)(this,this.sGj,"handleMoveSlideById"),4);this.ia.ra(ea.a.Zhb,qc.a.application,Object(H.a)(this,this.tZc,"handleReorderSlide"),4);this.ia.ra(ea.a.Whb,qc.a.application,Object(H.a)(this,this.tZc,"handleReorderSlide"),
4);this.ia.ra(ea.a.Yhb,qc.a.application,Object(H.a)(this,this.tZc,"handleReorderSlide"),4);this.ia.ra(ea.a.Xhb,qc.a.application,Object(H.a)(this,this.tZc,"handleReorderSlide"),4);this.ia.ra(ea.a.qmc,qc.a.application,Object(H.a)(this,this.SDj,"handleCommitPendingMoveSlideData"),4);this.ia.ra(ea.a.rmc,qc.a.application,Object(H.a)(this,this.CHj,"handleQueryCommitMoveSlideDataEnabled"),100)}me(){const a=this.Fa.Ic(Si.a.fE);a.bindAction(x.KeyInputManager.Va(B.a.B2,x.KeyInputManager.Te),ea.a.Zhb);a.bindAction(x.KeyInputManager.Va(B.a.A2,
x.KeyInputManager.Te),ea.a.Whb);a.bindAction(x.KeyInputManager.Va(B.a.B2,x.KeyInputManager.Te|4),ea.a.Yhb);a.bindAction(x.KeyInputManager.Va(B.a.A2,x.KeyInputManager.Te|4),ea.a.Xhb)}sGj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.tfa&&(this.En&&1<this.pa.Re().length||this.fc.LVa()))return 16;if(1===c)return 32;if(!l)return ya.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.Xfa;c=[];for(var y of b)(b=a.XC(y))?c.push(b):
ya.a.J(50348435,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",y.sid,y.cid);y=l.Ba?a.XC(l.Ba):null;b=a.XC(l.hmc);f=null;0<=l.sectionIndex&&(f=a.Bcg(l.sectionIndex));return this.qhg(c,b,y,f,l.Ipe)}rGj(a,b,c,f,l){return!this.tfa&&(this.En&&1<this.pa.Re().length||this.fc.LVa())?16:1===c?32:l?this.qhg(l.Xfa,l.hmc,l.Ba,null,l.Ipe):8}qhg(a,b,c,f,l){if(this.tfa)for(var y of a)if(!y||this.fc.fd(this.ic.Qk(y.Cb)))return 16;y=[];for(var G of a){if(!G)continue;const R=this.ic.Qk(G.Cb);
R?y.push(R):ya.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",G.Cb.sid,G.Cb.cid)}if(G=Kc.a.Kb)G.Qj=!0,G.HF||(G.HF=new Date),y&&G.Wa("SlideCount",a.length.toString());G=null;l||(this.tfa?c&&(G=c):a&&0<a.length&&(G=a[0]),G&&!this.Ub.Ba.Cb.equals(G.Cb)&&(this.Ub.Ba=this.ic.Qk(G.Cb)));a=b?this.ic.Qk(b.Cb):null;this.wA.R3i(y,a,f);return 32}tZc(a,b,c){if(this.oR.h0||!this.ua.Ba||this.fc.fd(this.Ub.Gf)||!this.tfa&&this.En&&1<this.pa.Re().length)return 16;if(1===
c)return 32;if(this.tfa){b=this.pa.Re();if(!b||!b.length)return 16;this.LKl(b,a)}else this.GKl(this.ua.Ba,a);return 32}SDj(a,b,c){if(this.fc.fd(this.Ub.Gf)||!this.vLf())return 16;if(1===c)return 32;this.wmd();return 32}CHj(){return this.T$?32:16}Etb(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}GKl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.xe.wZ;if(!(1>=f)){var l=
!1;this.rgb||(this.rgb=a,this.oG=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.oG[c]&&this.rgb.Cb.equals(this.oG[c].Cb)){a=c;break}if((b!==ea.a.Zhb&&b!==ea.a.Yhb||a)&&(b!==ea.a.Whb&&b!==ea.a.Xhb||a!==f-1)){switch(b){case ea.a.Zhb:b=a-1;break;case ea.a.Whb:b=a+1;break;case ea.a.Yhb:b=0;break;case ea.a.Xhb:b=f-1;break;default:return}Array.removeAt(this.oG,a);Array.insert(this.oG,b,this.rgb);for(l=0;l<f;l++)this.oG[l]?this.oG[l].qe=l:ya.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",
l,f);this.xe.Uya(b);f=new Xx(!0,[this.rgb],0<b?this.oG[b-1]:null);this.vFf(f)}else l&&(this.oG=this.rgb=null)}}LKl(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.xe.wZ;if(!(1>=f)&&(a.sort((y,G)=>y.slideIndex-G.slideIndex),this.Etb(a))){var l=!1;this.S$||(this.S$=a,this.oG=c.slides||[],l=!0);a=this.fYc(this.S$[0],this.oG);c=this.fYc(this.S$[this.S$.length-1],this.oG);if((b!==ea.a.Zhb&&b!==ea.a.Yhb||a)&&(b!==ea.a.Whb&&b!==ea.a.Xhb||c!==f-1)){l=null;
switch(b){case ea.a.Zhb:l=0<=a-2?this.oG[a-2]:null;b=a-1;break;case ea.a.Whb:b=a+this.S$.length<f?a+this.S$.length:f-1;l=this.oG[b];break;case ea.a.Yhb:l=null;b=0;break;case ea.a.Xhb:l=this.oG[f-1];b=f-1;break;default:return}for(a=this.S$.length-1;0<=a;a--)this.Omi(this.S$[a],l);for(a=0;a<f;a++)this.oG[a]?this.oG[a].qe=a:ya.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.xe.Uya(b);f=new Xx(!0,this.S$,l);this.vFf(f)}else l&&(this.oG=
this.S$=null)}}Omi(a,b){const c=this.fYc(a,this.oG);Array.removeAt(this.oG,c);b=this.fYc(b,this.oG)+1;Array.insert(this.oG,b,a)}fYc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Cb.equals(b[c].Cb))return c;return-1}eqi(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Cb.equals(f.Cb)){a=!0;break}if(!a)return!1}return!0}vFf(a){if(!a)throw Error.argumentNull("moveData");this.tfa?this.eqi(this.S$,a.Xfa)||this.wmd():this.T$&&this.T$.Xfa&&
a.Xfa&&this.T$.Xfa[0]&&a.Xfa[0]&&!this.T$.Xfa[0].Cb.equals(a.Xfa[0].Cb)&&this.wmd();this.T$=a;this.bxe.perform()}wmd(){if(this.vLf()){var a=this.T$;this.S$=this.rgb=this.T$=null;Array.clear(this.oG);this.ia.Ja(ea.a.pmc,2,a)}}vLf(){const a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.T$)return!1;let b=!0,c=!this.T$.hmc;for(let f=0;f<this.T$.Xfa.length;f++)b=!!a.XC(this.T$.Xfa[f].Cb)&&b;c||(c=!!a.XC(this.T$.hmc.Cb));return b&&c}}Object(m.a)(VN,"SlideMoveActor",
null,[268]);class jy extends ox.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(jy,"TableGalleryButtonProps",ox.a,[]);class WN extends jy{constructor(){super()}get Type(){return 8}}Object(m.a)(WN,"ChangeColorsGalleryButtonProps",jy,[]);class XN{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(m.a)(XN,"SmartArtInfo",null,[]);var vt=d(501);class aj{constructor(a,b,c){this.lG=a;
this.Hqk=b;this.rtk=c}get id(){return this.lG}get parameter(){return this.Hqk}get iuh(){return this.rtk}}Object(m.a)(aj,"SmartArtColorInfo",null,[]);class YN{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb){this.pq=[];this.ia=a;this.fc=b;this.jb=c;this.Fb=f;this.Fa=l;this.ua=y;this.Rq=G;this.Sb=R;this.Eb=za;this.kj=Va;this.Ga=hb;this.xUk()}vb(){this.ia.ra(ea.a.IFa,rb.a.view,Object(H.a)(this,this.IFj,"handleInsertSmartArt"),4);this.ia.ra(ea.a.xGh,rb.a.application,Object(H.a)(this,this.pJj,"handleSmartArtToolsTabViewHandler"),
4);this.ia.ra(ea.a.$1b,rb.a.application,Object(H.a)(this,this.IDj,"handleChangeSmartArtLayout"),4);this.ia.ra(ea.a.Lih,rb.a.application,Object(H.a)(this,this.pHj,"handlePopulateSmartArtColorStyles"),96);this.ia.ra(ea.a.Z1b,rb.a.application,Object(H.a)(this,this.GDj,"handleChangeSmartArtColor"),4);this.ia.ra(ea.a.XKf,rb.a.application,Object(H.a)(this,this.HDj,"handleChangeSmartArtColorAnchor"),4);this.ia.ra(ea.a.oL,rb.a.application,Object(H.a)(this,this.JDj,"handleChangeSmartArtStyle"),4);this.ia.ra(ea.a.Iya,
rb.a.application,Object(H.a)(this,this.zIj,"handleResetSmartArt"),4);this.ia.ra(ea.a.bZe,rb.a.application,Object(H.a)(this,this.DIj,"handleReverseSmartArt"),4);this.ia.ra(ea.a.lod,rb.a.application,Object(H.a)(this,this.HHj,"handleQueryReverseSmartArt"),97);this.ia.ra(ea.a.HXf,rb.a.application,Object(H.a)(this,this.AEj,"handleEditSmartArtText"),4);this.ia.ra(ea.a.Qnd,rb.a.application,Object(H.a)(this,this.DHj,"handleQueryEditSmartArtText"),96)}me(){}IFj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.fc.fd(b))return 16;
if(1===c)return 32;this.Zld(l,a);if(!l)return 8;if((c=b.R_(this.jb.Ud()))&&this.fc.fd(c))return 16;if(!this.kj.hD(b,1))return this.kj.KD(b),16;const y=this.qwj(b,c,l);l=this.Fb.yd(15,void 0,()=>{this.jb.iu();this.jb.nh();this.Fa.Bd()},()=>{this.jb.selectShape(Object(sa.a)(4,y),!0)});try{l.jc(b),l.gd=a,c&&b.cS([c]),b.oB(Object(sa.a)(4,y))}finally{l&&l.dispose()}this.Rq.oA=Object(sa.a)(4,y);return 32}pJj(){return Object(sa.a)(566,this.eAa())?32:16}IDj(a,b,c,f,l){b=this.eAa();if(!b||this.fc.fd(b))return 16;
if(1===c)return 32;c=this.jb.Ud();for(var y of c){if(y.Wf){b=y;break}if(y.get_smartArtModelId()){b=this.Ga.Lr(y);this.jb.O8(y);this.jb.selectShape(b,!1);break}}this.Zld(l,a);y=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{y.jc(b),y.gd=a,Object(sa.a)(566,b).ensureModelData().get_elementCollection().documentElement.Hpa=l}finally{y&&y.dispose()}return 32}pHj(a,b,c,f,l){if(!this.eAa())return 16;a=this.jb.Fk();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=
this.Pvi(a):l.MenuItems=this.Dvi(a);return 32}GDj(a,b,c,f,l){b=this.eAa();if(!b||this.fc.fd(b))return 16;if(1===c)return 32;this.Zld(l,a);c=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{c.jc(b),c.gd=a,Object(sa.a)(566,b).ensureModelData().get_elementCollection().documentElement.tza=l}finally{c&&c.dispose()}return 32}HDj(){return this.eAa()?32:16}JDj(a,b,c,f,l){b=this.eAa();if(!b||this.fc.fd(b))return 16;if(1===c)return 32;this.Zld(l,a);c=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});
try{c.jc(b),c.gd=a,Object(sa.a)(566,b).ensureModelData().get_elementCollection().documentElement.uza=l}finally{c&&c.dispose()}return 32}zIj(a,b,c){b=Object(sa.a)(566,this.eAa());if(!b||this.fc.fd(Object(sa.a)(4,b)))return 16;if(1===c)return 32;c=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{c.jc(b),c.gd=a,b.Iya=!0}finally{c&&c.dispose()}return 32}DIj(a,b,c){b=this.eAa();if(!b||!b.tre||this.fc.fd(b))return 16;if(1===c)return 32;c=new XN;c.fReverseEnabled=b.tre;c.fReverseChecked=!b.sre;
const f=this.Fb.yd(15,void 0,()=>{this.jb.nj();this.Fa.Bd()});try{f.jc(b),f.gd=a,Object(sa.a)(566,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=c}finally{f&&f.dispose()}return 32}HHj(a,b,c,f,l){a=this.eAa();a=!!a&&a.sre;if(!Object(Sa.a)(gi.a,l))return 8;l.If(a);return 32}AEj(a,b,c){a=this.eAa();if(!a||this.fc.fd(a))return 16;if(1===c)return 32;this.ia.Ja(ea.a.mRa,2,new Zl.a(a,!0,null));return 32}DHj(a,b,c,f,l){a=this.jb.uz();if(!Object(Sa.a)(gi.a,l))return 8;l.If(a);return 32}qwj(a,
b,c){if(!a)return null;const f=a.Cs();let l;l=b?b.Jyb(Pd.a.UR,Pd.a.BY):this.Sb.Uka(Pd.a.UR,Pd.a.BY);return a.J2d(!0,0,b,c,l.x,l.y,Pd.a.UR,Pd.a.BY,f+1)}eAa(){const a=this.jb.Ud();for(const b of a){if(b.Wf)return b;if(b.get_smartArtModelId())return this.Ga.Lr(b)}return null}xUk(){Array.add(this.pq,new aj(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.pq,new aj(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.pq,new aj(2,"accent0_3,mainScheme",
ResourceStrings.L_SmartArtDark2Fill));Array.add(this.pq,new aj(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.pq,new aj(4,"colorful2,colorful",ResourceStrings.L_SmartArtColorful2));Array.add(this.pq,new aj(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.pq,new aj(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.pq,new aj(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.pq,new aj(8,"accent1_1,accent1",
ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.pq,new aj(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.pq,new aj(10,"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.pq,new aj(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.pq,new aj(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.pq,new aj(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));
Array.add(this.pq,new aj(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.pq,new aj(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));Array.add(this.pq,new aj(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.pq,new aj(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.pq,new aj(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.pq,new aj(19,"accent3_2,accent3",
ResourceStrings.L_SmartArtColoredFill3));Array.add(this.pq,new aj(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.pq,new aj(21,"accent3_4,accent3",ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.pq,new aj(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.pq,new aj(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.pq,new aj(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));
Array.add(this.pq,new aj(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.pq,new aj(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));Array.add(this.pq,new aj(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.pq,new aj(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.pq,new aj(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.pq,new aj(30,"accent5_3,accent5",
ResourceStrings.L_SmartArtGradientRange5));Array.add(this.pq,new aj(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.pq,new aj(32,"accent5_5,accent5",ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.pq,new aj(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.pq,new aj(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.pq,new aj(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));
Array.add(this.pq,new aj(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.pq,new aj(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}Dvi(a){const b=Object.assign(new bo.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new el.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=vj.Color.fj(a.Fd.Light1),l=vj.Color.fj(a.Fd.Dark1),y=vj.Color.fj(a.Fd.Light2),G=vj.Color.fj(a.Fd.Dark2),
R=Array(6);R[0]=vj.Color.fj(a.Fd.Accent1);R[1]=vj.Color.fj(a.Fd.Accent2);R[2]=vj.Color.fj(a.Fd.Accent3);R[3]=vj.Color.fj(a.Fd.Accent4);R[4]=vj.Color.fj(a.Fd.Accent5);R[5]=vj.Color.fj(a.Fd.Accent6);a=0;Array.add(c.ControlList,({R$b:a}=this.xvi(a,f,l,y,G)).returnValue);Array.add(c.ControlList,({R$b:a}=this.rui(a,f,R)).returnValue);Array.addRange(c.ControlList,({R$b:a}=this.bui(a,f,R)).returnValue);return b}xvi(a,b,c,f,l){const y=Object.assign(new Hq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",
ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(y.GalleryItems,this.Glc(b,c,a++));Array.add(y.GalleryItems,this.Glc(b,l,a++));Array.add(y.GalleryItems,this.Glc(l,f,a++));return{returnValue:y,R$b:a}}rui(a,b,c){const f=Object.assign(new Hq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,
Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.Qgd(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,this.FJe(c[l],c[l+1],b,a++));return{returnValue:f,R$b:a}}bui(a,b,c){const f=[];for(let G=0;6>G;G++){const R=Object.assign(new Hq.a,{Id:"ColorfulGallery"+(G+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(G+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,G+1),Type:8,
Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new vj.Color;l.r=l.g=l.b=255;var y=new vj.Color;l=vj.Color.x_(c[G],l,.5);y=vj.Color.x_(c[G],y,.25);Array.add(R.GalleryItems,this.Glc(b,c[G],a++));Array.add(R.GalleryItems,this.Glc(c[G],b,a++));Array.add(R.GalleryItems,this.FJe(c[G],l,b,a++));Array.add(R.GalleryItems,this.Kxk(y,c[G],l,b,a++));Array.add(R.GalleryItems,this.FJe(c[G],l,b,a++));Array.add(f,R)}return{returnValue:f,R$b:a}}Glc(a,b,c){return this.Qgd(a,a,a,a,a,a,b,c)}FJe(a,b,c,
f){const l=vt.a.x_(a,b,2/6),y=vt.a.x_(a,b,.5),G=vt.a.x_(a,b,4/6),R=vt.a.x_(a,b,5/6);return this.Qgd(a,l,y,G,R,b,c,f)}Kxk(a,b,c,f,l){const y=vj.Color.x_(b,c,.5);return this.Qgd(a,b,y,c,y,b,f,l)}Qgd(a,b,c,f,l,y,G,R){R=this.pdg(R);const ja="ChangeSmartArtColor__"+R.parameter.replace(",","__");return Object.assign(new WN,{Id:ja,ExternalId:ja,MenuItemId:R.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:R.iuh,TableCellStyles:[this.fIb(a,G),this.fIb(b,G),this.fIb(c,G),this.fIb(f,G),this.fIb(l,
G),this.fIb(y,G)]})}fIb(a,b){const c={};c.backgroundColor=this.BNf(a);c.border=String.format("1px solid {0}",this.BNf(b));return c}BNf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",a.r,a.g,a.b)}Pvi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new vj.Color;c.r=c.g=c.b=255;const f=new vj.Color,l=vj.Color.fj(a.Fd.Light1);var y=vj.Color.fj(a.Fd.Dark1),G=vj.Color.fj(a.Fd.Light2),R=vj.Color.fj(a.Fd.Dark2);const ja=Array(6);ja[0]=vj.Color.fj(a.Fd.Accent1);
ja[1]=vj.Color.fj(a.Fd.Accent2);ja[2]=vj.Color.fj(a.Fd.Accent3);ja[3]=vj.Color.fj(a.Fd.Accent4);ja[4]=vj.Color.fj(a.Fd.Accent5);ja[5]=vj.Color.fj(a.Fd.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.Flc(b,l,y,a++);this.Flc(b,l,R,a++);this.Flc(b,R,G,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',
ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.Mgd(b,ja[1],ja[2],ja[3],ja[4],ja[5],ja[1],l,a++);for(y=1;5>y;y++)this.BJe(b,ja[y],ja[y+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(y=0;6>y;y++)G=String.format(ResourceStrings.L_AccentFormat,y+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',y+1,G)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',
y+1)),G=vj.Color.x_(ja[y],c,.5),R=vj.Color.x_(ja[y],f,.25),this.Flc(b,l,ja[y],a++),this.Flc(b,ja[y],l,a++),this.BJe(b,ja[y],G,l,a++),this.Fxk(b,R,ja[y],G,l,a++),this.BJe(b,ja[y],G,l,a++),b.append("</Gallery>"),b.append("</MenuSection>");b.append("</Menu>");return b.toString()}Flc(a,b,c,f){this.Mgd(a,b,b,b,b,b,b,c,f)}BJe(a,b,c,f,l){const y=vt.a.x_(b,c,2/6),G=vt.a.x_(b,c,.5),R=vt.a.x_(b,c,4/6),ja=vt.a.x_(b,c,5/6);this.Mgd(a,b,y,G,R,ja,c,f,l)}Fxk(a,b,c,f,l,y){const G=vj.Color.x_(c,f,.5);this.Mgd(a,b,
c,G,f,G,c,l,y)}Mgd(a,b,c,f,l,y,G,R,ja){ja=this.pdg(ja);a.append('<GalleryButton Id="');a.append(ja.parameter);a.append('" Command="');a.append(ea.a.Z1b.toString());a.append('" QueryCommand="');a.append(ea.a.yc.toString());a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.gIb(a,b,R,8,-1);this.gIb(a,c,R,34,-1);this.gIb(a,f,R,8,16);this.gIb(a,l,R,34,16);this.gIb(a,y,R,8,33);this.gIb(a,G,R,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');
a.append(ja.iuh);a.append('"/>')}Zld(a,b){a.Uri=b===ea.a.Z1b?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===ea.a.oL?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+
a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}pdg(a){let b;for(let c=0;c<this.pq.length;c++)if(b=this.pq[c],b.id===a)return b;return new aj(-1,"","")}gIb(a,b,c,f,l){a.append("&lt;div style=&quot;");b.T7d()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.T7d()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",
c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(m.a)(YN,"SmartArtActor",null,[268]);class ky{constructor(a,b,c,f){this.OHe="BottomOverlaid";this.ia=a;this.Jc=f;this.ic=b;this.Fc=c;this.PHe="productionSpokenLanguages_"+this.Jc.Ipa;this.QHe="productionSubtitleLanguages_"+this.Jc.aAa}vb(){ya.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Jc.Rh);this.ia.ra(ea.a.r0a,qc.a.application,Object(H.a)(this,
this.r0a,"querySubtitleIsEnabled"),96);this.ia.ya(ea.a.VMa,qc.a.application,Object(H.a)(this,this.VMa,"toggleUseSubtitles"));this.ia.ra(ea.a.Iod,qc.a.application,Object(H.a)(this,this.e0k,"querySubtitleSettingsIsEnabled"),96);this.ia.ra(ea.a.ijb,qc.a.application,Object(H.a)(this,this.ijb,"populateTranscriptionSubtitleLanguage"),96);this.ia.ra(ea.a.hjb,qc.a.application,Object(H.a)(this,this.hjb,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(ea.a.BLl,qc.a.application,Object(H.a)(this,this.TJj,
"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(ea.a.CLl,qc.a.application,Object(H.a)(this,this.UJj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.ra(ea.a.MUe,qc.a.application,Object(H.a)(this,this.MUe,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.ra(ea.a.NUe,qc.a.application,Object(H.a)(this,this.NUe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.ra(ea.a.Rjb,qc.a.application,Object(H.a)(this,this.Rjb,"querySubtitlesBottomOverlay"),96);this.ia.ya(ea.a.DQb,qc.a.application,
Object(H.a)(this,this.DQb,"toggleSubtitlesBottomOverlay"));this.ia.ra(ea.a.Sjb,qc.a.application,Object(H.a)(this,this.Sjb,"querySubtitlesTopOverlay"),96);this.ia.ya(ea.a.EQb,qc.a.application,Object(H.a)(this,this.EQb,"toggleSubtitlesTopOverlay"));this.ia.ra(ea.a.Qjb,qc.a.application,Object(H.a)(this,this.Qjb,"querySubtitlesBelowSlide"),96);this.ia.ya(ea.a.CQb,qc.a.application,Object(H.a)(this,this.CQb,"toggleSubtitlesBelowSlide"));this.ia.ra(ea.a.Pjb,qc.a.application,Object(H.a)(this,this.Pjb,"querySubtitlesAboveSlide"),
96);this.ia.ya(ea.a.BQb,qc.a.application,Object(H.a)(this,this.BQb,"toggleSubtitlesAboveSlide"))}me(){}r0a(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return 8;l.If(this.Jc.Rh);return 32}e0k(a,b,c,f,l){return 1===c?this.ic.rj()?32:8:l&&"object"===typeof l?this.Jc&&this.Jc.j6b?32:(ya.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(ya.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}Rjb(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return ya.a.J(512500163,
822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.If("BottomOverlay"===this.Jc.gw);ya.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.Jc.gw);return 32}Sjb(a,b,c,f,l){if(!l||!Object(Sa.a)(gi.a,l))return 8;l.If("TopOverlay"===this.Jc.gw);ya.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Jc.gw);return 32}Qjb(a,b,c,f,l){try{l&&l.If("BelowSlide"===this.Jc.gw)}catch(y){ya.a.J(512500131,
822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",y)}return 32}Pjb(a,b,c,f,l){try{l&&l.If("AboveSlide"===this.Jc.gw)}catch(y){ya.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",y)}return 32}VMa(a,b,c,f,l){if(1===c)return this.ic.rj()?32:8;if(!l||"object"!==typeof l)return 8;this.Jc.Rh&&(Ti.a.qK("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Ti.a.aK)||ya.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Jc.Rh=
!this.Jc.Rh;ya.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Jc.Rh);Sc.App.Mb.pF({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}ijb(a,b,c,f,l){try{if(1===c)return 32;if(!l)return ya.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.Jih(l,!1)}catch(y){ya.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",y)}return 32}hjb(a,b,c,f,l){try{if(1===
c)return 32;if(!l)return ya.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.Jih(l,!0)}catch(y){ya.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",y)}return 32}UJj(a,b,c,f,l){try{if(l){this.Jc.aAa=l.MenuItemId;this.Jc.onb=this.Jc.JYc();const y=l.SourceControlId;this.QHe!==y&&(a={},a[y]="ToggleButtonModel",a[this.QHe]="ToggleButtonModel",Sc.App.Mb.pF(a),this.QHe=y)}}catch(y){ya.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",
y)}return 32}NUe(a,b,c,f,l){try{l&&(l[Ih.a.On]=l.MenuItemId.toLowerCase()===this.Jc.aAa.toLowerCase())}catch(y){ya.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",y)}return 32}TJj(a,b,c,f,l){try{if(l){this.Jc.Ipa=l.MenuItemId;const y=l.SourceControlId;this.PHe!==y&&(a={},a[y]="ToggleButtonModel",a[this.PHe]="ToggleButtonModel",Sc.App.Mb.pF(a),this.PHe=y)}}catch(y){ya.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",y)}return 32}MUe(a,
b,c,f,l){try{l&&(l[Ih.a.On]=l.MenuItemId.toLowerCase()===this.Jc.Ipa.toLowerCase())}catch(y){ya.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",y)}return 32}DQb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[Ih.a.On]&&(this.Jc.gw="BottomOverlay",ya.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.Pzd(l.SourceControlId);
return 32}EQb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[Ih.a.On]&&(this.Jc.gw="TopOverlay",ya.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.Pzd(l.SourceControlId);return 32}CQb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[Ih.a.On]&&
(this.Jc.gw="BelowSlide",ya.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.Pzd(l.SourceControlId);return 32}BQb(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return ya.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[Ih.a.On]&&(this.Jc.gw="AboveSlide",ya.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.Pzd(l.SourceControlId);return 32}Jih(a,b){a.MenuItems=
Object.assign(new bo.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Jc.q6e)&&0<b.count&&(b=ky.iSf(b,"productionSpokenLanguages",""),Array.add(a.MenuItems.MenuSectionList,b)),(b=this.Jc.p6e)&&0<b.count&&(b=ky.iSf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Jc.SPb)&&0<ta.a.count(b)&&(b=ky.kSi(this.Jc.a5e),Array.add(a.MenuItems.MenuSectionList,b));
a.PopulationXML=Bj.l(a.MenuItems)}Pzd(a){if(this.OHe!==a){const b={};b[a]="ToggleButtonModel";b[this.OHe]="ToggleButtonModel";Sc.App.Mb.pF(b);this.OHe=a;this.Fc.Uy(new lq.a(1))}}static iSf(a,b,c){c=Object.assign(new el.a,{DisplayMode:"Menu",Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),y=Object.assign(new Wy.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:ab.a.He(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Ne.a.Gtb});
Array.add(c.ControlList,y)}catch(l){ya.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static kSi(a){const b=Object.assign(new el.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new Wy.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:ab.a.He(c).displayName,
Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Ne.a.Gtb});Array.add(b.ControlList,f)}catch(f){ya.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",c,f)}return b}}Object(m.a)(ky,"SubtitleActor",null,[268]);var lS=d(413);class Co{constructor(a){this.ey=this.ot=this.ov=this.GK=this.FI=null;this.h_=a}get U0b(){return this.GK||(this.GK=Fb.a.instance.rb("Box4.IAutoCorrectRules"))}get Wca(){return this.ov||
(this.ov=Fb.a.instance.rb("Box4.IAutoCorrectScheduler"))}get gK(){return this.FI||(this.FI=Fb.a.instance.rb("Box4.Pages.IPageContentEditor"))}get dC(){return this.ey||(this.ey=Fb.a.instance.rb("Box4.IOutlineEditor"))}get Yn(){return this.ot||(this.ot=this.h_())}MCb(a,b,c){if(this.dC&&Co.oh){var f=Th.ContextSetEditor.Zbe(b);a=f.node;Jb.SelectionEditor.nm(f)&&(f=bb.a.Oj(a,zb.ParagraphReader.textLength(a)));var l=wb.a.language(wb.a.Es(f));f=ub.GraphIterator.pb(c.Ag);Co.tm.uLa(f);var y=a=null;if(f)for(let G=
f.Db(1);G&&!y;G=f.Pj(1))uj.OutlineReader.wX(G)&&(y=G);if(f&&!y){if(!this.gK||!this.dC)return;a=new pf.GraphTransaction(7);a.Xy(f);y=this.gK.K3b(f);this.dC.Gtd(y,c.v9b());this.dC.vW(f,!0);l&&(rc.OutlineElementNavigator.yi(f),f=bb.a.Oj(f.currentNode,0),Co.oh.z1a(wb.a.Es(f),l))}l=Vd.SelectionFactory.Ej(y,!0);c.Nb.setSelection(l);Jb.SelectionEditor.Xg(b)&&(c=ub.GraphIterator.pb(b.node),c.mv(),Sg.OutlineNavigator.hrd(c),this.U0b&&this.Wca&&uj.OutlineReader.eD(c,b,!0)&&(b=this.U0b.P8d(b,-1,!1,B.a.$q))&&
this.Wca.Rwh(b));this.Yn&&this.Yn.Dw();a&&a.dispose()}}a7d(a,b,c){a=ub.GraphIterator.pb(c.Ag);a=lS.a(a);a=Vd.SelectionFactory.Ej(a,!1);c.Nb.setSelection(a)}static get oh(){return Co.Jf||(Co.Jf=Fb.a.instance.rb("Box4.IFormattingEditor"))}static get instance(){return Co.La||(Co.La=Co.VC())}static VC(){return new Co(()=>Fb.a.instance.rb("Box4.IUndoManager"))}static get tm(){return Hy.PageNavigator.instance}}Co.La=null;Co.Jf=null;Object(m.a)(Co,"TitleViewEditor",null,[]);class Eu{constructor(a,b,c,f=
null,l=null,y,G,R=null,ja=null){this.ot=null;this.lxf=!1;this.h_=a;this.OQd=b;this.Um=c;this.GK=f;this.ov=l;this.kd=R;this.Mk=ja}get Yn(){return this.ot||(this.ot=this.h_())}vb(){const a=w.AFrameworkApplication.Qa,b=Object(H.a)(this,this.aIl,"tabView");a.ra(C.a.tab,rb.a.view,b,1124);a.ra(C.a.juc,rb.a.view,b,1124);a.ya(C.a.qmg,rb.a.view,zf.ActionManager.Sg)}aIl(a,b,c,f,l){if(1===c)return 32;const y=a===C.a.juc;if(!b.view.Uh)return 2;const G=b.view,R=G.Nb;var ja=R.ak;if(!ja||M.a.instance.ga(14)&&Eu.ij.U8a(ja))return 2;
if(this.Um&&this.Um.instance&&this.Um.instance.qX(ja))return 4;var za=null,Va=zf.ActionManager.k6,hb=!1,Cb=Jb.SelectionEditor.Xg(ja);if(ja.Cx){if(R.Pa.yH&&(Va=ja.getContext(0),za=new ub.GraphIterator,za.set(Va.node),za.mv(),Va=y?C.a.C_e:C.a.vsd),Va=this.OQd.UXk(Va,y?C.a.Ry:C.a.QC),Va===zf.ActionManager.k6){var lc=Eu.Cm.A3(ja,16);if(lc)y&&(Va=C.a.$hd),za=new ub.GraphIterator,za.set(lc.node),za.kf();else{if(M.a.instance.ga(77))return 2;if(Eu.LYj(ja)){if(y)return 2;Va=C.a.MCb}else Va=y?C.a.Ry:C.a.QC}}}else if(ja.Rk)za=
new ub.GraphIterator,za.set(ja.node),Jb.SelectionEditor.Pt(za),uj.OutlineReader.Nla(ja)?Va=y?C.a.C_e:C.a.vsd:(Va=y?this.OQd.jCj(za,ja,Va):this.OQd.iCj(za,ja,Va),he.OutlineElementReader.hh(za)&&ja.contextId===rb.a.Mf&&(hb=he.OutlineElementReader.eD(za,ja,!1)),(lc=Bb.ListReader.Hk(za)&&hb)&&ha.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Va===C.a.QC),Va!==zf.ActionManager.k6||Oc.isTableCellOrInside(za)||lc||(this.lxf||(ha.ULS.sendTraceTag(39662619,383,
50,"User tried to insert inline tabs"),this.lxf=!0),w.AFrameworkApplication.Qa.processAction(C.a.qmg,2),w.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.kd&&this.kd.isFeatureEnabled(84)&&this.kd.isFeatureEnabled(83)));else return 2;if(!y&&Va===zf.ActionManager.k6&&Oc.isTableCellOrInside(za))if(ae.returnToCell(za),Oc.isLastCellInTable(za)||Hd.TableReader.kBb(za)&&Oc.isLastCellInTableIgnoringGhostCells(za)){if(Va=this.WSd(za,ja),!Va)return 2}else Va=
C.a.F7g;if(Va===zf.ActionManager.k6)return 2;switch(Va){case C.a.MCb:Co.instance.MCb(a,ja,b.view);ja=32;break;case C.a.a7d:Co.instance.a7d(a,ja,b.view);ja=32;break;case C.a.F7g:case C.a.$hd:hb=Va===C.a.$hd;Cb&&this.GK&&this.ov&&(Cb=this.GK.P8d(ja,-1,!0,B.a.$q))&&this.ov.Rwh(Cb);ja=32;ae.returnToCell(za);ae.moveToNextOrPreviousCell(za,hb)&&(Cb=!0,hb=!1,uj.OutlineReader.HZc(za)||(Sg.OutlineNavigator.XKe(za,!1),rc.OutlineElementNavigator.yi(za),zb.ParagraphReader.zs(za.currentNode)&&(Cb=!1,zb.ParagraphReader.textLength(za.currentNode)||
(hb=!0)),hb||ae.returnToCell(za)),hb?za=Vd.SelectionFactory.Qg(za.currentNode,0):(za=Vd.SelectionFactory.rl(za.currentNode),!Cb&&Jb.SelectionEditor.nm(za.jf)&&(Cb=za.toArray(),Array.removeAt(Cb,Cb.length-1),za=new Wb.Selection(Cb,za.Cf))),R.setSelection(za));break;case C.a.C_e:case C.a.vsd:Va===C.a.vsd?Sg.OutlineNavigator.i7g(za,!1):Sg.OutlineNavigator.i7g(za,!0);R.setSelection(Vd.SelectionFactory.rl(za.currentNode));ja=32;break;case C.a.c2a:ja=w.AFrameworkApplication.Qa.ii(b,Va,c,!0,f,l);1===Sc.App.mode&&
ae.moveToNextOrPreviousCell(za,!1)&&(ae.returnToCell(za),za=Vd.SelectionFactory.Ej(za.currentNode,!0),Jb.SelectionEditor.nm(za.jf)&&(Cb=za.toArray(),Array.removeAt(Cb,Cb.length-1),za=new Wb.Selection(Cb,za.Cf)),R.setSelection(za));break;default:if(ja=w.AFrameworkApplication.Qa.ii(b,Va,c,!0,f,l),!hb&&Cb&&(Va===C.a.Ry||Va===C.a.QC)){const ic=Jb.SelectionEditor.zja(R.Pa.nb).y;Sc.App.U6k(()=>{this.fBk(R,G,ic)})}}32===ja&&b.view.Uh&&this.Yn.Dw();return ja}fBk(a,b,c){if(a&&b){var f=a.Pa.nb;Jb.SelectionEditor.zja(f).y<
c?(b=Jb.SelectionEditor.A6b(b,f,!1),b=Jb.SelectionEditor.Bta(b,!1,!1,!1,!0)):b=Jb.SelectionEditor.ETc(b,f,!1);a.setSelection(b)}}WSd(){return C.a.Fua}X6g(a,b,c){if(a&&b){var f=a.Pa.nb;Jb.SelectionEditor.zja(f).y<c?(b=Jb.SelectionEditor.A6b(b,f,!1),b=Jb.SelectionEditor.Bta(b,!1,!1,!1,!0)):b=Jb.SelectionEditor.Bta(f,!1,!1,!1,!0);a.setSelection(b)}}static get ij(){return Mh.a.instance}static get Cm(){return Th.ContextSetEditor.instance}static LYj(a){a=Eu.Cm.A3(a,10);return!!a&&Je.a(a)}}Object(m.a)(Eu,
"TabActor",null,[]);class ZN extends Eu{constructor(a,b,c,f){super(a,b,c);this.la=f}WSd(a,b){return this.la.oCb?super.WSd(a,b):0}}Object(m.a)(ZN,"Box4TabActor",Eu,[]);class $N{constructor(a,b,c,f){this.gvk=new ZN(a,b,c,f)}vb(){this.gvk.vb()}me(){}}Object(m.a)($N,"TabActor",null,[268]);class aO{constructor(a,b,c){this.uIg=b;this.pa=a;this.gHa=c}UXk(a,b){const c=this.pa.ak;return c&&this.gHa.A3(c,16)?a:this.Q2e(b)?b:F.a.we}jCj(a,b,c){(c=Object(sa.a)(5,b.node))&&c.Ks()?c=C.a.$hd:(rc.OutlineElementNavigator.Se(a),
c=(Jb.SelectionEditor.tk(b)||Jb.SelectionEditor.Xg(b)&&he.OutlineElementReader.eD(a,b,!1))&&this.uIg.Gub(a)&&this.Q2e(C.a.Ry)?C.a.Ry:F.a.we,ya.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",c===C.a.Ry?"Promote":"DoNothing"));return c}iCj(a,b,c){const f=Object(sa.a)(5,a.Dq);if(f&&f.Ks())return c;rc.OutlineElementNavigator.Se(a);c=(Jb.SelectionEditor.tk(b)||Jb.SelectionEditor.Xg(b)&&he.OutlineElementReader.eD(a,b,!1))&&this.uIg.zMc(a)&&this.Q2e(C.a.QC)?C.a.QC:
F.a.we;ya.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===C.a.Ry?"Demote":"DoNothing");return c}Q2e(a){var b=this.pa.Pa.nb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(zb.ParagraphReader.rX(f.node)){if(b=f.node.sa(sb.a.listLevel,0),a===C.a.QC&&b>=mp.a.A8-1||a===C.a.Ry&&!b||this.pa.dM()&&mp.a.vqg(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(m.a)(aO,"TabActorPromoteDemoteStrategy",null,[650]);var bO=d(405),mS=d(876),cO=d(988);class bw extends ei.a{constructor(a,
b,c,f,l,y,G,R,ja){super(void 0,void 0,!0);this.Rva=null;this.lkk=b;this.UOg=f;this.SOg=l;this.NOg=y;this.HOg=G;this.ECg=R;this.DCg=ja;this.nxa=a;this.Ydb=c}jvd(){this.ig=this.lkk;const a={};a.bodyControls=this.W$d();this.sj(this.nxa,Object(H.a)(this,this.J4d,"dialogResultHandler"),a)}J4d(a,b){1===a&&this.Ydb(parseInt(this.xUa(b)),parseInt(this.lgj(b)));this.dispose()}W$d(){this.Rva=bw.Pae();const a={};this.YIi(a);this.bIi(a);return a}YIi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,
this.UOg,this.NOg),c=[cO.a("None",0,this.UOg,this.NOg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.ECg,["validUnits"]:c,["numberFormatInfo"]:this.Rva,["validReservedValues"]:[""]}}bIi(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.SOg,this.HOg),c=[cO.a("None",0,this.SOg,this.HOg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",
["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.DCg,["validUnits"]:c,["numberFormatInfo"]:this.Rva,["validReservedValues"]:[""]}}xUa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.ECg.toString()}lgj(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.DCg.toString()}static Pae(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",
["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(m.a)(bw,"AReactTableSizeDialog",ei.a,[]);class dO extends bw{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,"InsertTableDialog",a,1,1,35,35,2,5)}}Object(m.a)(dO,"ReactInsertTableDialog",bw,[]);class eO extends bw{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(m.a)(eO,"ReactSplitTableCellsDialog",bw,[]);var cw=d(631),fO=
d(971);class CF{constructor(a){this.PGa=a;if(!a)throw Error.argumentNull("m_actionData");}Js(){return!1}zn(){return this.PGa.TableNode}Fv(){var a;return null!==(a=this.PGa.CellNodes)&&void 0!==a?a:this.zn().Kab()}lZ(a){return a&&!!a.Ba}}Object(m.a)(CF,"TableActionDataContextHelper",null,[754]);class DF{constructor(a){this.pa=a;if(!a)throw Error.argumentNull("m_selectionManager");}Js(){return this.pa.Js()}zn(){return this.pa.zn()}Fv(){return this.pa.Fv()}lZ(a){let b=!1;a&&a.Ba&&(a=this.pa.Ll(),b=!!a&&
a.xd);return b}}Object(m.a)(DF,"TableSelectionManagerContextHelper",null,[754]);class Fu{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch){this.cXa={};this.pic=!1;this.Zcd=null;this.eA=[0,.25,.5,.75,1,1.5,2.25,3,4.5,6];this.$F=new Eb.ScriptSharpLegacyMap;this.Ssj=(of,sg,Fg)=>{const og=new gs;og.response=8;const pi=[];of=of.lzb();if(!of)return og;sg=sg||Fg?of.firstRow:of.qcg(of.jV-1);if(!sg)return og;pi.push(bb.a.create(sg));og.UA=pi;og.Z1a=sg;og.vn=of;og.KJa=pi.length;
if(this.Da.qu||!Hd.TableReader.yt(og.vn))og.response=32;return og};this.Lsj=(of,sg,Fg)=>{const og=new gs;og.response=8;const pi=[];of=of.lzb();if(!of)return og;sg=sg||!Fg?of.ff(0,0):of.ff(0,of.K3-1);if(!sg)return og;Array.add(pi,bb.a.create(sg));og.UA=pi;og.Z1a=sg;og.vn=of;og.KJa=1;if(this.Da.qu||!Hd.TableReader.yt(og.vn))og.response=32;return og};this.Ub=lc;this.ua=ic;this.Tb=b;this.ia=a;this.qf=c;this.pa=yc;this.Fa=f;this.EA=l;this.Ga=y;this.Vs=Va;this.wk=za;this.Da=hb;this.Fb=Cb;this.WJ=ja;this.CZa=
R;this.zc=G;this.kj=ec;this.FHb=jc;this.f2g=xd;this.Wea=Xd;this.Eb=Qd;this.NGa=Ie;this.Rq=Pe;this.tY=ig;this.AKg=ff;this.PH=1;this.Rx=Hf.Box4ColorHelper.vS({Color:"##T,1,0,0"});this.Vv=bh;this.MA=ch}vb(){this.cXa["465284484"]=0;this.cXa["212166888"]=1;this.cXa["530759702"]=2;this.cXa["1915511548"]=0;this.cXa["2003354004"]=1;this.cXa["2257534378"]=2;Gc.Ude=Object(H.a)(this,this.Tde,"getRowOrColumnsForDelete");Gc.Ide=Object(H.a)(this,this.Tsj,"getRefRowWhenInsertRow");Gc.Fde=Object(H.a)(this,this.Msj,
"getRefCellWhenInsertColumn");Gc.Gde=Object(H.a)(this,this.Osj,"getRefColumnFromRefCell");Gc.Hde=Object(H.a)(this,this.Qsj,"getRefColumnsWhenSelectColumn");Gc.Jde=Object(H.a)(this,this.Vsj,"getRefRowsWhenSelectRow");Gc.age=Object(H.a)(this,this.aCj,"gotoFocusCellAfterInsertColumn");Gc.Iyb=Object(H.a)(this,this.wag,"getNewOutlineElementInfoFromCell");Gc.UBb=a=>this.Da.qu||!Hd.TableReader.kBb(a);this.ia.ra(ea.a.sKb,qc.a.application,Object(H.a)(this,this.nEj,"handleDeleteTable"),4);this.ia.ra(ea.a.qpc,
rb.a.view,Object(H.a)(this,this.pEj,"handleDeleteTableRow"),4);this.ia.ra(ea.a.$md,rb.a.view,Object(H.a)(this,this.oEj,"handleDeleteTableColumn"),4);this.ia.ra(ea.a.yRe,qc.a.application,Object(H.a)(this,this.SIj,"handleSelectTable"),4);this.ia.ra(ea.a.bnd,qc.a.application,Object(H.a)(this,this.JFj,"handleInsertTable"),4);this.ia.ra(ea.a.tRe,qc.a.application,Object(H.a)(this,this.KFj,"handleInsertTableDialog"),4);this.ia.ra(ea.a.fjh,qc.a.application,Object(H.a)(this,this.LFj,"handleInsertTableFromRibbon"),
4);this.ia.ra(ea.a.xVk,qc.a.application,Qr.a.sH,4);this.ia.ra(ea.a.yVk,qc.a.application,Qr.a.sH,4);this.ia.ra(ea.a.I_k,qc.a.application,Qr.a.P1,96);this.ia.ra(ea.a.J_k,qc.a.application,Qr.a.P1,96);this.ia.ra(ea.a.dmh,rb.a.view,Object(H.a)(this,this.IUe,"queryTableCellAnchoring"),96);this.ia.ra(ea.a.cmh,rb.a.view,Object(H.a)(this,this.IUe,"queryTableCellAnchoring"),96);this.ia.ra(ea.a.bmh,rb.a.view,Object(H.a)(this,this.IUe,"queryTableCellAnchoring"),96);this.ia.ya(ea.a.Apc,rb.a.view,Gc.Ika);this.ia.ya(ea.a.zpc,
rb.a.view,Gc.Ika);this.ia.ya(ea.a.ypc,rb.a.view,Gc.Ika);this.ia.ya(ea.a.Apc,rb.a.tableCell,Object(H.a)(this,this.Uge,"handleTableCellAnchoring"));this.ia.ya(ea.a.zpc,rb.a.tableCell,Object(H.a)(this,this.Uge,"handleTableCellAnchoring"));this.ia.ya(ea.a.ypc,rb.a.tableCell,Object(H.a)(this,this.Uge,"handleTableCellAnchoring"));this.ia.ie(ea.a.Apc,4);this.ia.ie(ea.a.zpc,4);this.ia.ie(ea.a.ypc,4);this.ia.ya(ea.a.bjh,rb.a.view,Object(H.a)(this,this.ADj,"handleCellShadingMenuOpen"));this.ia.ra(ea.a.kjh,
rb.a.view,Object(H.a)(this,this.gHj,"handlePopulateCellShadingColor"),96);this.ia.ya(ea.a.w6,rb.a.view,Gc.Ika);this.ia.ya(ea.a.w6,rb.a.tableCell,Object(H.a)(this,this.yDj,"handleCellShadingColor"));this.ia.ya(ea.a.hjh,rb.a.view,Object(H.a)(this,this.gGj,"handleMoreCellShadingColor"));this.ia.ya(ea.a.mpc,rb.a.view,Gc.Ika);this.ia.ya(ea.a.mpc,rb.a.tableCell,Object(H.a)(this,this.zDj,"handleCellShadingCustomColor"));this.ia.ya(ea.a.EKa,rb.a.view,Gc.Ika);this.ia.ya(ea.a.EKa,rb.a.tableCell,Object(H.a)(this,
this.pIj,"handleRemoveCellShading"));this.ia.ie(ea.a.w6,4);this.ia.ie(ea.a.EKa,4);this.ia.ra(ea.a.nqc,rb.a.application,Object(H.a)(this,this.nqc,"queryLockAspectRatio"),96);this.ia.ra(ea.a.utc,rb.a.application,Object(H.a)(this,this.utc,"setLockAspectRatio"),4);this.ia.ra(ea.a.KLb,rb.a.view,Object(H.a)(this,this.KLb,"queryTableRowHeight"),96);this.ia.ra(ea.a.JLb,rb.a.view,Object(H.a)(this,this.JLb,"queryTableColumnWidth"),96);this.ia.ra(ea.a.J1a,rb.a.view,Object(H.a)(this,this.J1a,"setTableRowHeight"),
4);this.ia.ra(ea.a.XLa,rb.a.view,Object(H.a)(this,this.XLa,"setTableColumnWidth"),4);this.ia.ra(ea.a.Wvd,rb.a.view,Object(H.a)(this,this.J1a,"setTableRowHeight"),4);this.ia.ra(ea.a.Vvd,rb.a.view,Object(H.a)(this,this.XLa,"setTableColumnWidth"),4);this.ia.ra(ea.a.Zth,qc.a.application,Object(H.a)(this,this.AIj,"handleResizeFallbackTable"),4);this.ia.ra(ea.a.Vqc,rb.a.view,Object(H.a)(this,this.mmh,"queryTableSize"),96);this.ia.ra(ea.a.Nod,rb.a.view,Object(H.a)(this,this.mmh,"queryTableSize"),96);this.ia.ra(ea.a.upa,
rb.a.view,Object(H.a)(this,this.VAh,"setTableSize"),4);this.ia.ra(ea.a.YLa,rb.a.view,Object(H.a)(this,this.VAh,"setTableSize"),4);this.ia.ra(ea.a.mergeTableCells,rb.a.view,Object(H.a)(this,this.dGj,"handleMergeTableCells"),4);this.ia.ra(ea.a.splitTableCells,rb.a.view,Object(H.a)(this,this.vJj,"handleSplitTableCells"),4);this.ia.ra(ea.a.BWf,rb.a.view,Object(H.a)(this,this.Ogg,"handleDistributeRows"),4);this.ia.ra(ea.a.AWf,rb.a.view,Object(H.a)(this,this.rEj,"handleDistributeColumns"),4);this.ia.ra(ea.a.QJh,
rb.a.view,Object(H.a)(this,this.Ogg,"handleDistributeRows"),4);this.ia.ra(ea.a.Bih,rb.a.view,Object(H.a)(this,this.fHj,"handlePopulateCellBorderColorMenu"),96);this.ia.ra(ea.a.ajh,rb.a.view,Object(H.a)(this,this.xDj,"handleCellBorderRecentColor"),96);this.ia.ra(ea.a.N6g,rb.a.view,Object(H.a)(this,this.fGj,"handleMoreCellBorderColors"),96);this.ia.ra(ea.a.GJh,rb.a.view,Object(H.a)(this,this.IJj,"handleTableBorderWidthAnchor"),4);this.ia.ra(ea.a.Gza,rb.a.view,Object(H.a)(this,this.UIj,"handleSelectTableBorderWidth"),
4);this.ia.ra(ea.a.sJh,rb.a.view,Object(H.a)(this,this.GJj,"handleTableBorderColorAnchor"),4);this.ia.ra(ea.a.xMa,rb.a.view,Object(H.a)(this,this.TIj,"handleSelectTableBorderColor"),4);this.ia.ra(ea.a.FJh,rb.a.view,Object(H.a)(this,this.HJj,"handleTableBorderTypeAnchor"),4);this.ia.ra(ea.a.Opa,rb.a.view,Object(H.a)(this,this.wZc,"handleSelectTableBorderType"),4);this.ia.ra(ea.a.uJh,rb.a.view,Object(H.a)(this,this.PIj,"handleSelectInsideTableBorderType"),4);this.ia.ra(ea.a.tJh,rb.a.view,Object(H.a)(this,
this.Vhg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.ra(ea.a.vJh,rb.a.view,Object(H.a)(this,this.Whg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.ra(ea.a.zUe,rb.a.view,Object(H.a)(this,this.YHj,"handleQueryTableBorderWidth_1"),96);this.ia.ra(ea.a.AUe,rb.a.view,Object(H.a)(this,this.ZHj,"handleQueryTableBorderWidth_2"),96);this.ia.ra(ea.a.BUe,rb.a.view,Object(H.a)(this,this.$Hj,"handleQueryTableBorderWidth_3"),96);this.ia.ra(ea.a.CUe,rb.a.view,Object(H.a)(this,this.aIj,"handleQueryTableBorderWidth_4"),
96);this.ia.ra(ea.a.DUe,rb.a.view,Object(H.a)(this,this.bIj,"handleQueryTableBorderWidth_5"),96);this.ia.ra(ea.a.EUe,rb.a.view,Object(H.a)(this,this.cIj,"handleQueryTableBorderWidth_6"),96);this.ia.ra(ea.a.FUe,rb.a.view,Object(H.a)(this,this.dIj,"handleQueryTableBorderWidth_7"),96);this.ia.ra(ea.a.GUe,rb.a.view,Object(H.a)(this,this.eIj,"handleQueryTableBorderWidth_8"),96);this.ia.ra(ea.a.HUe,rb.a.view,Object(H.a)(this,this.fIj,"handleQueryTableBorderWidth_9"),96);this.ia.ra(ea.a.uUe,rb.a.view,Object(H.a)(this,
this.THj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.ra(ea.a.xUe,rb.a.view,Object(H.a)(this,this.WHj,"handleQueryTableBorderType_RightBorder"),96);this.ia.ra(ea.a.yUe,rb.a.view,Object(H.a)(this,this.XHj,"handleQueryTableBorderType_TopBorder"),96);this.ia.ra(ea.a.oUe,rb.a.view,Object(H.a)(this,this.NHj,"handleQueryTableBorderType_BottomBorder"),96);this.ia.ra(ea.a.qUe,rb.a.view,Object(H.a)(this,this.PHj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.ra(ea.a.pUe,rb.a.view,Object(H.a)(this,
this.OHj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.ra(ea.a.sUe,rb.a.view,Object(H.a)(this,this.RHj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.ra(ea.a.tUe,rb.a.view,Object(H.a)(this,this.SHj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.ra(ea.a.rUe,rb.a.view,Object(H.a)(this,this.QHj,"handleQueryTableBorderType_InsideBorder"),96);this.ia.ra(ea.a.wUe,rb.a.view,Object(H.a)(this,this.VHj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.ra(ea.a.nUe,
rb.a.view,Object(H.a)(this,this.MHj,"handleQueryTableBorderType_AllBorder"),96);this.ia.ra(ea.a.vUe,rb.a.view,Object(H.a)(this,this.UHj,"handleQueryTableBorderType_NoBorder"),96)}me(){}lsa(a){return a.Op()?qd.a("TableBordersComplexTableFixEnabled"):!0}lZ(){var a=!1;this.ua.Ba&&(a=this.pa.Ll(),a=!!a&&a.xd);return a}ADj(){return this.lZ()?32:8}gHj(a,b,c,f,l){if(!this.lZ())return 16;if(1===c)return 32;if(!l)return 8;a=this.ua.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Ub.Gf.fda;
b=Object.assign(new bo.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,jl.f(a.Fd,LE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,jl.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,jl.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",
"ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,jl.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!0));qd.a("ColorPickerHighlighterFix")&&(c=this.MA.P6f(this.pa.Fv()),jl.h(b,
c,a.Fd));l.MenuItems=b;return 32}gGj(a,b,c,f,l){if(!this.lZ())return ya.a.J(512500107,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ja(ea.a.renderColorPicker,1,l);a=this.nuj();b={};b.currentColor=a;b.handleCommand=ea.a.mpc;return this.ia.Ja(ea.a.renderColorPicker,2,b)}zDj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.w6,c,l);if(!l)return ya.a.J(512500106,822,10,"HandleCellShadingCustomColor: actionData is null"),16;a=this.ia.Ja(ea.a.w6,c,
l);32===a&&this.ia.Ja(ea.a.xCa,c,l);return a}yDj(a,b,c,f,l){if(!this.lZ())return 16;if(1===c)return 32;if(!l)return 8;b=b.node;l=Hf.Box4ColorHelper.vS(l);if(!l)return 8;c=this.Fb.ke(15);c.jc(b);c.gd=a;a=b.cellShading;up.b(a);a.solidFillField=l;b.cellShading=a;c.dispose();ya.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",bO.a[this.ia.Lp]));return 32}pIj(a,b,c){if(!this.lZ())return 16;if(1===c)return 32;b=b.node;c=this.Fb.ke(15);c.jc(b);c.gd=a;a=Eg.a.ui(b,va.a.cellShading,
new mS.a);up.b(a);a.noFillField=new iy;b.cellShading=a;c.dispose();return 32}IJj(){const a=this.pa.zn();return a&&this.lZ()&&this.Da.MKb&&this.lsa(a)?32:8}UIj(a,b,c,f,l){a=this.pa.zn();if(!(a&&this.lZ()&&this.lsa(a)&&this.Da.MKb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.PH=this.eA[1];break;case "TableBorderWidth_2":this.PH=this.eA[2];break;case "TableBorderWidth_3":this.PH=this.eA[3];break;case "TableBorderWidth_4":this.PH=this.eA[4];break;
case "TableBorderWidth_5":this.PH=this.eA[5];break;case "TableBorderWidth_6":this.PH=this.eA[6];break;case "TableBorderWidth_7":this.PH=this.eA[7];break;case "TableBorderWidth_8":this.PH=this.eA[8];break;case "TableBorderWidth_9":this.PH=this.eA[9]}this.Vv.SA();return 32}LKa(a,b){return(a=Object(sa.a)(gi.a,a))?(this.PH===b?a.If(!0):a.If(!1),32):8}YHj(a,b,c,f,l){return this.LKa(l,this.eA[1])}ZHj(a,b,c,f,l){return this.LKa(l,this.eA[2])}$Hj(a,b,c,f,l){return this.LKa(l,this.eA[3])}aIj(a,b,c,f,l){return this.LKa(l,
this.eA[4])}bIj(a,b,c,f,l){return this.LKa(l,this.eA[5])}cIj(a,b,c,f,l){return this.LKa(l,this.eA[6])}dIj(a,b,c,f,l){return this.LKa(l,this.eA[7])}eIj(a,b,c,f,l){return this.LKa(l,this.eA[8])}fIj(a,b,c,f,l){return this.LKa(l,this.eA[9])}GJj(){const a=this.pa.zn();return a&&this.lZ()&&this.Da.qjb&&this.lsa(a)?32:8}TIj(a,b,c,f,l){a=e(this.pa,l);b=a.zn();if(!(b&&a.lZ(this.ua)&&this.lsa(b)&&this.Da.qjb))return 16;if(1===c)return 32;if(!l)return 8;this.Rx=Hf.Box4ColorHelper.vS(l);this.Vv.SA();return 32}fHj(a,
b,c,f,l){a=this.pa.zn();if(!(a&&this.lZ()&&this.lsa(a)))return 16;if(1===c)return 32;if(!l)return 8;c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Ub.Gf.fda;b=Object.assign(new bo.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,jl.f(c.Fd,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,jl.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellBorderColorPicker",
"71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,jl.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));l.MenuItems=b;return 32}xDj(a,b,c,f,l){if(1===c)return this.ia.Ja(ea.a.xMa,c,l);if(!l)return ya.a.J(512500100,822,10,"HandleCellBorderRecentColor: actionData is null"),
16;a=this.ia.Ja(ea.a.xMa,c,l);32===a&&this.ia.Ja(ea.a.xCa,c,l);return a}fGj(a,b,c,f,l){a=this.pa.zn();if(!(a&&this.lZ()&&this.Da.qjb&&this.lsa(a)))return ya.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.Ja(ea.a.renderColorPicker,1,l);c=null;b.Rk&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=Hf.Box4ColorHelper.Ita(b.cellShading.solidFillField));b={};b.currentColor=c;b.handleCommand=ea.a.xMa;return this.ia.Ja(ea.a.renderColorPicker,
2,b)}HJj(){const a=this.pa.zn();return a&&this.lZ()&&this.Da.Jaa&&this.lsa(a)?32:8}PIj(a,b,c,f,l){if(2===c)return this.wZc(a,b,c,f,l);const y=this.Vhg(a,b,c,f,l);a=this.Whg(a,b,c,f,l);return 32===y||32===a?32:8}Vhg(a,b,c,f,l){if(2===c)return this.wZc(a,b,c,f,l);c=this.pa.zn();a=!!c&&this.lZ()&&this.Da.Jaa&&this.lsa(c);if(!a)return 8;if(this.pa.Js())return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.zc.WF(c));if(!b||!b.length)return 16;a=!1;c=b[0].rowIndex;for(const y of b)if(c!==y.rowIndex){a=
!0;break}return a?32:8}Whg(a,b,c,f,l){if(2===c)return this.wZc(a,b,c,f,l);c=this.pa.zn();a=!!c&&this.lZ()&&this.Da.Jaa&&this.lsa(c);if(!a)return 8;if(this.pa.Js())return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.zc.WF(c));if(!b||!b.length)return 16;a=!1;c=b[0].Ai;for(const y of b)if(c!==y.Ai){a=!0;break}return a?32:8}wZc(a,b,c,f,l){var y;b=e(this.pa,l);if(b.Js())return 16;const G=b.zn();if(!G)return 16;if(1===c)return this.lsa(G)?32:8;if(!l)return ya.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),
16;let R=b.Fv();if(!R)return 16;R.length||(R=this.sEa(this.zc.WF(G)));if(!R||!R.length)return ya.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;c=this.PH;let ja=Oe.a.VH(c),za=null!==(y=l.BorderColor)&&void 0!==y?y:this.Rx;const Va=l.SourceControlId,hb=!!l.DoNotCreateTransaction;if(!Va||!za)return ya.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),8;this.$F.Gb(Va)&&this.$F.ga(Va)&&(ja=c=0,za=Cu.a.parse("000000").UMa());
return Fu.P3i(a,Va,c.toString(),this.qLi(za),bO.a[this.ia.Lp],()=>{let Cb;hb||(Cb=this.Fb.ke(15),Cb.jc(G),Cb.gd=a);this.zVl(a,Va,G,R,ja,za);Cb&&Cb.dispose();return 32})}zVl(a,b,c,f,l,y){switch(b){case "TableBordersTopBorder":this.TUa(c,f,l,y,!1,!1);break;case "TableBordersBottomBorder":this.OUa(c,f,l,y,!1,!1);break;case "TableBordersLeftBorder":this.RUa(c,f,l,y,!1,!1);break;case "TableBordersRightBorder":this.SUa(c,f,l,y,!1,!1);break;case "TableBordersInsideHorizontalBorder":this.PUa(c,f,l,y,!1,!1,
!1);break;case "TableBordersInsideVerticalBorder":this.QUa(c,f,l,y,!1,!1,!1);break;case "TableBordersInsideBorders":this.PUa(c,f,l,y,!1,!1,!1);this.QUa(c,f,l,y,!1,!1,!1);break;case "TableBordersOutsideBorders":this.TUa(c,f,l,y,!1,!1);this.OUa(c,f,l,y,!1,!1);this.RUa(c,f,l,y,!1,!1);this.SUa(c,f,l,y,!1,!1);break;case "TableBordersNoBorder":l=0;y=Cu.a.parse("000000").UMa();this.TUa(c,f,l,y,!1,!1);this.OUa(c,f,l,y,!1,!1);this.RUa(c,f,l,y,!1,!1);this.SUa(c,f,l,y,!1,!1);this.PUa(c,f,l,y,!1,!1,!1);this.QUa(c,
f,l,y,!1,!1,!1);this.Da.KRe&&(this.wgg(f,l,y),this.vgg(f,l,y));break;case "TableBordersAllBorders":this.TUa(c,f,l,y,!1,!1);this.OUa(c,f,l,y,!1,!1);this.RUa(c,f,l,y,!1,!1);this.SUa(c,f,l,y,!1,!1);this.PUa(c,f,l,y,!1,!1,!1);this.QUa(c,f,l,y,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.wgg(f,l,y);break;case "TableBordersDiagonalDownBorder":this.vgg(f,l,y);break;default:ya.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",
b,a))}}sEa(a){const b=[];for(const c of a)c.isGhostCell||b.push(c);return b}THj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.RUa(a,b,c,this.Rx,!0,!1)?(this.$F.$("TableBordersLeftBorder",!0),l.If(!0)):(this.$F.$("TableBordersLeftBorder",!1),l.If(!1)),32):8}WHj(a,
b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.SUa(a,b,c,this.Rx,!0,!1)?(this.$F.$("TableBordersRightBorder",!0),l.If(!0)):(this.$F.$("TableBordersRightBorder",!1),l.If(!1)),32):8}XHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||
(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.TUa(a,b,c,this.Rx,!0,!1)?(this.$F.$("TableBordersTopBorder",!0),l.If(!0)):(this.$F.$("TableBordersTopBorder",!1),l.If(!1)),32):8}NHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),
16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.OUa(a,b,c,this.Rx,!0,!1)?(this.$F.$("TableBordersBottomBorder",!0),l.If(!0)):(this.$F.$("TableBordersBottomBorder",!1),l.If(!1)),32):8}RHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.zc.WF(a));if(!b||!b.length)return ya.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.PUa(a,b,c,
this.Rx,!0,!1,!1)?(this.$F.$("TableBordersInsideHorizontalBorder",!0),l.If(!0)):(this.$F.$("TableBordersInsideHorizontalBorder",!1),l.If(!1)),32):8}SHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.zc.WF(a));if(!b||!b.length)return ya.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.QUa(a,b,c,this.Rx,!0,!1,!1)?(this.$F.$("TableBordersInsideVerticalBorder",
!0),l.If(!0)):(this.$F.$("TableBordersInsideVerticalBorder",!1),l.If(!1)),32):8}PHj(a,b,c,f,l){return this.Hhg(l,"TableBordersDiagonalUpBorder")}OHj(a,b,c,f,l){return this.Hhg(l,"TableBordersDiagonalDownBorder")}Hhg(a,b){if(!this.Da.KRe)return 8;const c=this.pa.zn();if(!c||!a)return 16;var f=this.pa.Fv();if(!f)return 16;f.length||(f=this.sEa(this.zc.WF(c)));if(!f||!f.length)return ya.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",
b)),16;a=Object(sa.a)(gi.a,a);if(null===a)return 8;f=this.kXj(b,f,Oe.a.VH(this.PH));this.$F.$(b,f);a.If(f);return 32}kXj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.Hpg(b,c,this.Rx,!1);case "TableBordersDiagonalDownBorder":return this.Gpg(b,c,this.Rx,!1);default:return ya.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}QHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.zc.WF(a));if(!b||!b.length)return ya.a.J(512500058,
822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(1<b.length&&this.QUa(a,b,c,this.Rx,!0,!1,!0)&&this.PUa(a,b,c,this.Rx,!0,!1,!0)?(this.$F.$("TableBordersInsideBorders",!0),l.If(!0)):(this.$F.$("TableBordersInsideBorders",!1),l.If(!1)),32):8}VHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),
16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.TUa(a,b,c,this.Rx,!0,!1)&&this.SUa(a,b,c,this.Rx,!0,!1)&&this.OUa(a,b,c,this.Rx,!0,!1)&&this.RUa(a,b,c,this.Rx,!0,!1)?(this.$F.$("TableBordersOutsideBorders",!0),l.If(!0)):(this.$F.$("TableBordersOutsideBorders",!1),l.If(!1)),32):8}MHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(this.TUa(a,b,c,this.Rx,!0,!1)&&this.SUa(a,b,c,this.Rx,!0,!1)&&this.OUa(a,b,c,this.Rx,!0,!1)&&this.RUa(a,b,c,this.Rx,!0,!1)&&this.PUa(a,b,c,this.Rx,!0,!1,!0)&&this.QUa(a,b,c,this.Rx,!0,!1,!0)?(this.$F.$("TableBordersAllBorders",!0),l.If(!0)):(this.$F.$("TableBordersAllBorders",!1),l.If(!1)),32):8}UHj(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.Fv();if(!b)return 16;b.length||(b=this.sEa(this.zc.WF(a)));if(!b||!b.length)return ya.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(sa.a)(gi.a,l);c=Oe.a.VH(this.PH);return l?(f=!0,this.Da.KRe&&(f=this.Hpg(b,c,this.Rx,!0)&&this.Gpg(b,c,this.Rx,!0)),f&&this.TUa(a,b,c,this.Rx,!0,!0)&&this.SUa(a,b,c,this.Rx,!0,!0)&&this.OUa(a,b,c,this.Rx,!0,!0)&&this.RUa(a,b,c,this.Rx,!0,!0)&&this.PUa(a,b,c,this.Rx,!0,!0,!0)&&this.QUa(a,b,c,this.Rx,!0,!0,!0)?(this.$F.$("TableBordersNoBorder",!0),l.If(!0)):(this.$F.$("TableBordersNoBorder",!1),l.If(!1)),32):8}rFa(a,
b){if(!a)return!1;const c=Hf.Box4ColorHelper.Vga(a),f=Hf.Box4ColorHelper.Vga(b);a=Hf.Box4ColorHelper.Ita(a);b=Hf.Box4ColorHelper.Ita(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.ND===b.ND:!1}qLi(a){a=Hf.Box4ColorHelper.Vga(a);const b=this.ua.Ba;return(a=Hf.Box4ColorHelper.YH(a,b?b.Fd:null))&&Hf.Box4ColorHelper.nha(a)?Hf.Box4ColorHelper.nha(a).FV():null}Fwb(a,b,c,f){if(a=Object(sa.a)(rt,a.qc(this.Eb.Na))){f=
Hf.Box4ColorHelper.Vga(f);var l=this.ua.Ba;f=(f=Hf.Box4ColorHelper.YH(f,l?l.Fd:null))?Hf.Box4ColorHelper.nha(f):null;a.mol(b,c,f)}}wv(a,b,c,f){if(a)switch(b){case "Top":a.Iza=c;a.zMa=f;this.Fwb(a,"Top",c,f);break;case "Right":a.gha=c;a.eha=f;this.Fwb(a,"Right",c,f);break;case "Bottom":a.fha=c;a.dha=f;this.Fwb(a,"Bottom",c,f);break;case "Left":a.Hza=c;a.yMa=f;this.Fwb(a,"Left",c,f);break;case "DiagonalUp":a.Kmb=c;a.Imb=f;this.Fwb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.Jmb=c,a.Hmb=f,this.Fwb(a,
"DiagonalDown",c,f)}}TUa(a,b,c,f,l,y){const G=new Eb.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,ja=-1;for(const za of b)b=za.Ai,R=Math.min(R,b),ja=Math.max(ja,b),G.Gb(b)?G.$(b,Math.min(G.ga(b),za.rowIndex)):G.$(b,za.rowIndex);if(l)return this.T8j(a,c,f,R,ja,G,y);this.iDj(a,c,f,R,ja,G);return!0}iDj(a,b,c,f,l,y){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.ff(y.ga(f),f);this.wv(R,"Top",b,c);let ja=f;const za=f+R.colSpan;for(;ja<za;){var G=a.ff(y.ga(f)-1,ja);G?G.isGhostCell?(G=
G.rz(),G.Ai<f?ja+=1:(this.wv(G,"Bottom",b,c),ja+=G.colSpan)):(this.wv(G,"Bottom",b,c),ja+=G.colSpan):ja+=1}f+=R.colSpan}else for(;f<=l;++f)this.wv(a.ff(y.ga(f),f),"Top",b,c),this.wv(a.ff(y.ga(f)-1,f),"Bottom",b,c)}T8j(a,b,c,f,l,y,G){for(;f<=l;){const R=a.ff(y.ga(f),f),ja=R.zMa,za=Oe.a.OM(R.Iza),Va=Oe.a.OM(b);if(G){if(za!==this.eA[0])return!1}else if(za!==Va||!this.rFa(ja,c))return!1;f+=R.colSpan}return!0}OUa(a,b,c,f,l,y){const G=new Eb.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,ja=-1;for(const za of b)b=
za.Ai,R=Math.min(R,b),ja=Math.max(ja,b),G.Gb(b)?G.$(b,Math.max(G.ga(b),za.rowIndex)):G.$(b,za.rowIndex);if(l)return this.nXj(a,c,f,R,ja,G,y);this.SCj(a,c,f,R,ja,G);return!0}SCj(a,b,c,f,l,y){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.ff(y.ga(f),f);this.wv(R,"Bottom",b,c);let ja=f;const za=f+R.colSpan;for(;ja<za;){var G=a.ff(y.ga(f)+R.rowSpan,ja);G?G.isGhostCell?(G=G.rz(),G.Ai<f?ja+=1:(this.wv(G,"Top",b,c),ja+=G.colSpan)):(this.wv(G,"Top",b,c),ja+=G.colSpan):ja+=1}f+=R.colSpan}else for(;f<=
l;++f)this.wv(a.ff(y.ga(f),f),"Bottom",b,c),this.wv(a.ff(y.ga(f)+1,f),"Top",b,c)}nXj(a,b,c,f,l,y,G){for(;f<=l;){const R=a.ff(y.ga(f),f),ja=R.dha,za=Oe.a.OM(R.fha),Va=Oe.a.OM(b);if(G){if(za!==this.eA[0])return!1}else if(za!==Va||!this.rFa(ja,c))return!1;f+=R.colSpan}return!0}RUa(a,b,c,f,l,y){const G=new Eb.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,ja=-1;for(const za of b)b=za.rowIndex,R=Math.min(R,b),ja=Math.max(ja,b),G.Gb(b)?G.$(b,Math.min(G.ga(b),za.Ai)):G.$(b,za.Ai);if(l)return this.X1j(a,c,f,
R,ja,G,y);this.ZCj(a,c,f,R,ja,G);return!0}ZCj(a,b,c,f,l,y){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.ff(f,y.ga(f));this.wv(R,"Left",b,c);let ja=f;const za=f+R.rowSpan;for(;ja<za;){var G=a.ff(ja,y.ga(f)-1);G?G.isGhostCell?(G=G.rz(),G.rowIndex<f?ja+=1:(this.wv(G,"Right",b,c),ja+=G.rowSpan)):(this.wv(G,"Right",b,c),ja+=G.rowSpan):ja+=1}f+=R.rowSpan}else for(;f<=l;++f)this.wv(a.ff(f,y.ga(f)),"Left",b,c),this.wv(a.ff(f,y.ga(f)-1),"Right",b,c)}X1j(a,b,c,f,l,y,G){for(;f<=l;){const R=
a.ff(f,y.ga(f)),ja=R.yMa,za=Oe.a.OM(R.Hza),Va=Oe.a.OM(b);if(G){if(za!==this.eA[0])return!1}else if(za!==Va||!this.rFa(ja,c))return!1;f+=R.rowSpan}return!0}SUa(a,b,c,f,l,y){const G=new Eb.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,ja=-1;for(const za of b)b=za.rowIndex,R=Math.min(R,b),ja=Math.max(ja,b),G.Gb(b)?G.$(b,Math.max(G.ga(b),za.Ai)):G.$(b,za.Ai);if(l)return this.X5j(a,c,f,R,ja,G,y);this.$Cj(a,c,f,R,ja,G);return!0}$Cj(a,b,c,f,l,y){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=
a.ff(f,y.ga(f));this.wv(R,"Right",b,c);let ja=f;const za=f+R.rowSpan;for(;ja<za;){var G=a.ff(ja,y.ga(f)+R.colSpan);G?G.isGhostCell?(G=G.rz(),G.rowIndex<f?ja+=1:(this.wv(G,"Left",b,c),ja+=G.rowSpan)):(this.wv(G,"Left",b,c),ja+=G.rowSpan):ja+=1}f+=R.rowSpan}else for(;f<=l;++f)this.wv(a.ff(f,y.ga(f)),"Right",b,c),this.wv(a.ff(f,y.ga(f)+1),"Left",b,c)}X5j(a,b,c,f,l,y,G){for(;f<=l;){const R=a.ff(f,y.ga(f)),ja=R.eha,za=Oe.a.OM(R.gha),Va=Oe.a.OM(b);if(G){if(za!==this.eA[0])return!1}else if(za!==Va||!this.rFa(ja,
c))return!1;f+=R.rowSpan}return!0}QUa(a,b,c,f,l,y,G){b=this.pa.czb();if(!b)return!1;b.length||(b=this.zc.WF(a));if(!b||!b.length)return ya.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const R=new Eb.ScriptSharpLegacyMap,ja=new Eb.ScriptSharpLegacyMap;let za=Number.MAX_VALUE,Va=-1;for(const hb of b)b=hb.rowIndex,za=Math.min(za,b),Va=Math.max(Va,b),R.Gb(b)?R.$(b,Math.min(R.ga(b),hb.Ai)):R.$(b,hb.Ai),ja.Gb(b)?ja.$(b,Math.max(ja.ga(b),hb.Ai)):ja.$(b,hb.Ai);
if(l)return this.w1j(a,c,f,za,Va,R,ja,y,G);this.YCj(a,c,f,za,Va,R,ja);return!0}YCj(a,b,c,f,l,y,G){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(y.Gb(f)&&G.Gb(f))for(var R=y.ga(f),ja=G.ga(f);R<ja;){const Va=a.ff(f,R);if(!Va.isGhostCell&&Va.Ai+Va.colSpan<=ja){this.wv(Va,"Right",b,c);let hb=f;const Cb=f+Va.rowSpan;for(;hb<Cb;){var za=a.ff(hb,R+Va.colSpan);za?za.isGhostCell?(za=za.rz(),za.rowIndex<f?hb+=1:(this.wv(za,"Left",b,c),hb+=za.rowSpan)):(this.wv(za,"Left",b,c),hb+=za.rowSpan):
hb+=1}}R+=Va.colSpan}}else for(;f<=l;++f)for(R=y.ga(f),ja=G.ga(f);R<ja;++R)this.wv(a.ff(f,R),"Right",b,c),this.wv(a.ff(f,R+1),"Left",b,c)}w1j(a,b,c,f,l,y,G,R,ja){if(qd.a("TableBordersComplexTableFixEnabled")){for(var za=!1;f<=l;f++)if(y.Gb(f)&&G.Gb(f))for(var Va=y.ga(f),hb=G.ga(f);Va<hb;){var Cb=a.ff(f,Va);if(!Cb.isGhostCell&&Cb.Ai+Cb.colSpan<=hb){var lc=Cb.eha;let ic=Oe.a.OM(Cb.gha),yc=Oe.a.OM(b);za=!0;if(R){if(ic!==this.eA[0])return!1}else if(ic!==yc||!this.rFa(lc,c))return!1}Va+=Cb.colSpan}return za?
!0:ja}for(za=f;za<=l;++za){hb=y.ga(za);f=G.ga(za);if(hb===f)return ja?!0:!1;for(;hb<f;++hb)if(Cb=a.ff(za,hb),Va=Cb.eha,Cb=Oe.a.OM(Cb.gha),lc=Oe.a.OM(b),R){if(Cb!==this.eA[0])return!1}else if(Cb!==lc||!this.rFa(Va,c))return!1}return!0}PUa(a,b,c,f,l,y,G){b=this.pa.czb();if(!b)return!1;b.length||(b=this.zc.WF(a));if(!b||!b.length)return ya.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const R=new Eb.ScriptSharpLegacyMap,ja=new Eb.ScriptSharpLegacyMap;
let za=Number.MAX_VALUE,Va=-1;for(const hb of b)b=hb.Ai,za=Math.min(za,b),Va=Math.max(Va,b),R.Gb(b)?R.$(b,Math.min(R.ga(b),hb.rowIndex)):R.$(b,hb.rowIndex),ja.Gb(b)?ja.$(b,Math.max(ja.ga(b),hb.rowIndex)):ja.$(b,hb.rowIndex);if(l)return this.v1j(a,c,f,za,Va,R,ja,y,G);this.XCj(a,c,f,za,Va,R,ja);return!0}XCj(a,b,c,f,l,y,G){if(qd.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(y.Gb(f)&&G.Gb(f))for(var R=y.ga(f),ja=G.ga(f);R<ja;){const Va=a.ff(R,f);if(!Va.isGhostCell&&Va.rowIndex+Va.rowSpan<=
ja){this.wv(Va,"Bottom",b,c);let hb=f;const Cb=f+Va.colSpan;for(;hb<Cb;){var za=a.ff(R+Va.rowSpan,hb);za?za.isGhostCell?(za=za.rz(),za.Ai<f?hb+=1:(this.wv(za,"Top",b,c),hb+=za.colSpan)):(this.wv(za,"Top",b,c),hb+=za.colSpan):hb+=1}}R+=Va.rowSpan}}else for(;f<=l;++f)for(R=y.ga(f),ja=G.ga(f);R<ja;++R)this.wv(a.ff(R,f),"Bottom",b,c),this.wv(a.ff(R+1,f),"Top",b,c)}v1j(a,b,c,f,l,y,G,R,ja){if(qd.a("TableBordersComplexTableFixEnabled")){for(var za=!1;f<=l;f++)if(y.Gb(f)&&G.Gb(f))for(var Va=y.ga(f),hb=G.ga(f);Va<
hb;){var Cb=a.ff(Va,f);if(!Cb.isGhostCell&&Cb.rowIndex+Cb.rowSpan<=hb){var lc=Cb.dha;let ic=Oe.a.OM(Cb.fha),yc=Oe.a.OM(b);za=!0;if(R){if(ic!==this.eA[0])return!1}else if(ic!==yc||!this.rFa(lc,c))return!1}Va+=Cb.rowSpan}return za?!0:ja}for(za=f;za<=l;++za){hb=y.ga(za);f=G.ga(za);if(hb===f)return ja?!0:!1;for(;hb<f;++hb)if(Cb=a.ff(hb,za),Va=Cb.dha,Cb=Oe.a.OM(Cb.fha),lc=Oe.a.OM(b),R){if(Cb!==this.eA[0])return!1}else if(Cb!==lc||!this.rFa(Va,c))return!1}return!0}wgg(a,b,c){for(const f of a)this.wv(f,
"DiagonalUp",b,c)}Hpg(a,b,c,f){for(const l of a)if(!this.Gtg(Oe.a.OM(l.Kmb),Oe.a.OM(b),l.Imb,c,f))return!1;return!0}vgg(a,b,c){for(const f of a)this.wv(f,"DiagonalDown",b,c)}Gpg(a,b,c,f){for(const l of a)if(!this.Gtg(Oe.a.OM(l.Jmb),Oe.a.OM(b),l.Hmb,c,f))return!1;return!0}Gtg(a,b,c,f,l){if(l){if(a!==this.eA[0])return!1}else if(a!==b||!this.rFa(c,f))return!1;return!0}IUe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[Ih.a.On]=!1;a=this.cXa[a.toString()];if(!this.pa||!this.pa.Pa.nb||this.pa.J9())return 16;
b=0;({Xxa:b}=this.zc.yyd(this.pa.Pa)).returnValue&&b===a&&(l[Ih.a.On]=!0);return 32}ztc(a,b){a=a.queryResult;null!==a&&(a.nba=parseFloat(b.toFixed(2)).toString())}nqc(a,b,c,f,l){if(!l)return 16;l.If(this.pic);return 32}utc(a,b,c){if(1===c)return 32;2===c&&(this.pic=!this.pic);Sc.App.Mb.pF({SetLockAspectRatio:"CheckboxModel"});return 32}mmh(a,b,c,f,l){if(!l)return 16;b=this.pa.zn();if(!b)return 8;a=a===ea.a.Vqc?this.zc.bfe(b):this.zc.dfe(b);this.ztc(l,Oe.a.$v(a));return 32}VAh(a,b,c,f,l){const y=this.pa.zn();
return a!==ea.a.upa&&a!==ea.a.YLa||!y?16:1===c?32:Vg.a(String.format("{0}::Entry point:{1}",ea.a.uy(a),this.ia.Lp),a,()=>{if(!l)return ya.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var G=Oe.a.iX(l.Number);var R=a===ea.a.upa?this.zc.bfe(y):this.zc.dfe(y);if(G<cw.a.vhd||R<cw.a.vhd)return 16;G/=R;R=this.Fb.ke(15);try{R.jc(y),R.gd=a,a===ea.a.upa?(this.Vs.upa(y,G),this.pic&&this.Vs.YLa(y,G)):(this.Vs.YLa(y,G),this.pic&&this.Vs.upa(y,G)),this.Vs.x0a(y)}finally{R&&R.dispose()}return 32})}KLb(a,
b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.UXc();if(!b)return 16;b.length||(b=this.zc.ala(a));if(!b.length)return 16;a=this.CZa.v7f(b);this.ztc(l,Oe.a.$v(a));return 32}J1a(a,b,c,f,l){const y=this.pa.zn();return y?1===c?32:Vg.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.Lp),a,()=>{if(null===l)return ya.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let G=this.pa.UXc();if(!G)return ya.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),
16;G.length||(G=this.zc.ala(y));if(!G.length)return 16;let R=cw.a.w6g;a!==ea.a.Wvd&&(R=l.Number);const ja=this.Fb.ke(15);try{ja.jc(y),ja.gd=a,this.Vs.UAh(G,R)}finally{ja&&ja.dispose()}this.Vs.x0a(y);return 32}):16}JLb(a,b,c,f,l){a=this.pa.zn();if(!a)return 16;b=this.pa.czb();if(!b)return 16;b.length||(b=this.mzb(a));if(!b.length)return 16;a=this.WJ.x7f(a,b);this.ztc(l,Oe.a.$v(a));return 32}XLa(a,b,c,f,l){const y=this.pa.zn();return y?1===c?32:Vg.a(String.format("SetTableColumnWidth::Entry point:{0}",
this.ia.Lp),a,()=>{if(null===l)return ya.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var G=this.pa.czb();if(!G)return ya.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;G.length||(G=this.mzb(y));if(!G.length)return 16;let R=cw.a.v6g;a!==ea.a.Vvd&&(R=l.Number);G=this.WJ.tae(G);const ja=this.Fb.ke(15);try{ja.jc(y),ja.gd=a,this.Vs.TAh(y,G,R)}finally{ja&&ja.dispose()}this.Vs.x0a(y);return 32}):16}Ogg(a,b,c,f,l){const y=this.pa.zn();
return y?1===c?qd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:y.Op()?8:32:Vg.a("HandleDistributeRows:Entry point:"+this.ia.Lp,a,()=>{if(2===c){if(null===l)return 16;let ja=this.pa.UXc();if(!ja)return 16;var G=this.pa.Fv();if(!G)return 16;ja.length&&1!==G.length||(ja=this.zc.ala(y));if(!ja)return 16;if(!ja.length)return ya.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;G=0;for(var R of ja)R&&(G+=this.CZa.hab(R));R=this.Hoj(ja,y);const za=ja.length;G=G<
za*R?R:G/za;R=this.Fb.ke(15);try{R.jc(y),R.gd=a,this.Vs.UAh(ja,Oe.a.$v(G))}finally{R&&R.dispose()}ya.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",Oe.a.$v(G),this.ia.Lp);this.Vs.x0a(y)}return 32}):16}Hoj(a,b){let c=Oe.a.iX(cw.a.w6g);for(const l of a){a=this.zc.Jab(l);for(const y of a)if(y&&(a=y.M6b)&&(a=zb.ParagraphReader.text(a))&&0<a.length){var f=y.rowIndex;const G=y.Ai;if(a=Object(sa.a)(rt,y.qc(this.Eb.Na)))this.tY.Ujh(b,this.Eb.Na),
f=this.tY.I7b(b,a.Qja,f,G),a=a.Od.Nd.gf(f,1),qd.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<y.rowSpan&&(a/=y.rowSpan),c=Math.max(c,a)}}return c}rEj(a,b,c,f,l){const y=this.pa.zn();return y?1===c?qd.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:y.Op()?8:32:Vg.a("HandleDistributeColumns:Entry point:"+this.ia.Lp,a,()=>{if(2===c){if(null===l)return 16;var G=this.pa.czb();G.length||(G=this.mzb(y));if(!G)return 16;var R=this.pa.Fv();if(!R)return 16;G.length&&1!==R.length||(G=this.mzb(y));
if(!G.length)return ya.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;R=0;G=this.WJ.tae(G);if(!G)return ya.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var ja=y.oae;if(!ja)return ya.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let za=0;za<G.length;za++)R+=ja[G[za]];R/=G.length;if(Oe.a.$v(R)<cw.a.v6g)return 16;ja=this.Fb.ke(15);try{ja.jc(y),ja.gd=a,this.Vs.TAh(y,G,Oe.a.$v(R))}finally{ja&&
ja.dispose()}ya.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",Oe.a.$v(R),this.ia.Lp);this.Vs.x0a(y)}return 32}):16}Uge(a,b,c,f,l){if(!this.Da.Gre||this.pa.J9())return 16;if(1===c)return 32;if(!l)return 8;c=this.cXa[a.toString()];b=b.node;f=this.Fb.ke(15);f.jc(b);f.gd=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.Ppa=c;f.dispose();return 32}JFj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.qf.fd(b))return 16;if(!this.kj.hD(b,1))return this.kj.KD(b),
16;c=l.Rows;f=l.Columns;l=l.From;var y=b.Cb;y=b.Q3(y.sid,y.cid,0,c,f,b.Cs());var G=b.R_(this.pa.Ud());if(G){if(this.qf.fd(G)||this.Ga.pJ(G))return 16;this.wk.jol(y,G.id);this.qf.uw(G,a)}G=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()});try{G.jc(b),G.gd=a,b.oB(y)}finally{G&&G.dispose()}this.pa.selectShape(y,!0);ya.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Rq.oA=y;return 32}KFj(){(new dO((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.Ja(ea.a.bnd,
2,c)})).jvd();return 32}LFj(a,b,c,f,l){l.From="Ribbon";return this.ia.Ja(ea.a.bnd,c,l)}nEj(a,b,c){b=this.ua.Ba;if(!b||this.pa.J9())return 16;const f=this.pa.Ll();if(!f||!f.xd||this.qf.fd(f))return 16;if(1===c)return 32;Kc.a.KP(!0,!0);c=this.Fb.yd(15,void 0,()=>{this.pa.setSelection(null);this.Fa.Bd()});try{c.jc(b),c.gd=a,this.wk.VQc(f)}finally{c&&c.dispose()}this.qf.uw(b,a);return 32}pEj(a,b,c,f,l){if(this.pa.Js())return 16;a=this.Tde(this.pa.ak,!0,this.pa);return this.uWj(a)?16:32!==a.response?8:
a.UA&&a.UA.length===Hd.TableReader.Ek(a.vn)?this.ia.processAction(ea.a.sKb,c):this.ia.ii(b,C.a.deleteRow,c,!1,f,l)}oEj(a,b,c,f,l){if(this.pa.Js())return 16;a=this.Tde(this.pa.ak,!1,this.pa);return this.tWj(a)?16:32!==a.response?8:a.UA&&a.UA.length===Hd.TableReader.Gi(a.vn)?this.ia.processAction(ea.a.sKb,c):this.ia.ii(b,C.a.LDa,c,!1,f,l)}SIj(a,b,c,f,l){return 1===c?32:this.ia.ii(b,ea.a.Nja,c,!1,f,l)}dGj(a,b,c){if(this.pa.Js()||this.pa.J9()||!this.Da.j4c)return 16;b=this.pa.Pa;if(!b||!b.Sl||1===b.length&&
1===b.ga(0).length)return 16;b=this.FHb.g9b(b);if(!b)return ya.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.F5j)return 16;if(1===c)return 32;Kc.a.Kb&&(Kc.a.Kb.Qj=!0,Kc.a.Kb.HF=new Date);ya.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Fb.ke(15);c.jc(f);c.gd=a;a=this.f2g.merge(f,b.Mub,b.tZ);a=mr.TableNodeContext.create(a);a=Vd.SelectionFactory.P3b(Vd.SelectionFactory.Qu(a));this.pa.gF(a);c.dispose();ya.a.J(36721630,822,50,"Table merge cells succeeded");
return 32}vJj(a,b,c,f,l){if(this.pa.Js()||this.pa.J9()||!this.Da.Lre)return 16;f=null;f=this.pa.Pa.Sl?this.FHb.g9b(this.pa.Pa):this.FHb.Qvj(b.view.Nb.ak);if(!f)return 16;const y=f.tableNode.rg(this.Eb.Na);if(y&&!y.V1j)return ya.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const G=Object(sa.a)(161,f.tableNode);if(this.zc.Kne(G))return 16;const R=f.Mub;if(!({rows:b,cols:a}=this.DOl(G,R)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const ja=f.tZ,za=new Date;
({rows:c,cols:f}=this.Dfj(G,ja,R,y));const Va=Kc.a.Kb;Va&&(Va.Wa("GetClientSplitLimit",(+new Date-+za).toString()),Va.$p=!1);const hb=(Cb,lc)=>{this.f2g.JEl(G,R,Cb,lc,ja,y,this.Eb.Nd,Object(H.a)(this,this.wag,"getNewOutlineElementInfoFromCell"),()=>{})};l&&l.rows&&l.columns&&!Number.isNaN(l.rows)&&!Number.isNaN(l.columns)?(b=Number.parseInt(l.rows),l=Number.parseInt(l.columns),l>f&&(l=f),b>c&&(b=c),hb(b,l)):(new eO((Cb,lc)=>{hb(Cb,lc)},Math.min(b,c),Math.min(a,f))).jvd();return 32}AIj(a,b,c,f,l){if(!l||
!Object(Sa.a)(Array,l))return 8;if(1!==l.length)return ya.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.qf.fd(l[0].i2))return 16;b=l[0].i2;if(!(b&&b.isConnected&&b.isResizable&&b.xd)||b.pJ)return ya.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(sa.a)(117,b.qc(this.Eb.Na));if(!f)return ya.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",
b.get_shapeId()),8;const y=this.zc.eO(b);if(!y)return ya.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const G=y.qc(this.Eb.Na);if(!G)return ya.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].j5b)return f&&f.setOffsets(new Gi.a,!0),ya.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let R=c=1;try{f.Dk.Owh.vvb.length||
(this.Zcd=new Gi.a);f.setOffsets(new Gi.a,!0);var ja=G.f9b();const za=this.NGa.vm(ja.hc-ja.kc),Va=this.NGa.vm(ja.Zb-ja.mc),hb=new cd.a(f.x+za,f.y+Va),Cb=new cd.a(f.Lga(l[0].S6g.x),f.Lga(l[0].S6g.y)),lc=hl.TYd(l[0].j5b,ja,Cb,!1,!1);c=za?1+(lc.right-lc.left)/za:1;R=Va?1+(lc.bottom-lc.top)/Va:1;G.XAh(c,R);const ic=G.f9b();let yc=Ce.a.s8b(ic,ja);yc.Kj(1/f.nd);this.Zcd&&(yc=Gi.a.add(yc,this.Zcd));f.setOffsets(yc,!0);this.Zcd=yc;l[0].X1.Kj(f.nd);this.N6e(l[0].j5b,f,ic,hb,l[0].X1)}catch(za){return ya.a.J(512500002,
822,50,"Fallback table resize fail: ",za.toString()),8}ja=this.Fb.ke(15);ja.jc(y);ja.gd=a;a=G.Od.Nd;this.Vs.JYe(y,c,R,G,a);if(Fu.NFa(l[0].j5b)||Fu.NFa(l[0].j5b,!0))l=a.gf(f.x,0),a=a.gf(f.y,1),b.My=l,b.Ny=a;ja.dispose();return 32}DOl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.zc.Ek(a))/b.mP)+1),f=Math.max(1,Math.floor((35-this.zc.Gi(a))/b.WR)+1),{returnValue:!0,rows:c,cols:f}}catch(l){ya.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,
rows:c,cols:f}}Dfj(a,b,c,f){a=this.Wea.jEa(a,b,c);b=f.rcg();f=f.i7f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const y=a.tA;l=Math.min(l,b[y.eg]-b[y.ve]);c=Math.min(c,f[y.Tf]-f[y.oe])}return{rows:Math.max(1,Math.floor(l/fO.a)),cols:Math.max(1,Math.floor(c/fO.a))}}wag(a){const b=Zh.abg(a,!1);b.style||(b.style=new Cq.a);a=Object(sa.a)(ub.GraphIterator,this.Tb.Lc(a));a.mv();if(a.DB(1)){if(Bb.ListReader.Hk(a)){const f=this.EA.Hv(a),l=cb.a.SN(f.listType,f.listStyle);0===l.listType&&(l.VA=l.AX=f.VA);
f.propertySet.Ta(Ya.a.ej)&&l.propertySet.setValue(Ya.a.ej,f.propertySet.eb(Ya.a.ej));f.propertySet.Ta(Ya.a.font)&&l.propertySet.setValue(Ya.a.font,f.propertySet.eb(Ya.a.font));f.propertySet.Ta(va.a.autonumberBulletType)&&l.propertySet.setValue(va.a.autonumberBulletType,f.propertySet.eb(va.a.autonumberBulletType));b.style.oy(l.propertySet)}var c;(c=b.style).Y8a.apply(c,[a.currentNode].concat(ir.Ufe()));if(c=a.DB(2)){let f;(f=b.style).Y8a.apply(f,[c].concat(ir.Ufe()));a.Cc()}}return b}Tsj(a,b,c){const f=
new gs;f.response=8;if(!a)return f;var l=Th.ContextSetEditor.instance.sB(a);if(qd.a("EnableInsertRowColOnWholeTable")&&1===l.length&&l[0].Rk&&(a=l[0].node)&&a.xd)return this.Ssj(a,b,c);let y=a=null,G=!1;const R=[];for(var ja=0;ja<l.length;++ja)if(l[ja].Rk){var za=Object(sa.a)(5,l[ja].node);if(!za||!za.Ks())return f;za=za.GL();a||(a=b?za.getContainingTable().firstRow:za.FVc());y?y!==za&&(G=!0):y=za}if(!a)return f;ja=a.getContainingTable();if(!ja)return f;if(G){c=new Oa.a;if(this.AKg){l=this.FHb.g9b(this.pa.Pa).Mub;
if(l.mTa())return f;if(b)c.add(0);else for(b=l.ve;b<l.eg;b++)c.add(b);ya.a.J(5125E5,822,50,"Insert {0} rows",c.count)}else if(c=this.ygj(l),1!==c.count)return f;b=ja.qcg(c.ga(0));for(l=0;l<c.count;l++)Array.add(R,bb.a.create(Object(sa.a)(Ig.a,b))),b=b.EJa}else{if(!c)for(b=y.rowSpan;0<--b;)a=a.EJa;Array.add(R,bb.a.create(Object(sa.a)(Ig.a,a)))}f.UA=R;f.Z1a=Object(sa.a)(Ig.a,a);f.vn=Object(sa.a)(Ig.a,ja);f.KJa=R.length;if(this.Da.qu||!Hd.TableReader.yt(f.vn))f.response=32;return f}Msj(a,b,c){const f=
new gs;f.response=8;if(!a)return f;var l=Th.ContextSetEditor.instance.sB(a);if(qd.a("EnableInsertRowColOnWholeTable")&&1===l.length&&l[0].Rk&&(a=l[0].node)&&a.xd)return this.Lsj(a,b,c);var y=null;let G=null,R=!1;a=[];for(let za=0;za<l.length;++za)if(l[za].Rk){var ja=Object(sa.a)(5,l[za].node);if(!ja||!ja.Ks())return f;ja=ja.GL();y||(y=b?ja.getContainingTable().ff(0,0):ja.D7f());G?G!==ja&&(R=!0):G=b?ja.getContainingTable().ff(0,0):ja}if(!G||!y)return f;y=y.getContainingTable();if(!y)return f;if(R){c=
new Oa.a;if(this.AKg){l=this.FHb.g9b(this.pa.Pa).Mub;if(l.mTa())return f;if(b)c.add(0);else for(b=l.oe;b<l.Tf;b++)c.add(b);ya.a.J(512499998,822,50,"Insert {0} columns",c.count)}else if(b?c.add(0):c=this.wgj(l),1!==c.count)return f;G=y.ff(0,c.ga(0));for(b=0;b<c.count;b++)Array.add(a,bb.a.create(Object(sa.a)(Ig.a,G))),G=G.U_()}else c&&(G=y.ff(0,G.Ai+G.colSpan-1)),Array.add(a,bb.a.create(Object(sa.a)(Ig.a,G)));f.UA=a;f.Z1a=Object(sa.a)(Ig.a,G);f.vn=Object(sa.a)(Ig.a,y);f.KJa=a.length;if(this.Da.qu||
!y.Op())f.response=32;return f}ygj(a){const b=new Oa.a,c=new Eb.ScriptSharpLegacyMap;let f=0;for(let G=0;G<a.length;++G)if(a[G].Rk){var l=Object(sa.a)(5,a[G].node);if(l&&l.Ks()){f++;var y=l.GL();l=y.rowIndex;for(y=l+y.rowSpan;l<y;l++)if(c.Gb(l)){let R;c.$(R=l,c.ga(R)+1)}else c.add(l,1)}}for(let G of c.keys)c.ga(G)===f&&b.add(G);return b}wgj(a){const b=new Oa.a,c=new Eb.ScriptSharpLegacyMap;let f=0;for(let G=0;G<a.length;++G)if(a[G].Rk){var l=Object(sa.a)(5,a[G].node);if(l&&l.Ks()){f++;var y=l.GL();
l=y.Ai;for(y=l+y.colSpan;l<y;l++)if(c.Gb(l)){let R;c.$(R=l,c.ga(R)+1)}else c.add(l,1)}}for(let G of c.keys)c.ga(G)===f&&b.add(G);return b}Osj(a){return eo.a(a)}Qsj(a){const b=new gs;b.response=8;if(!a)return b;if(a.Sl){var c=a.h2a;a=a.qka;if(!c||!a)return b;c=Object(sa.a)(130,c.currentNode);a=Object(sa.a)(130,a.currentNode);if(!c||!a)return b;var f=c.Ai;a=a.Ai;if(f>a){var l=f;f=a;a=l}}else{c=ze.a.kub(a);c=Th.ContextSetEditor.instance.sB(c);if(!c||1>c.length||!c[0].Rk)return b;c=Object(sa.a)(5,c[0].node);
if(!c||!c.Ks())return b;c=c.GL();a=f=c.Ai}l=this.zc.h9b(c);if(!l||14!==l.type||0>f||0>a)return b;const y=[];let G=l.ff(0,f);if(!G)return b;for(;f<=a;)Array.add(y,bb.a.create(Object(sa.a)(Ig.a,G))),G=G.U_(),f++;b.UA=y;b.Z1a=Object(sa.a)(Ig.a,c);b.vn=Object(sa.a)(Ig.a,l);b.KJa=y.length;if(this.Da.qu||!l.Op())b.response=32;return b}Vsj(a){const b=new gs;b.response=8;if(!a)return b;if(a.Sl){var c=a.h2a;a=a.qka;if(!c||!a)return b;var f=Dk.c(c);a=Dk.c(a);c=Object(sa.a)(im.TableCellNode,c.currentNode);if(f>
a){var l=f;f=a;a=l}}else{a=ze.a.kub(a);a=Th.ContextSetEditor.instance.sB(a);if(!a||1>a.length||!a[0].Rk)return b;a=Object(sa.a)(5,a[0].node);if(!a||!a.Ks())return b;c=a.GL();a=f=c.rowIndex}if(!c)throw ya.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const y=[];let G=l.ff(f,0).FVc();for(;f<=a;)Array.add(y,bb.a.create(Object(sa.a)(Ig.a,G))),G=G.EJa,f++;b.UA=y;b.Z1a=
Object(sa.a)(Ig.a,c);b.vn=Object(sa.a)(Ig.a,l);b.KJa=y.length;if(this.Da.qu||!Hd.TableReader.yt(b.vn))b.response=32;return b}aCj(a,b){if(a=Object(sa.a)(im.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.U_();else a=a.Q$a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().ff(b.rowIndex,a.Ai),a=a.rz(),ub.GraphIterator.pb(Object(sa.a)(Ig.a,a)))}}Tde(a,b,c){const f=new gs;f.response=8;if(!a||!c||!c.Pa)return f;const l=[],y=[];c=c.Pa;if(c.Sl){if(c=this.FHb.g9b(c))if(a=c.Mub,
c=c.tableNode.firstRow,b)for(b=0;b<=a.Ose;b++){var G=c.rowIndex;G>=a.V2f&&G<=a.Ose&&l.push(c);c=c.EJa}else for(b=c.N2f,c=0;c<=a.Gse;c++)G=b.Ai,G>=a.O2f&&G<=a.Gse&&y.push(b),b=b.U_()}else for(a=Th.ContextSetEditor.instance.sB(a),c=0;c<a.length;++c)if(a[c].Rk){G=Object(sa.a)(5,a[c].node);if(!G||!G.Ks())return f;var R=G.GL();if(b)for(G=R.rowSpan,R=R.FVc();0<G--;)Array.contains(l,R)||l.push(R),R=R.EJa;else for(G=R.colSpan,R=R.D7f();0<G--;)Array.contains(y,R)||y.push(R),R=R.U_()}if(!l.length&&!y.length)return f;
b=[];for(a=0;a<l.length;a++)Array.add(b,bb.a.create(Object(sa.a)(Ig.a,l[a])));for(a=0;a<y.length;a++)Array.add(b,bb.a.create(Object(sa.a)(Ig.a,y[a])));f.UA=b;f.Z1a=0<l.length?Object(sa.a)(Ig.a,l[0]):Object(sa.a)(Ig.a,y[0]);f.vn=0<l.length?Object(sa.a)(Ig.a,l[0].getContainingTable()):Object(sa.a)(Ig.a,y[0].getContainingTable());if(this.Da.qu||!Object(sa.a)(161,f.vn).Op())f.response=32;return f}uWj(a){if(!a.UA)return!1;for(let c=0;c<a.UA.length;c++){var b=Object(sa.a)(bb.a,a.UA[c]);if(b&&(b=Object(sa.a)(157,
b.node))){b=this.zc.Jab(b);for(const f of b)if(f&&f.VAb)return!0}}return!1}tWj(a){if(!a.UA)return!1;var b=Object(sa.a)(161,a.vn);if(!b)return!1;var c=Object(sa.a)(bb.a,a.UA[0]);if(!c)return!1;c=Object(sa.a)(130,c.node);if(!c)return!1;c=Object(sa.a)(ub.GraphIterator,this.Tb.Lc(c));c.rc(14);b=this.zc.Ek(b);a=a.UA.length;const f=new ub.GraphIterator;f.Tc(c);for(let l=0;l<b;l++){for(let y=0;y<a;y++){const G=Object(sa.a)(130,c.currentNode);if(G&&G.VAb)return!0;c.Hf(1)}ae.moveToNextRow(f);c.Tc(f)}return!1}mzb(a){let b=
null;a&&14===a.type&&(b=this.zc.$ee(a.firstRow));return b}N6e(a,b,c,f,l){var y=Fu.NFa(a);a=Fu.NFa(a,!0);if(y||a)y=this.NGa.vm(c.hc-c.kc),c=this.NGa.vm(c.Zb-c.mc),f._x+=this.NGa.vm(l.right),f._y+=this.NGa.vm(l.bottom),b.setPosition(f.x-y,f.y-c,!0)}nuj(){var a=null;const b=this.ua.Ba;var c=this.pa.Fv();if(qd.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.pa.zn())a=c.ff(0,0),a=Hf.Box4ColorHelper.GEa(a.cellShading.solidFillField,b.Fd);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?
Hf.Box4ColorHelper.GEa(c.cellShading.solidFillField,b.Fd):this.MA.kVc(Object(sa.a)(Ig.a,c)))}return a}static P3i(a,b,c,f,l,y){const G=Kc.a.Jj("HandleSelectTableBorderType");G.Wa("CommandId",a.toString());G.Wa("BorderType",b);G.Wa("BorderWidth",c);G.Wa("BorderColor",f);G.Wa("CommandLocation",l);try{return y()}finally{G.finish(!0)}}static NFa(a,b=!1){return a.equals(rd.a.Zu)?!0:b?a.equals(rd.a.north)||a.equals(rd.a.TE):a.equals(rd.a.west)||a.equals(rd.a.iI)}}Object(m.a)(Fu,"TableActor",null,[268]);
class dw{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0}}Object(m.a)(dw,"TableCellMargin",null,[]);class ew{constructor(a,b,c,f,l,y,G,R){this.gJa=null;this.Tad=0;this.C_l=Oe.a.Mmd(2);this.MTf=Object.assign(new dw,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.LTf=Object.assign(new dw,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.KTf=Object.assign(new dw,{marginTop:.05,marginBottom:.05,marginLeft:.05,marginRight:.05});this.WTf=
Object.assign(new dw,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.SOh=Object.assign(new dw,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(y){if(!G)throw ya.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!R)throw ya.a.J(512499989,822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");}else throw ya.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw ya.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");
else throw ya.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw ya.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw ya.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");else throw ya.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Da=b;this.Fb=c;this.ua=f;this.pa=l;this.zc=y;this.Sjk=G.Y1d(50,Object(H.a)(this,this.J7a,"applyPendingChangesToServerIfRequired"));this.Eb=R}vb(){this.ia.ra(ea.a.T6e,rb.a.view,
Object(H.a)(this,this.X9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Jvc,rb.a.tableCell,Object(H.a)(this,this.X9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Lod,qc.a.application,Object(H.a)(this,this.sZc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(ea.a.Ivc,rb.a.tableCell,Object(H.a)(this,this.X9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Kod,qc.a.application,Object(H.a)(this,this.sZc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(ea.a.Hvc,rb.a.tableCell,Object(H.a)(this,this.X9b,
"handleTableCellMargins"),4);this.ia.ra(ea.a.Jod,qc.a.application,Object(H.a)(this,this.sZc,"handleQueryTableCellDefaultMargins"),96);this.ia.ra(ea.a.Mvc,rb.a.tableCell,Object(H.a)(this,this.X9b,"handleTableCellMargins"),4);this.ia.ra(ea.a.Mod,qc.a.application,Object(H.a)(this,this.sZc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(ea.a.Jvc,rb.a.view,Gc.Ika);this.ia.ya(ea.a.Ivc,rb.a.view,Gc.Ika);this.ia.ya(ea.a.Hvc,rb.a.view,Gc.Ika);this.ia.ya(ea.a.Mvc,rb.a.view,Gc.Ika);this.ia.ra(ea.a.Gvc,
rb.a.view,Object(H.a)(this,this.zZc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.Sqc,rb.a.view,Object(H.a)(this,this.rZc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(ea.a.Kvc,rb.a.view,Object(H.a)(this,this.zZc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.Tqc,rb.a.view,Object(H.a)(this,this.rZc,"handleQueryTableCellCustomMargins"),96);this.ia.ra(ea.a.Lvc,rb.a.view,Object(H.a)(this,this.zZc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.Uqc,rb.a.view,Object(H.a)(this,this.rZc,
"handleQueryTableCellCustomMargins"),96);this.ia.ra(ea.a.Fvc,rb.a.view,Object(H.a)(this,this.zZc,"handleTableCellCustomMargins"),4);this.ia.ra(ea.a.Rqc,rb.a.view,Object(H.a)(this,this.rZc,"handleQueryTableCellCustomMargins"),96)}me(){}X9b(a,b,c,f,l){return this.PCh(a)?1===c?32:Vg.a("HandleTableCellMargins:Entry point:"+this.ia.Lp,a,()=>{if(!l)return ya.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return ya.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),
16;const y=b.node,G=this.J4i(a);if(!G)return ya.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),16;const R=this.Fb.ke(15);R.jc(y);R.gd=a;this.fEf(y,G);R.dispose();ya.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.Lp,a);return 32}):(ya.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}sZc(a,b,c,f,l){if(!this.Da.hQb)return 8;b=Object(sa.a)(gi.a,l);if(!b)return 16;f=this.pa.zn();if(!f)return ya.a.J(512499983,
822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.pa.Fv();if(!c)return 16;c.length||(c=this.zc.WF(f));if(!c||!c.length)return ya.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case ea.a.Lod:f=this.BVc(c,this.MTf);break;case ea.a.Kod:f=this.BVc(c,this.LTf);break;case ea.a.Jod:f=this.BVc(c,this.KTf);break;case ea.a.Mod:f=this.BVc(c,this.WTf)}b.If(f);return 32}BVc(a,b){for(const c of a)if(c&&!c.isGhostCell&&
(Oe.a.$v(c.marginTop)!==b.marginTop||Oe.a.$v(c.marginBottom)!==b.marginBottom||Oe.a.$v(c.marginLeft)!==b.marginLeft||Oe.a.$v(c.marginRight)!==b.marginRight))return!1;return!0}J4i(a){let b=kh.b(this.SOh);switch(a){case ea.a.Jvc:b=this.MTf;break;case ea.a.Ivc:b=this.LTf;break;case ea.a.Hvc:b=this.KTf;break;case ea.a.Mvc:b=this.WTf}return b}fEf(a,b){0<=b.marginLeft&&(a.marginLeft=Oe.a.iX(b.marginLeft));0<=b.marginRight&&(a.marginRight=Oe.a.iX(b.marginRight));0<=b.marginTop&&(a.marginTop=Oe.a.iX(b.marginTop));
0<=b.marginBottom&&(a.marginBottom=Oe.a.iX(b.marginBottom))}Nmi(a,b){b=Math.max(Oe.a.iX(this.C_l+b.marginLeft+b.marginRight),a);Xg.a.vz(b,a)||(a={},a.Number=Oe.a.$v(b),this.ia.Ja(ea.a.XLa,2,a))}PCh(a){if(!this.ua.Ba)return!1;const b=this.pa.Ll();return!!b&&b.xd&&(this.Da.hQb&&Array.contains(ew.Ail,a)||this.Da.Omb&&Array.contains(ew.Kil,a))}rZc(a,b,c,f,l){if(!this.Da.Omb)return 8;b=this.pa.zn();if(!b)return ya.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),
16;c=this.pa.Fv();if(!c)return ya.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),16;c.length||(c=this.zc.WF(b));if(!c||!c.length)return ya.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.zuj(c,a);this.ztc(l,Oe.a.$v(b));ya.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.Lp,a);return 32}zuj(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case ea.a.Sqc:c=
l.marginLeft;break;case ea.a.Tqc:c=l.marginRight;break;case ea.a.Uqc:c=l.marginTop;break;case ea.a.Rqc:c=l.marginBottom}if(0<=f&&f!==c)return-1;f=c}return c}ztc(a,b){a=a.queryResult;null!==a&&(a.nba=parseFloat(b.toFixed(2)).toString())}zZc(a,b,c,f,l){return this.PCh(a)?1===c?32:Vg.a("HandleTableCellCustomMargins:Entry point:"+this.ia.Lp,a,()=>{if(!l)return ya.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const y=this.pa.zn();if(!y)return ya.a.J(512499975,822,50,
"HandleTableCellCustomMargins: unable to get valid tableNode"),16;let G=this.pa.Fv();if(!G)return ya.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),16;G.length||(G=this.zc.WF(y));this.rGk(a,G,l);ya.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.Lp,a);return 32}):(ya.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}rGk(a,b,c){this.Tad!==a&&(this.J7a(),this.Tad=
a);this.gJa||(this.gJa=[]);Vg.a("OnCustomMarginChange:Entry point:"+this.ia.Lp,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const y=Object(sa.a)(rt,f.qc(this.Eb.Na));if(y){this.gJa[l]||(this.gJa[l]=new lx.a(f,this.Pxj(f)));f=this.gJa[l];switch(a){case ea.a.Gvc:f.second.marginLeft=c.Number;break;case ea.a.Kvc:f.second.marginRight=c.Number;break;case ea.a.Lvc:f.second.marginTop=c.Number;break;case ea.a.Fvc:f.second.marginBottom=c.Number}y.qol(f.second,a)}}return 32});
this.Sjk.perform()}J7a(){this.Da.Omb&&this.gJa&&this.gJa.length&&(Vg.a("ApplyPendingChangesToServerIfRequired:Entry point:"+this.ia.Lp,this.Tad,()=>{const a=this.Fb.ke(15);try{a.gd=this.Tad;let b=null;for(const c of this.gJa)b||(b=c.first.getContainingTable(),a.jc(b)),this.fEf(c.first,c.second),this.Nmi(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.gJa=null)}Pxj(a){const b=kh.b(this.SOh);b.marginLeft=Oe.a.$v(a.marginLeft);b.marginRight=Oe.a.$v(a.marginRight);b.marginTop=
Oe.a.$v(a.marginTop);b.marginBottom=Oe.a.$v(a.marginBottom);return b}}ew.Ail=[ea.a.T6e,ea.a.Jvc,ea.a.Ivc,ea.a.Hvc,ea.a.Mvc];ew.Kil=[ea.a.Gvc,ea.a.Kvc,ea.a.Lvc,ea.a.Fvc];Object(m.a)(ew,"TableCellMarginActor",null,[268]);class Rq{constructor(a,b,c,f,l,y,G,R){this.Pm=this.Nkc=null;this.d2g=0;this.W9c=!1;this.aEe=this.eIe=this.D2g=this.IAg=this.C2g=this.HAg=null;this.MA=a;this.il=b;this.gBe=c;this.r1=f;this.mIe=l;this.vvk=y;this.qvk=G;this.uYa=R}XIl(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');
this.Gje(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',this.il.Rtb(this.il.nbe(this.Nkc),this.Pm)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.eIe.dae(a,b,1,1),l=this.k9f(this.aEe,this.Pm,a,b),y=this.il.Rtb(f.Ta(va.a.cellShading)?f.Sh(va.a.cellShading):Ll.a.gwb,this.Pm),G=new Sys.StringBuilder;for(let R=0;R<Rq.Mec.length;R++){const ja=kq.sUa(Rq.c7c[R]),za=f.sa(ja.b8a,Ll.a.eQc),Va=f.sa(ja.$tb,Ll.a.ewb);G.append(Rq.Mec[R]);if(za.ND===
oc.a.auto){const hb=this.il.Y$d(.0277777777777778);G.append(String.format("inset {0}px transparent",hb))}else G.append(this.il.i$d(Va,.0277777777777778,za));G.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,y,G));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.W9c&&this.quh()}return c.toString()}gfj(a,b){const c=[];this.Gje(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.eIe.dae(a,b,
1,1),y=this.k9f(this.aEe,this.Pm,a,b);f.color=y;const G=this.il.Rtb(l.Ta(va.a.cellShading)?l.Sh(va.a.cellShading):Ll.a.gwb,this.Pm);f["background-color"]=G;f.overflow="visible";for(let R=0;R<Rq.Mec.length;R++){let ja=null,za=null,Va=null;({pRa:ja,b8a:za,$tb:Va}=kq.sUa(Rq.c7c[R]));let hb;if(this.uYa){const ec=Hf.Box4ColorHelper.vS({Color:"##T,0,0,0"}),jc=Eg.a.ui(l,za,ec),xd=Hf.Box4ColorHelper.Vga(jc),Xd=Hf.Box4ColorHelper.YH(xd,this.Pm);hb=Xd?Hf.Box4ColorHelper.nha(Xd):null}else hb=l.sa(za,Ll.a.eQc);
const Cb=l.sa(Va,Ll.a.ewb),lc=Rq.Mec[R].substring(0,Rq.Mec[R].length-1),ic=l.sa(ja,Ll.a.fwb),yc=this.uYa&&qd.a("TableBordersLocalRenderingFix");if(yc&&!ic||!yc&&hb.ND===oc.a.auto){const ec=this.il.Y$d(.0277777777777778);f[lc]=String.format("inset {0}px transparent",ec)}else f[lc]=this.il.i$d(Cb,.0277777777777778,hb)}c.push(f)}}finally{this.W9c&&this.quh()}return c}sYc(a,b){this.Gje(a,b);a={};a.background=this.il.Rtb(this.il.nbe(this.Nkc),this.Pm);return a}Gje(a,b){this.Nkc=this.r1.b9b(a).vY;this.d2g=
this.MA.zce(b);this.Pm=this.gBe.idg(b).Fd;this.W9c=this.ILj(this.Nkc);this.HAg=this.Pm.PresetSchemeColorMapping.Background1;this.C2g=this.Pm.PresetSchemeColorMapping.Text1;this.IAg=this.Pm.PresetSchemeColorMapping.Background2;this.D2g=this.Pm.PresetSchemeColorMapping.Text2;this.W9c&&(this.Pm.PresetSchemeColorMapping.Background1=this.Pm.PresetSchemeColorMapping.Light1,this.Pm.PresetSchemeColorMapping.Text1=this.Pm.PresetSchemeColorMapping.Dark1,this.Pm.PresetSchemeColorMapping.Background2=this.Pm.PresetSchemeColorMapping.Light2,
this.Pm.PresetSchemeColorMapping.Text2=this.Pm.PresetSchemeColorMapping.Dark2);a=this.mIe(()=>5,()=>5,()=>this.d2g,()=>null,()=>this.Pm,()=>this.Nkc);this.eIe=this.vvk(a);this.aEe=this.qvk(a)}quh(){this.Pm.PresetSchemeColorMapping.Background1=this.HAg;this.Pm.PresetSchemeColorMapping.Text1=this.C2g;this.Pm.PresetSchemeColorMapping.Background2=this.IAg;this.Pm.PresetSchemeColorMapping.Text2=this.D2g}ILj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;
a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}k9f(a,b,c,f){let l="black";a&&(l=a.d8f(b,c,f,1,1).FV());return l}}Rq.Mec=["border-top:","border-left:","border-bottom:","border-right:"];Rq.c7c=[7,5,0,6];Object(m.a)(Rq,"TableStylePreviewGenerator",null,[458]);class OE extends jy{constructor(){super()}get Type(){return 6}}Object(m.a)(OE,"TableStyleGalleryButtonProps",jy,[]);class PE{}PE.MCk=2147483647;Object(m.a)(PE,"TableStyleUtil",null,[]);class vp{constructor(a,b,c,f,l){this.r_d=
"Clear";this.c$a=null;this.isb=a;this.bjf=c;this.cjf=f;this.$0h=l;this.UQd=b;this.lO=w.AFrameworkApplication.lO;this.km=w.AFrameworkApplication.km}T5b(){}Yei(a,b){this.T5b();const c=this.TUc(),f=c.length;if(!(0>=f)){var l=PE.MCk,y=null;for(let za=0;za<f;za++){var G=c[za],R=this.$0h(G);l!==R&&(l=Object.assign(new el.a,{Id:"msMoreTableStyles"+R,Title:this.ayj(R),ControlList:[]}),y=Object.assign(new Hq.a,{Type:6,Id:"galleryMoreTableStyles"+R,ExternalGalleryId:"TableStylesGallery",Width:vp.wIh,ElementDimensions:"Size64by48",
GalleryItems:[]}),w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp&&this.c$a&&(y.ExternalId=this.c$a[R.toString()]),Array.add(l.ControlList,y),Array.add(b.MenuSectionList,l),l=R);var ja=this.cjf(G);G=vp.Z6e+za;R=!!w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp;ja=Object.assign(new OE,{Id:G,ExternalId:G,Command:"4171428777",QueryCommand:"2135594455",LabelText:ja?na.a.ze(ja):"",Alt:R?ja:null,VerticalCenterAlign:"true"});R&&(ja.TableCellStyles=this.beg(G,a),ja.TableStyles=this.sYc(G,
a));y&&y.GalleryItems.push(ja)}}}Wei(a){const b=Object.assign(new el.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new tg.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:na.a.ze(this.r_d),Alt:na.a.ze(this.r_d),Image16by16:this.km,Image16by16Class:tb.getImageClassWithCluster(this.lO,vp.uEi),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}uOi(a,
b){this.T5b();const c=a[Ih.a.SourceControlId],f=this.$wd(c,b);if(f){var l=this.isb.Kee(b);l=l?this.bjf(l):null;var y=this.cjf(f),G=this.bjf(f);a[vm.a.Alt]=y;a[vm.a.On]=G===l;w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp?(b=Object.assign(new OE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.beg(c,b),TableStyles:this.sYc(c,b),Alt:y}),a[vm.a.GalleryButtonProps]=b):(b=this.UQd.XIl(f,b),a[vm.a.InnerHTML]=b)}else a[vm.a.InnerHTML]=null,a[vm.a.Alt]=
null,a[vm.a.On]=!1,a[vm.a.GalleryButtonProps]=null}beg(a,b){this.T5b();return(a=this.$wd(a,b))?this.UQd.gfj(a,b):null}sYc(a,b){this.T5b();return(a=this.$wd(a,b))?this.UQd.sYc(a,b):null}zPi(a,b){w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.Rp?a.MenuItems=this.pag(b):a.PopulationXML=Bj.l(this.pag(b))}pag(a){const b=Object.assign(new bo.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.Yei(a,b);this.Wei(b);return b}$wd(a,b){return a?a.startsWith(vp.Z6e)?this.lxj(parseInt(a.substr(vp.Z6e.length))):
this.sgl(parseInt(a.substr(vp.VIl.length)),b):null}}vp.Z6e="buttonTableStyleMenu";vp.VIl="buttonTableStyleRibbon";vp.wIh=7;vp.uEi="ClearTableStyle_16x16x32";Object(m.a)(vp,"ATableStyleRibbonControl",null,[459]);class gO extends vp{constructor(a,b,c,f,l){super(a,l,Object(H.a)(f,f.jxj,"getStyleIdFromStyleContainer"),Object(H.a)(f,f.kxj,"getStyleNameFromStyleContainer"),Object(H.a)(f,f.cxj,"getStyleCatogeryFromStyleContainer"));this.MA=a;this.r1=f;this.r_d=ResourceStrings.L_ClearTableStyle;this.lO=Pd.a.Noc;
this.km=c.qk(Pd.a.umd);this.XTk()}ayj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}sgl(a,b){let c=null;(b=this.MA.i9b(b))&&(c=this.r1.eeg(b.styleIdField));return c?this.r1.$wj(c.wBg,c.vIg-c.vIg%vp.wIh+a):this.r1.jzb(a)}TUc(){return this.r1.TUc()}lxj(a){return this.r1.jzb(a)}T5b(){this.r1.H6d()}XTk(){this.c$a=
{};this.c$a["1"]="TableStylesBestMatch";this.c$a["2"]="TableStylesLight";this.c$a["3"]="TableStylesMedium";this.c$a["4"]="TableStylesDark"}}Object(m.a)(gO,"TableStyleRibbonControls",vp,[]);class hO{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){this.xE=this.EZa=null;this.ia=a;this.qf=b;this.Da=c;this.Fa=f;this.pa=l;this.Xs=y;this.Oc=G;this.yec=R;this.Eb=ja;this.Ga=za;this.$d=Va;this.Efa=Cb;this.zc=lc;this.Ofa=ic;this.NZa=ec;this.DA=hb;yc.execute(xd=>{this.EZa=xd});this.Da.sQ&&jc.execute(xd=>
{this.xE=xd})}get Hd(){return this.Oc.instance}get MF(){return this.yec.value}vb(){this.ia.ra(ea.a.jGf,qc.a.application,Object(H.a)(this,this.nDj,"handleBeginEditShapeTextByF2"),4);this.ia.ra(ea.a.X7a,qc.a.application,Object(H.a)(this,this.mDj,"handleBeginEditShapeText"),4);this.ia.ra(ea.a.mRa,rb.a.view,Object(H.a)(this,this.oDj,"handleBeginEditShapeTextForShapeMoniker"),5)}me(){const a=this.Fa.Ic(xa.a.qg),b=this.Fa.Ic(Si.a.D3);a.bindAction(x.KeyInputManager.Va(B.a.xyc,0),ea.a.jGf);a.bindAction(x.KeyInputManager.Va(B.a.jp,
0),ea.a.X7a);b.bindAction(x.KeyInputManager.Va(B.a.xyc,0),ea.a.jsi)}mDj(a,b,c){if(this.Ofa&&this.Ofa.isVisible())return ya.a.J(40735957,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.Ofa.hide(2,!0),32;if(1===c&&this.pa.GVa())return 2;a=this.pa.Ll();if(!a)return 16;b=Object(sa.a)(4,a.Okj(qd.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ga.Lr(a);else{if(a.Wf&&b)return this.ia.Ja(ea.a.$1a,c,b);if(a.Of){var f=this.Ga.yx(a);
if(0<f.length)return this.ia.Ja(ea.a.$1a,c,f[0])}else if(this.Da.sQ&&1===a.mediaType&&!a.Ug&&this.xE)return(f=this.xE.EL(a))&&f.setFocusOnPlayer(),32}return this.ia.Ja(ea.a.mRa,c,new Zl.a(a,!1))}nDj(a,b,c){a=this.pa.Ll();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Ga.Lr(a));return this.ia.Ja(ea.a.mRa,c,new Zl.a(a,!1))}oDj(a,b,c,f,l){if(!l||!Object(Sa.a)(Zl.a,l))return ya.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.bga||a.nr)||this.qf.fd(a))return 16;if(1===
c)return 32;a.xd&&(c=this.zc.eO(a),c=!!c&&c.Op(),ya.a.J(41007122,820,50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(ea.a.N8a,2));if(a.nr){if(this.MF&&this.Hd)return l=this.MF.N3(a),this.Hd.notifyAgave(l.id,11),32;ya.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.rg(this.Eb.Na);if(!c)return 16;this.EZa&&this.EZa.j8d(a,!0);this.NZa&&this.Da.Oml&&this.NZa.ping();Kc.a.Kb&&(Kc.a.Kb.actionName="BeginEditShapeText",(a.Of||a.Ug)&&On(a));
if(this.DA&&a.Wf&&c.mJ())Kc.a.yk(Ii.a.ZIc,"false"),this.$d.pnh(new Qx.a(a));else{this.Fa.wf(xa.a.qg,l.Xwl);this.Xs.Dw();c.s4e();if(a.xd&&l.tNc&&(c=this.zc.eO(a))&&c.Op())return(a=this.Efa.Q8d(l.tNc.clientPoint,c,null,null))?(c=a.qc(this.Eb.Na),this.Eb.i7(l.tNc.clientPoint,c,a,this.Eb,!1,!1,0),32):8;a.Ug&&(c=this.Ga.Fs(a))&&(c=c.rg(this.Eb.Na))&&c.Rd&&c.Rd.bOb(!0);this.Eb.oll(a,l.tNc)}return 32}}Object(m.a)(hO,"TextEditorLaunchingActor",null,[268]);class QE{constructor(a,b,c,f,l,y,G,R){this.ia=a;this.Fa=
b;this.Ga=c;this.sr=f;this.qf=l;this.pa=y;this.cYa=G;this.Hh=R}vb(){this.ia.ya(ea.a.TKf,qc.a.application,Object(H.a)(this,this.BDj,"handleChangeCaseMenu"));this.ia.ya(ea.a.sRe,qc.a.application,Object(H.a)(this,this.qHj,"handlePowerPointInsertHyperlink"));this.ia.ra(ea.a.clearFormatting,qc.a.application,Object(H.a)(this,this.MDj,"handleClearFormatting"),4)}me(){this.Fa.Ic(xa.a.DQ).bindAction(x.KeyInputManager.Va(B.a.BK,2),ea.a.clearFormatting)}BDj(){var a=this.pa.Pa.nb;return a&&(a=a.Ua)&&(a.contextId===
rb.a.Mf||a.contextId===rb.a.textRange)?32:this.ISh(!0)?32:8}qHj(a,b,c,f,l){return(a=this.pa.Pa.nb)&&this.pa.Z_j()?8:!a||this.pa.rWa()&&!QE.Kcc(a)?8:this.ia.Ja(ea.a.insertHyperlink,c,l)}MDj(a,b,c){if(!this.ISh(!1))return 16;a=this.pa.Pa.nb;if(!a)return 8;2===c&&this.aDa(a);return 32}aDa(a){ya.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.pa.Ud();let c;if((c=this.Avj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){ya.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");
return}if(b.contextId===rb.a.Mf){this.Boi(b,c[0]);return}if(b.contextId===rb.a.textRange||b.contextId===rb.a.paragraph){this.Doi(a,c);return}}this.Coi(c)}else b.length?this.pOc(b)?ya.a.J(593892317,820,50,"ClearFormatting on table(s)"):ya.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):ya.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}Avj(a){a=this.Ga.a0(a,!1);const b=[];let c=!0;for(const f of a)f.Of&&(c=!1,1!==a.length&&this.Kvl(f,
a)?b.push.apply(b,this.lqh(f,a,!1)):b.push.apply(b,this.lqh(f,a,!0)));return c?a:b}Kvl(a,b){for(const c of b)if(c&&!c.Of&&(b=c.Fs(),!b||a!==b))return!1;return!0}lqh(a,b,c=!1){const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const y=this.Ga.a0(this.pa.tP(b),!1);f.push.apply(f,y)}return f}Coi(a){this.sr.Y9a(b=>{this.o0e(b,0,this.tvj(b))},a)}Doi(a,b){const c=a.Ua,f=this.f$f(c,b[0]);if(c.contextId===rb.a.paragraph||-1!==f){var l=this.Eyj(a);this.sr.Y9a(y=>{this.o0e(y,f,l)},b)}}Boi(a,b){const c=
this.cYa.M8b(a);if(c){var f=c.Ua,l=this.f$f(a,b)+f.Ra;this.sr.Y9a(y=>{this.o0e(y,l,f.Lb-f.Ra)},[b])}}o0e(a,b,c){a.Ae(va.a.clearFormatting,!0);a.Ae(va.a.U7e,b);a.Ae(va.a.T7e,c)}f$f(a,b){let c=0,f=!1;if(!this.Hh.fe(a.node))return-1;const l=a.node;this.Ga.vG(b,y=>{y===l?f=!0:f||(c+=this.Hh.textLength(y)+1)});return f?a.contextId===rb.a.paragraph||a.contextId===rb.a.Mf?c:c+a.Ra:-1}Eyj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===rb.a.textRange?b+=f.Lb-f.Ra:f.contextId===rb.a.paragraph?
b+=this.Hh.textLength(f.node)+1:f.contextId===rb.a.endOfParagraph&&b++}return b}tvj(a){let b=0;if(a.mA)return 1;this.Ga.vG(a,c=>{b+=this.Hh.textLength(c)+1});return b}pOc(a){for(const b of a)if(b.xd)return!0;return!1}ISh(a){const b=this.pa.Ud();if(!b||1>b.length)return!1;const c=this.pa.zn();if(c&&!a&&1===b.length)return!1;a=this.Ga.a0(b);return 1>a.length&&!c||this.qf.dD(a)||this.qf.dD([c])?!1:!0}static Kcc(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!Jb.SelectionEditor.tk(b)||
!Jb.SelectionEditor.nm(a)||b.node!==a.node)}return!1}}Object(m.a)(QE,"TextOperationsActor",null,[268]);class RE{n4d(a,b,c){return 1===c?32:RE.KVi(b.node)}static KVi(a){const b=new ub.GraphIterator;b.set(a);b.mv();if(Je.b(b))return 2;a=new pf.GraphTransaction(7);a.Xy(b);b.Qi();a.dispose();return 32}}Object(m.a)(RE,"DeleteOutlineLevelContentStrategy",null,[]);class Al{constructor(){this.QZh=new RE}vb(a){const b=Object(H.a)(this.pQc,this.pQc.o4d,"deleteView"),c=Object(H.a)(this,this.n4d,"deleteOutlineLevelContent"),
f=Object(H.a)(this.sUf,this.sUf.LVi,"deleteParagraphContent");a.ya(C.a.backspace,rb.a.Mf,f);a.ya(C.a.backspace,rb.a.textRange,f);a.ya(C.a.backspace,rb.a.endOfParagraph,zf.ActionManager.Cv);a.ya(C.a.backspace,rb.a.outline,c);a.ya(C.a.backspace,rb.a.view,b);a.ie(C.a.backspace,1124);a.ya(C.a.NDa,rb.a.Mf,zf.ActionManager.Cv);a.ya(C.a.NDa,rb.a.textRange,f);a.ya(C.a.NDa,rb.a.endOfParagraph,zf.ActionManager.Cv);a.ya(C.a.NDa,rb.a.outline,c);a.ya(C.a.NDa,rb.a.view,b);a.ra(C.a.Uvb,rb.a.view,b,1124);a.ya(C.a.uL,
rb.a.Mf,f);a.ya(C.a.uL,rb.a.textRange,f);a.ya(C.a.uL,rb.a.endOfParagraph,zf.ActionManager.Cv);a.ya(C.a.uL,rb.a.outline,c);a.ya(C.a.uL,rb.a.view,b);a.ie(C.a.uL,1124);a.ra(C.a.e4b,rb.a.view,b,1124);a.ra(C.a.MDa,rb.a.view,Al.MDa,1028);a.ya(C.a.CSa,rb.a.view,Object(H.a)(this.pQc,this.pQc.CSa,"deleteFromInputEvent"));a.ya(C.a.CSa,rb.a.textRange,f);a.ie(C.a.CSa,1028)}n4d(a,b,c,f,l){return this.QZh.n4d(a,b,c,f,l)}static get tm(){return Hy.PageNavigator.instance}static get Xh(){return Al.Mi||(Al.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get gK(){return Al.FI||
(Al.FI=Fb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get JVi(){return Al.k4a||(Al.k4a=Fb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get dC(){return Al.ey||(Al.ey=Fb.a.instance.resolve("Box4.IOutlineEditor"))}static get Fe(){return Al.kd||(Al.kd=Fb.a.instance.rb("Box4.IFeatureHelper"))}static MDa(a,b,c,f,l){f=b.view;if(!f.Nb||!f.Nb.Pa.nb||Jb.SelectionEditor.Ex(f.Nb.Pa.nb))return 8;if(1===c)return 32;c=f.Nb.Pa;const y=c.nb;var G=y.Ua;let R=!1;var ja=
null,za=!1;if(c.yH)if(Je.a(G))R=!0;else{if(G.contextId===rb.a.outline&&1===c.length){for(a=ub.GraphIterator.pb(G.node);a.Ri();)a.Qi();Al.dC.vW(a,!0);rc.OutlineElementNavigator.yi(a);a=Vd.SelectionFactory.Qg(a.currentNode,0);f.Nb.setSelection(a);return 32}var Va=G.node;ja=null;if(ou.c(G)){var hb=Va.qc(f.Na);hb&&(hb=hb.Y1l)&&0<=hb.width&&0<=hb.height&&(ja=new gx.a(ve.a.gf(hb.x,0),ve.a.gf(hb.y,1)));ja||(ja=Dq.b(Va))}else ja=Dq.b(G.node);G=ub.GraphIterator.pb(G.node);G.mv();Al.tm.uLa(G);Va=Al.gK.K3b(G);
Dq.c(Va,ja.x,ja.y);Al.dC.vW(G,!0);ja=Vd.SelectionFactory.Ej(Va,!0)}else if(1===c.length){za=c.last;G=ze.a.fSa(za);if(Al.Fe&&Al.Fe.isFeatureEnabled(33)&&Th.ContextSetEditor.instance.z4e(G).returnValue)return 2;za=za.jf;za=!Je.a(za)&&!c.Sl&&(Jb.SelectionEditor.nm(za)||zb.ParagraphReader.Im(za)||Jb.SelectionEditor.oX(za))}za&&(za=Jb.SelectionEditor.im(y,!1,!1,void 0,Al.JVi.U2e(null,1)),f.Nb.setSelection(za),w.AFrameworkApplication.Qa.ii(b,C.a.$B,2,!1,null,l),ja=f.Nb.Pa.nb,f.Nb.setSelection(y));l||(l=
new J.DictionaryPropertySet);l.setValue(we.a.ywb,!0);w.AFrameworkApplication.Qa.ii(b,C.a.uL,2,!0,null,l);if(ja&&ja.Ua.isValid)return f.Nb.setSelection(ja),32;c.yH&&(R||Co.instance.MCb(a,b.RE,f));Jb.SelectionEditor.Ex(f.Nb.Pa.nb)||w.AFrameworkApplication.Qa.ii(b,C.a.$B,2,!1,null,l);return 32}}Al.FI=null;Al.Mi=null;Al.k4a=null;Al.ey=null;Al.kd=null;Object(m.a)(Al,"ADeleteActor",null,[]);class kl{get ij(){return Mh.a.instance}LVi(a,b,c,f,l){if(1===c)return 32;f=a===C.a.backspace||a===C.a.CSa;if(kl.mr()&&
kl.mr().instance&&kl.mr().instance.qX(b))return 4;c=b.node;var y=b.Ra;b=b.Lb;const G=zb.ParagraphReader.text(c),R=G.length;let ja=!1;if(y===b){if(f&&!y||!f&&y===R)return 2;f?(M.a.instance.ga(14)&&({cp:y,returnValue:ja}=this.ij.eBk(c,y)),ja||(y--,na.a.Hx(G,y)&&y--),a=C.a.OCa):(M.a.instance.ga(14)&&({cp:b,returnValue:ja}=this.ij.dBk(c,b)),ja||(b++,na.a.Hx(G,b)&&b++),a=C.a.BSa)}y=y===b?bb.a.Oj(c,y):bb.a.createTextRange(c,y,b);f=new pf.GraphTransaction(15);f.gd=a;f.ld(c);c=Object(Sa.a)(dt,l)&&l.j7b;if(kl.Xf.gg&&
kl.Xf.nz&&!c){c=kl.Xf.Vtb();try{let za;if(({type:za}=null.Weg()).returnValue){const Va=Object(sa.a)(10,l);if(Va&&Va.sa(ct.a.Bpg,!1)||1===za)kl.Xf.Ihh=za}l=0;for(let Va=null.length-1;0<=Va;--Va){let hb;const Cb=({Zug:hb}=null.getContext(Va)).returnValue;hb?(kl.hyperlinkEditor.PIb(Cb,null),l+=0,kl.g7.y1d=b+l):this.tUf(Cb)}}finally{c&&c.dispose()}}else this.tUf(y);f.dispose();return 32}static get Xf(){return kl.hd||(kl.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g7(){return kl.pp||
(kl.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Twc(){return kl.aE||(kl.aE=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return kl.Mn||(kl.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static mr(){return kl.Um||(kl.Um=Fb.a.instance.Ia("Box4.IExternalSelectionManager"))}}kl.hd=null;kl.pp=null;kl.aE=null;kl.Mn=null;kl.Um=null;Object(m.a)(kl,"ADeleteParagraphContentStrategy",null,[]);class fw extends kl{constructor(){super()}tUf(a){fw.characterPropertiesEditor.replaceTextRange(a,
"")}static get characterPropertiesEditor(){return fw.Lvh||(fw.Lvh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}fw.Lvh=null;Object(m.a)(fw,"DeleteParagraphContentStrategy",kl,[]);var nS=d(479);class iO{constructor(a,b,c,f){this.nbf=a;this.mK=c;this.vd=f;this.actionId=b}}Object(m.a)(iO,"DeleteActionData",null,[]);class yf{get UEi(){return yf.Ref||(yf.Ref=Fb.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}gMl(a){return!Jb.SelectionEditor.tk(a)}Kuj(a,b,c){if(!a)return null;
if(!c)return a;b=Jb.SelectionEditor.vTa(a,!1,!b,!0,!0,!0);return Vd.SelectionFactory.aO(a,b.Ua,!1)}o4d(a,b,c,f,l){if(1===c)return 32;var y=!1;a===C.a.e4b&&(a=C.a.uL,y=!0);a===C.a.Uvb&&(a=C.a.backspace,y=!0);a===C.a.NDa&&(b=new pC.a(Sc.App.Mb.Ld.Rn));var G=b;if(!G.view.Uh)return 2;var R=G.view.Nb;yh.GrippersManager.instance.setVisibility(!1);G=a===C.a.uL;R=0<R.Pa.length?R.Pa.ga(0):null;y=this.Kuj(R,G,y);return this.BUf(a,b,c,f,l,y,G)}BUf(a,b,c,f,l,y,G){const R=b.view,ja=R.Nb;var za=l,Va=l;a===C.a.NDa&&
(Va=za=null,y=new Wb.Selection(l,!0));if(!y)return 32;const hb=new iO(b,a,f,Va),Cb=this.Cwl(za,G,ja);za=!1;if(({MVa:za}=this.nDh(a,Cb,ja)).returnValue)return a=za?C.a.LDa:C.a.deleteRow,w.AFrameworkApplication.Qa.ii(b,a,c,!1,f,l);let lc;G?kf.a.mark(lc=5009):kf.a.mark(lc=5011);c=new pf.GraphTransaction(15);c.gd=a;c.ld(R.Ag);za=null;let ic=({Rjl:za}=this.Ugj(a,l,ja,y)).returnValue;Va=null;({Jvd:Va}=Th.ContextSetEditor.instance.z4e(ic)).returnValue&&(ic=Va);if(!ic)return c.dispose(),32;this.TLh(ic);const yc=
this.hdj(y,G);let ec=null;G?ec=new nr(y):yc&&(ec=new nr(yc));Va=!1;if(Jb.SelectionEditor.Xg(ic)){if(a===C.a.CSa)return 2;const jc=Yh.jXc(R.Ag,Cb);yf.sT.wG(()=>{this.CVi(b,f,l,ic,G,ec,y,jc,ja,Cb,hb,yc)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else yf.Xf.gg&&yf.Xf.nz?(this.fMl(a,R.Ag,ic,G,y,ja,Cb,hb,ec),Va=!0):Va=this.Thh(a,R.Ag,ic,ja,Cb,hb,ec,za);yf.l9i(ja);this.Pth(ic);c.dispose();kf.a.mark(lc+1);return a===C.a.NDa?Va?32:8:32}CSa(a,b,c,f,l){return b.view.Uh?this.BUf(a,b,c,f,null,l,!1):
2}Thh(a,b,c,f,l,y,G,R){b=Yh.jXc(b,l);this.gMl(c)&&b.Tpa(c);a=yf.Xc.eq(a);a.properties.$("CountOfParagraphsDeleted",yf.s6.w1d(c).toString());c=yf.jYi(yf.Gwl,Object(H.a)(this,this.Fwl,"shouldDispatchNoSpecialize"),c,f,l,b,y,G,R);a.end();return c}fMl(a,b,c,f,l,y,G,R,ja){var za=0,Va=null;const hb=Th.ContextSetEditor.instance.sB(c),Cb=hb[hb.length-1];if(Cb.contextId===rb.a.paragraph||Cb.contextId===rb.a.endOfParagraph){var lc=ub.GraphIterator.pb(Cb.node);lc.kf();rc.OutlineElementNavigator.Se(lc);rc.OutlineElementNavigator.cK(lc,
!0,!1)&&(Va=rc.OutlineElementNavigator.yi(lc))&&(za=yf.s6.textLength(Va))}else za=yf.s6.textLength(Cb.node)-Cb.Lb;if((lc=Object(sa.a)(10,R.vd))&&lc.sa(ct.a.Bpg,!1))this.Shh(a,b,c,y,G,R,ja,!1);else{lc=yf.Xf.Vtb();try{this.Shh(a,b,c,y,G,R,ja,!0)}finally{lc&&lc.dispose()}}if(f){if(c.Cx){a=hb.length-1;do l=hb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!yf.s6.fe(l.node))return;switch(Cb.contextId){case rb.a.paragraph:case rb.a.endOfParagraph:za=Va&&Va.isConnected?0:za;break;case rb.a.Mf:case rb.a.textRange:break;
default:za=0}za=Vd.SelectionFactory.Qg(l.node,yf.s6.textLength(l.node)-za);l.CQa===za.Ua.Ra&&(za.Ua.oT=l.oT)}else{za=l.Ua.node;if(!yf.s6.fe(za))return;Va=l.Ua.contextId===rb.a.paragraph?0:l.Ua.contextId===rb.a.endOfParagraph?yf.s6.textLength(za):l.Ua.Ra;za=Vd.SelectionFactory.Qg(za,Va)}ze.a.instance.setSelection(za)}Shh(a,b,c,f,l,y,G,R){this.rbj(f,c);!({type:ja}=null.Weg()).returnValue||R&&1!==ja||(yf.Xf.Ihh=ja);for(c=null.length-1;0<=c;--c){var ja=({Zug:R}=null.getContext(c)).returnValue;R?yf.hyperlinkEditor.PIb(ja,
2):this.Thh(a,b,ja,f,l,y,G,null)}}rbj(a,b){if(Object(Sa.a)(nS.a,b))for(a=Ci.Jta(a.Pa,!0),b=0;b<a.length&&a.getContext(b).contextId!==rb.a.table;b++);}Ugj(a,b,c,f){a===C.a.NDa?(c=nb.a.jSa(b),a=Ul.SelectionReferenceFactory.instance.Psa()):(a=null,c=1===c.Pa.length?ze.a.fSa(f):c.ak);return{returnValue:c,Rjl:a}}Pzi(a){return!a.Rk||a.contextId!==rb.a.paragraph||!yf.s6.fe(a.node)||yf.Xf.gg&&yf.Xf.nz||M.a.instance.ga(14)&&yf.ij.g3c(a)?!1:!0}TLh(a){if(a.Cx)for(let b=0;b<a.length;b++)this.TLh(a.getContext(b));
else this.Pzi(a)&&(a.node.yMc=!0)}Pth(a){if(a.Cx)for(let b=0;b<a.length;b++)this.Pth(a.getContext(b));else a.Rk&&(a=a.node)&&yf.s6.fe(a)&&(a.yMc=!1)}CVi(a,b,c,f,l,y,G,R,ja,za,Va,hb){const Cb=new ub.GraphIterator,lc=f.node;Cb.set(lc);Cb.kf();Jb.SelectionEditor.eD(Cb.currentNode,f,l)?this.GVi(a,b,c,f,l,y,G,R,ja,Va,hb,Cb,lc):yf.HVi(f,l,y,G,R,ja,za,Va)}nZc(a,b,c,f){return!a&&Bb.ListReader.Hk(b)?(f=yf.Soa(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}rFj(a,b,c,f,l,y){return M.a.instance.ga(65)&&
!a&&0<he.OutlineElementReader.syb(b)?(y=w.AFrameworkApplication.Qa.ii(c,C.a.iqh,2,!1,f,l),{returnValue:!0,response:y}):{returnValue:!1,response:y}}mKj(a,b,c,f,l,y){return M.a.instance.ga(54)&&!a&&0<he.OutlineElementReader.gab(b)?(y=w.AFrameworkApplication.Qa.ii(c,C.a.D$k,2,!1,f,l),{returnValue:!0,response:y}):{returnValue:!1,response:y}}yHj(a,b,c,f,l,y){return M.a.instance.ga(80)&&!a&&yf.Jv.Gub(b)?(y=w.AFrameworkApplication.Qa.ii(c,C.a.Ry,2,!1,f,l),{returnValue:!0,response:y}):{returnValue:!1,response:y}}FCj(a,
b,c,f,l,y,G,R,ja,za,Va){const hb=new Nn.a;hb.Tc(b);if(rc.OutlineElementNavigator.CJa(hb,!1,!a,!1)){Va=!0;za=32;const Cb=new ub.GraphIterator;Cb.Tc(hb);rc.OutlineElementNavigator.yi(hb);y&&f&&Jb.SelectionEditor.oX(f.Ua)?(c.Tpa(l),yf.Xh.h$k(b.currentNode)):hb.currentNode.nX?(M.a.instance.ga(68)&&c.Tpa(l),rc.OutlineElementNavigator.Se(hb),hb.Qi()):M.a.instance.ga(66)&&a&&y?yf.ij.Esg(R)&&!({mza:Va}=this.Pkh(a,R,hb.currentNode,f,Va)).returnValue&&(c.Tpa(l),yf.kq.Soa(b),b.Qi()):Hd.TableReader.jq(hb)?(c.Tpa(l),
this.AUf&&({response:za,returnValue:Va}=this.AUf.P0l(a,Cb,b,hb,G,ja,za))):yf.s6.fe(hb.currentNode)&&(({mza:Va}=this.Pkh(a,R,hb.currentNode,f,Va)).returnValue||this.uUf&&this.uUf.DVi(a,c,l,b,R,hb));return{returnValue:!0,response:za,mza:Va}}return{returnValue:!1,response:za,mza:Va}}Pkh(a,b,c,f,l){return yf.Xf.gg&&yf.Xf.nz&&(a=(a?b:c).Sa.last,b=w.AFrameworkApplication.userName,!a.Qo||a.Qo.authorName!==b)?(f&&(ze.a.instance.setSelection(f),l=!1),{returnValue:!0,mza:l}):{returnValue:!1,mza:l}}KJj(a,b,
c,f,l,y,G,R){return M.a.instance.ga(67)&&he.OutlineElementReader.uqg(b,a)?(Oc.isInTableCell(b)&&(ae.returnToContainingCell(b),Oc.isEmpty(b)&&c.Tpa(f),{Fxl:a,returnValue:R}=yf.PAk(b,G,a,l,y),a||(R=2)),{returnValue:!0,response:R}):{returnValue:!1,response:R}}OFj(a,b,c,f,l,y,G,R){he.OutlineElementReader.uqg(b,a)||({response:G,mza:R}=yf.WYi(c,f,a,y,l,G,R));return{returnValue:!1,response:G,mza:R}}GVi(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){let lc=!1,ic=2;const yc=yf.s6.isEmpty(hb),ec=hb.currentNode;rc.OutlineElementNavigator.Se(hb);
({response:ic}=this.nZc(l,hb,za,ic)).returnValue||({response:ic}=this.rFj(l,hb,a,b,c,ic)).returnValue||({response:ic}=this.mKj(l,hb,a,b,c,ic)).returnValue||({response:ic}=this.yHj(l,hb,a,b,c,ic)).returnValue||({response:ic,mza:lc}=this.FCj(l,hb,R,Va,f,yc,ec,Cb,ja,ic,lc)).returnValue||({response:ic}=this.KJj(l,hb,R,f,ja,za,ec,ic)).returnValue||({response:ic,mza:lc}=this.OFj(l,hb,b,c,R,G,ic,lc));yf.o8g(R,32===ic);lc&&yf.hV(ja,y)}Cwl(a,b,c){return a&&a.Ta(we.a.ywb)?this.UEi.JCh()||a.eb(we.a.ywb)?!a.sa(we.a.ywb,
!1):this.f8f(!1,c):this.f8f(b,c)}nDh(){return{returnValue:!1,MVa:!1}}static get characterPropertiesEditor(){return yf.mh||(yf.mh=Fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Vf(){return yf.fh||(yf.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}static get s6(){return yf.Er||(yf.Er=Fb.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return yf.Mn||(yf.Mn=Fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get kq(){return yf.lp||(yf.lp=Fb.a.instance.resolve("Box4.List.IListEditor"))}static get Xh(){return yf.grf||
(yf.grf=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get nI(){return cj.a.instance}static get Jv(){return wv.a.Lyb}static get Xf(){return yf.hd||(yf.hd=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get g7(){return yf.pp||(yf.pp=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Twc(){return yf.aE||(yf.aE=Fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Xc(){return cc.a.instance}static get ij(){return Mh.a.instance}static get nu(){return yf.VD||
(yf.VD=Fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get sT(){return Vf.a.instance}static l9i(a){if(1===a.Pa.length&&(a=a.Pa.ga(0),Jb.SelectionEditor.Ex(a))){var b=a.Ua;a=b.node;b=b.Ra;var c=yf.s6.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&yf.characterPropertiesEditor.replaceTextRange(bb.a.createTextRange(a,b-1,b),"\u00a0")}}static Ori(a,b){if(!b.hyperlink.lBb){const c=new pf.GraphTransaction(15);try{c.ld(a.node),yf.nu.cN(a,b)}finally{c&&c.dispose()}}}static Soa(a,
b){a=yf.Vf.Hv(a).a3c?C.a.JP:C.a.kN;return w.AFrameworkApplication.Qa.ii(b.nbf,a,2,!1,b.mK,b.vd)}static WYi(a,b,c,f,l,y,G){if(c=Jb.SelectionEditor.vTa(f,!1,!c,!1,!1,!0)){f=Vd.SelectionFactory.aO(f,c.Ua);y=32;for(c=0;c<f.length;++c){l.Tpa(f.ga(c));const R=w.AFrameworkApplication.Qa.ii(f.ga(c),C.a.uL,2,!0,a,b);2!==R&&(y=R)}32===y&&(G=!0)}return{response:y,mza:G}}static jYi(a,b,c,f,l,y,G,R,ja){let za=!1;a(c)?(za=yf.b5d(c,!0,f,l,y,G))&&yf.jNa(R,f,ja):b(c)?(za=yf.b5d(c,!1,f,l,y,G))&&yf.jNa(R,f,ja):(y.normalize(),
yf.jNa(R,f,ja));return za}static jNa(a,b,c){c&&c.hV()||yf.hV(b,a)}static b5d(a,b,c,f,l,y){f||uj.OutlineReader.Nla(a)||(c=yf.JPl(c))&&l.ytl(c);a=32===w.AFrameworkApplication.Qa.ii(a,y.actionId,2,b,y.mK,y.vd);yf.o8g(l,a);return a}static o8g(a,b){b?a.normalize():a.cancel()}static hV(a,b){b&&(b=b.restore())&&a.setSelection(b)}static HVi(a,b,c,f,l,y,G,R){let ja;!b&&({M$b:ja}=yf.nu.Fcb(a)).returnValue?(c=new nr(f),yf.Ori(a,ja),l.normalize(),yf.hV(y,c)):yf.b5d(a,!1,y,G,l,R)&&(b&&yf.Xf.gg&&yf.Xf.nz?(b=yf.g7.y1d)?
(y.setSelection(Vd.SelectionFactory.Qg(a.node,b)),yf.g7.y1d=null):yf.hV(y,c):yf.hV(y,c))}static PAk(a,b,c,f,l){let y,G=2;y=!0;if(Oc.isEmpty(a)){const R=ae.getContainingTable(a),ja=Hd.TableReader.Ek(R),za=Hd.TableReader.Gi(R);1===ja&&1===za?(G=w.AFrameworkApplication.Qa.ii(bb.a.create(R),C.a.L8a,2,!1,l.mK,l.vd),f.setSelection(Vd.SelectionFactory.Qg(b,0)),y=!1):1===ja?G=w.AFrameworkApplication.Qa.ii(l.nbf,C.a.LDa,2,!1,l.mK,l.vd):(b=Oc.isEmptyIncludingTheRestOfTheRow(a),Oc.isFirstCellInRow(a)&&b?G=w.AFrameworkApplication.Qa.ii(l.nbf,
C.a.deleteRow,2,!1,l.mK,l.vd):!c&&b&&(G=32,a=Jb.SelectionEditor.Cta(f.Pa.nb,!1,!1,!1,!0),f.setSelection(a),y=!1))}return{returnValue:G,Fxl:y}}static Gwl(a){return a.Cx||uj.OutlineReader.Nla(a)||yf.s6.Im(a)}static JPl(a){return(a=Ci.Jta(a.Pa,!0))&&1===a.length&&(a=a.getContext(0).node,Hd.TableReader.Zcb(a))?a:null}}yf.fh=null;yf.mh=null;yf.grf=null;yf.Er=null;yf.Mn=null;yf.lp=null;yf.hd=null;yf.pp=null;yf.aE=null;yf.Ref=null;yf.VD=null;Object(m.a)(yf,"ADeleteViewStrategy",null,[]);class Gu{constructor(a,
b){this.Tb=a;this.Hh=b}DVi(a,b,c,f,l,y){l=this.Tb.Lc(l);a&&!this.Hh.isEmpty(l)?(rc.OutlineElementNavigator.Se(y),b.VLh(y.currentNode),Gu.Xh.merge(f,y,!1,!1)):(rc.OutlineElementNavigator.Se(y),b.Tpa(c),Gu.Xh.merge(y,f,!1,!1))}static get Xh(){return Gu.Mi||(Gu.Mi=Fb.a.instance.resolve("Box4.IOutlineElementEditor"))}}Gu.Mi=null;Object(m.a)(Gu,"DeleteParagraphNodeStrategy",null,[798]);class jO extends yf{constructor(a,b,c,f){super();this.hkk=new Gu(c,f);this.la=a;this.cQg=b;this.Tb=c}get AUf(){throw Error.notImplemented();
}get uUf(){return this.hkk}hdj(a,b){return Jb.SelectionEditor.vTa(a,!0,!b,!1,!1,!0)}Fwl(a){return Jb.SelectionEditor.tk(a)}f8f(a,b){if(!this.la.Hre||!this.la.oCb||!this.la.Ire||a)return!1;a=this.Zxj(b);return 1===(a&1)&&2!==(a&2)}Zxj(a){var b=a.Pa;if(!b.length)return 0;a=Object(sa.a)(5,b.ga(0).Ua.node);if(!a||!a.Ks())return 0;a=(a=(a=a.GL())?a.Leg():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var y=Ci.pWc(l,!0),G=Ci.pWc(l,!1);if(y&&G){if(Jb.SelectionEditor.ou(y)&&
!Jb.SelectionEditor.eBb(y)||!zb.ParagraphReader.Woe(y.node)||y!==G&&Jb.SelectionEditor.ou(G)&&!Jb.SelectionEditor.eBb(G)||!zb.ParagraphReader.R1j(G.node))return 0;if(l=Object(sa.a)(nb.a,Th.ContextSetEditor.instance.o7b(nb.a.jSa(l.toArray()),16,!1)))for(y=0;y<l.length;++y)G=Object(sa.a)(im.TableCellNode,l.getContext(y).node),a.Op()&&G.isControllingCell?this.mVj(G,c):G.isGhostCell||Array.add(c,G)}}}if(!c.length)return 0;b=a.jV;f=a.K3;y=l=0;G=Array(b);const R=Array(f);for(var ja=0;ja<b;++ja)G[ja]=0;
for(ja=0;ja<f;++ja)R[ja]=0;for(ja=0;ja<c.length;++ja){const za=c[ja].Leg();++G[za.rowIndex]===f&&++l;++R[za.Ai]===b&&++y}if(0<l&&0<y){if(l===b&&y===f)return 3}else if(l||y){if(0<l){if(!a.Op())for(a=0;a<f;++a)if(R[a]!==l)return 0;return 1}if(0<y){if(!a.Op())for(a=0;a<b;++a)if(G[a]!==y)return 0;return 1}}return 0}mVj(a,b){Oc.foreachMergedCells(Object(sa.a)(Ig.a,a),c=>{Array.add(b,c)})}nZc(a,b,c,f){if(!a&&Bb.ListReader.Hk(b)){var l=this.Tb.fUa();l.Tc(b);if((l=Object(sa.a)(4,l.Jg(10)))&&l.Wf){if(this.cQg.Gub(b))this.cQg.Ajb(b,
-1,0),f=32;else if(b.YF(1)){if(b.Hf(1),({response:f}=super.nZc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.nZc(a,b,c,f)}return{returnValue:!1,response:f}}nDh(a,b,c){if(!(b&&a===C.a.backspace&&c.Pa&&c.Pa.length&&c.Pa.Sl))return{returnValue:!1,MVa:!1};b=c.zn();if(!b||!b.Op())return{returnValue:!1,MVa:!1};a=b.jV;b=b.K3;let f=a,l=0,y=b,G=0;c=Th.ContextSetEditor.instance.sB(c.ak);for(let za=0;za<c.length;za++){if(!c[za].Rk)return a=!1,
{returnValue:!1,MVa:a};var R=Object(sa.a)(5,c[za].node);if(!R||!R.Ks())return a=!1,{returnValue:!1,MVa:a};var ja=(R=R.GL())?R.rz():null;if(!ja)return a=!1,{returnValue:!1,MVa:a};R=ja.rowIndex;const Va=ja.Ai,hb=ja.rowSpan;ja=ja.colSpan;f=Math.min(f,R);l=Math.max(l,R+hb-1);y=Math.min(y,Va);G=Math.max(G,Va+ja-1)}return l-f+1!==a&&G-y+1!==b?{returnValue:!1,MVa:!1}:{returnValue:!0,MVa:l-f+1===a?!0:!1}}}Object(m.a)(jO,"DeleteViewStrategy",yf,[]);class kO extends Al{constructor(a,b,c,f){super();this.ikk=
new jO(a,b,c,f);this.gkk=new fw}get pQc(){return this.ikk}get sUf(){return this.gkk}}Object(m.a)(kO,"Box4DeleteActor",Al,[]);class lO{constructor(a,b,c,f,l){this.ia=a;this.fkk=new kO(b,c,f,l);ra.InteractiveViewManager.instance.editingView.A4b=!0}vb(){this.fkk.vb(this.ia)}me(){var a=C.a.backspace;const b=t.FocusManager.instance().Ic(L.AppFrame.UW);b.bindAction(x.KeyInputManager.Va(B.a.FG,0),a);b.bindAction(x.KeyInputManager.Va(B.a.FG,4),C.a.backspace);b.bindAction(x.KeyInputManager.Va(B.a.FG,4|x.KeyInputManager.Te),
F.a.we);b.bindAction(x.KeyInputManager.Va(B.a.FG,x.KeyInputManager.Te),C.a.Uvb);b.bindAction(x.KeyInputManager.Va(B.a.vha,0),C.a.uL);b.bindAction(x.KeyInputManager.Va(B.a.vha,x.KeyInputManager.Te),C.a.e4b);z.a.fl&&(b.bindAction(x.KeyInputManager.Va(B.a.FG,3),C.a.backspace),b.bindAction(x.KeyInputManager.Va(B.a.FG,7),C.a.backspace),b.bindAction(x.KeyInputManager.Va(B.a.FG,5),C.a.backspace),b.bindAction(x.KeyInputManager.Va(B.a.FG,1),C.a.Uvb))}}Object(m.a)(lO,"DeleteActor",null,[268]);class mO{constructor(a){this.Wik=
a}vb(){this.Wik.vb()}me(){}}Object(m.a)(mO,"EnterActor",null,[268]);class oq{constructor(a,b,c){this.ov=a;this.ZZb=b;this.Um=c}get Yn(){return this.ZZb.value}a3i(a,b,c,f,l){var y;if(!({Nf:c,selected:y,IF:ja}=this.rDh(b,c,!1)).returnValue)return ja;kf.a.mark(5013);var G=oq.Cm.sB(y);for(var R=0;R<G.length;++R){if(!G[R].isValid)continue;let za=G[R].iterator;za.mv();if(uj.OutlineReader.pu(za))return this.VZf(c,za);if(Je.b(za))return Co.instance.MCb(a,y,c),this.Yn.Dw(),kf.a.mark(5014),32}G=this.Xjj(y);
if(y.Cx||Jb.SelectionEditor.tk(y)||zb.ParagraphReader.Im(y)&&!Jb.SelectionEditor.oX(y)){if(oq.Fe&&oq.Fe.isFeatureEnabled(33)&&Th.ContextSetEditor.instance.z4e(y).returnValue)return 8;var ja=this.WZf(b,c,a,f,l,G)}else if(Jb.SelectionEditor.nm(y))ja=this.UZf(b,c,a,f,l,G);else if(Jb.SelectionEditor.Xg(y)){ja=new ub.GraphIterator;ja.set(y.node);ja.rc(10);if(this.NBk()&&(R=jb.HyperlinkReader.UC(y,!1),0<R.length)){if(!R[0].hyperlink)return ha.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
R[0].Ra,R[0].Lb),8;Sc.App.d7b(R[0].hyperlink.url);return 32}Oc.isInTableCell(ja)&&!M.a.instance.ga(77)&&(ae.returnToContainingCell(ja),M.a.instance.ga(30)&&Oc.isLastCellInTable(ja)&&!uj.OutlineReader.HZc(ja)&&uj.OutlineReader.eD(ja,y,!0)&&(Sg.OutlineNavigator.zaa(ja),Bb.ListReader.Hk(ja)||(G=C.a.Fua),ae.returnToCell(ja)),Oc.isFirstCellInRow(ja)&&(R=new ub.GraphIterator,R.Tc(ja),ae.returnToContainingRow(R),M.a.instance.ga(30)&&Dk.j(R)&&Dk.e(R)&&1<Hd.TableReader.Ek(ae.getContainingTable(R))?G=C.a.deleteRow:
uj.OutlineReader.eD(ja,y,!1)&&(Dk.g(R)&&0>=y.oT?(G=C.a.zac,ae.returnToContainingTable(ja),rc.OutlineElementNavigator.Se(ja),l||(l=new J.DictionaryPropertySet),l.Ae(we.a.targetObject,ja.currentNode.id)):M.a.instance.ga(30)&&(G=C.a.xVa))));ja=this.YZf(b,c,a,f,l,G)}else Jb.SelectionEditor.oX(y)&&(ja=w.AFrameworkApplication.Qa.ii(b,C.a.$B,2,!1,f,l));kf.a.mark(5014);return ja}rDh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Nf:f,selected:l,IF:32};if(!a.view.Uh)return{returnValue:!1,Nf:f,selected:l,
IF:2};f=a.view;l=f.Nb.ak;return!l||M.a.instance.ga(14)&&!oq.ij.Zpg(l,c)?{returnValue:!1,Nf:f,selected:l,IF:2}:this.Um&&this.Um.instance&&this.Um.instance.qX(l)?{returnValue:!1,Nf:f,selected:l,IF:4}:{returnValue:!0,Nf:f,selected:l,IF:2}}ewl(a,b,c,f,l){let y,G;if(!({Nf:c,selected:y,IF:G}=this.rDh(b,c,!0)).returnValue)return G;const R=oq.Cm.sB(y);for(let ja=0;ja<R.length;++ja){if(!R[ja].isValid)continue;const za=R[ja].iterator;za.mv();if(uj.OutlineReader.pu(za))return this.VZf(c,za)}y.Cx||Jb.SelectionEditor.tk(y)?
G=this.WZf(b,c,a,f,l,C.a.xac):Jb.SelectionEditor.nm(y)?G=this.UZf(b,c,a,f,l,C.a.xac):Jb.SelectionEditor.Xg(y)?G=this.YZf(b,c,a,f,l,C.a.xac):Jb.SelectionEditor.oX(y)&&(G=w.AFrameworkApplication.Qa.ii(b,C.a.$B,2,!1,f,l));return G}VZf(a,b){a.Nb.setSelection(Vd.SelectionFactory.Ej(b.currentNode,!1));return 32}WZf(a,b,c,f,l,y){const G=new pf.GraphTransaction(15);G.gd=c;G.ld(b.Ag);b=new J.DictionaryPropertySet;b.setValue(we.a.ywb,!0);b=w.AFrameworkApplication.Qa.ii(a,C.a.uL,2,!0,f,b);32===b&&(b=w.AFrameworkApplication.Qa.ii(a,
y,2,!1,f,l));G.dispose();return b}UZf(a,b,c,f,l,y){const G=new pf.GraphTransaction(15);G.gd=c;G.ld(b.Ag);b.Nb.setSelection(Jb.SelectionEditor.im(b.Nb.Pa.ga(0),!1,!1));a=w.AFrameworkApplication.Qa.ii(a,y,2,!1,f,l);G.dispose();return a}YZf(a,b,c,f,l,y){const G=new pf.GraphTransaction(15,c);G.gd=c;G.ld(b.Ag);a=w.AFrameworkApplication.Qa.ii(a,y,2,!1,f,l);G.dispose();return a}static get Cm(){return Th.ContextSetEditor.instance}static get ij(){return Mh.a.instance}static get Fe(){return oq.kd||(oq.kd=Fb.a.instance.rb("Box4.IFeatureHelper"))}}
oq.kd=null;Object(m.a)(oq,"AEnterViewStrategy",null,[704]);class wt extends oq{constructor(a,b,c){super(a,b,c)}Xjj(a){let b=C.a.$B;if(a&&(a=oq.Cm.sB(a))&&0<a.length){const c=new ub.GraphIterator;c.set(a[0].node);c.rc(10);(a=c.l3a())&&a.Ta(va.a.Cj)&&(a=a.eb(va.a.Cj),0===a||2===a)&&(b=C.a.xac)}return b}NBk(){return wt.tV?!1:!0}static get tV(){null==wt.HI&&(wt.HI=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return wt.HI}}wt.HI=null;Object(m.a)(wt,
"EnterViewStrategy",oq,[]);class SE{constructor(a){this.Flk=a}wtd(a,b){this.Flk.pV(a,b)}}Object(m.a)(SE,"PPTFontNameFormattingStrategy",null,[647]);class nO{JCh(){return!1}}Object(m.a)(nO,"PptClipboardOperationCutStrategy",null,[440]);class oO{constructor(a,b){this.DM=a;this.pa=b}e4j(a){return 10===a.Bi||16===a.Bi||60===a.Bi}Ozi(a){if(this.DM.Hcb(a)&&this.DM.hBb(a))return!1;let b=a=null;this.pa.Pa.nb&&(b=this.pa.Pa.nb.Ua,a=this.pa.Pa.nb.jf);return this.kse(b)&&this.kse(a)}kse(a){if(a){if(a.contextId===
rb.a.paragraph)return!0;if(a.contextId===rb.a.endOfParagraph&&(a=a.node))return na.a.Xa(a.characterData)}return!1}uxl(a,b){return this.U2e(a,b)}U2e(a,b){let c=null;this.pa.Pa.nb&&(c=this.pa.Pa.nb.Ua);return this.kse(c)?!!a&&this.DM.hBb(a)||1===b:!1}}Object(m.a)(oO,"PptDeleteOutlineElementNodeStrategy",null,[438]);class pO{constructor(a,b,c){this.Sq=a;this.WJ=b;this.jb=c}s_f(a){if(this.jb.Pa&&this.jb.Pa.Sl){const f=this.Sq.N6f(this.jb.Pa).returnValue;if(!f.mTa()&&a.Cx){a=new nb.a;var b=this.jb.Fv();
for(const l of b)if(b=Object(sa.a)(im.TableCellNode,l)){var c=ub.GraphIterator.pb(b);if(c.kf()){const y=Dk.c(c);c=this.WJ.uVc(Object(sa.a)(130,c.currentNode));f.g5i(y,c)&&a.aja(ze.a.fSa(Vd.SelectionFactory.rl(b)))}}}}return a}}Object(m.a)(pO,"PptDeleteTableSegmentStrategy",null,[441]);class qO{KIh(){return!1}msg(a){return!!a&&!a.Fm.equals(ia.a.nil)}}Object(m.a)(qO,"PptEopFormattingStrategy",null,[436]);class rO{constructor(a,b,c){this.Qad=!1;this.Ga=a;this.MJ=b;this.pa=c}VNh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(va.a.Hea,b.beforeSpacing.value),a.setValue(va.a.cma,b.beforeSpacing.unit)),b.afterSpacing&&(a.setValue(va.a.Gea,b.afterSpacing.value),a.setValue(va.a.bma,b.afterSpacing.unit)),b.lineSpacing&&(a.setValue(va.a.Jx,b.lineSpacing.value),a.setValue(va.a.CX,b.lineSpacing.unit)));return!0}GCh(){return!1}uDh(){return!1}CCh(){return!this.Qad}oDh(a,b){return a===rb.a.paragraph||a===rb.a.endOfParagraph||b}DCh(a,b,c){this.pa.Pa&&this.pa.Pa.nb&&(c=!this.pa.Pa.nb.ida);return a!==rb.a.textRange&&(b===
rb.a.paragraph||c)}aCf(a,b,c){this.Qad=!1;if(a.Ks()&&this.pa.Pa.nb){var f=this.pa.Pa.nb.Ua;this.pa.Pa&&this.pa.Pa.Sl&&this.pa.Pa.ga(0)&&(f=this.pa.Pa.ga(0).Ua);if(f=wb.a.Es(zb.ParagraphReader.fe(f.node)?f:Vd.SelectionFactory.rl(a).Ua))if(f=f.cache)!c.Ta(va.a.latinFont)&&f.Ta(va.a.latinFont)&&c.setValue(va.a.latinFont,f.BL),!c.Ta(Ya.a.fontColor)&&f.w4&&c.setValue(Ya.a.fontColor,f.fontColor),!c.Ta(Ya.a.fontSize)&&f.rua&&c.setValue(Ya.a.fontSize,f.fontSize),!c.Ta(Ya.a.bold)&&f.XUa&&c.setValue(Ya.a.bold,
f.isBold)}if(b){if(f=a.JQ(this.MJ)){b.mU||a.sa(va.a.Yne,!1)||f.sa(va.a.Yne,!1)||(this.Qad=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Ta(va.a.Hea)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Ta(va.a.Gea)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.unit&&1===l.lineSpacing.value&&!f.Ta(va.a.Jx)&&(l.lineSpacing=null))}this.Qad||(b.mU||(b.mU=cb.a.SN(16,0)),b.mU.B4f=!0)}if((f=a.Ocg())&&!f.Aaa&&(c.Ta(Ya.a.fontSize)&&(f=this.Ga.IEa(this.Ga.An(a)),
c.setValue(Ya.a.fontSize,c.eb(Ya.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.unit)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Ga.fyb(this.Ga.An(a))}c.sa(Ya.a.zt,!1)&&c.setValue(Ya.a.zt,!1);c.sa(Ya.a.m0,!1)&&c.setValue(Ya.a.m0,!1)}}Object(m.a)(rO,"PptFormatPainterStrategy",null,[439]);var TE=d(328);class iA{constructor(a,b,c,f,l,y,G){this.ia=a;this.Fa=f;this.pa=b;this.KE=c;this.Yu=l;this.Lz=y;this.dZa=!G.yg;this.iDe=G.ctg}vb(){this.ia.ra(F.a.GLh,ye.a.frame,
Object(H.a)(this,this.jWk,"pptToggleRibbonUXHandler"),128);this.ia.ya(F.a.Rsh,ye.a.frame,zf.ActionManager.Sg);this.ia.ya(F.a.Qsh,ye.a.frame,zf.ActionManager.Sg)}me(){}jWk(a,b){if(b.contextId!==ye.a.frame)return 2;this.pa.nh();this.Fa.Bd();this.Yu.show(!0,a);this.iDe?(ya.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),w.AFrameworkApplication.Qa.processAction(F.a.Rsh,2)):(ya.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),
w.AFrameworkApplication.Qa.processAction(F.a.Qsh,2));w.AFrameworkApplication.hv&&w.AFrameworkApplication.hv.X8();this.Lz.s0&&2===this.Lz.iC?iA.uwh(this.ia,this.iDe,TE.a.JKb):this.KE.h4(!1,this.dZa,()=>{iA.uwh(this.ia,this.iDe,TE.a.JKb)},null);return 32}static uwh(a,b,c){Ti.a.qK(c,(!b).toString(),Ti.a.aK);a.processAction(ea.a.refresh,2)}}Object(m.a)(iA,"ToggleRibbonUXActor",null,[268]);class sO extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.p$e=b;this.ddb=c}}Object(m.a)(sO,"UndoRedoEventArgs",
Sys.EventArgs,[]);class tO{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){this.ia=a;this.qf=b;this.pa=c;this.Fa=f;this.Xs=l;this.kad=y;this.yrk=G;this.DYg=R;this.JE=ja;this.ohb=za;this.DJ=Va;this.kmk=hb;this.$d=lc}vb(){this.ia.ra(ea.a.$_a,qc.a.application,Object(H.a)(this,this.kig,"handleUndoRedo"),4);this.ia.ra(ea.a.Z_a,qc.a.application,Object(H.a)(this,this.kig,"handleUndoRedo"),4)}me(){const a=this.Fa.Ic(xa.a.$i);a.ALc(x.KeyInputManager.Va(B.a.fob,x.KeyInputManager.Te),ea.a.$_a,()=>!0);a.bindAction(x.KeyInputManager.Va(B.a.Gyc,
x.KeyInputManager.Te),ea.a.Z_a)}kig(a,b,c,f,l){b=!0;a===ea.a.Z_a&&(b=!1);if(this.qf.fd(this.DYg)||!this.nwl(b,l))return 16;if(!this.owl())return this.Xs.fpa(),16;if(1===c)return 32;if(c=!this.Xs.$Yj(b))this.pa.nj(),this.Dfl();f=this.Xs.OVc(b);(l=this.DJ.F6(f))&&Kc.a.yk("UndoRedoActionName",l);this.ohb.bjd(!c);this.$d.u3k(new sO(a,f,b));(f=this.Xs.Kae(b))&&f.T6!==ia.a.nil&&Kc.a.yk("UndoRedoRevision",Kc.a.Cab(f.T6.toString()).toString());this.kmk.bjd(f,l,b);if(b?!this.Xs.undo():!this.Xs.redo())return ha.ULS.sendTraceTag(512499928,
801,10,"User perform {0} failed!!",a===ea.a.undo?"undo":"redo"),8;c&&this.qf.uw(this.DYg,a);return 32}nwl(a,b){a&&!this.Xs.gX&&b&&ha.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.Xs.zcb());return(a?this.Xs.gX:this.Xs.kla)&&!(this.Fa.Ee&&this.Fa.Ee.name===xa.a.rVd)&&this.pwl()}owl(){return this.kad||!this.c1j()}c1j(){return!this.yrk.Lta&&!!this.JE.instance&&this.JE.instance.d5j()}pwl(){return!this.d1j()}d1j(){const a=this.pa.Ll();return a?a.Lv:
!1}Dfl(){const a=this.Fa.Ee;!a||a.name!==xa.a.qg&&a.name!==xa.a.goa||this.Fa.Bd()}}Object(m.a)(tO,"UndoRedoActor",null,[268]);class uO{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh,ch,of,sg,Fg,og,pi,Wj,wg,Tg){this.tHa=this.zwa=this.Udd=null;this.RFb=0;this.KHg=this.iCe=!1;if(lc.Xn&&!Tg)throw Error.argumentNull("sorterViewActorLazy");this.KE=y;this.ia=a;this.ifc=b;this.Fa=c;this.Gg=f;this.pa=l;this.qf=G;this.le=R;this.Ub=ja;this.ua=za;this.Sb=Va;this.Alc=hb;this.Ib=
Cb;this.la=lc;this.Yu=ic;this.Ya=yc;this.Lz=ec;this.xe=jc;this.tZa=xd;this.lQg=Xd;this.Qv=Qd;this.wb=Ie;this.Qr=Pe;this.Pad=ig;this.mKg=lc.Sqg;this.Fc=ff;this.geb=bh;this.$o=ch;this.Jc=of;this.Vb=sg;this.Eb=Fg;this.eP=og;this.Rb=pi;this.uD=Wj;this.Lw=wg;this.Ina=Tg;this.YBi()}vb(){this.ia.ra(ea.a.fLb,qc.a.application,Object(H.a)(this,this.fLb,"queryEdit"),96);this.ia.ra(ea.a.ILb,qc.a.application,Object(H.a)(this,this.ILb,"querySorterView"),96);this.ia.ra(ea.a.HLb,qc.a.application,Object(H.a)(this,
this.HLb,"querySlideInformation"),96);this.ia.ya(ea.a.rpd,qc.a.application,Object(H.a)(this,this.NHl,"switchToReadingMode"));this.ia.ya(ea.a.BPb,qc.a.application,Object(H.a)(this,this.QFl,"startSlideShowFromBegnning"));this.ia.ya(ea.a.und,qc.a.application,Object(H.a)(this,this.und,"present"));this.ia.ya(ea.a.Kpc,qc.a.application,Object(H.a)(this,this.Kpc,"presentDropDown"));this.ia.ya(ea.a.Uoc,qc.a.application,Object(H.a)(this,this.Uoc,"playFromBeginningTopBar"));this.ia.ya(ea.a.xza,qc.a.application,
Object(H.a)(this,this.xza,"startSlideShowFromCurrentSlide"));this.ia.ya(ea.a.Axb,qc.a.application,Object(H.a)(this,this.Axb,"forceClose"));this.ia.ya(ea.a.zga,qc.a.application,Object(H.a)(this,this.zga,"rehearsePresentation"));this.ia.ya(ea.a.xrc,qc.a.application,Object(H.a)(this,this.xrc,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(ea.a.YRc,qc.a.application,Object(H.a)(this,this.YRc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(ea.a.XRc,qc.a.application,
Object(H.a)(this,this.XRc,"enableLivePresenterKeyboardShortcut")));this.zfi();this.ia.ya(ea.a.eMa,qc.a.application,Object(H.a)(this,this.eMa,"showEditTriPaneView"));this.Ib.ka("PPTSorterViewEnabled")&&(this.iCe=this.Ib.ka("FeedbackPaneExperienceIsEnabled")&&this.Ib.ka("HelpTabIsEnabled"),this.ia.ya(ea.a.C2b,qc.a.application,Object(H.a)(this,this.C2b,"closeEditTriPaneView")));this.la.t2c&&this.tZa.SQj(w.AFrameworkApplication.buildVersion,this.Ya.Ck,w.AFrameworkApplication.userSessionId,this.Jc)}me(){if(this.Ib.ka("SlideShowByShortcutEnabled")){const a=
this.Fa.Ic(D.AFrame.$i);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.zyc,x.KeyInputManager.Te|4),ea.a.xza);D.AFrame.zk(a,x.KeyInputManager.Va(B.a.zyc,x.KeyInputManager.Te),ea.a.BPb)}}zfi(){this.ia.ya(ea.a.X_a,qc.a.application,Object(H.a)(this,this.X_a,"presentLive"));this.ia.ya(ea.a.Mpc,qc.a.application,Object(H.a)(this,this.Mpc,"presentLiveTopBar"));this.ia.ya(ea.a.Y_a,qc.a.application,Object(H.a)(this,this.Y_a,"presentLiveSetAccessControlAnyone"));this.ia.ya(ea.a.Lpc,qc.a.application,Object(H.a)(this,
this.Lpc,"presentLiveSetAccessControlOrganization"));this.ia.ra(ea.a.xLb,qc.a.application,Object(H.a)(this,this.xLb,"queryPresentLiveAccessControlAnyone"),96);this.ia.ra(ea.a.yLb,qc.a.application,Object(H.a)(this,this.yLb,"queryPresentLiveAccessControlOrganization"),96);Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.l4("L_PublicLivePresentations",!0).then(b=>{b||(ya.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),
this.ia.kK(ea.a.Y_a,rb.a.application,Object(H.a)(this,this.Y_a,"presentLiveSetAccessControlAnyone")),Sc.App.Mb.b3a(ea.a.Y_a,Object(H.a)(new Rp,(new Rp).HEa,"getCommandById")));return null},b=>{ya.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}HLb(a,b,c,f,l){a=(a=this.ua.Ba)?a.qe+1:0;a=(b=this.Sb.rj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[Tp.a.Value]=a;l[wm.a.labelText]=a;return 32}fLb(a,b,c,f,l){this.Eb&&0!==
this.Eb.al?l.If(!1):l.If(!0);return 32}ILb(a,b,c,f,l){(a=Object(sa.a)(gi.a,l))&&(1!==this.Eb.al?a.If(!1):a.If(!0));return 32}eMa(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Eb.al&&(ya.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Eb.al=0,this.Rb&&(this.Rb.slidePane.kl(),this.la.Xn||this.Rb.thumbnailPane.kl(),this.Rb.notesPane.kl(),this.uD&&this.uD.setVisibility(!0)),this.ia.processAction(ea.a.Wkb,2),this.ia.processAction(ea.a.ivb,2),this.eP.iS("PptEditingStatusBar.Notes",
!0),this.eP.iS("PptEditingStatusBar.ZoomScale",!0),this.eP.iS("PptEditingStatusBar.FitToWindow",!0),this.iCe?this.eP.iS("PptEditingStatusBar.GiveFeedbackPane",!0):this.eP.iS("PptEditingStatusBar.GiveFeedback",!0),this.Fc.Uy(new lq.a(2)),this.Fc.Uy(new lq.a(1)),this.la.Xn||this.Gg.hL(xa.a.lF),this.Gg.hL(xa.a.goa),this.Gg.hL(xa.a.qg),this.Gg.hL(xa.a.DQ))}catch(f){ya.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}C2b(a,b,c){try{if(1===c)return 32;2===
c&&(this.Rb&&(this.Rb.slidePane.Kq(),this.Rb.thumbnailPane.Kq(),this.Rb.notesPane.Kq(),this.uD&&this.uD.setVisibility(!1)),this.eP.iS("PptEditingStatusBar.Notes",!1),this.eP.iS("PptEditingStatusBar.ZoomScale",!1),this.eP.iS("PptEditingStatusBar.FitToWindow",!1),this.iCe?this.eP.iS("PptEditingStatusBar.GiveFeedbackPane",!1):this.eP.iS("PptEditingStatusBar.GiveFeedback",!1),this.Fc.Uy(new lq.a(2)),this.Fc.Uy(new lq.a(1)),this.la.Xn||this.Gg.Eo(xa.a.lF),this.Gg.Eo(xa.a.goa),this.Gg.Eo(xa.a.qg),this.Gg.Eo(xa.a.DQ),
this.pa.nh())}catch(f){ya.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",f)}return 32}NHl(a,b,c){if(this.qf.fd(this.Ub.Gf))return 16;if(1===c)return this.ua.Ba?32:16;b=(new Date).getTime();let f=ug.a.Pi(window.document.URL,Yg.a.Lgh,Yg.a.readingView,!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ua.Ba.Cb;f=ug.a.Pi(f,Yg.a.Eoc,c?c.sid.toString():"",!0);f=this.ifc.instance&&this.ifc.instance.isVisible?ug.a.Pi(f,Yg.a.Kgh,"1",!0):ug.a.removeParameter(f,
Yg.a.Kgh,!0);this.XBi();f=ug.a.Pi(f,w.AFrameworkApplication.Ahd,b.toString(),!0);this.pa.nh();this.Fa.Bd();this.Yu.show(!0,a);this.KE.h4(!1,!0,()=>{this.xHh(f)},()=>{ya.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.xHh(f);return!0});return 32}xHh(a){this.Alc.openWindow(1,a,!1)||this.Yu.hide()}und(a,b,c){return this.umb(a,c,null)}Kpc(a,b,c){return this.umb(a,c,null)}Uoc(a,b,c){return this.umb(a,c,null)}QFl(a,b,c){return this.umb(a,c,null)}xza(a,b,c){return this.umb(a,
c,this.ua.Ba?this.ua.Ba.Cb:null)}umb(a,b,c,f=!1,l=!1){if(!this.la.t2c)return this.xFl(a,b,c);if(this.qf.fd(this.Ub.Gf)||!this.Sb.rj()||this.la.preventDuplicateSlideShowLaunches&&this.tZa.Occ()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.tZa.Xhe)return 16;if(1===b)return 32;this.la.Npg&&!qd.a("DummyChangeGateForTest")&&ya.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.Lw.hasDeferredContent()&&ya.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");
this.PFl(c,f,l);return 32}PFl(a,b,c){this.RFb=(new Date).getTime();this.pa.nh();this.Fa.wf(xa.a.dE);this.Fc.snh();ya.a.J(512499918,830,15,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.tZa.Xhe);const f=a?a.sid:-1;a=(a=a?Object(sa.a)(115,this.Sb.dFa(a.sid)):null)?a.qe+1:-1;let l=!1;this.$o.instance?l=this.$o.instance.P_?!0:!1:ya.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.tZa.cwd(f,a,b,this.Ib.Ha("361"),this.Ya.Ck,this.Ya.podSessionId,
this.Ib.Ha("387"),w.AFrameworkApplication.userSessionId,this.la.b5j,this.RFb,l,this.Ya,c);this.tZa.jja(Object(H.a)(this,this.Ejd,"onExitSlideshowHandler"));this.Lz.QCl()}xrc(a,b,c,f){return this.zga(a,b,c,f,{entryPoint:4})}zga(a,b,c,f,l){switch(c){case 2:if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.Ja(ea.a.kvc,2,b),this.Jc&&(this.Jc.nEa=!1),this.Vb&&this.Vb.instance&&(this.Vb.instance.nEa=
!1));return this.tZa.Occ()?(this.Jc&&(this.Jc.Rh=!1),32):this.umb(a,c,this.ua.Ba.Cb,!0);case 1:if(0<this.Sb.rj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===this.ia.processAction(ea.a.kMa,1)&&32===this.ia.processAction(ea.a.kvc,1))return 32;break}else return this.ia.processAction(ea.a.kMa,1);else break;default:ya.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}YRc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Jc)return this.Jc.nEa=
!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:ya.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}XRc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Vb&&this.Vb.instance)return this.Vb.instance.nEa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:ya.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}Mpc(a,
b,c,f,l){return this.X_a(a,b,c,f,l)}X_a(a,b,c){if(this.KHg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){ya.a.J(512499913,833,10,"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&this.Vb.instance.f$a?0<this.Sb.rj()?32:8:8;this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&(this.Vb.instance.mEa=!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");return this.umb(a,
c,this.ua.Ba.Cb,!1,!0)}Y_a(a,b,c){if(1===c)return this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&this.Vb.instance.f$a?32:8;this.Vb.instance.lr&&0!==this.Vb.instance.accessControl?this.Vb.instance.showEndSessionDialog(()=>{this.Vb.instance.N5b(5);this.Vb.instance.accessControl=0;this.Fc.Uy(new lq.a(1))},()=>{}):(this.Vb.instance.accessControl=0,this.Fc.Uy(new lq.a(1)));return 32}Lpc(a,b,c){if(1===c)return this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&this.Vb.instance.f$a&&this.Vb.instance.I0f?32:
8;this.Vb.instance.lr&&1!==this.Vb.instance.accessControl?this.Vb.instance.showEndSessionDialog(()=>{this.Vb.instance.N5b(5);this.Vb.instance.accessControl=1;this.Fc.Uy(new lq.a(1))},()=>{}):(this.Vb.instance.accessControl=1,this.Fc.Uy(new lq.a(1)));return 32}xLb(a,b,c,f,l){try{const y=Object(sa.a)(gi.a,l);y&&this.Vb.instance&&y.If(0===this.Vb.instance.accessControl)}catch(y){ya.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",y)}return 32}yLb(a,
b,c,f,l){try{const y=Object(sa.a)(gi.a,l);y&&this.Vb.instance&&y.If(1===this.Vb.instance.accessControl)}catch(y){ya.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",y)}return 32}xFl(a,b,c){if(this.qf.fd(this.Ub.Gf))return 16;if(1===b)return this.Sb.rj()?32:16;this.RFb=(new Date).getTime();this.pa.nh();this.Fa.wf(xa.a.dE);this.Fc.snh();this.Yu.show(!0,a);this.KE.h4(!1,!0,()=>{this.twh(c,this.RFb)},()=>{ya.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");
this.twh(c,this.RFb);return!0});return 32}Ejd(a,b){a=((new Date).getTime()-this.RFb).toString();ya.a.J(512499909,830,15,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",a,this.Lw.hasDeferredContent(),b.slideId?this.Lw.ihe(b.slideId.toString()):"Missing slideId");this.Lw.hasDeferredContent()||b.slideId&&this.Lw.ihe(b.slideId.toString())?this.Lw.Zra("DeferredExitSlideshowDuration",a):this.Lw.Zra("ExitSlideshowDuration",
a);this.tZa.Bga(Object(H.a)(this,this.Ejd,"onExitSlideshowHandler"));(this.zwa=b)&&!this.zwa.dXj&&!this.zwa.f0j&&0<this.zwa.slideId&&0<=this.zwa.slideIndex&&this.CBk(this.zwa.slideId,this.zwa.slideIndex);this.Fa.Bd();this.mKg?(this.tHa=Kc.a.Jj("ExitSlideshow"),this.qf.blockContent(this.Ub.Gf,"ExitSlideshow"),this.lQg.gk(Object(H.a)(this,this.qch,"onPageManifestNodePropertyChanged")),this.tHa.Wa("UnlockPodsSessionStartTime",Kc.a.vf(new Date)),this.unlockPodsSession(c=>{this.tHa&&(this.tHa.Wa("UnlockPodsSessionWithMerge",
c.toString()),this.tHa.Wa("UnlockPodsSessionEndTime",Kc.a.vf(new Date)));c?this.Qv.S$i():this.RYe()})):this.RYe()}RYe(a=null){a&&(this.Udd=null);this.zwa&&(this.mKg&&(this.lQg.Qm(Object(H.a)(this,this.qch,"onPageManifestNodePropertyChanged")),this.qf.zK(this.Ub.Gf),this.tHa&&(this.tHa.Wa("InboundPresentationEndTime",Kc.a.vf(new Date)),this.tHa.finish(),this.tHa=null)),this.zwa=null,this.Lz.lhl())}unlockPodsSession(a){const b=oh.a.create().toString();ya.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",
b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",w.AFrameworkApplication.fa.appSettings["361"],this.Ya.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=w.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Ya.Ck;this.eyh(c,f,0,a)}eyh(a,b,c,f){this.Qr.qj(a,2,null,b,!1,2,l=>{this.HQl(l,c,f)},l=>{this.POh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,Nl.a("2"))}HQl(a,b,c){if(b)ya.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",
b);else{b=!1;try{a.data.Wd&&0<a.data.Wd.length&&(b=JSON.parse(a.data.Wd).FMerged)}catch(f){ya.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",a.toString())}c(b)}}POh(a,b,c,f,l){f||l(!1);3>f?this.eyh(b,c,f+1,l):ya.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.Pad.j9(a),f)}qch(a,b){this.Udd||b.property!==va.a.eac||(this.Udd=new pd.a(2,1,0,Object(H.a)(this,this.RYe,
"resumeEditor"),90,"65"),this.wb.Hb(this.Udd))}twh(a,b){this.Yu.hide();let c=!0,f=!1,l=this.le.slideShowUrl;l||(l=ug.a.Pi(window.document.URL,Yg.a.Lgh,Yg.a.slideShowView,!0),f=!0);l=ug.a.removeParameter(l,Yg.a.rQk);l=a?ug.a.Pi(l,Yg.a.Eoc,a.sid.toString(),!0):ug.a.removeParameter(l,Yg.a.Eoc);0<b&&(l=ug.a.Pi(l,w.AFrameworkApplication.Ahd,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);
b=null;try{b=this.Alc.lPe(4,l,"SlideShowWindow",a,f,!1)}catch(y){ya.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",y),c=!1}b||(ya.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),c=!1);Kc.a.yk("Window Opened",c.toString());Kc.a.tyd()}Axb(a,b,c){if(2!==c)return this.ia.processAction(F.a.close,c);a=this.ia.processAction(F.a.close,2);32!==a&&(ya.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location=
"about:blank");return 32}CBk(a,b){ya.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Sb.dFa(a))?this.la.Xn?this.Ina.value.dK(a.qe):this.xe.dK(a.qe):(ya.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",b),a=this.Sb.rj()-1,b=b>a?a:b,0>b||(this.la.Xn?this.Ina.value.dK(b):this.xe.dK(b)))}XBi(){this.geb.instance&&this.geb.instance.OVa&&(this.geb.instance.OPc.TC?this.geb.instance.endCommentSession(this.geb.instance.OPc.TC.draftId,
7):this.geb.instance.endCommentSession("",7),this.geb.instance.Szf())}YBi(){this.la.powerPointLiveBroadcastEnabled&&Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",!1).then(b=>{b||(ya.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.KHg=!0);return null})})}}Object(m.a)(uO,"ViewSwitchingActor",null,[268]);class vO{constructor(a,b){this.wwe=null;this.Ya=a;this.Rna=
b;this.eHf();this.Ya.hBf(Object(H.a)(this,this.Qkd,"onSessionInfoChanged"))}eHf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Ya.presentationId.string));a.append(String.format("&{0}={1}",Yg.a.inl,this.Ya.Hwb));a.append(String.format("&{0}={1}",Yg.a.Aoa,"368"in w.AFrameworkApplication.fa.appSettings?void 0===this.Ya.sessionInfo||null===this.Ya.sessionInfo?"undefined":this.Ya.sessionInfo:this.Ya.sessionInfo));this.Ya.Ck&&a.append(String.format("&{0}={1}",Yg.a.Mgh,this.Ya.Ck));this.Ya.podSessionId&&
a.append(String.format("&{0}={1}",Yg.a.Faa,this.Ya.podSessionId));this.wwe=a.toString()}Qkd(){this.eHf()}resolve(a,b,c){if(!b||!b.length)return null;if(b.startsWith("./"+a))return b;const f=qd.a("FixInvalidOperationErrorInEditImageHandler")?encodeURIComponent(b):b;return c?this.Rna+a+this.wwe+`&cl=${c}&${Yg.a.Igh}=${f}`:this.Rna+a+this.wwe+String.format("&{0}={1}",Yg.a.Igh,b)}dispose(){this.Ya.bcl(Object(H.a)(this,this.Qkd,"onSessionInfoChanged"))}}Object(m.a)(vO,"ResourceViewElementResolver",null,
[469,108]);var oS=d(1076),pS=d(972);class wO{constructor(a,b){this.E6c=this.b5=0;this.DNg=null;this.ENg=-1;this.FNg=null;this.Gva=a;this.Dc=b}get soe(){return 0<this.E6c}get pwg(){return this.DNg}gFk(a){this.E6c++;this.Dc.vHh(a.CcpId,a.CcpCorrelation)}get Hse(){return this.FNg}set Hse(a){this.FNg=a}K9g(a,b){if(!a){const c=this.uAj(b);c>this.ENg&&(this.ENg=c,this.DNg=b.CcpId)}0<this.E6c?this.E6c--:ya.a.J(20760084,307,15,"ClipServiceManager - bad state");this.Dc.TYf(b.CcpId,a,0)}VOc(a,b,c=!1,f=!1){a=
Object.assign(new pS.a,{MW:32,Kp:oh.a.create().toString(),version:this.b5++,location:this.Gva.ccpInfo,OD:this.Gva.Ck||Sp.a.dTh,dataType:a,objectCount:b,WFa:c,UFa:f,Py:oh.a.create().toString()});ya.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}uAj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const y=Nd.a(c);if(y&&"I"in y&&"V"in y){l=new tt(y.I,parseInt(y.V));var f={returnValue:!0,Py:l};break a}}catch(y){}f={returnValue:!1,
Py:l}}if(({Py:b}=f).returnValue&&b)return b.version;ya.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(m.a)(wO,"ClipServiceManager",null,[457]);class xO{constructor(a,b,c,f,l,y,G,R,ja){this.Zg=a;this.Hgc=c;this.DHb=f;this.Fve=l;this.Vr=y;this.Dc=G;this.d1=R;this.ia=ja;this.yl=b;this.Uea=this.Zg.contentWindow.document.body;this.Vr.addHandler(this.Uea,pa.a.cut,Object(H.a)(this,this.A$g,"onBrowserCut"));this.Vr.addHandler(this.Uea,pa.a.copy,Object(H.a)(this,
this.z$g,"onBrowserCopy"))}get Hc(){return this.Hgc.Hc}dispose(){this.Zg&&this.Zg.contentWindow&&(this.Vr.removeHandler(this.Uea,pa.a.cut,Object(H.a)(this,this.A$g,"onBrowserCut")),this.Vr.removeHandler(this.Uea,pa.a.copy,Object(H.a)(this,this.z$g,"onBrowserCopy")));this.Zg=null}A$g(){if(il.bB&&!il.bB.O7d){var a=this.Dc.BP(1,0,"OnBrowserCut");this.hta(Object.assign(new ut(!0,!0),{Wb:a}))}}z$g(){if(il.bB&&!il.bB.O7d){var a=this.Dc.BP(0,0,"OnBrowserCopy");this.hta(Object.assign(new ut(!0),{Wb:a}))}}FQ(a){if((w.AFrameworkApplication.XE||
w.AFrameworkApplication.Vx)&&!w.AFrameworkApplication.YSa)return!1;for(let b=0;b<this.yl.length;b++)if(this.yl[b].FQ(a))return!0;return!1}hta(a){if(this.ia.vX)this.d1?(this.d1.show(5,-1),this.Dc.Lg(!1,a.Wb,26)):ya.a.J(509444690,826,10,"m_offlineModalCallout is null");else if(!w.AFrameworkApplication.XE&&!w.AFrameworkApplication.Vx||w.AFrameworkApplication.YSa){var b=0,c=!1;for(var f=0;f<this.yl.length;f++)if(this.yl[f].FQ(a)){c=!0;this.yl[f].hta(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;
case 1:f=19;break;default:f=0}this.Dc.jC(f,a.Wb);if(c){if(a.jpg&&(this.Fve.i1a(this.Zg),!a.E5i)){if(!this.DHb){this.Dc.Lg(!1,a.Wb,1);return}this.DHb.copy(this.Zg)||0!==b||(b=22)}this.Dc.Lg(0===b,a.Wb,b)}else this.Dc.Lg(!1,a.Wb,20)}else this.Dc.Lg(!1,a.Wb,32)}}Object(m.a)(xO,"CutCopyManager",null,[452,108]);var qS=d(926);class yO{constructor(a,b,c){this.sY=a;this.sY.gk(Object(H.a)(this,this.$g,"onPropertyChanged"));this.JM=b;this.JM.gk(Object(H.a)(this,this.$g,"onPropertyChanged"));this.Qq=c}$g(a,
b){this.Qq.jr&&0<this.Qq.jr.length&&(this.Qq.jr=Ub.a.fqa(this.Qq.jr,c=>!(ia.a.pQ(c.id,b.node.id)||Object(Sa.a)($v.a,c))));this.Qq.jr&&!this.Qq.jr.length&&(this.Qq.jr=null)}}Object(m.a)(yO,"GraphNodeChangeListener",null,[]);class zO{constructor(a,b){this.xfc=null;a&&b&&new yO(a,b,this)}get jr(){return this.xfc}set jr(a){const b=this.xfc&&0<this.xfc.length?this.xfc[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.DCf;this.xfc=a;c&&(c.DCf=f,c.RMf=f&&b?b.RMf:qS.a.create().toString())}}Object(m.a)(zO,
"InternalClipboard",null,[451]);class AO{constructor(a,b,c,f,l,y,G,R,ja,za){this.QAg=a;this.wi=b;this.Dfa=c;this.wIa=f;this.Q$=l;this.Ga=y;this.LCe=G;this.Nhc=R;this.Ynk=ja;this.rad=za}v0e(a,b,c){this.QAg.v0e(a,b,c);b=new LM.a;this.LCe&&c||(b.setValue(Ya.a.bold,!1),b.setValue(Ya.a.underline,!1),b.setValue(Ya.a.iw,be.Font.IV),b.setValue(Ya.a.strikethrough,!1),b.setValue(Ya.a.italic,!1),b.setValue(Ya.a.zt,!1),b.setValue(Ya.a.m0,!1));this.wi.H1e(a,b)}K0e(a,b,c){const f=b.cache;if(this.rad){var l=this.rij(b);
na.a.Xa(l)||c?f.propertySet.Ta(Ya.a.font)&&(f.sa(va.a.L1c,!1)||c)&&this.wi.pV(a,f.BL):this.wi.pV(a,l);f.rua&&this.wi.Xq(a,f.fontSize)}else this.QAg.K0e(a,b,c);(!this.Nhc||this.LCe&&c)&&f.w4&&(this.wi.Rm(a,Ya.a.fontColor,f.fontColor),this.Nhc&&(l=bm.SchemeColor.create(null,f.fontColor),this.wi.Rm(a,va.a.schemeColor,l.toString())));this.LCe&&c&&(this.wi.eI(a,f.isBold),this.wi.setItalic(a,f.isItalic),this.wi.gZ(a,f.cG),this.wi.qlb(a,f.j0),this.wi.iZ(a,f.uE),this.wi.wpa(a,f.iw),this.wi.A1a(a,f.zt),this.wi.ulb(a,
f.m0),this.wi.M6(a,f.dG),this.wi.hZ(a,f.isSuperscript),this.wi.eza(a,f.Wm));this.wi.A1a(a,!1);this.$rl(a,b)}gce(a){return this.Dfa.qUa(a)}fX(a){return this.Dfa.fX(a)}BUa(a){return this.wIa.BUa(a)}k9(a){return this.Q$.k9(a)}$rl(a,b){b=b.iA;if(null!==b&&b.Ta(va.a.ZKa)){b=b.eb(va.a.ZKa);var c=a.iA;null===c?this.wi.Rm(a,va.a.ZKa,b):c.setValue(va.a.ZKa,b)}}IDh(a){return this.Ynk&&a&&(a=a.paragraph)&&(a=this.Ga.An(a))&&a.Wf?!0:!1}rij(a){if(!this.rad||!a)return null;let b="";var c=a.paragraph;if(!c)return null;
var f=this.Ga.An(c);if(!f)return null;a=f.sa(sb.a.A0,[]);c=c.sa(sb.a.listLevel,Ke.a.xFa);a&&0<=c&&c<a.length&&(f=f.Nh)&&(a=f.Be(a[c]))&&(a.Ta(va.a.W3d)?b=a.eb(va.a.W3d):a.Ta(va.a.T3d)?b=a.eb(va.a.T3d):a.Ta(va.a.Q3d)?b=a.eb(va.a.Q3d):a.Ta(va.a.$3d)&&(b=a.eb(va.a.$3d)));return b}}Object(m.a)(AO,"PPTFormattingStewardBridge",null,[426]);class BO{constructor(a,b,c,f){this.lc=c;this.MA=f}}Object(m.a)(BO,"PPTFormattingStewardHelper",null,[435]);class CO{constructor(a,b,c,f,l){this.Eqk=[sb.a.um,sb.a.xo];
this.la=a;this.wDb=b;this.wGg=c;this.MJ=f;this.Tb=l;this.sfb=a.ysg;this.hwa=a.pptCopyPasteListMarkerEnabled;this.Hhc=a.pptCopyPasteMarginAndIndentationEnabled}E9e(a){return this.wDb.S3j(a)}Hge(a,b){return this.wDb.k3i(a,b)}spa(a,b,c,f=null,l=null){if(this.wGg.hmd)if(this.wDb.Ppg(c))a.setValue(we.a.$pg,!0);else if(this.wDb.vl(c)){if(this.Hhc&&a&&b){var y=this.Tb.Lc(a);y.rc(11);y.Jg(11);c=Bb.ListReader.Hk(y);const G=this.MJ.wij(a,y);y=this.MJ.sij(a,y);c&&(f||(ya.a.J(41219841,826,50,"Default marginLeft for internal"),
b[sb.a.um.id.toString()]=G),l||(ya.a.J(41219843,826,50,"Default textIndent for internal"),b[sb.a.xo.id.toString()]=y));f&&ya.a.J(41018240,826,50,"Customized marginLeft");l&&ya.a.J(41018242,826,50,"Customized textIndent")}this.wGg.spa(a,b)}if(this.la.C2c&&!zb.ParagraphReader.rX(a))for(const G of this.Eqk)void 0===a.Sh(G)&&a.Ae(G,0)}fOb(a,b,c){if(this.sfb){var f=b.propertySet.Ta(Ya.a.ej)?b.propertySet.eb(Ya.a.ej).length:1;if(a=this.MJ.JQ(a,b.propertySet.sa(sb.a.listLevel,0)))if(this.hwa&&(0<c.gub||
c.HRa&&0<c.HRa.length)){f="";b.lbb&&!b.Uig&&(f=c.font);let l=null;c.HRa&&0<c.HRa.length&&(l=c.HRa,1===c.HRa.length&&ya.a.J(41219847,826,50,"Customized bullet."));let y=-1;0<c.gub&&(y=c.gub,ya.a.J(41219849,826,50,"Customized number list."));this.MJ.FOc(a,b.propertySet);l&&b.propertySet.setValue(Ya.a.ej,l);na.a.Xa(f)||b.propertySet.setValue(Ya.a.font,f);0<y&&b.propertySet.setValue(va.a.autonumberBulletType,y)}else a.sa(Ya.a.ej,[]).length===f&&this.MJ.FOc(a,b.propertySet)}}n2c(a){return this.wDb.n2c(a)}get l3c(){return this.wDb.l3c}f2(a,
b){2===b.unit?(a.setValue(va.a.CX,2),a.setValue(va.a.Jx,b.value)):ya.a.J(36779851,826,50,"the un-support text spacing unit")}TLa(a,b){b.beforeSpacing.value&&(a.setValue(va.a.Hea,b.beforeSpacing.value),a.setValue(va.a.cma,4));b.afterSpacing.value&&(a.setValue(va.a.Gea,b.afterSpacing.value),a.setValue(va.a.bma,4))}LAh(a,b){const c=(new xv.a(b.unit,b.value)).qN;1===b.specialIndentType?a.setValue(sb.a.xo,c):2===b.specialIndentType?a.setValue(sb.a.xo,-c):0===b.specialIndentType&&a.setValue(sb.a.xo,0)}Dzh(a,
b){b=(new xv.a(b.unit,b.value)).qN;a.setValue(sb.a.um,b)}get LDh(){return!0}}Object(m.a)(CO,"PPTPasteStewardBridge",null,[433]);class DO extends Ts{constructor(a,b){super(a,b)}u7b(){return["PasteSlide"]}}Object(m.a)(DO,"PasteSlideReactFloatie",Ts,[]);class EO{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe){this.wig=!1;this.IR=[];this.ckc=[];this.Sue=[];this.wxe=0;this.Q8c=!1;this.ic=c;this.pa=f;this.qhb=l;this.Rc=R;this.uFe=xd;this.od=a;this.Qvk=b;this.Kk=Va;this.ssk=ja;
this.Ub=hb;this.Fa=Cb;this.Ps=lc;this.emk=ic;this.Xlk=yc;this.fc=ec;this.h_g=jc;this.Ib=Xd;this.hdd=Qd;this.Zg=Pe;this.uXa=Fb.a.instance.rb("Common.IReactContextualUILauncher");this.jEb=Fb.a.instance.rb("Common.IExternalUICommandDefinitionMapping");this.Nfd=(this.zh=Xd.ka("ReplaceThumbnailWithSlideSorter"))?document.getElementById("pptonline-sorter-view-id"):y.xa}m6(a){2===a.behavior&&(a=a.actionId,a!==ea.a.xv&&a!==ea.a.YCa&&a!==ea.a.boa&&a!==ea.a.i6&&a!==ea.a.Eja&&a!==ea.a.BQ&&a!==ea.a.insertPicture&&
a!==ea.a.boa&&a!==ea.a.Gta&&a!==ea.a.U9d&&a!==ea.a.T9d&&a!==ea.a.insertPicture&&a!==ea.a.nUc&&a!==ea.a.oUc&&a!==ea.a.$Qe&&a!==ea.a.jmd||this.iE(null,new Id(!0)))}l6(){}Dgi(){this.uFe&&!this.wig&&(this.pa.FC(Object(H.a)(this,this.onSelectionChange,"onSelectionChange")),this.Qvk.zd(7).KF(Object(H.a)(this,this.cC,"onChildTopologyChanged")),this.od.DCa(Object(H.a)(this,this.OY,"onThumbnailDrawCompleted")),md.a.addHandler(this.Nfd,"scroll",Object(H.a)(this,this.d1a,"scrollHandler")),md.a.addHandler(this.zh?
this.Nfd:this.Zg.contentWindow.document.body,pa.a.Df,Object(H.a)(this,this.onKeyDown,"onKeyDown")),this.zh||this.Rc.ub(pa.a.click,this.Nfd,Object(H.a)(this,this.IC,"clickHandler")),w.AFrameworkApplication.Aa.q8(Object(H.a)(this,this.W1,"resizeHandler")),this.ssk.D7a(Object(H.a)(this,this.D1,"onSlidePresenceChanged")),this.Kk.pBf(Object(H.a)(this,this.KOe,"onSlidesIdReturned")),this.emk.TQa(Object(H.a)(this,this.Mkd,"onRevisionProcessedOnServerHandler")),this.Xlk.bji(Object(H.a)(this,this.pFk,"onBlockingHandler")),
this.hdd.yUd(Object(H.a)(this,this.PJk,"onOnlyKeyPressed")),this.wig=!0)}PJk(){if(FC.a.instance.keyCode===B.a.Iba&&this.uXa.Qua){const c=document.getElementById("PasteSlideControl-Floatie");if(c){var a=Cd.a.mi(c),b=this.h_g.xa.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Mz.a.s$e?ya.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Ne.a.O7a)||"",Ne.a.qja===a&&c.click(),!this.Q8c&&this.zh&&(md.a.addHandler(c,pa.a.Df,this.onKeyDown.bind(this)),this.Q8c=
!0))}else ya.a.J(512497816,826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===B.a.AZ&&(this.Q8c&&(a=document.getElementById("PasteSlideControl-Floatie"),md.a.removeHandler(a,pa.a.Df,this.onKeyDown.bind(this)),this.Q8c=!1),this.iE(null,new Id(!0)))}pFk(a,b){1===b.block?this.iE(a,null):2===b.block&&this.iE(a,new Id(!0))}Mkd(a,b){b&&(a=b.GD)&&a.ActionInformation.ActionId!==""+ea.a.Joc&&a.ActionInformation.ActionId!==""+ea.a.bKb&&a.ActionInformation.ActionId!==""+ea.a.lmd&&this.Ps.i5c&&this.Ps.i5c<
parseInt(a.ActionInformation.ActionTime)&&this.iE(null,new Id(!0))}D1(a,b){this.s2f(b.slideId.sid,this.IR)&&(this.iE(null,new Id(!0)),this.Ps.ZOb=!1)}s2f(a,b){for(const c of b)if(c.sid===a)return!0;return!1}KOe(a,b){if(b&&b.h_a){if(this.Sue.length>=b.h_a.length&&!this.uXa.Qua&&(this.setSelection(b.h_a),this.IR.length===b.h_a.length)){this.showFloatie({},new Pj(1,w.AFrameworkApplication.isRtl));let c;(c=this.pa).y7a.apply(c,this.IR)}this.Ps.oKa.length||(this.Ps.oKa=b.h_a,Array.clear(this.IR),Array.clear(this.ckc))}}onSelectionChange(a,
b){if(this.Ps.ZOb){for(a=0;a<b.VE.length;a++)if(Object(sa.a)(4,b.VE[a].context.node)){this.iE(null,new Id(!0));return}!this.Fa.Ee||this.Fa.Ee.name!==Si.a.D3&&this.Fa.Ee.name!==Si.a.iIf&&this.Fa.Ee.name!==Si.a.fIf&&this.Fa.Ee.name!==xa.a.aI&&this.Fa.Ee.name!==xa.a.nJ&&this.Fa.Ee.name!==xa.a.YW||this.iE(null,new Id(!0))}}W1(){this.yVe()}d1a(){this.yVe()}IC(){this.yVe();return!0}yVe(){if(this.uXa.Qua){const a=new Pj(1,w.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}OY(a,b){a=this.Ps.oKa;this.Sue.push(b.$c);
if(!this.uXa.Qua&&this.Ps.ZOb&&a&&a.length>=this.ckc.length&&b.succeeded)for(var c of a)if((b=this.ic.Qk(new nc.a(c)))&&!this.s2f(b.sid,this.ckc)&&(this.ckc.push(b),this.wxe++,b=a.length,this.wxe===b)){this.pa.s9a();this.setSelection(a);var f=void 0;(f=this.pa).y7a.apply(f,this.IR);if(c=this.Lkj())this.Ub.Ba=c;this.wxe=0;c=!0;for(f=0;f<b;f++)(a=this.IR[f].rg(this.qhb))&&a.ujb&&a.ujb.m9()&&0<a.ujb.m9().length&&(c=!1);c&&this.showFloatie({},new Pj(1,w.AFrameworkApplication.isRtl));break}}Lkj(){let a=
this.IR.length;if(!a&&(this.setSelection(this.Ps.oKa),a=this.IR.length,!a))return ya.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;let b=this.IR[0];for(let c=1;c<a;c++)b.slideIndex>this.IR[c].slideIndex&&(b=this.IR[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.IR);for(const b of a)(a=this.ic.Qk(new nc.a(b)))?this.IR.push(a):ya.a.J(512497813,826,50,"Cannot find the slide")}}y$f(){let a=this.IR.length;if(!a&&(this.setSelection(this.Ps.oKa),a=this.IR.length,
!a))return ya.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;ya.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",a));let b=this.IR[0];for(let c=1;c<a;c++)b.slideIndex<this.IR[c].slideIndex&&(b=this.IR[c]);return b}showFloatie(a,b){b.location=this.vyb();if(b.location){const c=this.fc.fd(this.ic.yn);if(!c||c&&a)ya.a.J(512497810,826,50,"ShowFloatie number"),this.Ib.ka("ReactSlidePasteFloatieEnabled")&&(new DO(this.uXa,this.jEb)).G3e(b.location,b.Uu),Array.clear(this.Sue)}}iE(a,
b){this.uXa.Qua&&(this.uXa.iE(),b&&(this.Ps.ZOb=!b.H8d,b.H8d&&this.Ps.Wib&&(a=this.Ps.Wib.YA,null!=a&&ya.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",a.toString()))),this.Ps.ZOb||(this.Ps.i5c=0)))}WGi(a){if(!this.Ps.j4b)return!0;a=a.hI;if(a.length!==this.Ps.j4b.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Ps.j4b[c])||!a[c]&&this.Ps.j4b[c])if(b++,b>this.ckc.length)return!0;return!1}cC(a,b){this.uXa.Qua&&(a=Object(sa.a)(347,b.node))&&this.WGi(a)&&
this.iE(null,null)}vyb(){var a=this.zh?this.Qyj():this.Ryj();if(!a)return null;a=Cd.a.mi(a);const b=a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Nfd.style.height;var l=this.h_g.xa.style.height;l=parseInt(l.substr(0,l.length-2))+Mz.a.s$e;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.iE(null,new Id(!1)),null;this.Ps.position=new Sys.UI.Point(b,c);return this.Ps.position}Qyj(){const a=this.y$f();if(!a)return ya.a.J(509089690,826,50,null),null;let b=document.querySelectorAll("#pptonline-sorter-view-id .grid-content-thumbnail-view-visible-class");
return b&&b.length>a.slideIndex?b[a.slideIndex]:null}Ryj(){var a=this.y$f();if(!a)return ya.a.J(512497808,826,50,null),null;a=a.rg(this.qhb);return a?a.anb:(ya.a.J(512497807,826,50,null),null)}}Object(m.a)(EO,"PasteFloatieHelper",null,[434,144]);class UE{constructor(){this.ZOb=!1;this.i5c=0;this.Wib=null;this.ZPe=0;this.mgb=[];this.position=this.j4b=null}get oKa(){return this.mgb}set oKa(a){a?this.mgb=a:Array.clear(this.mgb)}}Object(m.a)(UE,"PasteFromFloatieArgs",null,[]);var rS=d(1074);class FO{Uac(a){a=
a.I8;return a===xa.a.qg||a===xa.a.lF||a===xa.a.nC}}Object(m.a)(FO,"PasteHandlerUtil",null,[455]);class GO{constructor(a,b,c,f,l,y){this.wU=0;this.ia=a;this.x5=b;this.xIa=c;this.Mx=f;this.TEb=l;this.wnk=y}FQ(a){if(!this.xIa.Uac(this.x5.value))return!1;if(this.Mx.YWj(a)){a=Array.isArray(a.kX)?a.kX:null;if(this.KKj(a)&&!this.iLj(a))return!1;this.wU=1}else if(this.TEb&&(this.Mx.WWj(a)||this.Mx.VWj(a))){a=this.Mx.uoe(a.Pu);if(!this.wnk&&a)return ha.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),
this.wU=0,!1;this.wU=2}else this.wU=0;return 0!==this.wU}paste(a){1===this.wU?this.ia.Ja(ea.a.imd,2,a):2===this.wU&&this.ia.Ja(ea.a.phh,2,a)}KKj(a){for(const b of a)if(!b.isConnected)return!0;return!1}iLj(a){for(const b of a)if(a=b.shapeNode,!a.tj&&!a.xd)return!0;return!1}}Object(m.a)(GO,"ShapePasteHandler",null,[484]);class HO{constructor(a,b,c){this.wU=0;this.ia=a;this.Mx=b;this.gYa=c}FQ(a){this.Mx.zog(a)?this.wU=1:this.gYa&&this.Mx.XWj(a)?this.wU=2:this.wU=this.Mx.$Wj(a)?3:0;return 0!==this.wU}paste(a){a.YA=
null!=a.YA?a.YA:!0;qd.a("UseClipServiceForDestinationThemePaste")&&1===this.wU&&!a.YA&&a.Pu&&(this.wU=2);1===this.wU?this.ia.Ja(ea.a.jmd,2,a):2===this.wU?(a.Pu?ya.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.YA):ya.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),this.ia.Ja(ea.a.lmd,2,a)):3===this.wU&&this.ia.Ja(ea.a.rhh,2,a)}}Object(m.a)(HO,"SlidePasteHandler",null,[484]);class VE{constructor(a,b,c,f){this.TDg=
[k.a.Ikg,k.a.Pmb,k.a.$Jh,k.a.Uwd];this.ia=a;this.Fa=b;this.xIa=c;this.Mx=f}FQ(a){if(!this.xIa.Uac(this.Fa)||VE.l4j(a)||this.Mx.J9j(a))return!1;a.FQ=!this.$Ji(a.kn);return a.FQ}$Ji(a){for(let b=0;b<this.TDg.length;++b)if(0<a.getElementsByTagName(this.TDg[b]).length)return!0;return!1}paste(a){ya.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");this.ia.Ja(ea.a.bQe,2,a)}static l4j(a){if(!a||!a.kn)return ya.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),
!0;a=xb.b(a.kn);return a&&a.length?!1:(ya.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(m.a)(VE,"TextPasteHandler",null,[484]);var sS=d(903),tS=d(974),uS=d(449),jA=d(690);class IO{constructor(a,b){this.dya=a;this.pastedContent=b}}Object(m.a)(IO,"PasteContext",null,[]);class JO{constructor(a){this.KDe=0;this.NHb=null;this.Tuk=a;this.hhb=this.Tuk.hIb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.hhb.start()}M_b(a){if(a&&0<a.length){this.NHb||
(this.NHb={});const b=this.hhb.er;this.NHb[a]=b-this.KDe;this.KDe=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.NHb){a=this.NHb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&ya.a.J(20570128,826,50,b);this.reset()}reset(){this.KDe=0;this.NHb=null}}Object(m.a)(JO,"TimingLogger",null,[]);class pq{constructor(){this.objectCount=0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=
!1;this.selectionSlide=null}static wQi(a){if(!a)return null;a=a.getData(pq.Cwi);return pq.Ilg(pq.Xnh(a))}static xQi(a){return a?pq.Ilg(pq.Xnh(a.pptSlide)):null}static Ilg(a){if(!a||0===a.contentType)return ya.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/pq.xwi:Number.MAX_VALUE;a.skipUndo=!1;ya.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,
a.objectCount,a.errorInCopying);return a}static P9j(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static Xnh(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(pq.P9j(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){ya.a.J(541405765,826,15,"ReadPicklingData exception occured in parsing")}return null}}pq.xwi=1048576;pq.Cwi="ppt/slides";Object(m.a)(pq,"PicklingClipboardObject",
null,[]);var vS=d(692);class Wg{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd){this.TCe=!1;this.sYg=0;this.kZa=null;this.wkc=!1;this.JDe=null;this.NCe=!1;this.x5=a;this.Zg=b;this.Qq=c;this.ZGa=l;this.la=f;this.yl=y;this.Vr=G;this.Uea=this.Zg.contentWindow.document.body;this.Vr.addHandler(this.Uea,pa.a.paste,Object(H.a)(this,this.NMe,"onBrowserPaste"));this.Vd=R;this.Zo=ja;this.Vgc=Cb;this.Ona=new JO(za);this.pma=hb;this.jjc=null;this.Kad=f.B8j;this.hMg=this.Zo.wO(7);this.Mx=Va;
this.FO=lc;this.lR=ic;this.Ga=ec;this.lc=yc;this.Dc=jc;this.d1=xd;this.ia=Xd;this.yEe=f.pptEditingImageMaxSizeInBytes;this.KOg=Math.floor(f.pptEditingImageMaxSizeInBytes*Wg.bGf);this.fhc=f.Eog;this.gYa=f.coe;this.D$c=f.WXj;this.z0g=f.w5j&&this.Zo.tX;this.hDe=this.Ead=!1;this.TEb=f.boe;this.phc=f.Rpg&&this.Zo.Io;this.iuk=f.Nlj&&this.Zo.mg;this.Xhk=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&this.Zo.ava;this.S$c=this.la.F_j;this.CH=Qd;this.pYa=this.la.ka("IsPasteTextFloatieEnabled")}dispose(){this.Zg&&
this.Vr.removeHandler(this.Uea,pa.a.paste,Object(H.a)(this,this.NMe,"onBrowserPaste"));this.Ona=this.Zg=null}GRk(a){a===this.JDe.Wb&&this.ia.Ja(ea.a.Ioc,2,this.JDe)}NMe(a){const b=this.Dc.BP(2,0,"OnBrowserPaste");this.Ona.start();this.Ead=this.NCe=!1;if(il&&il.bB&&!il.bB.O7d){!this.Zo.eG||this.Zo.ik||this.Xhk?k.a.n2b(this.Zg):this.ZGa.i1a(this.Zg);var c=this.lR.Sda(a);c=this.Mx.m3c()?pq.wQi(c):null;var f=new AE;f.B5d=a;f.jkh=b;null!=this.kZa&&(this.Dc.li(Wg.pIf,"menu",b),this.Dc.li(Wg.oIf,this.kZa?
Wg.Hwi:Wg.Fwi,b));this.wkc&&(this.Dc.li(Wg.pIf,"menu",b),this.Dc.li(Wg.oIf,Wg.Gwi,b));var l=this.pYa&&this.iHe,y=this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&this.jHe;this.wkc||l||y||!c||!this.dhh(c,null,b,ea.a.kmd,f)?(this.chh(a,b),this.kZa=null,this.wkc=!1,this.pYa&&(this.iHe=!1,this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(this.jHe=!1))):this.kZa=null}}chh(a,b){var c=this.lR.Sda(a);const f=this.lR.o0f(c);this.Dc.G1e(f,b);if(!this.XNl(a,b)){var l=Object.assign(new zm.a(!0),
{Wb:b,YA:this.kZa});this.pYa&&(l.l6b=this.iHe,this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(l.m6b=this.jHe));var y=null;w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",!1)&&document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")&&(ya.a.J(509669642,826,50,"Getting html from dom event for slide sorter"),(y=a=this.lR.c8b(c))||(y=c.getData("text/plain")));this.iuk&&(ya.a.J(512356507,
826,50,"OnBrowserPaste::Getting html data from Clipboard"),c=this.lR.c8b(c),a=this.lR.iKa(c),c?(this.FLf(a)&&(this.Qq.jr[0].G8a=a.firstChild.className,l.kX=null),l.kn=a):ya.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.JDe=l;Kc.a.gba(()=>{this.mMe(void 0,l,y)},0,this.la.P3j?0:2)}}BBi(a,b){let c=!1;il.bB.y8a(f=>{ya.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",f);null!=f&&f&&(c=this.IBi(a,b))});return c}IBi(a,b){const c=Date.now();let f=!1;il.bB.Sda(this.Zg,
a,l=>{ya.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-c));if(l){var y=this.la.ka("IsPasteTextFloatieEnabled")&&b;if(!a&&!y)l.html&&l.html.length<=Wg.yxi?-1!==l.html.indexOf(Wg.SIf)&&(f=!0):l.pptSlide&&l.pptSlide.length&&(f=!0);else if(y)l.text&&0<l.text.length?f=!0:this.lLj(l.html)&&(f=!0);else if(l.img||l.isImageAvailable)f=!0;f&&(l=[],a?(l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Pxi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Oxi,
!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Nxi,!1))):y?(l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Sxi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Rxi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Qxi,!1))):(l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.Zwi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.byi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.axi,
!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.dyi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.$wi,!1)),l.push(appChrome.actions.updateControlEnabledDisabledState(Wg.cyi,!1))),appChrome.api.dispatch(l));ya.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",f,Date.now()-c)}else ya.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});
return f}lLj(a){if(!a||0==a.length||0<=a.indexOf(Wg.$xi)||0<=a.indexOf(Wg.SIf))return!1;a=this.lR.iKa(a);if(!a)return ya.a.J(509089756,826,15,"hasOnlyTextContent:: html element is null"),!1;const b=a.getElementsByTagName(k.a.Pmb).length;return 0===a.getElementsByTagName(k.a.z4).length&&0===b}dhh(a,b,c,f,l){b||(b=Object.assign(new zm.a(!0),{Wb:c,YA:this.kZa}));b.$M=a;this.Dc.li(Wg.objectCount,a.objectCount.toString(),c);this.Dc.li(Wg.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),
c);this.Dc.li(Wg.Txi,(b.$M.packageSize?null==b.$M.packageSize?0:b.$M.packageSize/Wg.bGf:b.$M.dataSize).toString(),b.Wb);return 0!==b.$M.errorInCopying?(ya.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.$M.ccpid,b.$M.objectCount,b.$M.errorInCopying),this.yEh(b.$M.errorInCopying,f,l,b),!0):this.Mx.q4j(b.$M.dataSize)?this.e5d(b):(ya.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.$M.ccpid,
b.$M.dataSize,b.$M.objectCount),this.yEh(1,f,l,b),!0)}yEh(a,b,c,f){switch(a){case 1:this.Dc.Lg(!1,f.Wb,27);this.CH.kba(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,Wg.ZLc,!1,null);break;default:this.Dc.Lg(!1,f.Wb,28),this.CH.kba(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,
Wg.ZLc,!1,null)}}kmd(a,b){ya.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.Dc.BP(2,0,"PasteSlideAsImage");this.Dc.li("PasteSlideAsImage",b,c);this.Ona.start();this.Ead=this.NCe=!1;this.chh(a,c)}LCi(a){a=a.split("+");const b=this.lc.jg(this.Qq.jr[0].$c).Cb;return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}XNl(a,b){let c=!1,f=this.wkc;var l=this.lR.lae(a.rawEvent,this.Zg.contentWindow);if(l){let y=null;({V$b:y,W8g:l}=this.lR.zyd(l,this.la.clipboardDataImageBlobNumberLimitaton,
this.fhc?50*Wg.kVh:this.KOg));this.Ona.M_b("GetBlob");0<l&&(ya.a.J(512356498,826,50,"Blob is too large"),this.vvd(b),c=!0);y&&1===y.length&&(Kc.a.gba(()=>{this.pzi(y,b,f)},0),this.z0g&&a.preventDefault(),c=!0)}else this.Kad&&this.hMg&&(this.jjc=this.pma.zOl(a.rawEvent));c&&this.Dc.jC(5,b);return c}pzi(a,b,c){if(c||a&&(this.lR.cAd(this.Uea)||this.z0g)){const f=a[0],l=Kc.a.Kb;Kc.a.yk(Ii.a.Psi,f.size.toString());this.fhc&&f.size>=this.KOg?(this.hDe&&ya.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),
this.Vgc.Cxg(f,y=>{Kc.a.qy(l,()=>{y&&this.vCl(y,f.size,b)||(this.Ead=!0,this.mMe(b));this.hDe=!1})}),this.hDe=!0):(new sS.a).fNh(a,y=>{Kc.a.qy(l,()=>{this.kmj(y,b)})})}else this.mMe(b)}kmj(a,b){this.Ona.M_b("GetDataUrl");this.dPl(a,b)||(ya.a.J(512356496,826,15,"Paste image data uri failed"),this.paste(Object.assign(new zm.a(!0),{Wb:b}),null,!1))}mMe(a="",b=null,c=null){this.paste(b||Object.assign(new zm.a(!0),{Wb:a}),c,!1)}QRk(a,b){if(il.bB){ya.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",
a.Wb);var c=Date.now();il.bB.Sda(this.Zg,a.g$a,f=>{a.g$a&&(f.html=null,f.pptSlide=null,f.text=null);this.wek(f,c);if(f=pq.xQi(f)){var l=new BE;l.pastedContent=b;l.dya=a;this.dhh(f,a,a.Wb,ea.a.qhh,l)}else this.paste(a,b,!0)})}}wek(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;ya.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",Date.now()-
b,c,f,l,a)}else ya.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.vX)this.d1.show(5,-1),this.Dc.Lg(!1,a.Wb,26);else if(a.L7d)this.Ige(a,b);else if(il.bB){var f=this.Zo.dU&&w.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.t1c&&!f||this.phc?(a.$M=null,this.Mx.m3c()&&!c?this.QRk(a,b):(ya.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.phc,this.la.t1c),this.zZe(a,b))):(this.kZa=a.YA,
this.wkc=a.g$a,this.pYa&&(this.iHe=a.l6b,this.la.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled")&&(this.jHe=a.m6b)),this.Mx.m3c()&&il.bB.nNl(this.Zg,a.Wb)?(this.Dc.li(Wg.ZRk,"true",a.Wb),this.Dc.Lg(!0,a.Wb)):(this.kZa=null,({content:b}=il.bB.paste(this.Zg,this.x5.value,a.Wb,!1)).returnValue?this.Ige(a,b):(il.bB.Eda(!1),b=il.bB.zy,null==b?(a=new xf.a(null,Object(H.a)(this,this.X5i,"fWaitForAsyncAPIResult"),Object.assign(new HE,{vd:a.Wb})),a.$l("ClipboardPreProcessForAsyncAPI"),a.run()):null!=
b&&b&&this.zZe(a,null))))}else this.Dc.Lg(!1,a.Wb,1)}X5i(a,b){a=il.bB.zy;if(null==a)return!0;b=b.vd.toString();a?this.zZe(Object.assign(new zm.a(!1),{Wb:b}),null):this.Dc.Lg(!1,b,29);return!1}zZe(a,b){this.sYg=Date.now();this.TCe=!1;il.bB.prepareForPaste(a.g$a,c=>{this.Dc.li("isPasteFromAsyncApi",c.toString(),a.Wb);this.TCe=!0});b=new IO(a,b);(new xf.a(null,Object(H.a)(this,this.prepareForPaste,"prepareForPaste"),b)).run()}$Pe(a,b){return a&&0<a.length?(a=Object.assign(new zm.a(!0),{Wb:b,Cie:a,$Sc:!0}),
this.e5d(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.TCe){let f;({content:f}=il.bB.paste(this.Zg,this.x5.value,b.dya.Wb,b.dya.g$a)).returnValue&&f?this.Ige(b.dya,f):c=!0;a=!1}else Date.now()-this.sYg>this.la.OLf&&(ya.a.J(512356491,826,50,null),a=!1,c=!0,il.bB.reset());c&&this.Dc.Lg(!1,b.dya.Wb,29);return a}get gxl(){return this.Zo.Yj&&this.la.BXj}Ige(a,b){if(!a.kn)if(ya.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.Isg&&this.gxl)if(this.Jxl()){b=k.a.xB();
b.src=this.jjc;this.jjc=null;var c=k.a.ee();c.appendChild(b);a.kn=c}else this.FLf(this.Uea)&&(ya.a.J(512356488,826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),this.Qq.jr[0].G8a=this.Uea.firstChild.className,a.kX=null),ya.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.kn=this.Uea;else ya.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=k.a.ee(),tS.a.Atd(c,b,"PasteManager"),a.kn=
c;this.YXd(a);b=this.Mx.WZj(a.kn.firstChild);c=this.Mx.ZZj(a.kn.firstChild);if(b||c)ya.a.J(512356486,826,50,"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",b,c),this.Dc.Lg(!0,a.Wb);else if(this.k9i(a.kn),b=a.kn.innerHTML.startsWith("<img"),c=a.kn.innerHTML.length,a.L7d&&b&&(this.Ona.M_b("ConvertDataUrlToDOMNode"),this.Ona.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.Zo.mz,c,this.NCe))),!c&&this.Ead)this.vvd(a.Wb);else{var f=0,l=!1;({C_d:f,
R7d:l}=this.VNl(a));1===f?(ya.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",l),this.Dc.Lg(!1,a.Wb,25)):!a.kX&&!a.Pu&&c>this.yEe?(qd.a("PasteManagerOacr73010Fix")?(this.Zg.contentWindow.document.body.innerText="",a.kn.innerText=""):(this.Zg.contentWindow.document.body.innerHTML=null,a.kn.innerHTML=null),b?(ya.a.J(512356484,826,50,"Image too large"),this.vvd(a.Wb)):(ya.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",
c)),this.Dc.Lg(!1,a.Wb,7))):(a.Pu?(ya.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",a.YA),this.Dc.li(Sp.a.Kp,a.Pu.Kp,a.Wb)):ya.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),this.e5d(a))}}YXd(a){a?a.kn?a.kn.firstChild?a.kn.firstChild.getAttribute||ya.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):ya.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):
ya.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):ya.a.J(512356480,826,50,"BuildDiagnosticInfo:pasteParams is null")}FLf(a){if(!(this.D$c&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&a.firstChild.getAttribute(Sp.a.type)&&a.firstChild.getAttribute(Sp.a.Olb)&&this.Qq.jr))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(Sp.a.sessionId).toString()===this.Qq.jr[0].sessionId&&b.startsWith("CID")&&b!==this.Qq.jr[0].G8a&&
(Object(Sa.a)(jA.a,this.Qq.jr[0])&&"shape"===a.firstChild.getAttribute(Sp.a.type).toString()&&this.JCi(a.firstChild.getAttribute(Sp.a.Olb).toString())||Object(Sa.a)($v.a,this.Qq.jr[0])&&"slide"===a.firstChild.getAttribute(Sp.a.type).toString()&&this.LCi(a.firstChild.getAttribute(Sp.a.slideId).toString()))}JCi(a){a=a.split(",");let b=0;if(a.length!==this.Qq.jr.length)return!1;for(const c of a)for(const f of this.Qq.jr)if(c===this.Ga.fzb(f.shapeNode).toString()){b++;break}return b===a.length}e5d(a){let b=
!1;for(let c=0;c<this.yl.length;c++)if(this.yl[c].FQ(a)){b=!0;this.yl[c].paste(a);break}b||this.Dc.Lg(!1,a.Wb,19);return b}vCl(a,b,c){if(a){const f=new vS.a("ShrinkImage",!0);a=this.Vgc.CFh(a,b,this.yEe);f.stop();if(a)return this.Ona.M_b("LoadAndShrinkImage"),this.Ona.flush(String.format("Browser={0}, Length={1}",this.Zo.mz,a.length)),Kc.a.yk(Ii.a.VOj,f.oba.toFixed(0)),Kc.a.yk(Ii.a.UOj,f.yRc.toFixed(0)),Kc.a.yk(Ii.a.WOj,a.length.toString()),this.$Pe(a,c)}return!1}k9i(a){this.S$c&&a&&(a=a.ownerDocument)&&
(a=a.getElementById(Sp.a.clg))&&a.parentNode&&a.parentNode.removeChild(a)}VNl(a){let b,c;b=0;c=!1;if(a&&a.kn&&a.kn.firstChild&&a.kn.firstChild.getAttribute){var f=a.kn.firstChild;const l=f.getAttribute(Sp.a.Kp),y=this.Qq.jr;if(y&&0<y.length&&y[0]&&Sys.UI.DomElement.containsCssClass(f,y[0].G8a)){let G=!1;(this.gYa&&Object(Sa.a)($v.a,y[0])||this.TEb&&Object(Sa.a)(jA.a,y[0]))&&this.z1j(y)&&(this.$Xj(l)?G=!0:(a.bfh=!1,ya.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",
a.Wb)),ya.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",a.Wb,G));if(G)ya.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",a.Wb),this.Qq.jr=null;else if(ya.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Wb),a.kX=y,!qd.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,
C_d:b,R7d:c}}else ya.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",l,a.Wb);f=this.Mx.K4i(f,a.Wb);b=f.$Ra;c=1===f.dataType;if(this.Mx.A9j(f)&&void 0!==f&&null!==f&&32===f.MW)return a.Pu=f,ya.a.J(512356443,826,50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.YA),{returnValue:!0,C_d:b,R7d:c};ya.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",
f?f.toString():"(null)")}ya.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");return{returnValue:!1,C_d:b,R7d:c}}dPl(a,b){let c=!1;if(this.pma.mug(a))if(a.length>=this.yEe)this.vvd(b),c=!0;else{if(a=this.pma.jOl(a))this.Ona.M_b("ExtractDataUri"),this.Ona.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.Zo.mz,a.length));c=this.$Pe(a,b)}return c}z1j(a){for(const b of a)if(b.hsg)return!0;return!1}$Xj(a){if(this.FO.soe)return ya.a.J(512356439,826,
50,"Cannot predict copy result due to incompletion"),!1;ya.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",a,this.FO.pwg);return!!a&&a!==this.FO.pwg}vvd(a){this.Dc.Lg(!1,a,18);this.Vd.rH(60,null)}Jxl(){let a=!1;if(this.jjc&&0<this.jjc.length&&this.hMg){const b=this.Uea.getElementsByTagName(k.a.z4);if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}ya.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}
Wg.kVh=1048576;Wg.bGf=.75;Wg.yxi=5E3;Wg.ZRk="PasteViaTriggeringEvent";Wg.objectCount="ObjectCount";Wg.isDataCompressed="IsDataCompressed";Wg.Txi="PastedObjectDataSize";Wg.oIf="ActionName";Wg.pIf="CcpMethod";Wg.Hwi="PasteKeepingSourceFormatting";Wg.Fwi="PasteKeepingDestinationTheme";Wg.Gwi="PasteAsImage";Wg.SIf='data-clipservice-type="slide"';Wg.$xi='data-clipservice-type="shape"';Wg.Zwi="ContextMenu.PasteKeepingDestinationTheme";Wg.byi="ContextMenu.PasteKeepingSourceFormatting";Wg.axi="PasteKeepingDestinationTheme";
Wg.dyi="PasteKeepingSourceFormatting";Wg.$wi="PasteKeepingDestinationThemeMLR";Wg.cyi="PasteKeepingSourceFormattingMLR";Wg.ZLc=20;Wg.Pxi="PasteAsImageSLR";Wg.Oxi="PasteAsImageMLR";Wg.Nxi="ContextMenu.PasteAsImage";Wg.Sxi="PasteTextOnlySLR";Wg.Rxi="PasteTextOnlyMLR";Wg.Qxi="ContextMenu.PasteTextOnly";Object(m.a)(Wg,"PasteManager",null,[453,108]);class KO{constructor(a,b){this.ACg=a;this.Da=b}UFl(a,b,c,f,l){this.ACg.pZ(this.Da.iDi,a,b,c,this.Da.jDi,this.Da.kDi,this.Da.lDi,f,l)}uAi(a){this.ACg.tAi(a)}}
Object(m.a)(KO,"PastedDataUploader",null,[449]);class WE{static create(a){const b=new WE;b.Wtg=Wr.b(a,c=>c.isEditable);return b}}Object(m.a)(WE,"ShapeCopyPasteParams",null,[]);class LO{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe){if(!a)throw Error.argumentNull("selectionManager");if(!b)throw Error.argumentNull("clipboardTarget");if(!c)throw Error.argumentNull("lazyFocusManager");if(!l)throw Error.argumentNull("internalClipBoard");if(!f)throw Error.argumentNull("activeSlideViewManager");
if(!y)throw Error.argumentNull("ccpUtils");if(!G)throw Error.argumentNull("clipboardHelper");if(!R)throw Error.argumentNull("clipServiceManager");if(!ja)throw Error.argumentNull("actionManager");if(!za)throw Error.argumentNull("htmlExportProcessor");if(!Va)throw Error.argumentNull("htmlExportUtils");if(!ec)throw Error.argumentNull("shapeReader");if(!jc)throw Error.argumentNull("clipboardTelemetry");if(!Xd)throw Error.argumentNull("pptFileReaderHelper");if(!Ie)throw Error.argumentNull("systemClipboard");
if(!Pe)throw Error.argumentNull("browserHelperManager");if(!xd)throw Error.argumentNull("deferredContentManager");this.pa=a;this.Zg=b;this.x5=c;this.Qq=l;this.Hgc=f;this.pma=y;this.Mx=G;this.FO=R;this.ia=ja;this.tmk=za;this.umk=Va;this.ghc=hb;this.lhc=Cb;this.E$c=lc;this.cCe=ic;this.PIa=yc;this.Ga=ec;this.Dc=jc;this.Lw=xd;this.xjc=Xd;this.nCe=Qd;this.DHb=Ie;this.ZGa=Pe}FQ(a){const b=this.pa.Qf();let c=!1;b&&0<b.length&&this.x5.value.I8===xa.a.qg&&(a.dataType=2,c=a.vea?this.$4i(b):!this.pa.GVa());
return c}$4i(a){let b=!0;for(const c of a){if(c.h4c&&!c.isLocal)return!0;c.mA||(b=!1)}return b}hta(a){w.AFrameworkApplication.uk("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");const b=this.pa.Qf();if(!b||!b.length)return this.Qq.jr=null,!1;var c;let f=({contentType:c}=this.pma.VYd(b)).returnValue;this.Dc.jC(c,a.Wb);a.vea?({Mlb:f,returnValue:c}=this.YYi(b,a,f),f="Cut:"+f):({Mlb:f,returnValue:c}=this.VYi(b,a,f),f="Copy:"+f);this.Lw.hhe(b,"DoCutCopy")&&
(ya.a.J(509210822,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.vea?this.Lw.Zra("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.Lw.Zra("ShapeCutCopyHandlerHasDeferredContentIsCopy","true"));ya.a.J(509210821,307,50,f);return c}YYi(a,b,c){var f=!0;let l=[];for(const y of a)y.h4c&&l.push(y),y.mA||(f=!1);l=f?a:l;f=({Mlb:c}=this.JTh(l,l,!0,!0,c,b.Wb,f)).returnValue;this.TPf(l,b.vea);this.lhc&&this.WPf(a);return{returnValue:32===this.ia.Ja(ea.a.gTf,2,f),Mlb:c}}VYi(a,
b,c){if(this.ghc&&this.MYj(this.ovj(),a))return{returnValue:!0,Mlb:c};var f=[];for(const l of a)l.h4c&&f.push(l);f=({Mlb:c}=this.JTh(a,f,this.ghc,!1,c,b.Wb)).returnValue;f.Pu&&this.ia.Ja(ea.a.VPf,2,f);this.TPf(a,b.vea);this.lhc&&this.WPf(a);return{returnValue:32===this.ia.processAction(ea.a.UPf,2),Mlb:c}}MYj(a,b){if(!this.FO.soe||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}Yyl(a){if(!a.length)return!0;let b=0,c=0;for(let f=0;f<a.length;f++){const l=
a[f];if(l.isLocal)return!0;!l.tj||l.get_isSVGBlipFilled()||l.isGif||b++;l.xd&&c++}return this.E$c?c===a.length:b+c===a.length}Fmj(a){const b=[];for(const c of a)c&&(a=new jA.a(c),a.sessionId=this.PIa,b.push(a));return b}ovj(){const a=[];if(this.Qq.jr&&this.Qq.jr.length)for(const b of this.Qq.jr){const c=Object(sa.a)(jA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}JTh(a,b,c,f,l,y,G=!1){let R=new dy(null,y,null);this.Qq.jr=this.Fmj(a);!c||this.Yyl(b)?(c&&(ya.a.J(509210820,307,50,
"Clip service shapes cut/copy is throttled"),this.Dc.li(Bu.a.OMf,"true",y)),this.Mx.SAd(this.Zg,this.Qq.jr,null,this.PIa,this.Scg(a),null,y)):(this.pma.GGh(b),c=this.FO.VOc(2,b.length,f,G),c.Qmc=WE.create(b),this.cCe&&this.Lw.hhe(a,f?"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.$Ra=1,c.MW=8),this.Dc.li(Bu.a.Kp,c.Kp,y),l+=String.format(", CcpId={0}",c.Kp),this.Mx.SAd(this.Zg,this.Qq.jr,c,this.PIa,this.Scg(a),null,y),R=new dy(c,y,b));return{returnValue:R,Mlb:l}}Scg(a){const b=[];for(const c of a)Array.add(b,
this.Ga.fzb(c));return b}TPf(a,b){for(const c of a)if(c&&c.tj&&(a=vg.c(c,this.Hgc.Hc.Na))&&!a.Ml&&(a=a.kRa))if(qd.a("FixForIpadImageCCP")){let f;this.nCe&&(f=this.$eg(a));f||(f=a.getAttribute(gj.a.Y$b));f&&(a=f.toString())&&(a.startsWith("data:image/")?this.IVd(a,c):this.V9f(a,c,b))}else(a=this.nCe?this.$eg(a):a.getAttribute(gj.a.Y$b))&&(this.nCe?this.V9f(a,c,b):this.IVd(a.toString(),c))}V9f(a,b,c){try{fetch(a).then(f=>{f.blob().then(l=>{this.xjc.Tnh(l,y=>{y=y.target.result;c&&k.a.n2b(this.Zg);this.IVd(y,
b);this.ZGa.i1a(this.Zg);this.DHb.copy(this.Zg)})}).catch(l=>{ya.a.J(509207576,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in getting blob from response: {0}",l.toString())})}).catch(f=>{ya.a.J(509207575,307,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob from url: {0}",f.toString())})}catch(f){ya.a.J(509210634,826,10,"ShapeCutCopyHandler::getImageDataFromGC2Url exception in fetching blob: {0}",f)}}$eg(a){if((a=a.querySelectorAll("image"))&&a.length&&(a=
a[0].getAttribute("href")))try{const b=new URL(a);if("blob:"===b.protocol||"data:"===b.protocol)return a}catch(b){ya.a.J(509207881,826,10,"Exception {0} while converting to URL.",b)}return null}IVd(a,b){let c=k.a.xB();c.src=a;b.get_shapeRotation()||this.pma.hql(c,b.Ix,b.iD);c.className+=this.Qq.jr[0].G8a;this.Zg.contentWindow.document.body.appendChild(c)}WPf(a){(a=this.umk.Ubj(a,b=>!!b&&b.xd))&&0<a.length&&(a=this.tmk.Vbj(a))&&this.Zg.contentWindow.document.body.appendChild(a)}}Object(m.a)(LO,"ShapeCutCopyHandler",
null,[586]);class os{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb){this.Zg=b;this.x5=c;this.Qq=f;this.ua=l;this.ia=y;this.Mx=G;this.FO=R;this.F$c=ja;this.cCe=za;this.pa=a;this.PIa=Va;this.Dc=hb;this.Lw=Cb}FQ(a){var b=this.x5.value.I8;if(b=!!this.ua.Ba&&!!b&&b===Si.a.fE||b===xa.a.qg&&!this.pa.Ud().length||b===xa.a.nC)a.dataType=1;return b}hta(a){this.Dc.jC(19,a.Wb);return this.YTi(a)}get Nb(){return this.pa}YTi(a){var b=this.Nb.Re();if(!b||!b.length)return this.Qq.jr=null,ha.ULS.sendTraceTag(512497806,
826,10,"Tried to copy slides but no slides were selected."),!1;var c=os.A7f(b,!0);if(!c.length)return a=this.kdg(b).join(","),ha.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),!1;b.length!==c.length&&(b=os.A7f(b,!1),b=this.kdg(b).join(","),ha.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=os.getSlides(this.Qq),l=os.$Oi(this.PIa,c);this.Qq.jr=os.jLl(l);b=(b=
c[0])?b.Cb:null;const y=this.Lw.JKj(c);this.F$c?this.q3e(f,l)?(ya.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.Wb),this.Dc.li(Bu.a.OMf,"true",a.Wb)):(f=this.FO.VOc(1,c.length,a.vea),c=new xE.a(f,a.Wb,c),this.Dc.li(Bu.a.Kp,f.Kp,a.Wb),l=8,y?this.cCe&&(f.$Ra=1,f.MW=8):a.vea||(l=this.ia.Ja(ea.a.t1d,2,c),f.MW=l),this.Mx.SAd(this.Zg,this.Qq.jr,f,this.PIa,null,b,a.Wb),!y&&a.vea&&(l=this.ia.Ja(ea.a.hTf,2,c)),ya.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",
a.vea,f.MW,f.Kp),a.vea?this.Lw.Zra("DeferredSlideCutStatus",f.MW.toString()):this.Lw.Zra("DeferredSlideCopyStatus",f.MW.toString())):(this.Mx.SAd(this.Zg,this.Qq.jr,null,this.PIa,null,b,a.Wb),ya.a.J(576745568,307,15,"Clip service has been disabled. CcpCorId: {0}",a.Wb));return!0}kdg(a){return lj.c(a,b=>b?b.Cb.toString():null)}q3e(a,b){if(!b||!b.length||os.Jpi(b))return!0;if(this.FO.soe){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!os.cqi(a[c],b[c]))return!1;return!0}return!1}static A7f(a,
b){const c=new Oa.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.jr||!a.jr.length)return b;for(let c=0;c<a.jr.length;c++)b.push(Object(sa.a)($v.a,a.jr[c]));return b}static cqi(a,b){return!a&&!b||!!a&&!a.$c&&!!b&&!b.$c||!!a&&!!a.$c&&!!b&&!!b.$c&&(!a.$c.id&&!b.$c.id||!!a.$c.id&&!!b.$c.id&&a.$c.id.equals(b.$c.id))}static Jpi(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].$c&&!nc.a.Fw(a[b].$c.Cb))return!1;return!0}static jLl(a){const b=[];for(const c of a)b.push(c);
return b}static $Oi(a,b){const c=[];for(const f of b)c.push(Object.assign(new $v.a(f),{sessionId:a}));return c}}Object(m.a)(os,"SlideCopyHandler",null,[586]);class MO{constructor(a,b,c,f){this.Kma=this.Wze=!1;this.AZb=null;this.ZGa=a;this.fvk=b;this.Hfc=c;this.Dc=f}get jN(){this.AZb||(this.AZb=this.fvk.create());return this.AZb}get O7d(){return this.Kma}Eda(a){this.jN.Eda(a)}y8a(a){this.jN.y8a(a)}get G6(){return this.jN.G6}get zy(){return this.jN.zy}prepareForPaste(a,b){this.Kma=!0;this.jN.prepareForPaste(b,
a,this.Hfc.eDa.contentWindow.document)}Sda(a,b,c){this.Kma=!0;this.jN.Sda(a,b,c);this.Kma=!1}reset(){this.Kma=!1}nNl(a,b){if(!this.JMa(a,b))return!1;try{const c=a.contentWindow.document;let f=c.body;Ga.a.yv(f);this.jN.W9a(c,f);return!0}catch(c){ya.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.wf(xa.a.qg);if(!this.JMa(a,c)&&(null==this.zy||null!=this.zy&&!this.zy))return{returnValue:!1,
content:f};b=a.contentWindow.document;let l=b.body;this.Kma=!0;Ga.a.yv(l);let y=!1;try{this.ZGa.i1a(a),l=this.jN.W9a(b,l),f=l.innerHTML,y=!0}catch(G){this.N9b(c)}this.Kma=!1;return{returnValue:y,content:f}}copy(a){a.contentWindow.focus();this.Kma=!0;let b;try{this.jN.DSc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Kma=!1;return b?!0:!1}JMa(a,b){if(this.Wze)return!0;this.Kma=!0;let c=!1;try{c=this.jN.JMa(a.contentWindow.document.body,()=>{Ga.a.yv(a.contentWindow.document.body)},()=>{this.ZGa.i1a(a)})}catch(f){}this.Kma=
!1;c?this.Wze=!0:z.a.Yj||null==this.zy||this.zy||this.N9b(b);return c}N9b(a){this.Wze=!1;Jq.instance.Jvb(null,null);this.Dc.Lg(!1,a,29)}}Object(m.a)(MO,"SystemClipboard",null,[450]);class NO{constructor(a,b,c,f,l,y,G,R){this.FCe=!0;this.pGg=!1;l.pptOfflineModeEnabled&&a.qUd(Object(H.a)(this,this.mJb,"onNetworkHealthStateChanged"));this.Yr=b;this.ia=c;this.d1=f;this.la=l;this.eP=y;this.uM=G;this.ua=R;this.WG=0;this.rfb=!1;this.r7c=0;this.bOg=new Date}get status(){return this.WG}mJb(a,b){this.FCe=b.aqe;
this.pGg||this.pzh(this.FCe,"NetworkHealthStateChanged")}e4f(a){this.pGg=!a;this.FCe&&this.pzh(a,"PodSeamlessFailoverManager")}pzh(a,b){a&&this.rfb&&(this.d1.wuc=!1,this.WG=1,this.eP.SA());const c=!a,f=this.r7c+1;Uj.a.instance.Hb(new pd.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.D1a(c,f)},90,"107"));this.r7c++;ha.ULS.sendTraceTag(508913122,813,50,kh.c({["Current state"]:this.rfb.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}D1a(a,
b){this.r7c===b&&this.rfb!==a&&(this.d1.wuc=a,a&&3!==this.ia.mode||((this.rfb=a)?(this.WG=2,this.eP.SA(),this.uM.pX(this.ua.presentation)&&this.d1.show(0,-1)):(this.WG=0,this.d1.dismiss(),this.eP.SA()),qd.a("PersistSelectionInOfflineMode")?this.Yr.jlb(a,!0):this.Yr.D1a(a),ha.ULS.sendTraceTag(508913121,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.r7c,Kc.a.vf(this.bOg)),this.bOg=new Date))}}Object(m.a)(NO,"PPTOfflineManager",
null,[471]);class OO{Ruc(a,b,c){zE.a(a,b,c)}}Object(m.a)(OO,"WarningDialogProxy",null,[446]);var wS=d(278);class ly extends ei.a{constructor(a,b,c,f,l,y,G,R,ja){super();this.U8c=!1;this.cfc=null;this.Jfb=0;this.qbd=this.Yhc=this.mbd=this.jbd=this.eed=this.ubd=this.s8c=this.hgd=this.BYa=this.WDe=this.qEe=this.n1=this.w5=null;this.Hna=a;this.ric=b;this.NJ=c;this.kpk=f;this.Qhk=l;this.dlk=ja;this.Fa=y;this.D0g=R;this.ic=G}dispose(){this.WDe=this.qEe=this.n1=this.w5=null;super.dispose()}vEh(a){this.dPh();
this.sj(a,Object(H.a)(this,this.c1i,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}rxh(a){if(a)for(let b=0;b<this.BYa.length;b++){const c=document.getElementById(this.BYa[b]);if(parseInt(c.getAttribute("LayoutId"))===a){this.oNb(c);break}}}Gu(){super.Gu();k.a.ee().appendChild(this.bPi());const a=document.getElementById(this.Vh("WACDialogPanel"));a&&a.removeAttribute(Ne.a.Uca)}ZA(){super.ZA();var a=document.getElementById(this.Vh("WACDialogPanel"));a.style.width=k.a.Pc(532);a=parseInt(tf.a.wt(a).top);
this.w5.style.height=k.a.Pc(Math.min(Math.max(0,zi.a.oP-a-100),398));this.hg=this.w5.parentNode.innerHTML}x8(){super.x8();this.qEe=document.getElementById("MasterId");this.WDe=document.getElementById("LayoutId");this.Yhc=Object(H.a)(this,this.idb,"keyPressHandler");w.AFrameworkApplication.Aa.DG.Ipd(pa.a.Df,window.document,this.Yhc,null);this.jbd=Object(H.a)(this,this.hbk,"layoutClickHandler");this.mbd=Object(H.a)(this,this.ibk,"layoutDoubleClickHandler");this.qbd=Object(H.a)(this,this.kbk,"layoutOnFocus");
for(let a=0;a<this.BYa.length;a++){const b=document.getElementById(this.BYa[a]);this.Ln.ub(pa.a.click,b,this.jbd);this.Ln.ub(pa.a.doubleClick,b,this.mbd);md.a.addHandler(b.firstChild,"focus",this.qbd)}}$sa(){super.$sa();this.Yhc&&w.AFrameworkApplication.Aa.DG.w$e(pa.a.Df,window.document,this.Yhc);this.Yhc=null;for(let a=0;a<this.BYa.length;a++){const b=document.getElementById(this.BYa[a]);this.Ln.Bb(pa.a.click,b,this.jbd);this.Ln.Bb(pa.a.doubleClick,b,this.mbd);md.a.removeHandler(b.firstChild,"focus",
this.qbd)}this.qbd=this.mbd=this.jbd=null}bPi(){if(this.w5)return this.w5;this.w5=k.a.ee();this.w5.id="LayoutPickerDiv";this.w5.className="LayoutPicker";this.Jfb=0;this.BYa=[];var a=this.ric.length;if(!a||1===a&&!this.ric[0].InContent)return ya.a.J(509654401,822,10,"Legacy LayoutDialog:: Master not loaded."),this.w5;var b=0;let c=!1;for(var f=0;f<a;f++)this.ric[f].Id===this.kpk&&(b=f,c=!0);c&&this.Xyf(this.ric[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.Xyf(this.ric[f],1!==a);a=k.a.jPc();a.id="MasterId";
a.type="hidden";b=k.a.jPc();b.id="LayoutId";b.type="hidden";this.w5.appendChild(a);this.w5.appendChild(b);return this.w5}Xyf(a,b){a.InContent&&this.NJ.Gb(a.Id)&&(b&&this.w5.appendChild(this.uPi(a)),this.w5.appendChild(this.qNi(a)))}uPi(a){const b=k.a.ee();b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}qNi(a){const b=a.Id;a=a.ContentMasters;if(!this.NJ.Gb(b))return null;const c=this.NJ.ga(b),f=k.a.ee();f.className="LayoutTableContainer";var l=k.a.mSf();const y=k.a.rSi();let G=null;f.appendChild(l);
l.appendChild(y);l=this.Hna.width;let R=this.Hna.height,ja;l||(l=1);R||(R=1);ja=R/l*145;let za=0;const Va=a.length;for(var hb=0;hb<Va;hb++)!this.D0g&&this.ic.lcb(a[hb])||za++;hb=1;for(let ec=0;ec<Va;ec++){var Cb=a[ec];if(!this.D0g&&this.ic.lcb(Cb))continue;1===hb%3&&(G=k.a.M2d(),y.appendChild(G));var lc=Cb.Id.toString();const jc=Cb.Name,xd=k.a.zPc();xd.id="Layout"+this.Jfb;xd.setAttribute("LayoutIndex",this.Jfb);xd.setAttribute("MasterId",b);xd.setAttribute("LayoutId",lc);xd.setAttribute(Ne.a.hf,
Ne.a.qQ);Array.add(this.BYa,xd.id);var ic=null;if(lc=!!c.LayoutIcons&&c.LayoutIcons.length>ec&&!!c.LayoutIcons[ec].Icon){ic=-1;for(var yc=0;yc<c.LayoutIcons.length;yc++)if(c.LayoutIcons[yc].LayoutId===Cb.Id){ic=yc;break}-1===ic&&(ic=ec);ic=c.LayoutIcons[ic].Icon;yc=new wS.a(ic.Clip.Bounds.Left,ic.Clip.Bounds.Top,145,ja);Cb=k.a.xB();Cb.src=Fb.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(Yg.a.Gwb,ic.ImgId,"LayoutPicker");Cb.title=jc;Cb.style.clip=this.f6k(yc);Cb.style.left=k.a.Pc(-yc.s3a);
Cb.style.overflow=qe.a.ft;Cb.style.position=qe.a.tba;Cb.style.top=k.a.Pc(-yc.t3a);Cb.style.zIndex="0";l<R&&(Cb.style.height=k.a.Pc(ja));Cb.setAttribute(Ne.a.hf,Ne.a.fRa);ic=document.createElement("span");ic.style.width=k.a.Pc(145);ic.style.height=k.a.Pc(ja);ic.setAttribute("Unselectable","on");ic.style.zIndex="0";ic.style.overflow=qe.a.ft;ic.style.display=qe.a.NGl;ic.style.position=qe.a.svc;ic.appendChild(Cb);ic.setAttribute(Ne.a.NI,Ne.a.rB)}Cb=k.a.ee();Cb.id="title_Layout"+this.Jfb;Cb.className=
"LayoutTitle LayoutTitleHighContrast";Cb.innerText=jc;yc=k.a.mda();yc.setAttribute("tabindex","0");yc.setAttribute("onclick","return false;");yc.setAttribute("unselectable","on");yc.setAttribute(Ne.a.fr,jc);yc.setAttribute(Ne.a.hf,Ne.a.fRa);yc.setAttribute(Ne.a.IWd,hb);yc.setAttribute(Ne.a.JWd,za);lc&&yc.appendChild(ic);yc.appendChild(Cb);G.appendChild(xd);xd.appendChild(yc);this.Jfb++;hb++}Va%3&&(this.Jfb+=3-Va%3);return f}f6k(a){let b;b="rect( "+(k.a.Pc(a.t3a)+", ");b+=k.a.Pc(a.QVh)+", ";b+=k.a.Pc(a.RVh)+
", ";return b+=k.a.Pc(a.s3a)+")"}c1i(a,b){this.U8c&&(Kc.a.evb(this.cfc),this.U8c=!1,this.cfc=null);1===a&&this.Qhk(b.MasterId,b.LayoutId)}kbk(a){a=a.target.parentNode;this.n1&&a.id===this.n1.id||this.oNb(a)}idb(a){a=a.nc;var b=this.ppj(a);if(b===B.a.pSb)return!0;if(b===B.a.jp)return(a=this.Fa.Kl())&&"WACDialogCancelButton"!==a.Gj.G_.id?(this.Wqa(1),this.hide(),!0):!1;a.preventDefault();if(!this.n1)return a=document.getElementById("Layout0"),this.oNb(a),!0;a=parseInt(this.n1.getAttribute("LayoutIndex"));
b=this.onj(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.oNb(f);break}}return!0}ppj(a){let b=B.a.pSb;switch(a.keyCode){case B.a.B2:b=B.a.B2;break;case B.a.A2:b=B.a.A2;break;case B.a.BZ:b=B.a.BZ;break;case B.a.JV:b=B.a.JV;break;case B.a.jp:b=B.a.jp}this.dlk&&(b===B.a.JV?b=B.a.BZ:b===B.a.BZ&&(b=B.a.JV));return b}onj(a){let b=[0];switch(a){case B.a.B2:if(!this.hgd)for(this.hgd=Array(3),a=0;3>a;a++)this.hgd[a]=-3-a;b=this.hgd;break;case B.a.BZ:if(!this.ubd)for(this.ubd=
Array(3),a=0;3>a;a++)this.ubd[a]=-1-a;b=this.ubd;break;case B.a.JV:if(!this.eed)for(this.eed=Array(3),a=0;3>a;a++)this.eed[a]=a+1;b=this.eed;break;case B.a.A2:if(!this.s8c)for(this.s8c=Array(3),a=0;3>a;a++)this.s8c[a]=3-a;b=this.s8c}return b}hbk(a){this.oNb(a.HC);return!0}ibk(a){a=a.HC;a!==this.n1&&this.oNb(a);this.Wqa(1);this.hide();return!0}oNb(a){this.dPh();this.n1=a;const b=this.Fa.Kl();b?b.Gj.mF(a.firstChild):ya.a.J(509654368,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");
Sys.UI.DomElement.addCssClass(this.n1,"Selected");this.vSl();this.U8c=!0;this.cfc||(this.cfc=Kc.a.gba(Object(H.a)(this,this.ell,"selectElement_Finish"),0))}ell(){this.n1&&this.zkl(this.n1);this.U8c=!1;this.cfc=null}dPh(){this.n1&&(Sys.UI.DomElement.removeCssClass(this.n1,"Selected"),this.n1=null)}zkl(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=k.a.q9g(b,a)._y,y=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+
c,l=y+l,l>a&&(b.scrollTop=c+(l-a)))}}vSl(){this.qEe.value=this.n1.getAttribute("MasterId");this.WDe.value=this.n1.getAttribute("LayoutId")}}Object(m.a)(ly,"LayoutPicker",ei.a,[]);class PO extends ly{constructor(a,b,c,f,l,y,G,R,ja){super(a,b,c,f,l,y,G,R,ja)}dispose(){super.dispose()}xvd(a){this.vEh(ResourceStrings.l_NewSlideTitle);this.rxh(a)}Gu(){this.Le(1,ResourceStrings.l_AddSlide);super.Gu()}}Object(m.a)(PO,"AddSlideDialog",ly,[609]);class QO extends ly{constructor(a,b,c,f,l,y,G,R,ja){super(a,
b,c,f,l,y,G,R,ja)}dispose(){super.dispose()}xvd(a){this.vEh(ResourceStrings.L_SlideLayoutDialog);this.rxh(a)}Gu(){this.Le(1,ResourceStrings.L_ChangeLayout);super.Gu()}}Object(m.a)(QO,"ChangeLayoutDialog",ly,[609]);class RO{constructor(a,b){this.Fa=a;this.ic=b}R1d(a,b,c,f,l,y,G,R){switch(a){case 1:return new PO(b,c,f,l,y,this.Fa,this.ic,G,R);case 0:return new QO(b,c,f,l,y,this.Fa,this.ic,G,R);default:return null}}}Object(m.a)(RO,"DialogFactory",null,[587]);class SO{constructor(a,b,c,f,l){this.Lna=
null;this.ia=a;this.IM=b;this.Ys=c;this.LO=f;this.Wp=l;this.IM.p8(Object(H.a)(this,this.Jnc,"onShapeDisconneted"));this.Ys.PUd(Object(H.a)(this,this.Pnc,"onSlideBackgroundClicked"));this.Ys.Yki(Object(H.a)(this,this.Gdh,"onShapeViewElementBackgroundClicked"))}dih(a){if(!a)throw Error.argumentNull("template");this.Lna=a;ya.a.J(18368227,822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.LO.t0=!0}Ioi(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Lna||a.id.equals(this.Lna.id)?
b=!0:a.get_isSVGBlipFilled()&&(this.Lna.Gw||!this.Lna.Rla&&!this.Lna.get_isSVGBlipFilled())&&(b=!0);b?this.zRa():(ya.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",this.Lna.get_shapeId(),a.get_shapeId()),this.ia.Ja(ea.a.V9d,2,new hA(this.Lna,a)))}zRa(){this.isActive&&(ya.a.J(18368262,822,50,"FormatPainter::CancelFormat"),this.Lna=null,this.LO.t0=!1)}dispose(){this.IM.jLa(Object(H.a)(this,this.Jnc,"onShapeDisconneted"));this.Ys.Srh(Object(H.a)(this,this.Pnc,"onSlideBackgroundClicked"));
this.Ys.zcl(Object(H.a)(this,this.Gdh,"onShapeViewElementBackgroundClicked"))}Jnc(a,b){b.node===this.Lna&&this.zRa()}Pnc(){const a=this.isActive;this.zRa();this.Wp&&a&&this.ia.processAction(C.a.Eka,2)}Gdh(a,b){this.isActive&&this.Ioi(b.$w.shapeNode)}get isActive(){return this.LO.t0}get HJl(){return this.Lna}}Object(m.a)(SO,"FormatPainter",null,[468,108]);var xS=d(1200),kA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";
a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(kA||(kA={}));Object(m.b)("OfflineModalCalloutTrigger",kA);class TO{constructor(a){this.Jo=null;this.wuc=!1;this.Rb=a;a=document.createElementNS(gj.a.E6e,"polyline");a.setAttribute(gj.a.vih,"1,1 15,14 30,1");a.setAttribute(gj.a.rwd,"rgb(234,234,234)");a.setAttribute(gj.a.T5e,"2");a.setAttribute(gj.a.C8d,"white");a.setAttribute(gj.a.S5e,"bevel");this.yve=new ln.a;this.yve.ah(32,
16);this.yve.xa.appendChild(a);this.Xec=document.createElement("p");this.Xec.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.Xec.style.width="258px";this.Xec.style.color="black";this.Xec.style.fontSize="14px"}dismiss(){this.Jo&&(this.Jo.dismiss(),this.Jo=null)}show(a,b){ha.ULS.sendTraceTag(512497097,813,50,"OfflineModalCallout.Show is triggered by {0}",kA[a]);if(this.wuc){if(this.Jo){if(this.Jo.WL)return;this.Jo.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");
qd.a("OfflineModalCalloutCrashFix")&&!c?ha.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=Cd.a.mi(c),this.Jo=xS.a.l2d(a,c,this.Rb.jwd,2),this.Jo.w_=4,0<b&&(this.Jo.i8e=b),this.Jo.Mr=!0,this.Jo.content=this.Xec,this.Jo.K_d=()=>{ha.ULS.sendTraceTag(512497095,813,50,"The user clicks the button to close the callout.");this.Jo&&(this.Jo.dispose(),this.Jo=null)},this.Jo.Skd=()=>{if(this.Jo&&this.Jo.content){this.Jo.content.parentNode.style.width=
"258px";this.Jo.fK.style.borderColor="rgb(234,234,234)";for(var f=this.Jo.Ttb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.yve.xa);this.Jo.A1e()}else ha.ULS.sendTraceTag(512497094,813,50,"callout content is empty in OnShowCallback")},this.Jo.show(),ha.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}Object(m.a)(TO,"OfflineModalCallout",null,[470]);var UO=d(298),lA=d(213);class VO{constructor(a,b,c){this.kh=this.NO=this.yb=null;this.Ab=!0;this.ta=a;this.Meb=b;this.XEe=
a.jxb?a.Mea:null;this.rfa=c}dispose(){this.rfa&&this.NO&&($removeHandler(this.NO.xa,"error",Object(H.a)(this,this.sbh,"onImageLoadError")),this.NO.dispose(),this.NO=null);this.yb&&this.yb.Eq();this.NO=this.kh=this.yb=null;this.XEe&&(this.Meb.revokeObjectURL(this.XEe),this.XEe=null)}Bm(a){this.yb=new Rz.a;this.yb.opa(Ui.a.e6e);a.appendChild(this.yb.viewport);this.NO=new UO.a;this.NO.ek(0);this.yb.appendChild(this.NO);this.NO.Yw(this.ta.Mea);$addHandler(this.NO.xa,"error",Object(H.a)(this,this.sbh,
"onImageLoadError"));a=this.ta.Nn;const b=Ce.a.xLh(a);this.NO.setPosition(a.kc,a.mc);this.NO.ah(b.width,b.height);this.NO.Sd(!0);this.kh=new Vm.a;this.kh.ek(1);this.kh.setVisibility(!1);this.kh.xa.setAttribute("class","ShapeMoveHandle");this.kh.Sd(!0);this.kh.Mt(a.points);this.kh.eba("cursor: move");this.yb.appendChild(this.kh);this.yb.em()}sbh(){ya.a.J(34182307,826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ta.Ncb)}setPosition(a,b){this.yb.setPosition(a,b)}kC(){}Kj(a){this.yb.Kj(a)}wq(a){this.yb.fF(a,
lA.a.Zca)}Ju(a){this.yb.fF(a,lA.a.uub)}setZIndex(a){this.yb.lC(a)}ny(){}ZC(){return null}TA(){return[]}draw(){}JD(){}Mp(){return this.Ab?this.yb.Mp():null}get visible(){return this.Ab}set visible(a){this.Ab=a;this.yb.Sd(this.Ab)}get vq(){return this.kh}get ye(){return this.yb}PL(a){return a.Bc===this.vq.xa}Xw(){}setSelection(){}}Object(m.a)(VO,"LocalImageView",null,[614,282,283,108]);class WO{constructor(a,b){this.Meb=a;this.Gmk=b}create(a){return new VO(a,this.Meb,this.Gmk)}}Object(m.a)(WO,"Factory",
null,[463]);class XO{constructor(a){this.Ab=!0;this.jXa=this.UXa=this.yb=null;this.Zd=a}dispose(){this.yb&&this.yb.Eq();this.UXa=this.jXa=this.yb=null;this.Ab=!1}Bm(a){this.yb=new Rz.a;this.yb.opa(Ui.a.e6e);a.appendChild(this.yb.viewport);this.jXa=new Vm.a;this.yb.appendChild(this.jXa);this.jXa.dF(gj.a.none);a=this.Zd.shapeNode.Nn;this.jXa.fv(Pd.a.h2);this.jXa.xr(Pd.a.hF);this.jXa.tpa("2,2");this.jXa.Mt(a.points);this.UXa=new UO.a;this.UXa.ek(0);this.yb.appendChild(this.UXa);this.UXa.Yw(hh.a.PN(Pd.a.Joa));
a=Ce.a.xLh(a);const b=Pd.a.YKb,c=Pd.a.Fnd;this.UXa.setPosition(a.width/2-b/2,a.height/2-c/2);this.UXa.ah(b,c);this.UXa.Sd(!0);this.yb.em()}setPosition(a,b){this.yb.setPosition(a,b)}kC(){}Kj(){}wq(a){this.yb.fF(a,lA.a.Zca)}Ju(a){this.yb.fF(a,lA.a.uub)}setZIndex(a){this.yb.lC(a)}ny(){}ZC(){return null}TA(){return[]}draw(){}JD(){}Mp(){return this.Ab?this.yb.Mp():null}get visible(){return this.Ab}set visible(a){this.Ab=a;this.yb.Sd(this.Ab)}get ye(){return this.yb}PL(){return!1}Xw(){}setSelection(){}}
Object(m.a)(XO,"ShapeProgressIndicatorView",null,[613,282,283,108]);class YO{create(a){return new XO(a)}}Object(m.a)(YO,"Factory",null,[464]);var ps=d(330);class XE{constructor(){this.sz=null;this.Asa=this.KN=this.Bsa=0;this.startTime=this.Dnd=this.Gr=this.ZH=this.$C=this.t6b=null}Imc(){return this.KN<this.sz.oJ?Object.assign(new XE,{sz:this.sz,Bsa:this.KN,KN:this.KN+Math.min(this.Asa,this.sz.oJ-this.KN),Asa:this.Asa,t6b:this.t6b,$C:this.$C,ZH:this.ZH,Gr:this.Gr,Dnd:this.Dnd}):null}}Object(m.a)(XE,
"ChunkUploadingContext",null,[]);var qs=d(514);class gw{constructor(a,b,c,f){this.Af=this.XJ=this.RH=null;this.Xhc=b;this.bfc=c;this.tgb=f;this.wb=a}get T9(){return!!this.RH}pZ(a,b,c,f,l,y,G,R=null,ja=null){this.T9?G(new qs.a(Object.assign(new ps.a,{Code:59}))):(ja&&ja.register(Object(H.a)(this,this.abort,"abort")),0<l&&(this.XJ=Object.assign(new pd.a(2,1,l,Object(H.a)(this,this.UM,"onTimeout"),90,"85"),{customData:G}),this.wb.Hb(this.XJ)),(this.RH=Object.assign(new XE,{sz:a,t6b:c,Bsa:0,KN:0,Asa:b,
$C:f,ZH:y,Gr:G,Dnd:R,startTime:new Date}).Imc())?this.ERb(this.RH):G(new qs.a(Object.assign(new ps.a,{Code:92}))))}ERb(a){this.Xhc();if(this.bfc()||!this.T9)this.reset();else{this.W_a();var b=a.sz,c=a.$C,f=a.Bsa,l=a.KN,y=a.Asa,G=!f&&l===b.oJ,R=new FormData;R.append("Type","2");R.append("FileName",a.sz.fileName);c&&R.append("ImageToken",c);R.append("Content-Range","bytes "+f+"-"+(l-1)+"/"+b.oJ);ya.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",
f,l,y,b.oJ);this.Af.onreadystatechange=()=>{this.Af&&4===this.Af.readyState&&this.VMe(a,this.Af.status)};b=G?a.t6b:a.t6b.slice(f,l);R.append("chunk",b);this.Af.send(R)}}VMe(a,b){let c=Object.assign(new ps.a,{Code:94});if(200===b){this.tgb.vxc(this.Af.getResponseHeader(gw.FMc));b=a.Dnd;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.Af.responseText)}catch(l){ya.a.J(34420810,818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&
f.Result){const l=f.Result;a.$C=l.ItemId;const y=a.Imc();a.Bsa===l.XOffset&&l.ItemId?y?(b&&b.CKk(100*a.KN/a.sz.oJ,!1),c=null,this.ERb(y)):(b&&b.CKk(100,!0),c=null,ya.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.ZH(new xk.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else ya.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",b,a.$C||"");c&&(this.reset(),a.Gr(new qs.a(c)))}W_a(){this.Af=
new XMLHttpRequest;this.Af.open("POST",this.tgb.Qab(),!0);w.AFrameworkApplication.accessToken&&(this.Af.setRequestHeader("X-AccessToken",w.AFrameworkApplication.accessToken),this.Af.setRequestHeader("X-AccessTokenTtl",w.AFrameworkApplication.k_.toString()));w.AFrameworkApplication.canary&&this.Af.setRequestHeader(gw.iAi,w.AFrameworkApplication.canary)}UM(a){ya.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.XJ=null;this.abort();(a=a.customData)&&a(new qs.a(Object.assign(new ps.a,
{Code:299})))}abort(){if(this.T9){ya.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.Af;this.reset();a&&a.abort()}}reset(){this.XJ&&(this.wb.Kg(this.XJ),this.XJ=null);this.RH=this.Af=null}}gw.iAi="X-Key";gw.FMc="X-NewKey";Object(m.a)(gw,"ChunkedPictureUploader",null,[445]);class ZO{constructor(a,b,c,f){this.wb=a;this.mlk=b;this.Vgc=c;this.xEe=f.pptEditingImageMaxSizeInBytes;this.TOg=Math.floor(.75*this.xEe);this.ppk=52428800;this.rMg=f.Eog&&f.Xne;this.ehc=f.Xne;this.T$c=
f.G_j;this.Mhc=f.Ysg}get Mlc(){return this.rMg?this.ppk:this.TOg}get suc(){return this.ehc}get Oud(){return this.T$c}j3b(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.TOg?this.convertToBase64AndCallback(a,b):this.rMg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.mlk.create();this.ehc?c.AOl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.xEe&&(l=null);this.Mhc?b(l):this.wb.Hb(new pd.a(2,1,0,()=>{b(l)},90,"83"))}):c.fNh(a,b)}shrinkToBase64AndCallback(a,
b){this.Vgc.Cxg(a,c=>{const f=this.Vgc.CFh(c,a.size,this.xEe);this.Mhc?b(f):this.wb.Hb(new pd.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(m.a)(ZO,"PPTProcessImageStrategy",null,[578]);var yS=d(1165);class mA{static get hg(){return ei.a.pz(mA.Fo,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}mA.Fo="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(mA,"InsertImageDialogHtml",null,[]);class $O extends ei.a{constructor(a){super();this.Wl=null;this.rw=[];this.QB=a;this.Wvf=!1;this.aYa=w.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}XAl(a){this.hg=mA.hg;this.Le(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(H.a)(this,this.KTj,"insertImageDialogHandler"));if(this.Wl=document.getElementById("fileInput"))this.Wl.setAttribute("accept","image/*"),this.aYa&&a&&this.Wl.setAttribute("multiple",
"multiple");a=[];this.Wl&&(md.a.addHandler(this.Wl,pa.a.Df,Object(H.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.Wl));var b=this.fVc(1);b&&a.push(b);(b=this.fVc(0))&&a.push(b);this.rw=a;this.QTl()}validate(){const a=this.QB.qAd(this.Wl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.QB.dkj(a);b.style.display="inline-block";return!1}return!0}dispose(){this.Wl&&md.a.removeHandler(this.Wl,pa.a.Df,Object(H.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}KTj(a){1===
a&&this.QB.nKk(this.Wl);this.Wl=null}QTl(){if(0<this.rw.length){const a=new yS.a(this.rw),b=t.FocusManager.instance().Kl();b&&(this.rw[0].focus(),b.Gj=a,b.GX=!0)}}onKeyDown(a){4!==t.FocusManager.instance().Tkh(a)&&a.preventDefault()}}Object(m.a)($O,"InsertImageDialog",ei.a,[]);class YE{constructor(){this.y_c=this.file=this.fileName=null;this.S0f=!1;this.WIb=null;this.oJ=this.imageHeight=this.imageWidth=0;this.M7d=!1}}Object(m.a)(YE,"ImageType",null,[]);class aP{constructor(a,b,c,f,l,y,G,R,ja,za){this.FRb=
0;this.j8c=this.qjc=this.rOg=this.Tlb=!1;this.sM=[];this.ZXa="image/*";this.ia=a;this.hgb=b?b.xa:null;this.pJa=null;this.Vd=c;this.xjc=f;this.$Ie=l;this.Icd=R.pptEditingUploadedImageMaxSizeInBytes;this.Meb=y;this.ijk=G;this.HFe=R.pptEditingUploadLargeImageMaxSizeInBytes;this.Oqk=R.pptEditingUploadLargeImageChunkSizeInBytes;this.Pqk=1E3*R.pptEditingUploadLargeImageTimeoutInSeconds;if(this.zhb=R.aTk)this.ZXa=this.zhb.join(",");this.aYa=R.PTj;this.tgb=ja;this.Ie=za;this.Nfc=R.IXi}get S5c(){return this.rOg}set S5c(a){this.rOg=
a;this.qjc=0<this.HFe&&this.Meb.n3j&&a}get $Sk(){return this.qjc}nKk(a){this.Ryf(a);this.hgb&&this.$Ie.S2d(this.hgb,a,Object(H.a)(this,this.$Oe,"onUploadFrameInitialized"),Object(H.a)(this,this.wde,"getPictureUploadEndPoint"),this.ZXa,!1,!1)}WJf(){return!(void 0===window.self.FormData||null===window.self.FormData)}nlh(a){if(this.hgb){if(this.Nfc){if(this.WJf()){this.$Ie.S2d(this.hgb,null,Object(H.a)(this,this.$Oe,"onUploadFrameInitialized"),Object(H.a)(this,this.wde,"getPictureUploadEndPoint"),this.ZXa,
a&&this.aYa,!0);this.j8c=!1;return}ya.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}z.a.Yj||z.a.VBb||z.a.WAb&&72>z.a.fNc?(this.$Ie.S2d(this.hgb,null,Object(H.a)(this,this.$Oe,"onUploadFrameInitialized"),Object(H.a)(this,this.wde,"getPictureUploadEndPoint"),this.ZXa,!1,!1),this.j8c=!1):((new $O(this)).XAl(a),this.j8c=!0)}else ya.a.J(18643099,822,15,"PictureUploader initialize failed.")}b_i(a){this.Zzd&&(Array.addRange(this.sM,a),this.PRh())}get Zzd(){return 1>
this.sM.length}PRh(){if(!this.Zzd){const a=new YE,b=this.sM[0];b?(a.fileName=this.I7d(b.name),a.M7d=!0,this.Vnh(a)):(ya.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.sM.length.toString()),Array.clear(this.sM))}}wde(){return this.tgb.Qab()}$Oe(a){this.pJa=a;if(!this.j8c){if(this.Nfc&&this.WJf()){a.p5d(Object(H.a)(this,this.CJk,"onMultipleFileChosen"));return}if(z.a.eG){a.p5d(Object(H.a)(this,this.oMk,"onSingleFileChosen"));return}a=a.p5d(null);if(!a)return;
this.sM.push(a.files[0])}this.iVd()}Ryf(a){if(a)if(this.aYa)for(const b of a.files)this.sM.push(b);else this.sM.push(a.files[0])}CJk(a){this.Ryf(a);this.iVd()}lZi(a){a=this.qAd(a.fileName);return 0!==a?(this.pJa&&this.pJa.lQc(),2!==a&&3!==a||this.Nt(90,a),!1):!0}y6b(a){let b=!0;this.S5c&&a.y_c&&!this.rXl(a)&&(this.pJa&&(this.pJa.jdc=!1),b=!1);!a.WIb||!this.Tlb&&b||(this.Meb.revokeObjectURL(a.WIb),a.WIb=null);if(b){switch(this.FRb){case 0:this.ia.Ja(ea.a.ATc,2,a);break;case 1:this.ia.Ja(ea.a.T9d,2,
a)}this.PRh()}else Array.clear(this.sM)}I7d(a){if(a){let b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}rXl(a){if(a.oJ>this.Icd){if(this.qjc&&a.oJ<this.HFe)return ya.a.J(34420823,822,50,"Upload large image: {0}",a.oJ),a.M7d=!0;ya.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.oJ/1024/1024,this.Icd/1024/1024);this.Nt(87,4);return!1}return!0}L4i(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+
1)}B5e(a,b,c,f=null){if(a.M7d||this.aYa&&1<this.sM.length){const l=this.pJa,y=this.sM[0];Array.remove(this.sM,y);const G=Kc.a.Kb;G&&G.Wa("FChuckedPictureUpload","True");this.ijk().pZ(a,this.Oqk,y,f,this.Pqk,R=>{l&&(l.jdc=!1,l.dispose());b(R)},R=>{l&&(l.jdc=!1,l.dispose());Array.clear(this.sM);c(R)})}else this.pJa&&(a=this.Erj(f),this.pJa.VGl(b,c,a)),Array.clear(this.sM)}Erj(a){const b=new Yc.a;b.$("PresentationId",this.Ie.presentationId.string);b.$(Yg.a.Aoa,this.Ie.sessionInfo);b.$("Canary",w.AFrameworkApplication.canary);
b.$("access_token",w.AFrameworkApplication.accessToken);b.$("Type",this.FRb.toString());a&&b.$("ImageToken",a);return b}oMk(a){a&&(Array.add(this.sM,a.files[0]),this.iVd())}iVd(){if(this.Zzd||!this.sM[0])Array.clear(this.sM);else{var a=new YE;a.fileName=this.I7d(this.sM[0].name);this.pJa.jdc=!0;this.Vnh(a)}}Vnh(a){this.lZi(a)?this.S5c?this.s4k(a):this.y6b(a):Array.clear(this.sM)}qAd(a,b=!1){if(a&&a.length){if(1===this.FRb&&this.b8j(a))return ya.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),
3;if(this.njg(a))return 0;this.L4i(a)?ya.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):ya.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.FRb?3:2}return 1}b8j(a){return!!a&&0<a.length&&na.a.ug(a).endsWith(".svg")}dkj(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.tug()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;
case 3:return ResourceStrings.l_InvalidImageErrorMessage;default:return""}}tug(){return this.njg(".svg")}njg(a){a=na.a.ug(a);for(let b=0;b<this.zhb.length;++b)if(this.zhb[b]&&0<this.zhb[b].length&&a.endsWith(this.zhb[b].trim().toLowerCase()))return!0;return!1}Nt(a,b){if(87===a){const c=this.qjc?this.HFe:this.Icd;this.Vd.rH(a,f=>{f.JC=1;f.jTa=[(c/1024/1024).toString()];return!1})}else{const c=this.ckj(b);this.Vd.rH(a,f=>{f.JC=1;f.message=c;return!1})}}ckj(a){return 2===a&&this.tug()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.zhb.join(", ")):ResourceStrings.invalidImageFileError}s4k(a){let b=this.sM[0];if(b){a.oJ=b.size;a.file=b;if(b.size>this.Icd&&this.qjc)try{b=b.slice(0,6),a.S0f=!0}catch(c){ya.a.J(34420828,822,50,"File.slice throw exception"),this.Tlb=!0,this.y6b(a)}this.xjc.Tnh(b,c=>{this.kej(c,a)})}}kej(a,b){try{let c=a.target.result;b.y_c=c;b.S0f&&(c=this.Meb.createObjectURL(b.file),b.WIb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.lWj(b.y_c)&&(this.Tlb=!0,ya.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.y6b(b)};f.onerror=()=>{ya.a.J(20828428,822,50,"Read image failed");this.Tlb=!0;this.y6b(b)};f.src=c}catch(c){ya.a.J(20828430,822,50,"GetBase64Image throw exception"),this.Tlb=!0,this.y6b(b)}}lWj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(m.a)(aP,"PictureUploader",null,[444]);class bP{constructor(a){this.Ie=a}Qab(){let a="pptPictureUpload.ashx";if(Sc.App.webServiceBase)a=Sc.App.webServiceBase+
a;else if(z.a.mg||z.a.kva)a=ug.a.Jka(a);a+=String.format("?{0}&{1}&{2}",w.AFrameworkApplication.yUa(),this.Ie.presentationId.string,w.AFrameworkApplication.F7b());this.Ie.podSessionId&&(a+=String.format("&{0}={1}",Yg.a.Faa,this.Ie.podSessionId));this.Ie.Ck&&(a+=String.format("&waccluster={0}",this.Ie.Ck));return a}vxc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}w.AFrameworkApplication.canary=a;w.AFrameworkApplication.TWa&&
ya.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(m.a)(bP,"PictureUploaderHelper",null,[443]);class nA{constructor(a,b,c,f,l,y,G,R,ja,za){this.jdc=!1;this.AU=null;this.Sma=!1;this.Af=this.jY=this.LYa=this.ugc=this.olc=this.Wl=this.Px=this.tAe=null;this.tf=a;this.Qmk=f;this.Ie=c;this.o$=l;this.ZEb=y;b&&(this.Wl=b.cloneNode(!0));this.Ulk=G;this.ZXa=R;this.Opk=ja;(this.yeb=za)?this.xZf():this.wMi()}wMi(){this.AU=document.createElement("iframe");this.AU.style.visibility=
Ui.a.hidden;this.AU.id=nA.oyi;this.AU.className="ObjectInDialog";this.tf.appendChild(this.AU);this.olc=Object(H.a)(this,this.Qeh,"onUploadFrameLoad");md.a.addHandler(this.AU,"load",this.olc);z.a.eG&&this.Qeh(null)}p5d(a){w.AFrameworkApplication.Aa.tjb();if(!this.Wl)return null;this.yeb?md.a.addHandler(this.Wl,"change",()=>{this.Y6i(a)}):z.a.eG&&(this.tAe=a,this.ugc=Object(H.a)(this,this.nTc,"fileInputChange"),md.a.addHandler(this.Wl,"change",this.ugc));try{this.Wl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);ya.a.J(19505501,818,10,c);return null}return this.Wl}Y6i(a){a&&a(this.Wl)}nTc(){this.tAe&&this.tAe(this.Wl)}VGl(a,b,c){a||ya.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||ya.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.LYa=a;this.jY=b;if(c.Gb("ImageToken")||c.Gb("AudioToken"))a=this.Px.action,a+=String.format("&{0}={1}",Yg.a.gQk,1),this.Ie.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.Px.action=a;for(let f of c.keys)this.gfi(f,c.ga(f));this.yeb?this.WGl():this.Px.submit()}WGl(){try{ya.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.Px);this.rml(a)}catch(a){ya.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.Mxc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.lQc()}}rml(a){if(a){const b=this.Px.action;this.Af=
new XMLHttpRequest;this.Af.open("POST",b);this.Af.onreadystatechange=Object(H.a)(this,this.tNk,"onUploadResponseReceived");this.Af.send(a)}}tNk(){4===this.Af.readyState&&(this.Af.status===ok.a.mx?this.Mxc(this.Af.responseText):(ya.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.Af.status,this.Af.responseText?!1:!0),this.Mxc("Upload request failed")),this.lQc())}dispose(){this.o$(this);this.yeb&&this.tf?this.tf.removeChild(this.Px):this.tf&&this.AU&&(this.tf.contains(this.AU)&&
this.tf.removeChild(this.AU),this.olc&&md.a.removeHandler(this.AU,"load",this.olc),this.olc=null);this.ugc&&(md.a.removeHandler(this.Wl,"change",this.ugc),this.ugc=null);this.AU=this.Wl=this.Px=this.tf=null}gfi(a,b){const c=this.WOi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.Px.appendChild(c)}WOi(){return this.yeb?document.createElement("input"):this.AU.contentWindow.document.createElement("input")}Qeh(a){try{if(!this.AU.contentWindow.document.body)return}catch(b){ya.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.Mxc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.Sma?this.LYa?(this.Mxc(this.Mzj(this.AU.contentWindow.document.body)),this.lQc()):ya.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.xZf()}xZf(){if(!this.Sma){const a=this.Ulk();this.yeb?(this.Px=document.createElement("form"),this.tf.appendChild(this.Px)):(this.Px=this.AU.contentWindow.document.createElement("form"),this.AU.contentWindow.document.body.appendChild(this.Px));
this.gOi();this.Px.id="formId";this.Px.method="post";this.Px.encoding="multipart/form-data";this.Px.action=a;this.Px.appendChild(this.Wl);this.Sma=!0;this.Qmk(this)}}gOi(){this.Wl||(this.yeb?(this.Wl=document.createElement("input"),this.Wl.style.opacity="0",this.Opk&&(this.Wl.multiple="multiple")):this.Wl=this.AU.contentWindow.document.createElement("input"),this.Wl.type="file",this.Wl.accept=this.ZXa,this.Wl.id="fileInputId",this.Wl.name="fileInputId")}delayedDispose(){this.dispose()}lQc(){const a=
new pd.a(2,1,0,Object(H.a)(this,this.delayedDispose,"delayedDispose"),90,"82");w.AFrameworkApplication.De.Hb(a)}Mxc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){ya.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.LYa?this.LYa(new xk.a(b.Result)):ya.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new ps.a,
{Code:94}),this.jY?this.jY(new qs.a(a)):ya.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}Hwl(){return this.Sma&&!this.jdc}Mzj(a){let b=null;this.ZEb?(this.R$k(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=z.a.Yj?a.innerText:a.innerHTML;return b||"No response got from server"}R$k(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}nA.oyi="ppt_uploadframe";Object(m.a)(nA,
"UploadFrame",null,[606,607,608]);class cP{constructor(a,b){this.uEb=[];this.Ie=a;this.ZEb=b}S2d(a,b,c,f,l,y,G){if(0<this.uEb.length)for(let R=this.uEb.length-1;0<=R;R--)this.uEb[R].Hwl()&&this.uEb[R].dispose();a=new nA(a,b,this.Ie,c,Object(H.a)(this,this.FYi,"disposeHandler"),this.ZEb,f,l,y,G);Array.add(this.uEb,a)}FYi(a){Array.remove(this.uEb,a)}}Object(m.a)(cP,"UploadFrameFactory",null,[442]);class dP extends Kq{constructor(a,b,c,f,l){super(a,b);this.lc=c;this.pa=f;this.khc=l}vr(a){var b="";if(this.khc){const c=
bm.SchemeColor.parse(a);c&&(c.color&&!c.qua&&(b=Object(sa.a)(115,this.lc.jg(this.pa.Pa.nb.Ua.node)),(b=c.resolve(b?b.Fd:null))?c.tQ=Xh.g(b.X0a):ya.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Xh.c(a))),b=c.toString());ya.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Xh.c(b));this.ll.setValue(va.a.schemeColor,b);c&&c.qua&&(a=Xh.i(c.tQ))}na.a.Xa(a)||super.vr(a)}}Object(m.a)(dP,"PptInsertionPointFormatting",
Kq,[]);class ZE{constructor(){this.Asa=this.KN=this.Bsa=0;this.packageKey=this.Zx=this.bqa=null;this.SMb=this.UZa=this.u_=0;this.startTime=this.Gr=this.ZH=null}Imc(){return this.KN<this.bqa.length?Object.assign(new ZE,{Bsa:this.KN,KN:this.KN+Math.min(this.Asa,this.bqa.length-this.KN),Asa:this.Asa,bqa:this.bqa,Zx:this.Zx,packageKey:this.packageKey,ZH:this.ZH,Gr:this.Gr,u_:0,UZa:this.UZa,SMb:this.SMb,startTime:new Date}):null}}Object(m.a)(ZE,"ChunkContext",null,[]);class eP{constructor(a,b,c,f,l){this.Af=
this.XJ=this.RH=null;this.Xhc=b;this.bfc=c;this.wb=a;this.Ie=f;this.Tv=l}get T9(){return!!this.RH}pZ(a,b,c,f,l,y,G,R,ja){this.T9?(ya.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.RH.Zx,f),ja&&ja(new qs.a(Object.assign(new ps.a,{Code:59})))):(0<l&&(this.XJ=Object.assign(new pd.a(2,1,l,Object(H.a)(this,this.UM,"onTimeout"),90,"85"),{customData:ja}),this.wb.Hb(this.XJ)),(this.RH=Object.assign(new ZE,{Bsa:0,
KN:0,Asa:a,bqa:b,packageKey:c,Zx:f,ZH:R,Gr:ja,u_:0,UZa:y,SMb:G,startTime:new Date}).Imc())?this.ERb(this.RH):(ya.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),ja&&ja(new qs.a(Object.assign(new ps.a,{Code:437})))))}tAi(a){this.T9&&(ya.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.RH.Zx),this.RH.Zx===a&&this.abort())}ERb(a){this.Xhc();if(this.bfc()||!this.T9)ya.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.Zx),this.reset();else{var b=this.W_a(a);this.Af.onreadystatechange=()=>{this.Af&&4===this.Af.readyState&&this.VMe(a,this.Af.status)};this.Af.send(b)}}VMe(a,b){let c=Object.assign(new ps.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.Af.responseText)}catch(f){ya.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.Zx)}if(b&&!b.Error&&b.Result){const f=a.Imc();f?(this.Tv.iNa(100*a.KN/
a.bqa.length),this.ERb(f)):(ya.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.Zx),this.Tv.iNa(100),this.reset(),a.ZH&&a.ZH(new xk.a(b.Result)))}b&&(c=b.Error)}else ya.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.Zx);c&&(a.u_<a.UZa?(ya.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.Bsa,a.KN,a.Zx),window.setTimeout(()=>{a.u_++;this.ERb(a)},a.SMb)):(ya.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.Bsa,a.KN,a.Zx),this.reset(),a.Gr&&a.Gr(new qs.a(c))))}W_a(a){this.Af=new XMLHttpRequest;this.Af.open("POST",this.Qab(),!0);w.AFrameworkApplication.accessToken&&(this.Af.setRequestHeader("X-AccessToken",w.AFrameworkApplication.accessToken),this.Af.setRequestHeader("X-AccessTokenTtl",w.AFrameworkApplication.k_.toString()));
const b=a.packageKey,c=a.Bsa,f=a.KN,l=!c&&f===a.bqa.length,y=new FormData;y.append("FileName",a.Zx);b&&y.append("PackageKey",b);y.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.bqa.length);ya.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.bqa.length,a.Zx);a=l?a.bqa:a.bqa.slice(c,f);y.append("ChunkData",a);return y}Qab(){let a="PastedDataUpload.ashx";if(Sc.App.webServiceBase)a=Sc.App.webServiceBase+a;else if(z.a.mg||
z.a.kva)a=ug.a.Jka(a);a+=String.format("?{0}&{1}&{2}",w.AFrameworkApplication.yUa(),this.Ie.presentationId.string,w.AFrameworkApplication.F7b());this.Ie.podSessionId&&(a+=String.format("&{0}={1}",Yg.a.Faa,this.Ie.podSessionId));this.Ie.Ck&&(a+=String.format("&waccluster={0}",this.Ie.Ck));return a}UM(a){ya.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.RH.Zx);this.XJ=null;this.abort();(a=a.customData)&&a(new qs.a(Object.assign(new ps.a,{Code:299})))}abort(){if(this.T9){ya.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.RH.Zx);const a=this.Af;this.reset();a&&a.abort()}}reset(){this.XJ&&(this.wb.Kg(this.XJ),this.XJ=null);this.RH=this.Af=null}}Object(m.a)(eP,"ChunkedDataUploader",null,[448]);class fP{constructor(){this.Ykk=new vb.a(Object(H.a)(this,this.tXj,"isBrowerSupportObjectUrl"))}get n3j(){return this.Ykk.value}tXj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(m.a)(fP,"PPTFileApiHelper",null,[466]);class gP{yXj(){return window.FileReader?!0:!1}Tnh(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}I7d(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(m.a)(gP,"PPTFileReaderHelper",null,[461]);var zS=d(987),AS=d(633),Do;(function(a){a.Accent1="#4472C4";a.Accent2="#ED7D31";
a.Accent3="#A5A5A5";a.Accent4="#FFC000";a.Accent5="#5B9BD5";a.Accent6="#70AD47";a.Hyperlink="#0563C1";a.ClickedHyperlink="#954F72";a.LightBackground="#FFFFFF";a.DarkBackground="#000000";a.TextColorLight="#E7E6E6";a.TextColorDark="#44546A";a.ColorPaletteName="Office"})(Do||(Do={}));Object(m.b)("DefaultOfficeThemeColorScheme",Do);var oA;(function(a){a.ThemeFamilyId="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}";a.VariantId="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"})(oA||(oA={}));Object(m.b)("DefaultOfficeThemeFamily",
oA);const Xl=a=>{if(a)return"#"+(16777216+(a.r<<16)+(a.g<<8)+a.b).toString(16).slice(1);ya.a.J(509207453,811,10,"Color is null")};var BS=d(996),CS=d(342),DS=d(452),ES=d(302),hP=d(547),Hu;(function(a){a.Insert="Insert";a.ReplaceAll="ReplaceAll"})(Hu||(Hu={}));Object(m.b)("MergeAction",Hu);var Up;(function(a){a.ChatPPTExitClicked="ChatPPTExitClicked";a.ChatPPTLikeClicked="ChatPPTLikeClicked";a.ChatPPTDislikeClicked="ChatPPTDislikeClicked";a.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked";a.ChatPPTShowDesigner=
"ChatPPTShowDesigner";a.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart";a.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete";a.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation";a.ChatPPTInsertSlideCompleted="ChatPPTInsertSlideCompleted";a.ChatPPTSearchClicked="ChatPPTSearchClicked";a.ChatPPTSearchCompleted="ChatPPTSearchCompleted";a.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful";a.ChatPPTQueryAppState="ChatPPTQueryAppState";a.ChatPPTAppStateResponse=
"ChatPPTAppStateResponse"})(Up||(Up={}));Object(m.b)("ChatPPTEvents",Up);class iP{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic){this.ME={};this.$0=this.mLg=this.uJg=!1;this.ggb=null;this.ZHe=[];this.zgd=!1;this.jeh=(yc,ec)=>{var jc;if(ec&&ec.FPb){if("NotHandled"!==ec.FPb.status&&this.ZHe.push(ec.FPb),"Success"===ec.FPb.status||"NotHandled"===ec.FPb.status||"Cancelled"===ec.FPb.status)null===(jc=this.E1g)||void 0===jc?void 0:jc.qrh(this.jeh),this.showTaskPane(!0),this.ZHe=[],this.la.ka("ChatPPTAutoOpenTaskPane")&&
this.Rb.MI(xd=>{this.Eu(xd)})}else ya.a.J(509097375,811,15,"Copilot Chat: StoryTellerEventArgs is null")};this.Eu=yc=>{this.la.ka("ChatPPTAutoOpenTaskPane")&&Object(qd.a)("ToggleRibbonModeOnModeSwitch")&&1!==yc.mode&&!this.$0&&this.showTaskPane(!1)};this.QLk=yc=>{yc&&(this.$0=!1,ya.a.J(509166466,811,50,"Copilot Chat: Close SDX in offline mode"))};this.uLl=(yc,ec)=>{this.$0||this.mLg?this.$0&&"Multiline".match(appChrome.selectors.getRibbonMode())&&ec.Uqe?this.eNf():!this.$0&&"SingleLine".match(appChrome.selectors.getRibbonMode())&&
ec.Uqe&&this.showTaskPane(!1):this.showTaskPane(!1)};this.O3e=(yc,ec,jc)=>{if(1==jc)return 32;this.$0?(this.Ryg(!1),this.eNf()):(this.Ryg(!0),this.showTaskPane(!1));return 32};this.Jqc=(yc,ec,jc,xd,Xd)=>{if(!Xd)return 8;null===Xd||void 0===Xd?void 0:Xd.If(this.$0);return 32};this.ZCa=(yc,ec,jc)=>{if(1==jc)return 32;this.Cpl();return 32};this.sbe=()=>{const yc={cB:"Copilot (Preview)",lKh:"Copilot (Preview)"};yc.assetId=this.DBg;yc.nonPersistedSettings=this.ME;yc.n6=this.zib;Object(qd.a)("AddClassOnSDXPaneContainer")&&
(yc.iKh="ActionAITaskPane");Object(qd.a)("AddInPaneHeaderEnhancement")&&(yc.jKh="PPTCoPilot_24");return yc};this.$Ja=(yc,ec)=>{ec&&(yc=ec.instanceId)&&yc.length&&this.ggb===yc&&(this.$0=!1,this.ggb=null,Object(qd.a)("EnableChatPPTEventListenerFromSDX")&&this.fGl())};this.zib=()=>{this.ggb=this.hUa();this.mLg=this.$0=!0;Object(qd.a)("EnableChatPPTEventListenerFromSDX")&&this.lFl()};this.Cpl=()=>{Mj.UISurfaces.Iq().then(yc=>{const ec=this.hUa();ec&&yc.setSelectedTaskPane(ec);return null}).catch(yc=>
{ya.a.J(509354912,811,10,"Copilot Chat: SelectPane exception: {0}",yc.toString())})};this.DVk=yc=>Object(ii.a)(this,void 0,void 0,function*(){var ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff=yc.slides;let bh=[];for(var ch of ff){var of=ch;ff=this.la.ka("ChatPPTEnableHubbleImageSearch");var sg=this.la.ka("ChatPPTEnableTextToImage");if(!of)throw Error.argumentNull("slideData");var Fg=of.Images,og=[],pi=[];for(var Wj of Fg)Wj&&(og.push(Wj.Prompt),pi.push({Url:Wj.Url,Format:void 0}));Fg=of.Title;const wg=of.KeyPoints;
of=of.Notes;Fg&&wg||ya.a.J(509207452,811,15,"Copilot:InvalidOutlineInfo={0}{1}",Fg?"":"slideTitle;",wg?"":"keyPoints;");bh.push({Title:Fg,ImagesQuery:ff?og:void 0,Images:sg?pi:void 0,KeyPoints:wg,Notes:of})}Wj={Title:"",Slides:bh};ff=this.ua.Ba;ch=this.ua.currentSlideIndex;ff||ya.a.J(509207493,811,15,"Copilot Chat: Slide Node is Null. Using Office Default Theme Values");sg=this.la.ka("ChatPPTUseColorSwapFix");ff&&ff.Fd?sg=sg?{["Accent1"]:Xl(ff.Fd.Accent1),["Accent2"]:Xl(ff.Fd.Accent2),["Accent3"]:Xl(ff.Fd.Accent3),
["Accent4"]:Xl(ff.Fd.Accent4),["Accent5"]:Xl(ff.Fd.Accent5),["Accent6"]:Xl(ff.Fd.Accent6),["Hyperlink"]:Xl(ff.Fd.Hyperlink),["ClickedHyperlink"]:Xl(ff.Fd.FollowedHyperlink),["TextColorLight"]:Xl(ff.Fd.Light1),["TextColorDark"]:Xl(ff.Fd.Dark1),["LightBackground"]:Xl(ff.Fd.Light2),["DarkBackground"]:Xl(ff.Fd.Dark2),["ColorPaletteName"]:Object(qd.a)("PptOutlineToPptUsesColorSchemeName")?ff.Fd.ColorSchemeName:void 0}:{["Accent1"]:Xl(ff.Fd.Accent1),["Accent2"]:Xl(ff.Fd.Accent2),["Accent3"]:Xl(ff.Fd.Accent3),
["Accent4"]:Xl(ff.Fd.Accent4),["Accent5"]:Xl(ff.Fd.Accent5),["Accent6"]:Xl(ff.Fd.Accent6),["Hyperlink"]:Xl(ff.Fd.Hyperlink),["ClickedHyperlink"]:Xl(ff.Fd.FollowedHyperlink),["LightBackground"]:Xl(ff.Fd.Light1),["DarkBackground"]:Xl(ff.Fd.Dark1),["TextColorLight"]:Xl(ff.Fd.Light2),["TextColorDark"]:Xl(ff.Fd.Dark2),["ColorPaletteName"]:Object(qd.a)("PptOutlineToPptUsesColorSchemeName")?ff.Fd.ColorSchemeName:void 0}:(ya.a.J(509207489,811,50,"Slide Node is Null. Using Default Office Theme Color Scheme"),
sg={["Accent1"]:Do.Accent1,["Accent2"]:Do.Accent2,["Accent3"]:Do.Accent3,["Accent4"]:Do.Accent4,["Accent5"]:Do.Accent5,["Accent6"]:Do.Accent6,["Hyperlink"]:Do.Hyperlink,["ClickedHyperlink"]:Do.ClickedHyperlink,["LightBackground"]:Do.LightBackground,["DarkBackground"]:Do.DarkBackground,["TextColorLight"]:Do.TextColorLight,["TextColorDark"]:Do.TextColorDark,["ColorPaletteName"]:Object(qd.a)("PptOutlineToPptUsesColorSchemeName")?Do.ColorPaletteName:void 0});og=this.ua;ff&&(null===og||void 0===og?0:og.presentation)&&
og.presentation.W8b(ff)?og="{"+og.presentation.W8b(ff).ThemeFamilyId+"}":(ya.a.J(509207490,811,50,"Slide Node is Null. Using Default Office Theme Family Id"),og=oA.ThemeFamilyId);og=[og];of=pi=void 0;Fg=yc.mergeAction?yc.mergeAction:Hu.Insert;Object(qd.a)("PptOutlineToPptUseFontName")&&Fg==Hu.Insert&&(pi=null===(Xd=null===(xd=null===(jc=null===(ec=null===ff||void 0===ff?void 0:ff.Fd)||void 0===ec?void 0:ec.FontScheme)||void 0===jc?void 0:jc.majorFontField)||void 0===xd?void 0:xd.latinField)||void 0===
Xd?void 0:Xd.typefaceField,of=null===(ig=null===(Pe=null===(Ie=null===(Qd=null===ff||void 0===ff?void 0:ff.Fd)||void 0===Qd?void 0:Qd.FontScheme)||void 0===Ie?void 0:Ie.minorFontField)||void 0===Pe?void 0:Pe.latinField)||void 0===ig?void 0:ig.typefaceField);ec={OutlineInput:{ColorScheme:sg,PresOutline:Wj,ThemeIds:og,MajorFont:pi,MinorFont:of,FRenderFirstThumb:!0},RequestOptions:{ClientName:"ChatPPT",MergeAction:Fg,CorrelationId:void 0,InsertPosition:{ReferenceSlide:{Cid:null===ff||void 0===ff?void 0:
ff.cid,Sid:null===ff||void 0===ff?void 0:ff.sid},InsertBefore:!1}}};ya.a.J(509166875,811,15,"Copilot Chat:MergeAction={0}",yc.mergeAction);ec=yield this.uU.b5f(ec);return{slideIndex:-1===ch||yc.mergeAction===Hu.ReplaceAll?bh.length-1:ch+bh.length,success:ec}});this.Otl=yc=>{yc||ya.a.J(509166874,811,10,"Copilot Chat: SetThumbnailFocus - No data received from SDX");try{const ec=JSON.parse(yc),jc=ec.mergeAction===Hu.ReplaceAll?1:ec.slideIndex;!jc||!this.ic.rj()||jc>this.ic.rj()?ya.a.J(509166371,811,
10,"Copilot Chat: Invalid Slide Index provided to set focus"):this.la.Xn?this.Ina.value.dK(jc):this.xe.dK(jc)}catch(ec){ya.a.J(509166873,811,10,"Copilot Chat: Unexpected Error Occurred setting slideIndex:{0}",ec.toString())}};this.bUj=yc=>{if(null==yc)ya.a.J(509207492,811,10,"Copilot Chat: InsertSlideEventHandler - No message received from SDX");else if(Object(qd.a)("pptCreatorServiceForCopilotEnabled")){let ec;try{ec=JSON.parse(yc)}catch(jc){ya.a.J(509207491,811,10,"Copilot Chat: InsertSlideEventHandler - Unexpected error parsing sdx request data {0}",
jc.toString());return}this.DVk(ec).then(jc=>{jc?(ya.a.J(509211359,811,15,"Copilot Chat: InsertSlideEventHandler - InsertSlideSuccessful={0}",jc.success),jc={type:Up.ChatPPTInsertSlideCompleted,message:JSON.stringify(jc)},this.Pxh(jc)):ya.a.J(509166872,811,10,"Copilot Chat: InsertSlideEventHandler - No Response From creator service")}).catch(jc=>{ya.a.J(509211358,811,10,"Copilot Chat: InsertSlideEventHandler - Unexpected error in insert slide operation from copilot?: {0}",jc.toString())})}};this.BHj=
yc=>{var ec;yc||ya.a.J(508839042,811,10,"Copilot Chat: handleQueryAppState - No data received from SDX");try{const jc=JSON.parse(yc),xd={scenario:jc.scenario,appState:{}};switch(jc.scenario){case "CreatePresentation":const Qd=null===(ec=this.Njk)||void 0===ec?void 0:ec.djj();"None"===Qd?xd.appState.enabled=!0:(xd.appState.enabled=!1,xd.appState.disabledReason=Qd.toString());ya.a.J(508831951,811,50,`Copilot Chat: handleQueryAppState: CreatePresentation disabledReason:${Qd}`);break;default:ya.a.J(508839041,
811,10,`Copilot Chat: handleQueryAppState: app cannot handle ${jc.scenario}`)}const Xd={type:Up.ChatPPTAppStateResponse,message:JSON.stringify(xd)};this.Pxh(Xd)}catch(jc){ya.a.J(508839040,811,10,`Copilot Chat: handleQueryAppState: Unexpected Error: ${jc}`)}};this.Pxh=yc=>{if(this.ggb){var ec=document.getElementById(this.ggb);null==ec?ya.a.J(509196E3,811,10,"Copilot Chat: SDX pane not found. IsPaneVisible={0}",this.$0):ec.contentWindow&&ec.contentWindow.postMessage(yc,"*")}else ya.a.J(509166871,811,
10,"Copilot Chat: SDX instance id is null",this.$0)};this.eLf=yc=>{if(null!==yc&&void 0!==yc&&yc.data)switch(yc.data.type){case Up.ChatPPTExecuteInsertSlideOperation:this.bUj(yc.data.message);break;case Up.ChatPPTShowDesigner:this.ia.processAction(ea.a.sfh,2);break;case Up.ChatPPTLikeClicked:Object(qd.a)("EnableFeedbackInChatPPTMode")&&this.GLi(yc.data.message);break;case Up.ChatPPTDislikeClicked:Object(qd.a)("EnableFeedbackInChatPPTMode")&&this.FLi(yc.data.message);break;case Up.ChatPPTSearchClicked:this.NFl(yc.data.message);
break;case Up.ChatPPTSlideUpdateCheckSuccessful:Object(qd.a)("SetFocusFromSDX")&&this.Otl(yc.data.message);break;case Up.ChatPPTQueryAppState:Object(qd.a)("CreatePresentationEnabledState")&&this.BHj(yc.data.message)}};if(!R)throw Error.argumentNull("graphTopologyManager");if(!ja)throw Error.argumentNull("copilotProxy");if(!y)throw Error.argumentNull("appSettings");if(y.Xn&&!za)throw Error.argumentNull("sorterViewActorLazy");if(!y.Xn&&!Va)throw Error.argumentNull("thumbnailNavigationPaneView");if(!hb)throw Error.argumentNull("presentationReader");
if(!c)throw Error.argumentNull("appFrame");this.ia=a;this.Oc=b;this.la=y;this.nuk=G;this.Gzg=l;this.Rb=c;this.ua=R;this.uU=ja;this.xe=Va;this.Ina=za;this.ic=hb;this.E1g=Cb;this.Njk=lc;this.$d=f;this.DBg=this.la.RYj?"FA000000129":"FA000000121";this.uJg=ic;this.Jt();this.KQj()}vb(){this.ia.ya(ea.a.Yub,rb.a.view,this.O3e);this.ia.ya(ea.a.Yub,rb.a.notes,this.O3e);this.ia.ya(ea.a.Yub,rb.a.Mf,this.O3e);this.ia.ie(ea.a.Yub,4);Object(qd.a)("ShowEnabledStateOfChatPPT")&&this.ia.ra(ea.a.Jqc,rb.a.application,
this.Jqc,96);this.ia.ya(ea.a.ZCa,rb.a.view,this.ZCa);this.ia.ya(ea.a.ZCa,rb.a.notes,this.ZCa);this.ia.ya(ea.a.ZCa,rb.a.Mf,this.ZCa);this.ia.ie(ea.a.ZCa,4)}me(){}Jt(){var a;this.Oc.execute(b=>{b.PJc(this.$Ja)});!Object(qd.a)("DisableLazyBootLogic")&&this.$d&&this.$d.Fli(this.uLl);Object(qd.a)("EnableChatPPTPaneOnEditingMode")&&!this.sWa()&&this.Rb.MI(b=>{this.Eu(b)});Object(qd.a)("EnhancementOfSDXPaneBootTime")&&Sd.a.get_instance().Vj(8,()=>{this.Lol();this.la.ka("ChatPPTAutoOpenTaskPane")&&(this.sWa()||
this.showTaskPane(!1))});Object(qd.a)("FixAddInPaneVisibilityInOfflineMode")&&this.Rb.QQa(this.QLk);Object(qd.a)("StoryTellerToSDXTransition")&&this.sWa()&&(null===(a=this.E1g)||void 0===a?void 0:a.nki(this.jeh))}KQj(){var a;Object(qd.a)("PptChatPaneUseALOverrideIfSet")?this.ME.AugloopClouldALServiceUrl=null!==(a=Object(BS.a)(this.la))&&void 0!==a?a:this.la.Ha("AugLoopCloudALServiceUrl"):this.ME.AugloopClouldALServiceUrl=this.la.Ha("AugLoopCloudALServiceUrl");this.ME.ShouldUseEnvSpecificALUrl=this.nuk.toString();
this.ME.PPTCreatorEnabled=Object(qd.a)("pptCreatorServiceForCopilotEnabled").toString();this.ME.PPTClientOrigin=window.location.origin;this.ME.PPTCopilotSearchEnabled=(!Object(qd.a)("pptCopilotSearch")).toString();this.ME.PPTCopilotEnableTextToImage=this.la.ka("ChatPPTEnableTextToImage").toString();this.ME.PPTShowSuggestionsPill=this.la.ka("ChatPPTSuggestionsPillEnabled").toString();this.ME.PPTCIQDocMenuEnabled=this.la.ka("ChatPPTCIQDocMenuEnabled").toString();this.ME.PPTEnableFluentVisualRefresh=
(this.la.Xbc&&this.la.ka("EnablePPTOBgColorRefresh")).toString();this.ME.PPTCopilotScnCreatePresFromPrompt=this.la.ka("PPTCopilotScnCreatePresFromPrompt").toString();this.ME.PPTCopilotScnCreatePresQueryAppState=this.la.ka("PPTCopilotScnCreatePresQueryAppState")&&Object(qd.a)("CreatePresentationEnabledState")?"true":"false";this.ME.PPTCopilotScnCreatePresFromDoc=this.la.ka("PPTCopilotScnCreatePresFromDoc").toString();this.ME.PPTCopilotScnAddSlide=this.la.ka("PPTCopilotScnAddSlide").toString();this.ME.PPTCopilotScnInsertImage=
this.la.ka("PPTCopilotScnInsertImage").toString();this.ME.PPTCopilotScnAnimate=this.la.ka("PPTCopilotScnAnimate").toString();this.ME.PPTCopilotScnBeautify=this.la.ka("PPTCopilotScnBeautify").toString();this.ME.PPTCopilotScnOrganize=this.la.ka("PPTCopilotScnOrganize").toString();this.ME.PPTCopilotUseOfficeAIAugLoopWorkflow=this.la.ka("PPTCopilotUseOfficeAIAugLoopWorkflow").toString();this.ME.PPTCopilotDebugJOfcPayload=this.la.ka("PPTCopilotDebugJOfcPayload").toString();this.ME.PPTCopilotDebugODSLInput=
this.la.ka("PPTCopilotDebugODSLInput").toString()}sWa(){return Object(qd.a)("StoryTellerToSDXTransition")&&this.uJg&&(this.la.qJ&&(""==this.la.Tza||"blank"==this.la.Tza)||this.la.RVa)}Lol(){Zg.c()?appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ChatPPTPane",!1)):ya.a.J(508875333,811,15,"Copilot Chat: Tried to set Copilot ribbon icon to isHidden:false but appChrome not loaded")}Ryg(a){Object(qd.a)("logTelemetryForOpenClosePane")&&ya.a.J(509613323,811,15,"Copilot Chat: Pane-IsOpen:"+
a)}showTaskPane(a){if(this.$0)return 8;this.ME.ChatPPTSessionID=oh.a.create().toString();this.ME.PPTStoryTellerExecutionResponse=a?JSON.stringify(this.ZHe):"[]";a=Object(qd.a)("StoryTellerToSDXTransition")&&this.Ns?this.Ns:this.Ns=this.sbe();if(!a)return 8;this.ia.Ja(ea.a.Sga,2,a);return 32}eNf(){this.$0&&this.ggb?this.ia.Ja(ea.a.hvb,2,this.ggb):this.$0=!1}hUa(){var a;if(null!==(a=this.Oc)&&void 0!==a&&a.instance)return a=this.Oc.instance.HQ(this.DBg),null===a||void 0===a?void 0:a.instanceId;ya.a.J(509207495,
811,10,"Copilot Chat: m_appForOfficeManager Instance is null")}GLi(a){ya.a.J(508904391,811,15,"Copilot Chat: Like button clicked for {0}",a);this.cPb(!0,a)}FLi(a){ya.a.J(508904390,811,15,"Copilot Chat: Dislike button clicked for {0}",a);this.cPb(!1,a)}cPb(a,b){if(this.Gzg)try{this.Gzg.cPb(a,b,null)}catch(c){ya.a.J(508904389,811,10,"Copilot Chat: Feedback dialog failed to open with error={0}; isLikeDialog={1}; featureArea={2}",c.toString(),a,b)}else ya.a.J(509613464,811,10,"Copilot Chat: ActionAIFeedback is received as null")}NFl(a){a&&
!Object(qd.a)("pptCopilotSearch")&&(a=Object.assign(new CS.a,{selection:Object.assign(new DS.a,{neighborhood:a,mentionStart:0,mentionLength:null===a||void 0===a?void 0:a.length}),launchData:Object.assign(new ES.a,{landingTab:Object(qd.a)("pptCopilotSearchLandingTab")?"File":"All"}),entryPoint:Object(qd.a)("Microsoft.Office.SharedOnline.ChangeGate.UseCopilotEntrypointForDeckGen")?hP.a.powerPointCopilot:hP.a.searchBoxGenerateDeck}),this.ia.Ja(F.a.Y0c,2,a),a=document.getElementById(this.hUa()),null==
a&&ya.a.J(509196033,811,10,"Copilot: SDX pane not found. IsPaneVisible={0}",this.$0),a.contentWindow.postMessage({type:Up.ChatPPTSearchCompleted,message:"1"},"*"))}lFl(){this.zgd||(window.addEventListener("message",this.eLf),this.zgd=!0)}fGl(){this.zgd&&(window.removeEventListener("message",this.eLf),this.zgd=!1)}}Object(m.a)(iP,"ActionAIActor",null,[268]);class jP{constructor(a,b){this.DSl=(c,f,l,y,G)=>{if(1===l)return 32;c=this.la.HDa?"DataSync: Fluid":"DataSync: Box4";G[Tp.a.Value]=c;G[wm.a.labelText]=
c;G[Tp.a.Visible]=!0;return 32};if(!a||!b)throw ha.ULS.sendTraceTag(509384847,844,10,"DataSyncActor:IActor: ActionManager or appSettings should not be null."),Error.argumentNull("actionManager and appSettings cannot be null.");this.ia=a;this.la=b}vb(){this.ia.ra(ea.a.Ilh,ye.a.frame,this.DSl,96)}me(){}}Object(m.a)(jP,"DataSyncActor",null,[268]);class kP{constructor(a){this.Efc=a}cPb(a,b,c){const f=this.zij(b);f.initialFeedbackType=a?"Smile":"Idea";this.showDialog(f,a,b,c)}showDialog(a,b,c,f){function l(G){ya.a.J(508904388,
811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",G,c,b);f&&f(G,c)}const y=this.Gr;Mj.UISurfaces.Zce().then(G=>{G.initializeFeedbackModal(a,l,y)})}Gr(a){ya.a.J(509613318,811,10,"Error in submitting feedback: "+a)}zij(a){var b={};w.AFrameworkApplication.fa.nJc(b);b=this.Efc.getContext(b)||{};b.uiType="Modal";b.screenshot=!0;b.showEmailAddress=!0;const c=b.telemetryGroup||{};c.processSessionId=b.sessionId;c.officeBuild=b.build;c.featureArea=a;b.telemetryGroup=
c;return b}}Object(m.a)(kP,"ActionAIFeedback",null,[]);var FS=d(1051),GS=d(1314);class lP{constructor(a){this.q2a=(b,c,f)=>{var l;c=new FS.a(new vb.a(()=>Sc.App.Mb?Sc.App.Mb.Ld.Di:null),ra.InteractiveViewManager.instance,Fb.a.instance.rb("Box4.ISelectionFactory"),Fb.a.instance.rb("PowerPointWebEditor.ISlideReader"),Fb.a.instance.rb("PowerPointWebEditor.IPPTWorkspace"),Fb.a.instance.rb("PowerPointWebEditor.Graph.IGraphTopologyManager"),new GS.a,Fb.a.instance.rb("Common.IActionManagerExtended"),Fb.a.instance.rb("PowerPointWebEditor.IPptSelectionManager"),
Fb.a.instance.rb("PowerPointWebEditor.IClipServiceManager"),Fb.a.instance.rb("PowerPointWebEditor.IPresentationReader"));b=b===ea.a.q2a?c.getSelectedSlidesAsPPTXStream():c.getAllSlidesAsPPTXStream();if(null===(l=null===b||void 0===b?void 0:b.selectedSlideIDs)||void 0===l||!l.length)return 16;if(1===f)return 2>b.selectedSlideIDs.length?16:32;this.ia.Ja(F.a.b1c,2,b);return 32};if(!a)throw Error.argumentNull("actionManager");this.ia=a;this.vb()}vb(){this.ia.ya(ea.a.q2a,qc.a.application,this.q2a);this.ia.ya(ea.a.n6e,
qc.a.application,this.q2a)}me(){}}Object(m.a)(lP,"AICopilotActor",null,[268]);var mP=d(1075),HS=d(1035),IS=d(994),hw=d(984),pA=d(284),qA=d(300),JS=d(1070);class nP{constructor(a,b,c,f,l,y,G){this.vdd=[];this.jIj=()=>{this.Cfl();this.submitOperation(this.J3b(this.getSelectedText()));return 32};this.Czb=(R,ja,za,Va,hb)=>{2==za&&this.uhb&&(R=JSON.stringify(this.vdd[(Number(hb.SourceControlId.substring(hb.SourceControlId.length-1))-1).toString()].data),this.uhb.hpi(R));return 32};this.zae=()=>{const R=
this.YEe.zae();return JSON.stringify(R)};if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("augLoopRunTimeManager");if(!c)throw Error.argumentNull("pptSelectionManager");if(!f)throw Error.argumentNull("appOfficeManager");if(!l)throw Error.argumentNull("shapeReader");if(!y)throw Error.argumentNull("appSettingsManager");if(!G)throw Error.argumentNull("transformer");this.ia=a;this.Ms=b;this.Ms.execute(R=>{R.kQ(hw.ActionRecommendationAnnotation.getTypeName());R.B6(hw.ActionRecommendationAnnotation.getTypeName(),
this.SQ.bind(this))});this.jb=c;this.Fik=f;this.Ga=l;this.Ib=y;this.YEe=new IS.a(this.Fik,this.jb,this.Ga);this.hsk=new JS.a(this.jb,this.Ga,this.Ib);this.uhb=G;this.vb()}vb(){this.ia.ya(ea.a.kyf,qc.a.application,this.Czb);this.ia.ya(ea.a.lyf,qc.a.application,this.Czb);this.ia.ya(ea.a.myf,qc.a.application,this.Czb);this.ia.ya(ea.a.nyf,qc.a.application,this.Czb);this.ia.ya(ea.a.oyf,qc.a.application,this.Czb);this.ia.ya(ea.a.pyf,qc.a.application,this.Czb);this.ia.ya(ea.a.doh,qc.a.application,this.jIj)}me(){}SQ(a){try{var b=
a.modelResult;a=[];let c=1;this.vdd&&(this.vdd=[]);let f=[];for(let l of b)if(this.L1j(l)){l=JSON.parse(l);for(const y of l){const G=y.scenario;b=y;if(G){this.vdd.push({query:G,data:b});const R="ActionRecommendation"+c.toString();f.push(R);appChrome.api.dispatch(appChrome.actions.setControlLabel(R,G.charAt(0).toUpperCase()+G.substr(1)));c++}}}a.push(appChrome.api.menuSection(f,"",null,null));appChrome.api.dispatch(appChrome.actions.updateMenu("RecommendationContextMenuFlyout",a))}catch(c){}}L1j(a){try{JSON.parse(a)}catch(b){return!1}return!0}submitOperation(a){this.Ms.execute(b=>
{b.submitOperation(a)})}J3b(a){const b=this.KVc();return Object.assign(new pA.a,{parentPath:["Signal",hw.ActionRecommendationSignal.getTypeName()],items:[Object.assign(new qA.a,{body:Object.assign(new hw.ActionRecommendationSignal,{query:a,context:this.zae(),useDirectLLMCall:!0,T2l:w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ContentRecommendationFetchImageEnabled",!1),trigger:"Paragraph"===b?hw.ActionRecommendationTrigger.TextSelection:"TextBoxSelection"})})]})}getSelectedText(){const a=
JSON.parse(this.uhb.Hsj(hw.ActionRecommendationTrigger.TextSelection));return a.shapeText?a.shapeText:a.selectedText}KVc(){const a=this.hsk.contentType.split(",");for(const b of a)if("Paragraph"===b||"SlideTextBox"===b||"SlideShape"===b)return b;return"Unknown"}Cfl(){appChrome.api.dispatch(appChrome.actions.updateMenu("RecommendationContextMenuFlyout",[]))}}Object(m.a)(nP,"SmartRecommendationActor",null,[268]);var oP=d(983),pP=d(978),qP=d(981),rP=d(1078),sP=d(977),tP=d(340),uP=d(982);class vP{constructor(a){this.hNk=
()=>{};this.wGk=()=>{};this.M7c=a;this.M7c.nBf(this.hNk);this.M7c.jji(this.wGk)}}Object(m.a)(vP,"CopilotDesignerKeptRateTracker",null,[504]);class wP{constructor(a){this.DJk=()=>{};this.M7c=a;this.M7c.Lji(this.DJk)}}Object(m.a)(wP,"CopilotDesignerSeenTracker",null,[504]);class $E{constructor(){this.va=new Wc.a}e1k(){var a=new Sys.EventArgs;this.va.raiseEvent("CDD",a)}jji(a){this.va.addHandler("CDD",a)}Lji(a){this.va.addHandler("CDN",a)}nBf(a){this.va.addHandler("CDU",a)}}Object(m.a)($E,"CopilotDesignerMetricsEventSource",
null,[502,503]);class xP{constructor(){this.tNg=this.bFg=this.qed=this.DBe=this.EBe=this.zHe=this.HA=this.Cma=this.K=null}get name(){return"PowerPointWebEditor.Actor"}Xb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").K0j?a.register(426,"Box4.Actors.IFormattingStewardBridge").na().oa(()=>new AO(new wE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),
a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").GBb,a.resolve("PowerPointWebEditor.IApplicationSettings").Zsg,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(426,"Box4.Actors.IFormattingStewardBridge").na().oa(()=>new wE(a.resolve("Box4.IFormattingEditor")));
qd.a("EnhancementOfSDXPaneBootTime")&&a.register(mP.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new mP.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).na();a.register(427,"PowerPointWebEditor.IGraphTransactionHelper").na().oa(()=>
new kN(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Ia("PowerPointWeb.Comments.ICommentFrame")));a.register(428,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").na().oa(()=>new xN(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(429,"Box4.IInsertionPointFormatting").na().oa(()=>new dP(a.rb("Box4.IFontSlotProvider"),
a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").v3c));a.register(430,"Box4.IClipboardCommands").na().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new tE(w.AFrameworkApplication.Qa,ea.a.$ih,ea.a.Ymd,ea.a.Zmd,ea.a.jjh):new tE(w.AFrameworkApplication.Qa,C.a.f1b,C.a.GLc,C.a.z8,C.a.fmd));a.register(431,
"HtmlImport.IHtmlNormalizerSettings").na().oa(()=>new wC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(432,"HtmlImport.IHtmlTranslatorSettings").na().oa(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new kC(c.wsg&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.PVa||c.MRk,!1,c.pptCopyPasteTextWithHighlight,c.PVa,c.PVa||c.pptCopyPasteFontFamilyEnabled,void 0,c.pptCopyPasteMarginAndIndentationEnabled,
a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,c.PVa,c.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled"),f=>f.gbc&&c.mqe,()=>c.Bqe,()=>c.PVa)});a.register(433,"Box4.Actors.IBox4PasteStewardBridge").na().oa(()=>new CO(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),
a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(sE.a,"Common.PressOnlyKeyEvent").na().oa(()=>sE.a.instance());a.register(UE,"PowerPointWebEditor.PasteFromFloatieArgs").na().oa(()=>new UE);a.register(434,"PowerPointWebEditor.IPasteFloatieHelper").na().oa(()=>new EO(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Na,a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").etg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").eDa));a.register(uE,
"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").na().oa(()=>new uE);a.register(169,"Box4.IContextSetEditor").na().oa(()=>Th.ContextSetEditor.instance);a.register(435,"PowerPointWebEditor.IPPTFormattingStewardHelper").na().oa(()=>new BO(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));
a.register(wt,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").na().oa(()=>new wt(a.rb("Box4.IAutoCorrectScheduler"),a.ue("Box4.IUndoManager"),a.Ia("Box4.IExternalSelectionManager")));a.register(SE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").na().oa(()=>new SE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(436,"Box4.Actors.IEopFormattingStrategy").na().oa(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").sdb?
Object(sa.a)(436,new qO):Object(sa.a)(436,new KM));a.register(437,"Box4.ISelectAllHandlers").na().oa(()=>new ms(fx.PageReader.instance,a.ue("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(438,"Box4.Actors.IDeleteOutlineElementNodeStrategy").na().oa(()=>new oO(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(439,"Box4.IFormatPainterStrategy").na().oa(()=>new rO(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(440,"Box4.Clipboard.IClipboardOperationCutStrategy").na().oa(()=>new nO);a.register(441,"Box4.Actors.IDeleteTableSegmentStrategy").na().oa(()=>new pO(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(442,"PowerPointWebEditor.IUploadFrameFactory").na().oa(()=>new cP(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.IApplicationSettings").H_j));a.register(443,"PowerPointWebEditor.IPictureUploaderHelper").na().oa(()=>new bP(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(444,"PowerPointWebEditor.IPictureUploader").na().oa(()=>new aP(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),
a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(445,"PowerPointWebEditor.IChunkedPictureUploader").oa(()=>new gw(a.resolve("Common.ITaskManager"),()=>{Kc.a.BGa()},Object(H.a)($k.a.instance,$k.a.instance.IRa,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));
a.register(446,"PowerPointWebEditor.IWarningDialog").na().oa(()=>new OO);a.register(447,"PowerPointWebEditor.ICalloutNotificationAdapter").na().oa(()=>new oS.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").xa));a.register(448,"PowerPointWebEditor.IDataUploader").oa(()=>new eP(a.resolve("Common.ITaskManager"),()=>{Kc.a.BGa()},Object(H.a)($k.a.instance,$k.a.instance.IRa,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(449,"PowerPointWebEditor.IPastedDataUploader").na().oa(()=>new KO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(160,"PowerPointWebEditor.IMediaUploader").oa(()=>new AS.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
()=>{Kc.a.BGa()},$k.a.instance.IRa.bind($k.a.instance)));a.register(450,"PowerPointWebEditor.ISystemClipboard").na().oa(()=>new MO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(451,"PowerPointWebEditor.IInternalClipboard").na().oa(()=>new zO(a.resolve("PowerPointWebEditor.IApplicationSettings").Aqg?
a.resolve("Box4.Graph.IGraphInstance").zd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").Aqg?a.resolve("Box4.Graph.IGraphInstance").zd(8):null));a.register(452,"PowerPointWebEditor.ICutCopyManager").na().oa(()=>new xO(a.resolve("PowerPointWebEditor.IDesignModeManager").eDa,[new LO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").eDa,a.ue("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").bYj,a.resolve("PowerPointWebEditor.IApplicationSettings").UYj,a.resolve("PowerPointWebEditor.IApplicationSettings").aYj,
a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),w.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").B$a,a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager")),new os(a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.IDesignModeManager").eDa,a.ue("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").cYj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),w.AFrameworkApplication.userSessionId,
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(453,"PowerPointWebEditor.IPasteManager").na().oa(()=>
new Wg(a.ue("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").eDa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),[new GO(a.resolve("Common.IActionManagerExtended"),a.ue("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").boe,
a.resolve("PowerPointWebEditor.IApplicationSettings").$sg),new HO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").coe),new rS.a(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),
a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").h4j,a.resolve("PowerPointWebEditor.IApplicationSettings").K5j,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),new ey(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new $z(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),w.AFrameworkApplication.dR),new VE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));
a.register(454,"PowerPointWebEditor.ICopyPasteUtility").na().oa(()=>new Qq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));
a.register(455,"PowerPointWebEditor.IPasteHandlerUtil").na().oa(()=>new FO);a.register(456,"PowerPointWebEditor.IClipboardHelper").na().oa(()=>new yE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.tUa().Ck||Sp.a.dTh,a.resolve("Common.IAppSettingsManager").Ha("RedisCacheServiceEnabledDatacenters"),a.resolve("Common.IAppSettingsManager").uc("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));
a.register(457,"PowerPointWebEditor.IClipServiceManager").na().oa(()=>new wO(b.tUa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(458,"Box4.TableEditors.ITableStylePreviewGenerator").na().oa(()=>new Rq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Tz.oSf,c=>new YD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),
c=>new VD(c),a.resolve("PowerPointWebEditor.IApplicationSettings").Jaa));a.register(459,"Box4.TableEditors.ITableStyleRibbonControls").na().oa(()=>new gO(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(460,"Common.App.ImageProcessor.IImageProcessor").na().oa(()=>new JM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));
a.register(461,"PowerPointWebEditor.IPPTFileReaderHelper").na().oa(()=>new gP);a.register(462,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").na().oa(()=>new cA(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));a.register(463,"PowerPointWebEditor.ILocalImageViewFactory").na().oa(()=>new WO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").ycb));a.register(464,
"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").na().oa(()=>new YO);a.register(465,"PPTe.IColorPickerBuilderFactory").na().oa(()=>new bS.a);a.register(466,"PowerPointWebEditor.IFileApiHelper").na().oa(()=>new fP);a.register(467,"PowerPointWebEditor.IInsertImageHelper").na().oa(()=>new vN(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(vE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").na().oa(()=>new vE(a.resolve("Box4.Styles.IStyleEditor"),
a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),Mh.a.instance,a.rb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(468,"PowerPointWebEditor.IFormatPainter").na().oa(()=>
new SO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").zd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(469,"PPTe.IResourceViewElementResolver").na().oa(()=>new vO(b.tUa(),Sc.App.webServiceBase));a.register(470,"PowerPointWebEditor.IOfflineModalCallout").na().oa(()=>new TO(a.resolve("Box4.IAppFrame")));
a.register(471,"PowerPointWebEditor.IPPTOfflineManager").na().oa(()=>new NO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));
a.register(348,"PowerPointWebEditor.IClipboardTelemetry").na().oa(()=>new Bu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").zd(8),a.resolve("Box4.Graph.IGraphInstance").zd(10),a.resolve("Box4.Graph.IGraphInstance").zd(12),a.resolve("Box4.Graph.IGraphInstance").zd(60),a.resolve("Box4.Graph.IGraphInstance").zd(7),
a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(a.register(tP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").na().oa(()=>new tP.a(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineEditor"),
a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.ICharacterPropertiesEditor"))),a.register(sP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").na().oa(()=>new sP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.List.IListEditor"),
a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),a.register(pP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").na().oa(()=>new pP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),
a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"))),a.register(qP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").na().oa(()=>
new qP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),a.register(rP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").na().oa(()=>new rP.a(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),
a.register(uP.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").na().oa(()=>new uP.a(a.Ia("PowerPointWebEditor.AppForOfficeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"))),a.register(oP.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").na().oa(()=>new oP.a(a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),a.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));a.register($E,"PowerPointWebEditor.ICopilotDesignerMetricsEventNotifier").as("PowerPointWebEditor.ICopilotDesignerMetricsEventListener").na().oa(()=>
new $E)}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.hT;var f=b.To;const l=c.rd;var y=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),G=f.Zib;const R=a.resolve("Common.IActionManagerExtended"),ja=a.resolve("PowerPointWebEditor.IFrameContext"),za=a.resolve("PowerPointWebEditor.IFocusManager"),Va=a.resolve("PowerPointWebEditor.IFormatPainter"),hb=a.resolve("PowerPointWebEditor.CoauthManager"),Cb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),
lc=Fb.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),ic=Fb.a.instance.resolve("PowerPointWebEditor.IDialogManager"),yc=Fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),ec=Fb.a.instance.resolve("Box4.ISelectionManager"),jc=Fb.a.instance.Ia("Box4.IExternalSelectionManager"),xd=Fb.a.instance.resolve("PowerPoint.IPathManager");var Xd=Fb.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const Qd=f.Ld,Ie=Fb.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");
b=Fb.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const Pe=Fb.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),ig=Fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),ff=Fb.a.instance.resolve("PowerPointWebEditor.INotesView"),bh=Fb.a.instance.resolve("Box4.IFormatPainter"),ch=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),of=a.resolve("Common.Transaction.ITransactionFactory"),sg=a.resolve("PowerPointWebEditor.IPresentationReader"),Fg=a.resolve("PowerPointWebEditor.IShapeReader"),
og=a.resolve("PowerPointWebEditor.Graph.ITableReader"),pi=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),Wj=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");var wg=a.resolve("PowerPointWebEditor.ITableEditor");const Tg=Fb.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Dh=Fb.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Mm=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Jj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),Nm=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),
so=Fb.a.instance.resolve("Box4.List.IListReader");var an=a.resolve("Box4.Graph.IGraphIteratorFactory");const to=a.resolve("PPTe.IColorPickerBuilderFactory"),hm=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.Cma=Fb.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.HA=Fb.a.instance.resolve("PowerPointWebEditor.IPasteManager");const Vl=Fb.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),um=Fb.a.instance.resolve("PPTe.IResourceViewElementResolver");Fb.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");
Fb.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const Kn=Fb.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),wl=Fb.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),ui=a.resolve("Common.Utils.IHighContrastDetector"),Ln=Fb.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),uo=a.resolve("PowerPointWebEditor.IRibbonUser"),Lp=a.resolve("Box4.CloudFontService"),bn=a.resolve("Box4.CustomFontService");this.zHe=new mj(R,lc,za,ja.LCID,
yc,of,Dh,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sg,new RO(Fb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),Fb.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),Vl,l,um);this.EBe=new ck(Dh,R,za,yc,lc,hm,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Box4.Graph.IGraphInstance").zd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Ie,Tg,wl,a.resolve("PowerPointWebEditor.IApplicationSettings").s1j,
a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),a.Ia("PowerPointWebEditor.IInsertShapeOverlayViewElement"),a.resolve("PowerPointWebEditor.IApplicationSettings").AAb,l.mUj,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),
a.resolve("Box4.Graph.IGraphInstance").zd(10));this.DBe=new eA(Dh,R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),lc,hm,a.resolve("Box4.Graph.IGraphInstance").zd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,Ie,Tg,wl,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));Xd=new aN(R,za,a.resolve("PowerPointWebEditor.IPptSelectionManager"),Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
of,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),Xd,lc,this.Cma,this.HA,a.resolve("PowerPointWebEditor.IDesignModeManager").eDa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),sg,Tg,hm,a.resolve("PowerPointWebEditor.IWarningDialog"),(tj,zg,$d,nf,Pf,Fe,Eh,Aj,Lj)=>new EN(tj,zg,$d,nf,Pf,Fe,Eh,Aj,Lj),wl,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),
a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.ITextPasteFloatieManager"):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?Fb.a.instance.resolve("Box4.IPasteFloatieEventSource"):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("PowerPointWebEditor.IGraphHotColdManager"):
null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.Graph.IGraphInstance").zd(10):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"):null,w.AFrameworkApplication.fa.ka("IsPasteTextFloatieEnabled")?a.resolve("Box4.IUndoManager"):null);const cn=new vi(R,za,of,G,Va,lc,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),
a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),bh,ch,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),ui,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Na),Kj=new DN(R,lc,ja,of,yc,a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));G=new mN(R,of,yc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),ja,a.resolve("PowerPointWebEditor.IApplicationSettings"));y=[new RM(R,l,y,yc,of,lc,l.w3),Xd,new fy(R,l,w.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),
a.resolve("PowerPointWebEditor.IClipServiceManager"),za,lc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),of,Mm,Qd,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),hm,wl,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Kn,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.HA,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new dN(R,Fb.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),ic,a.ue("PowerPointWebEditor.IContextMenuUser"),
Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),za,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),l.pptContextMenuOnSelectionFixIsEnabled,l.Xn),new eN(R,yc,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.Bjh,l.KKb,l.w3,l.ka("PictureBGREnabled")),
new lO(R,l,wv.a.Lyb,an,a.resolve("Box4.IParagraphReader")),new mO(zu.instance),this.EBe,this.DBe,G,new hy(R,lc,za,ja.notesPane,ff,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,Fb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView")),new CN(R,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),
Kj,new KN(R,ja,uo,za,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled")),new NN(R,lc,za,ic,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),Va,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),
l.fD,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.sQ,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.q8a),cn,new SN(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),lc,of,za,Vl,um,yc,Fg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new aw(Dh,R,za,lc,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),Fg,!!Lp&&Lp.isEnabled,!!bn&&bn.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new TN(Dh,R,za,lc,yc,Fg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),
a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),of,l.Cqe,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.zHe,new UN(R,lc,of,Dh,za,yc,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sg,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ICopilotDesignerMetricsEventNotifier")),new VN(R,ic,za,lc,Dh,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sg,Pe,(tj,zg)=>new zS.a(tj,zg),a.resolve("PowerPointWebEditor.IPptSelectionManager"),l.fD,l.Dqe),new YN(R,lc,yc,of,za,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ie,sg,Tg,hm,wl,a.resolve("PowerPointWebEditor.IShapeReader")),new $N(()=>ig,new aO(ec,wv.a.Lyb,a.resolve("Box4.IContextSetEditor")),jc,l),new hO(R,lc,l,za,yc,ig,a.Ia("PowerPointWebEditor.IAppForOfficeManager"),
a.ue("PowerPointWebEditor.IAppforOfficeClassFactory"),hm,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ia("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),
a.Ia("PowerPointWebEditor.IAudioManagerStore")),new iA(R,yc,Jj,za,b,Cb,Fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new uO(R,a.Ia("PowerPointWebEditor.ICommentsPane"),za,a.resolve("Common.IF6Manager"),yc,Jj,lc,xd,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),sg,a.resolve("PowerPointWebEditor.IWindowUtils"),w.AFrameworkApplication.fa,l,b,c.tUa(),Cb,Pe,Fb.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),Fb.a.instance.resolve("Box4.Graph.IGraphInstance").zd(7),
Fb.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),Fb.a.instance.resolve("Common.ITaskManager"),w.AFrameworkApplication.Je,Fb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),Fb.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ia("PowerPointWeb.Comments.ICommentFrame"),a.Ia("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),Ln,Fb.a.instance.Ia("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),
f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"),l.Xn?a.ue("PowerPointWebEditor.ISorterViewActorLazy"):null)];wg=new Fu(R,an,lc,za,so,Fg,og,Wj,pi,Tg,wg,l,of,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yc,wl,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,uo,a.resolve("Box4.Styles.ITableStyleReader"));y.push(new Du(R,yc,za,so,a.resolve("Box4.ILineSpacingHelper"),of,Nm,an,Sc.App.NMa.ZOc(12),Sc.App.NMa.ZOc(10),Fg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),l.Cqe,l.isPromoteDemoteOnParagraphEnabled,
to,l.v3c,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),bh,f,Qd,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Box4.IInsertionPointFormatting"),ch,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").Qkb));y.push(wg);f=new QE(R,za,Fg,Dh,lc,yc,a.resolve("Box4.IInsertionPointFormatting"),
a.resolve("Box4.IParagraphReader"));y.push(f);l.Vdl&&y.push(new IN(R,za,a.resolve("PowerPointWebEditor.IPresentationReader")));l.oWk&&y.push(new bN(R,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.hQb||l.Omb)&&y.push(new ew(R,l,of,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yc,og,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.rdi&&y.push(new PM(yc,w.AFrameworkApplication.fa,l,Object(H.a)(Nz.App.p7a,Nz.App.p7a.h4f,
"forceUpdateRibbonControls")));qd.a("EnhancementOfSDXPaneBootTime")&&y.push(new HS.a(l,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),R,Qd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),of,this.K.ue("PowerPointWebEditor.IClassFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),an,lc,wl));l.ka("CopilotDesignerEnableMetricsTracker")&&(new vP(this.K.resolve("PowerPointWebEditor.ICopilotDesignerMetricsEventListener")),
new wP(this.K.resolve("PowerPointWebEditor.ICopilotDesignerMetricsEventListener")));a.resolve("PowerPointWebEditor.IApplicationSettings").ccb&&l.ka("CopilotChatMasterSwitch")&&!w.AFrameworkApplication.XE&&!w.AFrameworkApplication.Vx&&(an=l.ka("CopilotStartMasterSwitch")&&l.sWa,y.push(this.gQf(l,an)));l.CIh&&y.push(new lP(R));l.W4e&&y.push(new nP(R,this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ia("PowerPointWebEditor.IAppForOfficeManager"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Common.IAppSettingsManager"),a.resolve("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations")));qd.a("DataSyncModeOnStatusBar")&&"inner"===w.AFrameworkApplication.fa.Ha("Microsoft365Ring")&&y.push(new jP(R,l));for(const tj of y)tj.vb(),tj.me();Fb.a.instance.Ia("PowerPointWebEditor.ISorterViewActorMain").execute(tj=>{tj.vb()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").Gsi(new ZO(a.resolve("Common.ITaskManager"),
a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const vh=this;w.AFrameworkApplication.fa.$e(()=>{const tj=as.a(a),zg=[new tO(R,lc,yc,za,ig,l.J2j,hb,Qd.Gf,a.Ia("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],$d=w.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");l.Vla&&$d&&zg.push(new ky(R,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Ln));vh.qed=new LN(R,Dh,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").zd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPresentationReader"),
yc,a.resolve("PowerPointWebEditor.IApplicationSettings").Xn,a.resolve("PowerPointWebEditor.IApplicationSettings").fD);zg.push(vh.qed);zg.push(new PN(R,yc,hm,a.resolve("PowerPointWebEditor.IApplicationSettings").gla));zg.push(new ON(tj,yc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),za,a.resolve("PowerPointWebEditor.View.ISelectionPane"),cn,Kj,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),ja,Fg,a.resolve("Box4.IPageView").Na,a.resolve("Common.Transaction.ITransactionFactory")));zg.push(new gN(tj,yc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,za,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),Fg,l.caj,l.Bvl,l.gla,a.resolve("PowerPointWebEditor.IImageViewManager")));zg.push(new iN(yc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,za,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),as.a(this.K),og,Wj,pi));l.xsg?zg.push(new tN(tj,yc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),za,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),of,l.HRe)):zg.push(new qN(tj,yc,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),za,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),of,l.HRe));zg.push(new cN(tj,R,za,Qd));l.powerPointSmartLookupIsEnabled&&
zg.push(new uN(Dh,R,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),lc));l.lWk&&zg.push(new UM(as.a(this.K),R,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));zg.push(new SM(R,yc,za,of,a.Ia("PowerPointWebEditor.IAudioManagerStore"),l.sQ,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));zg.push(new OM(R,
yc,of,Qd,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),uo,l.Tci,l.oYl,l.$me,l.L3d,l.w3,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));l.rWk&&zg.push(new BN(as.a(this.K),l.pWk,l.qWk,R,lc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
yc,wl));l.pptoCaptionDiscoverabilityPaneEnabled&&zg.push(new Yv(as.a(this.K),R,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.mWk));vh.bFg=new fN(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
of,a.resolve("Box4.Graph.IGraphInstance").zd(82));zg.push(vh.bFg);qd.a("PptJOfcBrowserGraphNode")&&(vh.tNg=new zN(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),of,a.resolve("Box4.Graph.IGraphInstance").zd(83)),zg.push(vh.tNg));for(const nf of zg)nf.vb(),nf.me();Ln.j6b=$d});a.resolve("PowerPointWebEditor.IApplicationSettings").ccb||!l.ka("CopilotChatMasterSwitch")||!l.ka("CopilotChatLicenseCheckEnabled")||w.AFrameworkApplication.XE||w.AFrameworkApplication.Vx||w.AFrameworkApplication.fa.$e(()=>
{a.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(tj=>{tj.isFeatureEnabled("Copilot",!1).then(zg=>{zg&&(zg=l.ka("CopilotStartMasterSwitch")&&l.ka("CopilotStartLicenseCheckEnabled"),this.gQf(l,zg).vb())})})});(new HN(c.kH(),c.Obe(),b,Jj,yc,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).vb();w.AFrameworkApplication.Aa&&w.AFrameworkApplication.Aa.mb.lre&&YR()}dispose(){this.Cma.dispose();
this.HA.dispose();this.zHe.dispose();this.EBe.dispose();this.DBe.dispose();this.qed&&this.qed.dispose();const a=this.K.Ia("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}gQf(a,b){var c=null;Object(qd.a)("EnableFeedbackInChatPPTMode")&&(c=this.K.resolve("Common.App.ICustomerFeedbackUiWrapper"),c=new kP(c));let f=!1;Object(qd.a)("NewSettingsForChatPPT")&&(f=a.d7j);return new iP(this.K.resolve("Common.IActionManagerExtended"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),c,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ICopilotProxy"),a.Xn?this.K.ue("PowerPointWebEditor.ISorterViewActorLazy"):null,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b?this.K.resolve("PowerPointWebEditor.IStorytellerEventListener"):null,
Object(qd.a)("CreatePresentationEnabledState")?this.K.resolve("PowerPointWebEditor.ICreatePresentationEnabledState"):void 0,b)}}Object(m.a)(xP,"ActorPackage",null,[2,3]);class yP{constructor(a,b,c,f,l,y,G,R,ja,za){this.OH=!1;this.Ub=a;this.ua=b;this.Rf=c;this.NB=f;this.Sb=l;this.Qv=y;this.wb=G;this.uwa=R;this.U0g=ja;this.Mc=za;this.YFe=[0,1,2,3];this.Q5=new Qe.a;for(const Va of this.YFe)this.Q5.$(Va,[]);this.Q5.$(4,[]);this.Rf.LI(Object(H.a)(this,this.aC,"onActiveSlideChanged"));this.uwa.gk(Object(H.a)(this,
this.ekd,"onMainMastersLoaded"));this.U0g.kja(Object(H.a)(this,this.JOe,"onSlideLoaded"));this.U0g.gk(Object(H.a)(this,this.woa,"onSlidePropertyChanged"));this.Mc.GC(Object(H.a)(this,this.TM,"onSessionClosed"));this.Mc.C7a(Object(H.a)(this,this.lga,"onSessionRehydrating"));this.Mc.qB(Object(H.a)(this,this.Hn,"onSessionRehydrated"));this.rYg=new Ux(Object(H.a)(this,this.LWk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.wb,3);this.qYg=new Ux(Object(H.a)(this,this.KWk,"prefetchSlideMasterImage"),
250,6E4,8E3,500,"slide master image",this.wb,3);this.aC(null,null)}aC(){this.G6d()}G6d(){const a=this.ua.Ba;a&&8===a.type&&a.Ta(va.a.mj)&&a.Ta(va.a.Qn)&&this.kPl(a.mj,a.Qn)}LWk(){if(!this.OH){var a=this.Q5.ga(0),b=this.Q5.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.x7j(f.first,f.second)&&(Array.removeAt(a,c),Array.add(b,f),this.rYg.ixd(),this.Qv.JWk(f.first,f.second))}}}KWk(){if(!this.OH){this.iyd(1,2,c=>!!this.Sb.q$a(c.first,c.second));var a=this.Q5.ga(2);if(0<a.length){const c=a[0];var b=
this.Sb.q$a(c.first,c.second);b&&this.d3e(b)?(b=b.iAb(new sr.a(b.Xp,b.Xk)),this.qYg.ixd(),Array.removeAt(a,0),Array.add(this.Q5.ga(3),c),this.NB.rxb(b,!0,()=>{this.iyd(3,4,f=>!this.d3e(this.Sb.q$a(f.first,f.second)));this.qYg.exd()})):(Array.removeAt(a,0),Array.add(this.Q5.ga(4),c))}this.iyd(3,4,c=>!this.d3e(this.Sb.q$a(c.first,c.second)))}}xMf(){for(const a of this.YFe)Array.clear(this.Q5.ga(a));Array.clear(this.Q5.ga(4))}JOe(a,b){(a=Object(sa.a)(116,b.node))&&a.rE&&this.enc(a)}woa(a,b){a=b.property;
b.node&&a===va.a.Qn&&b.node===this.ua.Ba&&this.G6d()}enc(a){if(this.u7j(a)&&a){const b=a.mj,c=a.Qn;b&&c&&(this.iyd(1,2,f=>f.first===b&&f.second===c),this.rYg.exd())}}ekd(a,b){a=b.property;if(a===va.a.eIb||a===va.a.XY)this.xMf(),this.G6d()}TM(){this.OH=!0}lga(){this.xMf()}Hn(){this.OH=!1}kPl(a,b){this.v7j(a,b)||this.w7j(a,b)||Array.add(this.Q5.ga(0),new lx.a(a,b))}w7j(a,b){for(const c of this.YFe)for(const f of this.Q5.ga(c))if(f.first===a&&f.second===b)return!0;return!1}v7j(a,b){for(const c of this.Q5.ga(4))if(c.first===
a&&c.second===b)return!0;return!1}iyd(a,b,c){a=this.Q5.ga(a);b=this.Q5.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}d3e(a){if(!a)return!1;a=a.iAb(new sr.a(a.Xp,a.Xk));if(null===a)return!1;for(const b of a)if(!this.NB.W$b.usc(b).data)return!0;return!1}u7j(a){const b=this.Ub.Gf.sa(va.a.$Fh,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}x7j(a,b){var c=this.Sb.bJ();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===
a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(m.a)(yP,"SlideMasterPrefetchManager",null,[215]);var KS=d(997);class zP{constructor(a,b,c,f,l,y,G){this.Ab=!1;this.QX=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");if(!y)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.wb=y;this.Rr=a;this.Rb=b;this.vu=c;this.Yv=f;this.od=l;this.qJg=
G;this.atk=new pd.a(0,1,0,Object(H.a)(this,this.hdl,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Ab}QBl(){if(!this.Ab&&this.Rr&&this.Rr.xa){this.QX=this.uui();this.qJg||this.Rr.xa.appendChild(this.QX);this.Rr.setVisibility(!0);this.qJg&&this.od.TAf(Object(H.a)(this,this.njd,"onCommentContainersChanged"));var a=new KS.a(!0);this.Yv.ymh(a);this.Rb.SIb(1);this.Ab=!0}}njd(){this.Rb.TJc(Object(H.a)(this,this.fsh,"renderCommentShimmerOnSlideResize"));this.od.vbl(Object(H.a)(this,
this.njd,"onCommentContainersChanged"))}fsh(){this.wb.Hb(this.atk);this.Rb.kqd(Object(H.a)(this,this.fsh,"renderCommentShimmerOnSlideResize"))}hdl(){!this.QX||this.y0f()?ya.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.Rr.xa.appendChild(this.QX)}Rjg(){if(this.Ab&&this.Rr&&this.Rr.xa&&this.y0f()){this.Rr.xa.removeChild(this.QX);this.QX=null;this.Ab=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();ya.a.J(523352018,809,50,ta.a.toJSON(a))}}$5i(){this.Ab&&
this.Rr&&this.Rr.xa&&(this.QX.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(H.a)(this,this.Rjg,"hideShimmerUX"),600))}uui(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.vui());return a}vui(){const a=document.createElement("div");a.className=this.vu?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";
const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const y=document.createElement("div");y.className="CommentShimmerActionStyles";a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(y);return a}y0f(){return!!document.getElementById("CommentShimmerContainer")}}Object(m.a)(zP,"CommentShimmerView",
null,[216]);class aF{constructor(a,b){this.Rb=a;this.qxa=b;this.qxa.xBf(Object(H.a)(this,this.Lwh,"scaleOnUIChanged"))}dispose(){this.qxa.Jrh(Object(H.a)(this,this.Lwh,"scaleOnUIChanged"))}m6(){}l6(a){2===a.behavior&&(a=a.actionId,a!==ea.a.M1&&a!==ea.a.L1&&a!==ea.a.K1&&a!==ea.a.zoa||this.updateCommandUI())}Lwh(){this.updateCommandUI()}updateCommandUI(){this.Rb.updateCommandUI()}}Object(m.a)(aF,"UpdateCommandUIActionListener",null,[144,108]);class bF{constructor(){this.correlationId=this.sessionId=
this.LNd=null;this.actionId=0;this.vd=null}get Ef(){return this.LNd?this.LNd:""}set Ef(a){this.LNd=a}}Object(m.a)(bF,"AssistanceSearchVariableUrlParameterSet",null,[]);class yr{constructor(){this.ZP=!1;this.YP=!0;this.guf=this.GSb=null}get isInitialized(){return this.ZP}initialize(a,b){const c=!!a&&!!b;c&&(this.GSb=a,this.guf=b);this.ZP=c;w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>{f.l4("Enabled").then(l=>{this.YP=l;return null},()=>null)})}vb(a){a||(a=w.AFrameworkApplication.Qa);w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.YP=w.AFrameworkApplication.iF,Fb.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",
!0).then(c=>{this.YP=w.AFrameworkApplication.iF&&c;(c=w.AFrameworkApplication.Aa)&&c.updateCommandUI();return null},()=>null)}));a.ya(F.a.lNb,ye.a.frame,Object(H.a)(this,this.NBl,"showSearchResults"))}NBl(a,b,c,f,l){if(1===c)return w.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.YP=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.YP)?8:
tz.SessionStatusManager.instance.jla?8:32;ha.ULS.sendTraceTag(4761738,1302,50,"");kf.a.mark(4771);if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new bF,{actionId:F.a.lNb,vd:l});if(void 0!==a&&null!==a)l=yr.Ozj(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=F.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=
F.a.G0d;break;case "btnShowTraining":case "Training":l.actionId=F.a.XLh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=F.a.pTh}this.GSb.Wzl(this.guf,l);kf.a.mark(4772);return 32}kf.a.mark(4772);return 8}dispose(){this.GSb&&(this.GSb.dispose(),this.GSb=null)}static get instance(){yr.La||(yr.La=new yr);return yr.La}static Ozj(a){const b=new bF,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.Ef=a.substr(f+1);return b}}yr.La=null;Object(m.a)(yr,
"AssistanceActor",null,[108]);class cF{constructor(){this.tdf=this.Ma=this.zob=null;this.OMd=!1}Wzl(a,b){if(b.actionId!==F.a.giveFeedback||w.AFrameworkApplication.iF)if(this.OMd&&!w.AFrameworkApplication.cta)this.zob||(this.zob=this.tdf()),this.zob.kl(a,b);else if(b.actionId===F.a.giveFeedback)this.Hzl();else{a=a.GYc(b);b=null;try{na.a.I9(a)&&(b=Cd.a.In(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw ha.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?ha.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):ha.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else ha.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.zob&&(this.zob.dispose(),this.zob=null)}EBh(a,b,c){c&&Ck.b(a)?this.OMd=!1:(this.tdf=a,this.OMd=c);this.Ma=b}Hzl(){w.AFrameworkApplication.Qa.processAction(F.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new cF;null==c?f.EBh(a,b,w.AFrameworkApplication.kFf||b.ka("HelpTabIsEnabled")):f.EBh(a,b,c);return f}}Object(m.a)(cF,"AssistanceDisplayManager",null,[346,108]);
class iw{constructor(a,b,c,f,l){this.SG=a;this.G5h=b;this.cEc=c;this.TWh=f;this.qof=l}get lcid(){return this.SG}get namespace(){return this.G5h}get xJa(){return this.cEc}get Gpi(){return this.TWh}get locale(){return this.qof}static vzj(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:iw.Gqi}static createInstance(a){return new iw(w.AFrameworkApplication.lcid,a,iw.vzj(w.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
ab.a.He(w.AFrameworkApplication.lcid).name)}}iw.Gqi=16;Object(m.a)(iw,"AssistanceSearchUrlParameterSet",null,[]);class dF{constructor(a,b){a=new qj.QueryStringBuilder(a);a.xg("clid",b.lcid.toString());a.xg("p1",b.namespace);a.xg("ver",b.xJa.toString());a.xg("apps",b.Gpi);a.xg("lc",b.locale);this._url=a.toString()}GYc(a){const b=new qj.QueryStringBuilder(this._url);b.xg("src","TellMe");b.xg("query",a.Ef);b.xg("sessionid",a.sessionId);b.xg("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new dF(w.AFrameworkApplication.lFf,
a)}}Object(m.a)(dF,"AssistanceSearchUrlProvider",null,[337]);class eF{Xb(){}init(){w.AFrameworkApplication.Ktb&&!w.AFrameworkApplication.YPb&&yr.instance.vb(w.AFrameworkApplication.Qa)}dispose(){yr.instance.dispose()}Olg(a){yr.instance.initialize(cF.createInstance(a,w.AFrameworkApplication.fa),dF.createInstance(iw.createInstance("PPWAEndUser")))}}Object(m.a)(eF,"AssistancePackage",null,[2,3]);var LS=d(1049);class AP{constructor(a,b,c,f,l,y){this.ia=a;this.Oc=b;this.Efc=c;this.Ujk=f;this.rAe=l;this.c$=
y}kl(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case F.a.G0d:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case F.a.giveFeedback:a.feedback=this.GJi(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case F.a.XLh:a.query="showtraining";c=ResourceStrings.L_Training;break;case F.a.pTh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.Ef,c=ResourceStrings.L_Help}const f={};f.cB=c;f.assetId="FA000000012";this.c$.X2c&&b.actionId===F.a.giveFeedback&&
(f.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");f.nonPersistedSettings=a;f.Uaf=!1;b.actionId==F.a.G0d&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.Ja(ea.a.Sga,2,f)}}Kq(){const a=this.Myb();a&&this.ia&&this.ia.Ja(ea.a.hvb,2,a)}dispose(){}Myb(){if(this.Oc.instance){const a=this.Oc.instance.HQ("FA000000012");if(a)return a.instanceId}return null}GJi(a){this.c$.X2c||(this.rAe?this.rAe.kWb?this.CKf():this.Ujk.G5d(Object(H.a)(this,this.u6i,"feedbackDownloaded")):ya.a.J(512324302,
1302,15,"feedbackFormManager is undefined"));a=a.vd?a.vd:{};w.AFrameworkApplication.fa.nJc(a);a=this.Efc.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}CKf(){if(LS.a.k9g())ya.a.J(512324300,
1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(H.a)(this,this.Xih,"postScreenshotData"));return}catch(a){ya.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(H.a)(this,this.Xih,"postScreenshotData"))}catch(a){ya.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}u6i(a){a&&
(this.rAe.Uvg(a),this.CKf())}Xih(a){a=a.toDataURL("image/jpeg");const b=this.Myb(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(m.a)(AP,"AgaveAssistancePane",null,[300,108]);class BP extends eF{constructor(){super();this.odf=this.$hf=this.Kff=this.Lff=this.Ea=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Xb(a){this.Ea=a}load(){this.init()}init(){super.init();!w.AFrameworkApplication.Ktb&&w.AFrameworkApplication.YPb?
ya.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(ya.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),w.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(this.Lff=this.Ea.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.Kff=this.Ea.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.$hf=this.Ea.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
this.odf=this.Ea.resolve("PowerPointWebEditor.IApplicationSettings"),this.Olg(()=>new AP(this.Ea.resolve("Common.IActionManagerExtended"),this.Ea.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.Lff,this.Kff,this.$hf,this.odf))):this.Olg(null))}}Object(m.a)(BP,"PowerPointAssistancePackage",eF,[274]);class fF{N8i(a,b,c){return a?this.N7i(b,c):this.O8i(b,c)}m2f(a,b,c){return a?this.p8i(b,c):this.h8i(b,c)}f8i(a){var b=a.Cf?a.og.jf:a.og.Ua;const c=new ub.GraphIterator;a.uq?c.Tc(a.uq):c.set(b.node);
c.rc(14);a=new ub.GraphIterator;a.Tc(c);a.rc(14);b=Oc.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Oc.isLastCellInRow(a)){do if((f=ae.moveToNextColumn(a))&&Oc.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Oc.isLastCellInRow(a))}if(!l&&!Oc.isLastCellInColumn(c)){do if((f=ae.moveToNextRow(c))&&Oc.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Oc.isLastCellInColumn(c))}return l?f:null}n8i(a){var b=a.Cf?a.og.jf:a.og.Ua;const c=new ub.GraphIterator;a.uq?c.Tc(a.uq):
c.set(b.node);c.rc(14);a=new ub.GraphIterator;a.Tc(c);a.rc(14);b=Oc.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Oc.isFirstCellInRow(a)){do if((f=ae.moveToPreviousColumn(a))&&Oc.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Oc.isFirstCellInRow(a))}if(!l&&!Oc.isFirstCellInColumn(c)){do if((f=ae.moveToPreviousRow(c))&&Oc.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Oc.isFirstCellInColumn(c))}return l?f:null}ITc(a,b){var c=a.Cf?a.og.jf:a.og.Ua;const f=new ub.GraphIterator;
a.uq?f.Tc(a.uq):f.set(c.node);f.rc(14);a=Oc.findControllingCellFromNode(c.node);c=null;if(b){do{if(Oc.isFirstCellInColumn(f))break;c=ae.moveToPreviousRow(f)}while(c&&Oc.findControllingCellFromNode(c)===a)}else{do{if(Oc.isLastCellInColumn(f))break;c=ae.moveToNextRow(f)}while(c&&Oc.findControllingCellFromNode(c)===a)}return c}l2f(a,b){if(!Dk.l(a))return null;a=ub.GraphIterator.pb(a.currentNode);a.rc(14);let c;const f=Hd.TableReader.yt(a.origin);do c=b?ae.moveToPreviousRow(a):ae.moveToNextRow(a);while(f&&
c&&Dk.h(a));return c}e_a(a,b,c,f,l){let y=null;rc.OutlineElementNavigator.Se(a);const G=he.OutlineElementReader.isRtl(a.currentNode);if(c)if(ae.returnToCell(a),b=Oc.isLastCellInRow(a),c=Oc.isFirstCellInRow(a),l||!G&&c||G&&f&&b)ae.returnToContainingRow(a),(f=this.l2f(a,!0))?y=Vd.SelectionFactory.Ej(f,!b):l&&(rc.OutlineElementNavigator.Se(a),l=new Nn.a,l.Tc(a),(a=rc.OutlineElementNavigator.xxa(l,!1,!1))&&(y=Vd.SelectionFactory.Ej(a,!1)));else{do G?ae.moveToNextColumn(a):ae.moveToPreviousColumn(a);while(Oc.isGhostCell(a)&&
!Oc.isFirstCellInColumn(a));Oc.isGhostCell(a)||(y=Vd.SelectionFactory.Ej(a.currentNode,!G))}else he.OutlineElementReader.eD(a,b,G)||Jb.SelectionEditor.Xg(b)||ae.returnToCell(a),y=Vd.SelectionFactory.Ej(a.currentNode,!G);return y}d_a(a,b,c,f,l){let y=null;rc.OutlineElementNavigator.Se(a);const G=he.OutlineElementReader.isRtl(a.currentNode);if(c)if(ae.returnToCell(a),c=Oc.isLastCellInRow(a),b=Oc.isFirstCellInRow(a),l||!G&&f&&c||G&&!f&&b)ae.returnToContainingRow(a),(f=this.l2f(a,!1))?y=Vd.SelectionFactory.Ej(f,
b):(rc.OutlineElementNavigator.Se(a),f=new Nn.a,f.Tc(a),(a=rc.OutlineElementNavigator.cK(f,!1,!1))&&(y=Vd.SelectionFactory.Ej(a,!0)));else{do G?ae.moveToPreviousColumn(a):ae.moveToNextColumn(a);while(Oc.isGhostCell(a)&&!Oc.isLastCellInRow(a));Oc.isGhostCell(a)||(y=Vd.SelectionFactory.Ej(a.currentNode,G))}else he.OutlineElementReader.eD(a,b,!G)||Jb.SelectionEditor.Xg(b)||ae.returnToCell(a),y=Vd.SelectionFactory.Ej(a.currentNode,G);return y}}Object(m.a)(fF,"ATableCellSelectionStrategy",null,[341]);
class gF extends fF{constructor(){super()}h8i(a,b){var c=a.nb;let f=null;if(a.Sl){let l=null;if(b){if(c.uq=a.qka,a=Object(sa.a)(im.TableCellNode,this.f8i(c)))a.isGhostCell&&(l=a,a=a.rz()),f=c.cH.isValid&&c.cH.node&&a===c.cH.node?Vd.SelectionFactory.Ej(c.cH.node,!c.Cf):Vd.SelectionFactory.Qu(mr.TableNodeContext.create(Object(sa.a)(Ig.a,a)),c.Cf)}else if(c=a.ga(Math.max(0,Math.min(a.bka,a.Jza))),c=Object(sa.a)(im.TableCellNode,c.og.jf.node),c.isControllingCell&&(c=c.$be(2)),a=c.U_(),b=c.FVc().EJa,!a&&
b&&(c=b.N2f),a=c)a.isGhostCell&&(l=a,a=a.rz()),f=Jb.SelectionEditor.im(Vd.SelectionFactory.rl(Object(sa.a)(Ig.a,a)),!0,!1);f&&l&&(f.uq=ub.GraphIterator.pb(l))}return f}p8i(a,b){let c=a.nb,f=null;a.Sl&&(b?(c.uq=a.qka,a=Object(sa.a)(im.TableCellNode,this.n8i(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.rz()),(f=c.cH&&c.cH.isValid&&a===Object(sa.a)(130,c.cH.node)?Vd.SelectionFactory.Ej(c.cH.node,!c.Cf):Vd.SelectionFactory.Qu(mr.TableNodeContext.create(Object(sa.a)(Ig.a,a)),c.Cf))&&b&&(f.uq=ub.GraphIterator.pb(Object(sa.a)(Ig.a,
b))))):(a.bka>a.Jza?(c=a.Y6,c.uq=c.Cf?a.h2a:null):c.uq=c.Cf?null:a.qka,f=Jb.SelectionEditor.im(Vd.SelectionFactory.rl(c.og.Ua.node),!0,!1),f.uq=c.uq));return f}O8i(a,b){let c=a.nb;var f=null;if(a.Sl){const l=a.bka>a.Jza;let y=null;if(b){if(c.uq=a.qka,a=Object(sa.a)(im.TableCellNode,this.ITc(c,!0)))a.isGhostCell&&(y=a,a=a.rz()),f=l&&c.cH&&c.cH.isValid&&a===c.cH.node?Vd.SelectionFactory.Ej(c.cH.node,!c.Cf):Vd.SelectionFactory.Qu(mr.TableNodeContext.create(Object(sa.a)(Ig.a,a)),c.Cf)}else l?(c=a.Y6,
c.Cf&&(c=c.wxb(),c.uq=a.h2a)):c.Cf?c=c.wxb():c.uq=a.qka,f=Object(sa.a)(im.TableCellNode,this.ITc(c,!0)),f?f.isGhostCell&&(y=f,f=f.rz()):(f=Object(sa.a)(im.TableCellNode,c.og.Ua.node),y=c.uq?Object(sa.a)(im.TableCellNode,c.uq.currentNode):null),f=Vd.SelectionFactory.Ej(Object(sa.a)(Ig.a,f),!0);f&&y&&(f.uq=ub.GraphIterator.pb(Object(sa.a)(Ig.a,y)))}return f}N7i(a,b){let c=a.nb;var f=null;if(a.Sl){const l=a.bka<a.Jza;let y=null;if(b){if(c.uq=a.qka,a=Object(sa.a)(im.TableCellNode,this.ITc(c,!1)))a.isGhostCell&&
(y=a,a=a.rz()),f=l&&c.cH&&c.cH.isValid&&a===Object(sa.a)(130,c.cH.node)?Vd.SelectionFactory.Ej(c.cH.node,!c.Cf):Vd.SelectionFactory.Qu(mr.TableNodeContext.create(Object(sa.a)(Ig.a,a)),c.Cf)}else l?(c=a.Y6,c.Cf&&(c=c.wxb(),c.uq=a.h2a)):c.Cf?c=c.wxb():c.uq=a.qka,f=Object(sa.a)(im.TableCellNode,this.ITc(c,!1)),f?f&&f.isGhostCell&&(y=f,f=f.rz()):(f=Object(sa.a)(im.TableCellNode,c.og.Ua.node),y=c.uq?Object(sa.a)(im.TableCellNode,c.uq.currentNode):null),f=Vd.SelectionFactory.Ej(Object(sa.a)(Ig.a,f),!0);
f&&y&&(f.uq=ub.GraphIterator.pb(Object(sa.a)(Ig.a,y)))}return f}}Object(m.a)(gF,"TableCellSelectionStrategy",fF,[]);class CP extends ez{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){super(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,ec,jc);this.u9h=l;this.k2h=c;this.Mzc=yc}o3b(a,b){var c=Object(sa.a)(sp,b);c&&c.e0a&&this.aCi(this.k2h.Y7e)&&(c=c.e0a.sa(sm.a.Wb,""),this.Mzc.Ilc(c),this.Mzc.jC(6,c));return super.o3b(a,b)}aCi(a){const b=new vC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;
a=ub.GraphIterator.pb(a);let c=a.Ri();for(;c;)b.enqueue(c),c=a.xp()}return!1}nQc(a,b){var c=Object(sa.a)(sp,b);if(c&&c.e0a){c=c.e0a.sa(sm.a.Wb,"");const f=Object(sa.a)(5,this.u9h.Pa.nb.jf.node);f&&(f.Wb=c)}return super.nQc(a,b)}}Object(m.a)(CP,"PPTClipboardOperationCutCopy",ez,[]);class DP{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc,ec,jc){this.Ca=a;this.qd=b;this.us=c;this.jW=y;this.Uc=l;this.Mi=f;this.Er=G;this.rf=R;this.zia=ja;this.VK=za;this.Aia=Va;this.nrb=hb;this.r6a=Cb;this.Ma=lc;this.lk=
ic;this.Mzc=yc;this.ud=ec;this.jd=jc}create(){return new CP(this.Ca,this.qd,this.us,this.Mi,this.Uc,this.jW,this.Er,this.rf,this.zia,this.VK,this.Aia,this.nrb,this.r6a,this.Ma,this.lk,this.Mzc,this.ud,this.jd)}}Object(m.a)(DP,"Factory",null,[272]);class EP{constructor(){}get Bmd(){return!1}Ytb(){}get J5g(){return!1}set J5g(a){}get ozk(){return!1}qoa(){}y_a(){}get V8g(){return-1}get CQc(){return null}}Object(m.a)(EP,"NoImageSteward",null,[336]);class hF{constructor(a){this.Khc=a}create(a,b){return this.Khc||
1!==a?new EP(b):null}}Object(m.a)(hF,"PPTImageStewardFactory",null,[303]);class Sq extends hs{constructor(a,b,c,f,l,y,G){super(a,b,c);this.ia=f;this.Mx=l;this.Dc=G;this.Snk=y.HRk;this.gYa=y.coe;this.rnk=y.boe;this.Khc=y.GBb;this.Tnk=y.M4j}Dpe(a,b,c){const f=Sq.H6f(c);a=(!M.a.instance.ga(82)||this.Q3j(a,b,f))&&super.Dpe(a,b,c);3===c.aSa?this.Dc.Yw(2,f):2===c.aSa&&this.Dc.Yw(3,f);a&&(this.Dc.Ilc(f),this.BPh(b,f));return a}L2e(a,b,c){const f=Sq.H6f(c);a.setAttribute(Bu.a.LKf,f);let l=!1;const y=Sq.O3j(a);
if(y)ya.a.J(17310354,826,50,null),l=!0;else if(this.Tnk&&1===a.getElementsByTagName("Table").length&&!b.iterator.rc(60))this.Dc.jC(6,f),l=!0;else{const G=xb.b(a);G&&G.length||!Sq.Z7b(a)||(ya.a.J(17310356,826,50,null),l=!0)}l&&!Sq.Uvh&&(w.AFrameworkApplication.iM("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Sq.Uvh=!0);if(!this.Snk)return!0;l&&(this.Khc&&this.Jsg(c)?ya.a.J(36779848,826,50,"Paste text only action."):(ya.a.J(17310358,826,50,null),this.U3i(a.cloneNode(!0),
y)));if(a=!l&&super.L2e(a,b,c))this.Dc.Ilc(f),this.Dc.jC(1,f),this.BPh(b,f);return a}U3i(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.gYa||this.rnk)&&this.Mx.WEi(a.firstChild,a));Kc.a.gba(()=>{this.ia.Ja(ea.a.bhh,2,a)},100)}Q3j(a,b,c){if(w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Sq.cyj(a);if(1!==a.count)return!1;this.Dc.jC(6,c);a=a.ga(0);return!w.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&
this.EKj(a)?!1:Sq.i4j(b)}c=Object(sa.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.GL())?c.getContainingTable():null);return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.Rk&&b.node.Ta(va.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.Op()}EKj(a){a=a.getElementsByTagName("Table");if(1===a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");
if(!f||!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}BPh(a,b){if(Object(sa.a)(5,a.node)&&a.iterator)if(a.iterator.rc(10)){if(a=Object(sa.a)(4,a.iterator.jx(10)))a.Wb=b}else a.iterator.rc(60)&&(a=Object(sa.a)(302,a.iterator.jx(60)))&&(a.Wb=b)}static cyj(a){a=a.getElementsByTagName("Table");if(1===a.length){var b;return b=new Oa.a,b.add(a[0]),b}b=new Oa.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=
a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static i4j(a){return a.Rk&&a.node.Ta(va.a.cellId)&&a.iterator.rc(14)?!0:!1}static Z7b(a){a=a.getElementsByTagName(k.a.z4);if(!a.length)return null;a=a[0];return a.src?a:null}static O3j(a){return!!a.firstChild&&!!a.firstChild.className&&uS.a.Png(a.firstChild.className)}static H6f(a){let b="";a&&a.e0a&&(b=a.e0a.sa(sm.a.Wb,""));return b}}Sq.Uvh=!1;Object(m.a)(Sq,"PPTPasteCoordinator",hs,[]);class FP{constructor(){}Ytb(){}get uda(){return!1}NY(){}KY(){}MY(){}LY(){}JY(){}IY(){}}
Object(m.a)(FP,"TextOnlyTableSteward",null,[332,333]);class iF{constructor(a){this.Khc=a}create(a,b){return this.Khc||1!==a?new FP(b):null}}Object(m.a)(iF,"PPTTableStewardFactory",null,[301]);class jF{constructor(a,b,c){this.Llk=a;this.Mok=b;this.la=c}hWe(){this.Llk.execute(a=>{this.la.pqe&&a.tWe(this.Mok.value)})}}Object(m.a)(jF,"AccessibilityActor",null,[]);class Iu{get key(){return"LIST"}get E8(){return Box4Intl.Box4Strings.l_ListContentTitle}x9e(a){let b;b=null;const c=Iu.Vf.Hv(a);if(!c)return{returnValue:!1,
yvb:b};a=this.Gnj(a,c);b=Object.assign(new az,{N1:this.key,contentId:a.listId,vQ:a});return{returnValue:!0,yvb:b}}JVc(a,b){a=a.vQ;const c=this.Lmj(a.mU),f=new Ji.a;b?(b=b.vQ,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c)):b.id.equals(a.id)&&b.mU.listType===a.mU.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));
return f.toArray().join(" ")}Lmj(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.AX);else if(1===a.listType)switch(c){case 1:b=this.PHf;break;case 2:b=this.jwi;break;case 3:b=this.kwi;break;default:b=this.PHf}return b}static get Vf(){return Iu.fh||(Iu.fh=Fb.a.instance.resolve("Box4.List.IListReader"))}}Iu.fh=null;Object(m.a)(Iu,"ListDetailsProvider",null,[327,328]);class GP{constructor(){this.mU=this.listId=this.id=null;this.level=
0}}Object(m.a)(GP,"ListItemInfo",null,[]);class kF extends Iu{constructor(a){super();this.KH=a}get PHf(){return ResourceStrings.l_BulletStyle1}get jwi(){return ResourceStrings.l_BulletStyle1}get kwi(){return ResourceStrings.l_BulletStyle1}Gnj(a,b){const c=this.KH.Wda(a),f=this.KH.Enj(a);return Object.assign(new GP,{id:a.currentNode.id,listId:new ia.a(oh.a.nil,f),mU:b,level:c+1})}}Object(m.a)(kF,"ListDetailsProvider",Iu,[]);class HP{constructor(){this.BH=this.K=null}dispose(){}Xb(a){this.K=a;this.BH=
this.K.resolve("Common.AFrameworkApplication");a.register(hF,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").na().oa(()=>new hF(a.resolve("PowerPointWebEditor.IApplicationSettings").GBb));a.register(iF,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").na().oa(()=>new iF(a.resolve("PowerPointWebEditor.IApplicationSettings").GBb));a.register(hs,"Box4.Actors.PasteCoordinator").na().oa(()=>new Sq(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(272,"Box4.Actors.IClipboardOperationCutCopyFactory").na().oa(()=>new DP(w.AFrameworkApplication.Qa,cc.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
ze.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),hi.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),wc.a.instance,a.resolve("Box4.IEditingDomManager")));
a.register(kF,"PowerPointWebEditor.ListDetailsProvider").oa(()=>new kF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(jF,"PowerPointWebEditor.AccessibilityActor").na().oa(()=>new jF(a.Ia("Box4.Accessibility.IAccessibilityContextManager"),a.ue("PowerPointWebEditor.ListDetailsProvider"),this.BH.hT.rd));a.register(gF,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").na().oa(()=>new gF)}init(){const a=Sc.App.eE.rT;cy.HRj(this.BH.To,this.K.resolve("Common.IReactContextualUILauncher"),
a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));this.K.resolve("PowerPointWebEditor.AccessibilityActor").hWe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(m.a)(HP,"Box4DelayedLoadedPackage",null,[2,3]);class IP{constructor(a,b,c,f,l,y,G,R){this.leb=this.Lva=null;this.C6c=0;this.y6c=new Qe.a(0);this.Deb=this.Kxe=this.bgc=null;this.z6c=!1;this.UEg=[pa.a.contextMenu,pa.a.Zza,pa.a.lN,pa.a.mouseDown,pa.a.pointerDown,pa.a.sRa,pa.a.bib,pa.a.paste];this.x3g=[pa.a.Df,
pa.a.Tl,pa.a.Ay,pa.a.click,pa.a.doubleClick,pa.a.aS,pa.a.RXd,pa.a.bK,pa.a.Whd];this.DJ=a;this.Gue=c||[];this.hik=f||[];this.lwe=l||[];this.y0g=y;this.Mc=b;this.Mc.Shi(Object(H.a)(this,this.$9g,"onAppClosing"));this.Mc.GC(Object(H.a)(this,this.UE,"onSessionEnd"));this.Mcd=G;R&&(Md.EventHandlerManager.instance.oWe(this.UEg,Object(H.a)(this,this.hFk,"onBeforeEventActionContextCreated")),Md.EventHandlerManager.instance.qph(this.UEg,Object(H.a)(this,this.vEk,"onAfterEventActionContextCreated")),Md.EventHandlerManager.instance.oWe(this.x3g,
Object(H.a)(this,this.iFk,"onBeforeEventTriggered")),Md.EventHandlerManager.instance.qph(this.x3g,Object(H.a)(this,this.wEk,"onAfterEventTriggered")));this.GCe=!1}m6(a){if(2===a.behavior){var b=a.actionId;if(this.Dpa(b)){var c=this.getCommandName(b);ya.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.tkg(a,c,"",!1)+"; Current Event: "+(this.Deb||"")+"; Current ActionContext: "+(Kc.a.Kb?Kc.a.Kb.toString():""));if(!this.C6c)if(this.z6c=!0,this.xwl(a)){this.Lva=Kc.a.Nyd(c);this.GCe=
!0;a=a.telemetryData;c=this.bgc;let f=this.Kxe;null===c&&a&&a[Ii.a.lEa]&&(c=a[Ii.a.lEa],f=Kc.a.ynb(c));null!==f&&(this.Lva.Wa(Ii.a.o7a,f.toFixed(2)),null!==c&&this.Lva.Wa(Ii.a.lEa,c.toFixed(2)));a&&ta.a.forEach(a,(l,y)=>{this.Lva.dAa(l,(null===y||void 0===y?void 0:y.toString())||"")},null);c=!1;Array.contains(Fm.xll,b)?c=!0:this.Lva.$p=!0;c=c||this.Qj(b,a);this.Lva.Qj=c}else this.Lva=Kc.a.Kb}this.C6c++}}l6(a){if(2===a.behavior){var b=a.actionId;if(this.Dpa(b)){var c=Kc.a.Kb;const f=c?c.vK(Ii.a.jyf).toString():
"";ya.a.J(18956762,817,50,"ActionContextListener::OnAfterAction "+this.tkg(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.Deb||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.vK(Ii.a.ZY).toString():""))}this.Tyl(b)&&(c=this.y6c.nXc(b,0),this.y6c.add(b,c+1));this.C6c--;0<this.C6c||!Kc.a.Kb||!this.Lva||(Kc.a.yk(Ii.a.fdi,a.response.toString()),Kc.a.Kb!==this.Lva||this.leb||this.U9g(),this.Lva=null)}}U9g(){const a=Kc.a.Kb;if(a){var b=new Date;
a.Qj&&!a.WOb&&null===a.HF&&(a.HF=b);a.dAa(Ii.a.$ci,(+b-+a.bE).toString());a.$p?0<a.vK(Ii.a.ZY).length&&Kc.a.Naa(a):Kc.a.tyd();this.GCe&&(Kc.a.Kb=null,this.GCe=!1)}}Dpa(a){if(!this.y0g)return!1;if(Array.contains(this.Gue,a))return!0;a=w.AFrameworkApplication.Qa.MT(a);return!!a&&!(a.flags[32]||a.flags[64])}Qj(a,b){return Array.contains(this.hik,a)?b&&Ii.a.ZIc in b?b[Ii.a.ZIc]:!0:!1}Tyl(a){return this.y0g&&Array.contains(this.lwe,a)}xwl(a){return this.Mcd?!Kc.a.Kb:!Kc.a.Kb&&a.Zi}tkg(a,b,c,f){if(null===
a)return"null";b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.xLc+", InvocationMethod="+a.bU+", CommandLocation="+a.Lp+", CommandTabName="+a.Gsa;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.DJ?this.DJ.F6(a):null;return b?b:a.toString()}$9g(){if(!(1>this.y6c.count)){var a={};this.y6c.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});ya.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",Nd.c(a));this.Mc.Gal(Object(H.a)(this,
this.$9g,"onAppClosing"))}}UE(){Kc.a.vDi()}hFk(a){this.Deb=a.type;this.leb=Kc.a.Nyd(this.Deb);this.leb.Qj=!0;this.z6c=!1;a=Kc.a.xyd(a);null!==a&&Kc.a.PNl(a)&&this.leb.Wa(Ii.a.lEa,a.toFixed(2))}vEk(){this.leb&&Kc.a.Kb===this.leb&&this.z6c&&this.U9g();Kc.a.Kb=null;this.z6c=!1;this.leb=this.Deb=null}iFk(a){this.Deb=a.type;this.bgc=Kc.a.xyd(a);null!==this.bgc&&(this.Kxe=Kc.a.ynb(this.bgc))}wEk(){this.Deb=this.Kxe=this.bgc=null}}Object(m.a)(IP,"ActionContextListener",null,[144]);var MS=d(381);class lF{constructor(){this.K=
null;this.WDg=[];this.Kk=null;this.Bwa="";this.Dnk=!1;this.kY=[new HP,new xP];this.E$=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Xb(a){this.Bwa=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());Jg.a.instance.$b("EditingPackageConfigureStart",Date.now());this.K=a;this.vb();for(const b of this.kY)b.Xb(a);this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rqg&&this.K.register(215,"PowerPointWebEditor.ISlideMasterPrefetchManager").na().oa(()=>
new yP(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").zd(7),this.K.resolve("Box4.Graph.IGraphInstance").zd(8),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(aF,"PowerPointWebEditor.UpdateCommandUIActionListener").na().oa(()=>new aF(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}uEj(a,b,c){return 1===c?32:2===c?(this.bSj(),ya.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(ea.a.hmg,2),32):8}wRj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
a.Du();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}$lg(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.ySf=!0;b.RIh=a;b.Ixg()}tck(a,b){ya.a.J(512497351,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.Xck().continueWith(l=>{var y=new Date;ya.a.J(512497350,813,50,"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Kc.a.vf(c),
Kc.a.vf(y),+y-+c);if(6===l.status){l=lK.a({});const G=(y=lD())&&l&&(b||a);ya.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:y,["shouldUseShapeBuilder"]:G});l=G?document.createElement("canvas"):null;f.VRj(l,this.K.resolve("Gc2.IGlyphStore"))}l=this.K.resolve("PowerPointWebEditor.IApplicationSettings");l.HUc&&!l.B$a&&this.K.resolve("Common.AFrameworkApplication").To.C$b()}).continueWith(l=>
{6!==l.status&&ya.a.J(512497348,835,10,"Exception: {0}",l.hj)})}eTj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").Mxg()}bSj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").vdb().continueWith(()=>{this.K.resolve("PowerPointWebEditor.WetInkView")})}vb(){this.K.resolve("Common.IActionManagerExtended").ya(ea.a.Wsh,ye.a.frame,Object(H.a)(this,this.uEj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;
this.Bwa=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Bwa,(new Date).getTime(),a);Jg.a.instance.$b("EditingPackageInitStart",Date.now());a?(this.Kk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.Kk.tBf(Object(H.a)(this,this.Clg,"initEditingPackage"))):this.Dlg()}Clg(){this.Kk.Grh(Object(H.a)(this,this.Clg,"initEditingPackage"));this.Dlg()}Dlg(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Bwa=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",
this.Bwa,a.Ala,(new Date).getTime());a.MFa(()=>{this.hQj(a)});a.Kng(()=>{this.vJi()})}hQj(a){this.Bwa=String.format("{0}, InitStartInternal:{1}",this.Bwa,(new Date).getTime());Jg.a.instance.$b("EditingPackageInitStartInternal",Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings");var f=new BP;f.Xb(this.K);f.load(b);for(var l of this.kY)l.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(Fb.a.instance.resolve("PowerPointWebEditor.IImageViewManager").smb(),
c.aWa&&b.To.C$b());this.wRj();this.K.resolve("Common.IActionManagerExtended").Oaa(new IP(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),Fm.Yxg,Fm.Qdk,c.oGi,c.Y3j,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.AJa){let G=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=vg.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Na))?(G=b.hda,c.HUc&&(f=null,l=this.K.resolve("Common.AFrameworkApplication"),
f=b.pPb.querySelector("#GC2Container"),null==f&&l.To.C$b())):ya.a.J(512497347,809,10,"slideViewElement is null."):ya.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").rj());this.K.register(216,"PowerPointWebEditor.ICommentShimmerView").na().oa(()=>new zP(G,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),w.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("Common.ITaskManager"),c.JGi))}this.K.resolve("Common.IActionManagerExtended").Oaa(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.Iua||(yj.a.instance.AVe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&c.AJa&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),MS.a.Z4k(),this.K.resolve("PowerPointWebEditor.ISessionState").A6("AppInteractive"),
this.E$&&Jg.a.instance.$b("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").hoa("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(Nz.App.ENb(null,ji.a.contentEditable),this.qek()),Sd.a.get_instance().dI(4),a.Iua=!0);c.AJa&&this.Ung()&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").QBl(),ya.a.J(512497345,809,50,"CommentLandingSlide: true"));w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CommentTTVRImprovementIsEnabled",
!1)&&this.pYj()&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").OWk();this.Dnk&&(c.rxc?this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Fda("pptedit.extcommon",null,()=>d.e(12).then(d.t.bind(null,1292,7))):(a=Tx.a.create("pptedit.extcommon",null,()=>d.e(12).then(d.t.bind(null,1292,7))),Nv.a.py(a)));this.eTj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&ya.a.J(512497315,809,50,"HighContrastMode enabled");!c.Sne||
a&&a.isInHighContrastMode?c.Ije&&c.Sne&&this.$lg(!1):this.$lg(!0);c.I9b&&(this.WDg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.tck(c.IUc,c.jbj));w.AFrameworkApplication.hv||(w.AFrameworkApplication.hv=ya.a.G3b());c.Rqg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const y=this.K.rb("Common.IFrameTimingMeter");y&&(ya.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),y.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),
this.K.resolve("Common.ITaskManager").Hb(new pd.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,()=>{y.stop()},90,"93")));this.Bwa=String.format("{0}, InitDone:{1}",this.Bwa,(new Date).getTime());Jg.a.instance.$b("EditingPackageInitDone",Date.now());ya.a.J(512497313,809,50,this.Bwa)}Ung(){var a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){if(a=a.nE(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").qig(a))return!0}else ya.a.J(512497344,
809,10,"activeSlide is null");return!1}pYj(){return this.K.resolve("PowerPointWebEditor.IApplicationSettings").ka("IsDeepLinkSession")||this.Ung()}vJi(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");ya.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.GQh("{"+w.AFrameworkApplication.userSessionId+"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Ajj();
f&&(c.wxc(0<f.length?2:1),c.VPh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").Tek(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").GZf();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").emg();ya.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&w.AFrameworkApplication.fa.$e(Object(H.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),
this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").zHh,"startServerRtcConnection"))}qek(){if(Jg.a.instance.obb)ya.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[ji.a.zEa,ji.a.v4f,ji.a.x4f,ji.a.vUc,ji.a.w4f,ji.a.ptb,ji.a.IKc,ji.a.xda,ji.a.wQ,ji.a.contentEditable,ji.a.Uxc,"UserClickTime","DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","DocPageNavigationRedirects",
"BootJsStartTime","BootJsEndTime",ji.a.Tqd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime","EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime",
"EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",ji.a.N6b,ji.a.O6b,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime","OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime",
"OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart","ParseOpenEarlyServerResponseEnd","AppBootCompleted",
"FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])Jg.a.instance.xn(b)&&(a[b]=Jg.a.instance.Tg(b));w.AFrameworkApplication.fa.Ha("PodSID")&&(a.PodSessionID=w.AFrameworkApplication.fa.Ha("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&(a.RealRibbonDisplaySource=
b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:Jg.a.instance.xn("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=Jg.a.instance.Tg("ThumbnailShimmerHideTime"));ya.a.J(39184516,809,50,"Perf metrics: "+ta.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.q2j&&this.lgk(a,b)}}lgk(a,b){if(a[ji.a.wQ])if(a[ji.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[ji.a.contentEditable]-a[ji.a.wQ]>b.Iri){var c=new Map;c.set("ContentEditable",
a[ji.a.contentEditable].toString());c.set("ContentViewable",a[ji.a.wQ].toString());Sf.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new Ak.a,{extendedProperties:c}))}c=b.o3i;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[ji.a.wQ]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[ji.a.wQ].toString()),Sf.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],!1,!0,!1,!1,Object.assign(new Ak.a,
{extendedProperties:c})))}else ya.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else ya.a.J(512497309,809,15,"ContentEditable is null");else ya.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.kY)a.dispose();for(const a of this.WDg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();ya.a.J(38876352,809,50,"EditingPackage::Register time:{0}",a);Jg.a.instance.$b("EditingPackageRegisterTime",
a);n.a.instance.Ac(new lF)}}Object(m.a)(lF,"EditingPackage",null,[2,3]);var NS=d(588);class mF{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc,ic,yc){this.Yma=this.H$=!1;this.HM={};this.k5=this.JJ=null;this.Sxa=()=>{this.H$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");if(!y)throw Error.argumentNull("shapeReader");
if(!G)throw Error.argumentNull("pageView");if(!R)throw Error.argumentNull("actionManager");if(!ja)throw Error.argumentNull("slideDimensionsHelper");if(!za)throw Error.argumentNull("presentationReader");if(!Va)throw Error.argumentNull("transactionFactory");if(!hb)throw Error.argumentNull("pptPageView");if(!Cb)throw Error.argumentNull("applicationSettings");if(!lc)throw Error.argumentNull("viewElementEventHandlers");if(!ic)throw Error.argumentNull("viewCoreEventHandlers");this.Rb=a;this.Kc=b;this.af=
c;this.qJa=f;this.pa=l;this.Ga=y;this.Eb=G;this.ia=R;this.vu=yc;this.Wv=ja;this.ic=za;this.Fb=Va;this.yjc=hb;this.OGe=Cb.vvh;this.QGe=Cb.uvh;this.od=lc;this.ZJ=ic}get ylc(){return document.getElementById(L.AppFrame.YSh)}dispose(){this.H$=!1;this.Rb.drh(Object(H.a)(this,this.renderRuler,"renderRuler"));md.a.removeHandler(this.ylc,pa.a.scroll,Object(H.a)(this,this.Gnb,"updateRulerLocation"));this.od.vXe(Object(H.a)(this,this.anc,"onCloseTextEditView"));this.od.Nrc(Object(H.a)(this,this.ync,"onOpenTextEditView"));
this.ZJ.eqd(this.Sxa);this.JJ&&this.k5?(Ga.a.gLa(this.JJ,"ShowWACHorizontalRulerContainer"),Ga.a.WI(this.JJ,"HideWACHorizontalRulerContainer"),Mj.UISurfaces.PXc().then(a=>{a.dispose(this.k5);return null}),this.JJ.removeChild(this.k5),this.qJa.removeChild(this.JJ),this.k5=this.JJ=null):ya.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.JJ&&this.k5){Ga.a.gLa(this.JJ,"HideWACHorizontalRulerContainer");Ga.a.WI(this.JJ,"ShowWACHorizontalRulerContainer");
var b=this.Kc.Hc;if(b&&b.$c){var c=b.$c;c=new sr.a(c.Xp,c.Xk);b=this.Wv.T8b(c,b.hda?b.hda.xa.style.visibility===Ui.a.visible:!1).width;c=this.af.mi(this.Kc.Hc.WA).width;1===this.yjc.al||0>=b||0>=c?ya.a.J(512496003,824,50,"Ruler should not be rendered"):(this.HM.rulerCanvasProps=this.NTk(ve.a.tga(b,0)),c=Object(H.a)(this,this.tIk,"onIndentChange"),this.HM.onIndentChange=c,this.HM.indents=this.HM.rulerCanvasProps.textEditableArea?this.sUk():null,this.HM.rtl=this.Yma?!this.vu:this.vu,this.HM.inverted=
this.Yma?!this.vu:this.vu,this.k5.style.width=this.af.Pc(b),this.Gnb(null),Mj.UISurfaces.PXc().then(f=>{f.renderRuler(this.k5,this.HM);return null}),b=window.performance.now(),ya.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else ya.a.J(512496004,824,50,"Unable to get slideViewElement")}else ya.a.J(512496005,824,50,"Ruler container div / Ruler div null")}NTk(a){const b={},c=Oe.a.$v(this.ic.yn.eb(va.a.slideWidth));var f=a/2;let l=0,y=ve.a.xK(a,0);b.zeroScale=ve.a.xK(f,
0);this.Yma=!1;b.textEditableArea=!1;if(this.pa.i0()&&!this.pa.rWa()){f=this.pa.Y_();var G=f.qc(this.Eb.Na),R=G.rotation;R>this.OGe&&R<this.QGe&&(this.Yma=!0);const ja=G.htmlElement.querySelector(".ShapeViewContent"),za=this.Ga.VWc(f,this.Eb.Nd);R=0;f.Ug&&(R=f.Fs().qc(this.Eb.Na).htmlElement.offsetLeft);R+=G.htmlElement.offsetLeft+ja.parentNode.offsetLeft+(za?za.e:0);G=R+ja.offsetWidth;f=(this.Yma?!this.vu:this.vu)?G:R;R>=l&&R<=y&&G>=l&&G<=y&&(l=R,y=G,b.zeroScale=f,b.textEditableArea=!0)}R=Oe.a.yua(c)/
a;a=R*ve.a.tga(y-l,0);R*=ve.a.tga(l,0);b.leftMargin=l;b.rightMargin=y;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=Oe.a.cNa(a);b.leftBoundary=Oe.a.cNa(R);return b}ync(){this.H$&&this.renderRuler()}anc(){this.H$&&this.renderRuler()}sUk(){var a={};if(32!==this.ia.Ja(C.a.kLb,2,a))return ya.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},f={type:"LeftIndent"};a=a.FB;if(!a)return ya.a.J(512496E3,
824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?Oe.a.cNa(a.yPb+a.mO):2===a.specialIndentType?Oe.a.cNa(a.mO-a.yPb):Oe.a.cNa(a.mO);c.value=Oe.a.cNa(a.mO);f.value=Oe.a.cNa(a.mO);return[b,c,f]}tIk(a,b){const c=new NS.a;c.unit=1;c.value=Oe.a.yua(b);this.DPj(a,c)}DPj(a,b){var c=this.pa.Y_();if(a&&b&&c){var f=window.performance.now(),l=this.Fb.ke(15);l.jc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.Ja(ea.a.uOb,2,b);l.gd=ea.a.uOb;break;case "HangingIndent":c=this.ia.Ja(ea.a.wOb,2,
b);l.gd=ea.a.wOb;break;case "LeftIndent":c=this.ia.Ja(ea.a.qla,2,b);l.gd=ea.a.qla;break;default:ya.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();ya.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&ya.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else ya.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}rP(){this.OTd();this.H$=!0;this.Rb.SAf(Object(H.a)(this,this.renderRuler,
"renderRuler"));md.a.addHandler(this.ylc,pa.a.scroll,Object(H.a)(this,this.Gnb,"updateRulerLocation"));this.od.aKc(Object(H.a)(this,this.anc,"onCloseTextEditView"));this.od.$sb(Object(H.a)(this,this.ync,"onOpenTextEditView"));this.ZJ.KJc(this.Sxa)}Gnb(){if(this.H$){var a=this.Kc.Hc;a&&a.WA&&window.requestAnimationFrame(()=>{const b=Cd.a.Z$a(a.WA),c=Cd.a.Z$a(this.qJa);this.k5.style.marginLeft=this.af.Pc(b.x-c.x+1)})}else ya.a.J(512495967,824,10,"UpdateRulerLocation called with cookie value false")}X1i(){if(this.JJ)return this.JJ;
this.JJ=document.createElement("div");this.JJ.id="WACHorizontalRulerContainer";this.JJ.className="WACHorizontalRulerContainer";this.JJ.setAttribute(Ne.a.fr,"ruler");this.JJ.setAttribute(Ne.a.hf,Ne.a.nsa);Sys.UI.DomElement.addCssClass(this.JJ,"HideWACHorizontalRulerContainer");return this.JJ}Y1i(){if(this.k5)return this.k5;this.k5=document.createElement("div");this.k5.className="WACHorizontalRuler";this.k5.id="WACHorizontalRuler";return this.k5}OTd(){this.JJ=this.X1i();this.JJ.appendChild(this.Y1i());
this.qJa.insertBefore(this.JJ,this.qJa.firstChild)}}Object(m.a)(mF,"HorizontalRuler",null,[265]);class nF{constructor(a,b,c,f,l){this.jZj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Rb=b;this.u_g=c;this.c$c=f;this.ogd=l}vb(){this.ia.ra(ea.a.rvd,rb.a.application,Object(H.a)(this,this.rvd,
"showHideRuler"),4);this.ia.ra(ea.a.mod,rb.a.application,Object(H.a)(this,this.mod,"queryRulerToggle"),96)}HQj(){this.H3c()&&(ya.a.J(523351431,824,15,"Ruler init is called"),this.u_g.Zlg())}rvd(a,b,c){return this.H3c()?this.AMj(c):this.MBl(c)}fRh(){this.Rb.pF({ShowHideRuler:"ToggleButtonModel"})}MBl(a){if(1===a)return 32;ya.a.J(523351432,824,15,"ShowRuler called");this.u_g.Zlg();this.wAh(!0);this.Rb.Du();this.fRh();return 32}AMj(a){if(1===a)return 32;ya.a.J(523351433,824,15,"HideRuler called");this.LYi();
this.wAh(!1);this.Rb.Du();this.fRh();return 32}LYi(){this.H3c()&&(this.c$c.dispose(),this.ogd.dispose(),this.Rb.Du())}mod(a,b,c,f,l){if(1===c)return 32;l&&(l[Ih.a.On]=this.H3c());return 32}H3c(){return Ti.a.S_(TE.a.xjh,this.jZj)}wAh(a){Ti.a.qK(w.AFrameworkApplication.fa.Ha("IsRulerOnCookieName"),a.toString(),Ti.a.aK)}}Object(m.a)(nF,"RulerActor",null,[]);class JP{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");
this.c$c=a;this.ogd=b;this.Rb=c}Zlg(){this.c$c.rP();this.ogd.rP();this.Rb.Du();this.c$c.renderRuler();this.ogd.renderRuler()}}Object(m.a)(JP,"RulerFactory",null,[209]);class Tq{constructor(a,b,c,f,l,y,G,R,ja,za,Va,hb,Cb,lc){this.zYd="HideWACVerticalRulerContainer";this.UIf="ShowWACVerticalRulerContainer";this.Yma=this.H$=!1;this.b6=this.YJ=null;this.Sxa=()=>{this.H$&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");
if(!l)throw Error.argumentNull("selectionManager");if(!y)throw Error.argumentNull("shapeReader");if(!G)throw Error.argumentNull("pageView");if(!R)throw Error.argumentNull("slideDimensionsHelper");if(!ja)throw Error.argumentNull("presentationReader");if(!za)throw Error.argumentNull("pptPageView");if(!Va)throw Error.argumentNull("applicationSettings");if(!hb)throw Error.argumentNull("viewElementEventHandlers");if(!Cb)throw Error.argumentNull("viewCoreEventHandlers");this.Rb=a;this.Kc=b;this.af=c;this.qJa=
f;this.pa=l;this.Eb=G;this.ic=ja;this.vu=lc;this.Wv=R;this.yjc=za;this.OGe=Va.vvh;this.QGe=Va.uvh;this.od=hb;this.ZJ=Cb}get ylc(){return document.getElementById(L.AppFrame.YSh)}dispose(){this.H$=!1;md.a.removeHandler(this.ylc,pa.a.scroll,Object(H.a)(this,this.Gnb,"updateRulerLocation"));this.Rb.drh(Object(H.a)(this,this.renderRuler,"renderRuler"));this.od.vXe(Object(H.a)(this,this.anc,"onCloseTextEditView"));this.od.Nrc(Object(H.a)(this,this.ync,"onOpenTextEditView"));this.ZJ.eqd(this.Sxa);this.YJ&&
this.b6?(Ga.a.gLa(this.YJ,this.UIf),Ga.a.WI(this.YJ,this.zYd),Mj.UISurfaces.PXc().then(a=>{a.dispose(this.b6);return null}),this.YJ.removeChild(this.b6),this.qJa.removeChild(this.YJ),this.b6=this.YJ=null):ya.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.YJ&&this.b6){Ga.a.gLa(this.YJ,this.zYd);Ga.a.WI(this.YJ,this.UIf);var b=this.Kc.Hc;if(b&&b.$c){var c=b.$c;c=new sr.a(c.Xp,c.Xk);b=this.Wv.T8b(c,b.hda?b.hda.xa.style.visibility===
Ui.a.visible:!1).height;c=this.af.mi(this.Kc.Hc.WA).height;if(1===this.yjc.al||0>=b||0>=c)ya.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.uUk(ve.a.tga(b,1));f.rtl=this.Yma?!this.vu:this.vu;f.inverted=this.Yma?!this.vu:this.vu;this.b6.style.height=this.af.Pc(b);this.Gnb(null);Mj.UISurfaces.PXc().then(l=>{l.renderRuler(this.b6,f);return null});b=window.performance.now();ya.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else ya.a.J(512495964,
824,50,"Unable to get slideViewElement")}else ya.a.J(512495965,824,50,"Ruler container div / Ruler div null")}uUk(a){const b={},c=Oe.a.$v(this.ic.yn.eb(va.a.slideHeight));var f=a/2;let l=0;a=ve.a.xK(a,0);b.zeroScale=ve.a.xK(f,0);this.Yma=!1;b.textEditableArea=!1;if(this.pa.i0()&&!this.pa.rWa()){f=this.pa.Y_();var y=f.qc(this.Eb.Na);const R=y.htmlElement.querySelector(".ShapeViewContent");var G=y.rotation;G>this.OGe&&G<this.QGe&&(this.Yma=!0);G=0;f.Ug&&(G=f.Fs().qc(this.Eb.Na).htmlElement.offsetTop);
G+=y.htmlElement.offsetTop+R.parentNode.offsetTop+R.offsetTop;y=G+R.offsetHeight;f=(this.Yma?!this.vu:this.vu)?y:G;G>=l&&G<=a&&y>=l&&y<=a&&(l=G,a=y,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}rP(){this.OTd();this.H$=!0;md.a.addHandler(this.ylc,pa.a.scroll,Object(H.a)(this,this.Gnb,"updateRulerLocation"));this.Rb.SAf(Object(H.a)(this,this.renderRuler,"renderRuler"));this.od.aKc(Object(H.a)(this,this.anc,"onCloseTextEditView"));
this.od.$sb(Object(H.a)(this,this.ync,"onOpenTextEditView"));this.ZJ.KJc(this.Sxa)}Gnb(){if(this.H$){var a=this.Kc.Hc;a&&a.WA&&window.requestAnimationFrame(()=>{const b=Cd.a.Z$a(a.WA),c=Cd.a.Z$a(this.qJa);this.b6.style.marginTop=this.af.Pc(b.y-c.y+1)})}else ya.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}ync(){this.H$&&this.renderRuler()}anc(){this.H$&&this.renderRuler()}OTd(){this.YJ=this.T2i();this.YJ.appendChild(this.U2i());this.qJa.insertBefore(this.YJ,this.qJa.firstChild)}T2i(){if(this.YJ)return this.YJ;
this.YJ=document.createElement("div");this.YJ.id=Tq.ryi;this.YJ.className=Tq.qyi;this.YJ.setAttribute(Ne.a.fr,"ruler");this.YJ.setAttribute(Ne.a.hf,Ne.a.nsa);Sys.UI.DomElement.addCssClass(this.YJ,this.zYd);return this.YJ}U2i(){if(this.b6)return this.b6;this.b6=document.createElement("div");this.b6.className=Tq.pyi;this.b6.id=Tq.syi;return this.b6}}Tq.ryi="WACVerticalRulerContainer";Tq.qyi="WACVerticalRulerContainer";Tq.syi="WACVerticalRuler";Tq.pyi="WACVerticalRuler";Object(m.a)(Tq,"VerticalRuler",
null,[265]);class oF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Xb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qkb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(mF,"PowerPointWebEditor.Ruler.HorizontalRuler").na().oa(()=>new mF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.fyc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
w.AFrameworkApplication.isRtl));this.K.register(Tq,"PowerPointWebEditor.Ruler.VerticalRuler").na().oa(()=>new Tq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.fyc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),w.AFrameworkApplication.isRtl));this.K.register(209,"PowerPointWebEditor.Ruler.IRulerFactory").na().oa(()=>new JP(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),a));this.K.register(nF,
"PowerPointWebEditor.Ruler.RulerActor").na().oa(()=>new nF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").vb();Sd.a.get_instance().Vj(8,()=>{this.LMe()})}}LMe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").HQj()}dispose(){}static main(){n.a.instance.Ac(new oF)}}
Object(m.a)(oF,"PPTWebEditorRulerPackage",null,[2,3]);class rA{static get J_l(){return rA.K_l}}rA.K_l="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(m.a)(rA,"ZoomDialogHtml",null,[]);class my extends ei.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.o_b=this.n_b=this.Ea=this.Oyc=null;this.E_l=
"ZoomDialogBoxGroup";this.BQa=a;this.MIc=b;this.Xxf=c;this.Pd=f;this.hg=this.Cui();this.Ad=1;this.ig="ZoomDialog"}get UUe(){return"ListRadioBox"}get Yqc(){return"radiobox"}get rmh(){return"WACZoomDialogRadioRow"}get TUe(){return"WACZoomDialogRadioRow-highlight"}get Wo(){return this.Pd}get k8(){return this.Oyc}BFh(a,b){if(this.gL)this.uCl(a,b);else{const c={};for(let f=0;f<this.BQa.length;f++)c[this.Yqc+f]=this.MIc[f]===b?!0:!1;this.sj(a,Object(H.a)(this,this.G_l,"zoomDialogHandler"),c);this.xVe();
this.jWe()}}uCl(a,b){var c=Array(this.BQa.length);let f="";for(let l=0;l<this.BQa.length;l++){const y=l.toString();c[l]={["key"]:y,["text"]:this.BQa[l]};b===this.MIc[l]&&(f=y)}b={};b.dialogChoiceGroupProps={["id"]:this.E_l,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.sj(a,Object(H.a)(this,this.L_l,"zoomDialogReactHandler"),c)}hll(){this.Oyc=document.getElementsByName(this.UUe)[0];this.$Tc(this.k8)}x8(){this.Ea||(this.Ea=document.getElementById("WACDialogText"));
this.Ea&&(this.n_b||(this.n_b=Object(H.a)(this,this.F_l,"zoomDialogClickHandler"),this.Ln.ub(pa.a.click,this.Ea,this.n_b)),this.o_b||(this.o_b=Object(H.a)(this,this.H_l,"zoomDialogKeyDownHandler"),this.Wg.ub(pa.a.Df,this.Ea,this.o_b)));super.x8();this.Jb&&this.Wg.ub(pa.a.Tl,this.Jb,Object(H.a)(this,this.YN,"dialogDefaultEnterKeyHandler"))}xVe(){this.Wo.Kl().scope.hw(t.FocusManager.instance().Cra);this.Wo.Kl().scope.hw(t.FocusManager.instance().Dra);this.Wo.Kl().scope.bindAction(t.FocusManager.instance().Cra,
F.a.pyc);this.Wo.Kl().scope.bindAction(t.FocusManager.instance().Dra,F.a.oyc)}jWe(){const a=document.getElementsByName(this.UUe);for(let b=0;b<a.length;b++){const c=a[b];md.a.addHandler(c,pa.a.focus,Object(H.a)(this,this.Qod,"radioButtonFocusHandler"));c.checked&&(this.Oyc=c)}}G_l(a,b){if(1===a)for(a=0;a<this.BQa.length;a++)if(b[this.Yqc+a]){this.Xxf(this.MIc[a]);break}}Qod(a){this.$Tc(a.target)}F_l(a){a=a.Bc;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.rmh))return!1;
a=this.b$f(a);a=document.getElementById(this.Yqc+a);this.$Tc(a);return!0}L_l(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.Xxf(this.MIc[a]))}H_l(a){a=a.nc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.b$f(this.k8);const c=this.BQa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.Yqc+b);this.$Tc(a);return!0}YN(a){return a.eventName===
pa.a.Tl&&a.nc.keyCode===Sys.UI.Key.enter?(super.YN(a),!0):!1}$Tc(a){a&&(a.checked=!0,this.Wo.Ee&&this.Wo.Ee.name===this.CL||this.Wo.wf(this.CL),this.Wo.Kl().Gj.mF(a),a.focus(),this.k8&&Sys.UI.DomElement.removeCssClass(this.k8.parentNode,this.TUe),Sys.UI.DomElement.addCssClass(a.parentNode,this.TUe),this.Oyc=a)}b$f(a){return Number.parseInvariant(na.a.substr(a.id,a.id.length-1,1))}ZA(){super.ZA();const a=document.getElementById(this.Vh("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}Cui(){let a="";for(let b=0;b<this.BQa.length;b++)a+=ei.a.pz(my.I_l,b.toString(),this.BQa[b],this.UUe);return a}dispose(){this.Ea&&(this.Ln&&this.n_b&&this.Ln.Bb(pa.a.click,this.Ea,this.n_b),this.Wg&&this.o_b&&this.Wg.Bb(pa.a.Df,this.Ea,this.o_b));this.Ln&&this.Jb&&this.Wg.Bb(pa.a.Tl,this.Jb,Object(H.a)(this,this.YN,"dialogDefaultEnterKeyHandler"));super.dispose()}}my.I_l=rA.J_l;Object(m.a)(my,"ZoomDialog",ei.a,[308]);class pF{constructor(){this.Ff=null}create(a,
b,c,f){return this.Ff=new my(a,b,c,f)}}Object(m.a)(pF,"ZoomDialogFactory",null,[296]);class qF{constructor(){this.Ea=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Xb(a){this.Ea=a;this.Ea.register(pF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").oa(()=>new pF).na()}static main(){n.a.instance.Ac(new qF)}}Object(m.a)(qF,"ZoomPackage",null,[2,3]);class KP{constructor(a,b,c,f,l,y,G){this.oxk=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.Hgd="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.Ff=null;this.ia=a;this.Fa=b;this.ic=l;this.lj=c;this.Rb=f;this.qm=y;this.rAg=G}vb(){this.ia.ra(ea.a.OUe,qc.a.application,Object(H.a)(this,this.t0k,"queryZoom"),96);this.ia.ya(ea.a.mPe,qc.a.application,Object(H.a)(this,this.oKj,"handleZoomConfig"));this.ia.ya(ea.a.qyc,qc.a.application,Object(H.a)(this,this.pKj,"handleZoomToFit"));this.ia.ya(F.a.pyc,ye.a.frame,Object(H.a)(this,this.XTh,"zoomDialogTabFocusHandler"));this.ia.ya(F.a.oyc,
ye.a.frame,Object(H.a)(this,this.XTh,"zoomDialogTabFocusHandler"));w.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(F.a.dwb,ye.a.frame,Object(H.a)(this,this.dwb,"decreaseZoom")),this.ia.ya(F.a.mAb,ye.a.frame,Object(H.a)(this,this.mAb,"increaseZoom")),this.ia.ya(F.a.M_l,ye.a.frame,Object(H.a)(this,this.INk,"onZoomToPercentage")),this.ia.ra(F.a.u0k,ye.a.frame,Object(H.a)(this,this.IKk,"onQueryZoomPercentage"),96),qd.a("ZoomShortCutsEnabled")&&(this.ia.ya(C.a.DSf,ye.a.frame,zf.ActionManager.Sg),
this.ia.ya(C.a.CSf,ye.a.frame,zf.ActionManager.Sg)))}me(){if(w.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&qd.a("ZoomShortCutsEnabled")){const a=this.Fa.Ic(xa.a.$i);a.bindAction(x.KeyInputManager.Va(B.a.kAd,x.KeyInputManager.Te),F.a.mAb);a.bindAction(x.KeyInputManager.Va(B.a.nAd,x.KeyInputManager.Te),F.a.mAb);a.bindAction(x.KeyInputManager.Va(B.a.lAd,x.KeyInputManager.Te),F.a.dwb);a.bindAction(x.KeyInputManager.Va(B.a.Zxc,x.KeyInputManager.Te),F.a.dwb);this.rAg&&ka.a.instance.ub(pa.a.rIb,
this.rAg,Object(H.a)(this,this.Umi,"adjustZoomOnMouseWheel"))}}Umi(a){return a?a.D_?(0<a.qTh?this.lNa(this.d8g):0>a.qTh&&this.lNa(this.e8g),!0):!1:!1}get h9a(){return Math.round(100*this.lj.kV)}get e8g(){return Math.floor(this.h9a/10)/10+.1}get d8g(){return Math.ceil(this.h9a/10)/10-.1}t0k(a,b,c,f,l){if(!l||isNaN(this.h9a)||0==this.h9a)return 8;l[mE.a.LabelText]=Math.round(100*this.lj.kV)+"%";this.qm&&(this.qm.WU(this.qm.U6,this.qm.Sbf),this.qm.hoa(this.qm.U6,this.qm.Sbf));return 32}oKj(a,b,c,f,l){if(1===
c)return this.ic.rj()?32:8;if(!l)return 8;this.Ff=new my(this.oxk,this.Hgd,Object(H.a)(this,this.XAd,"zoomSettingAction"),t.FocusManager.instance(),!0);this.Ff.BFh(CommonUIStrings.l_ZoomDialogTitle,this.lj.Fla?this.Hgd[0]:this.lj.kV.toString());return 32}XAd(a){if(a!==this.Hgd[0]){const b=parseFloat(a);if(isNaN(b)){ya.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.lj.Fla=!1;this.lj.kV=b;this.lj.Unb=2}else this.lj.Fla=!0;this.Rb.Du();ya.a.J(512288458,827,50,"Succeeded to Zoom: {0}",
a)}pKj(a,b,c,f,l){if(1===c)return this.ic.yn&&!this.ic.rj()?8:32;if(!l)return 8;if(!this.ic.yn)return ya.a.J(509212699,827,50,"Content Editable hasn't reached yet as presentation node hasn't been set"),8;this.XAd(this.Hgd[0]);return 32}XTh(a){if(!this.Ff)return 8;var b=this.Ff.Wo.Kl().Gj.G_;if(b===this.Ff.lw&&a===F.a.pyc||b===this.Ff.QD&&a===F.a.oyc)this.Ff.k8||this.Ff.hll(),this.Ff.Wo.Kl().Gj.mF(this.Ff.k8);else if(b.id.startsWith(this.Ff.Yqc)||b.className.startsWith(this.Ff.rmh))b=null,a===F.a.pyc?
b=this.Ff.QD:a===F.a.oyc&&(b=this.Ff.lw),this.Ff.Wo.Kl().Gj.mF(b),Sys.UI.DomElement.removeCssClass(this.Ff.k8.parentNode,this.Ff.TUe);else if(a===F.a.pyc)this.Ff.Wo.Kl().uIb();else if(a===F.a.oyc)this.Ff.Wo.Kl().sIb();else return 16;return 32}mAb(a,b,c){if(1===c)return 32;this.lNa(this.e8g);ya.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");return 32}dwb(a,b,c){if(1===c)return 32;this.lNa(this.d8g);ya.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}INk(a,b,c,f,l){if(1===
c)return 32;a=l.value/100;this.lNa(a);ya.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.PC=Math.floor(100*a));return 32}IKk(a,b,c,f,l){if(isNaN(this.h9a)||0==this.h9a)return 8;l.MinValue=10;l.MaxValue=400;l.value=this.h9a;return 32}lNa(a){.1>a?a=.1:4<a&&(a=4);this.lj.Fla=!1;this.lj.kV=a;this.lj.Unb=2;this.Rb.Du()}}Object(m.a)(KP,"ZoomActor",null,[268]);class rF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Xb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");
const b=this.K.resolve("Common.IActionManagerExtended"),c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new KP(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.KVd);a.vb();a.me()}dispose(){}static main(){n.a.instance.Ac(new rF)}}Object(m.a)(rF,"PPTWebEditorZoomPackage",null,[2,3]);var LP=d(525);class MP{constructor(a){this.le=a}$Qf(a,b,c,f,l,y){const G=this.le.qk(c+".png");
c=tb.getImageClassWithCluster(c,f);return tb.createClusteredImageFromClusterWithImageClass(a,b,c,G,32===a&&32===b?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,l,null,y)}}Object(m.a)(MP,"ShapeGlyphImageFactory",null,[207]);var NP=d(701);class OP{constructor(a,b){this.x9c=this.S0=null;this.Xwe=this.oOg=0;this.af=a;this.Kc=b}dispose(){this.clear();this.S0.parentNode.removeChild(this.S0)}add(a,b){this.D0e(!1);a=this.xfi(a,b);this.O_j()||this.z7j(a)?this.C0e(-1*(Math.ceil(a.offsetWidth)+
2)):this.C0e(this.Xwe);this.D0e(!0)}clear(){this.af.yv(this.x9c);this.D0e(!1);this.C0e(0)}vRa(a,b,c){this.oOg=c;this.Xwe=b;this.S0=this.af.ee();this.S0.className="prFlyout UISmallFont";a.appendChild(this.S0);this.x9c=this.af.W3b();this.S0.appendChild(this.x9c)}xfi(a,b){const c=this.af.mRf();c.style.backgroundColor=a;c.style.lineHeight=this.af.Pc(this.oOg);this.af.Rz(c,b);this.x9c.appendChild(c);return c}z7j(a){a=this.af.mi(a);const b=this.af.mi(this.Kc.Hc.WA);return a.x+a.width+this.Xwe>b.x+b.width}O_j(){return 0>
this.af.Sn(this.S0.style.left)}D0e(a){this.S0.style.visibility=a?Ui.a.visible:Ui.a.hidden}C0e(a){this.S0.style.left=this.af.Pc(a)}}Object(m.a)(OP,"ShapePawnFlyout",null,[315]);var OS=d(999),PS=d(1315),QS=d(1306);class sF{constructor(a,b,c,f,l){this.pYd=1;this.Fjc=[];this.keb=null;this.ufc=this.AGb=!1;this.ekc=this.Uk=this.yu=null;(this.Rv=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))?(this.Uk=a,this.ekc=l,this.FQi()):this.Ky=Object(sa.a)(NP.a,f.cSf(a,b,c,Object(H.a)(this,this.SM,
"onPointerOver"),Object(H.a)(this,this.sG,"onPointerOut"),l))}m9(){if(this.Rv)return this.Orj();const a=Array.clone(this.vga);if(this.PW){let b=!1;for(const c of this.vga)if(c.clientId===this.PW.clientId){b=!0;break}b||Array.add(a,this.PW)}return a}dispose(){this.Rv?this.CYi():(this.Fjc=this.keb=null,this.Ky.dispose())}pB(a){if(this.Rv)this.Bhi(a);else if(a){for(const b of this.vga)if(b.clientId===a.clientId)return;Array.add(this.vga,a);this.refresh()}}uP(a){if(this.Rv)this.zal(a);else if(a)for(const b of this.vga)if(b.clientId===
a.clientId){Array.remove(this.vga,b);this.refresh();break}}clear(){this.Rv?this.NDi():(this.Fjc=[],this.Ky.clear())}get PW(){return this.keb}set PW(a){this.keb!==a&&(this.keb=a,this.keb||(this.ufc=!1),this.Rv||this.refresh())}D3e(){this.Rv||(this.PW?(this.ufc=!0,this.dMb()):ya.a.J(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}d4e(){this.Rv?this.zBl():(this.AGb=!0,this.keb&&(this.ufc=!0),this.dMb())}She(){this.Rv?this.zMj():(this.AGb=
!1,this.dMb())}setZIndex(a){this.Rv?this.Ful(a):this.Ky.setZIndex(a)}get N_a(){return this.PW?this.PW.color:this.vga&&this.vga.length?this.vga[this.vga.length-1].color:gj.a.none}CZc(){return!!this.keb||0<this.Fjc.length}get vga(){return this.Rv?this.yu.PKb:this.Fjc}pMj(){this.Ky.PYe();this.Ky.h_d()}sG(){this.CZc()&&(this.AGb=!1,this.dMb());return!0}SM(){this.CZc()&&(this.AGb=!0,this.dMb());return!0}iTl(){this.CZc()?this.Ky.lzh(1<this.Fjc.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",
this.N_a):this.Ky.MRa()}refresh(){this.iTl();this.dMb()}dMb(){this.pMj();if(this.AGb)if(this.PW){this.Ky.I_b(this.PW.color,String.format(ResourceStrings.l_TypingHint,this.PW.userName));for(const a of this.vga)this.PW.clientId!==a.clientId&&this.Ky.I_b(a.color,a.userName)}else for(const a of this.vga)this.Ky.I_b(a.color,a.userName);else this.ufc&&(this.PW?this.Ky.I_b(this.PW.color,String.format(ResourceStrings.l_TypingHint,this.PW.userName)):ya.a.J(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));
(this.AGb||this.ufc)&&this.Ky.aKe()}EOb(a,b){this.yu&&this.yu.EOb(a,b)}CYi(){this.yu&&this.yu.dispose()}ZRe(){return k.a.mi(document.body)}Bhi(a){a?this.yu?(ya.a.J(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",a.clientId),this.yu.pB(a)):ya.a.J(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):ya.a.J(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}zal(a){a?
this.yu?(ya.a.J(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",a.clientId),this.yu.uP(a.clientId)):ya.a.J(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):ya.a.J(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}NDi(){if(this.yu){ya.a.J(42472543,814,50,"ShapePresencePawn:Clear at PresencePawn ");var a=this.m9();if(a)for(const b of a)this.uP(b);
else ya.a.J(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else ya.a.J(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}Orj(){return this.yu?this.yu.PKb:null}zBl(){this.yu&&(this.yu.hMa(),this.yu.dMa())}zMj(){this.yu&&this.yu.hMa()}Ful(a){this.Uk.style.zIndex=String(a)}ezj(a){const b=new PS.a;b.add(0,tb.getImageClassWithCluster(w.AFrameworkApplication.lO,"MoreUsersGlyph_16x16x32"));b.add(5,w.AFrameworkApplication.km);b.add(1,tb.getImageClassWithCluster(w.AFrameworkApplication.lO,
"DoughboyWhiteGlyph_20x20x32"));b.add(4,w.AFrameworkApplication.km);b.add(6,20);b.add(8,w.AFrameworkApplication.isRtl);b.add(12,a);b.add(11,!1);b.add(16,Object(H.a)(this,this.ZRe,"presenceViewportBoundsCallback"));return new QS.a(b)}FQi(){this.yu=this.ezj(this.dag()).C3b(this.Uk);Sys.UI.DomElement.addCssClass(this.yu.element,"ShapePawnContainer")}zEi(){const a=this.m9();if(a)for(const b of a)this.EOb(b.clientId,!1)}dag(){return this.pYd+Sx.a.Bha+Sx.a.Bha}aKe(){this.ekc.xa.style.zIndex=String(this.dag())}}
Object(m.a)(sF,"ShapePresencePawn",null,[312,313,108,205]);var RS=d(998);class PP{constructor(a,b,c,f,l){this.Xr=a;this.Rc=b;this.af=c;this.Wgb=f;this.Kc=l}yRi(a,b,c,f){this.af.addCssClass(a,"ShapeModernCatchupPawnContainer");return new RS.a(a,b,"pegal",this,c,f)}wRi(a,b,c){this.af.addCssClass(a,"ShapePawnContainer");return new sF(a,b,"per",this,c)}cSf(a,b,c,f,l,y){return new NP.a(a,b,c,f,l,null,this,this.Wgb,this.af,this.Xr,this.Rc,y)}uRi(){return new OP(this.af,this.Kc)}vRi(){return new OS.a(this.af)}}
Object(m.a)(PP,"ShapePawnFactory",null,[206]);var Eo=d(653);class QP{constructor(a,b,c,f,l,y=16){this.kJg=!1;this.rm=null;this.pfb=!1;this.Dlc=this.ZB=this.YB=0;this.nd=1;this.ngc=!1;this.Ab=this.Nec=!0;this.AA=!1;this.DU=!0;this.Nxe=!1;this.m5=y;this.TIa=new dm.a;this.H0=new Rz.a;this.Kx=new Vm.a;this.kG=new Vm.a;this.IH=new Vm.a;this.C5=new dm.a;this.LE=new XD.a;this.Zr=new XD.a;this.jb=a;this.Ky=b?b(this.C5.xa,this.m5,l):null;this.ta=c;this.o$=f}dispose(){this.o$();this.TIa&&(this.TIa.xa.parentNode&&
this.TIa.Eq(),this.H0&&this.H0.viewport&&this.H0.viewport.Eq(),this.Kx&&this.Kx.Eq(),this.kG&&this.kG.Eq(),this.IH&&this.kG.Eq());this.Ky&&this.Ky.dispose();this.C5=this.IH=this.kG=this.Kx=this.H0=this.TIa=null;this.Ab=!1}get SBh(){return this.Ky}get shape(){return this.ta}get bcb(){return this.kJg}set bcb(a){this.m5=a?20:16;this.kJg=a}get Srg(){return this.pfb}set Srg(a){this.m5=16;this.pfb=a}Bm(a){this.TIa.appendChild(this.H0.viewport);this.TIa.appendChild(this.C5);this.Kx.dF(gj.a.none);this.pfb?
this.Kx.xr(Pd.a.l2e):this.Kx.xr(Pd.a.o2e);this.kG.dF(gj.a.none);this.kG.xr(Eo.a.WNc);this.IH.dF(gj.a.none);this.IH.xr(Eo.a.e0d);this.H0.appendChild(this.IH);this.H0.appendChild(this.kG);this.H0.appendChild(this.Kx);this.setVisibility();this.nXf();a.appendChild(this.TIa)}kC(){}Mp(){return this.H0.Mp()}UAb(){return!1}Xw(){}setVisibility(){const a=this.Ab&&(!this.AA||!this.DU);this.C5.Sd(a);this.Kx.Sd(a);this.kG.Sd(a);this.IH.Sd(a);this.TIa.Sd(this.Ab)}ny(){}ZC(){return null}TA(){return[]}nXf(){this.rm=
this.ta.Nn.copy();this.Kx.xr(this.Nxe?Eo.a.cOf:this.pfb?Pd.a.l2e:Pd.a.o2e);this.kG.xr(Eo.a.WNc);this.IH.xr(Eo.a.e0d);this.ls();this.setVisibility()}draw(){this.visible=!0;this.nXf()}get visible(){return this.Ab}set visible(a){this.Ab!==a&&(this.Ab=a,this.setVisibility(),this.ls())}get aub(){return this.Nec}set aub(a){this.Nec=a;this.Kx.Sd(this.Ab&&this.Nec);this.kG.Sd(this.Ab&&this.Nec);this.IH.Sd(this.Ab&&this.Nec)}setPosition(a,b){this.YB=a;this.ZB=b;this.ls()}Kj(a){this.nd=a;this.ls()}wq(a){this.LE=
a;this.ls()}Ju(a){this.Zr=a;this.ls()}setZIndex(a){this.Dlc=a;this.TIa.lC(this.Dlc);this.H0.lC(this.Dlc);this.C5.lC(this.Dlc);this.Ky&&this.Ky.setZIndex(this.Dlc)}JD(a,b){this.AA=a;this.DU=b;this.setVisibility()}kRb(a=null){this.Ky&&this.Kx.fv(a||this.Ky.N_a);this.Kx&&(this.Kx.tpa(""),this.Kx.dF(gj.a.none),this.pfb?this.Kx.xr(Pd.a.l2e):this.Kx.xr(Pd.a.o2e),this.Kx.eba(""))}KDi(){this.Kx&&this.kG&&this.IH&&(this.Nxe=!1,this.Kx.eba(""),this.kG.eba(""),this.Kx.fv(gj.a.none),this.Kx.hza(0),this.kG.fv(gj.a.none),
this.kG.hza(0),this.IH.fv(gj.a.none),this.IH.hza(0))}G$e(a,b=!1){if(this.Kx&&this.kG&&this.IH){this.Nxe=!0;var c=0===a;this.Kx.xr(Eo.a.cOf);this.kG.xr(2===a?Eo.a.DGi:Eo.a.WNc);this.IH.xr(Eo.a.e0d);this.Kx.fv(c?gj.a.none:Eo.a.BGi);this.kG.fv(c?gj.a.none:Eo.a.xGi);switch(a){case 2:this.IH.fv(Eo.a.AGi);break;case 1:this.IH.fv(Eo.a.yGi);break;default:this.IH.fv(Eo.a.zGi)}1===a?this.W0f():b?this.W0f():(this.Kx.hza(1),this.kG.hza(1),this.IH.hza(1))}}W0f(){this.X0f(0)}X0f(a){this.Kx&&this.kG&&this.IH&&!(1<
a)&&(a+=.05,this.Kx.hza(a),this.kG.hza(a),this.IH.hza(a),window.setTimeout(()=>{this.X0f(a)},10))}ls(){if(this.rm){var a=this.rm.copy();this.LE.ql(a);this.Zr.ql(a);a.move(this.YB,this.ZB);a.scale(this.nd,this.nd);this.URl(a);this.mUl(a)}}URl(a){if(this.Kx&&this.kG&&this.IH&&a){var b=this.kJf(Eo.a.CGi,a),c=this.kJf(Eo.a.WNc,b);this.IH.Mt(c.points);this.H0.em();this.IH.Sd(this.Ab&&(!this.AA||!this.DU));this.kG.Mt(b.points);this.H0.em();this.kG.Sd(this.Ab&&(!this.AA||!this.DU));this.Kx.Mt(a.points);
this.H0.em();this.Kx.Sd(this.Ab&&(!this.AA||!this.DU));z.a.Ecb&&this.ta&&this.ta.xd&&this.jb.eog()&&this.H0.viewport.ah(this.H0.viewport.width,0)}}kmc(){if(this.bcb){var a=this.C5.x,b=this.C5.y;this.jb.yX(this.ta)&&!this.ngc&&(this.C5.setPosition(a,b-18),this.ngc=!0)}}SKe(){if(this.bcb){var a=this.C5.x,b=this.C5.y;this.ngc&&!this.jb.yX(this.ta)&&(this.C5.setPosition(a,b+18),this.ngc=!1)}}kJf(a,b){var c=b.Wj(rd.a.TE),f=b.Wj(rd.a.Zu);c=Oe.a.bN(cd.a.LF(f,c));new cd.a(0,0);let l;new cd.a(0,0);let y;new cd.a(0,
0);new cd.a(0,0);b.rotate(-c);const G=b.points;f=new cd.a(G[0]._x+a,G[0]._y+a);l=new cd.a(G[1]._x-a,G[1]._y+a);y=new cd.a(G[2]._x-a,G[2]._y-a);a=new cd.a(G[3]._x+a,G[3]._y-a);a=new Ce.a(f,l,y,a);a.rotate(c);b.rotate(c);return a}mUl(a){if(a){var b=a.Wj(rd.a.TE),c=a.Wj(rd.a.Zu),f=Oe.a.bN(cd.a.LF(c,b));b=a.Wj(rd.a.TE);c=a.Wj(rd.a.Zu);90<=f&&(b=a.Wj(rd.a.Zu),c=a.Wj(rd.a.iI));180<=f&&(b=a.Wj(rd.a.iI),c=a.Wj(rd.a.jF));270<=f&&(b=a.Wj(rd.a.jF),c=a.Wj(rd.a.TE));f=cd.a.LF(c,b);var l=this.krj(f);a=Math.cos(f)*
l;f=Math.sin(f)*l;l=this.bcb?this.m5/2-1:this.pfb?this.m5/2:this.m5;this.pfb?this.C5.setPosition(c.x-l,c.y-l):this.C5.setPosition(b.x-a,b.y-f-l);this.C5.Sd(this.Ab&&(!this.AA||!this.DU));this.bcb&&(this.ngc=!1,this.kmc())}}krj(a){return(this.bcb?10:15)-Oe.a.bN(a)/6}}Object(m.a)(QP,"ShapePawnView",null,[314]);class RP{H2d(a,b,c,f,l){return new QP(a,b,c,f,l,16)}}Object(m.a)(RP,"ShapePawnViewFactory",null,[208]);class SP extends Sys.EventArgs{constructor(a){super();this.shape=a}}Object(m.a)(SP,"ShapeViewElementPresenceStateChangedEventArgs",
Sys.EventArgs,[]);class TP{constructor(a,b){this.Dg=a;this.ta=this.Dg.shape;this.ta.Hs=!1;this.dBg=new SP(this.ta);this.jj=Object(sa.a)(sF,this.Dg.SBh);this.h4g=b;(this.fFg=w.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.Dg&&(this.Dg.bcb=!0)}Bm(a){this.Dg.Bm(a)}kC(a){this.Dg.kC(a)}Mp(){return this.Dg.Mp()}PL(a){return this.Dg.UAb(a)}Xw(a){this.Dg.Xw(a)}kmc(){this.Dg.kmc()}SKe(){this.Dg.SKe()}dispose(){this.Dg.dispose()}ny(){this.Dg.ny()}ZC(a){return this.Dg.ZC(a)}TA(a){return this.Dg.TA(a)}draw(a,
b){this.Dg.draw(a,b)}get visible(){return this.Dg.visible}set visible(a){this.Dg.visible=a}setPosition(a,b){this.Dg.setPosition(a,b)}Kj(a){this.Dg.Kj(a)}wq(a){this.Dg.wq(a)}Ju(a){this.Dg.Ju(a)}setZIndex(a){this.Dg.setZIndex(a)}JD(a,b){this.Dg.JD(a,b)}setSelection(){}gja(a){a&&(this.lRa(),this.jj.pB(a),this.Dg.kRb(),this.Dg.setVisibility(),ya.a.J(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",a.clientId,this.jj.N_a,this.ta?this.ta.Xm:"null_moniker"))}E0a(a){if(a&&
this.jj){this.jj.uP(a);this.Dg.kRb();var b=this.jj.m9();b&&b.length?ya.a.J(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",a.clientId,this.jj.N_a,this.ta?this.ta.Xm:""):ya.a.J(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",a.clientId,this.ta?this.ta.Xm:"null_moniker");this.Dg.setVisibility();this.GCa()}}yMf(){this.jj.clear();
this.Dg.kRb();this.GCa()}D3e(){this.jj.D3e()}Dzl(){this.jj.d4e()}jea(){this.jj.She()}Ozd(a){a&&this.lRa();this.jj&&(this.jj.PW=a);this.Dg.kRb();this.fFg&&this.jj&&(this.jj.PW?this.jj.EOb(a.clientId,!0):this.jj.zEi());a||this.GCa()}get ujb(){return this.jj}get vhe(){return this.jj.CZc()}get aub(){return this.Dg.aub}set aub(a){this.Dg.aub=a}lRa(){this.ta.Hs||this.vhe||(this.ta.Hs=!0,this.h4g.nnh(this.dBg))}GCa(){this.ta.Hs&&!this.vhe&&(this.ta.Hs=!1,this.h4g.nnh(this.dBg))}}Object(m.a)(TP,"ShapePresenceView",
null,[281,282,283,108]);var SS=d(343);class sA{get name(){return"PowerPointWebEditor.ShapePresence"}Xb(a){a.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").na().oa(()=>new SS.a((b,c)=>{let f=null;const l=Object(sa.a)(117,b.qc(a.resolve("Box4.IPageView").Na));l&&!l.Ml&&(b=a.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").H2d(a.resolve("PowerPointWebEditor.IPptSelectionManager"),(y,G,R)=>Object(sa.a)(205,a.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").wRi(y,
G,R)),b,c,l.nV),f=new TP(b,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),f.Bm(l.nV),l.$ra(f,1),f.visible=l.TQ||l.lo);return f}));a.register(206,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").na().oa(()=>new PP(a.resolve("Common.IPointerInputManager"),a.resolve("Common.IClickInputManager"),a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
a.register(207,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").na().oa(()=>new MP(a.resolve("PowerPoint.IPathManager")));a.register(208,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").na().oa(()=>new RP)}init(){}dispose(){}static main(){n.a.instance.Ac(new sA)}}Object(m.a)(sA,"PPTWebEditorShapePresencePackage",null,[2,3]);class tF{constructor(){this.K=null;this.kY=[new sA]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}Xb(a){this.K=a;for(const b of this.kY)b.Xb(a)}init(){for(const a of this.kY)a.init();
this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").jqg=!0;Jg.a.instance.$b(LP.a.C7d,(new Date).getTime())}dispose(){}static main(){Jg.a.instance.$b(LP.a.D7d,(new Date).getTime());n.a.instance.Ac(new tF)}}Object(m.a)(tF,"PptExtCommonPackage",null,[2,3]);var jw=d(443),uF=d(138);class kw extends jw.a{constructor(){super();this.contextId=this.context=this.numSlides=this.prompt=null;this.H_=Object.assign(new uF.a,{T_:kw.getTypeName(),B_:kw.getBaseTypes()})}static getTypeName(){return"AugLoop_Storyteller_StorytellerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(kw,"StorytellerSignal",jw.a,[]);class TS{}Object(m.a)(TS,"StorytellerDebugParams",null,[]);class US{constructor(){this.colorsModel=this.outlineModel=null}}Object(m.a)(US,"StorytellerSettingParams",null,[]);const ro=new Map;class UP{constructor(a){this.bSe=new Promise((b,c)=>{this.ogl=f=>{r("AugLoopPresentationOutlineSucceeded",new Date);ya.a.J(508909145,817,50,`AugLoopGetPresentationOutlineSucceeded: ${JSON.stringify({events:ro})}`);b(f)};this.Jph=f=>{r("AugLoopPresentationOutlineFailed",
new Date);ya.a.J(508909144,817,50,`AugLoopGetPresentationOutlineFailed: ${JSON.stringify({reason:f,events:ro})}`);c(f)}});this.mlh=new Promise((b,c)=>{this.rgl=f=>{r("AugLoopGetQuestionsSucceeded",new Date);ya.a.J(509118087,817,50,`AugLoopGetQuestionsSucceeded: ${JSON.stringify({events:ro})}`);b(f)};this.yWe=f=>{r("AugLoopGetQuestionsFailed",new Date);ya.a.J(509118086,817,10,`AugLoopGetQuestionsFailed: ${JSON.stringify({reason:f,events:ro})}`);c(f)}});this.Esk=new Promise((b,c)=>{this.ngl=f=>{r("AugLoopGetOutlineSucceeded",
new Date);ya.a.J(509118085,817,50,`AugLoopGetOutlineSucceeded: ${JSON.stringify({events:ro})}`);b(f)};this.Iph=f=>{r("AugLoopGetOutlineFailed",new Date);ya.a.J(509118084,817,10,`AugLoopGetOutlineFailed: ${JSON.stringify({reason:f,events:ro})}`);c(f)}});this.Dsk=new Promise((b,c)=>{this.ggl=f=>{r("AugLoopGetColorsSucceeded",new Date);ya.a.J(509118083,817,50,`AugLoopGetColorsSucceeded: ${JSON.stringify({events:ro})}`);b(f)};this.Hph=f=>{r("AugLoopGetColorsFailed",new Date);ya.a.J(509118082,817,10,`AugLoopGetColorsFailed: ${JSON.stringify({reason:f,
events:ro})}`);c(f)}});this.Fsk=new Promise((b,c)=>{this.ygl=f=>{r("AugLoopGetTemplatesSucceeded",new Date);ya.a.J(509118081,817,50,`AugLoopGetTemplatesSucceeded: ${JSON.stringify({events:ro})}`);b(f)};this.Kph=f=>{r("AugLoopGetTemplatesFailed",new Date);ya.a.J(509118080,817,10,`AugLoopGetTemplatesFailed: ${JSON.stringify({reason:f,events:ro})}`);c(f)}});this.promise=Promise.allSettled([this.Esk,this.Dsk,this.Fsk]);this.xqk=window.setTimeout(()=>{this.Iph(`Timeout outlinePromise after ${a.PUe} ms`)},
a.YOk);this.wjk=window.setTimeout(()=>{this.Hph(`Timeout colorsPromise after ${a.CNf} ms`)},a.CNf);this.Evk=window.setTimeout(()=>{this.Kph(`Timeout templatePromise after ${a.EKh} ms`)},a.EKh);this.Lsk=window.setTimeout(()=>{this.yWe(`Timeout questionsPromise after ${a.PUe} ms`)},a.PUe);this.wsk=window.setTimeout(()=>{this.Jph(`Timeout presentationOutlinePromise after ${a.$jh} ms`)},a.$jh)}}Object(m.a)(UP,"DeferredStorytellerAugLoopPromise",null,[]);class tA{constructor(a,b,c){this.Zwe=new Map;this.Uue=
new Map;this.la=a;this.Ib=b;this.Ms=c;this.Ms.execute(f=>{this.la.ka("StoryTellerShowQuestions")&&(f.kQ("AugLoop_Storyteller_StorytellerQuestionsResponse"),f.B6("AugLoop_Storyteller_StorytellerQuestionsResponse",this.SQ.bind(this)));this.la.ka("StoryTellerUsePresentationOutlineJSON")?(ya.a.J(508908557,817,50,"StorytellerAugLoopManager: activating and registering presentationOutlineAnnotation"),f.kQ("AugLoop_Storyteller_PresentationOutlineResponse"),f.B6("AugLoop_Storyteller_PresentationOutlineResponse",
this.SQ.bind(this))):(f.kQ("AugLoop_Storyteller_StorytellerOutlineResponse"),f.B6("AugLoop_Storyteller_StorytellerOutlineResponse",this.SQ.bind(this)),f.kQ("AugLoop_Storyteller_StorytellerColorsResponse"),f.B6("AugLoop_Storyteller_StorytellerColorsResponse",this.SQ.bind(this)),f.kQ("AugLoop_Storyteller_StorytellerTemplatesResponse"),f.B6("AugLoop_Storyteller_StorytellerTemplatesResponse",this.SQ.bind(this)))})}Dml(a,b,c,f){var l;if(a.contextId){var y=this.la.ka("StoryTellerUsePresentationOutlineJSON"),
G=y&&this.la.ka("StorytellerHubbleEnabled"),R=Object.assign(new kw,Object.assign(Object.assign({},a),{debugParams:{debugMetadataEnabled:this.la.RVa,outlinePromptTemplate:0<(null===(l=this.la.ZHh)||void 0===l?void 0:l.length)?this.la.ZHh:void 0},settingParams:{textToImageEnabled:this.la.ka("StoryTellerEnableTextToImage"),outlineModel:this.Ib.getStringFeatureGate("Microsoft.Office.PowerPointOnline.AugLoop.StorytellerOutlineModel",null),colorsModel:this.Ib.getStringFeatureGate("Microsoft.Office.PowerPointOnline.AugLoop.StorytellerColorsModel",
null),hubbleEnabled:G,hubbleAggregateApiEnabled:G&&this.la.ka("StorytellerHubbleAggregateApiEnabled"),multiLanguageEnabled:this.la.ka("EnableStoryTellerMultiLang")}})),ja=Object.assign(new pA.a,{parentPath:["Signal",kw.getTypeName()],items:[Object.assign(new qA.a,{body:R})]});l=new UP({$jh:this.la.uc("StorytellerPresentationOutlineAnnotationTimeout",3E4),PUe:this.la.uc("StoryTellerQuestionsAnnotationTimeout",1E4),YOk:this.la.uc("StoryTellerOutlineAnnotationTimeout",2E4),CNf:this.la.uc("StoryTellerColorsAnnotationTimeout",
1E4),EKh:this.la.uc("StoryTellerTemplatesAnnotationTimeout",1E4)});this.la.ka("StoryTellerShowQuestions")||l.yWe("ShowStoryTellerQuestions disabled");Promise.allSettled([l.mlh,l.promise]).then(()=>{this.Zwe.delete(a.contextId);this.Uue.delete(a.contextId)});l.bSe.then(za=>tA.tvg(za)?f(za.presentationOutline):(ya.a.J(508909143,817,10,"StorytellerAugLoopManager:sendStorytellerSignal Promise rejected"),f(void 0))).catch(za=>{za=this.la.RVa?"":JSON.stringify(za);ya.a.J(508909142,817,10,`StorytellerAugLoopManager:sendStorytellerSignal presentationOutlinePromise Exception ${za}`)});
l.mlh.then(za=>b(za.questionsResponse)).catch(za=>{za=this.la.RVa?"":JSON.stringify(za);ya.a.J(509214794,817,10,`StorytellerAugLoopManager:sendStorytellerSignal questionsPromise Exception ${za}`)});l.promise.then(([za,Va,hb])=>{var Cb,lc,ic,yc,ec,jc,xd,Xd,Qd,Ie,Pe,ig,ff,bh;if("rejected"==za.status){if(ya.a.J(509195422,817,10,`StorytellerAugLoopManager:sendStorytellerSignal Promise rejected - outline:${za.status}, colors:${Va.status}, templates:${hb.status}`),!y)return c(void 0)}else{const ch={ColorScheme:"fulfilled"==
Va.status?{Accent1:null===(Cb=Va.value.colorPalette)||void 0===Cb?void 0:Cb.accent1,Accent2:null===(lc=Va.value.colorPalette)||void 0===lc?void 0:lc.accent2,Accent3:null===(ic=Va.value.colorPalette)||void 0===ic?void 0:ic.accent3,Accent4:null===(yc=Va.value.colorPalette)||void 0===yc?void 0:yc.accent4,Accent5:null===(ec=Va.value.colorPalette)||void 0===ec?void 0:ec.accent5,Accent6:null===(jc=Va.value.colorPalette)||void 0===jc?void 0:jc.accent6,Hyperlink:null===(xd=Va.value.colorPalette)||void 0===
xd?void 0:xd.hyperlink,ClickedHyperlink:null===(Xd=Va.value.colorPalette)||void 0===Xd?void 0:Xd.clickedHyperlink,LightBackground:null===(Qd=Va.value.colorPalette)||void 0===Qd?void 0:Qd.lightBackground,DarkBackground:null===(Ie=Va.value.colorPalette)||void 0===Ie?void 0:Ie.darkBackground,TextColorLight:null===(Pe=Va.value.colorPalette)||void 0===Pe?void 0:Pe.textColorLight,TextColorDark:null===(ig=Va.value.colorPalette)||void 0===ig?void 0:ig.textColorDark}:{},PresOutline:{Title:null===(ff=za.value.presentation)||
void 0===ff?void 0:ff.title,Slides:null===(bh=za.value.presentation)||void 0===bh?void 0:bh.slides.map(of=>{var sg;return{Title:of.title,Notes:of.notes,KeyPoints:of.keyPoints,ImagesQuery:this.la.ka("StoryTellerEnableHubbleImageSearch")?of.images:void 0,Images:null===(sg=of.imageUrls)||void 0===sg?void 0:sg.map(Fg=>({Url:Fg,Format:""}))}})},ThemeIds:"fulfilled"==hb.status?hb.value.templateIds:void 0};if(!y)return c(ch)}}).catch(za=>{za=this.la.RVa?"":JSON.stringify(za);ya.a.J(509214863,817,10,`StorytellerAugLoopManager:sendStorytellerSignal outlinePromise Exception ${JSON.stringify(za)}`)});
this.Zwe.set(a.contextId,l);this.Uue.set(a.contextId,new Date);this.Ms.execute(za=>{za.submitOperation(ja);r("AugLoopOpSubmitted",new Date)})}else ya.a.J(509214865,817,10,"StorytellerAugLoopManager:sendStorytellerSignal No contextId")}SQ(a){var b;if(a.contextId){var c=this.Zwe.get(a.contextId),f=this.Uue.get(a.contextId);if(c&&f){var l=null!==(b=a.loggableMetadata)&&void 0!==b?b:{};l.annotationType=a.ownerId;l.L2l=(+new Date-+f).toString();ya.a.J(509207583,817,15,`StorytellerAugLoopManager:handleAnnotationEvent ${JSON.stringify(l)}`);
a.debugMetadata&&0<Object.keys(a.debugMetadata).length&&console.log(`Storyteller Debug Info for ${a.ownerId}: ${JSON.stringify(a.debugMetadata)}`);return tA.tvg(a)?this.cuh(!0,a,c):this.cuh(!1,a,c)}ya.a.J(509214861,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No deferredPromise found")}else ya.a.J(509214862,817,10,"StorytellerAugLoopManager:handleAnnotationEvent No contextId")}cuh(a,b,c){switch(b.ownerId){case "StorytellerQuestions":clearTimeout(c.Lsk);a?c.rgl(b):c.yWe(b);break;case "StorytellerOutline":clearTimeout(c.xqk);
a?c.ngl(b):c.Iph(b);break;case "StorytellerColors":clearTimeout(c.wjk);a?c.ggl(b):c.Hph(b);break;case "StorytellerTemplates":clearTimeout(c.Evk);a?c.ygl(b):c.Kph(b);break;case "Storyteller":clearTimeout(c.wsk);a?c.ogl(b):c.Jph(b);break;default:ya.a.J(509214860,817,10,`StorytellerAugLoopManager:resolveOrRejectDeferredPromise Invalid type:${b.ownerId}, resolve:${a}`)}}static tvg(a){if(!a)return ya.a.J(509214859,822,10,"StorytellerAugLoopManager:isValidStorytellerAnnotation annotationItem is undefined."),
!1;const b=null===a||void 0===a?void 0:a.status;if(!b||0!==b.code)return ya.a.J(509214858,817,10,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} error response. status: ${b?JSON.stringify(b):""}`),!1;ya.a.J(509214857,817,15,`StorytellerAugLoopManager:isValidStorytellerAnnotation type:${a.ownerId} is valid.`);return!0}dispose(){}}Object(m.a)(tA,"StorytellerAugLoopManager",null,[]);class Ju extends Sys.EventArgs{constructor(a){super();this.N5i=a}}Object(m.a)(Ju,"QueueShowingPanesEventEventArgs",
Sys.EventArgs,[]);class ny extends Sys.EventArgs{constructor(a){super();this.FPb=a}}Object(m.a)(ny,"StoryTellerEventArgs",Sys.EventArgs,[]);class vF{dEh(){return this.la.ka("StoryTellerWaitForThumbnailRefreshForDismissDialog")}constructor(a,b,c,f,l,y,G,R,ja,za){this.Cgb=5;this.pdd=new Date;this.ive=0;this.WEb=this.k9c=this.rEb=!1;this.Rxa=()=>{this.od.zXe(this.Rxa);this.k9c=!0};this.iLk=()=>{kk.c(ea.a.qhl,!0)};this.onClose=()=>{this.rEb=!0;this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.$d.TLb(new Ju(!1));
this.dEh()&&(this.od.zXe(this.Rxa),this.k9c=!1);Object(qd.a)("StoryTellerToSDXTransition")&&this.zHb.kpd(new ny({query:this.SYa,status:this.WEb?"Cancelled":"NotHandled"}));kk.c(ea.a.jFi,!0)};this.MOe=(Va,hb)=>{kk.c(ea.a.UGl,!0);void 0!=this.SYa&&this.la.ka("StoryTellerShowQuestions")||(this.SYa=Va,this.ive++,this.pdd=new Date,r("PromptSubmitted",this.pdd));if(hb)switch(hb.presentationLength){case "shortLength":this.Cgb=5;break;case "mediumLength":this.Cgb=8;break;case "longLength":this.Cgb=11}this.WEb=
!0;const Cb=oh.a.create().toString();let lc=()=>{},ic=()=>{};const yc=new Promise((ec,jc)=>{lc=(xd,Xd)=>{ya.a.J(509158928,817,15,`Storyteller${Xd}Succeeded: ${JSON.stringify({totalDurationMs:+new Date-+this.pdd,augLoopContextId:Cb,attemptCount:this.ive,presentationLength:this.Cgb,events:ro})}`);"PromptToOutlineFlow"===Xd&&ro.clear();ec(xd)};ic=xd=>{ya.a.J(509158927,817,10,`StorytellerFailed: ${JSON.stringify({reason:xd,totalDurationMs:+new Date-+this.pdd,augLoopContextId:Cb,attemptCount:this.ive,
presentationLength:this.Cgb,events:ro})}`);this.WEb=!1;Object(qd.a)("StoryTellerToSDXTransition")&&this.zHb.kpd(new ny({query:this.SYa,status:"Fail"}));ro.clear();jc(xd)}});(this.la.ka("CopilotTransformEnabled")||this.la.RVa)&&Va.startsWith("http")&&hb.additionalContext&&hb.additionalContext.startsWith("bb")?this.jwk.ESk({fileUrl:Va,length:this.Cgb,correlationId:Cb,contentType:"fileurl",fileType:"docx"},ec=>Object(ii.a)(this,void 0,void 0,function*(){this.Zjh(lc,ic,ec)})):(hb=Object.assign(new kw,
{prompt:this.SYa,numSlides:this.Cgb,context:null===hb||void 0===hb?void 0:hb.additionalContext,contextId:Cb}),this.Uuk.Dml(hb,ec=>Object(ii.a)(this,void 0,void 0,function*(){this.v0k(lc,ic,Va,ec)}),ec=>Object(ii.a)(this,void 0,void 0,function*(){this.TOk(lc,ic,Va,ec)}),ec=>Object(ii.a)(this,void 0,void 0,function*(){this.Zjh(lc,ic,ec)})));return yc};if(!R||!ja)throw Error("Required parameters for StorytellerView are null");this.uU=a;this.Uuk=b;this.jwk=c;this.la=f;this.$d=l;this.od=y;this.zHb=G;this.ih=
R;this.C8c=ja;this.L0g=za;this.C8c.execute(Va=>{Va.X_b(this.rNe)});this.ih.nUd(this.rNe);this.ih.IUd(this.rNe)}rNe(){this.L0g=!1;this.uHe&&this.uHe.n1l()}dispose(){}Gck(){r("LoadDialog",new Date);var a=document.createElement("div");a.style.height="0px";a.style.width="0px";a.style.display="none";document.body.appendChild(a);const b={enableTryAgainButton:this.la.ka("StoryTellerEnableTryAgainButton"),promptCharacterLimit:this.la.uc("StoryTellerPromptCharacterLimit",200),disableBlankInputOnInitialPrompt:this.la.ka("StoryTellerDisableBlankInputOnInitialPrompt"),
disableInputFieldEditOnBlur:this.la.ka("StoryTellerDisableInputFieldEditOnBlur"),enablePromptCharacterLimit:this.la.ka("StoryTellerEnablePromptCharacterLimit"),copilotUXRefresh:this.la.ka("CopilotStartEnableUXRefresh"),ciqEnabled:this.la.ka("StorytellerCiqEnabled")};this.WEb=!1;a=new storytellerDialog.StorytellerDialogManager(a,this.MOe,{settings:b},this.onClose,this.iLk);a.showDialog();this.L0g&&this.la.ka("StorytellerEnableThumbnailEntryPoint")&&(this.G1g=document.getElementById("ppt-slidegrid-copilot-start-anchor-element"))&&
(this.uHe=new storytellerDialog.SkittleManager(this.G1g,a.showDialog()),this.uHe.F2l())}XYl(a,b){return Object(ii.a)(this,void 0,void 0,function*(){function c(l=1E3){return new Promise(y=>{setTimeout(y,l)})}let f=0;for(;!this.k9c&&f<a;)yield c(b),f+=b;this.k9c||ya.a.J(509141907,817,10,`StorytellerView:waitForThumbnailRefresh never received thumbnail refresh event; maxWaitTimeMs: ${a}`);ya.a.J(509141906,817,50,`StorytellerView:waitForThumbnailRefresh finished; currentWaitTimeMs: ${f}`)})}l9k(){this.od.cKc(this.Rxa)}Zjh(a,
b,c){Object(ii.a)(this,void 0,void 0,function*(){try{yield this.bSe(c),this.zHb.Kmh(),this.WEb=!1,Object(qd.a)("StoryTellerToSDXTransition")&&this.zHb.kpd(new ny({query:this.SYa,status:"Success"})),a({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(f){r("PresentationOutlinePromiseFailed",new Date),this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.$d.TLb(new Ju(!1)),b(f)}})}b4i(a){return Object(ii.a)(this,void 0,void 0,function*(){try{return JSON.parse(yield this.uU.applyJOfcCommands(JSON.stringify([{data:a,
name:"CreatePresentationCmd"}]),"","Storyteller")).FSuccess}catch(b){return ya.a.J(508846987,817,10,"StorytellerView::executeStorytellerJOfcCommand error: {0}, commandName: {1}",b,"CreatePresentationCmd"),!1}})}bSe(a){return Object(ii.a)(this,void 0,void 0,function*(){return new Promise((b,c)=>Object(ii.a)(this,void 0,void 0,function*(){if(this.rEb)return ya.a.J(508895438,817,15,"StorytellerView:onSubmit:presentationOutlinePromise User closed StoryTeller dialog before slides generated"),r("UserClosedBeforeSlidesGenerated",
new Date),c("UserClosedBeforeSlidesGenerated");if(!a)return ya.a.J(509195420,817,10,"StorytellerView:onSubmit:presentationOutlinePromise presentationOutlineAnnotation failed"),r("AugLoopGetPresentationOutlineFailed",new Date),c("presentationOutlineAnnotation failed");try{let f=!1;(f=Object(qd.a)("StoryTellerUseSharedJOfcCommandCall")?yield this.b4i(a):yield this.uU.D_f(JSON.stringify(a),"CreatePresentationCmd"))?b():c("JOfcCommand CreatePresentationCmd failed")}catch(f){return ya.a.J(508895437,817,
10,`StorytellerView:onSubmit:presentationOutlinePromise Exception ${f}`),c(`${f}`)}}))})}TOk(a,b,c,f){Object(ii.a)(this,void 0,void 0,function*(){if(this.rEb)return ya.a.J(509118089,817,15,"StorytellerView:onSubmit:outlineCallback User closed StoryTeller dialog before Augloop response"),r("UserClosedBeforeOutlineCallback",new Date),b("UserClosedBeforeOutlineCallback");if(!f)return ya.a.J(508895436,817,10,"StorytellerView:onSubmit:outlineCallback outlineAnnotation failed"),r("AugLoopGetOutlineFailed",
new Date),b("outlineAnnotation failed");if(this.SYa!=c||!this.la.ka("ShowStoryTellerQuestions"))try{const l={ClientName:"StoryTeller",MergeAction:"ReplaceAll"};r("Send2ndOutlineToPPT",new Date);const y=yield this.uU.m$d(f,l);r("Send2ndMergeSlides",new Date);if(this.rEb)return ya.a.J(509118088,817,15,"StorytellerView:onSubmit:outlineCallback User closed StoryTeller dialog before Merge request"),r("UserClosedBeforeMergeOutlineCallback",new Date),b("UserClosedBeforeMergeOutlineCallback");if(!(yield this.uU.lKe(y,
l)))return b("MergeSlidesFailure");this.zHb.Kmh();this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.$d.TLb(new Ju(!1));this.dEh()&&(this.l9k(),yield this.XYl(this.la.uc("StoryTellerDialogDismissTimeoutMs",3E3),this.la.uc("StoryTellerDialogDismissPollIntervalMs",200)));r("2ndMergeSlidesSucceeded",new Date);this.WEb=!1;Object(qd.a)("StoryTellerToSDXTransition")&&this.zHb.kpd(new ny({query:this.SYa,status:"Success"}));return a({prompts:[],fShouldDismiss:!0},"PromptToOutlineFlow")}catch(l){return ya.a.J(509211013,
817,10,`StorytellerView:onSubmit:outlineCallback Exception ${l}`),r("OutlineCallbackFailed",new Date),this.la.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.$d.TLb(new Ju(!1)),b(`${l}`)}})}v0k(a,b,c,f){Object(ii.a)(this,void 0,void 0,function*(){if(!this.la.ka("StoryTellerShowQuestions"))return ya.a.J(509159458,817,10,"StorytellerView:onSubmit:questionsCallback ShowStoryTellerQuestions disabled"),b("ShowStoryTellerQuestions disabled");if(this.rEb)return ya.a.J(509118091,817,15,"StorytellerView:onSubmit:questionsCallback User closed StoryTeller dialog before Augloop response"),
r("UserClosedBeforeQuestionsCallback",new Date),b("UserClosedBeforeQuestionsCallback");if(!f)return ya.a.J(509195421,817,10,"StorytellerView:onSubmit:questionsCallback questionsAnnotation failed"),r("AugLoopGetQuestionsFailed",new Date),b("questionsAnnotation failed");if(this.SYa==c){const l={ColorScheme:{},PresOutline:{Title:void 0,Slides:[{Title:f.slide.title,Notes:f.slide.notes,KeyPoints:f.slide.keyPoints,ImagesQuery:this.la.ka("StoryTellerEnableHubbleImageSearch")?f.slide.images:void 0}]},ThemeIds:void 0};
try{const y={ClientName:"StoryTeller",MergeAction:"ReplaceAll"};r("Send1stOutlineToPPT",new Date);const G=yield this.uU.m$d(l,y);r("Send1stMergeSlides",new Date);if(this.rEb)return ya.a.J(509118090,817,15,"StorytellerView:onSubmit:questionsCallback User closed StoryTeller dialog before Merge request"),r("UserClosedBeforeMergeQuestionsCallback",new Date),b("UserClosedBeforeMergeQuestionsCallback");this.uU.lKe(G,y)}catch(y){return ya.a.J(509211014,817,10,`StorytellerView:onSubmit:questionsCallback Exception ${y}`),
r("QuestionsCallbackFailed",new Date),b(`${y}`)}r("QuestionsCallbackSucceeded",new Date);return a({prompts:f.qList,fShouldDismiss:!1},"PromptToQuestionFlow")}})}}Object(m.a)(vF,"StorytellerView",null,[]);class wF{constructor(){this.va=new Wc.a}Kmh(){var a=new Sys.EventArgs;this.va.raiseEvent("MSS",a)}Iji(a){this.va.addHandler("MSS",a)}qrh(a){this.va.removeHandler("MSS",a)}kpd(a){this.va.raiseEvent("STEC",a)}nki(a){this.va.addHandler("STEC",a)}}Object(m.a)(wF,"StorytellerEventSource",null,[487,488]);
class VP{constructor(a,b,c,f,l){this.$He=[];this.rIg=!1;this.Vbh=()=>{this.F1g.qrh(this.Vbh);this.mHg.DUd(this.leh);this.Mc.CCa(this.RJa)};this.leh=()=>{this.rIg=!0;this.mHg.zrh(this.leh);this.ic.MTa().forEach(y=>{this.$He.push(nc.a.ax(y.sid,y.cid))});setTimeout(()=>{this.Lsh("onTimer")},1E3*this.Ib.uc("StoryTellerReportKeptRateTimerInSeconds",300))};this.RJa=(y,G)=>{this.Mc.oqd(this.RJa);this.rIg?this.Lsh("onSessionEnd"):ya.a.J(509125888,817,15,`StorytellerKeepRateTracker::onBeforeSessionEnd session ended before inbound happen, sessionCloseReason: ${G.iC}`)};
this.Lsh=y=>{let G=0;for(let R of this.$He)this.ic.Qk(R)&&G++;ya.a.J(509125859,817,15,`StorytellerKeepRateTracker::reportKeptSlideCount source:${y}, addedSlideCount:${this.$He.length}, keptSlideCount:${G}`)};this.Ib=a;this.F1g=b;this.mHg=c;this.ic=f;this.Mc=l;this.F1g.Iji(this.Vbh)}}Object(m.a)(VP,"StorytellerKeepRateTracker",null,[]);var VS=d(461);class oy extends jw.a{constructor(){super();this.sourceContent=this.correlationId=null;this.H_=Object.assign(new uF.a,{T_:oy.getTypeName(),B_:oy.getBaseTypes()})}static getTypeName(){return"AugLoop_ContentProcessing_ContentProcessingSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(oy,"ContentProcessingSignal",jw.a,[]);class WS{}Object(m.a)(WS,"ICTEnterpriseSourceContent",null,[]);var xF;(function(a){a.Web="web";a.Pdf="pdf";a.Html="html";a.Mhtml="mhtml";a.FileUrl="fileurl"})(xF||(xF={}));Object(m.b)("ICTDocSources",xF);class XS{constructor(){this.targetLengthInMinutes=0;this.language="en"}}Object(m.a)(XS,"ICTRequestForSegmentationConfig",null,[]);class py extends jw.a{constructor(){super();this.segmentBlobs=this.correlationId=null;this.H_=Object.assign(new uF.a,
{T_:py.getTypeName(),B_:py.getBaseTypes()})}static getTypeName(){return"AugLoop_SegmentToSlide_SegmentToSlideSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(m.a)(py,"SegmentToSlideSignal",jw.a,[]);const WP=(a,b)=>{let c;a?a.correlationId?b!==a.correlationId&&(c=`Annotation correlationId: ${a.correlationId} doesn't match ongoingTransformCorrelationId: ${b}.`):c="Annotation correlationID undefined.":c="Annotation is undefined.";c&&yF(a.ownerId,c);return!0},yF=(a,b)=>{ya.a.J(508859922,
817,b?10:15,`TransformAugLoopManager:isValidTransformAnnotation type:${a} is ${b?"invalid: "+b:"valid"}.`)};class YS{}Object(m.a)(YS,"TransformParams",null,[]);class ZS{}Object(m.a)(ZS,"SegmentToSlideParams",null,[]);class XP{constructor(a,b){this.la=a;this.Ms=b;this.Ms.execute(c=>{c.kQ("AugLoop_ContentProcessing_ContentProcessingAnnotation");c.B6("AugLoop_ContentProcessing_ContentProcessingAnnotation",this.VDj.bind(this));c.kQ("AugLoop_SegmentToSlide_SegmentToSlideAnnotation");c.B6("AugLoop_SegmentToSlide_SegmentToSlideAnnotation",
this.NIj.bind(this))})}ESk(a,b){a.correlationId?(r("BeginTransform",new Date),this.kwk=b,this.cFe=a.correlationId,this.TGl(a)):ya.a.J(508859919,817,10,"StorytellerAugLoopManager:sendStorytellerSignal No correlationId")}TGl(a){a=Object.assign(new oy,{correlationId:a.correlationId,sourceContent:[{contentType:a.contentType,source:"",fileType:a.fileType,url:a.fileUrl}],config:{targetLengthInMinutes:a.length}});const b=Object.assign(new pA.a,{parentPath:["Signal",oy.getTypeName()],items:[Object.assign(new qA.a,
{body:a})]});this.Ms.execute(c=>{const f=this.la.uc("CopilotTransformContentProcessingAnnotationTimeoutMs",1E4);this.iCg=window.setTimeout(()=>{this.I6b(void 0,`ContentProcessing timeout after ${f}MS.`)},f);r("ContentProcessingAugLoopSignalSubmitted",new Date);c.submitOperation(b)})}VDj(a){clearTimeout(this.iCg);r("ContentProcessingAugLoopAnnotationReceived",new Date);var b=this.cFe;var c;b?0<(null===(c=a.errors)||void 0===c?void 0:c.length)?(yF(a.ownerId,`Annotation contains error: ${JSON.stringify(a.errors)}`),
b=!1):b=WP(a,b):(yF(a.ownerId,`Empty ongoingTranformCorrelationId, annotation CorrelationId:${a.correlationId}`),b=!1);if(!b)return this.I6b(void 0,"Invalid content processing annotation");this.YGl({segmentBlobs:a.segmentBlobs,correlationId:a.correlationId})}YGl(a){a=Object.assign(new py,{correlationId:a.correlationId,segmentBlobs:a.segmentBlobs,language:a.language});const b=Object.assign(new pA.a,{parentPath:["Signal",py.getTypeName()],items:[Object.assign(new qA.a,{body:a})]});this.Ms.execute(c=>
{const f=this.la.uc("CopilotTransformSegmentToSlideAnnotationTimeoutMs",2E4);this.M_g=window.setTimeout(()=>{this.I6b(void 0,`SegmentToSlide timeout after ${f}MS.`)},f);r("SegmentToSlideAugLoopSignalSubmitted",new Date);c.submitOperation(b)})}NIj(a){clearTimeout(this.M_g);r("SegmentToSlideAugLoopAnnotationReceived",new Date);if(!WP(a,this.cFe))return this.I6b(void 0,"SegmentToSlide annotation is invalid");let b=[];for(let c=0;c<a.slideResponses.length;c++){const f=a.slideResponses[c];f.error?ya.a.J(508859921,
817,10,`SlideResponse slide ${c} has error. type: ${f.error.errorType}; message: ${f.error.message}`):f.slide&&b.push(f.slide)}return this.I6b({version:"1.0.0",slides:b})}I6b(a,b){r("FinishTransform",new Date);this.cFe="";clearTimeout(this.iCg);clearTimeout(this.M_g);ya.a.J(508859920,817,b?10:50,`TransformAugLoopManager: Transform ${b?"failed due to "+b:"succeeded"}.  ${JSON.stringify({events:ro})}`);return this.kwk(a)}dispose(){}}Object(m.a)(XP,"TransformAugLoopManager",null,[]);class zF{get name(){return"PowerPointWebEditor.Storyteller"}Xb(a){this.K=
a;const b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");a=w.AFrameworkApplication.XE||w.AFrameworkApplication.Vx;const c=b.qJ&&(""==b.Tza||"blank"==b.Tza)&&!a||b.RVa;this.K.register(wF,"PowerPointWebEditor.IStorytellerEventNotifier").as("PowerPointWebEditor.IStorytellerEventListener").na().oa(()=>new wF);this.K.register(vF,"PowerPointWebEditor.StorytellerView").as("PowerPointWebEditor.IStorytellerView").na().oa(()=>new vF(this.K.resolve("PowerPointWebEditor.ICopilotProxy"),new tA(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("Common.IAppSettingsManager"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),new XP(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IStorytellerEventNotifier"),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.Ia("Common.App.HostNotification.EditNotificationEventSource"),c));b.sWa?this.Jxg(b,c):b.ka("CopilotStartLicenseCheckEnabled")&&this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{f.isFeatureEnabled("Copilot",!1).then(l=>{l?this.Jxg(b,c):ya.a.J(508900954,817,50,"PPTWebEditorStorytellerPackage:configure not loading Storyteller script since user is not licensed for Copilot.")})})}Jxg(a,b){!1===a.ka("CopilotStartMasterSwitch")?
ya.a.J(508900953,817,50,"PPTWebEditorStorytellerPackage: not loading Storyteller script since Copilot Start master switch disabled."):b&&(a.ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").TLb(new Ju(!0)),this.loadScript())}loadScript(){r("LoadDialogScript",new Date);Sd.a.get_instance().Vj(7,()=>Object(ii.a)(this,void 0,void 0,function*(){const a=as.a(this.K);yield a("storytellerDialog");a("storytellerDialog").then(()=>{this.K.resolve("PowerPointWebEditor.IStorytellerView").Gck()}).catch(b=>
{ya.a.J(509154954,817,10,`PPTWebEditorStorytellerPackage:loadScript Exception while loading storytellerDialog ${JSON.stringify(b)}`);this.K.resolve("PowerPointWebEditor.IApplicationSettings").ka("StoryTellerRaiseQueueShowingPanesEvent")&&this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier").TLb(new Ju(!1))})}))}init(){this.Wuk=this.K.resolve("PowerPointWebEditor.IStorytellerView");Object(qd.a)("EnableStoryTellerKeepRateTracker")&&new VP(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IStorytellerEventListener"),
VS.a.instance,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"))}dispose(){this.Wuk.dispose()}static main(){n.a.instance.Ac(new zF)}}Object(m.a)(zF,"PPTWebEditorStorytellerPackage",null,[2,3]);var $S=d(554),YP=d(689),ZP=d(218);class AF{get name(){return"Common.App.OAuth.OAuthPackage"}Xb(a){a.register(267,"Common.App.OAuth.IOAuthManager").na().oa(()=>new $S.OAuthManager)}init(){const a=Fb.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.IPl(a)}IPl(a){const b=w.AFrameworkApplication.fa.Ha("FileSource");if(w.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||w.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===b){var c=ZP.OAuthManagerSettings.s3b;if(c&&c.IsEnabled){var f=c.Application,l=ZP.OAuthManagerSettings.authority;if(void 0!==f&&null!==f&&f.length&&void 0!==l&&null!==l&&l.length){var y=YP.a[a.IZ],G=z.a.mz,R=a.mE();try{var ja=new Map;void 0!==ja&&null!==ja?(ja.set("SupportStatus",y),ja.set("Browser",G),ja.set("AuthStrategy",
R)):ja=null}catch(Va){ja=null}Sf.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ja);var za=Cd.a.zj();a.mI("Core",f).then(Va=>{const hb=Math.floor(Cd.a.zj()-za);y=YP.a[a.IZ];G=z.a.mz;R=a.mE();ha.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',hb,Va.IsSuccess,y,Va.ErrorCode,b,G,R);ja&&(ja.set("SupportStatus",y),ja.set("Browser",
G),ja.set("AuthStrategy",R));var Cb=Object.assign(new Ak.a,{durationMs:hb,extendedProperties:ja});if(Va.IsSuccess){if(Sf.Health.instance.recordKpiSuccess("WacCorePFT",Cb),Va="Bearer "+Va.Token,w.AFrameworkApplication.Je.iyc=Va,Cb=c.Endpoint){var lc=Cd.a.zj();w.AFrameworkApplication.Je.Psb(Cb,1,null,{["Authorization"]:Va},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(ic=>{var yc=Math.floor(Cd.a.zj()-lc),ec=null;ic.jo?ic="Canceled":ic.Hm?ic="Faulted":(ec=ic.result,ic=ec.succeeded?
"Completed":"Failed");yc={["TaskResult"]:ic,["BrowserTokenDurationMS"]:hb,["BrowserValidationDurationMS"]:yc};ec&&(yc.HttpStatus=ec.xj.data.Oe,ec.succeeded&&(ec=Nd.a(ec.xj.data.Wd),yc.ServerValidationDurationMS=ec.ElapsedMilliseconds,yc.ServerValidationResult=ec.ValidatedToken,yc.KMSI=ec.KMSI,yc.Scopes=ec.Scopes,yc.TokenExpirationS=Math.floor(parseInt(ec.Expiration)-(new Date).getTime()/1E3)));ha.ULS.sendTraceTag(520632322,3E3,"Completed"===ic?50:15,ta.a.toJSON(yc))})}}else Sf.Health.instance.recordKpiFailure("WacCorePFT",
Va.ErrorCode,!1,!1,Cb)}).catch(Va=>{var hb=Math.floor(Cd.a.zj()-za);hb=Object.assign(new Ak.a,{durationMs:hb,extendedProperties:ja});Sf.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Va.toString(),!1,!1,hb)})}}}}dispose(){}static main(){n.a.instance.Ac(new AF)}}Object(m.a)(AF,"OAuthPackage",null,[2,3]);var $P=d(13);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");Type.registerNamespace("B4OLE");
Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");
Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");
Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");Type.registerNamespace("PowerPointWebEditor.GraphEditor");
Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");Type.registerNamespace("PowerPointWebEditor.PresenterView");
Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartArt");
Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");Type.registerNamespace("PowerPointWebEditor.UndoRedo");
Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.ShapePresence");window.g_hermesExtJS=Date.now();Object($P.c)("Ext");U.main();fa.main();Ue.main();
Xa.main();Pl.main();Dl.main();pl.main();zF.main();pj.main();fk.main();Em.main();Wd.main();$o.main();sj.main();xe.main();ki.main();fn.main();Go.main();qm.main();Uk.main();Type.registerNamespace("Common.App.AccountSwitching");Tj.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");$n.main();Type.registerNamespace("Common");Bt.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");
Nu.main();Type.registerNamespace("Common.App.ImageProcessor");Type.registerNamespace("Common.App.NewAndOpen.Core");n.a.instance.Ac(new Ou);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");cq.main();Ks.main();kv.main();Type.registerNamespace("Common.App.People");Ss.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=gr;xt.main();Type.registerNamespace("Common");n.a.instance.Ac(new EF);Type.registerNamespace("CAUI");Pr.main();
Type.registerNamespace("Common.App.SaveStatus");n.a.instance.Ac(new GF);Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1190).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");qF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",
ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",
promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",isZeroBased:!1,promptQuestion:"We have two questions for you.",
promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"},AddinFlyoutFeedbackSurvey:{campaignId:"327596a8-5cb9-4b12-b62a-b976921fc4ec",commentQuestion:"Please tell us what kind of add-ins would be useful to you.",
isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"Please let us know why you didn\u2019t try any add-ins at this time.",ratingValuesAscending:["Skipped it for now, will take a look later","Need bigger selection of add-ins ","These add-ins aren\u2019t useful to me","Need more info about each add-in","Not interested in add-ins"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We\u2019d love your feedback on the new look for add-ins!"}};
HA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");IA.main();QA.main();SA.main();TA.main();UA.main();VA.main();$A.main();aB.main();iB.main();window.PowerPointEditingJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",
LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",
Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",
LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",
Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",
Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",
Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",
LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",
Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",
Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",
Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",
Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",
Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",
LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",
LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",
LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",
attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",
Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},
{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",
attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},
{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};
KB.main();Type.registerNamespace("Common.App.Insights");n.a.instance.Ac(new uH);Type.registerNamespace("Common.App.Activities");OB.main();Type.registerNamespace("Common.App.ActivityAggregator");TB.main();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=kr;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");UB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");
VB.main();Type.registerNamespace("Common.App.EventsCacheManager");WB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");ZB.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");bC.main();GC.main();KC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");MC.main();Type.registerNamespace("Common.App.VisibilityManagement");
OC.main();Type.registerNamespace("Common.ModernFontPicker");PC.main();QC.main();VC.main();aD.main();dD.main();mD.main();oD.main();tD.main();Iz.main();ND.main();PD.main();QD.main();dE.main();eE.main();fE.main();gE.main();iE.main();qE.main();rE.main();Type.registerNamespace("Common.App.OAuth");AF.main();lF.main();oF.main();rF.main();Type.registerNamespace("Common.App.CollabControls");tF.main();sA.main();Object($P.b)("Ext")},1306:function(K,S,d){K=d(0);var h=d(395),e=d(7),r=d(303),m=d(304);class n{static bij(H){return n.cij(H)}static cij(H){const ra=
document.createElementNS(n.Pbf,"svg");ra.setAttribute("viewBox",String.format(n.cUi,n.QSh,n.PSh));ra.appendChild(n.Gxj(H));return ra}static Gxj(H){const ra=n.QSh/H,ha=2*ra,Ma=n.PSh/2;H=(H-12-8)*ra/2;const Ga=document.createElementNS(n.Pbf,"g");Sys.UI.DomElement.addCssClass(Ga,n.bUi);for(let na=1;3>=na;na++)Ga.appendChild(n.Afj(na,ha,H+(6*na-2)*ra,Ma));return Ga}static Afj(H,ra,ha,Ma){const Ga=document.createElementNS(n.Pbf,"circle");Sys.UI.DomElement.addCssClass(Ga,String.format("{0}-{1}",n.mDi,H));
Ga.setAttribute("cx",String.format("{0}",ha));Ga.setAttribute("cy",String.format("{0}",Ma));Ga.setAttribute("r",String.format("{0}",ra));return Ga}}n.Pbf="http://www.w3.org/2000/svg";n.bUi="prDancingDots";n.mDi="prAnimateCircle";n.cUi="0 0 {0} {1}";n.PSh=40;n.QSh=120;Object(K.a)(n,"ModernPresenceTooltipDancingDots",null,[]);var z=d(27),t=d(185),x=d(79),B=d(67),D=d(141),w=d(227),J=d(99),F=d(47),L=d(3);class M extends r.a{constructor(H,ra){super(H);this.fxf=this.xOa=this.FDd=this.$Z=this.RZ=this.bA=
this.yq=null;this.Cca=ra.get(8,!1);this.Tha=ra.get(6,0);this.Ybi=ra.get(15,!1);this.Yc=ra;this.Shf=0;this.element=H;this.element.className=M.b7b;this.VS=document.createElement("span");this.element.appendChild(this.VS);this.r_h=n.bij(ra.get(6,0));this.rP(ra);this._state=5}o8(H){this.addHandler(m.a.Cw,H)}Woa(H){this.removeHandler(m.a.Cw,H)}get user(){return this.fxf}get state(){return this._state}dispose(){this.element&&(this.yq.Bb(B.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.yq.Bb(B.a.doubleClick,
this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")),this.bA.Bb(B.a.pointerDown,this.element,Object(e.a)(this,this.Aib,"onPointerDown")),this.bA.Bb(B.a.pointerOut,this.element,Object(e.a)(this,this.sG,"onPointerOut")),this.bA.Bb(B.a.pointerOver,this.element,Object(e.a)(this,this.SM,"onPointerOver")),this.RZ.Bb(this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}rP(H){this.yq=H.get(10);this.yq.ub(B.a.click,this.element,Object(e.a)(this,
this.onClick,"onClick"));this.yq.ub(B.a.doubleClick,this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"));this.bA=H.get(9);this.bA.ub(B.a.pointerOver,this.element,Object(e.a)(this,this.SM,"onPointerOver"));this.bA.ub(B.a.pointerOut,this.element,Object(e.a)(this,this.sG,"onPointerOut"));this.bA.ub(B.a.pointerDown,this.element,Object(e.a)(this,this.Aib,"onPointerDown"));this.RZ=H.get(13);this.RZ.ub(this.element,Object(e.a)(this,this.kF,"stopPropagationAndPreventDefaultBehavior"))}hide(H=
null,ra=0,ha=0){this.Ybi&&H?this.VAl(H,ra,ha):(3===this.state&&this.fqh(),this.visible=!1,this._state=5)}VAl(H,ra,ha=0){this.show(H,ra,15,4,void 0,ha)}mEh(H,ra,ha=!1,Ma=!1,Ga=!1,na=0){this.show(H,ra,20,ha?2:Ma?1:0,Ga,na)}rAl(H,ra,ha,Ma=!1,Ga=0){this.show(H,ra,ha+20,3,Ma,Ga)}show(H,ra,ha,Ma=3,Ga=!1,na=0){!H||Ma===this.state&&this.xLj(ra,ha)||(this.Ldi(Ma,Ga,na),this.pB(H,Ma,na),this._state=Ma,4===na||0===na&&!this.Cca?this.element.style.left=ra+"px":this.element.style.right=ra+"px",this.element.style.top=
ha+"px",this.visible=!0)}pB(H,ra,ha){this.fxf=H;J.a.yv(this.VS);w.a.rEi(this.VS);this.VS.id="fly_"+H.clientId;this.VS.style.backgroundColor=H.color;4!==ra?(this.VS.style.height=this.Tha+"px",this.VS.style.lineHeight=this.Tha+"px",w.a.eba(this.VS,"border-radius",this.Tha+"px")):4===ha||0===ha&&!this.Cca?this.VS.style.left="0px":this.VS.style.right="0px";2!==ra&&(4===ra?J.a.Rz(this.VS,""):1===ra?this.VS.appendChild(this.r_h):(this.VS.setAttribute("dir","auto"),ha=F.a.j$f(H.userName,!1),(!H.isAnonymous||
z.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ha||0!==ra?(H=H.userName,0===ra&&(H=ha,w.a.eba(this.VS,"text-align","center")),J.a.Rz(this.VS,H)):(this.$Z||(this.$Z=this.GMi()),this.VS.appendChild(this.$Z),w.a.eba(this.VS,"text-align","start"))))}onClick(H){if(0===this.state)return this.raiseEvent(m.a.Cw,new m.a(1,H)),!0;3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}sG(H){3===this.state&&
this.raiseEvent(m.a.Cw,new m.a(3,H));return!1}SM(H){3!==H.kg&&this.raiseEvent(m.a.Cw,new m.a(2,H));return!1}Aib(H){if(3!==H.kg)return!0;this.raiseEvent(m.a.Cw,new m.a(4,H));return!1}GMi(){const H=document.createElement("img");H.src=t.a.PN("doughperson_white_glyph.svg");H.setAttribute("Unselectable","on");D.a.gS(H,D.a.hf,D.a.qQ);return x.createClusteredImageFromClusterWithImageClass(this.Tha,this.Tha,null,null,M.p$i,"",!1,"",this.element.ownerDocument,H)}Ldi(H,ra=!1,ha=0){if(!this.ebc(this.state)||
!this.ebc(H))switch(Sys.UI.DomElement.removeCssClass(this.element,this.FDd),this.state){case 4:3===H?this.sCa(M.u9d,M.D3f):this.ebc(H)&&this.sCa(M.t9d,M.D3f);break;case 3:4===H?this.sCa(M.w9d,M.C3f):this.ebc(H)&&(ra&&this.fqh(),this.sCa(M.t9d,M.C3f,ra?M.o$i:""));break;case 0:case 1:case 2:4===H?this.sCa(M.w9d,M.v9d):3===H&&(ra&&this.Lei(),this.sCa(M.u9d,M.v9d,ra?M.E3f:"",3===ha?M.r$i:M.q$i));break;default:4===H?this.sCa(M.w9d):3===H?this.sCa(M.u9d):this.ebc(H)&&this.sCa(M.t9d)}}sCa(...H){this.FDd=
H.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.FDd)}Lei(){this.Shf=window.setTimeout(()=>{this.element&&(this.xOa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.xOa),this.element.style.zIndex="2",this.xOa.style.zIndex="1")},300)}fqh(){window.clearTimeout(this.Shf);this.xOa&&(Sys.UI.DomElement.removeCssClass(this.xOa,M.v9d+" "+M.E3f),Sys.UI.DomElement.addCssClass(this.xOa,M.n$i),L.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.xOa.parentNode&&
this.element.parentNode.removeChild(this.xOa)}),w.a.YWe(this.element,"z-index"))}ebc(H){return 0===H||1===H||2===H}xLj(H,ra){const ha=w.a.Boa(this.element.style.top);return w.a.Boa(this.element.style.left)===H&&ha===ra}tYe(H){3===H&&w.a.GW(this.element,"left")?(H=w.a.Boa(this.element.style.left),w.a.YWe(this.element,"left"),this.element.style.right=-1*H+"px"):4===H&&w.a.GW(this.element,"right")&&(H=w.a.Boa(this.element.style.right),w.a.YWe(this.element,"right"),this.element.style.left=-1*H+"px")}}
M.b7b="prModernFlyout UIFont";M.w9d="flyoutIdle";M.u9d="flyoutExpanded";M.t9d="flyoutCollapsed";M.D3f="flyoutFromIdle";M.C3f="flyoutFromExpanded";M.v9d="flyoutFromCollapsed";M.E3f="flyoutStacked";M.o$i="flyoutFromStacked";M.n$i="flyoutFadeOut";M.p$i="cui-img-cont-float cui-img-20by20";M.q$i="flyoutLtrDir";M.r$i="flyoutRtlDir";Object(K.a)(M,"ModernPresenceTooltipFlyoutControl",r.a,[]);class Q{constructor(H,ra,ha=2,Ma=4){this.offsetTop=H;this.offsetLeft=ra;this.LSh=ha;this.$jg=Ma}}Object(K.a)(Q,"FlyoutsPositioningInfo",
null,[]);var C=d(65);class O{constructor(H=!1,ra=!1){this.nl=H;this.gGd=ra}nnj(H,ra,ha,Ma,Ga){const na=Ga.y,wa=Ga.height;var Fa=this.Gej(Ma);const pa=Fa+ra,Ea=H*ha+2*(H-1);ha=null;1===H||this.Rzi(Fa,Ea,na,wa)?H=new Q(0,0,2):(H=this.j9i(pa,Ea,na,wa),H.offsetTop-=Fa);this.gGd?ha=new Q(0,0,void 0,this.nl?4:3):(Ma=this.Fej(Ma,Ga),Fa=Math.max(0,Ga.x),Ga=Ga.width,ra=Ma+ra,this.Szi(Ma,Fa,Ga)?ha=new Q(0,0,void 0,this.nl?3:4):this.Tzi(ra,Fa)&&(ha=new Q(0,0,void 0,this.nl?4:3)),ha||(ha=this.i9i(Ma,ra,Fa,Ga)));
return new Q(H.offsetTop,ha.offsetLeft,H.LSh,ha.$jg)}Gej(H){return C.a.aae(H)}Fej(H,ra){return this.nl?ra.width-C.a.Eej(H):C.a.Z$d(H)}Rzi(H,ra,ha,Ma){return H+ra<=ha+Ma}j9i(H,ra,ha,Ma){let Ga=1,na=Math.max(ha,H-ra);ra>H-ha&&(Ga=2,na=ra<Ma?Ma-ra:ha);return new Q(na,0,Ga)}Szi(H,ra,ha){return H+150<=ra+ha}Tzi(H,ra){return 150<=H-ra}i9i(H,ra,ha,Ma){Ma-ra>=H-ha?H=4:(ra=H,H=3);return new Q(0,ra,void 0,H)}}Object(K.a)(O,"ModernPresenceTooltipPositioner",null,[]);class U{constructor(H,ra,ha,Ma,Ga,na,wa){this.YZ=
H;this._parent=ra;this.bff=ha;this.CYh=Ma;this.L1h=Ga;this.lsb=na;this.Cca=wa;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(H,ra){if(3!==H)if(5!==H&&this.YZ&&this.YZ.length){if(4===H){var ha=this.L1h;var Ma=(this.lsb-ha)/2;this.element.style.height=this.lsb+"px";this.element.style.width=this.lsb+"px";H=w.a.Boa(this.YZ[0].element.style.top);ra=w.a.Boa(this.Cca?this.YZ[0].element.style.right:this.YZ[0].element.style.left)}else ha=
this.bff,Ma=(this.lsb-ha)/2,this.element.style.height=this.lsb+"px",this.element.style.width=this.Zfj()+2*Ma+"px",H=w.a.Boa(this.YZ[this.YZ.length-1].element.style.top),ra=this.fzi(this.YZ[this.YZ.length-1].element,ha,ra);w.a.eba(this.element,"border-radius",this.lsb+"px");this.element.style.top=H-Ma-ha+"px";this.Cca?this.element.style.right=ra-Ma+"px":this.element.style.left=ra-Ma+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&
this.element.parentNode.removeChild(this.element)}fzi(H,ra,ha){return this.Cca&&!ha?w.a.Boa(H.style.right):this.Cca||ha?this.Cca&&ha?-w.a.Boa(H.style.left)-ra:-w.a.Boa(H.style.right)-ra:w.a.Boa(H.style.left)}Zfj(){return this.YZ&&this.YZ.length?this.bff+Math.min(this.YZ.length-1,2)*this.CYh:0}}Object(K.a)(U,"ModernPresenceTooltipTarget",null,[]);var T=d(69),ca=d(121),N=d(199);class da extends r.a{constructor(H,ra,ha){super(H);this.orb=this.Pqa=this.zkf=this.B4a=!1;this.Dh=[];this.wCc={};this.Yc=ha;
this.nl=ha.get(8,!1);this.Ojf=ha.get(15,!1);this.IZh=ha.get(12,0);this.tRa=ha.get(6,0);this.Srb=ra;this.xxf=ha.get(16);this.gGd=ha.get(17,!1);this.M1h=ha.get(19,!1);this.s7h=ha.get(20,!1);this.IDc=0;this.o7h=new O(this.nl,this.gGd);this.vSb=this.c8f();this.hNd=!1;this.wAa=[];this.yVb=[];this.element.id=da.t7b();this.element.className=r.a.E2d(this.nl);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.nl;this.ktc(ra);this.Zha=this.createElement("div");this.Zha.className="prFlyoutContainer";
this.element.appendChild(this.Zha);this.YZ=[];this.KOa=new U(this.KT,this.element,this.tRa,4,6,32,this.nl);this.bA=ha.get(9);this.bA.ub(B.a.pointerDown,this.KOa.element,Object(e.a)(this,this.jJb,"onHitTarget"));this.bA.ub(B.a.pointerOver,this.KOa.element,Object(e.a)(this,this.jJb,"onHitTarget"));this.bA.ub(B.a.pointerOut,this.KOa.element,Object(e.a)(this,this.jJb,"onHitTarget"))}get PKb(){return N.a.clone(this.Dh)}get KT(){return this.YZ}get defaultZIndex(){return this.IZh}get wEa(){return this.KT?
this.KT.length:0}get G2a(){return 0<this.wEa?this.KT[0].state:5}get Toe(){return 3===this.G2a&&!this.B4a}o8(H){this.addHandler(m.a.Cw,H)}Woa(H){this.removeHandler(m.a.Cw,H)}dispose(){if(this.Toe)this.hNd=!0;else{if(this.KT)for(const H of this.KT)H.Woa(Object(e.a)(this,this.GY,"onInteractivityChanged")),ca.a.Wy(H);this.YZ=null;this.bA.Bb(B.a.pointerDown,this.KOa.element,Object(e.a)(this,this.jJb,"onHitTarget"));this.bA.Bb(B.a.pointerOver,this.KOa.element,Object(e.a)(this,this.jJb,"onHitTarget"));this.bA.Bb(B.a.pointerOut,
this.KOa.element,Object(e.a)(this,this.jJb,"onHitTarget"));super.dispose()}}hMa(){this.K8a();this.visible=!0}svd(){this.visible=!0;this.V_f();this.B4a=!0}dMa(){this.svd()}hide(){this.zqh();this.hX();this.KOa.update(this.G2a,this.orb)}pB(H){const ra=this.G2a,ha=this.B4a;H.clientId||(H.clientId=(da.VOa++).toString());if(H.clientId in this.wCc){var Ma=this.zka(H.clientId);if(0<=Ma){Ma=this.Dh[Ma];if(Ma.color===H.color&&Ma.userName===H.userName)return;this.uP(H.clientId)}}this.hide();Ma=new M(this.createElement("div"),
this.Yc);Ma.o8(Object(e.a)(this,this.GY,"onInteractivityChanged"));this.Zha.insertBefore(Ma.element,this.Zha.firstChild);this.wCc[H.clientId]=Ma;Array.add(this.Dh,H);Array.add(this.KT,Ma);this.ERh(ra,ha);this.visible=!0}uP(H){if(this.Toe)Array.add(this.yVb,H);else{var ra=this.G2a,ha=this.B4a;this.hide();this.F0a(H);this.ERh(ra,ha)}}Vhd(H){const ra=this.zka(H);if(!(0>=ra)){var ha=this.Dh[ra];H=this.wCc[H];Array.removeAt(this.Dh,ra);Array.insert(this.Dh,0,ha);Array.removeAt(this.KT,ra);Array.insert(this.KT,
0,H);this.Zha.removeChild(H.element);this.Zha.appendChild(H.element);this.K8a()}}ERh(H,ra){0>=this.Dh.length?this.hide():3===H&&ra?this.svd():this.hMa()}EOb(H,ra){ra?this.udi(H):this.Rph(H)}xSc(H){if(this.Toe&&this.M1h)return!1;H=da.E8b(H);if(this.Zha!==H&&J.a.NVa(this.Zha,H))return!0;for(const ra of this.KT)if(J.a.NVa(ra.element,H))return!0;return!1}position(H,ra){this.element.style.top=ra+"px";this.element.style.left=H+"px"}K8a(H=!1){if(!H||this.Pqa){this.zkf&&this.EAh(!0);var ra=Math.min(3,this.wEa)-
1;H=0;var ha=1,Ma=0;this.orb&&(H=this.vSb,ha=-1,Ma=-this.tRa);for(let Ga=this.wEa-1;Ga>ra;Ga--)this.KT[Ga].mEh(this.Dh[Ga],-4*ra*ha+Ma,!0,!1,!0,H);for(;0<=ra;ra--)this.KT[ra].mEh(this.Dh[ra],-4*ra*ha+Ma,0<ra,Array.contains(this.wAa,this.Dh[ra].clientId),ra!==this.IDc,H);this.IDc=0;this.KOa.update(0,this.orb);this.zIndex=this.defaultZIndex;this.B4a=!1;this.zqh(0);this.hNd&&this.dispose()}}V_f(){this.zkf&&this.EAh(!1);this.zIndex=this.defaultZIndex+1;let H,ra,ha;({offsetX:ra,offsetY:H,Zjg:ha}=this.Eql());
for(let Ma=0;Ma<this.wEa;Ma++)this.KT[Ma].rAl(this.Dh[Ma],ra,H+(this.tRa+2)*Ma,Ma!==this.IDc,ha)}hX(){let H=0,ra=0;this.orb&&(H=this.vSb,ra=-6);for(let ha=0;ha<this.wEa;ha++)this.KT[ha].hide(this.Dh[ha],ra,H);this.zIndex=this.defaultZIndex;this.visible=this.B4a=!1;this.hNd&&this.dispose()}U_d(H=0){H?(this.Pqa=!0,L.Task.delay(H).continueWith(()=>{this.Ojf?this.EMj():this.K8a(!0);this.Pqa=!1})):this.Ojf?this.hide():this.K8a()}EMj(){this.Pqa&&this.hide()}Ssi(){if(z.AFrameworkApplication.Aa&&z.AFrameworkApplication.Aa.mb.Q9&&
T.c()){const H=appChrome.selectors.getShyState();return H.isActive&&0!==H.state}return!1}GY(H,ra){H=this.G2a;this.Ssi()||2!==ra.type&&(4!==ra.type||3===H)?4===ra.type&&3===H?(this.Pqa&&(this.Pqa=!1),this.U_d()):3!==ra.type||3!==H||this.B4a||(1<this.wEa?(this.Pqa=!0,L.Task.delay(250).continueWith(()=>{this.K8a(!0);this.Pqa=!1})):this.U_d()):(this.Pqa&&(this.Pqa=!1),3!==H&&(this.V_f(),3===ra.Fj.kg&&this.U_d(2E3)));this.raiseEvent(m.a.Cw,ra)}jJb(H){3===H.kg?this.GY(this,new m.a(4,H)):H.eventName===B.a.pointerOver?
this.GY(this,new m.a(2,H)):H.eventName===B.a.pointerOut&&this.GY(this,new m.a(3,H));return!1}ktc(H){this.element.style.width=H+"px";this.element.style.height=this.tRa+"px"}F0a(H){this.Rph(H);H=this.zka(H);if(!(0>H)){var ra=this.Dh[H];Array.removeAt(this.Dh,H);delete this.wCc[ra.clientId];ra=this.KT[H];this.Zha.removeChild(ra.element);this.Yc.get(18,!1)&&ra.Woa(Object(e.a)(this,this.GY,"onInteractivityChanged"));Array.removeAt(this.KT,H);ra.dispose()}}zqh(H=5){if(this.yVb.length){this.visible&&this.hX();
for(let ra=0;ra<this.yVb.length;ra++)this.F0a(this.yVb[ra]);Array.clear(this.yVb);0>=this.Dh.length||5===H?this.hide():0===H&&this.hMa()}}zka(H){for(let ra=0;ra<this.Dh.length;ra++)if(this.Dh[ra].clientId===H)return ra;return-1}udi(H){if(-1===this.zka(H))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.wAa,H)){if(this.Dh[0].clientId===H)return;Array.remove(this.wAa,H)}Array.add(this.wAa,H);this.Vhd(H);1!==this.G2a&&this.K8a()}}Rph(H){-1===
this.zka(H)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.wAa,H)&&(Array.remove(this.wAa,H),this.Dh[0].clientId===H&&0<this.wAa.length&&this.Vhd(this.wAa[this.wAa.length-1]),this.Dh[0].clientId===H&&1===this.G2a&&this.K8a())}EAh(H){H?Sys.UI.DomElement.addCssClass(this.Zha,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Zha,"prBackgroundSelection")}Eql(){let H,ra;ra=H=0;var ha=this.vSb;if(this.xxf){const Ma=this.xxf(this);
if(!Ma)return{offsetX:H,offsetY:ra,Zjg:ha};const Ga=4===this.G2a;ha=this.o7h.nnj(this.wEa,Ga?6:this.tRa,this.tRa,this.element,Ma);ra=ha.offsetTop;this.IDc=this.smj(ha.LSh,ha.offsetTop);ha=ha.$jg;ha!==this.vSb&&(this.tYe(ha),this.element.dir=3===ha?"rtl":"ltr",this.vSb=ha);ha!==this.c8f()?(H=this.s7h?-2:Ga?-6:-this.tRa,this.orb=!0):this.orb=!1}return{offsetX:H,offsetY:ra,Zjg:ha}}smj(H,ra){if(1===H)return this.wEa-1;H=Math.abs(ra);return 0<H?H/(this.tRa+2):0}tYe(H){for(let ra=0;ra<this.wEa;ra++)this.KT[ra].tYe(H)}c8f(){return this.nl?
3:4}static t7b(){return String.format("{0}-{1}","presencetooltip",da.VOa++)}static E8b(H){return H.nc.rawEvent.relatedTarget}}da.VOa=0;Object(K.a)(da,"ModernPresenceTooltipControl",r.a,[623,108]);var Y=d(240),fa=d(318),aa=d(282);d.d(S,"a",function(){return ka});class ka{constructor(H){this.Yc=H;this.Yc.o_(10,Y.a.instance);this.Yc.o_(9,aa.a.instance);this.Yc.o_(6,20);this.Yc.o_(13,fa.a.instance);this.Yc.o_(17,!1)}U1d(H,ra){this.Yc.o_(15,!1);return new da(H,ra,this.Yc)}C3b(H){this.Yc.o_(15,!1);return new da(H,
20,this.Yc)}}Object(K.a)(ka,"ModernPresenceTooltipFactory",null,[602])},1314:function(K,S,d){K=d(0);class h{constructor(r,m,n,z){this.aZh=r;this.S8h=m;this.R8h=n;this.T8h=z}get IKi(){return this.aZh}get ghl(){return this.S8h}get dhl(){return this.R8h}get resultType(){return this.T8h}}Object(K.a)(h,"SearchContext",null,[679]);d.d(S,"a",function(){return e});class e{nRi(r,m,n){var z=n-m;let t;if(100<=z)z=m,t=n;else{z=Math.max(0,m+Math.ceil(z/2)-50);t=Math.min(r.length,z+100);z=Math.max(0,t-100);let B;
if(z&&" "!==r.charAt(z-1)){B=Math.min(m,z+10);for(var x=z;x<B;++x)if(" "===r.charAt(x)){z=x+1;break}}if(t!==r.length&&" "!==r.charAt(t))for(B=Math.max(n,t-10),x=t-1;x>=B;--x)if(" "===r.charAt(x)){t=x;break}}return new h(r.substring(z,t),m-z,n-z,"")}}Object(K.a)(e,"SearchContextFactory",null,[634])},1315:function(K,S,d){K=d(0);var h;(function(r){r[r.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";r[r.peopleImageClassName=1]="peopleImageClassName";r[r.peopleImageClusterPath=4]="peopleImageClusterPath";
r[r.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";r[r.imageDimension=6]="imageDimension";r[r.rtl=8]="rtl";r[r.pointerInputManager=9]="pointerInputManager";r[r.clickInputManager=10]="clickInputManager";r[r.vertical=11]="vertical";r[r.zIndex=12]="zIndex";r[r.contextMenuInputManager=13]="contextMenuInputManager";r[r.imageDomElement=14]="imageDomElement";r[r.useIdleTooltip=15]="useIdleTooltip";r[r.viewportBoundsCallback=16]="viewportBoundsCallback";r[r.flipHorizontalDirection=17]=
"flipHorizontalDirection";r[r.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";r[r.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";r[r.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||(h={}));Object(K.b)("PresenceTooltipSettingKeys",h);d.d(S,"a",function(){return e});class e{constructor(){this.V2={}}get(r,m=null){r=h[r];return"number"===typeof m?(m=this.V2[r])?Number.parseInvariant(m.toString()):0:this.V2[r]}add(r,m){this.V2[h[r]]=m}o_(r,m){h[r]in this.V2||(this.V2[h[r]]=
m)}remove(r){delete this.V2[h[r]]}}Object(K.a)(e,"PresenceTooltipSettings",null,[])},155:function(K,S,d){d.d(S,"a",function(){return e});d.d(S,"b",function(){return r});var h=d(43);const e=(m,n,z)=>{m=h.a.Jj(m);m.Wa("CommandId",n.toString());try{return z()}finally{m.finish(!0)}},r=(m,n,z,t)=>e(m+n,z,t)},201:function(K,S,d){d.d(S,"a",function(){return m});K=d(0);var h=d(27),e=d(1164),r=d(47);class m{static f9f(){return m.Wli+"_"+e.a.D$b+"_"+r.a.nL(h.AFrameworkApplication.userName)+"_"}static PUc(n){return n+
"_"+e.a.D$b+"_"+r.a.nL(h.AFrameworkApplication.userName)+"_"}static Ibg(){return m.cYk+"_"+e.a.D$b+"_"+r.a.nL(h.AFrameworkApplication.userName)+"_"}}m.bsa="ack0";m.csa="ack1";m.gKc="ack2";m.Wli="ack3";m.LBf="ack4";m.MBf="ack7";m.Hwg="ack8";m.lEh="ack9";m.iXd="ack10";m.jEh="ack13";m.etb="AddinDetailsRefreshed";m.Uli="DdaMethod";m.Tli="ControlId";m.mKc="SecurityOrigin";m.F7a="ak0";m.UUd="ak1";m.WUd="ak2";m.jKc="ak4";m.KBf="Office.AutoShowTaskpaneWithDocument";m.TUd="refreshRequired";m.NBf="value";m.$li=
"errorCode";m.W5d="SolutionId";m.U5d="MethodData";m.V5d="DynamicAddinCommandsMethodDispatchId";m.y_i="SourceControlId";m.w_i="OsfControl";m.x_i="RibbonUpdaterData";m.Axd="AddinShared";m.cYk="__OSF_PRIVATECATALOG_ADDINIDS";Object(K.a)(m,"AddinConstantsString",null,[])},238:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.uKc="AfterValidate";h.autoCorrect="AutoCorrect";h.gsi="BeforeValidate";h.WTi="CutAction";h.R_i="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";
h.U8i="FinishingSelectionValidation";h.$Oj="ImeTypingEnd";h.bPj="ImeTypingStart";h.FVj="IpMode";h.Ay="KeyPress";h.Df="KeyDown";h.NCk="NotFinishingSelectionValidation";h.oPk="OvertypeEnd";h.qPk="OvertypeStart";h.tPk="PaddingChanged";h.wgh="ParagraphContentUpdated";h.CRk="PasteAction";h.Yql="SetMode";h.typingProcess="TypingProcess";h.SEi="ClipboardModeBegin";h.TEi="ClipboardModeEnd";Object(K.a)(h,"EditEventKeys",null,[])},249:function(K,S,d){d.r(S);var h;(function(ha){ha[ha.Undefined=0]="Undefined";
ha[ha.Created=10]="Created";ha[ha.Sent=20]="Sent";ha[ha.Duplicated=30]="Duplicated";ha[ha.Seen=40]="Seen";ha[ha.Tried=50]="Tried";ha[ha.Kept=60]="Kept";ha[ha.Rejected=70]="Rejected"})(h||(h={}));var e;(function(ha){ha[ha.None=0]="None";ha[ha.Added=1]="Added";ha[ha.Updated=2]="Updated";ha[ha.Deleted=3]="Deleted"})(e||(e={}));var r;(function(ha){ha[ha.ContentChanged=0]="ContentChanged";ha[ha.ContentWasEmpty=1]="ContentWasEmpty";ha[ha.FormattingChanged=2]="FormattingChanged";ha[ha.ContentWasInsideOfTheTable=
3]="ContentWasInsideOfTheTable"})(r||(r={}));var m;(function(ha){ha[ha.None=0]="None";ha[ha.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";ha[ha.AlCodedLocation=2]="AlCodedLocation"})(m||(m={}));var n;(function(ha){ha[ha.NewDocument=0]="NewDocument";ha[ha.EditDocument=1]="EditDocument";ha[ha.ViewOnlyDocument=2]="ViewOnlyDocument"})(n||(n={}));class z{}z.lowerIndexBound=1;z.maxNumberOfRows=1048576;z.maxNumberOfColumns=16384;z.firstColumnName="A";z.lastColumnName="XFD";var t=d(336);class x{constructor(ha){t.a.assign(x,
this,ha)}get metadata(){return this.M_}set metadata(ha){this.M_=ha}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class B{constructor(ha){t.a.assign(B,this,ha)}get metadata(){return this.M_}set metadata(ha){this.M_=ha}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,
[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(ha){t.a.assign(D,this,ha)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class w{constructor(ha){t.a.assign(w,this,ha)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,
[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};var J=d(985);class F{constructor(ha){t.a.assign(F,this,ha)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class L{constructor(ha){t.a.assign(L,this,ha)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,
[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class M{constructor(ha){t.a.assign(M,this,ha)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class Q{constructor(ha){t.a.assign(Q,this,ha)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[Q.getTypeName()])}}
Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class C{constructor(ha){t.a.assign(C,this,ha)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class O{constructor(ha){t.a.assign(O,this,ha)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[O.getTypeName()])}}
O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class U{constructor(ha){t.a.assign(U,this,ha)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class T{constructor(ha){t.a.assign(T,this,ha)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[T.getTypeName()])}}
T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class ca{constructor(ha){t.a.assign(ca,this,ha)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[ca.getTypeName()])}}ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};class N{constructor(ha){t.a.assign(N,this,ha)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[N.getTypeName()])}}
N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class da{constructor(ha){t.a.assign(da,this,ha)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[da.getTypeName()])}}da.H_={T_:da.getTypeName(),B_:da.getBaseTypes()};class Y{constructor(ha){t.a.assign(Y,this,ha)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[Y.getTypeName()])}}
Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class fa{constructor(ha){t.a.assign(fa,this,ha)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[fa.getTypeName()])}}fa.H_={T_:fa.getTypeName(),B_:fa.getBaseTypes()};class aa{constructor(ha){t.a.assign(aa,this,ha)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,
[aa.getTypeName()])}}aa.H_={T_:aa.getTypeName(),B_:aa.getBaseTypes()};class ka{constructor(ha){t.a.assign(ka,this,ha)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[ka.getTypeName()])}}ka.H_={T_:ka.getTypeName(),B_:ka.getBaseTypes()};class H{constructor(ha){t.a.assign(H,this,ha)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(ha){return t.a.matchesTypesFor(ha,
[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class ra{constructor(ha){t.a.assign(ra,this,ha)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(ha){return t.a.matchesTypesFor(ha,[ra.getTypeName()])}}ra.H_={T_:ra.getTypeName(),B_:ra.getBaseTypes()};d.d(S,"AnnotationState",function(){return h});d.d(S,"ItemOperation",function(){return e});d.d(S,"ItemChanges",function(){return r});d.d(S,"BlobRefType",
function(){return m});d.d(S,"OpenType",function(){return n});d.d(S,"GridConstants",function(){return z});d.d(S,"Annotation",function(){return x});d.d(S,"BinaryClassificationAnnotation",function(){return B});d.d(S,"Event",function(){return D});d.d(S,"UserCommand",function(){return w});d.d(S,"ItemDelta",function(){return J.f});d.d(S,"ItemChangesDelta",function(){return J.e});d.d(S,"Operation",function(){return J.i});d.d(S,"OperationWithSiblingContext",function(){return J.j});d.d(S,"AddOperation",function(){return J.a});
d.d(S,"MoveOperation",function(){return J.h});d.d(S,"UpdateAnnotationMetaDataOperation",function(){return J.m});d.d(S,"UpdateOperation",function(){return J.n});d.d(S,"DeleteOperation",function(){return J.b});d.d(S,"PurgeOperation",function(){return J.k});d.d(S,"FocusOperation",function(){return J.d});d.d(S,"VisibilityOperation",function(){return J.o});d.d(S,"DeltaUpdateOperation",function(){return J.c});d.d(S,"MicroSyncOperation",function(){return J.g});d.d(S,"SignalOperation",function(){return J.l});
d.d(S,"SchemaObject",function(){return t.a});d.d(S,"Signal",function(){return F});d.d(S,"DirtyAreaSignal",function(){return L});d.d(S,"Blob",function(){return M});d.d(S,"Binary",function(){return Q});d.d(S,"TileGroup",function(){return C});d.d(S,"Session",function(){return O});d.d(S,"Document",function(){return U});d.d(S,"SubDocument",function(){return T});d.d(S,"GridCell",function(){return ca});d.d(S,"GridNeighborhoodContext",function(){return N});d.d(S,"ItemFilter",function(){return da});d.d(S,
"DynamicContext",function(){return Y});d.d(S,"ContextHolder",function(){return fa});d.d(S,"UserContextHolder",function(){return aa});d.d(S,"TenantContextHolder",function(){return ka});d.d(S,"EventsHolder",function(){return H});d.d(S,"UserCommandsHolder",function(){return ra})},252:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=d(55),r=d(27),m=d(47),n=d(591),z=d(1261),t=d(18);d(1253);var x=d(1039),B=d(29),D=d(75),w=d(123),J=d(34),F=d(42),L=d(38),M=d(76),Q=d(54),C=d(74),O=d(60),U=d(88);d(425);var T=d(51),
ca=d(427);class N{constructor(aa,ka,H,ra,ha){this.RMd=aa;this.Zai=H;this.Yai=ka;this.E0h=ra;this.b6h=ha}Bjl(aa,ka){ka.Cjl(aa,this.RMd,this.Yai,this.Zai,this.E0h,this.b6h)}}Object(K.a)(N,"MathPropertyObject",null,[]);var da=d(32),Y=d(109);d.d(S,"Box4PasteSteward",function(){return fa});class fa extends x.a{constructor(aa,ka,H,ra,ha,Ma,Ga,na=null,wa=null){super(aa,Ga,na,wa);this.Ao=this.b3=null;this.Kqa=!1;this.N4a=null;this.Upb=-1;this.F5a=0;this.WQd=new t.a;Y.a(4223754,307,O.OutlineElementReader.hh(aa));
this.R4a=ka;this.R4a.Ytb(this);this.FF=H;this.FF.Ytb(this);this.NHd=ra;this.lp=ha;this.R4h=Ma;this.cNd=M.ListReader.Hk(this.zb);fa.qSj();fa.eSj();fa.VSj()}get y9(){return this.b3||(this.b3=e.a.instance.rb("Box4.IInternalLinkManager"))}get oSa(){return this.Ao}get V8a(){return this.cNd&&!this.FF.uda}get j9a(){return 0<this.F5a}get Jv(){return this.NHd}get kq(){return this.lp}get k6c(){return this.R4h}get uti(){return!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();
this.Ao=this.Oae(!1)}JVd(aa){Y.a(4223762,307,O.OutlineElementReader.hh(this.zb)||C.OutlineReader.pu(this.zb));this.vIb(!1);var ka=new da.GraphIterator;ka.Tc(this.zb);aa=x.a.Xh.pda(this.zb,this.kUa(aa));this.WKc(ka,!1);Y.a(4223763,307,aa===this.zb.currentNode);Y.a(4223764,307,J.ParagraphReader.fe(aa));-1!==this.Ao.vE&&fa.paragraphEditor.pK(aa,this.Ao.vE);if(fa.paragraphEditor.Jv&&!this.KZ.LDh){if(this.Ao.textIndent){let ha;({unit:ra,returnValue:ha}=fa.Wld(this.Ao.textIndent));var H=!1;if(ha||!M.ListReader.d$a){0>
ha&&(H=!0,ha*=-1);var ra=fa.l1d(ha,ra);H||fa.paragraphEditor.Jv.slb(aa,ra)}}!this.Ao.marginLeft||fa.hM.A3c||M.ListReader.Hk(ka)||({unit:ka,returnValue:H}=fa.Wld(this.Ao.marginLeft),ka=fa.l1d(H,ka),fa.paragraphEditor.Jv.ztd(aa,1,ka))}(fa.Xf.gg&&fa.Xf.nz||L.a.instance.ga(45)&&B.App.eE.MQb)&&aa.setValue(F.a.Vbc,!0);this.Ao.lineSpacing&&fa.paragraphEditor.f2(aa,this.Ao.lineSpacing);this.Ao.paragraph=aa;this.Kqa=!0}WKc(aa,ka){Y.a(8128518,307,!ka);this.ZM&&!L.a.instance.ga(76)&&(0<this.ZM&&this.Jv.xQc(aa,
this.ZM),0>this.ZM&&this.Jv.Ajb(aa,this.ZM,0));L.a.instance.ga(29)&&(this.zb.Tc(aa),Q.OutlineElementNavigator.yi(this.zb));!this.V8a||2===B.App.mode&&this.k6c.Ypc?aa&&this.kq.S0e(aa,this.j9a):this.kq.eAh(aa);this.ZM=0}cyd(aa){this.WQd.add(aa)}m_d(){this.ZM=0}E1(aa,ka=null){Y.a(4223772,307,J.ParagraphReader.vl(this.zb));const H=this.zb.currentNode;this.Ao.r9e(H);if(!this.KZ.E9e(ka)){r.AFrameworkApplication.uk("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");var ra=H.Sa.last,
ha=T.a.eSa(H),Ma=!1;this.Kqa&&(ra.formatting=this.Ao.y$a.ge(ra),L.a.instance.ga(57)&&H.nv(),this.Kqa=!1,Ma=!0);aa=this.KZ.Hge(aa,ka);this.KZ.spa(this.zb.currentNode,this.Ao.qga,ka);this.characterPropertiesEditor.replaceTextRange(ha,aa);this.uti&&Ma&&(aa=H.Vwb(ha.Ra),aa.formatting=this.Ao.y$a.ge(aa));L.a.instance.ga(2)}}roa(aa){this.KZ.l3c&&this.KZ.n2c(aa)?(this.PA(),this.QA(aa)):(Y.a(4223773,307,J.ParagraphReader.vl(this.zb)),aa=T.a.eSa(this.zb.currentNode),this.characterPropertiesEditor.a0c(aa,ka=>
new ca.a(ka,ca.a.gQc),D.AParagraphNode.L_))}C_a(){}qoa(aa){this.R4a.qoa(aa)}poa(aa){this.Ao=aa;this.Kqa=!0}Exa(aa){Y.a(4223774,307,J.ParagraphReader.vl(this.zb));Y.a(4223775,307,!this.N4a);Y.a(4223776,307,0>this.Upb);this.N4a=aa;this.Upb=J.ParagraphReader.textLength(this.zb.currentNode)}Dxa(){Y.a(4223777,307,J.ParagraphReader.vl(this.zb));Y.a(4223778,307,!!this.N4a);Y.a(4223779,307,0<=this.Upb);let aa=T.a.createTextRange(this.zb.currentNode,this.Upb,J.ParagraphReader.textLength(this.zb.currentNode)),
ka="",H="";this.y9&&({Lph:ka,Daj:H}=this.y9.QMh(w.HyperlinkReader.$Ea(this.N4a),!0)).returnValue&&(this.N4a=ka,H&&(this.characterPropertiesEditor.replaceTextRange(aa,H),aa=T.a.createTextRange(this.zb.currentNode,this.Upb,J.ParagraphReader.textLength(this.zb.currentNode))));fa.hyperlinkEditor.Vja(aa,this.N4a,!1);this.Kqa=!0;this.N4a=null;this.Upb=-1}QA(aa){this.JVd(aa);this.Ao.ryd(this.zb.currentNode);aa&&"P"===aa.ZU.J$b&&fa.paragraphEditor.TLa(this.zb.currentNode,this.Ao.Mld);this.KZ.spa(this.zb.currentNode,
this.Ao.qga,aa,this.Ao.marginLeft,this.Ao.textIndent)}PA(){Y.a(4223808,307,J.ParagraphReader.vl(this.zb));fa.hyperlinkEditor.a2i(this.zb.currentNode);Q.OutlineElementNavigator.Se(this.zb)}x_a(){}w_a(){}Jxa(){}ZJa(){}uoa(){Y.a(4223809,307,O.OutlineElementReader.hh(this.zb)||C.OutlineReader.pu(this.zb));let aa=!1;this.j9a||(aa=this.V8a||!0);aa||(this.ZM+=1);this.F5a++}soa(){this.F5a--;let aa=!1;this.j9a||(aa=this.V8a||!0);aa||--this.ZM}Ixa(aa){Y.a(4223810,307,O.OutlineElementReader.hh(this.zb)||C.OutlineReader.pu(this.zb));
Y.a(4223811,307,0!==aa.listStyleType);this.kq.fOb(this.cck(aa))}toa(){Y.a(4223813,307,O.OutlineElementReader.hh(this.zb));r.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(fa.hM.A3c&&M.ListReader.Hk(this.zb)){const aa=J.ParagraphReader.tyb(this.zb.currentNode),ka=this.k6c.R$f(this.zb);this.kq.Dtd(ka,aa,null)}}y_a(aa){this.R4a.y_a(aa)}NY(aa){this.FF.NY(aa)}KY(){this.FF.KY()}MY(aa){this.FF.MY(aa)}LY(){this.FF.LY()}JY(aa){this.FF.JY(aa)}IY(){this.FF.IY()}static get paragraphEditor(){return fa.qx||
(fa.qx=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return fa.Mn||(fa.Mn=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Xf(){return fa.hd||(fa.hd=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get RPb(){return fa.Svf}static get hM(){return fa.XK||(fa.XK=e.a.instance.rb("Box4.List.ListSettings"))}static qSj(){const aa=L.a.instance.ga(61);fa.hKa[1]=aa?U.StyleReader.KAd:U.StyleReader.HPb;fa.hKa[2]=aa?U.StyleReader.LAd:U.StyleReader.IPb;
fa.hKa[3]=aa?U.StyleReader.MAd:U.StyleReader.JPb;fa.hKa[4]=aa?U.StyleReader.NAd:U.StyleReader.KPb;fa.hKa[5]=aa?U.StyleReader.OAd:U.StyleReader.LPb;fa.hKa[6]=aa?U.StyleReader.PAd:U.StyleReader.MPb;fa.hKa[7]=aa?null:U.StyleReader.pvc}static eSj(){fa.Kea.unspecified=0;fa.Kea.defaultUnordered=1;fa.Kea.defaultOrdered=1;fa.Kea.none=0;fa.Kea.disc=1;fa.Kea.circle=2;fa.Kea.square=3;fa.Kea.decimal=1;fa.Kea.lowerAlpha=2;fa.Kea.lowerRoman=3;fa.Kea.upperAlpha=4;fa.Kea.upperRoman=5}static VSj(){fa.Svf=U.StyleReader.kzb()}static X8a(aa){return m.a.substring(aa,
4,6)+m.a.substring(aa,2,4)+m.a.substring(aa,0,2)}static Wld(aa){let ka,H;ka=0;const ra=aa.length;H=parseFloat(m.a.substring(aa,0,ra-2));aa=m.a.substr(aa,ra-2,2);switch(aa){case "in":ka=3;break;case "px":ka=7;break;case "cm":ka=1;break;case "pt":ka=5;break;default:h.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",aa),H=0}return{returnValue:H,unit:ka}}static l1d(aa,ka){let H=0;switch(ka){case 3:H=n.a.yua(aa);break;case 7:H=
z.a.tga(aa,0);break;case 1:H=n.a.wZd(aa);break;case 5:H=n.a.yua(n.a.Mmd(aa));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",aa,ka)}return H}}fa.qx=null;fa.Mn=null;fa.hd=null;fa.hKa=Array(8);fa.Kea={};fa.Svf=null;fa.XK=null;Object(K.a)(fa,"Box4PasteSteward",x.a,[])},267:function(K,S,d){d.r(S);K=d(0);d(395);var h=d(942);d(943);var e=d(27),r=d(99),m=d(55),n=d(37);class z{}Object(K.a)(z,"RibbonUpsellButtonCreator",
null,[]);class t extends Sys.EventArgs{constructor(ca){super();this.qZl=ca}}Object(K.a)(t,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(396);var x=d(370);d(185);var B=d(131);d(315);d(79);var D=d(240),w=d(168),J=d(67);class F{constructor(ca,N){this.cluster=ca;this.IPc=N}}Object(K.a)(F,"ImageInfo",null,[]);class L{constructor(ca,N,da,Y,fa,aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa=null,pa=null){this.id=ca;this.SIc=N;this.WIc=da;this.VIc=Y;this.UIc=fa;this.TIc=aa;this.YIc=ka;this.VSd=H;this.oPb=new F(ra,ha);this.Lvd=
new F(Ma,Ga);this.Yhd=new F(na,wa);Fa&&pa&&new F(Fa,pa)}}Object(K.a)(L,"PeoplesWellBaseSettings",null,[]);class M{constructor(){this.MGf=null}}Object(K.a)(M,"BreadcrumbControls",null,[]);class Q{constructor(ca){this.id=ca}}new Q("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(K.a)(Q,"ChatButtonSettings",null,[]);class C{constructor(){this.id=this.image=this.label=this.command=null}}Object(K.a)(C,"SkypeButtonInfo",null,[]);class O{constructor(){this.Yaf=
this.rLh=this.MXd=null}}Object(K.a)(O,"TopRowControls",null,[]);var U=d(199);d(47);d.d(S,"CuiHelper",function(){return T});class T{constructor(ca,N,da=null,Y,fa=null){this.gia=ca;this.l2h=U.a.fAk(N,fa);this.l2h.push(CommonUIStrings);h.b();T.Ca=void 0===da||null===da?e.AFrameworkApplication.Qa:da}static get YLj(){return T.Nqa||(T.Nqa=m.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static mrj(ca,N,da){return new L(T.nQe,n.a.CFi,n.a.T_d,n.a.FFi,n.a.EFi,n.a.DFi,n.a.GFi,n.a.J8a,ca,"per_SingleCollabUserGlyph_16x16x32",
N,"per_SingleCollabUserGlyph_32x32x32",da,"per_MoreUsersGlyph_16x16x32",null,null)}static OYi(ca){ca.MXd&&(T.NYi(ca.MXd),ca.MXd=null);ca.rLh&&(T.MYi(),ca.rLh=null);ca.Yaf&&(T.PYi(ca.Yaf),ca.Yaf=null);T.YLj.Z1k();let N;({t$b:N}=x.a.YQb(!1)).returnValue&&r.a.bDa(N)}static hac(){e.AFrameworkApplication.Qa.processAction(n.a.hac,2)}static MYi(){e.AFrameworkApplication.tRc&&w.EventHandlerManager.instance.ezd(e.AFrameworkApplication.tRc)}static addButton(ca,N,da,Y,fa,aa,ka,H){N=B.a(ca,N,da,Y,null,null,null,
aa,null,null,void 0,void 0,fa);(ca=H.hostControl(ca,N,aa))&&ka.appendChild(ca);return ca}static SOc(ca,N,da){let Y;Y=document.createElement("span");Y.className="BreadcrumbItem";Y.id=N;Y.innerText=da;Y.setAttribute("dir","auto");ca.appendChild(Y);return Y}static NYi(ca){ca.MGf&&w.EventHandlerManager.instance.NQl(ca.MGf)}static PYi(ca){D.a.instance.YOh(J.a.click,ca,T.kMk,!0)}static kMk(){e.AFrameworkApplication.Vaf?(e.AFrameworkApplication.Aa.Suc(e.AFrameworkApplication.Aa.mb.cdg()),e.AFrameworkApplication.Vaf=
!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static u4c(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.mb.u4c}}T.Nqa=null;T.Mvl="ShareServerWhite_20x20x32";T.H7d="ExternalHeaderFullTopBars";T.cMj="HeaderTopBars";T.NXd="BreadcrumbBrand";T.OXd="BreadcrumbFolder";T.PXd="BreadcrumbTitle";T.P3f="FolderSeparator";T.B7e="sbTellMe";T.E4e="TellMe-SearchBox";T.kfh="btnOpenInClient";T.s2e="btnFileSharing";T.SCl="BasicChat";T.Eqd="btnReplyWithChanges";T.o1f="jbtnGiveFeedback";
T.nQe="PeoplesWellControl";T.JXf="EditableBreadcrumbItem";T.Ca=null;T.s$e=50;T.WLj=null;Object(K.a)(T,"CuiHelper",null,[888])},284:function(K,S,d){K=d(0);var h=d(529),e=d(138);class r extends h.a{constructor(){super();this.nextId=this.prevId=null;this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(K.a)(r,"OperationWithSiblingContext",h.a,[]);d.d(S,
"a",function(){return m});class m extends r{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(K.a)(m,"AddOperation",r,[])},300:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.sourceTimestamp=this.source=
this.id=null}}Object(K.a)(h,"Item",null,[])},301:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.eAb="Image16by16Class";h.rOj="Image30by30Class";h.vFa="Image32by32Class";h.Bie="Image48by48Class";h.labelText="LabelText";h.pak="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.sV="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet="IconSet";h.Koh="ReduxActions";Object(K.a)(h,"SharedControlCommandProperties",
null,[])},302:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(K.a)(h,"LaunchData",null,[])},303:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(78);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===
this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}kF(){return!0}static E2d(e){return"prControl"+(e?"Rtl":"")}}Object(K.a)(h,"BasePresenceControl",d.a,[108,563])},304:function(K,S,d){d.d(S,
"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r){super();this.type=e;this.Fj=r}}h.Cw="InteractivityChanged";Object(K.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,[])},306:function(K,S,d){K=d(0);var h=d(55),e=d(396),r=d(604),m=d(129),n=d(395),z=d(99),t=d(667),x=d(408),B=d(47),D=d(227),w=d(56),J=d(1148),F=d(27),L=d(162);class M{constructor(na,wa){this.cp=na;this.distance=wa}}Object(K.a)(M,"CpDistanceResult",null,[]);class Q{constructor(){this.oFa=0;this.Bt=null;
this.$vb=this.awb=this.sSa=this.EDa=0;this.gwc=this.IGa=this.rMa=null;this.ECb=this.Lda=this.ahd=0;this.xbf=this.L4d=!1;this.l4b=this.vEa=this.Zja=this.T3=this.Ppc=0;this.ZTh=this.Z2f=this.cvc=this.vPb=!1;this.result=null;this.z3b=this.z1d=this.Z8a=this.G8=this.lda=0;this.Ela=this.NOc=!1;this.wP=null}}Object(K.a)(Q,"CpFromPointState",null,[]);class C{constructor(na,wa,Fa,pa,Ea,ta,ia,Ja=null,ab=0,Oa=null){this.sDa=this.cp=this.Ra=0;this.y3b=-1;this.deltaX=this.eQf=Number.MAX_VALUE;this.m_a=0;this.LWa=
-Number.MAX_VALUE;this.JWa=-Number.MAX_VALUE;this.f8d=this.c6b=this.Xtb=this.eNe=!1;this.element=na;this.point=Fa;this.rdb=pa;this.eWe=Ea;this.dWe=ta;this.dng=ia;this.Bja=Ja;this.m8a=ab;this.originalText=wa;this.dKa=this.originalText.length;this.Lb=this.dKa-1;this.Mbc=4===this.rdb||3===this.rdb;this.wP=Oa}}Object(K.a)(C,"CpFromPointElementState",null,[]);var O=d(44);class U{constructor(na,wa,Fa){this.CpBegin=na;this.CpEnd=wa;this.IsEop=Fa}}Object(K.a)(U,"CpFromPointResult",null,[]);class T{constructor(na,
wa,Fa){this.LineBounds=na;this.ClientRects=wa;this.IsRangeMultipleLines=Fa}}Object(K.a)(T,"LineCoordinateResult",null,[]);class ca{constructor(na,wa,Fa,pa,Ea,ta){this.Fob={};this.KVb=!0;this.qwg=this.QEc=this.kHc=this.Wrb=this.E6a=null;this.qd=na;this.ZZ=wa;this.N3h=Fa?Fa.ka("TextFidelityLayoutFixesEnabled"):!1;this.T2h=Fa?Fa.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.E2h=Fa?Fa.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.rPa=pa)||n.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");
this.dQ=Ea;this.Wai=ta}tea(){this.KVb=!1}$8a(na,wa,Fa,pa=null){this.qwg=[];var Ea=na.c7;if(!na.textLength)return this.GEj(na,wa,Fa,pa);pa=Object.assign(new Q,{rMa:Array(Ea.length),IGa:Array(Ea.length),gwc:Array(Ea.length),L4d:!0,Bt:Ea,wP:pa});for(var ta=0;ta<=Ea.length;ta++){pa.EDa=0;pa.sSa=0;pa.awb=0;pa.$vb=0;pa.oFa=0;pa.vPb=!1;pa.cvc=!1;if(ta<Ea.length){if(!this.c8i(na,pa,ta))continue}else{pa.ECb=ta-1;break}if(this.F8i(wa,pa,ta))break}if(pa.xbf&&pa.Ppc<wa.y&&wa.y<pa.T3)return this.Jkl(na,wa,Fa,
pa);pa.result=null;pa.lda=-1;pa.G8=pa.vEa;pa.Z8a=Number.MAX_VALUE;pa.z1d=0;pa.z3b=0;pa.NOc=!1;pa.Ela=!1;for(Ea=pa.Lda;Ea<=pa.ECb;Ea++)if(ta=this.D8i(na,wa,Fa,Ea,pa))return ta;return this.pDj(na,wa,Fa,pa)}GEj(na,wa,Fa,pa){const Ea=na.isRtl;if(!Fa)return new U(0,0,!1);na=this.rRa(na,pa);return!Ea&&wa.x>na.x+na.width/2||Ea&&wa.x<na.x+na.width/2?new U(-1,-1,!0):new U(0,0,!0)}c8i(na,wa,Fa){if(this.ACi(wa.Bt[Fa].htmlElement)||wa.Bt[Fa].TAb)return!1;var pa=this.KXd(wa.Bt[Fa],wa.wP);wa.rMa[Fa]=pa;var Ea=
pa.y;let ta=pa.y+pa.height;wa.Bt[Fa].Xpg||wa.Bt[Fa].Ela||wa.Bt[Fa].G4&&!wa.Bt[Fa].WVa?({WSf:Ea,VSf:ta}=this.$Bf(wa.Bt[Fa].htmlElement,Ea,ta),wa.EDa=wa.awb=Ea,wa.sSa=wa.$vb=ta,wa.IGa[Fa]=ta-Ea,wa.gwc[Fa]=wa.IGa[Fa]):(this.lzl(na,Fa)?(pa=this.eu(na,wa.l4b,void 0,void 0,void 0,wa.wP),Ea=this.d8b(wa.Bt[Fa].htmlElement),na=1<Ea?this.eu(na,wa.l4b+Ea-1,void 0,void 0,void 0,wa.wP):pa,wa.EDa=Ea=pa.y,wa.sSa=pa.y+pa.height,wa.awb=na.y,wa.$vb=na.y+na.height,wa.IGa[Fa]=pa.height,wa.gwc[Fa]=pa.height):(na=this.Wai.uyj(wa.Bt[Fa].htmlElement),
wa.oFa=this.rPa.Awj(wa.Bt[Fa].htmlElement,na),{WSf:Ea,VSf:ta}=this.$Bf(wa.Bt[Fa].htmlElement,Ea,ta),wa.ZTh=1<Math.abs(pa.width-this.Plj(wa.Bt[Fa].htmlElement))||1<Math.abs(pa.height-this.Olj(wa.Bt[Fa].htmlElement)),wa.ZTh&&this.ZZ.instance&&(na=Math.round(na*this.ZZ.instance.U3),wa.oFa=Math.round(wa.oFa*this.ZZ.instance.U3)),wa.EDa=Ea-wa.oFa,wa.sSa=Ea+na+wa.oFa,wa.awb=ta-na-wa.oFa,wa.$vb=ta+wa.oFa,wa.IGa[Fa]=na+2*wa.oFa,wa.gwc[Fa]=na),wa.ahd=Math.max(wa.ahd,wa.IGa[Fa]));wa.Z2f||(wa.T3=wa.EDa,wa.Zja=
wa.sSa,wa.Z2f=!0);wa.cvc=wa.awb>(wa.EDa+wa.sSa)/2;Fa=ca.Nta(wa.ahd);this.N3h&&(Fa=this.eVd(wa,Fa));wa.vPb=this.qXj(wa.T3,wa.Zja,Ea,Fa);return!0}qXj(na,wa,Fa,pa){return na===wa?Fa>wa:Fa>=wa-pa}eVd(na,wa){return wa=this.rPa.eVd(!!na.wP&&na.wP.TBb,na.EDa,na.sSa,wa)}F8i(na,wa,Fa){if(wa.vPb||wa.cvc){wa.vPb?wa.ECb=Fa-1:(wa.T3=Math.min(wa.T3,wa.EDa),wa.Zja=Math.max(wa.Zja,wa.sSa),wa.ECb=Fa);Array.add(this.qwg,wa.Zja);if(na.y<=wa.Zja)return!0;wa.Ppc=wa.Zja;wa.T3=wa.awb;wa.Zja=wa.$vb;wa.Lda=Fa;wa.vEa=wa.l4b;
wa.L4d=wa.vPb;wa.xbf=wa.cvc;wa.ahd=wa.Bt[Fa].Ela||wa.Bt[Fa].G4&&!wa.Bt[Fa].WVa?0:wa.IGa[Fa]}else wa.T3=Math.min(wa.T3,wa.EDa),wa.Zja=Math.max(wa.Zja,wa.$vb);na.y>wa.Ppc&&na.y<wa.T3&&!wa.Bt[wa.Lda].Ela&&!wa.Bt[wa.Lda].G4&&wa.T3-wa.Ppc<wa.gwc[wa.Lda]/2&&(wa.T3=na.y);wa.l4b+=this.MTi(wa.Bt[Fa]);return!1}Jkl(na,wa,Fa,pa){if(pa.Bt[pa.Lda].G4)return Fa?new U(pa.vEa,pa.vEa,!1):new U(pa.vEa,pa.vEa+1,!1);if(Fa=this.dQf(pa.Bt[pa.Lda].htmlElement,pa.rMa[pa.Lda],wa,pa.L4d?4:3,pa.Ppc,pa.T3,pa.IGa[pa.Lda],na.isRtl,
na.Bja,pa.vEa,pa.wP))return Fa=pa.vEa+Fa.cp,Fa=this.WBf(na,wa,Fa,pa.Lda,pa.vEa,void 0,void 0,pa.wP),new U(Fa,Fa,!1);this.qd.Yb(t.a.pCk,{["Reason"]:r.a.d1f});return null}D8i(na,wa,Fa,pa,Ea){if(Ea.Bt[pa].TAb)return null;const ta=Ea.Bt[pa].G4,ia=Ea.Bt[pa].Ela;let Ja=!1;if(ta){if(Ea.rMa[pa].y>=Ea.T3&&(Ea.Bt[pa].WVa||Ea.Bt[pa].d3c)){var ab=Ea.rMa[pa];const Oa=ab.x+ab.width/2,Za=Math.abs(wa.x-Oa);if(Za<Ea.Z8a||!ab.width&&Za===Ea.Z8a)Ea.NOc=!0,Ea.Z8a=Za,Ea.Ela=!1,Ea.lda=!Fa||!na.isRtl&&wa.x<Oa||na.isRtl&&
wa.x>Oa?Ea.G8:Ea.G8+1}if(!Ea.Bt[pa].WVa&&!Ea.Bt[pa].d3c){ab=Ea.rMa[pa];if(!Fa&&wa.x>ab.x&&wa.x<ab.x+ab.width&&!Ea.Bt[pa].V0j)return new U(Ea.G8,Ea.G8+1,!1);Ea.result=wa.x<ab.x+ab.width/2?new M(na.isRtl?1:0,Math.max(ab.x-wa.x,0)):new M(na.isRtl?0:1,Math.max(wa.x-ab.x-ab.width,0))}}else ia?(na=this.rRa(na,Ea.wP),Ja=1>na.width,Ea.result=new M(-1,x.a.dRc(wa,na))):Ea.result=this.dQf(Ea.Bt[pa].htmlElement,Ea.rMa[pa],wa,pa===Ea.Lda&&Ea.xbf?1:pa===Ea.ECb&&!Ea.vPb&&Ea.cvc?0:2,Ea.T3,Ea.Zja,Ea.IGa[pa],na.isRtl,
na.Bja,Ea.G8,Ea.wP);Ea.result&&(Ea.result.distance<Ea.Z8a||Ja&&Ea.result.distance<=Ea.Z8a+1)&&(Ea.lda=Ea.result.cp+Ea.G8,Ea.Ela=ia,Ea.Z8a=Ea.result.distance,Ea.z1d=Ea.G8,Ea.z3b=pa,Ea.NOc=ta);Ea.G8=ta?Ea.G8+1:Ea.G8+this.d8b(Ea.Bt[pa].htmlElement);return null}pDj(na,wa,Fa,pa){if(-1===pa.lda)return this.qd.Yb(t.a.KUj,{["Reason"]:r.a.Z0f}),null;const Ea=na.textLength;if(pa.Ela){if(Fa)return Fa=pa.rMa[pa.rMa.length-1],!na.isRtl&&wa.x<Fa.x+Fa.width/2||na.isRtl&&wa.x>Fa.x+Fa.width/2?new U(Ea,Ea,!1):new U(-1,
-1,!0);pa.lda=Ea}pa.lda>Ea&&(pa.lda=Ea);!pa.NOc&&pa.lda<Ea&&(pa.lda=this.WBf(na,wa,pa.lda,pa.z3b,pa.z1d,pa.z3b===pa.Lda,pa.z3b===pa.ECb,pa.wP));return new U(pa.lda,pa.lda,!1)}WBf(na,wa,Fa,pa,Ea,ta=!1,ia=!1,Ja=null){const ab=na.isRtl,Oa=na.characterData,Za=na.textLength;Fa=B.a.Hx(Oa,Fa)?Fa-1:Fa;const Na=B.a.O0j(Oa,Fa)?Fa+2:Fa+1,sa=this.eu(na,Fa,void 0,void 0,void 0,Ja);wa=wa.x>sa.x+sa.width/2;if(Fa-Ea===this.d8b(na.c7[pa].htmlElement)&&na.c7.length>pa+1&&na.c7[pa+1].G4)return Fa;if(na.c7[pa].BYj)return++Fa;
if(na.c7[pa].AYj)return Fa;let Sa=null,xb=!1;0<Fa&&(Sa=this.eu(na,B.a.Hx(Oa,Fa-1)?Fa-2:Fa-1,void 0,void 0,void 0,Ja),0<Fa-Ea?xb=Sa.y+Sa.height/2>sa.y:ta||na.c7[pa-1].G4||(xb=!0));ta=null;let gc=!1;if(this.E2h?Na<=Za:Na<Za)ta=this.eu(na,Na,void 0,void 0,void 0,Ja),Na-Ea<this.d8b(na.c7[pa].htmlElement)?gc=ta.y+ta.height/2<sa.y+sa.height:ia||na.c7[pa+1].WVa||na.c7[pa+1].d3c||(gc=!0);xb&&gc?Sa.x<=sa.x&&ta.x>=sa.x?wa&&(Fa=Na):Sa.x>=sa.x&&ta.x<=sa.x?wa||(Fa=Na):Sa.x<ta.x?wa||(Fa=Na):ta.x<Sa.x&&wa&&(Fa=
Na):xb||(gc?ta.x>=sa.x&&wa?Fa=Na:ta.x<=sa.x&&!wa&&(Fa=Na):!B.a.yz(Oa.charCodeAt(Fa))&&(!ab&&wa||ab&&!wa)&&(Fa=Na));return Fa}Mlj(na){return z.a.Gv(na)}Olj(na){return na.offsetHeight}Plj(na){return na.offsetWidth}ACi(na){return!na.parentNode}d8b(na){return z.a.$$a(na)}lzl(na,wa){wa=na.c7[wa];if(wa.G4)return!1;na=na.htmlElement;Sys.UI.DomElement.containsCssClass(na,"Paragraph")||(na=na.firstChild);return""!==na.style.lineHeight&&na.style.lineHeight!==wa.htmlElement.style.lineHeight}MTi(na){return na.G4?
1:z.a.$$a(na.htmlElement)}$Bf(na,wa,Fa){Fa=new Sys.UI.Bounds(0,wa,0,Fa-wa);this.omi(na,[Fa]);wa=Fa.y;Fa=Fa.y+Fa.height;return{WSf:wa,VSf:Fa}}omi(na,wa){if(na=D.a.wt(na)){var Fa=na.borderTopWidth,pa=Fa.indexOf("px");if(-1<pa)for(Fa=parseInt(Fa.substr(0,pa)),pa=0;pa<wa.length;pa++)wa[pa].y+=Fa,wa[pa].height-=Fa;na=na.borderBottomWidth;Fa=na.indexOf("px");if(-1<Fa)for(na=parseInt(na.substr(0,Fa)),Fa=0;Fa<wa.length;Fa++)wa[Fa].height-=na}}dQf(na,wa,Fa,pa,Ea,ta,ia,Ja,ab,Oa,Za=null){if(this.A_j(na))return this.qd.Yb(t.a.Z8i,
{["Reason"]:r.a.c1f}),new M(0,x.a.dRc(Fa,wa));if(this.z_j(na))return this.qd.Yb(t.a.NTc,{["Reason"]:r.a.NTc}),null;na=this.zNi(na,Fa,pa,Ea,ta,ia,ab,Oa,Za);if(1>=na.dKa)return new M(0,x.a.dRc(na.point,wa));this.chl(na);do{if(na.Ra>na.Lb)return this.PMb(),this.qd.Yb(t.a.oCk,{["Reason"]:r.a.f8g}),null;this.kBk(na)}while(!na.eNe);for(na.sDa=!Ja&&na.m_a<na.point.x||Ja&&na.m_a>na.point.x?na.Lb:na.Ra;!na.Xtb&&!this.Bsi(na););if(na.f8d)for(na.cp=na.Ra;na.cp<=na.Lb&&!this.Vbk(na);na.cp++);return this.xDi(na)}zNi(na,
wa,Fa,pa,Ea,ta,ia,Ja,ab=null){return new C(na,this.Mlj(na),wa,Fa,pa,Ea,ta,ia,Ja,ab)}A_j(na){return!na.firstChild}z_j(na){return 3!==na.firstChild.nodeType}chl(na){let wa;if(0===na.rdb){na.LWa=na.eWe;na.JWa=na.dWe;for(var Fa=40;Fa<na.dKa;Fa+=40)if(wa=this.qRa(na.element,na.originalText,Fa,na.Bja,na.m8a,void 0,void 0,na.wP),wa.height&&wa.y+wa.height/2>na.JWa){na.Lb=Fa;break}}else if(1===na.rdb)for(na.Lb=na.dKa-1,na.LWa=na.eWe,na.JWa=na.dWe,Fa=na.dKa-40;0<=Fa;Fa-=40){if(wa=this.qRa(na.element,na.originalText,
Fa,na.Bja,na.m8a,void 0,void 0,na.wP),wa.height&&wa.y+wa.height/2<na.LWa){na.Ra=Fa;break}}else if(2===na.rdb)na.Lb=na.dKa-1,na.LWa=na.eWe,na.JWa=na.dWe;else if(3===na.rdb||4===na.rdb)for(Fa=0;Fa<na.dKa+40;Fa+=40){const pa=Fa<na.dKa?Fa:na.dKa-1;wa=this.qRa(na.element,na.originalText,pa,na.Bja,na.m8a,void 0,void 0,na.wP);if(wa.height&&(wa.y+wa.height<na.point.y&&(na.Ra=pa),wa.y>na.point.y)){na.Lb=pa;break}}}kBk(na){const wa=Math.floor((na.Ra+na.Lb)/2);na.cp=wa;let Fa=this.qRa(na.element,na.originalText,
na.cp,na.Bja,na.m8a,void 0,void 0,na.wP);for(;na.cp<na.Lb&&!Fa.height;)na.cp++,Fa=this.qRa(na.element,na.originalText,na.cp,na.Bja,na.m8a,void 0,void 0,na.wP);na.cp!==na.Lb||Fa.height?!na.Mbc&&Fa.y+Fa.height/2<na.LWa||na.Mbc&&Fa.y+na.dng<na.point.y?na.Ra=na.cp+1:!na.Mbc&&Fa.y+Fa.height/2>na.JWa||na.Mbc&&Fa.y>na.point.y?na.Lb=na.cp-1:Fa.x<=na.point.x&&Fa.x+Fa.width>=na.point.x?(na.Xtb=!0,na.c6b=!0,na.eNe=!0):(na.eNe=!0,na.m_a=Fa.x+Fa.width/2,na.y3b=na.cp,na.deltaX=Math.abs(na.m_a-na.point.x),na.Mbc&&
(na.LWa=Fa.y,na.JWa=Fa.y+na.dng)):na.Lb=wa-1}Bsi(na){var wa=Math.abs(na.sDa-na.cp);if(wa<na.eQf)na.eQf=wa;else return na.Xtb=!0,na.f8d=!0;wa=Math.floor((na.cp+na.sDa)/2);wa===na.cp&&(wa=na.sDa);var Fa=this.qRa(na.element,na.originalText,wa,na.Bja,na.m8a,void 0,void 0,na.wP);if(0<Fa.height&&Fa.y+Fa.height/2<=na.LWa||Fa.y+Fa.height/2>=na.JWa)na.sDa=na.cp<na.sDa?wa-1:wa+1;else if(Fa.x<=na.point.x&&Fa.x+Fa.width>=na.point.x)na.cp=wa,na.c6b=!0,na.Xtb=!0;else{Fa=Fa.x+Fa.width/2;const pa=Math.abs(na.m_a-
Fa),Ea=Math.abs(na.m_a-na.point.x),ta=Math.abs(Fa-na.point.x);ta<na.deltaX&&(na.y3b=wa,na.deltaX=ta);pa+ta===Ea?(na.cp=wa,na.m_a=Fa):Ea+ta===pa?(na.sDa=na.cp<na.sDa?na.cp+1:na.cp-1,na.cp=wa,na.m_a=Fa):pa+Ea===ta&&(na.Xtb=!0,na.f8d=!0)}na.sDa===na.cp&&(na.Xtb=!0);return!1}Vbk(na){var wa=this.qRa(na.element,na.originalText,na.cp,na.Bja,na.m8a,void 0,void 0,na.wP);if(0<wa.height&&wa.y+wa.height/2<=na.LWa||wa.y+wa.height/2>=na.JWa)return!1;if(wa.x<=na.point.x&&wa.x+wa.width>=na.point.x)return na.c6b=
!0;wa=Math.abs(wa.x+wa.width/2-na.point.x);wa<na.deltaX&&(na.y3b=na.cp,na.deltaX=wa);return!1}xDi(na){if(!na.c6b&&-1===na.y3b)return this.PMb(),this.qd.Yb(t.a.qCk,{["Reason"]:r.a.$0f}),null;na.c6b?na.deltaX=0:na.cp=na.y3b;B.a.Hx(na.originalText,na.cp)&&na.cp--;this.PMb();return new M(na.cp,na.deltaX)}eu(na,wa,Fa=!1,pa=!1,Ea=!1,ta=null){let ia;na||n.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ja=({i:sa,Bt:ia,G8:Ea,SBk:wa}=this.xdg(na,wa,Ea)).returnValue,ab="";ab=na.Bja;na=z.a.Gv(Ja.htmlElement);
let Oa=na.length,Za,Na=!1;if(!Oa)if(Za=Sys.UI.DomElement.getBounds(Ja.htmlElement),Na=!0,!Za.height&&sa<ia.length-1)sa++,Ja=ia[sa],na=L.b(Ja.htmlElement),Oa=na.length;else if(!Ja.htmlElement.firstChild||Ja.Xpg)return this.dQ.mha(Za,ta,()=>Ja.htmlElement.offsetWidth/Ja.htmlElement.offsetHeight);var sa=!1;!Na&&wa>=Oa&&(wa=Oa-1,sa=!0);if(Za=Ja.G4||!Ja.htmlElement.firstChild||Ja.dpg?this.KXd(Ja,ta):this.qRa(Ja.htmlElement,na,wa,ab,Ea,Fa,pa,ta))Na?Za.width=1:sa&&(Za.x+=Za.width,Za.width=1);this.PMb();
return Za}eFa(na,wa,Fa=!1,pa=!0){return this.xdg(na,wa,Fa,pa).returnValue}Ecc(na,wa){return wa.y>na.y+na.height-ca.Nta(na.height)}xdg(na,wa,Fa=!1,pa=!0){let Ea,ta,ia=na;Ea=na.c7;for(na=ta=0;na<Ea.length;na++){if(Ea[na].TAb)continue;let Ja;if(Ea[na].G4){if(!wa){Fa||this.W1j(Ea,na)?ia=Ea[na]:(ia=Ea[na-1],wa=Ja=z.a.$$a(ia.htmlElement),ta-=Ja);break}wa--;ta++;continue}Ja=z.a.$$a(Ea[na].htmlElement);let ab=!1;if(this.T2h){const Oa=Ea[na].htmlElement,Za=Oa.nextSibling;Za&&(ab=Sys.UI.DomElement.containsCssClass(Oa,
"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(Za,"Hyperlink"))}if(wa<Ja||!wa&&pa&&!ab||na>=Ea.length-1){ia=Ea[na];break}else wa-=Ja,ta+=Ja}return{returnValue:ia,i:na,Bt:Ea,G8:ta,SBk:wa}}W1j(na,wa){if(!wa)return!0;const Fa=this.bub(na[wa-1].htmlElement);na=this.bub(na[wa].htmlElement);return this.Ecc(Fa,na)}qRa(na,wa,Fa,pa,Ea,ta=!1,ia=!1,Ja=null){let ab=Fa+1;Fa||wa.length?B.a.Hx(wa,Fa)?Fa--:B.a.Hx(wa,ab)&&ab++:ab=0;if(""!==pa)if(pa=Ea+Fa+"-"+pa,this.KVb){if(Ea=this.Fob[pa],void 0!==Ea&&null!==
Ea)return pa=this.dQ.mha(Ea,Ja,()=>this.dQ.T6f(na,Fa)),pa=this.rPa.fVd(Ja,na,pa)}else this.Fob={},this.KVb=!0;Ea=this.Oxc(na,Fa,ab);ta=ta&&(w.a.Yj||w.a.Io);if(!Ea&&!ia||ta)wa=this.zzk(na,wa,Fa,ab),Ea||(Ea=wa),ta&&Ea&&(Ea.y=wa.y,Ea.height=wa.height);""!==pa&&Ea&&(this.Fob[pa]=new Sys.UI.Bounds(Ea.x,Ea.y,Ea.width,Ea.height));pa=this.dQ.mha(Ea,Ja,()=>this.dQ.T6f(na,Fa));return pa=this.rPa.fVd(Ja,na,pa)}Oxc(na,wa,Fa){let pa=null;if(this.d8b(na)<Fa)return null;w.a.qS&&(pa=this.yzk(na,wa,Fa));!pa&&w.a.Yj&&
(pa=this.Azk(na,wa,Fa));return pa}EGf(na,wa=null){return this.bub(na.htmlElement.firstChild,wa)}KXd(na,wa=null){return na.WVa?this.EGf(na,wa):this.bub(na.htmlElement,wa)}bub(na,wa=null){var Fa=Sys.UI.DomElement.getBounds(na);Fa=this.dQ.mha(Fa,wa,()=>na.offsetWidth/na.offsetHeight);return Fa=this.rPa.fVd(wa,na,Fa)}BW(na,wa,Fa,pa,Ea,ta){return na!==wa.characterData.length||Fa?this.tti(na,wa,Fa,pa,Ea,ta):this.sti(wa)}sti(na){const wa=this.rRa(na);return this.U8f(wa,!na.isRtl)}tti(na,wa,Fa,pa,Ea,ta){var ia=
wa.textLength;if(w.a.gU&&Fa&&0<na&&na<ia){var Ja=this.eFa(wa,na-1,!0),ab=this.eFa(wa,na,!0);Ja===ab&&(Fa=!1)}var Oa=Fa?na-1:na;B.a.Hx(wa.characterData,Oa)&&--Oa;var Za=!0;ab=this.eFa(wa,Oa,!0,!1);if(ab.G4)if(ab.WVa){if(Fa)return this.BW(na,wa,!1,pa,!1,ta);Ja=this.EGf(ab)}else if(ab.d3c){if(Fa)return this.BW(na,wa,!1,pa,!1,ta);if(na)return this.BW(na,wa,!0,pa,!1,ta);Ja=this.KXd(ab)}else Ja=this.bub(ab.htmlElement),ab.l1j&&(Za=!1);else{ab=Oa;do{Ja=this.eu(wa,ab,Ea,ta);if(!Ja)return null;ab+=1}while(!Ja.height&&
ab<=ia)}ab=ia=wa.isRtl;if(Za){Za=this.oKc(wa,Oa,-1,Ea,ta);Ea=this.oKc(wa,Oa,1,Ea,ta);ta=new Sys.UI.Point(Ja.x+Ja.width/2,Ja.y+Ja.height/2);Oa=Ja.y;var Na=Ja.y+Ja.height;Oa=!Za||Za.y+Za.height<=Oa;Na=!Ea||Ea.y>=Na;let sa=!1;Oa||Na?Oa||B.a.yz(wa.characterData.charCodeAt(na))?Na||(Ea.x>=ta.x?ab=!1:Ea.x<=ta.x&&(ab=!0),sa=ab!==ia):(Za.x<=ta.x?ab=!1:Za.x>=ta.x&&(ab=!0),sa=ab!==ia):Za.x<=ta.x&&ta.x<=Ea.x?ab=!1:Ea.x<=ta.x&&ta.x<=Za.x?ab=!0:Za.x<Ea.x?(ab=!0,sa=Fa?ta.x<Za.x:Za.x<ta.x):Ea.x<Za.x&&(ab=!1,sa=
Fa?Za.x<ta.x:ta.x<Za.x);if(sa&&w.a.eG){if(Fa&&!pa)return this.BW(na,wa,!1,!1);na||(Ja=this.Zij(wa,ia))}}return this.U8f(Ja,ab===Fa)}oKc(na,wa,Fa,pa,Ea){if(0>Fa&&0>=wa||0<Fa&&wa>=na.characterData.length-1)return null;const ta=wa+Fa;return B.a.Hx(na.characterData,ta)?this.oKc(na,ta,Fa,pa,Ea):this.eFa(na,wa,!0,!1).WVa?null:(wa=this.eu(na,ta,pa,Ea))?wa.height&&wa.width?wa:this.oKc(na,ta,Fa,pa,Ea):null}Zij(na,wa){let Fa=null;for(var pa=0;pa<na.c7.length;pa++){const Ea=na.c7[pa];if(!Ea.TAb){Fa=Ea.htmlElement;
break}}for(pa=Fa.childNodes[0];pa&&1===pa.nodeType;)Fa=pa,pa=Fa.childNodes[0];pa=z.a.Gv(Fa);z.a.Rz(Fa,(wa?"\u202e":"\u202d")+pa);this.tea();na=this.eu(na,0);z.a.Rz(Fa,pa);this.tea();return na}U8f(na,wa){return new Sys.UI.Bounds(wa?na.x:na.x+na.width,na.y,0,na.height)}rRa(na,wa=null){return this.bub(na.ZZf.htmlElement,wa)}yzk(na,wa,Fa){this.PMb();try{const pa=na.firstChild,Ea=pa.ownerDocument.createRange();Ea.setStart(pa,wa);Ea.setEnd(pa,Fa);const ta=this.fqj(Ea,(ia,Ja)=>(0<ia||wa===Fa)&&0<Ja);if(!ta||
!ta.length)return null;this.VBf(pa,ta[0]);Ea.detach();return ta[0]}catch(pa){return null}}fqj(na,wa){this.PMb();try{let Fa;Fa=na.getClientRects();na=[];for(let pa=0;pa<Fa.length;pa++){const Ea=Fa[pa];if(Ea){const ta=Math.floor(Ea.width/1),ia=Math.floor(Ea.height/1);if(wa(ta,ia)){const Ja=new Sys.UI.Bounds(Math.floor(Ea.left/1),Math.floor(Ea.top/1),ta,ia);Array.add(na,Ja)}}}return na}catch(Fa){return null}}Azk(na,wa,Fa){if(!w.a.XPb)return null;let pa=null;try{pa=na.ownerDocument.body.createTextRange(),
pa.moveToElementText(na)}catch(Ea){return null}if(pa.collapse&&pa.move&&pa.moveEnd)pa.collapse(),pa.move("character",wa),pa.moveEnd("character",Fa-wa);else return null;wa=new Sys.UI.Bounds(pa.boundingLeft,pa.boundingTop,pa.boundingWidth,pa.boundingHeight);if(!(wa.x||wa.y||wa.width||wa.height))return null;this.VBf(na,wa);na=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==na&&(wa.x=Math.round(wa.x/na),wa.y=Math.round(wa.y/na),wa.width=Math.round(wa.width/na),wa.height=Math.round(wa.height/na));
return wa}zzk(na,wa,Fa,pa){this.E6a&&this.E6a.ownerDocument===na.ownerDocument||(this.E6a=na.ownerDocument.createElement("SPAN"),this.Wrb=na.ownerDocument.createElement("SPAN"),this.kHc=na.ownerDocument.createElement("SPAN"));na.firstChild!==this.E6a&&(this.QEc=new J.a(na),z.a.yv(na),this.rPa&&this.rPa.ZDi(this.E6a,this.Wrb,this.kHc),na.appendChild(this.E6a),na.appendChild(this.Wrb),na.appendChild(this.kHc));z.a.Rz(this.E6a,B.a.substring(wa,0,Fa));z.a.Rz(this.Wrb,B.a.substring(wa,Fa,pa));z.a.Rz(this.kHc,
B.a.substring(wa,pa,wa.length));F.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&w.a.ik&&w.a.UXj&&" "===B.a.substring(wa,Fa,pa)&&Sys.UI.DomElement.addCssClass(this.Wrb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.Wrb)}VBf(na,wa){this.imi(na,[wa])}imi(na,wa){try{if(void 0!==na.ownerDocument.parentWindow){var Fa=na.ownerDocument.parentWindow.frameElement;if(Fa&&("0"===Fa.frameBorder||"no"===Fa.frameBorder))for(na=0;na<wa.length;na++)wa[na].x+=2,wa[na].y+=2}}catch(pa){}}PMb(){this.QEc&&
this.QEc.restore();this.QEc=null}cub(na,wa){if(""!==wa){let Fa;if(this.KVb){if(Fa=this.Fob["VE-"+wa])return na=new Sys.UI.Bounds(Fa.x,Fa.y,Fa.width,Fa.height)}else this.Fob={},this.KVb=!0;Fa=Sys.UI.DomElement.getBounds(na);this.Fob["VE-"+wa]=Fa;return na=new Sys.UI.Bounds(Fa.x,Fa.y,Fa.width,Fa.height)}return Sys.UI.DomElement.getBounds(na)}static get instance(){return ca.La||(ca.La=new ca(e.a.instance,h.a.instance.Ia("Common.IZoomManager"),F.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),
h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static Nta(na){return O.SelectionEditor.Nta(na)}}ca.La=null;Object(K.a)(ca,"TextMetrics",null,[]);var N=d(98);class da{get WVa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.Idc)}get G4(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.JN)}get d3c(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.vPk)}get l1j(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
N.a.oTj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.nTj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.lTj)}get Xpg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.m6d)}get dpg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.dPf)}}Object(K.a)(da,"ATextMetricsElement",null,[473]);var Y=d(34),fa=d(154);class aa extends da{constructor(na){super();this.WP=na}get htmlElement(){return this.WP}get Ela(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
N.a.$N)}get TAb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,fa.a.xW)}get V0j(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.HVj)}get BYj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.Rsi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.qTj)}get AYj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.Qsi)||Sys.UI.DomElement.containsCssClass(this.htmlElement,N.a.pTj)}}Object(K.a)(aa,"TextMetricsLeafElement",da,[505,473]);var ka=
d(54),H=d(60);class ra extends da{constructor(na){super();this.Yqb=na;this.Vi=this.Yqb.gb;this.FZb=Array(na.Et.length);for(na=0;na<this.Yqb.Et.length;na++){const wa=new aa(this.Yqb.Et[na]);this.FZb[na]=wa}}get c7(){return this.FZb}get paragraphId(){return this.Vi.id.toString()}get htmlElement(){return this.Yqb.htmlElement}get Bja(){return this.Yqb.Qc.Uh?this.Yqb.gb.id.toString():""}get textLength(){return Y.ParagraphReader.textLength(this.Vi)}get isRtl(){return H.OutlineElementReader.Jm(ka.OutlineElementNavigator.AB(this.Vi))}get zs(){return Y.ParagraphReader.fe(this.Vi)&&
!this.Vi.nX}get characterData(){return this.Vi.characterData}get ZZf(){return this.FZb.length?this.FZb[this.FZb.length-1]:null}static d9a(na){return new ra(na)}}Object(K.a)(ra,"TextMetricsParagraphElement",da,[472,473]);var ha=d(51),Ma=d(35);d.d(S,"a",function(){return Ga});class Ga{static get x3b(){return Ga.eB||(Ga.eB=h.a.instance.rb("Box4.CharacterPointConverter"))}static get Xc(){return e.a.instance}static eu(na,wa,Fa=!1,pa=!1,Ea=!1,ta=null){na=ra.d9a(na);return ca.instance.eu(na,wa,Fa,pa,Ea,
ta)}static Oxc(na,wa,Fa){return ca.instance.Oxc(na,wa,Fa)}static cub(na,wa){return ca.instance.cub(na,wa)}static BW(na,wa,Fa,pa,Ea=!1,ta=!1){wa=ra.d9a(wa);return ca.instance.BW(na,wa,Fa,pa,Ea,ta)}static rRa(na,wa=null){na=ra.d9a(na);return ca.instance.rRa(na,wa)}static tea(){ca.instance.tea()}static $8a(na,wa,Fa,pa=null){let Ea=null,ta=null;try{const ia=ra.d9a(na);let Ja=null;Ea=Ga.Xc.eq(Ma.a.ofj);(Ja=ca.instance.$8a(ia,wa,Fa,pa))&&(ta=Ga.x3b?Ga.x3b.L0l(Ja,na.gb):ha.a.cSa(Ja.CpBegin,Ja.CpEnd,Ja.IsEop,
na.gb))}catch(ia){Ga.Xc.Yb(m.a.s_l,{["Reason"]:r.a.v3i,["ExceptionMessage"]:ia.message,["ExceptionCallstack"]:ia.stack}),ta=null}Ea&&Ea.end();return ta}static eFa(na,wa,Fa=!1,pa=!0){na=ra.d9a(na);return ca.instance.eFa(na,wa,Fa,pa).htmlElement}static Ecc(na,wa){return ca.instance.Ecc(na,wa)}}Ga.eB=null;Object(K.a)(Ga,"TextMetricsAdapter",null,[])},314:function(K,S,d){K=d(0);var h=d(395),e=d(27),r=d(1281);const m=(z,t)=>{const x={};let B=null;switch(z){case 0:B="HtmlProcessor";var D=t.a;null!=D&&(x.SessionID=
D);var w=t.b.toString();null!=w&&(x.Elements=w);var J=t.c.toString();null!=J&&(x.PrunedElements=J);var F=t.d.toString();null!=F&&(x.TransparentElements=F);var L=t.e.toString();null!=L&&(x.VoidElements=L);var M=t.f.toString();null!=M&&(x.UnknownElements=M);break;case 1:B="WordConverter";var Q=t.a;null!=Q&&(x.SessionID=Q);var C=t.b.toString();null!=C&&(x.BulletsConverted=C);var O=t.c.toString();null!=O&&(x.NumberedConverted=O);break;case 2:B="FormattingSteward";var U=t.a;null!=U&&(x.SourceApp=U);var T=
t.b;null!=T&&(x.Browser=T);var ca=t.c;null!=ca&&(x.OperationId=ca);var N=t.d.toString();null!=N&&(x.Lang=N);var da=t.e.toString();null!=da&&(x.TextDir=da);var Y=t.f.toString();null!=Y&&(x.Bold=Y);var fa=t.g.toString();null!=fa&&(x.Math=fa);var aa=t.h.toString();null!=aa&&(x.Italics=aa);var ka=t.i.toString();null!=ka&&(x.Underline=ka);var H=t.j.toString();null!=H&&(x.Strikethrough=H);var ra=t.k.toString();null!=ra&&(x.Subscript=ra);var ha=t.l.toString();null!=ha&&(x.Superscript=ha);var Ma=t.m.toString();
null!=Ma&&(x.Fontsize=Ma);var Ga=t.n.toString();null!=Ga&&(x.Fontface=Ga);var na=t.o.toString();null!=na&&(x.GrowFontsize=na);var wa=t.p.toString();null!=wa&&(x.ShrinkFontsize=wa);var Fa=t.q.toString();null!=Fa&&(x.FontColor=Fa);var pa=t.r.toString();null!=pa&&(x.FontHighlight=pa);var Ea=t.s.toString();null!=Ea&&(x.ParagraphStyle=Ea);var ta=t.t.toString();null!=ta&&(x.TextAlign=ta);var ia=t.u.toString();null!=ia&&(x.TextIndent=ia);var Ja=t.v.toString();null!=Ja&&(x.MarginLeft=Ja);var ab=t.w.toString();
null!=ab&&(x.ParagraphSpaceBefore=ab);var Oa=t.x.toString();null!=Oa&&(x.ParagraphSpaceAfter=Oa);var Za=t.y.toString();null!=Za&&(x.LineSpace=Za);var Na=t.z.toString();null!=Na&&(x.CellShadingColor=Na);break;case 3:B="SemanticEvents";var sa=t.a;null!=sa&&(x.SessionID=sa);var Sa=t.b.toString();null!=Sa&&(x.Text=Sa);var xb=t.c.toString();null!=xb&&(x.LineBreak=xb);var gc=t.d.toString();null!=gc&&(x.Image=gc);var zc=t.e.toString();null!=zc&&(x.File=zc);var Xb=t.f.toString();null!=Xb&&(x.FormattingChange=
Xb);var jb=t.g.toString();null!=jb&&(x.Anchor=jb);var zb=t.h.toString();null!=zb&&(x.Paragraph=zb);var Tb=t.i.toString();null!=Tb&&(x.Math=Tb);var Ya=t.j.toString();null!=Ya&&(x.List=Ya);var sb=t.k.toString();null!=sb&&(x.ListItem=sb);var oc=t.l.toString();null!=oc&&(x.RenderAugmentation=oc);var wb=t.m.toString();null!=wb&&(x.Span=wb);break;case 4:B="SemanticTableEvents";var rc=t.a;null!=rc&&(x.SessionID=rc);var Ka=t.b.toString();null!=Ka&&(x.Tables=Ka);var Db=t.c.toString();null!=Db&&(x.TableRow=
Db);var bc=t.d.toString();null!=bc&&(x.TableCell=bc);var Mc=t.e.toString();null!=Mc&&(x.TablePart=Mc);break;case 5:B="HtmlEvents";var mb=t.a;null!=mb&&(x.OperationId=mb);var Wa=t.b;null!=Wa&&(x.SourceApp=Wa);var db=t.c;null!=db&&(x.Browser=db);var ub=null==t.d?null:t.d.toString();null!=ub&&(x.Text=ub);var Lb=null==t.e?null:t.e.toString();null!=Lb&&(x.A=Lb);var Kb=null==t.f?null:t.f.toString();null!=Kb&&(x.Abbr=Kb);var uc=null==t.g?null:t.g.toString();null!=uc&&(x.Acronym=uc);var Yb=null==t.h?null:
t.h.toString();null!=Yb&&(x.Address=Yb);var Tc=null==t.i?null:t.i.toString();null!=Tc&&(x.Applet=Tc);var sc=null==t.j?null:t.j.toString();null!=sc&&(x.Area=sc);var Qb=null==t.k?null:t.k.toString();null!=Qb&&(x.B=Qb);var kb=null==t.l?null:t.l.toString();null!=kb&&(x.Base=kb);var Ib=null==t.m?null:t.m.toString();null!=Ib&&(x.Basefont=Ib);var eb=null==t.n?null:t.n.toString();null!=eb&&(x.Bdo=eb);var Rb=null==t.o?null:t.o.toString();null!=Rb&&(x.Big=Rb);var pc=null==t.p?null:t.p.toString();null!=pc&&
(x.Blockquote=pc);var Wc=null==t.q?null:t.q.toString();null!=Wc&&(x.Body=Wc);var Ic=null==t.r?null:t.r.toString();null!=Ic&&(x.Br=Ic);var nd=null==t.s?null:t.s.toString();null!=nd&&(x.Button=nd);var ob=null==t.t?null:t.t.toString();null!=ob&&(x.Caption=ob);var $b=null==t.u?null:t.u.toString();null!=$b&&(x.Center=$b);var Hc=null==t.v?null:t.v.toString();null!=Hc&&(x.Cite=Hc);var Pb=null==t.w?null:t.w.toString();null!=Pb&&(x.Code=Pb);var Yc=null==t.x?null:t.x.toString();null!=Yc&&(x.Col=Yc);var Rd=
null==t.y?null:t.y.toString();null!=Rd&&(x.Colgroup=Rd);var Gb=null==t.z?null:t.z.toString();null!=Gb&&(x.Dd=Gb);var Bb=null==t.ba?null:t.ba.toString();null!=Bb&&(x.Del=Bb);var dc=null==t.bb?null:t.bb.toString();null!=dc&&(x.Dfn=dc);var Xc=null==t.bc?null:t.bc.toString();null!=Xc&&(x.Dir=Xc);var Fb=null==t.bd?null:t.bd.toString();null!=Fb&&(x.Div=Fb);var kd=null==t.be?null:t.be.toString();null!=kd&&(x.Dl=kd);var od=null==t.bf?null:t.bf.toString();null!=od&&(x.Dt=od);var Gd=null==t.bg?null:t.bg.toString();
null!=Gd&&(x.Em=Gd);var Fd=null==t.bh?null:t.bh.toString();null!=Fd&&(x.Fieldset=Fd);var ee=null==t.bi?null:t.bi.toString();null!=ee&&(x.Font=ee);var Bf=null==t.bj?null:t.bj.toString();null!=Bf&&(x.Form=Bf);var be=null==t.bk?null:t.bk.toString();null!=be&&(x.Frame=be);var af=null==t.bl?null:t.bl.toString();null!=af&&(x.Frameset=af);var Ue=null==t.bm?null:t.bm.toString();null!=Ue&&(x.H=Ue);var qf=null==t.bn?null:t.bn.toString();null!=qf&&(x.Head=qf);var Xa=null==t.bo?null:t.bo.toString();null!=Xa&&
(x.Hr=Xa);var vb=null==t.bp?null:t.bp.toString();null!=vb&&(x.Html=vb);var cc=null==t.bq?null:t.bq.toString();null!=cc&&(x.I=cc);var wc=null==t.br?null:t.br.toString();null!=wc&&(x.Iframe=wc);var Ad=null==t.bs?null:t.bs.toString();null!=Ad&&(x.Img=Ad);var Md=null==t.bt?null:t.bt.toString();null!=Md&&(x.Input=Md);var Sd=null==t.bu?null:t.bu.toString();null!=Sd&&(x.Ins=Sd);var Le=null==t.bv?null:t.bv.toString();null!=Le&&(x.Isindex=Le);var fe=null==t.bw?null:t.bw.toString();null!=fe&&(x.Kbd=fe);var Vf=
null==t.bx?null:t.bx.toString();null!=Vf&&(x.Label=Vf);var Cd=null==t.by?null:t.by.toString();null!=Cd&&(x.Legend=Cd);var Sc=null==t.bz?null:t.bz.toString();null!=Sc&&(x.Li=Sc);var jg=null==t.ca?null:t.ca.toString();null!=jg&&(x.Link=jg);var mg=null==t.cb?null:t.cb.toString();null!=mg&&(x.Map=mg);var Pa=null==t.cc?null:t.cc.toString();null!=Pa&&(x.Math=Pa);var bb=null==t.cd?null:t.cd.toString();null!=bb&&(x.Menu=bb);var Fc=null==t.ce?null:t.ce.toString();null!=Fc&&(x.Meta=Fc);var yd=null==t.cf?null:
t.cf.toString();null!=yd&&(x.Noframes=yd);var ge=null==t.cg?null:t.cg.toString();null!=ge&&(x.Noscript=ge);var rb=null==t.ch?null:t.ch.toString();null!=rb&&(x.Object=rb);var gf=null==t.ci?null:t.ci.toString();null!=gf&&(x.Ol=gf);var Ab=null==t.cj?null:t.cj.toString();null!=Ab&&(x.Optgroup=Ab);var fc=null==t.ck?null:t.ck.toString();null!=fc&&(x.Option=fc);var kc=null==t.cl?null:t.cl.toString();null!=kc&&(x.P=kc);var ud=null==t.cm?null:t.cm.toString();null!=ud&&(x.Param=ud);var zd=null==t.cn?null:t.cn.toString();
null!=zd&&(x.Pre=zd);var Td=null==t.co?null:t.co.toString();null!=Td&&(x.Q=Td);var Me=null==t.cp?null:t.cp.toString();null!=Me&&(x.S=Me);var tf=null==t.cq?null:t.cq.toString();null!=tf&&(x.Samp=tf);var re=null==t.cr?null:t.cr.toString();null!=re&&(x.Script=re);var lh=null==t.cs?null:t.cs.toString();null!=lh&&(x.Select=lh);var ze=null==t.ct?null:t.ct.toString();null!=ze&&(x.Small=ze);var Je=null==t.cu?null:t.cu.toString();null!=Je&&(x.Span=Je);var Wh=null==t.cv?null:t.cv.toString();null!=Wh&&(x.Strike=
Wh);var Kg=null==t.cw?null:t.cw.toString();null!=Kg&&(x.Strong=Kg);var pd=null==t.cx?null:t.cx.toString();null!=pd&&(x.Style=pd);var Nc=null==t.cy?null:t.cy.toString();null!=Nc&&(x.Sub=Nc);var le=null==t.cz?null:t.cz.toString();null!=le&&(x.Sup=le);var Ye=null==t.da?null:t.da.toString();null!=Ye&&(x.Tables=Ye);var Zc=null==t.db?null:t.db.toString();null!=Zc&&(x.Tbody=Zc);var Jf=null==t.dc?null:t.dc.toString();null!=Jf&&(x.Td=Jf);var pg=null==t.dd?null:t.dd.toString();null!=pg&&(x.Textarea=pg);var gd=
null==t.de?null:t.de.toString();null!=gd&&(x.Tfoot=gd);var bd=null==t.df?null:t.df.toString();null!=bd&&(x.Th=bd);var Ne=null==t.dg?null:t.dg.toString();null!=Ne&&(x.Thead=Ne);var rf=null==t.dh?null:t.dh.toString();null!=rf&&(x.Title=rf);var Fh=null==t.di?null:t.di.toString();null!=Fh&&(x.Tr=Fh);var Ae=null==t.dj?null:t.dj.toString();null!=Ae&&(x.Tt=Ae);var Kf=null==t.dk?null:t.dk.toString();null!=Kf&&(x.U=Kf);var Mf=null==t.dl?null:t.dl.toString();null!=Mf&&(x.Ul=Mf);var vf=null==t.dm?null:t.dm.toString();
null!=vf&&(x.Var=vf);var eg=null==t.dn?null:t.dn.toString();null!=eg&&(x.Unknown=eg);break;case 6:B="List";var zf=t.a;null!=zf&&(x.SessionID=zf);var Nd=t.b.toString();null!=Nd&&(x.MaxListLevel=Nd)}x.Table=B;return Sys.Serialization.JavaScriptSerializer.serialize(x)};d.d(S,"a",function(){return n});class n{static get K9(){null==n.f5a&&(n.f5a=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return n.f5a}static get Jrg(){null==n.RId&&(n.RId=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return n.RId}static fR(z){h.ULS.sendTraceTag(5822145,307,50,z)}static O9f(z){const t={};t.a=z;t.b=0;t.c=0;t.d=0;t.e=0;t.f=0;return t}static Bfk(z){n.K9||n.fR(m(0,z))}static Ofe(z){const t={};t.a=z;t.b=0;t.c=0;return t}static Ahk(z){n.K9||n.fR(m(1,z))}static N9f(z,t){const x={};x.c=r.a[z];x.a=t;return x}static Afk(z,t){n.Jrg&&z&&(z.b=t,n.fR(m(5,z)))}static Jcg(z){const t={};t.a=z;t.b=0;t.c=0;t.d=0;t.e=0;t.f=0;t.g=0;t.h=0;t.i=0;t.j=0;
t.k=0;t.l=0;t.m=0;return t}static Ngk(z){n.K9||n.fR(m(3,z))}static Kcg(z){const t={};t.a=z;t.b=0;t.c=0;t.d=0;t.e=0;return t}static Ogk(z){n.K9||n.fR(m(4,z))}static Dbe(z,t){const x={};x.b=r.a[z];x.c=t;x.d=0;x.e=0;x.f=0;x.g=0;x.h=0;x.i=0;x.j=0;x.k=0;x.l=0;x.m=0;x.n=0;x.o=0;x.p=0;x.q=0;x.r=0;x.s=0;x.t=0;x.w=0;x.x=0;x.y=0;x.z=0;x.u=0;x.v=0;return x}static qfk(z,t){n.Jrg&&z&&(z.a=t,n.fR(m(2,z)))}static Unj(z){const t={};t.a=z;t.b=-1;return t}static Tfk(z){!n.K9&&z&&0<=z.b&&n.fR(m(6,z))}}n.f5a=null;n.RId=
null;Object(K.a)(n,"UsageEditor",null,[])},335:function(K,S,d){d.d(S,"a",function(){return r});var h=d(47),e=d(27);const r=m=>{if(h.a.Xa(m))return!1;var n=e.AFrameworkApplication.fa.Ha("PPTDisabledChangeGates");return n?(n=n.split(";"))&&0<n.length?0>Array.indexOf(n,m):!0:!1}},336:function(K,S,d){d.d(S,"a",function(){return h});class h{constructor(e){h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:
void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const r=h.getTypeNameFor(e);return r?[r,...h.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,r){if(!Array.isArray(r)||0===r.length)return!0;const m=h.getTypeNameFor(e);e=h.getBaseTypesFor(e);for(const n of r)if(n===m||0<=e.indexOf(n))return!0;return!1}static assign(e,r,m){if(m)for(const n of Object.keys(m))r[n]=m[n];r.H_=e.H_;return r}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},337:function(K,S,d){d.d(S,
"a",function(){return h});K=d(0);class h{constructor(){this.ve=this.eg=this.oe=this.Tf=0}p5i(e){return e.ve<this.eg&&this.ve<e.eg&&e.oe<this.Tf&&this.oe<e.Tf}gxb(e){return e.ve>=this.ve&&e.eg<=this.eg&&e.oe>=this.oe&&e.Tf<=this.Tf}g5i(e,r){return e>=this.V2f&&e<=this.Ose&&r>=this.O2f&&r<=this.Gse}mTa(){return 0>=this.mP||0>=this.WR}equals(e){return e.ve===this.ve&&e.eg===this.eg&&e.oe===this.oe&&e.Tf===this.Tf}clone(){return Object.assign(new h,{ve:this.ve,eg:this.eg,oe:this.oe,Tf:this.Tf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",
this.ve,this.eg,this.oe,this.Tf)}get mP(){return this.eg-this.ve}get WR(){return this.Tf-this.oe}get Ose(){return this.eg-1}get Gse(){return this.Tf-1}get V2f(){return this.ve}get O2f(){return this.oe}}Object(K.a)(h,"CellRange",null,[])},338:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"OAuthResult",null,[])},339:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.MW="data-copystatus";h.$Ra="data-copyfailedreason";h.Kp="data-clipservice-ccpid";h.version=
"data-clipservice-version";h.location="data-clipservice-location";h.OD="data-clipservice-dc";h.type="data-clipservice-type";h.dMe="data-clipservice-param";h.count="data-clipservice-count";h.WFa="data-clipservice-cut";h.UFa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.OEi="data-clipboardasbytes-url";h.dTh="wacserver";h.sessionId="data-SessionId";h.Olb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.cPj="data-willexpire";h.clg="ClipboardAsImage";
h.Py="data-pkey";Object(K.a)(h,"ClipServiceConstants",null,[])},340:function(K,S,d){d.d(S,"a",function(){return z});K=d(0);var h=d(32),e=d(51),r=d(18),m=d(34),n=d(461);class z{constructor(t,x,B,D){this.Tb=t;this.egb=x;this.uIa=B;this.GJ=D;if(!t)throw Error.argumentNull("m_graphIteratorFactory");if(!x)throw Error.argumentNull("m_outlineEditor");if(!B)throw Error.argumentNull("m_outlineElementNavigator");if(!D)throw Error.argumentNull("m_characterPropertiesEditor");}llj(t,x,B){t=this.plj(t,x,B);x=new r.a;
for(const D of t)x.add(e.a.create(D));return x}plj(t,x,B){const D=new h.GraphIterator;D.set(x);x=new r.a;this.wWc(t,D,B,!1,x);return x}wWc(t,x,B,D,w){let J=null;if(x&&(J=x.Ri())){do{switch(J.type){case 12:break;case 35:D&&this.wWc(t,x,B,D,w);break;case 14:B&&this.wWc(t,x,B,D,w);break;default:this.wWc(t,x,B,D,w)}if(t===J.type&&12===t){if(null===J)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");w.add(J)}}while(J=x.xp());x.Cc()}}v_e(t,x,B){for(const D of x){if(12===t&&(D.mA||
D.Rla&&0===D.vy().length)){x=this.Tb.Lc(D);D.deleteParagraph();this.egb.vW(x,!0);this.uIa.yi(x);x=x.currentNode;const w=m.ParagraphReader.textLength(x);x=e.a.createTextRange(x,0,w);this.GJ.replaceTextRange(x,"")}B.push(...this.llj(t,D,14===t).toArray())}}pNb(t,x,B){for(const D of x)this.v_e(t,D.yj(),B)}}z.r9=(t,x,B=!1)=>{const D=()=>{if(x){var w=B?x.lzb():x;t(w);n.a.instance.zrh(D)}};n.a.instance.DUd(D);return D};Object(K.a)(z,"ODSLGraphHelper",null,[])},341:function(K,S,d){d.d(S,"a",function(){return D});
K=d(0);var h=d(1253),e=d(42),r=d(488),m=d(159),n=d(39),z=d(58),t=d(28),x=d(992),B=d(993);class D{constructor(w){this.HE=w}get node(){return this.HE}get propertySet(){return this.HE}get jy(){if(1074135132===this.HE.Xe)return 0;if(1074135137===this.HE.Xe)return 1;t.a.J(18354962,802,10,"Invalid AppType {0}",r.a[this.HE.Xe]);return-1}get id(){return 0===this.jy?this.propertySet.sa(n.a.q_,null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(n.a.q_,null)}get MWf(){return this.propertySet.sa(e.a.GVd,
null)}get visibility(){return this.propertySet.sa(e.a.q0b,!1)}get width(){return this.propertySet.sa(e.a.coi,320)}get row(){return this.propertySet.sa(e.a.boi,0)}get Yng(){return this.propertySet.sa(m.a.isForUILessAction,!1)}get wya(){return this.propertySet.sa(e.a.qtb,null)}get version(){return this.propertySet.sa(e.a.OKc,null)}get store(){return this.propertySet.sa(e.a.NKc,null)}get storeType(){return this.propertySet.eb(n.a.n0b)}get ownerAddinSolutionId(){return this.propertySet.sa(n.a.Wfh,null)}get sharedRuntimeId(){return this.propertySet.sa(m.a.sharedRuntimeId,
null)}get settings(){const w={};x.a(this.node,(J,F)=>{B.b(F,w)});return w}get slideId(){return 0===this.jy?z.a.ax(this.HE.eb(n.a.sid),this.HE.eb(n.a.cid)):null}get shapeId(){const w=Object(h.a)(4,this.HE);return 0===this.jy&&w?w.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(n.a.ownerAddinStoreType,null)}get Qtb(){return this.propertySet.sa(n.a.Qtb,-1)}get V7a(){return this.propertySet.sa(n.a.V7a,null)}}Object(K.a)(D,"AppReader",null,[558])},342:function(K,S,d){d.d(S,"a",function(){return e});
K=d(0);var h=d(27);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ha("EditDocInClientUrl")}}Object(K.a)(e,"SmartLookupApplicationInterface",null,[])},343:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(1053);class e{constructor(r){this.Wq=new h.a;this.f4g=r}dJ(r){const m=r.id;let n=null;this.Wq.Gb(m)?n=this.Wq.ga(m):(this.f4g&&(n=this.f4g(r,()=>{this.q$k(m)})),n&&this.Wq.$(m,n));return n}hJ(r){r=r.id;return this.Wq.Gb(r)?this.Wq.ga(r):null}q$k(r){this.Wq.remove(r)}}
Object(K.a)(e,"ShapeComponentViewManager",null,[204])},351:function(K,S,d){var h=d(18),e=d(115),r=d(510),m=d(152),n=d(231);K=d(0);var z=d(212),t=d(28);class x{constructor(O,U,T,ca){this.type=O;this.stops=U;this.angle=T;this.jSk=ca}FV(){const O=z.b(this.stops,U=>U.FV()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",this.angle,O);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.jSk.FV(),O);t.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",
this.type));return n.Color.auto.FV()}static createLinearGradient(O,U){return new x(0,O,U,null)}static pQi(O,U){return new x(1,O,0,U)}}Object(K.a)(x,"GradientFill",null,[]);class B{constructor(O,U){this.left=O;this.top=U}FV(){return String.format("{0}% {1}%",this.left,this.top)}}Object(K.a)(B,"GradientPathCenter",null,[]);class D{constructor(O,U){this.color=O;this.position=U}FV(){return String.format("{0} {1}%",this.color.FV(),this.position)}}Object(K.a)(D,"GradientStop",null,[]);d.d(S,"a",function(){return w});
d.d(S,"g",function(){return J});d.d(S,"e",function(){return F});d.d(S,"b",function(){return L});d.d(S,"c",function(){return M});d.d(S,"f",function(){return Q});d.d(S,"d",function(){return C});const w=O=>{O?(O=e.a(O),O=Object.assign(new r.a,{blipFillField:O.blipFillField||null,gradFillField:O.gradFillField||null,grpFillField:O.grpFillField||null,noFillField:O.noFillField||null,pattFillField:O.pattFillField||null,solidFillField:O.solidFillField||null})):O=null;return O},J=O=>{m.Box4ColorHelper.XSa(O)},
F=O=>{O=e.a(O);return!O||!O.blipFillField&&!O.gradFillField&&!O.grpFillField&&!O.noFillField&&!O.pattFillField&&!O.solidFillField},L=O=>{m.Box4ColorHelper.XSa(O)},M=O=>{L(O);O&&(O.cell3DField=null,O.extLstField=null,O.lnBField=null,O.lnBlToTrField=null,O.lnLField=null,O.lnRField=null,O.lnTField=null,O.lnTlToBrField=null)},Q=(O,U)=>{if(!O)return null;var T=O.gsLstField;if(T){var ca=new h.a;for(const N of T)T=m.Box4ColorHelper.NSc(N),m.Box4ColorHelper.dcb(T)?t.a.J(18397184,822,15,"Encountered invalid gradient stop color."):
ca.add(new D(m.Box4ColorHelper.YH(T,U),N.posField/1E3));U=ca.toArray()}else U=null;if(O.linField)return ca=90,O.linField.angFieldSpecified&&(ca=(O.linField.angField/6E4+90)%360),x.createLinearGradient(U,ca);if(O.pathField)return ca=new B(50,50),O.pathField.fillToRectField&&(ca=new B(O.pathField.fillToRectField.lField/1E3,O.pathField.fillToRectField.tField/1E3)),x.pQi(U,ca);t.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");return x.createLinearGradient(U,90)},C=O=>e.b(O)},
355:function(K,S,d){K=d(0);var h=d(395),e=d(272),r=d(675),m=d(29),n=d(531);class z{}Object(K.a)(z,"ProofingFeedbackLoopRequestObject",null,[]);var t=d(532),x=d(35),B=d(530);d.d(S,"a",function(){return D});class D extends r.a{constructor(w,J,F,L,M=null){super(J);this.C7=w;this.u3h=F;this.L7h=L;this.rkf=!1;this.Ma=M;this.errorType=1===(this.C7.CritiqueActions&1)?0:1}get proofingType(){return n.b(this.C7)}get traceId(){return this.C7.TraceId}get NCf(){return this.C7.AnnotationId}get typeId(){return this.C7.TypeId}get UN(){return this.C7}get suggestions(){const w=
[];if(this.C7.Suggestions)for(const J of this.C7.Suggestions)w.push(J.Text);return w}get metadata(){const w=[];if(this.C7.Metadata&&0<this.C7.Metadata.length)for(const J of this.C7.Metadata)J.Name&&J.Value&&w.push(J);return w}XMa(w,J=0){this.rsf.track(()=>Object.assign(new t.a,{E:2,T:this.proofingType,A:w,I:J,G:this.typeId}));if(this.u3h){var F=e.a.He(this.lcid);let L="";F?L=F.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);F=null;h.ULS.sendTraceTag(39416218,
375,50,"Sending proofing context with feedback loop API");F=Object.assign(new z,{AppId:B.a[m.App.mode]+"_online",TraceId:this.traceId,LanguageId:L,CritiqueTypeId:this.typeId,EventId:this.Zxk(w),FlaggedText:this.token,SuggestionText:this.Axj(w),PreContextBegin:this.Kaa,PostContextEnd:this.AKa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.C7.Priority,Metadata:this.C7.Metadata});14!==F.EventId&&this.L7h.Wll(F)}}Zxk(w){switch(w){case x.a.ola:return 0;case x.a.xie:return 1;
case x.a.ODa:return 3;case x.a.Nza:return 4;case x.a.Oza:return 5;case x.a.Pza:return 6;case x.a.xwb:return 13;default:return 14}}Axj(w){switch(w){case x.a.Nza:return this.suggestions[0];case x.a.Oza:return this.suggestions[1];case x.a.Pza:return this.suggestions[2];case x.a.EMa:return this.suggestions[3];case x.a.FMa:return this.suggestions[4];default:return""}}get uFa(){return this.rkf}set uFa(w){this.rkf=w}}Object(K.a)(D,"EditorServiceErrorDetails",r.a,[344,345])},356:function(K,S,d){var h=d(275),
e=d(811),r=d(1283),m=d(47),n=d(210),z=d(27);K=d(0);class t{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(K.a)(t,"RecentColor",null,[]);var x=d(231),B=d(232),D=d(233),w=d(266),J=d(1077),F=d(546),L=d(28);d.d(S,"f",function(){return M});d.d(S,"e",function(){return Q});d.d(S,"d",function(){return C});d.d(S,"c",function(){return O});d.d(S,"g",function(){return U});d.d(S,"b",function(){return T});d.d(S,"a",function(){return ca});d.d(S,"h",function(){return N});const M=(Y,fa,aa,ka,H,ra,ha)=>
Q(Y,fa,aa,ka,H,ra,ha,!1),Q=(Y,fa,aa,ka,H,ra,ha,Ma)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:aa,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});ka=Object.assign(new e.a,{Id:ka,ExternalId:H,McuExternalId:String.format("{0}MCU",H),McuLayout:!0,Command:ra,Width:10});if(Y)if(H=[],1===ha||2===ha){Ma=(new J.a).fgj(Y);({themeColors:Y,XKh:ha}=da(Ma,Y));for(var Ga=0;6>Ga;Ga++)for(var na=0;na<Y.length;na++){ra=H;aa=ra.push;var wa=void 0,Fa=void 0;wa=Ma;var pa=Y[na][Ga];Fa=Y[na][0];var Ea=ha[na],
ta=Ga,ia=na;pa=m.a.vw(pa.r,2)+m.a.vw(pa.g,2)+m.a.vw(pa.b,2);({MNc:wa,KQb:Fa}=wa.sae(Fa,pa,Ea,ta,ia));pa=Object.assign(new r.a,{Color:"#"+wa,DisplayColor:"#"+pa,Alt:Fa});aa.call(ra,pa)}}else for(Ma=(new J.a).l7f(Y,Ma),{themeColors:Y,XKh:ha}=da(Ma,Y),Ga=0;6>Ga;Ga++)for(na=0;na<Y.length;na++)ra=H,aa=ra.push,wa=Ma,pa=Y[na][Ga],Fa=Y[na][0],Ea=ha[na],ta=Ga,ia=na,pa=m.a.vw(pa.r,2)+m.a.vw(pa.g,2)+m.a.vw(pa.b,2),{MNc:Fa,KQb:wa}=wa.sae(Fa,pa,Ea,ta,ia),{Chl:Fa,nkl:wa,KQb:pa}={Chl:pa,nkl:Fa,KQb:wa},pa=Object.assign(new r.a,
{Color:wa,DisplayColor:"#"+Fa,Alt:pa}),aa.call(ra,pa);else H=null;ka.Colors=H;Array.add(fa.ControlList,ka);return fa},C=(Y,fa,aa,ka,H,ra)=>{Y=Object.assign(new h.a,{Id:Y,ControlsId:fa,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});aa=Object.assign(new e.a,{Id:aa,ExternalId:ka,Command:H,Width:10,Colors:[]});ra?(aa.Colors.push(Object.assign(new r.a,{Color:"0000C0",Alt:m.a.ze(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),aa.Colors.push(Object.assign(new r.a,{Color:"0000FF",
Alt:m.a.ze(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),aa.Colors.push(Object.assign(new r.a,{Color:"00C0FF",Alt:m.a.ze(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),aa.Colors.push(Object.assign(new r.a,{Color:"00FFFF",Alt:m.a.ze(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),aa.Colors.push(Object.assign(new r.a,{Color:"50D092",Alt:m.a.ze(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),aa.Colors.push(Object.assign(new r.a,{Color:"50B000",
Alt:m.a.ze(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),aa.Colors.push(Object.assign(new r.a,{Color:"F0B000",Alt:m.a.ze(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),aa.Colors.push(Object.assign(new r.a,{Color:"C07000",Alt:m.a.ze(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),aa.Colors.push(Object.assign(new r.a,{Color:"602000",Alt:m.a.ze(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),aa.Colors.push(Object.assign(new r.a,{Color:"A03070",
Alt:m.a.ze(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(aa.Colors.push(Object.assign(new r.a,{Color:"#C00000",Alt:m.a.ze(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),aa.Colors.push(Object.assign(new r.a,{Color:"#FF0000",Alt:m.a.ze(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),aa.Colors.push(Object.assign(new r.a,{Color:"#FFC000",Alt:m.a.ze(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),aa.Colors.push(Object.assign(new r.a,{Color:"#FFFF00",
Alt:m.a.ze(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),aa.Colors.push(Object.assign(new r.a,{Color:"#92D050",Alt:m.a.ze(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),aa.Colors.push(Object.assign(new r.a,{Color:"#00B050",Alt:m.a.ze(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),aa.Colors.push(Object.assign(new r.a,{Color:"#00B0F0",Alt:m.a.ze(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),aa.Colors.push(Object.assign(new r.a,{Color:"#0070C0",
Alt:m.a.ze(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),aa.Colors.push(Object.assign(new r.a,{Color:"#002060",Alt:m.a.ze(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),aa.Colors.push(Object.assign(new r.a,{Color:"#7030A0",Alt:m.a.ze(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(Y.ControlList,aa);return Y},O=(Y,fa,aa,ka,H,ra,ha)=>{fa=Object.assign(new h.a,{Id:fa,ControlsId:aa,Title:ResourceStrings.L_RecentColors,ControlList:[]});ka=Object.assign(new e.a,
{Id:ka,ExternalId:H,Command:ra,Width:10,Colors:[]});if(ha)for(ha=0;Y&&ha<Y.length&&Y[ha];ha++)H=Y[ha],ka.Colors.push(Object.assign(new r.a,{Color:H.hex,Alt:m.a.ze(H.hex),DisplayColor:H.hex}));else for(ha=0;Y&&ha<Y.length&&Y[ha];ha++)H=Y[ha],ka.Colors.push(Object.assign(new r.a,{Color:"#"+H.hex,Alt:m.a.ze("#"+H.hex),DisplayColor:"#"+H.hex}));Array.add(fa.ControlList,ka);return fa},U=(Y,fa)=>{if(!fa)return Y;var aa=new t;aa.hex=fa;const ka=[];let H=0;ka[H++]=aa;for(aa=0;Y&&aa<Y.length&&10>aa&&10>H&&
Y[aa];aa++)Y[aa].hex!==fa&&(ka[H++]=Y[aa]);return ka},T=(Y,fa,aa,ka,H,ra,ha,Ma)=>{Y=Object.assign(new h.a,{Id:Y,ControlsId:fa,DisplayMode:"Menu16",ControlList:[]});aa=Object.assign(new n.a,{Command:aa,LabelText:ka,Image16by16:z.AFrameworkApplication.km,Image16by16Class:ha,Id:H,ExternalId:ra,KeyTip:Ma});Array.add(Y.ControlList,aa);return Y},ca=(Y,fa,aa,ka,H,ra,ha,Ma)=>{Y=Object.assign(new h.a,{Id:Y,ControlsId:fa,DisplayMode:"Menu16",ControlList:[]});aa=Object.assign(new n.a,{Command:aa,LabelText:ka,
Image16by16:z.AFrameworkApplication.km,Image16by16Class:ha,Id:H,ExternalId:ra,KeyTip:Ma});Array.add(Y.ControlList,aa);return Y},N=(Y,fa,aa)=>{for(let wa=0;wa<Y.MenuSectionList.length;wa++){var ka=Y.MenuSectionList[wa],H=ka.ControlList;if(H&&0<H.length&&(H=H[0]))if(fa)if(ka.Id===F.a.themeColors&&aa){var ra=D.i(fa.ND)||"";ka=aa;var ha=H.Colors,Ma="#";if(ha&&ha.length)if(m.a.Xa(ra))L.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var Ga=0;Ga<ha.length;Ga++){var na=
ha[Ga].Color;if(!m.a.Xa(na)&&(na=(na=B.a.parse(ha[Ga].Color))?na.Fwc():w.SchemeColor.parse(ha[Ga].Color),ka&&na&&na.VVe(ka)&&na.qua&&(na=D.i(na.tQ),na.toLowerCase()===ra.toLowerCase()))){Ma=ha[Ga].Color;break}}ka=Ma;H.SelectedColorId=ka}else{ha=D.i(D.g(fa.ND))||"";ka=H.Colors;ra="#";if(ka&&ka.length)if(m.a.Xa(ha))L.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ma=0;Ma<ka.length;Ma++)if(Ga=ka[Ma].DisplayColor,!m.a.Xa(Ga)&&Ga.replace("#","").toLowerCase()===
ha.toLowerCase()){ra=ka[Ma].Color;break}ka=ra;H.SelectedColorId=ka}else H.SelectedColorId="#"}},da=(Y,fa)=>{let aa;aa=Array(10);aa[0]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Background1));aa[1]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Text1));aa[2]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Background2));aa[3]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Text2));aa[4]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Accent1));aa[5]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Accent2));aa[6]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Accent3));
aa[7]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Accent4));aa[8]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Accent5));aa[9]=Y.FL(x.Color.fj(fa.PresetSchemeColorMapping.Accent6));Y=Array(10);Y[0]=ResourceStrings.l_ThemeLabel1;Y[1]=ResourceStrings.l_ThemeLabel2;Y[2]=ResourceStrings.l_ThemeLabel3;Y[3]=ResourceStrings.l_ThemeLabel4;Y[4]=ResourceStrings.l_ThemeLabel5;Y[5]=ResourceStrings.l_ThemeLabel6;Y[6]=ResourceStrings.l_ThemeLabel7;Y[7]=ResourceStrings.l_ThemeLabel8;Y[8]=ResourceStrings.l_ThemeLabel9;
Y[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:aa,XKh:Y}}},385:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.wOf="CU";h.oHi="CS";h.lHi="CE";h.yse="KP";h.ZJl="TI";h.Mfk="L";Object(K.a)(h,"CharacterBlockTrackerKeys",null,[])},386:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(36);class e{constructor(r,m){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=r;this.Flight=m}serialize(){return h.c([this.ul(),this])}}Object(K.a)(e,"ACommonHandlerRequest",
null,[])},387:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Bha=1E5;Object(K.a)(h,"ViewConstants",null,[])},388:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Owc="ToolbarButton";h.JQb="ToolbarButtonHome";h.insertPicture="InsertPicture";h.P4e="SlideNavigationDesignMode";h.Jkb="Retrigger";h.refresh="Refresh";h.typing="Typing";h.EUf="DesignElementsDeleted";h.FZd="ChangeSlideSize";h.Dtb="ApplyTheme";h.K4e="SlideChangeLayout";h.boa="NewSlide";h.zZd="ChangeIconInSmartArt";
h.Uub="ChangeIcon";h.insertTable="InsertTable";h.eya="PasteTable";h.b0c="InsertChart";h.ZVd="ApplyReplaceObject";h.moreIdeas="MoreIdeas";h.newDocument="NewDocument";h.w4d="DesignTab";h.makeItVisual="MakeItVisual";h.mKa="PasteText";h.m1d="ConvertedToPPT";h.kVd="AgendaToPPT";Object(K.a)(h,"DesignerTrigger",null,[])},389:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.w2a=this.lea=this.zV=null;this.n3c=this.Wlb=!1;this.aQe=0;this.Wb=null;this.jcc=this.Dog=this.icc=!1;
this.reset()}reset(){this.lea=[];this.zV=null;this.w2a=[];this.n3c=this.Wlb=!1;this.aQe=0;this.Wb=null;this.jcc=this.Dog=this.icc=!1}}Object(K.a)(h,"HtmlPasteContext",null,[])},394:function(K,S,d){K=d(0);var h=d(56),e=d(27),r=d(47),m=d(103),n=d(1281),z=d(7),t=d(1253),x;(function(Y){Y[Y.none=0]="none";Y[Y.noSystemClipboardAccess=1]="noSystemClipboardAccess";Y[Y.cutCopyDisallowed=2]="cutCopyDisallowed";Y[Y.pasteDisallowed=3]="pasteDisallowed";Y[Y.invalidPasteContext=4]="invalidPasteContext";Y[Y.invalidCcpOperation=
5]="invalidCcpOperation";Y[Y.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";Y[Y.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";Y[Y.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";Y[Y.noShapesPasted=9]="noShapesPasted";Y[Y.invalidImagePasteArgs=10]="invalidImagePasteArgs";Y[Y.invalidClipboardData=11]="invalidClipboardData";Y[Y.invalidCopiedShapes=12]="invalidCopiedShapes";Y[Y.invalidCopiedSlides=13]="invalidCopiedSlides";Y[Y.invalidHtmlContent=14]="invalidHtmlContent";Y[Y.textEditFailed=
15]="textEditFailed";Y[Y.clipServiceDataInvalid=16]="clipServiceDataInvalid";Y[Y.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";Y[Y.imageTooLarge=18]="imageTooLarge";Y[Y.noAvailablePasteHandler=19]="noAvailablePasteHandler";Y[Y.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";Y[Y.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";Y[Y.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";Y[Y.copyObjectEmpty=23]="copyObjectEmpty";Y[Y.tableInvalid=24]="tableInvalid";Y[Y.copyObjectHasDeferredContent=
25]="copyObjectHasDeferredContent";Y[Y.userOffline=26]="userOffline";Y[Y.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";Y[Y.picklingInvalidCopyData=28]="picklingInvalidCopyData";Y[Y.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";Y[Y.chunkUploaderFailure=30]="chunkUploaderFailure";Y[Y.pasteCancelledByUser=31]="pasteCancelledByUser";Y[Y.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(x||(x={}));Object(K.b)("CcpFailure",x);var B=d(955),D=d(115),w=d(28),
J=d(339),F;(function(Y){Y[Y.none=0]="none";Y[Y.text=1]="text";Y[Y.shape=2]="shape";Y[Y.textbox=3]="textbox";Y[Y.normalShape=4]="normalShape";Y[Y.image=5]="image";Y[Y.table=6]="table";Y[Y.chart=7]="chart";Y[Y.video=8]="video";Y[Y.list=9]="list";Y[Y.ink=10]="ink";Y[Y.addin=11]="addin";Y[Y.smartArt=12]="smartArt";Y[Y.group=13]="group";Y[Y.placeholder=14]="placeholder";Y[Y.line=15]="line";Y[Y.activeX=16]="activeX";Y[Y.oleObject=17]="oleObject";Y[Y.media=18]="media";Y[Y.slide=19]="slide";Y[Y.mixed=20]=
"mixed"})(F||(F={}));Object(K.b)("ClipboardContentType",F);var L;(function(Y){Y[Y.keyboard=0]="keyboard";Y[Y.menu=1]="menu";Y[Y.floatie=2]="floatie";Y[Y.ribbon=3]="ribbon"})(L||(L={}));Object(K.b)("ClipboardMethod",L);var M;(function(Y){Y[Y.copy=0]="copy";Y[Y.cut=1]="cut";Y[Y.paste=2]="paste"})(M||(M={}));Object(K.b)("ClipboardOperation",M);var Q;(function(Y){Y[Y.other=0]="other";Y[Y.pptOnline=1]="pptOnline";Y[Y.pptOnlineSameSession=2]="pptOnlineSameSession";Y[Y.pptOnlineCrossSession=3]="pptOnlineCrossSession";
Y[Y.wordOnline=4]="wordOnline";Y[Y.xlOnline=5]="xlOnline";Y[Y.oneNoteOnline=6]="oneNoteOnline";Y[Y.pptWin32=7]="pptWin32";Y[Y.wordWin32=8]="wordWin32";Y[Y.xlWin32=9]="xlWin32";Y[Y.oneNoteWin32=10]="oneNoteWin32";Y[Y.googleDocs=11]="googleDocs";Y[Y.pptDesktop=12]="pptDesktop";Y[Y.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(Q||(Q={}));Object(K.b)("ClipboardSource",Q);class C{constructor(){this.data={};this.IGf=!1;this.wmb=null}}Object(K.a)(C,"TelemetryEntry",null,[]);var O=d(1074),U=d(441),
T=d(43),ca=d(30),N=d(72);d.d(S,"a",function(){return da});class da{constructor(Y,fa,aa,ka,H,ra,ha,Ma,Ga,na,wa,Fa){this.SAg=h.a.mz;this.k_g=this.OHg=this.a8c="";this.LR=Y;this.lR=fa;this.Xv=new N.a;this.paa=new N.a;ka.TQa(Object(z.a)(this,this.BOe,"onRevisionProcessedOnServer"));H.hja(Object(z.a)(this,this.sMl,"trackSlideCcpRevision"));ra.hja(Object(z.a)(this,this.rMl,"trackShapeCcpRevision"));ha.hja(Object(z.a)(this,this.oMl,"trackParagraphCcpRevision"));Ma.hja(Object(z.a)(this,this.nMl,"trackNotesCcpRevision"));
Ga&&Ga.hja(Object(z.a)(this,this.pMl,"trackPresentationCcpRevision"));this.CH=wa;this.ia=na;this.yzg=aa.Pvd;this.Tv=Fa;if(Y=e.AFrameworkApplication.Md)this.OHg=Object(t.a)(String,Y.Host)||"",this.k_g=Object(t.a)(String,Y.Ring)||"",this.a8c=Object(t.a)(String,Y.WACDatacenter)||""}rCb(Y){return this.Xv.Gb(Y)}jC(Y,fa){r.a.Xa(fa)||(this.rCb(fa)?da.contentType in this.Xv.ga(fa).data&&!this.EYj(fa,Y)||this.rW(da.contentType,F[Y],fa):w.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+
fa))}Mab(Y,fa){if(!this.Xv.Gb(Y))return null;let aa=null;if(this.Xv.ga(Y)&&!(fa in this.Xv.ga(Y).data))switch(fa){case da.contentType:aa="none";break;case da.source:aa="other"}return aa?aa:this.Xv.ga(Y).data[fa].toString()}KVc(Y){return this.Mab(Y,da.contentType)}e7f(Y){return this.Mab(Y,da.source)}Ifj(Y){return this.Mab(Y,da.operation)}zcc(Y){return"xlOnline"===this.e7f(Y)&&"chart"===this.KVc(Y)}e4c(Y){return"slide"===this.KVc(Y)&&"paste"===this.Ifj(Y)}LQk(Y){const fa=F;for(let ka in fa){var aa=
fa[ka];if(ka.toLowerCase()===Y.toLowerCase())return aa}return 0}MQk(Y){const fa=Q;for(let ka in fa){var aa=fa[ka];if(ka.toLowerCase()===Y.toLowerCase())return aa}return 0}EYj(Y,fa){Y=this.LQk(this.Xv.ga(Y).data[da.contentType].toString());return fa>Y}Yw(Y,fa){r.a.Xa(fa)||(this.rCb(fa)?da.source in this.Xv.ga(fa).data&&!this.F7j(fa,Y)||this.rW(da.source,Q[Y],fa):w.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+fa))}F7j(Y,fa){Y=this.MQk(this.Xv.ga(Y).data[da.source].toString());
return fa>Y}li(Y,fa,aa){r.a.Xa(aa)||this.rW(Y,fa,aa)}BP(Y,fa,aa){const ka=T.a.Kb&&!r.a.Xa(T.a.Kb.actionName)?T.a.Kb.actionName:aa,H=m.a.create().toString();this.Xv.$(H,Object.assign(new C,{wmb:this.LR.Ii("UserAction","ClipboardTelemetry")}));this.rW(da.MKf,H,H);this.rW(da.actionName,ka,H);this.rW("ActualActionName",aa,H);this.rW("CcpOperation",M[Y],H);this.rW("CcpMethod",L[fa],H);this.rW("CcpBrowser",this.SAg,H);this.rW("CcpHost",this.OHg,H);this.rW("CcpDatacenter",this.a8c,H);this.rW("CcpRing",this.k_g,
H);w.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.SAg,H,L[fa],M[Y],ka);return H}Lg(Y,fa,aa=0){if(r.a.Xa(fa))w.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(r.a.Xa(fa)||!this.rCb(fa))w.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",fa);else{var ka=this.Xv.ga(fa);this.rW("CcpTotalMs",ka.wmb.er.toString(),fa);this.rW(da.NKf,Y.toString(),
fa);0!==aa&&(this.rW("CcpFailureReason",x[aa],fa),this.zcc(fa)?16===aa?this.CH.kba(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.Dub,!1,null):(Y=Object.assign(new U.a(!0),{Wb:fa}),this.CH.kba(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,ca.a.RPf,ca.a.r1d,null,Y,!0,da.Dub,!1,null)):
25===aa&&(w.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",fa),this.CH.kba(ResourceStrings.l_DeferredContentPasteDialogTitle,ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,da.Dub,!1,null)));w.a.J(50733397,826,50,D.c(ka.data));this.zcc(fa)||this.e4c(fa)||this.Xv.remove(fa)}}Gtl(Y,fa){r.a.Xa(fa)||(this.Yw(0,fa),this.WAh(Y,fa,0))}WAh(Y,fa,aa){if(Y){if(aa>=O.a.WLc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",
O.a.WLc));if(1===Y.nodeType){for(var ka=Y.firstChild;ka;)this.WAh(ka,fa,aa+1),ka=ka.nextSibling;this.G1e(Y,fa)}}}G1e(Y,fa){const {ClipboardHelper:aa}=d(729);if(!r.a.Xa(fa))if(!this.rCb(fa))w.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+fa);else if(Y)if("head"===Y.tagName.toLowerCase()){var ka=this.lR.p0f(Y);r.a.Xa(ka)||this.mtl(ka,fa)}else{ka=0;var H=Y.getAttribute(J.a.sessionId);H?ka=aa.Htg(H.toString())?2:3:Y.getAttribute(B.a.kTf)?ka=5:Y.getAttribute(B.a.lTf)||
Y.getAttribute(B.a.pTf)?ka=1:Y.id&&Y.id.startsWith&&Y.id.startsWith(B.a.Xfg)&&(ka=11);if(Y.className&&Y.className.split)for(const ra of Y.className.split(" "))if(ra.startsWith(h.a.e1b)&&ra.length===h.a.e1b.length+1&&(Y=parseInt(r.a.substring(ra,ra.length-1,ra.length)),isNaN(Y)||this.rW("CcpSourceBrowser",n.a[Y],fa)),0===ka)if(ra.startsWith(B.a.ijh))ka=1;else if(ra.startsWith(B.a.Xeh))ka=6;else if(ra.startsWith(B.a.zTh))ka=4;else if(ra===B.a.A7g||ra===B.a.B7g)ka=8,this.jC(9,fa);0!==ka&&this.Yw(ka,
fa)}}mtl(Y,fa){switch(Y){case "PowerPoint.Slide":this.Yw(7,fa);break;case "Word.Document":this.Yw(8,fa);break;case "Excel.Sheet":this.Yw(9,fa);break;case "OneNote.File":this.Yw(10,fa)}}rW(Y,fa,aa){this.Xv.Gb(aa)&&(this.Xv.ga(aa).data[Y]=fa)}BOe(Y,fa){fa.GD&&!r.a.Xa(fa.GD.Id)&&this.paa.Gb(fa.GD.Id)&&this.TYf(fa.GD.Id,!fa.GD.Error,fa.GD.Error?fa.GD.Error.Code:0)}sMl(Y,fa){this.Swc(aa=>{let ka=null;if(aa=Object(t.a)(116,aa.node))ka=aa.Wb,aa.Wb=null;return ka},fa)}rMl(Y,fa){this.Swc(aa=>{let ka=null;
if(aa=Object(t.a)(4,aa.node))ka=aa.Wb,aa.Wb=null;return ka},fa)}oMl(Y,fa){this.Swc(aa=>{let ka=null;if(aa=Object(t.a)(5,aa.node))ka=aa.Wb,aa.Wb=null;return ka},fa)}nMl(Y,fa){this.Swc(aa=>{let ka=null;if(aa=Object(t.a)(302,aa.node))ka=aa.Wb,aa.Wb=null;return ka},fa)}pMl(Y,fa){this.Swc(aa=>{let ka=null;if(aa=Object(t.a)(347,aa.node))ka=aa.Wb,aa.Wb=null;return ka},fa)}Swc(Y,fa){fa.revisionId&&fa.node&&(Y=Y(fa),r.a.Xa(Y)||this.vHh(fa.revisionId.toString(),Y))}vHh(Y,fa){r.a.Xa(Y)||r.a.Xa(fa)||this.paa.$(Y,
fa)}TYf(Y,fa,aa){if(!r.a.Xa(Y)&&this.paa.Gb(Y)){this.yzg&&"pptDesktopWithDataUpload"===this.e7f(this.paa.ga(Y))&&this.Tv.x6d();var ka={};ka[da.MKf]=this.paa.ga(Y);ka[da.NKf]=fa;ka[da.QEi]=aa;this.zcc(this.paa.ga(Y))?(ka[da.source]="xlOnline",ka[da.contentType]="chart",0!==aa&&(fa=Object.assign(new U.a(!0),{Wb:this.paa.ga(Y)}),this.CH.kba(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,
ca.a.RPf,ca.a.r1d,null,fa,!0,da.Dub,!1,null))):433===aa?(this.e4c(this.paa.ga(Y))&&this.ia.processAction(ca.a.TI,2),this.CH.kba(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,!1,null,!1,null,0,0,null,null,!0,da.Dub,!1,null)):434===aa&&(this.e4c(this.paa.ga(Y))&&(this.yzg?this.ia.processAction(ca.a.k4d,2):this.ia.processAction(ca.a.TI,2)),this.CH.kba(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,
null,!1,null,0,0,null,null,!0,da.Dub,!1,null));w.a.J(50733400,826,50,D.c(ka));(this.zcc(this.paa.ga(Y))||this.e4c(this.paa.ga(Y)))&&this.Xv.remove(this.paa.ga(Y));this.paa.remove(Y)}}rXj(Y){return!r.a.Xa(Y)&&this.Xv.Gb(Y)?this.Xv.ga(Y).IGf:!1}Ilc(Y){r.a.Xa(Y)||(this.rCb(Y)?this.Xv.ga(Y).IGf=!0:w.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+Y))}}da.source="CcpSource";da.contentType="CcpContentType";da.operation="CcpOperation";da.NKf="CcpSuccess";da.actionName=
"ActionName";da.Dub=20;da.MKf="CcpCorrelation";da.LLi="CcpCopyIframeContent";da.OMf="ClipServiceThrottled";da.LKf="data-corr-id";da.Kp="CcpId";da.QEi="ClipServiceFailureReason";Object(K.a)(da,"ClipboardTelemetry",null,[348])},401:function(K,S,d){K=d(0);var h=d(47),e=d(199),r=d(1261),m=d(1253),n=d(59);class z{constructor(){this.shapeType=this.UJe=this.R5g=this.s9g=this.r9g=0;this.qr=this.jq=this.Pp=this.tj=!1;this.rLc=null}}Object(K.a)(z,"ShapeProperties",null,[]);var t=d(28),x=d(43),B=d(105),D=d(217);
d.d(S,"a",function(){return w});class w{constructor(J,F,L,M,Q,C,O,U,T){this.sr=J;this.wk=F;this.Ga=O;this.Red=C.Oyl;this.Ksk=this.MQi();this.qq=L;this.uM=M;this.We=Q.Na;this.xR=C.cva;this.wok=C.cAa;this.Sb=T}ohh(J,F,L,M,Q,C=null){if(F){var O=this.Ga.cab(L);O&&(Array.remove(L,O),Array.add(L,this.Ga.Lr(O)));this.GGh(L);var U=L.length;O=Array(U);M=this.Bag(F,M);for(var T=0;T<U;T++){var ca=L[T],N=this.Ipj(ca,M);O[T]=Object.assign(new z,{r9g:N.x,s9g:N.y,R5g:ca.Ix,UJe:ca.iD,shapeType:ca.shapeType,tj:ca.tj,
Pp:ca.Pp||2===ca.mediaType||1===ca.mediaType,jq:ca.xd,qr:ca.qr,rLc:""});O[T].tj&&(N=Object(m.a)(117,ca.qc(this.We)),O[T].rLc=N?N.Svd:"",t.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",ca.she,this.uM.pX(ca),0<O[T].rLc.length))}T=F.Cb;ca=F.Cs();N=[];M=!0;var da=J.mj===F.mj,Y=J.Qn===F.Qn,fa=!1;J!==F&&(da?(fa=J.rbb||F.rbb,Y||(fa=J.jbb||F.jbb||fa),M=!fa):M=!1,M&&this.xR&&(J.Xp!==F.Xp||J.Xk!==F.Xk)&&(M=!1));for(var aa=0;aa<U;aa++)this.Nyl(L[aa])||(N.push(L[aa]),M&&(M=this.Nwl(L[aa],
Y)));L=N;t.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:M,["SameSlide"]:J===F,["SameMaster"]:da,["SameLayout"]:Y,["ThemeOverrides"]:fa});U=[];aa=fa=Y=da=N=!1;for(let ka=0;ka<L.length;ka++){const H=O[ka];let ra=this.wk.VNi(T.cid,T.sid,H.r9g,H.s9g,H.R5g,1>H.UJe?1:H.UJe,ca+L[ka].get_zIndex(),J.id,L[ka],H.shapeType,H.tj,H.rLc,M);h.a.Xa(C)||(ra.Wb=C);U.push(ra);N=N||H.tj;da=da||H.Pp;Y=Y||H.jq;fa=fa||H.qr;aa=aa||this.wok&&w.B4j(ra)}Q=w.Fth(N,da,Y,fa,aa,Q);if(0<U.length&&(J=M?L:null,this.sr.HT(U,F,
Q,J),M&&x.a.Kb)){if(J){F="";for(const ka of J)F+=this.Ga.F8b(ka)+",";x.a.Kb.Wa(B.a.ELi,F);x.a.Kb.Wa(B.a.svl,J.length.toString())}x.a.Kb.Qj=!0;x.a.Kb.WOb=!0}}}fTi(J,F,L,M,Q,C){var O=this.Bag(J,L);L=[];const U=F.Qmc,T=!!U&&!e.a.Xa(U.Wtg);C=this.Hpj(C,O);for(O=0;O<F.objectCount;O++){const ca=this.wk.hNi(J.cid,J.sid,C.x,C.y,Q);ca.isEditable=T&&U.Wtg[O];L.push(ca)}0<L.length&&this.sr.HT(L,J,M)}Hpj(J,F){const L=F*w.nT;F*=w.nT;let M=new n.a(L,F);J&&(M=this.Sb.Uka(J.clientWidth,J.clientHeight))&&(M.x+=L,
M.y+=F);return M}Nyl(J){return J.mA&&this.Red||!J.mpg}Nwl(J,F){return J.she||this.uM.pX(J)||J.Ik&&J.hasText&&!F&&10!==J.Cj&&12!==J.Cj||J.nr?!1:!0}GGh(J){J.sort((F,L)=>F.get_zIndex()-L.get_zIndex())}o5j(J){return J?this.Ksk.contains(J):!1}Bag(J,F){if(!J)return 0;if(!F)return w.bxi;let L,M;return F.$(L=J.Cb,(M=F.ga(L))+1),M}Ipj(J,F){var L=this.qq.presentation;if(!L)throw Error.argumentNull("Presentation is null");let M=J.My,Q=J.Ny;J=L.hwj(L.XC(J.slideId));L=Math.round(w.nT/J)*J;J=r.a.gf(L,0);for(L=
r.a.gf(L,1);0<F;)M+=J,Q+=L,F--;return new n.a(M,Q)}zOl(J){try{if(J&&J.clipboardData){const F=J.clipboardData.types;for(let L=0;L<F.length;L++){const M=J.clipboardData.getData(F[L]);if(this.FXj(M))return M}}}catch(F){}return null}FXj(J){return!!J&&0<J.length&&this.v9j(J)}v9j(J){J=J.trim().toLowerCase();return J.startsWith("http:")||J.startsWith("https:")}hql(J,F,L){J&&(J.setAttribute(w.zIf,F.toString()),J.setAttribute(w.yIf,L.toString()),J.setAttribute(w.AIf,"true"))}MQi(){const J=new D.a;J.add("param");
J.add("map");J.add("area");J.add("script");J.add("noscript");J.add("col");J.add("colgroup");J.add("caption");J.add("head");J.add("title");J.add("link");J.add("meta");J.add("style");J.add("base");J.add("input");J.add("textarea");J.add("select");J.add("option");J.add("optgroup");J.add("button");J.add("hr");return J}jmj(J){return this.DNh(J,w.zIf)}bmj(J){return this.DNh(J,w.yIf)}Z0j(J){return J?"true"===J.getAttribute(w.AIf):!1}jOl(J){if(this.mug(J)){const F=J.indexOf('"')+1,L=J.lastIndexOf('"');if(1<
F&&L>F&&(J=J.slice(F,L),J.startsWith(w.kxi)))return J}return null}mug(J){return!!J&&J.length>w.Mxi&&J.startsWith(w.lxi)}DNh(J,F){let L=0;this.Z0j(J)&&(L=parseFloat(J.getAttribute(F)));return isNaN(L)?0:L}UYd(J){return this.VYd(J).returnValue}VYd(J){let F;F=2;let L=0,M=0,Q=0,C=0,O=0,U=0,T=0,ca=0,N=0,da=0,Y=0,fa=0,aa=0,ka=0,H=0,ra=0,ha=0;for(const Ma of J)Ma.xd?(F=2===F?6:20,L++):Ma.Wf?(F=2===F?12:20,M++):Ma.qr?(F=2===F?7:20,Q++):Ma.Of?(F=2===F?13:20,C++):22===Ma.H9b?(F=2===F?10:20,O++):Ma.tj?(F=2===
F?5:20,U++):Ma.Gw?(F=2===F?3:20,T++):Ma.x0?(F=2===F?14:20,Ma.mA&&N++,ca++):Ma.Ik?(F=2===F?14:20,Ma.mA&&Y++,da++):Ma.wz?(F=2===F?15:20,fa++):Ma.mX?(F=2===F?16:20,aa++):Ma.Pp?(F=2===F?18:20,ka++):Ma.nr?(F=2===F?11:20,H++):Ma.N9?(F=2===F?17:20,ra++):(F=2===F?4:20,ha++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",
J.length,L,M,Q,C,O,U,T,ca,N,da,Y,fa,aa,ka,H,ra,ha),contentType:F}}static rll(J){for(const F of J)if(!F.mpg||F.isLocal)return!1;return!0}static B4j(J){return J&&4===J.mL?(!J.fill||!!J.fill.noFillField)&&(!J.lineStyle||!!J.lineStyle.noFillField):!1}static Fth(J,F,L,M,Q,C){return J||F||L||M||Q?C:0}}w.AIf="data-from-ppt-online";w.zIf="data-image-width-mu";w.yIf="data-image-height-mu";w.kxi="data:image/";w.lxi="<img src=";w.Mxi=14;w.bxi=1;w.nT=15;Object(K.a)(w,"CopyPasteUtility",null,[454])},443:function(K,
S,d){d.d(S,"a",function(){return e});K=d(0);S=d(324);var h=d(138);class e extends S.a{constructor(){super();this.timestamp=this.targetObject=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}}Object(K.a)(e,"Signal",S.a,[])},444:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.open="open";h.refresh="refresh";h.QZe="saveAs";h.translate="translate";h.modeSwitch="modeSwitch";
h.JPi="createNew";h.convert="convert";Object(K.a)(h,"ReasonList",null,[])},445:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.func=this.outputSchema=this.inputSchema=this.name=null}}Object(K.a)(h,"Lambda",null,[1003])},446:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Wuc="SlideTextTile";h.r2e="ShapeTextTile";Object(K.a)(h,"AugmentationSchemas",null,[])},447:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d(27);class h{static vb(){}static P1(e,
r,m,n,z){return 1===m?32:h.a_k(e,z)?32:8}static sH(e,r,m,n,z){return 1===m?32:h.jDk(e,z)?32:8}static jDk(e,r){const m=h.cZh[e.toString()];if(void 0===m||null===m)return!1;m(e,r);return!0}static a_k(e,r){const m=h.gZh[e.toString()];if(void 0===m||null===m)return!1;m(e,r);return!0}}h.cZh={};h.gZh={};Object(K.a)(h,"DialogCuiControlActor",null,[])},448:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.description=this.title=this.vQ=this.N1=null}}Object(K.a)(h,"CpContentDetails",
null,[474])},449:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(103);class e{constructor(){this.DCf=!1;this.sessionId=this.RMf=null;this.G8a=e.lcj()}static lcj(){return"CID"+h.a.create().toString()}static Png(r){return r&&r.length?r.startsWith("CID")&&h.a.isValid(r.substring(3,r.length))?!0:!1:!1}}Object(K.a)(e,"InternalClipboardObject",null,[])},450:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(449);class h extends d.a{constructor(e){super();this.$c=e}get hsg(){return!this.$c||
!this.$c.isConnected}get id(){return this.$c.id}get isConnected(){return this.$c.isConnected}}Object(K.a)(h,"InternalClipboardSlide",d.a,[])},451:function(K,S,d){d.d(S,"a",function(){return e});var h=d(107);const e=(r,m,n)=>{const z=new h.StandardDialog;z.Ad=0;z.zP(r,m,n);return z}},452:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"SmartLookupSelection",null,[])},463:function(K,S,d){K=d(0);var h=d(395),e=d(7),r=d(27),m=d(182),n=d(79),z=d(67),t=d(176),x=d(93),B=d(175);
d(69);class D{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(K.a)(D,"MessageBarProps",null,[]);class w{constructor(U,T){this.onExecute=this.label=this.type=null;this.label=U;this.type="AppButtonProps";this.onExecute=T}}Object(K.a)(w,"AppButtonProps",null,[]);var J=d(143),F=d(804),L=d(141),
M=d(203),Q=d(103),C=d(37);d.d(S,"a",function(){return O});class O{constructor(U,T,ca){this._message=this.xC=null;this.WId=this.Rob=!1;this.GCd=0;this.fia="";this.JS=0;this.tF=this.zS=this.tqa=this.K7=this.t5a=this.SSb=this.RSb=this.QSb=this.PSb=this.EN=this.u7=this.Jra=this.SOa=null;this.Job=this.Iob=!1;this.Xdf=this.ZCd="";this.XCd=!1;this.Ydf=this.cDd="";this.aDd=!1;this.bDd=this.YCd=null;this.FWb=!1;this.fof=this.Dqb="";this.s5a=null;this.MVb=this.Skf=!1;this.nDa=this.KW=this.mea=this.WP=this.businessBar=
null;this.errorCode=0;this.KCf=this.visible=!1;this.title=U;this.message=T;this.Pac=ca;this.id=0;this.image=1;this.R2c=!0;this.aGf=5}get htmlElement(){return this.WP}get R2c(){return this.WId}set R2c(U){this.WId=U}get aGf(){return this.GCd}set aGf(U){this.GCd=U}get title(){return this.xC}set title(U){this.xC!==U&&(this.xC=U,this.Jra&&(this.Jra.innerText=this.xC))}get message(){return this._message}set message(U){this._message!==U&&(this._message=U,this.u7&&(this.u7.innerText=this._message))}get image(){return this.JS}set image(U){this.JS=
U;4!==this.JS&&(this.mea="")}get wFa(){return this.fia}set wFa(U){this.fia=U}get closeable(){return this.Rob}set closeable(U){this.Rob!==U&&(this.Rob=U,this.tqa&&(this.tqa.style.display=this.Rob?"table-cell":"none"))}get crc(){return r.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get qXl(){return r.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(U,T,ca,N=!1){this.ZCd=U;this.YCd=T;this.Iob=!0;this.Xdf=ca;this.XCd=N}PTd(U,T){this.cDd=U;this.bDd=T;this.Job=!0;this.Ydf="";this.aDd=
!1}Gzf(U,T){this.Dqb=U;this.s5a=T;this.FWb=!0}OQi(){var U=M.a.S_(r.AFrameworkApplication.fa.Ha("VNextStyleOptOutCookieName"),!1);U=this.qXl&&!U;this.WP=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",O.Wdf,O.i8h,U?O.kci:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.nDa&&null!==this.nDa&&(this.htmlElement.id=this.nDa);U=()=>{J.UISurfaces.Coj().then(T=>{this.businessBar.Jqe||(T.initializeMessageBarInStore(),this.businessBar.Jqe=!0);const ca=
Object.assign(new D,{message:this._message,messageTitle:this.xC,isMultiline:this.WId,messageBarType:this.GCd});if(this.Rob){ca.closeable=!0;var N=this._message+". "+CommonUIStrings.l_DialogClose;this.xC&&(N=this.xC+". "+N);ca.dismissButtonAriaLabel=N;ca.onDismiss=()=>{this.M_d(this)}}4===this.JS&&(ca.messageBarIconProps={["iconName"]:this.mea});this.FWb&&(ca.linkProps={["type"]:"AppLinkProps",["text"]:this.Dqb,["handler"]:{["href"]:this.fof,["target"]:"_blank"}},this.s5a&&(N=Object(e.a)(this,this.kJk,
"onMessageBarLinkClicked"),ca.linkProps.handler=N));this.Iob&&(ca.firstActionButtonProps=new w(this.ZCd,()=>{this.owi(this)}));this.Job&&(ca.secondActionButtonProps=new w(this.cDd,()=>{this.qwi(this)}));T.createNewMessageBarWithCallback?T.createNewMessageBarWithCallback(this.htmlElement,ca,()=>{r.AFrameworkApplication.Aa.Du()}):T.createNewMessageBar(this.htmlElement,ca);return null}).catch(()=>{h.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};m.a.get_instance().isCompleted(7)?
U():m.a.get_instance().Vj(7,U);this.Pac&&(r.AFrameworkApplication.Aa.$y.ub(z.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),r.AFrameworkApplication.Aa.DG.gV(z.a.Tl,this.htmlElement,Object(e.a)(this,this.JMe,"onBodyKeyUp"),this),this.Skf&&!this.MVb&&(r.AFrameworkApplication.Aa.vba.ub(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.MVb=!0));return this.htmlElement}createElement(){r.AFrameworkApplication.iM("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");
if(this.crc)return this.OQi();this.WP=document.createElement("div");this.htmlElement.className=O.Wdf;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.nDa&&null!==this.nDa&&(this.htmlElement.id=this.nDa);this.SOa=null;if(0!==this.JS){this.SOa=document.createElement("span");this.SOa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.SOa);var U=null;let T=null;switch(this.JS){case 2:U=O.Q_h;T=CommonUIStrings.l_DialogError;break;case 1:U=O.wci;T=CommonUIStrings.l_DialogWarning;
break;case 3:U=O.Z1h;T=CommonUIStrings.l_DialogInfo;break;case 4:U=this.mea,T=this.fia}this.SOa.title=T;this.SOa.setAttribute(L.a.hf,L.a.ZEf);this.SOa.appendChild(n.createClusteredImage(24,24,U,O.P1h,!0,""))}U=Q.a.create().toString();this.EN=document.createElement("div");this.EN.id="BBTitleAndBody"+U;this.EN.className=O.RXh;this.EN.tabIndex=0;this.xC&&(this.Jra=document.createElement("p"),this.Jra.innerText=this.xC,this.Jra.className=O.SXh+" UIFontBold",this.Jra.id="BBTitle"+U,this.Jra.setAttribute("UNSELECTABLE",
"on"),this.EN.setAttribute(L.a.t_,this.Jra.id),this.EN.appendChild(this.Jra));this.u7=document.createElement("p");this.u7.className=O.MXh;this.u7.innerText=this._message;this.u7.id="BBBody"+U;this.u7.setAttribute("UNSELECTABLE","on");this.u7.style.width="100%";this.EN.setAttribute(L.a.Uca,this.u7.id);this.Iob&&this.Wyf(this.u7,this.Xdf);this.Job&&this.Wyf(this.u7,this.Ydf);this.EN.appendChild(this.u7);U=document.createElement("div");U.setAttribute(L.a.hf,L.a.CWd);U.appendChild(this.EN);this.htmlElement.appendChild(U);
this.Iob&&(this.QSb=document.createElement("span"),this.PSb=document.createElement("button"),this.zQf(this.QSb,this.PSb,this.ZCd,Object(e.a)(this,this.YHf,"buttonOneClickHandler")));this.Job&&(this.SSb=document.createElement("span"),this.RSb=document.createElement("button"),this.zQf(this.SSb,this.RSb,this.cDd,Object(e.a)(this,this.ZHf,"buttonTwoClickHandler")));this.FWb&&(this.t5a=document.createElement("span"),this.t5a.className=O.QXh,this.K7=document.createElement("a"),this.K7.className=F.a.PXh,
this.K7.innerText=this.Dqb,this.s5a?(this.K7.tabIndex=0,r.AFrameworkApplication.Aa.$y.gV(z.a.click,this.K7,Object(e.a)(this,this.hxg,"linkClickHandler"),this),r.AFrameworkApplication.Aa.DG.gV(z.a.Tl,this.K7,Object(e.a)(this,this.Jbh,"onLinkKeyUp"),this)):(this.K7.href=this.fof,this.K7.target="_blank"),this.t5a.appendChild(this.K7),this.htmlElement.appendChild(this.t5a));r.AFrameworkApplication.Aa.$y.ub(z.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));r.AFrameworkApplication.Aa.DG.gV(z.a.Tl,
this.EN,Object(e.a)(this,this.JMe,"onBodyKeyUp"),this);this.Skf&&!this.MVb&&(r.AFrameworkApplication.Aa.vba.ub(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.MVb=!0);this.Rob&&(this.tqa=document.createElement("span"),this.tqa.className=O.wYh,this.zS=document.createElement("a"),this.zS.className=O.xYh,this.zS.tabIndex=0,this.zS.title=CommonUIStrings.l_DialogClose,this.zS.setAttribute(L.a.hf,L.a.Ou),this.tF=n.createClusteredImage(16,16,O.yYh,"",!0,""),this.zS.appendChild(this.tF),
this.tqa.style.display="table-cell",this.tqa.appendChild(this.zS),this.htmlElement.appendChild(this.tqa),r.AFrameworkApplication.Aa.$y.gV(z.a.click,this.zS,Object(e.a)(this,this.N$g,"onCloseClick"),this),r.AFrameworkApplication.Aa.DG.gV(z.a.Tl,this.zS,Object(e.a)(this,this.O$g,"onCloseKeyUp"),this));return this.htmlElement}mAl(){this.EN&&this.EN.setAttribute(L.a.NI,L.a.qja)}Wyf(U,T){if(T&&""!==T){var ca=document.createElement("span");ca.className=O.m9h;ca.innerText=T;U.appendChild(ca)}}zQf(U,T,ca,
N){U.className=O.OXh;T.setAttribute("type","button");T.className=O.NXh;T.innerText=ca;U.appendChild(T);this.htmlElement.appendChild(U);r.AFrameworkApplication.Aa.$y.gV(z.a.click,T,N,this)}$th(){this.crc||(this.EN.style.whiteSpace="nowrap",this.closeable?this.tqa.style.width="auto":this.FWb?this.t5a.style.width="auto":this.Job?this.SSb.style.width="auto":this.Iob?this.QSb.style.width="auto":this.EN.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.EN.style.whiteSpace=
"normal":this.closeable?this.tqa.style.width="100%":this.FWb?this.t5a.style.width="100%":this.Job?this.SSb.style.width="100%":this.Iob?this.QSb.style.width="100%":this.EN.style.width="100%")}i$e(U,T){if(B.a.XIb()){var ca={};ca.WacSessionId=r.AFrameworkApplication.userSessionId;ca.ActionName="BusinessBar"+U;ca.InputMethod=T;h.ULS.sendTraceTag(35489761,207,50,JSON.stringify(ca))}}EX(U,T,ca,N){this.i$e(U,ca);B.a.BWa()&&x.c(T,!0,x.e,N,10)}YHf(U){this.YCd(U.MD);this.EX("ButtonOne",C.a.SHf,"Mouse",2);this.XCd&&
(this.EX("Close",C.a.mub,"Mouse_ButtonOne",2),this.close(U));return!0}owi(U){this.YCd(U);this.EX("ButtonOne",C.a.SHf,"Mouse",2);this.XCd&&(this.EX("Close",C.a.mub,"Mouse_ButtonOne",2),this.M_d(U))}ZHf(U){this.bDd(U.MD);this.EX("ButtonTwo",C.a.THf,"Mouse",2);this.aDd&&(this.EX("Close",C.a.mub,"Mouse_ButtonTwo",2),this.close(U));return!0}qwi(U){this.bDd(U);this.EX("ButtonTwo",C.a.THf,"Mouse",2);this.aDd&&(this.EX("Close",C.a.mub,"Mouse_ButtonTwo",2),this.M_d(U))}hxg(U){this.s5a(U.MD);this.EX("Link",
C.a.WHf,"Mouse",2);return!0}kJk(){this.s5a(null)}Jbh(U){return U.nc.keyCode!==t.a.jp||U.nc.altKey?!1:(this.s5a(U.MD),this.EX("Link",C.a.WHf,"Keyboard",1),!0)}JMe(U){return U.nc.keyCode===t.a.jp&&!U.nc.altKey&&this.Pac?(this.Pac(U.MD,U),this.EX("Invoke",C.a.VHf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(r.AFrameworkApplication.Aa.$y.Bb(z.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),this.MVb&&r.AFrameworkApplication.Aa.vba.Bb(this.htmlElement,Object(e.a)(this,this.onClick,
"onClick")));this.zS&&(r.AFrameworkApplication.Aa.$y.Bb(z.a.click,this.zS,Object(e.a)(this,this.N$g,"onCloseClick")),r.AFrameworkApplication.Aa.DG.Bb(z.a.Tl,this.zS,Object(e.a)(this,this.O$g,"onCloseKeyUp")));this.PSb&&r.AFrameworkApplication.Aa.$y.Bb(z.a.click,this.PSb,Object(e.a)(this,this.YHf,"buttonOneClickHandler"));this.RSb&&r.AFrameworkApplication.Aa.$y.Bb(z.a.click,this.RSb,Object(e.a)(this,this.ZHf,"buttonTwoClickHandler"));this.K7&&this.s5a&&(r.AFrameworkApplication.Aa.$y.Bb(z.a.click,this.K7,
Object(e.a)(this,this.hxg,"linkClickHandler")),r.AFrameworkApplication.Aa.DG.Bb(z.a.Tl,this.K7,Object(e.a)(this,this.Jbh,"onLinkKeyUp")));this.EN&&r.AFrameworkApplication.Aa.DG.Bb(z.a.Tl,this.EN,Object(e.a)(this,this.JMe,"onBodyKeyUp"));this.businessBar=this.zS=this.tqa=this.tF=this.t5a=this.K7=this.SSb=this.RSb=this.QSb=this.PSb=this.EN=this.u7=this.WP=this.Jra=this.SOa=this.fia=null}onClick(U){this.EX("Invoke",C.a.VHf,"Mouse",2);return!!this.Pac&&this.Pac(this,U)}N$g(U){this.EX("Close",C.a.mub,
"Mouse",2);this.close(U);return!0}O$g(U){return U.nc.keyCode!==t.a.jp||U.nc.altKey?!1:(this.EX("Close",C.a.mub,"Keyboard",1),this.close(U),!0)}close(U){const T=U.MD;this.businessBar.removeEntry(T);this.Dng(T,U.kg)}Dng(U,T){if(U.KW){const ca=r.AFrameworkApplication.Qa;ca.Lp=10;ca.bU=T;U.KW(U);ca.Lp=0;ca.bU=0}}M_d(U){U&&this.businessBar&&(this.businessBar.removeEntry(U),this.Dng(U,0))}}O.Wdf="WACBusinessBarEntry";O.SXh="WACBusinessBarTitle";O.MXh="WACBusinessBarBody";O.RXh="WACBusinessBarTitleBodyHolder";
O.OXh="WACBusinessBarButtonHolder";O.NXh="WACBusinessBarButton";O.QXh="WACBusinessBarLinkHolder";O.xYh="WACBusinessBarClose";O.wYh="WACBusinessBarCloseHolder";O.yYh="BusinessBarClose_16x16x32";O.P1h="WACBusinessBarImage";O.m9h="WACScreenReaderOnly";O.Q_h="CancelRequest_24x24x32";O.wci="Risks_24x24x32";O.Z1h="Info_24x24x32";O.i8h="ReactBusinessBarEntry";O.kci="VNextBusinessBarEntry";Object(K.a)(O,"BusinessBarEntry",null,[491,108])},527:function(K,S,d){d.d(S,"a",function(){return m});K=d(0);var h=d(65),
e=d(528),r=d(931);class m{J2b(n,z){if(1===n.nodeType&&z){var t=this.aX(z);n=this.w2f(n,t);this.iGi(t,n,z)}}w2f(n,z){const {CombineHelper:t}=d(1201),x=[];let B=null;for(let w=0;w<n.childNodes.length;w++){var D=n.childNodes[w];3===D.nodeType?(B||(B=new t(n,w,z)),B.hhi(w)):(B&&(B.end(x,w-1),B=null),D=this.w2f(D,z),Array.addRange(x,D))}B&&B.end(x,n.childNodes.length-1);return x}iGi(n,z,t){n=n.clone();let x=!1;for(let B=z.length-1;0<=B;B--){const D=z[B].hGi();x=n.merge(D)||x}x&&this.setSelection(n,t)}setSelection(n,
z){z=h.a.LEa(z);z.setStart(n.start.element,n.start.offset);z.setEnd(n.end.element,n.end.offset)}aX(n){return(n=h.a.LEa(n))?Object.assign(new r.a,{start:Object.assign(new e.a,{element:n.startContainer,offset:n.startOffset}),end:Object.assign(new e.a,{element:n.endContainer,offset:n.endOffset})}):new r.a}}m.unused=-1;Object(K.a)(m,"TextNodeCombiner",null,[1474])},528:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,
{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(K.a)(h,"SelectionSide",null,[])},529:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);S=d(324);var h=d(138);class e extends S.a{constructor(){super();this.items=this.parentRevId=this.parentPath=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}}
Object(K.a)(e,"Operation",S.a,[])},530:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(K.b)("AppMode",h)},531:function(K,S,d){d.d(S,"a",function(){return e});d.d(S,"b",function(){return r});d.d(S,"c",function(){return m});const h=n=>{switch(n){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},
e=n=>h(m(n.Priority,n.Tag)),r=n=>m(n.Priority,n.Tag),m=(n,z)=>{switch(n){case 0:return 1;case 1:return 2;case 2:return z&1?5:3;case 3:return 4;default:return 0}}},532:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(K.a)(h,"ProofingTraceMetrics",null,[])},533:function(K,S,d){d.d(S,"a",function(){return r});d.d(S,"b",function(){return m});d.d(S,"c",function(){return n});var h=d(27),e=d(534);const r=()=>
{const z=h.AFrameworkApplication.Aa.mb.Ti;return(3===z||1===z||2===z||4===z)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},m=(z,t,x,B=!1)=>{t=1===t;1===z&&(t=2===h.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[z],t?"Editor":"Viewer",B?"Dime":"Unknown",x?x:"dimedefault")},n=z=>{switch(z){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},
534:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(K.b)("OfficeAppType",h)},535:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.GFf="AugEditorServiceTileCheckRequest";h.TWd="AugEditorServiceTileCheckResponse";h.e0i="EditorServiceTileCheckRequest";h.hNf="Proofing.ProofingRequest";h.DNc="Proofing.ProofingResponse";
Object(K.a)(h,"ProofingAugmentationSchemaNames",null,[])},536:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.slideId=null;this.akh=this.Vuc=0}}Object(K.a)(h,"SlidePresenceInfo",null,[])},537:function(K,S,d){d.d(S,"a",function(){return m});K=d(0);var h=d(395),e=d(1098),r=d(36);class m{execute(n,z,t=null){h.ULS.sendTraceTag(572846934,380,50,"reqType:{0}",n.ul());const x=new e.a,B=this.V8(n,z,t);B.continueWith(()=>{if(B.Hm)x.EG(B.hj);else if(B.jo)x.r2();else{const D=
B.result;if(D&&!D.succeeded&&D.xj&&D.xj.data&&5===B.result.xj.data.status){const w=this.V8(n,z,t);w.continueWith(()=>{w.Hm?x.EG(w.hj):w.jo?x.r2():x.wK(w.result)})}else x.wK(D)}});return x.task}V8(n,z,t){t=this.Suj(t);return z(t,{"Content-Type":"application/json; charset=utf-8"},n.serialize())}Suj(n){return n?String.format("{0}/{1}",n,"people.ashx"):"people.ashx"}static t9a(n){if(!n)return h.ULS.sendTraceTag(572846935,380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return r.a(n)}catch(z){h.ULS.sendTraceTag(572846936,
380,10,"Could not parse the response. Message: {0}",z.message)}return null}}Object(K.a)(m,"CommonHandlerRequestManager",null,[])},538:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(395);class e{equals(r,m){if(!r||!m)return!r&&!m;if(r.UserId!==m.UserId){if(!e.QWf(r.Provider)||!e.QWf(m.Provider))return!1;const z=r.UserId.startsWith(e.z_b);var n=m.UserId.startsWith(e.z_b);if(z&&n){if(r.Provider!==m.Provider)return h.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",
r.Provider,m.Provider),!1;n=e.m0f(r.UserId);m=e.m0f(m.UserId);return!!n&&n===m}r=r.Email&&""!==r.Email?r.Email:z?e.e$a(r.UserId):r.UserId;m=m.Email&&""!==m.Email?m.Email:n?e.e$a(m.UserId):m.UserId;return!!r&&r===m}return r.Provider!==m.Provider?!1:r.Provider&&""!==r.Provider||r.UserId&&""!==r.UserId?!0:r.DisplayName===m.DisplayName}dX(){return 0}static QWf(r){return"O365"===r||"AD"===r}static e$a(r){if(!r.startsWith(e.z_b))return null;r=r.substr(e.z_b.length);const m=r.lastIndexOf("::");return-1===
m?null:r.substr(0,m)}static m0f(r){if(!r.startsWith(e.z_b))return null;var m=r.lastIndexOf("::");if(-1===m)return null;m+=2;return m>=r.length?null:r.substr(m)}}e.z_b="S::";Object(K.a)(e,"CommentTaskPersonIdentityComparer",null,[352])},539:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(K.a)(h,"CrossDocumentMessage",null,[])},540:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.additionalDataFields=
this.otelEvent=null}}Object(K.a)(h,"OtelTelemetryEvent",null,[])},541:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(K.a)(h,"CustomContentProps",null,[])},542:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(301);class h{}h.CommandValueId="CommandValueId";h.Description="Description";h.Image16by16Class=d.a.eAb;h.Image30by30Class=d.a.rOj;h.Image32by32Class=d.a.vFa;h.Image48by48Class=d.a.Bie;h.On="On";h.LabelText=d.a.labelText;
h.Visible=d.a.visible;h.SourceControlId="SourceControlId";h.DisplayMode="DisplayMode";h.Alt=d.a.alt;Object(K.a)(h,"ToggleButtonCommandProperties",null,[])},543:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Uu="InputMethod";h.iba="ShouldCanvasTakeFocus";h.Vyd="UILocation";Object(K.a)(h,"ReactRibbonConstants",null,[])},544:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1159),{IECustomEventFactory:r}=d(1160);
h.La||(h.La="function"===typeof window.CustomEvent?new e:new r);return h.La}}h.La=null;Object(K.a)(h,"CustomEventFactory",null,[])},545:function(K,S,d){d.d(S,"a",function(){return e});d.d(S,"b",function(){return m});var h=d(9);d(1098);const e=z=>r(z),r=z=>new Promise((t,x)=>{z.continueWith(B=>{B.Hm?x(B.hj.message):B.jo?x(h.a.UOc()):t(null)})}),m=z=>n(z),n=z=>new Promise((t,x)=>{z.continueWith(()=>{z.Hm?x(z.hj.message):z.jo?x(h.a.UOc()):t(z.result)})})},546:function(K,S,d){d.d(S,"a",function(){return h});
K=d(0);class h{}h.themeColors="Theme Colors";Object(K.a)(h,"ReactColorConstants",null,[])},547:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.other=0]="other";e[e.searchBoxSearch=1]="searchBoxSearch";e[e.searchBoxDictionary=2]="searchBoxDictionary";e[e.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";e[e.smartLookupRibbon=4]="smartLookupRibbon";e[e.smartLookupContextMenu=5]="smartLookupContextMenu";e[e.entity=6]="entity";e[e.dictionary=7]="dictionary";e[e.web=8]="web";
e[e.pictures=9]="pictures";e[e.files=10]="files";e[e.bookmarks=11]="bookmarks";e[e.help=12]="help";e[e.chartRecommendation=13]="chartRecommendation";e[e.linkSkill=14]="linkSkill";e[e.searchBoxFindInDocument=15]="searchBoxFindInDocument";e[e.searchBoxEntity=16]="searchBoxEntity";e[e.searchSkill=17]="searchSkill";e[e.controlF=18]="controlF";e[e.ribbonFindButton=19]="ribbonFindButton";e[e.reuseSlides=20]="reuseSlides";e[e.data=21]="data";e[e.contextMenuDictionary=22]="contextMenuDictionary";e[e.contextMenuSearchSuggestion=
23]="contextMenuSearchSuggestion";e[e.contextMenuSynonyms=24]="contextMenuSynonyms";e[e.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";e[e.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";e[e.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";e[e.note=28]="note";e[e.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";e[e.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";e[e.dataDisambiguate=31]="dataDisambiguate";e[e.linkFiles=32]="linkFiles";e[e.searchBoxNoteL2=
33]="searchBoxNoteL2";e[e.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";e[e.actionAI=35]="actionAI";e[e.pasteAsNewSlide=36]="pasteAsNewSlide";e[e.slidesCompression=37]="slidesCompression";e[e.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";e[e.powerPointCopilot=39]="powerPointCopilot";e[e.tellMeService=40]="tellMeService";e[e.prefetch=99]="prefetch"})(h||(h={}));Object(K.b)("EntryPoint",h)},554:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=d(1274),r=d(689),m;(function(pa){pa[pa.external=
0]="external";pa[pa.msa=1]="msa";pa[pa.aad=2]="aad"})(m||(m={}));Object(K.b)("AuthorityType",m);var n=d(338);class z{constructor(pa){this.z5h=pa}initialize(){return Promise.resolve(0)}N5c(){return Promise.resolve(0)}mI(){h.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new n.a,{IsSuccess:!0,Token:this.z5h}))}Dyd(){return Promise.resolve(Object.assign(new n.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Ewd(){return!1}a9b(){return"MockAuthTokenStrategy"}}
Object(K.a)(z,"MockAuthTokenStrategy",null,[350]);var t=d(740);class x{static get(pa,Ea,ta){if(!ta)return pa;let ia=0;return Promise.race([pa,new Promise(Ja=>{ia=window.setTimeout(()=>{Ja(Ea)},ta)})]).then(Ja=>{window.clearTimeout(ia);return Promise.resolve(Ja)}).catch(()=>{window.clearTimeout(ia);return Promise.resolve(Ea)})}}Object(K.a)(x,"PromiseWithTimeout",null,[]);var B=d(27),D=d(218);class w{constructor(pa,Ea,ta,ia,Ja){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=pa;this.scope=Ea;this.silentLogin=ta;this.options=ia;this.correlationId=Ja}}Object(K.a)(w,"TokenRequestParameters",null,[482]);var J=d(56),F=d(55);class L{constructor(){this.Kxf=null;let pa=B.AFrameworkApplication.fa.Ha(B.AFrameworkApplication.yK),Ea=B.AFrameworkApplication.fa.Ha(B.AFrameworkApplication.sOh);this.bsb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",pa&&""!==pa?pa:"Unspecified",Ea&&""!==Ea?Ea:"Unspecified")}initialize(){return new Promise(pa=>
{F.a.instance.Ia("Common.App.WopiIdentity.IWopiIdentity").execute(Ea=>{this.Kxf=Ea;pa(0)})})}Ic(pa){const Ea=["HTTPS:","API:"];let ta=!1;const ia=pa.toLocaleUpperCase();for(const Ja of Ea)if(ia.startsWith(Ja)){ta=!0;break}return ta||this.C0j(pa)?pa+"/.default":pa}C0j(pa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(pa)}N5c(){return Promise.resolve(0)}mI(pa,Ea,ta,ia,Ja,ab,Oa){if(J.a.zGa){Ja=D.OAuthManagerSettings.OYl;if(!Ja)return Ea=Object.assign(new n.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ea);if(!Array.contains(Ja,pa))return Ea=Object.assign(new n.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+pa}),Promise.resolve(Ea)}pa=this.Ic(ta);ta=new w(ta,pa,!ia,null,B.AFrameworkApplication.userSessionId);return this.Kxf.getAccessToken(ta,Ea,Oa).then(Za=>Object.assign(new n.a,{IsSuccess:!0,Token:Za.accessToken}),Za=>Object.assign(new n.a,{IsSuccess:!1,ErrorCode:Za}))}Dyd(){return Promise.resolve(Object.assign(new n.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Ewd(){return!1}a9b(){return this.bsb}}Object(K.a)(L,"ParentFrameTokenStrategy",null,[350]);var M=d(7),Q=d(463),C=d(18);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.llh=this.dGf=null}}Object(K.a)(O,"PromiseWrapper",null,[]);class U{constructor(pa=0){this.wN=0;this.PXb=!1;this.Mu=new C.a;this._timeout=pa}enqueue(pa){return new Promise((Ea,
ta)=>{this.Mu.add(Object.assign(new O,{llh:pa,resolve:Ea,reject:ta}));this.process()})}process(){if(this.PXb||this.wN===this.Mu.count)return!1;const pa=this.Mu.ga(this.wN++);try{this.PXb=!0,pa.llh().then(Ea=>{this.PXb=!1;this.s0d(pa,Ea,null,!0)}).catch(Ea=>{this.PXb=!1;this.s0d(pa,null,Ea,!1)})}catch(Ea){this.PXb=!1,this.s0d(pa,null,Ea,!1)}return!0}s0d(pa,Ea,ta,ia){if(ia){const Ja=()=>{pa.resolve(Ea);this.process()};0<this._timeout?window.setTimeout(()=>{Ja()},this._timeout):Ja()}else{const Ja=()=>
{pa.reject(ta);this.process()};0<this._timeout?window.setTimeout(()=>{Ja()},this._timeout):Ja()}}}Object(K.a)(U,"PromiseQueue",null,[]);class T{constructor(){this.correlationId=this.resolve=null}}Object(K.a)(T,"ResolveWithCorrelation",null,[]);var ca=d(1253),N=d(80),da=d(539),Y=d(127);class fa extends N.a{constructor(pa,Ea,ta,ia,Ja,ab){super(!1,!1,!0);this.qgf=this.Pha=null;this.Eca=pa;this.F7h=ta;this.uF=ia;this.tbi=Ja;this.b5a=ab;this.lB=document.createElement("iframe");this.lB.id="SharedAuthInteractiveFrame";
this.lB.setAttribute("name","SharedAuthInteractiveFrame");this.lB.setAttribute("title","SharedAuthInteractiveFrame");this.lB.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.lB.style.border="0";this.lB.style.height="48px";this.lB.style.width="190px";$addHandler(this.lB,"error",Object(M.a)(this,this.iMk,"onSharedAuthFrameError"));pa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Eca,Ea,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",B.AFrameworkApplication.userType);this.lB.src=pa;this.VZh=new Promise(Oa=>{this.qgf=Oa});this.rgf=!1}Rga(){this.Pha={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.F7h,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:B.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(M.a)(this,this.rOi,"createFrame"),["resolveDialogStyles"]:this.qgf}};this.Ad=5;this.sj(CommonUIStrings.l_SignIn,Object(M.a)(this,this.Tvl,"sharedAuthConsentDialogHandler"),
this.Pha)}$Qh(pa=!1,Ea=5){this.Pha&&this.Pha.bodyControls&&(!0!==Object(ca.a)(Object,this.Pha.bodyControls).frameLoaded&&(Object(ca.a)(Object,this.Pha.bodyControls).frameLoaded=!0),pa!==Object(ca.a)(Object,this.Pha.bodyControls).frameLoadSuccess&&(Object(ca.a)(Object,this.Pha.bodyControls).frameLoadSuccess=pa),Ea!==this.Pha.dialogButtonsOption&&(this.Pha.dialogButtonsOption=null,this.Ad=Ea),this.update(this.Pha))}SBl(pa,Ea){const ta=new da.a(Y.a.Xvl);ta.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:B.AFrameworkApplication.isRtl,["messageCorrelationId"]:pa,["dialogStyles"]:Ea};this.uF.flb(ta,this.lB.contentWindow,this.Eca)}f4f(){this.$Qh(!1,6)}get ZBh(){return this.lB}get jXi(){return this.VZh.then(pa=>{this.rgf=!0;return pa})}get kXi(){return this.rgf}iMk(){this.f4f()}rOi(){return this.lB}Tvl(pa){0===pa&&(this.tbi.reject(Object.assign(new n.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.b5a(null))}}
Object(K.a)(fa,"SharedAuthConsentDialog",N.a,[483]);var aa=d(680),ka=d(97),H=d(224),ra=d(65),ha=d(103),Ma=d(89);class Ga{constructor(){this.lB=null;this.uCc=0;this.Jqb=this.xsb=this.xCd=this.b5a=this.f_=this.Ewf=null;this.uF=new aa.a(null,null);this.bsb="SharedAuthTokenStrategy Unloaded";this.Eca=D.OAuthManagerSettings.Vvl;this.Ruf=D.OAuthManagerSettings.Uvl;this.shf=D.OAuthManagerSettings.enableConsoleLogging;this.H_h=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.I$h=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.bci=B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.SPa={};this.j2h=new U(1500)}a9b(){return this.bsb}initialize(){var {OAuthManager:pa}=d(554);if("loadFrame"in this.SPa)return this.SPa.loadFrame.dGf;if(!this.Eca)return ka.Health.instance.recordKpiFailure(pa.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),
h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);pa=this.nwd("loadFrame");this.uCc=ra.a.zj();var Ea=this.Eca+this.Ruf+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+B.AFrameworkApplication.userSessionId+"&WacUserType="+B.AFrameworkApplication.userType;this.bci&&(Ea+="&webworker=1");this.lB=document.createElement("iframe");this.U_c(this.lB);this.lB.style.cssText="height:0;width:0;display:none;";this.lB.id=
"SharedAuthFrame";this.lB.setAttribute("name","SharedAuthFrame");this.lB.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.lB.setAttribute("title","SharedAuthFrame");this.lB.src=Ea;document.body.appendChild(this.lB);Ea=ra.a.zj()-this.uCc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Ea,this.lB.src);return pa}N5c(pa){this.xCd=pa;const Ea=new da.a(Y.a.bCh);Ea.Values=this.IFf(pa);
pa=this.nwd("initFrame");this.uF.flb(Ea,this.lB.contentWindow,this.Eca);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return pa}mI(pa,Ea,ta,ia,Ja,ab){const Oa=new da.a(Y.a.Yvl),Za=this.ecg();Oa.Values=this.iNh(pa,Ea,ta,ia,Ja,ab,Za);pa=this.nwd(Za);ia&&B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.j2h.enqueue(()=>new Promise(Na=>{this.HOl(ab,Oa,Na,Za)})):(this.uF.flb(Oa,this.lB.contentWindow,
this.Eca),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ea));return pa}HOl(pa,Ea,ta,ia){const Ja=this.SPa[ia];Ja&&(this.xsb=Ea,this.b5a=Object.assign(new T,{resolve:ta,correlationId:ia}),this.f_=new fa(this.Eca,this.Ruf,pa,this.uF,Ja,ta),this.f_.Rga())}ecg(){return ha.a.create().toString()}iNh(pa,Ea,ta,ia,Ja,ab,Oa){const Za={};Za.appName=pa;Za.appId=Ea;Za.target=ta;Za.withPopup=ia;Za.claims=Ja;Za.promptMessage=ab;Za.messageCorrelationId=
Oa;return Za}U_c(pa){$addHandler(pa,"load",Object(M.a)(this,this.pIk,"onIFrameLoaded"));$addHandler(pa,"error",Object(M.a)(this,this.NNe,"onIFrameError"));this.uF.qCa(this.Eca);this.uF.Nu(Y.a.eCh);this.uF.fC(Y.a.eCh,Object(M.a)(this,this.ELk,"onScriptLoaded"));this.uF.Nu(Y.a.dCh);this.uF.fC(Y.a.dCh,Object(M.a)(this,this.DLk,"onScriptInitialized"));this.uF.Nu(Y.a.$Bh);this.uF.fC(Y.a.$Bh,Object(M.a)(this,this.XHk,"onGetTokenResponse"));this.uF.Nu(Y.a.fCh);this.uF.fC(Y.a.fCh,Object(M.a)(this,this.eJk,
"onLoginResponse"));this.uF.Nu(Y.a.cCh);this.uF.fC(Y.a.cCh,Object(M.a)(this,this.CIk,"onInteractiveFlowReady"));this.uF.Nu(Y.a.aCh);this.uF.fC(Y.a.aCh,Object(M.a)(this,this.lIk,"onHideDialog"));this.uF.Nu(Y.a.YBh);this.uF.fC(Y.a.YBh,Object(M.a)(this,this.OFk,"onCloseDialog"))}nwd(pa){const Ea=new O;Ea.startTime=ra.a.zj();const ta=new Promise((ia,Ja)=>{Ea.resolve=ia;Ea.reject=Ja});Ea.dGf=ta;this.SPa[pa]=Ea;return ta}pIk(){const pa=ra.a.zj()-this.uCc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
pa)}NNe(pa){const {OAuthManager:Ea}=d(554),ta=ra.a.zj()-this.uCc,ia=Object.assign(new Ma.a,{durationMs:ta});ka.Health.instance.recordKpiFailure(Ea.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ia);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ta,this.shf?JSON.stringify(pa):"")}ELk(pa){const {OAuthManager:Ea}=d(554),ta=this.SPa.loadFrame;var ia=ra.a.zj()-ta.startTime,Ja=pa.Values.AuthLibrary.toString();pa=pa.Values.Success.toString();h.ULS.sendTraceTag(573112902,
3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",pa,Ja,ia);Ja&&(this.bsb="SharedAuthTokenStrategy "+Ja);Ja=Boolean.parse(pa);Ja||(pa=H.a.fA(),void 0!==pa&&null!==pa&&(pa.set("AuthLibrary",this.a9b()),ia=Object.assign(new Ma.a,{durationMs:ia,extendedProperties:pa}),ka.Health.instance.recordKpiFailure(Ea.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ia)));ta.resolve(Ja?0:1)}DLk(pa){if(pa.Values.interactive&&this.xsb&&this.xsb.Values.messageCorrelationId){const ta=
this.xsb.Values.messageCorrelationId.toString();if(pa.Values.interactive&&this.f_){this.f_.jXi.then(ia=>{this.uF.flb(this.xsb,this.f_.ZBh.contentWindow,this.Eca);this.f_.SBl(ta,ia);this.f_.$Qh(!0);this.xsb=null});return}}pa=this.SPa.initFrame;const Ea=ra.a.zj()-pa.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ea);pa.resolve(0)}XHk(pa){if(pa.Values.messageCorrelationId&&pa.Values.messageCorrelationId.toString()){var Ea=pa.Values.messageCorrelationId.toString(),
ta=this.SPa[Ea];if(ta){var ia=ra.a.zj()-ta.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ia);pa.Values.isSuccess&&pa.Values.isSuccess?ta.resolve(pa.Values.response):ta.reject(pa.Values.response);this.NNh(Ea)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}CIk(){if(this.f_.kXi)this.f_.f4f();
else if(this.xCd&&this.f_){const pa=new da.a(Y.a.bCh);pa.Values=this.IFf(this.xCd,!0);this.uF.flb(pa,this.f_.ZBh.contentWindow,this.Eca)}}lIk(){this.f_&&this.f_.Uhe()}OFk(pa){pa.Values.cancelled&&pa.Values.cancelled&&pa.Values.messageCorrelationId&&this.NNh(pa.Values.messageCorrelationId.toString());this.f_&&this.f_.hide()}IFf(pa,Ea=!1){const ta={};ta.appIds=this.Pdj();ta.upn=pa.loginHint;ta.authority=pa.authority;ta.authorityType=Object(e.a)(m,pa.authorityType);ta.tenantId=pa.tenantId;ta.correlationId=
B.AFrameworkApplication.userSessionId;ta.enableConsoleLogging=this.shf;ta.enablePopupFlash=this.H_h;ta.skipUpnCheck=this.I$h;ta.interactive=Ea;return ta}Pdj(){const pa=[],Ea=D.OAuthManagerSettings.AVd;for(let ia in Ea){var ta=Ea[ia];Array.contains(pa,ta)||Array.add(pa,ta)}return pa}Dyd(pa,Ea,ta,ia,Ja,ab){const Oa=new da.a(Y.a.Wvl),Za=this.ecg();Oa.Values=this.iNh(pa,Ea,ta,ia,Ja,ab,Za);this.Ewf=Oa;pa=this.nwd(Za);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
Ea);this.Jzl();return pa}Ewd(){return!0}Jzl(){this.Jqb||(this.Jqb=new Q.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Jqb.id=16,this.Jqb.R2c=!1,this.Jqb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.uF.flb(this.Ewf,this.lB.contentWindow,this.Eca)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),B.AFrameworkApplication.Aa.mb.hJc(this.Jqb,
!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}eJk(pa){if(pa.Values.messageCorrelationId&&pa.Values.messageCorrelationId.toString()){var Ea=this.SPa[pa.Values.messageCorrelationId.toString()];if(Ea){var ta=ra.a.zj()-Ea.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ta);pa.Values.isSuccess&&pa.Values.isSuccess?Ea.resolve(pa.Values.response):Ea.reject(pa.Values.response)}else h.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}NNh(pa){this.b5a&&this.b5a.correlationId===pa&&(this.b5a.resolve(null),this.b5a=null)}}Object(K.a)(Ga,"SharedAuthTokenStrategy",null,[350]);class na{constructor(pa){this.YNd=pa;this.bsb="UnsupportedAuthTokenStrategy Reason="+r.a[this.YNd]}initialize(){return Promise.resolve(0)}N5c(){return Promise.resolve(0)}mI(){return Promise.resolve(Object.assign(new n.a,
{IsSuccess:!1,ErrorCode:r.a[this.YNd],ErrorMessage:"Unable to get a token. Reason: ["+r.a[this.YNd]+"]"}))}Dyd(){return Promise.resolve(Object.assign(new n.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Ewd(){return!1}a9b(){return this.bsb}}Object(K.a)(na,"UnsupportedAuthTokenStrategy",null,[350]);var wa=d(201);d.d(S,"OAuthManager",function(){return Fa});class Fa{constructor(pa=null){this.IZ=
0;this.JZ=null;this.h6a=0;this.hmf=!!window.location.search.match(RegExp("wdpa=1","gi"));const Ea=ra.a.zj();this.$1h=this.IWi(pa).then(ta=>ta?this.UPj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.mE(),Math.floor(ra.a.zj()-Ea)),ta=H.a.fA(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.mE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(ra.a.zj()-Ea),extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,
"StrategyPickFailed",!1,!0,ta)),Promise.resolve(1))).then(ta=>0!==ta?Promise.resolve(ta):this.uck())}JWi(){if(this.hmf)this.IZ=5,this.JZ=new na(this.IZ);else{var pa=D.OAuthManagerSettings.HAk;pa&&0<pa.length?(this.IZ=1,this.JZ=new z(pa)):B.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||B.AFrameworkApplication.fa.ka("IsO365CommercialHost")?B.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.IZ=2,this.JZ=new na(this.IZ)):(pa=t.a.getAuthContext().loginHint)&&pa.length?D.OAuthManagerSettings.ubb?
(this.IZ=1,this.JZ=new L):(this.IZ=1,this.JZ=new Ga):(this.IZ=3,this.JZ=new na(this.IZ)):(this.IZ=4,this.JZ=new na(this.IZ))}}mE(){return this.JZ?this.JZ.a9b()||"Unknown":"None"}IWi(pa=null){h.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ea=ra.a.zj();return B.AFrameworkApplication.fa.flj().then(ta=>{ta?(this.JWi(),pa&&(this.JZ=pa),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
D.OAuthManagerSettings.clientVersion,D.OAuthManagerSettings.appVersion,D.OAuthManagerSettings.tZi,this.mE(),Math.floor(ra.a.zj()-Ea))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ra.a.zj()-Ea));return Promise.resolve(ta)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ra.a.zj()-Ea));return Promise.resolve(!1)})}UPj(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.mE());const pa=ra.a.zj();return x.get(this.JZ.initialize(),2,D.OAuthManagerSettings.fTe).then(Ea=>{if(0===Ea)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.mE(),Math.floor(ra.a.zj()-pa));else if(1===Ea){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.mE(),Math.floor(ra.a.zj()-
pa));var ta=H.a.fA();void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.mE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(ra.a.zj()-pa),extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyInitFailed",!1,!0,ta))}else 2===Ea&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.mE(),Math.floor(ra.a.zj()-pa)),ta=H.a.fA(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.mE()),ta=Object.assign(new Ma.a,
{durationMs:Math.floor(ra.a.zj()-pa),extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyInitTimedOut",!1,!0,ta)));return Promise.resolve(Ea)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.mE(),Math.floor(ra.a.zj()-pa));return Promise.resolve(1)})}uck(){h.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.mE());const pa=ra.a.zj();return x.get(this.JZ.N5c(t.a.getAuthContext()),2,D.OAuthManagerSettings.fTe).then(Ea=>
{if(0===Ea)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.mE(),Math.floor(ra.a.zj()-pa));else if(1===Ea){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.mE(),Math.floor(ra.a.zj()-pa));var ta=H.a.fA();void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.mE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(ra.a.zj()-pa),extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyLoadFailed",
!1,!0,ta))}else 2===Ea&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.mE(),Math.floor(ra.a.zj()-pa)),ta=H.a.fA(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.mE()),ta=Object.assign(new Ma.a,{durationMs:Math.floor(ra.a.zj()-pa),extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyLoadTimedOut",!1,!0,ta)));return Promise.resolve(Ea)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",
this.mE(),Math.floor(ra.a.zj()-pa));return Promise.resolve(1)})}mI(pa,Ea,ta=null){return this.aRb(pa,Ea,!1,null,"",ta)}jNh(pa,Ea,ta,ia,Ja=null){return this.aRb(pa,Ea,!0,ta,ia,Ja)}aRb(pa,Ea,ta,ia,Ja,ab,Oa=0){Oa+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",pa,this.Tkb(pa,Ea),this.mE(),Oa);var Za=H.a.fA();void 0!==Za&&null!==Za&&(Za.set("AuthLibrary",this.mE()),Za.set("AppName",pa),Za.set("Target",this.Tkb(pa,Ea)),
ka.Health.instance.recordKpiUsage(Fa.kpiName,0,"WacOAuthFC",Za));if(!D.OAuthManagerSettings.isEnabled||this.hmf){var Na;return this.Mte((Na=new n.a,Na.IsSuccess=!1,Na.Token=null,Na.ErrorCode="NotEnabled",Na.ErrorMessage="OAuthManager is disabled.",Na),pa)}const sa=D.OAuthManagerSettings.AVd[pa];if(void 0===sa||null===sa){h.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",pa);var Sa;return this.Mte((Sa=new n.a,
Sa.IsSuccess=!1,Sa.Token=null,Sa.ErrorCode="DisallowedApp",Sa.ErrorMessage="Disallowed appName: "+pa,Sa),pa)}const xb=ra.a.zj();let gc=xb;const zc=this;Za=this.$1h.then(Tb=>{gc=ra.a.zj();return zc.EVj(pa,sa,Ea,ta,ia,Ja,ab,Tb)});Na=ta?0:D.OAuthManagerSettings.fTe;let Xb;Sa=(Xb=new n.a,Xb.IsSuccess=!1,Xb.Token=null,Xb.ErrorCode="authTokenStrategy_timeout",Xb.ErrorMessage="Auth Strategy timed out after ["+Na+"] ms when fetching token",Xb);let jb=this,zb=this;return x.get(Za,Sa,Na).then(Tb=>Oa<=Fa.szk&&
(Tb.ErrorCode===Fa.qLh||Tb.ErrorCode===Fa.AGl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Oa,Math.floor(ra.a.zj()-xb)),jb.aRb(pa,Ea,ta,ia,Ja,ab,Oa)):Tb.ErrorCode===Fa.Ivg&&!ta&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Oa,Fa.vYf),Fa.J0i&&jb.JZ.Ewd()&&jb.JZ.Dyd(pa,sa,Ea,ta,ia,Ja).then(Ya=>Promise.resolve(jb.c6c(Ya,pa,Ea,sa,xb,gc))).catch(()=>{let Ya;const sb=(Ya=new n.a,
Ya.IsSuccess=!1,Ya.Token=null,Ya.ErrorCode="authTokenStrategy_failure",Ya.ErrorMessage="LoginPopup failed, GetToken could not be called",Ya);return Promise.resolve(jb.c6c(sb,pa,Ea,sa,xb,gc))}),Fa.vYf)?jb.aRb(pa,Ea,!0,ia,Ja,ab,Oa):Promise.resolve(jb.c6c(Tb,pa,Ea,sa,xb,gc))).catch(()=>{let Tb;const Ya=(Tb=new n.a,Tb.IsSuccess=!1,Tb.Token=null,Tb.ErrorCode="authTokenStrategy_failure",Tb.ErrorMessage="Auth Strategy failed with an unknown error",Tb);return Promise.resolve(zb.c6c(Ya,pa,Ea,sa,xb,gc))})}EVj(pa,
Ea,ta,ia,Ja,ab,Oa,Za){return 1===Za||2===Za?this.Mte(Object.assign(new n.a,{IsSuccess:!1,Token:null,ErrorCode:1===Za?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),pa):this.JZ.mI(pa,Ea,ta,ia,Ja,ab,Oa).then(Na=>Promise.resolve(this.p8g(Na,!0,pa))).catch(Na=>Promise.resolve(this.p8g(Na,!1,pa)))}c6c(pa,Ea,ta,ia,Ja,ab){const Oa={},Za=ra.a.zj()-ab;Oa.IsSuccess=pa.IsSuccess;Oa.ErrorCode=pa.IsSuccess?"Success":pa.ErrorCode||"";Oa.ErrorMessage=pa.IsSuccess?"Success":this.Tkb(Ea,
pa.ErrorMessage||"");Oa.Target=this.Tkb(Ea,ta||"");Oa.TimeInMS=Math.floor(Za);Oa.LoadTimeInMS=Math.floor(ab-Ja);Oa.AuthLibrary=this.mE();Oa.AppName=Ea;Oa.AuthorityType=Object(e.a)(m,t.a.cVc());Oa.UserType=this.eAj(t.a.getAuthContext());Oa.IsAuthSupportedInSession=r.a[this.IZ];Oa.RequestCount=++this.h6a;Oa.AppId=ia;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Oa));pa.IsSuccess||(ta=H.a.fA(),void 0!==ta&&null!==ta&&(ta.set("AppName",Ea),ta.set("AuthLibrary",this.mE()),ta.set("ErrorCode",pa.ErrorCode),
ta.set("ErrorMessage",this.Tkb(Ea,pa.ErrorMessage)),Ea=Object.assign(new Ma.a,{durationMs:Za,extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,"TryGetTokenFailure",!1,!0,Ea)));return pa}Mte(pa,Ea){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ea,this.Tkb(Ea,pa.ErrorMessage));const ta=H.a.fA();void 0!==ta&&null!==ta&&(ta.set("AppName",Ea),ta.set("AuthLibrary",this.mE()),ta.set("ErrorCode",pa.ErrorCode),ta.set("ErrorMessage",
this.Tkb(Ea,pa.ErrorMessage)),Ea=Object.assign(new Ma.a,{extendedProperties:ta}),ka.Health.instance.recordKpiFailure(Fa.kpiName,"FailureBeforeGetToken",!1,!0,Ea));return Promise.resolve(pa)}Eqg(pa){return pa===wa.a.Axd}Tkb(pa,Ea){return this.Eqg(pa)&&Ea?"REDACTED":Ea}eAj(pa){return B.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!pa.loginHint||1>pa.loginHint.length?"empty":-1<pa.loginHint.indexOf("guest#")?"guest":-1<pa.loginHint.indexOf("ext#")?"external":0>pa.upn.indexOf("@")?"no-at":
"supported"}xog(){return 1===this.IZ}p8g(pa,Ea,ta){let ia=null,Ja=null,ab=null,Oa=null;pa?pa.ErrorCode||pa.ErrorMessage?(Ja=pa.ErrorCode?pa.ErrorCode:Fa.r_f,ab=pa.ErrorMessage?pa.ErrorMessage:"No message"):pa.Token?Ea?ia=pa.Token:(Ja=Fa.D9k,ab="A rejected promise returned a token."):(Ja=Fa.r_f,ab=JSON.stringify(pa)):(Ja=Fa.tCk,ab="No result came from Auth Token Strategy");pa&&pa.Telemetry&&!this.Eqg(ta)&&(Oa=pa.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Oa)));if(Ja===Fa.SAk||Ja===
Fa.KLl)Ja=Fa.qLh,ab="Auth Library Timed Out";Ja===Fa.qri&&-1<ab.indexOf(Fa.Lci)&&(Ja=Fa.Ivg);if(Ja||ab)ia=null;return Object.assign(new n.a,{IsSuccess:!!ia,Token:ia,ErrorCode:Ja,ErrorMessage:ab,Telemetry:Oa})}static get vYf(){return B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get J0i(){return B.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Fa.KLl="token_renewal_error";
Fa.r_f="Exception";Fa.tCk="NoResult";Fa.D9k="RejectToken";Fa.SAk="monitor_window_timeout";Fa.qLh="Timeout";Fa.AGl="authTokenStrategy_timeout";Fa.qri="login_required";Fa.Lci="AADSTS50058";Fa.Ivg="Cookies Disabled";Fa.kpiName="OAuthManager";Fa.szk=2;Object(K.a)(Fa,"OAuthManager",null,[267])},558:function(K,S,d){K=d(0);var h=d(395),e=d(359),r=d(55),m=d(67),n=d(176),z=d(94),t=d(27);d(7);var x=d(36),B=d(50),D=d(100);class w{constructor(){this.sjb=this.x6=null;this.KLh=0}}Object(K.a)(w,"CandidateManager",
null,[]);var J=d(670),F=d(668),L=d(669);class M{constructor(){this.keyCode=0;this.IZl=this.HZl=null}}Object(K.a)(M,"PredictionKeptState",null,[]);class Q{constructor(){this.values={}}plg(Ea,ta,ia){Ea=this.Gdg(Ea);Ea[ta]=ta in Ea?Ea[ta]+ia:ia}add(Ea,ta,ia){this.Gdg(Ea)[ta]=ia}ga(Ea){return this.values[Ea]}$(Ea,ta){return this.values[Ea]=ta}ROf(Ea){return Ea in this.values?!0:!1}Gdg(Ea){let ta;Ea in this.values?ta=this.values[Ea]:(ta={},this.values[Ea]=ta);return ta}}Object(K.a)(Q,"PredictionState",
null,[]);class C{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=0;this.PredictionAccepted=!1}}Object(K.a)(C,"TypeAheadRoamingSettings",null,[]);var O=d(199),U=d(1253),T=d(18),ca=d(935),N=d(671);d(672);var da=d(936);class Y{constructor(Ea){this.dzc=null;this.RD=Ea;Ea=r.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xI;const ta=r.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Ea,ta)}initialize(Ea,ta){const ia=new N.a;return Ea?ta?this.dzc?this.dzc:
t.AFrameworkApplication.Aa.mb.hqg?this.dzc=new Promise((Ja,ab)=>{const Oa=t.AFrameworkApplication.Ji("al",2);ta.TCb(Oa).continueWith(Za=>{Za.Hm?(this.Obh(),ab(Za.hj.message)):(this.Qlg(ia),Ja({}))})}):this.dzc=Ea.loadScript("al").then(()=>{this.Qlg(ia)}).catch(Ja=>{this.Obh();return Promise.reject(Ja)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}Qlg(Ea){Y.sT.wG(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const ta=
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let ia=t.AFrameworkApplication.fa.Ha("OfficeApplicationName")||"";ia=ia.replace("Web","");Ea.appName=Ea.appName||ia;Ea.serviceUrl=Ea.serviceUrl||t.AFrameworkApplication.fa.Ha("AugLoopCloudALServiceUrl");Ea.appVersion=Ea.appVersion||t.AFrameworkApplication.fa.Ha("BuildVersion")||"";Ea.releaseAudienceGroup=Ea.releaseAudienceGroup||(t.AFrameworkApplication.Md?Object(U.a)(String,t.AFrameworkApplication.Md.AudienceGroup)||"":"");Ea.sessionId=Ea.sessionId||
t.AFrameworkApplication.fa.Ha("SessionId")||"";Ea.uiLanguage=Ea.uiLanguage||t.AFrameworkApplication.uiCulture;Ea.flights=this.$dj();Ea.initSession=Ea.initSession||!0;ta.initialize(Ea);ta.activateAnnotation(Object.assign(new ca.a,{annotationType:da.a.getTypeName(),handler:this.RD}))},"WordPredictionAL:Initialize")}Obh(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}$dj(){var Ea=t.AFrameworkApplication.fa.Ha("FlightId"),ta=t.AFrameworkApplication.fa.ty("AugLoopFlightKeywordList");
Ea=this.E8d(Ea,ta);ta="";0<Ea.length&&(ta=O.a.join(Ea,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,50,"FlightCount: [{0}], flightIds: [{1}]",Ea.length].concat(Ea)));return ta}E8d(Ea,ta){const ia=new T.a;if(Ea&&""!==Ea&&ta&&0<ta.length){for(let Ja=0;Ja<ta.length;Ja++)ta[Ja]=ta[Ja].toLowerCase();Ea=Ea.toLowerCase().split(";");for(const Ja of Ea)O.a.any(ta,ab=>-1<Ja.indexOf(ab))&&ia.add(Ja)}return ia.toArray()}static get sT(){return e.a.instance}}Object(K.a)(Y,"WordPredictionAugLoopHandler",null,
[1308]);var fa=d(146),aa=d(184),ka=d(110);class H{constructor(Ea,ta,ia,Ja){this.s4b=null;this.maxWords=Ea;this.fnl=ia;this.vAi=Ja;this.Rml=ta;this.$Pc=Array(Ea);this.Jth();this.Wth()}xPj(Ea,ta,ia){Ea>this.maxWords-1||this.olg(this.$Pc[Ea],ta,ia)}Fbb(Ea,ta){this.olg(this.s4b,Ea,ta)}oTd(Ea,ta){this.s4b[Ea]=ta}flush(){H.sT.wG(()=>{for(let Ea=0;Ea<this.$Pc.length;Ea++){const ta=this.Vcj(Ea);ta&&(ta.dataFields.push(Object.assign(new ka.a,{name:F.a.LP,int64:Ea})),fa.a.sendActivityEvent(ta))}this.Jth()},
"WPT:F")}j$i(){H.sT.wG(()=>{const Ea=this.Ucj();Ea&&fa.a.sendActivityEvent(Ea);this.Wth()},"WPT:FSD")}e$i(Ea){H.sT.wG(()=>{const ta=this.Tcj(Ea);ta&&fa.a.sendActivityEvent(ta)},"WPT:FCD")}Ucj(){const Ea=this.Qce(this.fnl);for(var ta=0;ta<L.a.LTa.length;ta++)this.pTd(L.a.LTa[ta],this.s4b,Ea.dataFields);for(ta=0;ta<L.a.x7b.length;ta++)this.Q_b(L.a.x7b[ta],this.s4b,Ea.dataFields);return Ea.dataFields.length?Ea:null}Vcj(Ea){const ta=this.Qce(this.Rml);for(let ia=0;ia<F.a.LTa.length;ia++)this.pTd(F.a.LTa[ia],
this.$Pc[Ea],ta.dataFields);return ta.dataFields.length?ta:null}Tcj(Ea){const ta=this.Qce(this.vAi);for(var ia=0;ia<J.a.LTa.length;ia++)this.pTd(J.a.LTa[ia],Ea,ta.dataFields);for(ia=0;ia<J.a.x7b.length;ia++)this.Q_b(J.a.x7b[ia],Ea,ta.dataFields);return ta.dataFields.length?ta:null}olg(Ea,ta,ia){Ea[ta]=ta in Ea?Ea[ta]+ia:ia}Qce(Ea){const ta=new aa.a;ta.name=Ea;ta.dataFields=[];return ta}pTd(Ea,ta,ia){Ea in ta&&Array.add(ia,Object.assign(new ka.a,{name:Ea,int64:ta[Ea]}))}Q_b(Ea,ta,ia){Ea in ta&&Array.add(ia,
Object.assign(new ka.a,{name:Ea,string:ta[Ea]}))}Jth(){for(let Ea=0;Ea<this.maxWords;Ea++)this.$Pc[Ea]={}}Wth(){this.s4b={}}static get sT(){return e.a.instance}}Object(K.a)(H,"WordPredictionTelemetryHandler",null,[1309]);var ra=d(64),ha=d(34),Ma=d(393),Ga=d(306),na=d(91);d(238);var wa=d(51),Fa=d(35);d(284);d(300);d(1080);d.d(S,"a",function(){return pa});class pa{static get sT(){return e.a.instance}static get gE(){pa.Bzc||(pa.Bzc=new w);return pa.Bzc}static set gE(Ea){pa.Bzc=Ea}static get w3c(){return pa.Qxf}static set w3c(Ea){pa.Qxf=
Ea}static get ATh(){pa.CSd||(pa.CSd=pa.EQi());return pa.CSd}static get settings(){pa.UGc||(pa.UGc=Object.assign(new C,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return pa.UGc}static set settings(Ea){pa.UGc=Ea}static get U_a(){pa.wNd||(pa.wNd=new Q);return pa.wNd}static get zJl(){return pa.fVi}static get Z6(){pa.ESd||(pa.ESd=new H(pa.zJl,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));
return pa.ESd}static get OTi(){return pa.l7a?pa.l7a.instance?pa.l7a.instance.U3:1:(pa.l7a=r.a.instance.Ia("Common.IZoomManager"),pa.l7a&&pa.l7a.instance?pa.l7a.instance.U3:1)}static get characterPropertiesEditor(){pa.wDd||(pa.wDd=r.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return pa.wDd}static get Ind(){pa.HNd||r.a.instance.Ia("Box4.Proofing.IProofingSentenceSeparator").execute(Ea=>{Ea&&(pa.HNd=Ea)});return pa.HNd}static get JZl(){pa.DSd||(pa.DSd=r.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));
return pa.DSd}static Pjl(){window.setTimeout(()=>{const Ea={};Ea.WordPredIsEnabled=pa.settings.WordPredIsEnabled;Ea.PredictionSeenCount=pa.settings.PredictionSeenCount;Ea.PredictionAccepted=pa.settings.PredictionAccepted;pa.JZl.m2l(x.c(Ea))},pa.DTf)}static Dge(Ea,ta){if(!Ea||!ta||Ea.eventName!==m.a.PCa)return!1;const ia=Ea.nc.keyCode;if(pa.Jog(ta)){pa.K7k();ta=ta.node;if((ia===n.a.JV||ia===n.a.$q)&&pa.gWa)return z.a.Pn(Ea.nc),pa.aUj(ta),pa.sUl(ia),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),
!0;if(ia===n.a.BK)pa.w3c&&(pa.w3c=!1);else if(ia===n.a.AZ&&pa.gWa)pa.w3c=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),pa.lVa();else if(ia===n.a.fob&&Ea.nc.ctrlKey&&pa.vNd)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),pa.Uth(),!1}if(ia===n.a.Nnb&&Ea.nc.shiftKey||ia===n.a.Iba&&Ea.nc.ctrlKey||ia===n.a.oNa&&Ea.nc.altKey)return!1;ta=pa.gE.x6;const Ja=ia===n.a.CZ||ia===n.a.o7||ia===n.a.wha||ia===n.a.Jba;if(Ja||Ja&&(Ea.nc.ctrlKey||Ea.nc.shiftKey)||ia!==n.a.Iba&&Ea.nc.ctrlKey||
ia!==n.a.oNa&&Ea.nc.altKey||ia===n.a.FG||pa.gWa&&ta&&0<ta.q9.length&&!ta.q9.toLowerCase().startsWith(String.fromCharCode(ia).toLowerCase()))pa.lVa(),pa.gE.x6=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");pa.Uth();return!1}static MIj(){5>pa.settings.PredictionSeenCount&&(pa.settings.PredictionSeenCount+=1)}static lVa(){Ma.a.lVa();pa.gWa=!1}static aUj(Ea){pa.sT.wG(()=>{var ta=document.getElementById("inlinePredictedWord");
if(ta){var ia=ta.innerText;if(ia&&0<ia.length&&(Ea=Ea?Ea:pa.Jqj())){var Ja=new B.GraphTransaction(7);Ja.ld(Ea);var ab=Ea.Sa.last,Oa=wa.a.eSa(Ea),Za=na.a.Es(Oa);ab.formatting=Za.ge(ab);pa.characterPropertiesEditor.replaceTextRange(Oa,ia,!0,!0,Fa.a.typing);Ja.dispose();ia=D.InteractiveViewManager.instance.Rd;Ja=Ea.rg(ia.Na);Ja=Ga.a.eu(Ja,ha.ParagraphReader.textLength(Ea));ab=new Sys.UI.Point(Ja.x,Ja.y);ab.y+=Ja.height;ia.i7(ab,null,null,ia,!1);pa.gWa=!1;ta.innerText="";(ta=document.getElementById("inlinePlaceholderTab"))&&
pa.gig()&&(ta.className="hidePanel")}}},"WPT:IIG")}static Zql(Ea){pa.Iuf=Ea;pa.Z6.oTd(L.a.modelId,Ea.modelId);pa.Z6.oTd(L.a.modelVersion,Ea.modelVersion);pa.Z6.oTd(L.a.configId,Ea.configId)}static Toj(){return pa.Iuf}static YVd(Ea,ta){const ia=pa.ATh;var Ja=document.getElementById("inlinePredictedWord");Ja&&(Ja.innerText=ta,(ta=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<ta.length&&(ta=ta[ta.length-1],Ja.style.fontSize=ta.style.fontSize,
Ja.style.fontFamily=ta.style.fontFamily,Ja.style.color=ta.style.color,Ja.style.whiteSpace="pre",Ja=Ja.parentNode,Ea="suggestion: "+Ea,ta=document.getElementById("inlinePlaceholderTab"),ta.className="hidePanel",ta&&pa.gig()&&(ta.className="inlinePlaceholderTab",Ea+=". Tab to accept"),Ja.parentNode.setAttribute("aria-label",Ea)),ia&&(ia.className="textareaCaretTracker"),pa.Nrl()&&(pa.gWa=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static Jog(Ea){Ea||(Ea=pa.Qgj());if(Ea){const ta=
Ea.node;try{return ha.ParagraphReader.textLength(ta)<=Ea.Ra}catch(ia){}}return!1}static nek(Ea){Ea=pa.U_a.ga(Ea);Ea=Ea[L.a.yVd]-Ea[L.a.Tuc];300<Ea?(pa.Z6.Fbb(L.a.jUf,Ea),pa.Z6.Fbb(L.a.iUf,1)):(pa.Z6.Fbb(L.a.HFf,Ea),pa.Z6.Fbb(L.a.PCf,1))}static p9d(Ea){pa.Bqg("TextPredictionTelemetryIsEnabled")&&pa.Z6.e$i(Ea)}static iyg(Ea,ta){Ea=pa.U_a.ga(Ea);const ia=Ea[L.a.Tuc];ta?pa.Z6.Fbb(L.a.JFh,Ea[L.a.QCf]-ia):pa.Z6.Fbb(L.a.HFh,Ea[L.a.OCf]-ia)}static Wdc(Ea){pa.Z6.Fbb(Ea,1)}static nva(Ea,ta,ia){pa.Z6.xPj(Ea,
ta,ia)}static Rqd(){pa.gE.x6=null;pa.gE.sjb=null}static FWk(){pa.rnb("TextPredictionsSeen","TextPredictionsSeenIsEnabled");pa.MIj();pa.CVj()}static rnb(Ea,ta){pa.Bqg(ta)&&window.setTimeout(()=>{const ia=r.a.instance.Ia("Common.ISystemInitiatedFeedback");ia&&ia.execute(Ja=>{Ja.logActivity(Ea,ta)})},pa.DTf)}static Bqg(Ea){return!!t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.ka(Ea)}static EQi(){var Ea=document.body;const ta=document.createElement("div");if(Ea){Ea.appendChild(ta);ta.setAttribute("id",
"textareaCaretTracker");ta.className="hidePanel";ta.setAttribute("role","alert");Ea=document.createElement("button");const ia=document.createElement("span");Ea.setAttribute("disabled",!0);Ea.setAttribute("aria-disabled",!0);Ea.setAttribute("aria-hidden",!0);ia.setAttribute("aria-disabled",!0);ia.setAttribute("aria-hidden",!0);ia.setAttribute("id","inlinePredictedWord");ia.className="inlinePredictedWord";Ea.className="inlinePredictedWordButton";Ea.appendChild(ia);ta.appendChild(Ea);ta.appendChild(pa.qSi());
(Ea=document.getElementById("WACViewPanel"))&&$addHandler(Ea,"scroll",pa.IGj)}return ta}static Nrl(){const Ea=pa.ATh;var ta=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");ta=(ta=ta?ta.getElementsByClassName("EOP")[0]:null)?ta.getBoundingClientRect():null;return Ea&&ta?(Ea.style.cssText="transform: scale("+pa.OTi+"); transform-origin: 0% 0%",Ea.style.top=ta.top+"px",Ea.style.left=ta.left+"px",!0):!1}static gig(){return!pa.settings.PredictionAccepted}static CVj(){5!==pa.settings.PredictionSeenCount||
pa.settings.PredictionAccepted||(pa.rnb("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),pa.Pjl())}static qSi(){const Ea=document.createElement("button");Ea.setAttribute("aria-hidden",!0);Ea.className="hidePanel";Ea.id="inlinePlaceholderTab";Ea.disabled=!0;Ea.innerText="Tab";return Ea}static IGj(){pa.lVa()}static Jqj(){const Ea=ra.a.instance.Pa.nb;return Ea&&Ea.jf?Ea.jf.node:null}static K7k(){pa.$Qd||(pa.$Qd=window.setTimeout(pa.YEj,6E4*pa.eVi))}static YEj(){pa.Z6.flush();pa.Z6.j$i();pa.$Qd=
0}static B$f(Ea){return Ea&&0<Ea.length&&(Ea=Ea.split(" "),0<Ea.length)?Ea[Ea.length-1].length:-1}static sUl(Ea){const ta=pa.gE.x6,ia=pa.gE.sjb;ta&&(pa.vNd=Object.assign(new M,{keyCode:Ea,HZl:ta,IZl:ia}))}static Qgj(){const Ea=ra.a.instance.Pa.nb;return Ea&&Ea.jf?Ea.jf:null}static Uth(){pa.vNd=null}}pa.fVi=30;pa.eVi=5;pa.DTf=5E3;pa.CSd=null;pa.HNd=null;pa.wDd=null;pa.l7a=null;pa.Qxf=!1;pa.$Qd=0;pa.ESd=null;pa.wNd=null;pa.vNd=null;pa.DSd=null;pa.UGc=null;pa.Iuf=null;pa.Bzc=null;pa.gWa=!1;Object(K.a)(pa,
"WordPredictionHandler",null,[])},667:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.oCk="NoCharacterPositionOnLine";h.qCk="NoCharacterPositionOnSpan";h.pCk="NoCharacterPositionOnMultilineSpan";h.Z4b="DoNothingResult";h.vka="FailedProcessingStep";h.i$a="FailedResult";h.NTc="FirstChildNotText";h.Z8i="FirstChildNull";h.KUj="InvalidCharacterPositionResult";h.Ah="NoExecute";h.fp="NoApply";h.t2="UnexpectedState";Object(K.a)(h,"ActivityEventName",null,[])},668:function(K,S,d){d.d(S,"a",
function(){return h});K=d(0);class h{}h.LP="WordIndex";h.ush="RenderedCandidateCount";h.r8g="NotRenderedCandidateCount";h.wKf="CandidateListCount";h.HSf="CumulativeIndexOfSeen";h.yTi="CumulativeIndexOfRejected";h.xTi="CumulativeIndexOfKept";h.GSf="CumulativeIndexOfCorrect";h.wTi="CumulativeIndexOfAcceptedCandidate";h.kxh="SeenCount";h.E9k="RejectedCount";h.X$j="KeptCount";h.lOh="TypedThroughCount";h.zTi="CumulativeScoreOfKept";h.ATi="CumulativeScoreOfRejected";h.JSf="CumulativeScoreOfTypeThrough";
h.vsh="RenderedCharSum";h.W$j="KeptCharSum";h.V$j="KeptCandidateTokenSum";h.sQl="UndoOfKeptCount";h.vQl="UndoneKeptCharCount";h.mOh="TypedThroughLastMatchingCharCount";h.language="Language";h.LTa=[h.ush,h.r8g,h.wKf,h.HSf,h.yTi,h.xTi,h.GSf,h.wTi,h.kxh,h.E9k,h.X$j,h.lOh,h.zTi,h.ATi,h.JSf,h.vsh,h.W$j,h.V$j,h.sQl,h.vQl,h.mOh,h.language];Object(K.a)(h,"DataFieldsPerSentence",null,[])},669:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion=
"ModelVersion";h.DWk="PredictionAcceptedByTab";h.CWk="PredictionAcceptedByRightArrow";h.HFf="AugLoopResponseTime";h.JFh="SignalRenderedTime";h.HFh="SignalNotRenderedTime";h.jUf="DelayedResponseTime";h.zCl="SignalGeneratedCount";h.PCf="AnnotationReceivedCount";h.Kjh="PredictionRenderedCount";h.Jjh="PredictionNotRenderedCount";h.l6d="EmptyPredictionResponseCount";h.TFh="SkippedPredictionResponseCount";h.iUf="DelayedResponseCount";h.zCk="NonEnglishSkipCount";h.Tuc="SignalGenerationTime";h.yVd="AnnotationReceivedTime";
h.QCf="AnnotationRenderedTime";h.OCf="AnnotationNotRenderedTime";h.LTa=[h.CWk,h.DWk,h.HFf,h.JFh,h.HFh,h.jUf,h.zCl,h.PCf,h.Kjh,h.Jjh,h.l6d,h.TFh,h.iUf,h.zCk];h.x7b=[h.modelId,h.configId,h.modelVersion];Object(K.a)(h,"DataFieldsPerSession",null,[])},670:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.language="Language";h.IZd="CharIndex";h.XMc="CharIndexRendered";h.fwg="KeptCharCount";h.modelId="ModelId";h.Ijh="PredictionLength";h.Ljh="PredictionTokenCount";h.score="Score";h.status=
"Status";h.e$e="TypedThroughCharCount";h.LP="WordIndex";h.modelVersion="ModelVersion";h.oLh="TimeTakenAugloop";h.Ixd="TimeToRender";h.configId="ConfigId";h.LTa=[h.IZd,h.XMc,h.fwg,h.Ijh,h.Ljh,h.score,h.status,h.e$e,h.LP,h.oLh,h.Ixd];h.x7b=[h.language,h.modelId,h.configId,h.modelVersion];Object(K.a)(h,"DataFieldsPerCandidate",null,[])},671:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=
this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(K.a)(h,"InitializeParameters",null,[])},672:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.operation=
null}}Object(K.a)(h,"SubmitOperationParameters",null,[])},673:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.MHa=!0;this.d7c=this.ded=this.Wfd=this.tbd=null;this.oma=e}copy(){return new h(this.oma.copy())}move(e,r){this.MHa=!0;this.oma.move(e,r)}setOffsets(e){this.MHa=!0;this.oma.setOffsets(e)}Zf(){return this.oma.Zf()}get kc(){this.jzd();return this.tbd}get mc(){this.jzd();return this.Wfd}get hc(){this.jzd();return this.ded}get Zb(){this.jzd();return this.d7c}jzd(){if(this.MHa){var e=
this.oma.points;this.tbd=this.ded=e[0].x;this.Wfd=this.d7c=e[0].y;for(const r of e)this.tbd=Math.min(this.tbd,r.x),this.Wfd=Math.min(this.Wfd,r.y),this.ded=Math.max(this.ded,r.x),this.d7c=Math.max(this.d7c,r.y);this.MHa=!1}}}Object(K.a)(h,"Boundary",null,[])},674:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.iC=e}}Object(K.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},675:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=
d(55);class e{constructor(r){this.Oxg=this.errorType=0;this.originalText=this.token=null;this.AKa=this.Kaa=this.lcid=0;this.jTh=!1;this.rsf=r}vpe(){const r=this.token?this.token:null;return 0!==this.errorType&&e.lOj.contains(r,this.lcid)}static get lOj(){return e.ROa||(e.ROa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.ROa=null;Object(K.a)(e,"ProofingErrorDetails",null,[481])},676:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=
1]="Edit"})(h||(h={}));Object(K.b)("UserAction",h)},677:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);S=d(111);class h extends S.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=this.PreContextText=null;this.ApplicationMode=0}ul(){return 4}static Maj(e,r){const m=new h;h.YQe(m,e,r);m.UserActionType=e.paragraphNode.RVb?"Edit":"Load";return m}static YQe(e,r,m){e.Lcid=r.range.lcid;e.Input=r.yoa.substring(r.range.begin,r.range.end);e.ApplicationMode=
m;0<=r.range.Kaa&&(e.PreContextText=r.yoa.substring(r.range.Kaa,r.range.begin));0<=r.range.AKa&&(e.PostContextText=r.yoa.substring(r.range.end,r.range.AKa))}static Puj(e,r,m,n,z,t,x,B){const {SpellingRequestObjectUpdatedV2:D}=d(1149),{SpellingRequestObjectUpdated:w}=d(1150);return B?D.e$d(r,m):e?w.e$d(r,m,n,z,t,x):h.Maj(r,m)}}Object(K.a)(h,"SpellingRequestObject",S.a,[])},678:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r=null,m=null,n=null,z=!1,t=null){this.DisplayName=
this.ClientId=this.Provider=this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=r;this.DisplayName=m;this.Email=n;this.IsAnonymous=z;this.ClientId=t}}Object(K.a)(h,"Person",null,[])},679:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(82);class e{static z7a(r,m,n="GenericCommentsTask"){n=new h.a(2,1,0,()=>{m()},92,n);r.Hb(n)}static qt(r){return Error.create("SDXHostAPI Error : "+r,{["SDXHostAPIErrorCode"]:r})}}Object(K.a)(e,"OfficeSharedCommentsUtils",null,
[])},680:function(K,S,d){d.d(S,"a",function(){return m});K=d(0);var h=d(395);S=d(744);var e=d(1068),r=d(940);class m extends S.a{constructor(n,z,t=null){super(n,z,t||e.a.instance,m.tRj)}static tRj(){r.a.sendTraceTag=m.Lml;r.a.debugAssertTag=m.lUi}static Lml(n,z,t,...x){h.ULS.sendTraceTag.apply(null,[n,204,m.eTi(z),t].concat(x))}static lUi(){}static eTi(n){switch(n){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}m.jSe="wdPreviousSession";
m.SSf="wdUserSession";Object(K.a)(m,"CommonCrossDocumentMessenger",S.a,[])},681:function(K,S,d){d.d(S,"a",function(){return r});K=d(0);var h=d(395),e=d(27);class r{static Cfe(m,n){let z=null;if(m&&0<m.length&&n&&0<n.length){const t=window[n];t?t&&m in t?z=t[m]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+m+" from dictionary "+n):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+n)}return z}static dpe(){const m=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",
!1);m?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return m}}Object(K.a)(r,"CommonUtils",null,[])},682:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(301);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.pak;h.Visible=d.a.visible;h.ImageIsVisible="ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.eAb;h.Image32by32Class=
d.a.vFa;h.Image48by48Class=d.a.Bie;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(K.a)(h,"FlyoutAnchorCommandProperties",null,[])},683:function(K,S,d){d.d(S,"a",function(){return t});K=d(0);var h=d(267),e=d(27),r=d(370),m=d(227),n=d(99),z=d(65);class t{static c1a(x){let B,D;({RLl:B,SLl:D}=t.L7i());t.Ujl(B,D,x)}static L7i(){({t$b:B}=r.a.YQb(!e.AFrameworkApplication.UT));var x=$get(h.CuiHelper.cMj);if(B)var B=document.getElementById(h.CuiHelper.H7d);else B=x.childNodes[0],
x=x.childNodes[1];return{RLl:B,SLl:x}}static Ujl(x,B,D){if(x&&B&&0<B.clientHeight){const w=-1!==B.parentNode.parentNode.className.indexOf("cui-ribbon");t.Kwh(x,B,D,w)}}static Kwh(x,B,D,w){let J=null,F=null,L=null,M=null,Q=null,C=null,O=null,U=null,T=null,ca=null,N=null,da=null,Y=null,fa=null,aa=null,ka=null,H=null,ra=null,ha=null,Ma=null;({kYf:J,jYf:F,lYf:L,L9a:M,M9a:Q,TSa:C,DT:O,Dv:U,USa:T,EQ:ca,VSa:N,mYf:Ma}=t.Z1f(x,J,F,L,M,Q,C,O,U,T,ca,N,Ma));({D5b:da,iH:Y,iYf:fa,gYf:aa,N9a:ka,Lwb:H,Mwb:ra,hYf:ha}=
t.y2f(B,da,Y,fa,aa,ka,H,ra,ha));x=[J,F,L,M,Q,C,O,U,T,ca,N,fa,aa,ka,H,ra,ha,Ma];for(var Ga of x)t.jAl(Ga);Ga=[J,F,L,Q,O,U,ca,N,aa,H,ra,ha];for(const na of Ga)t.E$e(na);t.Tth(F);t.ozh(Y,0);t.w2i(J,F,L,M,Q,C,O,U,T,ca,N,da,Y,fa,aa,ka,H,ra,ha,Ma,w,D);t.lmi(C,O)}static Xjl(x,B){t.Kwh(x,null,B,!1)}static lmi(x,B){x&&B&&(x.style.marginTop=(B.offsetHeight-x.offsetHeight)/2+"px")}static Z1f(x,B,D,w,J,F,L,M,Q,C,O,U,T){for(let ca=0;x&&ca<x.childNodes.length;ca++){const N=x.childNodes[ca],da=n.a.Lka(N),Y=!!N.id;
-1!==da.indexOf("cui-QATRowLeft")?B=N:-1!==da.indexOf("cui-QATRowCenter")?D=N:-1!==da.indexOf("cui-QATRowRight")?w=N:-1!==da.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?J=N:N.id===h.CuiHelper.NXd?F=N:N.id===h.CuiHelper.P3f?L=N:N.id===h.CuiHelper.OXd?M=N:N.id===h.CuiHelper.PXd?Q=N:Y&&t.PZj(N)?C=N:-1!==da.indexOf("UsernameNameContainer")?O=N:-1!==da.indexOf("UsernameNameItem")?U=N:-1!==da.indexOf("FreemiumUpsellButton")&&(T=N);({kYf:B,jYf:D,lYf:w,L9a:J,M9a:F,TSa:L,DT:M,Dv:Q,USa:C,EQ:O,VSa:U,mYf:T}=
t.Z1f(N,B,D,w,J,F,L,M,Q,C,O,U,T))}return{kYf:B,jYf:D,lYf:w,L9a:J,M9a:F,TSa:L,DT:M,Dv:Q,USa:C,EQ:O,VSa:U,mYf:T}}static y2f(x,B,D,w,J,F,L,M,Q){for(let C=0;x&&C<x.childNodes.length;C++){const O=x.childNodes[C],U=n.a.Lka(O),T=!!O.id;-1!==U.indexOf("cui-jewel-container")?B=O:-1!==U.indexOf("cui-tts")?D=O:-1!==U.indexOf("cui-TabRowInline")?J=O:-1!==U.indexOf("cui-TabRowRight")?Q=O:-1!==U.indexOf("cui-separator")?w=O:T&&O.id.startsWith(h.CuiHelper.kfh)&&!F?F=O:T&&O.id.startsWith(h.CuiHelper.o1f)?L=O:T&&
O.id.startsWith(h.CuiHelper.nQe)&&(M=O);({D5b:B,iH:D,iYf:w,gYf:J,N9a:F,Lwb:L,Mwb:M,hYf:Q}=t.y2f(O,B,D,w,J,F,L,M,Q))}return{D5b:B,iH:D,iYf:w,gYf:J,N9a:F,Lwb:L,Mwb:M,hYf:Q}}static Tjl(x,B,D,w,J,F,L,M,Q){t.bS(x,B,Q)&&(t.SZc(B),t.bS(x,B,Q)&&t.SZc(B));t.bS(B,w,Q)&&(t.QL(D),t.QL(J),t.bS(B,w,Q)&&(t.SZc(B),t.bS(B,w,Q)&&(t.SZc(B),t.bS(B,w,Q)&&t.QL(w))));t.bS(w,M,Q)&&(t.QL(D),t.QL(J));x=[F,L,M];t.Djg(w,M,x,Q);t.Djg(B,M,x,Q)}static Djg(x,B,D,w){let J=0;for(;J<D.length&&t.bS(x,B,w);)t.QL(D[J]),J++}static buj(x){if(!x)return 0;
if(void 0===x._scaleStep||null===x._scaleStep){let B=0;-1!==x.className.indexOf("cui-tts-scale1")?B=1:-1!==x.className.indexOf("cui-tts-scale2")&&(B=2);x._scaleStep=B}return parseInt(x._scaleStep)}static SZc(x){let B=t.buj(x);2>B&&t.ozh(x,++B)}static ozh(x,B){x&&(x.className=t.Ehl[B],x._scaleStep=B)}static bS(x,B,D){return x&&B?z.a.$wg(z.a.mi(x),z.a.mi(B),D):!1}static KJb(x,B,D){let w=0;x&&B&&(w=z.a.cte(z.a.mi(x),z.a.mi(B),D));return w}static b1d(x){for(let B=0;x&&B<x.childNodes.length;B++)if(-1!==
x.childNodes[B].className.indexOf("cui-cg"))return!0;return!1}static qbe(x){let B=null;for(let D=x.childNodes.length-1;x&&0<=D;D--){const w=x.childNodes[D];if(-1===w.className.indexOf("cui-cg"))break;B=w}return B}static WQb(x,B,D){if(x&&!t.Wm(x)){var w=m.a.wt(x);w=n.a.YM(w.paddingLeft)+n.a.YM(w.paddingRight);D=x.offsetWidth-D-w;let J=0;for(;B&&B!==x;)(w=m.a.wt(B))&&(J+=n.a.YM(w.paddingLeft)+n.a.YM(w.paddingRight)),B=B.parentNode;D=Math.max(D,75+J);x.style.width=D+"px"}}static Wel(x,B,D){if(x&&B){let w=
0,J=0;({left:w,top:J}=z.a.D8f(B,w,J));t.ZAk(x,D?w-x.offsetWidth:w+B.offsetWidth)}}static w2i(x,B,D,w,J,F,L,M,Q,C,O,U,T,ca,N,da,Y,fa,aa,ka,H,ra){H&&t.Tjl(U,T,ca,N,da,Y,fa,aa,ra);t.b1d(T)?t.bkl(T,x,B,D,w,J,F,L,M,Q,C,O,ka,ra):t.akl(x,B,D,w,J,F,L,M,Q,C,O,ka,ra)}static akl(x,B,D,w,J,F,L,M,Q,C,O,U,T){const ca=!!J,N=!!L,da=!!M;let Y=0;if((N||da)&&0<(Y=t.KJb(x,B,T))){let fa=N;da&&(!N||M.offsetWidth>L.offsetWidth)&&(fa=!1);t.WQb(fa?L:M,fa?L:M,fa?Y:2*Y);N&&da&&0<(Y=t.KJb(x,B,T))&&t.WQb(fa?L:M,fa?L:M,fa?Y:2*
Y)}if(N&&t.bS(L,B,T)||ca&&t.bS(J,B,T))t.QL(w),t.QL(J),t.QL(F),t.QL(L),da&&(t.E$e(B),t.E$e(M));t.Pph(B,D,M,Q,C,O,U,T);da&&t.AKf(M,x,D,T)}static bkl(x,B,D,w,J,F,L,M,Q,C,O,U,T,ca){const N=!!M,da=!!Q,Y=!!C,fa=!!T,aa=t.qbe(x);0<(B=t.KJb(B,aa,ca))&&(N&&t.WQb(M,M,B),!N||t.bS(M,aa,ca))&&(t.QL(J),t.QL(F),t.QL(L),t.QL(M));t.bS(x,D,ca)&&t.Wel(D,x,ca);t.Pph(D,w,Q,C,O,U,T,ca);0<(B=t.KJb(x,w,ca))&&(t.WQb(O,U,B),fa&&t.bS(x,w,ca)&&t.QL(T),Y&&t.bS(x,w,ca)&&t.QL(C));da&&!t.Wm(D)&&t.AKf(Q,x,w,ca)}static Pph(x,B,D,w,
J,F,L,M){const Q=!!D,C=!!w,O=!!J,U=!!L;let T=0;if((Q||O)&&0<(T=t.KJb(x,B,M))){const ca=!!x&&"absolute"!==x.style.position;let N=Q;O&&(!Q||J.offsetWidth>D.offsetWidth)&&(N=!1);t.WQb(N?D:J,N?D:F,N&&ca?2*T:T);Q&&O?(0<(T=t.KJb(x,J,M))&&(N=!N,t.WQb(N?D:J,N?D:F,N&&ca?2*T:T)),t.bS(x,J,M)&&t.QL(x)):Q&&t.bS(x,B,M)&&t.QL(x)}U&&t.bS(x,B,M)&&t.QL(L);C&&t.bS(x,B,M)&&t.QL(w)}static Wm(x){if(!x)return!0;x=x._isHidden;return!(void 0===x||null===x||"0"===x)}static QL(x){x&&!t.Wm(x)&&(x.style.display="none",x._isHidden=
"1")}static jAl(x){x&&t.Wm(x)&&(x.style.display="",x._isHidden="0")}static E$e(x){x&&(x.style.width="auto",x.style.maxWidth="none")}static ZAk(x,B){x&&(x.style.position="absolute",x.style.left=B+"px")}static Tth(x){x&&(x.style.position="static",x.style.left="auto")}static AKf(x,B,D,w){if(x&&x.parentNode&&x.parentNode.parentNode){var J=t.GSk(x);"auto"!==x.parentNode.style.width&&(x.style.width=x.parentNode.offsetWidth-J+"px");var F=w?D:B;B=w?B:D;D=z.a.mi(x.parentNode.parentNode);F=F?z.a.mi(F):new Sys.UI.Bounds(D.x,
0,0,0);B=B?z.a.Z$a(B):new Sys.UI.Point(D.x+D.width,0);"absolute"===x.parentNode.style.position?J=B.x-(F.x+F.width)-J-1:(D=z.a.mi(x.nextSibling?x.parentNode:x),D=D.x+D.width/2,J=2*Math.min(D-(F.x+F.width),B.x-D)-J-1);x.style.maxWidth=J+"px"}}static GSk(x){var B=m.a.wt(x);B=B?n.a.YM(B.paddingLeft)+n.a.YM(B.paddingRight):0;var D=m.a.wt(x.parentNode);D=D?n.a.YM(D.paddingLeft)+n.a.YM(D.paddingRight):0;let w=0;for(;x.nextSibling;)x=x.nextSibling,w+=x.offsetWidth;return B+D+w}static PZj(x){return!!x.id&&
(x.id.startsWith(h.CuiHelper.s2e)||x.id.startsWith(h.CuiHelper.Eqd))}}t.Ehl=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(K.a)(t,"RibbonTabScalingActor",null,[])},684:function(K,S,d){d.d(S,"a",function(){return x});K=d(0);var h=d(395),e=d(7),r=d(27),m=d(146),n=d(55),z=d(184),t=d(110);class x{constructor(){this.n3=null}Myd(){try{this.n3||(this.n3=n.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(B){h.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+
B)}}tfe(B,D){return this.n3?this.n3.getToken(B,D):new Promise(w=>{n.a.instance.Ia("Common.App.SearchCommon.ISearchOAuthManager").execute(J=>{J?(this.n3=J,this.n3.getToken(B,D).then(F=>w(F))):w(null)})})}doj(){this.Myd();return this.n3?this.n3.getToken("Search",r.AFrameworkApplication.pue):null}Rdg(){if("Dev Box"===r.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(B=>{window.setTimeout(()=>
{B(window.TellMeSubstrateTokenOverride)},750)});this.Myd();return this.n3?this.n3.getToken("Search",r.AFrameworkApplication.j6e):null}kyj(){this.Myd();return this.n3?this.n3.getToken("Search",this.hyj()):null}hyj(){return r.AFrameworkApplication.fa.Ha("TellMeServiceAuthEndpointForSearch")}Mvj(){if("Dev Box"===r.AFrameworkApplication.fa.Ha("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(B=>{window.setTimeout(()=>
{B(window.TellMeSubstrateTokenOverride)},750)});this.Myd();return this.n3?this.n3.getToken("SmartLookup",this.Lvj()):null}Lvj(){return r.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")}eoj(){return Object(e.a)(this,this.doj,"getLokiTokenPromise")}rxj(){return Object(e.a)(this,this.Rdg,"getSubstrateTokenPromise")}TOb(){return!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.mb.TOb}bzj(){const B={};this.TOb()&&(B.Loki=this.eoj(),B.Substrate=this.rxj());return B}bec(B){m.a.DLa(Object.assign(new z.a,
{name:"Events",dataFields:[Object.assign(new t.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new t.a,{name:"Status",bool:B})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}tdk(){return r.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.bec(!1);return!1}).then(()=>{this.bec(!0);return!0}):new Promise((B,D)=>{const w=n.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xI;w?w.loadScript("tellme-strings").then(()=>
{this.bec(!0);B(!0)}).catch(()=>{this.bec(!1);D(!1)}):(this.bec(!1),D(!1))})}static w6j(){return!!r.AFrameworkApplication.Aa&&(r.AFrameworkApplication.Aa.mb.$cc||r.AFrameworkApplication.Aa.mb.cCb)}static N3c(){return!!r.AFrameworkApplication.Aa&&r.AFrameworkApplication.Aa.mb.cCb}}Object(K.a)(x,"ReactSharedHeaderSearchUtils",null,[])},685:function(K,S,d){d.d(S,"a",function(){return x});K=d(0);var h=d(395),e=d(47),r=d(954),m=d(29),n=d(44),z=d(75),t=d(34);class x{constructor(B=2E3){this.qPa=B}aZj(){const B=
x.aX();return this.F9j(B)}F9j(B){return 0<this.VXc(B).mentionLength}getSelectedText(){const B=x.aX();return this.VXc(B)}VXc(B){return this.Buj(B)}Buj(B){var D=null;B&&B.ida&&n.SelectionEditor.Xg(B.Ua)&&n.SelectionEditor.$Bb(B.Ua)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),D=n.SelectionEditor.gTa(B.Ua,!1));D&&(B=D);if(!B)return Object.assign(new r.a,{neighborhood:"",mentionStart:0,mentionLength:0});const w=new Sys.StringBuilder;let J=D=0;const F=[],
L=B.length;for(let Q=0;Q<L;Q++){const C=B.ga(Q);if(!t.ParagraphReader.fe(C.node)||Array.contains(F,C.node.eNa))continue;F.push(C.node.eNa);let O=t.ParagraphReader.text(C.node),U=0;var M=t.ParagraphReader.dua(C.node,!0,!0,!0);let T=t.ParagraphReader.dua(C.node,!1,!0,!0),ca=0;for(;O.length<this.qPa&&(M||T);){if(!(ca%2)&&M){const N=t.ParagraphReader.text(M);O=N+" "+O;U+=N.length+1;M=t.ParagraphReader.dua(M,!0,!0,!0)}1===ca%2&&T&&(O=O+" "+t.ParagraphReader.text(T),T=t.ParagraphReader.dua(T,!1,!0,!0));
ca++}M=Q===L-1;Q||-1===C.Ra||(D=C.Ra);J+=M&&-1!==C.Lb?C.Lb:O.length;w.append(O);D+=U;J+=U;M||(w.append(" "),J++)}for(B=z.AParagraphNode.Zpd(w.toString()," ");D<J&&e.a.yz(B.charCodeAt(D));)D++;for(;J>D&&e.a.yz(B.charCodeAt(J-1));)J--;return this.Kmi(B,D,J)}Kmi(B,D,w){if(B.length>this.qPa){var J=w-D;if(J>this.qPa)B=B.substr(D,this.qPa),w=this.qPa,D=0;else{J=Math.max(D-Math.floor((this.qPa-J)/2),0);let F;F=Math.min(J+this.qPa,B.length);J=Math.max(F-this.qPa,0);D-=J;w-=J;B=B.substring(J,F)}}return Object.assign(new r.a,
{neighborhood:B,mentionStart:D,mentionLength:w-D})}static aX(){var B=m.App.Mb.Ld.Rn;if(!B)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;B=B.Nb;return B&&B.Pa&&B.Pa.length?B.Pa.nb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(K.a)(x,"Box4InsightsSelection",null,[329,330])},686:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(K.a)(h,"NewOutlineElementInfo",
null,[])},687:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Gid="Listening";h.RIb="Warning";h.i_a="Error";Object(K.a)(h,"VoiceNotificationResourceStrings",null,[])},688:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.CoachButton="coachButton";h.MicButton="micButton";h.PrevButton="prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton=
"exitButton";h.CameraButton="cameraButton";h.OptionsButton="optionsButton";Object(K.a)(h,"SlideshowToolbarButtonIDs",null,[])},689:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported";e[e.perfAutomation=5]="perfAutomation"})(h||(h={}));Object(K.b)("SupportStatus",
h)},690:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(449);class h extends d.a{constructor(e){super();this.shapeNode=e}get hsg(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}Object(K.a)(h,"InternalClipboardShape",d.a,[])},691:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(973);class h extends d.a{constructor(e,r,m){super(e,r);this.aGh=m}}Object(K.a)(h,"ClipServiceSlideCopyParams",
d.a,[])},692:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(43);class e{constructor(r,m){this.fhb=!1;this.kFd=this.Avf=-1;this.px=r;m&&this.start()}start(){this.fhb=!0;this.kFd=-1;const r=h.a.xZ();r&&(this.Avf=r)}stop(){this.fhb=!1;const r=h.a.xZ();r&&0<this.oba&&r>=this.oba&&(this.kFd=r-this.oba)}get operation(){return this.px}get yRc(){return this.kFd}get oba(){return this.Avf}}Object(K.a)(e,"PPTStopwatch",null,[])},693:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=
d(231);class e{}var r=e;e.Mvh={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",
darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",
goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",
lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",
olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",
slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};e.TRa=m=>{m=m.toLowerCase().trim().replace(/\s/g,"");return e.Mvh[m]?e.Mvh[m]:""};e.fKf=m=>m?""!==r.TRa(m):!1;e.dgj=m=>{var n=/^#([0-9a-f])*$/i;if(!m||!m.match(n))throw Error("invalid hex color string provided");
n=new h.Color;switch(m.length){case 7:n.a=1;n.r=parseInt(m.substring(1,3),16);n.g=parseInt(m.substring(3,5),16);n.b=parseInt(m.substring(5,7),16);break;case 9:n.r=parseInt(m.substring(1,3),16);n.g=parseInt(m.substring(3,5),16);n.b=parseInt(m.substring(5,7),16);n.a=parseInt(m.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return n};Object(K.a)(e,"ColorTranslator",null,[])},694:function(K,S,d){d.d(S,"a",function(){return z});K=d(0);var h=d(1261),e=d(41),r=d(39),m=
d(58),n=d(43);class z{static yPc(t,x,B,D,w,J,F,L,M,Q,C,O,U,T,ca){J=O.BDa(!1,t.cid,t.sid,0,x.shapeType,J,F,L,M,Q+1);J.setValue(r.a.mL,x.Yga);({XBh:D,PBh:T}=w.Rcg(D,x,B,ca,U,T));U=U.Nd;J.setValue(e.a.Ix,U.gf(ca.cI(D,B),0));J.setValue(e.a.iD,U.gf(ca.cI(T,B),1));J.setValue(r.a.fSb,J.Ix);J.setValue(r.a.Pzb,J.iD);J.setValue(r.a.sqd,!0);J.Ada=h.a.tKa(D,0);J.zda=h.a.tKa(T,1);J.setValue(r.a.NSa,0);J.setValue(r.a.OSa,0);J.setValue(r.a.cWa,!0);J.setValue(r.a.isResizable,!0);J.setValue(r.a.bM,!0);J.sO=!0;J.YVa=
!0;ca=(U=95===x.Yga||97===x.Yga)||Array.contains(z.gte,x.Yga);J.bM=!U;J.isResizable=!0;J.setValue(r.a.wz,U);J.setValue(r.a.v0,95===x.Yga);J.CG=m.a.ax(t.sid,t.cid);J.qmb=J.get_shapeId();J.setValue(r.a.Kua,!0);t=w.xQf(D,T,B);J.dS=t;(C.cM(J)||C.Hla(J))&&n.a.Kb&&(n.a.Kb.Qj=!0);ca?w.Fzh(J):w.Qzh(J);return J}}z.gte=[88,93,94,89,90,91,92];Object(K.a)(z,"InsertContentShapeNodeFactory",null,[])},695:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r,m,n){this.Yga=e;this.shapeType=
r;this.height=m;this.width=n}}Object(K.a)(h,"AutoShapeProps",null,[])},696:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(){super()}}Object(K.a)(h,"SlidesChangedArgs",Sys.EventArgs,[])},697:function(K,S,d){d.d(S,"a",function(){return e});d.d(S,"b",function(){return r});var h=d(47);const e=m=>{m=btoa(m);m=m.replace(RegExp("\\+","g"),"-");m=m.replace(RegExp("\\/","g"),"_");return m=m.replace(RegExp("\\=+$","g"),"")},r=m=>{if(h.a.Xa(m))return null;const n=
RegExp("%([0-9A-F]{2})","g");m=encodeURIComponent(m);let z="",t=0,x;for(;x=n.exec(m);){const B=n.lastIndex-3;B>t&&(z+=m.substring(t,B));z+=h.a.fromCharCode(parseInt(String("0x"+x[1])));t=n.lastIndex}t<m.length&&(z+=m.substring(t,m.length));return btoa(z)}},698:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.cxb="extId";h.svb="ComponentType";h.Oja="ComponentId";h.bNj="HostProps";h.Mib="OptionalProps";Object(K.a)(h,"ActionPropertyNames",null,[])},699:function(K,S,d){d.d(S,"a",function(){return h});
K=d(0);var h;(function(e){e[e.OK=0]="OK";e[e.notReady=1]="notReady";e[e.storeDisabled=2]="storeDisabled";e[e.invokeFailure=3]="invokeFailure"})(h||(h={}));Object(K.b)("AddinDetailsQueryError",h)},700:function(K,S,d){d.d(S,"a",function(){return t});K=d(0);var h=d(27),e=d(171),r=d(94),m=d(7);S=d(18);var n=d(28),z=d(68);class t{constructor(x,B,D,w,J,F,L,M,Q,C,O,U,T,ca){this.a6=this.Wl=this.Px=null;this.OJf=!0;this.ZXa=x;this.Lwk=B;this.Rlk=D;this.vgc=w;this.F5=F;this.fc=L;this.Vd=M;this.Ve=Q;this.ywk=
C;this.Qfb=O;this.xpk=U;this.wpk=T;this.vpk=ca;this.EJ=J}openDialog(){this.qOi();h.AFrameworkApplication.Aa.tjb();try{this.Wl.click()}catch(x){const B=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",x.message,x.stack);n.a.J(509727820,818,10,B);throw x;}}submit(){const x=this.Wl.files[0];this.a6=this.Rlk();this.a6.HMe&&this.a6.HMe(this.F5,this.fc,this.Vd,this.Ve);if(this.ywk)this.iWl(x);else{const B=new FormData;for(let w of this.a6.cVd)B.append(w.key,w.value);B.append("fileInputId",
x,x.name);const D=new XMLHttpRequest;D.onreadystatechange=()=>{this.BJb(D)};D.open("POST",this.a6.Rih);D.send(B)}}BJb(x){if(4===x.readyState){const B=x.status;if(!B||B>=e.a.mx&&B<e.a.Tri){if(this.a6.onSuccess)this.a6.onSuccess(x.responseText,this.F5,this.fc,this.Vd,this.Ve,this.Wl)}else this.a6.Pz&&this.a6.Pz(x.responseText,this.F5,this.fc,this.Vd,this.Ve);this.dispose()}}iWl(x){this.Qfb().pZ(this.vgc,this.EJ,x.size,x,this.a6.cVd.ga("MediaToken"),this.Ve,this.xpk,this.wpk,this.vpk,B=>{if(this.a6.onSuccess)this.a6.onSuccess(B.result,
this.F5,this.fc,this.Vd,this.Ve,this.Wl)},B=>{this.a6.Pz&&this.a6.Pz(B.error.Code.toString(),this.F5,this.fc,this.Vd,this.Ve)})}dispose(){this.Px&&(r.a.removeHandler(this.Wl,"change",Object(m.a)(this,this.nTc,"fileInputChange")),document.body.removeChild(this.Px),this.Wl=this.Px=null,t.Haf.remove(this))}qOi(){this.Px||(this.Px=document.createElement("form"),this.Px.id="uploadFormId",this.Px.style.visibility=z.a.hidden,this.Px.method="post",this.Px.encoding="multipart/form-data",this.Px.action="",
this.Wl=document.createElement("input"),this.Wl.style.visibility=z.a.hidden,this.Wl.type="file",this.Wl.id="uploadFileInputId",this.Wl.name="uploadFileInputId",this.Wl.accept=this.ZXa,this.Px.appendChild(this.Wl),document.body.appendChild(this.Px),r.a.addHandler(this.Wl,"change",Object(m.a)(this,this.nTc,"fileInputChange")))}nTc(){this.Wl.value&&this.Wl.value.length?(this.OJf=!1,this.Lwk(this.Wl,this.Vd,this.Ve,this.vgc).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static t4e(x,
B,D,w,J,F,L,M,Q,C,O,U,T,ca){for(let N of t.Haf)N.OJf&&N.dispose();x=new t(x,B,D,w,J,F,L,M,Q,C,O,U,T,ca);t.Haf.add(x);x.openDialog()}}t.Haf=new S.a;Object(K.a)(t,"UploadFileDialog",null,[])},701:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(67),e=d(7),r=d(387),m=d(124);class n{constructor(z,t,x,B,D,w,J,F,L,M,Q,C){this.pYd=1;this.m5=t;this.Uk=z;this.qjk=x;this.af=L;this.Xr=M;this.Rc=Q;this.Wgb=F;this.kcd=D;this.lcd=B;this.A5=w;this.af.addCssClass(this.Uk,"prControl");this.Uk.style.width=
this.af.Pc(t);this.Ov=J.vRi();this.w9c=J.uRi();this.Ov.vRa(z);this.w9c.vRa(z,t,t);this.ekc=C;this.cLa()}dispose(){this.k$e();this.clear();this.Ov.dispose();this.w9c.dispose();this.af.removeCssClass(this.Uk,"prControl")}get N_a(){return m.a.none}clear(){this.MRa();this.h_d();this.PYe()}setZIndex(z){this.Uk.style.zIndex=String(z)}aKe(){this.ekc.xa.style.zIndex=String(this.pYd+r.a.Bha)}PYe(){this.ekc.xa.style.zIndex="0"}lzh(z,t,x=null){z=this.Wgb.$Qf(this.m5,this.m5,this.qjk,z,"",x);this.Ov.OLa(z,t)}I_b(z,
t){this.w9c.add(z,t)}h_d(){this.w9c.clear()}MRa(){this.Ov.clear()}onClick(){return!0}cLa(){this.lcd&&this.Xr.ub(h.a.pointerOver,this.Uk,this.lcd);this.kcd&&this.Xr.ub(h.a.pointerOut,this.Uk,this.kcd);this.A5?this.Rc.ub(h.a.click,this.Uk,this.A5):this.Rc.ub(h.a.click,this.Uk,Object(e.a)(this,this.onClick,"onClick"));this.Rc.ub(h.a.doubleClick,this.Uk,Object(e.a)(this,this.onClick,"onClick"))}k$e(){this.lcd&&this.Xr.Bb(h.a.pointerOver,this.Uk,this.lcd);this.kcd&&this.Xr.Bb(h.a.pointerOut,this.Uk,this.kcd);
this.A5?this.Rc.Bb(h.a.click,this.Uk,this.A5):this.Rc.Bb(h.a.click,this.Uk,Object(e.a)(this,this.onClick,"onClick"));this.Rc.Bb(h.a.doubleClick,this.Uk,Object(e.a)(this,this.onClick,"onClick"))}}Object(K.a)(n,"ShapePawn",null,[205])},719:function(K,S,d){d.r(S);K=d(0);var h=d(395),e=d(196),r=d(948),m=d(1134),n=d(27),z=d(1133),t=d(7),x=d(1252),B=d(1253),D=d(29),w=d(473);class J extends w.a{constructor(Ga,na,wa,Fa,pa,Ea){super();this.init(Ga);this.$l("DummyClipboardOperation");this.yFa(n.AFrameworkApplication.Qa,
na,Fa,pa,Ea);this.Rt=wa;this.np=8;this.eZ()}run(){this.WOa=!0;this.plb(this.Rt);this.Ioa();this.np=32}}Object(K.a)(J,"DummyClipboardOperation",w.a,[]);var F=d(99),L=d(129),M=d(118),Q=d(61);class C{constructor(Ga,na,wa){h.ULS.shipAssertTag(6305502,307,!!Ga);this.properties=Ga;this.qd=na;this.yra=wa}get Xc(){return this.qd}lbg(){return this.properties.sa(Q.a.aV,"")}Pjh(){return!0}dNh(){let Ga,na=!1;Ga=null;const wa=this.lbg();if(this.yra||""!==wa)try{({E9a:Ga,returnValue:na}=this.N9e(wa))}catch(Fa){h.ULS.shipAssertTag(4203138,
307,!1),this.Xc.Yb(L.a.vka,{["Reason"]:M.a.UGf}),F.a.bDa(Ga)}else h.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Xc.Yb(L.a.t2,{["Reason"]:M.a.z7d});return{returnValue:na,rOc:Ga}}}Object(K.a)(C,"AStringInputImportStrategy",null,[724]);class O extends C{constructor(Ga,na,wa,Fa,pa){super(Ga,na,pa);this.lk=wa;this.GPd=Fa}N9e(Ga){const {ClipboardActor:na}=d(719);let wa;if(this.yra&&!Ga)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,
E9a:null};wa=null;if(this.yra)return wa=this.lk.iKa(Ga),{returnValue:!0,E9a:wa};if(this.GPd){const Fa=this.properties.sa(Q.a.fQe,"");Fa&&(wa=this.lk.iKa(Fa))}wa||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),wa=na.mhh,wa.innerHTML=Ga);return{returnValue:!0,E9a:wa}}}Object(K.a)(O,"HtmlStringImportStrategy",C,[]);var U=d(47);class T extends C{constructor(Ga,na,wa){super(Ga,na,wa)}N9e(Ga){let na;if(this.yra&&!Ga)return h.ULS.sendTraceTag(541172642,
307,10,"No htmlDomContent"),{returnValue:!1,E9a:null};na=document.createElement("div");Ga=Ga.split(RegExp("\r\n|\r|\n"));for(var wa=0;wa<Ga.length-1;wa++){const Fa=document.createElement("p");Fa.innerText=this.jte(Ga[wa]);na.appendChild(Fa)}wa=document.createElement("span");wa.innerText=U.a.t6d(Ga[Ga.length-1]);na.appendChild(wa);return{returnValue:!0,E9a:na}}jte(Ga){return U.a.t6d(Ga.length?Ga:" ")}}Object(K.a)(T,"MultiLineTextImportStrategy",C,[]);class ca extends T{constructor(Ga,na,wa){super(Ga,
na,wa)}lbg(){return this.properties.sa(Q.a.Yib,"")}jte(Ga){Ga=super.jte(Ga);return Ga.length&&" "!==Ga?Ga:"\u00a0"}}Object(K.a)(ca,"MultiLinePlainTextImportStrategy",T,[]);class N extends C{constructor(Ga,na,wa){super(Ga,na,wa)}N9e(Ga){var {ClipboardActor:na}=d(719);if(this.yra&&!Ga)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,E9a:null};na=na.mhh;na.innerText=Ga;return{returnValue:!0,E9a:na}}}Object(K.a)(N,"PlainTextImportStrategy",C,[]);var da=d(396);class Y{constructor(Ga){this.sg=
this.Eqe=!1;this.jW=Ga}Pjh(){this.Eqe||(this.Eqe=!0,this.sg=!1,this.jW.prepareForPaste(()=>{this.sg=!0}));return this.sg}dNh(){let Ga;this.Eqe=!1;Ga=this.jW.paste();return Ga?Ga.hasChildNodes()?{returnValue:!0,rOc:Ga}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),Y.Xc.Yb(L.a.t2,{["Reason"]:M.a.z7d}),{returnValue:!1,rOc:Ga}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Y.Xc.Yb(L.a.i$a,{["Reason"]:M.a.Q6e}),{returnValue:!1,rOc:Ga})}static get Xc(){return da.a.instance}}
Object(K.a)(Y,"SystemClipboardImportStrategy",null,[724]);var fa=d(64),aa=d(38),ka=d(51),H=d(40),ra=d(35),ha=d(261);d.d(S,"ClipboardActor",function(){return Ma});class Ma{constructor(Ga,na,wa,Fa,pa,Ea,ta,ia){this.$df=null;this.wWb=0;this.uYh=Ga;this.jW=na;this.qd=wa;this.lk=Fa;this.Uc=pa;this.Ca=Ea;this.ot=ta;this.Imf=!!ia&&ia.ka("SupportImageDragDropExternalIsEnabled");this.SPd=!!ia&&ia.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.SK=new ha.a;this.hDc=!!ia&&ia.ka("AddMergeFormattingOptionInPasteTextFloatieEnabled");
this.SK.$(ra.a.paste,257);this.SK.$(ra.a.u6,8449);this.SK.$(ra.a.z8,1);this.SK.$(ra.a.ing,513);this.SK.$(ra.a.reformatPastedContent,4097);this.hDc&&this.SK.$(ra.a.aMb,20481);this.SK.$(ra.a.y0a,12289);this.SK.$(ra.a.fmd,7);this.SK.$(ra.a.emd,1);this.SK.$(ra.a.ghh,8193);this.SK.$(ra.a.copy,272);this.SK.$(ra.a.GLc,16);this.SK.$(ra.a.cut,304);this.SK.$(ra.a.f1b,48);this.SK.$(ra.a.Ohd,64);this.SK.$(ra.a.Phd,64);this.SK.$(ra.a.showPlaceholderGlossary,65536);this.Imf&&this.SK.$(ra.a.eXf,1)}get QMf(){return this.uYh.value}get bB(){return this.jW}vb(){this.Ca.ra(ra.a.F_k,
H.a.application,Object(t.a)(this,this.fod,"queryPasteOptions"),97);this.Ca.ra(ra.a.G_k,H.a.application,Object(t.a)(this,this.fod,"queryPasteOptions"),97);this.SPd?this.Ca.ra(ra.a.Ylh,H.a.application,Object(t.a)(this,this.$Te,"queryReformatPasteOptions"),97):this.Ca.ra(ra.a.Zlh,H.a.application,Object(t.a)(this,this.$Te,"queryReformatPasteOptions"),97);this.Ca.ra(ra.a.$lh,H.a.application,Object(t.a)(this,this.$Te,"queryReformatPasteOptions"),97);this.Ca.bT(ra.a.f1b,H.a.view,Object(t.a)(this,this.pT,
"clipboardAction"),1028);this.Ca.bT(ra.a.cut,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.Ca.rCa(ra.a.GLc,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"));this.Ca.rCa(ra.a.copy,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"));this.Imf&&this.Ca.bT(ra.a.eXf,H.a.view,Object(t.a)(this,this.j_i,"dropBrowserContent"),1028);this.Ca.bT(ra.a.z8,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.Ca.bT(ra.a.paste,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),
1028);this.Ca.bT(ra.a.u6,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.Ca.bT(ra.a.ghh,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.Ca.bT(ra.a.emd,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.Ca.bT(ra.a.fmd,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.hDc&&this.Ca.bT(ra.a.aMb,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),4);this.Ca.bT(ra.a.reformatPastedContent,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);
this.Ca.bT(ra.a.y0a,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"),1028);this.Ca.ya(ra.a.Lqd,H.a.view,e.ActionManager.Sg);this.Ca.ya(ra.a.iSk,H.a.view,e.ActionManager.Sg);this.Ca.ya(ra.a.yhh,H.a.view,e.ActionManager.Sg);this.Ca.ya(ra.a.zhh,H.a.view,e.ActionManager.Sg);this.Ca.ya(ra.a.Ahh,H.a.view,e.ActionManager.Sg);this.Ca.ya(ra.a.xhh,H.a.view,e.ActionManager.Sg);this.Ca.rCa(ra.a.Ohd,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"));this.Ca.rCa(ra.a.Phd,H.a.view,Object(t.a)(this,this.Phd,
"moveSelectedContentWithinCurrentParagraph"));this.Ca.rCa(ra.a.ing,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"));this.Ca.rCa(ra.a.showPlaceholderGlossary,H.a.view,Object(t.a)(this,this.pT,"clipboardAction"));this.Ca.ya(ra.a.ESf,H.a.view,e.ActionManager.Sg);this.Ca.ya(ra.a.fTf,H.a.view,e.ActionManager.Sg)}fod(Ga,na,wa,Fa,pa){if(1===wa)return 32;pa[r.a.On]=!1;return 32}j_i(Ga,na,wa,Fa,pa,Ea){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var ta=Ea.DataTransfer;Ea=ta.getData("text/html");
ta=ta.getData("text/plain");let ia=!1;const Ja=new m.DictionaryPropertySet;0<Ea.length?(h.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ja.setValue(Q.a.aV,Ea),ia=!0):0<ta.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ja.setValue(Q.a.Yib,ta),ia=!0);if(ia){const ab=this.SK.ga(na);return this.QMf.create(Ga,na,ab,new x.a(()=>this.bVf(ab,Ja)),wa,Fa,pa,Ja)}return null}$Te(Ga,na,wa,Fa,pa){if(na=Object(B.a)(Object,pa))n.AFrameworkApplication.uk("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),
!this.SPd&&Ga===ra.a.Zlh||this.SPd&&Ga===ra.a.Ylh?(Ga=this.wWb!==ra.a.reformatPastedContent&&this.wWb!==ra.a.y0a,na[r.a.On]=this.wWb===ra.a.reformatPastedContent||Ga):Ga===ra.a.$lh&&(na[r.a.On]=this.wWb===ra.a.y0a);return 32}pT(Ga,na,wa,Fa,pa,Ea){if((n.AFrameworkApplication.XE||n.AFrameworkApplication.Vx)&&!n.AFrameworkApplication.YSa||aa.a.instance.ga(83))return new J(Ga,na,wa,Fa,pa,Ea);const ta=this.SK.ga(na);1!==Fa&&ta&1&&(this.wWb=na);1!==Fa&&Ea&&ta&1&&(this.$df=Ea);1!==Fa&&!Ea&&ta&4096&&(Ea=
this.$df);return this.QMf.create(Ga,na,ta,new x.a(()=>this.bVf(ta,Ea)),wa,Fa,pa,Ea)}Phd(Ga,na,wa,Fa,pa,Ea){Ea=ka.a.Oj(fa.a.instance.Pa.nb.Ua.node,Ea);return this.pT(Ga,na,wa,Fa,pa,Ea)}bVf(Ga,na){return Ga&256?new Y(this.bB):Ga&2?Ga&4096?new O(na,this.qd,this.lk,D.App.instance.Ebc,D.App.instance.QOb):new N(na,this.qd,D.App.instance.QOb):na.Ta(Q.a.Yib)?new ca(na,this.qd,D.App.instance.QOb):new O(na,this.qd,this.lk,D.App.instance.Ebc,D.App.instance.QOb)}static get mhh(){return z.a.Eab("Box4PasteScratchPad")}}
Object(K.a)(Ma,"ClipboardActor",null,[])},724:function(K,S,d){K=d(0);var h=d(18),e=d(7),r=d(405),m=d(406);class n{constructor(F,L,M,Q=0,C=0,O=null,U=null){this.commandId=F;this.controlId=L;this.timeStamp=M;this.commandSurface=r.a[Q];this.Uu=m.a[C];this.contentType=O;this.lxd=U}}Object(K.a)(n,"CommandActionInfo",null,[]);class z{constructor(){this.iWh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))");this.dZh=RegExp("(CoauthorsRendered|DoNothing|MenuClose|MenuOpen|ZeroTermContextMenuClose|SmartLookupContextMenu|TabSwitch|((TellMe).+))")}isNullOrUndefined(F){return null===
F||"undefined"===typeof F}W9j(F){return!this.iWh.exec(F)}X9j(F){return this.isNullOrUndefined(F)||!F.trim().length?!1:!this.dZh.exec(F)}}Object(K.a)(z,"EventsCacheLoggingUtils",null,[]);class t{constructor(F,L,M,Q){this.CmdId=this.ParentTcid=this.Tcid=null;this.Time=0;this.Tcid=F;this.ParentTcid=L;this.CmdId=M;this.Time=Q}}Object(K.a)(t,"MRUControl",null,[]);var x=d(27),B=d(1156),D=d(775),w=d(203);d.d(S,"a",function(){return J});class J{constructor(){this.SWb=null;this.Yof=this.UKd=20;this.zEc=this.qca=
this.ABc=this.V3a=this.zTb=null;this.Zuf=this.SId=!1}init(){this.SWb=new z;this.zTb=new h.a;this.V3a=new h.a;this.ABc=new h.a;this.UKd=x.AFrameworkApplication.fa.uc("MaxCommandClickedEventQueueSize",20);B.a.fji(Object(e.a)(this,this.lGi,"commandClickEventRaised"));D.a.instance.MAf(Object(e.a)(this,this.P4k,"recordActionEvent"));this.SId=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserMRUActionsCookieEnabled",!1);this.Zuf=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPreferParentControls",
!0);this.SId&&(this.qca=new h.a,this.zEc="UserRecentActions_"+this.YUc(),this.cdk())}YUc(){switch(x.AFrameworkApplication.Aa.mb.Ti){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}cdk(){var F=w.a.get(this.zEc);if(!this.SWb.isNullOrUndefined(F)&&0<F.length){let L=null;try{L=JSON.parse(decodeURIComponent(F))}catch(M){w.a.remove(this.zEc);return}F=0;for(const M of L)this.qca.insert(F++,M)}}qei(F){const L=this.Zuf&&
!this.SWb.isNullOrUndefined(F.ZJb)&&0<F.ZJb.length;if(0<this.qca.count){for(var M=0;M<this.qca.count&&3>M;M++){var Q=this.qca.ga(M);if(L&&Q.ParentTcid===F.ZJb||Q.Tcid===F.controlId)return}for(M=3;M<this.qca.count;M++)if(Q=this.qca.ga(M),L&&Q.ParentTcid===F.ZJb||Q.Tcid===F.controlId){this.qca.remove(Q);break}}this.qca.insert(0,new t(F.controlId,F.ZJb,F.commandId,F.time));this.qca.count>this.Yof&&this.qca.removeAt(this.Yof);F=JSON.stringify(this.qca.toArray());w.a.qK(this.zEc,F,w.a.aK)}m9e(F){F.count>
this.UKd&&F.removeAt(this.UKd)}lGi(F,L){this.zTb.insert(0,new n(L.commandId,L.controlId,L.time,L.commandSurface,L.Uu,L.contentType,L.ZJb));this.m9e(this.zTb);this.SId&&this.SWb.X9j(L.controlId)&&this.qei(L)}P4k(F,L){this.V3a.insert(0,new n(L.actionName,L.controlId,L.timeStamp,L.commandSurface,L.Uu,L.contentType,L.lxd));this.m9e(this.V3a);this.SWb.W9j(L.actionName)&&(this.ABc.insert(0,new n(L.actionName,L.controlId,L.timeStamp,L.commandSurface,L.Uu,L.contentType,L.lxd)),this.m9e(this.ABc))}static get instance(){return J.La||
(J.La=new J)}}J.La=null;Object(K.a)(J,"CommandClickEventsCache",null,[])},729:function(K,S,d){d.r(S);K=d(0);var h=d(735),e=d(27),r=d(47),m=d(56),n=d(103),z=d(1254),t=d(1255),x=d(19),B=d(339);const D=(T,ca)=>{if(T){T=T.trim().toLowerCase();if("true"===T)return!0;if("false"===T)return!1}return ca};var w=d(747),J=d(28),F=d(972),L;(function(T){T[T.none=0]="none";T[T.internal=1]="internal";T[T.clipService=2]="clipService"})(L||(L={}));Object(K.b)("ClipboardIframeContent",L);var M=d(394),Q=d(690),C=d(450),
O=d(49);d.d(S,"ClipboardHelper",function(){return U});class U{constructor(T,ca,N,da,Y,fa){this.kjk=[B.a.MW,B.a.Kp,B.a.location,B.a.OD,B.a.type,B.a.dMe,B.a.count,B.a.WFa,B.a.UFa,B.a.Olb,B.a.slideId,B.a.sessionId,B.a.timeStamp,B.a.Py];this.lGe=new h.a;this.GFe=new z.a(t.a.Gk());this.Qq=T;this.tCg=ca;this.Dc=fa;if(N&&0<N.length){T=N.split(";");for(const aa of T)T=this.Eag(aa),0<T.length&&this.lGe.add(T)}this.ljk=da;this.kDe=Y;if(this.m3c()){da=e.AFrameworkApplication.fa.Ha("PicklingAPIMaxPackageSizeInMB").split(";");
for(const aa of da)da=aa.split(":"),2===da.length&&0<da[0].length&&0<da[1].length&&this.GFe.add(da[0],parseInt(da[1]))}}SAd(T,ca,N,da,Y,fa,aa){if(T.contentWindow&&T.contentWindow.document&&T.contentWindow.document.body){O.a.n2b(T);const H=O.a.mda();var ka=document.createTextNode(O.a.CLe);H.appendChild(ka);ka=null;let ra=0;if(!ca)J.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",aa),Sys.UI.DomElement.addCssClass(H,
O.a.j6d);else if(ca.length&&ca[0]&&ca[0].G8a&&(Sys.UI.DomElement.addCssClass(H,this.Qq.jr[0].G8a),ra=1,N)){r.a.Xa(N.OD)&&J.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",N.Kp);ra=2;ca=w.a(N.dataType);H.setAttribute(B.a.MW,N.MW);H.setAttribute(B.a.$Ra,N.$Ra);H.setAttribute(B.a.Kp,N.Kp);H.setAttribute(B.a.version,N.version);H.setAttribute(B.a.location,N.location);H.setAttribute(B.a.OD,N.OD);H.setAttribute(B.a.type,ca);H.setAttribute(B.a.count,
N.objectCount.toString());H.setAttribute(B.a.WFa,N.WFa);H.setAttribute(B.a.UFa,N.UFa);H.setAttribute(B.a.Py,N.Py);const ha=(new Date).toUTCString();J.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",ca,N.WFa,ha);H.setAttribute(B.a.timeStamp,ha);if(1===N.dataType||2===N.dataType)ca=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+r.a.Ne(N.Kp)+"&DC="+r.a.Ne(N.OD)+"&pkey="+r.a.Ne(N.Py)+
"&wdwaccluster="+r.a.Ne(N.OD)+"&DataType="+ca,H.setAttribute(B.a.OEi,ca);N.Qmc&&H.setAttribute(B.a.dMe,this.Xml(N.Qmc));1===N.dataType&&this.kDe&&(ka=O.a.xB(),ka.id=B.a.clg,ka.setAttribute(B.a.cPj,"true"),N=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ha("361"))+"?Id="+r.a.Ne(N.Kp)+"&DC="+r.a.Ne(N.OD)+"&pkey="+r.a.Ne(N.Py)+"&wdwaccluster="+r.a.Ne(N.OD),ka.src=N)}H.setAttribute(B.a.sessionId,da);H.setAttribute(B.a.Olb,Y?Y.join(","):"");fa?H.setAttribute(B.a.slideId,fa.cid.toString()+
"+"+fa.sid.toString()):H.setAttribute(B.a.slideId,"");T.contentWindow.document.body.appendChild(H);ka&&T.contentWindow.document.body.appendChild(ka);this.Dc.li(M.a.LLi,L[ra],aa)}}q4j(T){var ca="";m.a.ik?ca="Chromium":m.a.mg?ca="Firefox":m.a.Dcc&&(ca="Safari");ca=this.GFe.Gb(ca)?this.GFe.ga(ca):0;(ca=Math.ceil(T)<=ca)||J.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",m.a.mz,T);return ca}WZj(T){return T&&Sys.UI.DomElement.containsCssClass(T,O.a.j6d)?!0:!1}ZZj(T){return!!T&&
!!T.getAttribute&&D(T.getAttribute(B.a.UFa),!1)}J9j(T){return!!T&&!!T.kn&&!!T.kn.firstChild&&!!T.kn.firstChild.className&&this.K9j(T.kn.firstChild.className)}K9j(T){return!!T&&T.startsWith("CID")&&n.a.isValid(T.substring(3,T.length))}A9j(T){return!!T&&!!T.Kp&&!!T.OD&&0!==T.dataType&&0<T.objectCount&&!!T.Py}Kxl(T){if(!this.dWj(T))return J.a.J(512329174,307,50,"DC '{0}' is not allowed",T.OD),!1;if(T.sta&&"TimeStamp"in T.sta){var ca=new Date(Date.parse(T.sta.TimeStamp));T=60*this.ljk-5;ca=U.jJf(ca);
if(ca>=T)return J.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",T,ca),!1}return!0}Eag(T){return T?T.trim().toUpperCase():""}dWj(T){return!this.uoe(T)||this.lGe.contains(this.Eag(T.OD))||this.lGe.contains("ALL")}yog(T){return!!T&&!!T.kX&&!!T.kX.length&&!!T.kX[0]}zog(T){return this.yog(T)&&Object(x.a)(C.a,T.kX[0])}YWj(T){return this.yog(T)&&Object(x.a)(Q.a,T.kX[0])}Tne(T){return!!T&&!!T.Pu&&this.Kxl(T.Pu)}XWj(T){return this.Tne(T)&&1===T.Pu.dataType}WWj(T){return this.Tne(T)&&
2===T.Pu.dataType}VWj(T){return this.Tne(T)&&3===T.Pu.dataType}ZWj(T){return!!T&&!!T.$M}$Wj(T){return this.ZWj(T)&&1===T.$M.contentType}m3c(){return!(m.a.Fx||m.a.Dcc)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}WEi(T,ca){if(T&&ca&&T.getAttribute)for(const N of this.kjk){const da=T.getAttribute(N);da&&ca.setAttribute(N,da)}}uoe(T){if(T.OD!==this.tCg)return J.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",w.a(T.dataType),
T.OD,this.tCg,T.Kp)),!0;J.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",w.a(T.dataType),T.OD,T.Kp));return!1}K4i(T,ca){var N=T.getAttribute(B.a.Kp),da=parseInt(T.getAttribute(B.a.version)),Y=T.getAttribute(B.a.Py),fa=parseInt(T.getAttribute(B.a.MW)),aa=parseInt(T.getAttribute(B.a.$Ra)),ka=T.getAttribute(B.a.type);ka=ka?w.b(ka):2;var H=Object,ra=H.assign,ha=new F.a;fa=isNaN(fa)?32:fa;aa=isNaN(aa)?0:aa;da=isNaN(da)?0:da;var Ma=T.getAttribute(B.a.location),Ga=
T.getAttribute(B.a.OD),na=T.getAttribute(B.a.count);na=parseInt(na);N=ra.call(H,ha,{MW:fa,$Ra:aa,Kp:N,version:da,location:Ma,OD:Ga,dataType:ka,objectCount:isNaN(na)?-1:na,WFa:D(T.getAttribute(B.a.WFa),!1),UFa:D(T.getAttribute(B.a.UFa),!1),Py:Y});Y=U.S4i(T);ka=U.W4i(T);N.sta={["SessionId"]:Y,["TimeStamp"]:ka?ka.toUTCString():""};ca=U.YXd(N,ka,this.Dc,ca);J.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",ca);if(T=T.getAttribute(B.a.dMe))N.Qmc=this.hWi(T);return N}Xml(T){return JSON.stringify(T)}hWi(T){try{return JSON.parse(T)}catch(ca){return J.a.J(512329169,
826,15,"{0} when parse json string: {1}",ca.toString(),T),null}}static Tog(T){return T&&T.sta&&"SessionId"in T.sta?U.Htg(T.sta.SessionId.toString()):!1}static Htg(T){return r.a.Xa(T)||r.a.Xa(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===T.toLowerCase()}static YXd(T,ca,N,da){const Y=w.a(T.dataType);T=String.format("A {0} ClipServiceObject was just created: '{1}'",Y,T);ca&&(ca=U.jJf(ca),T+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",
ca),N.li("CopyPasteElapsedSec",ca.toString(),da));return T}static S4i(T){T=T.getAttribute(B.a.sessionId);return void 0===T||null===T?"":T}static W4i(T){T=T.getAttribute(B.a.timeStamp);return void 0===T||null===T?null:new Date(Date.parse(T))}static jJf(T){var ca=new Date;if(!T)throw Error.argumentNull("fromTime");if(!ca)throw Error.argumentNull("toTime");return(ca.getTime()-T.getTime())/1E3}}Object(K.a)(U,"ClipboardHelper",null,[456])},740:function(K,S,d){K=d(0);class h{}Object(K.a)(h,"AuthContext",
null,[]);var e=d(27),r=d(218);d.d(S,"a",function(){return m});class m{static getAuthContext(){const n=e.AFrameworkApplication.fa.Ha("UserPrincipalName")||"";let z=n;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(z=r.OAuthManagerSettings.QDk||n);return Object.assign(new h,{upn:n,loginHint:z,authority:r.OAuthManagerSettings.authority,authorityType:m.cVc(),tenantId:e.AFrameworkApplication.fa.Ha("TenantId")||""})}static cVc(){let n=0;const z=
m.d6f();"aad"===z.toLowerCase()?n=2:"msa"===z.toLowerCase()&&(n=1);return n}static d6f(){return e.AFrameworkApplication.fa.Ha("HostAuthType")||""}}Object(K.a)(m,"OAuthIdentity",null,[])},744:function(K,S,d){K=d(0);var h=d(7),e=d(27),r=d(77),m=d(56),n=d(47),z=d(103);class t{constructor(F,L){this.message=F;this.Fj=L}}Object(K.a)(t,"CrossDocumentEventArgs",null,[]);var x=d(539),B=d(178),D=d(581),w=d(940);d.d(S,"a",function(){return J});class J{constructor(F,L,M,Q){this._name="";this.FNa={};this.lpf=
null;this.jYb=[];this.ZUb=[];this.$Ub=[];this.wXb=[];this.dwf=F;this.cwf=L;this.P7={};this.cca={};this.fXb=M;J._id++;Q&&Q();this.OG=this.enable()}get GMa(){return this.cwf}get eKh(){return this.dwf}enable(){if(!D.a())return w.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.EUj();w.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.OG}EUj(){w.a.debugAssertTag(5018253,!!this.fXb,null);this.lpf=Object(h.a)(this,this.jAk,"messageListener");this.fXb.Sqi(this.lpf)}disable(){this.OG=
!1;this.jYb=[];this.ZUb=[];this.$Ub=[];this.wXb=[];this.dwf=null;this.cwf="";this.fXb.EWi();this.P7={};this.cca={}}dispose(){this.disable()}Upe(F){return!!this.jYb&&Array.contains(this.jYb,F)||this.Rrg(F)}Rrg(F){return!!this.ZUb&&Array.contains(this.ZUb,F)}Nu(F){w.a.debugAssertTag(5018259,!!this.jYb,null);Array.add(this.jYb,F);w.a.sendTraceTag(5018260,2,"Allow receiving : {0}",F)}Fyf(F){w.a.debugAssertTag(5018261,!!this.ZUb,null);Array.add(this.ZUb,F);w.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",
F)}x2j(F){return!!this.$Ub&&Array.contains(this.$Ub,F)}Gyf(F){w.a.debugAssertTag(5018263,!!this.$Ub,null);Array.add(this.$Ub,F);w.a.sendTraceTag(5018264,2,"Allow free sending: {0}",F)}bcc(F){F=r.a.KQ(F);return!!F&&!!this.wXb&&Array.contains(this.wXb,F)}qCa(F){w.a.debugAssertTag(5018265,!!this.wXb,null);if(F===J.l0b)return w.a.debugAssertTag(5018266,!1,null),!1;let L=r.a.KQ(F);if(!L)return w.a.sendTraceTag(5018267,4,"Get origin fail:{0}",F),!1;e.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&
(L=n.a.ug(L));Array.add(this.wXb,L);w.a.sendTraceTag(5018268,2,"Add origin:{0}",L);return!0}send(F,L=null){let M=this.GMa;if(L){L=r.a.KQ(L);if(!L)return!1;M=L}return this.flb(F,this.eKh,M)}sendMessage(F,L,M=""){M=M&&""!==M?M:z.a.create().toString();return this.send(this.yPe(F,L,M,e.AFrameworkApplication.userSessionId))}postMessage(F){const L=z.a.create().toString();if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!F.shouldRetry)return this.send(this.yPe(F.messageId,F.values,L,
F.userSessionId));if(!this.P7[F.QIc]){this.Nu(F.QIc);const M=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.fC(F.QIc,M)}this.FNa[L]="";return this.Vih(F,L,1)}Vih(F,L,M){if(""!==L&&L in this.FNa&&"ACK_RECEIVED"===this.FNa[L])return delete this.FNa[L],!0;if(M>F.uxa)return w.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',F.QIc,L),delete this.FNa[L],!1;w.a.sendTraceTag(40716251,1<M?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',
F.uxa-M,F.messageId,L);M++;window.setTimeout(()=>{this.Vih(F,L,M)},F.Wci);F.values[B.a.Vci]=!0;return this.send(this.yPe(F.messageId,F.values,L,F.userSessionId))}ackMessageHandler(F){F=F.CorrelationId;""!==F&&F in this.FNa&&(w.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.FNa[F],F),this.FNa[F]="ACK_RECEIVED")}yPe(F,L,M,Q){F=new x.a(F);F.CorrelationId=M;L&&(F.Values=L);F.Values.wdUserSession=Q;return F}flb(F,L,M){w.a.debugAssertTag(5018269,!!F,null);if(!this.OG)return!1;
w.a.debugAssertTag(5018270,!!L,null);w.a.debugAssertTag(5018271,!!M,null);if(!L||!M)return w.a.debugAssertTag(5018272,!1,null),!1;if(M===J.l0b&&!this.x2j(F.MessageId))return w.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:F.MessageId}),!1;F.SendTime=(new Date).getTime();let Q="";try{Q=Sys.Serialization.JavaScriptSerializer.serialize(F)}catch(C){return w.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:C.message}),!1}L=J.sendMessage(L,Q,M);w.a.sendTraceTag(5018275,2,
"Send {0}. {1}",L?"succeeded":"failed",{["id"]:F.MessageId,["origin"]:M});return L}fC(F,L){w.a.debugAssertTag(5018304,!!L,null);w.a.debugAssertTag(5018305,!!this.P7&&!!this.cca,null);this.OG&&(this.Upe(F)?this.P7[F]!==L&&(w.a.debugAssertTag(5018307,!this.P7[F]&&!this.cca[F],null),this.P7[F]=L,delete this.cca[F]):w.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:F}))}A0a(F,L){w.a.debugAssertTag(40420062,!!L,null);w.a.debugAssertTag(40420063,!!this.cca&&!!this.P7,null);this.OG&&(this.Upe(F)?
this.cca[F]!==L&&(w.a.debugAssertTag(40420065,!this.P7[F]&&!this.cca[F],null),this.cca[F]=L,delete this.P7[F]):w.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:F}))}OQl(F){this.OG&&(this.P7[F]&&delete this.P7[F],this.cca[F]&&delete this.cca[F])}jAk(F){const L=this.Doj(F);if(!L)return!1;if(this.P7[L.MessageId])return this.fXb.T0c(this.P7[L.MessageId],L),!0;if(this.cca[L.MessageId]){let M=this.cca[L.MessageId];F=new t(L,F);this.fXb.nVj(M,F);return!0}return!1}Doj(F){const L=new Date;this.zgk(F);
if(!F.origin||!F.source||void 0===F.data||null===F.data)return w.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const M=this.L$j(F.data);if(!M)return null;if(!this.bcc(F.origin)){if(!this.Rrg(M.MessageId))return w.a.sendTraceTag(5018309,1,"{0}",{["id"]:M.MessageId}),null;if(!m.a.Dcb&&F.source!==this.eKh)return w.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}w.a.debugAssertTag(5018311,!!M.Values,null);M.Values.m_Source=F.source;
M.Values.m_Origin=F.origin;M.Values.m_ReceivedTime=L.getTime();return M}L$j(F){if(!F)return null;let L=null;try{L=Sys.Serialization.JavaScriptSerializer.deserialize(F,!0)}catch(C){return 2>J.dgf&&(w.a.sendTraceTag(5018312,2,"Deser failed"),J.dgf++),null}if(!L)return w.a.debugAssertTag(5018313,!1,null),null;for(F=0;F<J.HPc.length;F++)if(!L[J.HPc[F]])return"MessageId"!==J.HPc[F]&&w.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",J.HPc[F]),null;if(L.Values)try{L.Values}catch(C){return w.a.sendTraceTag(5018314,
4,"Not a valid dictionary: {0}",C.message),null}else w.a.sendTraceTag(41502556,2,"No values in message");F=L.MessageId;if(!this.Upe(F))return w.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:F}),null;const M=L.SendTime,Q=(new Date).getTime()-M;if(0>M)return w.a.sendTraceTag(520435660,2,"{0}",{["t"]:M,["id"]:F}),null;6E4<Q&&w.a.sendTraceTag(520435659,2,"{0}",{["t"]:M,["delta"]:Q,["id"]:F});-300>Q&&w.a.sendTraceTag(520435658,2,"{0}",{["t"]:M,["delta"]:Q,["id"]:F});F=new x.a;F.MessageId=L.MessageId;
F.SendTime=L.SendTime;F.CorrelationId=L.CorrelationId;L.Values&&(F.Values=L.Values);w.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",F.MessageId,F.SendTime,F.CorrelationId);return F}zgk(F){w.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:F.origin,["data"]:F.data,["source"]:F.source}))}static sendMessage(F,L,M){if(!D.a())return w.a.debugAssertTag(5018319,!1,null),!1;try{return F.postMessage(L,M),!0}catch(Q){w.a.sendTraceTag(5018320,
4,"{0}",{["exception"]:Q.message})}return!1}}J.HPc=["MessageId","SendTime"];J.l0b="*";J._id=0;J.dgf=0;Object(K.a)(J,"CrossDocumentMessenger",null,[108,537])},745:function(K,S,d){d.r(S);var h=d(134);K=d(0);var e=d(470),r=d(78),m=d(146),n=d(94),z=d(67),t=d(318),x=d(27),B=d(47),D=d(56),w=d(55),J=d(97),F=d(28),L=d(33),M=d(86),Q=d(966),C=d(958),O=d(956),U=d(959),T=d(960),ca=d(963),N=d(964),da=d(961),Y=d(957),fa=d(965),aa=d(962);class ka{createAuthProviderAsync(Ma){w.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Fja();
return new Promise(Ga=>{w.a.instance.Ia("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(na=>{na=na.TMi(Ma);Ga(na)})})}}Object(K.a)(ka,"SlideShowAppForOfficeAuthFactory",null,[]);var H=d(1037),ra=d(70);d.d(S,"SlideShowCoreFrame",function(){return ha});class ha{constructor(Ma,Ga,na,wa,Fa,pa,Ea,ta,ia,Ja,ab,Oa,Za,Na){this.xk=this.Kjc=this.Kcd=null;this.wfa=new e.a;this.va=new r.a;this.pJe="";this.Jw=null;this.wgd="";this.KHe=this.HIg=this.Ekc=this.IO=this.gaa=this.faa=this.$va=this.K=null;this.Gkc=
!0;this.AYa=Date.now();this.yYa=Date.now();this.Qeb=this.z1g=0;this.dFb=!1;this.$Gk=()=>{F.a.J(512309270,830,50,"SlideShowCoreFrame::OnEditHappened");this.yYa=Date.now()};this.SIk=()=>{F.a.J(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.yYa=Date.now()};this.NKk=()=>{F.a.J(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.yYa=Date.now()};this.K6k=sa=>{Object(h.a)(this,void 0,void 0,function*(){if(this.Iec){var Sa=(new Date).getTime();try{const xb=yield this.Iec.mI("Hubble",
sa);xb.IsSuccess?this.xk.setAadToken(xb.Token):this.xk.setAadToken("");F.a.J(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${xb.IsSuccess} time: ${(new Date).getTime()-Sa}`)}catch(xb){F.a.J(508949123,830,10,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-Sa} error: ${xb}`),this.xk.setAadToken("")}}else F.a.J(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),
this.xk.setAadToken("")})};this.tf=Ma;this.la=Ga;this.Jc=na;this.$Db=wa;this.Xl=Fa;this.Vb=pa;this.EO=ta;this.tu=Ea;this.bJe=ia;this.le=Ja;this.C8c=ab;this.ih=Oa;this.$O=Za;this.Qr=Na;this.Bvk=m.a.getInstance();this.C8c&&this.C8c.execute(sa=>{sa.X_b(this.$Gk)});this.ih&&(this.ih.nUd(this.SIk),this.ih.IUd(this.NKk));try{const sa=this.O5=JSON.parse(this.la.Ha("Settings"))||{};sa.slideshowcore||(sa.slideshowcore={});sa.slideshowcore&&sa.slideshowcore.forceSvg&&"true"===sa.slideshowcore.forceSvg.toString().toLowerCase()?
this.bJe=!0:this.bJe&&(sa.slideshowcore.forceSvg="True");sa.slideshowcore.enableCameoInPPTOSlideShow=this.la.N_.toString()}catch(sa){F.a.J(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",sa),this.O5={}}}preloadShaders(){this.e2e();this.qud();SlideShowCore.SlideShowCore.preloadShaders()}init(Ma,Ga,na,wa){return Object(h.a)(this,void 0,void 0,function*(){this.pJe=na;this.$O=wa;this.wgd=Ga;if(this.Jw)F.a.J(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.Zgc);
else{this.$va=document.getElementById("HiddenFocusTrapAnchor");this.Jw=document.createElement("div");this.Jw.id="SlideShowBackground";this.Jw.className="SlideShowBackground";this.Jw.style.visibility=ra.a.ft;this.Jw.tabIndex=-1;this.K=document.createElement("div");this.K.id="SlideShowContainer";this.K.className="SlideShowContainer";this.K.tabIndex=-1;this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";n.a.addHandler(this.Jw,z.a.vxa,Ea=>{this.zJk(Ea)});t.a.instance.ub(this.Jw,
Ea=>this.pib(Ea));this.Jw.appendChild(this.K);L.a("PresenterCoachTabFix")&&this.$va?this.tf.insertBefore(this.Jw,this.$va):this.tf.appendChild(this.Jw);var Fa=this.la.Ha("pptSlideShowCoreCssUrl"),pa=document.createElement("link");pa.setAttribute("rel","stylesheet");pa.setAttribute("type","text/css");pa.setAttribute("href",Fa);this.K.appendChild(pa);H.a.instance.init(this.la,this.Jw,this.Jc,this,this.Xl,this.Vb,this.EO);this.faa=document.getElementById("slideshowBeginningFocusTrap");this.gaa=document.getElementById("slideshowEndFocusTrap");
this.faa||this.gaa||(this.faa=document.createElement("div"),this.faa.id="slideshowBeginningFocusTrap",this.faa.className="FocusTrap",this.faa.tabIndex=0,n.a.addHandler(this.faa,z.a.focus,Ea=>{this.Qnc(Ea)}),this.gaa=document.createElement("div"),this.gaa.id="slideshowEndFocusTrap",this.gaa.className="FocusTrap",this.gaa.tabIndex=0,n.a.addHandler(this.gaa,z.a.focus,Ea=>{this.Qnc(Ea)}),L.a("PresenterCoachTabFix")&&this.$va?(this.tf.insertBefore(this.faa,this.tf.firstChild),this.tf.insertBefore(this.gaa,
this.$va.nextSibling)):(Fa=document.getElementById("slideshow-toolbar"),this.tf.insertBefore(this.faa,this.Jw),this.tf.insertBefore(this.gaa,Fa)));this.Zgc=this.sdg(1)}yield this.Zgc})}sdg(Ma){return Object(h.a)(this,void 0,void 0,function*(){const Ga=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.$O),na={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};na["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;
const wa=new Date;return new Promise((Fa,pa)=>{this.Qr.qj(Ga,1,"",na,!1,0,Ea=>Object(h.a)(this,void 0,void 0,function*(){yield this.JNe(Ea,wa);F.a.J(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");Fa()}),Ea=>Object(h.a)(this,void 0,void 0,function*(){yield this.INe(Ea,Ma);F.a.J(509636750,830,10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");pa()}),null,null)})})}JNe(Ma,Ga){return Object(h.a)(this,void 0,void 0,function*(){F.a.J(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",
+new Date-+Ga);const na=JSON.parse(Ma.data.Wd);this.IO=na.downloadUrl;B.a.Xa(this.IO)?F.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",na):(this.AYa=Date.now(),yield this.RQj())})}Sbg(){const Ma={};Ma.settings=this.O5;Ma.retryCount=this.la.uc("GetItemsRetryCount",3);Ma.retryOnCategories=this.la.Ha("GetItemsRetryCategories").split(";");const Ga={};Ga.Slide=ResourceStrings.l_Slide;Ga.AnimNum=ResourceStrings.l_AccSsAnimNum;Ga.SldNameWithTooltip=
ResourceStrings.l_AccSsSldNameWithTooltip;Ga.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Ga.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Ga.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;Ma.localizedStrings=Ga;return Ma}RQj(){return Object(h.a)(this,void 0,void 0,function*(){this.e2e();this.qud();this.Kcd=new PodsProxy.PodsProxy(this.la.oab?this.la.NWc:this.la.podsWebServiceBase,{DownloadUrl:this.IO,DocID:x.AFrameworkApplication.Pg,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},
this.la.uKa?B.a.IQ(this.la.uKa).toLowerCase():"",this.wfa,this.rbg(),this.sbg());this.Kjc=new SlideShowCore.DefaultResourceProviders(this.Kcd,this.wfa,this.Sbg());const Ma={};Ma.initTime=ha.u8b();Ma.uiHost="Unified App";Ma.serverUrl=B.a.Ne(this.la.podsWebServiceBase);Ma.userSessionId=this.pJe;Ma.jsScriptsBasePath=this.la.Ha("StaticContentHost")+"pptscripts/ssapp/";Ma.fileHost=this.la.Ha("FileHost");Ma.isRtl=x.AFrameworkApplication.isRtl;Ma.applicationLcid=x.AFrameworkApplication.lcid;Ma.applicationLocaleName=
x.AFrameworkApplication.uiCulture;Ma.areThirdPartyAddInsAllowed=x.AFrameworkApplication.Tca;Ma.theWsaClient=x.AFrameworkApplication.Ci;Ma.appForOfficeContextActivationParameters=Q.a.Idg(this.le);Ma.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;Ma.acceptLanguage=x.AFrameworkApplication.uiCulture;Ma.appForOfficeAuthFactory=new ka;const Ga={};Ga.settings=this.O5;Ga.transitionResourceCDNPath=this.la.dTf;Ga.transitionDisabledList=this.la.ZMa;Ga.clickTargetEnabled=!0;Ga.mediaEnabled=!0;Ga.gifEnabled=
!0;Ga.convertGifToVideo=!0;Ga.crossSlideAudioEnabled=!0;Ga.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");Ga.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");Ga.useNewYoutubePlayer=!0;Ga.useNewVimeoPlayer=!0;Ga.useOnlineVideoPlayer=!0;Ga.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");Ga.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");Ga.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Ga.enableSVGAsWebGLTexture=!D.a.mg&&this.la.ka("SlideShowShapeBuilderSVGEnabled");
Ga.maxSvgTextureSize=this.la.uc("ShapeBuilderMaxSvgTextureSize",2048);Ga.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");Ga.slideSizeMax={["x"]:this.la.uc("SlideShowMaxWidth",1504),["y"]:this.la.uc("SlideShowMaxHeight",849)};Ga.slideSizeMin={["x"]:this.la.uc("SlideShowMinWidth",348),["y"]:this.la.uc("SlideShowMinHeight",261)};Ga.slideSizeDefault={["x"]:this.la.uc("SlideShowDefaultWidth",1504),["y"]:this.la.uc("SlideShowDefaultHeight",849)};Ga.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");
Ga.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");Ga.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");Ga.combineBootRequest=!0;Ga.localVideoTelemetryEnabled=this.la.ka("IsGFXVideoLocalTelemetryEnabled");Ga.imageSettings={["imageAppendOption"]:"all"};const na={["slideShowCoreSettings"]:Ga,["appSettings"]:Ma};this.xk=new SlideShowCore.SlideShowCore(this.K,this.Kjc,this.wfa,na);new SlideShowCore.PrefetchAddon(this.xk,this.wfa,{["forwardPrefechCount"]:this.la.uc("PptModernSlideShowForwardPrefetchCount",
10),["backwardPrefechCount"]:this.la.uc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.uc("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.la.uc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.xk,this.wfa);this.z1g=Date.now();this.KHe=this.xk.init();this.xk.events.on("slideLocationChanged",()=>{this.Ekd()});this.xk.events.on("animationStateChanged",()=>{this.Ekd()});this.xk.events.on("slideDimensionsChanged",
()=>{this.getCurrentSlideDimensions()});this.xk.events.on("exitFromEndOfShow",()=>{this.vNe(!0)});this.xk.events.on("blankSlideStateChanged",wa=>{this.oFk(wa)});this.xk.events.on("slideshowError",wa=>{this.Djd(wa)});this.la.ka("IsStream2VideoEnabled")&&(this.Iec=w.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.xk.events.on("aadTokenRequest",wa=>{this.K6k(wa)}));return new Promise(wa=>Object(h.a)(this,void 0,void 0,function*(){yield this.KHe;this.Gkc=!1;this.HIg=new SlideShowCore.InputsAddon(this.xk,
this.K,x.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.xk,na,this.wfa);new SlideShowCore.TransitionLoggerAddon(this.xk,na,this.wfa);new SlideShowCore.PerfCheckerAddon(this.xk,na,this.wfa);this.Ekc=new SlideShowCore.SlideShowInkAddon(this.xk,this.wfa,this.K,()=>this.$Db.loadScript("slideshowink"),{["telemetryLogger"]:this.Bvk});this.la.N_&&(this.qHb=new SlideShowCore.CameoWebcamAddon(this.xk));this.HIg.events.on("keydown",Fa=>{this.XJa(Fa)});F.a.J(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");
wa()}))})}sbg(){const Ma={};Ma.timeout=this.la.uc("PptModernSlideShowGetItemsTimeoutMs",3E4);Ma.throwHttpErrors=!1;Ma.enableServerSpecificErrorCode=L.a("SSCore.EnableServerSpecificErrorCode");return Ma}qud(){try{const Ma=this.O5;if(Ma.slideshowcore){const Ga={};Ga.settings=Ma;Ga.logger=this.wfa;Ga.disabledChangeGates=this.la.Ha("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Ga)}}catch(Ma){F.a.J(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",
Ma)}}e2e(){try{const Ma=this.O5;if(Ma.podsproxy){const Ga={};Ga.settings=Ma;window.PodsProxy.setupGlobals_PodsProxy(Ga)}}catch(Ma){F.a.J(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",Ma)}}vRh(Ma,Ga){return Object(h.a)(this,void 0,void 0,function*(){this.e2e();this.qud();if(this.xk){this.Kcd=new PodsProxy.PodsProxy(this.la.oab?this.la.NWc:this.la.podsWebServiceBase,{DownloadUrl:this.IO,DocID:x.AFrameworkApplication.Pg,CustomFontCatalogUrl:this.la.Ha("CustomFontCatalogURL")},
this.la.uKa?B.a.IQ(this.la.uKa).toLowerCase():"",this.wfa,this.rbg(),this.sbg());var na=this.Kjc;this.Kjc=new SlideShowCore.DefaultResourceProviders(this.Kcd,this.wfa,this.Sbg());yield this.xk.updateResourceProviders(this.Kjc,{shouldRerenderSlide:!0});na&&na.dispose();F.a.J(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",Ma,Ga,Date.now(),this.qWa())}else F.a.J(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}INe(Ma,
Ga){return Object(h.a)(this,void 0,void 0,function*(){const na=Ma.data?Ma.data.Oe:-1;0<Ga--?(F.a.J(512309281,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",na),yield this.sdg(Ga)):F.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",na)})}cwd(Ma,Ga,na,wa,Fa,pa,Ea,ta,ia){Object(h.a)(this,void 0,void 0,function*(){this.Zgc&&(F.a.J(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",
this.Zgc),yield this.Zgc,this.qWa()||this.show());if(B.a.Xa(this.IO)){if(F.a.J(508924042,830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.IO),this.qWa()){var Ja=M.a.Ph(410);x.AFrameworkApplication.No(Ja);J.Health.instance.recordQosError(M.a.kda(Ja),["SlideShowACE"],!1,!0,!0,!0,null);this.xk&&this.xk.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"});this.exit()}}else if(this.xk){Ja={};this.yYa>this.AYa||this.Gkc?(this.O5.slideshowcore.vetoBootDurationMs=
this.la.uc("PptModernSlideShowEditVetoBootDurationMs",8E3),Ja.BootScenario=this.yYa>this.AYa?"AfterEdit":"Init",F.a.J(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.uc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.yYa,this.AYa,this.Gkc)):(this.O5.slideshowcore.vetoBootDurationMs=this.la.uc("PptModernSlideShowCachedVetoBootDurationMs",2E3),Ja.BootScenario="Relaunch",F.a.J(509703458,
830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.uc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.yYa,this.AYa,this.Gkc));this.qud();this.yYa>this.AYa&&(this.xk.showLoadingSpinner(),yield this.wRh(1));Ja.startFromTime=ia-window.performance.timing.navigationStart;Ja.SSCoreFrameStartTime=ha.u8b();H.a.instance.wal();this.K.style.top="0";this.faa&&this.gaa&&(this.faa.tabIndex=0,this.gaa.tabIndex=
0);const ab={["slideId"]:{["sid"]:Ma,["cid"]:0}};ab.slideIndex=Ga-1;this.tu.ybc&&!this.tu.H9?this.$Bi(ab,Ja):this.I2f(ab,Ja)}else F.a.J(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}prev(){return Object(h.a)(this,void 0,void 0,function*(){this.xk&&(yield this.xk.prevStep("0_anim"))})}next(){return Object(h.a)(this,void 0,void 0,function*(){this.xk&&(yield this.xk.nextStep("0_anim",3))})}show(){this.Jwc(!0)}qWa(){return this.Jw&&this.Jw.style.visibility===ra.a.Tz?!0:!1}n9(){return"Modern"}Jwc(Ma){H.a.instance.setVisibility(Ma&&
this.Jc.Rh);this.Jw&&(Ma?(this.Jw.style.visibility=ra.a.Tz,$addHandler(window,"visibilitychange",Ga=>{this.E_a(Ga)})):(this.Jw.style.visibility=ra.a.ft,$removeHandler(window,"visibilitychange",Ga=>{this.E_a(Ga)})))}exit(){this.vNe(!1)}FUc(){this.vNe(!1)}transcribe(Ma,Ga,na,wa,Fa,pa,Ea){const ta=!!this.Vb&&!!this.Vb.instance&&(this.Vb.instance.oTa||this.Vb.instance.lr);(this.Vb&&this.Vb.instance&&this.Vb.instance.Jr&&this.Vb.instance.mEa||ta)&&!this.Vb.instance.lxb()?F.a.J(512495900,830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):
(H.a.instance.transcribe(Ma,Ga,na,wa,Fa,pa,Ea),this.Jc.Rh&&this.xk.recordSessionStats({["metadata"]:"subtitles"}),this.t5d())}I2f(Ma,Ga){Object(h.a)(this,void 0,void 0,function*(){this.xk.clearNavigationState();const na={navigationType:"init"};na.startFromTime=Ga.startFromTime;Ga.waitedForInit=this.Gkc;Ga.startInitTime=this.z1g;Ga.beforeInitPromise=ha.u8b();yield this.KHe;Ga.afterInitPromise=ha.u8b();na.bootMetrics=Ga;if(0>Ma.slideIndex)yield this.xk.gotoFirstSlide(!0,na),this.K.style.height="100%",
this.K.style.width="100%",F.a.J(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {1}",JSON.stringify(Ma));else{const wa={};wa.actionContext=na;wa.fSkipTransition=!0;yield this.xk.gotoSlide(Ma,wa);this.K.style.height="100%";this.K.style.width="100%";F.a.J(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {1}",JSON.stringify(Ma))}this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}$Bi(Ma,Ga){const na=
this.la.uc("PptModernSlideShowCheckFullscreenCounter",10);let wa=na;this.Qeb=window.setInterval(()=>{wa--;F.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",wa);if(this.tu.H9||0>=wa){window.clearInterval(this.Qeb);this.Qeb=0;const Fa=20*(na-wa);Ga.checkFullscreenMs=Fa;F.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",Fa);this.I2f(Ma,Ga)}},20)}t5d(){let Ma=0,Ga=100;this.Jc.Rh&&H.a.instance.isVisible()&&("AboveSlide"===this.Jc.gw?
(Ma=15,Ga=85):"BelowSlide"===this.Jc.gw&&(Ga=85));const na=document.getElementById("LiveURLBarLayerHost");this.dFb&&na?(this.K.style.top=String.format("calc({0}% + {1})",Ma.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",Ga.toString(),"26px")):(this.K.style.top=Ma.toString()+"%",this.K.style.height=Ga.toString()+"%")}setMicrophoneState(Ma){H.a.instance.setMicrophoneState(Ma)}Iyh(Ma){Ma?this.kFl():this.RHh()}zPh(Ma){this.qHb&&Ma&&this.qHb.updateWebcamDevice(Ma)}GQb(Ma,Ga=""){this.dFb=
Ma;H.a.instance.FLh(Ma,Ga);this.t5d()}toggleTranscriberUIVisibility(Ma){H.a.instance.setVisibility(Ma);H.a.instance.pKc();this.t5d()}z8e(){this.va.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}restoreFocus(){this.Jw&&this.Jw.style.visibility!==ra.a.ft&&!this.Ioe()&&this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.xk){const Ma=this.xk.getSlideLocation();Ma?this.va.raiseEvent("OnGetCurrentPosition",new U.a({["SlideId"]:Ma.slideId.sid,["SlideIndex"]:Ma.slideIndex})):F.a.J(512495897,
830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.xk){const Ma=this.xk.getSlideLocation();if(Ma){const Ga=this.xk.getAnimationState(!0),na=Ga.timelineStates,wa=[];for(let Fa=0;Fa<na.length;Fa+=1)wa.push({["TimeLineId"]:na[Fa].timelineId,["Step"]:na[Fa].step,["LastClickTime"]:na[Fa].lastClickTime,["StartTimeOffset"]:Ga.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new U.a({["SlideId"]:Ma.slideId.sid,["SlideIndex"]:Ma.slideIndex,
["TimeLineMappings"]:wa}))}else F.a.J(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.xk&&this.Jw&&this.Jw.style.visibility!==ra.a.ft){const Ma=document.getElementById(this.bJe?"svg-canvas":"webgl-canvas");Ma&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new T.a({["SlideHeight"]:Ma.offsetHeight,["SlideWidth"]:Ma.offsetWidth,["SlideLeftBound"]:Ma.offsetLeft,["SlideBottomBound"]:Ma.offsetTop+Ma.offsetHeight}))}}HUa(Ma){Object(h.a)(this,
void 0,void 0,function*(){this.xk&&(yield this.xk.gotoSlide({["slideIndex"]:Ma},{actionContext:{navigationType:"goto"},fSkipTransition:!1}))})}Ufg(Ma,Ga){Object(h.a)(this,void 0,void 0,function*(){if(this.xk){const wa={};var na=[];let Fa=0;for(let pa=0;pa<Ga.length;pa+=1){const Ea={};Ea.timelineId=Ga[pa].TimeLineId;Ea.step=Ga[pa].Step;Ea.lastClickTime=Ga[pa].LastClickTime;Fa=Ga[pa].StartTimeOffset;na.push(Ea)}wa.timelineStates=na;wa.startTimeOffset=Fa;na={actionContext:{navigationType:"goto"}};na.animationState=
wa;na.fSkipTransition=!1;yield this.xk.gotoSlide({["slideIndex"]:Ma},na)}})}wRh(Ma){return Object(h.a)(this,void 0,void 0,function*(){F.a.J(512309260,830,15,"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.$O);const Ga=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.$O),na={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};na["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;
const wa=new Date;return new Promise((Fa,pa)=>{this.Qr.qj(Ga,1,"",na,!1,0,Ea=>Object(h.a)(this,void 0,void 0,function*(){yield this.fIk(Ea,wa);F.a.J(509636748,830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");Fa()}),Ea=>Object(h.a)(this,void 0,void 0,function*(){yield this.dIk(Ea,Ma);F.a.J(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");pa()}),null,null)})})}fIk(Ma,Ga){return Object(h.a)(this,void 0,
void 0,function*(){const na=new Date;F.a.J(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",+na-+Ga);const wa=JSON.parse(Ma.data.Wd);this.IO=wa.downloadUrl;B.a.Xa(this.IO)?F.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",wa):(this.AYa=Date.now(),yield this.vRh(Ga,na))})}dIk(Ma,Ga){return Object(h.a)(this,void 0,void 0,function*(){const na=Ma.data?Ma.data.Oe:-1;0<Ga--?(F.a.J(512309277,
830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",na),yield this.wRh(Ga)):F.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",na)})}refreshPodSession(Ma,Ga,na=1){return Object(h.a)(this,void 0,void 0,function*(){F.a.J(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.$O,Ma);this.$O=Ma;this.wgd=
Ga;const wa=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.$O),Fa={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};Fa["X-UserSessionId"]=x.AFrameworkApplication.userSessionId;const pa=new Date;return new Promise((Ea,ta)=>{this.Qr.qj(wa,1,"",Fa,!1,0,ia=>Object(h.a)(this,void 0,void 0,function*(){yield this.gIk(ia,pa);Ea()}),ia=>Object(h.a)(this,void 0,void 0,function*(){yield this.eIk(ia,na);ta()}),null,null)})})}gIk(Ma,
Ga){return Object(h.a)(this,void 0,void 0,function*(){var na=new Date;F.a.J(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+na-+Ga);const wa=JSON.parse(Ma.data.Wd);this.IO=wa.downloadUrl;B.a.Xa(this.IO)?(F.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",wa),this.qWa()&&(na=M.a.Ph(413),x.AFrameworkApplication.No(na),J.Health.instance.recordQosError(M.a.kda(na),
["SlideShowACE"],!1,!0,!0,!0,null),this.xk&&this.xk.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.AYa=Date.now(),yield this.vRh(Ga,na))})}eIk(Ma,Ga){return Object(h.a)(this,void 0,void 0,function*(){const na=Ma.data?Ma.data.Oe:-1;0<Ga--?(F.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",na),yield this.refreshPodSession(this.$O,this.wgd,
Ga)):(F.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",na),this.qWa()&&this.exit())})}setVisibility(Ma){this.Jwc(Ma)}Tga(Ma){this.Jw&&(this.Jw.style.cursor=Ma?"default":"none");H.a.instance.Tga(Ma)}setOsfLocalStorage(){}lRe(Ma){if(this.Ekc)this.Ekc.onInkManagerActivity(Ma)}XJa(Ma){this.T_e(Ma)}T_e(Ma){this.va.raiseEvent("OnSpecialKey",new Y.a({["Key"]:Ma.keyCode,["ShiftKey"]:Ma.shiftKey}))}Zxh(){}Qnc(){this.Jw&&this.restoreFocus()}rbg(){const Ma=
new Map;Ma.set("X-UserSessionId",this.pJe);Ma.set("X-WacNoAuth","1");Ma.set("X-WacCluster",this.wgd);Ma.set("Client","Unified App");this.la.Mmj&&Ma.set("UseDocCache","True");return Ma}kFl(){this.qHb&&this.qHb.startWebcam()}RHh(){this.qHb&&this.qHb.stopWebcam()}vNe(Ma=!1){this.Qeb&&(F.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.Qeb),window.clearInterval(this.Qeb),this.Qeb=0);this.Ekc&&this.Ekc.resetInkCanvas();this.faa&&this.gaa&&
(this.faa.tabIndex=-1,this.gaa.tabIndex=-1);if(this.xk){const Ga=this.xk.getSlideLocation();this.xk.endSession(ha.u8b());Ga?(this.va.raiseEvent("OnExit",new O.a({["SlideId"]:Ga.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:Ga.slideIndex,["IsFromEndOfSlideshow"]:Ma})),this.RHh()):(this.va.raiseEvent("OnExit",new O.a({["IsFromEndOfSlideshow"]:Ma})),F.a.J(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null"))}this.K.style.width=window.screen.width+"px";this.K.style.height=
window.screen.height+"px";this.Jwc(!1);H.a.instance.K5e()}Ekd(){if(this.xk&&this.Jw&&this.Jw.style.visibility!==ra.a.ft){const Ma=this.xk.getSlideLocation();if(Ma){const Ga=this.xk.getAnimationState(!0),na=Ga.timelineStates,wa=[];for(let Fa=0;Fa<na.length;Fa+=1)wa.push({["TimeLineId"]:na[Fa].timelineId,["Step"]:na[Fa].step,["LastClickTime"]:na[Fa].lastClickTime,["StartTimeOffset"]:Ga.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new N.a({["SlideId"]:Ma.slideId.sid,["SlideIndex"]:Ma.slideIndex,
["TimeLineMappings"]:wa}))}else F.a.J(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}oFk(Ma){if(this.xk&&this.Jw&&this.Jw.style.visibility!==ra.a.ft)switch(Ma){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:F.a.J(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",Ma)}}Djd(Ma){if(this.xk){F.a.J(512495886,
830,10,"SlideshowCoreFrame.OnErrorHandler {0}",Ma);let Ga;Ma.startsWith("Server")&&(Ma="GetItemsRequestFailed");switch(Ma){case "GetItemsFailedDownloadFile":F.a.J(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.$O);this.va.raiseEvent("OnPodSessionExpired",new ca.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.$O}));return;case "LoadFailed":Ga=407;break;case "GetItemsFailedInvalidResponse":Ga=408;break;case "GetItemsRequestFailed":Ga=
409;break;case "GetItemsTimeout":Ga=411;break;case "EnsureSlideFailed":Ga=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Ga=414;break;default:Ga=359}if(0!==Ga)if(this.qWa()){const na=M.a.Ph(Ga);x.AFrameworkApplication.No(na);Ma=409===Ga?Ma:M.a.kda(na);J.Health.instance.recordQosError(Ma,["SlideShowACE"],!1,!0,!0,!0,null);this.xk.recordSessionStats({["errorName"]:Ma})}else F.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",
Ma)}}lld(Ma){F.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.xk&&this.Jw&&this.Jw.style.visibility!==ra.a.ft&&this.va.raiseEvent("OnTranscriberStartedEventId",new fa.a({["TranscriberSessionId"]:Ma}));this.Jc.nxb=!0}E_a(){F.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new aa.a(!1))}Ioe(){return!!this.Vb&&!!this.Vb.instance&&this.Vb.instance.D0f}UJc(Ma){this.va.addHandler("OnSlideshowReady",
Ma)}lqd(Ma){this.va.removeHandler("OnSlideshowReady",Ma)}tUd(Ma){this.va.addHandler("OnBrowserEvent",Ma)}gXe(Ma){this.va.removeHandler("OnBrowserEvent",Ma)}aBf(Ma){this.va.addHandler("OnFullscreenClick",Ma)}nrh(Ma){this.va.removeHandler("OnFullscreenClick",Ma)}vUd(Ma){this.va.addHandler("OnSlideshowContextMenu",Ma)}iXe(Ma){this.va.removeHandler("OnSlideshowContextMenu",Ma)}jja(Ma){this.va.addHandler("OnExit",Ma)}Bga(Ma){this.va.removeHandler("OnExit",Ma)}YAf(Ma){this.va.addHandler("OnSlideshowError",
Ma)}krh(Ma){this.va.removeHandler("OnSlideshowError",Ma)}QJc(Ma){this.va.addHandler("OnGetCurrentSlideDimensions",Ma)}jqd(Ma){this.va.removeHandler("OnGetCurrentSlideDimensions",Ma)}Y_b(Ma){this.va.addHandler("OnGetCurrentPosition",Ma)}nkb(Ma){this.va.removeHandler("OnGetCurrentPosition",Ma)}VJc(Ma){this.va.addHandler("OnSpecialKey",Ma)}mqd(Ma){this.va.removeHandler("OnSpecialKey",Ma)}oBf(Ma){this.va.addHandler("OnVisibilityChangeEventId",Ma)}qXe(Ma){this.va.removeHandler("OnVisibilityChangeEventId",
Ma)}AUd(Ma){this.va.addHandler("OnPodSessionExpired",Ma)}mXe(Ma){this.va.removeHandler("OnPodSessionExpired",Ma)}dBf(Ma){this.va.addHandler("OnLogEndOfTranscriptionSession",Ma)}prh(Ma){this.va.removeHandler("OnLogEndOfTranscriptionSession",Ma)}RQa(Ma){this.va.addHandler("OnPositionChangeEventId",Ma)}okb(Ma){this.va.removeHandler("OnPositionChangeEventId",Ma)}cBf(Ma){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Ma)}orh(Ma){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Ma)}xUd(Ma){this.va.addHandler("OnEnterEndOfShowEventId",
Ma)}jXe(Ma){this.va.removeHandler("OnEnterEndOfShowEventId",Ma)}zUd(Ma){this.va.addHandler("OnLeaveEndOfShowEventId",Ma)}lXe(Ma){this.va.removeHandler("OnLeaveEndOfShowEventId",Ma)}lBf(Ma){this.va.addHandler("OnSubtitleUpdatedEventId",Ma)}yrh(Ma){this.va.removeHandler("OnSubtitleUpdatedEventId",Ma)}mBf(Ma){this.va.addHandler("OnTranscriberStartedEventId",Ma)}Arh(Ma){this.va.removeHandler("OnTranscriberStartedEventId",Ma)}vBf(Ma){this.va.addHandler("RecordQosErrorEventId",Ma)}Hrh(Ma){this.va.addHandler("RecordQosErrorEventId",
Ma)}zJk(Ma){this.va.raiseEvent("OnBrowserEvent",new C.a({["ClientX"]:Ma.clientX,["ClientY"]:Ma.clientY}))}pib(Ma){this.va.raiseEvent("OnSlideshowContextMenu",new da.a({["ClientX"]:Ma.clientPoint.x,["ClientY"]:Ma.clientPoint.y}));return!0}static u8b(){return Math.round(window.performance.now())}}Object(K.a)(ha,"SlideShowCoreFrame",null,[403])},747:function(K,S,d){K=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.Xub="chart";Object(K.a)(h,"ClipserviceDataConstants",null,[]);d.d(S,"b",function(){return e});
d.d(S,"a",function(){return r});const e=m=>m===h.slideType?1:m===h.shapeType?2:m===h.Xub?3:0,r=m=>1===m?h.slideType:2===m?h.shapeType:""},748:function(K,S,d){K=d(0);var h=d(18),e=d(47),r=d(863),m=d(231),n=d(232),z=d(233),t=d(501);class x{constructor(D,w){this.X0a=D;this.description=w}}Object(K.a)(x,"ColorEntry",null,[]);d.d(S,"a",function(){return B});class B{constructor(D){this.kwe={};this.UHe=null;this.Pm=D}get gFl(){if(!this.UHe){const D=new Sys.StringBuilder;for(let w of this.standardColors)D.append(String.format(B.GYd,
this.wLh(w.X0a),this.o8e(w.X0a),w.description));this.UHe=D.toString()}return this.UHe}get standardColors(){let D;return D=new h.a,D.add(new x(12582912,ResourceStrings.L_FontColorDarkRed)),D.add(new x(16711680,ResourceStrings.L_FontColorRed)),D.add(new x(16760832,ResourceStrings.L_FontColorOrange)),D.add(new x(16776960,ResourceStrings.L_FontColorYellow)),D.add(new x(9621584,ResourceStrings.L_FontColorLightGreen)),D.add(new x(45136,ResourceStrings.L_FontColorDarkGreen)),D.add(new x(45296,ResourceStrings.L_FontColorLightBlue)),
D.add(new x(28864,ResourceStrings.L_FontColorBlue)),D.add(new x(8288,ResourceStrings.L_FontColorDarkBlue)),D.add(new x(7352480,ResourceStrings.L_FontColorPurple)),D}wLh(D){return String.format("#{0}",z.i(D))}o8e(D){return z.i(D)}Fwc(D){return Object.assign(new n.a,{ThemeColor:D.ThemeColor,ColorLuminance:D.ColorLuminance,FTintColor:D.FTintColor}).toString()}Qfe(D,w,J){const F=new Sys.StringBuilder;F.append(this.WXd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,D));this.khi(F);F.append(this.VXd());
F.append(this.WXd("StandardColors",ResourceStrings.L_StandardFontColor,!1,D));F.append(this.gFl);F.append(this.VXd());w&&0<w.length&&(F.append(this.WXd("RecentColors",ResourceStrings.L_RecentColors,!1,J)),F.append(this.Gsj(w)),F.append(this.VXd()));return F.toString()}Gsj(D){const w=new Sys.StringBuilder;for(let J=0;J<D.length;J++){const F=D[J];w.append(String.format(B.GYd,"#"+F.hex,F.hex,"#"+F.hex))}return w.toString()}WXd(D,w,J,F){return String.format(B.Swi,D,w,"ColorPicker",J?'McuLayout = "true" ':
"",F)}VXd(){return B.Rwi}khi(D){const w=Array(10);w[0]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Background1));w[1]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Text1));w[2]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Background2));w[3]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Text2));w[4]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Accent1));w[5]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Accent2));w[6]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Accent3));
w[7]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Accent4));w[8]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Accent5));w[9]=this.FL(m.Color.fj(this.Pm.PresetSchemeColorMapping.Accent6));const J=Array(10);J[0]=ResourceStrings.l_ThemeLabel1;J[1]=ResourceStrings.l_ThemeLabel2;J[2]=ResourceStrings.l_ThemeLabel3;J[3]=ResourceStrings.l_ThemeLabel4;J[4]=ResourceStrings.l_ThemeLabel5;J[5]=ResourceStrings.l_ThemeLabel6;J[6]=ResourceStrings.l_ThemeLabel7;J[7]=ResourceStrings.l_ThemeLabel8;J[8]=
ResourceStrings.l_ThemeLabel9;J[9]=ResourceStrings.l_ThemeLabel10;for(let F=0;5>=F;F++)for(let L=0;L<w.length;L++)D.append(this.hcj(w[L][F],w[L][0],J[L],F,L))}FL(D){const w=e.a.vw(D.r,2)+e.a.vw(D.g,2)+e.a.vw(D.b,2);if(this.kwe[w])return this.kwe[w];const J=t.a.ETa(D),F=[];Array.add(F,D);if(D.T7d())for(var L=0;L<r.a.rTh.length;++L)D=t.a.n7b(J),D.darken(r.a.rTh[L]/100),Array.add(F,D.iua());else if(D.q5i())for(L=0;L<r.a.rGf.length;++L)D=t.a.n7b(J),D.lighten(r.a.rGf[L]/100),Array.add(F,D.iua());else if(J.lum<
B.Bwi)for(L=0;L<r.a.kzg.length;++L)D=t.a.n7b(J),D.lighten(r.a.kzg[L]/100),Array.add(F,D.iua());else if(J.lum>B.Awi)for(L=0;L<r.a.jzg.length;++L)D=t.a.n7b(J),D.darken(r.a.jzg[L]/100),Array.add(F,D.iua());else for(L=0;L<r.a.ONc.length+r.a.zNf.length;++L)D=t.a.n7b(J),L<r.a.ONc.length?D.lighten(r.a.ONc[L]/100):D.darken(r.a.zNf[L-r.a.ONc.length]/100),Array.add(F,D.iua());return this.kwe[w]=F}hcj(D,w,J,F,L){D=this.o8e(D.X0a);({MNc:w,KQb:J}=this.sae(w,D,J,F,L));return String.format(B.GYd,w,D,J)}sae(D,w,
J,F,L){var M;var Q=M=null;if(0>F)return{MNc:M,KQb:Q};w=Object.assign(new n.a,{RGBColor:w,ThemeColor:L,ColorLuminance:0,FTintColor:!1});F?(L=t.a.ETa(D),Q=F-1,L.lum?1===L.lum?(F=!1,Q=[242,217,191,166,127][Q]):.8<L.lum?(F=!1,Q=[229,191,127,64,25][Q]):.2>L.lum?(F=!0,Q=[25,64,127,191,229][Q]):(L=[51,102,153],M=[191,127],Q=(F=Q<L.length)?L[Q]:M[Q-L.length]):(F=!0,Q=[127,166,191,217,242][Q]),Q=255-Q,Q=Math.round(100*Q/255),w.ColorLuminance=100-Q,w.FTintColor=F,Q=String.format(F?ResourceStrings.l_ColorPickerTooltipTint:
ResourceStrings.l_ColorPickerTooltipShade,D.toString(),J,Q)):Q=String.format(ResourceStrings.l_ColorPickerTooltipBase,D.toString(),J);M=this.Fwc(w);return{MNc:M,KQb:Q}}}B.Swi='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';B.Rwi="</Colors></ColorPicker></Controls></MenuSection>";B.GYd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';B.Bwi=.2;B.Awi=.8;Object(K.a)(B,"ColorPickerBuilder",null,[])},749:function(K,S,
d){var h=d(103),e=d(56),r=d(77),m=d(27),n=d(36),z=d(87),t=d(29),x=d(234),B=d(330),D=d(28),w=d(995);K=d(0);class J{constructor(){this.Pz=this.onSuccess=this.HMe=this.cVd=this.Rih=null}}Object(K.a)(J,"UploadFileDialogData",null,[]);var F=d(72),L=d(33);K=d(78);d.d(S,"d",function(){return Q});d.d(S,"e",function(){return C});d.d(S,"a",function(){return ca});d.d(S,"c",function(){return N});d.d(S,"b",function(){return da});const M=new K.a,Q=(Y,fa,aa,ka,H)=>{const ra=String.format("{0}{1}",aa,h.a.create().toString());
return Object.assign(new J,{cVd:T(ra,ka),Rih:U(aa,ka),HMe:(ha,Ma)=>{switch(aa){case "video":Ma.blockContent(H,Y);break;default:Ma.blockContent(ha,"Insert Media")}},onSuccess:(ha,Ma,Ga,na,wa,Fa)=>{fa(Y,ra,Ma,Ga,wa,Fa,H)},Pz:(ha,Ma,Ga,na,wa)=>{Ga.qO(Ma)?D.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+Ma.Pja):Ga.qO(H)&&D.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",
+new Date-+H.Pja);L.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(aa)?Ga.zK(H):Ga.zK(Ma);Ma=null;try{const Fa=n.a(ha);Ma=Fa?Fa.Error:null}catch(Fa){D.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",ha)}if(!Ma){let Fa;L.a("FixHideShimmerIssueOnUploadFailure")&&ha&&!isNaN(parseInt(ha))&&(Fa=Enum.parse(x.a,x.a[parseInt(ha)],!0));Ma=Object.assign(new B.a,{Code:Fa?Fa:444})}wa&&(wa.finish(),wa=null);D.a.J(509727821,822,10,"Upload media failed");
ca(aa)?N(ResourceStrings.l_FileInsertFailedMessageTitle,Ma&&449===Ma.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):O(na,wa,Ma.Code,null)}})},C=(Y,fa,aa,ka)=>new Promise((H,ra)=>{const ha=new w.a(ka);D.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}",Y&&Y.value?Y.files.length:0,w.a.hbe(Y));aa&&aa.Wa("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}",Y&&Y.value?
Y.files.length:0,w.a.hbe(Y)));if(Y&&Y.value&&Y.value.length)if(ha.GXl(Y.value)){var Ma=Y.files[0];if(ha.HXl(Ma.size))ha.fCi(Ma).then(Ga=>{Ga?(aa&&aa.Wa("MediaFileValidationPassedOnUI","true"),H(!0)):(ca(ka)?N(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ha.Qna.join(", ")]):O(fa,aa,443,[ha.Qna.join(", ")]),ra(443))},()=>{D.a.J(509727825,822,10,"Invalid media file, fileType:{0}",ka);ca(ka)?N(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,
[ha.Qna.join(", ")]):O(fa,aa,443,[ha.Qna.join(", ")]);ra(443)});else{D.a.J(509727826,822,10,"video"===ka?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${Ma.size}`);Ma=L.a("FetchMediaSizeLimitFromValidationHelper")?ha.wic.toString():"16";const Ga="video"===ka?450:442;ca(ka)?N(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,[Ma]):O(fa,aa,Ga,[Ma]);ra(442)}}else D.a.J(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",
null===ka||void 0===ka?void 0:ka.toString(),w.a.hbe(Y)),ca(ka)?N(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[ha.Qna.join(", ")]):O(fa,aa,441,[ha.Qna.join(", ")]),ra(441);else ca(ka)?N(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):O(fa,aa,440,null),ra(440)}),O=(Y,fa,aa,ka)=>{fa&&(fa.Wa("MediaFileValidationPassedOnUI","false"),aa&&fa.Wa("ErrorCode",aa.toString()),fa.finish());Y.rH(aa,H=>{H.JC=1;H.jTa=ka;
return!1})},U=(Y,fa)=>{let aa="MediaUpload.ashx";if(t.App.webServiceBase)aa=t.App.webServiceBase+aa;else if(e.a.mg||e.a.kva)aa=r.a.Jka(aa);let ka="";switch(Y){case "audio":ka="audio";break;case "captions":ka="captions";break;case "video":ka="video";break;default:D.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}aa+=String.format("?MediaType={0}&{1}&{2}&{3}",ka,m.AFrameworkApplication.yUa(),fa.presentationId.string,m.AFrameworkApplication.F7b());fa.podSessionId&&(aa+=
String.format("&{0}={1}",z.a.Faa,fa.podSessionId));fa.Ck&&(aa+=String.format("&waccluster={0}",fa.Ck));return aa},T=(Y,fa)=>{const aa=new F.a;aa.$("PresentationId",fa.presentationId.string);aa.$(z.a.Aoa,fa.sessionInfo);aa.$("Canary",m.AFrameworkApplication.canary);aa.$("access_token",m.AFrameworkApplication.accessToken);aa.$("MediaToken",Y);return aa},ca=Y=>L.a("EnableCalloutNotificationsForVideos")&&"video".match(Y)?!0:!1,N=(Y,fa,aa)=>{let ka=new B.a;ka.Title=Y;ka.Message=fa;ka.ExtraErrorParam=aa;
M.raiseEvent("videoCalloutNotificationEvent",ka)},da=Y=>{M.addHandler("videoCalloutNotificationEvent",Y)}},930:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.yLe="TraceIdNoBar";h.D5c="TraceIdLeftBar";h.qrd="TraceIdRightBar";h.DLc="TraceIdBothBar";Object(K.a)(h,"ConsistencyCheckTraceIdType",null,[])},931:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(528);class e{constructor(){this.start=new h.a;this.end=new h.a}clone(){return Object.assign(new e,{start:this.start.clone(),
end:this.end.clone()})}merge(r){let m=!1;r.start&&(m=this.start.merge(r.start));r.end&&(m=this.end.merge(r.end)||m);return m}}Object(K.a)(e,"TextNodeSelection",null,[])},932:function(K,S,d){d.d(S,"a",function(){return 19})},933:function(K,S,d){d.r(S);d.d(S,"WordPredictionAugLoopResponseManager",function(){return B});K=d(0);S=d(18);var h=d(359),e=d(934),r=d(670),m=d(668),n=d(669),z=d(558),t=d(64),x=d(34);class B{U9b(D){B.sT.wG(()=>{this.Kwl(D)||(this.V8e(D),this.EVl(),this.epi())},"WPT:PR")}epi(){const D=
z.a.gE.x6,w=z.a.gE.sjb;if(D){var J=t.a.instance.Pa.nb;if(J&&J.jf&&z.a.Jog(J.jf)){J=J.jf.node;var F=x.ParagraphReader.text(J);F=F.substring(D.Rsd,F.length);J=this.Hbe(J,D,F);"string"===typeof J?J.length?(D.q9=J,D.nPb+=1,z.a.YVd(D.text,J),this.DUl(),D.MPe=F,this.CUl(D)):w&&0===w[r.a.status]?(this.HQh(),z.a.Rqd()):this.VVl():(this.HQh(),z.a.Rqd())}}}CUl(D){B.oBd.count>=B.g5h&&B.oBd.removeAt(0);B.oBd.add(this.VEi(D))}VEi(D){return Object.assign(new e.a,{id:D.id,rza:D.rza,Ux:D.Ux,Rsd:D.Rsd,text:D.text,
q9:D.q9,a2b:D.a2b,v8a:D.v8a,score:D.score,F8e:D.F8e,E8e:D.E8e,LP:D.LP,nPb:D.nPb,MPe:D.MPe})}Kwl(D){if(D&&D.parentPath&&7===D.parentPath.length){const w=D.parentPath[6];z.a.U_a.add(w,n.a.yVd,(new Date).getTime());z.a.nek(w)}else return z.a.Wdc(n.a.l6d),!0;return z.a.gWa?(D=this.Qeg(D),D=this.Qjh(D[0]),D[r.a.status]=5,z.a.p9d(D),z.a.Wdc(n.a.TFh),!0):!1}V8e(D){(D=this.Qeg(D))&&D.length?(z.a.gE.x6=D[0],z.a.gE.KLh=D.length,z.a.gE.sjb=this.Qjh(D[0])):(z.a.Rqd(),z.a.Wdc(n.a.l6d))}Qeg(D){if(!D||!D.items||
!D.parentPath||7!==D.parentPath.length)return null;var w=D.items[0];let J;try{J=w.body}catch(C){return null}w=D.parentPath[2];const F=parseInt(D.parentPath[3]),L=parseInt(D.parentPath[4]),M=D.parentPath[5];D=D.parentPath[6];if(!J.predictions.length)return null;z.a.Zql(J.modelInfo);const Q=Array(J.predictions.length);for(let C=0;C<J.predictions.length;C++){const O=J.predictions[C];if(O.text){const U=O.characterRange,T=O.tokenRange;Q[C]=Object.assign(new e.a,{id:M,rza:D,Ux:w,Rsd:F,text:O.text,q9:O.text.substr(U.start),
a2b:U.start,v8a:U.length,score:O.score,F8e:T.start,E8e:T.length,LP:L,nPb:0})}}return Q}Qjh(D){const w={};w[r.a.language]="en-US";const J=z.a.Toj();w[r.a.modelId]=J.modelId;w[r.a.modelVersion]=J.modelVersion;w[r.a.configId]=J.configId;w[r.a.IZd]=D.v8a;w[r.a.XMc]=D.v8a;w[r.a.fwg]=D.q9.length;w[r.a.Ijh]=D.text.length;w[r.a.Ljh]=D.text.split(" ").length;w[r.a.score]=D.score;w[r.a.status]=0;w[r.a.e$e]=D.q9.length;w[r.a.LP]=D.LP;D=z.a.U_a.ga(D.rza);w[r.a.oLh]=D[n.a.yVd]-D[n.a.Tuc];w[r.a.Ixd]=0;return w}EVl(){const D=
z.a.gE.x6;D&&(z.a.nva(D.LP,m.a.wKf,z.a.gE.KLh),z.a.nva(D.LP,m.a.GSf,D.v8a))}DUl(){const D=z.a.gE.x6,w=z.a.gE.sjb;if(D&&1===D.nPb){const J=(new Date).getTime();z.a.U_a.plg(D.rza,n.a.QCf,J);z.a.iyg(D.rza,!0);z.a.Wdc(n.a.Kjh);const F=z.a.U_a.ga(D.rza)[n.a.Tuc];w[r.a.Ixd]=J-F;w[r.a.status]=1;w[r.a.XMc]=D.text.length-D.q9.length;z.a.nva(D.LP,m.a.kxh,1);z.a.nva(D.LP,m.a.ush,1);z.a.nva(D.LP,m.a.vsh,D.q9.length);z.a.nva(D.LP,m.a.HSf,D.text.length-D.q9.length);z.a.FWk()}}VVl(){const D=z.a.gE.x6,w=z.a.gE.sjb;
D&&(w[r.a.status]=3,w[r.a.XMc]=0,w[r.a.e$e]=D.text.length-w[r.a.IZd],z.a.p9d(w),z.a.nva(D.LP,m.a.lOh,1),z.a.nva(D.LP,m.a.JSf,D.score),z.a.nva(D.LP,m.a.mOh,D.text.length-D.v8a),z.a.Rqd())}HQh(){const D=z.a.gE.x6,w=z.a.gE.sjb;if(D){if(0===w[r.a.status]){const J=(new Date).getTime();z.a.U_a.plg(D.rza,n.a.OCf,J);z.a.iyg(D.rza,!1);z.a.Wdc(n.a.Jjh);const F=z.a.U_a.ga(D.rza)[n.a.Tuc];w[r.a.Ixd]=J-F;z.a.nva(D.LP,m.a.r8g,1);w[r.a.status]=6}z.a.p9d(w)}}Hbe(D,w,J){let F=null;w.Ux===D.id.toString()&&J&&w.a2b<
J.length&&(D=J.substring(0,w.a2b)+w.text,D=D.replace(RegExp("\\u00a0","g")," "),J=J.replace(RegExp("\\u00a0","g")," "),0<D.length&&0<J.length&&(D.indexOf(J)||(F=D.substring(J.length,D.length))));return F}static get sT(){return h.a.instance}}B.g5h=4;B.oBd=new S.a;Object(K.a)(B,"WordPredictionAugLoopResponseManager",null,[])},934:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.Ux=this.rza=this.id=null;this.LP=this.Rsd=0;this.q9=this.text=null;this.nPb=this.E8e=this.F8e=
this.score=this.v8a=this.a2b=0;this.MPe=null}}Object(K.a)(h,"Candidate",null,[])},935:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(K.a)(h,"ActivateAnnotationParameters",null,[])},936:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);S=d(619);var h=d(138);class e extends S.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new h.a,
{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(K.a)(e,"TextPredictionAnnotation",S.a,[])},937:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r,m){super();this.actionId=e;this.uBb=r;this.revisionId=m}}Object(K.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},938:function(K,S,d){d.d(S,"c",function(){return n});d.d(S,"b",
function(){return z});d.d(S,"a",function(){return t});var h=d(18),e=d(395),r=d(27),m=d(36);const n=x=>{if(!x)return null;let B;try{B=m.b(x)}catch(D){B=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",D)}return B},z=(x,B)=>{let D=[];if(x.breadcrumbs&&0<x.breadcrumbs.length)D=x.breadcrumbs;else{const w=x.service_info;w&&w.friendly_service_name&&Array.add(D,w.friendly_service_name);x.display_path&&Array.addRange(D,x.display_path)}return D.join(B?
" \u00ab ":" \u200f\u00bb ")},t=(x,B=!1)=>{if(!x)return[];if(!x.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!x.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];x=x.documents.items;const D=new h.a;for(let J=0;J<x.length;J++){const F=x[J];var w=F.web_url;if(!w){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!F.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}w=String.format("{0}?web=1",F.url)}const L=
{};L.DocumentUrl=w;L.MruId=F.mru_id;{w=F;let M=w.title;M?(w.extension&&(M=String.format("{0}.{1}",M,w.extension)),w=M):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),w="")}L.FileName=w;L.IsPinned=F.is_pinned;L.Path=z(F,r.AFrameworkApplication.isRtl);B&&(L.App=F.app,L.TimeStamp=F.time_stamp);D.add(L)}return D.toArray()}},939:function(K,S,d){d.d(S,"a",function(){return x});K=d(0);var h=d(395),e=d(1053),r=d(1253),m=d(7),n=d(18),z=d(41),t=d(33);class x{constructor(B,D,w,J,F,L,M,Q,C){this.$R=
new e.a;this.gT=O=>this.la&&this.la.w3&&O.UL?ResourceStrings.L_AccMessageDecorative:O.get_altTitle();this.zYg=B;this.Sb=D;this.KB=F;this.Ga=w;this.Oc=L;this.yec=M;this.om=J;this.Hh=Q;this.la=C;this.EQj()}get Hd(){return this.Oc.instance}get MF(){return this.yec.value}EQj(){this.$R.$(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.$R.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.$R.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);
this.$R.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.$R.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.$R.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.$R.$(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.$R.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.$R.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.$R.$(13,[ResourceStrings.l_PhTypeMedia,
ResourceStrings.l_InsertContent]);this.$R.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.$R.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.$R.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}Qcg(B,D){B&&(this.p9(B,D),B.Rla?D.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.xde(B,null,D));return null}pvj(B){if(!this.zYg.instance||!B)return null;B=this.zYg.instance.Ucg(B);if(!B||!B.length)return null;
const D=B.length;return 1===D?String.format(ResourceStrings.l_ShapePresenceForOneUser,B[0].userName):2===D?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,B[0].userName,B[1].userName):3===D?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,B[0].userName,B[1].userName,B[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,D)}kfe(B){let D="";B&&B.XL&&B.image.title&&0<B.image.title.length&&(D=B.image.title);B&&(D=String.format(ResourceStrings.l_ThumbnailInfoNew,
B.slideIndex+1,this.Sb.rj(),D),B=this.Tyj(B),0<B.length&&(D+=B));return D}Tyj(B){const D=new Sys.StringBuilder;B.isSelected&&D.append(ResourceStrings.L_SlideIsSelected);B.Wm&&D.append(ResourceStrings.l_SlideIsHidden);const w=Object(r.a)(116,B.$c);if(w){var J=w.nUa();J&&!this.om.bqe(J)&&D.append(ResourceStrings.l_SlideHasNotes);(J=w.nE())&&this.KB.instance&&this.KB.instance.Aig(J)&&(J=this.KB.instance.AVc(J),D.append(1===J?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,
J)))}B.iO&&D.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(B.ujb&&(B=B.ujb.m9())&&0<B.length)if(1===B.length)D.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,B[0].userName));else{J="";for(const F of B)J+=F.userName+",";D.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,J))}w&&w.isUnread&&D.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return D.toString()}uab(B,D){return String.format(ResourceStrings.l_MultipleSlidesSelected,
B,D)}Lij(B,D){return String.format(ResourceStrings.l_DesignerSuggestionSelected,B+1,D)}Wvj(){return ResourceStrings.l_SlidePanel}mpj(){return ResourceStrings.l_MultipleShapes}s8k(B){B&&(this.la.q8a&&B.C6(Object(m.a)(this,this.$ej,"getCameoAccMessage")),B.C6(Object(m.a)(this,this.Mxj,"getTableAccMessage")),B.C6(Object(m.a)(this,this.Zlj,"getImageAccMessage")),B.C6(Object(m.a)(this,this.toj,"getMediaAccMessage")),B.C6(Object(m.a)(this,this.pfj,"getChartAccMessage")),this.Nud?(B.C6(Object(m.a)(this,
this.odg,"getSmartArtAccMessage")),B.C6(Object(m.a)(this,this.xde,"getPlaceHolderAccMessage"))):(B.C6(Object(m.a)(this,this.xde,"getPlaceHolderAccMessage")),B.C6(Object(m.a)(this,this.odg,"getSmartArtAccMessage"))),B.C6(Object(m.a)(this,this.Gyj,"getTextboxAccMessage")),B.C6(Object(m.a)(this,this.evj,"getShapeGroupAccMessage")),B.C6(Object(m.a)(this,this.avj,"getShapeAccMessage")),B.C6(Object(m.a)(this,this.bdj,"getAddinAccMessage")),B.C6(Object(m.a)(this,this.Fcj,"get3DAccMessage")))}xde(B,D,w,J=
null){if(B&&w&&B.Ik&&(this.xYc(B,w),this.$R.Gb(B.Cj))){J&&J(String.format("{0} {1}",this.$R.ga(B.Cj)[0],ResourceStrings.l_Placeholder));if(B.hU||!w.count){w=this.$R.ga(B.Cj)[0];D="";if(!this.Nud||B.hU)D=this.$R.ga(B.Cj)[1];return String.format(B.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,w,this.gT(B),D,B.get_alt())}B=String.format(B.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.$R.ga(B.Cj)[0],
this.gT(B),B.get_alt());w.insert(0,document.createTextNode(B))}return null}Gyj(B,D,w,J=null){if(B&&w&&B.Gw)if(this.xYc(B,w),J&&J(ResourceStrings.L_TextBox),0<w.count)B=String.format(B.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.gT(B),B.get_alt()),w.insert(0,document.createTextNode(B));else return String.format(B.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,this.gT(B),B.get_alt());return null}odg(B,
D,w,J=null){if(B&&w&&B.Wf)if(this.xYc(B,w),J&&J(ResourceStrings.L_SmartArt),0<w.count)B=String.format(B.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.qdg(B)||"",this.gT(B),B.get_alt()),w.insert(0,document.createTextNode(B));else return String.format(B.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.qdg(B)||"",this.gT(B),B.get_alt());return null}p9(B,D){B&&D&&this.Ga.vG(B,w=>{w.Ta(z.a.Oo)&&
this.x$f(w,D)})}xYc(B,D){if(B&&D){const w=this.Nud?new n.a:D;let J=!1;this.Ga.vG(B,F=>{const L=this.Hh.rX(F),M=this.Hh.Tib(F);L&&w.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,M)));J=this.x$f(F,w)||J});this.Nud&&J&&D.addRange(w);D.count||(B=B.E7e)&&D.add(document.createTextNode(B))}}get Nud(){return t.a("AriaMessageHelper.FixAccMessageForEmptyList")}x$f(B,D){let w;const J=B.sa(z.a.kwc,null),F=B.sa(z.a.Oo,"");if(F&&D){if(J){let L=0,M=null,Q;for(let C=0;C<J.length+
1;C++)Q=this.Ga.RWc(B,C),M&&M!==Q&&(w=document.createElement("span"),w.setAttribute("lang",M),w.innerText=F.substring(L,J[C-1]),L=J[C-1],D.add(w)),M=Q;w=document.createElement("span");M&&w.setAttribute("lang",M);w.innerText=F.substring(L,F.length)}else w=document.createElement("span"),(B=this.Ga.RWc(B,0))&&w.setAttribute("lang",B),w.innerText=F;D.add(w)}return!!F&&0<F.length}Mxj(B,D,w,J=null){return B&&B.xd?(J&&J(ResourceStrings.L_Table),String.format(B.get_alt()?ResourceStrings.l_AccMessageTableAlt:
ResourceStrings.l_AccMessageTable,this.gT(B),B.get_alt())):null}Zlj(B,D,w,J=null){return B&&B.tj?(J&&J(ResourceStrings.l_Image),String.format(B.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,this.gT(B),B.get_alt())):null}$ej(B,D,w,J=null){if(!B||!B.Wua)return null;J&&J(ResourceStrings.l_Cameo);return B.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.gT(B),B.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,
this.gT(B),ResourceStrings.l_CameoLearnMoreMessage)}toj(B,D,w,J=null){if(B){if(0===B.mediaType)return null;if(1===B.mediaType)return J&&J(ResourceStrings.l_Audio),this.la.sQ?String.format(ResourceStrings.l_AccMessageCanvasAudio,B.shapeName):String.format(B.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.gT(B),B.get_alt());if(2===B.mediaType)return J&&J(ResourceStrings.l_Video),String.format(B.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,
this.gT(B),B.get_alt())}return null}pfj(B,D,w,J=null){return B&&B.qr?(J&&J(ResourceStrings.l_Chart),String.format(B.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.qfj(B)||"",this.gT(B),B.get_alt())):null}evj(B,D,w,J=null){return B&&B.Of?(J&&J(ResourceStrings.L_GroupObjects),t.a("GroupShapeAltTitleFixEnabled")?String.format(B.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,B.yx().length,B.get_alt()):String.format(B.get_alt()?
ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.gT(B),B.get_alt())):null}avj(B,D,w,J=null){if(B&&w&&B.Rla&&!B.Gw)if(this.xYc(B,w),D=this.Ga.Xcg(B),B.SFa&&(D=ResourceStrings.l_DecorativeLabel),J&&J(D||ResourceStrings.l_TextShape),0<w.count)B=String.format(B.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,D||ResourceStrings.l_TextShape,this.gT(B),B.get_alt()),w.insert(0,document.createTextNode(B));else return String.format(B.get_alt()?
ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,D||ResourceStrings.l_TextShape,this.gT(B),B.get_alt());return null}bdj(B,D,w,J=null){return B&&B.nr&&this.Hd&&this.MF?(B=this.MF.N3(B),B=this.Hd.Vxb(B.id),J&&J(B?B.Rca:null),B?B.Rca:null):null}Fcj(B,D,w,J=null){return B&&B.D4?(J&&J(ResourceStrings.l_3DModel),String.format(B.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,this.gT(B),B.get_alt())):null}qdg(B){return B.smartArtInfo?x.jee(B.smartArtInfo.SmartArtLayout,
1,177,"L_SAType"):(h.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",B.slideId?B.slideId.toString():"",B.get_shapeId()),null)}qfj(B){return x.jee(B.Xub,0,102,"L_ChartType")}qvj(B,D){return(B=this.Ga.NXc(B))&&D?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,D,B):null}static Fyj(B){return x.jee(B,1,177,"L_SAType")}static jee(B,D,w,J){return B>=D&&B<=w&&(B=ResourceStrings[J+B])?B:null}}Object(K.a)(x,"AriaMessageHelper",null,[1005])},940:function(K,S,d){d.d(S,
"a",function(){return h});K=d(0);class h{static Mml(){}static mUi(){}}h.sendTraceTag=h.Mml;h.debugAssertTag=h.mUi;Object(K.a)(h,"BULS",null,[])},941:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(1043),e=d(27),r=d(170),m=d(55);class n{constructor(z,t,x,B,D,w){this.uca=z;this.vca=t;this.yHd=x;this.NP=B;this.OAc=D;this.xob=w}get FEh(){return!this.vca&&!this.yHd}get j9g(){return 2===this.xob?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get d_f(){return CommonUIStrings.l_OICErrorMessageNoOffice}get vkg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get iVa(){return CommonUIStrings.l_OICErrorHelpLink}get ujg(){return"OICFailure"}get icon(){return 3}get hyf(){return 2===
this.xob?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get jka(){return CommonUIStrings.l_DefaultDialogTitle}Y3k(z){this.v9g(z)}Gbk(z){this.v9g(z)}v9g(z){let t=10;1===z?(m.a.instance.resolve("Common.IOfficeTrialExperience").Xse(this.xob),t=3):2===z&&((!this.yHd||this.yHd(this.NP))&&this.vca&&h.a.instance.XPi(this.vca,this.uca,this.NP),t=5);(0===z||1===z)&&this.uca&&this.uca(this.NP);e.AFrameworkApplication.ykb(r.a.ofh,this.OAc,t);this.dispose()}dispose(){this.NP=
this.vca=this.uca=null}}Object(K.a)(n,"AOICErrorDialogWithTrial",null,[108])},942:function(K,S,d){d.d(S,"b",function(){return m});d.d(S,"g",function(){return n});d.d(S,"d",function(){return z});d.d(S,"f",function(){return x});d.d(S,"e",function(){return B});d.d(S,"c",function(){return D});d.d(S,"a",function(){return w});var h=d(27);d(733);var e=d(1153),r=d(533);d(798);const m=()=>h.AFrameworkApplication.isEmbedded,n=()=>{const J=h.AFrameworkApplication.Aa.mb.uO;return!m()&&!h.AFrameworkApplication.hideHeader&&
r.a()&&(J||1===h.AFrameworkApplication.Baj)},z=()=>h.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),t=()=>h.AFrameworkApplication.GDh&&!m()&&!h.AFrameworkApplication.hideHeader,x=()=>t()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ha(h.AFrameworkApplication.yK)||"").toLowerCase()&&!h.AFrameworkApplication.zjg,B=()=>!h.AFrameworkApplication.Qhe&&t(),D=()=>!m()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),w=()=>{if(h.AFrameworkApplication.Tjg)return null;
var J=!!h.AFrameworkApplication.Aa&&h.AFrameworkApplication.Aa.mb.uO;if((h.AFrameworkApplication.Rqe&&h.AFrameworkApplication.J0a||h.AFrameworkApplication.Rxc)&&J)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(267).CuiHelper.Eqd});if(h.AFrameworkApplication.workflowEnabled){J="";switch(h.AFrameworkApplication.nyc){case "Assign":J=CommonUIStrings.l_Assign;break;case "Submit":J=CommonUIStrings.l_Submit}if(""!==J)return Object.assign(new e.a,{command:"2988588587",
label:J,id:"btnWorkflow"})}return null}},943:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"RibbonPeripheralSection",null,[])},944:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(K.a)(h,"ImageProps",null,[])},945:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=
this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(K.a)(h,"CalloutParameters",null,[])},946:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"ICalloutProps",null,[])},947:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";
Object(K.a)(h,"ComboBoxCommandProperties",null,[])},948:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl="IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(K.a)(h,"GalleryButtonCommandProperties",null,[])},949:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(242);class h extends d.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=
this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(K.a)(h,"ErrorViewProps",d.a,[])},950:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(242);class h extends d.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}
Object(K.a)(h,"MultiActionButtonProps",d.a,[])},951:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"PersonaInfo",null,[])},952:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"PersonaIdentifiers",null,[])},953:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.fm=e}w$d(e){const r=[];if(e)for(let z in e){var m=z,n=e[z];const t=this.fm.cbe(m);if(t)for(let x of t)r.push(appChrome.actions.updateControlHiddenState(x,
n));else if(m=this.fm.wlj(m))for(const x of m)if(x.externalUxCommandIds)for(const B of x.externalUxCommandIds)r.push(appChrome.actions.updateControlHiddenState(B,n));else r.push(appChrome.actions.updateGroupHiddenState(x.externalUxGroupId,n))}return r}Scj(e){const r=[];if(e)for(let m in e){if(!e[m])continue;const n=m;n&&r.push(appChrome.actions.deactivateRibbonTab(n))}return r}}Object(K.a)(h,"ReactRibbonTrimmingHelper",null,[])},954:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.neighborhood=
null;this.mentionLength=this.mentionStart=0}}Object(K.a)(h,"InsightsParameters",null,[])},955:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.kTf="data-ccp-timestamp";h.lTf="data-clipservice-ccpid";h.pTf="data-shapeids";h.Xfg="docs-internal-guid-";h.Xeh="SCXO";h.ijh="SCXP";h.zTh="SCXW";h.A7g="MsoListParagraphCxSpFirst";h.B7g="MsoListParagraphCxSpLast";Object(K.a)(h,"HtmlContentMetadataConstants",null,[])},956:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.dXj=e.IsBeforeReady;this.f0j=e.IsFromEndOfSlideshow;this.summary=e.Summary}}Object(K.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},957:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(K.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},958:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(K.a)(h,"OnBrowserEventArgs",Sys.EventArgs,[])},959:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Dwc=e.TimeLineMappings}}Object(K.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},960:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;
this.slideWidth=e.SlideWidth;this.ZFh=e.SlideLeftBound;this.VFh=e.SlideBottomBound}}Object(K.a)(h,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},961:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(K.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},962:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=
e.IsVisible}}Object(K.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},963:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}Object(K.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},964:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.Dwc=e.TimeLineMappings}}
Object(K.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},965:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(1253);class e extends Sys.EventArgs{constructor(r){super();this.YLh=null;this.YLh="string"===typeof r?Object(h.a)(String,r):r.TranscriberSessionId}}Object(K.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},966:function(K,S,d){d.d(S,"a",function(){return x});K=d(0);var h=d(395),e=d(272),r=d(27),m=d(185),n=d(56),z=d(47),t=d(218);class x{static Idg(B){const D={};D.appSettings=
x.LMi();D.singleSignOnSettings=x.ddg();D.appVersion="16";D.appUILocale=e.a.He(r.AFrameworkApplication.lcid).Gxb;D.dataLocale=e.a.He(r.AFrameworkApplication.lcid).Gxb;D.osfOmexBaseUrl=r.AFrameworkApplication.fa.Ha("50");D.firstPartyManifestCDNUrl=r.AFrameworkApplication.fa.Ha("565");D.sdxCdnUrl=r.AFrameworkApplication.fa.Ha("649");D.sdxDmsUrl=r.AFrameworkApplication.fa.Ha("650");D.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Ha("974");D.docUrl=B?B.documentUrl:"";D.pageBaseUrl=m.a.EP;D.lcid=
r.AFrameworkApplication.lcid.toString();D.allowExternalMarketplace=r.AFrameworkApplication.fa.ka("51");D.localizedScriptsUrl=(r.AFrameworkApplication.zbf?r.AFrameworkApplication.fa.Ha("StaticContentHostNonOverriden"):m.a.EP)+r.AFrameworkApplication.fa.Ha("52");B=B?B.Rkg:"";D.localizedImagesUrl=m.a.EP+B;D.localizedStylesUrl=m.a.EP+B;D.localizedResourcesUrl=m.a.Oci(B);D.enableAddinCommands=r.AFrameworkApplication.fa.ka("203");D.enableMyApps=r.AFrameworkApplication.fa.ka("186");D.enableMyOrg=r.AFrameworkApplication.fa.ka("InsertAgaveMyOrgEnabledForHost");
D.enableUploadFileDevCatalog=r.AFrameworkApplication.fa.ka("203")&&!r.AFrameworkApplication.fa.ka("847");D.enableDevCatalog=r.AFrameworkApplication.fa.ka("221");D.devCatalogUrl=r.AFrameworkApplication.fa.Ha("220");D.enablePrivateCatalog=r.AFrameworkApplication.fa.ka("305");D.showSignOutFromPrivateCatalogMessage=r.AFrameworkApplication.fa.ka("307");D.enableBlackForestRedirect=r.AFrameworkApplication.fa.ka("348");D.enableSingleSignOnForAddin=r.AFrameworkApplication.fa.ka("342")&&r.AFrameworkApplication.FWj;
D.enableTaskpaneUpgradeToAppCommand=r.AFrameworkApplication.fa.ka("381");D.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;D.enableAnonymousUseLegacyCatalogService=r.AFrameworkApplication.fa.ka("549");D.enableInsertDialogAccessibilityFix=r.AFrameworkApplication.fa.ka("584");D.enableFirstPartySDXErrorMessages=r.AFrameworkApplication.fa.ka("677");D.disableAppsForOfficeThirdParty=r.AFrameworkApplication.fa.ka("569");D.wacSessionId=r.AFrameworkApplication.userSessionId;D.disableLogging=
!r.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");D.loggableUserId=r.AFrameworkApplication.fa.Ha("LoggableUserId");D.sessionStartInfoJson=r.AFrameworkApplication.fa.Ha("SessionStartInfoJson");D.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;D.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Ha("PostMessageOrigin");D.wacIsEmbedded=r.AFrameworkApplication.fa.ka("IsEmbedded");D.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.ka("1055");
D.disableMicrophonePermission=n.a.wO(1)&&r.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&r.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");D.isHostFrameTrustCheckEnabledForAddIns=r.AFrameworkApplication.fa.ka("1100");D.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;D.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");D.hostAllowedOfficeStore=r.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");D.hostInstallAddIns=r.AFrameworkApplication.fa.Ha("HostInstallAddIns");
D.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");D.approvedAddIns=r.AFrameworkApplication.fa.Ha("ApprovedAddIns");D.isUpnCheckEnabled=r.AFrameworkApplication.fa.ka("1132");D.wacUpn=r.AFrameworkApplication.fa.Ha("UserPrincipalName");D.isReactRibbonEnabled=!0;D.enableSetFocusOnTaskpaneOnUserAction=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);D.enableMyOrg&&D.docUrl&&(B=D.docUrl.split("/"),
D.spBaseUrl=2<B.length?B[0]+"//"+B[2]:null,D.spBaseUrl||h.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",D.docUrl)));D.userNameHashCode=z.a.nL(r.AFrameworkApplication.userName);D.envCode=r.AFrameworkApplication.fa.uc("312",0).toString();return D}static LMi(){const B={};B.AddinRibbonIdAllowUnknown=r.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");B.AddinRibbonNativeGroupControlIsEnabled=!0;B.AddinRibbonTabAutoFocusIsEnabled=!0;B.AddinRibbonTabPositionIsEnabled=
!0;B.AgaveAddinUploadEnabled=r.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");B.DevConsoleEnabled=r.AFrameworkApplication.fa.ka("AddinDevConsoleLog");B.ManifestParserDevConsoleEnabled=!0;B.flightingTreatmentVariables=r.AFrameworkApplication.fa.U6b;B.DisabledChangeGates=r.AFrameworkApplication.fa.Ha("DisabledChangeGates");B.DmsSdxListPresentation=r.AFrameworkApplication.CWf;return B}static ddg(){try{const B={};n.a.zGa&&t.OAuthManagerSettings.ubb&&(B.UiHostSupportsAuthTokenAddinList=x.PTc);
B.UiHostSupportsAuthToken=t.OAuthManagerSettings.ubb;return B}catch(B){h.ULS.sendTraceTag(512263001,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",B.message)}return null}}x.PTc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");Object(K.a)(x,"AppForOfficeHelper",null,[])},967:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.tLe=e}}Object(K.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},968:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r,m){this.JZa={};this.Dcd=e;this.uad=r;this.nhc=m}nua(e,r,m){let n=h.PTf;if(this.uad)if(this.nhc){const z=e.UserId?e.UserId.toLowerCase():null;r=r?r.toLowerCase():null;n=z&&z in this.JZa?this.JZa[z]:r&&r in this.JZa?this.JZa[r]:this.Dcd.nua(e,m);!z||z in this.JZa||(this.JZa[z]=n);!r||r in this.JZa||(this.JZa[r]=n)}else n=this.Dcd.nua(e,m);return n}}
h.PTf="#C0C0C0";Object(K.a)(h,"PresenceColorProvider",null,[384])},969:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();this.iC=e}}Object(K.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},970:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(1199),e=d(27),r=d(36),m=d(77);class n{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}GNb(){return r.c([this.ul(),this])}execute(z,t,x){let B="RoamingAppsHandler.ashx";
h.a.instance.jZe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(B=m.a.Pi(B,"wdEnableRoaming","1"));e.AFrameworkApplication.Je.qj(B,2,this.GNb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.Uyb(),z,t,x,void 0,void 0,void 0,void 0,"6")}}Object(K.a)(n,"ARoamingAppsRequest",null,[])},971:function(K,S,d){d.d(S,"a",function(){return 2});d.d(S,"c",function(){return h});d.d(S,"b",function(){return e});const h=(r,m,n=2)=>{let z;if(0>m||m>r[r.length-1])throw Error.argumentOutOfRange("y");
z=!0;let t=0,x;const B=r.length-1;for(x=0;x<B;x++){const D=t;t=r[x+1];if(m<t){t-m<n&&x<B-1?x++:m-D>=n&&(z=!1);break}}return{returnValue:x<B?x:-1,gqe:z}},e=(r,m,n=2)=>{let z;if(0>m||m>r[r.length-1])throw Error.argumentOutOfRange("x");z=!0;let t=0,x;const B=r.length-1;for(x=0;x<B;x++){const D=t;t=r[x+1];if(m<t){t-m<n&&x<B-1?x++:m-D>=n&&(z=!1);break}}return{returnValue:x<B?x:-1,gqe:z}}},972:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.$Ra=this.MW=0;this.skipUndo=
!1;this.Kp=this.selectionSlide=null;this.version=0;this.OD=this.location=null;this.dataType=0;this.Qmc=null;this.objectCount=0;this.UFa=this.WFa=!1;this.Py=this.sta=this.nodes=null}toString(){const e=JSON.stringify(this.sta);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",this.Kp,this.version,this.OD,this.dataType,this.objectCount,this.WFa,this.UFa,e,this.MW)}}Object(K.a)(h,"ClipServiceObject",null,[])},
973:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r){this.Pu=e;this.Wb=r}}Object(K.a)(h,"ClipServiceCopyParams",null,[])},974:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(395),e=d(99);S=d(975);var r=d.n(S),m=d(335);class n{static Atd(z,t,x){if(z&&x&&(e.a.bDa(z),t&&""!==t))try{m.a("HtmlStringSanitizeByDomPurify")&&(t=r.a.sanitize(t));const B=n.j_h.parseFromString(t,"text/html");if(B&&B.body){const D=B.body.childNodes;for(t=0;t<D.length;t+=1)z.appendChild(D[t].cloneNode(!0))}}catch(B){h.ULS.sendTraceTag(523106530,
324,10,"In class: {0}, unable to parse HTML, {1}",x,B.message)}}}n.j_h=new DOMParser;Object(K.a)(n,"DOMParserHelper",null,[])},975:function(K){(function(S,d){K.exports=d()})(this,function(){function S(Tb,Ya){if("object"!==d(Tb)||"function"!==typeof Tb.createPolicy)return null;var sb=null;Ya.currentScript&&Ya.currentScript.hasAttribute("data-tt-policy-suffix")&&(sb=Ya.currentScript.getAttribute("data-tt-policy-suffix"));Ya="dompurify"+(sb?"#"+sb:"");try{return Tb.createPolicy(Ya,{createHTML:function(oc){return oc},
createScriptURL:function(oc){return oc}})}catch(oc){return console.warn("TrustedTypes policy "+Ya+" could not be created."),null}}function d(Tb){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Ya){return typeof Ya}:function(Ya){return Ya&&"function"==typeof Symbol&&Ya.constructor===Symbol&&Ya!==Symbol.prototype?"symbol":typeof Ya},d(Tb)}function h(Tb,Ya){h=Object.setPrototypeOf||function(sb,oc){sb.__proto__=oc;return sb};return h(Tb,Ya)}function e(){if("undefined"===
typeof Reflect||!Reflect.construct||Reflect.construct.B2l)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Tb){return!1}}function r(Tb,Ya,sb){r=e()?Reflect.construct:function(oc,wb,rc){var Ka=[null];Ka.push.apply(Ka,wb);oc=new (Function.bind.apply(oc,Ka));rc&&h(oc,rc.prototype);return oc};return r.apply(null,arguments)}function m(Tb){var Ya=Array.isArray(Tb)?n(Tb):void 0;Ya||(Ya="undefined"!==typeof Symbol&&
null!=Tb[Symbol.iterator]||null!=Tb["@@iterator"]?Array.from(Tb):void 0);if(!Ya)a:{if(Tb){if("string"===typeof Tb){Ya=n(Tb,void 0);break a}Ya=Object.prototype.toString.call(Tb).slice(8,-1);"Object"===Ya&&Tb.constructor&&(Ya=Tb.constructor.name);if("Map"===Ya||"Set"===Ya){Ya=Array.from(Tb);break a}if("Arguments"===Ya||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ya)){Ya=n(Tb,void 0);break a}}Ya=void 0}if(!(Tb=Ya))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return Tb}function n(Tb,Ya){if(null==Ya||Ya>Tb.length)Ya=Tb.length;for(var sb=0,oc=Array(Ya);sb<Ya;sb++)oc[sb]=Tb[sb];return oc}function z(Tb){return function(Ya){for(var sb=arguments.length,oc=Array(1<sb?sb-1:0),wb=1;wb<sb;wb++)oc[wb-1]=arguments[wb];return T(Tb,Ya,oc)}}function t(Tb,Ya,sb){sb=sb?sb:fa;J&&J(Tb,null);for(var oc=Ya.length;oc--;){var wb=Ya[oc];if("string"===typeof wb){var rc=sb(wb);rc!==wb&&(F(Ya)||(Ya[oc]=rc),wb=rc)}Tb[wb]=!0}return Tb}function x(Tb){var Ya=O(null),sb;for(sb in Tb)T(w,
Tb,[sb])&&(Ya[sb]=Tb[sb]);return Ya}function B(Tb,Ya){for(;null!==Tb;){var sb=M(Tb,Ya);if(sb){if(sb.get)return z(sb.get);if("function"===typeof sb.value)return z(sb.value)}Tb=L(Tb)}return function(oc){console.warn("fallback value for",oc);return null}}function D(){function Tb(pd){var Nc,le;sb("beforeSanitizeAttributes",pd,null);var Ye=pd.attributes;if(Ye){var Zc={attrName:"",zFf:"",dwg:!0,v0l:Bf};for(le=Ye.length;le--;){var Jf=Nc=Ye[le],pg=Jf.name;Jf=Jf.namespaceURI;Nc="value"===pg?Nc.value:ha(Nc.value);
var gd=Td(pg);Zc.attrName=gd;Zc.zFf=Nc;Zc.dwg=!0;Zc.W$i=void 0;sb("uponSanitizeAttribute",pd,Zc);Nc=Zc.zFf;if(!Zc.W$i&&(Ka(pg,pd),Zc.dwg))if(Ma(/\/>/i,Nc))Ka(pg,pd);else{wc&&(Nc=H(Nc,Gb," "),Nc=H(Nc,Bb," "),Nc=H(Nc,dc," "));var bd=Td(pd.nodeName);a:{var Ne=bd;var rf=gd,Fh=Nc;if(Vf&&("id"===rf||"name"===rf)&&(Fh in db||Fh in tf))Ne=!1;else{if(!vb||qf[rf]||!Ma(Xc,rf))if(!Xa||!Ma(Fb,rf))if(!Bf[rf]||qf[rf]){if(!(0<Ne.indexOf("-")&&(af.n2 instanceof RegExp&&Ma(af.n2,Ne)||af.n2 instanceof Function&&af.n2(Ne))&&
(af.S7a instanceof RegExp&&Ma(af.S7a,rf)||af.S7a instanceof Function&&af.S7a(rf))||"is"===rf&&af.yKc&&(af.n2 instanceof RegExp&&Ma(af.n2,Fh)||af.n2 instanceof Function&&af.n2(Fh)))){Ne=!1;break a}}else if(!(ge[rf]||Ma(Gd,H(Fh,od,""))||("src"===rf||"xlink:href"===rf||"href"===rf)&&"script"!==Ne&&0===ra(Fh,"data:")&&Fc[Ne]||cc&&!Ma(kd,H(Fh,od,"")))&&Fh){Ne=!1;break a}Ne=!0}}if(Ne){!Cd||"id"!==gd&&"name"!==gd||(Ka(pg,pd),Nc="user-content-"+Nc);if(Ic&&"object"===d(Ib)&&"function"===typeof Ib.getAttributeType&&
!Jf)switch(Ib.getAttributeType(bd,gd)){case "TrustedHTML":Nc=Ic.createHTML(Nc);break;case "TrustedScriptURL":Nc=Ic.createScriptURL(Nc)}try{Jf?pd.setAttributeNS(Jf,pg,Nc):pd.setAttribute(pg,Nc),da(Mc.removed)}catch(Ae){}}}}sb("afterSanitizeAttributes",pd,null)}}function Ya(pd){sb("beforeSanitizeElements",pd,null);if(pd instanceof Qb&&("string"!==typeof pd.nodeName||"string"!==typeof pd.textContent||"function"!==typeof pd.removeChild||!(pd.attributes instanceof sc)||"function"!==typeof pd.removeAttribute||
"function"!==typeof pd.setAttribute||"string"!==typeof pd.namespaceURI||"function"!==typeof pd.insertBefore||"function"!==typeof pd.hasChildNodes)||Ma(/[\u0080-\uFFFF]/,pd.nodeName))return Db(pd),!0;var Nc=Td(pd.nodeName);sb("uponSanitizeElement",pd,{tagName:Nc,w0l:Fd});if(!(!pd.hasChildNodes()||oc(pd.firstElementChild)||oc(pd.content)&&oc(pd.content.firstElementChild))&&Ma(/<[/\w]/g,pd.innerHTML)&&Ma(/<[/\w]/g,pd.textContent)||"select"===Nc&&Ma(/<template/i,pd.innerHTML))return Db(pd),!0;if(!Fd[Nc]||
Ue[Nc]){if(!Ue[Nc]&&0<Nc.indexOf("-")&&(af.n2 instanceof RegExp&&Ma(af.n2,Nc)||af.n2 instanceof Function&&af.n2(Nc)))return!1;if(Sc&&!Pa[Nc]){Nc=Wc(pd)||pd.parentNode;var le=pc(pd)||pd.childNodes;if(le&&Nc)for(var Ye=le.length-1;0<=Ye;--Ye)Nc.insertBefore(eb(le[Ye],!0),Rb(pd))}Db(pd);return!0}if(le=pd instanceof uc){(le=Wc(pd))&&le.tagName||(le={namespaceURI:gf,tagName:"template"});Ye=fa(pd.tagName);var Zc=fa(le.tagName);le=!(fc[pd.namespaceURI]&&("http://www.w3.org/2000/svg"===pd.namespaceURI?"http://www.w3.org/1999/xhtml"===
le.namespaceURI?"svg"===Ye:"http://www.w3.org/1998/Math/MathML"===le.namespaceURI?"svg"===Ye&&("annotation-xml"===Zc||re[Zc]):Je[Ye]:"http://www.w3.org/1998/Math/MathML"===pd.namespaceURI?"http://www.w3.org/1999/xhtml"===le.namespaceURI?"math"===Ye:"http://www.w3.org/2000/svg"===le.namespaceURI?"math"===Ye&&lh[Zc]:Wh[Ye]:"http://www.w3.org/1999/xhtml"===pd.namespaceURI?"http://www.w3.org/2000/svg"===le.namespaceURI&&!lh[Zc]||"http://www.w3.org/1998/Math/MathML"===le.namespaceURI&&!re[Zc]?0:!Wh[Ye]&&
(ze[Ye]||!Je[Ye]):"application/xhtml+xml"===ud&&fc[pd.namespaceURI]))}if(le||("noscript"===Nc||"noembed"===Nc)&&Ma(/<\/no(script|embed)/i,pd.innerHTML))return Db(pd),!0;wc&&3===pd.nodeType&&(Nc=pd.textContent,Nc=H(Nc,Gb," "),Nc=H(Nc,Bb," "),Nc=H(Nc,dc," "),pd.textContent!==Nc&&(Y(Mc.removed,{element:pd.cloneNode()}),pd.textContent=Nc));sb("afterSanitizeElements",pd,null);return!1}function sb(pd,Nc,le){Rd[pd]&&N(Rd[pd],function(Ye){Ye.call(Mc,Nc,le,Me)})}function oc(pd){return"object"===d(Kb)?pd instanceof
Kb:pd&&"object"===d(pd)&&"number"===typeof pd.nodeType&&"string"===typeof pd.nodeName}function wb(pd){return $b.call(pd.ownerDocument||pd,pd,Yb.SHOW_ELEMENT|Yb.SHOW_COMMENT|Yb.SHOW_TEXT,null,!1)}function rc(pd){if(Md)pd="<remove></remove>"+pd;else var Nc=(Nc=ka(pd,/^[\r\n\t ]+/))&&Nc[0];"application/xhtml+xml"===ud&&"http://www.w3.org/1999/xhtml"===gf&&(pd='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+pd+"</body></html>");var le=Ic?Ic.createHTML(pd):pd;if("http://www.w3.org/1999/xhtml"===
gf)try{var Ye=(new kb).parseFromString(le,ud)}catch(Zc){}if(!Ye||!Ye.documentElement){Ye=ob.createDocument(gf,"template",null);try{Ye.documentElement.innerHTML=Ab?"":le}catch(Zc){}}le=Ye.body||Ye.documentElement;pd&&Nc&&le.insertBefore(db.createTextNode(Nc),le.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===gf?Pb.call(Ye,Ad?"html":"body")[0]:Ad?Ye.documentElement:le}function Ka(pd,Nc){try{Y(Mc.removed,{attribute:Nc.getAttributeNode(pd),from:Nc})}catch(le){Y(Mc.removed,{attribute:null,
from:Nc})}Nc.removeAttribute(pd);if("is"===pd&&!Bf[pd])if(Sd||Le)try{Db(Nc)}catch(le){}else try{Nc.setAttribute(pd,"")}catch(le){}}function Db(pd){Y(Mc.removed,{element:pd});try{pd.parentNode.removeChild(pd)}catch(Nc){try{pd.outerHTML=nd}catch(le){pd.remove()}}}function bc(pd){return pd instanceof RegExp||pd instanceof Function}function Mc(pd){return D(pd)}var mb=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;Mc.version="2.4.1";Mc.removed=[];if(!mb||
!mb.document||9!==mb.document.nodeType)return Mc.g4c=!1,Mc;var Wa=mb.document,db=mb.document,ub=mb.DocumentFragment,Lb=mb.HTMLTemplateElement,Kb=mb.Node,uc=mb.Element,Yb=mb.NodeFilter,Tc=mb.NamedNodeMap,sc=void 0===Tc?mb.NamedNodeMap||mb.c0l:Tc,Qb=mb.HTMLFormElement,kb=mb.DOMParser,Ib=mb.trustedTypes;Tc=uc.prototype;var eb=B(Tc,"cloneNode"),Rb=B(Tc,"nextSibling"),pc=B(Tc,"childNodes"),Wc=B(Tc,"parentNode");"function"===typeof Lb&&(Lb=db.createElement("template"),Lb.content&&Lb.content.ownerDocument&&
(db=Lb.content.ownerDocument));var Ic=S(Ib,Wa),nd=Ic?Ic.createHTML(""):"";Lb=db;var ob=Lb.implementation,$b=Lb.createNodeIterator,Hc=Lb.createDocumentFragment,Pb=Lb.getElementsByTagName,Yc=Wa.importNode;Lb={};try{Lb=x(db).documentMode?db.documentMode:{}}catch(pd){}var Rd={};Mc.g4c="function"===typeof Wc&&ob&&"undefined"!==typeof ob.createHTMLDocument&&9!==Lb;var Gb=Na,Bb=sa,dc=Sa,Xc=xb,Fb=gc,kd=Xb,od=jb,Gd=zc,Fd=null,ee=t({},[].concat(m(na),m(wa),m(Fa),m(Ea),m(ia))),Bf=null,be=t({},[].concat(m(Ja),
m(ab),m(Oa),m(Za))),af=Object.seal(Object.create(null,{n2:{writable:!0,configurable:!1,enumerable:!0,value:null},S7a:{writable:!0,configurable:!1,enumerable:!0,value:null},yKc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ue=null,qf=null,Xa=!0,vb=!0,cc=!1,wc=!1,Ad=!1,Md=!1,Sd=!1,Le=!1,fe=!1,Vf=!0,Cd=!1,Sc=!0,jg=!1,mg={},Pa=null,bb=t({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),
Fc=null,yd=t({},"audio video img source image track".split(" ")),ge=null,rb=t({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),gf="http://www.w3.org/1999/xhtml",Ab=!1,fc=null,kc=t({},["http://www.w3.org/1998/Math/MathML","http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],aa),ud,zd=["application/xhtml+xml","text/html"],Td,Me=null,tf=db.createElement("form"),re=t({},["mi","mo","mn","ms","mtext"]),lh=t({},["foreignobject","desc","title",
"annotation-xml"]),ze=t({},["title","style","font","a","script"]),Je=t({},wa);t(Je,Fa);t(Je,pa);var Wh=t({},Ea);t(Wh,ta);var Kg=function le(Nc){var Ye,Zc=wb(Nc);for(sb("beforeSanitizeShadowDOM",Nc,null);Ye=Zc.nextNode();)sb("uponSanitizeShadowNode",Ye,null),Ya(Ye)||(Ye.content instanceof ub&&le(Ye.content),Tb(Ye));sb("afterSanitizeShadowDOM",Nc,null)};Mc.sanitize=function(Nc){var le=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(Ab=!Nc)&&(Nc="\x3c!--\x3e");if("string"!==typeof Nc&&!oc(Nc)){if("function"!==
typeof Nc.toString)throw Ga("toString is not a function");Nc=Nc.toString();if("string"!==typeof Nc)throw Ga("dirty is not a string, aborting");}if(!Mc.g4c){if("object"===d(mb.s8e)||"function"===typeof mb.s8e){if("string"===typeof Nc)return mb.s8e(Nc);if(oc(Nc))return mb.s8e(Nc.outerHTML)}return Nc}Me&&Me===le||(le&&"object"===d(le)||(le={}),le=x(le),ud=-1===zd.indexOf(le.pVh)?ud="text/html":ud=le.pVh,Td="application/xhtml+xml"===ud?aa:fa,Fd="ALLOWED_TAGS"in le?t({},le.Q_l,Td):ee,Bf="ALLOWED_ATTR"in
le?t({},le.O_l,Td):be,fc="ALLOWED_NAMESPACES"in le?t({},le.P_l,aa):kc,ge="ADD_URI_SAFE_ATTR"in le?t(x(rb),le.Wbf,Td):rb,Fc="ADD_DATA_URI_TAGS"in le?t(x(yd),le.N_l,Td):yd,Pa="FORBID_CONTENTS"in le?t({},le.dcf,Td):bb,Ue="FORBID_TAGS"in le?t({},le.X_l,Td):{},qf="FORBID_ATTR"in le?t({},le.W_l,Td):{},mg="USE_PROFILES"in le?le.o0l:!1,Xa=!1!==le.S_l,vb=!1!==le.T_l,cc=le.U_l||!1,wc=le.j0l||!1,Ad=le.p0l||!1,Sd=le.f0l||!1,Le=le.g0l||!1,fe=le.h0l||!1,Md=le.Y_l||!1,Vf=!1!==le.k0l,Cd=le.l0l||!1,Sc=!1!==le.a0l,
jg=le.$_l||!1,Gd=le.R_l||Gd,gf=le.d0l||"http://www.w3.org/1999/xhtml",le.yNa&&bc(le.yNa.n2)&&(af.n2=le.yNa.n2),le.yNa&&bc(le.yNa.S7a)&&(af.S7a=le.yNa.S7a),le.yNa&&"boolean"===typeof le.yNa.yKc&&(af.yKc=le.yNa.yKc),wc&&(vb=!1),Le&&(Sd=!0),mg&&(Fd=t({},m(ia)),Bf=[],!0===mg.html&&(t(Fd,na),t(Bf,Ja)),!0===mg.EHl&&(t(Fd,wa),t(Bf,ab),t(Bf,Za)),!0===mg.I2l&&(t(Fd,Fa),t(Bf,ab),t(Bf,Za)),!0===mg.z1l&&(t(Fd,Ea),t(Bf,Oa),t(Bf,Za))),le.iUh&&(Fd===ee&&(Fd=x(Fd)),t(Fd,le.iUh,Td)),le.hUh&&(Bf===be&&(Bf=x(Bf)),t(Bf,
le.hUh,Td)),le.Wbf&&t(ge,le.Wbf,Td),le.dcf&&(Pa===bb&&(Pa=x(Pa)),t(Pa,le.dcf,Td)),Sc&&(Fd["#text"]=!0),Ad&&t(Fd,["html","head","body"]),Fd.table&&(t(Fd,["tbody"]),delete Ue.oKh),Q&&Q(le),Me=le);Mc.removed=[];"string"===typeof Nc&&(jg=!1);if(jg){if(Nc.nodeName&&(le=Td(Nc.nodeName),!Fd[le]||Ue[le]))throw Ga("root node is forbidden and cannot be sanitized in-place");}else if(Nc instanceof Kb){var Ye=rc("\x3c!----\x3e");le=Ye.ownerDocument.importNode(Nc,!0);1===le.nodeType&&"BODY"===le.nodeName?Ye=le:
"HTML"===le.nodeName?Ye=le:Ye.appendChild(le)}else{if(!Sd&&!wc&&!Ad&&-1===Nc.indexOf("<"))return Ic&&fe?Ic.createHTML(Nc):Nc;Ye=rc(Nc);if(!Ye)return Sd?null:fe?nd:""}Ye&&Md&&Db(Ye.firstChild);for(var Zc=wb(jg?Nc:Ye);le=Zc.nextNode();)if((3!==le.nodeType||le!==Jf)&&!Ya(le)){le.content instanceof ub&&Kg(le.content);Tb(le);var Jf=le}if(jg)return Nc;if(Sd){if(Le)for(Jf=Hc.call(Ye.ownerDocument);Ye.firstChild;)Jf.appendChild(Ye.firstChild);else Jf=Ye;Bf.A2l&&(Jf=Yc.call(Wa,Jf,!0));return Jf}Jf=Ad?Ye.outerHTML:
Ye.innerHTML;Ad&&Fd["!doctype"]&&Ye.ownerDocument&&Ye.ownerDocument.doctype&&Ye.ownerDocument.doctype.name&&Ma(zb,Ye.ownerDocument.doctype.name)&&(Jf="<!DOCTYPE "+Ye.ownerDocument.doctype.name+">\n"+Jf);wc&&(Jf=H(Jf,Gb," "),Jf=H(Jf,Bb," "),Jf=H(Jf,dc," "));return Ic&&fe?Ic.createHTML(Jf):Jf};return Mc}var w=Object.hasOwnProperty,J=Object.setPrototypeOf,F=Object.isFrozen,L=Object.getPrototypeOf,M=Object.getOwnPropertyDescriptor,Q=Object.freeze,C=Object.seal,O=Object.create,U="undefined"!==typeof Reflect&&
Reflect,T=U.apply,ca=U.construct;T||(T=function(Tb,Ya,sb){return Tb.apply(Ya,sb)});Q||(Q=function(Tb){return Tb});C||(C=function(Tb){return Tb});ca||(ca=function(Tb,Ya){return r(Tb,m(Ya))});var N=z(Array.prototype.forEach),da=z(Array.prototype.pop),Y=z(Array.prototype.push),fa=z(String.prototype.toLowerCase),aa=z(String.prototype.toString),ka=z(String.prototype.match),H=z(String.prototype.replace),ra=z(String.prototype.indexOf),ha=z(String.prototype.trim),Ma=z(RegExp.prototype.test),Ga=function(Tb){return function(){for(var Ya=
arguments.length,sb=Array(Ya),oc=0;oc<Ya;oc++)sb[oc]=arguments[oc];return ca(Tb,sb)}}(TypeError),na=Q("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
wa=Q("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),Fa=Q("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
pa=Q("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Ea=Q("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),ta=Q("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
ia=Q(["#text"]),Ja=Q("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
ab=Q("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Oa=Q("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
Za=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Na=C(/\{\{[\w\W]*|[\w\W]*\}\}/gm),sa=C(/<%[\w\W]*|[\w\W]*%>/gm),Sa=C(/\${[\w\W]*}/gm),xb=C(/^data-[\-\w.\u00B7-\uFFFF]/),gc=C(/^aria-[\-\w]+$/),zc=C(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Xb=C(/^(?:\w+script|data):/i),jb=C(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zb=C(/^html$/i);return D()})},976:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=
d(7),e=d(79),r=d(67),m=d(141);class n extends Sys.UI.Control{constructor(z,t,x,B){super(document.createElement("div"));this.z7=this.x7=this.tF=this.a4a=this.IS=this.SNa=this.IPa=null;this.jVb=this.IOa=!1;this.content=this.xC=null;this.Mba=0;this.eGf=null;this.w_=0;this.Skd=null;this.bwf=z;this.Zqb=t;this.$P=x;this.K_d=B;this.pi=t.ownerDocument;this.q$b=this.Mr=this.OVb=!1}get fK(){this.IPa||(this.IPa=this.pi.createElement("div"),this.IPa.id=this.Vh("WACCalloutOuter"),this.IPa.className="WACCalloutOuter",
this.IPa.setAttribute(m.a.hf,m.a.FWd),this.IPa.style.width=this.Mba+"px");return this.IPa}get Ttb(){if(!this.SNa){this.SNa=this.pi.createElement("div");this.SNa.id=this.Vh("WACCalloutBeakContainer");this.SNa.className="WACCalloutBeakContainer";var z="CalloutBeakTopFilled_32x16x32";if(5===this.w_||6===this.w_||4===this.w_)z="CalloutBeakBottomFilled_32x16x32";z=e.createClusteredImage(32,16,z,"WACCalloutBeak",!0,"");this.SNa.appendChild(z)}return this.SNa}set Ttb(z){this.SNa=z}get WL(){return this.OVb}get title(){return this.xC}set title(z){this.xC!==
z&&(this.xC=z,this.x7&&(this.x7.innerText=this.xC))}get Mr(){return this.IOa}set Mr(z){this.IOa!==z&&(this.IOa=z,this.IS&&(this.IS.contains(this.tF)&&!this.IOa?this.IS.removeChild(this.tF):!this.IS.contains(this.tF)&&this.IOa&&this.Syf()))}get q$b(){return this.jVb}set q$b(z){this.jVb!==z&&(this.jVb=z,this.IS&&(this.IS.contains(this.x7)&&!this.jVb?this.IS.removeChild(this.x7):!this.IS.contains(this.x7)&&this.jVb&&this.nAf()))}show(){this.OVb||(this.TNi(),this.Qqi(),this.Zqb.appendChild(this.fK),this.fK.style.display=
"Block",this.A1e(),this.OVb=!0,this.Skd&&this.Skd())}dismiss(){this.OVb&&(this.CWi(),this.Zqb.removeChild(this.fK),this.OVb=!1,this.K_d&&this.K_d())}dispose(){this.dismiss();this.x7=this.tF=this.a4a=this.SNa=this.IS=this.IPa=null;Sys.Component.prototype.dispose.call(this)}Vh(z){return this.get_element().id+z}TNi(){this.IS=this.pi.createElement("div");this.IS.id=this.Vh("WACCalloutHeader");this.IS.className="WACCalloutHeader";this.Mr&&this.Syf();this.q$b&&this.nAf();this.a4a=this.pi.createElement("div");
this.a4a.id=this.Vh("WACCalloutContent");this.a4a.className="WACCalloutContent";this.a4a.style.width=190<this.Mba?this.Mba-26+"px":"164px";this.a4a.appendChild(this.content);this.fK.appendChild(this.Ttb);this.fK.appendChild(this.IS);this.fK.appendChild(this.a4a)}Syf(){this.tF=this.pi.createElement("a");this.tF.className="WACCalloutCloseAnchor";this.tF.id=this.Vh("WACCalloutCloseAnchor");this.tF.href="#";this.IS.appendChild(this.tF);const z=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.tF.appendChild(z)}nAf(){this.x7=this.pi.createElement("div");this.x7.className="WACCalloutTitle UIFontBold";this.x7.style.width=190<this.Mba?this.Mba-30+"px":"160px";this.x7.id=this.Vh("WACCalloutTitle");this.x7.innerText=this.title;this.IS.contains(this.tF)?this.IS.insertBefore(this.x7,this.tF):this.IS.appendChild(this.x7)}A1e(){var z=this.bwf;let t;if(1===this.w_){var x=this.eGf.y+16;t=-16}else 2===this.w_||3===this.w_||0===this.w_?(x=z.y+z.height+15,t=-15):
(x=z.y-this.fK.clientHeight-15-2,t=this.fK.clientHeight-1);this.fK.style.top=x+"px";this.Ttb.style.top=t+"px";1===this.w_?(z=this.eGf.x-16,this.fK.style.left="50%",this.fK.style.marginLeft=-this.Mba/2+"px",x=Sys.UI.DomElement.getBounds(this.fK),this.Ttb.style.left=z-x.x+"px"):(x=z.x+this.bwf.width/2,2===this.w_||5===this.w_?(z=20,x-=36):0===this.w_||4===this.w_?(z=this.Mba/2-16,x-=this.Mba/2):(z=this.Mba-20-32,x=x-this.Mba+36),this.fK.style.left=x+"px",this.Ttb.style.left=z+"px")}Qqi(){this.Mr&&!this.z7&&
(this.z7=Object(h.a)(this,this.KW,"closeHandler"),this.$P.ub(r.a.click,this.tF,this.z7,null))}CWi(){this.Mr&&this.z7&&(this.$P.Bb(r.a.click,this.tF,this.z7),this.z7=null)}KW(){this.dismiss();return!0}}Object(K.a)(n,"Callout",Sys.UI.Control,[740])},977:function(K,S,d){d.d(S,"a",function(){return L});var h=d(134);K=d(0);var e=d(34),r=d(40),m=d(32),n=d(91),z=d(187),t=d(51),x=d(39),B=d(730),D=d(1040),w=d(281),J=d(693),F=d(340);class L{constructor(M,Q,C,O,U,T,ca,N){this.pU=M;this.pa=Q;this.wi=C;this.wwa=
O;this.Ga=U;this.MJ=T;this.GJ=ca;this.sIa=N;this.select=({scope:da,text:Y,index:fa})=>Object(h.a)(this,void 0,void 0,function*(){var aa=[];let ka=[];var H=null!==da&&void 0!==da?da:"Selection";if("Selection"===H){var ra=this.pa.Pa.nb;ra?(ra=ra.toArray().filter(ha=>e.ParagraphReader.fe(ha.node)),0<ra.length?aa.push(...ra):(ra=this.pa.Ud(),0<ra.length&&this.sIa.v_e(12,ra,aa))):this.sIa.pNb(12,this.pa.Re(),aa);0!==aa.length||da||(H="Presentation")}if(Array.isArray(H)&&0<H.length&&H[0]instanceof w.a)this.sIa.pNb(12,
H,aa);else if(Array.isArray(H)&&0<H.length&&H[0]instanceof D.a)this.sIa.v_e(12,H,aa);else if("Presentation"===H&&this.Oc){H=this.Oc.hO.presentation.slides;if(null===H)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.sIa.pNb(12,H,aa)}if(Y)for(const ha of aa){aa=e.ParagraphReader.text(ha.node);aa=this.matchAll(aa,Y);for(const Ma of aa)Ma[0]&&void 0!==Ma.index&&(aa=Ma.index,H=Ma.index+Ma[0].length,ra=t.a.Oj(ha.node,aa),this.GJ.k5e(ra),ra=t.a.Oj(ha.node,H+1),this.GJ.k5e(ra),
ka.push(t.a.createTextRange(ha.node,aa,H)))}else ka=aa;if("number"===typeof fa){0>fa&&(fa=ka.length+fa);if(0<=fa&&fa<ka.length)return[ka[fa]];throw Error.argumentOutOfRange("index");}return ka});this.fol=(da,Y)=>{const fa=new m.GraphIterator;fa.set(da);fa.rc(11);fa.Jg(11);da=da.Vf.Hv(fa);const aa=Y?1:16;Y=Y?1:0;da?da.fza(aa,Y):(Y=z.a.SN(aa,Y),this.MJ.$Qa(fa,Y))};this.Ypl=(da,Y)=>{switch(Y){case "Left":Y=1;break;case "Center":Y=2;break;case "Right":Y=3;break;case "Distributed":Y=7;break;case "Justify":Y=
6;break;default:Y=1}this.wwa.pK(da,Y)};this.uul=(da,Y)=>{if(da=this.Ga.An(da)){switch(Y){case "Top":Y=0;break;case "Middle":Y=1;break;case "Bottom":Y=2;break;default:Y=0}da.setValue(x.a.HP,Y)}};this.format=({textRanges:da,color:Y,bold:fa,italic:aa,underline:ka,fontName:H,size:ra,bulleted:ha,horizontalAlignment:Ma,verticalAlignment:Ga})=>Object(h.a)(this,void 0,void 0,function*(){if(!da)throw Error.argumentNull("textRanges");const na=[];if(da&&0<da.length){for(const Fa of da){var wa=[];if(Fa.contextId===
r.a.paragraph){const pa=n.a.K5f(Fa.node,!1);for(const Ea of pa)wa.push(Ea.formatting)}else wa.push(n.a.Es(Fa));for(const pa of wa)pa&&(Y&&(wa=J.a.TRa(Y),Y=""===wa?Y:wa,this.wi.vr(pa,Y,null)),void 0!==fa&&this.wi.eI(pa,fa),void 0!==aa&&this.wi.setItalic(pa,aa),ka&&this.wi.iZ(pa,"None"!==ka),H&&this.wi.pV(pa,H),void 0!==ra&&this.wi.Xq(pa,2*ra),void 0!==ha&&this.fol(Fa.node,ha),Ma&&this.Ypl(Fa.node,Ma),Ga&&this.uul(Fa.node,Ga));na.push(new Promise(pa=>F.a.r9(pa,Fa.node).bind(this)))}yield Promise.all(na)}});
this.cel=(da,Y)=>Object(h.a)(this,void 0,void 0,function*(){const fa=(new DOMParser).parseFromString(Y,"text/html");if(0<fa.body.innerHTML.trim().length)return da.DMb=fa.body.innerHTML.trim(),new Promise(aa=>F.a.r9(aa,da).bind(this))});this.insert=({precededBy:da,text:Y})=>Object(h.a)(this,void 0,void 0,function*(){if(!da)throw Error.argumentNull("precededBy");const fa=[];for(var aa of da){var ka=aa.node,H=-1===aa.Lb?ka.characterData.length:aa.Lb+1;H=aa.contextId===r.a.Mf?aa:t.a.Oj(ka,H);this.GJ.replaceTextRange(H,
Y,!0);ka=t.a.createTextRange(ka,aa.Lb+1,aa.Lb+Y.length);fa.push(ka)}aa=[];for(const ra of fa)aa.push(new Promise(ha=>F.a.r9(ha,ra).bind(this)));return Promise.all(aa)});this.delete=({textRanges:da})=>Object(h.a)(this,void 0,void 0,function*(){if(!da)throw Error.argumentNull("textRanges");let Y=[];const fa=[];for(let aa of da){aa.node instanceof B.a&&aa.contextId!==r.a.textRange&&(aa=t.a.createTextRange(aa.node,0,aa.node.characterData.length));this.GJ.replaceTextRange(aa,"",!0);const ka=t.a.Oj(aa.node,
aa.Ra);Y.push(ka);fa.push(new Promise(H=>F.a.r9(H,aa.node).bind(this)))}yield Promise.all(fa);return 0===Y.length?[]:[Y[0]]});if(!M)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Q)throw Error.argumentNull("m_selectionManager");if(!C)throw Error.argumentNull("m_formattingEditor");if(!O)throw Error.argumentNull("m_paragraphEditor");if(!U)throw Error.argumentNull("m_shapeReader");if(!T)throw Error.argumentNull("m_listEditor");if(!ca)throw Error.argumentNull("m_characterPropertiesEditor");
if(!N)throw Error.argumentNull("m_odslGraphUtils");this.pU&&this.pU.execute(da=>{this.Oc=da})}matchAll(M,Q){Q=Q instanceof RegExp?Q:new RegExp(Q,"g");const C=[];let O;for(;null!==(O=Q.exec(M));)C.push(O);return C}}Object(K.a)(L,"ODSLText",null,[509])},978:function(K,S,d){d.d(S,"a",function(){return U});var h=d(134);K=d(0);var e=d(591),r=d(1261),m=d(1287),n=d(55),z=d(1253),t=d(281),x=d(58),B=d(59),D=d(401),w=d(694),J=d(43),F=d(105),L=d(1058),M=d(695),Q=d(232),C=d(693),O=d(340);class U{constructor(T,
ca,N,da,Y,fa,aa,ka,H,ra,ha){this.pU=T;this.pa=ca;this.kj=N;this.jZa=da;this.bYa=Y;this.Ga=fa;this.wk=aa;this.oi=ka;this.Eb=H;this.sr=ra;this.Rq=ha;this.QFb=this.kIa=0;this.D_e=(Ma,Ga)=>{for(let na of Ma)Ga.push(...na.yj())};this.select=({scope:Ma,name:Ga,index:na=-1})=>Object(h.a)(this,void 0,void 0,function*(){const wa=[],Fa=[];var pa=null!==Ma&&void 0!==Ma?Ma:"Selection";if("Selection"===pa){const Ea=this.pa.Ud();0<Ea.length?wa.push(...Ea):this.D_e(this.pa.Re(),wa);0!==wa.length||Ma||(pa="Presentation")}if("Presentation"===
pa&&this.Oc){pa=this.Oc.hO.presentation.slides;if(null===pa)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.D_e(pa,wa)}else Array.isArray(pa)&&0<pa.length&&pa[0]instanceof t.a&&this.D_e(pa,wa);if(Ga)for(const Ea of wa)Ea.shapeName===Ga&&Fa.push(Ea);else Fa.push(...wa);if("number"===typeof na){0>na&&(na=Fa.length+na);if(0<=na&&na<Fa.length)return[Fa[na]];throw Error.argumentOutOfRange("index");}return Fa});this.format=({shapes:Ma,left:Ga,top:na,height:wa,width:Fa,lineColor:pa,
lineDashStyle:Ea,lineWeight:ta,lineTransparency:ia,fillColor:Ja,fillTransparency:ab})=>Object(h.a)(this,void 0,void 0,function*(){if(!Ma)throw Error.argumentNull("shapes");if(Ma&&0<Ma.length){const Za=[];for(const Na of Ma){void 0!==Ga&&(Na.My=Ga);void 0!==na&&(Na.Ny=na);void 0!==wa&&(Na.iD=wa);void 0!==Fa&&(Na.Ix=Fa);if(pa){var Oa=C.a.TRa(pa);pa=""===Oa?pa:Oa;Oa=Q.a.parse(pa);Na.Bpa=JSON.stringify(Oa)}if(Ea)switch(Ea){case "Dash":Na.WM=0;break;case "DashDot":Na.WM=1;break;case "DashDotDot":Na.WM=
2;break;case "LongDash":Na.WM=3;break;case "LongDashDot":Na.WM=4;break;case "RoundDot":Na.WM=5;break;case "Solid":Na.WM=6;break;case "SquareDot":Na.WM=7;break;case "LongDashDotDot":Na.WM=8;break;case "SystemDash":Na.WM=9;break;case "SystemDot":Na.WM=10;break;case "SystemDashDot":Na.WM=11;break;default:Na.WM=6}void 0!==ta&&(Na.outlineWidth=ta);void 0!==ia&&(Oa=Q.a.parse(Na.Bpa),Oa.Alpha=100*ia,Na.Bpa=JSON.stringify(Oa));Ja&&(Ja=""===C.a.TRa(Ja)?Ja:C.a.TRa(Ja),Oa=Q.a.parse(Ja),Na.Pga=JSON.stringify(Oa));
void 0!==ab&&(Oa=Q.a.parse(Na.Pga),Oa.Alpha=100*ab,Na.Pga=JSON.stringify(Oa));Za.push(new Promise(sa=>O.a.r9(sa,Na).bind(this)))}yield Promise.all(Za)}});this.insert=({slides:Ma,shapeType:Ga})=>{if(!Ma)throw Error.argumentNull("slides");if(!this.Oc)throw Error("Cannot insert shapes without appForOfficeManager instance.");const na=[];for(const Ja of Ma){Ma=Ja;if(!Ma)throw Error("Cannot find selected slide to insert shape.");const ab=Ma.Cb;if(x.a.Fw(ab))throw Error("Cannot insert on fake slide node.");
const Oa=this.N$a(Ga);if(!Oa)throw Error("Could not load props for shapeType.");if(!this.kj.hD(Ma,1))throw this.kj.KD(Ma),Error("Too many shapes on the slide.");const Za=this.jZa.sJ;var wa=Ma.Fd.HasDefaultShape,Fa=Ma.Fd.HasDefaultLine,pa=95===Oa.Yga||97===Oa.Yga||Array.contains(w.a.gte,Oa.Yga);Fa=Fa&&pa;wa=wa&&!pa;this.oha(0);var Ea=void 0;let Na,sa;var ta=this.Oc.hO.presentation.slideWidth,ia=this.Oc.hO.presentation.slideHeight;Ea=new B.a((ta-Oa.width*e.a.yD)/2,(ia-Oa.height*e.a.yD)/2);pa=Ea.x+r.a.gf(this.HO*
D.a.nT,m.a.horizontal);sa=Ea.y+r.a.gf(this.HO*D.a.nT,m.a.vertical);Za?(Ea=Oa.width*e.a.yD,Na=Oa.height*e.a.yD):(Ea=r.a.gf(U.A1b,m.a.horizontal),Na=r.a.gf(U.z1b,m.a.vertical),pa=ta/2-r.a.gf(U.A1b/2-this.HO*D.a.nT,m.a.horizontal),sa=ia/2-r.a.gf(U.z1b/2-this.HO*D.a.nT,m.a.vertical));this.HO++;this.HO>this.kIa&&(this.HO=this.QFb);ta=Ma.Cs();ia=Object(z.a)(424,this.Oc.hO.Ba.rg(this.Eb.Na));J.a.Kb&&(Fa||wa)&&J.a.Kb.Wa(F.a.e8d,Fa?"HasDefaultLine":"HasDefaultShape");let Sa=null;Sa=!Za||"TextBox"===Ga||wa||
Fa?this.wk.BDa(!1,ab.cid,ab.sid,0,Oa.shapeType,pa,sa,Ea,Na,ta+1):w.a.yPc(ab,Oa,ia.$T,null,new L.a,pa,sa,Ea,Na,ta,this.Ga,this.wk,this.Eb,this.Oc.hO,this.oi);this.sr.HT([Sa],Ma,null);this.Rq.oA=Sa;this.Xwc();na.push(Sa)}Ga=[];for(const Ja of na)Ga.push(new Promise(ab=>O.a.r9(ab,Ja).bind(this)));return Promise.all(Ga)};this.delete=({shapes:Ma})=>Object(h.a)(this,void 0,void 0,function*(){if(!Ma)throw Error.argumentNull("shapes");for(const Ga of Ma)this.wk.VQc(Ga);return new Promise(Ga=>O.a.r9(Ga,this.Oc.hO.Ba).bind(this))});
if(!T)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!ca)throw Error.argumentNull("m_selectionManager");if(!N)throw Error.argumentNull("m_shapeCountValidator");if(!da)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.pU&&this.pU.execute(Ma=>{this.Oc=Ma});this.HO=0}oha(T){this.bYa.A8e(T)}Xwc(){const T=n.a.instance.Ia("Common.ISystemInitiatedFeedback");T&&T.execute(ca=>{ca.logActivity("InsertShapeActivity",null)})}N$a(T){switch(T){case "Textbox":return new M.a(34,16,.5,3);case "Ellipse":return new M.a(34,
9,1,1);case "Triangle":return new M.a(2,17,1,1.16);case "RightTriangle":return new M.a(3,55,1,1);case "Parallelogram":return new M.a(6,56,1,1.33);case "Trapezoid":return new M.a(7,57,1.33,1);case "Diamond":return new M.a(5,58,1,1);case "SPentagon":return new M.a(9,59,1,1.05);case "Hexagon":return new M.a(10,60,1,1.16);case "Heptagon":return new M.a(11,61,1,1);case "Octagon":return new M.a(12,62,1,1);case "Decagon":return new M.a(13,63,1,1);case "Dodecagon":return new M.a(14,64,1,1);case "Pie":return new M.a(39,
65,1,1);case "Chord":return new M.a(87,66,1,1);case "Teardrop":return new M.a(35,67,1,1);case "Frame":return new M.a(83,68,1,1);case "HalfFrame":return new M.a(84,69,1,1);case "LShape":return new M.a(85,70,1,1);case "DiagonalStripe":return new M.a(86,71,1,1);case "Cross":return new M.a(130,72,1,1);case "Plaque":return new M.a(33,73,1,1);case "Can":return new M.a(73,7,1.33,1);case "Cube":return new M.a(72,8,1.33,1.33);case "Bevel":return new M.a(82,74,1.14,1.14);case "Donut":return new M.a(41,75,1,
1);case "NoSymbol":return new M.a(42,76,1,1);case "BlockArc":return new M.a(40,77,1,1);case "FoldedCorner":return new M.a(81,78,1,1);case "SmileyFace":return new M.a(78,79,1,1);case "Heart":return new M.a(75,18,1,1);case "LightningBolt":return new M.a(74,80,1,1);case "Sun":return new M.a(76,81,1,1);case "Moon":return new M.a(77,82,1,.5);case "Cloud":return new M.a(120,83,1,1);case "Arc":return new M.a(88,84,1,1);case "DoubleBracket":return new M.a(93,85,1,1);case "DoubleBrace":return new M.a(94,86,
1,1.17);case "LeftBracket":return new M.a(89,87,1,.08);case "RightBracket":return new M.a(90,88,1,.08);case "LeftBrace":return new M.a(91,89,1,.17);case "RightBrace":return new M.a(92,90,1,.17);case "MathPlus":return new M.a(175,19,1,1);case "MathMinus":return new M.a(176,20,1,1);case "MathMultiply":return new M.a(177,21,1,1);case "MathDivide":return new M.a(178,22,1,1);case "MathEqual":return new M.a(179,23,1,1);case "MathNotEqual":return new M.a(180,24,1,1);case "StraightConnector":return new M.a(95,
12,1,1);case "StraightConnectorArrow":return new M.a(95,13,1,1);case "StraightConnectorTwoArrow":return new M.a(95,14,1,1);case "ElbowConnector":return new M.a(97,26,1,1);case "ElbowArrowConnector":return new M.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new M.a(97,156,1,1);case "CurvedConnector":return new M.a(101,25,1,1);case "CurvedArrowConnector":return new M.a(101,153,1,1);case "CurvedDoubleArrowConnector":return new M.a(101,154,1,1);case "DownArrow":return new M.a(46,0,1.07,.53);case "LeftArrow":return new M.a(44,
1,.53,1.07);case "LeftRightArrow":return new M.a(50,2,.53,1.33);case "RightArrow":return new M.a(43,3,.53,1.07);case "UpArrow":return new M.a(45,4,1.07,.53);case "UpDownArrow":return new M.a(51,5,1.33,.53);case "LeftRightUpArrow":return new M.a(53,27,.93,1.33);case "BentArrow":return new M.a(62,28,.95,.89);case "UTurnArrow":return new M.a(63,29,.96,.97);case "LeftUpArrow":return new M.a(52,30,.93,.93);case "BentUpArrow":return new M.a(49,31,.8,.93);case "CurvedRightArrow":return new M.a(67,32,1.33,
.8);case "CurvedLeftArrow":return new M.a(68,33,1.33,.8);case "CurvedUpArrow":return new M.a(69,34,.8,1.33);case "CurvedDownArrow":return new M.a(70,46,.8,1.33);case "StripedRightArrow":return new M.a(47,35,.53,1.07);case "NotchedRightArrow":return new M.a(48,36,.53,1.07);case "Pentagon":return new M.a(36,37,.53,1.07);case "Chevron":return new M.a(37,38,.53,.53);case "RightArrowCallout":return new M.a(56,39,1,1);case "DownArrowCallout":return new M.a(58,40,1,1);case "LeftArrowCallout":return new M.a(55,
41,1,1);case "UpArrowCallout":return new M.a(57,42,1,1);case "LeftRightArrowCallout":return new M.a(59,43,.63,1.33);case "QuadArrowCallout":return new M.a(61,44,1.33,1.33);case "CircularArrow":return new M.a(64,45,1.07,1.07);case "QuadArrow":return new M.a(54,47,1.33,1.33);case "Rectangle":return new M.a(4,10,1,1);case "RoundedRectangle":return new M.a(25,11,1,1);case "RoundDiagonalCornerRectangle":return new M.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new M.a(27,49,1,1);case "RoundSingleCornerRectangle":return new M.a(26,
50,1,1);case "SnipRoundSingleCornerRectangle":return new M.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new M.a(32,52,1,1);case "SnipSameSideCornerRectangle":return new M.a(31,53,1,1);case "SnipSingleCornerRectangle":return new M.a(30,54,1,1);case "RectangularCallout":return new M.a(116,91,.67,1);case "RoundedRectangleCallout":return new M.a(117,6,.67,1);case "OvalCallout":return new M.a(118,92,.67,1);case "CloudCallout":return new M.a(119,93,.67,1);case "LineCallout1":return new M.a(104,
94,.67,1);case "LineCallout2":return new M.a(105,95,.67,1);case "LineCallout3":return new M.a(106,96,.67,1);case "LineCallout1Accent":return new M.a(107,97,.67,1);case "LineCallout2Accent":return new M.a(108,98,.67,1);case "LineCallout3Accent":return new M.a(109,99,.67,1);case "LineCallout1BorderAccent":return new M.a(110,100,.67,1);case "LineCallout2BorderAccent":return new M.a(111,101,.67,1);case "LineCallout3BorderAccent":return new M.a(112,102,.67,1);case "LineCallout1NoBorder":return new M.a(113,
103,.67,1);case "LineCallout2NoBorder":return new M.a(114,104,.67,1);case "LineCallout3NoBorder":return new M.a(115,105,.67,1);case "Explosion1":return new M.a(79,106,1,1);case "Explosion2":return new M.a(80,107,1,1);case "Star4":return new M.a(15,108,1,1);case "Star5":return new M.a(16,15,1,1);case "Star6":return new M.a(17,109,1,1);case "Star7":return new M.a(18,110,1,1);case "Star8":return new M.a(19,111,1,1);case "Star10":return new M.a(20,112,1,1);case "Star12":return new M.a(21,113,1,1);case "Star16":return new M.a(22,
114,1,1);case "Star24":return new M.a(23,115,1,1);case "Star32":return new M.a(24,116,1,1);case "UpRibbon":return new M.a(122,117,.67,1.33);case "DownRibbon":return new M.a(121,118,.67,1.33);case "CurvedUpRibbon":return new M.a(124,119,.83,1.33);case "CurvedDownRibbon":return new M.a(123,120,.83,1.33);case "VerticalScroll":return new M.a(126,121,1.25,1.13);case "HorizontalScroll":return new M.a(127,122,1.13,1.25);case "Wave":return new M.a(128,123,1,1);case "DoubleWave":return new M.a(129,124,1,1);
case "Process":return new M.a(131,125,.67,1);case "AlternateProcess":return new M.a(158,126,.67,1);case "Decision":return new M.a(132,127,.67,1);case "Data":return new M.a(133,128,.67,1);case "PredefinedProcess":return new M.a(134,129,.67,1);case "InternalStorage":return new M.a(135,130,.67,.67);case "Document":return new M.a(136,131,.67,1);case "Multidocument":return new M.a(137,132,.83,1.16);case "Terminator":return new M.a(138,133,.33,1);case "Preparation":return new M.a(139,134,.67,1.16);case "ManualInput":return new M.a(140,
135,.5,1);case "ManualOperation":return new M.a(141,136,.67,1);case "Connector":return new M.a(142,137,.5,.5);case "OffpageConnector":return new M.a(159,138,.67,.67);case "Card":return new M.a(143,139,.88,1);case "PunchedTape":return new M.a(144,140,.88,1);case "SummingJunction":return new M.a(145,141,.67,.67);case "Or":return new M.a(146,142,.67,.67);case "Collate":return new M.a(147,143,1,.5);case "Sort":return new M.a(148,144,1,.5);case "Extract":return new M.a(149,145,.75,.75);case "Merge":return new M.a(150,
146,.75,.75);case "StoredData":return new M.a(152,147,.67,1);case "Delay":return new M.a(157,148,.67,.67);case "SequentialActionStorage":return new M.a(153,149,.67,.67);case "MagneticDisk":return new M.a(154,150,.67,1);case "DirectAccessStorage":return new M.a(155,151,.75,1);case "Display":return new M.a(156,152,.67,1);default:return null}}}U.A1b=110;U.z1b=75;Object(K.a)(U,"ODSLShape",null,[509])},979:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.algnField=0;this.algnFieldSpecified=
!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(K.a)(h,"CT_LineProperties",null,[])},980:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.valField=0;this.valFieldSpecified=
!1}}Object(K.a)(h,"CT_PresetLineDashProperties",null,[])},981:function(K,S,d){d.d(S,"a",function(){return z});var h=d(134);K=d(0);var e=d(1253),r=d(281),m=d(696),n=d(340);class z{constructor(t,x,B,D){this.pU=t;this.pa=x;this.qf=B;this.Gt=D;this.select=({scope:w,index:J=-1})=>Object(h.a)(this,void 0,void 0,function*(){const F=[];var L=null!==w&&void 0!==w?w:"Selection";if("Selection"===L){const M=this.pa.Re();0<M.length&&F.push(...M);0!==F.length||w||(L="Presentation")}if("Presentation"===L&&this.Oc){L=
this.Oc.hO.presentation.slides;if(null===L)throw Error("Could not cast from ISlide to ISlide on presentation slides.");F.push(...L)}return-1!==J&&J<F.length?[F[J]]:F});this.format=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.Qae=w=>w?w.mj:this.Oc.hO.presentation.AY[0].Id;this.Ngj=w=>{const J=this.Oc.hO.presentation.AY;for(let F=0;F<J.length;F++)if(w===J[F].Id)return J[F].ContentMasters[0].Id;return 0};this.Ogj=(w,J)=>{const F=this.Oc.hO.presentation.AY.find(L=>
L.Id===J).ContentMasters.find(L=>L.Name===w);if(!F)throw Error("Could not find content master for layout "+w);return F.Id};this.insert=({slides:w,layout:J})=>Object(h.a)(this,void 0,void 0,function*(){if(!w)throw Error("Could not insert slide due to invalid preceding slides");if(!this.Oc)throw Error("Cannot insert slides without appForOfficeManager instance.");const F=[];for(var L of w){var M=this.Qae(L);const Q=J?this.Ogj(J,M):this.Ngj(M);M=this.Oc.hO.presentation.L_b(L,null,M,Q);F.push(Object(e.a)(r.a,
M))}L=[];for(const Q of F)L.push(new Promise(C=>n.a.r9(C,Q).bind(this)));return Promise.all(L)});this.delete=({slides:w})=>Object(h.a)(this,void 0,void 0,function*(){if(!w)throw Error.argumentNull("slides");if(!this.Oc)throw Error("Cannot delete slides without appForOfficeManager instance.");for(const J of w){const F=J;F&&!this.qf.fd(F)&&F.isConnected&&(this.pa.nh(),this.Oc.hO.presentation.TI(F),this.Gt.jpd(new m.a([F])))}return new Promise(J=>n.a.r9(J,this.Oc.hO.presentation).bind(this))});if(!t)throw Error.argumentNull("m_appForOfficeManagerFuture");
if(!x)throw Error.argumentNull("m_selectionManager");if(!B)throw Error.argumentNull("m_actionBlockingManager");if(!D)throw Error.argumentNull("m_graphOperationEventNotifier");this.pU&&this.pU.execute(w=>{this.Oc=w})}}Object(K.a)(z,"ODSLSlide",null,[509])},982:function(K,S,d){d.d(S,"a",function(){return r});var h=d(134);K=d(0);var e=d(340);class r{constructor(m,n){this.pU=m;this.pa=n;this.select=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.format=()=>
Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.insert=({slides:z,imageData:t})=>Object(h.a)(this,void 0,void 0,function*(){if(!z)throw Error.argumentNull("slides");if(!t)throw Error("Could not get imageData in Base64.");if(!this.Oc)throw Error("Cannot insert images without appForOfficeManager instance.");this.V9j(t)&&(t=yield r.jej(t));const x=[];for(const B of z)this.pa.yP.apply(this.pa,B),this.Oc.au.BAh(t,!0,null,null,null,null,0,""),x.push(new Promise(D=>
e.a.r9(D,B).bind(this)));yield Promise.all(x)});this.delete=()=>Object(h.a)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});if(!m)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!n)throw Error.argumentNull("m_selectionManager");this.pU&&this.pU.execute(z=>{this.Oc=z})}static jej(m){return Object(h.a)(this,void 0,void 0,function*(){try{m.startsWith("//")&&(m="https:"+m);const n=yield fetch(m);if(n.ok){const z=yield n.arrayBuffer();return btoa((new Uint8Array(z)).reduce((t,
x)=>t+String.fromCharCode(x),""))}}catch(n){}return""})}V9j(m){try{return new URL(m),!0}catch(n){return!1}}}Object(K.a)(r,"ODSLImage",null,[509])},983:function(K,S,d){d.d(S,"a",function(){return x});var h=d(134);K=d(0);var e=d(1289),r=d(1290),m=d(40),n=d(28),z=d(53),t=d(984);d.n(t);class x{constructor(B,D,w,J,F,L,M,Q){this.pa=B;this.ua=D;this.Fb=w;this.twa=J;this.Xfb=F;this.gcd=L;this.wPg=M;this.uPg=Q;if(!this.pa)throw Error.argumentNull("m_selectionManager");if(!this.ua)throw Error.argumentNull("m_graphTopologyManager");
if(!this.Fb)throw Error.argumentNull("m_transactionFactory");if(!this.twa)throw Error.argumentNull("m_odslText");if(!this.Xfb)throw Error.argumentNull("m_odslShape");if(!this.gcd)throw Error.argumentNull("m_odslSlide");if(!this.wPg)throw Error.argumentNull("m_odslTable");if(!this.uPg)throw Error.argumentNull("m_odslImage");}Hsj(B){switch(B){case t.ActionRecommendationTrigger.TextSelection:case t.ActionRecommendationTrigger.TextBoxSelection:return this.Dyj();default:throw Error.argumentOutOfRange("trigger");
}}hpi(B){Object(h.a)(this,void 0,void 0,function*(){const D=JSON.parse(B),w=this.Fb.ke(15),J=D.scenario;try{if(!J)throw Error("No scenario provided in modelData");w.jc(this.ua.presentation);switch(J){case "textToTable":const F=Object.assign({},D);this.nLi(F);break;case "summarizeText":const L=Object.assign({},D);if(!L.summarizeText)throw Error("No summarizeText provided in modelData");this.lWd(J,L.summarizeText);break;case "rewriteText":const M=Object.assign({},D);if(!M.rewriteText)throw Error("No rewriteText provided in modelData");
this.lWd(J,M.rewriteText);break;case "continueText":const Q=Object.assign({},D);if(!Q.continueText)throw Error("No continueText provided in modelData");this.lWd(J,Q.newWholeText);break;case "slideGeneration":const C=Object.assign({},D);this.bpi(C);break;default:throw Error.argumentOutOfRange("scenario");}}catch(F){n.a.J(509085824,e.a.msoulscat_Uci_SmartLookupClient,r.a.warning,`SmartRecommendation: Exception thrown while applying recommendation. ${F}`)}finally{w&&w.dispose()}})}Dyj(){const B=this.pa.Ud().map(J=>
J.vy().map(F=>F.characterData).join("\n")).join("\n");let D="";const w=this.pa.Pa.nb;w&&(D=w.toArray().filter(J=>J.contextId===m.a.textRange).map(J=>J.node.characterData.substring(J.CQa,J.Isb)).join("\n"));return JSON.stringify({shapeText:B,selectedText:D})}nLi(B){Object(h.a)(this,void 0,void 0,function*(){if(!B)throw Error.argumentNull("modelData");if(!B.transformedData)throw Error("No transformedData provided in modelData");if(B.usedData){var D=B.usedData.split("\n");for(var w of D)D=yield this.twa.select({text:w}),
yield this.twa.delete({textRanges:D})}else w=yield this.Xfb.select({}),yield this.Xfb.delete({shapes:w});w=yield this.gcd.select({});yield this.wPg.insert({slides:w,html:B.transformedData})})}lWd(B,D){Object(h.a)(this,void 0,void 0,function*(){if("summarizeText"===B||"rewriteText"===B)var w=yield this.twa.select({});else"continueText"===B&&(w=yield this.Xfb.select({}),w=yield this.twa.select({scope:w}));w=yield this.twa.delete({textRanges:w});w=yield this.twa.insert({precededBy:w,text:D});0<w.length&&
(w=w[w.length-1],this.pa.setSelection(z.SelectionFactory.Qg(w.node,w.Lb)))})}bpi(B){Object(h.a)(this,void 0,void 0,function*(){if(!B)throw Error.argumentNull("modelData");var D=yield this.gcd.select({});D=yield this.gcd.insert({slides:D,layout:"Two Content"});var w=D[0];this.pa.s9a();this.ua.Ba=w;B.title&&(w=yield this.Xfb.select({scope:D,index:0}),w=yield this.twa.select({scope:w}),yield this.twa.insert({precededBy:w,text:B.title}));if(B.text){w=yield this.Xfb.select({scope:D,index:1});const J=`<ul>${B.text.map(F=>
`<li>${F}</li>`).join("")}</ul>`;yield this.twa.cel(w[0],J)}B.image&&(w=(yield this.Xfb.select({scope:D,index:2}))[0],this.pa.setSelection(z.SelectionFactory.rl(w)),yield this.uPg.insert({slides:D,imageData:B.image}))})}}Object(K.a)(x,"SmartRecommendations",null,[])},984:function(K,S,d){var h=this&&this.Dcf||(Object.create?function(r,m,n,z){void 0===z&&(z=n);var t=Object.getOwnPropertyDescriptor(m,n);if(!t||("get"in t?!m.Pba:t.writable||t.configurable))t={enumerable:!0,get:function(){return m[n]}};
Object.defineProperty(r,z,t)}:function(r,m,n,z){void 0===z&&(z=n);r[z]=m[n]}),e=this&&this.__exportStar||function(r,m){for(var n in r)"default"===n||Object.prototype.hasOwnProperty.call(m,n)||h(m,r,n)};Object.defineProperty(S,"__esModule",{value:!0});e(d(1166),S);e(d(1167),S);e(d(1168),S);e(d(1169),S)},985:function(K,S,d){d.d(S,"f",function(){return e});d.d(S,"e",function(){return r});d.d(S,"i",function(){return m});d.d(S,"j",function(){return n});d.d(S,"a",function(){return z});d.d(S,"h",function(){return t});
d.d(S,"m",function(){return x});d.d(S,"n",function(){return B});d.d(S,"b",function(){return D});d.d(S,"k",function(){return w});d.d(S,"d",function(){return J});d.d(S,"o",function(){return F});d.d(S,"c",function(){return L});d.d(S,"g",function(){return M});d.d(S,"l",function(){return Q});var h=d(336);class e{constructor(C){h.a.assign(e,this,C)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(C){return h.a.matchesTypesFor(C,[e.getTypeName()])}}e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};class r{constructor(C){h.a.assign(r,this,C)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(C){return h.a.matchesTypesFor(C,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class m{constructor(C){h.a.assign(m,this,C)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(C){return h.a.matchesTypesFor(C,[m.getTypeName()])}}
m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class n{constructor(C){h.a.assign(n,this,C)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class z{constructor(C){h.a.assign(z,this,C)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class t{constructor(C){h.a.assign(t,this,C)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[t.getTypeName()])}}t.H_={T_:t.getTypeName(),B_:t.getBaseTypes()};class x{constructor(C){h.a.assign(x,this,C)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,
[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class B{constructor(C){h.a.assign(B,this,C)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(C){h.a.assign(D,this,C)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,
[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class w{constructor(C){h.a.assign(w,this,C)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class J{constructor(C){h.a.assign(J,this,C)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,
[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class F{constructor(C){h.a.assign(F,this,C)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class L{constructor(C){h.a.assign(L,this,C)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,
[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class M{constructor(C){h.a.assign(M,this,C)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class Q{constructor(C){h.a.assign(Q,this,C)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(C){return h.a.matchesTypesFor(C,
[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()}},986:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e){this.muk=e}get wuc(){return this.muk}}Object(K.a)(h,"ShowHideNotesData",null,[])},987:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);d=d(912);class h extends d.a{constructor(e,r){super(r);this.cPg=e;this.Dfb=0}L0f(){const e=(new Date).getTime(),r=e-this.Dfb;if(0<this.Dfb&&0>=this.cPg-r)return this.Dfb=0,this.pZd(),!0;this.Dfb=e;this.pZd();this.setTimeout(this.cPg);
return!1}}Object(K.a)(h,"FunctionDelayer",d.a,[])},988:function(K,S,d){d.d(S,"b",function(){return e});d.d(S,"a",function(){return r});d.d(S,"c",function(){return m});var h=d(47);d(408);d(29);d(61);const e=(n,z)=>{const t=[];if(n.length!==z.length)return t;for(let x=0;x<n.length;x++){const B={};B.key=z[x];B.text=n[x];B.type="AppComboBoxItem";t[x]=B}return t},r=(n,z,t,x,B)=>({["unitType"]:n,["unitPlaceholder"]:h.a.OQe(z),["minValue"]:t,["maxValue"]:x,["step"]:B}),m=n=>"1.00"===n?1:"1.50"===n?1.5:"2.00"===
n?2:0},989:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{static add(e,r,m,n,z){h.sAg[h.s5f(e,r,m,n,z)]=!0}static contains(e,r,m,n,z){return h.s5f(e,r,m,n,z)in h.sAg}static s5f(e,r,m,n,z){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),r,m.toLowerCase(),n.toLowerCase(),z.toLowerCase())}}h.sAg={};Object(K.a)(h,"AppsInsertedStorage",null,[])},990:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.taskPaneWidth="TaskPaneWidth";h.sourceLocationOverrideResourceId=
"SourceLocationOverrideResourceId";h.cB="TaskPaneTitle";h.nonPersistedSettings="NonPersistedSettings";h.onTaskPaneClose="OnTaskPaneClose";h.onExtensionLaunchCallback="OnExtensionLaunchCallback";h.n6="OnRenderedCallback";h.HQc="DialogIsModal";h.LQc="DialogShowTitleBar";h.dialogWidth="DialogWidth";h.dialogHeight="DialogHeight";h.dialogLeft="DialogLeft";h.K4b="DialogRight";h.dialogTop="DialogTop";h.I4b="DialogBottom";h.jka="DialogTitle";h.I4d="DialogParentId";Object(K.a)(h,"PropertyNames",null,[])},
991:function(K,S,d){d.d(S,"a",function(){return D});K=d(0);var h=d(106),e=d(1253),r=d(41),m=d(42),n=d(32),z=d(84),t=d(247),x=d(39),B=d(992);class D{static JMi(w,J,F){w=Object(e.a)(z.a,w.createInstance(1074135137));D.Ozf(w,J,F);return w}static Jdi(w,J){n.GraphIterator.pb(w).Gl(J,19)}static Ozf(w,J,F){w.setValue(m.a.JKc,0===J.targetType);w.setValue(m.a.qtb,J.solutionId);w.setValue(m.a.OKc,J.version);w.setValue(m.a.o0b,J.storeType);w.setValue(m.a.NKc,J.storeId);w.setValue(x.a.n0b,F.zOc(J.storeType));
J.assetId&&w.setValue(x.a.zVd,J.assetId);w.setValue(x.a.TCf,J.assetStoreId);void 0===J.isAddinCommands?w.setValue(x.a.isAddinCommands,!1):w.setValue(x.a.isAddinCommands,J.isAddinCommands);J.sharedRuntimeId&&-1!==J.backgroundState&&(w.setValue(x.a.Qtb,J.backgroundState),w.setValue(x.a.V7a,J.sharedRuntimeId));0===J.targetType&&(w.setValue(x.a.nr,!0),F=J.height?J.height:200,w.setValue(r.a.Ix,J.width?J.width:200),w.setValue(r.a.iD,F))}static pPh(w,J,F){const L=h.a.Vtc(F);B.b(J,Q=>{Q=Q.eb(m.a.LKc);return!!Q&&
!(Q in L)});B.a(J,(Q,C)=>{const O=C.eb(m.a.LKc);O&&O in L&&(D.sRl(C,L[O],Q),delete L[O])});const M=n.GraphIterator.pb(J);h.a.forEach(L,(Q,C)=>{M.Gl(D.KMi(w,Q,C),21)},null)}static KMi(w,J,F){w=Object(e.a)(z.a,w.createInstance(1074135139));w.setValue(m.a.LKc,J);w.setValue(m.a.MKc,F);return w}static sRl(w,J,F){w.setValue(m.a.MKc,J);F.sa(m.a.JKc,!0)?t.d(F,w,D.Jil):t.d(F,w,D.djl)}}D.Jil=[x.a.sid,x.a.cid,x.a.shapeId];D.djl=[m.a.qtb];Object(K.a)(D,"AppEditor",null,[])},992:function(K,S,d){d.d(S,"a",function(){return r});
d.d(S,"b",function(){return m});var h=d(32),e=d(993);const r=(n,z)=>{const t=new h.GraphIterator;t.set(n);let x=t.Db(21);for(;x;)e.a(x)&&z(n,x),x=t.Hf(21)},m=(n,z)=>{const t=new h.GraphIterator;t.set(n);let x=t.Db(21);for(;x&&x!==n;)x=e.a(x)&&z(x)?t.FSa(21):t.Pj(21)}},993:function(K,S,d){d.d(S,"b",function(){return e});d.d(S,"a",function(){return r});var h=d(42);const e=(m,n)=>{n[m.eb(h.a.LKc)]=m.eb(h.a.MKc)},r=m=>1074135139===m.Xe},994:function(K,S,d){d.d(S,"a",function(){return t});K=d(0);var h=
d(1261),e=d(1287),r=d(90),m=d(32),n=d(34),z=d(232);class t{constructor(x,B,D){this.pU=x;this.pa=B;this.Ga=D;if(!x)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!B)throw Error.argumentNull("m_selectionManager");if(!D)throw Error.argumentNull("m_shapeReader");this.pU&&this.pU.execute(w=>{this.Oc=w})}pyj(x){if(!x.hasText)return null;const B=this.Ga.Cbe(x).cache;let D;switch(B.iw){case 0:D="None";break;case 1:D="Single";break;case 2:D="Double";break;case 3:D="Heavy";break;case 4:D="Dotted";
break;case 5:D="DottedHeavy";break;case 6:D="Dash";break;case 7:D="DashHeavy";break;case 8:D="DashLong";break;case 9:D="DashLongHeavy";break;case 10:D="DotDash";break;case 11:D="DotDashHeavy";break;case 12:D="DotDotDash";break;case 13:D="DotDotDashHeavy";break;case 14:D="Wavy";break;case 15:D="WavyHeavy";break;case 16:D="WavyDouble";break;default:D="None"}var w=x.vy()[0],J=new m.GraphIterator;J.set(w);J.rc(11);J.Jg(11);J=(J=w.Vf.Hv(J))?1===J.listType:!1;switch(n.ParagraphReader.IL(w)){case 1:w="Left";
break;case 2:w="Center";break;case 3:w="Right";break;case 7:w="Distributed";break;case 6:w="Justify";break;default:w="Left"}return{text:x.p9(),color:r.a.fH(B.fontColor),bold:B.isBold,italic:B.isItalic,underline:D,fontName:B.BL,size:B.fontSize/2,bulleted:J,horizontalAlignment:w}}cvj(x,B){const D=x.get_shapeTypeString(),w=x.shapeName;var J=x.mC;const F=h.a.Pe(J._x,e.a.horizontal);J=h.a.Pe(J._y,e.a.vertical);var L=x.dS;const M=L.BottomRight.Y-L.TopLeft.Y;L=L.BottomRight.X-L.TopLeft.X;var Q=z.a.parse(x.Bpa);
const C=Q?Q.RGBColor:"";Q=Q?Q.Alpha:-1;let O;switch(x.WM){case 0:O="Dash";break;case 1:O="DashDot";break;case 2:O="DashDotDot";break;case 3:O="LongDash";break;case 4:O="LongDashDot";break;case 5:O="RoundDot";break;case 6:O="Solid";break;case 7:O="SquareDot";break;case 8:O="LongDashDotDot";break;case 9:O="SystemDash";break;case 10:O="SystemDot";break;case 11:O="SystemDashDot";break;default:O="None"}const U=x.outlineWidth;var T=z.a.parse(x.Pga);const ca=T?T.RGBColor:"";T=T?T.Alpha:-1;x=this.pyj(x);
return{index:B,textRange:x,type:D,name:w,left:F,top:J,height:M,width:L,lineColor:C,lineDashStyle:O,lineWeight:U,lineTransparency:Q,fillColor:ca,fillTransparency:T}}Zvj(x){const B={index:0,shapes:[]};x=x.yj();for(let D=0;D<x.length;D++)B.shapes.push(this.cvj(x[D],D));return B}zae(){if(!this.Oc)throw Error("Cannot create contextTree without valid AppForOfficeManager instance.");const x={slides:[],selectionNames:[]};x.slides.push(this.Zvj(this.Oc.hO.Ba));const B=this.pa.Ud();for(const D of B)x.selectionNames.push(D.shapeName);
return x}}Object(K.a)(t,"ODSLContext",null,[554])},995:function(K,S,d){d.d(S,"a",function(){return n});K=d(0);var h=d(47),e=d(94),r=d(28),m=d(33);class n{constructor(z){this.Qna=null;this.wic=0;this.vgc=z;switch(this.vgc){case "audio":this.Qna=n.Iwk;this.wic=n.Mik;break;case "captions":this.Qna=n.Jwk;this.wic=n.bjk;break;case "video":this.Qna=n.Kwk;this.wic=n.Swk;break;default:r.a.J(509727835,822,10,"Invalid file type")}}static set sXl(z){n.Kwk=z}static set nYl(z){n.Swk=z}fCi(z){switch(this.vgc){case "audio":return n.dCi(z);
case "captions":return n.eCi(z);case "video":return m.a("DisableVideoAsFileCheck")?new Promise(t=>{t(!0)}):n.gCi(z);default:return r.a.J(509727834,822,10,"Invalid file type"),new Promise(t=>{t(!1)})}}GXl(z){z=h.a.ug(z);for(let t=0;t<this.Qna.length;++t){const x=this.Qna[t];if(x&&0<x.length&&z.endsWith(x))return!0}return!1}HXl(z){return z<=1048576*this.wic}static dCi(z){return new Promise((t,x)=>{if(z&&z.size){var B=document.createElement("video"),D=URL.createObjectURL(z);B.setAttribute("src",D);e.a.addHandler(B,
"loadedmetadata",()=>{URL.revokeObjectURL(D);const w=B.videoHeight,J=B.videoWidth;0<B.duration&&!w&&!J?t(!0):(r.a.J(509727832,822,10,"Invalid audio File"),t(!1))});e.a.addHandler(B,"error",()=>{URL.revokeObjectURL(D);r.a.J(509727831,822,10,"Invalid audio File");x(ResourceStrings.L_InvalidAudioFileError)})}else r.a.J(509727833,822,10,"Empty media File"),t(!1)})}static eCi(z){return new Promise((t,x)=>{if(z&&z.size){var B=URL.createObjectURL(z),D=document.createElement("video"),w=document.createElement("track");
D.appendChild(w);e.a.addHandler(w,"load",()=>{URL.revokeObjectURL(B);t(!0)});e.a.addHandler(w,"error",()=>{URL.revokeObjectURL(B);r.a.J(509727829,822,10,"Invalid captions File");x(ResourceStrings.l_InvalidCaptionsFileError)});w.setAttribute("src",B);w.setAttribute("default","true")}else r.a.J(509727830,822,10,"Empty captions File"),t(!1)})}static gCi(z){return new Promise((t,x)=>{if(z&&z.size){var B=document.createElement("video"),D=URL.createObjectURL(z);B.setAttribute("src",D);e.a.addHandler(B,
"loadedmetadata",()=>{URL.revokeObjectURL(D);const w=B.videoHeight,J=B.videoWidth;0<B.duration&&0<w&&0<J?t(!0):(r.a.J(509727837,822,10,"Invalid video File"),t(!1))});e.a.addHandler(B,"error",()=>{URL.revokeObjectURL(D);r.a.J(509727836,822,10,"Invalid video File");x(ResourceStrings.L_InvalidVideoFileError)})}else r.a.J(509727838,822,10,"Empty media File"),t(!1)})}static hbe(z){if(!z||!z.value)return"Input file name is null";const t=z.value.lastIndexOf(".");return-1===t?"":z.value.substring(t+1,t+5)}}
n.Mik=16;n.bjk=16;n.Jwk=[".vtt"];n.Iwk=[".mp3",".wav",".m4a",".aac",".oga"];Object(K.a)(n,"MediaValidationHelper",null,[])},996:function(K,S,d){d.d(S,"a",function(){return h});const h=e=>{if((e=e.uc("AugLoopEndpointOverride",0))&&!(1>e))return{[1]:"https://augloop-test.officeppe.com",[2]:"https://augloop-int.officeppe.com",[3]:"https://augloop-dogfood.officeppe.com",[4]:"https://augloop.office.com",[5]:"http://localhost:20080"}[e]}},997:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.w0f=e}}Object(K.a)(h,"CommentContainersChangedEventArgs",Sys.EventArgs,[])},998:function(K,S,d){d.d(S,"a",function(){return x});K=d(0);var h=d(1253),e=d(7),r=d(93),m=d(37),n=d(28),z=d(701),t=d(124);class x{constructor(B,D,w,J,F,L){this.eNd=this.n8c=null;this.Ky=Object(h.a)(z.a,J.cSf(B,D,w,Object(e.a)(this,this.SM,"onPointerOver"),Object(e.a)(this,this.sG,"onPointerOut"),F));this.xcd=0;this.Mc=L;this.Mc.GC(Object(e.a)(this,this.UE,"onSessionEnd"));this.clear()}dispose(){this.Ky.dispose();this.n8c=
null}get N_a(){return this.eNd}setZIndex(B){this.Ky.setZIndex(B)}vgi(B,D,w){this.eNd=B;this.n8c=D;this.Ky.lzh("UnreadNotification_16x16x32",this.N_a,w)}clear(){this.Ky.clear();this.eNd=t.a.none}V1a(){this.jea();this.Ky.I_b(this.N_a,this.m5d);this.Ky.aKe()}jea(){this.Ky.h_d();this.Ky.PYe()}UE(){n.a.J(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.xcd);0<this.xcd&&r.c(m.a.FKf)}get m5d(){return this.n8c?this.n8c():""}SM(){this.V1a();n.a.J(23606147,804,50,"Shape revision tracking pawn hovered");
this.xcd+=1;return!0}sG(){this.jea();return!0}}Object(K.a)(x,"ShapeRevisionTrackingPawn",null,[205])},999:function(K,S,d){d.d(S,"a",function(){return e});K=d(0);var h=d(68);class e{constructor(r){this.yEb=this.Igc=null;this.af=r}dispose(){this.clear();this.Igc.parentNode.removeChild(this.Igc)}vRa(r){this.Igc=this.BQf(r,"prContainerHr");this.yEb=this.BQf(this.Igc,"prGlyph")}clear(){this.D0a()}OLa(r,m){r&&(this.D0a(),this.yEb.appendChild(r),this.yEb.style.backgroundColor=m,this.Igc.style.visibility=
h.a.visible)}BQf(r,m){const n=this.af.ee();this.af.addCssClass(n,m);r.appendChild(n);return n}D0a(){this.yEb.firstChild&&this.yEb.removeChild(this.yEb.firstChild)}}Object(K.a)(e,"ShapePawnGlyph",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.ext.js.map