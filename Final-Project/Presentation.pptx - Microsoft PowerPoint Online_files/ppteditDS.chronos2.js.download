'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1004:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static c6f(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";
default:return"external"}}}Object(K.a)(h,"WopiAuthContext",null,[1166])},1025:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r,m=null){super();this.shapeId=e;this.Xkg=r;this.qZ=m}}Object(K.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},1026:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h extends Sys.EventArgs{constructor(e,r=null){super();this.shapeId=e;this.qZ=r}}Object(K.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",
Sys.EventArgs,[])},1027:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.VKc=null}}Object(K.a)(h,"IdeasSmartArtSuggestionWrapper",null,[])},1295:function(K,S,d){function h(u){for(const P of[ResourceStrings.L_ImageDescriptionWithVeryHighConfidence,ResourceStrings.L_ImageDescriptionWithHighConfidence,ResourceStrings.L_ImageDescriptionWithMediumConfidence,ResourceStrings.L_ImageDescriptionWithLowConfidence,ResourceStrings.L_ImageDescriptionWithVeryLowConfidence])if(u.endsWith(P))return[!0,
u.length-P.length];return[!1,-1]}function e(u,P,la){const Ca=new nd.a;Ca.xa.setAttributeNS(null,Ja.a.NI,Ja.a.rB);Ca.ah(P,la);Ca.ypa("0,0,2048,2048");P=new Pb.a;P.dZ(u);Ca.appendChild(P);return Ca}d.r(S);var r=d(0),m=d(71),n=d(395),z=d(7),t=d(27),x=d(205),B=d(146),D;(function(u){u[u.error=0]="error";u[u.warning=1]="warning";u[u.tip=2]="tip";u[u.intelligentService=3]="intelligentService"})(D||(D={}));Object(r.b)("AccessibilityRuleCategory",D);var w=d(55),J=d(73),F=d(37),L=d(110),M=d(177),Q=d(109);class C{constructor(u,
P,la=null){this.vBd=null;this.Klf=this.glf=!1;this.oCa=u;this.Lyc=P;this.Ca=la;this.un.ya(F.a.cFi,J.a.frame,Object(z.a)(this,this.eH,"closePane"))}get un(){return this.Ca||(this.Ca=t.AFrameworkApplication.Qa)}set un(u){this.Ca=u}G1i(){this.glf||(this.oCa.initialize(this),this.Lyc.initialize(this),this.glf=!0)}SMe(){Q.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.Lyc.iil()}kl(u,P,la){if(1===la)return x.SessionStatusManager.instance.jla?8:32;this.oCa.isVisible||this.G1i();this.tBl();return 32}eH(u,
P,la){1!==la&&this.oCa.Kq();return 32}zOe(){this.oCa.NEh(!0)}l5d(u){if(u){if(u.AccessibilityRules&&Object.keys(u.AccessibilityRules).length){const la=u.AccessibilityRules;for(let Ca in la){var P=Ca;const Ta=la[Ca].RuleId+"";P!==Ta&&Q.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",P,Ta)}this.vBd=la}else!this.vBd&&u.Results&&0<u.Results.length?(Q.c(18993251,200,15,"No accessibility rule definitions available"),u.IsSuccess=!1):u.AccessibilityRules=this.vBd;
u.IsSuccess||Q.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.N$k(u);this.Kgk(u);this.oCa.l5d(u)}}N$k(u){const P=u.AccessibilityRules;if(u=u.Results)for(let la=u.length-1;0<=la;la--){const Ca=u[la];let Ta="";const pb=Ca.RuleId;Ca.ContentName||(Ta+="Result does not have content name. ");pb in P||(Ta+=String.format("No accessibility check rule exists for ID {0}.",pb));0<Ta.length&&(Q.c(36214999,200,15,"Omitting invalid accessibility check result: "+Ta),Array.removeAt(u,la))}}euj(){return t.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("accessibility-checker-pane-strings"):w.a.instance.resolve("Common.IDynamicScriptLoaderProvider").xI.loadScript("accessibility-checker-pane-strings")}tBl(){this.Klf?this.oCa.kl():this.euj().then(()=>{this.Klf=!0;this.oCa.kl()}).catch(u=>n.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",u))}Kgk(u){var P={};const la={};var Ca=u.Results,Ta=[];Array.add(Ta,Object.assign(new L.a,{name:"FinalViolationCount",int64:0}));
Array.add(Ta,Object.assign(new L.a,{name:"FinalErrorCount",string:"0"}));Array.add(Ta,Object.assign(new L.a,{name:"FinalWarningCount",string:"0"}));Array.add(Ta,Object.assign(new L.a,{name:"FinalTipCount",string:"0"}));Array.add(Ta,Object.assign(new L.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Ca){for(const Cc of Ca)if(u.AccessibilityRules){var pb=u.AccessibilityRules[Cc.RuleId];if(pb){if(P[D[pb.Category]]){let ed=P[D[pb.Category]];P[D[pb.Category]]=++ed}else P[D[pb.Category]]=1;la[Cc.RuleId]?
(pb=la[Cc.RuleId],la[Cc.RuleId]=++pb):la[Cc.RuleId]=1}}Ta[0].int64=Ca.length;for(var Sb in P)switch(u=P[Sb],Ca=Sb,Ca="Final"+Ca.charAt(0).toUpperCase()+Ca.substring(1,Ca.length)+"Count",Ca){case "FinalErrorCount":Ta[1].string=u.toString();break;case "FinalWarningCount":Ta[2].string=u.toString();break;case "FinalTipCount":Ta[3].string=u.toString();break;case "FinalIntelligentServiceCount":Ta[4].string=u.toString()}}B.a.sendTelemetryEvent(Object.assign(new M.a,{name:String.format("{0}.{1}","Office.UX.AccChecker",
"AccCheckerViolationInformation"),dataFields:Ta}));for(let Cc in la)P=Cc,Ta=la[Cc],Sb=[],Array.add(Sb,Object.assign(new L.a,{name:"RuleID",string:P})),Array.add(Sb,Object.assign(new L.a,{name:"FinalViolationCount",string:Ta.toString()})),B.a.sendTelemetryEvent(Object.assign(new M.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Sb}))}dispose(){this.oCa&&this.oCa.dispose();this.Lyc&&this.Lyc.dispose()}}Object(r.a)(C,"AAccessibilityCheckManager",
null,[190,108]);var O=d(82),U=d(1253),T=d(58),ca=d(293),N=d(28);class da extends C{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed){super(u,P);this.Ggb=this.CIa=null;this.Fa=la;this.wb=Ca;this.Vq=Ta;this.E5=pb;this.ua=Sb;this.pa=Cc;this.Sb=ed;this.xHe=!1}Dpl(u){if(!u)return N.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(u.sldIdField){var P=new T.a(Object.assign(new ca.a,{Sid:u.sldIdField.sidField,Cid:u.sldIdField.cidField}));P=this.Sb.Yka(P);if(!P)return!1;let la=null;if(u.spIdFieldSpecified&&
(la=P.WC(u.spIdField),!la&&this.xHe))return!1;this.lll(P,la)}else N.a.J(19227929,334,15,"There is no slide id info in violation data");return!0}SMe(){this.xHe=!1;super.SMe()}zOe(){this.xHe=!0;super.zOe()}lll(u,P){if(u){const la=this.ua.Ba!==u?!0:!1;P&&(this.Ggb=P,la?this.Vq.eT(Object(z.a)(this,this.aJb,"onActiveSlideDomChanged")):this.uxh());la&&(this.E5.Ba=u);this.pa.iu();this.Fa.Bd()}}aJb(){this.Vq.Voa(Object(z.a)(this,this.aJb,"onActiveSlideDomChanged"));this.CIa||(this.CIa=new O.a(2,1,0,Object(z.a)(this,
this.sOe,"onPostActiveSlideDomChangedTask"),90,"20"),this.wb.Hb(this.CIa))}sOe(){this.CIa=null;this.uxh()}Bd(){this.E5.jL.yp||this.Fa.Bd()}uxh(){if(this.Ggb){const u=Object(U.a)(117,this.Ggb.rg(this.E5.jL.Na));u?u.Ml?N.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.Ggb.id):u.iq?u.yvd():this.pa.selectShape(this.Ggb,!0):N.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.Ggb.id);this.Bd();this.Ggb=null}}}Object(r.a)(da,"PptAccCheckManager",
C,[]);class Y{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(u){u=Sys.Serialization.JavaScriptSerializer.deserialize(u);const P=u.AccessibilityRules,la={};if(P)for(let Ca=0;Ca<P.length;++Ca){const Ta=P[Ca];la[Ta.Key]=Ta.Value}u.AccessibilityRules=la;return u}}Object(r.a)(Y,"AccessibilityCheckResultCollection",null,[]);class fa{}Object(r.a)(fa,"AccessibilityCheckResult",null,[]);class aa{}Object(r.a)(aa,"AccessibilityCheckRule",
null,[]);class ka{constructor(u){this.ENa=null;this.Xif=u}get fileId(){return this.Xif?this.Xif():null}initialize(u){this.ENa=u}H$g(u){this.ENa.l5d(u)}}Object(r.a)(ka,"AAccessibilityCheckService",null,[200,108]);var H=d(18),ra=d(111);class ha extends ra.a{constructor(){super()}ul(){return 56}}Object(r.a)(ha,"AccCheckRequest",ra.a,[]);var Ma=d(246);class Ga extends ka{constructor(u,P){super(null);this.ei=u;this.QYa=P}iil(){const u=new Ma.a(new ha,Object(z.a)(this,this.hEk,"onAccCheckSucceed"),Object(z.a)(this,
this.gEk,"onAccCheckFailed"));this.ei.Hb(u)}dispose(){}get JVj(){return 0<this.QYa.r_b.length}hEk(u){if(u&&u.ACResult&&(u=this.aui(u.ACResult))){this.H$g(u);N.a.J(19227935,334,50,"Acc-check succeeded");return}this.X4g("Succeeded but response is invalid")}gEk(u){this.X4g(u.toString());return!0}X4g(u){N.a.J(19227937,334,50,String.format("Acc-check failed: {0}",u));u=new Y;u.IsSuccess=!1;this.H$g(u)}aui(u){if(u){var P=null;try{P=JSON.parse(u)}catch(la){return N.a.J(19227939,334,10,"Cannot parse acc-check result json: {0}",
la.toString()),null}if(P){u=new Y;u.IsSuccess=!0;u.IsPartialResult=P.isPartialResultField;u.AccessibilityRules={};if(P.violatedRulesField){const la=new H.a;for(const Ca of P.violatedRulesField)if(P=this.cui(Ca)){u.AccessibilityRules[P.RuleId]=P;for(const Ta of Ca.violationsField){const pb=new fa;pb.RuleId=P.RuleId;pb.ContentName=Ta.labelField;pb.ContentId=Ta;la.add(pb)}}u.Results=la.toArray()}return u}}return null}cui(u){if(!u)return null;if(u.ruleIdField>=this.QYa.r_b.length)return N.a.J(19227971,
334,10,"Rule id {0} is bigger than total rule info list count {1}",u.ruleIdField,this.QYa.r_b.length),null;const P=new aa;P.RuleId=u.ruleIdField.toString();P.RuleName=this.QYa.r_b[u.ruleIdField].ruleTextField;switch(this.QYa.r_b[u.ruleIdField].ruleTypeField){case 0:P.Category=0;break;case 1:P.Category=1;break;case 2:P.Category=2;break;case 3:P.Category=3}return P}}Object(r.a)(Ga,"PptAccCheckService",ka,[1112,200,108]);class na{get vKi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get wKi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get xKi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get MOk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Jld(){return CommonUIStrings.l_AccCheckerPaneTitle}get yRk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(r.a)(na,"AccessibilityCheckStringsProvider",null,[201]);class wa{constructor(){this.svh=this.contentId=null}}Object(r.a)(wa,"ResultIds",null,[]);var Fa=d(67),pa=d(176);class Ea{constructor(u,P){this._element=null;this.yq=P;this.Wg=u}get element(){this._element||(this._element=this.S1d(),this.Jt());return this._element}Jlb(u){this._element=u}dispose(){this.element&&(this.Ypa(),this.Jlb(null))}Jt(){this.yq&&this.Wg?(this.yq.ub(Fa.a.click,this.element,Object(z.a)(this,this.onClick,"onClick")),
this.Wg.ub(Fa.a.Df,this.element,Object(z.a)(this,this.Ebh,"onKeyPress"))):n.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Ypa(){this.yq&&this.Wg&&(this.yq.Bb(Fa.a.click,this.element,Object(z.a)(this,this.onClick,"onClick")),this.Wg.Bb(Fa.a.Df,this.element,Object(z.a)(this,this.Ebh,"onKeyPress")))}onClick(){this.Abh();return!0}Ebh(u){return this.O1j(u.nc.keyCode)?(this.Abh(),!0):!1}O1j(u){return u===
pa.a.ORb||u===pa.a.jp}}Object(r.a)(Ea,"AInteractivePaneElement",null,[323,108]);const ta=(u,P,la)=>{u=document.createElement(u);P&&(u.id=P);la&&(u.className=la);u.setAttribute("Unselectable","on");return u};var ia=d(79),Ja=d(141),ab=d(99);class Oa extends Ea{constructor(u,P,la){super(u,P);this.l6h=la}hide(){this.element.removeAttribute(Ja.a.hf);Ja.a.gS(this.element,Ja.a.NI,Ja.a.rB);this.element.style.display="none"}show(){Ja.a.gS(this.element,Ja.a.NI,Ja.a.qja);Ja.a.gS(this.element,Ja.a.hf,Ja.a.CWd);
this.element.style.display="block"}S1d(){const u=ta("div",this.B8g,"AccCheckerNotification");Ja.a.gS(u,Ja.a.DWd,Ja.a.rB);Ja.a.gS(u,Ja.a.t_,this.KLe);u.tabIndex=0;const P=ta("span",this.A8g,"AccCheckerNotificationIcon");var la=ia.createClusteredImage(16,16,"Info_16x16x32","",!0,"");P.appendChild(la);la=ta("span",this.KLe,"AccCheckerNotificationText");ab.a.Rz(la,this.C8g);u.appendChild(P);u.appendChild(la);return u}Abh(){this.l6h()}}Object(r.a)(Oa,"APopupNotification",Ea,[322,323,108]);class Za extends Oa{constructor(u,
P,la,Ca){super(u,P,la);this.Gca=Ca}get B8g(){return"AccCheckerOutOfSyncNotificationId"}get A8g(){return"AccCheckerOutOfSyncNotificationIconId"}get KLe(){return"AccCheckerOutOfSyncNotificationTextId"}get C8g(){return this.Gca.MOk}}Object(r.a)(Za,"OutOfSyncNotification",Oa,[]);class Na extends Oa{constructor(u,P,la,Ca){super(u,P,la);this.Gca=Ca}get B8g(){return"AccCheckerPartialResultNotificationId"}get A8g(){return"AccCheckerPartialResultNotificationIconId"}get KLe(){return"AccCheckerPartialResultNotificationTextId"}get C8g(){return this.Gca.yRk}}
Object(r.a)(Na,"PartialResultNotification",Oa,[]);var sa=d(120),Sa=d(107);class xb{constructor(u,P,la,Ca=null,Ta=null,pb=null,Sb=null){this.otf=this.d8=this.Wg=this.ENa=null;this.hdb=Ca;this.yq=u;this.Pd=P;this.QK=la;this.Gca=Sb||new na;this.FMd=Ta||new Za(this.hdb,this.yq,Object(z.a)(this,this.GXi,"dimissOutOfSyncNotification"),this.Gca);this.VMd=pb||new Na(this.hdb,this.yq,Object(z.a)(this,this.HXi,"dimissPartialResultNotification"),this.Gca)}show(){}hide(){}get hdb(){return this.Wg||(this.Wg=t.AFrameworkApplication.Aa.DG)}set hdb(u){this.Wg=
u}HQf(){}Kq(){}dispose(){}TOh(){}ptd(){}rVj(u){var P=this.otf[u];u=P.contentId;if((P=P.svh+"")&&P.length){const la=[];Array.add(la,Object.assign(new L.a,{name:"RuleID",string:P}));B.a.sendTelemetryEvent(Object.assign(new M.a,{name:String.format("{0}.{1}",xb.p7e,"ViolationSelected"),dataFields:la}))}this.GBk(u)}GBk(u){u&&this.ENa.Dpl(u)||(this.Pd.cV(sa.AFrame.nW,!1),this.Yzl())}GXi(){this.NEh(!1);this.ptd()}HXi(){this.PEh(!1);this.ptd()}Yzl(){const u=Object.assign(new Sa.StandardDialog(!0),{Mr:t.AFrameworkApplication.uea,
Ad:1,Y1a:!1});u.cza(1);u.Le(1,this.Gca.vKi);u.Le(0,CommonUIStrings.l_DialogCancel);u.zP(this.Gca.xKi,this.Gca.wKi,P=>{1===P&&this.vne()})}Jvi(u){let P=null;if(u.Results&&0<u.Results.length){P={};let la=0;for(const Ca of u.Results)Ca.ResultId=xb.Qci+ ++la,u=new wa,u.contentId=Ca.ContentId,u.svh=Ca.RuleId,P[Ca.ResultId]=u}return P}Sgk(){B.a.addNamespaceMapping(xb.p7e,xb.AJl);B.a.sendTelemetryEvent(Object.assign(new M.a,{name:String.format("{0}.{1}",xb.p7e,"ShowTaskpane")}))}}xb.Qci="AccCheckResult";
xb.p7e="Office.UX.AccChecker";xb.AJl="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(r.a)(xb,"BaseAccessibilityCheckPane",null,[202,108]);class gc{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(r.a)(gc,"AccCheckerTaskPaneProps",null,[]);
var zc=d(1209),Xb=d(280);class jb{constructor(){this.zzc=new H.a}bLa(u){this.zzc.add(u)}Yrl(u){for(let P of this.zzc)P(u)}}Object(r.a)(jb,"ReactTaskPaneManager",null,[255]);var zb=d(659),Tb=d(143);class Ya extends xb{constructor(u,P,la,Ca,Ta=null,pb=null,Sb,Cc=null,ed=null){super(P,la,Ca,pb,void 0,void 0,Cc);this.Gcf=null;this.Csf=this.UMd=this.hFc=this.FGc=this.rGc=!1;this.dSd=null;this.YQd=!!t.AFrameworkApplication.Aa&&!!t.AFrameworkApplication.Aa.mb&&t.AFrameworkApplication.Aa.mb.Nre;this.MUb=
this.iqa=null;this.kVb=0;this.kCc=null;this.qCd=Ta;ed&&(this.iqa=ed.cdi,this.MUb=ed.d9i,this.kVb=ed.gMj);this.jra=new jb}get isVisible(){return this.Csf}HOb(u){this.Csf=u}l5d(u){u&&(this.Gcf=u,u.IsSuccess&&(this.otf=this.Jvi(u),u.IsPartialResult&&this.PEh(!0)),this.rGc=!0,this.FGc=!1,this.Cxc())}NEh(u){this.isVisible&&u!==this.hFc&&(this.hFc=u,this.Cxc())}PEh(u){this.UMd=u;this.Cxc()}kl(){this.FGc||Tb.UISurfaces.Iq().then(u=>{Xb.a.instance.s3(Ya.w3a+":PaneOpen:Start");u.showTaskPane(Ya.w3a,this.rda());
this.vne();return null});this.isVisible?Tb.UISurfaces.Iq().then(u=>{u.setSelectedTaskPane(Ya.w3a);return null}):this.Sgk()}Cxc(){Tb.UISurfaces.Iq().then(u=>{u.updateTaskPane(Ya.w3a,this.rda());return null})}rda(){var u=new gc;this.jra.Yrl(u);u=Object.assign(new zb.a,{title:this.Gca.Jld,hideHeader:!1,width:320,location:2,contentProps:u,onOpen:()=>{this.Gpl();this.HOb(!0);t.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.vtd();this.HOb(!1);this.FGc=this.rGc=!1;this.Cxc();t.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.YQd&&(u.enableResize=!0,u.minResizeWidth=268,u.maxResizeWidth=920);return u}initialize(u){const P=this.Pd.Ic(Ya.w3a);P.parent=sa.AFrame.$i;P.zJ=!0;this.ENa=u;this.sdi()}dispose(){this.TOh();this.FMd&&(this.FMd.dispose(),this.FMd=null);this.VMd&&(this.VMd.dispose(),this.VMd=null);super.dispose()}sdi(){this.jra.bLa(this.onRecheckExecute());this.jra.bLa(this.Lcj());this.jra.bLa(this.mtj());this.jra.bLa(this.onInvokeNavigateExecute());this.jra.bLa(this.Flj());this.jra.bLa(this.Aqj());
this.jra.bLa(this.drj());this.jra.bLa(this.updateLastScanTime());this.jra.bLa(this.showHelpPane())}onRecheckExecute(){return u=>{u.onRecheckExecute=()=>{this.vne()}}}Lcj(){return u=>{u.accessibilityCheckResultCollection=this.Gcf}}mtj(){return u=>{u.resultsReady=this.rGc}}onInvokeNavigateExecute(){return u=>{u.onInvokeNavigateExecute=P=>{this.rVj(P)}}}Flj(){return u=>{u.helpLink=this.E4i}}Aqj(){return u=>{u.outOfSync=this.hFc}}drj(){return u=>{u.partialResult=this.UMd}}updateLastScanTime(){return u=>
{u.updateLastScanTime=P=>{this.dSd=P}}}showHelpPane(){return u=>{u.showHelpPane=()=>{t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?t.AFrameworkApplication.cta||this.LEf()?this.kCc?this.kCc():this.iqa.value&&this.MUb&&this.kVb&&this.iqa.value.Ja(this.kVb,2,this.MUb):this.AFh():this.LEf()?this.kCc?this.kCc():this.iqa.value&&this.MUb&&this.kVb&&this.iqa.value.Ja(this.kVb,2,this.MUb):this.AFh()}}}LEf(){return!this.qCd||
!this.qCd.value}AFh(){const u=this.qCd.value;if(u){var P={};P.query=Ya.c8h+Ya.gHd;P=Object.assign(new zc.a,{nonPersistedSettings:P});u.Sga(Ya.fHd,P)}}vne(){this.UMd=this.hFc=this.rGc=!1;this.dSd&&this.dSd();this.Cxc();this.FGc=!0;this.ENa.SMe()}Gpl(){this.Pd.wf(Ya.w3a)}vtd(){this.Mre()&&this.Pd.wf(this.Pd.M8)}Mre(){return!!this.Pd.Ee&&this.Pd.Ee.name===Ya.w3a}}Ya.w3a="AccessibilityCheckerPane";Ya.gHd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Ya.fHd="FA000000012";Ya.c8h="AssetID=";Object(r.a)(Ya,"ReactAccessibilityCheckPane",
xb,[]);class sb{constructor(u,P,la){this.cdi=u;this.d9i=P;this.gMj=la}}Object(r.a)(sb,"HelpPaneProperties",null,[]);var oc=d(93),wb=d(30);class rc extends Ya{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){super(null,P,la,Ca,void 0,null,void 0,void 0,new sb(Sb,rc.sbe(),wb.a.Sga));this.wjc=u;this.cik=Ta;this.uD=pb;this.kic=Sb;this.Vv=Cc}get isVisible(){return!!this.wjc&&this.wjc.isVisible}HOb(u){this.wjc&&(this.wjc.isVisible=u)}get E4i(){return this.cik}kl(){this.HOb(!0);this.uD.sK(this.wjc,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
sa.AFrame.nW);super.kl();if(this.kic){var u=this.kic.value;if(u){u.processAction(wb.a.PIc,1);u=!1;try{this.Vv.selectRibbonTabById("AccessibleAuthoring"),u=!0}catch(P){N.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",P.toString())}oc.a("AccessibleAuthoringTab",u)}else N.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else N.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}Mjd(){}onBeforeLoadContent(){}onAfterLoadContent(){this.ENa&&
this.ENa.zOe()}onAfterFirstSaveContent(){}static sbe(){const u={};u.cB=ResourceStrings.L_Help;u.assetId="FA000000012";u.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return u}}Object(r.a)(rc,"PptReactAccCheckControl",Ya,[494]);class Ka{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Xb(u){this.K=u;this.K.register(Ga,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").na().oa(()=>
new Ga(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(202,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").na().oa(()=>new rc(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.ue("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(190,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").na().oa(()=>new da(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){m.a.instance.Ac(new Ka)}}Object(r.a)(Ka,"PptAccessibilityPackage",null,[2,3]);var Db=d(182),bc=d(1258),Mc=d(251),mb=d(183),Wa=d(542),db=d(52),ub=d(125);class Lb{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed){this.ia=u;this.la=P;this.dik=la;this.eik=Ca;this.Hdb=Ta;this.Vv=Sb;this.QYa=pb;this.Fa=Cc;this.ic=ed;this.QYa.Qii(Object(z.a)(this,this.Loh,"refreshAccCheckButtonStatus"))}vb(){this.la.powerPointEnableAccCheck&&
(this.ia.ra(wb.a.mRe,db.a.application,Object(z.a)(this,this.zBi,"checkAccessibility"),4),this.ia.ra(wb.a.H_k,db.a.application,Object(z.a)(this,this.$Zk,"queryCheckAccessibility"),97))}me(){this.la.powerPointEnableAccCheck&&this.Fa.Ic(ub.a.hIf).bindAction(mb.KeyInputManager.Va(pa.a.Ayc,mb.KeyInputManager.Te|1),wb.a.mRe)}zBi(u,P,la,Ca,Ta){return 1===la?this.ic.rj()?this.eik.JVj?32:8:8:this.dik.kl(u,P,la,Ca,Ta)}$Zk(u,P,la,Ca,Ta){Ta[Wa.a.On]=this.Hdb.isVisible;return 32}dispose(){this.QYa.ibl(Object(z.a)(this,
this.Loh,"refreshAccCheckButtonStatus"))}Loh(){this.Vv.SA()}}Object(r.a)(Lb,"AccCheckActor",null,[268,108]);class Kb{constructor(){this.iec=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Xb(u){this.K=u}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").JAb(()=>{this.pAb()})}pAb(){const u=this.K.resolve("Common.AFrameworkApplication").hT.rd,P=this.K.resolve("Common.IActionManagerExtended");u.powerPointEnableAccCheck&&(this.iec=new Lb(P,u,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.iec.vb(),this.iec.me());u.ute&&Db.a.get_instance().Vj(7,Object(z.a)(this,this.ute,"loadInternalSlice"))}ute(){const u=bc.a.create("pptedit.internal",
null,()=>d.e(18).then(d.bind(null,1310)));Mc.a.py(u)}dispose(){this.iec&&this.iec.dispose()}static main(){m.a.instance.Ac(new Kb)}}Object(r.a)(Kb,"PptLazyActorsPackage",null,[2,3]);var uc=d(215),Yb=d(591),Tc=d(1261),sc=d(181),Qb=d(165),kb=d(59),Ib=d(49),eb=d(68),Rb=d(139),pc=d(639);class Wc extends pc.a{constructor(){super();this.te=this.createElement(eb.a.V7e)}Ktl(u){this.xa.textContent=u}appendChild(u){if(!u.xa||!this.xa)throw Error.argumentNull();this.xa.appendChild(u.xa)}}Object(r.a)(Wc,"HTMLText",
pc.a,[]);var Ic=d(334),nd=d(190);class ob{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){this.nd=1;this.SGe=null;this.HR=new sc.a;this.Zr=new sc.a;this.rm=null;this.Vn=!1;this.Ema=null;this.Tgc="";this.nM=this.LA=!1;this.caa=this.zXa=this.Dma=this.nHa=this.SDb=this.$ea=null;this.vWa=!1;this.ta=u;this.wb=P;this.le=la;this.la=Ca;this.ia=Ta;this.Rc=pb;this.jb=Sb;this.vD=Cc}VEh(u){this.$ea&&this.caa&&(this.LA=!0,this.caa.appendChild(this.$ea.xa),this.jb.FC(Object(z.a)(this,this.onSelectionChange,"onSelectionChange")),
this.Ema=new O.a(3,1,this.la.uvd,Object(z.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.Bxc(u))}oQh(u){this.ta===u&&this.LA&&this.Bxc(this.ta.get_alt())}Bm(u){this.caa=u.xa;this.Q1d()}kC(u){if(this.LA&&!this.Vn)switch(u){case 1:u=this.le.qk("formatpainterobject.cur");this.nHa.Bl(Ib.a.WN(u,eb.a.Bmb));break;case 0:this.nHa.Bl(eb.a.Bmb)}}Mp(){return null}PL(){return!1}Xw(u){this.Vn=u}dispose(){this.kka();this.$ea&&(this.zXa=this.Dma=this.SDb=this.nHa=this.$ea=
null)}ny(){}ZC(){return null}TA(){return[]}draw(){this.LA&&this.Enb(!0)}get visible(){return this.nM}set visible(u){this.LA&&(this.nM!==u&&(this.nM=u,this.$ea.setVisibility(this.nM)),this.nM||this.kka())}setPosition(){}Kj(u){this.nd=u;this.LA&&(this.zKa(),this.pQh())}wq(u){this.HR=u;this.LA&&this.zKa()}Ju(u){this.Zr=u;this.LA&&this.zKa()}setZIndex(u){this.LA&&this.$ea.lC(u)}JD(u,P){this.LA&&(this.Enb(!u&&P||!P),u||this.wb.U1(this.Ema,this.la.uvd))}setSelection(){}Q1d(){this.$ea=new Rb.a;this.nHa=
new Ic.a;this.nHa.opa("ImageDescriptionBarBackground");this.Rc.ub(Fa.a.click,this.nHa.xa,Object(z.a)(this,this.QNe,"onImageDescriptonBarClickHandler"));this.SDb=new nd.a;this.SDb.appendChild(this.nHa);this.Dma=new Wc;this.Dma.Fr("ImageDescriptionBarText");this.pQh();this.zXa=new Rb.a;this.zXa.Fr("ImageDescriptionBarTextWrappingDiv");this.zXa.appendChild(this.Dma);this.$ea.appendChild(this.SDb);this.$ea.appendChild(this.zXa)}Bxc(u){const P=u.indexOf("\n");this.Tgc=-1===P?u:u.substring(0,P);this.Dma.Ktl(ResourceStrings.L_ShapeAltText+
": "+this.Tgc);this.Enb(!0)}Enb(u){this.rm=this.ta.Nn;this.nM=u;this.zKa();this.$ea.setVisibility(this.nM);this.vWa||(this.vWa=!0,this.wb.Hb(this.Ema))}pQh(){this.Dma.xa.style.fontSize=this.vD.Sja(29)}QNe(){this.ia.processAction(wb.a.hsa,2);return!0}onSelectionChange(){this.kka()}dismissImageDescriptionBarTask(){this.kka()}kka(){this.LA&&(this.nM=this.LA=!1,this.jb.Cga(Object(z.a)(this,this.onSelectionChange,"onSelectionChange")),this.vWa&&(this.wb.Kg(this.Ema),this.vWa=!1),this.caa&&this.caa.contains(this.$ea.xa)&&
this.caa.removeChild(this.$ea.xa))}zKa(){if(this.LA&&this.rm){var u=this.rm.copy();this.HR.ql(u);this.Zr.ql(u);this.SGe=Yb.a.bN(kb.a.LF(u.ga(0),u.ga(1)));var P=u.Wj(new Qb.a(6)),la=u.Wj(new Qb.a(4));u=u.Wj(new Qb.a(2));u=kb.a.Ql(la,u)*this.nd;la=kb.a.Ql(P,la)*this.nd;if(60>la||80>u)this.nM=!1;else{u=this.caa.children[0].style;this.SDb.setPosition(this.bRb(u.left),this.bRb(u.top));this.SDb.ah(this.bRb(u.width),this.bRb(u.height));var Ca=this.vD.Pe(Tc.a.gf(40,1),1);this.zXa.setPosition(P.x*this.nd,
P.y*this.nd-Ca);this.zXa.ah(la,Ca);this.zXa.xa.style.transform=this.ySa(this.SGe);this.Dma.ah(la-9,Ca-6);var Ta=new sc.a;Ta.m8(this.SGe,new kb.a(0,Ca));Ta.DC(P.x*this.nd-this.bRb(u.left),P.y*this.nd-this.bRb(u.top)-Ca);this.nHa.fF(Ta,1);this.nHa.ah(la,Ca)}}}bRb(u){u=parseFloat(u);return isNaN(u)?0:u}ySa(u){return"rotate("+u.toString()+"deg)"}}Object(r.a)(ob,"ImageDescriptionBarView",null,[1114,282,283,108]);var $b=d(253),Hc=d(70),Pb=d(167);class Yc{constructor(u,P,la,Ca,Ta,pb,Sb){this.nd=1;this.HR=
new sc.a;this.Zr=new sc.a;this.Vn=!1;this.Tgc="";this.CCe=this.DCe=this.s5=this.nM=this.LA=!1;this.lQf=()=>{this.s5||this.DCe||(this.Ema||(this.Ema=new O.a(3,1,this.la.uvd,this.dismissImageDescriptionBarTask,90,"19")),this.s5=!0,this.wb.Hb(this.Ema))};this.mUf=()=>{this.s5&&(this.s5=!1,this.wb.Kg(this.Ema),this.Ema=void 0)};this.xJk=()=>{this.DCe=!0;this.mUf();return!0};this.yJk=()=>{this.DCe=!1;this.lQf();return!0};this.QNe=Cc=>this.uah(Cc);this.ZEk=()=>{this.ia.processAction(wb.a.aLc,2);this.kka();
return!0};this.uah=()=>{this.ia.processAction(wb.a.BRc,2);this.kka();return!0};this.onSelectionChange=()=>{this.kka()};this.dismissImageDescriptionBarTask=()=>{this.kka()};if(!u)throw Error.argumentNull("shapeNode");if(!P)throw Error.argumentNull("taskManager");if(!Ca)throw Error.argumentNull("appSettings");if(!pb)throw Error.argumentNull("clickInputManager");if(!Sb)throw Error.argumentNull("pptSelectionManager");this.ta=u;this.wb=P;this.le=la;this.la=Ca;this.ia=Ta;this.Rc=pb;this.jb=Sb}Q1d(){this.uA=
Ib.a.ee();this.uA.className="ImageDescriptionBarNew";this.Rc.ub(Fa.a.click,this.uA,this.QNe);$b.a.instance.ub(Fa.a.Vfa,this.uA,this.xJk);$b.a.instance.ub(Fa.a.Wfa,this.uA,this.yJk);this.Dma=Ib.a.Hl();this.qeb=document.createElement(Ib.a.ULc);this.qeb.className="ImageDescriptionBarNewButton";this.qeb.appendChild(e("M 768 1660 l -666 -666 l 73 -72 l 593 593 l 1105 -1105 l 73 72 z",20,20).xa);var u=Ib.a.Hl();u.innerText=ResourceStrings.L_ImageDescriptionBarApprove;this.qeb.appendChild(u);this.Rc.ub(Fa.a.click,
this.qeb,this.ZEk);this.Gfc=document.createElement(Ib.a.ULc);this.Gfc.className="ImageDescriptionBarNewButton";this.Gfc.appendChild(e("M 1879 169 q 39 39 59 88 q 20 50 20 102 q 0 51 -20 100 q -20 50 -59 89 l -1221 1215 l -556 183 l 195 -574 l 1203 -1203 q 38 -38 86 -57 q 48 -19 99 -19 h 4 q 53 0 103 19 q 49 19 87 57 m -1440 1206 q 85 26 147 87 q 61 62 87 147 l 995 -995 l -234 -234 m -1194 1428 l 345 -127 q -6 -43 -24 -80 q -19 -37 -48 -66 q -29 -29 -66 -48 q -37 -18 -80 -24 m 1440 -987 q 24 -24 37 -55 q 12 -30 12 -62 q 0 -33 -13 -63 q -13 -30 -35 -53 q -23 -22 -53 -36 q -31 -13 -66 -13 q -32 0 -63 12 q -31 12 -54 35 l -66 66 l 235 235 z",
20,20).xa);u=Ib.a.Hl();u.innerText=ResourceStrings.L_ImageDescriptionBarEdit;this.Gfc.appendChild(u);this.Rc.ub(Fa.a.click,this.qeb,this.uah);this.uA.appendChild(this.Dma);this.uA.appendChild(this.qeb);this.uA.appendChild(this.Gfc)}Bxc(u){const P=u.indexOf("\n");this.Tgc=-1===P?u:u.substring(0,P);this.Dma.innerText=ResourceStrings.L_ImageDescriptionBarFormatString.replace("{0}",this.Tgc);this.Enb(!0)}Enb(u){this.rm=this.ta.Nn;this.nM=u;this.zKa();this.uA.style.display=this.nM?Hc.a.sba:Hc.a.Qe;this.lQf()}kka(){if(this.LA){this.nM=
this.LA=!1;this.jb.Cga(this.onSelectionChange);this.mUf();this.caa&&this.caa.contains(this.uA)&&this.caa.removeChild(this.uA);const u=Date.now()-this.Ruk,P=new L.a;P.name="IsMisaligned";P.int64=this.CCe?1:0;oc.a("AltTextBar",!0,u,[P])}}zKa(){if(this.LA&&this.rm){var u=this.rm.copy();this.HR.ql(u);this.Zr.ql(u);var P=Yb.a.bN(kb.a.LF(u.ga(0),u.ga(1))),la=u.Wj(new Qb.a(6)),Ca=u.Wj(new Qb.a(4));u=u.Wj(new Qb.a(2));u=kb.a.Ql(Ca,u)*this.nd;la=kb.a.Ql(la,Ca)*this.nd;this.uA.style.position=Hc.a.tba;if(45<=
P&&135>P||225<=P&&315>P){if(150>u||70>la){this.nM=!1;return}this.uA.style.marginLeft=(.5*(la-u)).toString()+"px";this.uA.style.marginTop=(.5*(la+u)-this.uA.offsetHeight).toString()+"px";this.uA.style.width=u.toString()+"px"}else{if(150>la||70>u){this.nM=!1;return}this.uA.style.marginLeft="0";this.uA.style.marginTop=(u-this.uA.offsetHeight).toString()+"px";this.uA.style.width=la.toString()+"px"}this.CCe=0!=P%90}}VEh(u){this.Ruk=Date.now();this.uA&&this.caa&&(this.LA=!0,this.CCe=!1,this.caa.appendChild(this.uA),
this.jb.FC(this.onSelectionChange),this.Bxc(u))}oQh(u){this.ta===u&&this.LA&&this.Bxc(this.ta.ECf)}get visible(){return this.nM}set visible(u){this.LA&&(this.nM!==u&&(this.nM=u,this.uA.style.display=this.nM?Hc.a.sba:Hc.a.Qe),this.nM||this.kka())}Bm(u){this.caa=u.xa;this.Q1d()}setPosition(){}Kj(u){this.nd=u;this.LA&&this.zKa()}wq(u){this.HR=u;this.LA&&this.zKa()}Ju(u){this.Zr=u;this.LA&&this.zKa()}setZIndex(u){this.LA&&(this.uA.style.zIndex=u.toString())}kC(u){if(this.LA&&!this.Vn)switch(u){case 1:this.le&&
(u=this.le.qk("formatpainterobject.cur"),this.uA.style.cursor=Ib.a.WN(u,eb.a.Bmb));break;case 0:this.uA.style.cursor=eb.a.Bmb}}ZC(){return null}ny(){}JD(u,P){this.LA&&(this.Enb(!u&&P||!P),!u&&this.Ema&&this.wb.U1(this.Ema,this.la.uvd))}Mp(){return null}PL(){return!1}Xw(u){this.Vn=u}setSelection(){}TA(){return[]}draw(){this.LA&&this.Enb(!0)}dispose(){this.kka();this.uA&&(this.Gfc=this.qeb=this.Dma=this.uA=void 0)}}Object(r.a)(Yc,"ImageDescriptionBarViewNew",null,[1114,282,283,108]);var Rd=d(1053),
Gb=d(47),Bb=d(39);class dc{constructor(u,P,la,Ca){this.shapeNode=u;this.fTc=P;this.o4j=la;this.imageDescription=Ca}}Object(r.a)(dc,"ImageDescriptionCache",null,[]);var Xc=d(222);class Fb{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We){this.w$=new Rd.a;this.gWj=Qf=>{[Qf]=h(Qf);return Qf};this.Eb=u;this.ei=P;this.Vq=Sb;this.Kva=la;this.jb=Ca;this.U0=pb;this.CHa=Ta;this.Ur=Cc;this.Fb=ed;this.fc=ad;this.h$c=Zd;this.jma=We}initialize(){this.Ur.gk(Object(z.a)(this,this.$g,"onPropertyChanged"));this.Vq.jBf(Object(z.a)(this,
this.yJb,"onShapeImageFirstDraw"));this.Vq.Hji(Object(z.a)(this,this.Sbh,"onLocalImageViewDismissed"));this.Kva.Cji(Object(z.a)(this,this.qbh,"onImageDescriptionReady"))}dispose(){this.Ur.Qm(Object(z.a)(this,this.$g,"onPropertyChanged"));this.Vq.oXe(Object(z.a)(this,this.yJb,"onShapeImageFirstDraw"));this.Vq.Mbl(Object(z.a)(this,this.Sbh,"onLocalImageViewDismissed"));this.Kva.Ibl(Object(z.a)(this,this.qbh,"onImageDescriptionReady"))}$g(u,P){if((u=P.node)&&u.tj)if(P=P.property,P===Bb.a.alt){P=Object(U.a)(117,
u.qc(this.Eb.Na));const la=u.get_alt();if(!this.jma||la&&this.gWj(la))P&&P.TQ&&u.get_alt()&&(P=this.h$c.dJ(u))&&P.oQh(u),this.CHa.nPh(u),u.get_alt()&&this.tvd(u,u.get_alt())}else P===Bb.a.$C?u.$C&&(P=Object(U.a)(117,u.qc(this.Eb.Na)))&&P.TQ&&(u=this.h$c.dJ(u))&&(u.visible=!1):P===Bb.a.Uf&&u.Uf!==Xc.a.ZT?(P=Object(U.a)(117,u.qc(this.Eb.Na)))&&P.TQ&&!u.Mea&&this.w$.ga(u.id)&&this.w$.ga(u.id).fTc&&(this.ITa(u,P),this.w$.remove(u.id)):this.jma&&P===Bb.a.UL&&(u=this.h$c.dJ(u))&&(u.visible=!1)}qbh(u,P){if(u=
P.cZc){var la=P.confidence,Ca=P.imageDescription,Ta=P.o0j;P=P.fTc;var pb=this.U0.Zda(u),Sb=pb?Object(U.a)(117,pb.qc(this.Eb.Na)):null;P?Sb&&Sb.TQ&&!pb.isLocal&&!pb.$C?this.ITa(pb,Sb):this.w$.add(u,new dc(pb,!0,!0,Ca)):!Ca||!Ta&&60>la?N.a.J(509092041,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Ta,la):(Ca=this.iHi(la,Ca),Ta?this.h0e(pb,Ca,!1):(N.a.J(509092040,815,50,"Image description ready for show and save"),Sb&&Sb.TQ?(N.a.J(509092039,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",
u.toString(),(new Date).getTime()),this.tvd(pb,Ca),pb.isLocal?this.w$.add(u,new dc(pb,!1,!1,Ca)):(N.a.J(509092038,815,50,"Save image description immediately"),this.h0e(pb,Ca,!0))):this.w$.add(u,new dc(pb,!1,!0,Ca))))}else N.a.J(509092042,815,15,"Graph node id is null")}yJb(u,P){u=P.cZc;N.a.J(509092037,815,50,"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",u?u.toString():"",(new Date).getTime());this.w$.Gb(u)?this.Rkh(u):(u=this.U0.Zda(u))&&u.get_alt()&&this.tvd(u,u.get_alt())}iHi(u,P){P+=String.fromCharCode(10,
10);return P=80<=u?P+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=u?P+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=u?P+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=u?P+ResourceStrings.L_ImageDescriptionWithLowConfidence:P+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}Sbh(u,P){(u=P.hEl)&&this.w$.Gb(u.id)&&this.Rkh(u.id)}Rkh(u){const P=this.w$.ga(u).shapeNode;if(P){var la=this.w$.ga(u).fTc,Ca=this.w$.ga(u).o4j,Ta=this.w$.ga(u).imageDescription;la?
(la=Object(U.a)(117,P.qc(this.Eb.Na)))&&this.ITa(P,la):(Ca&&this.tvd(P,Ta),P.isLocal?N.a.J(509092035,815,15,"Try to save alt text for local picture"):this.h0e(P,Ta,!0));this.w$.remove(u)}else N.a.J(509092036,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}ITa(u,P){this.ei.generateImageDescription(u.id,P.Svd,u.get_isSVGBlipFilled(),!1)}h0e(u,P,la){const Ca=Date.now();if(!la||!u.get_alt()){var Ta=this.Fb.ke(la?7:15);Ta.jc(u);u.sza=la;u.set_alt(Gb.a.mVa(P));Ta.dispose();la&&this.ei.forceOutbound();
u=Date.now()-Ca;oc.a("UpdateAltText",!0,u)}}tvd(u,P){if(u.tj){this.fc.fd(u)&&N.a.J(509092033,815,50,"Graph node or parents blocked");var la=this.jb.Ud();la&&this.jb.yX(u)?(N.a.J(509092003,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",u.id.toString(),(new Date).getTime()),(u=this.h$c.dJ(u))&&u.VEh(P)):N.a.J(509092032,815,50,"Is selected shapes empty: {0}",!la)}else N.a.J(509092034,815,50,"ShapeNode.IsPicture: {0}",u.tj)}}Object(r.a)(Fb,"ImageDescriptionManager",
null,[108]);var kd=d(96),od=d(307),Gd=d(33),Fd=d(48);class ee{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We){this.ta=null;this.vU=0;this.wad=!0;this.dfb=new Rd.a(0);this.I3e=()=>{N.a.J(509092045,815,10,"ImageDescriptionPane.showHideAltTextPane not implemented")};this.GEf=()=>{N.a.J(509092044,815,10,"ImageDescriptionPane.approveAltTextPane not implemented")};this.Y5d=()=>{N.a.J(509092043,815,10,"ImageDescriptionPane.editAltTextPane not implemented")};this.Gg=u;this.Rb=P;this.le=la;this.Fa=ad;this.ei=
Ca;this.Rc=Ta;this.jb=pb;this.LB=Sb;this.vR=Cc;this.Fb=ed;this.Kva=Zd;this.uD=We;this.ob=document.createElement("div");this.ob.className="ImageDescriptionPane";this.ob.id="ImageDescriptionPane";this.ob.style.position=Hc.a.tba;this.ob.setAttribute(Ja.a.hf,Ja.a.nsa);this.ob.setAttribute(Ja.a.t_,"ImageDescriptionPaneLabel");this.Rc.ub(Fa.a.click,this.ob,Object(z.a)(this,this.Wuh,"rootElementClickHandler"));this.vR.addHandler(this.ob,Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler"));this.Ab=
!1;this.JH=Ib.a.ee();this.JH.className="ImageDescriptionPaneLayoutRoot";this.gl=this.vDa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.gl,"ImageDescriptionPaneCloseButton");this.gl.setAttribute(Ja.a.hf,Ja.a.Ou);this.JH.appendChild(this.gl);this.Rc.ub(Fa.a.click,this.gl,Object(z.a)(this,this.gDa,"closeButtonClickHandler"));this.vR.addHandler(this.gl,Fa.a.focus,Object(z.a)(this,this.fJb,"onElementFocused"));this.Pma=Ib.a.ee();this.Pma.id="ImageDescriptionPaneLabel";this.Pma.className=
"PaneLabel";this.Pma.innerText=ResourceStrings.L_ShapeAltText;this.JH.appendChild(this.Pma);this.EHa=Ib.a.ee();this.EHa.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.EHa.className="ImageDescriptionLabel";this.JH.appendChild(this.EHa);this.DHa=Ib.a.ee();this.DHa.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.DHa.className="ImageDescriptionHint";this.JH.appendChild(this.DHa);this.afb=Ib.a.ee();this.Km=document.createElement("textarea");this.Km.className="AltTextTextArea";this.Km.setAttribute(Ja.a.fr,
ResourceStrings.L_ShapeAltText);this.Km.tabIndex=0;this.afb.appendChild(this.Km);this.JH.appendChild(this.afb);this.Rc.ub(Fa.a.click,this.Km,Object(z.a)(this,this.FCf,"altTextboxClickHandler"));this.vR.addHandler(this.Km,Fa.a.Df,Object(z.a)(this,this.HCf,"altTextboxTypingHandler"));this.vR.addHandler(this.Km,Fa.a.focus,Object(z.a)(this,this.fJb,"onElementFocused"));u=Ib.a.Hl();u.className="GenerateDescriptionButtonText";u.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;u.setAttribute("Unselectable",
"on");this.Mw=Ib.a.mda();this.Mw.className="ImageDescriptionPaneButton cui-ctl";this.Mw.setAttribute(Ja.a.hf,Ja.a.Ou);this.Mw.tabIndex=0;this.Mw.appendChild(u);this.JH.appendChild(this.Mw);this.Rc.ub(Fa.a.click,this.Mw,Object(z.a)(this,this.r7b,"generateDescriptionClickHandler"));this.vR.addHandler(this.Mw,Fa.a.focus,Object(z.a)(this,this.fJb,"onElementFocused"));this.LB.C4(Fd.a.VQ,Fd.a.$i,this.ob,()=>{this.XU(!0)},()=>{this.XU(!1)},!0);this.LB.C4(Fd.a.rVd,Fd.a.$i,this.Km,()=>{this.abh(!0)},()=>{this.abh(!1)},
!0);this.Kva.kBf(Object(z.a)(this,this.Onc,"onShowHideAltTextPane"))}vje(){this.ABi()&&(this.Km.disabled=!1,this.Km.value=this.ta.get_alt(),this.ob.appendChild(this.JH),this.Mw.style.display=this.ta.isLocal?Hc.a.Qe:Hc.a.Tj,this.Ab=!0,this.ob.style.display=Hc.a.Tj,this.Jsb(this.ob),this.uD.sK(this,this.Ab,ResourceStrings.L_ShapeAltText,Fd.a.VQ),this.jb.FC(Object(z.a)(this,this.onSelectionChange,"onSelectionChange")),N.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.hNc();
this.Kva.xrh(Object(z.a)(this,this.Onc,"onShowHideAltTextPane"));this.Rc.Bb(Fa.a.click,this.ob,Object(z.a)(this,this.Wuh,"rootElementClickHandler"));this.vR.removeHandler(this.ob,Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler"));this.Rc.Bb(Fa.a.click,this.gl,Object(z.a)(this,this.gDa,"closeButtonClickHandler"));this.vR.removeHandler(this.gl,Fa.a.focus,Object(z.a)(this,this.fJb,"onElementFocused"));this.Rc.Bb(Fa.a.click,this.Km,Object(z.a)(this,this.FCf,"altTextboxClickHandler"));this.vR.removeHandler(this.Km,
Fa.a.Df,Object(z.a)(this,this.HCf,"altTextboxTypingHandler"));this.vR.removeHandler(this.Km,Fa.a.focus,Object(z.a)(this,this.fJb,"onElementFocused"));this.Rc.Bb(Fa.a.click,this.Mw,Object(z.a)(this,this.r7b,"generateDescriptionClickHandler"));this.vR.removeHandler(this.Mw,Fa.a.focus,Object(z.a)(this,this.fJb,"onElementFocused"));this.Mw=this.Km=this.afb=this.DHa=this.EHa=this.Pma=null;N.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}nPh(u){this.ta&&u===this.ta&&this.Ab&&(this.dfb.Gb(u.id.toString())&&
this.ta.Uf!==this.dfb.ga(u.id.toString())&&N.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),2!==this.vU&&(this.Km.value=this.ta.get_alt()))}layout(u,P){const la=P?u.AG(this.width):u.BG(this.width);this.Ab&&(P?(Sys.UI.DomElement.addCssClass(this.ob,"ImageDescriptionPaneRTL"),la.AG(1)):(Sys.UI.DomElement.addCssClass(this.ob,"ImageDescriptionPaneLTR"),la.BG(1)));Ib.a.K6(this.ob,la);return u}get isVisible(){return this.Ab}get xa(){return this.ob}get order(){return 10}XU(u){this.Ab&&
(u?0===this.vU&&this.uyd():this.vU=0)}abh(u){this.Ab&&(u||this.PLa(),this.Rb.updateCommandUI())}HCf(u){u.keyCode===pa.a.EZ&&u.ctrlKey?this.LLa():(2!==this.vU&&this.bzh(),this.vU=2)}Cua(u){this.Ab&&(u.keyCode===pa.a.jp||u.keyCode===pa.a.BK?1===this.vU?this.eH():3===this.vU?this.ITa():2===this.vU&&(this.Mw.style.display=Hc.a.Tj):2===this.vU&&(this.Mw.style.display=Hc.a.Tj))}uyd(){kd.FocusManager.Zq(this.gl)?(this.LLa(),this.vU=1):N.a.J(512233505,815,50,"Fail to set focus on close button")}LLa(){this.Fa.hC(Fd.a.VQ)}bzh(){this.Fa.hC(Fd.a.rVd)}ABi(){const u=
this.jb.Ud();if(!u||1<u.length||!u[0].tj)return N.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",!u),!1;this.ta=u[0];return!0}gDa(){this.eH();return!0}eH(){this.Ab&&(this.hNc(),this.Fa.wj(Fd.a.VQ,!1),N.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}Wuh(){this.Ab&&(this.LLa(),this.vU=0);return!0}FCf(){this.bzh();this.vU=2;return!0}r7b(){this.LLa();this.ITa();return!0}ITa(){this.vU=
3;this.Mw.style.display=Hc.a.Qe;this.uyd();const u=this.ta?Object(U.a)(117,this.ta.qc(0)):null;u?(this.dfb.add(this.ta.id.toString(),this.ta.Uf),this.ei.generateImageDescription(this.ta.id,u.Svd,this.ta.get_isSVGBlipFilled(),!0)):N.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ta)}Onc(){this.Ab?this.hNc():(this.vje(),this.vU=0);this.Fa.wj(Fd.a.VQ,this.Ab);N.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Ab)}HRl(u){u=
u.Ud();this.wad&&this.PLa();1===u.length&&u[0].tj?(this.ta=u[0],this.wad=!0,this.Km.value=this.ta.get_alt(),this.Km.disabled=!1,this.Mw.style.display=this.ta.isLocal?Hc.a.Qe:Hc.a.Tj):(this.Mw.style.display=Hc.a.Qe,this.Km.disabled=!0,this.Km.value=null,this.wad=!1)}onSelectionChange(u){Gd.a("ChangePictureAltTextFixEnabled")?this.HRl(u):this.hNc();this.Gg.Eo(Fd.a.VQ)}fJb(u){this.Ab&&(u.target===this.gl?this.vU=1:u.target===this.Km?this.vU=2:u.target===this.Mw&&(this.vU=3))}hNc(){this.Ab&&(this.jb.Cga(Object(z.a)(this,
this.onSelectionChange,"onSelectionChange")),this.wad&&this.PLa(),this.Ab=!1,this.ob.removeChild(this.JH),this.ob.style.display=Hc.a.Qe,this.Jsb(this.ob),this.uD.sK(this,this.Ab,ResourceStrings.L_ShapeAltText,Fd.a.VQ),N.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}Jsb(u){t.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(u,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass(u,"ImageDescriptionPaneLTR")}PLa(){const u=this.Km.value;if(!(Gd.a("ChangePictureAltTextFixEnabled")&&
null===u||u===this.ta.get_alt())){var P=this.Fb.ke(15);P.jc(this.ta);this.ta.sza=!1;this.ta.set_alt(u);P.dispose()}}vDa(u,P){return this.uDa(u,"cui-img-16by16","cui-ctl-iconContainer",P,CommonUIStrings.l_DialogClose,null)}uDa(u,P,la,Ca,Ta,pb){const Sb=Ib.a.xB();Sb.alt=Ta;Sb.className=ia.getImageClassWithCluster(u,Ca);Sb.src=this.le.qk(u+".png");Sb.setAttribute("Unselectable","on");u=Ib.a.Hl();u.className=P+" cui-img-cont-float";u.appendChild(Sb);P=Ib.a.Hl();P.className=la;P.setAttribute("Unselectable",
"on");P.appendChild(u);la=Ib.a.mda();la.className="ImageDescriptionPaneNoBorderButton cui-ctl";la.title=Ta;la.setAttribute(Ja.a.hf,Ja.a.Ou);la.tabIndex=0;la.appendChild(P);pb&&(Ta=Ib.a.Hl(),Ta.className="cui-ctl-mediumlabel",Ta.setAttribute("Unselectable","on"),Ta.innerText=pb,la.appendChild(Ta));return la}get width(){return this.Ab?264+od.a.Vya:0}}Object(r.a)(ee,"ImageDescriptionPane",null,[1083,654,108]);class Bf{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf){this.dfb=new Rd.a(0);this.$g=
(He,Yf)=>{He=Yf.node;this.Mz&&this.Mz.includes(He)&&[Bb.a.alt,Bb.a.gsa,Bb.a.UL].includes(Yf.property)&&this.R_c()};this.Bdj=()=>{if(!this.Mz||0===this.Mz.length)return"";let He="",Yf=!0;for(let Rg of this.Mz){let $i=Rg.ECf;if(!Yf&&$i!==He)return"";He=$i;Yf=!1}return He};this.iij=()=>{if(!this.Mz||0===this.Mz.length)return[!1,!1];let He=!0,Yf=!0;for(let Rg of this.Mz)Rg.UL?Yf=!1:He=!1;return[He,!(He||Yf)]};this.R_c=()=>{if(this.Mz&&0!==this.Mz.length){this.zIg=this.F0.checked;[this.WXa,this.hY.indeterminate]=
this.iij();this.hY.checked=this.WXa;this.hY.disabled=!1;this.Pfb.style.display=Hc.a.Tj;this.xBe=this.Bdj();this.Km.value=this.WXa?ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative:this.xBe;this.Km.disabled=this.WXa;this.jDe=this.m7j();var He=!1;if(this.jDe){let Yf;[He,Yf]=h(this.Km.value);He=He&&0<Yf}this.yva.style.display=He||this.F0.checked?Hc.a.Tj:Hc.a.Qe;this.Mw.style.display=!this.jDe||He||this.F0.checked?Hc.a.Qe:Hc.a.Tj;this.Mw.disabled=this.WXa;this.Xva.style.display=Hc.a.Qe;""!==
this.t$.innerText&&(this.t$.innerText="");this.o2b()}else this.Km.value="",this.Km.disabled=!0,this.Mw.style.display=Hc.a.Qe,this.Xva.style.display=Hc.a.Qe,""!==this.t$.innerText&&(this.t$.innerText=""),this.o2b(),this.yva.style.display=Hc.a.Qe,this.Pfb.style.display=Hc.a.Qe};this.m7j=()=>this.Mz?1===this.Mz.length&&this.Mz[0].tj&&!this.Mz[0].get_isSVGBlipFilled():!1;this.Faf=()=>{this.Jsb(this.ob);this.uD&&this.uD.sK(this,this.Ab,ResourceStrings.L_ShapeAltTextNew,Fd.a.VQ)};this.u_d=()=>{0!==this.bgd&&
(window.clearTimeout(this.bgd),this.bgd=0)};this.o2b=()=>{0!==this.H9c&&(window.clearTimeout(this.H9c),this.H9c=0)};this.GCf=()=>{var He=Date.now();const Yf=this.yva.style.display===Hc.a.Tj;Yf&&(this.F0.checked=!1,this.yva.style.display=Hc.a.Qe,this.Mw.style.display=Hc.a.Tj,this.Xva.style.display=Hc.a.Qe,""!==this.t$.innerText&&(this.t$.innerText=""),this.o2b(),this.Vph());this.u_d();this.bgd=window.setTimeout(()=>{this.PLa()},500);if(!this.EHg){He=Date.now()-He;const Rg=new L.a;Rg.name="ApproveImplicitly";
Rg.int64=Yf?1:0;oc.d(wb.a.TPl,!0,"AltTextPane",1,12,He,[Rg]);this.EHg=!0}};this.uyd=()=>{this.LLa();kd.FocusManager.Zq(this.gl)||N.a.J(509092104,815,50,"Fail to set focus on close button")};this.azh=()=>{this.LLa();window.setTimeout(()=>{if(kd.FocusManager.Zq(this.Km))return this.Km.selectionStart=0,this.Km.selectionEnd=0,!0;N.a.J(509092103,815,50,"Fail to set focus on alt text box");return!1},0)};this.LLa=()=>{this.Fa&&this.Fa.hC(Fd.a.VQ)};this.gDa=()=>{this.eH();return!0};this.Vph=()=>{const [He,
Yf]=h(this.Km.value);if(He){const Rg=this.Km.selectionStart,$i=this.Km.selectionEnd;this.Km.value=this.Km.value.substring(0,Yf).trimEnd();this.Km.setSelectionRange(Rg,$i)}};this.qWd=(He,Yf)=>{var Rg=Date.now();const $i=!this.zIg;(this.F0.checked=$i)?(this.k7c=this.Km.value,this.Vph()):this.Km.value=this.k7c;this.PLa();Yf&&(Yf=Date.now()-Rg,Rg=new L.a,Rg.name="CustomData1",Rg.int64=$i?1:0,oc.d(wb.a.aLc,!0,"AltTextPane",He,12,Yf,[Rg]))};this.HEf=He=>{He.nc.preventDefault();He.nc.stopPropagation();this.qWd(2,
!0);window.setTimeout(()=>{this.F0.checked=this.zIg},0);return!0};this.IEf=He=>He.nc.keyCode===pa.a.jp||He.nc.keyCode===pa.a.BK?(He.nc.preventDefault(),He.nc.stopPropagation(),this.qWd(1,!0),!0):!1;this.b5g=He=>{var Yf=Date.now();const Rg=!this.WXa;this.hY.indeterminate=!1;this.hY.checked=Rg;this.Mw.disabled=Rg;this.yva.style.display=Hc.a.Qe;(this.Km.disabled=Rg)?(this.k7c=this.Km.value,this.Km.value=ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative):this.Km.value=this.k7c;this.PLa();Yf=
Date.now()-Yf;const $i=new L.a;$i.name="CustomData1";$i.int64=Rg?1:0;oc.d(wb.a.NJe,!0,"AltTextPane",He,12,Yf,[$i])};this.$4g=He=>{console.log("[markAsDecorativeClickHandler]",this.hY.checked);He.nc.preventDefault();He.nc.stopPropagation();this.b5g(2);window.setTimeout(()=>{this.hY.checked=this.WXa},0);return!0};this.a5g=He=>{console.log("[markAsDecorativeKeyDownHandler]",this.hY.checked);return He.nc.keyCode===pa.a.jp||He.nc.keyCode===pa.a.BK?(He.nc.preventDefault(),He.nc.stopPropagation(),this.b5g(1),
!0):!1};this.eH=()=>{if(this.Ab){var He=Date.now();this.a_d();N.a.J(509092102,815,50,"ImageDescriptionPaneNew.closePane - Image Description pane close button clicked.");He=Date.now()-He;const Yf=new L.a;Yf.name="CustomData1";Yf.int64=0;oc.d(wb.a.hsa,!0,"AltTextPane",0,12,He,[Yf])}};this.r7b=()=>{this.ITa();return!0};this.ITa=()=>{var He=Date.now();const Yf=this.Mz[0]?this.Mz[0].qc(0):void 0;this.ei&&Yf?(this.Mw.style.display=Hc.a.Qe,this.Xva.style.display=Hc.a.sba,this.t$.innerText=ResourceStrings.L_ImageDescriptionPaneInProgress,
this.o2b(),this.H9c=window.setTimeout(()=>{this.Xva.style.display=Hc.a.Qe;""!==this.t$.innerText&&(this.t$.innerText="");oc.a("GeneratingAltTextMessageTimeout")},15E3),this.uyd(),this.dfb.add(this.Mz[0].id.toString(),this.Mz[0].Uf),this.ei.generateImageDescription(this.Mz[0].id,Yf.Svd,this.Mz[0].get_isSVGBlipFilled(),!0),He=Date.now()-He,oc.d(wb.a.ubj,!0,"AltTextPane",0,12,He)):N.a.J(509092101,815,15,"ImageDescriptionPaneNew.generateDescriptionForMe - Is shape node null or undefined {0}",!this.Mz[0])};
this.Onc=()=>{this.I3e()};this.GRl=He=>{He=He.Qf();this.k7c="";this.PLa();this.Mz=He;this.EHg=this.F0.checked=!1;this.R_c()};this.onSelectionChange=He=>{this.GRl(He);this.Gg&&this.Gg.Eo(Fd.a.VQ)};this.Jsb=He=>{t.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(He,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass(He,"ImageDescriptionPaneLTR")};this.PLa=()=>{this.u_d();if(this.Mz&&0!==this.Mz.length){var He=this.hY.checked,Yf=He?"":this.Km.value;if(Yf!==this.xBe||He!==this.WXa){var Rg=
this.Fb.ke(15);if(Rg){Rg.jc(this.jb.Fk());if(He)for(let $i of this.Mz)$i.sza=!1,$i.UL=!0;else for(let $i of this.Mz)$i.sza=!1,$i.set_alt(Yf),$i.set_altTitle("");Rg.dispose()}this.WXa=He;this.xBe=Yf;this.Vv&&this.Vv.SA()}}};this.Xuh=He=>He.nc.keyCode===pa.a.AZ||He.nc.keyCode===pa.a.qNa?(He.nc.preventDefault(),He.nc.stopPropagation(),this.Fa.Bd(),!0):!1;this.J3e=He=>{const Yf=this.Ab;He?Yf?(this.Faf(),this.azh()):this.vje():Yf&&this.a_d();He!==Yf&&(this.Vv&&this.Vv.SA(),this.X4&&this.X4.SA());N.a.J(509092099,
815,50,"ImageDescrptionPaneNew.showHideAltTextPaneInternal {0} to {1}",Yf,He)};this.vje=()=>{this.Fa&&this.Fa.wj(Fd.a.VQ,!0);this.Mz=this.jb.Qf();this.R_c();this.Ab=!0;this.ob.appendChild(this.JH);this.ob.style.display=Hc.a.Tj;this.Faf();this.jb.FC(this.onSelectionChange);N.a.J(509092098,815,50,"ImageDescriptionPaneNew.initializeAndShowAltTextPane");if(this.kic){try{var He=this.kic.value}catch(Yf){N.a.J(509092096,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab: {0}",
Yf.toString());return}if(He){He.processAction(wb.a.PIc,1);He=!1;try{this.Vv.selectRibbonTabById("AccessibleAuthoring"),He=!0}catch(Yf){N.a.J(509092066,822,10,"ImageDescriptionPaneNew: can't select ribbon tab AccessibleAuthoring: {0}",Yf.toString())}oc.a("AccessibleAuthoringTab",He);this.azh()}else N.a.J(509092067,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else N.a.J(509092097,822,10,"ImageDescriptionPaneNew: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")};
this.a_d=()=>{this.Ab&&(this.Fa&&this.Fa.wj(Fd.a.VQ,!1),this.jb.Cga(this.onSelectionChange),this.PLa(),this.Ab=!1,this.ob.removeChild(this.JH),this.ob.style.display=Hc.a.Qe,this.Faf(),N.a.J(509092100,815,50,"ImageDescriptionPaneNew.cleanUpAndHideAltTextPane"))};this.dispose=()=>{this.a_d();this.yR&&this.yR.Bb(Fa.a.Df,this.ob,this.Xuh);this.Rc.Bb(Fa.a.click,this.gl,this.gDa);this.vR.removeHandler(this.Km,Fa.a.input,this.GCf);this.Rc.Bb(Fa.a.click,this.Mw,this.r7b);this.Rc.Bb(Fa.a.click,this.eXa,this.HEf);
this.yR&&this.yR.Bb(Fa.a.Df,this.F0,this.IEf);this.Rc.Bb(Fa.a.click,this.FYa,this.$4g);this.yR&&this.yR.Bb(Fa.a.Df,this.hY,this.a5g);this.Kva.xrh(this.Onc);this.Ur&&this.Ur.Qm(this.$g);this.sic=this.oEe=this.hY=this.FYa=this.Pfb=this.Fec=this.dve=this.F0=this.eXa=this.yva=this.Xva=this.t$=this.Mw=this.Km=this.afb=this.DHa=this.EHa=this.gl=this.Pma=this.Ugc=this.JH=this.ob=void 0;this.u_d();this.o2b();N.a.J(509092065,815,50,"ImageDescriptionPaneNew.dispose")};this.layout=(He,Yf)=>{const Rg=Yf?He.AG(this.width):
He.BG(this.width);this.Ab&&(Yf?(Sys.UI.DomElement.addCssClass(this.ob,"ImageDescriptionPaneRTL"),Rg.AG(1)):(Sys.UI.DomElement.addCssClass(this.ob,"ImageDescriptionPaneLTR"),Rg.BG(1)));Ib.a.K6(this.ob,Rg);return He};this.nPh=He=>{this.jDe&&He===this.Mz[0]&&this.Ab&&(this.dfb.Gb(He.id.toString())&&this.Mz[0].Uf!==this.dfb.ga(He.id.toString())&&N.a.J(509092064,815,50,"ImageDescriptionPaneNew.updateAltTextbox - Image version have been changed after generate description"),this.R_c())};this.I3e=()=>{this.J3e(!this.Ab)};
this.GEf=()=>{this.J3e(!0);this.F0.checked||this.qWd(0,!1)};this.Y5d=()=>{this.J3e(!0)};if(!Ca)throw Error.argumentNull("clickInputManager");if(!pb)throw Error.argumentNull("selectionManager");if(!Sb)throw Error.argumentNull("focusManagerHelper");if(!Cc)throw Error.argumentNull("inputHandlerManager");if(!ed)throw Error.argumentNull("transactionFactory");if(!Zd)throw Error.argumentNull("coreExtEventSource");this.Gg=u;this.Fa=ad;this.ei=la;this.Rc=Ca;this.yR=Ta;this.jb=pb;this.LB=Sb;this.vR=Cc;this.Fb=
ed;this.Kva=Zd;this.uD=We;this.kic=Qf;this.Vv=Af;this.X4=Ph;this.Ur=pf;this.Ab=!1;this.ob=Ib.a.ee();this.ob.className="ImageDescriptionPaneNew";this.ob.id="ImageDescriptionPaneNew";this.ob.style.position=Hc.a.tba;this.ob.setAttribute(Ja.a.hf,Ja.a.nsa);this.ob.setAttribute(Ja.a.t_,"ImageDescriptionPaneLabel");this.yR&&this.yR.ub(Fa.a.Df,this.ob,this.Xuh);this.JH=Ib.a.ee();this.JH.className="ImageDescriptionPaneLayoutRootNew";this.Ugc=Ib.a.ee();this.Ugc.className="ImageDescriptionPaneHeader";this.JH.appendChild(this.Ugc);
this.Pma=Ib.a.ee();this.Pma.id="ImageDescriptionPaneLabel";this.Pma.className="ImageDescriptionPaneTitle";this.Pma.innerText=ResourceStrings.L_ShapeAltTextNew;this.Ugc.appendChild(this.Pma);this.gl=document.createElement(Ib.a.ULc);this.gl.type="button";this.gl.setAttribute(Ja.a.fr,CommonUIStrings.l_DialogClose);this.gl.appendChild(e("M 1581 557 l -466 467 l 466 467 l -90 90 l -467 -466 l -467 466 l -90 -90 l 466 -467 l -466 -467 l 90 -90 l 467 466 l 467 -466 z",20,20).xa);this.gl.className="ImageDescriptionPaneCloseButtonNew";
this.Ugc.appendChild(this.gl);this.Rc.ub(Fa.a.click,this.gl,this.gDa);this.EHa=Ib.a.ee();this.EHa.innerText=ResourceStrings.L_ImageDescriptionPaneLabelRefresh;this.EHa.className="ImageDescriptionLabelNew";this.JH.appendChild(this.EHa);this.DHa=Ib.a.ee();this.DHa.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.DHa.className="ImageDescriptionHintNew";this.JH.appendChild(this.DHa);this.afb=Ib.a.ee();this.Km=document.createElement(Ib.a.TJl);this.Km.className="AltTextTextAreaNew";this.Km.setAttribute(Ja.a.fr,
ResourceStrings.L_ShapeAltTextNew);this.afb.appendChild(this.Km);this.JH.appendChild(this.afb);this.vR.addHandler(this.Km,Fa.a.input,this.GCf);u=Ib.a.Hl();u.className="GenerateDescriptionButtonText";u.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltipNew;this.Mw=document.createElement(Ib.a.ULc);this.Mw.type="button";this.Mw.className="ImageDescriptionPaneGenerateButtonNew";this.Mw.appendChild(u);this.JH.appendChild(this.Mw);this.Rc.ub(Fa.a.click,this.Mw,this.r7b);u=e("M1039.84,0.126321c261.41,4.108,517.2,108.271,709.24,300.861c292.63,293.471,379.52,734.393,220.11,1116.953c-154.43,370.6,-510.5,615.63,-909.38,629.51l-34.61,0.55l-16.1,-0.67c-72.623,-7.38,-129.295,-68.71,-129.295,-143.29c0,-74.57,56.672,-135.9,129.295,-143.28l12.8,-0.64c0,-0.07,0,-0.13,0,-0.19c297.81,0.84,566.77,-177.91,681.33,-452.82c114.55,-274.92,52.11,-591.774,-158.18,-802.668c-210.29,-210.893,-526.96,-274.235,-802.182,-160.458c-275.227,113.778,-454.739,382.239,-454.739,680.066l-288.129,0c0,-414.442,249.801,-788.021,632.795,-946.349c131.654,-54.426,270.122,-79.727,407.045,-77.575z",
16,16).xa;this.t$=Ib.a.Hl();this.t$.setAttribute(Ja.a.hf,Ja.a.bFf);this.t$.setAttribute(Ja.a.eLc,Ja.a.HWd);this.Xva=Ib.a.ee();this.Xva.className="ImageDescriptionPaneGeneratingMessage";this.Xva.appendChild(u);this.Xva.appendChild(this.t$);this.JH.appendChild(this.Xva);this.yva=Ib.a.ee();this.yva.className="ImageDescriptionCheckboxContainer";this.eXa=document.createElement(Ib.a.jwg);this.eXa.setAttribute("for","ImageDescriptionCheckboxApprove");this.eXa.innerText=ResourceStrings.L_ApproveAltText;this.yva.appendChild(this.eXa);
this.F0=Ib.a.jPc();this.F0.setAttribute("type","checkbox");this.F0.setAttribute(Ja.a.Uca,"ImageDescriptionTipApprove");this.F0.id="ImageDescriptionCheckboxApprove";this.eXa.appendChild(this.F0);this.dve=Ib.a.Hl();this.dve.className="checkmark";this.eXa.appendChild(this.dve);this.Fec=Ib.a.ee();this.Fec.className="ImageDescriptionInlineTip";this.Fec.innerText=ResourceStrings.L_ApproveAltTextTip;this.Fec.id="ImageDescriptionTipApprove";this.yva.appendChild(this.Fec);this.JH.appendChild(this.yva);this.Rc.ub(Fa.a.click,
this.eXa,this.HEf);this.yR&&this.yR.ub(Fa.a.Df,this.F0,this.IEf);this.Pfb=Ib.a.ee();this.Pfb.className="ImageDescriptionCheckboxContainer";this.FYa=document.createElement(Ib.a.jwg);this.FYa.setAttribute("for","ImageDescriptionCheckboxDecorative");this.FYa.innerText=ResourceStrings.L_MarkAsDecorative;this.Pfb.appendChild(this.FYa);this.hY=Ib.a.jPc();this.hY.setAttribute("type","checkbox");this.hY.setAttribute(Ja.a.Uca,"ImageDescriptionTipDecorative");this.hY.id="ImageDescriptionCheckboxDecorative";
this.FYa.appendChild(this.hY);this.oEe=Ib.a.Hl();this.oEe.className="checkmark";this.FYa.appendChild(this.oEe);this.sic=Ib.a.ee();this.sic.className="ImageDescriptionInlineTip";this.sic.innerText=ResourceStrings.L_MarkAsDecorativeTip;this.sic.id="ImageDescriptionTipDecorative";this.Pfb.appendChild(this.sic);this.JH.appendChild(this.Pfb);this.Rc.ub(Fa.a.click,this.FYa,this.$4g);this.yR&&this.yR.ub(Fa.a.Df,this.hY,this.a5g);this.LB.C4(Fd.a.VQ,Fd.a.$i,this.ob,()=>{},()=>{},!0);this.Kva.kBf(this.Onc);
this.Ur&&this.Ur.gk(this.$g);this.H9c=this.bgd=0}get width(){return this.Ab?264+od.a.Vya:0}get xa(){return this.ob}get order(){return 10}get isVisible(){return this.Ab}}Object(r.a)(Bf,"ImageDescriptionPaneNew",null,[1083,654,108]);var be=d(343);class af{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ImageDescription"}Xb(u){this.K=u;this.K.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").na().oa(()=>new be.a(P=>
{let la=null;const Ca=Object(U.a)(117,P.qc(u.resolve("Box4.IPageView").Na));Ca&&!Ca.Ml&&(la=this.K.resolve("PowerPointWebEditor.IApplicationSettings").w3?new Yc(P,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")):new ob(P,this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Nd),la.Bm(Ca.nV),Ca.$ra(la,4));return la}));this.K.register(1083,"PowerPointWebEditor.IImageDescriptionPane").na().oa(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").w3?new Bf(this.K.resolve("Common.IF6Manager"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.K.ue("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IContextMenuUser"),this.K.resolve("Box4.Graph.IGraphInstance").zd(10)):new ee(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Fb,"PowerPointWebEditor.ImageDescriptionManager").na().oa(()=>new Fb(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").zd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").w3))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uua&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Uua&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){m.a.instance.Ac(uc.a(new af,
0))}}Object(r.a)(af,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var Ue=d(80);class qf extends Ue.a{constructor(u){super(!1,!1,!0);this.gob=u}start(){var u={["tooltipPersistenceEnabled"]:this.gob.oie};t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(u.textSelectionChangeEnabled=this.gob.S7e);u={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:u};this.sj("",Object(z.a)(this,this.ehl,"resultHandler"),u)}ehl(u,P){1===u&&(this.gob.oie=
P.tooltipPersistenceEnabled,t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.gob.S7e=P.textSelectionChangeEnabled))}}Object(r.a)(qf,"AccessibilitySettingsDialog",Ue.a,[]);class Xa{constructor(u,P){this.Ca=u;this.gob=P}vb(){this.Ca.ya(F.a.xzl,J.a.frame,Object(z.a)(this,this.yzl,"showAccessibilitySettingsDialogHandler"))}yzl(){(new qf(this.gob)).start();return 32}}Object(r.a)(Xa,"AccessibilitySettingsDialogActor",null,[1261]);
var vb=d(1098);const cc=u=>{const P=new vb.a;t.AFrameworkApplication.Je.qj(wc(u),1,null,null,!0,2,la=>{200===la.data.Oe?P.Ng("true"===la.data.Wd.toLowerCase()):P.Ng(!1)},()=>{P.Ng(!1)},null,void 0,void 0,void 0,void 0,"7");return P.task},wc=u=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",t.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",u,t.AFrameworkApplication.Pg);var Ad=d(69);class Md{constructor(){this.lRd=this.Tpb=null}get oie(){return!!this.Tpb}set oie(u){u!==
this.Tpb&&(this.Tpb=u,Ad.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(u),this.ztg()&&t.AFrameworkApplication.Je.qj(wc("saveHoverableRibbonTooltipIsEnabled"),2,u.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get S7e(){return!!this.lRd}set S7e(u){u!==this.lRd&&(this.lRd=u)}Sck(){const u=new vb.a;if(this.Tpb)u.Ng(this.Tpb);else if(this.ztg()){const P=cc("getHoverableRibbonTooltipIsEnabled");P.continueWith(()=>{this.Tpb=P.result;
Ad.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(P.result);u.Ng(P.result)},8)}else u.Ng(!1)}ztg(){const u=t.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),P=t.AFrameworkApplication.fa.ka("IsAnonymousUser");return u&&!P}}Object(r.a)(Md,"AccessibilitySettingsInfo",null,[1260]);class Sd{constructor(){this.Ea=null}get name(){return"Common.App.AccessibilitySettings"}Xb(u){this.Ea=u;this.Ea.register(Md,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").oa(()=>
new Md).na();this.Ea.register(Xa,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").oa(()=>new Xa(t.AFrameworkApplication.Qa,this.Ea.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).na()}init(){const u=this.Ea.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),P=this.Ea.rb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");u&&P?(P.vb(),u.Sck()):Q.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){m.a.instance.Ac(new Sd)}}Object(r.a)(Sd,"AccessibilitySettingsPackage",null,[2,3]);var Le=d(94),fe=d(223),Vf=d(1165),Cd=d(77),Sc=d(727);class jg extends Sa.StandardDialog{constructor(u,P,la,Ca=null){super();this.i3=this.xs=this.yOa=null;this.rw=[];this.tFc=P;this.$P=u;this.t1h=la;this.QGc=Ca;this.asb=new Sc.a("LoadResource","LoadPrintablePdf")}lka(){this.Ad=
5;this.width=40;const u=document.createElement("span");u.id=this.Vh("DirectPrintHeaderContent");const P=document.createElement("span");P.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(P,"DirectPrintHeader");this.i3=document.createElement("iframe");this.i3.name="pdfObjectFrame";this.i3.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.i3.onload=Object(z.a)(this,this.RXk,"printablePdfLoaded");if(this.QGc&&0<this.QGc.count){var la=Cd.a.pde(this.tFc,this.QGc);const Ca=
Cd.a.QWe(this.tFc,this.QGc);this.xs=document.createElement("form");this.xs.id="printPreviewPostForm";this.xs.method="POST";this.xs.target=this.i3.name;this.xs.action=Ca;for(let Ta of la)la=document.createElement("input"),la.type="hidden",la.name=Ta.key,la.value=Ta.value,this.xs.appendChild(la)}else this.i3.setAttribute("src",this.tFc);Sys.UI.DomElement.addCssClass(this.i3,fe.a.sqf);this.t1h?(Sys.UI.DomElement.addCssClass(this.i3,"DirectPrintPdfObjectHidden"),P.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
Ja.a.gS(this.i3,Ja.a.NI,Ja.a.rB)):(Sys.UI.DomElement.addCssClass(this.i3,"DirectPrintPdfObject"),this.rw.push(this.i3));u.appendChild(P);u.appendChild(document.createElement("br"));u.appendChild(this.i3);this.xs&&u.appendChild(this.xs);u.appendChild(document.createElement("br"));u.appendChild(this.FJi(this.xs?"#":this.tFc));this.asb.start();this.jIb(CommonUIStrings.l_AppTitle,null,null,null,null,u);this.J6(this.Vh("DirectPrintHeaderContent"));this.xs&&this.xs.submit();this.lOi();n.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}FJi(u){const P=document.createElement("span");var la=document.createElement("span");la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;P.appendChild(la);t.AFrameworkApplication.fa&&(2===t.AFrameworkApplication.Aa.mb.Ti&&t.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===t.AFrameworkApplication.Aa.mb.Ti&&t.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(u=document.createElement("span"),2===
t.AFrameworkApplication.Aa.mb.Ti?u.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===t.AFrameworkApplication.Aa.mb.Ti&&(u.innerText=CommonUIStrings.l_InternalError_Directive,n.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.yOa=u,P.appendChild(document.createElement("br")),P.appendChild(u)):(la=document.createElement("a"),la.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,la.href=u,la.target="_blank",la.id="PrintPDFLink",la.className=
"AllowBrowserClick",this.yOa=la,P.appendChild(document.createElement("br")),P.appendChild(la),this.xs&&Le.a.addHandler(la,"click",Object(z.a)(this,this.MOe,"onSubmit")),this.$P.ub(Fa.a.click,this.yOa,Object(z.a)(this,this.aXf,"downloadPDFLinkClicked"),null));this.rw.push(this.yOa);return P}MOe(u){this.xs&&(this.xs.target="_blank",this.xs.submit());u.preventDefault()}lOi(){if(0<this.rw.length){const u=new Vf.a(this.rw),P=kd.FocusManager.instance().Kl();P&&(this.yOa.focus(),P.Gj=u,P.GX=!0)}}aXf(){n.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}zdb(){n.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}RXk(){n.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.asb&&this.asb.stop()}dispose(){this.yOa&&(this.$P.Bb(Fa.a.click,this.yOa,Object(z.a)(this,this.aXf,"downloadPDFLinkClicked")),this.yOa=null);ab.a.sP(this.i3);this.i3=null;super.dispose()}}Object(r.a)(jg,"DirectPrintDialog",Sa.StandardDialog,[1296]);class mg{constructor(u){this.$P=
u}Yij(u,P){return new jg(this.$P,u,P,null)}}Object(r.a)(mg,"DirectPrintDialogFactory",null,[1280]);var Pa=d(1252),bb=d(65);class Fc{constructor(u,P){this._url=u;this.w6h=P}FWf(){this.w6h?bb.a.downloadFile(this._url):bb.a.In(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(r.a)(Fc,"OpenUrlInTabDialogDownloadBehavior",null,[1188,108]);var yd=d(56);class ge extends Sa.StandardDialog{constructor(u,P=!0,la=!1,Ca=null,Ta=null,pb=!1,Sb=null){super();this.Kpb=
this.Jpb=this.xs=this.mca=null;var Cc=this.m8e?this.m8e:CommonUIStrings.l_DefaultDialogTitle;ge.Szb=pb;this.XXh=Sb;this.gFd=Ca||new Fc(u,!0);const ed=[],ad=[];ge.w2&&(this.nKc&&this.nKc.forEach(We=>{Array.add(ed,We)}),this.TBf&&this.TBf.forEach(We=>{Array.add(ad,We)}));P?la?this.E1c?(this.Ad=12,this.Le(1,this.buttonText),this.Le(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.Le(3,CommonUIStrings.l_DialogClose)):this.lpg?(this.Ad=12,this.Le(1,this.buttonText),this.Le(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),
this.Le(3,CommonUIStrings.l_DialogClose)):this.Wpg?(this.Ad=12,this.Le(1,this.buttonText),this.Le(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.Le(3,CommonUIStrings.l_DialogClose)):(this.Ad=4,this.Le(1,this.buttonText),this.Le(2,CommonUIStrings.l_DialogClose)):(this.Ad=6,this.Le(0,CommonUIStrings.l_DialogClose)):this.Ad=5;pb=document.createElement("span");this.b4b&&(pb.className=this.b4b);Ca=document.createElement("a");Ca.innerText=this.NCb;Ca.href=u;Ca.target="_blank";Ca.id=this.Jdc;
Ca.className=sa.AFrame.zCf;if(Sb=!yd.a.dU&&!!Ta&&0<Ta.count){const We=Cd.a.pde(u,Ta);Ta=Cd.a.QWe(u,Ta);Ca.href="#";Ca.target="_self";this.xs=document.createElement("form");this.xs.id="printPreviewPostForm1";this.xs.method="post";this.xs.target="_blank";this.xs.action=Ta;for(var Zd of We)Ta=document.createElement("input"),Ta.type="hidden",Ta.name=Zd.key,Ta.value=Zd.value,this.xs.appendChild(Ta)}else this.xs=null;this.xs||ge.Szb?ge.Szb||Array.add(ad,{["type"]:"AppLinkProps",["id"]:this.Jdc,["text"]:this.NCb,
["onExecute"]:()=>{this.Lnh()}}):Array.add(ad,{["type"]:"AppLinkProps",["id"]:this.Jdc,["text"]:this.NCb,["handler"]:{["href"]:Sb?"#":u,["target"]:Sb?"_self":"_blank"}});this.Vna&&Array.add(ed,this.Vna);la?(u=document.createElement("span"),u.innerText=this.Vna.replace("{0}",""),pb.appendChild(u)):this.k6g?(u=document.createElement("span"),u.id=this.Vh("message"),Zd=document.createElement("span"),Ta=document.createElement("span"),Sb=this.Vna.split("{0}"),Zd.innerText=Sb[0],Ta.innerText=Sb[1],u.appendChild(Zd),
u.appendChild(Ca),u.appendChild(Ta),pb.appendChild(u)):(u=document.createElement("span"),u.innerText=this.Vna,pb.appendChild(u),pb.appendChild(document.createElement("br")),pb.appendChild(document.createElement("br")),pb.appendChild(Ca),ge.Szb||Array.add(ed,"{0}"));this.xs&&pb.appendChild(this.xs);ge.w2&&(this.HWa&&(this.Gdc?this.izf(this.HWa,this.Gdc):(Array.add(ed,"{0}"),Array.add(ad,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.HWa,["onExecute"]:()=>{this.B5c()}}))),this.eJc(ed,
ad));this.jIb(Cc,null,this.tie,null,Object(z.a)(this,this.V3,"dialogHandler"),ge.w2?null:pb);this.J6(this.Vh("message"));!ge.w2&&this.Gdc&&this.HWa&&(Cc=document.createElement("div"),Cc.className="WACDialogLearnMoreLinkContainer",this.mca=document.createElement("a"),this.mca.innerText=this.HWa,this.mca.href=this.Gdc,this.mca.target="_blank",this.mca.id=this.Vh("LearnMoreLinkId"),this.mca.className=sa.AFrame.zCf,Cc.appendChild(this.mca),P?this.Jb.insertBefore(Cc,this.Jb.lastChild):this.Jb.appendChild(Cc),
this.J6(String.format("{0} {1}",this.Vh("message"),this.Vh("LearnMoreLinkId"))));this.dUb=Ca;la?this.jS(this.QD):this.jS(this.dUb);this.XCb();t.AFrameworkApplication.Aa.tS.ub(Fa.a.click,this.dUb,Object(z.a)(this,this.$Wf,"downloadLinkClicked"),null);this.mca&&t.AFrameworkApplication.Aa.tS.ub(Fa.a.click,this.mca,Object(z.a)(this,this.B5c,"learnMoreLinkClicked"),null);this.Ggf=!1}get tie(){return null}get m8e(){return null}get Vna(){return null}get wzi(){return this.XXh}get Gdc(){return null}get HWa(){return null}get k6g(){return!1}get buttonText(){return CommonUIStrings.l_Open}get b4b(){return null}get nKc(){return null}get TBf(){return null}get E1c(){return!1}get lpg(){return!1}get Wpg(){return!1}PPf(){this.Jda({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}p0i(){this.Jda({SourceControlId:"Share"},{ControlId:"Share"})}Jda(u,P){const la=t.AFrameworkApplication.Qa;la.Lp=8;la.Ja(F.a.Jda,2,u,P)}x8(){this.xs&&(this.Jpb||(this.Jpb=Object(z.a)(this,this.lEk,"onActionButtonClicked"),this.Ln.ub(Fa.a.click,this.QD,this.Jpb)),this.Kpb||(this.Kpb=Object(z.a)(this,this.mEk,"onActionButtonKeyUp"),this.Wg.ub(Fa.a.Tl,this.QD,this.Kpb)));super.x8()}lEk(u){this.y_f(u);return!0}mEk(u){return this.Y4c(u,Object(z.a)(this,this.y_f,"executeDismissActionButtonFromArgs"))}y_f(u){this.xs&&
this.xs.submit();this.T9a(u.Bc)}zdb(){}$Wf(){this.Ydc();this.xs?this.xs.submit():this.gFd.FWf();return!0}B5c(){return!1}dispose(){this.gFd.dispose();this.dUb&&(t.AFrameworkApplication.Aa.tS.Bb(Fa.a.click,this.dUb,Object(z.a)(this,this.$Wf,"downloadLinkClicked")),this.dUb=null);this.mca&&(t.AFrameworkApplication.Aa.tS.Bb(Fa.a.click,this.mca,Object(z.a)(this,this.B5c,"learnMoreLinkClicked")),this.mca=null);this.Ln&&this.Jpb&&(this.Ln.Bb(Fa.a.click,this.QD,this.Jpb),this.Jpb=null);this.Wg&&this.Kpb&&
(this.Wg.Bb(Fa.a.Tl,this.QD,this.Kpb),this.Kpb=null);super.dispose()}Lnh(){this.xs&&(document.body.appendChild(this.xs),this.xs.submit(),document.body.removeChild(this.xs))}V3(u){1===u?(this.zdb(),this.xs?ge.w2&&this.Lnh():this.gFd.FWf()):2===u&&(this.lpg||this.E1c?this.PPf():this.Wpg&&this.p0i());this.dispose()}static get w2(){return t.AFrameworkApplication.Aa.mb.gD&&t.AFrameworkApplication.Aa.mb.ktg}static get Szb(){return ge.Mjf}static set Szb(u){ge.Mjf=u}}ge.Mjf=!1;Object(r.a)(ge,"ADialogWithLinkToResource",
Sa.StandardDialog,[]);class rb extends ge{constructor(u,P,la=null,Ca=!0,Ta=!1,pb=null){super(u,!0,!(rb.k3a&&Ca),new Fc(u,P),la,Ta,pb);rb.k3a=rb.k3a&&Ca;if(rb.k3a){P=document.createElement("iframe");Ca=null;Ta=this.hXi;P.name="pdfObjectFrame";P.id="pdfObjectIFrame";if(la&&0<la.count){pb=Cd.a.pde(u,la);u=Cd.a.QWe(u,la);Ca=document.createElement("form");Ca.id="printPreviewPostForm";Ca.method="POST";Ca.target=P.name;Ca.action=u;for(let Sb of pb)u=document.createElement("input"),u.type="hidden",u.name=
Sb.key,u.value=Sb.value,Ca.appendChild(u)}else P.src=u;Ta.appendChild(P);Ca&&(Ta.appendChild(Ca),Ca.submit());Sys.UI.DomElement.addCssClass(P,"DirectPrintPdfObjectHidden");Ja.a.gS(P,Ja.a.NI,Ja.a.rB)}}get tie(){return"Print_32x32x32"}get m8e(){return rb.k3a?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Vna(){return rb.k3a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get nKc(){const u=[];Array.add(u,CommonUIStrings.l_PrintDialogCanCloseDocument);if(ge.Szb){let P=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;
""!==t.AFrameworkApplication.Aa.mb.bTf&&(P=t.AFrameworkApplication.Aa.mb.bTf);Array.add(u,P)}return rb.k3a?u:null}get NCb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Jdc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get b4b(){return t.AFrameworkApplication.ata?"UIFontDialogTextLarge":null}XCb(){n.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Ydc(){t.AFrameworkApplication.Ci.Gbb(9540,1);n.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}zdb(){n.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")}static get k3a(){return!!t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.gD&&t.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(yd.a.dU||yd.a.Yj||yd.a.mg||yd.a.Dcc)&&!t.AFrameworkApplication.fdc&&t.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set k3a(u){}}Object(r.a)(rb,"PrintDialogWithLinkToPdf",ge,[]);class gf{constructor(u){this.isEnabled=Boolean.parse(u.DirectPrintIsEnabled||
"false");this.g5j=Boolean.parse(u.DirectPrintProbeIsEnabled||"false");this.A1j=Boolean.parse(u.DirectPrintEnabledForInternetExplorer||"false");this.Dmb=(u.DirectPrintSupportedMimeTypes||"").split(gf.N4d);this.r2a=(u.DirectPrintSupportedPlugins||"").split(gf.N4d);this.ePj=(u.DirectPrintImmersivePreviewPlugins||"").split(gf.N4d);this.Spg=Boolean.parse(u.DirectPrintEnabledForEdge||"false");this.YXj=Boolean.parse(u.ChromePrintLayoutFixIsEnabled||"false");this.gDi=parseInt(u.ChromeVersionFromWhichPrintLayoutIsEnabled||
"76");this.pKe=14;this.m6g=14394;if(u=u.DirectPrintMinimalSupportedEdgeVersion){const P=u.split(".");2===P.length?(this.pKe=parseInt(P[0]),this.m6g=parseInt(P[1])):n.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",u)}else n.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}gf.N4d=",";Object(r.a)(gf,"DirectPrintBrsSettings",null,[]);class Ab{constructor(u,P){this.o6e=
u;this.r2a=P}}Object(r.a)(Ab,"DirectPrintProbeResults",null,[]);var fc=d(199),kc=d(106);class ud{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad){this.xIc=null;this.$Zh=u;this.kXb=P;this.ELd=la;this.L2h=Ca;this.F3h=Ta;this.ZXb=new Pa.a(Object(z.a)(this,this.asj,"getProbeResults"));this.LEd=pb;this.Znf=ed;this.uQd=Sb;this.G3h=Cc;this.V3h=ad}get vL(){return this.$Zh}start(){}dYk(){this.vL.g5j&&this.tgk()}f0k(){const u=Array(this.vL.Dmb.length);if(void 0!==this.kXb&&null!==this.kXb)for(let P=0;P<this.vL.Dmb.length;P++)u[P]=
this.vL.Dmb[P]in this.kXb&&this.L2h(this.kXb[this.vL.Dmb[P]]);return u}g0k(){const u=Array(this.vL.r2a.length),P=!(void 0===this.ELd||null===this.ELd);for(let la=0;la<this.vL.r2a.length;la++){const Ca=this.vL.r2a[la];u[la]=P&&Ca in this.ELd?!0:this.F3h(Ca)}return u}Fxj(){const u=this.f0k(),P=Array(u.length);for(let la=0;la<u.length;la++)P[la]=u[la]?this.O4i(this.kXb[this.vL.Dmb[la]]):null;return P}O4i(u){if(void 0===u||null===u)return null;u=u.enabledPlugin;return void 0===u||null===u?null:u.name}tgk(){n.ULS.sendTraceTag(4535643,
328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.ZXb.value.o6e,this.ZXb.value.r2a)}asj(){var u=this.Fxj();const P=this.g0k(),la={},Ca={};for(let Ta=0;Ta<this.vL.Dmb.length;Ta++)la[this.vL.Dmb[Ta]]=u[Ta];for(u=0;u<this.vL.r2a.length;u++)Ca[this.vL.r2a[u]]=P[u];return new Ab(la,Ca)}nzl(){return this.V3h||!this.vL.isEnabled||t.AFrameworkApplication.fdc?!1:this.pHl()}aEh(){if(null!=this.xIc)return this.xIc;const u=ud.Qpg(this.vL);return this.xIc=this.vL.Spg&&u||this.VXj()}VXj(){return yd.a.ik&&this.vL.YXj&&
yd.a.fNc>=this.vL.gDi?!0:!1}pHl(){if(!this.G3h(this.vL))return!1;var u=kc.a.Hfe(this.ZXb.value.o6e);for(const P of u)if(void 0!==P&&null!==P)return!0;u=kc.a.Hfe(this.ZXb.value.r2a);for(const P of u)if(P)return!0;return!1}VKj(){const u=kc.a.Hfe(this.ZXb.value.o6e);for(const P of u)if(fc.a.contains(this.vL.ePj,P))return!0;return!1}jFh(u){t.AFrameworkApplication.Aa&&t.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.Znf(u,null):this.nzl()?this.pYi(u,this.VKj()&&!0):this.Znf(u,
null)}pYi(u,P){const la=this.uQd.Ii("UserAction","OpenDirectPrintDialog");this.LEd.Yij(u,P).lka();la.stop()}static S7j(u){try{return new ActiveXObject(u),!0}catch(P){n.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",u)}return!1}static c_j(u){return void 0===u||null===u?!1:!(void 0===u.enabledPlugin||null===u.enabledPlugin)}static create(u){const P=new gf(t.AFrameworkApplication.fa.appSettings);let la=null;try{la=window.navigator.mimeTypes}catch(ad){n.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}let Ca=null;try{Ca=window.navigator.plugins}catch(ad){n.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Ta=ud.c_j,pb=ud.S7j;u=u.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Sb=t.AFrameworkApplication.Aa.BV,Cc=ud.T7j,ed=!!t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.gD&&!t.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new ud(P,la,Ca,Ta,pb,u,Sb,Cc,(ad,Zd)=>new rb(ad,
!1,Zd,!0,ed),t.AFrameworkApplication.isEmbedded)}static T7j(u){return yd.a.ik||yd.a.Yj&&u.A1j||u.Spg&&ud.Qpg(u)?!0:!1}static Qpg(u){var P=yd.a.MSa;if(P){var la=P.split(".");if(2===la.length)return P=parseInt(la[0]),la=parseInt(la[1]),P>u.pKe||P===u.pKe&&la>=u.m6g}return!1}}Object(r.a)(ud,"DirectPrintManager",null,[1142]);class zd{constructor(){this.wgf=this.Ea=null}get name(){return"Common.App.DirectPrint"}Xb(u){this.Ea=u;u.register(mg,"Common.App.DirectPrint.DirectPrintDialogFactory").na().oa(()=>
new mg(t.AFrameworkApplication.Aa.tS));u.register(1142,"Common.App.DirectPrint.IDirectPrintManager").na().oa(()=>ud.create(this.Ea))}init(){this.wgf=this.Ea.resolve("Common.App.DirectPrint.IDirectPrintManager");this.wgf.start()}dispose(){}}Object(r.a)(zd,"PackageManager",null,[2,3]);var Td=d(1171),Me=d(301);class tf{constructor(u,P){this.vUb=null;this.Ca=u;this.Ma=P}vb(){(this.vUb=this.Ma.Ha("StatusBarEnvironmentNameToUse"))&&""!==this.vUb&&this.Ca.ra(F.a.vTe,J.a.frame,Object(z.a)(this,this.WSl,"updateEnvironmentName"),
96)}WSl(u,P,la,Ca,Ta){if(1===la)return 32;Ta[Td.a.Value]=this.vUb;Ta[Me.a.labelText]=this.vUb;Ta[Td.a.Visible]=!0;return 32}}Object(r.a)(tf,"DisplayEnvironmentName",null,[]);class re{constructor(){this.Ea=null}get name(){return"Common.App.DisplayEnvironmentName"}Xb(u){this.Ea=u;this.Ea.register(tf,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").na().oa(()=>new tf(t.AFrameworkApplication.Qa,t.AFrameworkApplication.fa))}init(){this.Ea.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").vb()}dispose(){}static main(){m.a.instance.Ac(new re)}}
Object(r.a)(re,"DisplayEnvironmentNamePackage",null,[2,3]);var lh=d(185),ze=d(560);class Je extends ze.a{constructor(u){super(u)}get v3b(){return!1}createElement(){const u=document.createElement("link");u.setAttribute("rel","stylesheet");u.setAttribute("type","text/css");u.setAttribute("href",this.ev);return u}gPc(){return null}Brc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.fN.ev)}}Object(r.a)(Je,"CssResource",ze.a,[]);var Wh=d(311),Kg=d(3);class pd{constructor(){this.FFc=
this.FBc=null}Pck(){this.FBc||(n.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.FBc=Kg.Task.WAA(pd.Yck(),pd.Eck()),this.FBc.continueWith(u=>{n.ULS.sendTraceTag(21030599,324,10,"{0}",Gb.a.$ae(u.hj))},5));return this.FBc}Qck(){if(!this.FFc)try{n.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.FFc=Kg.Task.WAA(pd.D6d(Wh.a.create(t.AFrameworkApplication.fa.Ha("DimeUrl"),null,null))),this.FFc.continueWith(u=>{n.ULS.sendTraceTag(39978391,
324,10,"{0}",Gb.a.$ae(u.hj))},5)}catch(u){n.ULS.sendTraceTag(594874951,324,10,"{0}",Gb.a.$ae(u))}return this.FFc}static Yck(){var u=pd.GYc("inproductmessaging.js");u=Wh.a.create(u,null,null);return pd.D6d(u)}static Eck(){var u=pd.GYc("inproductmessaging.css");u=new Je(u);return pd.D6d(u)}static GYc(u){return lh.a.qvb(String.format("ipm/{0}",u))}static D6d(u){Mc.a.py(u);return u.KGa}}Object(r.a)(pd,"DependencyDownloader",null,[1275]);class Nc{}Nc.iPk="inProductMessagingOverlayDiv";Nc.iTk="PlayButtonImage";
Nc.hel="ReplayButtonImage";Object(r.a)(Nc,"Constants",null,[]);class le{constructor(){this.evf=this.wpf=this.Ddf=!0;this.iel=this.jTk=null;this.zBk=!1;this.locale=null;this.tOh={}}get autoPlay(){return this.Ddf}set autoPlay(u){this.Ddf=u}get I6g(){return this.wpf}set I6g(u){this.wpf=u}get ZEh(){return this.evf}set ZEh(u){(this.evf=u)&&this.Hrl()}Hrl(){this.vAf(Nc.iTk,this.jTk);this.vAf(Nc.hel,this.iel)}vAf(u,P){P&&(this.tOh[u]=P)}}Object(r.a)(le,"FirstRunExperienceUISettings",null,[1274]);class Ye{constructor(){this.completed=
this.N9k=!1}}Object(r.a)(Ye,"FirstRunExperienceViewData",null,[1273]);var Zc=d(196);class Jf{constructor(u,P,la){this.Ca=u;this.Yh=P;this.CCc=la}vb(){this.Ca.ra(F.a.h9i,J.a.frame,Object(z.a)(this,this.g9i,"firstRunExperienceHandler"),64);this.Ca.ya(F.a.Y2f,J.a.frame,Object(z.a)(this,this.lPj,"inProductMessagingTabHandler"));this.Ca.ya(F.a.X2f,J.a.frame,Object(z.a)(this,this.kPj,"inProductMessagingShiftTabHandler"));this.Ca.ya(F.a.EXi,J.a.frame,Object(z.a)(this,this.FXi,"dimeLaunchHandler"));this.Ca.ya(F.a.Ish,
J.a.frame,Zc.ActionManager.Sg);this.Ca.ya(F.a.Eel,J.a.frame,Zc.ActionManager.Sg);this.Ca.ya(F.a.Fel,J.a.frame,Zc.ActionManager.Sg);this.Yh&&this.Yh.updateCommandUI()}g9i(u,P,la,Ca,Ta){2===la&&this.CCc.Uak(Ta);return 32}FXi(u,P,la,Ca,Ta){2===la&&this.CCc.Tak(Ta);return 32}lPj(u,P,la){return 2===la?this.CCc.NKe():32}kPj(u,P,la){return 2===la?this.CCc.FKe():32}}Object(r.a)(Jf,"InProductMessagingActor",null,[]);class pg{constructor(){this.Gph=this.F6=this.gKh=this.y5c=this.instance=null}}Object(r.a)(pg,
"DimeExperienceUISettings",null,[]);var gd=d(533);class bd{constructor(u,P,la,Ca,Ta){this.wUc=!1;this.L4b=null;this.Ca=u;this.Y6a=P;this.nGc=la;this.Eha=Ca;this.Dha=Ta}URj(u){Ad.b("getHeaderApi")?u.isFeatureEnabled("MsoPremiumBadge",!0).then(P=>{const la=u.isFreemiumUpsellEnabled();la&&(appChrome.getHeaderApi().then(Ca=>{Ca.updatePremiumStatus(P,la);return null}),u.C0a("MsoPremiumBadge",Ca=>{appChrome.getHeaderApi().then(Ta=>{Ta.updatePremiumStatus(Ca.isEnabled,la);return null})}));return null}):
n.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}Uak(u){this.nGc.Pck().continueWith(()=>{this.Y6a.oCl(u)})}Tak(u){let P="gopremium",la=null,Ca=()=>{};u?(u.experience&&""!==Object(U.a)(String,u.experience)&&(P=Object(U.a)(String,u.experience)),u.onTaskComplete&&(Ca=u.onTaskComplete),u.campaignId&&""!==Object(U.a)(String,u.campaignId)&&(la=Object(U.a)(String,u.campaignId))):n.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Kwg(P,Ca,la)}Kwg(u,
P,la=null){if(this.wUc&&this.L4b){const Ca={};Ca.experience=u||"gopremium";Ca.campaignId=la||gd.b(this.Eha,this.Dha,Object(U.a)(String,Ca.experience),!0);this.Ca.processAction(F.a.Ish,2);n.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Ca.experience);try{const Ta=Object.assign(new pg,{instance:this.L4b,y5c:Ca,gKh:P||(()=>{}),F6:pb=>{n.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+pb.status)},Gph:()=>{n.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.wUc=
!1;this.L4b=null}});this.Y6a.HAl(Ta)}catch(Ta){n.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Ta.message),this.wUc=!1,this.L4b=null,this.Ca.Ja(F.a.xUc,2,{["experience"]:Ca.experience})}}else n.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.Ja(F.a.xUc,2,{["experience"]:u})}Rck(){this.nGc.Qck().continueWith(()=>{try{var u=Gb.a.ug(t.AFrameworkApplication.uiCulture);const Ca=gd.c(this.Eha);if(Ca){var P={};P.partnerId=Ca;P.language=u;P.sessionId=t.AFrameworkApplication.userSessionId;
P.authHint=t.AFrameworkApplication.fa.Ha("UserPrincipalName");var la=t.AFrameworkApplication.fa.Ha("Puid")||"";""!==la&&(u={},u.puid=la,P.userInfo=u);this.L4b=new Dime(P);this.wUc=!0;n.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else n.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Ca){n.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Ca.message)}},3)}NKe(){return this.Y6a.NKe()}FKe(){return this.Y6a.FKe()}}Object(r.a)(bd,"InProductMessagingUIManager",
null,[1272]);class Ne{constructor(){this.Bwf=0;this.Cqb=Array(5);this.Cqb[0]=10;this.Cqb[1]=15;this.Cqb[2]=50;this.Cqb[3]=100;this.Cqb[4]=200}Init(u){this.Bwf=u}SendTrace(u,P){n.ULS.sendTraceTag(34182235,this.Bwf,this.Cqb[u],"{0}",P)}}Object(r.a)(Ne,"DefaultNetworkingManager",null,[1287]);var rf=d(206);class Fh{constructor(u){this.Pd=u}oCl(u){u&&(InProductMessaging.Networking.NetworkingMgr=new Ne,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(u.ZEh,u.I6g,u.autoPlay,
u.zBk,u.locale,Object(z.a)(this,this.SGk,"onDismissFirstRunExperience"),u.tOh),this.L6(Nc.iPk,!0))}HAl(u){if(u&&u.instance&&u.y5c){let P=document.getElementById("wacDimeContainer");P||(P=document.createElement("div"),P.id="wacDimeContainer",document.body.appendChild(P));t.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.L6("wacDimeContainer",!1);u.y5c.parentElementId="wacDimeContainer";u.instance.launch(u.y5c,u.gKh).then(la=>{this.Roa();document.body.removeChild(P);u.F6(la)}).catch(la=>
{this.Roa();document.body.removeChild(P);u.Gph(la)})}else throw Error.argument("DimeExperienceUISettings");}L6(u,P){if(this.Pd&&u&&(u=document.getElementById(u),this.KRj(u),u=this.Pd.LQ("InProductMessagingFocusId"))){const la=this.Pd.Ee;la&&"InProductMessagingFocusId"===la.name||this.Pd.cV("InProductMessagingFocusId",!1);P&&this.xVe(u.scope)}}KRj(u){var P=this.Pd.Ic("InProductMessagingFocusId");P.parent=sa.AFrame.dE;const la=new rf.DOMFocusListing(()=>u);la.gkb=!1;la.So(3);la.So(2);la.So(4);P=this.Pd.Aja(()=>
u,P,la);P.hkb();P.GX=!0;P.XRa=!0}xVe(u){u.hw(kd.FocusManager.instance().Cra);u.hw(kd.FocusManager.instance().Dra);u.bindAction(kd.FocusManager.instance().Cra,F.a.Y2f);u.bindAction(kd.FocusManager.instance().Dra,F.a.X2f)}Roa(){this.Pd&&(this.Pd.J1("InProductMessagingFocusId"),this.Pd.rMb("InProductMessagingFocusId"))}SGk(u,P){this.Roa();u=Object.assign(new Ye,{completed:u,N9k:P});t.AFrameworkApplication.Qa.Ja(F.a.f9i,2,u)}NKe(){const u=document.activeElement,P=this.Pd.Kl();return u&&P&&P.Gj&&u===P.Gj.BCb?
(P.Gj.mF(u),P.uIb()?32:8):4}FKe(){const u=document.activeElement,P=this.Pd.Kl();return u&&P&&P.Gj&&u===P.Gj.Aka?(P.Gj.mF(u),P.sIb()?32:8):4}}Object(r.a)(Fh,"InProductMessagingUIWrapper",null,[1271]);class Ae{constructor(){this.Ea=null}get name(){return"Common.App.InProductMessaging"}Xb(u){u.register(pd,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").na().oa(()=>new pd);u.register(Fh,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").na().oa(()=>
new Fh(kd.FocusManager.instance()));u.register(bd,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").na().oa(()=>new bd(t.AFrameworkApplication.Qa,u.resolve("Common.IInProductMessagingUIWrapper"),u.resolve("Common.App.InProductMessaging.IDependencyDownloader"),t.AFrameworkApplication.Aa.mb.Ti,t.AFrameworkApplication.Aa.mb.LJa));u.register(Jf,"Common.App.InProductMessaging.InProductMessagingActor").na().oa(()=>new Jf(t.AFrameworkApplication.Qa,t.AFrameworkApplication.Aa,
u.resolve("Common.IInProductMessagingUIManager")));u.register(le,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").na().oa(()=>new le);u.register(Ye,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").na().oa(()=>new Ye);this.Ea=u}init(){this.Ea.resolve("Common.App.InProductMessaging.InProductMessagingActor").vb();t.AFrameworkApplication.fa.$e(()=>{t.AFrameworkApplication.Aa.mb.uO&&Db.a.get_instance().Vj(15,
()=>{this.Ea.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>{this.Ea.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").URj(u)})});t.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&gd.a()&&!yd.a.Fx&&1!==t.AFrameworkApplication.Aa.mb.Ti&&this.Ea.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>{u.isFeatureEnabled("MsoPremiumBadge",!0).then(P=>{!P&&u.isFreemiumUpsellEnabled()&&this.Ea.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Rck();
return null})})})}dispose(){}static main(){m.a.instance.Ac(new Ae)}}Object(r.a)(Ae,"InProductMessagingPackage",null,[2,3]);var Kf=d(400),Mf=d(572);class vf{static X0i(u){return vf.JHf("New",u)}static Y0i(u){return vf.JHf("Open",u)}static rHf(u,P){return vf.d8a("LoadingMenuSection",vf.Ndk,u,vf.k1b("lblLoading",P))}static l1b(u,P,la=null,Ca=null){return vf.d8a("MessageMenuSection",vf.o7g,P,vf.k1b("lblMessage",u,la,Ca))}static ovi(u){return vf.rHf(u,CommonUIStrings.l_VoicedLoadingText)}static pvi(u,
P){return vf.l1b(CommonUIStrings.l_NewCreationLocationMessage,u.labelText,P.ZR,P.vMa)}static nvi(u,P){return vf.l1b(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,P.vMa,"\n\n"),u.labelText)}static tHf(u){return vf.l1b(CommonUIStrings.l_NewGenericErrorMessage,u.labelText)}static lvi(u,P,la){return vf.d8a("menuNewBlank",vf.VLj,la?u.labelText:null,vf.g1b(u.qjg,u.rjg,u.sjg,null,u.vFa,u.U$b,P,"blank"))}static Yvi(){return vf.k1b("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static GHf(){return vf.k1b("lblTemplatesError",
CommonUIStrings.l_NewTemplateErrorMessage)}static Zvi(u,P){return vf.d8a("menuNewTemplates",u,null,P)}static jvi(u,P){return vf.d8a("menuNewMoreTemplates",vf.Z3f,null,vf.g1b("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,u,P))}static kui(u,P,la){let Ca="";la&&P&&(Ca=vf.d8a("BrowseMoreMenuSection",vf.Z3f,null,vf.g1b("btnBrowseMore",P,P,null,null,null,u||"1959943459",la)));return Ca}static k1b(u,P,la=null,Ca=null){let Ta=Ca;P&&0<P.length&&
(Ta=vf.S7g.qKa(P).trimEnd(),Ta=0<=Ta.indexOf("{0}")?String.format(Ta,Ca):String.format("{0} {1}",Ta,Ca));la=la&&Ca?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Gb.a.ze(la),Gb.a.ze(Ca),Gb.a.ze(Ta)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Gb.a.ze(u||""),vf.S7g.qKa(Gb.a.ze(P||"")),la)}static g1b(u,P,la,Ca,Ta,pb,Sb,Cc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
Gb.a.ze(u||""),Gb.a.ze(P||""),Gb.a.ze(la||""),Ca||"32by32",Gb.a.ze(Ta||""),Gb.a.ze(pb||""),Sb,Gb.a.ze(Cc||""))}static JHf(u,P){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',u,P)}static d8a(u,P,la,Ca){la=la?String.format('Title="{0}"',Gb.a.ze(la)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
Gb.a.ze(u||""),Gb.a.ze(P||""),la,Ca)}}vf.o7g="MenuMru";vf.Ndk="MenuLoading";vf.VLj="MenuHeader";vf.Z3f="MenuFooter";vf.S7g=Mf.a.vx("\n","&#10;");Object(r.a)(vf,"NewAndOpenXmlUtilities",null,[]);var eg=d(97);class zf{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(r.a)(zf,"HostInformation",null,[]);var Nd=d(135),Se=d(178),Qe=d(127),Ei=d(444),Ff=d(534);class Jh{constructor(u,P,la,Ca,Ta,pb){this.osb=this.Zn=this.tzc=null;this.eHc=this.TPd=!1;this.ipf=0;this.HPd=this.fJd=
!1;this.tia=u;this.IUb=P;this.cia=new Pa.a(()=>new Kf.a(la.value,Object(z.a)(this,this.UEa,"getMoreInfoEventReceived")));this.A5h=Ca;this.xPa=Ta;this.q$h=pb;this.cZb=this.Xud;this.vDc=!!t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.ka("GateTemplateRenderingByGetMoreInfoResponse");2===this.SH.w1&&(this.HPd=!0);t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.R6i()}get z3(){switch(this.SH.w1){case 3:return"WordWAC";
case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}R6i(){Nd.a.instance.Hb(new O.a(5,1,0,()=>{this.getTemplateListJson()}))}vb(){const u=this.SH.FIb;u.ya(F.a.newDocument,J.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));u.ya(F.a.ipc,J.a.frame,Object(z.a)(this,this.ipc,"populateNewMenu"))}newDocument(u,P,la,Ca,Ta){if(1===la)return 32;if(2===la&&Ta){if(t.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Ta.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),
t.AFrameworkApplication.Qa.processAction(F.a.QWk,2);if(Ta.MenuItemId&&Ta.SourceControlId)return"NewDocumentHome"===Ta.SourceControlId&&oc.a("NewDocumentFromHomeTab"),this.c9a(Ta.MenuItemId,Ta.SourceControlId)}return 8}c9a(u,P){var la=this.eid.o2d;if(null===la)return 8;var Ca=t.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(t.AFrameworkApplication.cdb&&Ca){n.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const Ta={};Ta[Se.a.DKh]=u;Ta[Se.a.z3]=this.z3;Ta[Se.a.lcid]=t.AFrameworkApplication.lcid.toString();Ta[Se.a.reason]=Ei.a.JPi;Ta[Se.a.uiCulture]=t.AFrameworkApplication.uiCulture;Ta[Se.a.dataCulture]=t.AFrameworkApplication.dataCulture;t.AFrameworkApplication.QT().execute(pb=>{pb.sendMessage(Qe.a.c9a,Ta)})}else Ca=(new Date).getTime(),P=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",la,Gb.a.Ne(this.yxa),Gb.a.Ne(u),Gb.a.Ne(this.z3),
Gb.a.Ne(t.AFrameworkApplication.lcid.toString()),Gb.a.Ne(Ca.toString()),Gb.a.Ne(P),Gb.a.Ne(t.AFrameworkApplication.canary),t.AFrameworkApplication.Pg),(la=t.AFrameworkApplication.fa.Ha("ScenarioId"))&&""!==la&&(P+="&wdscenarioid="+Gb.a.Ne(la)),P+="&"+t.AFrameworkApplication.yUa(),t.AFrameworkApplication.eGa&&(P+="&"+t.AFrameworkApplication.$Wc()),(la=this.Zn?this.Zn.ZR:null)?P+="&DestinationUrl="+Gb.a.Ne(la):3===this.SH.w1&&this.SH.Eza&&n.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),
bb.a.In(P,"_blank",void 0,"CreateNewDocument");2!==this.SH.w1&&3!==this.SH.w1||n.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Ff.a[this.SH.w1],["Template"]:u});t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.SH.w1&&("blank"===u?oc.b("ConsumerTemplateNewBlank"):(u=[Object.assign(new L.a,{name:"TemplateId",string:u})],oc.b("ConsumerTemplateNew",null,0,!0,0,u)));
return 32}ihk(u){let P=Number.MAX_VALUE,la=Number.MIN_VALUE;const Ca=window.performance;if(Ca&&"undefined"!==typeof Ca.getEntriesByName){for(let pb=0;pb<u.length;pb++){var Ta=Ca.getEntriesByName(u[pb]);Ta&&0<Ta.length&&(Ta=Ta[0],P=Math.min(parseInt(String(Ta.fetchStart)),P),la=Math.max(parseInt(String(Ta.responseEnd)),la))}la>P&&n.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:la-P,["MinFetchStart"]:P,["MaxResponseEnd"]:la})}}ipc(u,P,la,Ca,Ta){if(1===
la)return this.HPd&&(t.AFrameworkApplication.iM("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.HPd=!1),32;2!==la||this.fJd||(this.ipf=(new Date).getTime(),n.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Xud,["CachedNewMenuXmlExists"]:!!this.tzc,["ShouldCallGetMoreInfo"]:this.SH.Eza}));t.AFrameworkApplication.Oea("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");t.AFrameworkApplication.Oea("WordConsumerTemplates-tf;WordConsumerTemplates-cf");
return this.oUk(Ta)}oUk(u){u&&(this.tzc?u.PopulationXML=this.tzc:(this.SH.Eza&&!this.Zn&&this.bCk.Yda("Opened New menu",!0),u.PopulationXML=this.Dcj(this.getTemplateListJson())));return 32}ptg(){return!this.SH.Eza||!!this.Zn&&3===this.Zn.state&&!!this.Zn.vMa&&!!this.Zn.ZR}Nqe(){return t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.pGa&&!this.vDc?!0:this.ptg()}getTemplateListJson(){if(!this.Xud&&!this.vDc&&!this.Nqe())return null;if(this.cZb&&!this.eHc){var u="9";t.AFrameworkApplication.fa&&
t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(u="21");const P=t.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in P&&(u=P.NumberOfTemplatesInBackstage);let la=this.z3;"TemplateCollectionId"in P&&(la=P.TemplateCollectionId);t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(la="WordConsumerWAC",u="23");u=String.format(this.SH.aoa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",
Gb.a.Ne(t.AFrameworkApplication.lcid.toString()),Gb.a.Ne(la),u);Boolean.parse(P.AppendOriginQueryParam||"false")&&(u+="&org=backstage");Boolean.parse(P.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in P&&(u+="&templateTier="+P.TemplateTier);u+="&"+t.AFrameworkApplication.yUa();t.AFrameworkApplication.eGa&&(u+="&"+t.AFrameworkApplication.$Wc());this.SH.Fmc.qj(u,1,null,null,!1,2,Ca=>{this.SH.Ddb("CreateNewActor.GetTemplateListJson",Ca.data);this.GJl(Ca.data.Wd)},Ca=>{this.SH.Ddb("CreateNewActor.GetTemplateListJson",
Ca.data);this.FJl()},null,void 0,void 0,void 0,void 0,"5");this.cZb=!1}return this.osb}GJl(u){t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.osb=this.y7i(u):this.osb=u;this.cZb=!1;this.orc();this.vDc?this.Nqe()?this.f5d():this.Zn&&(n.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.d5d()):this.f5d()}f5d(){if(t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.pGa&&
Ad.c()){const u=t.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),P=t.AFrameworkApplication.cdb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.osb,!0,u&&P));3===this.SH.w1&&n.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}FJl(){this.eHc=this.cZb=!0;this.orc();this.d5d();eg.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}d5d(){t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.pGa&&
Ad.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.SH.w1&&n.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}y7i(u){u=JSON.parse(u);const P=new H.a;P.add("TM00002102");P.add("TM00002101");P.add("TM16392939");const la=fc.a.fqa(u,Ca=>P.contains(Ca.AssetId));u=u.slice(0,9);u.splice.apply(u,[2,0].concat(la));return JSON.stringify(u)}Wyj(u){var P=0;for(var la=0;la<u.length;la++)if("ST"===u[la].ImageType){P=la;break}const Ca=u.length?u[P]:
null;u=Ca?Ca.Url||"":"";var Ta;let pb=la=P=!1;if(Ca&&(Ta=Ca.AspectRatio))Ta=parseFloat(Ta),1>Ta?P=!0:1.5<Ta?la=!0:1===Ta&&(pb=!0);else switch(n.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:u}),this.SH.w1){case 3:P=!0;break;case 2:la=!0;break;case 5:pb=!0}return{returnValue:u,oJ:P?"95by123":la?"123by69":pb?"100by100":"123by95"}}Dcj(u){const P=({Jud:u}=this.mvi(u,this.eid,this.eid.s1b||"1056925771")).returnValue;u&&(this.tzc=P,n.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.ipf}));return P}UEa(u,P){n.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Zn||3!==u.state?2===u.state&&(n.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.TPd=!0,this.orc()):(this.Zn=u,P||this.orc(),t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.pGa&&Ad.c()&&Ad.d("setFileMenuHostInformation")&&(u=Object.assign(new zf,{hostUrl:this.Zn.ZR,hostName:this.Zn.vMa,folderUrl:t.AFrameworkApplication.breadcrumbFolderUrl,
folderName:t.AFrameworkApplication.breadcrumbFolderName}),n.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(u)),this.vDc&&this.osb&&this.osb.length&&(this.Nqe()?this.f5d():this.d5d(),n.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}mvi(u,P,la){let Ca;Ca=!1;const Ta=this.ptg();let pb="";this.SH.Eza&&(this.TPd?(pb=vf.tHf(P),this.TPd=!1,n.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.Zn?Ta?pb=vf.pvi(P,this.Zn):this.Zn.AUj?(Ca=!0,this.cZb=!1,pb=vf.nvi(P,this.Zn),n.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Ca=!0,pb=vf.tHf(P),n.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Zn.ZR,["StorageServiceDisplayNameIsSet"]:!!this.Zn.vMa})):(pb=vf.ovi(P.labelText),n.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
Ta&&(pb+=vf.lvi(P,la,!pb)+({Jud:Ca}=this.Xvi(u,la)).returnValue);return{returnValue:vf.X0i(pb),Jud:Ca}}Xvi(u,P){let la;la=!1;if(!this.Xud)return la=!0,n.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Jud:la};let Ca="",Ta="",pb="MenuTemplate";if(this.eHc)Ca=vf.GHf(),this.eHc=!1,n.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(u){try{const Sb=Sys.Serialization.JavaScriptSerializer.deserialize(u,!0);
Ca=this.Wvi(Sb,P);n.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");t.AFrameworkApplication.U7g&&"OneDrive"===this.yxa&&(Ta=vf.jvi(this.cCk,t.AFrameworkApplication.U7g))}catch(Sb){n.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:u}),Ca=vf.GHf()}la=!0}else pb="MenuLoading",Ca=vf.Yvi(),n.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:vf.Zvi(pb,Ca)+Ta,Jud:la}}Wvi(u,
P){let la="";const Ca=[];for(let pb=0;pb<u.length;pb++){var Ta=u[pb];let Sb="";if(Ta){const Cc=Ta.Title,ed=Ta.AssetId;Ta=Ta.Thumbnails;ed&&Cc&&Ta&&({oJ:Ta,returnValue:Sb}=this.Wyj(Ta),la+=vf.g1b("jbtnNewTemplate"+pb,Cc,null,Ta,null,Sb,P,ed))}Ca[pb]=Sb}u=new O.a(4,1,5E3,()=>{this.ihk(Ca)},106);this.SH.bid.Hb(u);return la}orc(){this.fJd=!0;this.SH.P7g.v2(this.eid.a7b);this.fJd=!1}get SH(){return this.tia.value}get eid(){return this.IUb.value}get bCk(){return this.cia.value}get cCk(){return this.A5h.value}get yxa(){return this.xPa.value}get Xud(){return this.q$h.value}}
Object(r.a)(Jh,"CreateNewActor",null,[]);class Wf{constructor(){this._initialized=!1;this.zQd={}}YC(u){this.OZf();return this.get(u)}contains(u){this.OZf();return u.toString()in this.zQd}OZf(){this._initialized||(this.Ugi(),this._initialized=!0)}Tsb(u,P){this.zQd[u.toString()]=P}get(u){return this.zQd[u.toString()]}}Object(r.a)(Wf,"AIntlHelper",null,[]);class md extends Wf{constructor(){super()}Ugi(){this.Tsb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Tsb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.Tsb(2,CommonUIStrings.l_Open);this.Tsb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Tsb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Tsb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return md.La||(md.La=new md)}static lOk(u){return md.instance.YC(u)}}md.La=null;Object(r.a)(md,"MruActorIntlHelper",Wf,[]);var Gf;(function(u){u[u.success=0]="success";u[u.failure=1]="failure";u[u.spinner=2]="spinner";u[u.none=3]="none"})(Gf||(Gf={}));Object(r.b)("DisplayState",Gf);var Hd=d(36);
class Ee{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){this.fDd=null;this.sSd=!0;this.szc="";this.ibi=0;this.Bqb=null;this.$Jd=3;this.Ma=Cc;this.tia=u;this.Gca=P;this.k0h=la;this.GXh=Ca;this.FXh=Ta;this.cia=new Pa.a(()=>new Kf.a(pb.value,null));this.U0h=new Pa.a(()=>new Kf.a(Sb.value,Object(z.a)(this,this.rBk,"mruEventResultReceived")));this.Ma.ka("WacInTabOpenMRUIsEnabledForUiHost");this.Ma.ka("UiHostSupportsDocRebootFeatures")}rBk(u,P){this.Bqb=u;P||this.Roh()}R8k(){this.nP.FIb.ra(F.a.Umd,J.a.frame,Object(z.a)(this,
this.Umd,"populateMruMenu"),96)}Umd(u,P,la,Ca,Ta){return 1!==la&&Ta?this.mUk(Ta):32}mUk(u){this.A1i();this.z1i();u.PopulationXML=vf.Y0i(this.szc+this.fDd);return 32}A1i(){var u=3;let P=!1;if(this.szc&&this.ibi===this.Bqb.aLl)n.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),u=this.$Jd;else{n.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var la=this.nP.TF();
this.Bqb=this.qBk.Yda("File Open opened",!0);this.szc&&2!==this.$Jd&&3!==this.Bqb.state?P=!0:(u=this.Nuj(this.Bqb),t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.pGa&&Ad.c()&&u&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(u,!0)),this.szc=({TBk:u}=this.Ecj(this.Bqb)).returnValue);la=this.nP.TF()-la;n.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:la})}2!==u&&(la={["DisplayState"]:Gf[u]},1!==u&&
(la.IsStale=P),n.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",la));this.$Jd=u}Nuj(u){let P;try{P=Hd.c(u.bLe)}catch(la){P=null,n.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",la)}return P}z1i(){this.sSd?(n.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.fDd=({$Yl:this.sSd}=this.Bxk()).returnValue):n.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
n.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.sSd,["NotDisplayingLink"]:!this.fDd})}Ecj(u){let P;1===u.state||0===u.state?(n.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),u=2,P=vf.rHf(this.hFa(2),this.hFa(5))):3===u.state&&u.bLe?(P=this.kvi(u.bLe),u=0):(n.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),P=vf.l1b(this.hFa(1),this.hFa(2)),u=1);return{returnValue:P,TBk:u}}kvi(u){let P;
const la=this.Tlc.s1b||"2155708348";if(u.length){P=vf.k1b("lblRecentDocuments",this.hFa(3));let Ca=0;for(let Ta=0;Ta<u.length;Ta++){const pb=u[Ta];"FileName"in pb&&"DocumentUrl"in pb&&"Path"in pb&&(P+=vf.g1b("MruButton"+Ta,pb.FileName.toString(),pb.Path.toString(),null,this.Tlc.vFa,this.Tlc.U$b,la,pb.DocumentUrl.toString()),pb.IsPinned&&Ca++)}P=vf.d8a("RecentDocumentsMenuSection",vf.o7g,this.hFa(2),P);n.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:u.length,
["NumPinnedDocuments"]:Ca})}else P=vf.l1b(this.hFa(0),this.hFa(2)),n.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return P}Bxk(){let u;u=!0;let P=this.Cti;var la=this.Bti;if(P&&la||!this.nP.Eza)u=!1;else{const Ca=this.dXc.Yda("File Open",!1);3===Ca.state&&(P=Ca.ZR,la=Ca.vMa,u=!1)}la=la?String.format(this.hFa(4),la):null;return{returnValue:vf.kui(this.Tlc.s1b,la,P),$Yl:u}}Roh(){this.nP.P7g.v2(this.Tlc.a7b)}get nP(){return this.tia.value}get hFa(){return this.Gca.value}get Tlc(){return this.k0h.value}get Cti(){return this.GXh.value}get Bti(){return this.FXh.value}get dXc(){return this.cia.value}get qBk(){return this.U0h.value}}
Object(r.a)(Ee,"MruRenderer",null,[]);var Ki=d(171),wf=d(454);class ag{constructor(u,P,la,Ca,Ta,pb,Sb){this.Zn=null;this.huf=!1;this.BOa=this.gef=0;this.L5h=u;this.Oqb=P;this.CEc=la;this.IUb=Ca;this.xPa=Ta;this.tia=pb;this.cia=new Pa.a(()=>new Kf.a(Sb.value,Object(z.a)(this,this.UEa,"getMoreInfoEventReceived")))}c9a(){!this.Zn&&this.pLe.Eza?this.dXc.Yda("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}UEa(u){if(!this.Zn&&3===u.state)this.Zn=u;else if(2===u.state){this.huf?n.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.dXc.Yda("NewDocumentFromStream",!0),this.huf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.gef=(new Date).getTime();var u=this.Z6i.o2d;if(null===u)this.Oqb(null);else{var P=this.CEc.menuItemId,la=this.CEc.sV,Ca=this.CEc.BGl,Ta=this.CEc.f7i;this.BOa="streamBase64"===Ca?Ta.length/1024:0;n.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.z3,this.BOa);var pb=(new Date).getTime();u=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
u,Gb.a.Ne(this.yxa),Gb.a.Ne(P),Gb.a.Ne(this.z3),Gb.a.Ne(t.AFrameworkApplication.lcid.toString()),Gb.a.Ne(pb.toString()),Gb.a.Ne(la),Gb.a.Ne(t.AFrameworkApplication.canary),t.AFrameworkApplication.Pg,Gb.a.Ne(Ca));u+="&"+t.AFrameworkApplication.yUa();t.AFrameworkApplication.eGa&&(u+="&"+t.AFrameworkApplication.$Wc());(P=this.Zn?this.Zn.ZR:null)&&(u+="&DestinationUrl="+Gb.a.Ne(P));this.pLe.Fmc.qj(u,2,Ta,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.WBk,"newDocumentFromStreamSuccessHandler"),
Object(z.a)(this,this.VBk,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}WBk(u){if(u&&u.data&&u.data.Wd){var P;({Su:P}=Hd.d(u.data.Wd)).returnValue?(u=P,u.StatusCode!==Ki.a.mx&&u.StatusCode!==Ki.a.Y3b?(n.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.z3,this.BOa,u.StatusCode),this.Oqb(null)):u.NewDocumentUrl&&""!==u.NewDocumentUrl?(n.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.z3,this.BOa,(new Date).getTime()-this.gef),this.L5h(u.NewDocumentUrl)):(n.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.z3,this.BOa),this.Oqb(null))):(n.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.z3,this.BOa,{["ResponseData"]:wf.a.axc(u.data.Wd)}),this.Oqb(null))}else n.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.z3,this.BOa),this.Oqb(null)}VBk(u){u&&u.data&&n.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.z3,this.BOa,u.data.status);this.Oqb(null)}get z3(){switch(this.pLe.w1){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get Z6i(){return this.IUb.value}get yxa(){return this.xPa.value}get pLe(){return this.tia.value}get dXc(){return this.cia.value}}
Object(r.a)(ag,"NewDocumentFromStreamOperation",null,[]);class Og{constructor(u,P,la,Ca){this.IUb=u;this.xPa=P;this.tia=la;this.T0h=Ca}create(u,P,la){return new ag(u,P,la,this.IUb,this.xPa,this.tia,this.T0h)}}Object(r.a)(Og,"NewDocumentFromStreamOperationFactory",null,[1178]);var Kh=d(254);class Xg{get name(){return"Common.App.NewAndOpen.UX"}Xb(u){u.register(Og,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").na().oa(()=>
new Og(new Pa.a(()=>t.AFrameworkApplication.Aa.mb.ibe()),new Pa.a(()=>t.AFrameworkApplication.yxa),new Pa.a(()=>u.rb("Common.INewAndOpenCommonHelpers")),new Pa.a(()=>u.rb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){t.AFrameworkApplication.fa.$e(()=>{this.zFa()})}zFa(){const u=Kh.a.Ot(w.a.instance.Ia("Common.INewAndOpenCommonHelpers")),P=Kh.a.Ot(w.a.instance.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>"));t.AFrameworkApplication.yxa&&Kg.Task.WAA.call(null,u,P).continueWith(()=>
{const la=new Jh(new Pa.a(()=>u.result),new Pa.a(()=>t.AFrameworkApplication.Aa.mb.ibe()),new Pa.a(()=>P.result),new Pa.a(()=>t.AFrameworkApplication.Aa.mb.jbe().s1b||"1959943459"),new Pa.a(()=>t.AFrameworkApplication.yxa),new Pa.a(()=>t.AFrameworkApplication.R2j));la.vb();la.orc()});if(t.AFrameworkApplication.tVe){const la=Kh.a.Ot(w.a.instance.Ia("Common.IEventEmitter<Common.IMruResult>"));Kg.Task.WAA.call(null,u,P,la).continueWith(()=>{const Ca=new Ee(new Pa.a(()=>u.result),new Pa.a(()=>md.lOk),
new Pa.a(()=>t.AFrameworkApplication.Aa.mb.jbe()),new Pa.a(()=>t.AFrameworkApplication.kOk),new Pa.a(()=>t.AFrameworkApplication.jOk),new Pa.a(()=>P.result),new Pa.a(()=>la.result),t.AFrameworkApplication.fa);Ca.R8k();Ca.Roh()})}}dispose(){}}Object(r.a)(Xg,"UXPackageManager",null,[2,3,108]);class Yd extends Sa.StandardDialog{constructor(){super();this.Ad=0;this.Le(1,CommonUIStrings.l_DialogClose)}Bv(u){this.Yy(u,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}VDa(u){this.Yy(u,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(r.a)(Yd,"ErrorDialog",Sa.StandardDialog,[1310]);class ce{T5f(){n.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const u=new vb.a;u.Ng("api.onedrive.com");return u.task}}Object(r.a)(ce,"OneDriveConsumerEndpointHelper",null,[1113]);var Rh=d(170);class ng{constructor(u,P,la,Ca){this.P5a=this.ooa=null;this.zPd=this.BPd=!1;this.Uqb=null;this.Ma=u;this.uob=P;this.q5a=la;this.iB=Ca}get WCf(){return this.uob}get fa(){return this.Ma}Kyb(){this.Uqb||
(this.Uqb=this.DJb?Wh.a.create(this.DJb,null,null,null,!1):null);return this.Uqb}setup(u){this.P5a=u;this.BPd||this.zPd?this.BPd&&this.P5a&&this.P5a(!0):(u=this.Kyb())?(this.zPd=!0,u.KGa.continueWith(P=>{this.MJk(P)}),Mc.a.py(u)):(n.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.P5a(!1))}ZNe(u){n.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",u.hj?u.hj.toString():"No error detail.")}MJk(u){this.zPd=!1;
if(u.Hm)this.ZNe(u),this.P5a(!1);else try{this.BPd=!0,n.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.wje(),n.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.P5a(!0)}catch(P){n.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",P.toString()),this.P5a(!1)}}jvc(u){this.ooa=u;this.q5a?n.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(z.a)(this,this.qMe,"onApiReady")))}qMe(u){u?this.z5c():this.Nt()}Nt(){this.iB().Bv(Rh.a.KNk)}onSuccess(u){n.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.ooa&&this.ooa(!0,u)}dispose(){this.Uqb&&this.Uqb.dispose()}}Object(r.a)(ng,"AOneDriveFilePickerApiManager",null,[1302,108]);class Vi extends ng{constructor(u,P,la,Ca,Ta,pb){super(P,la,Ca,pb);this.ol=null;this.Fca=u;this.v$h=Ta}get DJb(){return this.fa.Ha("OneDriveApiUrl")}start(u,P){this.ol=
u;this.jvc(P)}wje(){WL.init(1===this.WCf||2===this.WCf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}jvc(u){this.ooa=u;!this.q5a&&this.Fca.One?(n.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.qMe,"onApiReady"))):(n.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.v$h())}z5c(){try{n.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.ol).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.Pz,"onFailure"))}catch(u){n.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",u,u.stack),this.Nt()}}Pz(u){if(u&&u.error){if("user_canceled"===u.error.code){n.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}n.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",u.error.code,u.error.message)}else n.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.ooa&&this.ooa(!1,u);this.Nt()}}Object(r.a)(Vi,"OneDriveFilePickerApiManagerV5",ng,[]);class $h extends ng{constructor(u,P,la,Ca,Ta){super(u,P,la,Ca);this.nCc=this.Lqf=null;this.J_h=Ta;this.options={};this.options.clientId=this.fa.Ha("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.Wxd,"toggleHostDivVisibility")}get DJb(){return this.fa.Ha("OneDriveApiV72Url")}start(u,P){this.nCc=P;const la=this.J_h.T5f();la.continueWith(()=>{n.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Lqf=la.result;this.jvc((Ca,Ta)=>{this.Wxd();u(Ca,Ta)})},3);la.continueWith(()=>{n.ULS.sendTraceTag(24134242,352,15,la.hj.message);this.Wxd()},5)}wje(){this.options.success=u=>{const P={};P.data=u;this.onSuccess(P)};this.options.error=u=>{const P={};P.error=u;this.Pz(P)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Lqf;this.options.advanced.iframeParentDiv=this.nCc}z5c(){try{n.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.Wxd(),OneDrive.open(this.options)}catch(u){n.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",u.message),this.Nt()}}Pz(u){this.ooa&&this.ooa(!1,u);this.Nt()}Wxd(){this.nCc.style.visibility="hidden"===this.nCc.style.visibility?"":"hidden"}}Object(r.a)($h,"OneDriveFilePickerApiManagerV7",ng,[]);class fg extends ng{constructor(u,P,la,Ca){super(u,P,la,Ca);this.SWh=u;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ha("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get DJb(){return this.fa.Ha("OneDriveApiV72Url")}start(u,P,la,Ca){this.options.advanced.iframeParentDiv=la;this.options.advanced.endpointHint=Ca;this.options.cancel=P;this.SWh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.jvc(u)}jvc(u){this.ooa=u;this.q5a?n.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(n.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.qMe,"onApiReady")))}wje(){this.options.success=u=>{const P={};P.data=u;this.onSuccess(P)};this.options.error=u=>{const P={};P.error=u;this.Pz(P)}}z5c(){try{n.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(u){n.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",u.message,u.stack),this.Nt()}}ZNe(u){n.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",u.hj?u.hj.toString():"No error detail.");Mc.a.mal(this.DJb);this.Uqb=null}Nt(){this.iB().VDa(Rh.a.rjl)}Pz(u){this.ooa&&this.ooa(!1,u)}}Object(r.a)(fg,"OneDriveFilePickerApiManagerV72",ng,[]);class dk{constructor(u){this.olsSessionId=this.value=this.key=null;this.olsSessionId=u}}Object(r.a)(dk,"IExtraData",null,
[]);class xi extends fg{constructor(u,P,la,Ca){super(u,P,la,Ca);this.options.advanced.filter=u.Ha("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=t.AFrameworkApplication.iDf;u.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=u.Ha("OneDriveApiV72CommandMode")||"none");u.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new dk(t.AFrameworkApplication.userSessionId))}get DJb(){return this.fa.Ha("OneDriveApiV72Url")}z5c(){try{n.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",t.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(u){n.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",u.message,u.stack),this.Nt()}}}Object(r.a)(xi,"OneDriveFilePickerApiOpenManagerV72",
fg,[]);class yh{constructor(u){this.ow=null;this.ji=u;this.wOd=3}T5f(){this.ow=new vb.a;n.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.N_e();return this.ow.task}N_e(u=null){const P=String.format("GetMoreInfoHandler.ashx?{0}",t.AFrameworkApplication.f9a);this.ji.qW(P,1,null,u,["PersonalFileStorageUrl","X-NewKey"],2,Object(z.a)(this,this.cpj,"getMoreInfoSucceeded"),Object(z.a)(this,this.apj,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}apj(u){if(u.data.Oe===Ki.a.Ipc&&"X-NewKey"in u.data.Dj){n.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const P={};P["X-Key"]=u.data.Dj["X-NewKey"];this.N_e(P)}else 0<this.wOd?(n.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.wOd),this.wOd--,this.N_e()):(n.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.ow.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}cpj(u){"PersonalFileStorageUrl"in u.data.Dj&&""!==u.data.Dj.PersonalFileStorageUrl?(n.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.ow.Ng(u.data.Dj.PersonalFileStorageUrl)):(n.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.ow.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(r.a)(yh,"OneDriveForBusinessEndpointHelper",null,[1113]);var Lg=d(361);class yi{constructor(){this.Ea=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Xb(u){this.Ea=u;this.Ea.register(Vi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").na().oa(()=>new Vi(Lg.a.instance,t.AFrameworkApplication.fa,t.AFrameworkApplication.dTa,t.AFrameworkApplication.dR,t.AFrameworkApplication.nFh,()=>
new Yd));t.AFrameworkApplication.fCb?this.Ea.register(1113,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").na().oa(()=>new ce):this.Ea.register(1113,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").na().oa(()=>new yh(t.AFrameworkApplication.Je));this.Ea.register($h,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").na().oa(()=>new $h(t.AFrameworkApplication.fa,t.AFrameworkApplication.dTa,t.AFrameworkApplication.dR,()=>new Yd,this.Ea.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Ea.register(fg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").na().oa(()=>new fg(t.AFrameworkApplication.fa,t.AFrameworkApplication.dTa,t.AFrameworkApplication.dR,()=>new Yd));this.Ea.register(xi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").na().oa(()=>new xi(t.AFrameworkApplication.fa,t.AFrameworkApplication.dTa,t.AFrameworkApplication.dR,()=>new Yd))}static main(){m.a.instance.Ac(new yi)}}Object(r.a)(yi,"PackageManager",null,[2,3]);var Vd=d(175),
lf=d(184);class Zj{constructor(u){this.Wdb=this.NFe=this.wgb=this.Xad=0;this.mEe=this.CQg=null;u?(this.wb=u,this.t4b=Date.now,this.rQi(),this.F8k()):n.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}Frl(){this.CQg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}F8k(){window.document.body.addEventListener("pointerenter",Object(z.a)(this,this.pKk,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(z.a)(this,this.qKk,
"onPointerLeave"));w.a.instance.Ia("Common.App.VisibilityManagement.IVisibilityManager").execute(u=>{u.YJc(Object(z.a)(this,this.c$b,"handleVisibilityChange"))})}pKk(u){"pen"!==u.pointerType||this.wgb||(this.wgb=Math.floor(this.t4b()/1E3),this.wgb<=this.Xad&&(this.wgb=this.Xad),this.NFe=0)}qKk(){this.Dhg()}Dhg(){const u=Math.ceil(this.t4b()/1E3);this.wgb&&u>this.Xad&&(this.NFe=u,this.Wdb+=this.NFe-this.wgb);this.Xad=u;this.wgb=0}c$b(u,P){0!==P.newState&&this.Dhg()}rQi(){this.mEe=new O.a(4,2,6E4,Object(z.a)(this,
this.pgk,"logPenUsage"));this.wb.Hb(this.mEe)}pgk(){0<this.Wdb&&this.Xxh(this.Wdb);this.Wdb=0}Xxh(u){const P=new lf.a;P.name=this.CQg;const la=[];(u=Vd.a.V_("PenInputSec",u.toString(),3))&&Array.add(la,u);P.dataFields=la;B.a.sendActivityEvent(P)}dispose(){0<this.Wdb&&this.Xxh(this.Wdb);this.wb.Kg(this.mEe)}}Object(r.a)(Zj,"PenMinutesManager",null,[1117]);class Cj{constructor(){this.fNd=this.Ea=null}get name(){return"Common.App.PenMinutesManager"}Xb(u){this.Ea=u;const P=t.AFrameworkApplication.De;
this.Ea.register(1117,"Common.App.PenMinutesManager.IPenMinutesManager").na().oa(()=>new Zj(P))}init(){this.fNd=this.Ea.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.fNd&&this.fNd.dispose()}static main(){m.a.instance.Ac(new Cj)}}Object(r.a)(Cj,"PenMinutesManagerPackage",null,[2,3]);class he extends Sa.StandardDialog{constructor(u,P){super();this.Wqb=!1;this.RK=null;this.Ca=u;this.BUb=P;this.Y1a=!1}Bv(u,P,la){this.RK=P;this.Wqb=la;n.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
u,la);u=this.OZd(u);0===u?(this.Ad=6,this.Le(0,CommonUIStrings.l_DialogClose)):(this.Ad=0,this.Le(1,CommonUIStrings.l_DialogClose));0===u&&n.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Yy(Rh.a.qjl,this.Sij(u),this.Rij(u,P),Object(z.a)(this,this.ZYe,"retryDialogHandler"),!0)}ZYe(u){1===u?(n.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.RK?this.Ca.Ja(F.a.fNb,2,[this.RK,this.Wqb]):this.Ca.processAction(F.a.fNb,2)):n.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}OZd(u){return 0>u||6<u?(n.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",u),0):u}Rij(u,P){u=this.OZd(u);return this.BUb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,P),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][u]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,P),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][u]}Sij(u){u=this.OZd(u);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][u]}}
Object(r.a)(he,"ErrorRetryDialog",Sa.StandardDialog,[1276]);class ij{constructor(u,P){this.Ma=u;this.Ca=P;this.BUb=this.Ma.ka("SaveToHostWithExtraCharsInFileName")}create(){return new he(this.Ca,this.BUb)}}Object(r.a)(ij,"ErrorRetryDialogFactory",null,[1242]);class Rf extends Ue.a{constructor(u,P,la,Ca,Ta,pb,Sb=null){super();this.SV=null;this.Ca=P;this.Sba=Ca;this.hCa=pb;this.Ma=u;this.iB=Ta;this.Yh=la;this.BUb=this.Ma.ka("SaveToHostWithExtraCharsInFileName");this.ol=Sb;this.Le(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Yh}OVf(u,
P){this.cF(1,!!u&&u!==P);this.SV=document.getElementById(Rf.C1f);Le.a.addHandler(this.SV,"change",Object(z.a)(this,this.Fjd,"onFileNameChange"));Le.a.addHandler(this.SV,"input",Object(z.a)(this,this.Fjd,"onFileNameChange"));this.SV.focus()}B1f(u){return this.BUb?(new RegExp("["+this.i_f('\\/:*?"<>|')+"]")).test(u):(new RegExp("["+this.i_f('\\/:*?"<>|#{}%~&')+"]")).test(u)}i_f(u){return u.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}tge(){const u=Gb.a.mH(t.AFrameworkApplication.ju.rx);this.cF(1,
!!this.SV&&""!==this.SV.value&&this.SV.value!==u)}Fjd(){this.SV&&window.setTimeout(()=>{this.tge()},0)}oTc(u,P){if(1!==u)n.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{u=P[Rf.C1f];P=Rf.Ufh in P?P[Rf.Ufh]:!1;n.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Gb.a.Foh(u),P);const la=Gb.a.IQ(t.AFrameworkApplication.fileName);(u=u?u.trim():null)&&""!==u&&""!==la||1===this.Aa.state?
this.B1f(u)?this.iB.create().Bv(1,u,P):this.hCa.pZ(u+la,P,this.ol):this.iB.create().Bv(2,u,P)}}dispose(){this.SV&&(Le.a.removeHandler(this.SV,"change",Object(z.a)(this,this.Fjd,"onFileNameChange")),Le.a.removeHandler(this.SV,"input",Object(z.a)(this,this.Fjd,"onFileNameChange")),this.SV=null);super.dispose()}}Rf.C1f="txtFileName";Rf.Ufh="chkOverwrite";Object(r.a)(Rf,"FileNameDialogBase",Ue.a,[]);class zh{static get hg(){return Ue.a.pz(zh.Fo,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
zh.Fo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(r.a)(zh,"FileNameDialogHtml",null,[]);class Sh extends Rf{constructor(u,P,la,Ca,Ta,pb){super(u,P,la,Ca,Ta,pb);this.hg=zh.hg;this.ig="FileNameDialog-SaveAsToHost"}lka(u,P){const la=Gb.a.mH(t.AFrameworkApplication.ju.rx);P={["txtFileName"]:u||la,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:P};this.sj(CommonUIStrings.L_SaveAs,Object(z.a)(this,this.oTc,"fileNameDialogHandler"),P);this.OVf(u,la)}}Object(r.a)(Sh,"FileNameDialog",Rf,[1277]);class jj{constructor(u,P,la,Ca,Ta,
pb){this.Ca=P;this.Ma=u;this.Sba=Ca;this.hCa=pb;this.iB=Ta;this.Yh=la}create(){return new Sh(this.Ma,this.Ca,this.Yh,this.Sba,this.iB,this.hCa)}}Object(r.a)(jj,"FileNameDialogFactory",null,[1241]);class Dj{constructor(u,P,la){this.hCa=la;this.YFd=P;this.Ma=u}vb(){2===t.AFrameworkApplication.Aa.mb.Ti?t.AFrameworkApplication.Qa.ra(F.a.fNb,J.a.frame,Object(z.a)(this,this.owh,"saveAsToHostActionDispatcher"),4):t.AFrameworkApplication.Qa.ya(F.a.fNb,J.a.frame,Object(z.a)(this,this.owh,"saveAsToHostActionDispatcher"))}owh(u,
P,la,Ca,Ta){return P.contextId!==J.a.frame||u!==F.a.fNb?2:this.Ma.ka("SaveAsToHostBrsIsEnabled")?1===la?x.SessionStatusManager.instance.jla||t.AFrameworkApplication.$Q?8:32:2===la?(n.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),u=this.YFd.create(),Ta&&Object.getType(Ta)===Array&&2===Ta.length?u.lka(Ta[0],!!Ta[1]):u.lka(null,!1),32):8:8}}Object(r.a)(Dj,"SaveAsToHostActor",null,[]);class Ah{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){this.eo=null;this.Wqb=this.X2=
!1;this.gCa=this.ol=this.RK=null;this.Ma=P;this.lCa=this.Ma.appSettings.SaveAsToHostWebServiceBase;this.$kf=Ca;this.gra=Ta;this.ji=la;this.iB=pb;this.ki=Cc;this.Yh=Sb;this.Ca=u;this.cBa=P.Ha("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}Quc(){1!==this.Yh.state&&(this.eo=this.gra(),this.eo.message=CommonUIStrings.l_CommentProgressTooltip,this.eo.Ad=5,this.eo.Mr=!1,this.eo.Fpa(CommonUIStrings.l_DefaultDialogTitle,null,null))}nZ(u=0){1!==this.Yh.state&&this.iB.create().Bv(u,Gb.a.mH(this.RK),
this.Wqb)}akb(){const u=this.Ma.appSettings.BreadcrumbFolderUrl;n.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");bb.a.In(u,bb.a.Nba(3),void 0,"UploadToHostManager.RedirectToFolder")}$jb(u){let P=!1,la=!1;this.Ma&&(P=this.Ma.ka("SaveACopyIsEnabledForUiHost"),la=this.Ma.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",u,P,la);if(P&&la){n.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ca={};Ca[Se.a.XLb]="1";Ca[Se.a.documentUrl]=u;Ca[Se.a.reason]=Ei.a.QZe;t.AFrameworkApplication.QT().execute(Ta=>{Ta.sendMessage(Qe.a.YDa,Ca)})}else P&&!la&&t.AFrameworkApplication.uX?bb.a.In(u,bb.a.Nba(4),void 0,"UploadToHostManager.RedirectToEditUrl"):bb.a.In(u,bb.a.Nba(3),void 0,"UploadToHostManager.RedirectToEditUrl")}pZ(u,P,la=null){n.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.$kf&&
!this.$kf()&&this.ji&&(this.ki&&(this.gCa=this.ki.Ii("DialogShown","SaveAsToHostUploadTime")),this.Quc(),this.Wqb=P,this.RK=u,(this.ol=la)&&"true"===this.ol.SkipSaveToHost?this.ASc():this.c4())}c4(){32!==this.Ca.processAction(F.a.b1a,1)?(n.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.ASc()):this.Ca.Ja(F.a.b1a,2,[()=>{n.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.ASc()},(u,P)=>{n.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.nZ(P)}])}sNk(u){this.y9a();this.X2=!1;if(u&&u.data&&u.data.Wd)if(({Su:P}=Hd.d(u.data.Wd)).returnValue)if(u=P,u.StatusCode!==Ki.a.mx&&u.StatusCode!==Ki.a.Y3b){n.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var P={};P.FailureReason=u.StatusCode.toString();P.ExtraInfo=u.ExtraInfo;this.Gya(P);this.nZ(parseInt(u.ExtraInfo))}else{n.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.gYe();try{u.NewDocumentUrl&&""!==u.NewDocumentUrl?this.$jb(u.NewDocumentUrl):this.akb()}catch(la){n.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",la.toString())}this.Ooc()}else n.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:wf.a.axc(u.data.Wd)}),this.Gya({["FailureReason"]:"Failed to deserialize response"}),this.nZ();else n.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Gya({["FailureReason"]:"null response"}),this.nZ()}rNk(u){5!==u.data.status&&12!==u.data.status||this.X2?(n.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:u.data.status,["HttpStatus"]:u.data.Oe}),this.Gya({["FailureReason"]:u.data.Oe.toString()}),this.y9a(),this.nZ(),this.Ooc()):(n.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.X2=!0,this.ol&&"true"===this.ol.SkipSaveToHost?this.ASc():this.c4())}y9a(){this.eo&&
(this.eo.close(),this.eo=null)}Ooc(){this.gCa&&(this.gCa.stop(),this.gCa=null)}gYe(){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.processAction(F.a.Iqd,2)}Gya(u){this.ol&&"VersionHistory"===this.ol.SaveEntryPoint&&this.Ca.Ja(F.a.hYe,2,u)}ASc(){let u=this.lCa+this.cBa;u=Cd.a.Pi(u,"qs",Gb.a.Ne(t.AFrameworkApplication.Pg));u=Cd.a.Pi(u,"n",Gb.a.Ne((new Date).getTime().toString()));u=Cd.a.Pi(u,"ov",Gb.a.Ne(this.Wqb.toString()));u=Cd.a.Pi(u,"fn",Gb.a.Ne(this.RK));this.ol&&this.ol.FileDownloadUrl&&
(u=Cd.a.Pi(u,"furl",Gb.a.Ne(this.ol.FileDownloadUrl)));this.ji.qj(u,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(z.a)(this,this.sNk,"onUploadFinished"),Object(z.a)(this,this.rNk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(r.a)(Ah,"UploadToHostManager",null,[1240]);var hf=d(563);class rg{constructor(){this.Ea=null}get name(){return"Common.App.SaveAsToHost"}init(){t.AFrameworkApplication.fa.$e(Object(z.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){t.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Ea.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").vb()}Xb(u){this.Ea=u;this.Ea.register(ij,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").oa(()=>new ij(t.AFrameworkApplication.fa,t.AFrameworkApplication.Qa)).na();this.Ea.register(Ah,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").oa(()=>new Ah(t.AFrameworkApplication.Qa,t.AFrameworkApplication.fa,t.AFrameworkApplication.Je,()=>t.AFrameworkApplication.Yg,
()=>(new hf.a).create(),u.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.AFrameworkApplication.Aa,t.AFrameworkApplication.Aa.BV)).na();this.Ea.register(jj,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").oa(()=>new jj(t.AFrameworkApplication.fa,t.AFrameworkApplication.Qa,t.AFrameworkApplication.Aa,t.AFrameworkApplication.Aa.mb,u.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),u.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).na();
this.Ea.register(Dj,"Common.App.SaveAsToHost.SaveAsToHostActor").oa(()=>new Dj(t.AFrameworkApplication.fa,u.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),u.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).na()}dispose(){}static main(){m.a.instance.Ac(new rg)}}Object(r.a)(rg,"SaveAsToHostPackage",null,[2,3]);class Ej extends Sa.StandardDialog{constructor(){super();this.Ad=0;this.Le(1,CommonUIStrings.l_DialogClose)}Bv(u,P){this.kWf(u,P,Rh.a.sjl)}kWf(u,P,la){n.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",la);this.Yy(la,u,P,null)}VDa(u,P){n.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Yy(Rh.a.ujl,u,P,null,!0)}}Object(r.a)(Ej,"ErrorDialog",Sa.StandardDialog,[1266]);class Li{static get hg(){return Ue.a.pz(Li.Fo,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Li.Fo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(r.a)(Li,"FileNameDialogHtml",null,[]);class Gh extends Rf{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){super(u,P,la,Ca,Ta,pb,Cc);this.OOa=this.$Od=this.GI=null;this.pwi=CommonUIStrings.l_SaveToAnotherFolder;this.hg=Li.hg;this.ig="FileNameDialog-SaveToSharePoint";this.KYb=Sb;this.y6h=Cc}lka(u){const P=Gb.a.mH(t.AFrameworkApplication.ju.rx),la=t.AFrameworkApplication.breadcrumbFolderName,Ca=t.AFrameworkApplication.breadcrumbBrandName,Ta={["txtFileName"]:u||P};let pb=CommonUIStrings.L_SaveAs;2===t.AFrameworkApplication.Aa.mb.Ti&&
(pb=CommonUIStrings.L_SaveACopy);this.sj(pb,Object(z.a)(this,this.oTc,"fileNameDialogHandler"),Ta);this.OVf(u,P);this.G4d.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");t.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.GI=document.getElementById("anotherFolder"),u=document.getElementById("folderLocation"),this.$Od=Ja.a.lDf(u,this.GI,"anotherFolderDescribedBy",""),this.GI.className="WACButton WACDialogButtonNormal",
u=!1,la&&la.length?(this.Nyf(this.GI,this.$Od,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ca,la)),u=this.Gdi(Ca,la)):this.Nyf(this.GI,this.$Od,CommonUIStrings.l_CurrentOnlineFolder),this.jfi(this.GI),this.Idi(this.GI),u?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.GI,"SaveToAnotherLocationTwo"),n.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.GI,"SaveToAnotherLocationOne"),
Le.a.addHandler(this.GI,Fa.a.click,Object(z.a)(this,this.DOe,"onSaveToAnotherLocationClick")),Le.a.addHandler(this.GI,Fa.a.Df,Object(z.a)(this,this.jdh,"onSaveToAnotherLocationKeyDown")))}Gdi(u,P){let la;la=!1;const Ca=document.getElementById("currentLocation");Ca.innerText="";const Ta=this.vag(Ca,u),pb=this.vag(Ca,P);let Sb=255,Cc=255;255<Ta+pb&&(Sb=Math.max(238,408-Ta),Cc=Math.max(170,408-pb),la=!0);this.Jgi(Ca,u,Cc,P,Sb);return la}vag(u,P){const la=document.createElement("div");la.innerText=P;
la.style.visibility="hidden";u.appendChild(la);P=la.clientWidth;u.removeChild(la);return P}Jgi(u,P,la,Ca,Ta){P&&(this.Myf(u,P,la),this.zgi(u));Ca&&this.Myf(u,Ca,Ta)}Myf(u,P,la){const Ca=document.createElement("div");Ca.innerText=P;Ca.title=P;Ca.className="SaveToAnotherFolderBreadcrumb";Ca.style.maxWidth=la.toString()+"px";u.appendChild(Ca)}zgi(u){const P=document.createElement("span");P.id="FolderSeparator";const la=document.createElementNS("http://www.w3.org/2000/svg","svg");la.setAttribute("class",
"SeparatorCaret");const Ca=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ca.setAttribute("points","1 4 1 11 5 7.5");la.appendChild(Ca);P.appendChild(la);u.appendChild(P)}Nyf(u,P,la){la=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,la);P&&(P.innerText=la);u.tabIndex=0;u.setAttribute(Ja.a.hf,Ja.a.Ou)}Idi(u){const P=document.createElement("span");P.id="anotherFolderText";P.innerText=this.pwi;P.className="AnotherFolderTextSpan";u.appendChild(P)}jfi(u){const P=
document.createElement("span");P.className="cui-img-cont-float cui-img-16by16 ";this.OOa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.OOa.setAttribute("class","FolderIconSVG");const la=document.createElementNS("http://www.w3.org/2000/svg","path");la.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.OOa.appendChild(la);P.appendChild(this.OOa);u.appendChild(P)}jdh(u){!u||u.keyCode!==
pa.a.jp&&u.keyCode!==pa.a.ORb||this.DOe(u)}DOe(){if(this.SV){const u=Gb.a.IQ(t.AFrameworkApplication.fileName);let P=this.SV.value;this.hide();P&&""!==P&&""!==u||1===this.Aa.state?(""!==u&&(P+=u),this.B1f(P)?this.iB.create().Bv(1,P,!1):this.KYb.start(P,this.y6h)):this.iB.create().Bv(2,P,!1)}}qBi(u){this.GI&&this.OOa&&(u?(this.GI.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.GI,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.OOa,"DisabledFolderIconSVG")):(this.GI.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.GI,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.OOa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.GI,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.OOa,"DisabledFolderIconSVG"))))}tge(){super.tge();this.qBi(!!this.SV&&""!==this.SV.value)}dispose(){this.GI&&(Le.a.removeHandler(this.GI,Fa.a.click,Object(z.a)(this,this.DOe,"onSaveToAnotherLocationClick")),Le.a.removeHandler(this.GI,Fa.a.Df,Object(z.a)(this,this.jdh,"onSaveToAnotherLocationKeyDown")),this.GI=
null);super.dispose()}}Object(r.a)(Gh,"FileNameDialog",Rf,[1279]);var hg=d(1254),Lh=d(1255),La=d(938),lb=d(224);class Ob{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(r.a)(Ob,"SaveAsDialogInput",null,[]);class mc{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(r.a)(mc,"SaveLocation",null,[]);var Rc=d(89);class Ud{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed){this.tKd=null;this.RK="";this.KYb=u;this.iB=
P;this.ol=ed;this.hCa=la;this.Yh=Ta;this.wF=Ca;this.b7a=Sb;this.Jrb=Cc;pb&&(this.tKd=new Pa.a(()=>new Kf.a(pb.value,null)))}Phj(){const u=new hg.a(Lh.a.Gk());u.$("type","currentHost");return Object.assign(new mc,{folderName:this.wF.breadcrumbFolderName,friendlyPath:this.wF.breadcrumbBrandName,properties:u})}b7j(u){return!!u&&"ClassicMru"===u.type&&!!u.service_info&&!!u.service_info.service_id&&-1!==u.service_info.service_id.indexOf("SHAREPOINT")}Hvj(){if(!this.tKd||!this.b7a)return null;var u=this.tKd.value.Yda("SaveAsToSharePointDialog",
!1);if(!u||3!==u.state||!u.p7g)return null;u=u.p7g;const P=new H.a;let la=0,Ca=0;for(var Ta=0;Ta<u.length;Ta++){var pb=u[Ta];if(!this.b7j(pb))continue;la++;if(!pb.sharepoint_info)continue;const Sb=pb.url,Cc=pb.sharepoint_info.site_url,ed=pb.title;pb=La.b(pb,t.AFrameworkApplication.isRtl);if(!(Sb&&Cc&&ed&&pb))continue;Ca++;const ad=new hg.a(Lh.a.Gk());ad.$("type","SharePoint");ad.$("siteUrl",Cc);ad.$("folderUrl",Sb);Ca++;P.add(Object.assign(new mc,{folderName:ed,friendlyPath:pb,properties:ad}))}Ta=
new Map;Ta.set("NumPlaces",u.length.toString());Ta.set("NumSharepointPlaces",la.toString());Ta.set("placesWithMetadata",Ca.toString());eg.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ta);0<la&&(Ca?.5>1*Ca/la&&eg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):eg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return P}Qij(){const u=new H.a;u.add(this.Phj());const P=
this.Hvj();P&&u.addRange(P);return Object.assign(new Ob,{enableMoreLocations:!t.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.RK,extension:Gb.a.IQ(this.wF.rx),saveLocations:u.toArray(),scenario:"SaveToSharePoint"})}RVc(){const u=Object(z.a)(this,this.Qij,"getDialogInput"),P={};P.inputPropsCallback=u;return P}lka(u){this.RK=u;this.RK||(this.RK=String.format(CommonUIStrings.l_SaveACopy_Filename,Gb.a.mH(this.wF.rx)));u={["id"]:"SaveAsDialog",["bodyControls"]:this.RVc()};
let P=CommonUIStrings.L_SaveAs;2===this.Yh.mb.Ti&&(P=CommonUIStrings.L_SaveACopy);const la=new Ue.a(!1,!1,!0);la.Ad=1;la.ig="SaveAsDialog";la.Le(1,CommonUIStrings.l_SaveButtonLabel);la.sj(P,Object(z.a)(this,this.ojl,"saveAsDialogHandler"),u)}jBl(u,P){u&&""!==u&&""!==P||1===this.Yh.state?this.a7j()?this.kdk(u,P):(""!==P&&(u+=P),this.KYb.start(u,this.ol)):(n.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.iB.create().Bv(2,u,!1))}kdk(u,P){eg.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const la=this.Jrb.X1d(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Jrb.jWc(la).then(Ca=>{if(Ca&&0<Ca.length){const Ta=Ca[0][Se.a.QSk];Ca=Ca[0][Se.a.GQe];if(""!==Ta&&""!==Ca)this.b7a.pZ(Ca,u+P,Ta,this.ol),eg.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.iB.create().Bv(0,u,!1);const pb=lb.a.fA();pb&&(pb.set("SiteUrlAvailable",""===Ta?"false":"true"),pb.set("FolderUrlAvailable",""===Ca?"false":
"true"));eg.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Rc.a,{extendedProperties:pb}))}}else this.iB.create().Bv(0,u,!1),eg.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ca=>{"Canceled"===Ca?((Ca=lb.a.fA())&&Ca.set("IsCanceled","true"),eg.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Rc.a,{extendedProperties:Ca}))):eg.Health.instance.recordKpiFailure("SaveACopySFP",
Ca,!1,!1,null)})}a7j(){return this.Jrb?this.Jrb.jre():(n.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}ojl(u,P){if(P&&1===u){u=P.fileName;var la=Gb.a.IQ(this.wF.rx);P.moreLocationsSelected&&this.jBl(u,la);if(P.locationCallback){var Ca=P.locationCallback();Ca?Ca.properties&&"currentHost"===Ca.properties.ga("type")?this.hCa.pZ(u+la,!1,this.ol):Ca.properties&&"SharePoint"===Ca.properties.ga("type")?(P=Ca.properties.ga("siteUrl"),Ca=Ca.properties.ga("folderUrl"),this.b7a.pZ(Ca,
u+la,P,this.ol)):n.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):n.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else n.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(r.a)(Ud,"ReactSaveAsDialog",null,[1279]);class ue{constructor(u,P,la,Ca,Ta,pb,Sb,Cc=null,ed=null,ad=null){this.Ca=P;this.Ma=u;this.Sba=Ca;this.hCa=pb;this.iB=Ta;this.Yh=la;this.cuf=Sb;this.r4h=Cc;this.b7a=ed;this.Jrb=ad}create(u){return this.Yh&&this.Yh.mb.gD?new Ud(this.cuf,
this.iB,this.hCa,t.AFrameworkApplication.ju,this.Yh,this.r4h,this.b7a,this.Jrb,u):new Gh(this.Ma,this.Ca,this.Yh,this.Sba,this.iB,this.hCa,this.cuf,u)}}Object(r.a)(ue,"FileNameDialogFactory",null,[1267]);class Xe{constructor(u,P,la,Ca){this.Zn=this.xia=null;this.y4a=u;this.Yh=la;this.h7h=Ca;this.cia=new Pa.a(()=>new Kf.a(P.value,Object(z.a)(this,this.UEa,"getMoreInfoEventReceived")))}get EJb(){this.xia||(this.cia.value.Yda("Save As",!0),this.Zn&&this.Zn.ZR&&this.Zn.ZR.length&&(this.xia=this.bde(this.Zn.ZR)));
return this.xia}start(u){if(!this.EJb)if(t.AFrameworkApplication.breadcrumbFolderUrl&&t.AFrameworkApplication.breadcrumbFolderUrl.length)this.xia=t.AFrameworkApplication.breadcrumbFolderUrl;else return n.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Zn),!1;const P=this.h7h();P.b4e();const la=P.tde();if(!la)return n.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.y4a.start((Ca,Ta)=>{P.hide();u(Ca,Ta)},()=>{this.QMe(P)},la,this.xia);return!0}QMe(u){u.hide();n.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}bde(u){u=u.toLowerCase();u.endsWith("/")||(u+="/");const P=u.indexOf("/documents/");return-1!==P?u.substring(0,P+1)+"_layouts/15/onedrive.aspx":""}UEa(u){this.Zn||3!==u.state||(this.Zn=u)}}Object(r.a)(Xe,"OneDriveFilePickerHelper",null,[1265]);class pe extends Ue.a{constructor(){super()}b4e(){this.DAc="FilePickerDialog";
this.hg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ig="PickerDialog-MsoSp";this.showDialog("",null)}tde(){return document.getElementById("FilePickerDiv")}ZA(){}Maa(){}}Object(r.a)(pe,"PickerDialog",Ue.a,[1264]);var gg=d(495);class cg{constructor(u,P,la,Ca,Ta,pb,Sb){this.Ma=u;this.YFd=la;this.Ca=P;this.KYb=Ca;this.y4a=Ta;this.uMd=pb;this.ZXh=Sb}vb(){const u=this.y4a.Kyb();u?yd.a.Fx||this.Ma.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.ra(F.a.Ukb,J.a.frame,Object(z.a)(this,
this.Iwh,"saveToSharePointActionDispatcher"),64):(u.KGa.continueWith(P=>{P.Hm&&this.y4a.ZNe(P)}),this.tMc()):n.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}tMc(){Mc.a.Gpd(Object(z.a)(this,this.Iwh,"saveToSharePointActionDispatcher"));Mc.a.Q5b([new gg.a(F.a.Ukb,J.a.frame,0)],this.y4a.Kyb())}get sCb(){return this.Ma.ka("SaveToAnotherFolderBrsIsEnabled")}get hKf(){return this.Ma.ka("UserCanWriteRelative")}Iwh(u,P,la,Ca,Ta){return P.contextId!==J.a.frame||
u!==F.a.Ukb?2:this.sCb&&(this.uMd.EJb||this.hKf)?1===la?x.SessionStatusManager.instance.jla||t.AFrameworkApplication.$Q?8:this.ZXh()?32:8:2===la?(n.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ta&&Ta.SaveEntryPoint&&"VersionHistory"===Ta.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.hKf?(n.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.YFd.create(Ta).lka(null)):(n.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.KYb.start(null,Ta)),32):8:8}}Object(r.a)(cg,"SaveToSharePointActor",null,[]);class Sg{constructor(u,P,la,Ca){this.ol=this.Qpf=null;this.b7a=u;this.iB=P;this.uMd=la;this.Yh=Ca}start(u,P){n.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Qpf=u;this.ol=P;this.uMd.start((la,Ca)=>{this.processResponse(la,Ca)})||this.c4e()}processResponse(u,P){if(u)this.onSuccess(P);else this.Pz(P)}c4e(){1!==this.Yh.state&&this.iB().VDa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(u){n.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(u&&u.data&&u.data.value&&u.data.value.length&&u.data.value[0].sharePoint){const P=u.data.value[0].sharePoint.url;u=u.data.value[0].sharePoint.listUrl;let la=null;if(P&&(la=u?this.Tvj(u):this.Svj(P))){this.b7a.pZ(P,this.Qpf,la,this.ol);return}n.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!P,!la)}n.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.c4e()}Svj(u){u.endsWith("/")||(u+="/");let P=0;for(let la=0;la<u.length;la++)if("/"===u.charAt(la)&&5===++P)return u.substr(0,la);return null}Tvj(u){u.endsWith("/")&&(u=u.substring(0,u.length-1));const P=u.lastIndexOf("/");return-1!==P?u.substring(0,P):null}Pz(u){n.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");u&&u.error?n.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",u.error.errorCode,u.error.message):n.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.c4e()}}Object(r.a)(Sg,"SaveToSharePointManager",null,[1262]);class Hh{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){this.lCa=u;this.RK=P;this.Fpb=Ca;this.KNd=pb;this.Jqa=la;this.G$h=Ta;this.cBa=Sb;this.ol=Cc}execute(u,P){if(!t.AFrameworkApplication.Yg&&t.AFrameworkApplication.Je){var la=this.lCa+this.cBa;la=Cd.a.Pi(la,"fu",Gb.a.Ne(this.Jqa));la=Cd.a.Pi(la,"su",Gb.a.Ne(this.G$h));la=Cd.a.Pi(la,"fn",Gb.a.Ne(this.RK));la=Cd.a.Pi(la,"n",Gb.a.Ne((new Date).getTime().toString()));
this.ol&&this.ol.FileDownloadUrl&&(la=Cd.a.Pi(la,"furl",Gb.a.Ne(this.ol.FileDownloadUrl)));la=la+"&"+this.KNd;this.Fpb&&this.Fpb.length?la=Cd.a.Pi(la,"fnn",Gb.a.Ne(this.Fpb)):n.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");n.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");t.AFrameworkApplication.Je.qj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,u,P,null,void 0,void 0,void 0,void 0,"9")}}}Object(r.a)(Hh,"SharePointSaveAsCaller",
null,[1278]);class li{constructor(u){this.Pra=u.appSettings.SaveAsToHostWebServiceBase;this.RK=u.appSettings.FileName;this.cBa=u.Ha("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(u,P,la,Ca){return new Hh(this.Pra,this.RK,u,P,la,t.AFrameworkApplication.Pg,this.cBa,Ca)}}Object(r.a)(li,"SharePointUploadCallerFactory",null,[1263]);var Oh=d(505);class Wi{constructor(u,P,la,Ca,Ta){this.eo=this.ZSb=null;this.gCd=!1;this.XOd=this.Jqa=null;this.fSd=P;this.gra=la;this.iB=Ca;this.Yh=Ta;this.Ca=
u}pZ(u,P,la,Ca){this.gCd=!1;n.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.Quc();this.Jqa=u;Ca&&Ca.SaveEntryPoint&&(this.XOd=Ca.SaveEntryPoint);this.ZSb=this.fSd.create(u,P,la,Ca);Ca&&"true"===Ca.SkipSaveToHost?this.c4():this.Z$i()}Z$i(){const u=()=>{n.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.c4()};32!==this.Ca.Ja(F.a.b1a,2,[()=>{n.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.c4()},u])&&u()}c4(){n.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.ZSb.execute(Object(z.a)(this,this.yLk,"onSaveToSharePointUploadFinished"),Object(z.a)(this,this.xLk,"onSaveToSharePointUploadFailed"))}yLk(u){if(u&&u.data&&u.data.Wd){var P;if(({Su:P}=Hd.d(u.data.Wd)).returnValue)if(P.StatusCode!==Ki.a.mx&&P.StatusCode!==Ki.a.Y3b)n.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
u.data.status,P.StatusCode),P.StatusCode!==Ki.a.mth&&this.KWf(u.data.status)||(this.Gya(P.StatusCode.toString()),this.pAl(P.StatusCode));else{n.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.gYe();try{P.NewDocumentUrl?this.$jb(P.NewDocumentUrl):this.akb()}catch(la){n.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",la.toString())}}else n.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:wf.a.axc(u.data.Wd)}),
this.gRc()||(this.Gya("Failed to deserialize response"),this.Ouc())}else n.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.gRc()||(this.Gya("Unknown"),this.Ouc())}xLk(u){u&&u.data?this.KWf(u.data.status)||(n.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Gya(Oh.a[u.data.status]),this.Ouc()):(n.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.gRc()||(this.Gya("Unknown"),this.Ouc()))}gRc(){if(!this.gCd)return n.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.gCd=!0,this.c4(),!0;n.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}KWf(u){n.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",u);return this.gRc()}akb(){n.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");bb.a.In(this.Jqa,bb.a.Nba(3),void 0,"UploadToSharePointManager.RedirectToFolder")}$jb(u){let P=!1,la=!1;t.AFrameworkApplication.fa&&(P=t.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
la=t.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",u,P);if(P&&la){n.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ca={};Ca[Se.a.XLb]="1";Ca[Se.a.documentUrl]=u;Ca[Se.a.reason]=Ei.a.QZe;t.AFrameworkApplication.QT().execute(Ta=>{Ta.sendMessage(Qe.a.YDa,Ca)})}else bb.a.In(u,bb.a.Nba(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}Quc(){this.Yh&&
1===this.Yh.state||(this.eo=this.gra(),this.eo.message=CommonUIStrings.l_CommentProgressTooltip,this.eo.Ad=5,this.eo.Mr=!1,this.eo.Fpa(CommonUIStrings.l_DefaultDialogTitle,null,null))}y9a(){this.eo&&(this.eo.close(),this.eo=null)}Ouc(){this.Nt(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}nBl(){this.Nt(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}xAl(){const u=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.Nt(CommonUIStrings.l_SaveAsFileTooLargeTitle,u,Rh.a.pjl)}Nt(u,P,la=Rh.a.tjl){n.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",u,P);this.y9a();1!==this.Yh.state&&this.iB().kWf(u,P,la)}pAl(u){n.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",u);switch(u){case Ki.a.AOh:this.nBl();break;case Ki.a.mth:this.xAl();break;default:this.Ouc()}}gYe(){"VersionHistory"===this.XOd&&this.Ca.processAction(F.a.Iqd,2)}Gya(u){"VersionHistory"===this.XOd&&this.Ca.Ja(F.a.hYe,
2,{["FailureReason"]:u})}}Object(r.a)(Wi,"UploadToSharePointManager",null,[1259]);class Xi{constructor(){this.iQa=this.xLd=this.rLd=this.Ea=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Xb(u){this.Ea=u;this.rLd=Kh.a.Ot(u.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.xLd=Kh.a.Ot(u.Ia("Common.IEventEmitter<Common.IMruResult>"));this.iQa=Kh.a.Ot(u.Ia("Common.App.SharedFilePicker.ISharedFilePicker"));Kg.Task.WAA.call(null,this.rLd,this.xLd,this.iQa).continueWith(()=>
{this.V6k()})}V6k(){this.Ea.register(li,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").oa(()=>new li(t.AFrameworkApplication.fa)).na();this.Ea.register(Wi,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").oa(()=>new Wi(t.AFrameworkApplication.Qa,this.Ea.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new hf.a).create(),()=>new Ej,
t.AFrameworkApplication.Aa)).na();this.Ea.register(Sg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").oa(()=>new Sg(this.Ea.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Ej,this.Ea.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),t.AFrameworkApplication.Aa)).na();this.Ea.register(Xe,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").oa(()=>
new Xe(this.Ea.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Pa.a(()=>this.rLd.result),t.AFrameworkApplication.Aa,()=>new pe)).na();this.Ea.register(ue,"Common.App.SaveToSharePoint.FileNameDialogFactory").oa(()=>new ue(t.AFrameworkApplication.fa,t.AFrameworkApplication.Qa,t.AFrameworkApplication.Aa,t.AFrameworkApplication.Aa.mb,this.Ea.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Ea.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Ea.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new Pa.a(()=>this.xLd.result),this.Ea.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.iQa?this.iQa.result:null)).na();this.Ea.register(cg,"Common.App.SaveToSharePoint.SaveToSharePointActor").oa(()=>new cg(t.AFrameworkApplication.fa,t.AFrameworkApplication.Qa,this.Ea.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Ea.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Ea.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Ea.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>t.AFrameworkApplication.Aa.EMc)).na();t.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Ea.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").vb()}static main(){m.a.instance.Ac(new Xi)}}Object(r.a)(Xi,"PackageManager",null,[2,3]);class Fi extends Sa.StandardDialog{constructor(){super();this.Ad=0;this.Le(1,CommonUIStrings.l_DialogClose)}Bv(u){this.Yy(u,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(r.a)(Fi,"ErrorDialog",Sa.StandardDialog,[1146]);class Mi{}Mi.default=0;Object(r.a)(Mi,"SaveToCloudErrorCodes",null,[]);class mh{constructor(u,P,la,Ca,Ta,pb){this.ol=null;this.y$h=u;this.Fca=P;this.Bsb=la;this.Ma=Ca;this.uob=Ta;this.iB=pb}start(u){this.ol=u;if("SharePointOnlineConsumer"===this.Ma.Ha("FileSource")){const P=w.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(P){P.start(null,u);return}}this.Fca.One?("Open From URL"===Object(U.a)(String,t.AFrameworkApplication.Md.Host)||
t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))&&t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?(n.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.Bsb.pZ("root","https://onedrive.live.com",null,this.ol)):(n.ULS.sendTraceTag(6590559,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?
15:50,"User is signed in. We will show file picker."),this.rzi()):(n.ULS.sendTraceTag(6590560,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?15:50,"User is not signed in. We will show sign in dialog."),this.TBl())}TBl(){this.y$h.create().lka()}Nt(){this.iB().Bv(Mi.default)}rzi(){try{n.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let u={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.uob||2===
this.uob)u={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId};WL.init(u);n.ULS.sendTraceTag(6590562,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.Pz,"onFailure"))}catch(u){n.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",
u,u.stack),this.Nt()}}onSuccess(u){n.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");u&&u.data&&u.data.folders&&this.Bsb.pZ(u.data.folders[0].id,u.data.folders[0].urls.viewInBrowser,null,this.ol)}Pz(u){if(u&&u.error){if("user_canceled"===u.error.code){n.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}n.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",u.error.code,
u.error.message)}else n.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Nt()}}Object(r.a)(mh,"SaveToCloudManager",null,[1181]);class ai{constructor(u,P,la,Ca){this.qGc=null;this.k9h=u;this.Ma=la;this.Mqf=P;this.mof=new vb.a;this.ki=Ca}sCb(){return this.Ma.ka("SaveToCloudStorageUIIsEnabled")}A5f(){return F.a.ZZe}tMc(){Mc.a.Gpd(Object(z.a)(this,this.Fwh,"saveToCloudActionDispatcher"));Mc.a.Q5b([new gg.a(F.a.ZZe,J.a.frame,0)],this.Mqf.Kyb())}vb(){const u=this.Mqf.Kyb();
u?(u.sW(()=>{this.mof.Ng(!0)}),this.tMc()):n.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}poh(){n.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}Fwh(u,P,la,Ca,Ta){return P.contextId!==J.a.frame||u!==this.A5f()?2:this.sCb()?1===la?x.SessionStatusManager.instance.jla||t.AFrameworkApplication.$Q?8:32:2===la?(this.poh(),Ta&&Ta.FileDownloadUrl&&n.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.ki&&(this.qGc=this.ki.Ii("DialogShown","SaveToOneDriveReponseTime")),this.mof.task.continueWith(()=>{this.qGc&&(this.qGc.stop(),this.qGc=null);this.k9h.start(Ta)}),32):8:8}}Object(r.a)(ai,"SaveToCloudStorageActor",null,[1180]);var Aa=d(216);class Ua extends Sa.StandardDialog{constructor(u,P,la){super();this.Ca=u;this.Fca=P;this.Sba=la;this.ZV=!1;this.Ad=1;this.cza(1);this.Le(1,CommonUIStrings.l_SignIn);this.Le(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}lka(){this.Fca.CAf(Object(z.a)(this,
this.Jdh,"onSignIn"));this.Tx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(z.a)(this,this.sTj,"inputHandler"))}sTj(u){0===u?(n.ULS.sendTraceTag(6590598,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?15:50,"User dismissed SignIn Dialog."),this.hide()):this.ymd()}EBi(){let u="2";if(this.Sba)switch(this.Sba.Ti){case 3:u="0";break;case 2:u="3";break;case 1:u="1"}return u}hide(){this.Fca.Jal(Object(z.a)(this,
this.Jdh,"onSignIn"));super.hide()}ymd(){var u=t.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";u=new Aa.QueryStringBuilder(u);u.xg("prompt","1");u.xg("cbcxt",this.EBi());t.AFrameworkApplication.GQa(u);bb.a.In(u.toString(),"LoginWindow",void 0,"SignInDialog")}Jdh(){this.aR&&this.hide();n.ULS.sendTraceTag(7143885,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.Ca.processAction(F.a.ZZe,2)}}Object(r.a)(Ua,"SignInDialog",Sa.StandardDialog,[1284]);class gb{constructor(u,P,la){this.Ca=u;this.Fca=P;this.Sba=la}create(){return new Ua(this.Ca,this.Fca,this.Sba)}}Object(r.a)(gb,"SignInDialogFactory",null,[1270]);class Eb{constructor(u,P,la,Ca,Ta,pb,Sb){this.lCa=u;this.RK=P;this.Fpb=la;this.JBc=Ca;this.KNd=Ta;this.cBa=pb;this.ol=Sb}execute(u,P){if(!t.AFrameworkApplication.Yg&&t.AFrameworkApplication.Je){var la=this.lCa+this.cBa;la=Cd.a.Pi(la,"fo",Gb.a.Ne(this.JBc));
la=Cd.a.Pi(la,"fn",Gb.a.Ne(this.RK));la=Cd.a.Pi(la,"qs",Gb.a.Ne(this.KNd));la=Cd.a.Pi(la,"n",Gb.a.Ne((new Date).getTime().toString()));this.ol&&this.ol.FileDownloadUrl&&(la=Cd.a.Pi(la,"furl",Gb.a.Ne(this.ol.FileDownloadUrl)));this.Fpb&&(la=Cd.a.Pi(la,"fnn",Gb.a.Ne(this.Fpb)));t.AFrameworkApplication.Je.qj(la,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,u,P,null)}}}Object(r.a)(Eb,"SkyDriveUploadCaller",null,[1283]);class Ub{constructor(u){this.Ma=u;this.Pra=u.appSettings.SkyDriveUploadWebServiceBase;
this.RK=u.appSettings.FileName;this.cBa=u.Ha("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(u,P,la){return new Eb(this.Pra,this.RK,P,u,t.AFrameworkApplication.Pg,this.cBa,la)}}Object(r.a)(Ub,"SkydriveUploadCallerFactory",null,[1269]);class vc{constructor(u,P,la,Ca,Ta){this.Jqa=this.eo=this.ZSb=null;this.X2=!1;this.ol=this.gCa=null;this.fSd=u;this.gra=P;this.iB=la;this.Yh=Ca;this.ki=Ta}Quc(){this.Yh&&1===this.Yh.state||(this.eo=this.gra(),this.eo.message=CommonUIStrings.l_CommentProgressTooltip,
this.eo.Ad=5,this.eo.Mr=!1,this.eo.Fpa(CommonUIStrings.l_DefaultDialogTitle,null,null))}y9a(){this.eo&&(this.eo.close(),this.eo=null)}nZ(){1!==t.AFrameworkApplication.Aa.state&&this.iB().Bv(Mi.default)}akb(){n.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");bb.a.In(this.Jqa,bb.a.Nba(3),void 0,"UploadToCloudManager.RedirectToFolder")}$jb(u){t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti&&(u+="&wdsvodm=true");let P=!1,la=!1;t.AFrameworkApplication.fa&&
(P=t.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),la=t.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));n.ULS.sendTraceTag(6654163,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",u,P);if(P&&la){n.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ca={};Ca[Se.a.XLb]="1";Ca[Se.a.documentUrl]=
u;t.AFrameworkApplication.QT().execute(Ta=>{Ta.sendMessage(Qe.a.YDa,Ca)})}else bb.a.In(u,bb.a.Nba(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}pZ(u,P,la=null,Ca=null){n.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.ki&&(this.gCa=this.ki.Ii("DialogShown","SaveToOneDriveUploadTime"));this.Quc();this.Jqa=P;this.ZSb=this.fSd.create(u,la,Ca);this.ol=Ca;this.c4()}c4(){n.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.ZSb.execute(Object(z.a)(this,this.wLk,
"onSaveToCloudUploadFinished"),Object(z.a)(this,this.vLk,"onSaveToCloudUploadFailed"))}wLk(u){this.y9a();this.X2=!1;if(u&&u.data&&u.data.Wd){var P;if(({Su:P}=Hd.d(u.data.Wd)).returnValue)if(u=P,u.StatusCode!==Ki.a.mx&&u.StatusCode!==Ki.a.Y3b)n.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.nZ();else{n.ULS.sendTraceTag(6590603,216,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb&&1===t.AFrameworkApplication.Aa.mb.Ti?15:50,"UploadToCloudManager upload success.");
try{u.NewDocumentUrl&&""!==u.NewDocumentUrl?this.$jb(u.NewDocumentUrl):this.akb()}catch(la){n.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",la.toString())}this.Ooc()}else n.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:wf.a.axc(u.data.Wd)}),this.nZ()}else n.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.nZ()}vLk(u){5!==u.data.status&&12!==u.data.status||this.X2?(n.ULS.sendTraceTag(6590605,
216,10,"UploadToCloudManager HTTP failure with code: {0}",u.data.status),this.y9a(),this.nZ(),this.Ooc()):(n.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.X2=!0,this.c4())}Ooc(){this.gCa&&(this.gCa.stop(),this.gCa=null)}}Object(r.a)(vc,"UploadToCloudManager",null,[1143]);class jd{constructor(){this.Ea=null}get name(){return"Common.App.SaveToCloudStorage"}init(){t.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&this.Ea.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").vb()}dispose(){}Xb(u){this.Ea=
u;this.Ea.register(gb,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").oa(()=>new gb(t.AFrameworkApplication.Qa,Lg.a.instance,t.AFrameworkApplication.Aa.mb)).na();this.Ea.register(Ub,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").oa(()=>new Ub(t.AFrameworkApplication.fa)).na();this.Ea.register(ai,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").oa(()=>
new ai(u.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),u.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),t.AFrameworkApplication.fa,t.AFrameworkApplication.Aa.BV)).na();this.Ea.register(vc,"Common.App.SaveToCloudStorage.UploadToCloudManager").oa(()=>new vc(u.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new hf.a).create(),()=>new Fi,t.AFrameworkApplication.Aa,t.AFrameworkApplication.Aa.BV)).na();this.Ea.register(mh,"Common.App.SaveToCloudStorage.SaveToCloudManager").oa(()=>
new mh(u.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Lg.a.instance,u.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),t.AFrameworkApplication.fa,t.AFrameworkApplication.dTa,()=>new Fi)).na()}static main(){m.a.instance.Ac(new jd)}}Object(r.a)(jd,"PackageManager",null,[2,3]);class Id{static get hg(){return Ue.a.pz(Id.Fo,CommonUIStrings.l_SaveACopyFileName)}}Id.Fo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(r.a)(Id,"FileNameDialogHtml",null,[]);class Od extends Ue.a{constructor(u,P,la,Ca){super();this.JBc=this.Jqa=null;this.Ca=u;this.Sba=P;this.Bsb=la;this.Le(1,CommonUIStrings.l_SaveButtonLabel);this.hg=Id.hg;this.ig="FileNameDialog-SaveACopy";this.ol=Ca}lka(u,P,la){this.JBc=u;this.Jqa=la;u={["txtFileName"]:Gb.a.mH(t.AFrameworkApplication.ju.rx),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,P)};this.sj(CommonUIStrings.l_SaveToOneDrive,Object(z.a)(this,this.oTc,"fileNameDialogHandler"),
u);n.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}oTc(u,P){1!==u?n.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(u=P.txtFileName.trim(),n.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),P=Gb.a.IQ(t.AFrameworkApplication.fileName),u&&""!==u&&""!==P&&(u+=P),this.Bsb.pZ(this.JBc,this.Jqa,u,this.ol))}}Object(r.a)(Od,"FileNameDialog",Ue.a,
[1182]);class ba{constructor(u,P,la){this.Ca=u;this.Sba=P;this.Bsb=la}create(u){return new Od(this.Ca,this.Sba,this.Bsb,u)}}Object(r.a)(ba,"FileNameDialogFactory",null,[1145]);class Da extends Sa.StandardDialog{constructor(u){super();this.Ad=1;this.Le(1,CommonUIStrings.l_RetryButtonLabel);this.Le(0,CommonUIStrings.l_DialogClose);this.Ca=u}Bv(u){n.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",u);this.Yy(u,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(z.a)(this,this.ZYe,"retryDialogHandler"))}ZYe(u){1===u?(n.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(F.a.Qsc,2)):n.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(r.a)(Da,"RetryDialog",Sa.StandardDialog,[1146]);class Qa extends ai{constructor(u,P,la,Ca){super(u,P,la,Ca);this.r6h=P}sCb(){return this.Ma.ka("SaveACopyBrsIsEnabled")}A5f(){return F.a.Qsc}tMc(){Mc.a.Gpd(Object(z.a)(this,this.Fwh,"saveToCloudActionDispatcher"));
Mc.a.Q5b([new gg.a(F.a.Qsc,J.a.frame,0)],this.r6h.Kyb())}poh(){t.AFrameworkApplication.Oea("CreateCopy_cf;CreateCopy_tf");n.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(r.a)(Qa,"SaveACopyActor",ai,[]);class nb extends mh{constructor(u,P,la,Ca,Ta,pb,Sb){super(P,la,Ca,Ta,pb,Sb);this.j0h=u}onSuccess(u){u&&u.data&&u.data.folders?(n.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.j0h.create(this.ol).lka(u.data.folders[0].id,
u.data.folders[0].name,u.data.folders[0].urls.viewInBrowser)):(n.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Nt())}Pz(u){u&&u.error&&"user_canceled"===u.error.code&&n.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.Pz(u)}Nt(){n.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.Nt()}}Object(r.a)(nb,"SaveACopyManager",mh,[]);class Wb extends vc{constructor(u,P,la,Ca,Ta,pb){super(P,la,Ca,Ta,
pb);this.Ca=u}$qe(){return!!this.ol&&!!this.ol.SaveEntryPoint&&"VersionHistory"===this.ol.SaveEntryPoint.toString()}nZ(){n.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.$qe()&&this.Ca.Ja(F.a.hYe,2,{["FailureReason"]:"Unknown"});super.nZ()}akb(){n.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.$qe()&&this.Ca.processAction(F.a.Iqd,2);super.akb()}$jb(u){n.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",u);
this.$qe()&&this.Ca.processAction(F.a.Iqd,2);super.$jb(u)}c4(){this.ol&&"true"===this.ol.SkipSaveToHost?super.c4():32!==this.Ca.processAction(F.a.b1a,1)?(n.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.c4()):this.Ca.Ja(F.a.b1a,2,[()=>{n.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");vc.prototype.c4.call(this)},()=>{n.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.nZ()}])}}Object(r.a)(Wb,"SaveACopyUploadToCloudManager",vc,[]);class Jb{constructor(){this.Ea=null}get name(){return"Common.App.SaveACopy"}init(){t.AFrameworkApplication.fa.$e(Object(z.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){t.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&this.Ea.resolve("Common.App.SaveACopy.SaveACopyActor").vb()}dispose(){}Xb(u){this.Ea=u;this.Ea.register(Wb,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").oa(()=>new Wb(t.AFrameworkApplication.Qa,u.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
()=>(new hf.a).create(),()=>new Da(t.AFrameworkApplication.Qa),t.AFrameworkApplication.Aa,t.AFrameworkApplication.Aa.BV)).na();this.Ea.register(ba,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").oa(()=>new ba(t.AFrameworkApplication.Qa,t.AFrameworkApplication.Aa.mb,u.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).na();this.Ea.register(Qa,"Common.App.SaveACopy.SaveACopyActor").oa(()=>new Qa(u.resolve("Common.App.SaveACopy.SaveACopyManager"),
u.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),t.AFrameworkApplication.fa,t.AFrameworkApplication.Aa.BV)).na();this.Ea.register(nb,"Common.App.SaveACopy.SaveACopyManager").oa(()=>new nb(u.resolve("Common.App.SaveACopy.FileNameDialogFactory"),u.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Lg.a.instance,u.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),t.AFrameworkApplication.fa,t.AFrameworkApplication.dTa,()=>new Da(t.AFrameworkApplication.Qa))).na()}static main(){m.a.instance.Ac(new Jb)}}
Object(r.a)(Jb,"PackageManager",null,[2,3]);var Uc=d(379);class Jd{constructor(u){this.JNg=null;n.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.pjc=t.AFrameworkApplication.fa.Ha("PhoneLinkServiceEndpoint");(this.CM=u)||n.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.pjc&&this.pjc.length||n.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}M6i(u){u&&(this.pjc="https://dcg-df.microsoft.com/",n.ULS.sendTraceTag(526697302,
306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.L6i()}L6i(){n.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.JNg)n.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.JNg=new Date;var u=new Date;this.CM.mI("BayBridge",this.pjc).then(P=>{const la=+new Date-+u;P.IsSuccess?(n.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",
la),this.E6i(P.Token,this.Mdj())):n.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",la,P.ErrorCode,P.ErrorMessage)}).catch(P=>{n.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",P,+new Date-+u)})}}E6i(u,P){const la={};la.Authorization="Bearer "+u;la["Authorization-Type"]="AAD";la.Accept="application/json";la["DCG-SessionId"]=
t.AFrameworkApplication.userSessionId;t.AFrameworkApplication.Je.qj(P,1,null,la,!1,2,Object(z.a)(this,this.Swj,"getStatusSucceeded"),Object(z.a)(this,this.Qwj,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39");oc.a("FetchAccountLinkedStatus")}Vej(){const u=Uc.a.instance.getItem("AccountLinkedStatusCache");return u&&u.length?"true"===u.toLowerCase()?!0:!1:!1}Mdj(){return this.pjc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Qwj(){n.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Swj(u){n.ULS.sendTraceTag(527214157,
352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");u=Hd.a(u.data.Wd).state+"";Uc.a.instance.setItem("AccountLinkedStatusCache",u)}}Object(r.a)(Jd,"PhoneLinkManager",null,[1105]);class ne{constructor(){this.Ea=null}get name(){return"Common.App.PhoneLink"}Xb(u){this.Ea=u;this.Ea.register(1105,"Common.App.PhoneLink.IPhoneLinkManager").na().oa(()=>new Jd(this.Ea.resolve("Common.App.OAuth.IOAuthManager")))}init(){t.AFrameworkApplication.fa.$e(()=>{this.zFa()})}zFa(){this.Ea.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){m.a.instance.Ac(new ne)}}
Object(r.a)(ne,"PhoneLinkPackage",null,[2,3]);var bf;(function(u){u[u.myFiles=0]="myFiles";u[u.recent=1]="recent";u[u.currentFolder=2]="currentFolder";u[u.yourPhone=3]="yourPhone"})(bf||(bf={}));Object(r.b)("SharedFilePickerLandingLocation",bf);class sd{constructor(u){this.vbb=this.ZKb=null;this._initialized=!1;this.jie=u}R6d(u){this._initialized||(u.Nu(Qe.a.boh),u.fC(Qe.a.boh,Object(z.a)(this,this.RKk,"onReceivedPickerResponse")),this._initialized=!0)}jWc(u){return this.vbb=new Promise((P,la)=>{const Ca=
{};Ca[Se.a.PSk]=u;this.ZKb=(Ta,pb)=>{""===pb?(n.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),P(Ta)):("Canceled"===pb?n.ULS.sendTraceTag(572548164,306,50,pb):n.ULS.sendTraceTag(556901065,306,10,pb),la(pb))};this.jie.execute(Ta=>{this.R6d(Ta);Ta.sendMessage(Qe.a.rOk,Ca)})})}RKk(u){this.ZKb(u.Values[Se.a.qll],void 0===u.Values[Se.a.zQe]||null===u.Values[Se.a.zQe]?"":u.Values[Se.a.zQe])}jre(){return t.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}X1d(u,P,la,Ca,Ta,pb,
Sb,Cc,ed=null){const ad={};ad[Se.a.$kl]=u;ad[Se.a.titleText]=P;ad[Se.a.xni]=la;ad[Se.a.yni]=Ca;ad[Se.a.zni]=Ta;ad[Se.a.nYi]=!0;ad[Se.a.g7i]=pb;ad[Se.a.SSk]=Sb;ad[Se.a.RSk]=bf[Cc];Ad.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(ad[Se.a.TSk]="Dark");ed&&(null!=ed.mtb&&(ad[Se.a.mtb]=ed.mtb),null!=ed.lAb&&(ad[Se.a.lAb]=ed.lAb));return ad}}Object(r.a)(sd,"SharedFilePickerManager",null,[1135]);class vd{constructor(){this.Ea=null}get name(){return"Common.App.SharedFilePicker"}Xb(u){this.Ea=
u;u.register(sd,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").na().oa(()=>new sd(u.Ia("Postmessage.IHostPostmessenger")))}init(){t.AFrameworkApplication.fa.$e(()=>{this.zFa()})}zFa(){this.Ea.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){m.a.instance.Ac(new vd)}}Object(r.a)(vd,"SharedFilePickerPackage",null,[2,3]);class $c{constructor(u,P=3E4){this.HLl=9E5;this.LLl=1E4;this.iBg=this.$Fb=null;this.Jve=0;
this.t4b=Date.now;this.azj=u;this.Yxd=P;this.VUc()}Heg(u=!0){const P=this.t4b();if(P<this.Jve+this.HLl)return P>this.Jve+this.LLl&&this.VUc(),this.iBg;u&&this.VUc();return null}getToken(u=!0){return(u=this.Heg(u))?Promise.resolve(u):this.VUc()}VUc(){return this.$Fb=this.$Fb||new Promise(u=>{this.azj().then(P=>{this.$Fb=null;""!==P&&P&&(this.iBg=P,this.Jve=this.t4b(),u(P));u(null)}).catch(()=>{this.$Fb=null;u(null)});window.setTimeout(()=>{this.$Fb=null;u(null)},this.Yxd)})}}Object(r.a)($c,"OAuthCacheManager",
null,[]);class hd{constructor(){this.CM=null;this.zhf={};this.HQb=new hg.a(Lh.a.Gk())}getToken(u,P){if(this.HQb.Gb(P))return this.HQb.ga(P).getToken();const la=new $c(()=>this.Ieg(u,P));this.HQb.$(P,la);return la.getToken()}$yj(u,P){if(this.HQb.Gb(P))return this.HQb.ga(P).Heg();const la=new $c(()=>this.Ieg(u,P));this.HQb.$(P,la);return null}Ieg(u,P){if(!this.CM)try{this.CM=w.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(la){n.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+
la)}return this.CM?new Promise(la=>{const Ca=Date.now();this.CM.mI(u,P).then(Ta=>{const pb=Ta.Token;!Ta.IsSuccess||this.Q8j(pb)?(this.DNb("GetTokenInternalImplicitJS",!1,Date.now()-Ca,u,Ta.ErrorCode,Ta.ErrorMessage,P),la(null)):(this.DNb("GetTokenInternalImplicitJS",!0,Date.now()-Ca,u,Ta.ErrorCode,Ta.ErrorMessage,P),la(pb))}).catch(Ta=>{Ta=Ta?Hd.c(Ta):"";this.DNb("GetTokenInternalImplicitJS",!1,Date.now()-Ca,u,"Caught Exception",Ta,P);la(null)})}):new Promise(la=>{this.DNb("GetTokenInternalImplicitJS",
!1,0,u,"Null OAuthManager","OAuthManager not set");la(null)})}DNb(u,P,la,Ca,Ta="",pb="",Sb=""){var Cc="Search"===Ca;const ed=[];u=Vd.a.V_(Cc?"Event":"EventName",u,2);Ca=Vd.a.V_("AppName",Ca,2);Array.add(ed,u);Array.add(ed,Ca);Cc&&(Ca=Vd.a.V_("LatencyType","FetchToken",2),Array.add(ed,Ca));Ta&&""!==Ta&&(Ta=Vd.a.V_("ErrorCode",Ta,2),Array.add(ed,Ta));pb&&""!==pb&&(pb=Vd.a.V_("ErrorMessage",pb,2),Array.add(ed,pb));Sb&&""!==Sb&&(pb=!(Sb in this.zhf),this.zhf[Sb]=pb,pb=Vd.a.V_("WarmUpCall",pb.toString(),
1),Array.add(ed,pb),Sb=Vd.a.V_("Service",this.YXc(Sb),2),Array.add(ed,Sb));Cc=Cc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";P=Object.assign(new lf.a,{name:Cc,samplingPolicy:2,dataFields:ed,succeeded:P,durationMs:la});B.a.sendActivityEvent(P)}YXc(u){return u===t.AFrameworkApplication.pue?"Loki":u===t.AFrameworkApplication.j6e?"Substrate":t.AFrameworkApplication.fa&&u===t.AFrameworkApplication.fa.Ha("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}Q8j(u){return!u||
!u.length}}Object(r.a)(hd,"SearchOAuthManager",null,[1103]);class Dd{constructor(){this.Ea=null}get name(){return"Common.App.SearchOAuthManager"}Xb(u){this.Ea=u;this.Ea.register(1103,"Common.App.SearchCommon.ISearchOAuthManager").na().oa(()=>new hd)}init(){}dispose(){}static main(){m.a.instance.Ac(new Dd)}}Object(r.a)(Dd,"SearchOAuthPackage",null,[2,3]);var Re;(function(u){u[u.generalException=0]="generalException";u[u.invalidArgument=1]="invalidArgument";u[u.notAllowed=2]="notAllowed";u[u.apiNotAvailable=
3]="apiNotAvailable";u[u.unresolvedPendingRequest=4]="unresolvedPendingRequest";u[u.timeout=5]="timeout";u[u.adalTimeout=6]="adalTimeout";u[u.userNotSignedIn=7]="userNotSignedIn";u[u.userAborted=8]="userAborted";u[u.silentSignInFailed=9]="silentSignInFailed";u[u.invalidResourceUrl=10]="invalidResourceUrl";u[u.invalidGrant=11]="invalidGrant";u[u.connectionLost=12]="connectionLost";u[u.clientError=13]="clientError";u[u.serverError=14]="serverError"})(Re||(Re={}));Object(r.b)("ErrorCodes",Re);class ml{}
Object(r.a)(ml,"HostApplicationType",null,[]);class Mh{constructor(u,P){this.requestCallback=this.requestParameters=null;this.requestParameters=u;this.requestCallback=P}}Object(r.a)(Mh,"OutstandingRequest",null,[]);class we{}we.yCk="AADSTS50058";we.invalidResourceUrl="AADSTS50001";we.sCk="AADSTS65001";we.LCk="AADSTS70011";we.userAborted="13002";we.IUk="Popup Window is null";we.HUk="Popup Window closed";we.adalTimeout="Token renewal operation failed due to timeout";we.MLl="tokenRevoked";Object(r.a)(we,
"WopiHostErrorType",null,[]);var Yi=d(218),nl=d(317),Pj=d(1004);class ol{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(r.a)(ol,"WopiIdentityInfo",null,[1165]);class mi{constructor(u,P,la){this.expiration=this.authority=this.accessToken=null;this.accessToken=u;this.authority=P;this.expiration=la}}Object(r.a)(mi,"WopiIdentityToken",null,[1164]);class nk{constructor(u){this._initialized=!1;this.JJb={};this.mwd={};this.pba=t.AFrameworkApplication.Aa.BV;
this.jie=u}R6d(u){this._initialized||(u.Nu(Qe.a.Nih),u.fC(Qe.a.Nih,Object(z.a)(this,this.PKk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(u,P,la=null){this.thk(u,P);return new Promise((Ca,Ta)=>{if(this.Ine(P))if(P in this.JJb)Ta("unresolvedPendingRequest");else{var pb=window.setTimeout(()=>{n.ULS.sendTraceTag(37856032,344,10,Hd.c({["error"]:"Request timeout.",["callerId"]:P}));Ta("timeout")},12E4);this.v$d(u,P,la,(Sb,Cc)=>{window.clearTimeout(pb);Sb?Ca(Sb):(n.ULS.sendTraceTag(37856033,
369,15,Hd.c({["error"]:Re[Cc]})),Ta(Cc))})}else n.ULS.sendTraceTag(37856034,344,10,Hd.c({["error"]:"Caller is not allowed."})),Ta("notAllowed")})}getPrimaryIdentityInfo(u){return new Promise((P,la)=>{this.Ine(u)?this.Xrj((Ca,Ta)=>{Ca?P(Ca):(n.ULS.sendTraceTag(37856064,369,10,Hd.c({["error"]:Ta.toString()})),la(Ta))}):(n.ULS.sendTraceTag(37856065,344,10,Hd.c({["error"]:"Caller is not allowed."})),la("notAllowed"))})}getAuthContext(u){return new Promise((P,la)=>{const Ca=this.getAuthContextSync(u);
Ca?P(Ca):la("notAllowed")})}getAuthContextSync(u){if(this.Ine(u)){const P=new Pj.a;P.upn=t.AFrameworkApplication.fa.Ha("UserPrincipalName");P.userId=t.AFrameworkApplication.fa.Ha("LoggableUserId");P.authority=t.AFrameworkApplication.fa.Ha("HostAuthAuthority");P.tenantId=t.AFrameworkApplication.fa.Ha("TenantId");P.isAnonymous=t.AFrameworkApplication.fa.ka("IsAnonymousUser");P.supportsAuthToken=this.fNj(u);u=t.AFrameworkApplication.fa.Ha("HostAuthType");P.authorityType="aad"===u.toLowerCase()?2:"msa"===
u.toLowerCase()?1:0;return P}n.ULS.sendTraceTag(40751647,344,10,Hd.c({["error"]:"Caller is not allowed."}));return null}fNj(u){const P=Yi.OAuthManagerSettings.ubb;return yd.a.zGa?P&&Yi.OAuthManagerSettings.qKh?Array.contains(Yi.OAuthManagerSettings.qKh,u.toLowerCase()):!1:P}v$d(u,P,la,Ca){var Ta=[];Array.add(Ta,Object.assign(new L.a,{name:"CallerId",string:P}));Array.add(Ta,Object.assign(new L.a,{name:Se.a.m5e,string:u.correlationId}));B.a.sendTelemetryEvent(Object.assign(new M.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",
dataFields:Ta}));Ta=nl.a.create().toString();const pb="getAccessToken_"+Ta,Sb=this.pba.Ii("ComponentAttach",pb);this.mwd[pb]=Sb;const Cc={};Cc[Se.a.n5e]=Ta;Cc[Se.a.bFl]=u.resource;Cc[Se.a.cFl]=u.scope;Cc[Se.a.dHh]=t.AFrameworkApplication.fa.Ha("HostAuthType");Cc[Se.a.fFl]=t.AFrameworkApplication.fa.Ha("UserPrincipalName");Cc[Se.a.dFl]=u.silentLogin;Cc[Se.a.ZEl]=u.options;Cc[Se.a.m5e]=u.correlationId;Cc[Se.a.$El]=P;la&&(Cc[Se.a.addinName]=la.AddinName,Cc[Se.a.YEl]=la.AddinTrustId);this.jie.execute(ed=>
{this.R6d(ed);ed.sendMessage(Qe.a.getAuthToken,Cc)});this.JJb[Ta]=new Mh(u,Ca)}Xrj(u){const P=t.AFrameworkApplication.fa.Ha("UserName"),la=t.AFrameworkApplication.fa.Ha("UserPrincipalName"),Ca=t.AFrameworkApplication.fa.Ha("LoggableUserIdSpace"),Ta=new ol;Ta.email=la;Ta.displayName=P;switch(Ca){case "OrgIdPuid":Ta.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Ta.authority="MicrosoftAccount";break;default:Ta.authority=Ca}u(Ta,null)}PKk(u){let P=null;try{let Ca=u.Values[Se.a.n5e];
const Ta=u.Values[Se.a.XEl],pb=u.Values[Se.a.dHh],Sb=u.Values[Se.a.eFl];let Cc=null,ed=null;const ad=this.JJb[Ca];if("undefined"!==typeof ad&&ad){var la=[];Array.add(la,Object.assign(new L.a,{name:Se.a.m5e,string:ad.requestParameters.correlationId}));B.a.sendTelemetryEvent(Object.assign(new M.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:la}));P=ad.requestCallback;delete this.JJb[Ca];"undefined"!==typeof Ta&&Ta&&Ta.length?ed=new mi(Ta,pb,Sb):Cc=Re[this.byk(u)];
la="getAccessToken_"+Ca;la in this.mwd&&(this.mwd[la].stop(),delete this.mwd[la]);P(ed,Cc)}else n.ULS.sendTraceTag(37856066,344,10,Hd.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Ca}))}catch(Ca){u=u.Values[Se.a.n5e],u in this.JJb&&delete this.JJb[u],this.X5c(),n.ULS.sendTraceTag(37856067,344,10,Hd.c({["error"]:Ca.message,["stack"]:Ca.stack})),P&&P(null,"generalException")}}Ine(u){var P=t.AFrameworkApplication.zBj();u=u.toLowerCase();for(const la of P)if(u===la.toLowerCase())return!0;
P=Yi.OAuthManagerSettings.AVd;for(let la in P)if(u===P[la].toLowerCase())return!0;return!1}byk(u){u=u.Values[Se.a.aFl];this.X5c();n.ULS.sendTraceTag(39068821,344,15,Hd.c({["error"]:u}));return u?-1<u.indexOf(we.yCk)?9:-1<u.indexOf(we.IUk)||-1<u.indexOf(we.HUk)?12:-1<u.indexOf(we.invalidResourceUrl)?10:-1<u.indexOf(we.userAborted)?8:-1<u.indexOf(we.LCk)||-1<u.indexOf(we.sCk)||u===we.MLl?11:-1<u.indexOf(we.adalTimeout)?6:0:13}thk(u,P){u=this.o6k(u.resource);n.ULS.sendTraceTag(39921882,344,50,Hd.c({["callerId"]:P,
["resource"]:u}))}X5c(){n.ULS.sendTraceTag(39068822,344,50,Hd.c({["userAgent"]:window.navigator.userAgent}))}o6k(u){return(u?u:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(r.a)(nk,"WopiIdentityManager",null,[1134]);class ek{constructor(){this.Ea=null}get name(){return"Common.App.WopiIdentity"}Xb(u){this.Ea=u;u.register(nk,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").na().oa(()=>new nk(u.Ia("Postmessage.IHostPostmessenger")))}init(){t.AFrameworkApplication.fa&&
t.AFrameworkApplication.fa.$e(Object(z.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){try{this.Ea.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(u){n.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+u)}}dispose(){}static main(){m.a.instance.Ac(new ek)}}Object(r.a)(ek,"WopiIdentityPackage",null,[2,3]);var bj=d(680);class Nk extends bj.a{constructor(u,P){super(u,Cd.a.KQ(P))}Aya(u,P){this.isEnabled()&&this.qCa(this.GMa)&&(this.Nu(u),this.fC(u,P))}}
Object(r.a)(Nk,"InsertMediaCrossDocumentMessenger",bj.a,[1313,537,108]);class Qj{getInstance(u,P){return new Nk(u,P)}}Object(r.a)(Qj,"InsertMediaCrossDocumentMessengerFactory",null,[1301]);class Nf{constructor(u,P,la){this.correlationId=null;this.xaa=0;this.insertPictureTelemetryEndpoint=null;this.IQc=0;this.z1h=u;this.$Zb=[];this.x1h=P;this.Rvf=la.split(";")}emb(u,P){Array.clear(this.$Zb);u=this.z1h.value;u.OQl(P.Yzb);u.qCa(this.x1h);u.Nu(P.Yzb);u.fC(P.Yzb,la=>{this.SNe(la,P)});n.ULS.sendTraceTag(17838540,
352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");u.sendMessage(P.zSf,{["FileExtensionFilterList"]:this.Rvf})}xhi(u){Array.contains(this.$Zb,u)||Array.add(this.$Zb,u)}SNe(u,P){n.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");u=P.Sgh(u);const la=[];for(let Ca=0;Ca<u.length;Ca++){const Ta=u[Ca];P.h2c(Ta,this.Rvf)?Array.add(la,Ta):this.xhi(P.icg(Ta))}la&&la.length?P.Dua(la):n.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");
0<this.$Zb.length&&(P=this.$Zb.join(", "),n.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",P),this.rCl(P))}rCl(u){const P=new Sa.StandardDialog;P.Ad=0;P.zP(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,u),null)}dispose(){}}Object(r.a)(Nf,"InsertMediaFromHostManager",null,[1127,108]);class Bg{constructor(u){this.d2h=u}getInstance(){return this.d2h}}Object(r.a)(Bg,"InsertMediaFromHostManagerFactory",
null,[1299,1300]);class Xk{constructor(){this.EUb=document.createElement("iframe");this.EUb.src="about:blank";this.EUb.style.visibility="hidden";this.EUb.style.position="absolute";this.EUb.style.zIndex="-100"}get l$a(){return this.EUb}}Object(r.a)(Xk,"InsertMediaFromHostOneDriveHostFrame",null,[1122]);class Ni extends bj.a{constructor(u,P){super(u,"*"===P?P:Cd.a.KQ(P));this.Gyf(Qe.a.insertImage);this.Gyf(Qe.a.Xje)}reportDocumentLoadedTime(){}}Object(r.a)(Ni,"InsertMediaFromOneDriveCrossDocumentMessenger",
bj.a,[1110,537,108]);var nh=d(272),ni=d(549);class ye{KKc(u){switch(u){case 1:u=8;break;case 4:u=3;break;case 2:u=0;break;default:u=0}return u}Yui(u,P){return String.format(P,this.KKc(u))}pHf(u,P,la,Ca,Ta,pb,Sb){u=this.KKc(u);const Cc=nh.a.He(t.AFrameworkApplication.lcid).name,ed=t.AFrameworkApplication.buildVersion;t.AFrameworkApplication.Oea("ShIns226;ShIns226cf");return String.format(P,t.AFrameworkApplication.lcid,Cc,ed,Ta,u,pb,la,Ca,Sb)}avi(u,P){u=this.KKc(u);const la=t.AFrameworkApplication.buildVersion,
Ca=0<la.indexOf(".")?la.substring(0,la.indexOf(".")):"16";return String.format(P,t.AFrameworkApplication.lcid,t.AFrameworkApplication.lcid,t.AFrameworkApplication.lcid,u,Ca,la,"Video",0,0)}$ui(u,P,la,Ca,Ta,pb,Sb){u=String.format(P,t.AFrameworkApplication.lcid,t.AFrameworkApplication.uiCulture,t.AFrameworkApplication.buildVersion,la,this.KKc(u),Ca);Ta&&(u+="&flipgrid=1");pb&&(Ta=new Aa.QueryStringBuilder(u),Ta.xg("stream2","1"),Ta.xg("enablegetcustomheader","1"),u=Ta.toString());"defaultModal"!=Sb&&
(Ta=new Aa.QueryStringBuilder(u),Ta.xg("modalvariation",Sb),u=Ta.toString());return u}Ugh(u){if(!u||!u.Values)return null;u=u.Values;if(!u)return null;let P="";"sourceProvider"in u&&(P=u.sourceProvider||"");return Object.assign(new ni.a,{Action:u.action||"",Caption:u.caption||"",ContentType:u.contentType||"",Type:u.extension||"",PageUrl:u.pageUrl||"",OriginalUrl:u.sourceUrl||"",ContentProvider:P,ThumbnailUrl:u.thumbnailUrl||"",LicenseUrl:u.licenseUrl||"",LicenseDisplayName:u.licenseDisplayName||"",
Height:u.height||0,Width:u.width||0,SvgContent:u.svgContent||"",Description:u.description||"",ProviderName:u.providerName||"",StartInsertTime:u.startInsertTime||0})}fRk(u){const P=[];if(!u||!u.Values||!u.Values.Items)return P;u=u.Values.Items;for(let Ca=0;Ca<u.length;Ca++){var la=u[Ca];la&&(la=Object.assign(new ni.a,{Type:la.Extension||"",OriginalUrl:la.SourceUrl||"",Caption:la.caption,Description:la.description||"",Height:la.Height||0,Width:la.Width||0}),Array.add(P,la))}return P}h2c(u,P){if(!u)return!1;
for(let la=0;la<P.length;la++)if(0<=u.toLowerCase().indexOf(P[la]))return!0;return!1}bXk(u){let P="";if(u)for(let la=0;la<u.length;la++){const Ca=u[la];Ca&&(P+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',Ca.OriginalUrl,Ca.Width,Ca.Height))}return P}AAj(u){return(u=ye.wil.exec(u))&&2<u.length?u[2].trim():""}sei(u,P){u.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?P.xg("dallecore","1"):u.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",
!1)&&P.xg("dalle","1")}}ye.wil=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(r.a)(ye,"InsertMediaHelper",null,[1121]);var Dg=d(35);class Fj{constructor(u){this.FVb=Dg.a.insertHyperlink;this.Ca=u}get Ax(){return this.FVb}set Ax(u){this.FVb=u}Dua(u){try{n.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",u.length);for(let P=0;P<u.length;P++)this.Ca.Ja(this.Ax,2,u[P]);n.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",
u.length)}catch(P){n.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",P.toString())}}}Object(r.a)(Fj,"InsertOneDriveFileHandler",null,[1120]);class Gj extends Fj{constructor(u){super(u)}get zSf(){return Qe.a.Xje}get Yzb(){return Qe.a.GTj}Sgh(u){return u&&u.Values&&"Items"in u.Values?u.Values.Items:null}icg(){Q.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}h2c(){return!0}Ykh(u,
P,la){u=la(u);u.length&&(la={},la.Items=u,P.sendMessage(this.Yzb,la))}Tgh(u){const P=[];for(let la=0;la<u.data.value.length;la++){const Ca=u.data.value[la];if(Ca){const Ta={};Ta.DisplayText=Ca.name;Ta.Url=Ca.urls.download;Ta.sourceUrl=Ca.urls.download;Ta.caption=Ca.name;Array.add(P,Ta)}}return P}}Object(r.a)(Gj,"InsertOneDriveFileHelper",Fj,[1119,1120]);class xj extends Ue.a{constructor(){super()}b4e(){this.DAc="FilePickerDialog";this.hg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";
this.ig="PickerDialog-Livebooks";this.showDialog("",null)}tde(){return document.getElementById("OpenFilePickerDiv")}ZA(){}Maa(){}}Object(r.a)(xj,"PickerDialog",Ue.a,[1144]);class Rj{constructor(u,P,la){this.Zn=this.xia=null;this.y4a=u;this.p7h=la;this.cia=new Pa.a(()=>new Kf.a(P.value,Object(z.a)(this,this.UEa,"getMoreInfoEventReceived")))}get EJb(){this.xia||(this.cia.value.Yda("InsertFromOneDrive",!0),this.Zn&&this.Zn.ZR&&this.Zn.ZR.length&&(this.xia=this.bde(this.Zn.ZR)));return this.xia}bde(u){u=
u.toLowerCase();u.endsWith("/")||(u+="/");const P=u.indexOf("/documents/");return-1!==P?u.substring(0,P+1)+"_layouts/15/onedrive.aspx":""}UEa(u){this.Zn||3!==u.state||(this.Zn=u)}start(u){if(!this.EJb)if(t.AFrameworkApplication.breadcrumbFolderUrl&&t.AFrameworkApplication.breadcrumbFolderUrl.length)this.xia=t.AFrameworkApplication.breadcrumbFolderUrl;else{n.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Zn);return}const P=new xj;P.b4e();const la=P.tde();la?this.y4a.start((Ca,Ta)=>{P.hide();this.processResponse(Ca,Ta,u)},()=>{this.QMe(P)},la,this.xia):n.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}QMe(u){u.hide();n.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}processResponse(u,P,la){n.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",
u);u&&P&&P.data&&P.data.value&&0<P.data.value.length?(u=this.p7h.getInstance(window.frames[0].parent,window.document.URL),la.Ykh(P,u,Object(z.a)(la,la.Tgh,"parseOneDriveV7Response"))):n.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(r.a)(Rj,"OneDriveFilePickerHelperV7",null,[1115,1116]);class Bl{constructor(u,P,la,Ca){this.ia=P;this.la=u;this.q5=this.la.Gua;this.kM=la;this.Mzg=Ca}get lQ(){return this.Mzg?this.Mzg.instance:null}vb(){this.ia.ra(F.a.v5c,
db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"),4);this.ia.ra(F.a.u7a,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"),4);this.ia.ra(F.a.TVe,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"),4);this.ia.ra(F.a.dLb,db.a.application,Object(z.a)(this,this.dLb,"queryAddInCommandsLoadStatus"),96);this.ia.ya(F.a.x3e,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"));this.ia.ra(F.a.dV,db.a.application,
Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"),64);this.ia.ra(F.a.RMb,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"),64);this.ia.ya(F.a.Nuc,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"));this.ia.ra(F.a.B$b,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"),64);this.ia.ya(F.a.bPb,db.a.application,Object(z.a)(this,this.bAa,"triggerCommandforAddinCommands"));this.ia.ya(F.a.e6b,db.a.application,Object(z.a)(this,
this.bAa,"triggerCommandforAddinCommands"))}me(){}bAa(u,P,la,Ca,Ta){if(!this.q5)return 16;if(1===la)return P=u===F.a.u7a&&(!this.lQ||!this.lQ.ACj(Ta)),u=u===F.a.u7a&&!!this.lQ&&this.lQ.Dwl(Ta),P||u?8:32;if(this.lQ)switch(u){case F.a.v5c:this.lQ.w5c(Ta);break;case F.a.u7a:this.lQ.M9b(Ta);break;case F.a.dLb:this.lQ.Elh(Ta);break;case F.a.x3e:this.lQ.Czl();break;case F.a.dV:this.lQ.WZk(Ta);break;case F.a.RMb:this.lQ.RMb(Ta);break;case F.a.TVe:this.lQ.q6k();break;case F.a.Nuc:this.lQ.Nuc(Ta);break;case F.a.B$b:this.lQ.B$b(Ta);
break;case F.a.bPb:this.lQ.bPb(Ta);break;case F.a.e6b:this.lQ.e6b(Ta)}else this.kM.Fja(),this.kM.FQa(u,Ta);return 32}dLb(u,P,la,Ca,Ta){if(!this.q5)return 16;this.lQ&&this.lQ.Elh(Ta);return 32}}Object(r.a)(Bl,"AddinCommandsActor",null,[268]);var Cl=d(1035),Th=d(203),hi=d(87),Yk=d(172),cj=d(43),Am=d(1057),Pl=d(328);class Dl{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg,$i,jk,fj,Mk,Tk,Uk,uh){this.Rfc=null;this.pAg=!1;this.SXa=null;this.BFg=Gd.a("PartialDoc.SkipCutCopyCallout");if(!uh)throw Error.argumentNull("calloutNotificationAdapter");
this.ia=u;this.qf=P;this.Ib=Rg;this.Fa=la;this.pa=Ca;this.nq=Ta;this.KE=pb;this.C_g=Sb;this.smk=Cc;this.ysk=ed;this.L7c=ad;this.Rb=Zd;this.d$c=Yf.dkg;this.Yu=We;this.ic=$i;this.Thk=Yf.powerPointEditorDownloadACopyUiIsEnabled;this.jrk=Qf;this.t8c=Af;this.Ya=He;this.dZa=!Yf.yg;this.PYg=jk;this.w0g=Mk;this.lNg=Tk;this.Lw=Uk;this.LDg=!Yf.printingEnabled||Rg.ka("DisablePrint");this.MDg=Ph;this.wl=pf;this.vkk=Rg.Ha("DownloadPdfFromPodsUrl");this.m_printUrl=Rg.Ha("PrintPdfFromPodsUrl");this.ukk=Rg.Ha("DownloadOdpFromPodsUrl");
this.dEg=Rg.Ha("DownloadImagesFromPodsUrl");this.Zsk=Rg.ka("UseToastForDeferredBlobsEnabled");this.duk=Yf.pptAppendFileNameToQueryUrlForDocumentOperationsActor;u=(t.AFrameworkApplication.fileName||"").toLowerCase();Yf.yg&&Yf.wZj?(this.pAg=!0,this.Rfc=Rg.Ha("DownloadACopyPodsUrl")):!Yf.yg&&Yf.H5j&&(u.endsWith(".pptx")||u.endsWith(".ppsx"))?this.Rfc=this.Dxk():this.Rfc=t.AFrameworkApplication.JSa;this.jBe=fj;this.Rnk=Yf.$2c;this.kaa=w.a.instance.Ia("Common.ISystemInitiatedFeedback");this.tnk=Rg.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1);this.CH=uh}vb(){const u=!!this.MDg&&!this.PYg();N.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.LDg,u);this.LDg?u&&this.wl.TAl(this.MDg):(this.ia.ya(wb.a.print,db.a.application,Object(z.a)(this,this.vHj,"handlePrint")),this.ia.ya(wb.a.downloadACopy,db.a.application,Object(z.a)(this,this.downloadACopy,"downloadACopy")),this.ia.ya(wb.a.h5b,db.a.application,Object(z.a)(this,this.h5b,"downloadACopyAsPdf")),this.ia.ya(wb.a.g5b,db.a.application,Object(z.a)(this,this.g5b,
"downloadACopyAsOdp")),this.ia.ya(wb.a.i5b,db.a.application,Object(z.a)(this,this.i5b,"downloadAsImages")),this.ia.ya(wb.a.YZe,db.a.application,Object(z.a)(this,this.YZe,"saveSlidesAsImages")),this.ia.ya(wb.a.wpc,db.a.application,Object(z.a)(this,this.uWk,"pptoSaveACopy")),this.ia.ya(wb.a.wRe,db.a.application,Object(z.a)(this,this.vWk,"pptoSaveAsToHost")),this.ia.ya(wb.a.xRe,db.a.application,Object(z.a)(this,this.wWk,"pptoSaveToSharePoint")),this.ia.ya(wb.a.mSe,db.a.application,Object(z.a)(this,this.xHj,
"handlePrintNotes")),this.ia.ya(wb.a.kSe,db.a.application,Object(z.a)(this,this.wHj,"handlePrintHandouts")));this.ia.ya(F.a.b1a,db.a.application,Object(z.a)(this,this.b1a,"saveFileChange"));this.C_g&&this.ia.ra(wb.a.nod,db.a.application,Object(z.a)(this,this.nod,"querySaveStatus"),96);this.jBe.execute(Object(z.a)(this,this.mnc,"onHostPostmessengerCreated"))}me(){const u=this.Fa.Ic(ub.a.vwi);u.bindAction(mb.KeyInputManager.Va(pa.a.eob,mb.KeyInputManager.Te),wb.a.print);u.bindAction(mb.KeyInputManager.Va(pa.a.BNa,
mb.KeyInputManager.Te),F.a.we);u.bindAction(mb.KeyInputManager.Va(pa.a.nBd,mb.KeyInputManager.Te),F.a.we);u.bindAction(mb.KeyInputManager.Va(pa.a.EZ,mb.KeyInputManager.Te),F.a.we);u.bindAction(mb.KeyInputManager.Va(pa.a.EZ,mb.KeyInputManager.Te|4),F.a.we)}vWk(u,P,la){return this.RZe(la,F.a.fNb,"SaveAsToHost")}uWk(u,P,la){return this.RZe(la,F.a.Qsc,"SaveACopy")}wWk(u,P,la){return this.RZe(la,F.a.Ukb,"SaveToSharePoint")}RZe(u,P,la){if(1===u)return t.AFrameworkApplication.Vx||t.AFrameworkApplication.$Q?
8:this.ia.processAction(P,1);if(this.Lw.hasDeferredContent()&&(N.a.J(512500628,843,15,"{0} is triggered while document has deferred content",la),!this.Zsk))return this.Lw.z3e(la,null,null),8;this.Lsb(la);return this.Ya.yea?(N.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",P),this.ia.Ja(wb.a.hNb,2,P)):this.ia.processAction(P,2)}downloadACopy(u,P,la,Ca,Ta){if(this.qf.fd(this.nq))return 16;if(1===la)return!this.ic.rj()||t.AFrameworkApplication.$Q?8:Dl.C0f()?
32:this.avb();if(this.Lw.hasDeferredContent())return N.a.J(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),this.BFg&&this.CH.W4d(),this.Lw.z3e("DownloadACopy",new Am.a,()=>{this.c9e(Ta)}),this.Lw.Zra("DownloadACopyRequestedTime",cj.a.vf(new Date)),8;this.pa.nh();this.Fa.Bd();N.a.J(512500625,801,50,"PPT save and download a copy");this.Ya.yea?this.c9e(Ta):(this.Yu.show(!0,u),this.KE.h4(!1,this.dZa,()=>{this.c9e(Ta)},Object(z.a)(this,this.Qya,"saveFailureCallback")));
this.Lsb("DownloadACopy");return 32}c9e(u){this.Yu.hide();let P;P=Dl.C0f()?t.AFrameworkApplication.JSa:this.pAg?this.stb(this.Rfc):this.Rfc;u&&u.FileDownloadUrl&&(P=u.FileDownloadUrl.toString());this.Qek();this.lNg&&!this.lNg()&&this.w0g&&this.w0g("3555692408")?this.SXa.sendMessage(Qe.a.download,{}):this.Thk?(this.jrk.yBl(P),this.Lw.Zra("DownloadModalTime",cj.a.vf(new Date))):this.Rb.PM(!0,P,!0)}Qek(){this.tnk&&this.kaa&&this.kaa.execute(u=>{u.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity",
"CollabCornerFloodgateSurveysIsEnabled")})}nod(u,P,la,Ca,Ta){u="";this.C_g&&(u=this.smk.pX(this.nq)?String.format(ResourceStrings.L_SavingStatus):this.d$c?String.format(CommonUIStrings.l_SavedToStatus,this.d$c):String.format(ResourceStrings.L_SavedStatus));Ta[Td.a.Value]=u;return 32}vHj(u,P,la){return this.lSe(la,0,u)}xHj(u,P,la){return this.lSe(la,8,u)}wHj(u,P,la){return this.lSe(la,4,u)}lSe(u,P,la){if(this.qf.fd(this.nq))return 16;if(1===u)return!this.ic.rj()||t.AFrameworkApplication.$Q?8:this.avb();
if(this.PYg())return N.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),16;N.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",P);this.pa.nh();this.Fa.Bd();this.Ya.yea?this.swh(P):(this.Yu.show(!0,la),this.KE.h4(!1,this.dZa,()=>{this.swh(P)},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.Lsb("Print-"+la);return 32}swh(u){this.Yu.hide();this.ysk.print(this.Ya.presentationId.string,this.stb(this.m_printUrl),u)}h5b(u,P,la){if(this.qf.fd(this.nq))return 16;if(1===
la)return!this.ic.rj()||t.AFrameworkApplication.$Q?8:this.avb();this.t8c.cXf=new Date;this.pa.nh();this.Fa.Bd();this.Ya.yea?this.pwh():(this.Yu.show(!0,u),this.KE.h4(!1,this.dZa,()=>{this.pwh()},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.Lsb("DownloadACopyAsPDF");this.agi();return 32}pwh(){this.Yu.hide();this.t8c.xwh=new Date;this.L7c.convert(this.Ya.presentationId.string,1,this.stb(this.vkk))}i5b(u,P,la){if(this.qf.fd(this.nq))return 16;if(1===la)return!this.ic.rj()||t.AFrameworkApplication.$Q?
8:this.avb();this.pa.nh();this.Fa.Bd();this.Ya.yea?this.qwh():(this.Yu.show(!0,u),this.KE.h4(!1,this.dZa,()=>{this.qwh()},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.Lsb("DownloadAsImages");return 32}YZe(u,P,la){if(this.qf.fd(this.nq))return 16;if(1===la)return!this.ic.rj()||t.AFrameworkApplication.$Q?8:this.avb();this.pa.nh();this.Fa.Bd();this.Ya.yea?this.bXf():(this.Yu.show(!0,u),this.KE.h4(!1,this.dZa,()=>{this.bXf()},Object(z.a)(this,this.Qya,"saveFailureCallback")));this.Lsb("SaveSlidesAsImages");
return 32}qwh(){this.Yu.hide();this.L7c.convert(this.Ya.presentationId.string,2,this.stb(this.dEg))}bXf(){this.Yu.hide();var u=this.stb(this.dEg),P=this.pa.Re();0<P.length&&(P=Yk.c(P,la=>la.sid.toString()).join(","),u=new Aa.QueryStringBuilder(u),u.xg(hi.a.dDl,P),this.L7c.convert(this.Ya.presentationId.string,2,u.toString()))}g5b(u,P,la){if(this.qf.fd(this.nq))return 16;if(1===la)return!this.ic.rj()||t.AFrameworkApplication.$Q?8:this.avb();if(this.Lw.hasDeferredContent())return this.BFg&&this.CH.W4d(),
N.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.Lw.z3e("DownloadACopyAsOdp",new Am.a,()=>{this.SZe()}),8;this.pa.nh();this.Fa.Bd();this.Ya.yea?this.SZe():(this.Yu.show(!0,u),this.KE.h4(!1,this.dZa,()=>{this.SZe()},Object(z.a)(this,this.Qya,"saveFailureCallback")));return 32}Qya(){this.Yu.hide();return!1}SZe(){this.Yu.hide();this.L7c.convert(this.Ya.presentationId.string,0,this.stb(this.ukk))}b1a(u,P,la,Ca,Ta){if(this.qf.fd(this.nq))return 16;if(1===
la)return 32;this.pa.nh();this.Fa.Bd();this.KE.h4(!1,!0,pb=>{if(Ta&&1<=Ta.length)Ta[0](pb)},pb=>Ta&&2<=Ta.length?(Ta[1](pb,pb.ServerError.Code),!0):!1);return 32}Dxk(){const u=new Aa.QueryStringBuilder(Cd.a.Jka("DownloadACopyHandler.ashx"));u.xg(hi.a.Qld,this.Ya.presentationId.string);u.xg(hi.a.Aoa,this.Ya.sessionInfo);u.xg("fn",t.AFrameworkApplication.fileName);t.AFrameworkApplication.GQa(u);return u.toString()}stb(u){if(u){const P=new Aa.QueryStringBuilder(u);this.Ya&&this.Ya.podSessionId&&0>u.indexOf(this.Ya.podSessionId)&&
(P.kJc(hi.a.Faa+"="+this.Ya.podSessionId),N.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Ya.podSessionId));this.duk&&t.AFrameworkApplication.ju.rx&&0<t.AFrameworkApplication.ju.rx.length&&(P.xg(hi.a.Fgh,t.AFrameworkApplication.ju.rx),N.a.J(512500619,801,50,"Appended FileName in url"));this.Rnk&&(P.xg(hi.a.hQk,"true"),N.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));t.AFrameworkApplication.GQa(P);return P.toString()}return null}Lsb(u){const P=Th.a.S_(Pl.a.JKb,!0);N.a.J(509448414,
801,15,"DocOperation={0};SimplifiedRibbonON={1}",u,P)}agi(){if(this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePdfProtectionUsageTelemetry",!1)){var u=new L.a;u.name="IsPdfProtectionEnabled";u.bool=this.Ib.ka("KeepPDFProtection");var P=new L.a;P.name="IsLabeled";var la=this.Ib.Ha("AppliedPolicyId");P.bool=la&&0<la.length;oc.a("PdfProtectionUsage",!0,void 0,[u,P])}}mnc(u){this.SXa=u}avb(){return t.AFrameworkApplication.Vx?8:32}static C0f(){const u=t.AFrameworkApplication.Vx,P=!Gb.a.Xa(t.AFrameworkApplication.JSa),
la=t.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),Ca=t.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");N.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",u,P,la,Ca);return u&&P&&la&&Ca}}Object(r.a)(Dl,"DocumentOperationsActor",null,[268]);class ii{}ii.hg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Object(r.a)(ii,"EmbedDialogHtml",null,[]);class oh{constructor(u,P,la,Ca){this.pPe=u;this.y4=P;this.Dfh=la;this.value=Ca}}Object(r.a)(oh,"OptionInfo",null,[]);class ok{constructor(u,P,la){this.k_e=u;this.gAb=P;this.y4=la}}Object(r.a)(ok,"SectionInfo",null,[]);var ya=d(318);class qd extends Ue.a{constructor(u,P=!1){super(!1,!1,P);this.ohf=476;this.eBc=288;this.WZh=798;this.A7h=476;this.y7h=288;this.Rld={};this.h1a=[];this.RP=this.BBa=this.zMd=this.RAc=this.dFc=this.brb=null;this.oUb=t.AFrameworkApplication.Zzb;
this.GFc=u;this.xMd=Object(z.a)(this,this.wOk,"optionClickHandler");this.yMd=Object(z.a)(this,this.xOk,"optionKeyHandler");this.tCd=Object(z.a)(this,this.wqi,"arrowClickHandler");this.yob=Object(z.a)(this,this.xqi,"arrowKeyHandler");this.OHc=Object(z.a)(this,this.SJl,"textAreaOnFocusHandler");this.v3h=P;this.hg=ii.hg;this.Ad=0;this.ig="EmbedDialog"}get Rpb(){return this.eBc}set Rpb(u){this.eBc=u}mFh(u){const P={["id"]:this.ig,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,
["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Cd.a.Pi(this.GFc,"wdPreview","1"),["initialEmbedUrl"]:this.oUb,["getEmbedCode"]:qd.G8f,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const la of Object.keys(u))P[la]=u[la];this.Ad=1;this.Le(1,CommonUIStrings.l_CopyAction);this.Le(0,CommonUIStrings.l_Close);this.sj(CommonUIStrings.l_Embed,null,P)}amb(){if(this.v3h)this.mFh({});
else{this.showDialog(CommonUIStrings.l_Embed,null);this.brb=document.getElementById("embedpreviewpane");this.dFc=document.getElementById("embedoptionpane");this.brb.style.width=String.format("{0}px",this.A7h);this.BBa=document.createElement("iframe");this.BBa.className=qd.x7h;this.BBa.frameBorder="0";this.BBa.style.height=String.format("{0}px",this.y7h);this.BBa.tabIndex=-1;this.brb.appendChild(this.wPc(CommonUIStrings.l_Preview,this.BBa,qd.csf,qd.z7h,qd.csf,!0));this.RP=document.createElement("textarea");
this.RP.className=qd.B_h;Sys.UI.DomElement.addCssClass(this.RP,ya.a.HCa);this.RP.id=qd.C_h;yd.a.Yi||(this.RP.readOnly=!0);this.RP.rows=4;this.RP.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.RP.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.RP.setAttribute(Ja.a.t_,String.format("{0} {1}",qd.nhf,qd.mhf));this.brb.appendChild(this.wPc(CommonUIStrings.l_EmbedCode,this.RP,qd.nhf));Le.a.addHandler(this.RP,"focus",this.OHc);var u=document.createElement("span");u.className=qd.C0h;
u.innerText=CommonUIStrings.l_CopyText;u.id=qd.mhf;this.brb.appendChild(u);this.RAc=document.createElement("div");this.RAc.className=qd.ZZh;this.dFc.appendChild(this.wPc(CommonUIStrings.l_Dimensions,this.RAc));this.zMd=document.createElement("div");this.dFc.appendChild(this.jNi(qd.z6h,this.zMd));this.Ad=0;this.Le(1,CommonUIStrings.l_Close);this.XPh();this.YQh();yd.a.Yi||this.RP.focus()}}dispose(){if(this.Rld){var u=this.Rld;for(let P in u){const la=u[P];this.Ln.Bb(Fa.a.click,la.pPe,this.xMd);this.Wg.Bb(Fa.a.Df,
la.pPe,this.yMd);this.Wg.Bb(Fa.a.Tl,la.pPe,this.yMd)}this.yMd=this.xMd=this.Rld=null}if(this.h1a){for(u=0;u<this.h1a.length;++u)this.Ln.Bb(Fa.a.click,this.h1a[u].gAb,this.tCd),this.Wg.Bb(Fa.a.Df,this.h1a[u].gAb,this.yob),this.Wg.Bb(Fa.a.Ay,this.h1a[u].gAb,this.yob),this.Wg.Bb(Fa.a.Tl,this.h1a[u].gAb,this.yob);this.Wg=this.tCd=this.h1a=null}this.OHc&&this.RP&&(Le.a.removeHandler(this.RP,"focus",this.OHc),this.OHc=null);this.RP=this.BBa=this.zMd=this.RAc=this.dFc=this.brb=null;super.dispose()}Maa(){super.Maa();
this.Jb.style.width=String.format("{0}px",this.WZh);this.XCa()}YPh(u,P){const la=Cd.a.Pi(this.oUb,u,P);return this.oUb!==la?(this.oUb=la,this.GFc=Cd.a.Pi(this.GFc,u,P),!0):!1}XPh(){this.RP&&(this.RP.innerText=qd.G8f(this.oUb,this.ohf,this.eBc))}YQh(){this.BBa&&this.BBa.contentWindow.location.replace(Cd.a.Pi(this.GFc,"wdPreview","1"))}TSl(u,P){this.YPh(u,P)&&(this.XPh(),this.YQh())}wPc(u,P,la=null,Ca=null,Ta=null,pb=!1){const Sb=document.createElement("div");Sb.className=qd.q9h;Ca&&(Sb.id=Ca);Ta&&
Sb.setAttribute(Ja.a.t_,Ta);pb&&(Sb.tabIndex=0);Ca=document.createElement("span");Ca.className=qd.r9h;Ca.innerText=u;la&&(Ca.id=la);Sb.appendChild(Ca);Sb.appendChild(P);return Sb}jNi(u,P){const la=this.wPc(CommonUIStrings.l_Interaction,P),Ca=this.pi.createElement("div");Ca.className=qd.ZWh;Ca.id=qd.aXh+u;Ca.setAttribute(Ja.a.hf,Ja.a.Ou);Ca.tabIndex=0;la.insertBefore(Ca,P);u=ia.createClusteredImage(16,16,qd.$Wh,qd.bXh,!0,"");Ca.appendChild(u);u=u.childNodes[0];u.className=ia.getImageClass(qd.Qgf);
u.title=CommonUIStrings.l_Expand;Ca.title=CommonUIStrings.l_Expand;P.style.visibility="hidden";P=new ok(P,Ca,u);Array.add(this.h1a,P);this.Ln.gV(Fa.a.click,Ca,this.tCd,P);this.Wg.gV(Fa.a.Df,Ca,this.yob,P);this.Wg.gV(Fa.a.Ay,Ca,this.yob,P);this.Wg.gV(Fa.a.Tl,Ca,this.yob,P);return la}wqi(u){this.SKf(u);return!0}xqi(u){return this.Y4c(u,Object(z.a)(this,this.SKf,"changeArrowState"))}SKf(u){u=u.MD;"visible"===u.k_e.style.visibility?(u.k_e.style.visibility="hidden",u.y4.className=ia.getImageClass(qd.Qgf),
u.y4.title=CommonUIStrings.l_Expand,u.gAb.title=CommonUIStrings.l_Expand):(u.k_e.style.visibility="visible",u.y4.className=ia.getImageClass(qd.Qbi),u.y4.title=CommonUIStrings.l_Collapse,u.gAb.title=CommonUIStrings.l_Collapse)}wOk(u){this.Cfh(u);return!0}xOk(u){return this.Y4c(u,Object(z.a)(this,this.Cfh,"optionHandler"))}Cfh(u){const P=this.Rld[u.MD.toString()];P.value?(P.value=0,P.y4.className=ia.getImageClass(qd.Cbi),P.Dfh.setAttribute(Ja.a.XEf,Ja.a.qja)):(P.value=1,P.y4.className=ia.getImageClass(qd.hYh),
P.Dfh.setAttribute(Ja.a.XEf,Ja.a.rB));this.TSl(u.MD.toString(),P.value.toString())}SJl(){this.RP.select()}static G8f(u,P,la){if(!qd.KLd){const Ca=String.format('<a target="_blank" href="{0}">{1}</a>',Gb.a.I$b("https://office.com"),CommonUIStrings.l_Office),Ta=String.format('<a target="_blank" href="{0}">{1}</a>',Gb.a.I$b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);qd.KLd=String.format(CommonUIStrings.l_NoFrames,Ca,Ta)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
Gb.a.I$b(u),P,la,qd.KLd)}}qd.KLd=null;qd.hYh="CheckboxChecked_16x16x32";qd.Cbi="CheckboxUnchecked_16x16x32";qd.Qbi="OutlookSearchChevronUp_16x16x32";qd.Qgf="OutlookSearchChevronDown_16x16x32";qd.$Wh="UpArrowServer";qd.q9h="EmbedSectionHeader";qd.r9h="EmbedSectionName UIFontBold";qd.C0h="EmbedCodeFooter";qd.x7h="EmbedPreviewFrame";qd.B_h="EmbedCodeTextArea";qd.ZZh="EmbedDimensionSection";qd.bXh="EmbedArrowIcon";qd.ZWh="WACGlyph EmbedArrowHolder";qd.C_h="EmbedCode";qd.nhf="EmbedCodeHeader";qd.csf="Preview";
qd.z7h="PreviewHeader";qd.z6h="Options";qd.aXh="Arrow";qd.mhf="EmbedCodeFooter";Object(r.a)(qd,"EmbedDialog",Ue.a,[]);class ea extends qd{constructor(u,P){super(u,!0);P&&P&&!isNaN(P)||N.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.YPh(hi.a.ZPk,P.toString())}amb(){const u=[];u.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:ea.r4k});this.mFh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.ohf,["defaultHeight"]:this.eBc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:u})}static r4k(u,P,la){return"wdEaaCheck"===P?Cd.a.Pi(u,P,la?"1":"0"):u}}Object(r.a)(ea,"ReactEmbedDialog",qd,[]);class Ok{constructor(u,P,la,Ca,Ta){this.TGa=null;this.Dye=!1;this.SXa=null;this.Rb=u;this.RAe=P;this.Zfc=la;this.jBe=Ca;this.Ya=Ta}amb(u,P,la){(u=(u=t.AFrameworkApplication.XE)||
this.Ya.yea)||this.Dye||(u=!this.LMh());return 1===la?u?2:32:this.lAl()}lAl(){if(!this.Dye)return 8;if(t.AFrameworkApplication.Zzb&&this.Zfc)this.wEh();else{const u=t.AFrameworkApplication.Naf?this.SXa.sendMessage(Qe.a.X6i,null)?32:8:2;return 32!==u?this.Rb.PM(!0,t.AFrameworkApplication.r8d):u}return 32}kAl(u){u.Values.HostEmbeddedViewUrl&&(this.Zfc=t.AFrameworkApplication.Zzb=u.Values.HostEmbeddedViewUrl.toString(),this.wEh())}LMh(){return!1}Eei(u,P){this.TGa=P;this.Dye=!!this.Rb&&!!this.RAe&&!(void 0===
this.Zfc||null===this.Zfc)&&!!u&&!!P}wEh(){(new ea(this.Zfc,this.TGa)).amb()}}Object(r.a)(Ok,"EmbedManager",null,[]);class kj{constructor(u,P,la){this.TGa=null;this.Elk={};for(P=0;P<u.length;P++)this.Elk[u[P].Format.toString()]=P;this.TGa=la&&!isNaN(la)&&isFinite(la)?la:0}}Object(r.a)(kj,"FormatPicker",null,[]);class Ek extends Ok{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){super(u,P,la,pb,Sb,Cc);this.ia=Ca;this.Sb=Ta}vb(){this.ia.ya(wb.a.amb,db.a.application,Object(z.a)(this,this.amb,"showEmbedDialog"));
this.jBe.execute(Object(z.a)(this,this.mnc,"onHostPostmessengerCreated"))}me(){}LMh(){var u=this.Sb.Tu();if(!this.RAe||!u.height)return!1;u=u.width/u.height;const P=new kj(this.RAe,!1,u);this.Eei(P,u);return!0}mnc(u){this.SXa=u;t.AFrameworkApplication.isEmbedded||t.AFrameworkApplication.Zzb||!this.SXa||(this.SXa.Nu(Qe.a.PJf),this.SXa.fC(Qe.a.PJf,Object(z.a)(this,this.kAl,"showEmbedDialogPostMessage")))}}Object(r.a)(Ek,"EmbedActor",Ok,[268]);var Uf=d(40),pl=d(749),Zk=d(700);class Sf{constructor(u,
P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We){this.ia=u;this.hgb=P?P.xa:null;this.ua=la;this.fc=Ca;this.jb=Ta;this.Rq=pb;this.Fb=Sb;this.wk=Cc;this.Vd=ed;this.sDb=null;this.Fa=ad;this.nq=la.presentation;this.Ie=Zd;this.Ve=null;this.Qfb=We}vb(){this.ia.ra(wb.a.XEh,Uf.a.application,Object(z.a)(this,this.cKj,"handleUploadAudioDialog"),4)}me(){}cKj(u,P,la){const Ca=this.ua.Ba;if(!Ca||this.fc.fd(Ca))return 16;if(1===la)return 32;if(this.hgb){this.Ve=cj.a.Jj("Audio::Insert");try{return Zk.a.t4e("audio/*",pl.e,()=>pl.d(u,
Object(z.a)(this,this.yTj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Ie,Ca),"audio",Ca,this.ua.presentation,this.fc,this.Vd,this.Ve,!1,this.Qfb,50,10,3),this.Ve&&this.Ve.Wa("AudioDialogInitialized","true"),32}catch(Ta){N.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return N.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(u,P){this.Ve&&(this.Ve.finish(),this.Ve=null);this.Vd.rH(u,
la=>{la.JC=1;la.jTa=P;return!1})}yTj(u,P,la,Ca,Ta,pb,Sb){Ca.qO(la)&&N.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+la.Pja);Ca.zK(la);Ta&&Ta.Wa("AudioUploadToRC","true");Object(Gd.a)("FixForInsertMediaSlideNavigationIssue")||(Sb=this.ua.Ba);la=Sb.Cs();var Cc=this.nq.slideWidth,ed=this.nq.slideHeight;Ca=Tc.a.gf(32,0);const ad=Tc.a.gf(32,1);Cc=Cc/2-Tc.a.gf(16,0);ed=ed/2-Tc.a.gf(16,1);if(Sb&&Sb.isConnected){var Zd=
this.Fb.yd(15,void 0,void 0,()=>{this.Rq.oA=this.sDb;this.jb.selectShape(this.sDb,!0);this.Fa.Bd()});try{Zd.jc(Sb);Zd.gd=u;Ta&&Ta.Wa("CreatingAudioShape","true");this.sDb=this.wk.BDa(!1,Sb.Cb.cid,Sb.Cb.sid,0,10,Cc,ed,Ca,ad,la+1);const We=pb.files[0].name;this.sDb.P0b=P;this.sDb.N0b=We;Sb.oB(this.sDb)}finally{Zd&&Zd.dispose()}Ta&&(Ta.Wa("AudioShapeSuccessfullyCreated","true"),Ta.finish(),Ta=null)}}}Object(r.a)(Sf,"InsertAudioActor",null,[268]);var bi=d(103);class qc{constructor(){this.lAb=this.mtb=
null}}Object(r.a)(qc,"CreatePickerCustomizationDictionaryOptions",null,[1591]);var ql=d(162),Kc=d(29);class Of{}Of.hg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(r.a)(Of,"InsertMediaDialogHtml",null,[]);class nj{}nj.hg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(r.a)(nj,"InsertMediaM365DialogHtml",null,[]);var Hj=d(401);class Xf{static get hg(){return Ue.a.pz(Xf.Fo,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,"http://go.microsoft.com/fwlink/?linkid=2010177")}}Xf.Fo="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(r.a)(Xf,"InsertOnlineVideoDialogHtml",null,[]);class $l extends Ue.a{constructor(u){super();this.cF(1,!0);this.Le(1,ResourceStrings.L_Insert);this.hg=Xf.hg;this.B$=u;this.ZV=!1}Rga(){this.width=50;this.sj(ResourceStrings.L_OnlineVideo,Object(z.a)(this,this.RTj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(Ja.a.eLc,Ja.a.mqi);const u=document.getElementById("url");this.cF(1,!!u&&0<u.value.length);
Le.a.addHandler(u,Fa.a.input,Object(z.a)(this,this.wkd,"onPatternChanged"));Le.a.addHandler(u,Fa.a.change,Object(z.a)(this,this.wkd,"onPatternChanged"));this.jS(u)}hide(){const u=document.getElementById("url");u&&(Le.a.removeHandler(u,Fa.a.input,Object(z.a)(this,this.wkd,"onPatternChanged")),Le.a.removeHandler(u,Fa.a.change,Object(z.a)(this,this.wkd,"onPatternChanged")));super.hide()}RTj(u,P){if(1===u){if(P){var la=cj.a.Jj("InsertOnlineVideo",1);la.$p=!0;u=P.url.trim();(u=this.B$.X4i(u))?this.B$.vvg(u)&&
this.B$.a$j(u)?(N.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.B$.y8f(u)),this.B$.requestVideoData(u,Ca=>{cj.a.qy(la,()=>{this.rZ(Ca)})},Object(z.a)(this,this.a6i,"failCallback"))):(N.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.B$.y8f(u)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(N.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}rZ(u){this.hide();
this.B$.Smg(u)}a6i(u){this.fail(u,ResourceStrings.l_CannotInsertOnlineVideo)}fail(u,P){if(document.getElementById("labelmessage")){var la=+new Date-+this.B$.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=P;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();u&&N.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:la,["ResponseCode"]:u.data.Oe}))}else N.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}wkd(){cj.a.BGa();const u=document.getElementById("url");this.cF(1,!!u&&0<u.value.length)}}Object(r.a)($l,"InsertOnlineVideoDialog",Ue.a,[1312]);var kg=d(63),Rm=d(1134),oi=d(61);class oj{constructor(u,P,la){this.FVb=Dg.a.z8;this.KG=null;this.Ca=u;this.SHd=P;this.aCa=la}get un(){return this.Ca}get w8(){return this.KG||(this.KG=w.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Ax(){return this.FVb}set Ax(u){this.FVb=u}Dua(u){try{n.ULS.sendTraceTag(21612195,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",u.length);const P=this.SHd.bXk(u);let la=2;if(P&&0<P.length){const Ca=new Rm.DictionaryPropertySet;Ca.setValue(oi.a.aV,P);Ca.setValue(oi.a.z2c,!0);if(this.aCa){const Ta=this.aCa.x5e();Ta.RKc("insertOnlineImage");Ca.setValue(oi.a.PRa,Ta)}t.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.w8.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);la=this.Ca.Ja(this.Ax,2,Ca)}n.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",u.length,32===la,""===P)}catch(P){n.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",P.toString())}}}Object(r.a)(oj,"InsertOnlineImageHandler",null,[1120]);class zi extends oj{constructor(u,P,la=null){super(u,P,la)}get zSf(){return Qe.a.insertImage}get Yzb(){return Qe.a.LTj}Sgh(u){return this.SHd.fRk(u)}icg(u){return u.Type}h2c(u,
P){return this.SHd.h2c(u.Type,P)}Tgh(u){const P=[];if(u&&u.data&&u.data.value&&0<u.data.value.length)for(let Ca=0;Ca<u.data.value.length;Ca++)if(u.data.value[Ca]&&u.data.value[Ca].urls&&u.data.value[Ca].urls.download){var la=u.data.value[Ca];la=Object.assign(new ni.a,{OriginalUrl:la.urls.download,Type:la.extension||"",Caption:la.name,ContentType:"",Height:la.driveItem||la.driveItem.image?la.driveItem.image.height:0,Width:la.driveItem||la.driveItem.image?la.driveItem.image.width:0});Array.add(P,la)}P.length||
n.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return P}Ykh(u,P,la){la=la(u);if(la.length){u=[];for(let Ca=0;Ca<la.length;Ca++){const Ta=la[Ca],pb={};pb.Extension=Ta.Type;pb.SourceUrl=Ta.OriginalUrl;pb.SourceUrl=Ta.OriginalUrl;pb.Width=Ta.Width;pb.Height=Ta.Height;Array.add(u,pb)}la={};la.Items=u;P.sendMessage(this.Yzb,la)}}}Object(r.a)(zi,"InsertOnlineImageHelperBox4",oj,[1119,1120]);class sh extends zi{constructor(u,P,la){super(u,
P);this.aJe=la.insertOnlineVideoUrlPatterns;this.Ax=wb.a.ake}Dua(u){if(u&&0<u.length){var P=Cd.a.jA(u[0].OriginalUrl);P=this.Fre(P)?P:"unsupported";N.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",P);this.un.Ja(this.Ax,2,u[0])}}Fre(u){if(!u)return!1;u=u.trim();for(const P of this.aJe)if((new RegExp(P)).test(u))return!0;return!1}}Object(r.a)(sh,"InsertOnlineVideoHelper",zi,[]);class Ij{static get hg(){return Ue.a.pz(Ij.Fo,ResourceStrings.l_InsertSocialMediaDialogMsg)}}
Ij.Fo="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(r.a)(Ij,"InsertSocailMediaDialogHtml",null,[]);var Uh=d(86),mf=d(237);class Ql extends Sys.EventArgs{constructor(u,P,la,Ca){super();this.slideId=u;this.qZ=la;this.shapeId=P;this.iconName=Ca}}Object(r.a)(Ql,"IconChangedEventArgs",Sys.EventArgs,[]);var Fk=d(502);class dj{constructor(u,
P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg,$i,jk,fj,Mk,Tk,Uk,uh,Ri,Tj,Km){this.YHa=this.f2c=!1;this.oHb=this.ena=null;this.pza=(kk,Vk,aq)=>{if(!this.jba(this.ua.Ba,kk,this.la.Rbb))return 8;if(1===aq)return 32;let Uj,Zm;this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?Zm="dallecore":this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&(Zm="dalle");Vk=new Aa.QueryStringBuilder(this.Rlj(kk));Vk.xg("entryPoint",wb.a.uy(kk));
Zm&&Vk.xg(Zm,"1");switch(kk){case wb.a.xAb:case wb.a.Aac:Uj=1;this.mfa.Ax=wb.a.Bac;break;case wb.a.f0c:case wb.a.g0c:Vk.iy("initpivot","dalle");Uj=1;this.mfa.Ax=wb.a.Bac;break;case wb.a.wac:Uj=1;this.mfa.Ax=wb.a.k0c;break;case wb.a.FRa:Gd.a("ChangePictureFromIconsFixEnabled")?this.qma.Ax=wb.a.R1b:this.qma.Ax=wb.a.SMc;Uj=0;break;case wb.a.u8a:Uj=0;this.qma.Ax=wb.a.R1b;break;case wb.a.W1b:Vk.iy("initpivot","dalle");Uj=0;this.qma.Ax=wb.a.R1b;break;default:return N.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",
kk.toString()),16}this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(Vk.xg("gae","1"),t.AFrameworkApplication.Bdb("0fecb342;2aaje503"));this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyIngestionExperiment",!1)&&(Vk.xg("gie","1"),Vk.xg("semsearch","1"),t.AFrameworkApplication.Bdb("421a8839;gjbhf574"));this.la.Vbb&&Vk.xg("sv","1");const $n=Vk.toString();if(!$n||!$n.length)return 16;N.a.J(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");
try{const Hl=bi.a.create(),$q=Gb.a.nL(this.la.pptEditingUserId).toString();this.Tea.execute(Fp=>{var ar=this.la.Hmg&&Fp.isFreemiumUpsellEnabled();ar=this.YHa?1:ar?0:-1;var uq=this.Ib.ka("InsertOnlineM365ExperimentEnabled")?1:0;uq=this.KJ.pHf(Kc.App.mode,$n,ar,Uj,Hl.toString(),$q,uq);Fp=this.NEb.getInstance(uq,this.MEb,this.KJ,Fp,nj.hg);Fp.correlationId=Hl;Fp.xaa=2;Fp.IQc=ar;Fp.emb(CommonUIStrings.L_PictureInsertTitle,kk===wb.a.FRa||kk===wb.a.u8a?this.qma:this.mfa,void 0);N.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});
return 32}catch(Hl){return N.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",Hl.toString()),dj.Nt(Uh.a.genericError,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}};this.la=u;this.ia=P;this.fc=la;this.pa=Ca;this.Fa=Ta;this.ua=pb;this.Fb=Sb;this.NEb=Cc;this.Wmk=ed;this.MEb=ad;this.KJ=Zd;this.Tea=We;this.mfa=Qf;this.qma=Af;this.Sb=Ph;this.wk=pf;this.Ga=He;this.Eb=Yf;this.Rq=Rg;this.kj=$i;this.$fb=jk;this.$Xa=Uk;this.yDe=
uh;this.Fc=Ri;this.BU=u.KKb;this.Ib=Km;this.$fb&&(this.$fb.l$a.removeAttribute("style"),this.$fb.l$a.style.display="none");this.bFe=fj;this.Xmk=Mk;this.B$=Tk;this.V4=Tj;this.Tea.execute(kk=>{kk.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Vk=>N.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Vk)).then(Vk=>{this.YHa=Vk;this.YHa||(this.ena=kk.C0a("MsoPremiumStockImages",()=>{this.YHa=!0;N.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));
return null})})}vb(){this.rfi();this.ia.ra(wb.a.k0c,Uf.a.application,Object(z.a)(this,this.jWl,"uploadIcon"),4);Gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(wb.a.SMc,Uf.a.application,Object(z.a)(this,this.tBi,"changeToIcon"),4):this.ia.ra(wb.a.SMc,Uf.a.application,Object(z.a)(this,this.uBi,"changeToIcon"),4);this.ia.ra(wb.a.Sbb,Uf.a.application,Object(z.a)(this,this.Yzd,"uploadOnlinePicture"),4);Gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(wb.a.V1b,Uf.a.application,Object(z.a)(this,
this.UMc,"changeToOnlinePicture"),4):this.ia.ra(wb.a.V1b,Uf.a.application,Object(z.a)(this,this.VMc,"changeToOnlinePicture"),4);this.ia.ra(wb.a.Bac,Uf.a.application,Object(z.a)(this,this.Yzd,"uploadOnlinePicture"),4);Gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(wb.a.R1b,Uf.a.application,Object(z.a)(this,this.UMc,"changeToOnlinePicture"),4):this.ia.ra(wb.a.R1b,Uf.a.application,Object(z.a)(this,this.VMc,"changeToOnlinePicture"),4);this.ia.ra(wb.a.m0c,Uf.a.application,Object(z.a)(this,this.Yzd,
"uploadOnlinePicture"),4);Gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(wb.a.S1b,Uf.a.application,Object(z.a)(this,this.UMc,"changeToOnlinePicture"),4):this.ia.ra(wb.a.S1b,Uf.a.application,Object(z.a)(this,this.VMc,"changeToOnlinePicture"),4);this.qfi();this.ia.ra(wb.a.Fmg,Uf.a.application,Object(z.a)(this,this.Yzd,"uploadOnlinePicture"),4);Gd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.ra(wb.a.CZd,Uf.a.application,Object(z.a)(this,this.UMc,"changeToOnlinePicture"),4):this.ia.ra(wb.a.CZd,
Uf.a.application,Object(z.a)(this,this.VMc,"changeToOnlinePicture"),4);this.sfi();this.ia.ra(wb.a.ake,Uf.a.application,Object(z.a)(this,this.mWl,"uploadOnlineVideo"),4);this.ia.ra(wb.a.Zje,Uf.a.application,Object(z.a)(this,this.lWl,"uploadOnlineHubbleVideo"),4);this.ia.ra(wb.a.jqc,db.a.application,Object(z.a)(this,this.VSl,"updateEntryPoints"),96)}rfi(){this.ia.ra(wb.a.wac,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),4);this.ia.ra(wb.a.FRa,Uf.a.application,Object(z.a)(this,
this.pza,"showInsertMediaDialogFromM365"),4);this.ia.ra(wb.a.insertOnlinePicture,Uf.a.application,Object(z.a)(this,this.R3e,"showInsertPictureDialog"),4);this.ia.ra(wb.a.T1b,Uf.a.application,Object(z.a)(this,this.R3e,"showInsertPictureDialog"),4);Gd.a("InsertSocialMediaVideoIcon")&&this.ia.ra(wb.a.Omg,Uf.a.application,Object(z.a)(this,this.YAl,"showInsertSocialMediaDialog"),4);Gd.a("InsertDalleIcon")&&(this.ia.ra(wb.a.f0c,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),
4),this.ia.ra(wb.a.g0c,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),4));this.ia.ra(wb.a.xAb,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),4);this.ia.ra(wb.a.u8a,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),4);Gd.a("ChangePictureCreateWithAI")&&this.ia.ra(wb.a.W1b,Uf.a.application,this.pza,4);this.ia.ra(wb.a.Aac,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),4);this.ia.ra(wb.a.yAb,
Uf.a.application,Object(z.a)(this,this.S3e,"showInsertPictureFromHostDialog"),4);this.ia.ra(wb.a.U1b,Uf.a.application,Object(z.a)(this,this.S3e,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.ikb("ppt_insertOnlinePictures",wb.a.insertOnlinePicture,Uf.a.application,Object(z.a)(this,this.R3e,"showInsertPictureDialog"),u=>{Kc.App.Mb.b3a(u,Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))}),this.ia.ikb("ppt_insertOnlinePictures",wb.a.xAb,Uf.a.application,Object(z.a)(this,this.pza,
"showInsertMediaDialogFromM365"),u=>{Kc.App.Mb.b3a(u,Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))}),this.ia.ikb("ppt_insertOnlinePictures",wb.a.Aac,Uf.a.application,Object(z.a)(this,this.pza,"showInsertMediaDialogFromM365"),u=>{Kc.App.Mb.b3a(u,Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))}),this.ia.ikb("ppt_insertOnlinePictures",wb.a.yAb,Uf.a.application,Object(z.a)(this,this.S3e,"showInsertPictureFromHostDialog"),u=>{Kc.App.Mb.b3a(u,Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))}))}qfi(){this.la.q0c&&
this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.ra(wb.a.p0c,Uf.a.application,Object(z.a)(this,this.wvd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.ra(wb.a.X1b,Uf.a.application,Object(z.a)(this,this.wvd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.ikb("mso_insertMobileDevicePictures",wb.a.p0c,Uf.a.application,Object(z.a)(this,this.wvd,"showInsertPictureFromMobileDeviceDialog"),u=>{Kc.App.Mb.b3a(u,
Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))}),this.ia.ikb("mso_insertMobileDevicePictures",wb.a.X1b,Uf.a.application,Object(z.a)(this,this.wvd,"showInsertPictureFromMobileDeviceDialog"),u=>{Kc.App.Mb.b3a(u,Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))})))}sfi(){this.ia.ra(wb.a.Eua,Uf.a.application,Object(z.a)(this,this.hPb,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.ikb("ppt_insertOnlineVideos",wb.a.Eua,Uf.a.application,Object(z.a)(this,this.hPb,"showInsertVideoDialog"),
u=>{Kc.App.Mb.b3a(u,Object(z.a)(this.V4,this.V4.HEa,"getCommandById"))})}dXk(){t.AFrameworkApplication.Lbc()&&t.AFrameworkApplication.$Dh()&&(t.AFrameworkApplication.Aa.get_element().appendChild(this.$fb.l$a),Le.a.addHandler(this.$fb.l$a.contentWindow,"message",Object(z.a)(this,this.gFh,"showOneDriveFilePickerDialog")),this.f2c=!0)}gFh(u){if(u.rawEvent&&(u=u.rawEvent.data))try{N.a.J(512517961,352,50,"User select images.");const P=Sys.Serialization.JavaScriptSerializer.deserialize(u,!0),la=P.MessageId?
P.MessageId.toString():null;P&&la&&(la===Qe.a.insertImage||la===Qe.a.Xje)&&this.bFe.start(la===Qe.a.insertImage?this.mfa:this.Xmk)}catch(P){N.a.J(512517960,352,10,"malformatted postmessage here.")}}me(){}VSl(){return 32}R3e(u,P,la){if(!this.jba(this.ua.Ba,u,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;N.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const Ca=bi.a.create(),Ta=Gb.a.nL(this.la.pptEditingUserId).toString(),pb=u===wb.a.insertOnlinePicture&&
this.la.KVk?1:0;let Sb=String.format(this.la.insertPictureServiceEndpoint,t.AFrameworkApplication.lcid,nh.a.He(t.AFrameworkApplication.lcid).name,t.AFrameworkApplication.buildVersion,Ca.toString(),3,Ta,pb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net","gi"))&&(Sb=this.KJ.Yui(Kc.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.Tea.execute(Cc=>{Cc=this.NEb.getInstance(Sb,this.MEb,
this.KJ,Cc,Of.hg);Cc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;Cc.correlationId=Ca;Cc.xaa=1;switch(u){case wb.a.T1b:this.qma.Ax=wb.a.V1b;break;default:this.mfa.Ax=wb.a.Sbb}Cc.emb(CommonUIStrings.L_PictureInsertTitle,u===wb.a.insertOnlinePicture?this.mfa:this.qma,void 0);N.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(Ca){return N.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",
Ca.toString()),dj.Nt(Uh.a.genericError,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}YAl(u,P,la){if(1===la)return 32;u=new Ue.a(void 0,void 0,!1);u.Ad=5;u.hg=Ij.hg;u.sj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});N.a.J(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}Rlj(u){switch(u){case wb.a.xAb:case wb.a.Aac:case wb.a.f0c:case wb.a.g0c:return this.la.$je;case wb.a.wac:return this.la.l0c;
case wb.a.FRa:return Gd.a("ChangePictureFromIconsFixEnabled")?this.la.l0c:this.la.kBi;case wb.a.u8a:case wb.a.W1b:return this.la.lBi;default:return this.la.$je}}S3e(u,P,la){if(!this.jba(this.ua.Ba,u,t.AFrameworkApplication.Lbc()&&(dj.Lig?!!this.bFe.EJb&&9<this.bFe.EJb.length:!0)))return 8;if(1===la)return 32;N.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{P=!0;let Ca=0;if(this.Ib.ka("InsertMediaSharedFilePickerEnabled")){const pb=w.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");
if(pb.jre()){P=!1;const Sb=this.la.Lmg;la=!1;this.la.q0c&&(la=this.Ncj());const Cc=Object.assign(new qc,{mtb:la,lAb:!0}),ed=pb.X1d(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Sb,"InsertPicture",0,Cc);pb.jWc(ed).then(ad=>{if(ad&&0<ad.length){const Zd=[];for(let We=0;We<ad.length;We++){const Qf=ad[We][Se.a.GQe],Af={};Af.Extension=ad[We][Se.a.cih];Af.OriginalUrl=Se.a.BQe in ad[We]?ad[We][Se.a.BQe]:Qf;Af.Type=Se.a.CQe in ad[We]?ad[We][Se.a.CQe]:"";Af.Caption=
Se.a.FQe in ad[We]?ad[We][Se.a.FQe]:"";Af.Description=Se.a.AQe in ad[We]?ad[We][Se.a.AQe]:"";Af.Width=Se.a.EQe in ad[We]?ad[We][Se.a.EQe]:0;Af.Height=Se.a.DQe in ad[We]?ad[We][Se.a.DQe]:0;Array.add(Zd,Af)}this.zmj(u).Dua(Zd);N.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}Ca=32}).catch(ad=>{N.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",ad.toString());dj.Nt(Uh.a.genericError,ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_CannotInsertOnlinePicture);Ca=8})}}if(!P)return Ca;dj.Lig=!0;this.f2c||this.dXk();const Ta=this.Wmk.getInstance();Ta.xaa=4;switch(u){case wb.a.U1b:this.qma.Ax=wb.a.S1b;break;default:this.mfa.Ax=wb.a.m0c}Ta.emb(CommonUIStrings.L_PictureInsertTitle,u===wb.a.yAb?this.mfa:this.qma,void 0);N.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(Ca){return N.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",
Ca.toString()),dj.Nt(Uh.a.genericError,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}zmj(u){if(!Gd.a("ChangePictureFromOneDriveFixEnabled"))return this.mfa;const P=(u=u===wb.a.yAb)?this.mfa:this.qma;P.Ax=u?wb.a.m0c:wb.a.S1b;return P}Ncj(){return w.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").Vej()}wvd(u,P,la){if(!this.jba(this.ua.Ba,u,this.la.q0c&&this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)))return 8;if(1===la)return 32;w.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").M6i(this.Ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let Ca=0;const Ta=w.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Ta.jre()){const pb=u===wb.a.p0c,Sb=this.la.Lmg,Cc=Object.assign(new qc,{mtb:!0,lAb:!0}),ed=Ta.X1d(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,pb,Sb,"InsertPictureFromMobile",
3,Cc);Ta.jWc(ed).then(ad=>{if(ad&&0<ad.length){const Zd=[];let We=!1;const Qf=this.Ib.Ha("PhoneLinkServiceEndpoint");for(let Af=0;Af<ad.length;Af++){const Ph=ad[Af][Se.a.GQe],pf=ad[Af],He={};He.Extension=ad[Af][Se.a.cih];He.OriginalUrl=this.VLb(pf,Se.a.BQe,Ph);He.Type=this.VLb(pf,Se.a.CQe,"");He.Caption=this.VLb(pf,Se.a.FQe,"");He.Description=this.VLb(pf,Se.a.AQe,"");He.Width=this.VLb(pf,Se.a.EQe,0);He.Height=this.VLb(pf,Se.a.DQe,0);Array.add(Zd,He);We||(We=-1!==He.OriginalUrl.indexOf(Qf))}ad=pb?
this.mfa:this.qma;ad.Ax=We?pb?wb.a.Fmg:wb.a.CZd:pb?wb.a.m0c:wb.a.S1b;ad.Dua(Zd);N.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}Ca=32}).catch(ad=>{N.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",ad.toString());Ca=8})}return Ca}catch(Ca){return N.a.J(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Ca.toString()),8}}VLb(u,
P,la){return P in u?u[P]:la}Yzd(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===la)return 32;if(!this.kj.hD(P,1))return this.kj.KD(P),16;try{const pb=P.R_(this.pa.Ud());if(pb&&this.fc.fd(pb))return 16;const Sb=this.Gab(P,pb);let Cc=null;const ed=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(Sb,!0);Cc&&this.pa.selectShape(Cc,!1)});try{ed.jc(P);
ed.gd=wb.a.insertOnlinePicture;ed.ry[mf.a.pka]=mf.a.online;la=null;u={["actionId"]:u};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Ta.LicenseUrl&&Ta.LicenseDisplayName){const ad=dj.TRe(Ta);la=ql.c(ad);if(this.la.pptImageAttributionSelectionImprove){const Zd=P.Cb;Cc=this.wk.Xja(!0,Zd.cid,Zd.sid,0,0,0,kg.a.UR,kg.a.BY,P.Cs()+1,!1)}}else u["result.LicenseDisplayName"]=Ta.LicenseDisplayName,u["result.LicenseUrl"]=Gb.a.nL(Ta.LicenseUrl);else u.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;
N.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",u);Sb.kOb(Ta.OriginalUrl,Ta.LicenseUrl?null:Ta.Caption,la,Ta.PageUrl);pb&&P.cS([pb]);P.oB(Sb);Cc&&(P.oB(Cc),Sb.T7a=Cc.id,Cc.zbb=!0)}finally{ed&&ed.dispose()}this.Rq.oA=Sb;return 32}catch(pb){return N.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",pb.toString()),8}}VMc(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.FKa))return 8;
if(1===la)return 32;N.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Ta)return 16;try{const pb=this.bab()||this.qWc();if(!pb||this.fc.fd(pb))return 16;let Sb=null;const Cc=this.Fb.yd(15,void 0,void 0,()=>{this.pa.selectShape(pb,!0);Sb&&this.pa.selectShape(Sb,!1);N.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{Cc.jc(P);Cc.gd=wb.a.V1b;Cc.ry[mf.a.pka]=mf.a.online;u=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&
Ta.LicenseUrl&&Ta.LicenseDisplayName){const ed=dj.TRe(Ta);u=ql.c(ed);if(this.la.pptImageAttributionSelectionImprove){const ad=P.Cb;Sb=this.wk.Xja(!0,ad.cid,ad.sid,0,0,0,kg.a.UR,kg.a.BY,P.Cs()+1,!1);N.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}pb.kOb(Ta.OriginalUrl,Ta.LicenseUrl?null:Ta.Caption,u,Ta.PageUrl);pb.set_isSVGBlipFilled(!1);Sb&&(P.oB(Sb),pb.T7a=Sb.id,Sb.zbb=!0)}finally{Cc&&Cc.dispose()}this.Rq.oA=pb;return 32}catch(pb){return N.a.J(512517905,
352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",pb.toString()),8}}UMc(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.FKa))return 8;if(1===la)return 32;N.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Ta)return 16;try{var pb=this.pa.Ud();u=[];for(var Sb of pb)Sb.Of||u.push(Sb);for(const ed of u)if(!ed||this.fc.fd(ed))return 16;pb=null;const Cc=this.Fb.yd(15,void 0,
void 0);try{Cc.jc(P);Cc.gd=wb.a.V1b;Cc.ry[mf.a.pka]=mf.a.online;Sb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Ta.LicenseUrl&&Ta.LicenseDisplayName){const ad=dj.TRe(Ta);Sb=ql.c(ad);if(this.la.pptImageAttributionSelectionImprove){const Zd=P.Cb;pb=this.wk.Xja(!0,Zd.cid,Zd.sid,0,0,0,kg.a.UR,kg.a.BY,P.Cs()+1,!1);N.a.J(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const ed=Ta.LicenseUrl?null:Ta.Caption;for(const ad of u)ad.kOb(Ta.OriginalUrl,
ed,Sb,Ta.PageUrl),ad.set_isSVGBlipFilled(!1),pb&&(P.oB(pb),ad.T7a=pb.id,pb.zbb=!0)}finally{Cc&&Cc.dispose()}this.Rq.oA=u[0];return 32}catch(Cc){return N.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",Cc.toString()),8}}jWl(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517903,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.Rbb))return 8;if(1===la)return 32;N.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Ta||!Ta.length)return 16;
if(!this.kj.hD(P,Ta.length))return this.kj.KD(P),16;try{let pb=null;la=null;if(!({gTk:la,XSk:pb}=this.qrj(Ta,P)).returnValue)return 16;const Sb=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.pa.j1a(pb,!0)});try{for(Sb.jc(P),Sb.gd=u,Sb.ry[mf.a.pka]=mf.a.icon,la&&P.cS(la),u=0;u<pb.length;u++)P.oB(pb[u])}finally{Sb&&Sb.dispose()}this.Rq.oA=pb[pb.length-1];return 32}catch(pb){return N.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",
Ta.length,pb.toString()),8}}qrj(u,P){let la,Ca;la=Array(u.length);Ca=Array(u.length);var Ta=P.R$d(this.pa.Ud());if(Ta&&0<Ta.length){var pb=0;for(const Sb of Ta)if(Sb&&!this.fc.fd(Sb)&&pb<u.length&&(la[pb]=Sb,pb++,pb===u.length))break}Ta=!0;for(pb=0;pb<la.length;pb++)this.la.svgIconLocalEditingIsEnabled&&u[pb].SvgContent&&0<u[pb].SvgContent.length&&(!la[pb]||la[pb]&&15!==la[pb].Cj)?Ca[pb]=this.orj(P,la[pb],u[pb],pb):(Ca[pb]=this.aYc(P,la[pb],u[pb],!0,pb),Ta=!1),Ta&&cj.a.KP(!0,!0),Ca[pb].kOb(u[pb].OriginalUrl,
u[pb].Caption,null,null);return{returnValue:!0,gTk:la,XSk:Ca}}orj(u,P,la,Ca){if(!u)return null;var Ta=u.Cb,pb=u.Cs();let Sb;const Cc=Object(U.a)(424,u.qc(this.Eb.Na));({m8d:Sb,mC:u}=this.$Xa.z0d(P,la.Width,la.Height));Ca=P?0:Ca*Hj.a.nT;Ta=this.wk.Xja(!0,Ta.cid,Ta.sid,0,u.x+Ca,u.y+Ca,Sb.width,Sb.height,pb+1,!1);pb=this.$Xa.IXd(this.Eb.Nd,Sb,u,Cc.$T);Ta.dS=pb;Ta.isResizable=!0;Ta.Ubc=!0;Ta.bM=!0;Ta.FJa=!0;Ta.set_isSVGBlipFilled(!0);la=this.yDe.hjl(la.SvgContent);Ta.Mea=la?String.format("data:image/svg+xml;charset=utf8,{0}",
encodeURIComponent(la)):"";P&&(Ta.B8=P.id);return Ta}tBi(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;N.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Ta||!Ta.length)return 16;try{const pb=this.pa.Ud(),Sb=[];for(const ad of pb)ad.Of||Sb.push(ad);const Cc=Ta[0].Caption;for(const ad of Sb){if(!Sb||this.fc.fd(ad))return 16;const Zd=this.Ga.Lr(ad);
Cc&&Zd&&this.Fc.Emh(new Ql(P.Cb,ad.get_shapeId(),ad.get_smartArtModelId(),Cc))}const ed=this.Fb.yd(15,void 0,void 0,()=>{for(const ad of Sb){const Zd=this.Ga.Lr(ad);Zd&&(this.Fc.Sod(),this.pa.selectShape(Zd,!0),this.Fc.Rod())}N.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{ed.jc(Sb[0]);ed.gd=u;ed.ry[mf.a.pka]=mf.a.icon;for(const ad of Sb)ad.set_isSVGBlipFilled(!0),ad.kOb(Ta[0].OriginalUrl,Cc,null,null)}finally{ed&&ed.dispose()}for(const ad of Sb)this.fc.usa(P,ad,
this.Eb.Na,u);return 32}catch(pb){return N.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Ta.length,pb.toString()),8}}uBi(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===la)return 32;N.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Ta||!Ta.length)return 16;try{const pb=this.qWc()||this.bab();if(!pb||
this.fc.fd(pb))return 16;const Sb=Ta[0].Caption,Cc=this.Ga.Lr(pb);Sb&&Cc&&this.Fc.Emh(new Ql(P.Cb,pb.get_shapeId(),pb.get_smartArtModelId(),Sb));const ed=this.Fb.yd(15,void 0,void 0,()=>{Cc&&(this.Fc.Sod(),this.pa.selectShape(Cc,!0),this.Fc.Rod());N.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{ed.jc(pb),ed.gd=u,ed.ry[mf.a.pka]=mf.a.icon,pb.set_isSVGBlipFilled(!0),pb.kOb(Ta[0].OriginalUrl,Sb,null,null)}finally{ed&&ed.dispose()}(la=Cc||pb)&&this.fc.usa(P,
la,this.Eb.Na,u);return 32}catch(pb){return N.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Ta.length,pb.toString()),8}}qWc(){let u=null;const P=this.pa.Ud();for(const la of P)if(la&&la.get_isSVGBlipFilled())if(u)break;else u=la;return u}bab(){if(this.BU){const u=this.pa.Ud();return u&&u.length?this.uWd(u)?u[0]:this.uyb():null}return this.uyb()}uWd(u){if(!u||!u.length)return!1;let P=u[0].tj,la=1===u[0].mediaType;for(const Ca of u)P=P&&Ca.tj,
la=la&&1===Ca.mediaType;return P||la}uyb(){const u=this.pa.Ud();for(const P of u)if(P&&P.tj)return P;return null}Syg(u,P){const la=this.Ib.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==la&&N.a.J(u,352,15,`${P}::Modal:${la}`)}hPb(u,P,la){if(!this.jba(this.ua.Ba,u,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;this.oHb=cj.a.Jj("ShowInsertVideoDialog",1);const Ca=this.Ib.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal",
"defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){N.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const pb=bi.a.create(),Sb=Gb.a.nL(this.la.pptEditingUserId).toString();let Cc;const ed=this.la.ka("InsertStream2FlowEnabled")&&this.la.kCb&&this.la.ka("GetCustomHeaderEnabled");ed&&(Cc=w.a.instance.resolve("Common.App.OAuth.IOAuthManager"));this.Tea.execute(ad=>{ad=this.NEb.getInstance(this.KJ.$ui(Kc.App.mode,this.la.oUj,pb.toString(),
Sb,this.la.rcb,ed,Ca),this.MEb,this.KJ,ad,nj.hg);ad.correlationId=pb;ad.xaa=5;const Zd=new sh(this.ia,this.KJ,this.la);Zd.Ax=wb.a.Zje;ad.emb(CommonUIStrings.L_VideoInsertTitle,Zd,Cc)})}else this.la.insertVideoOnlineFromUrlEnabled?(N.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new $l(this.B$)).Rga()):(N.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.Tea.execute(pb=>{this.NEb.getInstance(this.KJ.avi(Kc.App.mode,
this.la.insertVideoServiceEndpoint),this.MEb,this.KJ,pb,Of.hg).emb(CommonUIStrings.L_VideoInsertTitle,new sh(this.ia,this.KJ,this.la),void 0)}));this.Syg(512557208,"ShowInsertOnlineVideoDialog");null!=this.oHb&&Object(Fk.a)(this.oHb.actionName,(new Date).getTime()-this.oHb.bE.getTime(),"InsertOnlineVideoDialog",this.oHb.actionId,this.oHb.Qj);const Ta=this.Ib.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");Gd.a("LogInsertOnlineVideoCustomToolTip")&&
"InsertOnlineVideo"!==Ta&&N.a.J(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Ta);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Ib.U6b){const pb=this.Ib.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";N.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+pb)}N.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Ta){return N.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",
Ta.toString()),dj.Nt(Uh.a.genericError,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}mWl(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517853,352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===la)return 32;if(!this.kj.hD(P,1))return this.kj.KD(P),16;try{const pb=P.R_(this.pa.Ud());if(pb&&this.fc.fd(pb))return 16;const Sb=this.Gab(P,pb),Cc=this.KJ.AAj(Ta.OriginalUrl);Sb.d1e(Cc,Ta.ThumbnailUrl,Ta.Caption,Ta.Description,
0<Ta.Width?Ta.Width:0,0<Ta.Height?Ta.Height:0);const ed=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(Sb,!0)});try{ed.jc(P),ed.gd=u,pb&&P.cS([pb]),P.oB(Sb)}finally{ed&&ed.dispose()}N.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.Rq.oA=Sb;return 32}catch(pb){return N.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",pb.toString()),8}}lWl(u,P,la,Ca,Ta){P=this.ua.Ba;if(!P)return N.a.J(512517850,
352,50,"Active Slide is null"),8;if(!this.jba(P,u,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===la)return 32;N.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.kj.hD(P,1))return this.kj.KD(P),16;try{const pb=P.R_(this.pa.Ud());if(pb&&this.fc.fd(pb))return 16;const Sb=this.Gab(P,pb),Cc=0<Ta.Width?Ta.Width:0,ed=0<Ta.Height?Ta.Height:0;let ad=Ta.PageUrl;this.la.kCb&&"odspbusiness"===Ta.ProviderName.toLocaleLowerCase()&&(ad=Ta.OriginalUrl);Sb.d1e(ad,
Ta.ThumbnailUrl,Ta.Caption,Ta.Description,Cc,ed);const Zd=this.Fb.yd(15,void 0,()=>{this.pa.iu();this.pa.nh();this.Fa.Bd()},()=>{this.pa.selectShape(Sb,!0)});try{Zd.jc(P),Zd.gd=u,pb&&P.cS([pb]),P.oB(Sb)}finally{Zd&&Zd.dispose()}this.Syg(512557200,"InsertOnlineHubbleVideo");N.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Ta.StartInsertTime);this.Rq.oA=Sb;return 32}catch(pb){return N.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",
pb.toString()),8}}jba(u,P,la){u=!!u&&la&&!this.fc.fd(u);switch(P){case wb.a.FRa:return u&&(!!this.bab()||!!this.qWc());case wb.a.T1b:case wb.a.U1b:case wb.a.X1b:case wb.a.u8a:return u&&this.GCi();default:return u}}GCi(){const u=this.bab()||this.qWc();return u?this.Ga.Lr(u)?!1:!0:!1}Gab(u,P){return this.aYc(u,P,null,!1,0)}aYc(u,P,la,Ca,Ta){if(!u)return null;var pb=u.Cb;u=u.Cs();let Sb;Ca?{width:la,height:Sb}=dj.Hxj(P,la):(la=kg.a.UR,Sb=kg.a.BY);let Cc;Cc=P?P.Jyb(la,Sb):this.Sb.Uka(la,Sb);Ta=P?0:Ta*
Hj.a.nT;pb=this.wk.Xja(!0,pb.cid,pb.sid,0,Cc.x+Ta,Cc.y+Ta,la,Sb,u+1,!0);pb.set_isSVGBlipFilled(Ca);P&&(pb.B8=P.id);return pb}dispose(){this.Tea.instance&&this.ena&&this.Tea.instance.lkb("MsoPremiumStockImages",this.ena);this.f2c&&this.$fb.l$a.contentWindow&&(Le.a.removeHandler(this.$fb.l$a.contentWindow,"message",Object(z.a)(this,this.gFh,"showOneDriveFilePickerDialog")),this.f2c=!1)}static Lvi(){const u=CommonUIStrings.l_AttributionText.split(/[{}]+/);return Yk.e(u,P=>!!P)}static Wui(u,P){const la=
document.createElement("body");var Ca="";let Ta="",pb=CommonUIStrings.L_CCYYSA;void 0!==P&&null!==P&&(void 0!==P.PageUrl&&null!==P.PageUrl&&(Ca=P.PageUrl),void 0!==P.LicenseDisplayName&&null!==P.LicenseDisplayName&&0<P.LicenseDisplayName.length&&(pb=P.LicenseDisplayName),void 0!==P.LicenseUrl&&null!==P.LicenseUrl&&(Ta=P.LicenseUrl));for(const Sb of u){switch(Sb){case "L_ThePhoto":u=dj.nHf(CommonUIStrings.l_ThePhoto,Ca);break;case "L_CCYYSA":u=dj.nHf(pb,Ta);break;case "L_PhotoAuthor":u=dj.HHf(CommonUIStrings.l_PhotoAuthor);
break;default:u=dj.HHf(Sb)}u&&la.appendChild(u)}Ca=document.createElement("html");Ca.appendChild(la);return Ca}static HHf(u){const P=document.createElement("span");P.innerText=u;return P}static nHf(u,P){const la=document.createElement("A");la.setAttribute("href",P);la.setAttribute("target","_blank");la.setAttribute("rel","noreferrer");P=document.createElement("span");P.innerText=u;la.appendChild(P);return la}static TRe(u){const P=dj.Lvi();return dj.Wui(P,u)}static Nt(){}static Hxj(u,P){let la;u&&
15===u.Cj?(la=Tc.a.Pe(u.Bbf,0,!1),u=Tc.a.Pe(u.Jhe,0,!1)):P&&0<P.Width&&0<P.Height?(la=P.Width,u=P.Height):(la=Tc.a.Pe(2,0,!1),u=Tc.a.Pe(2,0,!1));return{width:la,height:u}}}dj.Lig=!1;Object(r.a)(dj,"InsertMediaActor",null,[268]);var yj=d(548);class ma{}ma.SKl=864E5;ma.Vli=3;ma.fEk=144E5;Object(r.a)(ma,"AddinConstantsNum",null,[]);var ib=d(201),yb=d(390),ac=d(453);class Qc{constructor(u,P,la,Ca=null){this.fa=Ca?Ca:t.AFrameworkApplication.fa;this.OHd=2;this.qAb=u;this.dci=P;this.gx=la}get sVa(){return this.OHd}get LWl(){return this.dci}UYe(u){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.qAb(u,
this.sVa,{["ak0"]:(new Date).getTime()});else if(ac.a.yDh(u)){var P=String.format(t.AFrameworkApplication.Aa.mb.aoa+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",t.AFrameworkApplication.Aa.mb.Ti,this.LWl,t.AFrameworkApplication.Pg);const la=t.AFrameworkApplication.Je;let Ca=null;this.gx&&(Ca=this.gx.Ii("ComponentAttach",yb.a[u]+yj.a[this.sVa]));la.qj(P,1,null,null,!0,4,Ta=>{this.zNk(u,Ta.data.Wd);Ca&&Ca.stop()},Ta=>{n.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",
Ta.data.Oe);Ca&&Ca.stop()},null)}else ac.a.bhe(u)?(P=ac.a.y$d(u),this.qAb(u,this.sVa,{["ak0"]:P})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.qAb(u,this.sVa,null)}zNk(u,P){if(P&&""!==P&&(P=Sys.Net.XMLDOM(P))){ac.a.fxc(ib.a.WUd,((new Date).getTime()+ma.fEk).toString(),u);let la=P.getElementsByTagName("update");la&&la.length||(la=P.getElementsByTagName("o:update"));la&&0<la.length&&(P=Date.parse(la[0].firstChild.nodeValue),(ac.a.y$d(u)<
P||ac.a.bhe(u))&&this.qAb(u,this.sVa,{["ak0"]:P}))}}}Object(r.a)(Qc,"AddinCommandsAnonymousAPIInitializer",null,[1229]);class me{constructor(u,P,la){this.OHd=la;this.qAb=u;this.ki=P}get sVa(){return this.OHd}UYe(u){let P=null;this.ki&&(P=this.ki.Ii("ComponentAttach",yb.a[u]+yj.a[this.sVa]));(null==this.f3e(u)?0:this.f3e(u))&&this.qAb(u,this.sVa,{["ak0"]:(new Date).getTime()-ma.Vli*ma.SKl});P&&P.stop()}}Object(r.a)(me,"AddinCommandsInitializerBase",null,[1229]);class Ge extends me{constructor(u,P){super(u,
P,5)}f3e(){return!0}}Object(r.a)(Ge,"AddinCommandsInitializer",me,[]);class sf extends me{constructor(u,P){super(u,P,1)}f3e(u){try{const P=ib.a.f9f()+u;return Boolean.parse(this.Uej(P)||"false")}catch(P){n.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",P.toString())}return null}Uej(u){const P=localStorage;return void 0!==P&&null!==P?P.getItem(u):null}}Object(r.a)(sf,"AddinCommandsLocalCacheInitializer",me,[]);class uf{constructor(u,P=null){this.gx=u;this.fa=P?P:t.AFrameworkApplication.fa}get appUILocale(){return nh.a.He(t.AFrameworkApplication.lcid).name}mRj(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var u={};u[ib.a.y_i]="TeachingCallout";this.xSe(F.a.yNl,u)}const P=this.P$d();if(P)if(this.fa.ka("OcpsIsEnabled"))w.a.instance.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(la=>
{la.isFeatureEnabled("ConnectedServices",!0).then(Ca=>{for(let Ta of P){if(!Ca&&0===Ta.key)continue;const pb=this.i5f(Ta.value);pb&&pb.UYe(Ta.key)}return null})});else for(let la of P)(u=this.i5f(la.value))&&u.UYe(la.key)}VYe(u,P,la){la&&la[ib.a.F7a]?(la[ib.a.csa]=u,la[ib.a.bsa]=P,this.xSe(F.a.RMb,la),ac.a.fxc(ib.a.F7a,la[ib.a.F7a].toString(),u)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===u&&(la={},la[ib.a.csa]=u,la[ib.a.bsa]=P,this.xSe(F.a.dV,
la))}i5f(u){let P=null;switch(u){case 1:P=new sf(Object(z.a)(this,this.VYe,"retrieveAddinFlagCompleted"),this.gx);break;case 2:P=new Qc(Object(z.a)(this,this.VYe,"retrieveAddinFlagCompleted"),this.appUILocale,this.gx,this.fa);break;case 5:P=new Ge(Object(z.a)(this,this.VYe,"retrieveAddinFlagCompleted"),this.gx)}return P}}Object(r.a)(uf,"AddinCommandsInitializerHost",null,[]);var xf=d(1164),dg=d(153);class df extends uf{constructor(u,P){super(u.Jdg());this.Yo=u;this.Ib=P;xf.a.D$b=xf.a.mjh}POl(){this.mRj()}P$d(){const u=
new dg.a;this.Ib.ka("51")&&(u.$(0,2),u.$(16,5));this.Ib.ka("187")&&u.$(1,1);this.Yo.rd.Gua&&u.$(8,1);this.Ib.ka("305")&&u.$(10,5);return u}xSe(u,P){this.Yo.kH().Ja(u,2,P)}}Object(r.a)(df,"AddinCommandsInitService",uf,[1139]);class If{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Xb(u){this.K=u;w.a.instance.register(df,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").oa(()=>new df(this.K.resolve("PowerPointWebEditor.IApplicationContext"),
this.K.resolve("Common.IAppSettingsManager"))).na()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").Vng&&this.K.resolve("Common.IAppSettingsManager").$e(()=>{w.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").POl()})}dispose(){}}Object(r.a)(If,"AddInCommandsInitPackage",null,[2,3]);class Ai extends rb{constructor(u,P=null,la=null){super(u,!0,P,!1,void 0,la)}get tie(){return null}get Vna(){return this.E1c?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:
t.AFrameworkApplication.ata?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get NCb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get nKc(){return null}get E1c(){return"VersionHistory"===this.wzi?!1:t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}XCb(){n.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");t.AFrameworkApplication.Bdb("tcopypdf;ccopypdf")}}
Object(r.a)(Ai,"DownloadAsPdfDialog",rb,[]);class nc extends Ai{constructor(u){super(u)}get Vna(){return t.AFrameworkApplication.ata?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}XCb(){N.a.J(25544926,801,50,"Images download dialog displayed")}Ydc(){N.a.J(25544928,801,50,"Images download dialog link clicked")}zdb(){N.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(r.a)(nc,"DownloadACopyAsImagesDialog",Ai,[]);var hn=d(204);class yn extends ge{constructor(u){super(u,
void 0,t.AFrameworkApplication.ata)}get Vna(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get NCb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get Jdc(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get b4b(){return t.AFrameworkApplication.ata?"UIFontDialogTextLarge":null}XCb(){N.a.J(8958087,801,50,"ODP download dialog displayed")}Ydc(){N.a.J(8958089,801,50,"ODP download dialog link clicked")}zdb(){N.a.J(19505496,801,50,"ODP download dialog button clicked")}B5c(){hn.Redirect.showHelp("PPTODF");
return!0}get Gdc(){return t.AFrameworkApplication.fa&&t.AFrameworkApplication.fa.ka("EnableReactDialogs")&&Gd.a("ReactDialogsODPDialogFix")?null:"#"}get HWa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get k6g(){return!t.AFrameworkApplication.ata}}Object(r.a)(yn,"DownloadACopyAsOdpDialog",ge,[]);class Bm extends Ai{constructor(u){super(u)}get Vna(){return t.AFrameworkApplication.ata?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}XCb(){N.a.J(21050910,
801,50,"PDF download dialog displayed")}Ydc(){N.a.J(21050912,801,50,"PDF download dialog link clicked")}zdb(){N.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(r.a)(Bm,"DownloadACopyAsPdfDialog",Ai,[]);var gh=d(1206),pj=d(398);class Rl extends pj.a{constructor(u,P,la){super();this.oY=null;this.X7c=0;this.Vd=this.FPg=null;this.Csk=u;this.Mkk=P;this.Phk=la;this.u_a=Object(z.a)(this,this.o6,"onRequestComplete");this.onError=Object(z.a)(this,this.eLk,"onRequestError")}get Tnc(){return this.FPg}set Tnc(u){this.FPg=
u}get Gr(){return this.Vd}set Gr(u){this.Vd=u}start(){this.jPb()}jPb(){1!==t.AFrameworkApplication.Aa.state&&(this.oY=new gh.a,this.oY.Mr=!1,this.oY.Ad=5,this.oY.message=this.Csk,this.oY.Fpa(ResourceStrings.l_GenericDialogTitle,null,null),this.X7c=0)}WT(){this.oY&&(this.oY.close(),this.oY=null)}o6(u){this.WT();u.pTa?this.Tnc(u):this.nZ()}eLk(u){u.f5i&&this.X7c<Rl.Uil?(this.X7c+=1,u.start()):this.nZ()}nZ(){this.WT();if(1!==t.AFrameworkApplication.Aa.state){const u=new Sa.StandardDialog;u.Ad=0;u.Yy(this.Phk,
ResourceStrings.l_GenericDialogTitle,this.Mkk,this.Gr)}}}Rl.Uil=3;Object(r.a)(Rl,"UIBlockingTask",pj.a,[]);var Yg=d(264);class va extends Rl{constructor(u){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,Uh.a.UDk);this.RB=u}start(){super.start();Yg.a.vLi(this.RB,Object(z.a)(this,this.gea,"handleWebserviceResponse"),Object(z.a)(this,this.fea,"handleWebserviceError"))}}Object(r.a)(va,"ConvertToOdpTask",Rl,[]);class zn extends Rl{constructor(u){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,Uh.a.rSk);this.RB=u}start(){super.start();Yg.a.xLi(this.RB,Object(z.a)(this,this.gea,"handleWebserviceResponse"),Object(z.a)(this,this.fea,"handleWebserviceError"))}}Object(r.a)(zn,"ConvertToPdfTask",Rl,[]);class jh{constructor(u,P,la){this.t8c=u;this.Ce=P;this.Yxe=la}get Dwb(){return this.t8c.value}convert(u,P,la){let Ca=null;0===P?this.Yxe?new yn(la):(Ca=new va(u),Ca.Tnc=Object(z.a)(this,this.mGk,"onConvertOdpRequestSucceeded"),Ca.start()):1===P?this.Ce.rd.Oqg&&
this.Yxe?new Bm(la):cj.a.YI(cj.a.Kb,()=>{Ca=new zn(u);Ca.Tnc=Object(z.a)(this,this.nGk,"onConvertPdfRequestSucceeded");Ca.start()}):2===P?this.Ce.rd.atg&&this.Yxe&&new nc(la):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",P))}mGk(u){u=u.result;1!==t.AFrameworkApplication.Aa.state&&(u=Cd.a.Jka(u.PrintUrl),new yn(u))}nGk(u){u=u.result;1!==t.AFrameworkApplication.Aa.state&&(u=Cd.a.Jka(u.PrintUrl),this.Dwb.wPf=new Date,new Bm(u),this.Dwb.kVf=new Date,N.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.Dwb.cXf.toString(),this.Dwb.xwh.toString(),this.Dwb.wPf.toString(),this.Dwb.kVf.toString()))}}Object(r.a)(jh,"Converter",null,[1311]);class Qg{constructor(){this.cXf=this.xwh=this.wPf=this.kVf=Kc.App.tn}}Object(r.a)(Qg,"DownloadACopyAsPdfContext",null,[]);class Pk extends Rl{constructor(u,P){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
Uh.a.SXk);this.RB=u;this.Ewk=P}start(){super.start();Yg.a.print(this.RB,this.Ewk,Object(z.a)(this,this.gea,"handleWebserviceResponse"),Object(z.a)(this,this.fea,"handleWebserviceError"))}}Object(r.a)(Pk,"PrintTask",Rl,[]);class Sj{constructor(u,P,la){if(!u)throw Error.argumentNull("directPrintManager");this.Mfc=u;this.Ce=P;this.blk=la}BKk(u){this.Mfc.dYk();u=u.result;1!==t.AFrameworkApplication.Aa.state&&(u=Cd.a.Jka(u.PrintUrl),this.Mfc.jFh(u))}print(u,P,la){this.Ce.rd.Oqg&&this.blk?(u=new Aa.QueryStringBuilder(P),
u.xg(hi.a.tQk,this.Mfc.aEh().toString()),u.xg(hi.a.oQk,la.toString()),this.Mfc.jFh(u.toString())):(la=new Pk(u,this.Mfc.aEh()),la.Tnc=Object(z.a)(this,this.BKk,"onPrintRequestSucceeded"),la.start())}}Object(r.a)(Sj,"Printer",null,[1140]);class fk{get name(){return"PowerPointWebEditor.PrintPackage"}Xb(){w.a.instance.register(Sj,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").na().oa(()=>new Sj(w.a.instance.rb("Common.App.DirectPrint.IDirectPrintManager"),w.a.instance.rb("PowerPointWebEditor.IApplicationContext"),
w.a.instance.rb("PowerPointWebEditor.IApplicationSettings").yg));w.a.instance.register(jh,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").na().oa(()=>new jh(w.a.instance.ue("PowerPointWebEditor.DownloadACopyAsPdfContext"),w.a.instance.rb("PowerPointWebEditor.IApplicationContext"),w.a.instance.rb("PowerPointWebEditor.IApplicationSettings").yg));w.a.instance.register(Qg,"PowerPointWebEditor.DownloadACopyAsPdfContext").na().oa(()=>new Qg)}init(){}dispose(){}}Object(r.a)(fk,"PrintPackage",null,
[2,3]);var km=d(1075);class jn extends zi{constructor(u,P,la){super(u,P);this.la=la;this.Ax=wb.a.Uub}Dua(u){if(u&&u.length){var P=wb.a.uy(this.Ax),la=this.MXj(u[0]);try{N.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",P,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(la?this.un.Ja(wb.a.SMc,2,u):this.un.Ja(this.Ax,2,u[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",
la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));N.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",P,la?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(Ca){N.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",P,Ca.toString())}}}MXj(u){(u=!!u&&!!u.OriginalUrl&&0<u.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&
0<this.la.powerPointInsertContentSvgPath.length&&0<=u.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&u.OriginalUrl.toLowerCase().indexOf(".svg")===u.OriginalUrl.length-4)||N.a.J(512517842,352,50,"isChangeSvg = false");return u}}Object(r.a)(jn,"ChangeOnlineImageHelper",zi,[]);class wk extends zi{constructor(u,P,la){super(u,P);this.la=la;this.Ax=wb.a.Sbb}Dua(u){var P;if(u&&u.length){var la=wb.a.uy(this.Ax),Ca=new Map;Ca.set("InsertMediaCommand",la);eg.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",
null,Ca);try{const pb=[],Sb=[],Cc=[];for(let ad=0;ad<u.length;ad++){const Zd=u[ad];this.jrg(Zd)?Array.add(pb,Zd):this.la.Vbb&&this.b$j(Zd)?Array.add(Cc,Zd):Array.add(Sb,Zd)}N.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",Sb.length,pb.length,la);let ed=this.Ax;ed===wb.a.k0c?ed=wb.a.Bac:this.la.Vbb&&ed===wb.a.Ubb&&(ed=wb.a.Bac);for(u=0;u<Sb.length;u++){var Ta=this.un.Ja(ed,2,Sb[u]);if(32!==Ta)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",
Sb.toString(),la));}if(this.la.Vbb&&0<Cc.length){this.Ve||(this.syh(cj.a.Jj("StockVideos::Insert")),null===(P=this.Ve)||void 0===P?void 0:P.Wa("StockVideoInitiatedByRibbon","false"));this.Ve&&this.Ve.Wa("totalVideosSelected",Cc.length.toString());const ad=performance.now();for(P=0;P<Cc.length;P++)if(Ta=this.un.Ja(wb.a.Ubb,2,Cc[P]),32!==Ta)throw this.JYf("videosInsertedBeforeFailure",P,ad),Error.invalidOperation(String.format("Failed to upload video {0} with command {1}.",Cc.toString(),la));this.JYf("videosInsertedSuccess",
Cc.length,ad)}if(this.jrg(pb[0])&&(Ta=this.un.Ja(wb.a.k0c,2,pb),32!==Ta))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",pb.toString()));N.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images {2} videos success, command: {3}.",Sb.length,pb.length,Cc.length,la)}catch(pb){N.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.Ax.toString(),pb.toString()),Ca.set("Exception",pb.toString()),eg.Health.instance.recordKpiFailure("InsertOnlineImage",
"InsertMediaException",!1,!0,Object.assign(new Rc.a,{extendedProperties:Ca}))}}}syh(u){this.Ve=u}JYf(u,P,la){if(this.Ve){const Ca=performance.now();this.Ve.Wa("VideosInsertionTimeInMilliseconds",(Ca-la).toString());this.Ve.Wa(u,P.toString());this.Ve.finish();this.Ve=null}}jrg(u){(u=!!u&&!!u.OriginalUrl&&0<u.OriginalUrl.length&&this.la.Rbb&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=u.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&
u.OriginalUrl.toLowerCase().indexOf(".svg")===u.OriginalUrl.length-4)||N.a.J(512517838,352,50,"isInsertSvg = false");return u}b$j(u){return!!u&&!!u.OriginalUrl&&0<u.OriginalUrl.length&&u.OriginalUrl.toLowerCase().indexOf(".mp4")===u.OriginalUrl.length-4}}Object(r.a)(wk,"InsertOnlineImageHelper",zi,[]);var rl=d(735);class Oi{constructor(u,P){this.mfb=!1;this.Hfb=new Date(0);this.Gfb=new Date(0);this.WGe=u;this.wb=P}rgg(){this.mfb=!0}yLa(){this.mfb?N.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):
this.Hfb>this.Gfb?N.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Hfb+". Last scan at "+this.Gfb+"."):(this.Hfb=new Date,this.wb.Hb(new O.a(3,1,0,Object(z.a)(this,this.yZe,"runJob"),90,"112")))}yZe(){this.Gfb=new Date;this.mfb?N.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.WGe()&&this.yLa()}}Object(r.a)(Oi,
"PrefetchScheduler",null,[]);class Qk{constructor(u,P,la){this.m7c=null;this.xGg=P;this.JAg=la;this.kDb=u}vnl(u){this.kDb!==u&&(this.kDb=u,this.m7c=null)}jwj(){this.m7c||(this.m7c=this.czi());return this.m7c}czi(){const u=[];Array.add(u,this.kDb);for(let P=1;P<=this.xGg||P<=this.JAg;P++)P<=this.xGg&&Array.add(u,this.kDb+P),P<=this.JAg&&0<=this.kDb-P&&Array.add(u,this.kDb-P);return u}}Object(r.a)(Qk,"SlideWindow",null,[]);class gk{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){this.fhb=!1;this.lc=Ta;this.qq=Ca;
this.hxa=Cc;this.mDb=new rl.a;this.JA=new Oi(Object(z.a)(this,this.U9e,"tryScan"),pb);this.y4g=new Qk(Ca&&Ca.Ba?Ca.Ba.slideIndex:0,Sb?Sb.DGl:10,Sb?Sb.CGl:5);this.f2e(u,P,la)}start(){this.fhb?N.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(N.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.fhb=!0,this.JA.yLa())}f2e(u,P,la){u&&u.LI(Object(z.a)(this,this.yjd,"onEditSlideChanged"));P&&P.kja(Object(z.a)(this,
this.ukd,"onPageContentLoaded"));la&&la.RQa(Object(z.a)(this,this.xMk,"onSlideshowSlideChanged"))}ukd(u,P){this.fhb&&(u=Object(U.a)(116,P.node))&&u.rE&&(this.mDb.remove(u.Cb),this.JA.yLa())}yjd(u,P){P&&P.$na&&this.aC(P.$na.slideIndex)}xMk(u,P){P&&this.aC(P.slideIndex)}aC(u){this.y4g.vnl(u);this.fhb&&this.JA.yLa()}U9e(){const u=this.Bee();0<u.length&&this.b_e(u[0]);return 1<u.length}Bee(){const u=[];var P=this.qq.presentation;if(!P)throw Error.argumentNull("Presentation is null");P=P.slides||[];for(const la of this.y4g.jwj()){const Ca=
P[la];this.eyl(Ca)&&Array.add(u,Ca)}return u}eyl(u){return!!u&&u.rE&&!u.pO&&!this.mDb.contains(u.Cb)}b_e(u){this.mDb.add(u.Cb);u=this.Vwj(u);0<u.length&&(N.a.J(593773072,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",u.length),this.hxa?this.hxa.zWk(u):N.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}Vwj(u){if(!this.lc)return N.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),
this.JA.rgg(),[];const P=[];if(!u)return P;u=Object(U.a)(116,u);if(!u)return P;for(const la of u.yj())(u=la.xha)&&this.hxa&&this.hxa.Xcb(u)&&Array.add(P,u);return P}static Y4j(u){return!!u&&u.jug&&!yd.a.Yi&&!yd.a.ZFa&&!yd.a.cD&&!yd.a.lse}}Object(r.a)(gk,"StreamVideoPrefetchOrchestrator",null,[]);class Lf{static addAppPLTEventToLog(u){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(u)}catch(P){}}static setIsPageLoadForFirstTime(u){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(u)}catch(P){}}}
Object(r.a)(Lf,"VersionHistoryLogConnector",null,[]);class am{constructor(u,P,la,Ca){this.yY=null;this.Gth=this.ResetAppVersionController;this.Qw=u;this.Hi=P;this.Da=la;this.ic=Ca;this.DZa={}}OnVersionHistorySelected(u,P){try{N.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const la=document.getElementById("VersionHistoryViewerSpinner");la&&(la.style.display="none");if(this.yY)this.yY.onVersionSelected(u,P,this.DZa)}catch(la){N.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
la)}}ResetAppVersionController(u){try{if(this.yY)Lf.setIsPageLoadForFirstTime(!1),this.yY.switchParentViewContainer(u);else{Lf.setIsPageLoadForFirstTime(!0);const P=new PowerPointVersionHistory.AppBootSettings;P.RenderServiceBase="";P.IsRtl=!1;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(z.a)(this.Qw,this.Qw.G1d,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(z.a)(this,this.CreateNotesIcon,"CreateNotesIcon");P.IsHighContrast=!1;
this.Hi&&(P.IsHighContrast=this.Hi.isInHighContrastMode);P.IsHighContrast&&(P.ClientColorSettings=this.Hi.highContrastColors.foregroundTextColor+"_"+this.Hi.highContrastColors.backgroundColor+"_"+this.Hi.highContrastColors.linkColor);if(this.ic){const Ca=this.ic.wUa();P.DefaultSlideWidth=Ca.width;P.DefaultSlideHeight=Ca.height}P.UserSessionId=t.AFrameworkApplication.userSessionId;P.VersionViewerCssUrl=this.Da.versionHistoryViewerCssUrl;P.ProgressImageResourceUrl=lh.a.PN(kg.a.Joa);this.yY=new PowerPointVersionHistory.AppVersionController(P,
u,la)}}catch(P){N.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",P)}}CreateNotesIcon(){return ia.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(r.a)(am,"PPTVersionHistorySelectionHandler",null,[1104]);class jo extends ge{constructor(u){super(u,void 0,t.AFrameworkApplication.ata)}get Vna(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get NCb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Jdc(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get b4b(){return t.AFrameworkApplication.ata?
"UIFontDialogTextLarge":null}XCb(){N.a.J(19743688,801,50,"Download a copy dialog displayed")}Ydc(){N.a.J(19743690,801,50,"Download a copy dialog clicked")}zdb(){N.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(r.a)(jo,"PowerPointDownloadACopyDialog",ge,[]);class Rk{yBl(u){new jo(u)}}Object(r.a)(Rk,"PowerPointDownloadACopyDialogFactory",null,[1063]);var ve=d(134),I;(function(u){u[u.OK=0]="OK";u[u.cancel=1]="cancel";u[u.error=2]="error";u[u.open=3]="open"})(I||(I={}));Object(r.b)("HubbleAction",
I);var V=d(540);const Ba={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class cb{constructor(u){this.Iec=
u}static e2c(){return Date.now()>cb.hwh}getToken(u){return Object(ve.a)(this,void 0,void 0,function*(){return cb.e2c()?yield this.refreshToken(u):cb.eNb})}refreshToken(u){return Object(ve.a)(this,void 0,void 0,function*(){cb.eNb="";if(!this.Iec)return n.ULS.sendTraceTag(508872861,352,50,"Refresh token requested without IOAuthManager."),cb.eNb;try{const P=yield this.Iec.mI("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");P.IsSuccess&&(cb.hwh=P.Telemetry.expiresOn?1E3*(P.Telemetry.expiresOn-
10):0,cb.eNb=P.Token);n.ULS.sendTraceTag(509096264,352,50,`Hubble token requested by: ${"PowerPointInsertMediaDialog"} successful: ${!!cb.eNb} time: ${(new Date).getTime()-u}`)}catch(P){n.ULS.sendTraceTag(509096262,352,10,`Hubble token requested by: ${"showInsertMediaDialog"} successful: false time: ${(new Date).getTime()-u} error: ${P}`)}return cb.eNb})}}cb.hwh=0;cb.eNb="";Object(r.a)(cb,"TokenCache",null,[]);class Nb extends Ue.a{constructor(u,P,la,Ca,Ta){super();this.Ow=null;this.b9c=!1;this.Sgc=
this.ena=this.aY=null;this.BYd="KeepFocusDiv";this.CYd="KeepFocusStartDiv";this.correlationId=null;this.xaa=0;this.insertPictureTelemetryEndpoint=null;this.IQc=0;if(!u)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.JIg=u;this.pR="";this.KJ=la;this.S4=Ca;this.fZa=[];this.hrk=P;this.hg=Ta||Of.hg;this.ig="InsertMediaDialog";this.dhe=!1;this.Ad=5}emb(u,P,la){Object(ve.a)(this,void 0,void 0,function*(){this.pR=u;this.oJa=new cb(la);this.Pl=(new Date).getTime();
yield this.oJa.getToken(this.Pl);this.b9c=!1;this.showDialog(this.pR,null);this.aY=this.SVc(this.Vh("insertmediaframe"));if(!this.aY)throw this.T9a(this.LLc),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Ca=document.getElementById(this.Vh("WACDialogPanel"));Ca&&Ca.setAttribute(Ja.a.hf,Ja.a.FWd);Ca=document.createElement("div");Ca.setAttribute("Id",this.CYd);Ca.setAttribute("tabindex","0");Ca.setAttribute("position","absolute");Ca.setAttribute("width","-1000px");Ca.setAttribute("top",
"-1000px");this.aY.parentNode.insertBefore(Ca,this.aY.parentNode.firstChild);Ca=document.createElement("div");Ca.setAttribute("Id",this.BYd);Ca.setAttribute("tabindex","0");this.aY.parentNode.appendChild(Ca);Ca.setAttribute("position","absolute");Ca.setAttribute("width","-1000px");Ca.setAttribute("top","10000px");$addHandler(this.G4d,"keydown",Object(z.a)(this,this.nA,"keyDownHandler"));this.aY.setAttribute("src",this.JIg);this.aY.setAttribute("width","100%");this.aY.setAttribute("height","100%");
this.aY.setAttribute("frameborder","0");t.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(yd.a.mg||yd.a.Dcc)?(this.aY.style.visibility="hidden",this.Sgc=Object(z.a)(this,this.yIk,"onInsertMediaIframeLoaded"),Le.a.addHandler(this.aY,"load",this.Sgc)):this.aY.style.visibility="visible";this.SVc(this.Vh("WACDialogTitleText")).style.display="none";if(2===this.xaa||5===this.xaa)this.SVc(this.Vh("WACDialogTitlePanel")).style.display="none",this.SVc(this.Vh("WACDialogBodyPanel")).style.padding=
"0";kd.FocusManager.instance().Kl().scope.zJ=!0;Ca=this.JIg;if(t.AFrameworkApplication.fa.ka("GetCustomHeaderEnabled")){const Ta=new URL(Ca),pb=Ba[Ta.protocol+"//"+Ta.host];pb?Ca=pb:n.ULS.sendTraceTag(508937633,352,10,`Target URL: ${Ta.host} not found`)}this.Ow=this.hrk.getInstance(this.aY.contentWindow,Ca);this.Ow.qCa("https://osiziwuspersimmon002.blob.core.windows.net");this.Ow.qCa("https://osizewuspersimmon001.blob.core.windows.net");this.Ow.qCa("https://osizpscuspersimmon000.blob.core.windows.net");
this.Ow.qCa("https://cdn.hubblecontent.msit.osi.office.net");this.Ow.qCa("https://cdn.hubblecontent.osi.office.net");this.Ow.Aya(Qe.a.Azf,Ta=>{this.pEk(Ta,Object(z.a)(P,P.Dua,"insertMediaCallback"))});this.Ow.Aya(Qe.a.insert,Ta=>{this.SNe(Ta,Object(z.a)(P,P.Dua,"insertMediaCallback"))});this.Ow.Aya(Qe.a.Ufi,Ta=>{this.RJk(Ta)});this.Ow.Aya(Qe.a.Xhj,Object(z.a)(this,this.IHk,"onGetCustomHeaders"));this.Ow.Aya(Qe.a.Wuj,Object(z.a)(this,this.UHk,"onGetSessionId"));this.Ow.Aya(Qe.a.Tej,Object(z.a)(this,
this.FHk,"onGetCID"));this.Ow.Aya(Qe.a.mAi,Object(z.a)(this,this.yFk,"onCancelDialog"));2===this.xaa&&0===this.IQc&&(this.Ow.Aya(Qe.a.Yak,Object(z.a)(this,this.WIk,"onLaunchM365Upsell")),this.ena=this.S4.C0a("MsoPremiumStockImages",Ta=>{n.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.Ow.sendMessage(Qe.a.hWl,{["LicenseTier"]:Ta.toString()})}));this.itc(3)})}yIk(){this.aY&&(this.aY.style.visibility="visible",window.setTimeout(()=>{if(this.pi){const u=this.pi.getElementById("insertmediaframe");
u&&u.focus()}},0))}nA(u){u.keyCode===Sys.UI.Key.tab&&(u.target.id!==this.BYd||u.shiftKey?u.target.id===this.CYd&&u.shiftKey&&(u.preventDefault(),this.pi.getElementById(this.BYd).focus()):(u.preventDefault(),this.pi.getElementById(this.CYd).focus()))}dispose(){this.S4&&this.ena&&this.S4.lkb("MsoPremiumStockImages",this.ena);this.Ow&&(this.Ow.dispose(),this.Ow=null);this.Sgc&&(Le.a.removeHandler(this.aY,"load",this.Sgc),this.Sgc=null);super.dispose()}pEk(u,P){n.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");
if(u=this.KJ.Ugh(u))50<this.fZa.length?n.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.fZa,u),this.b9c&&(P(this.fZa),this.b9c=!1))}yFk(){n.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.T9a(this.LLc);this.itc(1)}itc(u){if(2===this.xaa||5===this.xaa){const Ca=t.AFrameworkApplication.fa.Ha("InsertMediaDialogAriaTenantNameSpace");if(Ca&&""!==Ca){var P=[],la="InsertUnknownContent";2===this.xaa?(Array.add(P,Object.assign(new L.a,
{name:"DialogMode",string:"M365Content"})),Array.add(P,Object.assign(new L.a,{name:"Provider",string:"M365Content"})),la="InsertM365Content"):5===this.xaa&&(Array.add(P,Object.assign(new L.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(P,Object.assign(new L.a,{name:"Provider",string:"HubbleVideo"})),la="InsertHubbleVideo");Array.add(P,Object.assign(new L.a,{name:"InsertedFiles",int64:this.fZa.length}));Array.add(P,Object.assign(new L.a,{name:"DialogResult",string:I[u]}));Array.add(P,Object.assign(new L.a,
{name:"CorrelationId",string:this.correlationId.toString()}));B.a.sendTelemetryEvent(Object.assign(new M.a,{name:String.format("{0}.{1}",Ca,la),dataFields:P}))}}}SVc(u){const P=document.getElementById(u);if(!P)throw Error.invalidOperation(String.format("Couldn't get {0}.",u));return P}SNe(u,P){n.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.T9a(this.LLc);P?this.fZa&&0<this.fZa.length?(P(this.fZa),this.itc(0)):(n.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.b9c=
!0,P(this.fZa),this.itc(2)):this.itc(2)}IHk(){return Object(ve.a)(this,void 0,void 0,function*(){if(this.Ow){var u=yield this.oJa.getToken(this.Pl);n.ULS.sendTraceTag(509096025,352,50,`onGetCustomHeaders : Token available: ${!!u} time: ${(new Date).getTime()-this.Pl}`);this.Ow.sendMessage(Qe.a.Pol,{["CustomHeaders"]:u||""})}})}UHk(){this.Ow&&(n.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.Ow.sendMessage(Qe.a.Psl,{["SessionId"]:t.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}FHk(){this.Ow&&
(n.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.Ow.sendMessage(Qe.a.gol,{["CID"]:""}))}RJk(u){u&&u.Values&&(u=u.Values,delete u.m_Origin,delete u.m_Source,delete u.m_ReceivedTime,n.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+u.eventName||!1),B.a.sendOtelEvent(Object.assign(new V.a,{otelEvent:u})))}WIk(){this.S4&&(n.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.S4.launchUpsellExperience("stockimages"))}}
Object(r.a)(Nb,"InsertMediaDialog",Ue.a,[1127,108]);class Ec{getInstance(u,P,la,Ca,Ta){return new Nb(u,P,la,Ca,Ta)}}Object(r.a)(Ec,"PptInsertMediaDialogFactory",null,[1101]);var Oc=d(114);class je{constructor(u){this.Peb=u;this.f2e(this.Peb.Kk,this.Peb.jQg)}f2e(u,P){u&&u.LI(Object(z.a)(this,this.yjd,"onEditSlideChanged"));P&&P.kja(Object(z.a)(this,this.ukd,"onPageContentLoaded"))}V$k(u,P){u&&u.E6(Object(z.a)(this,this.yjd,"onEditSlideChanged"));P&&P.H0a(Object(z.a)(this,this.ukd,"onPageContentLoaded"))}ukd(u,
P){(u=Object(U.a)(116,P.node))&&u.rE&&(this.Peb.mDb.remove(u.Cb),this.Peb.JA.yLa())}yjd(u,P){P&&P.$na&&(this.Peb.xXa=P.$na,this.Peb.JA.yLa(),this.Peb.Hue=new Date)}}Object(r.a)(je,"SlideEventListener",null,[]);class De{constructor(u,P,la){this.p2g="";this.mfb=!1;this.Hfb=new Date(0);this.Gfb=new Date(0);this.WGe=u;this.wb=P;la&&(this.p2g=la)}rgg(){this.mfb=!0}yLa(){this.mfb?N.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):
this.Hfb>this.Gfb?N.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Hfb+". Last scan at "+this.Gfb+"."):(this.Hfb=new Date,this.wb.Hb(new O.a(3,1,0,Object(z.a)(this,this.yZe,"runJob"),90,this.p2g)))}yZe(){this.Gfb=new Date;this.mfb?N.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.WGe()&&this.yLa()}}
Object(r.a)(De,"BackgroundJobScheduler",null,[]);class Pd{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd){this.Zed=null;this.Hue=new Date;this.xXa=null;this.aGg={};this.X2g={};this.I3g={};this.dFg={};if(!la)throw Error.argumentNull("graphTopologyManager");if(!Ca)throw Error.argumentNull("fontUtilsManager");this.qq=la;this.Dz=Ca;this.Kk=u;this.jQg=P;this.kHb=Cc;this.lZa=ed;this.lHb=ad;this.Ped=Zd;this.mDb=new rl.a;this.JA=new De(Object(z.a)(this,this.U9e,"tryScan"),Ta,"");0<pb&&window.setInterval(Object(z.a)(this,
this.yyg,"logMissingFonts"),pb);this.ipk=Sb;u=la.Ba?la.Ba.slideIndex:0;if(P=this.qq.presentation)P=P.slides||[],u<P.length&&(this.xXa=P[u],this.Hue=new Date)}dispose(){this.stop();this.yyg()}start(){this.stop();this.Zed=new je(this);this.JA.yLa()}stop(){this.Zed&&this.Zed.V$k(this.Kk,this.jQg);this.Zed=null}Bee(){const u=[];this.xXa&&u.push(this.xXa);return u}U9e(){const u=this.Bee();0<u.length&&(this.b_e(u[0]),this.mDb.add(u[0].Cb));return 1<u.length}Lte(u,P,la,Ca){const Ta=[];for(const pb of Object.keys(u))u[pb]||
this.dFg[pb]||(Ta.push(pb),this.dFg[pb]=!0);u=Ta.length;0<u&&(N.a.J(la,820,15,"{0}",u),P&&N.a.J(Ca,820,15,"{0}",Ta.join(",")))}b_e(u){const P=u.AUa();if(P&&(this.kHb||this.lHb||this.lZa||Gd.a("ShouldLogMissingThirdPartyFontCount"))){var la={},Ca={},Ta={};u.U2f.split(",").forEach(ad=>{ad&&(ad=this.Dz.rG(ad),la[ad]=!1)});u.dLh.split(",").forEach(ad=>{ad&&(ad=this.Dz.rG(ad),Ca[ad]=!1)});u.MOh.split(",").forEach(ad=>{ad&&(ad=this.Dz.rG(ad),Ta[ad]=!1)});u=[];var pb=[],Sb=[];for(let ad=0;ad<P.length;ad++){var Cc=
P[ad];Cc=Array.isArray(Cc.vy())?Cc.vy():null;for(const Zd of Cc)for(Cc=0;Zd.Sa&&Cc<Zd.Sa.length;){var ed=Zd.Sa.ga(Cc);ed=ed.formatting?this.Dz.rG(Oc.Font.OEa(ed.formatting.cache.BL.trim().toLowerCase())):"";Gb.a.Xa(ed)||(ed in la&&!la[ed]?(u.push(ed),la[ed]=!0):ed in Ca&&!Ca[ed]?(pb.push(ed),Ca[ed]=!0):ed in la||ed in Ca||Ta[ed]||(Sb.push(ed),Ta[ed]=!0));Cc++}}this.kHb&&(Pd.Fje(this.aGg,u,this.Dz),this.Lte(la,!0,555886295,555886296));if(this.lZa||Gd.a("ShouldLogMissingThirdPartyFontCount"))Pd.Fje(this.X2g,
pb,this.Dz),this.Lte(Ca,this.lZa||this.Ped,555886297,555886298);this.lHb&&(Pd.Fje(this.I3g,Sb,this.Dz),this.Lte(Ta,this.Ped,555886299,555886300))}}yyg(){+new Date-+this.Hue<this.ipk||(this.kHb&&Pd.Xte(this.aGg,this.Dz,591003669,!0,"MissingFirstPartyFonts"),(this.lZa||Gd.a("ShouldLogMissingThirdPartyFontCount"))&&Pd.Xte(this.X2g,this.Dz,591003667,this.lZa||this.Ped,"MissingThirdPartyFonts"),this.lHb&&Pd.Xte(this.I3g,this.Dz,587337796,this.Ped,"MissingNonLoggableFonts"))}static Fje(u,P,la){P.forEach(Ca=>
{Gd.a("ShouldNormalizeFontNamesBeforeLogging")&&(Ca=la.rG(Ca));if(void 0===u[Ca]||null===u[Ca])u[Ca]=!1})}static Noj(u,P){if(!u)throw Error.argumentNull("fonts");const la=[];for(const Ca of Object.keys(u))u[Ca]||(P.G9(Ca)||P.G9('"'+Ca+'"')||la.push(Ca),u[Ca]=!0);return la}static Xte(u,P,la,Ca,Ta){P=Pd.Noj(u,P);u=P.length;0<u&&(P=P.join(","),Ca&&587337796===la?N.a.J(la,820,15,"{0}",P):N.a.J(la,820,15,"{0}",Ca?P:u.toString()),la=new Map,Ca&&la.set("Fonts",P),la.set("FontsCount",u.toString()),eg.Health.instance.recordQosError(Ta,
["MissingFont"],!1,!1,!0,!1,Object.assign(new Rc.a,{extendedProperties:la})))}}Object(r.a)(Pd,"FontLogger",null,[108]);var Ke=d(995),xg=d(1001),Gg=d(202);class ph{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg,$i){this.YHa=!1;this.ena=null;this.ZBl=(jk,fj,Mk)=>{var Tk;fj=this.ua.Ba;if(!fj||this.fc.fd(fj))return 16;if(1===Mk)return 32;N.a.J(508941190,846,50,"InsertVideoActor::InsertStockVideos Initiated");this.Ve=cj.a.Jj("StockVideos::Insert");Mk=new Aa.QueryStringBuilder(this.Da.$je);
Mk.iy("initpivot","stockvideos");Mk.xg("entryPoint",wb.a.uy(jk));Mk.xg("sv","1");Gd.a("AddDalleTabToStockVideoDialog")&&this.KJ.sei(this.Da,Mk);const Uk=new wk(this.ia,this.KJ,this.Da);Uk.Ax=wb.a.Ubb;null===(Tk=this.Ve)||void 0===Tk?void 0:Tk.Wa("StockVideoInitiatedByRibbon","true");Uk.syh(this.Ve);const uh=Mk.toString();if(!uh||!uh.length)return 16;try{const Ri=bi.a.create(),Tj=Gb.a.nL(this.Da.pptEditingUserId).toString();this.Tea.execute(Km=>{var kk=this.Da.Hmg&&Km.isFreemiumUpsellEnabled();kk=
this.YHa?1:kk?0:-1;var Vk=this.Da.ka("InsertOnlineM365ExperimentEnabled")?1:0;Vk=this.KJ.pHf(Gg.App.mode,uh,kk,1,Ri.toString(),Tj,Vk);Km=this.NEb.getInstance(Vk,this.MEb,this.KJ,Km,nj.hg);Km.correlationId=Ri;Km.xaa=2;Km.IQc=kk;Km.emb(CommonUIStrings.L_VideoInsertTitle,Uk,void 0);this.Ve&&this.Ve.Wa("StockVideoDialogInitialized","true");N.a.J(509100040,846,50,"InsertVideoActor::showStockVideosDialog : Show dialog success.")});return 32}catch(Ri){N.a.J(509100039,846,10,"InsertVideoActor::showStockVideosDialog : Exception = [{0}]",
Ri.toString())}return 8};this.eUj=(jk,fj,Mk,Tk,Uk)=>{jk=this.ua.Ba;if(!jk||this.fc.fd(jk))return 16;if(1===Mk)return 32;if(!this.kj.hD(jk,1))return this.kj.KD(jk),16;if(!Uk||!Uk.OriginalUrl)return 16;try{const uh=jk.R_(this.jb.Ud());if(uh&&this.fc.fd(uh))return 16;const Ri=this.aYc(jk,uh),Tj=this.Fb.yd(15,void 0,()=>{this.jb.iu();this.jb.nh();this.Fa.Bd()},()=>{this.jb.selectShape(Ri,!0)});try{Tj.jc(jk);Tj.gd=wb.a.Ubb;Tj.ry[mf.a.pka]=mf.a.online;N.a.J(509100038,846,50,"InsertVideoActor::UploadStockVideo");
Ri.setValue(Bb.a.gsa,Uk.LicenseUrl?null:Uk.Caption);Ri.TRb=Uk.Caption;Ri.setValue(Bb.a.mediaType,2);Ri.setValue(Bb.a.Pp,!0);Ri.setValue(Bb.a.iMa,!0);Ri.setValue(Bb.a.xha,Uk.OriginalUrl);Ri.setValue(Bb.a.yO,!0);const Km=String.format("{0}{1}","video",bi.a.create().toString());Ri.URb=Km;uh&&jk.cS([uh]);jk.oB(Ri)}finally{Tj&&Tj.dispose()}this.Rq.oA=Ri;return 32}catch(uh){return N.a.J(509100037,846,10,"InsertVideoActor:: Error while creating video shape node : Exception = [{0}].",uh.toString()),8}};this.kba=
(jk,fj)=>{var Mk;this.Ve&&(this.Ve.Wa("MediaFileValidationPassedOnUI","false"),this.Ve.Wa("ErrorMessage",null===(Mk=fj.Message)||void 0===Mk?void 0:Mk.toString()),this.Ve.finish(),this.Ve=null);jk=fj.ExtraErrorParam?String.format(fj.Message,fj.ExtraErrorParam):fj.Message;fj=Object.assign(new xg.a,{title:fj.Title,message:jk,timeoutInSeconds:120});this.CH.kEh(fj)};if(!u)throw Error.argumentNull("applicationSettings");if(!P)throw Error.argumentNull("actionManager");if(!la)throw Error.argumentNull("graphTopologyManager");
if(!Ca)throw Error.argumentNull("graphActionBlockingManager");if(!Ta)throw Error.argumentNull("pptSelectionManager");if(!pb)throw Error.argumentNull("ribbonChangeManager");if(!Sb)throw Error.argumentNull("transactionFactory");if(!Cc)throw Error.argumentNull("shapeEditor");if(!ed)throw Error.argumentNull("errorHandler");if(!ad)throw Error.argumentNull("focusManager");if(!Zd)throw Error.argumentNull("sessionInfo");if(!We)throw Error.argumentNull("mediaUploaderFactory");if(!Qf)throw Error.argumentNull("calloutNotificationAdapter");
if(null===u||void 0===u?0:u.Vbb){if(!Af)throw Error.argumentNull("appFeatureHelper");if(!Ph)throw Error.argumentNull("insertMediaHelper");if(!He)throw Error.argumentNull("insertMediaCrossDocumentMessengerFactory");if(!pf)throw Error.argumentNull("insertMediaDialogFactory");if(!Yf)throw Error.argumentNull("shapeCountValidator");if(!Rg)throw Error.argumentNull("pageView");if(!$i)throw Error.argumentNull("presReader");}this.Da=u;this.ia=P;this.ua=la;this.fc=Ca;this.jb=Ta;this.Rq=pb;this.Fb=Sb;this.wk=
Cc;this.Vd=ed;this.Fa=ad;this.nq=la.presentation;this.Ie=Zd;this.Qfb=We;this.CH=Qf;this.Tea=Af;this.KJ=Ph;this.MEb=He;this.NEb=pf;this.kj=Yf;this.Eb=Rg;this.Sb=$i;Ke.a.sXl=this.Da.NSh;Ke.a.nYl=this.Da.pYl;(null===u||void 0===u?0:u.Vbb)&&this.xCi()}vb(){this.ia.ra(wb.a.hPb,Uf.a.application,this.gKj.bind(this),4);this.ia.ra(wb.a.Pmg,Uf.a.application,this.ZBl,4);this.ia.ra(wb.a.Ubb,Uf.a.application,this.eUj,4);Gd.a("EnableCalloutNotificationsForVideos")&&pl.b(this.kba)}me(){}gKj(u,P,la){const Ca=this.ua.Ba;
if(!Ca||this.fc.fd(Ca))return 16;if(1===la)return 32;this.Ve=cj.a.Jj("Video::Insert");try{return N.a.J(509650205,846,50,"InsertLocalVideo: flow initiated"),Zk.a.t4e(this.Da.NSh.toString(),pl.e,()=>pl.d(u,this.pUj.bind(this),"video",this.Ie,Ca),"video",Ca,this.ua.presentation,this.fc,this.Vd,this.Ve,!0,this.Qfb,this.Da.dyc,this.Da.cyc,this.Da.byc),this.Ve&&this.Ve.Wa("VideoDialogInitialized","true"),32}catch(Ta){N.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Ta)}pl.a("video")?
pl.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}dispose(){this.Tea.instance&&this.ena&&this.Tea.instance.lkb("MsoPremiumStockImages",this.ena)}showErrorMessage(u,P){this.Ve&&(this.Ve.finish(),this.Ve=null);this.Vd.rH(u,la=>{la.JC=1;la.jTa=P;return!1})}pUj(u,P,la,Ca,Ta,pb,Sb){Ca.qO(la)&&N.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-
+la.Pja);Ca.zK(Sb);la=Sb.Cs();var Cc=this.nq.slideHeight;Ca=this.nq.slideWidth/2-Tc.a.gf(kg.a.UR/2,0);Cc=Cc/2-Tc.a.gf(kg.a.UR/2,1);if(Sb&&Sb.isConnected){var ed=this.Fb.yd(15,void 0,void 0,()=>{this.Rq.oA=this.YHb;this.jb.selectShape(this.YHb,!0);this.Fa.Bd()});try{ed.jc(Sb);ed.gd=u;Ta&&Ta.Wa("CreatingVideoShape","true");this.YHb=this.wk.BDa(!1,Sb.Cb.cid,Sb.Cb.sid,0,10,Ca,Cc,kg.a.UR,kg.a.BY,la+1);const ad=pb.files[0].name;this.YHb.URb=P;this.YHb.TRb=ad;Gd.a("SetMediaTypeAsVideoForEmbeddedVideo")&&
this.YHb.setValue(Bb.a.mediaType,2);Sb.oB(this.YHb)}finally{ed&&ed.dispose()}Ta&&(Ta.Wa("VideoShapeSuccessfullyCreated","true"),Ta.finish(),Ta=null)}}xCi(){this.Tea.execute(u=>{u.isFeatureEnabled("MsoPremiumStockImages",!1).catch(P=>N.a.J(509100036,846,10,"InsertVideoActor::Constructor - Failed to load the premium state from application feature helper: {0}",P)).then(P=>{this.YHa=P;this.YHa||(this.ena=u.C0a("MsoPremiumStockImages",()=>{this.YHa=!0;N.a.J(509100035,846,50,"InsertVideoActor:: setting isUserLicensed=1")}));
return null})})}aYc(u,P){if(!u)return null;var la=u.Cb;u=u.Cs();const Ca=this.Sb.Uka(kg.a.UR,kg.a.BY);la=this.wk.Xja(!0,la.cid,la.sid,0,Ca.x,Ca.y,kg.a.UR,kg.a.BY,u+1,!0);P&&(la.B8=P.id);return la}}Object(r.a)(ph,"InsertVideoActor",null,[268]);class qg{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){if(!u)throw Error.argumentNull("transactionHelper");if(!P)throw Error.argumentNull("actionManager");if(!Ca)throw Error.argumentNull("graphTopologyManager");if(!Ca.presentation)throw Error.argumentNull("graphTopologyManager.presentation");
if(!la)throw Error.argumentNull("graphActionBlockingManager");if(!Ta)throw Error.argumentNull("ribbonChangeManager");if(!pb)throw Error.argumentNull("shapeEditor");if(!Sb)throw Error.argumentNull("shapeCountValidator");if(!Cc)throw Error.argumentNull("appSettingsManager");this.sr=u;this.ia=P;this.ua=Ca;this.fc=la;this.Rq=Ta;this.nq=Ca.presentation;this.wk=pb;this.kj=Sb;this.Ib=Cc}vb(){this.Ib.ka("EnableCameoInEditor")&&this.ia.ra(wb.a.Emg,Uf.a.application,this.AFj.bind(this),4)}me(){}AFj(u,P,la){P=
this.ua.Ba;if(!P)return 16;if(T.a.Fw(P.Cb))return 8;if(this.fc.fd(P))return 16;if(1===la)return 32;if(!this.kj.hD(P,1))return this.kj.KD(P),16;var Ca=Math.min(Math.min(this.nq.kGh,this.nq.XFh),100);la=P.Cs();var Ta=this.nq.slideWidth,pb=this.nq.slideHeight;const Sb=Tc.a.gf(Ca,0);Ca=Tc.a.gf(Ca,1);Ta=Ta/2-Tc.a.gf(50,0);pb=pb/2-Tc.a.gf(50,1);la=this.wk.BDa(!1,P.Cb.cid,P.Cb.sid,0,10,Ta,pb,Sb,Ca,la+1);la.Wua=!0;this.sr.HT([la],P,u);this.Rq.oA=la;return 32}}Object(r.a)(qg,"InsertCameoActor",null,[268]);
class th{constructor(){this.baa=this.jh=this.G5=this.K=null;this.sPg=[];this.Ffc=[new fk];this.kY=[]}get name(){return"PowerPointWebEditor.Chronos2"}Xb(u){this.K=u;this.G5=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.jh=this.G5.WEa(5,this.name);this.baa=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Ta=0;Ta<this.Ffc.length;++Ta)Array.add(this.kY,uc.a(this.Ffc[Ta],5));for(const Ta of this.kY)Ta.Xb(u);const P=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
la=t.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),Ca=Kh.a.Ot(this.K.Ia("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Object(Gd.a)("EnhancementOfSDXPaneBootTime")||this.K.register(km.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").oa(()=>new km.a(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),
this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).na();this.K.register(am,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").na().oa(()=>new am(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Rj,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").na().oa(()=>
new Rj(u.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new Pa.a(()=>Ca.result),u.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(Gj,"Box4.Media.InsertOneDriveFileHelper").na().oa(()=>new Gj(t.AFrameworkApplication.Qa));this.K.register(ye,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").na().oa(()=>new ye);this.K.register(wk,"PowerPointWebEditor.InsertOnlineImageHelper").na().oa(()=>new wk(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(jn,"PowerPointWebEditor.ChangeOnlineImageHelper").na().oa(()=>new jn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Bg,"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").na().oa(()=>new Bg(new Nf(new Pa.a(()=>
{if(t.AFrameworkApplication.$Dh()){var Ta=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").l$a;Ta=new Ni(Ta.contentWindow,"*")}else Ta=P.Klj();return Ta}),la?Cd.a.KQ(window.document.URL):Cd.a.KQ(t.AFrameworkApplication.Foa),t.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(Qj,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").na();this.K.register(Xk,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").na().oa(()=>
new Xk);this.K.register(Ec,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").na();this.K.register(1063,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").na().oa(()=>new Rk);this.K.register(gk,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").na().oa(()=>new gk(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").zd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let u=this.jh.du("resolvechronos2");const P=this.K.resolve("Common.AFrameworkApplication"),la=this.K.resolve("PowerPointWebEditor.IApplicationContext"),Ca=la.rd,Ta=P.To,pb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),
Sb=this.K.resolve("Common.IActionManagerExtended"),Cc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var ed=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const ad=this.K.resolve("PowerPointWebEditor.IFocusManager"),Zd=Ta.Ld,We=this.K.resolve("Common.Transaction.ITransactionFactory"),Qf=this.K.resolve("PowerPointWebEditor.IShapeEditor"),Af=this.K.ue("PowerPointWebEditor.IClassFactory"),Ph=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),pf=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
He=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Yf=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Rg=this.K.resolve("PowerPointWebEditor.IPresentationReader"),$i=Ta.Zib,jk=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),fj=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),Mk=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),Tk=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Uk=this.K.resolve("PowerPointWebEditor.IShapeReader"),
uh=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.jh.lu(u);u=this.jh.du("regactorschronos2");ed=[...(Object(Gd.a)("EnhancementOfSDXPaneBootTime")?[]:[new Cl.a(Ca,this.K.resolve("Common.IAppSettingsManager"),ed,Sb,Zd,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),We,Af,Cc,this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),pf,He,Yf)]),new Bl(Ca,Sb,Cc,this.K.Ia("PowerPointWebEditor.IAddinCommandsManager")),new dj(Ca,Sb,He,Ph,ad,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
We,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),Rg,Qf,Uk,uh,Tk,Yf,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new Sf(Sb,this.K.resolve("PowerPointWebEditor.ISlidePane"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),He,Ph,Tk,this.K.resolve("Common.Transaction.ITransactionFactory"),Qf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ad,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new qg(ed,Sb,He,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Tk,Qf,Yf,this.K.resolve("Common.IAppSettingsManager")),new ph(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
Sb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),He,Ph,Tk,this.K.resolve("Common.Transaction.ITransactionFactory"),Qf,this.K.resolve("PowerPointWebEditor.IErrorHandler"),ad,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),
this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))];for(const Ri of ed)Ri.vb(),Ri.me();Cc.Dyf=!0;this.jh.lu(u);t.AFrameworkApplication.fa.$e(()=>{u=this.jh.du("regfullactorschronos2");const Ri=[new Dl(Sb,He,ad,Ph,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").Gf,jk,la.tUa().p6j,fj,this.K.resolve("PowerPointWeb.IPrinter"),
this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),Mk,pb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),P.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>t.AFrameworkApplication.XE,la.Obe(),Tj=>t.AFrameworkApplication.Aa.mb.K2e(Tj),
()=>t.AFrameworkApplication.fdc,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new Ek(Ta,Ca.baj,$i.embedPreviewUrl,Sb,Rg,la.Obe(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const Tj of Ri)Tj.vb(),Tj.me();this.jh.lu(u)});N.a.J(512360593,809,50,"Chronos2Package::Init");for(const Ri of this.kY)this.jh.du(Ri.name),Ri.init(),this.jh.lu(Ri.name);
u=this.jh.du("al");this.sRj();this.jh.lu(u);t.AFrameworkApplication.fa.$e(()=>{if(Ca.powerPointIdeasIsEnabled){u=this.jh.du("idea");var Ri=this.$Rj();this.ZRj(Ri);this.jh.lu(u)}Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1)&&(u=this.jh.du("fastcards"),this.GRj(),this.jh.lu(u));Ca.powerPointSmartLookupIsEnabled&&(u=this.jh.du("smartLookup"),this.OSj(),this.jh.lu(u));t.AFrameworkApplication.G4c()&&(u=this.jh.du("versionhistory"),this.dTj(),this.jh.lu(u));gk.Y4j(Ca)&&Db.a.get_instance().Vj(7,
()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const Tj=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(Tj&&(Tj.dDh||Tj.cDh||Tj.eDh)){const Km=!Gb.a.Xa(t.AFrameworkApplication.fa.Ha("TenantId"))&&Array.contains(Tj.LJl,t.AFrameworkApplication.fa.Ha("TenantId"));this.K.register(Pd,"PowerPointWebEditor.Text.FontLogger").na().oa(()=>new Pd(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").zd(8),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),Tj.BAk,Tj.AAk,Tj.dDh,Tj.cDh&&t.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),Tj.eDh,Tj.I0i&&Km));Ri=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.sPg.push(Ri);Ri.start()}});t.AFrameworkApplication.cta||(u=this.jh.du("appforoffice"),this.pRj(),this.jh.lu(u));Ca.gGh&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").xte()}dispose(){for(const u of this.kY)u.dispose();
for(const u of this.sPg)try{u&&u.dispose()}catch(P){N.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",P.message,P.stack)}}sRj(){N.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const u=bc.a.create("pptedit.augloop",null,()=>d.e(8).then(d.bind(null,1298)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const P=this.K.resolve("Common.ISharedDependencyLoader"),la=t.AFrameworkApplication.Ji("augloop-runtime-shim-ie",
2);P.TCb(la).continueWith(()=>{Mc.a.py(u)})}else Mc.a.py(u)}catch(u){N.a.J(512360590,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",u.message,u.stack)}}$Rj(){N.a.J(512360588,809,50,"Start to download infrared.hermes.js file");var u=[this.baa.Pvb(t.AFrameworkApplication.Ji("ir-plugin-ski.min.js",5))];u=bc.a.create("pptedit.infrared",u,()=>d.e(14).then(d.bind(null,1304)));Mc.a.py(u);return u}ZRj(u){N.a.J(512360587,809,50,"Start to download ideas.hermes.js file");
u=this.baa.B2d(t.AFrameworkApplication.Ji("microsoft.ideas.runtime.js",5),[u],!1);u=bc.a.create("pptedit.ideas",[u],()=>d.e(15).then(d.bind(null,1305)));Mc.a.py(u)}GRj(){N.a.J(508958302,809,50,"Start to download fastcards.hermes.js file");const u=bc.a.create("pptedit.fastcards",null,()=>d.e(11).then(d.bind(null,1307)));Mc.a.py(u)}OSj(){N.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");const u=bc.a.create("pptedit.smartlookup",null,()=>d.e(13).then(d.bind(null,1301)));Mc.a.py(u)}dTj(){var u=
t.AFrameworkApplication.Ji("pptVersionHistory.js",5);u=this.baa.Pvb(u);try{Mc.a.py(u)}catch(P){N.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",P.toString())}}pRj(){const u=this.K.resolve("PowerPointWebEditor.IApplicationSettings");w.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").ahe()?th.kje():u.yg?t.AFrameworkApplication.fa.$e(th.zlg):Db.a.get_instance().Vj(8,()=>{th.zlg()})}static main(){t.AFrameworkApplication.Yg&&
yd.a.mg?N.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):m.a.instance.Ac(uc.a(new th,5))}static kje(){w.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").Fja();m.a.instance.Ac(new If)}static zlg(){let u=!1;try{window.self.requestIdleCallback(th.kje)}catch(P){u=!0}u&&window.setTimeout(th.kje,0)}}Object(r.a)(th,"Chronos2Package",null,[2,3]);var ci=d(193),Hf;(function(u){u[u.unsupported=0]="unsupported";u[u.designer=1]="designer";u[u.blank=
2]="blank"})(Hf||(Hf={}));Object(r.b)("AgendaSlideThemeType",Hf);var Xh=d(115);class bm{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(r.a)(bm,"AgendaApplyInfo",null,[]);class Qn{constructor(){this.DeckSuggestionId=this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(r.a)(Qn,"AgendaThemeApplyInfo",null,[]);class Sm{constructor(u,P){this.S7d=!1;this.dSe=[];this.tTf=u;this.r5i=P}}Object(r.a)(Sm,"DeckOptionInformation",null,[]);class lg{constructor(){this.y3g=
this.z3g=0;this.CCg=[]}get pyd(){return this.z3g}set pyd(u){this.z3g=u}get oyd(){return this.y3g}set oyd(u){this.y3g=u}get n9a(){return this.CCg}set n9a(u){this.CCg=u}Eih(u,P,la){const Ca=new H.a;if(u)for(let Ta=0;Ta<la-1&&Ta<u.length;Ta++)Ca.add(new Sm(u[Ta],!1));Gb.a.Xa(P)||Ca.add(new Sm(P,!0));this.n9a=Ca.toArray()}}Object(r.a)(lg,"AgendaDeckSessionInformation",null,[]);class Cm{constructor(){this.qec=this.rec=this.Uzg=0;this.YGe=this.N6c=this.WEe=this.rcd=null}Enl(u){u&&(this.Uzg=u.body.slideIndex)}srl(u){u.body&&
u.body.outlineRequestContent&&(this.rcd=JSON.stringify(u.body.outlineRequestContent))}Anl(u){u.body&&(this.qec=u.body.slideCId)}Dnl(u){u.body&&(this.rec=u.body.slideSId)}Bnl(u){this.N6c=u.id}aWj(u){return u===this.N6c?(this.N6c=this.rcd=null,!0):!1}x9j(){return!Gb.a.Xa(this.rcd)&&!Gb.a.Xa(this.N6c)}hrl(u){u.body&&u.body.outlineRequestContent&&u.body.outlineRequestContent.Slides&&(this.WEe=u.body.outlineRequestContent.Slides.length)}Cnl(u){this.YGe=u.body.score}}Object(r.a)(Cm,"AgendaDetection",null,
[]);var Eg=d(1081);class qe{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We){this.vva=this.JB=null;this.S6c=0;this.D0=null;this.eHb="";this.$8c=!1;this.ima=0;this.b$=new H.a;this.bJg=!1;this.ei=u;this.Sb=P;this.ua=la;this.fc=Ca;this.Da=Ta;this.Pq=pb;this.xe=Cc;this.jb=ed;this.Iw=ad;this.Dgb=Zd;this.Ib=We;this.Iw.WGk(this.Da)}gMh(){this.aBh();this.zMi();this.kxb()?(this.D0=new lg,this.D0.pyd=this.HL(),this.VMl()):1!==this.ima||this.Da.URc?2===this.ima&&this.Da.TRc&&(this.D0=new lg,this.D0.pyd=this.HL(),
this.DNl()):this.CNl()}zMi(){this.vva=bi.a.create().toString();this.Iw.yel(this.vva);this.Iw.qEk()}Z8e(u,P){if(this.JB){if(!this.JB.rec||!this.JB.qec){var la=this.Sb.zx(this.JB.Uzg);this.JB.rec=la.Cb.sid;this.JB.qec=la.Cb.cid}la=this.Sb.zx(0);this.ei.generateAgendaSuggestion(la.Cb.cid,la.Cb.sid,this.vva,this.JB.rcd,this.Rbj(),u,P)}else P(null)}CNl(){this.Z8e(Object(z.a)(this,this.TJk,"onPODSTriggerAgendaConversionSuccessV1"),Object(z.a)(this,this.nch,"onPODSTriggerAgendaConversionFailureV1"));this.fc.blockContent(this.ua.presentation,
"ApplyAgenda",!0)}DNl(){for(let u of this.b$)u&&u.$Ml();this.Z8e(Object(z.a)(this,this.UJk,"onPODSTriggerAgendaConversionSuccessV2"),Object(z.a)(this,this.SJk,"onPODSTriggerAgendaConversionFailureV2"))}VMl(){this.Z8e(Object(z.a)(this,this.VJk,"onPODSTriggerAgendaConversionSuccessV3"),Object(z.a)(this,this.och,"onPODSTriggerAgendaConversionFailureV3"));this.fc.blockContent(this.ua.presentation,"ApplyAgenda",!0)}Cib(u,P){if(P.property===Bb.a.Q_a&&this.S6c){u=Object(U.a)(347,P.node);if(u.Q_a===qe.kUh)for(let la of this.b$)la&&
la.NEk();else if(u.Q_a===qe.lUh){for(let la of this.b$)la&&la.Z9g();this.$8c=!0}this.Dgb.Qm(Object(z.a)(this,this.Cib,"onPresentationPropertyChange"));this.S6c=0}}Rbj(){const u={};this.Da.TRc&&2===this.ima&&(u.shouldGenerateThemes="true",u.themeCount="3");this.kxb()&&(u.shouldNotConvertToGVMLBytes="true",u.shouldInsertBlankSlides="true");return Xh.c(u)}Hbj(u){const P={};P.SlideCount=this.rj().toString();P.isBlankThemeRequest=(this.D0.n9a[u].r5i&&!this.kxb()).toString();P.isRequestForDeckDesignerForNonBlankSlides=
this.kxb();return Xh.c(P)}kxb(){return this.Da.URc&&(1===this.ima||0===this.ima)}UMl(){this.jb.nh();const u=this.ua.presentation;if(u){const P=this.Pq.ke(15);try{P.jc(u),P.gd=wb.a.w0b,u.itb=Object.assign(new bm,{CorrelationId:this.vva,AgendaSlideSid:this.JB.rec,AgendaSlideCid:this.JB.qec})}finally{P&&P.dispose()}this.fc.uw(u,wb.a.w0b);this.fc.zK(u)}else this.Vid()}hMh(u){this.jb.nh();this.Iw.xpi(this.Mae(u));const P=this.ua.presentation;if(P){const la=this.Pq.ke(15);try{la.jc(P),la.gd=wb.a.w0b,P.Q_a=
qe.jUh,this.S6c=this.HL(),this.Dgb.gk(Object(z.a)(this,this.Cib,"onPresentationPropertyChange")),P.jtb=Object.assign(new Qn,{DeckSuggestionId:this.Mae(u),AgendaSessionId:this.vva,CorrelationId:bi.a.create().toString()})}finally{la&&la.dispose()}this.fc.uw(P,wb.a.w0b);this.fc.zK(P)}else this.Vid()}Vid(){for(let u of this.b$)u&&u.MEk();this.fc.zK(this.ua.presentation)}TJk(){this.UMl();this.$8c=!0;for(let u of this.b$)u&&u.Z9g()}UJk(u){this.D0.oyd=this.HL();const P=this.b9f(),la=new H.a;if(u.Images)for(const Ca of u.Images)la.add("data:image/jpg;base64, "+
Ca);la.add(P);Gb.a.Xa(u.BlankSuggestionId)&&(u.BlankSuggestionId=bi.a.create().toString());this.D0.Eih(u.DeckSuggestionId,u.BlankSuggestionId,qe.acf);for(let Ca of this.b$)Ca&&Ca.PEk(la.toArray());this.b9e(0)}VJk(){this.D0.oyd=this.HL();this.D0.Eih(null,bi.a.create().toString(),qe.acf);this.b9e(0)}b9e(u){this.kxb()?this.mMh(u,Object(z.a)(this,this.XJk,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(z.a)(this,this.och,"onPODSTriggerAgendaConversionFailureV3")):this.mMh(u,Object(z.a)(this,
this.WJk,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(z.a)(this,this.pch,"onPODSTriggerAgendaDeckSuggestionFailure"))}mMh(u,P,la){if(this.D0.oyd<this.D0.pyd)this.gMh();else if(this.Iw.bNk(u),this.eHb=this.Mae(u),this.S5i(this.D0.n9a[u])){var Ca=bi.a.create().toString();this.ei.generateAgendaDeckSuggestion(this.JB.qec,this.JB.rec,Ca,this.vva,this.eHb,this.Hbj(u),P,la);N.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",
Ca,this.eHb)}else this.E8g(this.D0.n9a[u].dSe,this.eHb),this.Iw.V9g(u,!0)}WJk(u){if(u.Images&&u.Images.length){var P=new H.a;for(var la of u.Images)P.add("data:image/jpg;base64, "+la);this.E8g(P.toArray(),u.DeckSuggestionId);if(la=({themeIndex:u}=this.$7f(u.DeckSuggestionId)).returnValue)la.dSe=P.toArray(),la.S7d=!0;this.Iw.V9g(u,!1)}else this.pch(u)}XJk(u){u.Images&&u.Images.length?this.hMh(0):this.Vid()}E8g(u,P){for(let la of this.b$)la&&P===this.eHb&&la.IEk(u)}pch(u){try{let P;const la=({themeIndex:P}=
this.$7f(u.DeckSuggestionId)).returnValue;la&&(la.S7d=!1,la.dSe=[]);this.Iw.HEk(P);if(this.eHb!==u.DeckSuggestionId)return!0}catch(P){N.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+P.message)}for(let P of this.b$)P&&P.Y9g();return!0}nch(){this.Vid();return!0}och(u){return this.nch(u)}SJk(){const u=this.b9f(),P=new H.a;P.add(u);for(let la of this.b$)la&&(la.OEk(P.toArray()),la.Y9g());return!0}b9f(){const u=this.Sb.zx(0);return this.xe.XF(u.Cb).image.src}SQ(u,P){try{this.JB||
(this.JB=new Cm);let la=!1;P?this.JB.aWj(u.id)&&(this.xzh(!1,this.ima),la=!0):(this.JB.Enl(u),this.JB.srl(u),this.JB.Anl(u),this.JB.Dnl(u),this.JB.Bnl(u),this.JB.Cnl(u),this.aBh(),this.JB.x9j()&&(this.xzh(!0,this.ima),this.JB.hrl(u)));if(!(0>=this.b$.count))for(let Ca of this.b$)try{Ca&&(la?window.setTimeout(()=>{Ca.D8g()},100):Ca.D8g())}catch(Ta){N.a.J(512496857,813,10,"Exception message: "+Ta.message)}}catch(la){N.a.J(512496856,813,10,"Exception message: "+la.message)}}X6k(u){u&&this.b$.add(u)}MQl(u){this.b$.remove(u)}xzh(u,
P){this.bJg=this.Da.URc?u:u&&0!==P}q$f(){return this.bJg&&!this.$8c}XOe(u){this.$8c=!u}rj(){return this.ua.presentation.Gpa+this.JB.WEe}aBh(){this.ima=this.Kyj();this.Iw.Kel(Hf[this.ima]);this.qel()}qel(){this.kxb()?this.Iw.bYe("V3"):1!==this.ima||this.Da.URc?2===this.ima&&this.Da.TRc&&this.Iw.bYe("V2"):this.Iw.bYe("V1")}Kyj(){try{const u=this.Sb.bJ();if(u&&0<u.length)for(const P of u)if(P){const la=P.ThemeFamilyId;if(this.Da.TRc&&la.toLowerCase()===qe.vUh.toLowerCase())return 2;if(0<=Array.indexOf(this.Da.gni,
la)||Object(Gd.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Ib.ka("DisableAgendaToPPTForUnsupportedTheme")&&void 0===Eg.a.Dza.find(Ca=>Ca.iTc===la))return 1}return 0}catch(u){return N.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+u.message),0}}Mae(u){return this.D0.n9a[u].tTf}$7f(u){let P;P=0;for(const la of this.D0.n9a){if(la.tTf===u)return{returnValue:la,themeIndex:P};P++}N.a.J(512496854,813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+
u);return{returnValue:null,themeIndex:P}}S5i(u){return u?!u.S7d:(N.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.Dgb.Qm(Object(z.a)(this,this.Cib,"onPresentationPropertyChange"));this.S6c=0}HL(){return(new Date).getTime()}}qe.acf=4;qe.vUh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";qe.lUh=1;qe.kUh=2;qe.jUh=0;Object(r.a)(qe,"AgendaConverterManager",null,[108]);class Bi{constructor(u,P,la){this.Iw=u;this.Fc=P;this.AO=la;this.Jt()}Jt(){this.Fc.XJc(Object(z.a)(this,
this.xoa,"onUndoRedo"))}dispose(){this.Fc.nqd(Object(z.a)(this,this.xoa,"onUndoRedo"))}a$b(u,P){u===wb.a.w0b&&(this.Iw.XOe(P),this.AO.XOe(P))}xoa(u,P){this.a$b(P.p$e,P.ddb)}}Object(r.a)(Bi,"AgendaConverterUndoRedoController",null,[1077]);var kn=d(78);class Tm{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(r.a)(Tm,"IAgendaSettings",null,[]);class hk{constructor(u,P,la,Ca,Ta){this.wIf="HighConfidenceAgendaDetected";this.Bz=null;this.va=new kn.a;this.M6c=
null;this.agd=0;this.la=la;this.Yr=P;this.Fa=Ta;this.Bz||(P=new Tm,P.isEntryState=!0,P.pptAppFrameDomElement=this.Yr.UF(),P.maxTryAgainCount=this.la.tCf,this.Bz=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(P));this.aHl();this.AO=u;this.la&&this.la.SRc&&this.AO.X6k(this);this.Iw=Ca;this.Kdb=!1}D8g(){this.AO&&(this.AO.q$f()?(this.Iw.pel(this.AO.JB.YGe),this.hEh(this.M6c),1===this.AO.JB.YGe&&this.va.raiseEvent(this.wIf,null)):this.Mhe())}$Ml(){this.Bz&&(this.Iw.JEk(),this.Bz.showAgendaToPptDialog(this.AO.rj()),
this.Fa.S_c(Fd.a.sCf,Fd.a.$i,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.wj(Fd.a.sCf,!0),this.Kdb=!0)}Z9g(){this.Mhe();this.Iw.LEk();window.setTimeout(()=>{this.hNl()},8E3)}PEk(u){this.wFh(u);this.Iw.W9g(!0)}OEk(u){this.wFh(u);this.Iw.W9g(!1)}IEk(u){this.ABl(u)}MEk(){this.agd>=this.la.tCf?this.Bz.showAgendaToPptDismissCard():(this.agd+=1,this.Bz.showAgendaToPptFailureCard());this.Iw.Wbh()}Y9g(){this.Bz&&this.Kdb&&this.Bz.showSlidePreviewError()}NEk(){this.Bz.showMergeSlidesError();
this.Iw.Wbh()}hEh(u){this.la.SRc&&(this.f0e(u),this.Bz&&this.M6c&&this.AO&&this.AO.q$f()&&(this.Bz.showAgendaCard(this.M6c,this.AO.JB.WEe),this.Iw.GEk()))}Mhe(){N.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.Bz&&!this.Kdb&&(this.Bz.hideAgendaCard(),this.f0e(null))}wFh(u){this.Bz&&this.Kdb&&this.Bz.populateThemesInAgendaDialog(u)}ABl(u){this.Bz&&this.Kdb&&this.Bz.populatePreviewSlidesInAgendaDialog(u)}f0e(u){this.M6c=u}hNl(){if(this.la.UUk)try{const u=w.a.instance.Ia("Common.ISystemInitiatedFeedback");
u&&(N.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),u.execute(P=>{P.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(u){N.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",u)}}aHl(){this.Bz.on(hk.mUh,()=>{this.bni()});this.Bz.on(hk.pUh,()=>{this.eni()});this.Bz.on(hk.nUh,()=>{this.cni()});this.Bz.on(hk.oUh,()=>{this.dni()});this.Bz.on(hk.tUh,
u=>{this.ani(u)});this.Bz.on(hk.qUh,u=>{this.rCf(u,!1)});this.Bz.on(hk.rUh,()=>{this.fni()});this.Bz.on(hk.sUh,u=>{this.rCf(u,!0)})}bni(){this.wHh()}eni(){this.Iw.dNk();this.wHh()}cni(){this.qCf();this.Iw.E$g()}dni(){this.qCf();this.Iw.RGk()}qCf(){this.cleanup();this.AO.MQl(this)}wHh(){this.AO.gMh()}ani(u){this.AO.b9e(u)}rCf(u,P){this.Iw.KEk(u,P);this.Kdb=!1;this.Bz.hideAgendaToPptDialog();this.AO.hMh(u)}fni(){this.Kdb=!1;this.Bz.hideAgendaToPptDialog();this.Iw.E$g()}cleanup(){this.f0e(null);this.agd=
0;this.Bz.cleanup()}zji(u){this.va.addHandler(this.wIf,u)}}hk.mUh="AgendaCardAddSlides";hk.pUh="AgendaCardTryAgain";hk.nUh="AgendaCardCancel";hk.oUh="AgendaCardDismiss";hk.tUh="AgendaToPptDialogThemeSuggestionSelected";hk.qUh="AgendaToPptDialogApply";hk.rUh="AgendaToPptDialogCancel";hk.sUh="AgendaToPptDialogMergeTryAgain";Object(r.a)(hk,"AgendaConverterView",null,[1078,1102]);var Dm=d(692);class Rn{constructor(){this.ojc={}}dwd(u){this.ojc[u]=new Dm.a(u,!0)}CPb(u){if(u in this.ojc){var P=this.ojc[u];
P.stop();P=P.yRc;delete this.ojc[u];return P}return-1}nPe(u){return u in this.ojc}}Object(r.a)(Rn,"AgendaPerfLogger",null,[]);class ak{constructor(){this.u2c=this.Zng=this.aog=this.$ng=!1}Mgk(){this.u2c&&!this.$ng&&(this.$ng=!0,oc.b(ak.Kwi))}mhk(){this.u2c&&!this.aog&&(this.aog=!0,oc.b(ak.Lwi))}Lfk(){this.u2c&&!this.Zng&&(this.Zng=!0,oc.b(ak.Jwi))}static Oek(u){u&&u.qJ&&oc.b(ak.Iwi)}}ak.Kwi="WAC_Exp_AgendaToPPTHighConfidenceSeen";ak.Lwi="WAC_Exp_AgendaToPPTHighConfidenceTried";ak.Jwi="WAC_Exp_AgendaToPPTHighConfidenceKept";
ak.Iwi="WAC_Exp_AgendaToPPTIsCreateNew";Object(r.a)(ak,"ExperimentationMetrics",null,[]);class Ho{constructor(){this.sxe=this.Mwe=this.Rue=this.vva=null;this.Nye=!1;this.YEg=this.Tzg=this.s2g=this.Da=null;this.sIe="";this.Qye=!1;this.Que=""}reset(){this.s2g={};this.Tzg=new Rn;this.YEg=new ak;this.sIe="";this.Qye=!1;this.Que="";this.sxe=this.Mwe=this.Rue=this.vva=null;this.Nye=!1}get telemetryData(){return this.s2g}get LSc(){return this.YEg}get r8(){return this.Tzg}get rd(){return this.Da}set rd(u){this.Da=
u}get jxd(){return this.sIe}set jxd(u){this.sIe=u}get nTa(){return this.Qye}set nTa(u){this.Qye=u}get mQ(){return this.Que}set mQ(u){this.Que=u}get uW(){return this.vva}set uW(u){this.vva=u}get aH(){return this.Rue}set aH(u){this.Rue=u}get tT(){return this.Mwe}set tT(u){this.Mwe=u}get documentOpenType(){return this.sxe}set documentOpenType(u){this.sxe=u}get Sac(){return this.Nye}set Sac(u){this.Nye=u}}Object(r.a)(Ho,"AgendaMetricsState",null,[]);var Em=d(788);class ik{constructor(u,P){if(!u)throw Error.argumentNull("AgendaThemetype is null");
if(!P)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.Qva=new Em.a;this.Qva.dja(Object.assign(new L.a,{name:"AgendaThemeType",string:u}));this.Qva.dja(Object.assign(new L.a,{name:"AgendaFlowVersion",string:P}))}I6(u){Gb.a.Xa(u)||this.Qva.dja(Object.assign(new L.a,{name:"AgendaSessionId",string:u}));return this}btd(u){this.Qva.dja(Object.assign(new L.a,{name:"AgendaThemeIndexSelected",int64:u}));return this}ilb(u){Gb.a.Xa(u)||this.Qva.dja(Object.assign(new L.a,{name:"AgendaCardState",
string:u}));return this}FLa(u){Gb.a.Xa(u)||this.Qva.dja(Object.assign(new L.a,{name:"AgendaDialogState",string:u}));return this}t1a(u){Gb.a.Xa(u)||this.Qva.dja(Object.assign(new L.a,{name:"AgendaButtonClickedType",string:u}));return this}Rtd(u){Gb.a.Xa(u)||this.Qva.dja(Object.assign(new L.a,{name:"AgendaSeenTriedKept",string:u}));return this}c2(u){Gb.a.Xa(u)||this.Qva.dja(Object.assign(new L.a,{name:"DocumentOpenType",string:u}));return this}build(){return this.Qva.dataFields}}Object(r.a)(ik,"AgendaToPptActivityDataPointBuilder",
null,[]);class Gk{constructor(){this.Wc=null;this.xZa=new Dm.a("AgendaToPpt",!1);this.g2e()}g2e(){this.Wc=new Ho;this.Wc.reset();this.Wc.telemetryData.Flights="";t.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)&&(this.Wc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Wc.telemetryData.InitialUserThemeType=this.Wc.mQ}WGk(u){u&&(this.Wc.rd=u,this.Wc.documentOpenType=Gk.kjj(u),ak.Oek(this.Wc.rd),
this.Wc.telemetryData.IsDocumentOpenTypeCreateNew=this.Wc.rd.qJ.toString())}X9g(u,P){if(this.Wc.r8.nPe("AgendaToPptDialogThemeApply")&&"V2"===this.Wc.aH){var la=this.Wc.r8.CPb("AgendaToPptDialogThemeApply");this.Wc.telemetryData.TotalTimeTakenToMerge=la.toString();oc.a(Gk.FW,u,la,P)}else this.Wc.r8.nPe("OnAddSlidesClicked")?(la=this.Wc.r8.CPb("OnAddSlidesClicked"),this.Wc.telemetryData.TotalTimeTakenToMerge=la.toString(),oc.a(Gk.FW,u,la,P)):this.Wc.r8.nPe("OnTryAgainClicked")&&(la=this.Wc.r8.CPb("OnTryAgainClicked"),
this.Wc.telemetryData.TotalTimeTakenToMerge=la.toString(),oc.a(Gk.FW,u,la,P));this.Wc.Sac=!1}GEk(){this.Wc.Sac=!1;if(!("Seen"in this.Wc.telemetryData)){this.pN("OnAgendaCardShown");this.xZa.start();this.Wc.telemetryData.Seen="true";N.a.J(576746627,813,50,"AgendaCard shown");const u=(new ik(this.Wc.mQ,this.Wc.aH)).ilb("AgendaCardShown").Rtd("Seen").c2(this.Wc.documentOpenType).build();oc.a(Gk.FW,!0,0,u);this.Wc.LSc.Mgk()}}qEk(){this.Wc.Sac?this.ohk():this.cek()}cek(){this.pN("OnAddSlidesClicked");
this.xZa.stop();this.Wc.telemetryData.Tried="true";this.Wc.r8.dwd("OnAddSlidesClicked");N.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",this.xZa.yRc);const u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).ilb("AgendaCardShown").t1a("AddSlides").Rtd("Tried").c2(this.Wc.documentOpenType).build();oc.a(Gk.FW,!0,this.xZa.yRc,u);this.Wc.LSc.mhk()}LEk(){this.pN("OnAgendaToPPTApply");this.Wc.nTa=!0;this.Wc.telemetryData.Kept="true";this.Wc.telemetryData.Event="AgendaCompleted";const u=(new ik(this.Wc.mQ,
this.Wc.aH)).I6(this.Wc.uW).ilb("AgendaCompleted").c2(this.Wc.documentOpenType).build();this.X9g(!0,u);N.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}dNk(){this.Wc.Sac=!0;this.pN("OnTryAgainClicked");this.Wc.telemetryData.Tried="true";this.Wc.telemetryData.Event="AgendaTryAgain";this.Wc.r8.dwd("OnTryAgainClicked");N.a.J(556561858,813,50,"AgendaCard retry attempt")}ohk(){const u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).ilb("AgendaMergeError").t1a("TryAgain").Rtd("Tried").c2(this.Wc.documentOpenType).build();
oc.a(Gk.FW,!0,0,u)}JEk(){this.pN("OnAgendaDialogShown");this.Wc.tT="Loading";N.a.J(556602440,813,50,"AgendaDialog shown");const u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).FLa(this.Wc.tT).c2(this.Wc.documentOpenType).build();oc.a(Gk.FW,!0,0,u)}W9g(u){this.pN("OnAgendaThemePaneLoadedSuccess");this.Wc.tT=u?"ThemeSuggestions":"ThemeSuggestionsFailure";u=this.Wc.r8.CPb("OnAddSlidesClicked");this.Wc.telemetryData.ThemePaneLoadingTime=u.toString();const P=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).FLa(this.Wc.tT).c2(this.Wc.documentOpenType).build();
oc.a(Gk.FW,!0,u,P)}xpi(u){this.pN("ThemeDeckSuggestionId");this.Wc.telemetryData.SelectedDeckSuggestionId=u}bNk(u){"V2"===this.Wc.aH&&(this.pN("OnTriggerDifferentThemeWorkflow"),this.Wc.tT="ThemeSuggestions",this.Wc.r8.dwd("TriggerDeckLevelDesigner_"+u),u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).FLa(this.Wc.tT).btd(u).t1a("ThemeSelected").c2(this.Wc.documentOpenType).build(),oc.a(Gk.FW,!0,0,u))}V9g(u,P){this.pN("OnAgendaDeckPreviewLoaded");this.Wc.tT=P?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";
P=this.Wc.r8.CPb("TriggerDeckLevelDesigner_"+u);this.Wc.telemetryData["DeckPreviewLoadTime_"+u]=P.toString();u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).FLa(this.Wc.tT).btd(u).c2(this.Wc.documentOpenType).build();oc.a(Gk.FW,!0,P,u)}HEk(u){const P=this.Wc.r8.CPb("TriggerDeckLevelDesigner_"+u);this.pN("OnAgendaDeckPreviewError");this.Wc.tT="AgendaDeckPreviewError";let la="";"DeckPreviewFailure"in this.Wc.telemetryData&&(la=this.Wc.telemetryData.DeckPreviewFailure.toString());this.Wc.telemetryData.DeckPreviewFailure=
la+u.toString()+";";u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).FLa(this.Wc.tT).btd(u).c2(this.Wc.documentOpenType).build();oc.a(Gk.FW,!1,P,u)}KEk(u,P){this.pN("OnAgendaDialogThemeApply");this.Wc.tT=P?"AgendaDeckMergeError":this.Wc.tT;this.Wc.r8.dwd("AgendaToPptDialogThemeApply");u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).btd(u).FLa(this.Wc.tT).t1a(P?"TryAgain":"Apply").c2(this.Wc.documentOpenType).build();oc.a(Gk.FW,!0,0,u)}E$g(){this.pN("OnCancelClicked");this.Wc.nTa=!0;this.Wc.telemetryData.Kept=
"false";this.Wc.telemetryData.Event="AgendaCancelled";N.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).t1a("Cancel").c2(this.Wc.documentOpenType);"V2"===this.Wc.aH?u.FLa(this.Wc.tT):u.ilb("AgendaMergeError");oc.a(Gk.FW,!0,0,u.build())}RGk(){this.pN("OnDismissClicked");this.Wc.nTa=!0;this.Wc.telemetryData.Kept="false";this.Wc.telemetryData.Event="AgendaDismissed";N.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const u=(new ik(this.Wc.mQ,
this.Wc.aH)).I6(this.Wc.uW).t1a("Dismiss").c2(this.Wc.documentOpenType);"V2"===this.Wc.aH?u.FLa(this.Wc.tT):u.ilb("AgendaMergeError");oc.a(Gk.FW,!0,0,u.build())}Wbh(){this.pN("OnMergingErrorInAgenda");this.Wc.nTa=!0;this.Wc.telemetryData.Kept="false";this.Wc.telemetryData.Event="AgendaError";const u=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).c2(this.Wc.documentOpenType);"V2"===this.Wc.aH?(this.Wc.tT="AgendaMergeError",u.FLa("AgendaMergeError")):u.ilb("AgendaMergeError");this.X9g(!1,u.build())}XOe(u){let P=
!1;this.pN("OnUndoRedoClicked");let la=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).c2(this.Wc.documentOpenType);if("Kept"in this.Wc.telemetryData){this.Wc.telemetryData.Kept=(!u).toString();const Ca=u?"UndoClicked":"RedoClicked";this.Wc.telemetryData.Event=Ca;la=la.t1a(Ca)}else P=!0,la.t1a("UndoRedoPostAgendaKept");oc.a(Gk.FW,!0,0,la.build());N.a.J(576746629,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!u).toString(),P.toString())}yel(u){this.pN("ReportCorrelationID");this.Wc.telemetryData.CorrelationId=
u;this.Wc.uW=u}Kel(u){this.pN("ReportInitialUserThemeType");this.Wc.telemetryData.InitialUserThemeType=u;this.Wc.mQ=u}bYe(u){this.pN("ReportAgendaToPptFlowVersion");this.Wc.telemetryData.AgendaToPptFlowVersion=u;this.Wc.aH=u}pel(u){this.pN("ReportAgendaScore");this.Wc.telemetryData.AgendaScore=u.toString();1===u&&this.Iel()}Iel(){this.pN("ReportHighConfidenceAgendaDetected");this.Wc.telemetryData.HighConfidenceAgendaDetected="true";this.Wc.LSc.u2c=!0}dispose(){N.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",
Xh.c(this.Wc.telemetryData))}Rel(){if(!this.Wc.telemetryData||!kc.a.count(this.Wc.telemetryData))return"";const u=Xh.c(this.Wc.telemetryData);if(this.Wc.jxd===u)return"";this.Wc.jxd=u;if("Kept"in this.Wc.telemetryData){const P=(new ik(this.Wc.mQ,this.Wc.aH)).I6(this.Wc.uW).Rtd("Kept").c2(this.Wc.documentOpenType).build(),la=Boolean.parse(this.Wc.telemetryData.Kept.toString());oc.a(Gk.FW,la,0,P);la&&this.Wc.LSc.Lfk()}this.Wc.nTa&&(this.g2e(),this.Wc.nTa=!1);N.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",
this.Wc.jxd,this.Wc.nTa.toString());return u}pN(u){this.Wc.telemetryData||(N.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",u),this.g2e())}static kjj(u){return u.qJ?"NewDocument":u.EWa?"ViewOnlyDocument":"EditDocument"}}Gk.FW="AgendaToPptEvents";Object(r.a)(Gk,"AgendaMetrics",null,[1076]);class An{constructor(){this.Da=this.K=null;this.ZYg=!0;this.Szg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.AO=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Xb(u){this.K=
u;this.K.register(1076,"PowerPointWebEditor.IAgendaMetrics").na().oa(()=>new Gk);this.K.register(qe,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").na().oa(()=>new qe(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").zd(7),this.K.resolve("Common.IAppSettingsManager")));this.K.register(1077,"PowerPointWebEditor.IAgendaConverterUndoRedoController").na().oa(()=>new Bi(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const P=ci.a(this.K);Gd.a("AgendaToPPT.DisableLocalizedStrings")?P("agendaConverter").then(()=>{this.K.register(1078,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").na().oa(()=>new hk(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):P("powerpoint-agenda-to-ppt-strings").then(()=>{P("agendaConverter").then(()=>{this.K.register(1078,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").na().oa(()=>new hk(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),
this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").$e(Object(z.a)(this,this.W6k,"registerAgendaDetectionEventHandler"))}dispose(){}W6k(){this.Da=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.AO=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const u=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Da.z0i&&this.ZYg&&2===u.mode&&(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(P=>{P.kQ(this.Szg);P.cph(this.Szg,Object(z.a)(this.AO,this.AO.SQ,"handleAnnotationEvent"))}),this.ZYg=!1)}static main(){m.a.instance.Ac(new An)}}Object(r.a)(An,"AgendaConverterPackage",null,[2,3]);var Io=d(697);class pk{constructor(u,
P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd){this.kec=0;this.ia=u;this.Rb=P;this.la=la;this.Fa=Ca;this.le=Ta;this.pa=pb;this.$m=Sb;this.KE=Cc;this.Yu=ed;this.Yo=ad;this.kxa=Zd}vb(){this.tdi();this.la.qXk&&this.H0f()&&this.kxa.continueWith(()=>{this.kxa.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}tdi(){this.ia.ra(wb.a.vjb,db.a.application,Object(z.a)(this,this.vjb,"presentToTeams"),4);this.ia.ra(wb.a.aSe,db.a.application,Object(z.a)(this,this.vjb,"presentToTeams"),4);this.ia.ra(wb.a.$Re,
db.a.application,Object(z.a)(this,this.vjb,"presentToTeams"),4)}rwh(){this.Yu.hide();this.a9d()}a9d(){let u;cj.a.tyd();u=this.sOk();this.showDialog();return u}sOk(){this.Yo.pcc=!0;const u=bi.a.create().toString(),P=this.le.documentUrl;try{const Ca={};Ca.pptSharingUrl=Io.b(P);const Ta=encodeURIComponent(Hd.c(Ca));let pb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",u,Ta);if(!Gb.a.Xa(null)){const Sb=Cd.a.jA(null);pb=pb+"&fqdn="+Sb;const Cc=encodeURIComponent(Hd.c({joinUrl:null}));
pb=pb+"&meetingContext="+Cc}var la=pb;n.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.kec,u);window.open(la,"_top")}catch(Ca){return n.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",Ca),!1}return!0}showDialog(){const u=new Sa.StandardDialog;u.Ad=4;u.Le(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);u.Le(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);u.Tx(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,
0,Object(z.a)(this,this.Wpc,"protocolLaunchingDialogResultHandler"))}Wpc(u){1===u||0===u?(n.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.U0a()):2===u&&(n.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(wb.a.$Re,2))}U0a(){this.ia.Ja(wb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}H0f(){return!!this.le.documentUrl}vjb(u,P,la){if(!this.H0f())return n.ULS.sendTraceTag(523084879,
838,10,"PresentToTeamsActor: Document not supported"),8;if(1===la)return 32;this.kec=u;if(this.$m.isPaused)return this.Fa.Bd(),this.a9d()?32:8;this.pa.nh();this.Fa.Bd();if(u===wb.a.$Re||1===this.Rb.mode)return this.a9d()?32:8;this.KE.h4(!0,!0,()=>{this.rwh()},()=>{n.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.rwh();return!0});this.Yu.show(!1,this.kec);return 32}m6(){}l6(){}}Object(r.a)(pk,"PresentToTeamsActor",null,[144]);class Sn{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Xb(u){this.K=
u}init(){t.AFrameworkApplication.fa.$e(()=>{(new pk(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
this.K.resolve("PowerPointWebEditor.IApplicationContext"),Kh.a.Ot(w.a.instance.Ia("Common.ISystemInitiatedFeedback")))).vb()})}dispose(){}static main(){m.a.instance.Ac(new Sn)}}Object(r.a)(Sn,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var ej=d(750),qk=d(19);class $k{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(r.a)($k,"DesignerSuggestionApplyInfo",null,[]);var qj=d(346),kh=d(536),lm=d(112);class xk{constructor(){this.VKc=
null}}Object(r.a)(xk,"IdeasSlideSuggestionWrapper",null,[]);var Jo=d(105);class xp{constructor(){this.trigger=null;this.cid=this.sid=0;this.RL=null;this.timestamp=new Date;this.correlationId=bi.a.create().toString()}}Object(r.a)(xp,"DesignerRequestData",null,[]);var Um=d(227);class sl{}Object(r.a)(sl,"SlideSuggestionData",null,[]);class Wd{}Wd.FAk="mivTitle";Wd.EAk="mivSubtitle";Wd.zhd="mivContainer";Wd.DAk="mivButtonsContainer";Wd.B6g="mivButton";Wd.CAk="mivButtonImage";Wd.lIb="mivOverlayContainer";
Wd.sKe="mivIcon";Wd.mIb="mivTerm";Wd.D6g="mivFrame";Wd.GAk="mivView";Wd.E6g="mivIdx";Wd.uKe="mivKeepFocusStart";Wd.tKe="mivKeepFocusEnd";Wd.XXf="Editor";Wd.f6d="EditorContainer";Wd.j0i="EditorTitle";Wd.f0i="EditorSubtitleContainer";Wd.ZXf="EditorSubtitle";Wd.U_i="EditorBucketContainer";Wd.K9a="EditorPrev";Wd.z5b="EditorPrevDisabled";Wd.Kwb="EditorPrevEnabled";Wd.e6d="EditorBucketCurrent";Wd.V_i="EditorBucketTotalCount";Wd.NXf="EditorBucketTotal";Wd.Iwb="EditorNext";Wd.Jwb="EditorNextEnabled";Wd.y5b=
"EditorNextDisabled";Wd.X_i="EditorDescription";Wd.$_i="EditorIgnoreContainer";Wd.x5b="EditorIgnore";Wd.d0i="EditorSeeMoreContainer";Wd.B5b="EditorSeeMoreLabel";Wd.OXf="EditorCardContent";Wd.bYf="EditorSuggestionsContainer";Wd.SSa="EditorSuggestionContainer";Wd.HRc="EditorSuggestionArrow";Wd.g0i="EditorSuggestionCheck";Wd.aYf="EditorSuggestionText";Wd.$Xf="EditorSuggestionInstances";Wd.a0i="EditorNoMoreContainer";Wd.h0i="EditorSvgCheck";Wd.k0i="EditorWhiteCheck";Wd.Z_i="EditorGreenFill";Wd.Y_i="EditorGreenBorder";
Wd.b0i="EditorNoMoreLabel";Object(r.a)(Wd,"IdeasCss",null,[]);class Bh{}Bh.S$b="IdeasPane";Bh.RSa="editorSuggestionIdx";Bh.eH="ClosePane";Bh.UNj="IdeasPaneOpen";Bh.Nlc=6;Bh.$yk=3;Bh.FTf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(r.a)(Bh,"IdeasPaneConstants",null,[]);var Ce=d(388);class rd{constructor(u,P,la,Ca,Ta,pb,Sb){this.Ygc=null;this.ua=u;this.ic=P;this.la=la;this.Pb=Ca;this.Sdd=(u=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";
this.Tdd=u?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.wb=Ta;this.le=pb;this.lDb=Sb}oRk(u){const P=[];try{if(!u||!u.SlideSuggestions)return N.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),P;for(let la=0;la<u.SlideSuggestions.length;la++){if(!u.SlideSuggestions[la])continue;const Ca=u.SlideSuggestions[la].Base64Img;let Ta=null;try{Ta=Object.assign(new sl,{suggestionIndex:u.SlideSuggestions[la].Index.toString(),
suggestionCid:u.SlideSuggestions[la].SlideId.Cid.toString(),suggestionSid:u.SlideSuggestions[la].SlideId.Sid.toString(),imageData:Ca.startsWith("data:image")?Ca:"data:image/png;base64,"+Ca,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)})}catch(pb){N.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),Ta=null}Ta||(Ta=Object.assign(new sl,{suggestionIndex:u.SlideSuggestions[la].Index.toString(),suggestionSid:u.SlideSuggestions[la].SlideSid.toString(),
imageData:Ca.startsWith("data:image")?Ca:"data:image/png;base64,"+Ca,label:String.format(ResourceStrings.l_DesignerSuggestionItem,la+1)}));Array.add(P,Ta)}}catch(la){N.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",la)}return P}Mij(u,P,la){if(!u)throw Error.argumentNull("suggestionsContainer");return u.querySelector("#"+P+" ."+rd.TCa+'[correlationId="'+la+'"]')}zfe(){return this.la.yWi?this.la.xWi:this.la.wWi}G_c(u){if(!this.la.designerIncrementalRenderEnabled)return!1;
let P=!0;switch(u){case Ce.a.moreIdeas:P=!1;break;case Ce.a.newDocument:P=!1}return P}JXe(u){N.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Pb.correlationId,u.r$a);if(u.nwb&&u.KSc&&u.aha){var P=this.Ane(),la=u.aha.parentNode.parentNode.id;if(u.u4e&&this.la.ESa&&u.r$a)switch(u.nwb.DocumentUpsellStatus){case 0:this.Tgi(u.aha);break;case 1:this.nfi(u.aha);break;case 2:this.Xei(u.aha)}u.r$a&&this.la.SRc&&this.$rh(u.aha);var Ca;if(Ca=u.r$a?this.LNi(u.KSc,
u.Qh,u.aha,P,u.dAd):this.Mij(u.aha,la,u.Qh))try{const pb=this.Pb.CRa,Sb=!fc.a.Xa(pb)&&la===Bh.S$b,Cc=this.Vvi(u.nwb,Sb,pb);if(u.r$a){this.Pb.h8e=new Date;u.dAd&&this.wFl(u.m4i);for(var Ta=0;Ta<Ca.childNodes.length;Ta++){let ed=Ca.childNodes[Ta];u.dAd&&this.Dyl(Cc,Ta)?rd.WAl(P,Ta,ed):this.FXe(Sb?pb[Ta].Type:0,u.aha,ed,la,u.KSc,Cc[Ta.toString()],Ta,u.u4e,u.nwb.DocumentUpsellStatus)}this.la.gka&&u.nwb.HasPaginationInfo&&this.eFh(u.aha,u.Qh)}else if(u.dAd){N.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",
this.Pb.correlationId,kc.a.count(Cc));for(Ta of Object.keys(Cc)){const ed=parseInt(Ta);let ad=u.aha.querySelector("#"+la+" ["+rd.UCa+'="'+ed+'"]');Cc[Ta]&&ad&&Sys.UI.DomElement.containsCssClass(ad.firstChild,"IncSuggestionPlaceholder")&&this.FXe(Sb?pb[ed].Type:0,u.aha,ad,la,u.KSc,Cc[Ta],ed,u.u4e,u.nwb.DocumentUpsellStatus)}}}catch(pb){N.a.J(510248773,829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Pb.correlationId,pb)}}}wdl(u,P,la,Ca){try{if(!(u&&u.SlideSuggestions&&
u.SlideSuggestions.length&&P))return!1;this.ZZc(P);const Ta=P.querySelector("."+rd.TCa);if(!Ta)return!1;const pb=Ta.childNodes.length,Sb=Ta.childNodes.length+u.SlideSuggestions.length,Cc=this.Ane(),ed=P.parentNode.parentNode.id;for(let ad=0;ad<u.SlideSuggestions.length;++ad){const Zd=this.NQf(pb+ad,Sb,Cc);this.FXe(0,P,Zd,ed,Sb,u.SlideSuggestions[ad],pb+ad,Ca,u.DocumentUpsellStatus);Ta.appendChild(Zd)}u.HasPaginationInfo&&this.eFh(P,la);return!0}catch(Ta){return N.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",
Ta),!1}}Vvi(u,P,la){const Ca={};if(P)for(const Ta of la)switch(Ta.Type){case 0:P=Ta;la=null;for(const pb of u.SlideSuggestions)if(pb.Index===P.IndexInDesigner){la=pb;break}Ca[Ta.Index.toString()]=la;break;default:Ca[Ta.Index.toString()]=Ta}else for(const Ta of u.SlideSuggestions)Ca[Ta.Index.toString()]=Ta;return Ca}Dyl(u,P){P=P.toString();return!(P in u)||!u[P]}Tgi(u){const P=Ib.a.ee();P.className="DesignerFreeTrialCardContainer";const la=Ib.a.ee();la.className="DesignerFreeTrialCardTitle";la.innerText=
ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const Ca=Ib.a.ee();Ca.className="DesignerFreeTrialCardContent";Ca.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.zfe());const Ta=Ib.a.ee();Ta.className="DesignerStartFreeTrialButtonsContainer";const pb=Ib.a.ee();pb.className=rd.rub;pb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;pb.tabIndex=0;pb.setAttribute(Ja.a.fr,pb.innerText);pb.setAttribute(Ja.a.hf,Ja.a.Ou);const Sb=Ib.a.ee();Sb.className=
rd.aMc;const Cc=document.createElement("i");Cc.className=rd.gMc;Cc.style.lineHeight="20px";Cc.setAttribute("Unselectable","on");const ed=Ib.a.ee();ed.className="DesignerStartTrialGoPremiumButtonText";ed.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ed.setAttribute("Unselectable","on");Sb.setAttribute(Ja.a.fr,ed.innerText);Sb.setAttribute(Ja.a.hf,Ja.a.Ou);Sb.tabIndex=0;Sb.appendChild(Cc);Sb.appendChild(ed);Ta.appendChild(pb);Ta.appendChild(Sb);P.appendChild(la);P.appendChild(Ca);P.appendChild(Ta);
P.setAttribute(Ja.a.fr,String.format("{0}. {1}",la.innerText,Ca.innerText));P.setAttribute(Ja.a.hf,Ja.a.nsa);u.appendChild(P)}dRf(){const u=Ib.a.ee();u.className="DesignerInFreeTrialView";const P=document.createElement("i");P.className=t.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const la=Ib.a.ee();la.className=rd.y1b;la.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;la.tabIndex=0;const Ca=Ib.a.ee();
Ca.className=t.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";Ca.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;la.setAttribute(Ja.a.hf,Ja.a.GWd);la.setAttribute(Ja.a.O7a,Ja.a.qja);la.setAttribute(Ja.a.fr,la.innerText);u.appendChild(P);u.appendChild(la);u.appendChild(Ca);u.setAttribute(Ja.a.fr,la.innerText+" "+Ca.innerText);u.setAttribute(Ja.a.hf,Ja.a.nsa);return u}IMl(){const u=document.getElementsByClassName("DesignerFreeTrialCardContainer");
if(u)for(let P=0;P<u.length;P++){const la=u[P];if(la.parentNode){const Ca=this.dRf();la.parentNode.replaceChild(Ca,la)}}this.ePh()}nfi(u){const P=this.dRf();u.appendChild(P)}Xei(u){const P=Ib.a.ee();P.className="DesignerFreeTrialCardContainer";const la=Ib.a.ee();la.className="DesignerFreeTrialCardTitle";la.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;const Ca=Ib.a.ee();Ca.className="DesignerFreeTrialCardContent";Ca.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;
const Ta=Ib.a.ee();Ta.className=rd.x1b;const pb=document.createElement("i");pb.className=rd.gMc;pb.style.lineHeight="20px";const Sb=Ib.a.ee();Sb.className="DesignerTrialExhaustedGoPremiumButtonText";Sb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Ta.setAttribute(Ja.a.fr,Sb.innerText);Ta.setAttribute(Ja.a.hf,Ja.a.Ou);Ta.tabIndex=0;Ta.appendChild(pb);Ta.appendChild(Sb);P.appendChild(la);P.appendChild(Ca);P.appendChild(Ta);P.setAttribute(Ja.a.fr,String.format("{0}. {1}",la.innerText,Ca.innerText));
P.setAttribute(Ja.a.hf,Ja.a.nsa);u.appendChild(P)}eFh(u,P){const la=Ib.a.ee();la.className=rd.FYd;la.setAttribute(rd.qub,P);la.tabIndex=0;P=new nd.a;P.ah(16,16);P.ypa("0,0,2048,2048");const Ca=new Pb.a;Ca.dZ("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
P.appendChild(Ca);P=P.xa;P.setAttribute("class","DesignerMoreIdeasButtonIcon");la.appendChild(P);P=Ib.a.ee();P.className="DesignerMoreIdeasButtonLabel";P.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;la.appendChild(P);la.setAttribute(Ja.a.fr,P.innerText);la.setAttribute(Ja.a.hf,Ja.a.Ou);u.appendChild(la)}fBl(u){if(u){var P=Ib.a.xB();P.className="DesignerMoreIdeasLoading";P.src=lh.a.PN(kg.a.Joa);u.appendChild(P)}}ZZc(u){if(u){var P=u.querySelector("."+rd.FYd);P&&u.removeChild(P);(P=u.querySelector(".DesignerMoreIdeasLoading"))&&
u.removeChild(P)}}LNi(u,P,la,Ca,Ta){const pb=Ib.a.ee();pb.className=rd.TCa;pb.setAttribute(rd.qub,P);pb.setAttribute(Ja.a.fr,ResourceStrings.l_DesignerSuggestions);pb.setAttribute(Ja.a.hf,Ja.a.J0b);Ta&&(this.Pb.L1b=this.cfj());for(P=0;P<u;++P)pb.appendChild(this.NQf(P,u,Ca));la.appendChild(pb);return pb}NQf(u,P,la){const Ca=Ib.a.ee();Ca.className=la?this.Sdd+"4x3":this.Sdd;Ca.setAttribute(rd.UCa,u);Ca.tabIndex=0;Ca.setAttribute(Ja.a.fr,String.format(ResourceStrings.l_DesignerSuggestionItem,u+1));
Ca.setAttribute(Ja.a.hf,Ja.a.fRa);Ca.setAttribute(Ja.a.IWd,u+1);Ca.setAttribute(Ja.a.JWd,P);return Ca}FXe(u,P,la,Ca,Ta,pb,Sb,Cc,ed){let ad=null;this.la.designerIncrementalRenderEnabled&&(P&&(ad=P.querySelector("#"+Ca+' [IncSuggestionPlaceholder="'+Sb+'"]')),ad&&Sys.UI.DomElement.addCssClass(ad,"ShimmerPaused"),this.Hfk(Sb,Ta));P=!1;switch(u){case 0:this.utl(la,pb,Sb);P=(u=Cc&&this.la.ESa)&&1!==ed;Ta=Ca=ed=!1;if(pb&&pb.Categories)for(const Zd of pb.Categories)2===Zd?ed=Cc&&!u:1===Zd?Ca=!0:3===Zd?Ta=
!0:4===Zd&&this.gje(la,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Sb);(ed||P)&&this.nul(la);Ca?this.gje(la,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Sb):Ta&&(this.gje(la,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Sb),la.setAttribute(rd.vYd,rd.vYd),la.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.wei(la,pb);break;case 1:this.udl(la,pb);break;case 2:this.kdl(la);break;case 3:case 4:this.Hdl(la,pb)}ad&&ad.parentNode.removeChild(ad);pb=Ib.a.ee();pb.className=rd.lMc;P&&(pb.style.visibility=eb.a.visible,la.removeAttribute("tabindex"),la.setAttribute(Ja.a.NI,Ja.a.rB));la.appendChild(pb)}udl(u,P){if(P){u.className=Wd.zhd;u.setAttribute(Ja.a.fr,ResourceStrings.L_MakeItVisualCardTitle);var la=Ib.a.Hl();la.className=Wd.FAk;la.innerText=ResourceStrings.L_MakeItVisualCardTitle;var Ca=Ib.a.Hl();
Ca.className=Wd.EAk;Ca.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Ta=Ib.a.ee();Ta.className=Wd.DAk;Ta.setAttribute(Ja.a.hf,Ja.a.J0b);var pb=0,Sb=new rl.a,Cc=Math.min(Bh.Nlc,P.SearchTerms.length);for(let ed=0;ed<Cc;ed++)pb=this.tRf(P.SearchTerms[ed].Term,Ta,Sb,ed,pb);for(P=Cc;P<Bh.Nlc;P++)for(const ed of Bh.FTf)if(!Sb.contains(ed)){pb=this.tRf(ed,Ta,Sb,P,pb);break}u.appendChild(la);u.appendChild(Ca);u.appendChild(Ta);this.Pb.Pgd=!0}}tRf(u,P,la,Ca,Ta){const pb=Ib.a.ee();pb.className=Wd.B6g;
pb.setAttribute(Ja.a.hf,Ja.a.fRa);const Sb=Wd.mIb+"."+Ca,Cc=Ib.a.xB();Cc.className=Wd.CAk;Cc.src=({cAb:Ta}=this.noj(u,la,Ta)).returnValue;Cc.setAttribute(Ja.a.t_,Sb);la=Ib.a.ee();la.className=Wd.lIb;la.tabIndex=0;la.setAttribute(Wd.E6g,Ca);la.setAttribute(Ja.a.hf,Ja.a.Ou);Ca=document.createElement("i");Ca.className=Wd.sKe;Ca.innerText="\ue721";Ca.setAttribute(Ja.a.hf,Ja.a.qQ);const ed=Ib.a.Hl();ed.className=Wd.mIb;ed.innerText=u;ed.id=Sb;pb.appendChild(Cc);pb.appendChild(la);la.appendChild(Ca);la.appendChild(ed);
P.appendChild(pb);return Ta}noj(u,P,la){for(const Ca of Bh.FTf)if(Ca.toLowerCase()===u.toLowerCase())return P.add(Ca),{returnValue:this.le.qk(u+".png"),cAb:la};return{returnValue:this.le.qk("stock"+la++ +".png"),cAb:la}}ttl(u,P){if(u){var la=document.createElement("video");la.className="SuggestedVideoBackgroundContainer";la.setAttribute("Src",P);la.setAttributeNode(document.createAttribute("muted"));Um.a.C5j()||(la.setAttributeNode(document.createAttribute("autoplay")),la.setAttributeNode(document.createAttribute("loop")),
la.addEventListener("canplay",()=>{la.muted="true";la.play()}));u.appendChild(la)}}gje(u,P,la,Ca){if(u){var Ta=Ib.a.xB();Ta.src=this.le.qk(P);Ta.className="SuggestedMediaIcon";P=Ib.a.Hl();P.className="SuggestedMediaContainer";P.appendChild(Ta);u.setAttribute(Ja.a.fr,String.format(la,Ca+1));P.setAttribute("aria-hidden",Ja.a.rB);P.setAttribute("Unselectable","on");u.appendChild(P)}}wei(u,P){u&&P&&P.DesignDescription&&0!=P.DesignDescription.length&&u.setAttribute(Ja.a.fr,P.DesignDescription)}nul(u){if(u)if(this.la.ESa)Sys.UI.DomElement.addCssClass(u,
eb.a.Woc);else{u.setAttribute(rd.dMc,rd.dMc);var P=u.getAttribute(Ja.a.fr);P&&u.setAttribute(Ja.a.fr,String.format("{0}. {1}",P.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));Ja.a.gS(u,Ja.a.O7a,Ja.a.qja);P=Ib.a.ee();P.className=rd.jMc;var la=document.createElement("i");la.className=rd.gMc;P.appendChild(la);u.appendChild(P)}}ePh(){const u=document.getElementsByClassName(rd.B1b);if(u)for(let P=0;P<u.length;P++){Sys.UI.DomElement.removeCssClass(u[P].parentNode,eb.a.Woc);u[P].parentNode.tabIndex=
0;u[P].parentNode.removeAttribute(Ja.a.NI);const la=ab.a.Rda(u[P].parentNode,rd.lMc);!la||la.getAttribute(rd.LYd)&&la.getAttribute(rd.LYd).toString()===rd.LIf||(la.style.visibility=eb.a.hidden)}}mRl(){if(this.la.ESa){var u=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(u)for(var P=0;P<u.length;P++)u[P].parentNode.removeChild(u[P]);if(u=document.getElementsByClassName("DesignerInFreeTrialView"))for(P=0;P<u.length;P++)u[P].parentNode.removeChild(u[P]);this.ePh()}else if(u=document.getElementsByClassName(rd.jMc))for(P=
0;P<u.length;P++){u[P].style.display="none";const Ca=u[P].parentNode;Ca.removeAttribute(rd.dMc);Ca.removeAttribute(Ja.a.O7a);var la=Ca.getAttribute(Ja.a.fr);la&&(la=la.toString(),la=la.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),Ca.setAttribute(Ja.a.fr,la))}}utl(u,P,la){if(u&&P)try{let Ca=!1;try{u.setAttribute(rd.l8a,P.SlideId.Sid),u.setAttribute(rd.kMc,P.SlideId.Cid),Ca=!0}catch(pb){N.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
Ca=!1}Ca||u.setAttribute(rd.l8a,P.SlideSid);const Ta=Ib.a.xB();Ta.className=rd.B1b;Ta.src=P.Base64Img;this.Pb.Zsa.contains(P.Index)||this.Pb.Zsa.add(P.Index);this.la.AQc&&!Gb.a.Xa(P.DesignerMediaURL)&&P.Categories&&fc.a.contains(P.Categories,1)&&this.ttl(u,P.DesignerMediaURL);u.appendChild(Ta);N.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",la,this.Pb.correlationId)}catch(Ca){u.parentNode.removeChild(u),N.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
la,this.Pb.correlationId,Ca)}}kdl(u){if(fc.a.Xa(this.Pb.VW)||!this.Pb.BJi())u.style.display=eb.a.none;else{u.className=Wd.f6d;var P=Ib.a.Hl();P.className=Wd.j0i;P.innerText=ResourceStrings.L_ConsistencyCardTitle;var la=Ib.a.ee();la.className=Wd.f0i;var Ca=Ib.a.Hl();Ca.className=Ca.id=Wd.ZXf;Ca.innerText=Ca.title=this.Pb.VW[0].critiques[0].explanationLabel;var Ta=Ib.a.ee();Ta.className=Wd.U_i;var pb=Ib.a.Hl();pb.innerText="<";pb.tabIndex=0;Sys.UI.DomElement.addCssClass(pb,Wd.K9a);Sys.UI.DomElement.addCssClass(pb,
Wd.z5b);pb.id=Wd.K9a;var Sb=Ib.a.Hl();Sb.innerText="1";Sb.id=Wd.e6d;this.Pb.VN=0;var Cc=Ib.a.Hl();Cc.innerText="/";var ed=Ib.a.Hl();ed.className=Wd.V_i;ed.id=Wd.NXf;ed.innerText=this.Pb.VW.length.toString();var ad=Ib.a.Hl();ad.innerText=">";ad.tabIndex=0;ad.className=ad.id=Wd.Iwb;0<this.Pb.VW.length-1?Sys.UI.DomElement.addCssClass(ad,Wd.Jwb):Sys.UI.DomElement.addCssClass(ad,Wd.y5b);Ta.appendChild(pb);Ta.appendChild(Sb);Ta.appendChild(Cc);Ta.appendChild(ed);Ta.appendChild(ad);la.appendChild(Ca);la.appendChild(Ta);
Ca=Ib.a.Hl();Ca.className=Wd.X_i;Ca.innerText=ResourceStrings.L_ConsistencyCardDescription;Ta=rd.QQf();this.Khg(Ta,0);pb=Ib.a.ee();pb.className=Wd.$_i;Sb=Ib.a.ee();Sb.className=Wd.x5b;Sb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Sb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Sb.tabIndex=0;pb.appendChild(Sb);Sb=Ib.a.ee();Sb.className=Wd.d0i;Cc=Ib.a.Hl();Cc.className=Wd.B5b;Cc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;Cc.tabIndex=0;Sb.appendChild(Cc);Cc=Ib.a.ee();Cc.id=Wd.OXf;
Cc.appendChild(la);Cc.appendChild(Ca);Cc.appendChild(Ta);Cc.appendChild(pb);u.appendChild(P);u.appendChild(Cc);u.appendChild(Sb);this.Pb.GRc=!0}}Hdl(u,P){if(P){u.className=rd.WIf;u.setAttribute(Ja.a.fr,P.TitleText);u.setAttribute(rd.UCa,P.Index);var la=this.hHl(P.ExecutionActionName);if(la){var Ca=Ib.a.xB();Ca.src=this.le.qk("pegal.png");Ca.className=la;var Ta=Ib.a.Hl();Ta.className="cui-img-container cui-img-24by24";Ta.appendChild(Ca);u.appendChild(Ta)}Ca=Ib.a.Hl();Ca.className="DesignerSuggestedActionTitle";
Ca.innerText=P.TitleText;Ta=Ib.a.Hl();Ta.className="DesignerSuggestedActionSubtitle";Ta.innerText=P.DescriptionText;P=Ib.a.ee();P.className=la?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";P.appendChild(Ca);P.appendChild(Ta);u.appendChild(P)}}$rh(u){try{if(this.lDb&&this.lDb.instance){const P=Ib.a.ee();P.id="AgendaCardContainer";P.className="AgendaCardContainer";u.appendChild(P);this.lDb.instance.hEh(P)}}catch(P){N.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Pb.correlationId,P)}}wDi(){try{this.lDb&&this.lDb.instance&&this.lDb.instance.Mhe()}catch(u){N.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Pb.correlationId,u)}}hHl(u){switch(u){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}Khg(u,P){P=this.Pb.VW[P].critiques[0].suggestions;const la=Math.min(Bh.$yk,P.length);for(let Ca=0;Ca<la;Ca++)this.tIj(u,P[Ca].description,P[Ca].numberOfInstances,
Ca)}tIj(u,P,la,Ca){const Ta=Ib.a.ee();Ta.className=Wd.SSa;Ta.tabIndex=0;Ta.setAttribute(Bh.RSa,Ca);const pb=Ib.a.Hl();pb.className=Wd.HRc;pb.innerText="\u2192";pb.setAttribute(Bh.RSa,Ca);const Sb=Ib.a.Hl();Sb.className=Wd.aYf;Sb.innerText=P;Sb.setAttribute(Bh.RSa,Ca);P=Ib.a.Hl();P.className=Wd.$Xf;P.innerText=String.format("[{0}]",la);P.setAttribute(Bh.RSa,Ca);Ta.appendChild(pb);Ta.appendChild(Sb);Ta.appendChild(P);u.appendChild(Ta)}wFl(u){this.lwd();this.Ygc=new O.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.Gfk(u)},void 0,"IncrementalRenderTimeoutTask");this.wb.Hb(this.Ygc)}lwd(){this.Ygc&&(this.wb.Kg(this.Ygc),this.Ygc=null)}Gfk(u){this.lwd();for(let P=0;P<u;P++)this.Pb.Zsa.contains(P)||this.Pb.F_c.add(P)}Hfk(u,P){if(!this.Pb.BRa.contains(u)&&(this.Pb.BRa.add(u),u=this.Pb.BRa.count,u===P&&(this.Pb.c0b=new Date,this.lwd()),!this.Pb.YRb&&u>=this.Pb.L1b)){for(P=0;P<this.Pb.L1b;P++)if(!this.Pb.BRa.contains(P))return;this.Pb.YRb=new Date}}cfj(){const u=document.getElementById("WACDocumentPanel");
if(u){const P=this.la.useWideSuggestionThumbs,la=this.Ane();return Math.floor((u.offsetHeight-87)/(P||la?135:101))}return 1}Ane(){const u=this.Tu();return.01>=Math.abs(u.width/u.height-1.33)}XLf(u,P){this.Daf(this.Wxb(u,P),P,!1)}yyh(u,P){this.Daf(u,P,!0)}pQl(u){if(u&&(u=u.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var P=-1!==u.className.indexOf("4x3");this.Daf(u,P,!1)}}Daf(u,
P,la){u&&(la?(u.className=P?this.Tdd+"4x3":this.Tdd,Ja.a.gS(u,Ja.a.P7a,Ja.a.rB)):(u.className=P?this.Sdd+"4x3":this.Sdd,Ja.a.gS(u,Ja.a.P7a,Ja.a.qja)))}Tu(){return this.ic.Tu()}Wxb(u,P){return u.querySelector("."+(P?this.Tdd+"4x3":this.Tdd))}get Ba(){return Object(U.a)(116,this.ua.Ba)}Zwh(u,P){if(u){if(u=u.querySelector("["+rd.UCa+'="'+P+'"]'))P=bb.a.mi(u),u.contains(bb.a.YTa(new Sys.UI.Point(P.x,P.y)))&&u.contains(bb.a.YTa(new Sys.UI.Point(P.x+P.width-1,P.y)))?u.contains(bb.a.YTa(new Sys.UI.Point(P.x,
P.y+P.height-1)))&&u.contains(bb.a.YTa(new Sys.UI.Point(P.x+P.width-1,P.y+P.height-1)))||u.scrollIntoView(!1):u.scrollIntoView(!Gd.a("Designer.ScrollIntoViewFix"))}else N.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static u4d(u){let P=null;try{P=Hd.a(u)}catch(la){N.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return P}static IQk(u){const P=u.CardData;let la=null;try{if(la=Hd.a(P),!u.SlideSuggestions&&
la)for(la=Yk.e(la,Ca=>0!==Ca.Type),u=0;u<la.length;u++)la[u].Index=u}catch(Ca){N.a.J(510248726,829,10,"parsing cards failed with exception: {0}",Ca)}return la}static WAl(u,P,la){la.style.backgroundColor="white";const Ca=Ib.a.ee();Ca.className=u?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";Ca.setAttribute("IncSuggestionPlaceholder",P);(yd.a.ik||yd.a.mg)&&Sys.UI.DomElement.addCssClass(Ca,"Shimmer");la.appendChild(Ca)}static QQf(){const u=Ib.a.ee();u.className=
u.id=Wd.bYf;return u}}rd.TCa="DesignerSuggestionList";rd.qub="correlationId";rd.UCa="suggestionIndex";rd.l8a="slideId";rd.kMc="slideCid";rd.dMc="isShownAsPremiumContent";rd.vYd="containsAnimation";rd.LIf="Refreshing";rd.LYd="SourceTrigger";rd.B1b="SuggestionImg";rd.gMc="ms-Icon ms-Icon--Diamond";rd.jMc="ShadowedTriangleContainer";rd.lMc="DesignerSuggestionListDisabled";rd.FYd="DesignerMoreIdeasButton";rd.WIf="DesignerSuggestedActionResult";rd.y1b="DesignerInFreeTrialViewGoPremiumText";rd.x1b="DesignerFreeTrialCardGoPremiumButton";
rd.rub="DesignerStartFreeTrialButton";rd.aMc="DesignerStartFreeTrialGoPremiumButton";Object(r.a)(rd,"DesignerViewHelper",null,[1066]);class Gi{constructor(){this.cid=this.sid=0;this.h_c=this.RL=this.trigger=null}}Object(r.a)(Gi,"PendingRequest",null,[]);class cd{constructor(){this.CGe=!1;this.CFb=null}get vtg(){return this.CGe}get Awg(){return this.CFb}static get inProgress(){const u=new cd;u.CGe=!0;u.CFb=new Date;return u}static get ready(){const u=new cd;u.CGe=!1;u.CFb=null;return u}}Object(r.a)(cd,
"RequestState",null,[]);var vg=d(345),yg=d(380);class Bn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg,$i,jk,fj,Mk,Tk,Uk,uh,Ri,Tj,Km,kk){this.FM=null;this.uJa=this.zGg=0;this.oNg=!1;this.WWa=this.axe=this.yXa=null;this.PCg=!1;this.BNg=0;this.EGj=(Vk,aq,Uj)=>{if(1===Uj)return 32;try{this.Ap&&this.Ap.Mo&&this.Ap.Mo.isVisible?Tb.UISurfaces.Iq().then(Zm=>{Zm.setSelectedTaskPane(Fd.a.P8);return null}).catch(Zm=>{N.a.J(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Zm.toString())}):
this.ia.processAction(wb.a.r6b,2)}catch(Zm){return N.a.J(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Zm.toString()),8}return 32};this.Un=Sb;this.Ap=Cc;this.Bp=ed;this.Ey=ad;this.Pb=Zd;this.ia=u;this.lR=P;this.jb=Ta;this.Fa=pb;this.ua=We;this.Rf=Qf;this.Fc=Af;this.la=pf;this.fc=la;this.Fb=Ca;this.ei=He;this.pna=Yf;this.xna=cd.ready;this.u$=Rg;this.Eb=$i;this.Mc=jk;this.wb=fj;this.PHb=Mk;this.Xfc=uh;this.ic=Ri;this.CM=Tj;this.Iw=Km;this.Rzg=kk;this.yGg=Object(z.a)(this,this.VEj,
"handleFirstRunExperienceEvent");Uk&&Uk.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(Vk=>{this.oNg=Vk;return null});this.ia.Oaa(this)}vb(){this.la.M1c&&(this.ia.ra(wb.a.LEh,db.a.application,Object(z.a)(this,this.KEh,"showHideIdeas"),4),this.ia.ra(wb.a.L3e,db.a.application,Object(z.a)(this,this.KEh,"showHideIdeas"),4),Gd.a("Designer.QueryNewPane")&&this.ia.ra(wb.a.Kqc,db.a.application,Object(z.a)(this,this.Q_k,"queryShowHideDesignerPane"),96),this.la.ccb&&this.ia.ra(wb.a.sfh,db.a.application,
this.EGj,4),this.ia.ra(wb.a.r6b,db.a.application,Object(z.a)(this,this.K3e,"showHideDesigner"),4),this.ia.ra(wb.a.t8,db.a.application,Object(z.a)(this,this.t8,"applyDesignerSuggestion"),4),this.ia.ra(wb.a.wtb,db.a.application,Object(z.a)(this,this.t8,"applyDesignerSuggestion"),4),this.ia.ya(wb.a.dib,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.zmc,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.BIb,db.a.application,
Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.cib,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.xmc,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.zIb,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.ymc,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),this.ia.ya(wb.a.AIb,db.a.application,Object(z.a)(this,this.g_a,"navigateDesignerSuggestion")),
this.ia.ra(wb.a.$oa,db.a.application,Object(z.a)(this,this.$oa,"reportSuggestionSessionInfo"),64),this.ia.ya(wb.a.QUf,db.a.application,Object(z.a)(this,this.mNl,"triggerOnUndoRedo")),this.ia.ya(wb.a.dke,db.a.application,Object(z.a)(this,this.dhg,"handleImageUploadForDesigner")),this.ia.ya(wb.a.o0c,db.a.application,Object(z.a)(this,this.dhg,"handleImageUploadForDesigner")),this.pna.D7a(Object(z.a)(this,this.D1,"onSlidePresenceChanged")),this.Rf.LI(Object(z.a)(this,this.tWi,"designerTargetSlideChangedHandler")),
this.la.designerIncrementalRenderEnabled&&this.Fc.Xji(Object(z.a)(this,this.cLk,"onRenderSuggestions")),this.la.gka&&this.Fc.gii(Object(z.a)(this,this.vJk,"onMoreIdesClicked")),this.la.IUf&&this.Fc.B7a(Object(z.a)(this,this.kga,"onRibbonTabSwitched")),this.la.fD&&this.Rf.E7a(Object(z.a)(this,this.rWi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.u$.W_b(Object(z.a)(this,this.ega,"onBlockingStateChanged")),this.Rf.HAf(Object(z.a)(this,this.Jjd,"onForceOutboundGraphTransactionDisposed")),
this.PHb.V_b(Object(z.a)(this,this.xib,"onMarkedUndo")),this.la.A4d&&this.Mc.CCa(Object(z.a)(this,this.Fib,"onSessionEnding")),this.Mc.qB(Object(z.a)(this,this.Hn,"onSessionRehydrated")),this.Xfc&&this.Xfc.execute(u=>{u.XAf(Object(z.a)(this,this.sNe,"onEditorCritiques"))}),this.Rzg&&this.Rzg.execute(u=>{u.zji(Object(z.a)(this,this.mIk,"onHighConfidenceAgendaDetected"))}),this.la.lWi?(this.zGg=window.setTimeout(Object(z.a)(this,this.c$e,"tryTriggerNewDocDesignerRequest"),this.la.kWi),window.addEventListener("FREDecisionEvent",
this.yGg,!0)):this.c$e(),!Gb.a.Xa(this.la.uRe)&&this.uWi(this.la.uRe)&&(this.XDj(),this.iNl(this.la.uRe)))}VEj(u){window.removeEventListener("FREDecisionEvent",this.yGg,!0);window.clearTimeout(this.zGg);(u=u.detail)&&u.show&&u.show||this.c$e()}me(){const u=this.Fa.Ic(Fd.a.P8);u.bindAction(mb.KeyInputManager.Va(pa.a.B2,0),wb.a.dib);u.bindAction(mb.KeyInputManager.Va(pa.a.rF,0),wb.a.dib);u.bindAction(mb.KeyInputManager.Va(pa.a.oI,0),wb.a.zmc);u.bindAction(mb.KeyInputManager.Va(pa.a.$q,4),wb.a.BIb);
u.bindAction(mb.KeyInputManager.Va(pa.a.A2,0),wb.a.cib);u.bindAction(mb.KeyInputManager.Va(pa.a.qF,0),wb.a.cib);u.bindAction(mb.KeyInputManager.Va(pa.a.ez,0),wb.a.xmc);u.bindAction(mb.KeyInputManager.Va(pa.a.$q,0),wb.a.zIb);u.bindAction(mb.KeyInputManager.Va(pa.a.BZ,0),wb.a.ymc);u.bindAction(mb.KeyInputManager.Va(pa.a.JV,0),wb.a.AIb)}K3e(u,P,la,Ca,Ta){return this.sK(this.Ap,Fd.a.P8,la,u,Ta)}KEh(u,P,la,Ca,Ta){return Ta||!this.Un.isVisible?this.sK(this.Ap,Fd.a.ybb,la,u,Ta):0}sK(u,P,la,Ca,Ta){var pb=
this.ua.presentation;pb=!!this.ua.Ba&&!!pb&&!this.fc.fd(pb);if(this.la.fD){const Sb=this.jb.Re();pb=!!Sb&&1===Sb.length&&pb}if(!pb)return 16;if(!this.Ey.isEnabled())return 8;if(1===la)return 32;Ta||this.Fa.wj(P,u.Mo.isVisible);Ca===wb.a.r6b?this.Pb.correlationId&&!this.Pb.lCb(this.Pb.correlationId)||this.dea(Ce.a.JQb):u.Mo.isVisible?u.Mo.Zp(!1,vg.a.PPb):(this.dea(Ca===wb.a.L3e?Ce.a.JQb:Ce.a.Owc),u.Mo.Zp(!0,vg.a.none));return 32}Q_k(u,P,la,Ca,Ta){if(!Object(qk.a)(lm.a,Ta)||!this.Ap||!this.Ap.Mo)return 8;
Ta.If(this.Ap.Mo.isVisible);return 32}t8(u,P,la,Ca,Ta){P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.fd(P))return 16;Ca=null;let pb=!0;Object(qk.a)($k,Ta)?Ca=Ta:Object(qk.a)(xk,Ta)&&(Ca=Ta.VKc,pb=!1);if(!this.Ey.isEnabled()||!Ca)return 8;if(this.Ey.HPk())return N.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",Ca.CorrelationId,u),8;if(1===la)return 32;if(!this.jb.Js()){if(1===this.jb.Ud().length&&this.jb.Ud()[0].Lv)return this.jb.nh(),
N.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",Ca.CorrelationId,u),8;this.jb.nh()}if(!this.la.gka&&this.Pb.r_.sid===Ca.SuggestionSid)return N.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",Ca.CorrelationId,Ca.SuggestionSid),2;la=this.Fb.ke(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.Pb.cRa=
new Date),la.jc(P),la.gd=u,P.QDa=Ca,this.Pb.r_=T.a.ax(Ca.SuggestionSid,Ca.SuggestionCid),this.Pb.jU=!0,N.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ca.CorrelationId,u,Ca.SuggestionSid)}finally{la&&la.dispose()}this.la.designerBlockApplyUntilDraw?this.fc.usa(P,this.ua.Ba,this.Eb.Na,u):this.fc.uw(P,u);this.Un.isVisible&&this.Fa.wf(Fd.a.ybb);pb&&this.Pb.OJe();return 32}g_a(u,P,la){P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.fd(P))return 16;
if(!this.Ey.isEnabled())return 8;if(1===la)return 32;this.Ey.yJj(u);return 32}$oa(u,P,la,Ca,Ta){if(this.Ey.Ap.Mo.isVisible)return 0;this.glb(Ta.f3c,Ta.Ofl);return 32}glb(u,P,la){const Ca=this.Pb.correlationId;if(Gb.a.Xa(Ca))N.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",P);else if(this.Pb.lCb(Ca))N.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",Ca,P);else{var Ta=
{};Ta.CachedTrigger=this.Pb.OYd;Ta.SuggestionSlideId=this.Pb.r_.sid.toString();Ta.SuggestionSlideCreationId=this.Pb.r_.cid.toString();Ta.AppliedSuggestion=this.Pb.jU;Ta.DisplaySuggestionsTimeoutInMs=this.la.z4d;Ta.SuggestionsTimeout=this.Pb.tWa;Ta.ClientAbort=this.Pb.XAb||this.Ey.EPk();Ta.DesignerPaneClosed=u;Ta.ResetReason=P;Ta.HoverPreviewDesignerTriggered=this.Pb.Uqg;Ta.DesignerFixPaneOpenHint=this.la.KUf;Ta.DesignerSendTraceRequestOnSessionEnded=this.la.A4d;Ta.UseWin32DesignerIconEnabled=this.la.B4d;
Ta.IsSimplifiedRibbon=this.Hcc();Gd.a("DesignerLogRetriggerReason")&&la&&(Ta.RetriggerReason=la);this.la.IUf&&(Ta.DesignerDesignTabTriggerEnabled=!0);this.Ap.vta()&&(this.la.ESa?(Ta[mf.a.SRh]=this.Bp.zfe(),Ta[mf.a.TRh]=!0,this.Pb.C5e&&(Ta.StartUpsellFreeTrial=!0)):Ta[mf.a.cPf]=!0);u=!!P&&0<=P.indexOf(Ce.a.moreIdeas);this.la.gka&&(Ta.TermCorrelationId=Bn.ffe(),u||(Ta.TermAction=this.lyj()));la=Hd.b(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());var pb={};pb.ClientOS=la.Os;
pb.Browser=la.Browser||"";pb.BrowserVersion=la.BrowserVersion||"";pb.BrowserMajorVersion=la.BrowserMajorVersion||"";pb.BrowserMinorVersion=la.BrowserMinorVersion||"";this.Pb.wvc&&this.Pb.bha&&this.Pb.bha>this.Pb.wvc&&(pb.SuggestionsE2ETimeMs=+this.Pb.bha-+this.Pb.wvc);this.la.designerIncrementalRenderEnabled&&(this.Bp.lwd(),this.H5e(),Ta[mf.a.qlg]=!0,pb.VisibleSuggestionsCount=this.Pb.L1b,0<this.Pb.F_c.count&&(pb.IncrementalRenderTimeoutIndexes=this.Pb.F_c.toArray().join(",")),0<this.Pb.Ufa.count&&
(pb.MissingDesignerCardIndexes=this.Pb.Ufa.toArray().join(",")),0<this.Pb.BRa.count&&(pb.CardIndexes=this.Pb.BRa.toArray().join(",")),0<this.Pb.Zsa.count&&(pb.DesignerCardIndexes=this.Pb.Zsa.toArray().join(",")),this.Pb.yQ&&(this.Pb.bmc&&this.Pb.bmc>this.Pb.yQ&&(pb.MissingDesignerCardsReceivedTime=+this.Pb.bmc-+this.Pb.yQ),this.Pb.c0b&&this.Pb.c0b>this.Pb.yQ&&(pb.AllIncRenderReceivedTime=+this.Pb.c0b-+this.Pb.yQ),this.Pb.YRb&&this.Pb.YRb>this.Pb.yQ&&(pb.VisibleIncRenderReceivedTime=+this.Pb.YRb-+this.Pb.yQ)));
this.mfi(pb);try{if(this.Iw.instance){const Sb=this.Iw.instance.Rel();Gb.a.Xa(Sb)||(Ta.AgendaMetrics=Sb)}}catch(Sb){N.a.J(512496583,813,10,"exception while populating AgendaMetrics",Sb)}Ta.BrowserData=pb;this.Pb.yQ&&this.Pb.bha&&this.Pb.bha>this.Pb.yQ&&(Ta.TimeToDisplaySuggestionsInMs=+this.Pb.bha-+this.Pb.yQ);this.Pb.h8e&&this.Pb.Bwc&&(Ta.TimeSuggestionsRendered=this.Pb.h8e.toUTCString());this.Pb.Bwc&&(Ta.TimeDesignerPaneClosed=this.Pb.Bwc.toUTCString());this.Pb.D0b&&0<this.Pb.D0b.count&&(Ta.AppliedSuggestionHis=
this.Pb.D0b.toArray().join(" "));this.ei.$oa(Ca,Xh.c(Ta),P===vg.a.Vsd);this.qTl(Ca,P);this.Pb.Zyf(Ca,this.la.gka&&u);N.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",P,Ca)}}Hcc(){return t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.Rp?!0:!1}mfi(u){u.IdeasMivShown=this.Pb.Pgd;u.IdeasMivDrillIn=this.Pb.EJe;u.IdeasEditorShown=this.Pb.GRc;u.IdeasEditorKept=this.Pb.FRc;u.IdeasEditorDrillIn=
this.Pb.PXf;u.AnyCardShown=this.Pb.GRc||this.Pb.Pgd||0<this.Pb.BRa.count;u.AnyCardKept=this.Pb.FRc||this.Pb.jU}qTl(u,P){this.Ey.HJa(u,P===vg.a.PPb||P===vg.a.Bwd||P===vg.a.noSuggestion||P===vg.a.SVf?qj.a.GJa:qj.a.pending)}cLk(u,P){P.AIh.addRange(this.Pb.Zsa);this.hLf(P.AIh,P.Z_f,P.slideId,P.trigger,P.correlationId);P.r$a&&(this.WWa||this.Pb.Ufa.count||this.mFl(P.trigger,P.Z_f))}vJk(u,P){this.dea(Ce.a.moreIdeas,null,P.k5c)}kga(u,P){!P.Zfa||"PptRibbon.Design"!==P.Zfa&&"Design"!==P.Zfa||2!==P.Uu&&3!==
P.Uu&&4!==P.Uu||this.Ey.Ap.Mo.isVisible||32!==this.ia.processAction(wb.a.ovd,1)||this.dea(Ce.a.w4d)}mFl(u,P){this.H5e();const la=this.ua.Ba.Cb,Ca=this.Pb.correlationId;this.WWa=new O.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Pb.lCb(Ca)||this.hLf(this.Pb.Zsa,P,la,u,Ca,P)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.wb.Hb(this.WWa)}hLf(u,P,la,Ca,Ta,pb=-1){if(this.Pb.Zsa.count===P)this.H5e();else if(u&&u.count&&!(0<this.Pb.Ufa.count)){if(-1===pb)for(let Sb of u)Sb>pb&&(pb=
Sb);this.ZBi(u,P,pb)&&this.lOl(la,Ca,Ta)}}ZBi(u,P,la){for(let Ca=0;Ca<P&&(u.contains(Ca)||this.Pb.Ufa.contains(Ca)||this.Pb.Ufa.add(Ca),Ca!==la||this.Pb.Ufa.count);Ca++);return 0<this.Pb.Ufa.count}lOl(u,P,la){const Ca={};Ca.MissingDesignerCardIndexes=this.Pb.Ufa.toArray().join(",");this.WWa=new O.a(0,1,0,()=>{this.ei.Hka(u.cid,u.sid,la,Bn.ffe(),P,null,Xh.c(Ca),()=>{N.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",
Ca.MissingDesignerCardIndexes,la)},Ta=>{N.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",Ca.MissingDesignerCardIndexes,Ta.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.wb.Hb(this.WWa)}H5e(){this.WWa&&(this.wb.Kg(this.WWa),this.WWa=null)}D1(u,P){(u=this.ua.Ba)&&P.slideId.equals(u.Cb)&&(this.Ey.Rvd(P.jGh,P.bkh),this.Ey.Ap.Mo.isVisible&&!this.Ey.isEnabled()&&
(N.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",P.jGh,P.bkh,this.Pb.correlationId),this.Un.Zp(!1,vg.a.xFi)),this.Un.isVisible&&(this.Ey.isEnabled()||this.Ey.HJa(this.Pb.correlationId,qj.a.GJa)))}tWi(u,P){P.$na?(u=Object.assign(new kh.a,{slideId:P.$na.Cb}),this.ia.Ja(wb.a.q0a,2,u),this.Ey.Rvd(u.Vuc,u.akh),this.Un.isVisible&&(N.a.J(512496577,
829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Pb.correlationId),this.Ey.isEnabled()&&!P.$na.pO?this.dea(Ce.a.P4e):P.$na.pO&&this.la.designerNewSlideEnabled||(this.Un.Zp(!1,vg.a.slideNavigation),this.Ey.HJa(this.Pb.correlationId,qj.a.GJa)))):N.a.J(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Pb.correlationId)}Y9b(u){this.la.designerRequestThrottlingEnabled&&
(this.xna=cd.ready,this.FM&&(this.Un.isVisible?(N.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.FM.trigger,this.FM.sid),u()):this.FM=null))}Iib(u,P){this.Y9b(P);N.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",u.HttpStatusCode);return!0}rWi(){if(this.Ey.Ap.Mo.isVisible){const u=this.jb.Re();u&&1<u.length&&(N.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),
this.Un.isVisible&&this.Un.Zp(!1,vg.a.uBk))}}ega(u,P){u=this.Pb.cRa;const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";u&&Object(U.a)(String,P.actionName)===la&&(this.Pb.D0b.add(String.format("{0}:{1}:{2}",this.Pb.r_,+u-+this.Pb.bha,+new Date-+u)),this.Pb.cRa=null)}Fib(u,P){this.Ey.Ap.Mo.isVisible&&(N.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Pb.correlationId,yg.a[P.iC]),1!==P.iC&&3!==P.iC||this.glb(!0,vg.a.Vsd))}Hn(){N.a.J(512496544,
829,50,"DesignerActor::OnSessionRehydrated");const u={};u[mf.a.dTc]=!0;this.dea(Ce.a.refresh,u)}Jjd(u,P){P&&this.pge(P.actionId,P.transaction.ry)}xib(u,P){if(P.uBb&&this.Ey.dvg(P.actionId)){u={};if(P.revisionId){const la=cj.a.jua(Jo.a.ZY,cj.a.Cab(P.revisionId.toString()).toString());la&&1===la.length&&(u[mf.a.bE]=la[0].bE)}this.pge(P.actionId,u)}}dhg(u,P,la,Ca,Ta){switch(u){case wb.a.dke:return this.Pb.Ayk(Ta),32;case wb.a.o0c:return this.Pb.ral(Ta),32;default:return 2}}Wxk(u,P,la){if(u!==Ce.a.insertPicture&&
u!==Ce.a.eya&&u!==Ce.a.b0c)return null;const Ca=la?la[mf.a.j$b]:!1,Ta=la?la[mf.a.JZc]:!1,pb=la?la[mf.a.k$b]:!1,Sb=la?la[mf.a.IZc]:!1;let Cc=null;switch(P){case wb.a.Doa:case wb.a.gmd:Cc=Ca?mf.a.bSk:Ta?mf.a.aSk:pb?mf.a.cSk:Sb?mf.a.$Rk:null;break;case wb.a.imd:Cc=Ca?mf.a.fSk:Ta?mf.a.eSk:pb?mf.a.gSk:Sb?mf.a.dSk:null;break;case wb.a.mJc:Cc=mf.a.copilot;break;case wb.a.ATc:Cc=mf.a.A4f;break;case wb.a.insertOnlinePicture:case wb.a.Eua:case wb.a.Ubb:Cc=mf.a.online;break;case wb.a.Bmg:Cc=mf.a.icon}Cc||N.a.J(512496543,
829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",u,P,this.Pb.correlationId);delete la[mf.a.j$b];delete la[mf.a.JZc];delete la[mf.a.k$b];delete la[mf.a.IZc];return Cc}Xxk(u,P){switch(u){case wb.a.ATc:case wb.a.insertOnlinePicture:case wb.a.Eua:case wb.a.Ioc:case wb.a.Bmg:case wb.a.mJc:case wb.a.Ubb:return Ce.a.insertPicture;case wb.a.imd:case wb.a.Doa:case wb.a.gmd:case wb.a.Zmd:return P&&P[mf.a.j$b]||P&&P[mf.a.JZc]&&
this.la.ZMl?Ce.a.insertPicture:P&&P[mf.a.k$b]?Ce.a.eya:P&&P[mf.a.IZc]&&this.la.lMh?Ce.a.b0c:this.la.cAa?Ce.a.mKa:"";case wb.a.xv:case wb.a.YCa:case wb.a.Dtb:return Ce.a.Dtb;case wb.a.Eja:return Ce.a.K4e;case wb.a.Gtc:case wb.a.Htc:case wb.a.Ytd:case wb.a.Ztd:case wb.a.Jtc:return P&&mf.a.Fzb in P&&P[mf.a.Fzb]?Ce.a.FZd:Ce.a.refresh;case wb.a.wMf:case wb.a.C8a:return P&&mf.a.Fzb in P&&P[mf.a.Fzb]?Ce.a.EUf:Ce.a.refresh;case wb.a.BJa:case wb.a.Ckb:case wb.a.gtc:case Dg.a.tVa:case wb.a.bringForward:case wb.a.bringToFront:case wb.a.sendToBack:case wb.a.sendBackward:return Ce.a.Jkb;
case Dg.a.VWd:case Dg.a.YWd:case Dg.a.T0b:case Dg.a.XWd:case Dg.a.ZWd:case Dg.a.$Wd:case Dg.a.iRa:case Dg.a.aXd:case Dg.a.bXd:case Dg.a.cXd:case Dg.a.dXd:case Dg.a.fXd:case Dg.a.hXd:case Dg.a.backspace:case Dg.a.OCa:case Dg.a.uL:case Dg.a.BSa:case Dg.a.enter:case Dg.a.$B:case Dg.a.typing:return Ce.a.typing;case wb.a.eya:return Ce.a.eya;case wb.a.bnd:return this.la.ka("DesignerUseRefreshTriggerForInsertTable")?Ce.a.refresh:Ce.a.insertTable;case wb.a.i6:case wb.a.hid:case wb.a.HIb:case wb.a.BQ:return Ce.a.boa;
case wb.a.aRa:return Ce.a.ZVd;case wb.a.YKf:return Ce.a.zZd;case wb.a.Uub:return Ce.a.Uub;default:return Ce.a.refresh}}mNl(){const u={};u[mf.a.undoRedo]=!0;this.dea(Ce.a.refresh,u);return 32}pge(u,P){if(!this.MVj(u)){var la=pb=>{const Sb={};Sb[mf.a.timestamp]=pb.timestamp;Sb[mf.a.correlationId]=pb.correlationId;Sb[mf.a.trigger]=pb.trigger;Sb[mf.a.sid]=pb.sid;Sb[mf.a.cid]=pb.cid;Sb[mf.a.RL]=pb.RL;pb=this.Fb.yd(4);try{pb.jc(this.ua.presentation),pb.gd=wb.a.LUf,this.ua.presentation.mwb=Xh.c(Sb)}finally{pb&&
pb.dispose()}},Ca=this.Xxk(u,P),Ta=this.Wxk(Ca,u,P);P||(P={});Gd.a("DesignerLogRetriggerReason")&&Ca===Ce.a.refresh&&(P[mf.a.WYe]=u);if(this.$1c(Ca)||this.Un.isVisible)Gb.a.Xa(Ta)||(P[mf.a.pka]=Ta),this.Ey.dvg(u)&&this.Un.isVisible?this.f4d(Ca,this.la.designerTypeRefreshThrottleTimeoutMs,P,la):Ca===Ce.a.refresh&&this.Un.isVisible&&Gd.a("DesignerDelayRefreshTrigger")?this.f4d(Ca,this.la.qWi,P,la):u===wb.a.mJc?(u=this.la.uc("ChatPPTDesignerTriggerDelayMs",100),this.BNg=Date.now(),this.f4d(Ca,u,P,la)):
this.ESc(la,Ca,P)}}f4d(u,P,la,Ca){if(this.yXa){if(this.axe===Ce.a.insertPicture&&u===Ce.a.refresh){this.wb.Kg(this.yXa);this.wb.Hb(this.yXa);return}this.c_d()}this.Un.isVisible&&(this.Ey.HJa(this.Pb.correlationId,qj.a.pending),this.Htd(u));const Ta=this.ua.Ba;if(Ta){var pb=Ta.sid,Sb=Ta.cid;this.axe=u;this.yXa=new O.a(2,1,P,()=>{this.c_d();this.Un.isVisible&&N.a.J(512496542,829,50,"Potential candidate for {0} request for designer pane",u);this.Pyl(u,pb,Sb)||this.ESc(Ca,u,la)},void 0,"DesignerDelayTriggerTask");
this.wb.Hb(this.yXa)}}c_d(){this.yXa&&(this.wb.Kg(this.yXa),this.axe=this.yXa=null)}dea(u,P=null,la=null){P||(P={});this.ESc(Ca=>{if(this.la.designerRequestThrottlingEnabled){if(this.xna.vtg&&+new Date-+this.xna.Awg<this.la.designerRequestThrottleIntervalMs){this.FM=new Gi;this.FM.sid=Ca.sid;this.FM.cid=Ca.cid;this.FM.trigger=Ca.trigger;this.FM.h_c=Ca.RL;N.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",u,Ca.sid);return}this.xna=
cd.inProgress;this.FM=null}const Ta=()=>{this.dea(this.FM.trigger,this.FM.h_c,la)};this.ei.Hka(Ca.cid,Ca.sid,Ca.correlationId,Bn.ffe(),Ca.trigger,la,Xh.c(Ca.RL),pb=>{pb&&pb.Status===mf.a.Ath?this.erd(()=>{this.dea(Ca.trigger,Ca.RL,la)}):this.uJa=0;this.uJa||this.Y9b(Ta)},pb=>this.Iib(pb,Ta))},u,P)}erd(u){this.uJa<this.la.designerMaxRetryOnWait?this.wb.Hb(new O.a(2,1,1E3,()=>{N.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Pb.correlationId);this.xna=
cd.ready;this.uJa++;u()},void 0,"RetryRequestOnWait")):N.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Pb.correlationId)}Hlj(u,P=null){P=P||{};this.la.BQc&&u===Ce.a.newDocument&&(P[mf.a.D0i]="true");this.la.sWi&&(P[mf.a.nHl]=this.oNg);this.Ap.vta()&&(this.la.ESa?(P[mf.a.SRh]=this.Bp.zfe(),P[mf.a.TRh]=!0):P[mf.a.cPf]=!0);this.Bp.G_c(u)&&(P[mf.a.qlg]=!0);this.Ey.kYj()&&(P[mf.a.P_d]=this.Ey.P_d());P.NewPaneEnabled=!0;var la=!fc.a.Xa(this.Pb.VW);
(P.RequestForEditorCardsForNewIdeasPane=la)&&(P.NumEditorCritiques=this.lMi());la={};la.SupportsImageToTableSuggestedAction=32===this.ia.processAction(wb.a.nRe,1);P.PPTOEnabledSuggestedActions=Xh.c(la);this.la.cAa&&u===Ce.a.mKa&&(P[mf.a.Xib]=this.la.Xib,P[mf.a.dQe]=this.la.dQe,P[mf.a.cQe]=this.la.cQe);return P}lMi(){let u=0;for(const P of this.Pb.VW)for(const la of P.critiques)u+=la.suggestions.length;return u}MVj(u){if(void 0===u||null===u)return!0;switch(u){case wb.a.t8:case wb.a.wtb:case wb.a.cib:case wb.a.xmc:case wb.a.zIb:case wb.a.dib:case wb.a.zmc:case wb.a.BIb:case wb.a.ymc:case wb.a.AIb:case wb.a.LUf:return!0;
case wb.a.BSc:return this.la.ka("ChatPPTImgShowDesigner")&&Gd.a("DesignerIgnore")&&Date.now()<this.BNg+this.la.uc("ChatPPTImgIgnoreRefreshMs",2E4);case wb.a.BJa:case wb.a.Ckb:case wb.a.gtc:case Dg.a.tVa:case wb.a.bringForward:case wb.a.bringToFront:case wb.a.sendToBack:case wb.a.sendBackward:return!this.Pb.jU;default:return!1}}XQi(u,P=null){const la=this.ua.Ba;return la?Object.assign(new xp,{trigger:u,sid:la.sid,cid:la.cid,RL:this.Hlj(u,P)}):null}L5j(u){return this.M5j(u)}M5j(u){if(!u||!u.sid||!this.$1c(u.trigger)&&
!this.Un.isVisible)return!1;switch(u.trigger){case Ce.a.boa:case Ce.a.Owc:case Ce.a.JQb:case Ce.a.insertPicture:case Ce.a.Dtb:case Ce.a.w4d:case Ce.a.m1d:case Ce.a.eya:case Ce.a.P4e:case Ce.a.K4e:case Ce.a.insertTable:return!0;case Ce.a.b0c:return this.la.lMh;case Ce.a.typing:return this.la.PUf&&this.Un.isVisible;case Ce.a.Jkb:return this.la.designerRetriggerEnabled&&this.Pb.jU;case Ce.a.FZd:case Ce.a.EUf:return this.la.designerDesignElementsRemovedEnabled;case Ce.a.mKa:return this.la.cAa;case Ce.a.ZVd:case Ce.a.zZd:case Ce.a.Uub:return this.la.triggerDesignerAfterApplyReplaceObject;
case Ce.a.refresh:return this.E5j(u.RL);case Ce.a.moreIdeas:return this.la.gka;case Ce.a.newDocument:return this.la.BQc&&this.la.qJ&&!(Gd.a("DesignerInvokeFix")&&this.la.ccb);case Ce.a.kVd:return this.la.a9e;default:return N.a.J(512496538,829,15,"invalid trigger: {0}",u.trigger),!1}}E5j(u){return mf.a.dTc in u&&u[mf.a.dTc]||mf.a.undoRedo in u&&u[mf.a.undoRedo]||this.la.oWi&&this.Ey.Ap.Mo.isVisible?!0:!1}$1c(u){switch(u){case Ce.a.Owc:case Ce.a.JQb:case Ce.a.insertPicture:case Ce.a.b0c:case Ce.a.K4e:case Ce.a.FZd:case Ce.a.Dtb:case Ce.a.eya:case Ce.a.newDocument:case Ce.a.ZVd:case Ce.a.w4d:case Ce.a.m1d:return!0;
case Ce.a.kVd:return this.la.a9e;case Ce.a.mKa:return this.la.cAa;default:return!1}}LVj(u){if(!(this.la.designerSendActionDuration&&mf.a.bE in u.RL&&u.RL[mf.a.bE]))return!1;switch(u.trigger){case Ce.a.Owc:case Ce.a.JQb:case Ce.a.P4e:case Ce.a.newDocument:return!1;case Ce.a.refresh:return!(mf.a.dTc in u.RL)||!(mf.a.undoRedo in u.RL);default:return!0}}Htd(u){const P=u===Ce.a.typing||u===Ce.a.refresh?4:u===Ce.a.moreIdeas?7:1;(this.Ey.Ap.Mo.isVisible||this.$1c(u))&&this.Ap.M1a(P)}s7d(u,P,la){var Ca,Ta;
this.c_d();const pb=this.XQi(P,la);if(this.L5j(pb))if(this.Pb.A7j(this.ua.Ba.sid))this.Htd(pb.trigger),this.erd(()=>{this.ESc(u,P,la)});else{var Sb=null!==(Ta=null===(Ca=pb.RL)||void 0===Ca?void 0:Ca.i0l)&&void 0!==Ta?Ta:null;N.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2} ReTriggerReason: {3}",pb.trigger,pb.sid,pb.correlationId,Sb);this.Pb.correlationId&&!this.Pb.lCb(this.Pb.correlationId)&&(Gd.a("DesignerLogRetriggerReason")?this.glb(this.Ey.Ap.Mo.isVisible,pb.trigger,Sb):this.glb(this.Ey.Ap.Mo.isVisible,
pb.trigger));this.Pb.wvc=new Date;this.Pb.correlationId=pb.correlationId;this.Pb.OYd=pb.trigger;this.Pb.yQ=this.LVj(pb)?pb.RL[mf.a.bE]:new Date;pb.RL[mf.a.pka]===mf.a.copilot&&(this.Pb.$ac=!0);u(pb);this.Htd(pb.trigger);this.Ey.HJa(pb.correlationId,qj.a.pending)}else N.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",P),this.Un.Zp(!1,vg.a.SVf)}ESc(u,P,la){if(this.la.designerAuthEnabled&&this.CM){this.Htd(P);var Ca=new Date;this.CM.mI(this.la.pptDesignerImplicitAuthAppName,
this.la.designerResourceUri).then(Ta=>{const pb=+new Date-+Ca;Ta.IsSuccess?(la[mf.a.F6i]=pb,la[mf.a.enl]=Ta.Token):(la[mf.a.q1f]=pb,N.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Ta.ErrorCode+": "+Ta.ErrorMessage));this.s7d(u,P,la)}).catch(Ta=>{N.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Ta);la[mf.a.q1f]=+new Date-+Ca;this.s7d(u,P,la)})}else this.s7d(u,P,la)}c$e(){if(this.la.BQc&&
this.la.qJ)if(Gd.a("DesignerInvokeFix")&&this.la.ccb)N.a.J(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.ic){var u=this.ua.presentation;if(!u)throw Error.argumentNull("Presentation is null");var P=this.ic.bJ();if(!P||0>=P.length)N.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var la="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===P[0].ThemeFamilyId.toLowerCase();la&&1!==P.length?N.a.J(512496530,829,
15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.$8e||la?!u.slides||0>=u.slides.length?N.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):la&&1!==u.slides.length?N.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(u=null,this.la.Gml&&this.la.Tza&&0<this.la.Tza.length&&(u={},u.TemplateId=this.la.Tza),N.a.J(512496526,
829,50,"Triggering NewDocument designer request"),this.dea(Ce.a.newDocument,u)):N.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else N.a.J(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else N.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.la.BQc,this.la.qJ)}sNe(u,P){this.Pb.RSl(P.A5b)}Pyl(u,P,la){const Ca=this.ua.Ba;if(!Ca)return!0;
const Ta=Ca.cid;return Ca.sid!=P||Ta!=la||!this.Un.isVisible&&!this.$1c(u)}lyj(){const u=document.querySelector("."+rd.TCa);return u&&(this.Bp.Wxb(u,!1)||this.Bp.Wxb(u,!0))?"Kept":"NotKept"}k$f(u){const P=new H.a;if(u&&u.children)for(let la=0;la<u.children.length;la++){const Ca=u.children[la].innerText;Ca&&0<Ca.length&&P.add(u.children[la].innerText)}return P.toArray()}jrj(u){if(!u)return null;var P=u.sa(oi.a.Yib,null);if(P)return P.replace("\r","\n").replace("\n\n","\n").split("\n");if(P=u.sa(oi.a.aV,
null))if(P=this.lR.iKa(P))return this.k$f(P);if(P=u.sa(oi.a.fQe,null))if(u=this.lR.iKa(P))return this.k$f(u);return null}m6(){}l6(u){if(this.la.cAa&&u.actionId===wb.a.Zmd&&32===u.response){var P=this.jb.Ud();if(P&&1===P.length&&P[0].id&&(P=this.jrj(Object(U.a)(10,u.vd)))&&!(0>=P.length)){var la={};la[mf.a.hSk]=P;this.pge(u.actionId,la)}}}uWi(u){switch(u){case mf.a.GTh:return this.la.B0i;default:return!1}}XDj(){this.Un.Zp(!0,vg.a.none);this.dea(Ce.a.m1d);this.Ap.M1a(3)}iNl(u){switch(u){case mf.a.GTh:this.jNl()}}jNl(){if(this.la.YUk)try{const u=
w.a.instance.Ia("Common.ISystemInitiatedFeedback");u&&(N.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),u.execute(P=>{P.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(u){N.a.J(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",u)}}mIk(){this.la.a9e&&(this.Un.isVisible||this.PCg||(this.Un.Zp(!0,vg.a.none),this.dea(Ce.a.kVd),this.Ap.M1a(3),N.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),
this.PCg=!0)}static ffe(){const u=document.querySelector("."+rd.TCa);return u&&u.getAttribute(rd.qub)?u.getAttribute(rd.qub).toString():null}}Object(r.a)(Bn,"DesignerActor",null,[144]);var yp=d(551),cm=d(716);class Zo{constructor(u){this.bucketId=u;this.critiques=[]}}Object(r.a)(Zo,"BucketedEditorData",null,[]);class Hi{constructor(u){this.OYd=this.correlationId=this.rXa=this.WAg=null;this.XAb=this.tWa=this.jU=!1;this.Bwc=this.h8e=null;this.Uqg=!1;this.CRa=this.suggestions=this.YRb=this.c0b=this.yQ=
this.cRa=this.bmc=this.bha=this.wvc=null;this.VN=0;this.$ac=this.C5e=this.EJe=this.Pgd=this.PXf=this.FRc=this.GRc=!1;this.awe=[];this.JHe=[];this.Jfc=u;this.r_=T.a.empty;this.D0b=new H.a;this.BRa=new H.a;this.Zsa=new H.a;this.F_c=new H.a;this.Ufa=new H.a;this.L1b=1}qyk(){this.n1a(0,0)}pyk(){this.n1a(1,0)}OJe(){this.n1a(2,4)}n1a(u,P){this.Jfc&&this.Jfc.execute(la=>{const Ca=Object.assign(new cm.a,{cardId:yp.a.hGh,actionType:u,actionEngagement:P});la.Hid(Ca)})}Zyf(u,P){this.lCb(u)||(Array.add(this.awe,
u),N.a.J(509112540,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",u,this.awe.length));this.CYe(!P)}lCb(u){return Array.contains(this.awe,u)}Ayk(u){Array.add(this.JHe,u)}ral(u){Array.remove(this.JHe,u)}A7j(u){return Array.contains(this.JHe,u)}get C0d(){return this.rXa}BJi(){if(this.rXa)return!0;try{const u=w.a.instance.rb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(u)return this.rXa=u,!0}catch(u){N.a.J(509112539,829,15,"error resolving consistencyCheckActor. ex: {0}",
u)}return!1}RSl(u){if(u){var P=[],la=new Rd.a;for(const Ca of u.critiques){u=Ca.bucketId;let Ta=la.ga(u);Ta||(Ta=new Zo(u),la.$(u,Ta),P.push(Ta));Ta.critiques.push(Ca)}this.WAg=P}}get VW(){return this.WAg}CYe(u){this.correlationId="";this.r_=T.a.empty;this.OYd="";this.XAb=this.tWa=this.jU=!1;this.Bwc=null;this.Uqg=!1;this.cRa=this.bmc=this.bha=this.wvc=null;this.D0b.clear();this.YRb=this.c0b=this.yQ=null;this.L1b=1;this.BRa.clear();this.Zsa.clear();this.F_c.clear();this.Ufa.clear();this.VN=0;this.$ac=
this.C5e=this.GRc=this.FRc=this.Pgd=this.EJe=!1;u&&(this.suggestions=this.CRa=null)}}Object(r.a)(Hi,"DesignerContext",null,[1069]);class rk{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(r.a)(rk,"DesignerSuggestions",null,[]);var Hk;(function(u){u[u.init=0]="init";u[u.loading=1]="loading";u[u.noSuggestion=2]="noSuggestion";u[u.showSuggestion=3]="showSuggestion";u[u.refreshing=4]="refreshing";u[u.sameSlideCoauthNoSuggestion=
5]="sameSlideCoauthNoSuggestion";u[u.makeItVisualDrillIn=6]="makeItVisualDrillIn";u[u.loadingMoreIdeas=7]="loadingMoreIdeas";u[u.moreIdeas=8]="moreIdeas";u[u.noSuggestionRibbon=9]="noSuggestionRibbon"})(Hk||(Hk={}));Object(r.b)("DesignerViewState",Hk);class dm{constructor(){this.suggestions=[]}}Object(r.a)(dm,"SlideSuggestionNotificationData",null,[]);var Ko=d(260),Vm=d(399);class ln{constructor(u,P,la){this.iqb=this.kB=!1;u&&(this.S4=u,this.S4.isFeatureEnabled("PowerPointDesigner",!1).then(Ca=>{(this.kB=
Ca)?N.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.iqb=this.S4.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?la?N.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):N.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):N.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.Wsk=this.S4.C0a("PowerPointDesigner",Object(z.a)(this,
this.pxb,"featureStateChangeCallback")),this.pqk=P)}vta(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.S4&&(this.S4.lkb("PowerPointDesigner",this.Wsk),this.S4=null)}get isEnabled(){return this.kB}get isFreemiumUpsellEnabled(){return this.iqb}launchUpsellExperience(u){this.S4&&this.S4.launchUpsellExperience(u)}pxb(u){u&&"PowerPointDesigner"===u.featureName&&(!this.isEnabled&&u.isEnabled&&this.pqk(),this.kB=u.isEnabled)}}Object(r.a)(ln,"DesignerStateManager",null,[]);class em{constructor(u,
P,la){this.$uk=u;this.VB=P;this.xuk=la}toString(){return"SuggestionIndex:"+this.$uk+" SlideId:"+this.VB+" CreationId:"+this.xuk}}Object(r.a)(em,"LoggableSourceContext",null,[]);var zp=d(1200),$o=d(976),Fm=d(550);class Tn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af){this.hhc=!1;this.jJe=0;this.gl=this.TDb=null;this.va=new kn.a;this.Rb=u;this.le=P;this.Rc=la;this.Vr=Ca;this.ia=Ta;this.Pb=pb;this.LB=Sb;this.Mc=Cc;this.Hz=ed;this.pc=ad;this.Fa=Zd;this.la=We;this.Qv=Qf;this.lG=Bh.S$b;this.Cqk=
ResourceStrings.L_Designer;this.uD=Af;this.ob=document.createElement("div");this.ob.className=kg.a.mWi;this.ob.id=Bh.S$b;this.ob.style.position=Hc.a.tba;this.ob.setAttribute(Ja.a.hf,Ja.a.nsa);this.ob.setAttribute(Ja.a.t_,kg.a.y4d);this.Ab=!1;this.AXa=Ib.a.ee();this.AXa.className="DesignerPaneLayoutRoot";this.ob.appendChild(this.AXa);u=t.AFrameworkApplication.fa.Ha("PPTFabricIconDiamondCssUrl");P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",
u);this.ob.appendChild(P);this.Rb.QQa(Object(z.a)(this,this.HY,"onSetOffline"))}dispose(){this.G3();this.ob.removeChild(this.AXa);this.Rb.xMb(Object(z.a)(this,this.HY,"onSetOffline"));N.a.J(509089863,829,50,"DesignerPane::Dispose")}initialize(){this.gl=Tn.vDa(this.le);Sys.UI.DomElement.addCssClass(this.gl,"DesignerPaneCloseButton");this.gl.setAttribute(Ja.a.hf,Ja.a.Ou);this.AXa.appendChild(this.gl);this.Rc.ub(Fa.a.click,this.gl,Object(z.a)(this,this.jDa,"closePaneButtonClickHandler"));this.Vr.addHandler(this.gl,
Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler"));this.TDb=Ib.a.ee();this.TDb.id=kg.a.y4d;this.TDb.className=kg.a.y4d;this.TDb.innerText=this.Cqk;this.AXa.appendChild(this.TDb);this.LB.C4(this.j9f(),Fd.a.$i,this.ob,u=>{u===this.Fa.Ic(Fd.a.sS)&&this.gl?this.XA(!0):this.XU(!0)},()=>{this.XU(!1)});this.Mc.Qca(Object(z.a)(this,this.Oy,"onUnifiedAppStateChanged"));this.Mc.qB(Object(z.a)(this,this.Daa,"onPodSessionRehydrated"));this.Hz.Ysb(Object(z.a)(this,this.Daa,"onPodSessionRehydrated"));N.a.J(509089862,
829,50,"DesignerPane::Initialize")}j9f(){return Fd.a.P8}G3(){this.Rc&&0<this.AXa.childNodes.length&&(this.Rc.Bb(Fa.a.click,this.gl,Object(z.a)(this,this.jDa,"closePaneButtonClickHandler")),this.Vr.removeHandler(this.gl,Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler")),this.AXa.removeChild(this.TDb),this.AXa.removeChild(this.gl));this.Mc.skb(Object(z.a)(this,this.Oy,"onUnifiedAppStateChanged"));this.Mc.Raa(Object(z.a)(this,this.Daa,"onPodSessionRehydrated"));this.Hz.qkb(Object(z.a)(this,this.Daa,
"onPodSessionRehydrated"));this.Fa.Ee&&this.Fa.Ee.name===Fd.a.P8&&this.Fa.wj(Fd.a.P8,!1)}Oy(u,P){P.mcb&&!this.pc.Ho&&this.isVisible&&(N.a.J(509089861,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Pb.correlationId),this.Zp(!1,vg.a.PPb))}HY(u){u&&this.isVisible&&this.Zp(!1,vg.a.PPb)}Daa(){N.a.J(509089860,801,50,"Designer Pane is closed because session is rehydrated.");this.Zp(!1,vg.a.onl)}layout(u,P){const la=P?u.AG(this.width):
u.BG(this.width);this.isVisible&&(P?(Sys.UI.DomElement.addCssClass(this.ob,kg.a.OUf),la.AG(kg.a.x4d)):(Sys.UI.DomElement.addCssClass(this.ob,kg.a.NUf),la.BG(kg.a.x4d)));Ib.a.K6(this.ob,la);return u}Zp(u,P){if(this.Ab!==u){this.Ab=u;var la=this.la.KUf||this.id!==Bh.S$b?mf.a.GPk:Bh.UNj;u?(P={},P[la]=!0,this.Qv.Nwd(Xh.c(P)),this.initialize(),this.ob.style.display=Hc.a.sba,this.Pb.qyk(),N.a.J(509089859,829,50,"DesignerPane::SetIsVisible - Set to visible")):(u={},u[la]=!1,this.Qv.Nwd(Xh.c(u)),this.G3(),
this.ob.style.display=Hc.a.Qe,this.ICl(P)||(this.Pb.Bwc=new Date,1===this.jJe&&(this.Pb.XAb=!0),this.ia.Ja(wb.a.$oa,2,new Fm.a(!0,P))),this.Pb.pyk(),N.a.J(509089858,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.Jsb(this.ob);la=ResourceStrings.L_Designer;this.uD.sK(this,this.Ab,this.id===Bh.S$b?la:ResourceStrings.L_ShowHideDesignerPane,this.j9f());this.Ab&&this.Pb.$ac&&Gd.a("DesignerFocusChatPPT")&&this.ia.processAction(wb.a.ZCa,2,null)}}Jsb(u){t.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(u,
kg.a.OUf):Sys.UI.DomElement.addCssClass(u,kg.a.NUf)}ICl(u){return u===vg.a.bNf||this.isVisible&&u===vg.a.PPb}XU(u){u?this.va.raiseEvent("OnDesignerPaneFocusOn"):this.va.raiseEvent("OnDesignerPaneFocusBlur")}ZAf(u){this.va.addHandler("OnDesignerPaneFocusOn",u)}lrh(u){this.va.removeHandler("OnDesignerPaneFocusOn",u)}$Af(u){this.va.addHandler("OnDesignerPaneFocusBlur",u)}mrh(u){this.va.removeHandler("OnDesignerPaneFocusBlur",u)}Cua(u){!this.isVisible||u.keyCode!==pa.a.jp&&u.keyCode!==pa.a.BK||this.Zp(!1,
vg.a.typing)}jDa(){this.isVisible&&(N.a.J(509089857,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Pb.correlationId),this.Zp(!1,vg.a.PPb));return!0}XA(u){(this.hhc=u)&&this.gl.focus()}get Lba(){return this.jJe}set Lba(u){this.jJe=u}wlb(u){this.setFocus("#"+this.id+" ."+Wd.B6g+":nth-child("+u+") > ."+Wd.lIb)}epl(){this.setFocus("#"+Wd.K9a)}dpl(){this.setFocus("#"+Wd.Iwb)}qtd(u){this.setFocus("."+Wd.SSa+"["+Bh.RSa+'="'+u+'"')}bpl(){this.setFocus("."+
Wd.x5b)}cpl(){this.setFocus("."+Wd.B5b)}setFocus(u){(u=document.querySelector(u))&&kd.FocusManager.Zq(u)}get isVisible(){return this.Ab}get JVa(){return this.hhc}get xa(){return this.ob}get order(){return 7}get id(){return this.lG}get width(){let u=0;this.isVisible&&(u=kg.a.nWi,u+=kg.a.x4d+od.a.Vya);return u}static vDa(u){return Tn.uDa(u,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static uDa(u,P,la,Ca,Ta,pb,Sb){const Cc=Ib.a.xB();Cc.alt=
pb;Cc.className=ia.getImageClassWithCluster(P,Ta);Cc.src=u.qk(P+".png");Cc.setAttribute("Unselectable","on");u=Ib.a.Hl();u.className=la+" cui-img-cont-float";u.appendChild(Cc);la=Ib.a.Hl();la.className=Ca;la.setAttribute("Unselectable","on");la.appendChild(u);Ca=Ib.a.mda();Ca.className="cui-ctl DesignerPaneButton";Ca.title=pb;Ca.setAttribute(Ja.a.hf,Ja.a.Ou);Ca.tabIndex=0;Ca.appendChild(la);Sb&&(pb=Ib.a.Hl(),pb.className="cui-ctl-mediumlabel",pb.setAttribute("Unselectable","on"),pb.innerText=Sb,Ca.appendChild(pb));
return Ca}}Object(r.a)(Tn,"DesignerPane",null,[1065,654,108]);class al{constructor(u,P,la,Ca,Ta,pb){this.Ufd=this.Yec=this.WFb=this.Jo=null;this.dCe=this.Abc=!1;this.SHe=null;this.la=P;this.ia=u;this.qqk=pb;this.Rc=Ca;this.Vr=Ta;this.PEg=mb.KeyInputManager.Va(pa.a.qNa,0);this.ia.ya(wb.a.RRh,J.a.frame,Object(z.a)(this,this.gFi,"closeCallout"));this.sU=Ib.a.ee();this.sU.className="GoPremiumCalloutContainer";this.beb=Tn.vDa(la);Sys.UI.DomElement.addCssClass(this.beb,"GoPremiumCalloutClose");this.beb.setAttribute(Ja.a.hf,
Ja.a.Ou);this.sU.appendChild(this.beb);u=document.createElement("i");u.className=rd.gMc;u.setAttribute(Ja.a.hf,Ja.a.qQ);u.setAttribute("Unselectable","on");u.setAttribute(Ja.a.NI,Ja.a.rB);this.sU.appendChild(u);this.nxa=Ib.a.ee();this.nxa.className="GoPremiumTitle";this.sU.appendChild(this.nxa);this.tU=Ib.a.ee();this.tU.className="GoPremiumSubtitle";this.sU.appendChild(this.tU);this.Mma=Ib.a.ee();this.Mma.className="GoPremiumButton";u=Ib.a.Hl();u.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;
u.setAttribute("Unselectable","on");u.setAttribute(Ja.a.NI,Ja.a.rB);this.Mma.appendChild(u);this.Mma.tabIndex=0;this.Mma.setAttribute(Ja.a.fr,u.innerText);this.Mma.setAttribute(Ja.a.hf,Ja.a.Ou);this.sU.appendChild(this.Mma);this.Jt()}show(u,P,la,Ca,Ta,pb){this.WL&&this.dismiss();this.WFb=Ca;this.Yec=P;this.Ufd=Ta;this.SHe=pb;this.WFb&&Sys.UI.DomElement.addCssClass(this.WFb,this.Ufd);la?(this.nxa.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.tU.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):
(this.nxa.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.tU.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);P.setAttribute(Ja.a.O7a,Ja.a.rB);this.la.xYf?this.Jo=new $o.a(u,document.body,t.AFrameworkApplication.Aa.tS,null):(this.Jo=zp.a.l2d(u,document.body,document.body,2,Object(z.a)(this,this.dismiss,"dismiss")),this.Jo.i8e=120);this.Jo.Mba=310;this.sU.setAttribute(Ja.a.fr,String.format("{0}. {1}",this.nxa.innerText,this.tU.innerText));this.sU.setAttribute(Ja.a.hf,Ja.a.nsa);
this.Vr&&this.Vr.addHandler(this.sU,Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler"));this.Jo.content=this.sU;this.Wra();P=new Sys.UI.Bounds(0,0,ab.a.MYc(),ab.a.LYc());this.Jo.w_=this.eae(P,u,240,la);this.Jo.Mr=!1;this.Jo.Skd=()=>{this.sU.parentNode&&Sys.UI.DomElement.addCssClass(this.sU.parentNode,"GoPremiumCalloutContentContainer");this.Jo.fK&&(Sys.UI.DomElement.addCssClass(this.Jo.fK,"GoPremiumCalloutOuter"),this.Jo.fK.removeAttribute(Ja.a.hf),this.la.xYf||(this.Jo.fK.style.zIndex=String(t.AFrameworkApplication.Aa.Hsb)));
this.Jo.A1e();this.jS(this.Mma);this.Abc=!0};this.Jo.show()}Wra(){if(kd.FocusManager.oN()){var u=kd.FocusManager.instance(),P=u.Ic("callout/modal");P.parent=Fd.a.$i;u.wTd("callout/modal",Fd.a.$i,this.sU);u.cV("callout/modal",!1);P.bindAction(this.PEg,wb.a.RRh);P=new rf.DOMFocusListing(()=>this.sU);P.gkb=!0;P.So(2);u=u.Aja(()=>this.sU,u.Ic("callout/modal"),P);u.hkb();u.GX=!0;u.XRa=!0}}mkb(){if(kd.FocusManager.oN()&&!t.AFrameworkApplication.Yg){const P=kd.FocusManager.instance();var u=P.Ic("callout/modal");
u&&u.hw(this.PEg);P.J1("callout/modal");(u=P.LQ("callout/modal"))&&u.Gj.mF(null);P.rMb("callout/modal")}}jS(u){kd.FocusManager.oN()?kd.FocusManager.instance().LQ("callout/modal").Gj.x$a(u):u.focus()}get WL(){return!!this.Jo&&this.Jo.WL}CJj(){this.WL&&(this.Abc?this.beb.focus():this.Mma.focus(),this.Abc=!this.Abc)}cWf(){this.dismiss();return!0}gFi(){this.dismiss();return 32}dismiss(){if(!this.dCe){this.dCe=!0;try{this.mkb(),this.Yec&&(this.Yec.setAttribute(Ja.a.O7a,Ja.a.qja),kd.FocusManager.Zq(this.Yec),
this.Yec=null),this.WFb&&(Sys.UI.DomElement.removeCssClass(this.WFb,this.Ufd),this.WFb=null),this.SHe=this.Ufd=null,this.Abc=!1,this.Jo&&(this.Jo.dismiss(),this.Jo.dispose(),this.Jo=null),this.Vr&&this.Vr.removeHandler(this.sU,Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler"))}finally{this.dCe=!1}}}dispose(){this.dismiss();this.Ypa();this.sU=this.beb=this.Mma=null}Cua(u){if(u.keyCode===pa.a.jp||u.keyCode===pa.a.BK){u.preventDefault();u=document.activeElement;try{u?u.click():N.a.J(590967751,
829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(P){N.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",P)}}}ibh(){this.qqk(this.SHe);return!0}Jt(){this.Rc?(this.Rc.ub(Fa.a.click,this.beb,Object(z.a)(this,this.cWf,"dismissAndReturn")),this.Rc.ub(Fa.a.click,this.Mma,Object(z.a)(this,this.ibh,"onGoPremiumClicked"))):N.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}Ypa(){this.Rc&&
(this.Rc.Bb(Fa.a.click,this.beb,Object(z.a)(this,this.cWf,"dismissAndReturn")),this.Rc.Bb(Fa.a.click,this.Mma,Object(z.a)(this,this.ibh,"onGoPremiumClicked")))}eae(u,P,la,Ca){if(Ca)return 0;Ca=6;P.y-u.y<la&&(Ca=3);return Ca}}Object(r.a)(al,"PremiumContentCallout",null,[]);class mn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc){this.nwb=u;this.m4i=P;this.KSc=la;this.Qh=Ca;this.aha=Ta;this.r$a=pb;this.u4e=Sb;this.dAd=Cc}}Object(r.a)(mn,"RenderSuggestionsArgs",null,[1239]);class Un extends Sys.EventArgs{constructor(u){super();
this.card=u}}Object(r.a)(Un,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class ap extends Sys.EventArgs{constructor(u){super();this.k5c=u}}Object(r.a)(ap,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class ko extends Sys.EventArgs{constructor(u,P){super();this.vll=u;this.kHl=P}}Object(r.a)(ko,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class lo extends Ko.a{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af){super(new Vm.a,u,pb);this.reb=this.seb=this.oM=this.N0=this.Ifc=this.UX=
null;this.$Gg=this.eHg=0;this.Sma=!1;this.B2g=this.iIa=this.Ow=null;this.Un=la;this.Bp=Ca;this.Pb=Ta;this.Fa=Sb;this.Rc=Cc;this.le=P;this.Xr=ed;this.Vr=ad;this.ia=Zd;this.$d=We;this.la=Qf;this.gSh=this.la.useWideSuggestionThumbs;this.DR=new Pa.a(()=>new al(this.ia,this.la,P,Cc,ad,Object(z.a)(this,this.Jfg,"goPremiumExperience")));this.tDg=new ln(Af,Object(z.a)(this,this.kEk,"onAccountUpgrade"),Qf.ESa);this.KJ=new ye;this.Zmk=Object.assign(new wk(Zd,this.KJ,this.la),{Ax:wb.a.Sbb})}dispose(){this.Sma&&
this.YLf();this.Ow&&(this.Ow.dispose(),this.Ow=null);this.DR.tbb&&this.DR.value.dispose();super.dispose();N.a.J(512496477,829,50,"DesignerView::Dispose")}jac(){this.UX=Ib.a.ee();this.UX.className="DesignerViewContainer";this.container.appendChild(this.UX);this.Sma=!0;N.a.J(512496476,829,50,"DesignerView::InitializeView")}YLf(){this.la.SRc&&this.Bp.wDi();if(this.UX.children&&0<this.UX.children.length)for(const u=0;u<this.UX.children.length;)this.UX.removeChild(this.UX.children[u]);this.Un.Lba=0;this.Un.lrh(Object(z.a)(this,
this.onFocus,"onFocus"));this.Un.mrh(Object(z.a)(this,this.$ah,"onFocusBlur"));this.DR.tbb&&this.DR.value.dismiss();N.a.J(512496475,829,50,"DesignerView::CleanUpView")}M1a(u){N.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Pb.correlationId,Hk[u]);this.LN();4!==u&&7!==u&&8!==u&&(this.YLf(),this.UX.id=this.Pb.correlationId);this.Un.Lba=u;switch(this.Un.Lba){case 1:this.pQj();this.Utl();break;case 7:this.Ttl();break;case 2:this.wQj();break;case 9:this.vQj();
break;case 5:this.JQj();break;case 3:this.PQj();break;case 6:this.qQj();break;case 4:if(u=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let P=0;P<u.length;P++)u[P].style.visibility=eb.a.visible,u[P].setAttribute(rd.LYd,rd.LIf)}this.Un.ZAf(Object(z.a)(this,this.onFocus,"onFocus"));this.Un.$Af(Object(z.a)(this,this.$ah,"onFocusBlur"))}vta(){return this.la.RUf&&this.tDg.vta()}Jfg(u){this.la.RUf&&(N.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",u?u.toString():
""),this.DR.tbb&&this.DR.value.dismiss(),this.tDg.launchUpsellExperience(this.la.ESa?"designertrial":"designer"))}startFreeTrial(){this.DR.tbb&&this.DR.value.dismiss();this.Bp.IMl();this.Pb.C5e=!0;this.Zw(0,!0);N.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}kEk(){N.a.J(512496471,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.DR.tbb&&this.DR.value.dismiss();this.Bp.mRl()}pQj(){this.Ifc=Ib.a.ee();this.Ifc.className="DesignerLoadingView";const u=Ib.a.xB();
u.className=t.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";u.src=lh.a.PN(kg.a.Joa);const P=Ib.a.ee();P.className=t.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";P.innerText=ResourceStrings.L_DesignerLoading;this.Ifc.appendChild(u);N.a.J(512496470,829,50,"DesignerView::spinner shows up");this.Ifc.appendChild(P);this.UX.appendChild(this.Ifc);N.a.J(512496469,829,50,"DesignerView::InitLoadingState")}xQj(){const u=Ib.a.ee();
u.className="DesignerNoSuggestionNewButton";u.tabIndex=0;u.innerText=ResourceStrings.L_DesignerLearnMoreShort;u.setAttribute("Unselectable","on");u.setAttribute(Ja.a.fr,u.innerText);u.setAttribute(Ja.a.hf,Ja.a.Ou);u.setAttribute("href",kg.a.MUf);this.Rc.ub(Fa.a.click,u,Object(z.a)(this,this.LMf,"clickSuggestionLinkHandler"));this.N0.appendChild(u)}uQj(){const u=Ib.a.mda();u.className="DesignerNoSuggestionView-Link";u.setAttribute("href",kg.a.MUf);u.setAttribute("target","_blank");u.innerText=ResourceStrings.L_DesignerLearnMore;
u.tabIndex=0;u.setAttribute(Ja.a.hf,Ja.a.GWd);this.N0.appendChild(u);this.Rc.ub(Fa.a.click,u,Object(z.a)(this,this.LMf,"clickSuggestionLinkHandler"))}wQj(){this.Un.isVisible&&(this.mje(!1),this.seb.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.reb.innerText=ResourceStrings.L_DesignerNoSuggestionContent,N.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}vQj(){this.Un.isVisible&&(this.mje(!0),this.seb.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.reb.innerText=ResourceStrings.L_DesignerNoIdeas,
N.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}JQj(){this.Un.isVisible&&(this.mje(!1),this.seb.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.reb.innerText=ResourceStrings.L_DesignerCoauthorContent,N.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}mje(u){this.N0=Ib.a.ee();this.N0.className=t.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.seb=Ib.a.ee();this.reb=Ib.a.ee();this.Bp.$rh(this.UX);if(u){this.seb.className=
"DesignerNoSuggestionNew-Header";this.reb.className="DesignerNoSuggestionNew-Content";const P=Ib.a.xB();P.src=this.le.qk("DesignerNoIdeas.svg");P.className="DesignerNoIdeasIllustration";this.N0.appendChild(P)}else this.seb.className="DesignerNoSuggestionView-Header",this.reb.className="DesignerNoSuggestionView-Content";this.N0.appendChild(this.seb);this.N0.appendChild(this.reb);u?this.xQj():this.uQj();this.UX.appendChild(this.N0);this.Vr.addHandler(this.N0,Fa.a.Df,Object(z.a)(this,this.Cua,"inputKeyPressHandler"))}PQj(){this.Un.isVisible||
this.Un.Zp(!0,vg.a.none);this.oM=Ib.a.ee();const u=this.gSh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",P=this.gSh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.oM.className=t.AFrameworkApplication.isRtl?P:u;this.UX.appendChild(this.oM);this.la.PUf||(this.Fa.wj(Fd.a.P8,!0),this.Fa.Bd());this.Rc.ub(Fa.a.click,this.oM,Object(z.a)(this,this.IEi,"clickSuggestionHandler"));this.Vr.addHandler(this.oM,Fa.a.Df,Object(z.a)(this,this.Z_c,"inputKeyApplyHandler"));this.Xr.ub(Fa.a.pointerOver,
this.oM,Object(z.a)(this,this.SM,"onPointerOver"));this.Xr.ub(Fa.a.pointerOut,this.oM,Object(z.a)(this,this.sG,"onPointerOut"));N.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}yuj(){return this.d9b(this.oM.querySelector("#"+this.Mo.id+" .DesignerSuggestionResultSelected"))}Llj(){return this.d9b(this.oM.querySelector("#"+this.Mo.id+" ["+rd.l8a+"]:hover"))}d9b(u){let P;return({suggestionIndex:P}=this.Tdg(u)).returnValue?parseInt(P):-1}Tdg(u){let P,la,Ca;Ca=la=P="";if(u){const Ta=u.getAttribute(rd.UCa),
pb=u.getAttribute(rd.l8a);if(!Ta||!pb)return N.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Pb.correlationId),{returnValue:!1,suggestionIndex:P,slideId:la,N4e:Ca};P=Ta.toString();la=pb.toString();(u=u.getAttribute(rd.kMc))?Ca=u.toString():N.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Pb.correlationId);return{returnValue:!0,
suggestionIndex:P,slideId:la,N4e:Ca}}return{returnValue:!1,suggestionIndex:P,slideId:la,N4e:Ca}}e9b(){return this.oM.querySelectorAll("#"+this.Mo.id+" ["+rd.UCa+"]").length}LMf(u){return this.Un.isVisible&&u&&u.HC?this.Vfg(u.HC.className):!1}$da(){const u=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",P=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(t.AFrameworkApplication.isRtl?
P:u))}HEi(u){u=u.getAttribute(rd.UCa).toString();u=this.Pb.CRa[parseInt(u)];if(!u||3!==u.Type&&4!==u.Type)return!1;this.$d.T0k(new Un(u));return!0}BTc(u,P){for(;u&&u.className!==P;)u=u.parentNode;return u}IEi(u){if(!this.Un.isVisible||u.OA!==Sys.UI.MouseButton.leftButton||!this.Bp.Ba||!u.Bc)return!1;var P=u.Bc;try{if(P.className){if(P.className===Wd.lIb||P.className===Wd.mIb||P.className===Wd.sKe||P.className===Wd.zhd)return this.GEi(P);if(P.className.startsWith(Wd.XXf))return this.FEi(P)}else N.a.J(512496462,
829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(Zd){return N.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",P.className,Zd.message),!1}if(u=this.BTc(P,rd.WIf))return this.HEi(u);if(this.vta()){if(P.className===rd.rub)return this.startFreeTrial(),!0;if(P.className===rd.y1b)return u=bb.a.mi(P),this.DR.value.show(u,P,!0,P,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(u=this.BTc(P,rd.x1b))||(u=this.BTc(P,rd.aMc));if(u)return this.Jfg(null),
!0}if(this.la.gka&&(u=this.BTc(P,rd.FYd))){this.Bp.ZZc(this.$da());if(!u.getAttribute(rd.qub))return!1;this.Bp.fBl(this.$da());u=new ap(u.getAttribute(rd.qub).toString());this.$d.f1k(u);return!0}if(Sys.UI.DomElement.containsCssClass(P,"ms-Icon--Diamond")){if(P=P.parentNode,!P)return!1}else if(!(Sys.UI.DomElement.containsCssClass(P,rd.jMc)||Sys.UI.DomElement.containsCssClass(P,rd.B1b)||Sys.UI.DomElement.containsCssClass(P,rd.lMc)||(P=P.firstChild,P)))return!1;u=P.parentNode;var la=document.querySelector("#"+
this.Mo.id+" ."+rd.TCa);if(!({suggestionIndex:Cc,slideId:ed,N4e:ad}=this.Tdg(u)).returnValue)return!1;var Ca=parseInt(Cc),Ta=parseInt(ed);const pb=parseInt(ad)||0;let Sb=this.Pb.r_.sid===Ta;this.la.gka&&(Sb=this.Bp.Wxb(la,!1)===u||this.Bp.Wxb(la,!0)===u);if(Sb)return N.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.$d.zmh(new ko(Ca,this.e9b())),!1;if(u&&u.getAttribute(rd.dMc)){P=null;la=u.childNodes;for(Ca=0;Ca<la.length;Ca++)if(Ta=la[Ca],Sys.UI.DomElement.containsCssClass(Ta,
rd.jMc)){P=Ta;break}la=new em(Cc,ed,ad);P=bb.a.mi(P||u);this.DR.value.show(P,u,!1,null,null,la);return!1}if(Sys.UI.DomElement.containsCssClass(P,rd.lMc))return!1;var Cc=this.Ztj(P,Ta,pb);var ed=Object.assign(new $k,{SuggestionCid:pb,SuggestionSid:Ta,CorrelationId:la.getAttribute("correlationId").toString(),ActiveSlideCid:this.Bp.Ba.cid,ActiveSlideSid:this.Bp.Ba.sid});var ad=P;ad=.01>=Math.abs(ad.width/ad.height-1.33);this.Bp.Wxb(la,ad)?(this.Bp.XLf(la,ad),Cc&&Cc.parentNode&&Cc.parentNode.parentNode&&
this.Bp.XLf(Cc.parentNode.parentNode,ad),this.ia.Ja(wb.a.wtb,2,ed),N.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.Ja(wb.a.t8,2,ed),N.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.jWi&&u&&u.getAttribute(rd.vYd)&&w.a.instance.Ia("Common.ISystemInitiatedFeedback").execute(Zd=>{try{Zd.logActivity("DesignerAnimationSuggestion",null)}catch(We){N.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",
We)}});this.Bp.yyh(P.parentNode,ad);Cc&&this.Bp.yyh(Cc.parentNode,ad);this.Bp.Zwh(this.UX,Ca);this.$d.zmh(new ko(Ca,this.e9b()));return!0}Ztj(u,P,la){var Ca="["+rd.l8a+'="'+P+'"] > .'+rd.B1b;la&&(Ca=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',rd.l8a,P,rd.kMc,la,rd.B1b));P=document.querySelectorAll(Ca);if(!P)return null;for(la=0;la<P.length;la++)if(Ca=P[la],Ca!==u)return Ca;return null}Cua(u){this.Un.isVisible&&(u.keyCode!==pa.a.jp&&u.keyCode!==pa.a.BK||this.Vfg(u.target.className))}Z_c(u){!this.Un.isVisible||
u.keyCode!==pa.a.jp&&u.keyCode!==pa.a.BK||(u.preventDefault(),(u=document.activeElement)&&u.click())}Zw(u,P){if(!(0>u)){var la=this.oM.querySelector("["+rd.UCa+'="'+u+'"]');la?P&&(kd.FocusManager.Zq(la),this.Bp.Zwh(this.UX,u)):N.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",u)}}Zeg(){return this.vta()?this.oM.querySelector("."+rd.y1b)?2:this.oM.querySelector("."+rd.rub)?1:this.oM.querySelector("."+rd.x1b)?3:0:0}iug(){return!!this.oM.querySelector("."+rd.rub+
":focus")}Ktc(u){const P=this.oM.querySelector("."+rd.rub);P?u?kd.FocusManager.Zq(P):P.blur():N.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}hig(){this.kvg()&&this.DR.value.CJj()}kvg(){return this.DR.tbb&&this.DR.value.WL}q9j(u){return u?!!u&&(u.className===rd.rub||u.className===rd.aMc||u.className===rd.y1b||u.className===rd.x1b):!1}rpa(u,P){let la=null;1===P?la=this.oM.querySelector("."+rd.aMc):2===P?la=this.oM.querySelector("."+rd.y1b):3===P&&
(la=this.oM.querySelector("."+rd.x1b));la?u?kd.FocusManager.Zq(la):la.blur():N.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",P)}vtl(u,P){(P=9===P?this.N0.querySelector(".DesignerNoSuggestionNewButton"):this.N0.querySelector(".DesignerNoSuggestionView-Link"))?u?P.focus():P.blur():N.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}P7j(u){return!(9===u?!this.N0.querySelector(".DesignerNoSuggestionNewButton:focus"):
!this.N0.querySelector(".DesignerNoSuggestionView-Link:focus"))}Vfg(u){try{const P=this.N0.querySelector("."+u);if(!P)return!1;const la=P.getAttribute("href").toString();if(!la)return!1;bb.a.openWindow(4,la);return!0}catch(P){return N.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",P),!1}}$ah(){this.Un.isVisible&&this.DR.tbb&&this.DR.value.WL&&this.DR.value.dismiss()}onFocus(){if(this.Un.isVisible)if(2===this.Un.Lba)kd.FocusManager.Zq(this.N0.lastChild);else if(3===this.Un.Lba){var u=
this.Zeg();if(1===u)this.Ktc(!0);else if(3===u)this.rpa(!0,u);else{u=this.yuj();var P=this.Llj();-1===u?this.Zw(-1===P?0:P,!0):this.Zw(u,!0)}}}SM(u){return this.Un.isVisible&&u.Bc?this.WXf(u.clientPoint):!1}Hoi(u){var P;if(u){var la=u.getAttribute(rd.l8a);if((P=u.getAttribute(rd.kMc))&&la)P=P.toString(),la=la.toString();else{N.a.J(509371461,829,10,"DesignerView::applyFirstDesignerSuggestion - Failed to parse suggestion slide creation id and slideId, CorrelationId: {0}",this.Pb.correlationId);return}}N.a.J(508941526,
829,50,"DesignerView::applyFirstDesignerSuggestion - CorrelationId: {0}",this.Pb.correlationId);u=parseInt(la);P=parseInt(P)||0;P=Object.assign(new $k,{SuggestionCid:P,SuggestionSid:u,CorrelationId:this.Pb.correlationId,ActiveSlideCid:this.Bp.Ba.cid,ActiveSlideSid:this.Bp.Ba.sid});this.ia.Ja(wb.a.t8,2,P)}t8(u,P){N.a.J(509089807,829,50,"DesignerView::applyDesignerSuggestion - auto apply designer, CorrelationId: {0}",this.Pb.correlationId);u=Object.assign(new $k,{SuggestionCid:P,SuggestionSid:u,CorrelationId:this.Pb.correlationId,
ActiveSlideCid:this.Bp.Ba.cid,ActiveSlideSid:this.Bp.Ba.sid});this.ia.Ja(wb.a.t8,2,u)}sG(u){return this.Un.isVisible&&u.Bc?this.WXf(u.clientPoint):!1}eFj(u){this.LN();this.M1a(2);N.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",u);this.Un.isVisible&&(this.Pb.tWa=!0,this.ia.Ja(wb.a.$oa,2,new Fm.a(!1,vg.a.Bwd)))}Utl(){const u=this.Pb.correlationId;this.eHg=window.setTimeout(()=>{this.eFj(u)},this.la.z4d)}dFj(u){this.LN();this.Bp.ZZc(this.$da());N.a.J(512496450,
829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",u)}Ttl(){const u=this.Pb.correlationId;this.$Gg=window.setTimeout(()=>{this.dFj(u)},this.la.z4d)}LN(){window.clearTimeout(this.eHg);window.clearTimeout(this.$Gg)}get Mo(){return this.Un}qQj(){this.oM.style.display=eb.a.none;this.Pb.EJe=!0;this.iIa=Ib.a.ee();this.iIa.className=Wd.GAk;const u=this.lRf(Wd.uKe),P=document.createElement("iframe");P.className=P.id=Wd.D6g;const la=this.lRf(Wd.tKe);this.iIa.appendChild(u);this.iIa.appendChild(P);
this.iIa.appendChild(la);this.UX.appendChild(this.iIa);const Ca=this.Fa.Ic(Fd.a.t_c);Ca.parent=sa.AFrame.dE;this.Rc.jJc(Fd.a.t_c,P);Ca.n8(()=>{P.focus();const Ta=Object.assign(new rf.DOMFocusListing(()=>this.iIa),{gkb:!0});Ta.So(3);Ta.So(2);Ta.So(4);Ta.So(1);Ta.So(6);Ta.So(5);kd.FocusManager.instance().cYd(this.iIa,Ca,Ta);const pb=kd.FocusManager.instance().LQ(Fd.a.t_c);pb.hkb();pb.GX=!0;pb.XRa=!0;Ca.hw(kd.FocusManager.instance().Cra);Ca.hw(kd.FocusManager.instance().Dra);Ta.mF(P)});this.Fa.wf(Fd.a.t_c);
this.Vr.addHandler(this.iIa,Fa.a.Df,Object(z.a)(this,this.nA,"keyDownHandler"))}lRf(u){const P=document.createElement("div");P.setAttribute("Id",u);P.setAttribute("tabindex",0);P.setAttribute("position","absolute");P.setAttribute("width","-1000px");P.setAttribute("top","-1000px");return P}nA(u){u.keyCode===Sys.UI.Key.tab&&(u.target.id!==Wd.tKe||u.shiftKey?u.target.id===Wd.uKe&&u.shiftKey&&this.Nzh(u,Wd.tKe):this.Nzh(u,Wd.uKe))}Nzh(u,P){u.preventDefault();u.stopPropagation();(u=document.getElementById(P))&&
u.focus()}GEi(u){switch(u.className){case Wd.zhd:return this.Mo.wlb(1),!0;case Wd.lIb:u=u.querySelector("."+Wd.mIb).innerText;break;case Wd.mIb:u=u.innerText;break;case Wd.sKe:u=u.parentNode.querySelector("."+Wd.mIb).innerText;break;default:return!1}return this.vdl(u)}vdl(u){this.la.gka&&(this.B2g=this.$da().querySelector("."+rd.TCa).getAttribute("correlationId").toString());this.M1a(6);var P=Gb.a.nL(this.la.pptEditingUserId).toString();P=String.format(this.la.insertPictureServiceEndpoint,t.AFrameworkApplication.lcid,
nh.a.He(t.AFrameworkApplication.lcid).name,t.AFrameworkApplication.buildVersion,bi.a.create().toString(),3,P,0);P=P.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+u;u=document.getElementById(Wd.D6g);u.setAttribute("src",P);u.style.visibility=eb.a.visible;this.Ow=(new Qj).getInstance(u.contentWindow,P);this.Ow.Aya(Qe.a.Azf,la=>{if(la=this.KJ.Ugh(la)){const Ca=[];Array.add(Ca,la);this.ia.processAction(wb.a.N3e,2);this.Mo.Zp(!1,vg.a.bNf);this.Zmk.Dua(Ca)}});this.Ow.Aya(Bh.eH,()=>
{this.M1a(3);const la=new mn(this.Pb.suggestions,this.Pb.suggestions?this.Pb.suggestions.SlideSuggestions.length:0,this.Pb.CRa.length,this.la.gka?this.B2g:this.Pb.correlationId,this.$da(),!0,this.vta(),this.Bp.G_c(Ce.a.makeItVisual));this.Bp.JXe(la)});return!0}FEi(u){return Sys.UI.DomElement.containsCssClass(u,Wd.Kwb)||Sys.UI.DomElement.containsCssClass(u,Wd.Jwb)?this.EEj(u):Sys.UI.DomElement.containsCssClass(u,Wd.SSa)||Sys.UI.DomElement.containsCssClass(u,Wd.HRc)||Sys.UI.DomElement.containsCssClass(u,
Wd.aYf)||Sys.UI.DomElement.containsCssClass(u,Wd.$Xf)?this.FEj(u):Sys.UI.DomElement.containsCssClass(u,Wd.x5b)?this.oFj():Sys.UI.DomElement.containsCssClass(u,Wd.B5b)?this.CGj():!1}CGj(){this.ia.processAction(wb.a.oRe,2);this.Mo.Zp(!1,vg.a.UNk);return this.Pb.PXf=!0}WXf(u){const P=this.Pb.C0d;if(!P||fc.a.Xa(this.Pb.VW))return!1;u=bb.a.YTa(u);this.LZj(u)?P.f_c(this.O7f()):P.f_c([]);return!0}LZj(u){for(;u&&u.className!==Wd.f6d;)u=u.parentNode;return!!u&&u.className===Wd.f6d}oFj(){const u=this.Pb.C0d;
if(!u)return!1;u.ignoreCritiques(this.O7f(),4);this.Pb.VW.splice(this.Pb.VN,1);if(this.Pb.VN===this.Pb.VW.length){let P;(P=this.Pb).VN=P.VN-1}this.z6k();return!0}O7f(){const u=[];for(const P of this.Pb.VW[this.Pb.VN].critiques)u.push(P.critiqueId);return u}EEj(u){if(Sys.UI.DomElement.containsCssClass(u,Wd.Kwb)){let P;(P=this.Pb).VN=P.VN-1;this.Pb.VN||(Sys.UI.DomElement.removeCssClass(u,Wd.Kwb),Sys.UI.DomElement.addCssClass(u,Wd.z5b));u=document.getElementById(Wd.Iwb);Sys.UI.DomElement.removeCssClass(u,
Wd.y5b);Sys.UI.DomElement.addCssClass(u,Wd.Jwb)}else{let P;(P=this.Pb).VN=P.VN+1;this.Pb.VN===this.Pb.VW.length-1&&(Sys.UI.DomElement.removeCssClass(u,Wd.Jwb),Sys.UI.DomElement.addCssClass(u,Wd.y5b));u=document.getElementById(Wd.K9a);Sys.UI.DomElement.removeCssClass(u,Wd.z5b);Sys.UI.DomElement.addCssClass(u,Wd.Kwb)}document.getElementById(Wd.e6d).innerText=(this.Pb.VN+1).toString();this.UPh(this.Pb.VN);return!0}UPh(u){var P=this.Pb.VW[u].critiques[0].explanationLabel;document.getElementById(Wd.ZXf).innerText=
P;P=document.getElementById(Wd.bYf);const la=rd.QQf();P.parentNode.replaceChild(la,P);this.Bp.Khg(la,u)}FEj(u){const P=this.Pb.C0d;if(fc.a.Xa(this.Pb.VW)||!P)return!1;u=u.getAttribute(Bh.RSa);var la=document.querySelector("."+Wd.HRc+"["+Bh.RSa+'="'+u+'"]');la&&(la.innerText="\u2713",Sys.UI.DomElement.removeCssClass(la,Wd.HRc),Sys.UI.DomElement.addCssClass(la,Wd.g0i));la=new Rd.a(0);for(const Ca of this.Pb.VW[this.Pb.VN].critiques)la.add(Ca.critiqueId,u);P.cKh(la);return this.Pb.FRc=!0}z6k(){var u=
document.getElementById(Wd.NXf);let P=parseInt(u.innerText);P--;if(0>=P)this.mBl(document.getElementById(Wd.OXf));else{u.innerText=P.toString();this.UPh(this.Pb.VN);u=this.Pb.VN===this.Pb.VW.length-1;const la=document.getElementById(Wd.Iwb);1<P&&!u?(Sys.UI.DomElement.addCssClass(la,Wd.Jwb),Sys.UI.DomElement.removeCssClass(la,Wd.y5b)):(Sys.UI.DomElement.addCssClass(la,Wd.y5b),Sys.UI.DomElement.removeCssClass(la,Wd.Jwb));u&&(document.getElementById(Wd.e6d).innerText=P.toString());u=document.getElementById(Wd.K9a);
1<P&&this.Pb.VN?(Sys.UI.DomElement.addCssClass(u,Wd.Kwb),Sys.UI.DomElement.removeCssClass(u,Wd.z5b)):(Sys.UI.DomElement.addCssClass(u,Wd.z5b),Sys.UI.DomElement.removeCssClass(u,Wd.Kwb))}}mBl(u){const P=Ib.a.ee();P.className=Wd.a0i;const la=new nd.a;la.ah(40,40);la.ypa("0,0,2048,2048");la.Fr(Wd.h0i);var Ca=new Pb.a;Ca.dZ("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Ta=new Pb.a;Ta.dZ("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Ta.xa.setAttribute("class",Wd.k0i);const pb=
new Pb.a;pb.dZ("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
pb.xa.setAttribute("class",Wd.Z_i);const Sb=new Pb.a;Sb.dZ("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Sb.xa.setAttribute("class",Wd.Y_i);la.appendChild(Ca);la.appendChild(Ta);la.appendChild(pb);la.appendChild(Sb);Ca=Ib.a.Hl();Ca.innerText=ResourceStrings.l_ConsistencyCardNoMore;Ca.className=Wd.b0i;P.appendChild(la.xa);P.appendChild(Ca);u.parentNode.replaceChild(P,u)}}lo.W_i=[Wd.K9a,Wd.Iwb,Wd.SSa,Wd.x5b,Wd.B5b];Object(r.a)(lo,"DesignerView",Ko.a,[1064,177,172,108]);var Vn=d(192);class Ik extends Sys.EventArgs{constructor(u,P){super();this.slideId=u.slideId;this.AIh=u.uvc;this.Z_f=u.yba;this.r$a=P;
this.trigger=u.trigger;this.correlationId=u.correlationId}}Object(r.a)(Ik,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class Sk{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af){this.kIg=new rl.a;this.Ap=u;this.Bp=P;this.Pb=la;this.la=Ca;this.ia=Ta;this.ua=pb;this.Fb=Sb;this.Fc=Cc;this.Eb=ed;this.Fa=ad;this.wb=Zd;this.ffc=this.hwe=0;this.VXa=We;this.Iik=Qf;this.kxa=Af;this.Jt()}Jt(){this.Fc.lji(Object(z.a)(this,this.oeh,"onSuggestionsUpdated"));this.Fc.kji(Object(z.a)(this,this.R$g,"onCoauthModifiedSameSlide"));
this.Iik.execute(u=>{u.Fgi(Object(z.a)(this,this.jMk,"onShowMoreSuggestions"),()=>{this.YNb(this.Ap,3)})});this.la.designerIncrementalRenderEnabled&&this.Fc.qki(Object(z.a)(this,this.Reh,"onUserBeginUploadPicture"));this.Fc.XJc(Object(z.a)(this,this.xoa,"onUndoRedo"))}dispose(){this.Fc.ybl(Object(z.a)(this,this.oeh,"onSuggestionsUpdated"));this.Fc.xbl(Object(z.a)(this,this.R$g,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Fc.gcl(Object(z.a)(this,this.Reh,"onUserBeginUploadPicture"));
this.Fc.nqd(Object(z.a)(this,this.xoa,"onUndoRedo"))}wml(u){this.ia.Ja(wb.a.$oa,2,new Fm.a(!1,u))}YNb(u,P){u?u.M1a(P):N.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Pb.correlationId,P)}yJj(u){const P=this.WWi(u);if(P){var la=P.Mo;N.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",u,Hk[la.Lba]);switch(la.Lba){case 3:this.EBk(u,P);break;case 2:case 9:this.DBk(u,P,la.Lba)}}}WWi(u){switch(u){case wb.a.cib:case wb.a.xmc:case wb.a.zIb:case wb.a.dib:case wb.a.zmc:case wb.a.BIb:case wb.a.ymc:case wb.a.AIb:u=
this.Ap;break;default:return null}return u}EBk(u,P){if(P&&P.Mo){var la=document.activeElement;if(la){var Ca=la.getAttribute(rd.UCa),Ta=P.q9j(la),pb=Sys.UI.DomElement.containsCssClass(la,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(la,"IdeasText"),Sb=this.C6g(la)||this.QXf(la),Cc=P.kvg();if(Ca||pb||Sb||Ta||Cc)if(Ca=Ca?parseInt(Ca.toString()):-1,Ta=P.e9b()-1,!(1>Ta))switch(pb=P.Mo,Sb=P.Zeg(),u){case wb.a.cib:if(Cc||1===Sb||3===Sb)break;pb.XA(!1);Ca<Ta&&(P.Zw(Ca,!1),P.Zw(Ca+1,!0));
break;case wb.a.xmc:if(Cc||1===Sb||3===Sb)break;pb.XA(!1);Ca!==Ta&&(P.Zw(Ca,!1),P.Zw(Ta,!0));break;case wb.a.zIb:if(Cc){P.hig();break}this.uGj(P,Ca,Ta,Sb);break;case wb.a.dib:if(Cc||1===Sb||3===Sb)break;pb.XA(!1);0<Ca&&(P.Zw(Ca,!1),P.Zw(Ca-1,!0));break;case wb.a.zmc:if(Cc||1===Sb||3===Sb)break;pb.XA(!1);Ca&&(P.Zw(Ca,!1),P.Zw(0,!0));break;case wb.a.BIb:if(Cc){P.hig();break}this.vGj(P,Ca,Ta,Sb);break;case wb.a.ymc:case wb.a.AIb:Cc||1===Sb||3===Sb||(u=u===wb.a.AIb,P=P.Mo,this.C6g(la)?this.xGj(u,P):this.QXf(la)&&
this.wGj(u,P))}}}}uGj(u,P,la,Ca){const Ta=u.Mo;if(-1===P){switch(Ca){case 1:Ta.JVa?(Ta.XA(!1),u.Ktc(!0)):u.iug()?(u.Ktc(!1),u.rpa(!0,Ca)):(u.rpa(!1,Ca),Ta.XA(!0));return;case 2:Ta.JVa?(Ta.XA(!1),u.Zw(0,!0)):(u.rpa(!1,Ca),Ta.XA(!0));return;case 3:P=Ta.JVa;Ta.XA(!P);u.rpa(P,Ca);return}Ta.XA(!1);u.Zw(0,!0)}else P===la?(u.Zw(P,!1),2===Ca?u.rpa(!0,Ca):Ta.XA(!0)):(u.Zw(P,!1),u.Zw(P+1,!0))}vGj(u,P,la,Ca){const Ta=u.Mo;if(0<P)u.Zw(P,!1),u.Zw(P-1,!0);else if(-1===P){switch(Ca){case 1:Ta.JVa?(Ta.XA(!1),u.rpa(!0,
Ca)):u.iug()?(u.Ktc(!1),Ta.XA(!0)):(u.rpa(!1,Ca),u.Ktc(!0));return;case 2:Ta.JVa?(Ta.XA(!1),u.rpa(!0,Ca)):(u.rpa(!1,Ca),u.Zw(la,!0));return;case 3:P=Ta.JVa;Ta.XA(!P);u.rpa(P,Ca);return}Ta.JVa&&(Ta.XA(!1),u.Zw(la,!0))}else u.Zw(0,!1),Ta.XA(!0)}DBk(u,P,la){if(P){var Ca=P.Mo;if(u===wb.a.zIb||u===wb.a.BIb||u===wb.a.dib||u===wb.a.cib)u=P.P7j(la),Ca.XA(u),P.vtl(!u,la)}}C6g(u){return Sys.UI.DomElement.containsCssClass(u,Wd.zhd)||Sys.UI.DomElement.containsCssClass(u,Wd.lIb)}QXf(u){return u.className.startsWith(Wd.XXf)}xGj(u,
P){var la=document.activeElement;la&&(Sys.UI.DomElement.containsCssClass(la,Wd.lIb)?(la=parseInt(la.getAttribute(Wd.E6g).toString())+1,u?la!==Bh.Nlc?P.wlb(la+1):P.wlb(1):1!==la?P.wlb(la-1):P.wlb(Bh.Nlc)):u?P.wlb(1):P.wlb(Bh.Nlc))}wGj(u,P){var la=document.activeElement;if(la){for(var Ca=lo.W_i,Ta=0;!Sys.UI.DomElement.containsCssClass(la,Ca[Ta]);)if(Ta++,Ta===Ca.length){Ta=-1;break}var pb=document.querySelectorAll("."+Wd.SSa).length;Ca[Ta]!==Wd.SSa?u?Ta!==Ca.length-1&&-1!==Ta?Ca[Ta+1]!==Wd.SSa?this.yzb(Ca[Ta+
1],P):P.qtd(0):this.yzb(Ca[0],P):Ta&&-1!==Ta?Ca[Ta-1]!==Wd.SSa?this.yzb(Ca[Ta-1],P):P.qtd(pb-1):this.yzb(Ca[Ca.length-1],P):(la=parseInt(la.getAttribute(Bh.RSa).toString()),u?la!==pb-1?P.qtd(la+1):this.yzb(Ca[Ta+1],P):la?P.qtd(la-1):this.yzb(Ca[Ta-1],P))}}yzb(u,P){switch(u){case Wd.K9a:P.epl();break;case Wd.Iwb:P.dpl();break;case Wd.x5b:P.bpl();break;case Wd.B5b:P.cpl()}}a$b(u,P){if(this.la.M1c&&this.Ap.Mo.isVisible){if(P&&(u===wb.a.t8||u===wb.a.wtb)){this.Pb.r_=T.a.empty;P=this.ua.presentation;const la=
this.Fb.yd(7,void 0,void 0,void 0,!0);try{la.jc(P),this.la.vWi&&(la.gd=u),P.removeProperty(Bb.a.QDa)}finally{la&&la.dispose()}}this.Bp.pQl(this.Ap.$da());this.la.pWi&&u!==wb.a.t8&&u!==wb.a.wtb&&this.ia.processAction(wb.a.QUf,2)}}xoa(u,P){this.a$b(P.p$e,P.ddb)}iYj(u){return this.Pb.lCb(u)}dvg(u){switch(u){case Dg.a.VWd:case Dg.a.YWd:case Dg.a.T0b:case Dg.a.XWd:case Dg.a.ZWd:case Dg.a.$Wd:case Dg.a.iRa:case Dg.a.aXd:case Dg.a.bXd:case Dg.a.cXd:case Dg.a.dXd:case Dg.a.fXd:case Dg.a.hXd:case Dg.a.backspace:case Dg.a.OCa:case Dg.a.uL:case Dg.a.BSa:case Dg.a.enter:case Dg.a.$B:case Dg.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.M1c}kYj(){return 0<this.ffc}P_d(){return this.ffc}R$g(u,P){u=P.slideId;N.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",u.sid);if((P=this.ua.Ba)&&P.Cb.equals(u)){P="unopened";this.Ap.Mo.isVisible&&(this.Ap.Mo.isVisible&&this.YNb(this.Ap,5),P="set to SameSlideCoauthNoSuggestion UI");let la="unopened";this.Ap.Mo.isVisible&&(this.HJa(this.Pb.correlationId,qj.a.GJa),la="closed");"unopened"===P&&"unopened"===
la||N.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",P,la,u.sid,u.cid,this.Pb.correlationId,this.hwe,this.ffc)}}oeh(u,P){N.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.M1c,this.hwe,
this.ffc,P.correlationId,P.trigger);if(this.isEnabled()){if(u=this.ua.Ba)if(P.slideId.equals(u.Cb))if(this.iYj(P.correlationId))N.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",P.correlationId);else if(this.SWl(P.correlationId))N.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
P.correlationId);else{this.Pb.correlationId!==P.correlationId&&(this.Pb.Zyf(P.correlationId,this.la.gka&&P.trigger===Ce.a.moreIdeas),N.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Pb.correlationId,P.correlationId));if(this.Pb.correlationId===P.correlationId&&this.Ap.Mo.isVisible&&3===this.Ap.Mo.Lba)if(this.la.designerIncrementalRenderEnabled&&fc.a.any(P.uvc.toArray(),la=>0<=this.Pb.Ufa.indexOf(la)))this.Pb.bmc=
new Date,N.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",P.correlationId,P.uvc.toString(),this.Pb.Ufa.toString());else if(u=P.uMa,!this.la.designerIncrementalRenderEnabled||this.Pb.Zsa.contains(u)){N.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",P.correlationId,u.toString());
return}u=rd.u4d(P.XDa);this.yjl(u,P);this.AJj(P);this.zJj(this.Ap,P,u,P.yba,fc.a.Xa(this.Pb.CRa)?P.yba:this.Pb.CRa.length)}else N.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",P.correlationId)}else N.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",P.correlationId)}yjl(u,P){if(u&&P.trigger!==Ce.a.moreIdeas){this.Pb.suggestions||(this.Pb.suggestions=
Object.assign(new rk,{CardData:u.CardData,SlideSuggestions:Array(P.Xie?P.yba:P.p2a)}));if(!fc.a.Xa(u.SlideSuggestions))for(const la of u.SlideSuggestions)this.Pb.suggestions.SlideSuggestions[la.Index]=la;this.Pb.CRa||(this.Pb.CRa=rd.IQk(u))}}zJj(u,P,la,Ca,Ta){N.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",P.correlationId,P.trigger,P.yba,Ca);if(P.trigger===Ce.a.moreIdeas){this.Pb.bha||(this.Pb.bha=new Date);var pb=u.e9b();
this.Bp.wdl(la,u.$da(),P.correlationId,u.vta())||(this.Bp.ZZc(u.$da()),pb=u.e9b()-1);u.Zw(pb,!0);this.YNb(u,8)}else if(!Ca)!this.la.designerNewNoIdeasUxEnabled||P.trigger!==Ce.a.Owc&&P.trigger!==Ce.a.JQb?this.YNb(u,2):this.YNb(u,9),this.Ap.Mo.isVisible?this.HJa(this.Pb.correlationId,qj.a.GJa):this.wml(vg.a.noSuggestion);else if(this.wyl(P.trigger,u.Mo)){var Sb=!0;if(this.la.designerIncrementalRenderEnabled){Sb=null;var Cc=u.$da();Cc&&(Sb=Cc.querySelector("#"+u.Mo.id+" ."+rd.TCa+'[correlationId="'+
P.correlationId+'"]'));Sb=!Sb;N.a.J(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",P.correlationId,P.trigger,Sb);Cc=new Ik(P,Sb);this.Fc.t2k(Cc)}if(Sb){this.YNb(u,3);this.Pb.bha||(this.Pb.bha=new Date);try{this.la.EVk&&this.kxa.execute(ed=>{ed.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(ed){N.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
ed)}}Ca=new mn(la,Ca,Ta,P.correlationId,u.$da(),Sb,u.vta(),this.Bp.G_c(P.trigger));this.Bp.JXe(Ca);this.Pb.$ac&&this.la.ka("ChatPPTHideImg")&&this.$fl();this.Pb.$ac&&this.la.ka("ChatPPTImgAutoApplyDesigner")&&"InsertPicture"===P.trigger&&(Gd.a("DesignerChatPPTApplyOnFirstRender")?Sb&&0<(null===(pb=null===la||void 0===la?void 0:la.SlideSuggestions)||void 0===pb?void 0:pb.length)?u.t8(la.SlideSuggestions[0].SlideId.Sid,la.SlideSuggestions[0].SlideId.Cid):N.a.J(509089808,829,Sb?10:50,"DesignerManager::HandleSuggestionUpdate: not able to get suggestion to apply"):
(P=u.$da().querySelector("."+rd.TCa),null!=P&&u.Hoi(P.childNodes[0])))}}$fl(){const u=this.ua.Ba;if(u){var P=u.W_(la=>0!==la.lQb);P&&P.length&&(P.forEach(la=>{la.lQb=0}),P=new O.a(2,1,this.la.uc("ChatPPTUnhideUpdateMs",2E3),()=>{u.z9(this.Eb.Na,252,!0)},void 0,"ResetTempHiddenShapeTask"),this.wb.Hb(P))}}AJj(u){u.Xie?(fc.a.Xa(this.Pb.suggestions.SlideSuggestions)||this.Pb.suggestions.SlideSuggestions.length===u.yba)&&this.HJa(u.correlationId,qj.a.success,this.Pb.suggestions,u.trigger):this.HJa(u.correlationId,
qj.a.success,this.Pb.suggestions,u.trigger)}wyl(u,P){return P.isVisible||u!==Ce.a.boa&&u!==Ce.a.zZd&&u!==Ce.a.Uub}Rvd(u,P){this.ffc=u;this.hwe=P;this.Fc.Uy(new Vn.a(1))}Reh(){this.Ap.Mo.isVisible&&3===this.Ap.Mo.Lba&&(this.kIg.add(this.Pb.correlationId),this.Ap.M1a(1))}SWl(u){return this.kIg.contains(u)}HJa(u,P,la=null,Ca=""){N.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",u,P,Ca);this.VXa.execute(Ta=>{const pb=this.tLi(u,la);Gb.a.Xa(Ca)||
(pb.trigger=Ca);Ta.notifySlideSuggestion(P,pb)})}tLi(u,P){const la=new dm;la.correlationId=u;if(!P)return N.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",u),la;la.suggestions=this.Bp.oRk(P);return la}jMk(u){u=new mn(this.Pb.suggestions,u.suggestions.length,u.suggestions.length,u.correlationId,this.Ap.$da(),!0,this.Ap.vta(),this.Bp.G_c(u.trigger));this.Bp.JXe(u);this.Fa.wj(Fd.a.P8,!0)}HPk(){return 4===this.Ap.Mo.Lba}EPk(){return 1===
this.Ap.Mo.Lba}}Object(r.a)(Sk,"DesignerManager",null,[1067,108]);class fm{constructor(u,P){this.Fgb=this.Ko=null;this.Fuk=P;this.af=u;this.Dr=!1}get Gh(){return this.Dr}setup(){this.Gh||(this.Fgb=Ib.a.ee(),this.Fgb.setAttribute("Unselectable","on"),this.Fgb.style.position=eb.a.absolute,this.af.addCssClass(this.Fgb,"designerPreviewImageContainer"),this.Ko=new Rb.a,this.Dr=!0)}dispose(){this.Gh&&(this.dismiss(),this.Ko&&this.Ko.xa.parentNode&&(this.Ko.Eq(),this.af.removeCssClass(this.Ko.xa,"designerPreviewImageContainer")))}dismiss(){this.Gh?
(this.D0a(),this.Ko.setVisibility(!1)):N.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}OLa(u){if(this.Gh){this.Fgb&&(this.Fgb.appendChild(this.Ko.xa),this.af.addCssClass(this.Ko.xa,"designerPreviewImageContainer"),this.Ko.setVisibility(!1));var P=this.Fuk.Hc;if(u=this.Wja(u))this.D0a(),P.pPb.appendChild(this.Fgb),this.Ko.xa.appendChild(u),this.Ko.setVisibility(!0);this.Ko.ah(P.WA.clientWidth,P.WA.clientHeight)}else N.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}Wja(u){if(!Gb.a.Xa(u)){const P=
Ib.a.xB();P.setAttribute("Unselectable","on");P.src=u;P.style.height="100%";P.style.width="100%";return P}return null}D0a(){this.Ko.xa.firstChild&&this.Ko.xa.removeChild(this.Ko.xa.firstChild)}}Object(r.a)(fm,"DesignerPreviewImageView",null,[1068]);var $g=d(166);class mm{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We){this.FM=null;this.uJa=0;this.ia=u;this.Fb=P;this.jb=la;this.ua=Ca;this.Eb=Ta;this.la=pb;this.ei=Sb;this.Aj=Cc;this.fc=ed;this.u$=ad;this.wb=Zd;this.Vd=We;this.xna=cd.ready}vb(){this.ia.ra(wb.a.fixIt,
db.a.application,Object(z.a)(this,this.WEj,"handleFixIt"),4);this.ia.ra(wb.a.xTe,db.a.application,Object(z.a)(this,this.EHj,"handleQueryFixIt"),96);this.ia.ra(wb.a.xtb,db.a.application,Object(z.a)(this,this.xtb,"applyFixItSuggestion"),4);this.ia.ra(wb.a.K0a,db.a.application,Object(z.a)(this,this.K0a,"reportFixItSessionInfo"),64);this.u$.W_b(Object(z.a)(this,this.ega,"onBlockingStateChanged"))}dispose(){this.u$.iqd(Object(z.a)(this,this.ega,"onBlockingStateChanged"))}WEj(u,P,la){P=this.jb.Ud();if(2>
P.length)return 8;if(1===la)return 32;la=this.ua.presentation;this.la.designerBlockApplyUntilDraw?this.fc.usa(la,this.ua.Ba,this.Eb.Na,u):this.fc.uw(la,u);this.Aj.B1c=!0;const Ca=[];P.forEach(Ta=>{Array.add(Ca,Ta.get_shapeId())});u={};u.SelectedShapeIds=Ca.join(",");this.Aj.Olb=Ca;this.vge(u);this.Aj.enb=window.setTimeout(()=>{this.XEj(this.Aj.correlationId)},this.la.f3f);return 32}XEj(u){this.Aj.tWa=!0;N.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",u);this.ia.Ja(wb.a.K0a,
2,vg.a.Bwd);this.Vd.eta(Uh.a.Ph(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}vge(u=null,P=null){this.N3i(la=>{if(this.la.designerRequestThrottlingEnabled){if(this.xna.vtg&&+new Date-+this.xna.Awg<this.la.designerRequestThrottleIntervalMs){this.FM=new Gi;this.FM.sid=la.sid;this.FM.cid=la.cid;this.FM.h_c=la.RL;return}this.xna=cd.inProgress;this.FM=null}const Ca=()=>{this.vge(this.FM.h_c,P)};this.ei.Hka(la.cid,la.sid,la.correlationId,null,mf.a.fixIt,
P,Xh.c(la.RL),Ta=>{Ta&&Ta.Status===mf.a.Ath?this.erd(()=>{this.vge(la.RL,P)}):this.uJa=0;this.uJa||this.Y9b(Ca)},Ta=>this.Iib(Ta,Ca))},u)}erd(u){this.uJa<this.la.designerMaxRetryOnWait?this.wb.Hb(new O.a(2,1,1E3,()=>{N.a.J(578937822,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Aj.correlationId);this.xna=cd.ready;this.uJa++;u()},void 0,"RetryRequestOnWait")):N.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",
this.Aj.correlationId)}xtb(u,P,la,Ca,Ta){P=this.ua.presentation;if(!this.ua.Ba||!P)return 16;Ca=null;Object(qk.a)($k,Ta)&&(Ca=Ta);if(!Ca)return 8;if(1===la)return 32;la=this.Fb.ke(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&(this.Aj.cRa=new Date),la.jc(P),la.gd=u,P.QDa=Ca,this.Aj.r_=T.a.ax(Ca.SuggestionSid,Ca.SuggestionCid),this.Aj.jU=!0,N.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ca.CorrelationId,u,Ca.SuggestionSid)}finally{la&&
la.dispose()}return 32}N3i(u,P=null){const la=this.ua.Ba;la&&la.sid&&(P=Object.assign(new xp,{sid:la.sid,cid:la.cid,RL:P||{}}),N.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",P.sid,P.correlationId),this.Aj.correlationId&&this.glb(vg.a.Jkb),this.Aj.o2a=new Date,this.Aj.correlationId=P.correlationId,this.Aj.yQ=new Date,u(P))}Y9b(u){this.la.designerRequestThrottlingEnabled&&(this.xna=cd.ready,this.FM&&u())}Iib(u,P){this.Y9b(P);N.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",
u.HttpStatusCode);return!0}EHj(u,P,la,Ca,Ta){this.WMl();if(!Object(qk.a)(lm.a,Ta))return 8;if(1<this.jb.Bsd()){let pb;(pb=this.Aj).oub=pb.oub+1;return 32}return 8}K0a(u,P,la,Ca,Ta){if(Ta===vg.a.noSuggestion||Ta===vg.a.Bwd)this.la.designerBlockApplyUntilDraw?this.fc.qxc($g.e(this.ua.Ba,this.Eb.Na)):this.fc.zK(this.ua.presentation);this.glb(Ta);return 32}ega(u,P){if(this.Aj.B1c){u=this.fc.fd(this.ua.presentation);const la=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";
u||Object(U.a)(String,P.actionName)!==la||(window.clearTimeout(this.Aj.enb),this.Aj.tWa||(this.Aj.n2a=new Date),this.Aj.cRa=null,this.Aj.B1c=!1)}}glb(u){const P=this.Aj.correlationId;if(Gb.a.Xa(P))N.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",u);else{var la={};this.Aj.r_&&(la.SuggestionSlideId=this.Aj.r_.sid.toString(),la.SuggestionSlideCreationId=this.Aj.r_.cid.toString());la.AppliedSuggestion=this.Aj.jU;la.DisplaySuggestionsTimeoutInMs=this.la.f3f;
la.SuggestionsTimeout=this.Aj.tWa;la.ClientAbort=this.Aj.XAb;la.ResetReason=u;la.DesignerSendTraceRequestOnSessionEnded=this.la.A4d;var Ca=Hd.b(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),Ta={};Ta.ClientOS=Ca.Os;Ta.Browser=Ca.Browser||"";Ta.BrowserVersion=Ca.BrowserVersion||"";Ta.BrowserMajorVersion=Ca.BrowserMajorVersion||"";Ta.BrowserMinorVersion=Ca.BrowserMinorVersion||"";this.Aj.o2a&&this.Aj.QPb&&this.Aj.QPb>this.Aj.o2a&&(Ta.SuggestionsE2ETimeMs=+this.Aj.QPb-+this.Aj.o2a);
this.Aj.o2a&&this.Aj.n2a&&this.Aj.n2a>this.Aj.o2a&&(Ta.SuggestionAppliedE2ETimeMs=+this.Aj.n2a-+this.Aj.o2a);la.BrowserData=Ta;this.Aj.yQ&&this.Aj.n2a&&this.Aj.n2a>this.Aj.yQ&&(la.TimeToDisplaySuggestionsInMs=+this.Aj.n2a-+this.Aj.yQ);this.Aj.g8e&&(la.TimeSuggestionsRendered=this.Aj.g8e.toUTCString());this.ei.$oa(P,Xh.c(la),u===vg.a.Vsd);this.Aj.CYe();N.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
u,P)}}WMl(){try{const u=w.a.instance.Ia("Common.ISystemInitiatedFeedback");u&&u.execute(P=>{P.logActivity("AutoFixInViewportActivity",null)})}catch(u){N.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",u)}}m6(){}l6(){}}Object(r.a)(mm,"FixItActor",null,[144]);class tl{constructor(){this.oub=0;this.correlationId=this.Olb=null;this.enb=0;this.XAb=this.B1c=this.jU=this.tWa=!1;this.suggestion=this.yQ=this.n2a=this.cRa=this.QPb=this.o2a=this.g8e=null;this.r_=
T.a.empty}CYe(){this.oub=0;this.correlationId=this.Olb=null;this.r_=T.a.empty;this.enb=0;this.XAb=this.B1c=this.jU=this.tWa=!1;this.yQ=this.n2a=this.cRa=this.QPb=this.o2a=this.g8e=null}}Object(r.a)(tl,"FixItContext",null,[1072]);var El=d(969),Pi=d(1005),Lo=d(870),yk=d(937);class Ve{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad){this.ia=u;this.ua=P;this.Fb=la;this.Fc=Ca;this.Aj=Ta;this.Rf=pb;this.PHb=Sb;this.DJ=Cc;this.Mc=ed;this.Vd=ad;this.Jt()}Jt(){this.PHb.V_b(Object(z.a)(this,this.TH,"onEvent"));this.Rf.LI(Object(z.a)(this,
this.TH,"onEvent"));this.Mc.CCa(Object(z.a)(this,this.TH,"onEvent"));this.Mc.qB(Object(z.a)(this,this.TH,"onEvent"));this.Fc.xji(Object(z.a)(this,this.neh,"onSuggestionReceived"));this.Fc.XJc(Object(z.a)(this,this.xoa,"onUndoRedo"))}dispose(){this.Fc.Fbl(Object(z.a)(this,this.neh,"onSuggestionReceived"));this.Fc.nqd(Object(z.a)(this,this.xoa,"onUndoRedo"))}neh(u,P){if(u=this.ua.Ba)if(P.slideId.equals(u.Cb))if(this.Aj.correlationId!==P.correlationId)N.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",
this.Aj.correlationId,P.correlationId);else if(u=Ve.u4d(P.XDa),u.SlideSuggestion)this.Aj.QPb||(this.Aj.QPb=new Date),P=Object.assign(new $k,{SuggestionCid:u.SlideSuggestion.SlideId.Cid,SuggestionSid:u.SlideSuggestion.SlideId.Sid,CorrelationId:P.correlationId,ActiveSlideCid:Object(U.a)(116,this.ua.Ba).cid,ActiveSlideSid:Object(U.a)(116,this.ua.Ba).sid}),this.ia.Ja(wb.a.xtb,2,P);else switch(this.ia.Ja(wb.a.K0a,2,vg.a.noSuggestion),u.ResponseDescription){case "Invalid request":this.Vd.eta(Uh.a.Ph(122),
0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Vd.eta(Uh.a.Ph(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Vd.eta(Uh.a.Ph(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else N.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",
P.correlationId)}RQ(u){this.Aj.correlationId&&u!==wb.a.xtb&&this.ia.Ja(wb.a.K0a,2,vg.a.dSb+this.DJ.F6(u))}a$b(u,P,la){if(this.Aj.correlationId&&la&&P===wb.a.xtb){this.Aj.r_=T.a.empty;la=this.ua.presentation;const Ca=this.Fb.yd(7,void 0,void 0,void 0,!0);try{Ca.jc(la),Ca.gd=P,la.removeProperty(Bb.a.QDa)}finally{Ca&&Ca.dispose()}this.ia.Ja(wb.a.K0a,2,vg.a.dSb+this.DJ.F6(u))}}xoa(u,P){this.a$b(P.actionId,P.p$e,P.ddb)}TH(u,P){u=!1;let la="";if(Object(qk.a)(El.a,P)){N.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",
this.Aj.correlationId,yg.a[Object(U.a)(El.a,P).iC]);if(1===Object(U.a)(El.a,P).iC||3===Object(U.a)(El.a,P).iC)u=!0;la=vg.a.Vsd}else Object(qk.a)(Pi.a,P)?(N.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),u=!0,la=vg.a.A9k):Object(qk.a)(Lo.a,P)?(u=!0,la=vg.a.slideNavigation):Object(qk.a)(yk.a,P)&&Object(U.a)(yk.a,P).uBb&&this.RQ(Object(U.a)(yk.a,P).actionId);u&&this.Aj.correlationId&&this.ia.Ja(wb.a.K0a,2,la);this.Lgk()}Lgk(){0<this.Aj.oub&&(N.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",
this.Aj.oub),this.Aj.oub=0)}static u4d(u){let P=null;try{P=Hd.a(u)}catch(la){N.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return P}}Object(r.a)(Ve,"FixItManager",null,[1071,108]);var rj=d(1060),lj=d(16),Mo;(function(u){u[u.seen=0]="seen";u[u.keep=1]="keep";u[u.drillIn=2]="drillIn"})(Mo||(Mo={}));Object(r.b)("IdeasCardAction",Mo);var Sl;(function(u){u[u.designer=0]="designer";u[u.makeItVisual=1]="makeItVisual";u[u.editor=2]="editor";u[u.UNKNOWN=
3]="UNKNOWN"})(Sl||(Sl={}));Object(r.b)("IdeasCardType",Sl);class Qi{constructor(u,P){this.Eva=null;this.cjc=!1;this.ia=u;this.la=P;this.ia.ya(wb.a.ideasPaneOpened,db.a.application,Object(z.a)(this,this.nFj,"handleIdeasPaneOpen"));this.ia.ya(wb.a.vie,db.a.application,Object(z.a)(this,this.mFj,"handleIdeasPaneClose"));this.ia.ya(wb.a.zkg,db.a.application,Object(z.a)(this,this.bhg,"handleIdeasKeep"));this.ia.ya(wb.a.Akg,db.a.application,Object(z.a)(this,this.zge,"handleIdeasSee"));this.ia.ya(wb.a.Fkg,
db.a.application,Object(z.a)(this,this.zge,"handleIdeasSee"));this.ia.ya(wb.a.Gkg,db.a.application,Object(z.a)(this,this.yge,"handleIdeasDrillIn"));this.ia.ya(wb.a.Dkg,db.a.application,Object(z.a)(this,this.bhg,"handleIdeasKeep"));this.ia.ya(wb.a.Ekg,db.a.application,Object(z.a)(this,this.zge,"handleIdeasSee"));this.ia.ya(wb.a.Bkg,db.a.application,Object(z.a)(this,this.yge,"handleIdeasDrillIn"));this.ia.ya(wb.a.Ckg,db.a.application,Object(z.a)(this,this.yge,"handleIdeasDrillIn"))}nFj(){if(!this.la.pptIdeasContextEnabled)return 2;
this.cjc=!0;this.HYj()||this.CFl(bi.a.create());return 32}mFj(){if(!this.la.pptIdeasContextEnabled)return 2;this.cjc=!1;return 32}bhg(u){if(!this.la.pptIdeasContextEnabled)return 2;this.mMl(this.F4d(u));return 32}zge(u){if(!this.la.pptIdeasContextEnabled)return 2;this.byd(this.F4d(u));return 32}yge(u){if(!this.la.pptIdeasContextEnabled)return 2;this.kMl(this.F4d(u));return 32}F4d(u){switch(u){case wb.a.zkg:case wb.a.Akg:case wb.a.Bkg:u=0;break;case wb.a.Fkg:case wb.a.Gkg:u=1;break;case wb.a.Dkg:case wb.a.Ekg:case wb.a.Ckg:u=
2;break;default:u=3}return u}CFl(){this.la.pptIdeasContextEnabled&&(this.Eva=new rj.a)}byd(u){this.la.pptIdeasContextEnabled&&this.cjc&&3!==u&&this.Eva&&!this.Eva.any(P=>P.key===u)&&this.Eva.add(new lj.a(u,0))}mMl(u){this.cjc&&3!==u&&this.Eva&&this.Eva.add(new lj.a(u,1))}kMl(u){this.cjc&&3!==u&&this.Eva&&this.Eva.add(new lj.a(u,2))}HYj(){return!!this.Eva&&0<this.Eva.length}}Object(r.a)(Qi,"IdeasContext",null,[1070]);class Wn{constructor(){this.Ny=this.My=null;this.iD=this.Ix=0}}Object(r.a)(Wn,"ImageLocationInfo",
null,[]);var No=d(445);class Oo{}Object(r.a)(Oo,"ImageToTableRequest",null,[]);class zk{}zk.$kg="ImageToTableTile";zk.Ykg="ImageToTable.Request";zk.Zkg="ImageToTable.Response";Object(r.a)(zk,"ImateToTableAugmentationSchemaNames",null,[]);class nm{constructor(){this.i1=this.G0=null}get GG(){return"ImageToTableALWorkflow"}get proto(){return""}get Utb(){this.G0||(this.G0=Object.assign(new No.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:zk.$kg,outputSchema:zk.Ykg,func:Object(z.a)(this,this.kdb,"lambdaBeforeFunc")}));
return this.G0}get htb(){return null}get lMb(){this.i1||(this.i1=Object.assign(new No.a,{name:"LambdaRemote_ImageToTableAL",inputSchema:zk.Ykg,outputSchema:zk.Zkg,func:null}));return this.i1}kdb(u,P,la){u=Object.assign(new Oo,{image:u.image});la(u)}}Object(r.a)(nm,"ImageToTableALWorkflow",null,[958]);class Fl{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(r.a)(Fl,"ImageToTableALv2ResponseWrapper",null,[]);class bp{constructor(){this.sessionId=
null;this.shapeId=this.slideSid=0;this.image=this.Tdc=null}}Object(r.a)(bp,"ImageToTableTile",null,[]);class nn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd){this.ia=u;this.jb=P;this.fc=la;this.Kk=Ca;this.wA=Ta;this.Sb=Sb;this.wk=Cc;this.ove=ed;this.Qma=ad;this.la=Zd}initialize(){this.ia.ya(wb.a.nRe,db.a.application,Object(z.a)(this,this.Ggg,"handleConvertImageToTable"));this.ia.ya(wb.a.vRe,db.a.application,Object(z.a)(this,this.Nhg,"handleReplaceImageWithHtmlTable"));this.Kk.LI(Object(z.a)(this,this.aC,
"onActiveSlideChanged"));this.ove.execute(u=>{const P=new nm;u.registerSimpleRemoteWorkflow(P.GG,P.Utb,P.lMb,P.htb);u.addEventHandler(zk.Zkg,Object(z.a)(this,this.qFj,"handleImageToTableALResults"));u.kQ("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");u.B6("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(z.a)(this,this.SQ,"handleAnnotationEvent"))})}dispose(){this.ia.kK(wb.a.nRe,db.a.application,Object(z.a)(this,this.Ggg,"handleConvertImageToTable"));this.ia.kK(wb.a.vRe,db.a.application,
Object(z.a)(this,this.Nhg,"handleReplaceImageWithHtmlTable"));this.Kk.E6(Object(z.a)(this,this.aC,"onActiveSlideChanged"))}aC(){this.Qma.close()}Ggg(u,P,la){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===la)return 32;u=this.jb.Ud();if(1!==u.length)return 8;const Ca=this.Qma.WNk();if(!Ca)return N.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Ta=u[0];this.la.Ejh&&(this.Qma.Kol(Ca,Ta.slideSid,Ta.get_shapeId(),nn.k2d(Ta)),
this.Qma.Y$g(Ca));this.ove.execute(pb=>{pb.kWl(Ta.slideCid,Ta.slideSid,Ta.get_shapeId(),Sb=>{this.chg(Ca,Ta,Sb)},()=>{this.chg(Ca,Ta,null);return!0})});return 32}SQ(u){if(u&&"errorDescription"in u&&"parentPath"in u&&"errorCode"in u){var P=new Fl,la=u.errorDescription.split(";");P.errorDescription=la[0].split(":")[1];P.processId=la[1].split(":")[1];P.errorCode=u.errorCode;N.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",P.processId,P.errorCode,
P.errorDescription);la=u.parentPath[1].split("|");P.slideId=Number.parseInvariant(la[0]);P.shapeId=Number.parseInvariant(la[2]);P.html=u.html;this.Qma.Iol(P);this.Qma.X$g()}}chg(u,P,la){if(la&&la.ImgData)if(this.la.Ejh)this.Qma.Jol(u,la.ImgData),this.Qma.X$g();else{const Ca=nn.k2d(P),Ta=Object.assign(new bp,{sessionId:u,slideSid:P.slideSid,shapeId:P.get_shapeId(),Tdc:Ca,image:la.ImgData});this.ove.execute(pb=>{pb.submit(zk.$kg,Ta)});this.Qma.Y$g(u)}else this.Qma.sIk(u)}qFj(u,P,la,Ca){N.a.J(512496419,
829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",Ca.processId,Ca.errorCode,Ca.errorDescription);this.Qma.lGk(P,Ca)}Nhg(u,P,la,Ca,Ta){u=this.Sb.dFa(Ta.slideSid);if(!u)return 8;la=(P=u.MQ(Ta.shapeId))?nn.k2d(P):Ta.Tdc;if(!la)return 8;N.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",P.get_shapeId());Ta=this.wk.t2d(!1,u.cid,u.sid,!1,la.My,la.Ny,la.Ix,la.iD,u.Cs()+1,Ta.RJh,"");this.wA.HT([Ta],u,0,null,P);this.fc.uw(u,"ImageToTable");
return 32}static k2d(u){return Object.assign(new Wn,{My:u.My,Ny:u.Ny,Ix:u.Ix,iD:u.iD})}}Object(r.a)(nn,"ImageToTableActor",null,[]);class mo{constructor(u){this.shapeId=this.slideId=0;this.Gie=null;this.Lbf=0;this.Fhe=!1;this.eoc=null;this.f3c=!1;this.B_c=this.Kie=this.I9g=this.rfh=null;this.sessionId=u}}Object(r.a)(mo,"ImageToTableConversionContext",null,[]);class Ii{constructor(){this.shapeId=this.slideSid=0;this.RJh=this.Tdc=null}}Object(r.a)(Ii,"ReplaceImageWithHtmlTableData",null,[]);class Tl{constructor(u,
P,la,Ca){this.ia=u;this.Oc=P;this.Da=la;this.DEe=Ca;this.x$=null}initialize(){this.Oc.execute(u=>{u.PJc(Object(z.a)(this,this.Yah,"onFirstPartyAddInHidden"))});this.DEe.oUd(Object(z.a)(this,this.lhg,"handleMessage"))}dispose(){this.Oc.execute(u=>{u.Ebl(Object(z.a)(this,this.Yah,"onFirstPartyAddInHidden"))});this.DEe.Zqh(Object(z.a)(this,this.lhg,"handleMessage"))}WNk(){this.close();const u=new mo(bi.a.create().toString());u.rfh=new Promise(la=>{u.I9g=()=>{la(u.sessionId)}});const P={};P.cB=ResourceStrings.L_DataFromPicturePaneTitle;
P.assetId="FA000000050";P.n6=()=>{this.zib(u)};P.nonPersistedSettings={["SessionID"]:u.sessionId};P.sourceLocationOverrideResourceId=this.Da.pptImageToTableSourceLocationId;return 32===this.ia.Ja(wb.a.Sga,2,P)?(this.x$=u,this.x$.sessionId):this.x$=null}close(){this.L_d(this.x$)}zib(u){N.a.J(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",u.sessionId);const P=this.Oc.instance.HQ("FA000000050");if(P&&P.settings&&"SessionID"in P.settings){var la;({Su:la}=Hd.d(P.settings.SessionID)).returnValue&&
(u.sessionId===la?(u.eoc=P.instanceId,N.a.J(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",P.instanceId)):N.a.J(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}L_d(u){u&&u.eoc&&(u.f3c=!0,this.ia.Ja(wb.a.hvb,2,u.eoc))}Kol(u,P,la,Ca){if(u=this.iyb(u))u.slideId=P,u.shapeId=la,u.Gie=Ca}Iol(u){const P=this.x$;P&&P.slideId===u.slideId&&P.shapeId===u.shapeId&&(this.x$.B_c=u)}Jol(u,P){if(u=this.iyb(u))u.Kie=P}Y$g(u){const P=this.iyb(u);P&&(P.Lbf=window.setTimeout(()=>
{this.WDj(P)},this.Da.pptImageToTableALWorkflowTimeoutMs))}lGk(u,P){if(u&&P){var la=this.iyb(u.sessionId);if(la&&!la.Fhe)if(la.slideId=u.slideSid,la.shapeId=u.shapeId,la.Gie=u.Tdc,window.clearTimeout(la.Lbf),0===P.errorCode){const Ca={};Ca.tableHtml=P.html;Ca.imageData=u.image;this.sendMessage(la.sessionId,Ca)}else this.Ksd(u.sessionId,"Failed to convert image to table")}}X$g(){const u=this.x$;if(u&&!u.Fhe&&u.B_c&&u.Kie)if(window.clearTimeout(u.Lbf),0===u.B_c.errorCode){const P={};P.tableHtml=u.B_c.html;
P.imageData=u.Kie;this.sendMessage(u.sessionId,P)}else this.Ksd(u.sessionId,"Failed to convert image to table")}sIk(u){this.Ksd(u,"Failed to render the image shape")}WDj(u){u.Fhe=!0;this.Ksd(u.sessionId,"Failed to convert image to table using AL")}lhg(u,P){P=P.message;(u=this.iyb(P.session_id))&&!u.f3c&&("ACK"===P.cmd_type?(N.a.J(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",P.cmd_type),u.I9g()):"cancel"===P.cmd_type?(N.a.J(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",
P.cmd_type),this.L_d(u)):"insert_html"===P.cmd_type?(N.a.J(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",P.cmd_type),P=Object.assign(new Ii,{slideSid:u.slideId,shapeId:u.shapeId,Tdc:u.Gie,RJh:P.parameters}),this.L_d(u),this.ia.Ja(wb.a.vRe,2,P)):N.a.J(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",P.cmd_type))}Ksd(u,P){this.sendMessage(u,{["errorMessage"]:P})}sendMessage(u,P){const la=this.iyb(u);la&&
la.sessionId===u&&la.rfh.then(()=>{this.DEe.sendMessage(la.eoc,P)})}iyb(u){return u&&this.x$&&this.x$.sessionId===u?this.x$:null}Yah(u,P){P&&this.x$&&P.instanceId===this.x$.eoc&&(this.x$=null)}}Object(r.a)(Tl,"ImageToTablePane",null,[1074]);class sj extends Sys.EventArgs{constructor(u){super();this.message=u}}Object(r.a)(sj,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class Bc{constructor(u){this.va=new kn.a;this.Da=u}oUd(u){this.va.addHandler("ImageToDocPaneMessageReceived",u)}Zqh(u){this.va.removeHandler("ImageToDocPaneMessageReceived",
u)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(z.a)(this,this.$lc,"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(z.a)(this,this.$lc,"messageReceivedHandler")):N.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(u){N.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
u.message,u.stack)}}sendMessage(u,P){const la={["imageToTablePaneWildcard"]:"."};for(const Ca of Object.keys(P))la[Ca]=P[Ca];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(u,"onCustomMessage",la,Ca=>{Ca&&N.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",Ca)})}$lc(u){if(u&&this.bcc(u.origin)){var P;({Su:P}=Hd.d(u.data)).returnValue&&P&&(u=Object(U.a)(Object,P),"."===u.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new sj(u)))}}bcc(u){return u&&
u.length&&"null"!==u?u===this.Da.pptImageToTableAllowedOrigin:!1}}Object(r.a)(Bc,"ImageToTablePaneMessenger",null,[1073]);var Wm=d(1129);class Cn{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(r.a)(Cn,"ImageTransformInfo",null,[]);class Gm{constructor(u,P,la,Ca){this.ia=u;this.jb=P;this.ua=la;this.Fc=Ca}initialize(){this.Fc.bii(Object(z.a)(this,this.meh,"onSuggestedActionClick"))}dispose(){this.Fc.Kal(Object(z.a)(this,this.meh,"onSuggestedActionClick"))}meh(u,
P){if((u=P.card)&&this.ua.Ba){var la=this.ua.Ba.yj(),Ca=[];P=[];for(var Ta of la)for(const pb of u.Selects)if(pb.Id===Ta.get_shapeId()){Array.add(Ca,Ta);Array.add(P,Ta.get_shapeId());break}this.jb.iu();this.jb.nh();this.jb.j1a(Ca,!0);if(4===u.Type){if(Ta=this.ua.presentation)Ta.hAb=Object.assign(new Cn,{Scenario:u.Scenario,SlideSid:this.ua.Ba.sid,SlideCid:this.ua.Ba.cid,ShapeIds:P})}else this.ia.processAction(Wm.a.qMc(u.ExecutionActionName),2)}}}Object(r.a)(Gm,"SuggestedActionsHandler",null,[]);class Gl{constructor(){this.K=
null;this.TO=!1}get name(){return"PowerPointWebEditor.Designer"}Xb(u){this.K=u;this.K.register(1064,"PowerPointWebEditor.IDesignerView").na().oa(()=>new lo(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(1065,"PowerPointWebEditor.IDesignerPane").na().oa(()=>new Tn(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(1066,"PowerPointWebEditor.IDesignerViewHelper").na().oa(()=>new rd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.Ia("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(1067,"PowerPointWebEditor.IDesignerManager").na().oa(()=>new Sk(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.Ia("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ia("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ia("Common.ISystemInitiatedFeedback")));this.K.register(1068,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").na().oa(()=>
new fm(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));this.K.register(1069,"PowerPointWebEditor.IDesignerContext").na().oa(()=>new Hi(this.K.Ia("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(1070,"PowerPointWebEditor.Infrared.IIdeasContext").na().oa(()=>new Qi(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1071,"PowerPointWebEditor.IFixItManager").na().oa(()=>
new Ve(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(1072,"PowerPointWebEditor.IFixItContext").na().oa(()=>new tl);(this.TO=this.K.resolve("PowerPointWebEditor.IApplicationContext").rd.yg)&&this.K.register(ej.a,"PowerPointWebEditor.PodsInfoSender").na().oa(()=>new ej.a(t.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),
this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(nn,"PowerPointWebEditor.Designer.ImageToTableActor").na().oa(()=>new nn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1073,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").na().oa(()=>new Bc(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));
this.K.register(1074,"PowerPointWebEditor.Designer.IImageToTablePane").na().oa(()=>new Tl(this.K.resolve("Common.IActionManagerExtended"),this.K.Ia("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(Gm,"PowerPointWebEditor.Designer.SuggestedActionsHandler").na().oa(()=>new Gm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const u=this.K.resolve("Common.IAppSettingsManager");u.$e(()=>{if(u.ka("248")){this.TO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var P=this.K.resolve("PowerPointWebEditor.IDesignerView");const la=w.a.instance.resolve("PowerPointWebEditor.IDesignerPane").xa;P.QCa(la);P.jac();P=null;if(u.ka("1034")&&(P=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const Ca=
new Date;P.mI(u.Ha("1043"),u.Ha("1035")).then(Ta=>{const pb=+new Date-+Ca;Ta.IsSuccess?N.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+pb):(N.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Ta.ErrorCode+": "+Ta.ErrorMessage),N.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+pb))}).catch(Ta=>{N.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+Ca));N.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Ta)})}P=new Bn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.Ia("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),P,this.K.Ia("PowerPointWebEditor.IAgendaMetrics"),this.K.Ia("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));P.vb();P.me();(new mm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).vb();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else N.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){m.a.instance.Ac(uc.a(new Gl,0))}}Object(r.a)(Gl,"PPTWebEditorDesignerPackage",null,[2,3]);class jf{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}Xb(u){this.K=u}init(){const u=this.K.rb("Common.App.PenMinutesManager.IPenMinutesManager");u&&u.Frl()}dispose(){}static main(){m.a.instance.Ac(new jf)}}Object(r.a)(jf,"PPTWebEditorPenMinutesPackage",null,[2,3]);var bl=d(939);class sk{}Object(r.a)(sk,"TextToSmartArtSuggestionData",null,[]);class xe{constructor(){this.suggestions=[]}}Object(r.a)(xe,"TextToSmartArtSuggestionNotificationData",null,[]);class Hg{}Hg.n2e="ShapePresence";Hg.slideNavigation=
"SlideNavigation";Hg.dSb="WebActionId:";Hg.mV="SelectionChanged";Hg.euc="ShapePositionChanged";Hg.Jkb="Retrigger";Hg.BLe="NoSuggestions";Hg.Nhk="LowSuggestions";Hg.fid="NewSession";Hg.qDl="SlideShowStarted";Hg.serverError="ServerError";Hg.NMf="ClientSuggestionTimeOut";Object(r.a)(Hg,"ReplaceObjectResetReason",null,[]);class Dn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg){this.sYa=this.uBe=this.Ueb=!1;this.pa=u;this.Fa=P;this.ua=la;this.fc=Ca;this.u$=Ta;this.Rf=pb;this.ia=Sb;
this.Iz=Cc;this.GIa=ed;this.Jz=ad;this.PHb=We;this.pna=Qf;this.Kdd=Af;this.Fc=Ph;this.DJ=pf;this.wb=He;this.Rb=Yf;this.Au=Zd;this.VXa=Rg;this.Dr=!1}get Gh(){return this.Dr}setup(){this.Gh||(this.Jt(),this.uBe=2===this.Rb.mode,this.Dr=!0)}Jt(){this.pa.FC(Object(z.a)(this,this.CD,"onSelectionChanged"));this.PHb.V_b(Object(z.a)(this,this.PJe,"markedUndo"));this.Rf.LI(Object(z.a)(this,this.aC,"onActiveSlideChanged"));this.pna.D7a(Object(z.a)(this,this.D1,"onSlidePresenceChanged"));this.Fc.Yji(Object(z.a)(this,
this.xOe,"onReplaceObjectResponse"));this.GIa.Zji(Object(z.a)(this,this.yOe,"onReplaceObjectViewDragEnd"));this.u$.W_b(Object(z.a)(this,this.uMe,"onApplyReplaceObjectBlockingStateChanged"));this.Rf.uUd(Object(z.a)(this,this.zxc,"updateEditState"));this.Rb.MI(Object(z.a)(this,this.Eu,"onAppFrameModeSwitched"));this.Fc.QAf(Object(z.a)(this,this.g$g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Fc.PAf(Object(z.a)(this,this.f$g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Fc.XJc(Object(z.a)(this,
this.xoa,"onUndoRedo"))}dispose(){this.Gh&&(this.pa.Cga(Object(z.a)(this,this.CD,"onSelectionChanged")),this.PHb.eXe(Object(z.a)(this,this.PJe,"markedUndo")),this.Rf.E6(Object(z.a)(this,this.aC,"onActiveSlideChanged")),this.pna.wXe(Object(z.a)(this,this.D1,"onSlidePresenceChanged")),this.Fc.Wbl(Object(z.a)(this,this.xOe,"onReplaceObjectResponse")),this.GIa.Xbl(Object(z.a)(this,this.yOe,"onReplaceObjectViewDragEnd")),this.u$.iqd(Object(z.a)(this,this.uMe,"onApplyReplaceObjectBlockingStateChanged")),
this.Rb.WY(Object(z.a)(this,this.Eu,"onAppFrameModeSwitched")),this.Rf.hXe(Object(z.a)(this,this.zxc,"updateEditState")),this.Fc.brh(Object(z.a)(this,this.g$g,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Fc.arh(Object(z.a)(this,this.f$g,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Fc.nqd(Object(z.a)(this,this.xoa,"onUndoRedo")),this.Dr=!1)}S1a(u){return this.Joe()?this.Kdd.ayc(u):!1}selectShape(u){u&&this.pa.selectShape(u,!1)}y2c(u){switch(u){case wb.a.aRa:case wb.a.TKe:case wb.a.lmc:case wb.a.mmc:case wb.a.nmc:case wb.a.omc:case wb.a.BJa:return!0;
default:return!1}}Joe(){return this.Ueb&&this.uBe}Wgh(u,P){const la=[];if(Gb.a.Xa(u))return la;u=u.split(";");if(u.length<P)return N.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",P,u.length),la;for(let Ca=0;Ca<P;++Ca){const Ta=u[Ca].split(":");if(3!==Ta.length)throw P=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",Ca,u[Ca]),N.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",P),Error.create(P);
const pb=bl.a.Fyj(Number.parseInvariant(Ta[1]));Array.add(la,Object.assign(new sk,{index:Ta[0],labelText:Gb.a.Xa(pb)?ResourceStrings.L_SmartArt:pb,imageData:this.GWc(Ta[2])}))}return la}g$g(){this.sYa=!0}f$g(){this.sYa=!1}xoa(u,P){this.RQ(P.actionId)}GWc(u){return Gb.a.Xa(u)?null:"data:image/png;base64,"+u}Eu(u){N.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",u.mode);this.uBe=2===u.mode}zxc(){this.Ueb||N.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.Ueb=!0}TIb(u,P,la,Ca){this.VXa.execute(Ta=>{const pb=Object.assign(new xe,{correlationId:u,shapeId:P,suggestions:la});Ta.notifyTextToSmartArtSuggestion(Ca,pb)})}Ohg(u,P,la){if(P.tE)if(P.U9&&0!==u.lLa)N.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",u.lLa);else{if(0===u.lLa){if(0>=u.Eea){N.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",u.correlationId);this.closeSession(P,Hg.BLe);
return}if(u.Eea<la.replaceObjectMinRequiredSuggestions){N.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",u.correlationId);this.closeSession(P,Hg.Nhk);return}P.U9=!1;P.suggestions=this.Wgh(u.XDa,u.Eea);P.suggestionCount=u.Eea;N.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",P.suggestionCount,u.correlationId)}else if(1===u.lLa){if(Gb.a.Xa(u.XDa)){N.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
u.correlationId);return}P.suggestions=this.Wgh(u.XDa,u.Eea);P.vQb=new Date;la.powerPointIdeasIsEnabled&&this.TIb(u.correlationId,P.shapeId,P.suggestions,qj.a.success)}else 2===u.lLa&&(P.ise=!1,P.shapeId=u.shapeId,this.TIb(P.correlationId,u.shapeId,P.suggestions,qj.a.success));la=P.shape;P.slide&&P.slide.isConnected&&la&&la.isConnected&&this.Au.xGa(la)&&this.Joe()&&(1===u.lLa?this.Jz.Zoh(P.correlationId):this.Jz.Fvd(la))}else N.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
u.correlationId)}}Object(r.a)(Dn,"BaseReplaceObjectManager",null,[926,950]);class Ul{}Ul.none="";Ul.euc="ShapePositionChanged";Object(r.a)(Ul,"ReplaceObjectRetriggerReason",null,[]);class Ji{}Ji.selectShape="SelectShape";Ji.Jkb="Retrigger";Ji.nri="AugLoopRetrigger";Ji.mri="AugLoopDefault";Object(r.a)(Ji,"ReplaceObjectTrigger",null,[]);var Ap=d(518);class on extends Dn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg,$i,jk,fj,Mk){super(Cc,la,Ca,Ta,pb,Sb,ed,ad,Zd,We,Qf,Ph,pf,He,Yf,
$i,jk,fj,Mk);this.rU=u;this.U6c=P;this.htk=Af;this.la=Rg;this.sZg=this.la.replaceObjectGrayFloatieInTyping}Jt(){this.la.replaceObjectUseClientAL?this.U6c.execute(u=>{u.addEventHandler("ShapeTextConvertable",Object(z.a)(this,this.dlh,"processShapeTextConvertibleClientAL"))}):this.rU.execute(u=>{u.addEventHandler("ShapeTextConvertable",Object(z.a)(this,this.SSe,"processShapeTextConvertible"))});this.Fc.pli(Object(z.a)(this,this.Wkd,"onSlideShowStarted"));super.Jt()}dispose(){this.Gh&&(this.la.replaceObjectUseClientAL?
this.U6c.execute(u=>{u.removeEventHandler("ShapeTextConvertable",Object(z.a)(this,this.dlh,"processShapeTextConvertibleClientAL"))}):this.rU.execute(u=>{u.removeEventHandler("ShapeTextConvertable",Object(z.a)(this,this.SSe,"processShapeTextConvertible"))}),this.Fc.Lcl(Object(z.a)(this,this.Wkd,"onSlideShowStarted")));super.dispose()}SSe(u,P){if(u&&P){try{var la=Hd.a(u);var Ca=Hd.a(P)}catch(pb){N.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(la&&!isNaN(la.sid)&&!isNaN(la.cid)&&!isNaN(la.shapeId)&&this.ua.Ba&&(u=new Date(la.c),N.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",la.sid,la.cid,la.shapeId,la.t,la.c?(new Date).getTime()-la.c:-1),(P=this.ua.Ba.MQ(la.shapeId))&&(fc.a.contains(this.Ecg(),P.get_shapeId())||"activeSlideChanged"===la.t)))if(Ca&&!Ca.isTextConvertible)this.Jz.Uoa(P,!0);else{var Ta=this.Iz.G8b(P.get_shapeId());if(Ta&&Ta.Hda&&(Ta=new Ap.a(P,Ta.lha),this.ia.Ja(wb.a.Gjb,
2,Ta),!Ta.Nua))return;this.S1a(P)&&this.Hka(this.ua.Ba,P,Ca&&Ca.smartArtInfo?Ca.smartArtInfo.length:0,la.t||Ji.mri,Ul.none,u)}}}dlh(u,P,la,Ca){P&&Ca&&Ca.ContextId&&Ca.Payload&&this.SSe(Ca.ContextId,Ca.Payload)}Wkd(){this.H_d(Hg.qDl)}CD(u,P){if(!this.Gh)N.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.sYa&&(P.VE.length||!this.Fa.Ee||this.Fa.Ee.name!==Fd.a.qg)){u=this.Ecg();for(let la of this.Iz)la.tE&&!Array.contains(u,la.shapeId)&&
this.closeSession(la,Hg.mV);this.sZg&&!Array.contains(u,this.Jz.vzb)&&this.Jz.B$k()}}yOe(u,P){this.Gh?(u=this.Iz.G8b(P.shape.get_shapeId()))&&u.tE&&(P=u.shape,this.closeSession(u,Hg.euc),this.S1a(P)&&this.Hka(this.ua.Ba,P,0,Ji.nri,Ul.euc)):N.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}PJe(u,P){P.uBb&&this.RQ(P.actionId)}aC(){this.H_d(Hg.slideNavigation)}D1(u,P){if(P.A9&&P.shapes)for(const la of P.shapes)(u=this.Iz.G8b(la))&&u.tE&&this.closeSession(u,
Hg.n2e)}xOe(u,P){(u=this.Iz.zab(P.correlationId))?this.Ohg(P,u,this.la):N.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",P.correlationId)}uMe(){if(this.Gh)for(let u of this.Iz)u.fcb&&0===u.suggestionType&&!this.fc.fd(this.ua.presentation)&&(u.fcb=!1,this.Jz.Uoa(u.shape,!0))}S1a(u){const P=this.Iz.yyf;return 1<=P?(N.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
P),!1):super.S1a(u)}Hka(u,P,la,Ca,Ta,pb=null){try{let Sb=this.Iz.G8b(P.get_shapeId());Sb&&this.closeSession(Sb,Hg.fid);Sb=this.Iz.rPc(u,P.get_shapeId(),Ca,Ta,this.la);Sb.zwc=pb;Sb.Hda="richEditTextUnicodeChanged"===Ca;this.Jz.xxc(Sb.correlationId);const Cc=this.htk.Qxh(Sb);N.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Sb.correlationId,Sb.slide.sid,Sb.slide.cid,Sb.shapeId,Cc);N.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Sb.correlationId,la,Math.min(la,this.la.replaceObjectSuggestionMaxCount),Ca);la&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(la=Math.min(la,this.la.replaceObjectSuggestionMaxCount),Sb.suggestions=this.acj(la),Sb.suggestionCount=la,Sb.U9=!1,this.Jz.Fvd(P));0===Cc&&this.la.powerPointIdeasIsEnabled&&this.TIb(Sb.correlationId,Sb.shapeId,[],qj.a.pending)}catch(Sb){N.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Sb.message)}}acj(u){const P=Array(u);for(let la=0;la<u;la++)Array.add(P,
Object.assign(new sk,{index:la.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return P}RQ(u){this.Gh?this.y2c(u)||this.H_d(Hg.dSb+this.DJ.F6(u)):N.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}mxl(u){if(!this.sZg)return!1;const P=this.pa.Ud();return u.Hda&&Array.contains(P,u.shape)}closeSession(u,P){0===u.suggestionType&&(P===Hg.BLe?this.Jz.Uoa(u.shape,!0):u.Hda&&this.Jz.Uoa(u.shape,!0,P!==Hg.fid,this.mxl(u)),this.Iz.Q0c(u,P),this.la.powerPointIdeasIsEnabled&&
this.TIb(u.correlationId,u.shapeId,u.suggestions,qj.a.GJa))}H_d(u){for(let P of this.Iz)this.closeSession(P,u)}Ecg(){const u=this.pa.Ud(),P=[];u&&u.forEach(la=>{Array.add(P,la.get_shapeId())});return P}}Object(r.a)(on,"AugmentationLoopReplaceObjectManager",Dn,[]);class Xm{constructor(u,P){this.disabled=!1;this.KNg=Kc.App.tn;this.la=u;this.wb=P}Xyh(u){this.disabled=!0;this.KNg=new Date;const P=new O.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.KNg>=
this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&u()});this.wb.Hb(P)}Xpl(u){const P=new O.a(2,1,550,()=>{u()});this.wb.Hb(P)}static rWl(u,P){return 7<=u&&8>=u&&1!==P}}Object(r.a)(Xm,"FlyoutAnchorTimer",null,[]);var om=d(375);class Xn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph){this.Rs=null;this.sYa=!1;this.Fc=P;this.pa=u;this.Iz=la;this.ua=Ca;this.Ga=Ta;this.la=pb;this.Jz=Sb;this.ei=Cc;this.Au=ed;this.pna=ad;this.u$=Zd;this.NXa=We;this.mlc=Qf;this.DJ=Af;this.pc=Ph}Jt(){this.Fc.Bji(Object(z.a)(this,
this.obh,"onIconSuggestionNotification"));this.pa.FC(Object(z.a)(this,this.CD,"onSelectionChanged"));this.Fc.QAf(Object(z.a)(this,this.e$g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Fc.PAf(Object(z.a)(this,this.d$g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Fc.Aji(Object(z.a)(this,this.nbh,"onIconChanged"));this.pna.D7a(Object(z.a)(this,this.D1,"onSlidePresenceChanged"));this.u$.W_b(Object(z.a)(this,this.ega,"onBlockingStateChanged"));this.mlc.V_b(Object(z.a)(this,
this.xib,"onMarkedUndo"))}l$e(){this.Fc.Hbl(Object(z.a)(this,this.obh,"onIconSuggestionNotification"));this.pa.Cga(Object(z.a)(this,this.CD,"onSelectionChanged"));this.Fc.brh(Object(z.a)(this,this.e$g,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Fc.arh(Object(z.a)(this,this.d$g,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Fc.Gbl(Object(z.a)(this,this.nbh,"onIconChanged"));this.pna.wXe(Object(z.a)(this,this.D1,"onSlidePresenceChanged"));this.u$.iqd(Object(z.a)(this,this.ega,
"onBlockingStateChanged"));this.mlc.eXe(Object(z.a)(this,this.xib,"onMarkedUndo"))}dispose(){this.l$e()}setup(){this.Jt()}e$g(){this.sYa=!0}d$g(){this.sYa=!1}nbh(u,P){P&&this.Rs&&this.Rs.Vsc&&this.Rs.slide.sid===P.slideId.sid&&this.Rs.slide.cid===P.slideId.cid&&this.Rs.shapeId===P.shapeId&&this.Rs.R6===P.qZ&&(this.Rs.m_e=P.iconName)}D1(u,P){if(P.A9&&P.shapes&&this.Rs)for(const la of P.shapes)this.Rs.shapeId===la&&this.JW(Hg.n2e)}xib(u,P){P.uBb&&!this.y2c(P.actionId)&&this.JW(Hg.dSb+this.DJ.F6(P.actionId))}y2c(u){switch(u){case wb.a.aRa:case wb.a.TKe:case wb.a.lmc:case wb.a.mmc:case wb.a.nmc:case wb.a.omc:case wb.a.BJa:return!0;
default:return!1}}ega(){if(this.Rs){const u=this.Rs.shape,P=this.Ga.Lr(u);u&&P&&!this.NXa.fd(P)&&(this.Rs.fcb=!1,this.Jz.Uoa(u,!0),this.Rs.xwc=new Date,this.Rs.JW(Hg.mV))}}CD(){if(!this.sYa){var u=this.Ga.cab(this.pa.Ud());if(u){if(this.Rs&&this.Rs.tE){if(om.a.duc(u.jZ,this.Rs.jZ))return;this.JW(Hg.mV)}this.S1a(u)&&this.Hka(this.ua.Ba,u,Ji.selectShape)}else this.Rs&&this.Rs.tE&&this.JW(Hg.mV)}}Hka(u,P,la){this.Rs=this.Iz.gSa(u,P.get_shapeId(),la,"",this.la,P.get_smartArtModelId());this.Rs.U9=!0;this.Jz.xxc(this.Rs.correlationId);
N.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.Rs.correlationId,this.Rs.slide.sid,this.Rs.slide.cid,this.Rs.shapeId,this.Rs.R6);const Ca=P.get_smartArtModelId()?this.Ga.Lr(P):P;Ca?this.ei.Ybj(u.cid,u.sid,Ca.get_shapeId(),this.Au.cYc(Ca),this.Au.bYc(Ca),P.get_smartArtModelId(),this.Rs.correlationId,la,Object(z.a)(this,this.qIk,"onIconSuggestionResponseSuccess"),Object(z.a)(this,this.Iib,"onTaskFailure")):
N.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",P.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}qIk(u){if(u&&u.SuggestionResult){var P=u.CorrelationId,la=this.Iz.zab(P);if(la)if(la.tE){P=null;try{P=Sys.Serialization.JavaScriptSerializer.deserialize(u.SuggestionResult)}catch(Ca){N.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",Ca)}if(P){la.suggestions=this.aRk(P);la.vQb=new Date;if(la.U9){if(this.Sog(la)){N.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",la.x2b,this.la.pptIconChunkingSuggestionTimeoutMs);this.JW(Hg.NMf);return}N.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");la.suggestionCount=la.suggestions?la.suggestions.length:0;la.U9=!1;this.Jz.Fvd(la.shape)}this.Jz.Zoh(la.correlationId)}else this.JW(Hg.serverError),N.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else N.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Rs?this.Rs.correlationId:"",P);else N.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",P)}else this.JW(Hg.serverError),N.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}Iib(u){this.JW(Hg.serverError);
N.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",u.HttpStatusCode);return!0}S1a(u){return this.pc.Ho?u.get_smartArtModelId()&&u.get_isSVGBlipFilled()?(u=this.Ga.Lr(u),!!u&&!u.Hs):!1:!1}JW(u){this.Rs&&(this.Jz.Uoa(this.Rs.shape,!0),this.Iz.Q0c(this.Rs,u),this.Rs=null)}GWc(u){return Gb.a.Xa(u)?null:u.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(u):"data:image/png;base64,"+u}aRk(u){const P=[];if(!u||
!u.length)return P;for(let la=0;la<u.length;++la){const Ca=Object.assign(new sk,{index:u[la].Index.toString(),labelText:u[la].Label,imageData:this.GWc(u[la].Render),renderData:this.GWc(u[la].Replace)});Array.add(P,Ca)}return P}QOi(u,P){const la=[];if(Gb.a.Xa(u)||!P)return la;for(var Ca=0;Ca<P;++Ca){var Ta=Object.assign(new sk,{index:Ca.toString(),labelText:"",imageData:null,renderData:null});Array.add(la,Ta)}u=u.split(";");if(u.length-1!==P)return N.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
la.length,P),la;for(Ca=0;Ca<P;++Ca)Ta=u[Ca].indexOf(":"),0>Ta?N.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):la[Ca].labelText=u[Ca].substr(Ta+1);return la}$Qk(u){let P,la,Ca,Ta;P="";Ca=la=0;Ta=null;if(Gb.a.Xa(u))return N.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:P,Eea:la,LLe:Ca,suggestions:Ta};const pb=u.split("|");if(4!==pb.length)return N.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+u.length),{returnValue:!1,correlationId:P,Eea:la,LLe:Ca,suggestions:Ta};P=pb[0];la=parseInt(pb[1]);Ca=Number.parseInvariant(pb[2]);Ta=this.QOi(pb[3],la);return{returnValue:!0,correlationId:P,Eea:la,LLe:Ca,suggestions:Ta}}obh(u,P){let la,Ca;if(({correlationId:u,Eea:P,LLe:la,suggestions:Ca}=this.$Qk(P.XDa)).returnValue){var Ta=this.Iz.zab(u);if(Ta)if(Ta.tE&&Ta.U9){var pb=Ta.shape;0===la&&(0>=
P?(N.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",u),this.JW(Hg.BLe)):this.Sog(Ta)?(N.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Ta.x2b,this.la.pptIconChunkingSuggestionTimeoutMs),this.JW(Hg.NMf)):(Ta.U9=!1,Ta.suggestionCount=P,Ta.suggestions=Ca,N.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Ta.correlationId,Ta.suggestionCount),this.Jz.Fvd(pb)))}else N.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.Rs?this.Rs.correlationId:"",u,Ta.tE,Ta.U9);else N.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",u)}else N.a.J(38279327,829,50,
"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}Sog(u){const P=new Date,la=u.lha,Ca=this.la.pptIconChunkingSuggestionTimeoutMs;return P&&la&&0<Ca&&+P-+la>Ca?(u.x2b=+P-+la,!0):!1}}Object(r.a)(Xn,"ReplaceIconManager",null,[]);var Bp=d(717),cp=d(1027);class Cp extends Sys.EventArgs{constructor(u){super();this.jZ=u}}Object(r.a)(Cp,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class pn{constructor(){this.shape=null;this.action=0}}Object(r.a)(pn,
"ShowHideReplaceObjectGalleryData",null,[]);class qn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf){this.Dr=this.Ueb=!1;this.ia=P;this.Fa=la;this.ua=Ta;this.Rf=Ca;this.fc=pb;this.HIa=Sb;this.Jz=Zd;this.Eb=We;this.Ga=Qf;this.pa=u;this.Fc=Cc;this.Iz=ed;this.Fb=ad}get Gh(){return this.Dr}setup(){this.Gh||(this.Jt(),this.vb(),this.me(),this.Dr=!0)}dispose(){this.Gh&&(this.l$e(),this.Dr=!1)}Jt(){this.Rf.uUd(Object(z.a)(this,this.zxc,"updateEditState"))}l$e(){this.Rf.hXe(Object(z.a)(this,this.zxc,"updateEditState"))}vb(){this.ia.ra(wb.a.aRa,
db.a.application,Object(z.a)(this,this.aRa,"applyReplaceObjectSuggestion"),4);this.ia.ra(wb.a.X1a,db.a.application,Object(z.a)(this,this.X1a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(wb.a.fPb,db.a.application,Object(z.a)(this,this.X1a,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.ra(wb.a.Bmc,db.a.application,Object(z.a)(this,this.G7g,"navigateReplaceObjectSuggestion"),4);this.ia.ra(wb.a.Amc,db.a.application,Object(z.a)(this,this.G7g,"navigateReplaceObjectSuggestion"),4)}me(){const u=
this.Fa.Ic(Fd.a.DQ),P=this.Fa.Ic(Fd.a.qg),la=this.Fa.Ic(Fd.a.ukb);u.bindAction(mb.KeyInputManager.Va(pa.a.jp,2),wb.a.fPb);P.bindAction(mb.KeyInputManager.Va(pa.a.jp,2),wb.a.fPb);la.bindAction(mb.KeyInputManager.Va(pa.a.jp,2),wb.a.fPb);la.bindAction(mb.KeyInputManager.Va(pa.a.AZ,0),wb.a.fPb);la.bindAction(mb.KeyInputManager.Va(pa.a.Jba,0),wb.a.Bmc);la.bindAction(mb.KeyInputManager.Va(pa.a.wha,0),wb.a.Amc)}zxc(){this.Ueb||N.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");
this.Ueb=!0}aRa(u,P,la,Ca,Ta){if(!this.Gh)return N.a.J(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.fd(P))return 16;if(1===la)return 32;la=!0;Ca=null;Object(qk.a)(Bp.a,Ta)?Ca=Ta:Object(qk.a)(cp.a,Ta)&&(Ca=Ta.VKc,la=!1);Ta=new om.a(T.a.ax(Ca.ActiveSlideSid,Ca.ActiveSlideCid),Ca.ShapeId,Ca.SmartArtSubNodeId);const pb=new Cp(Ta);this.HIa.T1k(pb);const Sb=this.Iz.Aab(Ta);if(Sb&&Sb.shapeId===Ca.ShapeId){let Cc=
null;1===Sb.suggestionType&&(Cc=this.Ga.Lr(Sb.shape));Ta=this.Fb.yd(15,void 0,()=>{1===Sb.suggestionType||this.pa.Js()||(this.Fc.Sod(),this.pa.nh(),this.Fc.Rod())},()=>{Cc&&(this.Fc.Sod(),this.pa.selectShape(Cc,!0),this.Fc.Rod())});try{Ta.jc(P),Ta.gd=Ca.SmartArtSubNodeId?wb.a.YKf:u,P.CMb=Ca,Sb.SKc=Ca.SuggestionSid,Sb.OVd=Ca.Label,Sb.jU=!0,Sb.ywc=new Date,N.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",Ca.CorrelationId,
u,Ca.SuggestionSid)}finally{Ta&&Ta.dispose()}Sb.ise=!0;Sb.fcb=!0;la&&Sb.OJe();0===Sb.suggestionType?this.fc.uw(P,u):Cc?this.fc.usa(P,Cc,this.Eb.Na,u):N.a.J(38854750,808,15,"Invalid smartArtShape")}else N.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}X1a(u,P,la,Ca,Ta){if(!this.Gh)return N.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;P=this.ua.presentation;if(!this.ua.Ba||!P||this.fc.fd(P))return 16;if(1===la)return 32;
la=null;P=0;if(u===wb.a.X1a){u=Object(U.a)(pn,Ta);if(!u)return 16;la=u.shape;P=u.action}else if(u===wb.a.fPb){u=this.pa.Ud();if(1!==u.length)return 32;la=u[0]}if(!la)return N.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;u=this.Iz.Aab(la.jZ);if(!u||!this.Ueb&&u&&0===u.suggestionType)return 2;if(u&&u.tE&&u.shapeId===la.get_shapeId())switch(this.pa.nj(),this.Fa.Bd(),P){case 0:this.Jz.zLl(u.correlationId);break;case 1:this.Jz.WB.isVisible||this.Jz.r4e(u.correlationId);
break;case 2:this.Jz.Zhe(la)}return 32}G7g(u,P,la){if(!this.Gh)return N.a.J(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;P=this.ua.presentation;return this.ua.Ba&&P&&!this.fc.fd(P)?1===la?32:this.Jz.WB.isVisible?u===wb.a.Bmc?(this.Jz.Bmc(),32):u===wb.a.Amc?(this.Jz.Amc(),32):16:16:16}}Object(r.a)(qn,"ReplaceObjectActor",null,[]);class gm{constructor(u,P){this.aP=u;this.V6c=P}initialize(){this.aP.execute(u=>{u.registerSimpleRemoteWorkflow(this.V6c.GG,
this.V6c.Utb,this.V6c.lMb,this.V6c.htb)})}}Object(r.a)(gm,"ReplaceObjectAugLoopRuntimeManager",null,[]);var Jk=d(1133),pm;(function(u){u[u.textToSmartArt=0]="textToSmartArt";u[u.iconChunking=1]="iconChunking"})(pm||(pm={}));Object(r.b)("ReplaceObjectType",pm);class Hm{constructor(u,P){this.y6a=this.US=this.la=null;this.shapeId=0;this.R6=null;this.suggestionType=0;this.Hda=!1;this.SKc=0;this.OVd=null;this.npe=this.bpe=this.fcb=this.jU=!1;this.xwc=this.ywc=this.f8e=this.vQb=this.Cwc=this.RMa=this.zwc=
this.lha=null;this.xxb=this.vvc=0;this.xOd=this.X6a=this.xqa=null;this.U9=!1;this.suggestions=null;this.x2b=this.suggestionCount=0;this.ise=!1;this.Vkb=null;this.Vsc=!1;this.m_e=null;this.sJd=!1;this.DGb=[];this.ei=u;this.Jfc=P;this.reset()}gSa(u,P,la,Ca,Ta,pb){this.tE&&this.JW(Hg.fid);if(!u)throw Error.argumentNull("slide");const Sb=u.ezb(new om.a(u?u.Cb:null,P,pb));if(!Sb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",P));this.US=u;this.y6a=Sb;
this.shapeId=P;this.R6=pb;this.xqa=bi.a.create().toString();this.sJd=!0;this.X6a=la;this.xOd=Ca;this.la=Ta;this.lha=new Date;this.suggestionType=this.Bxj();return this.correlationId}rPc(u,P,la,Ca,Ta){return this.gSa(u,P,la,Ca,Ta,null)}Bxj(){const u=this.shape;return this.la.iconChunkingEnabled&&u&&this.R6&&u.get_isSVGBlipFilled()?1:0}JW(u){if(this.tE&&!this.f5j(this.correlationId)){const P={};P.SuggestionCount=this.suggestionCount;P.ClientSuggestionTimeoutInMs=this.x2b;P.IsApplied=this.jU;P.AppliedSuggestionId=
this.jU?this.SKc.toString():"";P.AppliedSuggestionLabel=this.jU?this.OVd:"";P.IsFloatieShown=this.bpe;P.IsGalleryShown=this.npe;P.Trigger=this.trigger;P.RetriggerReason=this.WYe;P.ResetReason=u;P.IconId=this.la.replaceObjectIconType;P.SlideCID=this.slide.cid;P.SlideSID=this.slide.sid;P.ShapeID=this.shapeId;P.AnimId=this.la.replaceObjectAnimId;P.AnimEnabled=this.la.BMb;P.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;P.ReplaceSuggestionType=pm[this.suggestionType];P.SeeMoreButtonClicked=
this.Vsc;P.SeeMoreIconName=this.Vsc?this.m_e:"";this.lha&&(P.SessionLiveTimeInMs=+new Date-+this.lha);this.R6&&(P.SmartArtSubNodeId=this.R6);this.RMa&&this.vQb&&this.vQb>this.RMa&&(P.SuggestionsReadyInMs=+this.vQb-+this.RMa);0<this.vvc&&(P.SuggestionsDisplayedForMs=this.vvc);0<this.xxb&&(P.FloatieDisplayedForMs=this.xxb);this.RMa&&this.lha&&this.RMa>this.lha&&(P.FloatieReadyInMs=+this.RMa-+this.lha);this.lha&&this.zwc&&this.lha>this.zwc&&(P.TriggeredByAugLoopInMs=+this.lha-+this.zwc);this.ywc&&this.xwc&&
this.xwc>this.ywc&&(P.SuggestionAppliedInMs=+this.xwc-+this.ywc);if(0<this.suggestions.length){u=[];for(let la=0;la<this.suggestions.length;la++)Array.add(u,this.suggestions[la].labelText);P.SuggestionLabels=Xh.c(u)}1!==this.suggestionType||Gb.a.Xa(this.Vkb)||(u=Jk.a.Eab(this.Vkb))&&u.hasChildNodes()&&(Jk.a.P5b(),Jk.a.H9k(this.Vkb));this.ei.Pel(this.correlationId,Xh.c(P),void 0,Object(z.a)(this,this.inc,"onFailureCallback"));this.lyk(this.correlationId)}this.reset()}reset(){this.sJd=!1;this.US=null;
this.ise=this.npe=this.bpe=this.fcb=this.jU=this.Hda=!1;this.xOd=this.X6a=this.xqa="";this.suggestions=[];this.SKc=0;this.OVd="";this.U9=!1;this.x2b=this.suggestionCount=0;this.xwc=this.ywc=this.f8e=this.vQb=this.Cwc=this.RMa=this.zwc=this.lha=null;this.suggestionType=this.xxb=this.vvc=0;this.Vkb="";this.y6a=null;this.Vsc=!1;this.m_e=""}f5j(u){return this.DGb?Array.contains(this.DGb,u):!1}lyk(u){this.DGb&&!Array.contains(this.DGb,u)&&(Array.add(this.DGb,u),N.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",
u,this.DGb.length))}inc(u){N.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",u.HttpStatusCode);return!0}OJe(){this.h5g(2,4)}ryk(){this.h5g(3,3)}h5g(u,P){this.Jfc&&this.Jfc.execute(la=>{const Ca=Object.assign(new cm.a,{cardId:yp.a.rGh,actionType:u,actionEngagement:P});la.Hid(Ca)})}get slide(){return this.US}get shape(){return this.y6a}get correlationId(){return this.xqa}get trigger(){return this.X6a}get WYe(){return this.xOd}get tE(){return this.sJd}get appSettings(){return this.la}get jZ(){return new om.a(this.slide?
this.slide.Cb:null,this.shapeId,this.R6)}}Object(r.a)(Hm,"ReplaceObjectContext",null,[969]);class dp{constructor(){this.va=new kn.a}T1k(u){this.va.raiseEvent("ReplaceObjectBSA",u)}aji(u){this.va.addHandler("ReplaceObjectBSA",u)}rbl(u){this.va.removeHandler("ReplaceObjectBSA",u)}cnh(u){this.va.raiseEvent("ReplaceObjectSPOver",u)}Oki(u){this.va.addHandler("ReplaceObjectSPOver",u)}tcl(u){this.va.removeHandler("ReplaceObjectSPOver",u)}bnh(u){this.va.raiseEvent("ReplaceObjectSPOut",u)}Nki(u){this.va.addHandler("ReplaceObjectSPOut",
u)}scl(u){this.va.removeHandler("ReplaceObjectSPOut",u)}X1k(u){this.va.raiseEvent("ReplaceObjectViewDE",u)}Zji(u){this.va.addHandler("ReplaceObjectViewDE",u)}Xbl(u){this.va.removeHandler("ReplaceObjectViewDE",u)}}Object(r.a)(dp,"ReplaceObjectEventSource",null,[966,967,968]);class Im extends Dn{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He,Yf,Rg,$i,jk){super(pb,u,P,la,Ca,Ta,Sb,Cc,ed,ad,Zd,Qf,Af,Ph,pf,Yf,Rg,$i,jk);this.xi=Cc.a9f();this.ei=We;this.la=He}CD(u,P){if(!this.Gh)N.a.J(25306451,
829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.sYa&&P.VE.length)if(u=this.pa.Ud(),1!==u.length)this.xi.tE&&this.closeSession(this.xi,Hg.mV);else{u=u[0];if(this.xi.tE){if(this.xi.shapeId===u.get_shapeId())return;this.closeSession(this.xi,Hg.mV)}this.S1a(u)&&this.Hka(this.ua.Ba,u,Ji.selectShape,"")}}yOe(u,P){this.Gh?this.xi.tE&&this.xi.shape===P.shape&&(u=this.xi.shape,this.closeSession(this.xi,Hg.euc),this.S1a(u)&&this.Hka(this.ua.Ba,u,Ji.Jkb,Ul.euc)):N.a.J(25306453,
829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}PJe(u,P){P.uBb&&this.RQ(P.actionId)}aC(){this.xi.tE&&this.closeSession(this.xi,Hg.slideNavigation)}D1(u,P){this.xi.tE&&P.A9&&P.shapes&&Array.contains(P.shapes,this.xi.shapeId)&&this.closeSession(this.xi,Hg.n2e)}xOe(u,P){P.correlationId!==this.xi.correlationId?N.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.xi.correlationId,P.correlationId):
this.Ohg(P,this.xi,this.la)}uMe(){this.Gh&&this.xi.fcb&&0===this.xi.suggestionType&&!this.fc.fd(this.ua.presentation)&&(this.xi.fcb=!1,this.Jz.Uoa(this.xi.shape,!0))}Hka(u,P,la,Ca=""){try{const Ta=this.xi.rPc(u,P.get_shapeId(),la,Ca,this.la);this.xi.U9=!0;this.Jz.xxc(this.xi.correlationId);this.ei.m5f(u.cid,u.sid,P.get_shapeId(),Ta,la,this.Au.cYc(P),this.Au.bYc(P),void 0,Object(z.a)(this,this.Iib,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.TIb(Ta,this.xi.shapeId,this.xi.suggestions,qj.a.pending)}catch(Ta){N.a.J(34152532,
829,15,"GenerateSuggestion failed!! {0} ",Ta.message)}}Iib(u){N.a.J(36966422,829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",u.HttpStatusCode);return!0}RQ(u){this.Gh?this.xi.tE&&!this.y2c(u)&&this.closeSession(this.xi,Hg.dSb+this.DJ.F6(u)):N.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(u,P){u.Hda&&this.Jz.Uoa(u.shape,!0);u.JW(P);this.la.powerPointIdeasIsEnabled&&this.TIb(u.correlationId,u.shapeId,
u.suggestions,qj.a.GJa)}}Object(r.a)(Im,"ReplaceObjectManager",Dn,[]);var tk=d(1);class A{constructor(u){this.OO=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.gve=Array.clone(u)}get_current(){if(-1===this.OO||this.OO>=this.gve.length)throw Error.invalidOperation();return this.gve[this.OO]}moveNext(){this.OO++;return this.OO<this.gve.length}reset(){this.OO=-1}}Object(r.a)(A,"ArrayEnumerator",null,[143]);class W{constructor(u){this.FIa=[];this.$$ge=this.getEnumerator;
this.etk=u}getEnumerator(){return new A(this.FIa)}[Symbol.iterator](){return Object(tk.a)(this.getEnumerator())}Q0c(u,P){u&&(u.JW(P),Array.remove(this.FIa,u))}zab(u){for(const P of this.FIa)if(P.correlationId===u)return P;return null}Aab(u){for(const P of this.FIa)if(om.a.duc(u,P.jZ))return P;return null}ccg(u,P){for(const la of this.FIa)if(la.shapeId===u&&(!P&&!la.R6||P&&P===la.R6))return la;return null}G8b(u){return this.ccg(u,null)}a9f(){return 0<this.FIa.length?this.FIa[0]:null}gSa(u,P,la,Ca,
Ta,pb){let Sb=this.Aab(new om.a(u.Cb,P,pb));Sb&&this.Q0c(Sb,Hg.fid);Sb=this.etk(u,P,la,Ca,Ta,pb);Array.add(this.FIa,Sb);return Sb}rPc(u,P,la,Ca,Ta){return this.gSa(u,P,la,Ca,Ta,null)}get yyf(){let u=0;this.FIa.forEach(P=>{P.tE&&u++});return u}}Object(r.a)(W,"ReplaceObjectMultipleContextManager",null,[925,141]);class oa{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad){this.ua=u;this.AZg=P;this.itk=la;this.Au=pb;this.GIa=Ta;this.Iz=Ca;this.WB=Sb;this.Fa=Cc;this.We=ed;this.Ga=ad;this.Dr=!1;this.cCc=-1}get Gh(){return this.Dr}get vzb(){return this.cCc}setup(){this.Gh||
(this.GIa.aji(Object(z.a)(this,this.s$g,"onBeforeReplaceObjectSuggestionApply")),this.GIa.Oki(Object(z.a)(this,this.bdh,"onReplaceObjectSuggestionPointerOver")),this.GIa.Nki(Object(z.a)(this,this.adh,"onReplaceObjectSuggestionPointerOut")),this.Dr=!0)}dispose(){this.Gh&&(this.GIa.rbl(Object(z.a)(this,this.s$g,"onBeforeReplaceObjectSuggestionApply")),this.GIa.tcl(Object(z.a)(this,this.bdh,"onReplaceObjectSuggestionPointerOver")),this.GIa.scl(Object(z.a)(this,this.adh,"onReplaceObjectSuggestionPointerOut")),
this.Dr=!1)}s$g(u,P){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");(u=this.ua.Ba.ezb(P.jZ))&&this.Uoa(u,!1)}bdh(u,P){this.ua.Ba&&(u=new om.a(this.ua.Ba.Cb,P.shapeId,P.qZ),(u=this.ua.Ba.ezb(u))&&this.q4e(u,P.Xkg))}adh(u,P){this.ua.Ba&&(u=new om.a(this.ua.Ba.Cb,P.shapeId,P.qZ),(u=this.ua.Ba.ezb(u))&&this.A$b(u))}q4e(u,P){let la=u;u.get_smartArtModelId()&&(la=this.Ga.Lr(u));if(u=this.Udg(la))this.REh(la,!1),u.q4e(P)}A$b(u){let P=u;u.get_smartArtModelId()&&(P=this.Ga.Lr(u));if(u=this.Udg(P))this.REh(P,
!0),u.A$b()}Udg(u){return u&&!u.get_smartArtModelId()&&Object(U.a)(117,u.qc(this.We))?this.itk.dJ(u):null}D2i(u){return u&&Object(U.a)(117,u.qc(this.We))?this.AZg.dJ(u):null}Lde(u){return u&&Object(U.a)(117,u.qc(this.We))?this.AZg.hJ(u):null}Fvd(u){if(!this.Gh)N.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(u){var P=this.D2i(u);if(P){const la=this.Iz.Aab(u.jZ);!la||la.Hda&&this.vzb!==la.shapeId||(la.Hda?this.vzb===la.shapeId&&(P.VRc(),this.cCc=
-1):(this.Uoa(u,!0,!(this.WB.I0a&&this.WB.isVisible&&om.a.duc(u.jZ,this.WB.I0a.jZ))),P.display()),la.Hda=!0)}}}B$k(){if(-1!==this.vzb&&this.ua.Ba){var u=this.ua.Ba.MQ(this.vzb);u&&this.Uoa(u,!0)}}Uoa(u,P,la=!0,Ca=!1){this.Gh?u&&(P&&this.A$b(u),la&&this.Zhe(u),P=this.Lde(u))&&(Ca?(P.SQc(),this.cCc=u.get_shapeId()):(this.vzb===u.get_shapeId()&&(this.cCc=-1),P.visible&&P.dismiss(),(Ca=this.Iz.Aab(u.jZ))&&u.get_shapeId()===Ca.shapeId&&(Ca.Hda=!1))):N.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}xxc(u){this.WB.xxc(u)}zLl(u){if(this.Gh)if(this.WB.isVisible){const P=
this.Iz.zab(u);P&&P.tE&&P.correlationId===u&&this.A$b(P.shape);this.Zhe(P.shape)}else this.r4e(u);else N.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}Zhe(u){this.WB.isVisible&&this.WB.I0a&&om.a.duc(this.WB.I0a.jZ,u.jZ)&&(this.WB.dismiss(),(u=this.Lde(this.WB.I0a.shape))&&u.root&&(u.root.style.zIndex="0"),this.Fa.wj(Fd.a.ukb,!1))}r4e(u){const P=this.Iz.zab(u);if(P&&P.correlationId===u&&P.tE){var la=this.Lde(P.shape);if(la){var Ca=la.root;Ca?this.WB.isVisible&&
this.WB.I0a&&!om.a.duc(this.WB.I0a.jZ,P.jZ)||(Ca=this.Au.getBounds(Ca),this.WB.show(u,Ca.x,Ca.y),la.root.style.zIndex=String(t.AFrameworkApplication.Aa.Hsb),this.Fa.wj(Fd.a.ukb,!0),P.npe=!0):N.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else N.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}Zoh(u){this.Gh?this.WB.isVisible&&this.r4e(u):N.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}Bmc(){if(this.Gh){var u=
this.WB.wbe();u&&(-1===u?this.WB.Zw(0,!0):(this.WB.Zw(u,!1),this.WB.Zw(u-1,!0)))}else N.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}Amc(){if(this.Gh){var u=this.WB.wbe();u+1!==this.WB.wxj()&&(-1===u?this.WB.Zw(0,!0):(this.WB.Zw(u,!1),this.WB.Zw(u+1,!0)))}else N.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}REh(u,P){u&&(u=Object(U.a)(117,u.qc(this.We)))&&((u=u.xa)?u.Sd(P):N.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(r.a)(oa,"ReplaceObjectPresenter",null,[950]);class xa{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.dKb=null;this.jQe=0}}Object(r.a)(xa,"TaskItem",null,[]);class Ia{constructor(u,P,la){this.Rgb=[];this.ei=u;this.Au=P;this.lBg=la}u8i(u,P,la){for(let Ca=0;Ca<this.Rgb.length;Ca++)if(this.Rgb[Ca].slideSid===u&&this.Rgb[Ca].slideCid===P&&this.Rgb[Ca].shapeId===la)return this.Rgb[Ca];return null}Qxh(u){var P=this.u8i(u.slide.sid,
u.slide.cid,u.shapeId);if(P)return P.dKb=u,P.jQe++,1;const la=Object.assign(new xa,{slideSid:u.slide.sid,slideCid:u.slide.cid,shapeId:u.shapeId,jQe:0,dKb:null});Array.add(this.Rgb,la);u.U9=!0;P=u.correlationId;const Ca=u.slide,Ta=u.shape;this.ei.m5f(Ca.cid,Ca.sid,Ta.get_shapeId(),P,u.trigger,this.lBg?this.Au.cYc(Ta):this.Au.R8b(Ta),this.lBg?this.Au.bYc(Ta):this.Au.Q8b(Ta),()=>{this.xeh(la)},pb=>{this.xeh(la);N.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
pb.HttpStatusCode);return!0});return 0}xeh(u){Array.remove(this.Rgb,u);u.dKb&&u.dKb.tE&&(N.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",u.dKb.correlationId,u.jQe-1),this.Qxh(u.dKb))}}Object(r.a)(Ia,"ReplaceObjectRequestManager",null,[924]);class qb{constructor(u){this.jCe=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Up=u}get_current(){return this.Up}moveNext(){return this.jCe?(this.jCe=!1,!0):!1}reset(){this.jCe=
!0}}Object(r.a)(qb,"SingleEnumerator",null,[143]);class Hb{constructor(u){this.$$ge=this.getEnumerator;this.xi=u}getEnumerator(){return new qb(this.xi)}[Symbol.iterator](){return Object(tk.a)(this.getEnumerator())}Q0c(u,P){u&&u===this.xi&&u.JW(P)}zab(){return this.xi}Aab(){return this.xi}G8b(){return this.xi}ccg(){return this.xi}a9f(){return this.xi}gSa(u,P,la,Ca,Ta,pb){this.xi.gSa(u,P,la,Ca,Ta,pb);return this.xi}rPc(u,P,la,Ca,Ta){return this.gSa(u,P,la,Ca,Ta,null)}get yyf(){return this.xi.tE?1:0}}
Object(r.a)(Hb,"ReplaceObjectSingleContextManager",null,[925,141]);var hc=d(133);class Jc{constructor(u,P,la,Ca,Ta){this.Ffa=null;this.mHb=this.rxe=!1;this.rna=null;this.visible=!1;this.Bu=u;this.qU=P;this.o$=la;this.Au=Ta;this.Ujc=Ca;this.Dr=!1}get Gh(){return this.Dr}setup(){this.Gh||(this.rna=new Rb.a,this.Ffa=this.Ujc.UQi(this.rna.xa),this.qU&&!this.qU.Ml&&this.qU.nV&&(this.qU.nV.appendChild(this.rna),this.Sd(!1),this.mHb=!0,this.qU.$ra(this,3),this.visible=this.qU.TQ||this.qU.lo),this.Dr=!0)}Bm(){N.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}kC(){}Mp(){if(!this.Gh)return N.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.rxe||!this.Ffa.Gh||!this.Ffa.gO)return null;const u=Ib.a.Sn(this.Ffa.gO.xa.style.left),P=Ib.a.Sn(this.Ffa.gO.xa.style.top),la=Ib.a.Sn(this.Ffa.gO.xa.style.width),Ca=Ib.a.Sn(this.Ffa.gO.xa.style.height);return new hc.a(new kb.a(u,P),new kb.a(u+la,P),new kb.a(u+la,P+
Ca),new kb.a(u,P+Ca))}PL(){return!1}Xw(){}ny(){}setPosition(){}Kj(){this.mHb=!0;this.ls()}wq(){this.mHb=!0;this.ls()}Ju(){this.mHb=!0;this.ls()}setZIndex(u){this.rna&&this.rna.lC(u)}JD(){}ZC(){return null}TA(){return[]}draw(){}dispose(){this.o$();this.Gh&&(this.Ffa.dispose(),this.rna.xa.parentNode&&this.rna.Eq(),this.rna=null,this.Dr=!1)}q4e(u){this.Gh?(this.stc(u),this.ls()):N.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}A$b(){this.Gh?this.MRa():
N.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}stc(u){this.Gh?(this.Ffa.OLa(u),this.Sd(!0)):N.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}MRa(){this.Gh?(this.Ffa.dismiss(),this.Sd(!1)):N.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}ls(){if(this.rxe&&this.mHb){var u=this.Au.R8b(this.Bu),P=this.Au.Q8b(this.Bu);this.ah(u,P);this.rna&&(u=
this.Au.ytj(this.Bu),Um.a.setRotation(this.rna.xa,u));this.mHb=!1}}Sd(u){this.rxe=u;this.rna.Sd(u)}ah(u,P){this.Ffa&&this.Ffa.ah(u,P)}}Object(r.a)(Jc,"ReplaceObjectSuggestionPreviewView",null,[959,960,282,283,108,950]);var ld=d(282),wd=d(240),Bd=d(1026),de=d(1025);class oe extends Sys.EventArgs{constructor(u){super();this.shape=u}}Object(r.a)(oe,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class Pc{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd){this.I0g=!1;this.Y$=this.KXa=null;this.ia=Ta;this.af=
pb;this.od=Sb;this.Iz=Cc;this.HIa=ed;this.Ujc=Ca;this.o$=la;this.Bu=u;this.qU=P;this.AA=!1;this.la=ad;this.xGe=Zd;this.Dr=this.visible=!1}get Gh(){return this.Dr}kyb(){return this.Iz.Aab(this.Bu.jZ)}setup(){if(!this.Gh){var u=this.kyb();u=u?u.suggestionType:0;this.I0g=1===u;this.Y$=new Rb.a;this.KXa=this.Ujc.jOi(this.Y$,Pc.cMc,Object(z.a)(this,this.vHk,"onFlyoutAnchorClick"),Object(z.a)(this,this.wHk,"onFlyoutAnchorHover"),u);this.qU&&!this.qU.Ml&&this.qU.nV&&(this.Bm(this.qU.nV),this.qU.$ra(this,
3));this.Dr=!0}}VRc(){this.Gh?this.KXa&&this.KXa.VRc():N.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}SQc(){this.Gh?this.KXa&&this.KXa.SQc():N.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.Gh)N.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.ls();this.KXa.show();this.visible=!0;this.CRb();var u=this.kyb();if(u){u.bpe=!0;const P=new Date;u.RMa||
(u.RMa=P);u.Cwc=P;N.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",u.trigger,u.correlationId)}}}get root(){return this.Gh?this.Y$.xa:(N.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.Gh){this.KXa.dismiss();this.visible=!1;var u=this.kyb();u&&(u.Hda=!1,u.Cwc&&(u.xxb+=+new Date-+u.Cwc,N.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
u.xxb,u.Cwc,u.trigger,u.correlationId)))}else N.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Bm(){this.visible=!1;this.af.addCssClass(this.Y$.xa,"replaceObjectBody");document.body.appendChild(this.Y$.xa);this.od.Z_b(Object(z.a)(this,this.onResize,"onResize"));this.ls()}kC(){}Mp(){return null}PL(){return!1}Xw(){}ny(){}setPosition(){}Kj(){}wq(){}Ju(){}setZIndex(){}JD(u){if(this.Gh){if(u)this.visible=!1,this.CRb();else if(this.AA){const P=new oe(this.Bu);this.HIa.X1k(P)}this.AA=
u}else N.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}ZC(){return null}TA(){return[]}draw(){this.Gh?this.ls():N.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.o$();this.Gh&&(this.od.Urh(Object(z.a)(this,this.onResize,"onResize")),this.Y$&&(this.Y$.xa.parentNode&&this.Y$.Eq(),this.af.removeCssClass(this.Y$.xa,"replaceObjectBody")),this.dismiss(),this.KXa.dispose(),this.Y$=null,this.Dr=!1)}CRb(){this.Y$.xa.style.visibility=
this.visible?eb.a.visible:eb.a.hidden;const u=this.kyb();u&&(u.Hda=this.visible)}ls(){let u=null;var P=this.qU.nV;P&&(u=this.af.mi(P.xa));u?(P=u.x-(Pc.cMc+10),this.I0g&&this.qU&&this.qU.Od&&(P=this.qU.Od.Nd.Pe(this.Bu.Ix,0),P=u.x+P+10),Um.a.Ctc(this.Y$.xa,1),this.Y$.setPosition(1*P,u.y),this.LRl(1*P,u.y)):N.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}LRl(u,P){if(this.xGe.isVisible){var la=this.kyb(),Ca=this.xGe.I0a;Ca&&la&&Ca.correlationId===la.correlationId&&
this.xGe.updatePosition(u,P)}}vHk(u){if(u.OA!==Sys.UI.MouseButton.leftButton)return!1;this.ia.Ja(wb.a.X1a,2,Object.assign(new pn,{shape:this.Bu,action:0}));return!0}wHk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const u=this.kyb();if(u&&1===u.suggestionType)return!1;this.ia.Ja(wb.a.X1a,2,Object.assign(new pn,{shape:this.Bu,action:1}));return!0}onResize(u,P){this.visible&&(u=null,P&&P.zG&&(u=P.zG.$c),u&&u.Cb.equals(this.Bu.slideId)&&this.ls())}}Pc.cMc=32;Object(r.a)(Pc,"ShapeReplaceObjectView",
null,[948,949,282,283,108,950]);var tc=d(658),id=d(72);class ie{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We){this.RYa=this.jfa=this.VYa=this.W5=this.Lo=null;this.rfd=0;this.OAe=-1;this.Aq=this.xi=null;this.af=u;this.Rc=la;this.Xr=P;this.ua=Ca;this.ia=Ta;this.LB=ed;this.HIa=pb;this.Iz=Sb;this.vR=Cc;this.Fa=ad;this.la=Zd;this.euk=!We.ik;this.Dr=this.sqb=!1}get Gh(){return this.Dr}get isVisible(){return this.sqb}get I0a(){return this.xi}setup(){this.Gh||(this.Lo=Ib.a.ee(),this.Lo.setAttribute("Unselectable",
"on"),this.Lo.style.position=eb.a.absolute,this.af.addCssClass(this.Lo,"replaceObjectContainer"),this.GYe(null),document.body.appendChild(this.Lo),this.cLa(),this.LB.C4(Fd.a.ukb,Fd.a.$i,this.Lo,()=>{},()=>{},!0),this.Dr=!0)}dispose(){this.Gh&&(this.dismiss(),this.k$e(),this.Lo&&this.Lo.parentNode&&this.Lo.parentNode.removeChild(this.Lo),this.Dr=!1)}dismiss(){this.Gh?(t.AFrameworkApplication.Aa.aTa(!0),this.setVisibility(!1),this.nIb.style.display=eb.a.none,this.nIb.style.zIndex="-1",this.RYa=this.jfa=
null,this.GYe(null)):N.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(u,P,la){if(!this.Gh)N.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!Gb.a.Xa(u)){var Ca=this.Iz.zab(u);Ca&&Ca.correlationId===u&&Ca.tE&&!Ca.U9&&(this.xi=Ca,this.zUk(u,this.xi.suggestions),this.rfd=this.xi.suggestionCount,this.Nth(),t.AFrameworkApplication.Aa.nRa(!0),this.nIb.style.zIndex=String(t.AFrameworkApplication.Aa.Ura),this.Lo.style.zIndex=
String(t.AFrameworkApplication.Aa.Hsb),this.nIb.style.visibility=eb.a.hidden,this.nIb.style.display=eb.a.block,this.nIb.style.visibility=eb.a.visible,this.Gla()?this.af.addCssClass(this.Lo,"replaceIconObjectContainer"):this.af.removeCssClass(this.Lo,"replaceIconObjectContainer"),this.updatePosition(P,la),this.setVisibility(!0))}}updatePosition(u,P){let la,Ca;this.setPosition(0,0);if(this.Gla()){la=u+Pc.cMc+7;Ca=P;const Ta=tc.a(0,0);la+this.Lo.offsetWidth>Ta.width&&(la=u+Pc.cMc-this.Lo.offsetWidth,
Ca=P-7-this.Lo.offsetHeight)}else la=u,Ca=P-7-this.Lo.offsetHeight;this.setPosition(la,Ca)}wxj(){return this.Gh?this.rfd:(N.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}wbe(){return this.Gh?this.isVisible?this.Lo?this.Lo.querySelector(".replaceObjectSuggestionsList")?this.OAe:(N.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(N.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(N.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}Zw(u,P){if(!this.Gh)N.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>u)&&this.isVisible)if(this.Lo)if(u>=this.rfd)N.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.rfd,u);else{var la=this.Lo.querySelector(".replaceObjectSuggestionsList");
la?(la=la.children)?(la=la[u])?P?(this.OAe=u,kd.FocusManager.Zq(la)&&this.iFh(la.firstChild)):(this.Nth(),kd.FocusManager.WNl(la)&&this.Ojg(la.firstChild)):N.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):N.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):N.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else N.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}xxc(u){this.VYa&&(this.VYa.className="ReplaceObjectCorrelation "+u)}zUk(u,P){this.GYe(u);if(u=this.nSi(u,P))P=this.mSi(),this.Lo.appendChild(P),this.Lo.appendChild(u),this.Gla()&&(u=this.lSi(),this.Lo.appendChild(u))}GYe(u){this.Lo&&(this.W5&&(this.Rc.Bb(Fa.a.click,this.W5,Object(z.a)(this,this.Ibh,"onLinkClick")),this.W5=null),this.af.yv(this.Lo),this.VYa=Ib.a.ee(),this.VYa.setAttribute("Unselectable",
"on"),this.VYa.className=Gb.a.Xa(u)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+u,this.VYa.style.position=eb.a.absolute,this.VYa.style.display=eb.a.none,this.Lo.appendChild(this.VYa),this.Lo.style.zIndex="-1")}mSi(){const u=Ib.a.Hl();u.setAttribute("Unselectable","on");this.Gla()?(u.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.af.addCssClass(u,"replaceIconObjectContainerTitle")):(u.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.af.removeCssClass(u,
"replaceIconObjectContainerTitle"));this.af.addCssClass(u,"UIFont replaceObjectContainerTitle");return u}nSi(u,P){if(Gb.a.Xa(u))return N.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!P||!P.length)return N.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const la=Ib.a.W3b();la.id=u;la.setAttribute("Unselectable","on");la.setAttribute(Ja.a.hf,Ja.a.rqi);
this.af.addCssClass(la,"replaceObjectSuggestionsList");this.jfa||(this.jfa=new id.a);this.RYa||(this.RYa=new id.a);for(var Ca of P)Gb.a.Xa(Ca.imageData)||this.jfa.$(Ca.index,Ca.imageData),this.Gla()&&!Gb.a.Xa(Ca.renderData)&&this.RYa.$(Ca.index,Ca.renderData),u=this.Fui(Ca.index,Ca.labelText),la.appendChild(u);if(this.euk&&0<this.RYa.count&&this.Gla()&&(Gb.a.Xa(this.xi.Vkb)&&(this.xi.Vkb=nl.a.create().toString()),(Ca=Jk.a.Eab(this.xi.Vkb))&&!Ca.hasChildNodes())){Ca.style.position=eb.a.absolute;Ca.style.left=
"0px";Ca.style.top="0px";for(let Ta of this.RYa.values)u=Ib.a.xB(),u.src=Ta,u.style.display=eb.a.block,u.style.position=eb.a.absolute,Ca.appendChild(u);Jk.a.Y0b()}return la}lSi(){this.W5=Ib.a.Hl();this.W5.setAttribute("Unselectable","on");this.W5.setAttribute("tabindex","-1");this.W5.setAttribute(Ja.a.hf,Ja.a.GWd);this.af.addCssClass(this.W5,"UIFont replaceObjectContainerLink");this.Gla()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.Rbb&&(this.W5.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.Rc.ub(Fa.a.click,this.W5,Object(z.a)(this,this.Ibh,"onLinkClick")));const u=Ib.a.ee();u.appendChild(this.W5);return u}cLa(){this.Lo&&(this.Rc.ub(Fa.a.click,this.Lo,Object(z.a)(this,this.onClick,"onClick")),this.vR.addHandler(this.Lo,Fa.a.Df,Object(z.a)(this,this.Z_c,"inputKeyApplyHandler")),this.Xr.ub(Fa.a.pointerOver,this.Lo,Object(z.a)(this,this.SM,"onPointerOver")),this.Xr.ub(Fa.a.pointerOut,this.Lo,Object(z.a)(this,this.sG,"onPointerOut")))}k$e(){this.Lo&&(this.Rc.Bb(Fa.a.click,this.Lo,Object(z.a)(this,
this.onClick,"onClick")),this.vR.removeHandler(this.Lo,Fa.a.Df,Object(z.a)(this,this.Z_c,"inputKeyApplyHandler")),this.Xr.Bb(Fa.a.pointerOver,this.Lo,Object(z.a)(this,this.SM,"onPointerOver")),this.Xr.Bb(Fa.a.pointerOut,this.Lo,Object(z.a)(this,this.sG,"onPointerOut")))}SM(u){u=this.Nee(u.Bc);this.iFh(u);return!0}sG(u){u=this.Nee(u.Bc);this.Ojg(u);return!0}Z_c(u){if(this.isVisible&&!u.ctrlKey&&!u.altKey&&(!u.shiftKey||u.keyCode===pa.a.$q&&this.Gla()))if(u.keyCode===pa.a.jp||u.keyCode===pa.a.BK)u.preventDefault(),
(u=this.Lo.querySelector(":focus"))&&u.firstChild.click();else if(u.keyCode===pa.a.$q&&this.Gla()){const P=this.Lo.querySelector(":focus");P&&this.W5&&(P===this.W5?(u.preventDefault(),u.stopPropagation(),this.Zw(0,!0)):P.parentNode&&P.parentNode.className&&0<=P.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(u.preventDefault(),u.stopPropagation(),this.Zw(this.wbe(),!1),kd.FocusManager.Zq(this.W5)))}}onClick(u){if(u.OA!==Sys.UI.MouseButton.leftButton)return!1;var P=this.Nee(u.Bc);if(!this.Ere(P)||
!this.O7j(P))return!0;u=this.ohj(P);const la=this.d9b(P);P=this.zxj(P);Gb.a.Xa(u)||Gb.a.Xa(la)||(u=Object.assign(new Bp.a,{SuggestionSid:parseInt(la),ShapeId:this.xi.shapeId,CorrelationId:u,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,Label:P,SmartArtSubNodeId:this.xi.R6?this.xi.R6:null,ReplaceObjectType:this.xi.suggestionType}),this.ia.Ja(wb.a.aRa,2,u));return!0}Ibh(){this.xi&&(this.xi.Vsc=!0);this.qge();this.ia.processAction(wb.a.FRa,2);return!0}iFh(u){u&&this.Ere(u)&&(u=this.d9b(u),
Gb.a.Xa(u)||(u=this.Gla()?this.RYa.Gb(u)?this.RYa.ga(u):"":this.jfa.Gb(u)?this.jfa.ga(u):"",Gb.a.Xa(u)||(u=new de.a(this.xi.shapeId,u,this.xi.R6),this.HIa.cnh(u))))}Ojg(u){u&&this.Ere(u)&&(u=new Bd.a(this.xi.shapeId,this.xi.R6),this.HIa.bnh(u))}Nee(u){if(!u)throw Error.argumentNull("sourceElement");return"a"===u.nodeName.toLowerCase()?u:u.parentNode}ohj(u){return u?u.parentNode.parentNode.id:null}d9b(u){if(!u)return null;u=u.id.split("_");return 2!==u.length?null:u[1]}zxj(u){return u?u.title:null}Ere(u){return!!u&&
!Gb.a.Xa(u.className)&&-1!==u.className.indexOf("ObjectSuggestionContainer")}O7j(u){return!!u&&!Gb.a.Xa(u.className)&&-1===u.className.indexOf("ReplaceObjectSuggestionLoading")}Fui(u,P){const la=this.jfa.Gb(u);var Ca=la?this.jfa.ga(u):lh.a.PN(kg.a.Joa);la||N.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Ta=Ib.a.xB();Ta.setAttribute("Unselectable","on");Ta.src=Ca;Ta.title=P;Ta.setAttribute(Ja.a.hf,Ja.a.qQ);this.af.addCssClass(Ta,"replaceObjectSuggestionThumbnail");
Ca=Ib.a.mda();Ca.id="ROS_"+u;Ca.setAttribute("Unselectable","on");Ca.title=P;Ca.setAttribute(Ja.a.hf,"none");let pb=this.Gla()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.xi.jU&&this.xi.SKc.toString()===u&&(pb+="Selected");this.af.addCssClass(Ca,pb);la||this.af.addCssClass(Ca,"ReplaceObjectSuggestionLoading");Ca.appendChild(Ta);u=this.af.mRf();u.setAttribute("Unselectable","on");u.setAttribute("tabindex","-1");u.setAttribute(Ja.a.hf,Ja.a.qQ);u.setAttribute(Ja.a.fr,
P);u.appendChild(Ca);return u}setPosition(u,P){this.Gh?(0>u&&(u=0),0>P&&(P=0),this.Lo.style.left=this.af.Pc(u),this.Lo.style.top=this.af.Pc(P)):N.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(u){if(this.Lo){if(this.xi)if(u)this.xi.f8e=new Date,this.xi.ryk();else{let P;(P=this.xi).vvc=P.vvc+(+new Date-+this.xi.f8e)}this.Lo.style.visibility=u?eb.a.visible:eb.a.hidden;this.sqb=u;this.Fa.wj(Fd.a.ukb,u)}}Nth(){this.OAe=-1}Gla(){return!!this.xi&&
1===this.xi.suggestionType}get nIb(){this.Aq&&"undefined"!==typeof this.Aq||(this.Aq=this.af.ee(),this.Aq.setAttribute("id","ModalDiv"),this.af.addCssClass(this.Aq,"cui-modalDiv"),this.Aq.setAttribute("Unselectable","on"),document.body.appendChild(this.Aq),ld.a.instance.ub(Fa.a.pointerDown,this.Aq,Object(z.a)(this,this.ikd,"onModalPointerDown")),ld.a.instance.ub(Fa.a.aS,this.Aq,Object(z.a)(this,this.jkd,"onModalPointerUp")),ld.a.instance.ub(Fa.a.Xoc,this.Aq,Object(z.a)(this,this.tJk,"onModalPointerMove")),
ld.a.instance.ub(Fa.a.pointerOut,this.Aq,Object(z.a)(this,this.uJk,"onModalPointerOut")),wd.a.instance.ub(Fa.a.click,this.Aq,Object(z.a)(this,this.sJk,"onModalClick")),$b.a.instance.ub(Fa.a.rIb,this.Aq,Object(z.a)(this,this.fOe,"onModalMouseWheel")));return this.Aq}ikd(){return!0}jkd(){return this.qge()}tJk(){return!0}uJk(){return!0}sJk(){return this.qge()}fOe(){return!0}qge(){if(!this.xi||!this.xi.slide)return!0;const u=this.xi.shape;if(!u)return!0;this.ia.Ja(wb.a.X1a,2,Object.assign(new pn,{action:2,
shape:u}));return!0}}Object(r.a)(ie,"ReplaceObjectSuggestionsGalleryView",null,[922,950]);class v{constructor(u,P,la,Ca){this.jtk=u;this.Au=P;this.ua=la;this.la=Ca}Hdj(u){if(!this.ua.Ba)return!1;u=this.ua.Ba.MQ(u);return this.ayc(u)}ayc(u){return!(u&&u.get_shapeId()&&u.hasText&&this.Au.xGa(u))||u.get_shapeRotation()||u.Hs||u.x0||u.Gw||!this.jtk.validate(u)?!1:!0}U9j(u){return!Array.contains(this.la.replaceObjectDisabledTriggers,u)}}Object(r.a)(v,"ReplaceObjectValidationHelper",null,[]);class Z{constructor(u,
P,la,Ca,Ta,pb,Sb,Cc,ed){this.Ov=this.S0=null;this.Dr=!1;this.Bfa=u;this.Rc=P;this.Xr=la;this.A5=Ca;this.zfa=Ta;this.le=Sb;this.la=pb;this.Ldb=ed}get Gh(){return this.Dr}SQc(){this.la.BMb?this.Ov.setAttribute("Src",this.le.qk("BLUEBOLT_Deactivated.gif")):this.Ov.style.opacity=".3";this.Ldb.Xyh(Object(z.a)(this,this.dismiss,"dismiss"))}VRc(){this.la.BMb?this.Ov.setAttribute("Src",this.le.qk("BLUEBOLT_Reactivated.gif")):this.Ov.style.opacity="initial";this.Ldb.disabled=!1}show(){this.la.BMb?this.Ov.setAttribute("Src",
this.le.qk("BLUEBOLT_Entrance.gif")):this.Ov.setAttribute("Src",this.le.qk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.BMb?(this.Ov.setAttribute("Src",this.le.qk("BLUEBOLT_Exit.gif")),this.Ldb.Xpl(()=>{this.Bfa.xa.style.visibility=eb.a.hidden})):(this.Ov.setAttribute("Src",""),this.Bfa.xa.style.visibility=eb.a.hidden)}setup(){this.Gh||(this.Bfa?(this.S0=new Rb.a,this.S0.xa.style.visibility=eb.a.inherit,this.S0.xa.style.position=eb.a.absolute,this.Ov=Ib.a.xB(),this.Ov.setAttribute("Unselectable",
"on"),this.Ov.setAttribute(Ja.a.hf,Ja.a.qQ),this.Ov.className="gifFloatie",this.S0.xa.appendChild(this.Ov),this.Bfa.appendChild(this.S0),this.cLa()):N.a.J(38072903,829,15,"parentElement is null"),this.Dr=!0)}mbh(u){let P;switch(this.la.replaceObjectIconType){case 7:P="BLUEBOLT_Hover_on.gif";break;case 8:P="BLUEBOLT_HoverWhite_On.gif";break;default:P="BLUEBOLT_Hover_on.gif"}this.Ov.setAttribute("Src",this.le.qk(P));return this.zfa(u)}onBlur(){let u;switch(this.la.replaceObjectIconType){case 7:u="BLUEBOLT_Hover_off.gif";
break;case 8:u="BLUEBOLT_HoverWhite_Off.gif";break;default:u="BLUEBOLT_Hover_off.gif"}this.Ov.setAttribute("Src",this.le.qk(u));return!0}cLa(){this.A5&&this.Rc.ub(Fa.a.click,this.Ov,this.A5);this.zfa&&(this.Xr.ub(Fa.a.pointerOver,this.Ov,Object(z.a)(this,this.mbh,"onHover")),this.Xr.ub(Fa.a.pointerOut,this.Ov,Object(z.a)(this,this.onBlur,"onBlur")))}u$e(){this.A5&&this.Rc.Bb(Fa.a.click,this.Ov,this.A5);this.zfa&&(this.Xr.Bb(Fa.a.pointerOver,this.Ov,Object(z.a)(this,this.mbh,"onHover")),this.Xr.Bb(Fa.a.pointerOut,
this.Ov,Object(z.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.u$e();this.Dr=!1}}Object(r.a)(Z,"GifFlyoutAnchor",null,[1012,950]);class ua{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af){this.Ov=this.Nv=null;this.Bfa=u;this.m5=P;this.Cmk=la;this.Hmk=Ca;this.fIg=We.replaceObjectIconType;this.dAg=We.replaceObjectAnimId;this.eAg=We.BMb;this.Wgb=pb;this.Ujc=Ta;this.Rc=Sb;this.Xr=Cc;this.A5=ed;this.zfa=ad;this.af=Zd;this.avk=Qf;this.Ldb=Af;this.Dr=!1}get m5d(){return 1===this.avk?
ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.Ldb.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get Gh(){return this.Dr}setup(){this.Gh||(this.Nv=new Rb.a,this.Ov=this.Ujc.TQi(),this.Nv.xa.style.visibility=eb.a.inherit,this.vRa(),this.Dr=!0)}SQc(){this.Ldb.Xyh(Object(z.a)(this,this.dismiss,"dismiss"));this.MRa();this.stc();this.Nv.ZJi()||this.Nv.Fr("replaceObjectGrayedFlyoutAnchor")}show(){this.Gh?this.stc(this.eAg):N.a.J(38072907,
829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}VRc(){this.Ldb.disabled=!1;this.MRa();this.stc();this.Nv.jkb("replaceObjectGrayedFlyoutAnchor")}stc(u=!1){this.Gh?this.Ov.OLa(this.jlj(u),""):N.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}jlj(u){const P=this.Wgb.$Qf(this.m5,this.m5,this.Cmk,this.Hmk,this.m5d,null);this.af.addCssClass(this.Nv.xa,"replaceObjectFlyoutAnchorBase");this.af.addCssClass(this.Nv.xa,"replaceObjectFlyoutAnchor"+this.fIg);u&&
(this.af.addCssClass(this.Nv.xa,"replaceObjectFlyoutAnchorAnimBase"),this.af.addCssClass(this.Nv.xa,"replaceObjectFlyoutAnchorAnim"+this.dAg));return P}MRa(){this.Gh?(this.Ov.clear(),this.af.removeCssClass(this.Nv.xa,"replaceObjectFlyoutAnchorBase"),this.af.removeCssClass(this.Nv.xa,"replaceObjectFlyoutAnchor"+this.fIg),this.eAg&&(this.af.removeCssClass(this.Nv.xa,"replaceObjectFlyoutAnchorAnimBase"),this.af.removeCssClass(this.Nv.xa,"replaceObjectFlyoutAnchorAnim"+this.dAg))):N.a.J(25306445,829,
15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.Gh&&(this.u$e(),this.Nv&&this.Nv.xa.parentNode&&this.Nv.Eq(),this.dismiss(),this.Ov.dispose(),this.Nv=null,this.Dr=!1)}dismiss(){this.Gh?(this.MRa(),this.Bfa.xa.style.visibility=eb.a.hidden):N.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}vRa(){this.Bfa?(this.Nv.xa.style.width=this.af.Pc(this.m5),this.Nv.xa.style.height=this.af.Pc(this.m5),this.Nv.xa.setAttribute(Ja.a.hf,Ja.a.Ou),this.Bfa.appendChild(this.Nv),
this.Ov.vRa(this.Nv.xa),this.cLa()):N.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}tib(){return!0}cLa(){this.A5&&this.Rc.ub(Fa.a.click,this.Nv.xa,this.A5);this.Rc.ub(Fa.a.doubleClick,this.Nv.xa,Object(z.a)(this,this.tib,"onDoubleClick"));this.zfa&&(this.Xr.ub(Fa.a.pointerOver,this.Nv.xa,this.zfa),this.Xr.ub(Fa.a.pointerOver,this.Nv.xa.firstChild,this.zfa),this.Xr.ub(Fa.a.pointerOver,this.Nv.xa.firstChild.firstChild,this.zfa))}u$e(){this.A5&&this.Rc.Bb(Fa.a.click,
this.Nv.xa,this.A5);this.Rc.Bb(Fa.a.doubleClick,this.Nv.xa,Object(z.a)(this,this.tib,"onDoubleClick"));this.zfa&&(this.Xr.Bb(Fa.a.pointerOver,this.Nv.xa,this.zfa),this.Xr.Bb(Fa.a.pointerOver,this.Nv.xa.firstChild,this.zfa),this.Xr.Bb(Fa.a.pointerOver,this.Nv.xa.firstChild.firstChild,this.zfa))}}Object(r.a)(ua,"ReplaceObjectFlyoutAnchor",null,[1012,950]);class Ra{constructor(u,P){this.Xz=null;this.Uk=u;this.af=P;this.Dr=!1}get Gh(){return this.Dr}get gO(){return this.Xz}setup(){this.Gh||(this.Xz=new Rb.a,
this.vRa(),this.Dr=!0)}vRa(){this.Uk?(this.Uk.appendChild(this.gO.xa),this.af.addCssClass(this.gO.xa,"replaceObjectPreviewContainer"),this.gO.setVisibility(!1)):N.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}OLa(u){if(this.Gh){if(u=this.Wja(u))this.D0a(),this.gO.xa.appendChild(u),this.gO.setVisibility(!0)}else N.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}ah(u,P){this.Gh?this.gO.ah(u,P):N.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.Gh&&
(this.dismiss(),this.gO&&this.gO.xa.parentNode&&(this.gO.Eq(),this.af.removeCssClass(this.gO.xa,"replaceObjectPreviewContainer")),this.Xz=null)}dismiss(){this.Gh?(this.D0a(),this.gO.setVisibility(!1)):N.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}Wja(u){if(!Gb.a.Xa(u)){const P=Ib.a.xB();P.setAttribute("Unselectable","on");P.src=u;P.style.height="100%";P.style.width="100%";return P}return null}D0a(){this.gO.xa.firstChild&&this.gO.xa.removeChild(this.gO.xa.firstChild)}}
Object(r.a)(Ra,"ReplaceObjectPreviewImageView",null,[950]);var fb=d(999);class Mb{constructor(u,P,la,Ca,Ta,pb,Sb){this.Rc=u;this.Xr=P;this.af=la;this.Wgb=Ca;this.la=Ta;this.le=pb;this.lGg=Sb}jOi(u,P,la,Ca,Ta){u=Xm.rWl(this.la.replaceObjectIconType,Ta)?new Z(u,this.Rc,this.Xr,la,Ca,this.la,this.le,this.af,this.lGg):new ua(u,P,"per","PowerPointDesigner_32x32x32",this,this.Wgb,this.Rc,this.Xr,la,Ca,this.af,this.la,Ta,this.lGg);u.setup();return u}UQi(u){u=new Ra(u,this.af);u.setup();return u}TQi(){return new fb.a(this.af)}}
Object(r.a)(Mb,"ReplaceObjectViewFactory",null,[]);class xc{constructor(u,P,la){this.af=u;this.ua=la;this.i1g=P}cYc(u){if(!u)throw Error.argumentNull("shape");var P=u.dS;u=this.Evb(P.TopLeft);P=this.Evb(P.TopRight);return kb.a.Ql(u,P)}bYc(u){if(!u)throw Error.argumentNull("shape");var P=u.dS;u=this.Evb(P.TopRight);P=this.Evb(P.BottomRight);return kb.a.Ql(u,P)}R8b(u){return this.cYc(u)*this.rfg()}Q8b(u){return this.bYc(u)*this.rfg()}ytj(u){if(!u)throw Error.argumentNull("shape");var P=u.dS;u=this.Evb(P.TopLeft);
P=this.Evb(P.TopRight);return Yb.a.bN(kb.a.LF(u,P))}C5f(){return this.getBounds(this.i1g.Hc.WA)}getBounds(u){return this.af.mi(u)}rfg(){const u=this.i1g.Hc;return u?u.$T:1}Evb(u){return new kb.a(u.X,u.Y)}xGa(u){return u?!!this.ua.Ba&&this.ua.Ba.Cb.equals(u.slideId):!1}}Object(r.a)(xc,"ReplaceObjectViewHelper",null,[]);var Dc=d(446);class Vb{constructor(u,P,la){this.i1=this.G0=null;this.rU=u;this.gtk=P;this.Kdd=la}get GG(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Utb(){this.G0||
(this.G0=Object.assign(new No.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:Dc.a.r2e,outputSchema:Dc.a.r2e,func:Object(z.a)(this,this.kdb,"lambdaBeforeFunc")}));return this.G0}get htb(){return null}get lMb(){this.i1||(this.i1=Object.assign(new No.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:Dc.a.r2e,outputSchema:"ShapeTextConvertable",func:Object(z.a)(this,this.Dse,"lambdaRemoteFunc")}));return this.i1}kdb(u,P,la){if(u&&this.gtk.Joe())if(u){try{var Ca=Hd.a(u.ContextId)}catch(Ta){N.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.GG);la(null);return}this.Kdd.U9j(Ca.t)?this.Kdd.Hdj(Ca.shapeId)?la(u):(N.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.GG),la(null)):(N.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.GG),la(null))}else la(null),N.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.GG);else N.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.GG),la(null)}Dse(u,P,la){u?
u?this.rU.execute(Ca=>{Ca.csc(u.Topic,u.Data,u.ContextId,Ta=>{this.pLa(Ta)},Ta=>{this.nLa(Ta)},la)}):la(null):la(null)}pLa(u){if(!t.AFrameworkApplication.Yg&&u&&u.data){var P=u.data.state;if(P){try{var la=Hd.a(u.data.Wd)}catch(Ca){P(null);N.a.J(36804442,375,10,"Try parse aug response failed:{0}",Ca.message);return}P(la)}}}nLa(u){!t.AFrameworkApplication.Yg&&u&&u.data&&(u=u.data.state)&&u(null)}}Object(r.a)(Vb,"ReplaceObjectWacALWorkflow",null,[958]);var Lc=d(262);class dd{constructor(){this.xLe=null}ayc(u){return this.validate(u)?
this.xLe?this.xLe.ayc(u):!0:!1}erl(u){this.xLe=u}}Object(r.a)(dd,"ReplaceObjectWall",null,[]);class Ed extends dd{constructor(){super();this.Au=null}Pcg(u){const P=this.Au.R8b(u);u=this.Au.Q8b(u);var la=P*u;const Ca=this.Au.C5f().width,Ta=this.Au.C5f().height;la=la/(Ca*Ta)*100;N.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",P,u,Ca,Ta,la);return la}}Object(r.a)(Ed,"AreaRatioWall",dd,[]);class te extends Ed{constructor(u,
P){super();this.rpk=u;this.Au=P}validate(u){return this.Pcg(u)<=this.rpk}}Object(r.a)(te,"MaxAreaRatio",Ed,[]);class Ef extends dd{constructor(u,P){super();this.opk=u;this.Au=P}validate(u){return this.Au.Q8b(u)<=this.opk}}Object(r.a)(Ef,"MaxShapeHeight",dd,[]);class $f extends dd{constructor(u,P){super();this.tpk=u;this.Au=P}validate(u){return this.Au.R8b(u)<=this.tpk}}Object(r.a)($f,"MaxShapeWidth",dd,[]);class Mg extends Ed{constructor(u,P){super();this.Gpk=u;this.Au=P}validate(u){return this.Pcg(u)>=
this.Gpk}}Object(r.a)(Mg,"MinAreaRatio",Ed,[]);var ri=d(41);class ki extends dd{constructor(u,P){super();this.Fpk=u;this.Ga=P}validate(u){return this.Gqj(u,this.Ga)>=this.Fpk}Gqj(u,P){if(!u)return 0;let la=0;P.vG(u,Ca=>{Ca.Ta(ri.a.Oo)&&(Ca=Ca.eb(ri.a.Oo))&&0<Ca.length&&la++});return la}}Object(r.a)(ki,"MinParagraphCount",dd,[]);class hj extends dd{constructor(u,P){super();this.Dpk=u;this.Au=P}validate(u){return this.Au.Q8b(u)>=this.Dpk}}Object(r.a)(hj,"MinShapeHeight",dd,[]);class Ng extends dd{constructor(u,
P){super();this.Jpk=u;this.Au=P}validate(u){return this.Au.R8b(u)>=this.Jpk}}Object(r.a)(Ng,"MinShapeWidth",dd,[]);class Yl{constructor(u,P,la){this.Tfa=null;this.la=u;this.Ga=P;this.ZHb=la;this.init(this.la.replaceObjectClientWalls)}validate(u){return this.Tfa?this.Tfa.ayc(u):!0}init(u){u=this.XSi(u);this.dwi(u)}XSi(u){const P={};if(Gb.a.Xa(u))return P;u=u.split(";");for(const la of u)Gb.a.Xa(la)||(u=la.split(":"),2===u.length?P[u[0]]=u[1]:N.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
la));return P}dwi(u){const P=[];"MinParagraphCount"in u&&Array.add(P,new ki(Lc.d(u,"MinParagraphCount",0),this.Ga));"MinShapeHeight"in u&&Array.add(P,new hj(Lc.b(u,"MinShapeHeight",0),this.ZHb));"MaxShapeHeight"in u&&Array.add(P,new Ef(Lc.b(u,"MaxShapeHeight",Number.MAX_VALUE),this.ZHb));"MinShapeWidth"in u&&Array.add(P,new Ng(Lc.b(u,"MinShapeWidth",0),this.ZHb));"MaxShapeWidth"in u&&Array.add(P,new $f(Lc.b(u,"MaxShapeWidth",Number.MAX_VALUE),this.ZHb));"MinShapeAreaRatio"in u&&Array.add(P,new Mg(Lc.b(u,
"MinShapeAreaRatio",0),this.ZHb));"MaxShapeAreaRatio"in u&&Array.add(P,new te(Lc.b(u,"MaxShapeAreaRatio",Number.MAX_VALUE),this.ZHb));for(u=0;u<P.length-1;u++)P[u].erl(P[u+1]);0<P.length&&(this.Tfa=P[0])}}Object(r.a)(Yl,"ReplaceObjectWalls",null,[923]);class ll{constructor(){this.K=null;this.TO=this.sCe=this.ZCe=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Xb(u){this.K=u;(this.TO=this.K.resolve("PowerPointWebEditor.IApplicationContext").rd.yg)&&this.K.register(ej.a,"PowerPointWebEditor.PodsInfoSender").na().oa(()=>
new ej.a(t.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));u.register(dp,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").na().oa(()=>
new dp);u.register(xc,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").na().oa(()=>new xc(u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));u.register(922,"PowerPointWebEditor.IReplaceObjectGalleryView").na().oa(()=>new ie(u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("Common.IPointerInputManager"),u.resolve("Common.IClickInputManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.IInputHandlerManager"),u.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("Common.IBrowserUtils")));u.register(923,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").na().oa(()=>
new Yl(u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.IShapeReader"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));u.register(v,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").na().oa(()=>new v(u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.IApplicationSettings")));
u.register(924,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").na().oa(()=>new Ia(u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));u.register(925,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").na().oa(()=>u.resolve("Common.IAppSettingsManager").ka("473")?new W((P,la,Ca,Ta,
pb,Sb)=>{const Cc=new Hm(u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider"));Cc.gSa(P,la,Ca,Ta,pb,Sb);return Cc}):new Hb(new Hm(u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider"))));u.register(926,"PowerPointWebEditor.IReplaceObjectManager").na().oa(()=>u.resolve("Common.IAppSettingsManager").ka("473")?new on(u.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),u.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),u.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),u.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),u.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),u.resolve("PowerpointPresence.IPresenceEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.IApplicationSettings"),
u.resolve("PowerPointWebEditor.IActionNameResolver"),u.resolve("Common.ITaskManager"),u.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider")):new Im(u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),u.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),u.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
u.resolve("PowerpointPresence.IPresenceEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.IActionNameResolver"),u.resolve("Common.ITaskManager"),u.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.Ia("PowerPointWebEditor.IDesignerServiceProvider")));u.register(oa,"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").na().oa(()=>
new oa(u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),u.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
u.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("Box4.IPageView").Na,u.resolve("PowerPointWebEditor.IShapeReader")));u.register(Xm,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").na().oa(()=>new Xm(u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("Common.ITaskManager")));u.register(Mb,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").na().oa(()=>new Mb(u.resolve("Common.IClickInputManager"),u.resolve("Common.IPointerInputManager"),
u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPoint.IPathManager"),u.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));u.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").na().oa(()=>new be.a((P,la)=>{let Ca=null;const Ta=Object(U.a)(117,P.qc(u.resolve("Box4.IPageView").Na));
Ta&&!Ta.Ml&&Ta.nV&&(Ca=new Pc(P,Ta,la,u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPoint.IBrowserHelperManager"),u.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),
Ca.setup());return Ca}));u.register(204,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").na().oa(()=>new be.a((P,la)=>{let Ca=null;const Ta=Object(U.a)(117,P.qc(u.resolve("Box4.IPageView").Na));Ta&&!Ta.Ml&&Ta.nV&&(Ca=new Jc(P,Ta,la,u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),Ca.setup());return Ca}));u.register(Vb,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").na().oa(()=>
new Vb(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));u.register(gm,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").na().oa(()=>new gm(this.K.Ia("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));u.register(qn,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").na().oa(()=>
new qn(u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("Common.IActionManagerExtended"),u.resolve("PowerPointWebEditor.IFocusManager"),u.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
u.resolve("Common.Transaction.ITransactionFactory"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.View.IPPTPageView"),u.resolve("PowerPointWebEditor.IShapeReader")));u.register(Xn,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").na().oa(()=>new Xn(u.resolve("PowerPointWebEditor.IPptSelectionManager"),u.resolve("PowerPointWebEditor.View.IViewEventSource"),u.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),u.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
u.resolve("PowerPointWebEditor.IShapeReader"),u.resolve("PowerPointWebEditor.IApplicationSettings"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),u.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),u.resolve("PowerpointPresence.IPresenceEventHandlers"),u.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),u.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),
u.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),u.resolve("PowerPointWebEditor.IActionNameResolver"),u.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.TO&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");const u=this.K.resolve("Common.IAppSettingsManager");u.$e(()=>{const P=new Date;u.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?N.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):N.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");
if(this.ZCe=u.ka("463"))u.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.sCe=u.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();N.a.J(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+P)})}dispose(){this.ZCe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.sCe&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){m.a.instance.Ac(uc.a(new ll,0))}}Object(r.a)(ll,"PPTWebEditorReplaceObjectPackage",
null,[2,3]);var Nl=d(273),Ol=d(470),fn=d(1112);class Vh{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=
!1;this.wdDisableSPOFileCache=this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(r.a)(Vh,"AppSettings",null,[]);class Fo{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(r.a)(Fo,"ControllerFactoryParameters",null,[]);var gn=d(747),Zl=d(339);class wi{}wi.none="None";wi.vhFailedToLoadVersionList="VHFailedToLoadVersionList";wi.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";
wi.vhFailedToParseVersionList="VHFailedToParseVersionList";wi.vhFetchFailed="VHFetchFailed";wi.vhVersioningNotEnabled="VHVersioningNotEnabled";wi.vhFileNotFound="VHFileNotFound";wi.vhVersionTooOld="VHVersionTooOld";wi.jYl="VHFailedToRenderThumbnails";wi.iYl="VHFailedToRenderSlide";wi.hYl="VHFailedToRenderNotes";wi.fYl="VHFailedToRenderDiff";wi.kYl="VHFailedToShowAnimaitonIcon";wi.lYl="VHFailedToShowHiddenEffect";wi.gYl="VHFailedToRenderInitPresInfo";Object(r.a)(wi,"ErrorName",null,[]);class jm{constructor(){this.UIa=
new Rd.a;this.UIa.add(0,wi.none);this.UIa.add(100,wi.vhFailedToLoadVersionList);this.UIa.add(101,wi.vhFailedToGetDownloadToken);this.UIa.add(102,wi.vhFailedToParseVersionList);this.UIa.add(103,wi.vhFetchFailed);this.UIa.add(104,wi.vhVersioningNotEnabled);this.UIa.add(105,wi.vhFileNotFound);this.UIa.add(106,wi.vhVersionTooOld);this.sJa=new Rd.a;this.sJa.add(0,wi.none);this.sJa.add(100,wi.jYl);this.sJa.add(101,wi.iYl);this.sJa.add(102,wi.hYl);this.sJa.add(103,wi.fYl);this.sJa.add(104,wi.kYl);this.sJa.add(105,
wi.lYl);this.sJa.add(106,wi.gYl)}get Zvl(){return this.UIa}get zYl(){return this.sJa}static edg(){jm.OZe||(jm.OZe=new jm);return jm.OZe}}jm.mIf="ErrorCode";jm.OZe=null;Object(r.a)(jm,"VersionHistoryTelmetryHelper",null,[]);var Vp=d(313);class wj{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af,Ph,pf,He){this.ngd=this.JE=this.EGg=this.Gcd=this.uDb=this.b5=this.UIe=this.yY=this.FH=null;this.Ova=-1;this.aEb=null;if(!He)throw Error.argumentNull("clientRequestManager");this.ia=u;this.Qw=P;this.Hi=la;
this.Da=Ca;this.ic=Ta;this.DZa={};this.Fa=pb;this.Gg=Sb;this.gHb={};this.pc=ed;this.mgd={};this.Srk=Cc;this.Cfa=ad;this.Ya=Zd;this.Kwe=[];We&&(this.EGg=We,this.EGg.execute(Yf=>{this.JE=Yf}));this.FO=Qf;this.Zg=Af;this.Fve=Ph;this.DHb=pf;this.Qr=He;this.Bwk=new Vp.a(Ca.Haa)}vb(){this.ia.ya(F.a.Puc,J.a.frame,Object(z.a)(this,this.sCl,"showVersionHistoryDialogAction"));this.Da.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(wb.a.ljh,J.a.frame,Object(z.a)(this,this.IRe,"pptoShowFileVersion"));
this.ia.ya(wb.a.KSh,J.a.frame,Object(z.a)(this,this.hKj,"handleVersionHistoryCopySlides"))}sCl(u,P,la){if(1===la)return u=!1,this.Ya.yea&&(u=!0),u?2:32;2===la&&(t.AFrameworkApplication.iM("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),t.AFrameworkApplication.iM("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),this.ngd=bi.a.create().toString(),n.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: ${this.m_versionHistoryLaunchSessionId}. disableVHSPOFileCache: ${this.disableVHSPOFileCache()}"),
oc.c(wb.a.Afh,!0),this.DZa.VersionHistoryLaunchSessionId=this.ngd,this.gHb.VersionHistoryLaunchSessionId=this.ngd,this.DZa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.Gcd=[],this.FH||(this.FH=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Fo,{ulsLogger:new Ol.a,serviceBase:this.Da.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Da.ka("PPTVHPodsBootEnabled")?this.Da.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Da.getSetting("PodSID"):
"",docId:t.AFrameworkApplication.Pg,appSettings:Object.assign(new Vh,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Da.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.pc.Ho,wdEnableRestore:this.pc.Ho,userSessionId:t.AFrameworkApplication.userSessionId,wacCluster:this.Da.Ha("WacCluster"),uiLocale:this.Da.vKa?this.Da.vKa:"en-us",isRtl:t.AFrameworkApplication.isRtl,disabledChangeGates:this.Da.Ha("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Da.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),
wdEnableDeleteVersions:this.Da.ka("PPTVersionHistoryDeleteVersionsIsEnabled"),wdDisableSPOFileCache:this.N4b()}),perfTelemetryInfos:this.Gcd}))),this.FH&&this.FH.setDisableSaveACopy(t.AFrameworkApplication.Vx),this.tCl());return 32}IRe(u,P,la){return 1===la&&this.Ya.yea?2:this.ia.processAction(F.a.Fuc,la)}hKj(u,P,la){if(1===la)return this.wDh()?2:32;this.yY.onCopySlides();return 32}tCl(){var u;if(!document.getElementById("VersionHistoryOverlay")){this.X7k();this.T7k();this.U7k();this.O7k();this.M7k();
this.S7k();this.R7k();this.P7k();const P=document.createElement("div");P.id="VersionHistoryOverlay";P.style.width="100%";P.style.zIndex="998";P.style.display="block";P.style.position="absolute";P.style.top="0px";if(this.Da.ka("RegionComposerIsEnabled")){const la=(null===(u=document.getElementById("HeaderRegion"))||void 0===u?void 0:u.offsetHeight)||0;P.style.top=la+"px";P.style.bottom="0px";P.style.height=`calc(100vh - ${la}px)`}else P.style.height="calc(100% + "+sa.AFrame.iwd+"px)";document.getElementById("WACInnerFrame").appendChild(P);
this.UIe=this.FH.createVersionHistoryDialog(P);this.Llb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.FH.getTipVersion&&this.Da.ka("PPTVHPodsBootEnabled")&&this.FH.getTipVersion();this.FH.getVersions("");this.odi()}odi(){try{this.aEb=this.Srk.Jhj();for(let u=0;u<this.aEb.length;u++)this.Gg.Eo(this.aEb[u]);this.Gg.hL(Fd.a.RRb)}catch(u){n.ULS.sendTraceTag(512508633,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",u)}}jUi(){try{if(this.aEb)for(let u=
0;u<this.aEb.length;u++)this.Gg.hL(this.aEb[u]);else n.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.Gg.Eo(Fd.a.RRb)}catch(u){n.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",u)}}X7k(){this.FH.getFullAppErrorEvent().addListener(u=>{try{const P=jm.edg().Zvl.ga(u);this.gHb[jm.mIf]=P;n.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",P,this.ngd)}catch(P){n.ULS.sendTraceTag(512508629,
822,10,"Exception in FullAppErrorEvent call back: {0}.",P)}})}T7k(){this.FH.getVersionsReadyEvent().addListener(u=>{this.Gth(u.containerDiv);try{n.ULS.sendTraceTag(508843726,822,50,"registerForVersionReadyEvent - getVersionsReadyEvent - disableVHSPOFileCache: ${this.disableVHSPOFileCache()}");if(this.N4b())for(let P of u.versions)this.JSl(P);this.Dhi(u.versions);this.Fa.cV("VersionHistoryOverlay",!0);this.b5&&this.b5.DownloadUrl.length&&this.yY&&(this.MTh(),this.Klg(),this.yY.onVersionSelected(this.b5,
this.uDb,this.DZa),this.vMf())}catch(P){n.ULS.sendTraceTag(512508628,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",P)}})}Dhi(u){const P=this.yY.getAppDataStore();for(const la of u)P.AddVersionInfoToStore(la)}U7k(){this.FH.getVersionSelectedEvent().addListener(u=>{this.b5=u.currentVersion;this.uDb=u.baseVersion;if(this.yY&&this.b5.DownloadUrl.length)try{this.MTh(),this.Klg(),this.yY.onVersionSelected(u.currentVersion,u.baseVersion,this.DZa),this.q9k(),this.vMf()}catch(P){n.ULS.sendTraceTag(512508627,
822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",P)}})}q9k(){const u=this.t9b(2);u&&(Le.a.addHandler(u,Fa.a.Df,Object(z.a)(this,this.nA,"keyDownHandler")),ya.a.instance.ub(u,Object(z.a)(this,this.LC,"contextMenuHandler")))}gRl(){const u=this.t9b(2);u&&(Le.a.removeHandler(u,Fa.a.Df,Object(z.a)(this,this.nA,"keyDownHandler")),ya.a.instance.Bb(u,Object(z.a)(this,this.LC,"contextMenuHandler")))}nA(u){try{if(u.shiftKey&&u.keyCode===pa.a.hqa||u.keyCode===pa.a.pNa){const P=
fn.a.create(Fa.a.contextMenu,u,1);this.LC(P)}}catch(P){n.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",P)}}LC(u){if(1===u.kg){const P=this.t9b(2);P&&(u.clientPoint.x=bb.a.Z$d(P)+kg.a.Lsa,u.clientPoint.y=bb.a.aae(P)+kg.a.Lsa)}return 32===this.ia.Ja(wb.a.mPf,2,u)}O7k(){this.FH.getDownloadTokenReadyEvent().addListener(u=>{try{if(n.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.uDb)if(u&&u.updatedVersions&&
2<=u.updatedVersions.length){let P=null,la=null;const Ca=wj.Yyb(this.b5),Ta=wj.Yyb(this.uDb);for(const pb of u.updatedVersions){const Sb=wj.Yyb(pb);Ca===Sb?P=pb:Ta===Sb&&(la=pb);if(P&&la)break}P&&la?(this.b5=P,this.uDb=la,this.yY.diff(this.b5,this.uDb)):n.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Ca,Ta)}else n.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else n.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(P){n.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",P)}})}N4b(){return this.Bwk.i5i||this.Da.ka("DisableVHSPOFileCache")}WZi(u){return u?0!=u.indexOf("SequenceNumber")?(n.ULS.sendTraceTag(508859522,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL does not start with SequenceNumber: {0}",
u),!1):!0:(n.ULS.sendTraceTag(508859523,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL is null or empty"),!1)}JSl(u){if(u&&this.WZi(u.DownloadUrl)){var P=this.Da.popsServiceBase+"VersionHistoryDownloadLink.ashx";const la=t.AFrameworkApplication.Pg;if(la)P=new Aa.QueryStringBuilder(P),P.xg(hi.a.mQk,la),P.xg(hi.a.sQk,u.DownloadUrl),P.xg(hi.a.qQk,wj.Yyb(u)),u.DownloadUrl=P.toString(),n.ULS.sendTraceTag(508940565,822,50,"VersionHistoryPaneActor - updateDownloadUrl - Generated download URL");
else throw n.ULS.sendTraceTag(508936896,822,15,"VersionHistoryPaneActor - updateDownloadUrl - QuerySignature not found"),Error("Could not update downloadUrl with valid VersionHistoryDownloadLink - QuerySignature not found");}else throw Error("Could not update downloadUrl with valid VersionHistoryDownloadLink - Invalid SyncToken");}S7k(){this.FH.getSaveACopySelectedEvent().addListener(u=>{n.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",u);this.Da.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&
wj.DDk();let P=t.AFrameworkApplication.fCb;this.Da.ka("VHSaveACopyForOdcOnSpoEnabled")&&(P=32===this.ia.processAction(wb.a.wpc,1));u=P?this.ia.Ja(wb.a.wpc,2,{["FileDownloadUrl"]:u}):this.ia.Ja(F.a.Ukb,2,{["FileDownloadUrl"]:u});32!==u?(oc.c(wb.a.w_d,!1),n.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",u)):oc.c(wb.a.w_d,!0)})}AMh(u,P){try{(new Promise((la,Ca)=>{this.FH.setRestoreInProgress();this.Cfa.ANc(this.Ya.Wk,this.Ya.podSessionId,this.Ya.presentationId.string,
this.Da.getSetting("361"),this.Ya.Gaa,!1,!0,()=>{la(!0)},Ta=>{Ca("ClosePopWacSessionSync:: "+Ta.error.message)})})).then(()=>{(new Promise((la,Ca)=>{this.Cfa.Wqd(this.Ya.presentationId.string,u,()=>{la(!0)},Ta=>{Ca("RestoreFileVersion:: "+Ta.error.message)})})).then(()=>{const la=Date.now()-P;n.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",la);this.gHb.RestoreSucceededTime=la;this.ia.Ja(wb.a.refresh,2,{["IsSourceVH"]:!0});oc.c(wb.a.v2b,
!0)}).catch(la=>{const Ca=Date.now()-P;this.FH.setRestoreFailedAtServer(()=>{this.ia.Ja(wb.a.refresh,2,{["IsSourceVH"]:!0})});n.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",la,Ca);this.gHb.RestoreFailedTime=Ca;oc.c(wb.a.v2b,!1)})})}catch(la){n.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",la.message),oc.c(wb.a.v2b,!1)}}R7k(){this.FH.getRestoreVersionSelectedEvent().addListener(u=>{n.ULS.sendTraceTag(512508615,
832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",u);const P=Date.now();this.JE?(this.Kwe=this.JE.w7b(),0<this.Kwe.length?(n.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.Kwe.length),oc.c(wb.a.v2b,!1),this.FH.setCoauthRestoreError(),this.Da.ka("PPTVersionHistoryRestoreSurveyEnabled")&&wj.ebk()):this.AMh(u,P)):(n.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.AMh(u,
P))})}P7k(){this.FH.getDownloadVersionSelectedEvent().addListener(u=>{n.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");u=new Aa.QueryStringBuilder(u);u.xg(hi.a.Fgh,t.AFrameworkApplication.fileName);u=this.ia.Ja(F.a.downloadACopy,2,{["FileDownloadUrl"]:u.toString()});32!==u?(oc.c(wb.a.v_d,!1),n.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",u)):oc.c(wb.a.v_d,!0)})}MTh(){for(const u of this.Gcd){const P=u.TelemetryEventKey?
u.TelemetryEventKey:u.telemetryEventKey?u.telemetryEventKey:"",la=u.TelemetryEventData?u.TelemetryEventData:u.telemetryEventData?u.telemetryEventData:"";Gb.a.Xa(P)||Gb.a.Xa(la)||(this.DZa[P]=la)}}vMf(){this.Gcd=[];this.DZa={}}M7k(){this.FH.getCloseSelectedEvent().addListener(()=>{this.Da.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&wj.dbk();this.fNf()})}fNf(){this.jUi();this.Fa.J1("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Da.ZFf&&(this.b5=
null);n.ULS.sendTraceTag(512508610,822,50,Hd.c(this.gHb))}Gth(u){try{if(this.yY)Lf.setIsPageLoadForFirstTime(!1),this.yY.switchParentViewContainer(u);else{Lf.setIsPageLoadForFirstTime(!0);const P=new PowerPointVersionHistory.AppBootSettings;P.RenderServiceBase="";P.IsRtl=t.AFrameworkApplication.isRtl;const la=new PowerPointVersionHistory.AppCallbackBag;la.animationDecoratorCallback=Object(z.a)(this.Qw,this.Qw.G1d,"createAnimationOrTransitionStar");la.notesIconDecoratorCallback=Object(z.a)(this,this.RPi,
"createNotesIcon");la.addToF6LoopCallback=Object(z.a)(this,this.lhi,"addToF6Loop");la.copySlideCallback=Object(z.a)(this,this.copySlideCallback,"copySlideCallback");la.reportViewerErrorCallback=Ca=>{this.gHb[jm.mIf]=jm.edg().zYl.ga(Ca);106!==Ca&&103!==Ca||this.FH.setViewerError(!0);n.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",Ca);0!==Ca&&(t.AFrameworkApplication.No(Uh.a.Ph(406)),eg.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};
P.IsHighContrast=!1;this.Hi&&(P.IsHighContrast=this.Hi.isInHighContrastMode);P.IsHighContrast&&(P.ClientColorSettings=this.Hi.highContrastColors.foregroundTextColor+"_"+this.Hi.highContrastColors.backgroundColor+"_"+this.Hi.highContrastColors.linkColor);if(this.ic){const Ca=this.ic.wUa();P.DefaultSlideWidth=Ca.width;P.DefaultSlideHeight=Ca.height}P.UserSessionId=t.AFrameworkApplication.userSessionId;P.VersionViewerCssUrl=this.Da.versionHistoryViewerCssUrl;P.ProgressImageResourceUrl=lh.a.PN(kg.a.Joa);
P.ThumbnailShareOptimizationEnabled=this.Da.pptvhThumbnailShareOptimizationEnabled;P.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Da.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Da.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Da.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Da.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Da.getSetting("PPTVHSlidePrefetchDelay")});
P.FileExtension=void 0!==this.Da.uKa&&null!==this.Da.uKa?Gb.a.IQ(this.Da.uKa).toLowerCase():"";P.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;P.NotesButtonLabel=ResourceStrings.L_Notes;P.SynchronizerTimeout=this.Da.getSetting("PptVersionHistorySynchronizerTimeout");P.IsRtl=t.AFrameworkApplication.isRtl;P.IsCopySlidesEnabled=!0;P.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;P.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;P.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
P.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;P.Lcid=t.AFrameworkApplication.lcid;P.EnableOverflowXOnSlideAndNotePane=this.Da.ka("PodVHEnableOverflowXOnSlideAndNotePane");P.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;P.IsModernCatchUpUxEnable=!0;P.IsRevisionTrackingFlyoutEnabled=Gd.a("EnableRevisionTrackingFlyoutForVH");P.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.yY=new PowerPointVersionHistory.AppVersionController(P,u,la)}}catch(P){this.FH.setViewerError(!0),
n.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",P)}}RPi(){return ia.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}Llb(){const u=this.Fa.Ic("VersionHistoryOverlay");u.parent=sa.AFrame.$i;u.zJ=!0;u.MYe=!0;u.Oca(P=>{P&&"dialog/modal"===P.name?this.FH.setSaveACopyCanceled():P&&P.name===sa.AFrame.qP||(this.Ova=-1,this.wNh(!0))});this.Gg.r3("VersionHistoryOverlay");this.Gg.wtc(Fd.a.RRb,
P=>{this.wNh(P)});this.Gg.jOb(Fd.a.RRb,()=>{2===this.Ova&&Sys.UI.DomElement.addCssClass(this.t9b(2),"PPTVHViewerElementSelected");3===this.Ova&&Sys.UI.DomElement.addCssClass(this.t9b(3),"PPTVHViewerElementSelected")})}wNh(u){try{const P=this.KYc();(this.Ova=this.Bpj(u))?1===this.Ova?this.UIe.then(la=>{la.enterHeaderFocusTrapZone();return null}):P&&kd.FocusManager.Zq(document.getElementById(P[this.Ova])):this.UIe.then(la=>{la.enterFocusTrapZone();return null})}catch(P){n.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",P)}}Bpj(u){const P=this.KYc();let la=this.Ova;do if(u?P&&(la=(la+1)%P.length):P&&(la=0<la?la-1:P.length-1),!la||1===la||P&&"none"!==document.getElementById(P[la]).style.display)return la;while(la!==this.Ova);return 0}Klg(){const u=wj.Yyb(this.b5);this.mgd[u]||(this.mgd[u]=["VersionListPane","vhHeader"],this.Ova=-1)}KYc(){if(!this.b5)return this.Da.ZFf?["VersionListPane","vhHeader"]:null;const u=wj.Yyb(this.b5);return this.mgd[u]?
this.mgd[u]:null}t9b(u){const P=this.KYc();return P&&P.length>u?document.getElementById(P[u]):null}lhi(u){try{const P=this.KYc();P&&P.push(u)}catch(P){n.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",P)}return!0}copySlideCallback(u){if(this.wDh())return!1;const P=bi.a.create().toString();n.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",P);const la=this.FO.VOc(1,u.SlideIds.length),Ca={};Ca.WacSessionId=t.AFrameworkApplication.userSessionId;
Ca.CallerCorrelationId=P;var Ta={};Ta.Source=u.Source;Ta.SlideIds=u.SlideIds;Ta.CcpId=la.Kp;Ta.PackageAccessKey=la.Py;u=JSON.stringify(Ta);Ta=String.format("{0}{1}",this.Da.podsWebServiceBase,"vhcopyslide.ashx");const pb=Date.now();try{if(this.Qr.qj(Ta,2,u,Ca,!1,0,Sb=>{wj.eYl(Sb,pb,P)},Sb=>{wj.dYl(Sb,pb,P)},null,null),this.Zg.contentWindow&&this.Zg.contentWindow.document&&this.Zg.contentWindow.document.body){Ib.a.n2b(this.Zg);const Sb=Ib.a.mda();Sb.innerText=Ib.a.l8g;Sb.setAttribute(Zl.a.Kp,la.Kp);
Sb.setAttribute(Zl.a.OD,la.OD);Sb.setAttribute(Zl.a.count,la.objectCount.toString());const Cc=gn.a(la.dataType);Sb.setAttribute(Zl.a.type,Cc);Sb.setAttribute(Zl.a.location,la.location);Sb.setAttribute(Zl.a.Py,la.Py);this.Zg.contentWindow.document.body.appendChild(Sb);this.Fve.i1a(this.Zg);this.DHb.copy(this.Zg)}else n.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Sb){n.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Sb)}return!0}wDh(){return(t.AFrameworkApplication.XE||t.AFrameworkApplication.Vx)&&!t.AFrameworkApplication.YSa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.fNf();this.gRl()}static Yyb(u){return u.RevisionID?u.RevisionID:u.revisionID?u.revisionID:""}static eYl(u,P,la){const Ca=Date.now();try{JSON.parse(u.data.Wd).IsCopied?n.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",
Ca-P,la):n.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",Ca-P,la)}catch(Ta){n.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Ta,la)}}static dYl(u,P,la){const Ca=Date.now();n.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",Ca-P,u.data?u.data.Oe:-1,la)}static dbk(){const u=w.a.instance.rb("Common.ISystemInitiatedFeedback");
u?(u.logActivity("VersionHistoryExited",null),u.logActivity("VersionHistoryCheckExited",null)):n.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static DDk(){const u=w.a.instance.rb("Common.ISystemInitiatedFeedback");u?u.logActivity("VersionHistoryExited",null):n.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static ebk(){const u=w.a.instance.rb("Common.ISystemInitiatedFeedback");u?u.logActivity("VersionHistoryRestoreCoauthFailed",null):n.ULS.sendTraceTag(512508568,
822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(r.a)(wj,"VersionHistoryPaneActor",null,[991,108]);class wp{constructor(){this.mFc=this.Ea=null}get name(){return"PowerPointWebEditor.VersionHistory"}Xb(u){this.Ea=u}init(){t.AFrameworkApplication.fa.$e(Object(z.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){t.AFrameworkApplication.G4c()?this.Ea.resolve("PowerPointWebEditor.IApplicationSettings").$2c?n.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):
(n.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Db.a.get_instance().Vj(7,()=>{ci.a(this.Ea)("versionHistory").catch(u=>n.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",u)).then(()=>this.wNk()).catch(u=>n.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",u))})):n.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}wNk(){this.B3b();
return null}B3b(){this.Ea.register(wj,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").oa(()=>new wj(t.AFrameworkApplication.Qa,this.Ea.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Ea.resolve("Common.Utils.IHighContrastDetector"),this.Ea.resolve("PowerPointWebEditor.IApplicationSettings"),this.Ea.resolve("PowerPointWebEditor.IPresentationReader"),kd.FocusManager.instance(),Nl.a.instance,this.Ea.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Ea.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ea.resolve("PowerPointWebEditor.IPopWebService"),this.Ea.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Ea.Ia("PowerpointPresence.IPresenceManager"),this.Ea.resolve("PowerPointWebEditor.IClipServiceManager"),this.Ea.resolve("PowerPointWebEditor.IDesignModeManager").eDa,this.Ea.resolve("PowerPoint.IBrowserHelperManager"),this.Ea.resolve("PowerPointWebEditor.ISystemClipboard"),t.AFrameworkApplication.Je)).na();this.mFc=this.Ea.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.mFc.vb()}dispose(){this.mFc&&this.mFc.dispose()}}Object(r.a)(wp,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var Wp=d(463),Yo=d(745),Pn;(function(u){u[u.anyone=0]="anyone";u[u.organization=1]="organization"})(Pn||(Pn={}));Object(r.b)("AccessControlEnum",Pn);var Go=d(338);class ug{constructor(){this.token=this.timeStamp=null}}Object(r.a)(ug,"CachedAccessToken",null,[]);class si{constructor(u){this.Ive={};this.Pkk=u}yyi(u,P){if(!Gb.a.Xa(u)&&!Gb.a.Xa(P)){const la=new ug;la.token=P;la.timeStamp=
new Date;this.Ive[u]=la}}C6f(u){return u in this.Ive&&(u=Object(U.a)(ug,this.Ive[u]),+new Date-+u.timeStamp<6E4*this.Pkk)?u.token:null}}Object(r.a)(si,"AccessTokenCache",null,[]);class Ak{constructor(){this.reject=this.resolve=this.frame=this.uga=this.bbf=this.resource=this.appId=this.authority=this.id=null;this.enb=0;this.jYe=null;this.apc=0;this.ENh=!1}}Object(r.a)(Ak,"DirectAuthRequest",null,[]);class Ar{constructor(u){this.mjc={};this.la=u;this.oJa=new si(this.la.eVk);window.addEventListener("message",
Object(z.a)(this,this.$el,"requestCompletionMessageHandler"),!1)}H9f(u){const P={},la=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Ca;for(;Ca=la.exec(u);)P[Object(U.a)(String,Ca[1])]=Object(U.a)(String,Ca[2]);return P}$el(u){if("data"in u){var P;({Su:P}=Hd.d(u.data)).returnValue&&P&&"DirectAuthRequestID"in P&&this.wzb(P)}}wzb(u){try{const Ca=u.DirectAuthRequestID;if(Ca in this.mjc){var P=null,la=Object(U.a)(Ak,this.mjc[Ca]);if(la&&la.id===Ca){N.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
Ca,"Timeouted"in u,"FromPolling"in u);window.clearTimeout(la.enb);delete this.mjc[Ca];window.clearTimeout(la.apc);const Ta=new Go.a;Ta.IsSuccess=!1;Ta.ErrorCode="";Ta.ErrorMessage="";Ta.Token="";"Timeouted"in u?(N.a.J(592238722,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Ta.ErrorCode="Timeout",Ta.ErrorMessage="No response received in time for the authentcation request",la.resolve(Ta)):"PopupWindowClosed"in u&&la.uga?(Ta.ErrorCode="User_aborted",Ta.ErrorMessage="User aborted log in by closing the popup window",
la.resolve(Ta)):(la.frame?P=this.H9f(la.frame.contentWindow.location.hash):la.uga&&!la.uga.closed&&(P=this.H9f(la.uga.location.hash)),"access_token"in P?(Ta.IsSuccess=!0,Ta.Token=Object(U.a)(String,P.access_token),this.oJa&&this.oJa.yyi(la.jYe,Ta.Token),la.resolve(Ta)):(Ta.ErrorCode="error"in P?Object(U.a)(String,P.error):"unknown",0<=Array.indexOf(this.la.gVk,Ta.ErrorCode)&&la.ENh&&la.frame&&!la.uga?this.FUk(la.authority,la.appId,la.resource,la.bbf,this.la.hVk).then(pb=>{la.resolve(pb)}).catch(pb=>
{la.reject(pb)}):(Ta.ErrorMessage="error_description"in P?Object(U.a)(String,P.error_description):"unknown",la.resolve(Ta))));la.frame?document.body.removeChild(la.frame):la.uga&&!la.uga.closed&&la.uga.close()}else N.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",Ca)}else N.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(u))}catch(Ca){N.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
Ca.message)}}KOf(){const u=window.location.protocol,P=window.location.host;var la="/p/";N.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",u,P,"ffc-powerpoint.officeapps.live.com"===P||"ppc-powerpoint.officeapps.live.com"===P);if(void 0===la||null===la){la=window.location.pathname;const Ca=la.lastIndexOf("/");la=0<=Ca?la.substring(0,Ca+1):""}return u+"//"+P+la+"WacDirectAuth.html"}wOl(u,P,la,Ca,Ta,pb=!1){return this.CCl(u,P,la,Ca,Ta,pb)}FUk(u,
P,la,Ca,Ta){if(Gb.a.Xa(u))throw Error.argumentNull("authority");if(Gb.a.Xa(P))throw Error.argumentNull("appId");if(Gb.a.Xa(la))throw Error.argumentNull("resource");if(Gb.a.Xa(Ca))throw Error.argumentNull("userUPN");const pb=!Gb.a.Xa(Ca)&&Ca.indexOf("@")<Ca.indexOf("."),Sb=this.KOf(),Cc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",u,P,encodeURIComponent(la),encodeURIComponent(Sb));if(this.oJa){const Zd=
this.oJa.C6f(Cc);if(!Gb.a.Xa(Zd))return N.a.J(593782154,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(We=>{const Qf=new Go.a;Qf.IsSuccess=!0;Qf.ErrorCode="";Qf.ErrorMessage="";Qf.Token=Zd;We(Qf)})}const ed=bi.a.create().toString(),ad=String.format("{0}&state={1}",Cc,ed);return new Promise((Zd,We)=>{const Qf=new Ak;Qf.authority=u;Qf.appId=P;Qf.resource=la;Qf.bbf=Ca;Qf.resolve=Zd;Qf.reject=We;Qf.id=ed;Qf.jYe=Cc;Qf.uga=window.open("",ed,"width=400, height=600");Qf.uga?(this.mjc[ed]=
Qf,Qf.uga.location.replace(ad),N.a.J(593782152,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",ed,pb),this.kHh(Qf,1E3*Ta).then(()=>{const Af={};Af.DirectAuthRequestID=ed;Af.FromPolling=!0;this.wzb(Af)}).catch(Af=>{"WindowClosed"===Object(U.a)(String,Af)&&(Af={},Af.DirectAuthRequestID=ed,Af.PopupWindowClosed=!0,N.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+ed),this.wzb(Af))}),Qf.enb=window.setTimeout(()=>{const Af={};Af.DirectAuthRequestID=
ed;Af.Timeouted=!0;N.a.J(593782148,833,10,"DirectAuth: Popup request timedout with ID of: "+ed);this.wzb(Af)},1E3*Ta)):(N.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",ed),We=new Go.a,We.IsSuccess=!1,We.ErrorCode="fail_to_open_popup",We.ErrorMessage="Failed to create popup window!",We.Token="",Zd(We))})}CCl(u,P,la,Ca,Ta,pb){if(Gb.a.Xa(u))throw Error.argumentNull("authority");if(Gb.a.Xa(P))throw Error.argumentNull("appId");if(Gb.a.Xa(la))throw Error.argumentNull("resource");
if(Gb.a.Xa(Ca))throw Error.argumentNull("userUPN");const Sb=!Gb.a.Xa(Ca)&&Ca.indexOf("@")<Ca.indexOf(".");var Cc=this.KOf();const ed=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",u,P,encodeURIComponent(la),encodeURIComponent(Cc));if(this.oJa){const We=this.oJa.C6f(ed);if(!Gb.a.Xa(We))return N.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Qf=>{const Af=
new Go.a;Af.IsSuccess=!0;Af.ErrorCode="";Af.ErrorMessage="";Af.Token=We;Qf(Af)})}const ad=bi.a.create().toString();Cc=Sb?String.format("{0}&login_hint={1}&state={2}",ed,encodeURIComponent(Ca),ad):String.format("{0}&state={1}",ed,ad);const Zd=document.createElement("iframe");Zd.style.display="none";Zd.src=Cc;return new Promise((We,Qf)=>{const Af=new Ak;Af.authority=u;Af.appId=P;Af.resource=la;Af.bbf=Ca;Af.frame=Zd;Af.resolve=We;Af.reject=Qf;Af.id=ad;Af.jYe=ed;Af.ENh=pb;document.body.appendChild(Zd);
N.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",ad,Sb);this.kHh(Af,1E3*Ta).then(()=>{const Ph={};Ph.DirectAuthRequestID=ad;Ph.FromPolling=!0;this.wzb(Ph)});Af.enb=window.setTimeout(()=>{const Ph={};Ph.DirectAuthRequestID=ad;Ph.Timeouted=!0;N.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+ad);this.wzb(Ph)},1E3*Ta);this.mjc[ad]=Af})}kHh(u,P){return new Promise((la,Ca)=>{const Ta=P/50;let pb=0;u.apc=window.setInterval(()=>
{try{pb++>Ta&&(window.clearInterval(u.apc),N.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",P,Ta),Ca(""));const Sb=u.frame?u.frame.contentWindow:u.uga;if(!Sb||Sb.closed)window.clearInterval(u.apc),N.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),Ca("WindowClosed");let Cc=null,ed=null;try{Cc=Sb.location.href,ed=Sb.location.hash}catch(ad){}Cc&&"about:blank"!==Cc?Gb.a.Xa(ed)||(window.clearInterval(u.apc),
la(ed)):N.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===Cc)}catch(Sb){N.a.J(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Sb.message)}},50)})}}Object(r.a)(Ar,"DirectAuthHelper",null,[]);class fp{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=
this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(r.a)(fp,"ILiveActorSettings",null,[]);class Ro{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(r.a)(Ro,"ILiveReaction",null,[]);class Vq{constructor(){this.isPaused=
this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(r.a)(Vq,"ILiveSessionState",null,[]);class Wq{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(r.a)(Wq,"ILiveSessionURL",null,[]);class yt{constructor(){this.ASg=this.zSg=null}}Object(r.a)(yt,"PollObjectInfo",null,[]);var Kk;(function(u){u[u.none=0]="none";u[u.singleLineRibbon=1]="singleLineRibbon";u[u.multipleLineRibbon=2]="multipleLineRibbon";u[u.slideShowToolbar=3]="slideShowToolbar";
u[u.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";u[u.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Kk||(Kk={}));Object(r.b)("LiveEntryPoint",Kk);var Xq;(function(u){u[u.none=0]="none";u[u.callout=1]="callout";u[u.businessBar=2]="businessBar";u[u.pausedSessionTimeout=3]="pausedSessionTimeout";u[u.slideshowContextMenu=4]="slideshowContextMenu";u[u.accessControlChange=5]="accessControlChange";u[u.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Xq||(Xq={}));Object(r.b)("LiveExitPoint",
Xq);var qm=d(687);class Br{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af){this.va=new kn.a;this.uHa=this.oEb=this.c9c=this.Pze=this.xFg=!1;this.qgc=this.Bze=this.f9c=!0;this.Ijc=this.vHb=!1;this.Vp=this.Bj=this.Rea=this.oo=null;this.bXa=0;this.IFb=-1;this.OGb=30;this.oic=-1;this.Jd=this.una=this.I0=null;this.c0g=this.w4g=this.Ded=this.Aed=0;this.Gec=this.rva=this.XWa=null;this.ODe=this.meb=0;this.nmb=null;this.uIe=new Set;this.tIe=new Map;this.Zad=null;this.Hic=1;this.nic=this.o8c=this.$O=this.Rna=
this.eJe=this.oxe=null;this.le=Ca;this.la=u;this.GFg=!1;this.kb=la;this.ic=pb;this.qq=Sb;this.Mc=Cc;this.Hz=ed;this.Ya=ad;this.Jc=Zd;this.Xl=We;this.KYa=Qf;this.Fa=Af;if(this.Yr=P)this.Rea=P.UF();this.CM=Ta;this.bXa=this.I0f?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.oxe=new Ar(this.la));this.Mc.qB(Object(z.a)(this,this.Daa,"onPodSessionRehydrated"));this.Hz.FUd(Object(z.a)(this,this.rJb,"onPodSessionUnavailable"));this.lTa()&&this.Xl.execute(Ph=>{Ph.show(ResourceStrings.L_LivePresentations_Disconnected,
qm.a.RIb);Ph.hide()});N.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get Jr(){return this.la.powerPointLiveBroadcastEnabled&&this.f9c}get f$a(){return this.Pze}set f$a(u){(this.Pze=u)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get lr(){return!!this.Vp}get Ida(){return this.GFg}set Ida(u){this.GFg=u}get mEa(){return this.xFg}set mEa(u){this.xFg=u}get oTa(){return!!this.Vp&&this.Vp.isPaused}get s5i(){return this.c9c}get nEa(){return this.qgc}set nEa(u){this.qgc=
u}get c5i(){return this.f$a&&this.Jr&&!!this.oo}get accessControl(){return this.bXa}set accessControl(u){this.bXa=u}get I0f(){return"true"===this.Tbg("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get D0f(){return this.Jr&&this.lr&&this.Bj?this.Bj.isWelcomeScreenVisible():!1}lxb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&this.la.knd&&this.Jc.i6b?this.Jc.nxb?this.Ijc=!0:this.Jc.U0f||this.Ijc:!0}Wkd(u,P,la,Ca,Ta,pb,Sb,Cc,ed){if(this.Jr){this.kb.xUd(Object(z.a)(this,this.Rdh,
"onSlideShowEnterEndOfShow"));this.kb.zUd(Object(z.a)(this,this.Sdh,"onSlideShowLeaveEndOfShow"));this.kb.QJc(Object(z.a)(this,this.Gxa,"onGetCurrentSlideDimensionsHandler"));this.oEb=!1;this.uHa=!0;try{this.la.cnd&&this.wcj();const ad=this.sce(Ta,Ca);if(this.oo)(this.mEa||this.oTa)&&this.oo.FetchDocumentDownloadURL(ad);else{N.a.J(512496259,833,50,"Creating Broadcast monitor ...");const Zd=new PowerPointLive.PPTBroadcastMonitorSettings;Zd.isBlueChicken=this.la.isBlueChicken;Zd.fileDownloadUrl=ad;
Zd.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;Zd.broadcastSubtitlesFromSpeechFrontDoor=!0;Zd.pragueInitTimeoutInMS=this.la.jVk;Zd.preferredSubtitleLanguage=this.Jc.JYc();Zd.useStateService=this.la.sVk;Zd.numMaxAttempts=this.la.mVk;Zd.delayInSecsToCloseBroadcasterOnPause=this.la.dVk;Zd.batchedRequestsEnabled=this.la.aVk;Zd.sharedSessionSettings={};Zd.websocketAliveTimeAfterLoseFocusInMs=this.la.tVk;Zd.pingTimeoutInMs=this.la.kVk;Zd.pongTimeoutInMs=this.la.lVk;Zd.enableTransientSessionHandling=
this.la.OVk;Zd.maxStateServiceRoundtripRaw=t.AFrameworkApplication.fa.uc("PPTLiveMaxStateServiceRoundtripRaw",300);Zd.sharedSessionSettings.MaxStateServiceRoundtripRaw=Zd.maxStateServiceRoundtripRaw;Zd.documentSnapshotRequestUrlGenerator=this.la.LVk?()=>this.sce(this.Ya.podSessionId,this.Ya.Ck):null;this.la.gjh&&(Zd.sharedSessionSettings.IsAutomation=!0);this.oo=new PowerPointLive.PPTBroadcastMonitor(Zd);this.oo.RegisterParticipantsCountChangeEventListener(We=>{this.Jd.telemetryData.maxParticipantCount=
Math.max(this.Jd.telemetryData.maxParticipantCount,We);this.Bj&&this.Bj.setParticipantCount(We);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});this.oo.RegisterNewReactionEventListener(Object(z.a)(this,this.dCk,"newReactionHandler"));this.oo.RegisterConnectionStateEventListener(Object(z.a)(this,this.AJi,"connectionStateHandler"))}this.oo.SetCurrentPosition(u,P-1,null);this.meb=u;this.mEa&&!this.Vp&&ed?(this.hvc(t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.Rp?1:2,
Sb,la,Ta,Cc),this.YFi(u),this.rva=new Set):this.I0&&this.Tzb();this.rva&&this.rva.add(u)}catch(ad){N.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",ad.toString())}}}vNl(){window.setTimeout(()=>{const u=this.meb===this.ODe;this.Jr&&this.lr&&u&&this.Vp&&!this.Vp.isPaused&&(N.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.Oyd(0),this.TQb(0))},6E4*this.la.oVk)}qMk(){this.Jr&&(this.kb.jXe(Object(z.a)(this,this.Rdh,
"onSlideShowEnterEndOfShow")),this.kb.lXe(Object(z.a)(this,this.Sdh,"onSlideShowLeaveEndOfShow")),this.kb.jqd(Object(z.a)(this,this.Gxa,"onGetCurrentSlideDimensionsHandler")),this.uHa=this.oEb=!1,this.lr&&this.Bj&&(this.Bj.hideAll(),this.ire()||(this.mSk(),this.dBl()),this.lTa()&&this.Xl.instance.hide()))}yFl(u,P,la,Ca,Ta,pb){try{const Sb=new PowerPointLive.RendezvousSessionConfig;Sb.userSessionId=u;Sb.webServiceBase=P;Sb.podSessionId=la;Sb.docId=Ca;Sb.sessionId=Ta;Sb.accessControl=1===this.bXa?"organization":
"anyone";Sb.authTokenFunc=pb;Sb.locale=t.AFrameworkApplication.uiCulture;Sb.presentationName=Gb.a.mH(t.AFrameworkApplication.fileName);Sb.slideHeight=this.ic.Tu().height;Sb.slideWidth=this.ic.Tu().width;Sb.correlationId=this.Jd.telemetryData.correlationId;Sb.showQRCodeAfterFetchingDocDownloadUrl=this.la.VVk;Sb.presenterTenantId=!this.la.isBlueChicken&&this.la.sjh?t.AFrameworkApplication.fa.Ha("TenantId"):null;Sb.fileSource=t.AFrameworkApplication.fa.Ha("FileHost");this.la.qVk||(Sb.fileName=t.AFrameworkApplication.fileName,
Sb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const Cc=this.oo.StartLiveBroadcasting(Sb,this.Jd,!this.la.ERe);this.fSj();if(Cc){this.Vp=new Vq;this.Vp.isPrivate=1===this.bXa;this.Vp.isPaused=!1;this.Vp.participantsCount=0;this.Vp.sessionCurrentState=0;const ed=Cc.then(ad=>{const Zd=new Wq;Zd.participantUrl=ad.sessionInfo.shortParticipantUrl;Zd.sessionQRCode=ad.sessionInfo.sessionQRCode;this.Vp.sessionCurrentState=1;return Zd});this.Vp.sessionURLPromise=ed;this.la.lnd?this.nic.then(()=>
{this.Bj.actOnSessionRequested(this.Vp)}):this.Bj.actOnSessionRequested(this.Vp);this.kb.UJc(Object(z.a)(this,this.Tdh,"onSlideShowReady"));this.kb.mBf(Object(z.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.kb.AUd(Object(z.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));Cc.then(ad=>{this.Jd.telemetryData.pragueDocId=ad.sessionInfo.pragueDocId;this.Jd.telemetryData.sessionCreationWebServiceCallTimeInMS=this.HL()-this.Ded;this.Jd.telemetryData.startAttemptCount=ad.numAttempt;
N.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Jd.telemetryData.sessionId,this.Jd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.la.ERe?(this.qtc(),this.oo.InitializeStateService().then(()=>{this.GBh(ad);this.C0("StartLiveBroadcasting")}).catch(Zd=>{this.Jd.telemetryData.sessionEndedBeforePragueInitialized||this.Jd.telemetryData.sessionId!==Ta||(N.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",
this.Jd.telemetryData.sessionId,Zd?Zd.toString():""),this.Jd.telemetryData.SetErrorCode(2,Zd?Zd.toString():""),this.C0("StartLiveBroadcasting"),this.Gvd())})):this.GBh(ad);this.la.NVk&&$addHandler(window,"visibilitychange",Object(z.a)(this,this.cKk,"onPageVisibilityChangedHandler"));this.C0("StartLiveBroadcasting")}).catch(ad=>{N.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Jd.telemetryData.sessionId,ad.toString());this.Jd.telemetryData.SetErrorCode(4,
ad.toString());this.C0("StartLiveBroadcasting");this.Gvd()})}else this.Gvd(),this.Jd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),N.a.J(512496225,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Sb){this.Gvd(),this.Jd.telemetryData.SetErrorCode(4,Sb.toString()),N.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Jd.telemetryData.sessionId,Sb.toString())}finally{this.C0("StartLiveBroadcasting")}}GBh(u){const P=
this.Jc.Nfj(this.Jc.Ipa);P?this.oo.SetDefaultSubtitlesLanguage(P):N.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",this.Jd.telemetryData.sessionId);this.kb.GQb(!0,this.oo.GetPragueSessionInfoJSONString());this.kb.RQa(Object(z.a)(this,this.Rnc,"onSlideShowPositionChanged"));this.kb.lBf(Object(z.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.ERe&&!this.Bj.isWelcomeScreenVisible()||this.qtc();this.va.raiseEvent("OnLiveSessionStarted",u.sessionInfo);
this.lxb()||!this.Jc.i6b||this.Jc.U0f||this.Ijc||!this.lTa()||(this.vHb=!0,this.Xl.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",nh.a.He(t.AFrameworkApplication.uiCulture).displayName),qm.a.RIb));this.Gec=this.oo.CreateSurvey(u.authToken,null,null,null);this.Gec.then(la=>{if(la){const Ca={};Ca.surveyeeName=t.AFrameworkApplication.userName;Ca.surveyId=la.surveyId;Ca.surveyResponseUrl=la.surveyResponseUrl;this.oo.SetAudienceFeedbackInfo(JSON.stringify(Ca))}});
this.la.cnd&&(this.tIe.clear(),this.uIe.forEach(la=>{try{const Ca=la.zSg;this.oo.CreateSurvey(u.authToken,null,Ca,la.ASg).then(Ta=>{Ta?this.tIe.set(Ca,Ta.surveyId):N.a.J(512496222,833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Jd.telemetryData.sessionId)}).catch(Ta=>{N.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Jd.telemetryData.sessionId,Ta.toString());this.Jd.telemetryData.SetErrorCode(13,
u.toString())})}catch(Ca){N.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Jd.telemetryData.sessionId,Ca.toString())}}));this.KYa.init()?this.KYa.pUd(Object(z.a)(this,this.wnc,"onNetworkConnectivityChanged")):N.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Jd.telemetryData.sessionId)}Tbg(u){u=new RegExp(String.format("[\\?&]{0}=([^&#]*)",u));return(u=window.location.search.match(u))&&2===u.length?u[1]:""}hvc(u,
P,la,Ca,Ta){this.eJe=P;this.Rna=la;this.$O=Ca;this.o8c=Ta;this.Ded=this.HL();this.Aed=this.HL();var pb=this.Tbg("wdSetLiveSessionId");pb="rdvSession_"+(pb.length?pb:bi.a.create().toString());this.Jd=new PowerPointLive.LiveSessionTelemetry;this.Jd.telemetryData.sessionId=pb;this.Jd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Jd.telemetryData.accessControl=Pn[this.bXa];this.Jd.telemetryData.sessionEntryPoint=Kk[u];this.Jd.telemetryData.isSubtitleStartedByLive=
this.Ida;this.Jd.telemetryData.isAutomation=this.la.gjh;this.Jd.telemetryData.correlationId=bi.a.create().toString();this.C0("StartLiveBroadcasting");try{this.Jr&&this.oo&&this.U5b()&&!this.Vp?(this.$ck(),this.kb.Y_b(Object(z.a)(this,this.ebh,"onGetCurrentSlideShowPosition")),this.kb.getCurrentPosition(),this.Q7d()&&this.Bj&&this.nic&&this.nic.then(()=>{this.Bj.showOnboardingScreen();this.ybf=!0}),this.yFl(P,la,Ca,Ta,pb,()=>this.B7b("StartLiveBroadcasting",this.Jd.telemetryData.sessionId))):(this.Jd.telemetryData.SetErrorCode(4,
"Live actor or broadcast monitor is null while trying to start live session!"),N.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),this.Jd.telemetryData.isMordernSlideShow=!!this.kb&&this.kb instanceof Yo.SlideShowCoreFrame}catch(Sb){this.Jd.telemetryData.SetErrorCode(4,Sb.toString()),N.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Jd.telemetryData.sessionId,Sb.toString())}finally{this.C0("StartLiveBroadcasting")}}mSk(){if(this.Jr&&
this.lr&&this.oo&&this.U5b()&&!this.Vp.isPaused){this.Oyd(2);this.TQb(2);try{this.Jd.telemetryData.sessionPauseCount+=1,this.Jd.telemetryData.sessionActiveDurationInMS+=this.HL()-this.Aed,N.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Jd.telemetryData.sessionId),this.Bj.actOnSessionPaused(),this.Vp.isPaused=!0,this.c0g=this.HL(),this.oo.PauseLiveBroadcasting(()=>this.B7b("PauseLiveBroadcasting",this.Jd.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",
Sys.EventArgs.Empty),this.FFl(),this.kb.GQb(!1)}catch(u){this.Jd.telemetryData.SetErrorCode(5,u.toString()),N.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",this.Jd.telemetryData.sessionId,u.toString())}finally{this.C0("PauseLiveBroadcasting")}}}uuh(){if(this.Jr&&this.lr&&this.oo&&this.U5b()&&this.Vp.isPaused)try{this.Aed=this.HL(),this.Jd.telemetryData.sessionResumeCount+=1,N.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",
this.Jd.telemetryData.sessionId),this.Vth(),this.Bj.actOnSessionResumed(),this.oo.ResumeLiveBroadcasting(()=>this.B7b("ResumeLiveBroadcasting",this.Jd.telemetryData.sessionId)),this.Vp.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",Sys.EventArgs.Empty),this.I5e(),this.kb.GQb(!0,this.oo.GetPragueSessionInfoJSONString())}catch(u){this.Jd.telemetryData.SetErrorCode(6,u.toString()),N.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Jd.telemetryData.sessionId,
u.toString())}finally{this.C0("ResumeLiveBroadcasting")}}N5b(u){if(this.Jr&&this.lr&&this.oo&&this.U5b()){this.TQb(3);try{this.dNl(u,()=>{this.Jd.telemetryData.sessionExitPoint=Xq[u];this.Vp.isPaused||(this.Jd.telemetryData.sessionActiveDurationInMS+=this.HL()-this.Aed);this.I0&&this.Tzb();this.I5e();this.lTa()&&this.Xl.instance.hide();N.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Jd.telemetryData.sessionId);this.Bj.actOnSessionEnded();this.kb.lqd(Object(z.a)(this,
this.Tdh,"onSlideShowReady"));this.kb.okb(Object(z.a)(this,this.Rnc,"onSlideShowPositionChanged"));this.kb.yrh(Object(z.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.kb.Arh(Object(z.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.KYa.$qh(Object(z.a)(this,this.wnc,"onNetworkConnectivityChanged"));this.kb.mXe(Object(z.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.uHa&&this.kb.GQb(!1);this.Gec=this.Vp=null;this.va.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);
this.la.knd&&this.Jc.i6b&&(this.Ijc=this.vHb=!1);if(3!==u){const P=this.oo.EndLiveBroadcasting(()=>this.B7b("EndLiveBroadcasting",this.Jd.telemetryData.sessionId));P?P.then(()=>{this.C0("EndLiveBroadcasting");N.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",this.Jd.telemetryData.sessionId)}).catch(la=>{this.Jd.telemetryData.SetErrorCode(7,la.toString());this.C0("EndLiveBroadcasting");N.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",
this.Jd.telemetryData.sessionId,la.toString())}):(this.Jd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),N.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.oo.CleanUpBroadcastBeforeEnd(),N.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.C0("EndLiveBroadcasting")})}catch(P){this.Jd.telemetryData.SetErrorCode(7),N.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",
this.Jd.telemetryData.sessionId,P.toString())}finally{3!==u&&this.rnb(),this.C0("EndLiveBroadcasting")}}}Jzh(){this.Jr&&this.oo&&this.oo.SetPresenterState("muted")}Kzh(){this.Jr&&this.oo&&this.oo.SetPresenterState("unmuted")}showCallout(u){this.Jr&&this.Bj&&(this.c9c=!0,this.Bj.showCallout(u))}showWelcomeScreen(){this.Jr&&this.Bj&&(this.Bj.showWelcomeScreen(),this.W0e())}showEndSessionDialog(u,P){this.Jr&&this.lr&&this.Bj&&this.Bj.showEndSessionDialogWithCallbacks(u,P)}Gvd(){this.Bj.isWelcomeScreenVisible()||
this.Vp.isPaused||this.showWelcomeScreen();this.Vp=null;this.Bj.onSessionRequestError()}U5b(){if(this.Jr&&!this.Bj&&this.Rea){const u=new fp;u.hostElement=this.Rea;u.baseZIndex=50005;u.welcomeScreenBackgroundImageUrl=this.le.qk("LiveWelcomeScreenBackground.png");u.welcomeScreenErrorImageUrl=this.le.qk("LiveWelcomeScreenError.png");u.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";u.calloutContainerId="LiveCalloutContainer";u.urlBarLayerHostId="LiveURLBarLayerHost";u.dialogLayerHostId="LiveDialogLayerHost";
u.reactionsBarLayerHostId="LiveReactionBarLayerHost";u.showTryAgainButton=!0;u.isPowerpointLiveReactionEnabled=!Gd.a("PPTLive.ReactionToggleInLiveCallout");u.onboardingScreenHostId="LiveOnboardingScreenLayerHost";u.resourceCDNPath=this.la.pjb;u.enablePrefetchLiveResource=this.la.lnd;u.enableNewLiveWelcomeScreen=this.la.lnd;u.userSessionId=this.eJe;u.podsUrl=this.Rna;this.Bj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(u);this.Bj.on("OnWelcomeScreenOpenedAction",()=>{this.JLa("LiveWelcomeScreenLayerHost");
this.W0e();this.w4g=Date.now();this.Jd.telemetryData.welcomeShownCount+=1});this.Bj.on("OnWelcomeScreenClosedAction",()=>{this.oEb&&this.Bj.hideURLBar();this.qMf();this.kb.restoreFocus();this.Jd.telemetryData.welcomeScreenDurations.push(Date.now()-this.w4g);this.Jd.telemetryData.welcomeScreenFirstTimeDuration=this.Jd.telemetryData.welcomeScreenDurations[0];this.C0("OnWelcomeScreenClosedAction");this.oo.SetWelcomeScreenState(!1);this.la.cnd&&this.uMh();this.vHb&&this.lTa()&&window.setTimeout(()=>{this.Xl.instance.hide();
this.vHb=!1},5E3)});this.Bj.on("ResumeSessionAction",()=>{this.uuh();this.oEb||this.Bj.showURLBar()});this.Bj.on("EndSessionAction",()=>{this.N5b(this.uHa?1:2);this.kb.restoreFocus()});this.Bj.on("OnCalloutOpenedAction",()=>{this.c9c=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);this.Jd.telemetryData.calloutShownCount+=1});this.Bj.on("OnCalloutClosedAction",()=>{this.c9c=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.kb.restoreFocus()});this.Bj.on("OnEndSessionDialogOpenedAction",
()=>{this.Epl()});this.Bj.on("OnEndSessionDialogClosedAction",()=>{this.Vgl()});this.Bj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.Bj.on("OnTryAgainAction",()=>{N.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",this.Jd.telemetryData.sessionId);this.hvc(5,this.eJe,this.Rna,this.$O,this.o8c)});this.Bj.on("PresenterDisabledReactions",()=>{this.Bze=!1});this.Bj.on("PresenterEnabledReactions",()=>
{this.Bze=!0});this.Bj.on("OnOnboardingScreenOpenedAction",()=>{this.JLa("LiveOnboardingScreenLayerHost");this.W0e()});this.Bj.on("OnOnboardingScreenClosedAction",()=>{this.qtc()})}return!!this.Bj}qtc(){this.Bj&&(this.Q7d()&&this.Bj.isOnboardingScreenVisible()?this.JLa("LiveOnboardingScreenLayerHost"):this.Bj.isWelcomeScreenVisible()?this.JLa("LiveWelcomeScreenLayerHost"):(-1!==this.oic&&this.qMf(),this.kb.restoreFocus()))}Q_j(){const u=document.getElementById("LiveWelcomeScreenLayerHost"),P=document.getElementById("LiveOnboardingScreenLayerHost");
let la=!1;u&&(la=u.contains(document.activeElement));return document.activeElement===P||document.activeElement===u||la}W0e(){this.Bj&&-1===this.oic&&(this.oic=window.setInterval(()=>{this.Q_j()||this.qtc()},500))}qMf(){window.clearInterval(this.oic);this.oic=-1}JLa(u){this.Rea&&this.Bj&&window.setTimeout(()=>{kd.FocusManager.Zq(this.Rea.ownerDocument.getElementById(u))},50)}Epl(){this.uHa?this.JLa("LiveDialogLayerHost"):(this.Fa.S_c(Fd.a.DRe,Fd.a.$i,document.getElementById("LiveDialogLayerHost")),
this.Fa.wj(Fd.a.DRe,!0))}Vgl(){this.uHa?this.kb.restoreFocus():this.Fa.wj(Fd.a.DRe,!1)}mhg(){this.la.knd&&this.Jc.i6b&&(this.lTa()&&this.vHb&&(this.Xl.instance.hide(),this.vHb=!1),this.Ijc=!0)}$ck(){try{this.nic||!this.Q7d()&&!this.la.lnd||(this.nic=ci.a(w.a.instance)("liveActorLazy"))}catch(u){N.a.J(512496205,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Jd.telemetryData.sessionId,u.toString())}}Tdh(){this.Jr&&this.oo&&(this.oTa?(window.setTimeout(()=>
{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.uuh()):this.Vp&&this.Bj&&this.Bj.isWelcomeScreenVisible()&&this.qtc())}Rnc(u,P){this.Jr&&this.oo&&(this.oo.SetCurrentPosition(P.slideId,P.slideIndex,P.Dwc),this.meb!==P.slideId&&this.Vth(),this.meb=P.slideId,this.rva&&(this.XWa&&10>this.Hic&&10*this.rva.size>=this.Hic*this.XWa.size&&(this.TQb(4),this.Hic+=1),this.rva.add(P.slideId)),this.la.cnd&&this.uMh(),u=!!this.XWa&&this.XWa.size>=this.la.nVk,this.meb===this.ODe&&u&&
this.vNl())}Rdh(){this.oEb=!0;this.Jr&&this.lr&&this.Bj&&(this.Bj.hideURLBar(),this.Oyd(1),this.TQb(1))}Sdh(){this.oEb=!1;this.Jr&&this.lr&&this.Bj&&this.Bj.showURLBar()}onSubtitleUpdated(u,P){this.Jr&&this.lr&&this.oo&&(P.isFinal?this.oo.UpdateFinalSubtitles(P.ZLh):this.oo.UpdatePartialSubtitles(P.ZLh))}onTranscriberStarted(u,P){this.Jd.telemetryData.transcriberSessionIds+=P.YLh+",";this.Jr&&this.lr&&this.kb.GQb(!0,this.oo.GetPragueSessionInfoJSONString())}FFl(){N.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",
this.Jd.telemetryData.sessionId);-1!==this.IFb&&window.clearInterval(this.IFb);this.OGb=30;this.IFb=window.setInterval(Object(z.a)(this,this.qSk,"pausedSessionAutoExpireTimerCallBack"),6E4)}I5e(){-1!==this.IFb&&(N.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Jd.telemetryData.sessionId),window.clearInterval(this.IFb),this.IFb=-1)}qSk(){--this.OGb;0>=this.OGb?(N.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Jd.telemetryData.sessionId),this.Tzb(),
this.N5b(3)):this.I0&&(this.I0.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.OGb.toString()))}dBl(){if(!this.I0&&this.Yr&&!t.AFrameworkApplication.Yg&&0!==this.Vp.sessionCurrentState){var u=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.OGb.toString());u=new Wp.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,u,null);u.closeable=!0;u.KW=Object(z.a)(this,this.rFk,"onBusinessBarClosed");u.image=3;u.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,
Object(z.a)(this,this.tFk,"onBusinessBarResumeSessionButtonClicked"),"");u.PTd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(z.a)(this,this.sFk,"onBusinessBarEndSessionButtonClicked"));this.Yr.businessBar.li(u,!1);this.Yr.Du();this.I0=u}}ire(){var u=6E4*this.la.SVk;u=0<u?this.HL()-this.Ded>=u:!1;N.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",u);return u}Tzb(){try{this.Yr&&this.I0?(this.I5e(),this.Yr.businessBar.removeEntry(this.I0),this.Yr.Du(),N.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",
!this.I0.businessBar),this.I0=null):N.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.Yr,!!this.I0)}catch(u){N.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",u.toString())}}rFk(u){u===this.I0&&(this.I0=null)}tFk(u){u===this.I0&&this.Bj&&(this.Tzb(),this.ire()||t.AFrameworkApplication.Qa.processAction(wb.a.xza,2))}sFk(u){u===this.I0&&this.Bj&&(this.ire()?this.Tzb():this.Bj.showEndSessionDialog())}cKk(){const u=
this.HL(),P=window.document.hidden;N.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",P?"hidden":"visible",u);P||this.oTa&&18E5<=u-this.c0g&&this.Tzb()}M$d(u,P,la){return!this.la.powerPointLiveBroadcastEnabled||0===this.bXa&&this.la.isBlueChicken?new Promise(Ca=>{Ca(null)}):!la&&!this.CM||la&&!this.oxe?(N.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",u,P,la),new Promise((Ca,Ta)=>
{Ta("AuthHelperNotSet")})):new Promise((Ca,Ta)=>{let pb=this.la.hostAuthType,Sb="";if("aad"===pb||this.la.isBlueChicken)Sb=this.la.pptLiveResourceUri;else if("msa"===pb)Sb=this.la.RVk;else{N.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",u,P);Ta("HostAuthTypeInvalid");return}const Cc="true"===t.AFrameworkApplication.fa.Ha("IsAnonymousUser").toLowerCase();let ed=t.AFrameworkApplication.fa.Ha(t.AFrameworkApplication.yK);Gb.a.Xa(ed)&&(ed=
"Unset");const ad=new Date;let Zd=null;Zd=la?this.oxe.wOl(this.la.cVk,this.la.bVk,Sb,t.AFrameworkApplication.fa.Ha("UserPrincipalName"),this.la.pVk,this.la.fVk&&"StartLiveBroadcasting"===u&&!this.la.sjh):this.CM.mI(this.la.pptLiveImplicitAuthAppName,Sb);Zd.then(We=>{this.myg(P,u,pb,la,Cc,ed,We.IsSuccess,+new Date-+ad,We.ErrorCode,We.ErrorMessage);We.IsSuccess?Ca(We.Token):Ta(We.ErrorCode)}).catch(We=>{this.myg(P,u,pb,la,Cc,ed,!1,+new Date-+ad,"exception",We.toString());Ta("exception")})})}B7b(u,P){if(!this.la.powerPointLiveBroadcastEnabled||
0===this.bXa&&this.la.isBlueChicken)return new Promise(Ca=>{Ca(null)});if("msa"===this.la.hostAuthType)return this.M$d(u,P,!1);const la=this;return new Promise((Ca,Ta)=>{la.M$d(u,P,!0).then(pb=>{Ca(pb)}).catch(()=>{la.M$d(u,P,!1).then(pb=>{N.a.J(512496194,833,50,"LivePresenter::GetToken - WebAuth retry succeeded.");Ca(pb)}).catch(pb=>{Ta(pb)})})})}HL(){return(new Date).getTime()}myg(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad){const Zd={};Zd.SessionId=u;Zd.Action=P;Zd.HostAuthType=la;Zd.UseDirectAuth=Ca;Zd.IsAnonymousUser=
Ta;Zd.UiHost=pb;Zd.IsSuccess=Sb;Zd.Latency=Cc;Zd.ErrorCode=ed;Zd.ErrorMessage=ad;N.a.J(51197915,833,50,JSON.stringify(Zd))}C0(u){this.Jd.telemetryData.action=u;this.Jd.telemetryData.sessionDurationInMS=this.HL()-this.Ded;this.Jd.telemetryData.hostAuthType=this.la.hostAuthType;this.Jd.SetStateServiceMetrics();this.Jd.telemetryData.errorCode.length&&(!this.Jd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.iVk,this.Jd.telemetryData.errorMessage))&&(this.Jd.telemetryData.hasUnexpectedError=
!0);u=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==u.indexOf("pptservicescast.officeapps.live.com")?this.Jd.telemetryData.rendezvousServiceEnvironment="prod":-1!==u.indexOf("pptservicescast.edog.officeapps.live.com")?this.Jd.telemetryData.rendezvousServiceEnvironment="edog":-1!==u.indexOf("pptservicescast.officeapps.live-int.com")?this.Jd.telemetryData.rendezvousServiceEnvironment="int":this.Jd.telemetryData.rendezvousServiceEnvironment="dev";N.a.J(50706442,833,this.Jd.telemetryData.hasUnexpectedError?
15:50,JSON.stringify(this.Jd.telemetryData))}YFi(u){if(this.ic)try{var P=this.qq.presentation;if(!P)throw Error.argumentNull("Presentation is null");const la=P.slides||[];this.ODe=la[la.length-1].sid;let Ca=P=!1;this.XWa=new Set;for(const Ta of la)P||Ta.sid!==u||(P=!0,Ca=Ta.Wm),!P||Ta.Wm&&!Ca||this.XWa.add(Ta.sid),Ca&&!Ta.Wm&&(Ca=!1)}catch(la){this.Jd.telemetryData.SetErrorCode(16,la.toString()),N.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",
this.Jd.telemetryData.sessionId,la.toString())}}Oyd(u){return new Promise(P=>{if(this.Jr&&this.oo&&this.Vp&&this.Gec)try{this.Gec.then(la=>{let Ca=!1;switch(u){case 2:if(!this.rva||!this.XWa||10*this.rva.size<8*this.XWa.size){P(!0);return}break;case 3:Ca=!0}const Ta={triggeredSurveyType:"Survey.AudienceFeedback"};Ta.isMandatory=Ca;Ta.triggerEventId=bi.a.create().toString();Ta.surveyeeName=t.AFrameworkApplication.userName;la?(Ta.surveyId=la.surveyId,Ta.surveyResponseUrl=la.surveyResponseUrl):N.a.J(512496192,
833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Jd.telemetryData.sessionId);this.oo.TriggerSurvey(JSON.stringify(Ta));N.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.Jd.telemetryData.sessionId,u);P(!0)}).catch(la=>{N.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Jd.telemetryData.sessionId,la.toString());this.Jd.telemetryData.SetErrorCode(13,
la.toString());P(!1)})}catch(la){this.Jd.telemetryData.SetErrorCode(17,la.toString()),N.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",this.Jd.telemetryData.sessionId,la.toString()),P(!1)}else P(!0)})}ebh(u,P){this.kb&&this.oo&&P&&(this.kb.nkb(Object(z.a)(this,this.ebh,"onGetCurrentSlideShowPosition")),this.oo.SetCurrentPosition(P.slideId,P.slideIndex,P.Dwc))}Gxa(u,P){this.Bj&&this.Bj.actOnCurrentSlideDimensionChange(P.slideHeight,
P.VFh,P.slideWidth,P.ZFh)}getCalloutMenuDefinition(){return this.U5b()?this.Bj.getCalloutMenuDefinition():null}fSj(){const u=String.format("{0}{1}",this.la.pjb,"reactions/heart/default/240_anim_f/heart.png"),P=String.format("{0}{1}",this.la.pjb,"reactions/yes/default/240_anim_f/yes.png"),la=String.format("{0}{1}",this.la.pjb,"reactions/clap/default/240_anim_f/clap.png"),Ca=String.format("{0}{1}",this.la.pjb,"reactions/laugh/default/240_anim_f/laugh.png"),Ta=String.format("{0}{1}",this.la.pjb,"reactions/surprised/default/240_anim_f/surprised.png"),
pb=String.format("{0}{1}",this.la.pjb,"reactions/wonder/default/240_anim_f/wonder.png");this.una=[Object.assign(new Ro,{react:"yes",reactionCount:0,reactionImagePath:P,numberOfAnimationFrames:40}),Object.assign(new Ro,{react:"heart",reactionCount:0,reactionImagePath:u,numberOfAnimationFrames:16}),Object.assign(new Ro,{react:"clap",reactionCount:0,reactionImagePath:la,numberOfAnimationFrames:40}),Object.assign(new Ro,{react:"laugh",reactionCount:0,reactionImagePath:Ca,numberOfAnimationFrames:77}),
Object.assign(new Ro,{react:"surprised",reactionCount:0,reactionImagePath:Ta,numberOfAnimationFrames:68}),Object.assign(new Ro,{react:"wonder",reactionCount:0,reactionImagePath:pb,numberOfAnimationFrames:70})];this.nmb=new Map;this.Hic=1;this.Zad=null}Vth(){if(this.una){for(const u of this.una)u.reactionCount=0;this.Bj&&this.Bj.resetReactions()}}dCk(u){if(this.nmb){var P=this.nmb.has(u.slideId)?this.nmb.get(u.slideId)+1:1;this.nmb.set(u.slideId,P)}if(this.una&&!this.oTa&&this.Bze){for(const la of this.una)if(la.react===
u.react){la.reactionCount+=1;break}if(this.Bj){u=Array(this.una.length);for(P=0;P<this.una.length;P++)u[P]=Object.assign(new Ro,{react:this.una[P].react,reactionCount:this.una[P].reactionCount,reactionImagePath:this.una[P].reactionImagePath,numberOfAnimationFrames:this.una[P].numberOfAnimationFrames});this.Bj.setReactions(u)}}}TQb(u){return new Promise(P=>{if(this.Jr&&this.oo&&this.Vp)try{if(1>this.nmb.size)N.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",
this.Jd.telemetryData.sessionId,u),P(!0);else if(2===u&&(!this.rva||1>this.rva.size))N.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",this.Jd.telemetryData.sessionId,u),P(!0);else{var la=null,Ca=0;this.nmb.forEach((pb,Sb)=>{pb>Ca&&(la=Sb.toString(),Ca=pb)});if(this.Zad&&la===this.Zad)N.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Jd.telemetryData.sessionId,
u),P(!0);else{var Ta=this.oo.TriggerSaveThumbnails(()=>this.B7b("SaveThumbnails",this.Jd.telemetryData.sessionId),la);Ta?Ta.then(()=>{this.Zad=la;N.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",this.Jd.telemetryData.sessionId,u);P(!0)}).catch(pb=>{N.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Jd.telemetryData.sessionId,pb.toString(),u);P(!1)}):(this.Jd.telemetryData.SetErrorCode(15,
"Triggering save thumbnails failed to created Promise object!"),N.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),P(!1))}}}catch(pb){this.Jd.telemetryData.SetErrorCode(15,pb.toString()),N.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Jd.telemetryData.sessionId,pb.toString()),P(!1)}else P(!0)})}lTa(){return this.la.pptEditorVoiceUXEnabled&&this.Xl&&this.Xl.instance?!0:!1}AJi(u){if(this.lTa())switch(u){case 0:this.uHa&&
this.Xl.instance.show(ResourceStrings.L_LivePresentations_Disconnected,qm.a.i_a);this.Jd.telemetryData.SetErrorCode(3);this.C0("DisconnectdToPrague");break;case 1:this.Xl.instance.hide();break;case 2:this.uHa&&this.Xl.instance.show(ResourceStrings.L_LivePresentations_Connecting,qm.a.RIb);break;default:N.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Jd.telemetryData.sessionId)}else N.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",
this.Jd.telemetryData.sessionId)}wnc(u,P){this.lTa()?P.isConnected?this.Xl.instance.hide():this.uHa&&this.Xl.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,qm.a.RIb):N.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Jd.telemetryData.sessionId)}sce(u,P){u=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,u,P);this.la.rVk&&(u+="&shareable=true");return u}dNl(u,
P){try{const la=new H.a;if(1===u||2===u||4===u)la.add(this.Oyd(3)),la.add(this.TQb(3));la.count?Promise.all(la.toArray()).then(()=>P()).catch(()=>P()):P()}catch(la){N.a.J(512496150,833,10,"failed to create end session task promises, error : {0}",la),P()}}get ybf(){const u=Th.a.get("PPTLivePresentationOnboarded");return u?"true"===u.toLowerCase():!1}set ybf(u){Th.a.qK("PPTLivePresentationOnboarded",u.toString(),Th.a.aK)||N.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",
u.toString())}Q7d(){return this.la.TVk&&!this.ybf}Daa(){try{if(N.a.J(512496148,833,15,"Pods session rehydrated!"),this.f9c=!0,this.Jr&&this.lr&&this.oo){N.a.J(512496147,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Jd.telemetryData.sessionId,this.Ya.Ck);const u=this.sce(this.Ya.podSessionId,this.Ya.Ck);this.oo.OnPodSessionUpdated(u)}}catch(u){N.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",u.toString())}}rJb(){this.f9c=
!1}onPodSessionExpired(){this.f9c=!1}rnb(){if(this.la.UVk)try{const u=w.a.instance.Ia("Common.ISystemInitiatedFeedback");u&&(N.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),u.execute(P=>{P.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(u){N.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",u)}}xbg(u){const P=document.createElement("a");P.setAttribute("href",
u);return(u=P.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===u.length?u[1]:""}wcj(){var u=this.ic.vdg();let P=1;this.uIe.clear();for(const la of u){u=la.yj();for(const Ca of u)if(!Gb.a.Xa(Ca.kib)){u=this.xbg(Ca.kib);const Ta=new yt;Ta.zSg=u;Ta.ASg=P.toString();this.uIe.add(Ta);P+=1}}}uMh(){var u=this.ic.dFa(this.meb).yj();for(const P of u)Gb.a.Xa(P.kib)||(u=this.xbg(P.kib),u=this.tIe.get(u),Gb.a.Xa(u)||this.oo.SetCurrentPollInfoState(u,this.meb))}$ji(u){this.va.addHandler("OnLiveResourcesLoaded",
u)}Ybl(u){this.va.removeHandler("OnLiveResourcesLoaded",u)}iBf(u){this.va.addHandler("OnLiveSessionStarted",u)}vrh(u){this.va.removeHandler("OnLiveSessionStarted",u)}gBf(u){this.va.addHandler("OnLiveSessionEnded",u)}urh(u){this.va.removeHandler("OnLiveSessionEnded",u)}cji(u){this.va.addHandler("OnCalloutDismissed",u)}sbl(u){this.va.removeHandler("OnCalloutDismissed",u)}eBf(u){this.va.addHandler("OnRelaunchPausedSession",u)}srh(u){this.va.removeHandler("OnRelaunchPausedSession",u)}dji(u){this.va.addHandler("CalloutMenuDefinitionChanged",
u)}tbl(u){this.va.removeHandler("CalloutMenuDefinitionChanged",u)}}Object(r.a)(Br,"LivePresenter",null,[914]);class Yp{constructor(){this.K=null;this.iQg=0}get name(){return"PowerPointWebEditor.Live"}Xb(u){this.K=u;const P=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(914,"PowerPointLive.ILivePresenter").na().oa(()=>new Br(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),P,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),
this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),w.a.instance.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),
this.K.resolve("PowerPointWebEditor.IFocusManager")))}adk(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.iQg=Date.now(),N.a.J(509441559,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Db.a.get_instance().Vj(7,()=>{const u=this.K.resolve("Common.IDynamicScriptLoaderProvider").xI,P=ci.a(this.K),la=new H.a;la.add(u.loadScript("PPTLiveBroadcast"));la.add(u.loadScript("BroadcastMonitor"));la.add(P("liveActor"));t.AFrameworkApplication.Aa.mb.Rp||
la.add(P("uiFabricLazy"));Promise.all(la.toArray()).then(()=>this.ZIk()).catch(Ca=>N.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",Ca))})):N.a.J(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(u){N.a.J(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",u)}}jn(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").MVk){const u=
Gb.a.IQ((t.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===u||".pps"===u){N.a.J(509441556,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==u&&N.a.J(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+u)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").PVk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?N.a.J(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):
this.K.resolve("PowerPointWebEditor.IApplicationSettings").QVk&&(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?N.a.J(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").rjh&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?N.a.J(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):
this.K.Ia("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(u=>{u.isFeatureEnabled("PowerPointLivePresentations",!1).then(P=>{P?this.adk():(N.a.J(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else N.a.J(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(u){N.a.J(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",
u)}}ZIk(){N.a.J(509441549,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.iQg);this.K.resolve("PowerPointLive.ILivePresenter").f$a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").rjh||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){t.AFrameworkApplication.fa.$e(Object(z.a)(this,this.jn,"onFullAppSettingsReady"))}dispose(){}static main(){m.a.instance.Ac(new Yp)}}
Object(r.a)(Yp,"PPTWebEditorLivePackage",null,[2,3]);var zt=d(740);class no{}Object(r.a)(no,"LokiTokenResult",null,[]);class Dp{constructor(u){this.NEc=u}coj(){const u=this.boj();return u?Dp.cqe?new Promise((P,la)=>{this.NEc.continueWith(()=>{this.NEc.jo||this.NEc.Hm?la(Error.create("Error downloading auth library")):this.NEc.result.mI("Loki",u).then(Ca=>{Ca=t.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.foj():Ca.IsSuccess&&Ca.Token?Object.assign(new no,{isSuccess:!0,
token:Ca.Token,errorMessage:null}):Object.assign(new no,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Ca)});P(Ca);return Ca})})}):Promise.resolve(Object.assign(new no,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new no,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",zt.a.d6f())}))}foj(){const u=t.AFrameworkApplication.fa.Ha("LokiUserDataSignature")||
"";return Object.assign(new no,{isSuccess:!0,token:u,errorMessage:null})}boj(){let u=null;const P=zt.a.cVc();2===P?u=t.AFrameworkApplication.fa.Ha("LokiAADAppId"):1===P&&(u=t.AFrameworkApplication.fa.Ha("LokiMSAAppId"));return u}static get cqe(){return t.AFrameworkApplication.fa.ka("IsO365CommercialHost")||t.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(r.a)(Dp,"LokiTokenManager",null,[972]);class Yq{get name(){return"Common.App.LivePersonaUtils"}init(){w.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Xb(u){u.register(Dp,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").na().oa(()=>new Dp(Kh.a.Ot(u.Ia("Common.App.OAuth.IOAuthManager"))))}static main(){m.a.instance.Ac(new Yq)}}Object(r.a)(Yq,"LivePersonaUtilsPackage",null,[2,3]);var rs=d(248);class ul{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(r.a)(ul,"RehearsalCritique",null,[]);class ef{static gRj(){ef.UY[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;ef.UY[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
ef.UY[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;ef.UY[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;ef.$Uf=ResourceStrings.L_SubtitleDetection_MicReady;ef.aVf=ResourceStrings.L_SubtitleDetection_SoundReminder;ef.b_f=ResourceStrings.L_SubtitleDetection_NoMicrophone;ef.h_f=ResourceStrings.l_NoCamera;ef.x5f=ResourceStrings.L_SpeechGenericRetryErrorMessage}}ef.FIf=20;ef.yph=50002;ef.UY=Array(ef.FIf);ef.$Uf=null;ef.aVf=null;ef.b_f=null;ef.h_f=null;ef.x5f=null;ef.D8d="fillerWords";
ef.FOk="originality";ef.f_l="wordsPerMinute";ef.Pml="sensitivePhrases";ef.gMi="correctedSensitivePhrases";ef.KUk="positivity";ef.dge="grammar";ef.xKe="monotone";ef.hTe="pronunciation";ef.a3d="crutchWords";ef.aTh="visionFace";ef.HYl="visionGaze";ef.GYl="visionGazeGood";ef.JYl="visionOcclusion";ef.IYl="visionOcclusionGood";ef.DYl="visionDistanceGood";ef.EYl="visionDistanceTooClose";ef.FYl="visionDistanceTooFar";ef.Edg="GetStartedButton";ef.qck="ListeningButtonPlayPauseButton";ef.rck="ListeningElement";
ef.VJi="ContainerElement";ef.pSk="PausedElement";ef.eDk="NotificationButtonElement";ef.mZl="WelcomeCheckboxElement";ef.Aph="RehearsalFeedbackSettingPane";ef.BRe="PPTCoachRehearsalFREShown";Object(r.a)(ef,"RehearsalResourceString",null,[]);const Hn=(u,P)=>Gb.a.Xa(P)?(n.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):u?P.toLowerCase()in u:!0,Cr=(u,P)=>{let la=null;try{if(!u||Gb.a.Xa(P))return n.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Ta=Gb.a.Xa(u.Npd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(u.Npd,!0);la={};for(let pb in Ta){u=pb;var Ca=Ta[pb];if(Ca){const Sb=kc.a.j1b(Ca.split(","));Sb&&P.toLowerCase()in Sb&&(la[u.toLowerCase()]=!0)}}}catch(Ta){N.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Ta.toString()),la=null}return la},So=(u,P)=>{if(Gb.a.Xa(P)||Gb.a.Xa(u.pih))return null;try{var la=Sys.Serialization.JavaScriptSerializer.deserialize(u.pih,
!0);if(Gb.a.Xa(P)){n.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var Ca=null}else Ca=P.split("-")[0].toLowerCase();return la[Ca]}catch(Ta){return N.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Ta.toString()),null}},ss=u=>{if(u&&3<u.length){let P="";"ws"===u.substring(0,2)?P="http"+u.substring(2,u.length):"wss"===u.substring(0,3)&&(P="https"+u.substring(3,
u.length));return P}return u},Lk=u=>{if(Gb.a.Xa(u))return n.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",u),"en-US";switch(u.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return u}};class Zq{constructor(){this.userCritiques=null}}Object(r.a)(Zq,"RehearseRoamingSettings",null,[]);class To{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(r.a)(To,"UserCritiqueSettings",null,[]);class dl{constructor(u,P,la,Ca){this.va=new kn.a;this.QJ=this.sfc=this.KU=null;this.qM=!1;this.vBg=null;this.Mwa=this.Nwa=0;this.Qr=u;this.la=P;this.vfa=la;this.ia=Ca}jTj(){try{this.Ybg(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(u){N.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",u.toString())}}E3c(){return 2===this.Nwa&&2===this.Mwa}b$e(){try{0!==
this.Nwa&&3!==this.Nwa||this.Ybg(Object(z.a)(this,this.eVe,"raiseRehearsalGetCritiquesEvent")),0!==this.Mwa&&3!==this.Mwa||this.Ojj()}catch(u){N.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",u.toString())}}zhj(){if(!this.sfc)return N.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.QJ)for(let u of this.sfc)this.QJ.contains(u.critique.toLowerCase())?u.optOut=!0:u.optOut=!1}catch(u){N.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
u.toString())}return this.sfc.toArray()}cUl(u,P){this.OQh(u,P);"vision"===u.toLowerCase()&&(this.qM=!P,u={},u.triggerPoint=ef.Aph,this.ia.Ja(wb.a.AQb,2,u))}Sag(u=!1){let P="";if(this.QJ&&0<this.QJ.count)if(Gd.a("RehearsalFilterOptOutCritiqueEnabled")&&u){a:{var la=this.la;u=this.la.yya;var Ca=null;try{if(!la||Gb.a.Xa(u)){n.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Ta=null;break a}var pb=
Gb.a.Xa(la.Npd)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(la.Npd,!0);Ca={};for(let Cc in pb){Ta=Cc;var Sb=pb[Cc];if(Sb){const ed=kc.a.j1b(Sb.split(","));Ca[Ta.toLowerCase()]=ed&&u.toLowerCase()in ed?!0:!1}}}catch(Cc){N.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",Cc.toString()),Ca=null}Ta=Ca}if(Sb=Ta)for(let Cc of this.QJ)if(pb="vision"===Cc?ef.aTh.toLowerCase():Cc.toLowerCase(),pb in Sb?Sb[pb]:1)P=Gb.a.Xa(P)?
Cc.toLowerCase():P+","+Cc.toLowerCase()}else for(Ca of this.QJ)P=Gb.a.Xa(P)?Ca.toLowerCase():P+","+Ca.toLowerCase();return P}Rrd(){if(2!==this.Nwa)N.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.q6j()){N.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var u=new Zq;u.userCritiques=Object.assign(new To,{critiquesDisabled:this.Sag(),critiquesDisabledByDefault:this.KU.userCritiques.critiquesDisabledByDefault});
var P=Hd.c(u),la=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",t.AFrameworkApplication.Pg),Ca={};Ca["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Qr.qj(la,2,P,Ca,!1,2,Ta=>{this.ALk(Ta,u)},Object(z.a)(this,this.zLk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,rs.a("17"))}else N.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get b8d(){return this.qM}set b8d(u){this.qM=
u;this.OQh("vision",!this.qM);this.E3c()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}Tji(u){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",u)}Tbl(u){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",u)}Sji(u){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",u)}Sbl(u){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",u)}Rji(u){this.va.addHandler("OnRehearsalGetCritiquesFailed",u)}Rbl(u){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
u)}Uji(u){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",u)}Ubl(u){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",u)}OQh(u,P){this.QJ&&(u=u.toLowerCase(),P&&!this.QJ.contains(u)?this.QJ.add(u):!P&&this.QJ.contains(u)&&this.QJ.remove(u),Gd.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.Rrd())}q6j(){let u=!1;try{var P=Gb.a.Xa(this.KU.userCritiques.critiquesDisabled);if(!this.QJ||!this.QJ.count&&P)return!1;if(P&&0<this.QJ.count||!P&&!this.QJ.count)return!0;const la=new Set(this.KU.userCritiques.critiquesDisabled.split(","));
if(this.QJ.count!==la.size)return!0;for(P=0;P<this.QJ.count;P++)if(!la.has(this.QJ.ga(P).toLowerCase())){u=!0;break}}catch(la){N.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",la.toString())}return u}ALk(u,P){this.KU=P;N.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+u.data.fu-+u.data.PF,+u.data.Is-+u.data.PF)}zLk(u){const P=this.vfa.j9(u);N.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
P,u.data.state)}Ybg(u){const P=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",t.AFrameworkApplication.Pg),la={};la["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.Qr.qj(P,1,null,la,!1,2,Ca=>{this.aIk(Ca,u)},Ca=>{this.$Hk(Ca,u)},null,void 0,void 0,void 0,void 0,rs.a("16"));this.Nwa=1}aIk(u,P){let la=0;try{u.data.Wd&&0<u.data.Wd.trim().length&&(la=u.data.Wd.length,
this.KU=JSON.parse(u.data.Wd));this.KU&&this.KU.userCritiques||(this.KU=new Zq,this.KU.userCritiques=new To);Gb.a.Xa(this.KU.userCritiques.critiquesDisabledByDefault)&&(this.KU.userCritiques.critiquesDisabledByDefault="vision",Gb.a.Xa(this.KU.userCritiques.critiquesDisabled)?this.KU.userCritiques.critiquesDisabled="vision":this.KU.userCritiques.critiquesDisabled+=",vision");this.QJ=new H.a;if(!Gb.a.Xa(this.KU.userCritiques.critiquesDisabled)){const Ca=this.KU.userCritiques.critiquesDisabled.split(",");
for(const Ta of Ca)this.QJ.add(Ta.toLowerCase())}this.qM=!this.QJ.contains("vision");this.Nwa=2}catch(Ca){this.Nwa=3,N.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",Ca.toString())}P&&P();u=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",la,JSON.stringify(u.data.PF),JSON.stringify(u.data.Is),JSON.stringify(u.data.fu));N.a.J(559548295,822,50,u)}$Hk(u,P){this.Nwa=3;P&&P();u=this.vfa.j9(u);N.a.J(559548296,822,
50,"OnGetUserCritiquesFailed: Web service failed with {0}",u)}Ojj(){try{const P=this.q6i();if(Gb.a.Xa(P))N.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var u=new XMLHttpRequest;u.open("GET",P,!0);u.onreadystatechange=()=>{if(4===u.readyState){if(200===u.status){N.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const la=Hd.b(u.responseText);if(la){this.sfc=new H.a;for(const Ca of la.critiquesData)this.sfc.add(Object.assign(new ul,
{category:Ca.category,displayName:Ca.displayName,optOut:!1,critique:Ca.critique.toLowerCase()}));this.vBg=la.categoriesData;this.Mwa=2}else this.Mwa=3}else this.Mwa=3;this.eVe()}};u.send("");this.Mwa=1}}catch(P){this.Mwa=3,this.eVe(),N.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",P.toString())}}q6i(){const u=Hd.b(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",P=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return P&&P.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",P,u,Lk(this.la.yya)):null}eVe(){0!==this.Nwa&&1!==this.Nwa&&0!==this.Mwa&&1!==this.Mwa&&(this.E3c()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(r.a)(dl,"RehearsalFeedbackSettings",null,[911]);class ts{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(r.a)(ts,"RehearsalCritiqueWithGroupProps",null,[]);class Zp{constructor(u,P,la,Ca,Ta){this.RHa=this.Ab=!1;u("powerpoint-presenter-coach-strings").then(()=>{this.RHa=!0;N.a.J(509138183,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(pb=>{N.a.J(509138182,822,10,"Failed to load powerpoint-presenter-coach-strings "+pb.toString())});
this.ia=P;this.la=Ta;this.LB=la;this.Gy=Ca;this.ia.Oaa(this)}vb(){this.ia.ya(wb.a.Cvd,db.a.application,Object(z.a)(this,this.Cvd,"showRehearsalFeedbackSettingsPane"));this.ia.ya(wb.a.qvd,db.a.application,Object(z.a)(this,this.qvd,"showHideRehearsalFeedbackSettingsPane"));this.ia.ra(wb.a.Eod,db.a.application,Object(z.a)(this,this.Eod,"queryShowHideRehearsalFeedbackSettingsPane"),96)}me(){}m6(){}l6(){}Cvd(u,P,la){if(P.contextId!==db.a.application||!this.RHa)return 2;if(1===la)return 32;this.Ab?Tb.UISurfaces.Iq().then(Ca=>
{Ca.setSelectedTaskPane(Fd.a.ekb);this.XA(!0);return null}).catch(Ca=>{N.a.J(509138180,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",Ca.toString())}):(this.Ab=!0,this.tph(),(u=!this.Gy.E3c())&&this.Gy.b$e(),u=this.kA(u,!1),this.Euc(u),N.a.J(509138181,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}qvd(u,P,la){if(P.contextId!==db.a.application||!this.RHa)return 2;if(1===la)return 32;(this.Ab=!this.Ab)?(this.tph(),
(u=!this.Gy.E3c())&&this.Gy.b$e(),u=this.kA(u,!1),this.Euc(u),N.a.J(509138179,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.nFi(),N.a.J(509138178,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}Eod(u,P,la,Ca,Ta){if(!Object(qk.a)(lm.a,Ta))return 8;Ta.If(this.Ab);return 32}Euc(u,P=!1){const la=Object.assign(new zb.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,width:320,location:2,
contentProps:u,onOpen:()=>{},onClose:()=>{this.Ab=!1;this.UVi();this.Gy.Rrd()},onHide:()=>{this.Gy.Rrd()},isModernPane:!0});u=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.LB.C4(Fd.a.ekb,Fd.a.$i,u,()=>{this.XA(!0)},()=>{this.XA(!1)});Tb.UISurfaces.Iq().then(Ca=>{P?this.Ab&&Ca.updateTaskPane(Fd.a.ekb,la):Ca.showTaskPane(Fd.a.ekb,la);return null}).catch(Ca=>{N.a.J(509138177,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",Ca.toString())})}nFi(){Tb.UISurfaces.Iq().then(u=>
{u.hideTaskPane(Fd.a.ekb,2);return null}).catch(u=>{N.a.J(509138176,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",u.toString())})}kA(u,P){return Object.assign(new ts,{groupItems:u||P?null:this.Gy.zhj(),categoriesData:this.Gy.vBg,locale:this.la.yya,updateCritiqueState:(la,Ca)=>{this.Gy.cUl(la,Ca)},retryToFetchCritiqueSettings:()=>{this.Gy.b$e()},showLoadingMessage:u,showErrorMessage:P})}XA(u){const P=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
u&&P&&P.focus()}tph(){this.Gy.Sji(Object(z.a)(this,this.Vch,"onRehearsalGetCritiquesSucceeded"));this.Gy.Rji(Object(z.a)(this,this.Uch,"onRehearsalGetCritiquesFailed"));this.Gy.Uji(Object(z.a)(this,this.Xch,"onRehearsalSettingsUpdatedExternally"))}UVi(){this.Gy.Sbl(Object(z.a)(this,this.Vch,"onRehearsalGetCritiquesSucceeded"));this.Gy.Rbl(Object(z.a)(this,this.Uch,"onRehearsalGetCritiquesFailed"));this.Gy.Ubl(Object(z.a)(this,this.Xch,"onRehearsalSettingsUpdatedExternally"))}Vch(){const u=this.kA(!1,
!1);this.Euc(u,!0)}Uch(){const u=this.kA(!1,!0);this.Euc(u,!0)}Xch(){const u=this.kA(!1,!1);u.isExternalUpdated=!0;this.Euc(u,!0)}}Object(r.a)(Zp,"RehearsalFeedbackSettingsPane",null,[144]);var gp;(function(u){u[u.none=0]="none";u[u.ribbon=1]="ribbon";u[u.slideShowToolbar=2]="slideShowToolbar";u[u.summaryPage=3]="summaryPage";u[u.ribbonTopBar=4]="ribbonTopBar";u[u.deepLink=5]="deepLink"})(gp||(gp={}));Object(r.b)("RehearsalEntryPoint",gp);class Bk{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(r.a)(Bk,"ICoachActorConfig",null,[]);class Ep{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(r.a)(Ep,"ICoachFREActorConfig",null,[]);class us{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(r.a)(us,"ICoachSessionConfig",null,[]);class vs{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(r.a)(vs,"IDocumentDownloadConfig",null,[]);class $p{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(r.a)($p,"ISlideState",null,[]);class oo{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(r.a)(oo,"IWebcamConfig",null,[]);var qq=d(688);class In{constructor(u,P,la,Ca,Ta,pb,Sb,Cc,ed,ad,Zd,We,Qf,Af){this.HXa=!1;this.Kw=this.gwe=this.OX=this.Rea=null;this.Sjc=0;this.EYg=-1;this.dlc=0;this.Cgd=this.qgd=null;this.Eze=this.uze=!1;this.oGe=this.vna=0;this.qM=!1;this.va=new kn.a;this.yZa=null;this.JFg=this.gJe=this.nve=!1;this.qGe=null;this.Hec=this.RBg=0;this.F0g=this.eFg=!1;this.lFg=t.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.zkk=
la;P&&(this.Rea=P.UF());this.kb=Ca;this.ia=u;this.ic=Ta;this.ua=pb;this.Ya=Sb;this.la=Cc;this.Xl=ed;this.ffa=ad;this.Rjc=Zd;this.Gy=We;this.EO=Qf;this.Vv=Af;this.n6b()&&this.Gy.Tji(Object(z.a)(this,this.Wch,"onRehearsalOptOutSettingsRequestFinished"))}vb(){this.ia.ya(wb.a.kvc,db.a.application,Object(z.a)(this,this.kvc,"startRehearsalManager"));this.ia.ya(wb.a.AQb,db.a.application,Object(z.a)(this,this.AQb,"toggleRehearsalVisionEnabled"));this.ia.ya(wb.a.wrc,db.a.application,Object(z.a)(this,this.wrc,
"rehearsePresentationDropDown"));this.ia.ra(wb.a.ALb,db.a.application,Object(z.a)(this,this.ALb,"queryRehearsalVisionEnabled"),96)}ALb(u,P,la,Ca,Ta){if(!Ta||!Object(qk.a)(lm.a,Ta))return N.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Ta.If(this.qM);return 32}wrc(u,P,la){switch(la){case 1:if(this.HXa&&this.Yre())return this.ia.processAction(wb.a.zga,1);break;default:N.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}AQb(u,
P,la,Ca,Ta){switch(la){case 2:return this.qM=!this.qM,t.AFrameworkApplication.Aa&&t.AFrameworkApplication.Aa.mb.Rp&&Kc.App.Mb.pF({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.n6b()&&Ta&&Ta.triggerPoint!==ef.Aph&&(this.Gy.b8d=this.qM),32;case 1:if(this.HXa&&this.Yre())return 32;break;default:N.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}kvc(u,P,la,Ca,Ta){switch(la){case 2:return this.JFl(Ta),32;case 1:if(this.HXa&&this.Yre())return 32;break;default:N.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}Rdc(){try{this.RBg=Date.now();const u=this.zkk.xI;u.loadScript("powerpoint-presenter-coach-strings").then(()=>{const P=new H.a;P.add(u.loadScript("CoachActorPackage"));P.add(u.loadScript("CoachPackage"));Promise.all(P.toArray()).then(()=>{this.SFk();return null}).catch(la=>{N.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",la);return null})})}catch(u){N.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
u)}}eji(u){this.va.addHandler("OnCoachResourcesLoaded",u)}ubl(u){this.va.removeHandler("OnCoachResourcesLoaded",u)}SFk(){const u=t.AFrameworkApplication.fa.Ha("CoachPackageCssUrl"),P=document.createElement("link");P.setAttribute("rel","stylesheet");P.setAttribute("type","text/css");P.setAttribute("href",u);$addHandler(P,"load",()=>{this.HXa=!0;Gd.a("PollToRefreshCoachEntryPointOnRibbon")&&this.Vv&&this.Vv.SA();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);N.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.RBg)});document.body.appendChild(P)}c9k(){this.kb.UJc(Object(z.a)(this,this.Zdh,"onSlideshowReady"));this.kb.RQa(Object(z.a)(this,this.Rnc,"onSlideShowPositionChanged"));this.kb.jja(Object(z.a)(this,this.mga,"onSlideshowExitHandler"));this.kb.VJc(Object(z.a)(this,this.Qxa,"onSpecialKeyHandler"))}VVi(){this.kb.lqd(Object(z.a)(this,this.Zdh,"onSlideshowReady"));this.kb.okb(Object(z.a)(this,this.Rnc,"onSlideShowPositionChanged"));this.kb.Bga(Object(z.a)(this,this.mga,"onSlideshowExitHandler"));
this.kb.mqd(Object(z.a)(this,this.Qxa,"onSpecialKeyHandler"))}Qxa(u,P){P.key===pa.a.nSb&&this.F0e()}F0e(){if(0===this.vna){var u=this.Kw.getCoachElement(ef.Edg);u&&this.JLa(u)}else 2===this.vna?(u=this.Kw.getCoachElement(ef.pSk))&&this.JLa(u):1===this.vna&&(u=this.Kw.getCoachElement(ef.rck))&&this.JLa(u)}JLa(u){this.Rea&&this.Kw&&window.setTimeout(()=>{kd.FocusManager.Zq(u)},50)}nA(u){try{const Ta=this.Kw.getCoachElement(ef.Edg),pb=this.Kw.getCoachElement(ef.qck),Sb=this.Kw.getCoachElement(ef.mZl),
Cc=this.Kw.getCoachElement(ef.eDk);if(u.keyCode===pa.a.$q){if(!Gd.a("PresenterCoachTabFix")){var P=!Sb&&!!Ta&&u.target===Ta||!!Sb&&u.target===Sb,la=!!Ta&&!!pb&&pb.contains(u.target),Ca=!!Cc&&u.target===Cc;(P||la||Ca)&&this.kb.restoreFocus()}}else u.keyCode===pa.a.BZ||u.keyCode===pa.a.B2?(this.kb.prev(),this.F0e()):u.keyCode===pa.a.JV||u.keyCode===pa.a.A2?(this.kb.next(),this.F0e()):u.keyCode===pa.a.jp||u.keyCode===pa.a.ORb||u.shiftKey||this.kb.restoreFocus()}catch(Ta){N.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Ta)}}n8k(){const u=this.Kw.getCoachElement(ef.VJi);if(Gd.a("PresenterCoachTabFix")){var P=document.getElementById("HiddenFocusTrapAnchor");this.Rea.insertBefore(u,P)}else P=document.getElementById("slideshowEndFocusTrap"),this.Rea.insertBefore(u,P);u&&Le.a.addHandler(u,Fa.a.Df,Object(z.a)(this,this.nA,"keyDownHandler"))}JFl(u){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");ef.gRj();this.c9k();this.n6b()&&(this.Gy.Rrd(),this.Gy.Tbl(Object(z.a)(this,this.Wch,"onRehearsalOptOutSettingsRequestFinished")));
const P=new $p;this.yZa=Cr(this.la,this.la.yya);this.qM&&!this.la.pptRehearsalVisionEnabled&&N.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.qM=this.qM&&this.la.pptRehearsalVisionEnabled;var la=new Ol.a,Ca=Object(U.a)(115,this.ic.dFa(this.ua.Ba.Cb.sid));P.currentSlideIndex=Ca?Ca.qe:0;P.totalSlideCount=this.ic.rj();Ca=this.Rfj(P);this.Kw=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(Ca,la);this.qM&&(this.qgd=this.Kw.getRehearsalVideoElement(),
this.Cgd=this.Kw.getRehearsalVideoCanvas());this.oGe=u;u=this.nae(P,this.qgd,this.Cgd);this.OX=(new CoachPackage.CoachSessionFactory).createCoachManager(u);u=this.Sfj();this.gwe=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(u,la);Gd.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.EO.enumerateDevices(Object(z.a)(this,this.hnc,"onEnumerateDevicesSuccess"),Object(z.a)(this,this.t_a,"onDevicesFailure"),Object(z.a)(this,this.D_a,"onUnsupported"));this.f7k();this.g7k();
this.Sjc=0;this.Eze=!1;this.n8k();2===this.oGe&&(la=localStorage.getItem(ef.BRe),this.lFg&&!la?this.nHh():this.r5e())}r5e(){this.vna=0;this.ffa.execute(u=>{u.cF(qq.a.SubtitlesButton,!1);u.cF(qq.a.LiveButton,!1);u.cF(qq.a.CoachButton,!1);u.cF(qq.a.MicButton,!1)});this.OX.startSession(!0)}nHh(){this.gwe.showCoachFREUI(u=>{localStorage.setItem(ef.BRe,"true");this.F0g=u;this.r5e()})}hnc(u){this.Hec=0;if(u.length)for(var P of u)"audioinput"===P.kind&&(this.Hec+=1);else this.Hec=0;this.eFg=!0;u=new $p;
P=Object(U.a)(115,this.ic.dFa(this.ua.Ba.Cb.sid));u.currentSlideIndex=P?P.qe:0;u.totalSlideCount=this.ic.rj();u=this.nae(u,this.qgd,this.Cgd);this.OX.updateSessionConfiguration(u)}t_a(u){N.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",u.toString())}D_a(){N.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",yd.a.mz)}Zdh(){const u=localStorage.getItem(ef.BRe);this.lFg&&!u?this.nHh():this.r5e()}Rnc(u,
P){u=new $p;u.currentSlideIndex=P.slideIndex;u.totalSlideCount=this.ic.rj();P=this.nae(u,this.qgd,this.Cgd);this.OX.updateSessionConfiguration(P);this.Kw.updateCoachSlideComponent(u)}getTraceRequestMetadata(u,P){const la={};if(u)for(let Ca in u)la[Ca]=u[Ca];if(P)for(let Ca in P)la[Ca]=P[Ca];u=Hd.b(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());la.AudienceGroup=u.Ring||"Unknown";la.BuildVersion=t.AFrameworkApplication.buildVersion||"Unknown";la.ClientType="web";la.IdentityProvider=
this.la.hostAuthType||t.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";la.Locale=this.la.vKa||"Unknown";la.SpeechMode="rehearsal";la.TenantId=t.AFrameworkApplication.fa.Ha("TenantId");la.UserId=this.getUserId();la.WacDatacenter=u.WACDatacenter||"Unknown";la.WacHost=u.Host||"Unknown";la.SourceLanguage=this.la.lNf||Lk(this.la.yya);return la}getUserId(){let u=t.AFrameworkApplication.fa.Ha("PptEditingUserId");Gb.a.Xa(u)&&(u=t.AFrameworkApplication.fa.Ha("LoggableUserId"),n.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Gb.a.Xa(u)));return u}kml(){if(this.la.nTk){var u=this.OX.getTraceRequestMetadata(),P=this.Kw.getTraceRequestMetadata(),la=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(la&&la.length){var Ca=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",la);la=new XMLHttpRequest;la.open("POST",Ca,!0);Ca=bi.a.create().toString();la.setRequestHeader("X-Correlation",Ca);try{n.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",Ca);const Ta=this.getTraceRequestMetadata(u,P);la.send(Hd.c(Ta))}catch(Ta){n.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",Ca)}}else n.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}mga(){this.VVi();this.vna=3;this.OX.stopSession();this.gwe.hideCoachFREAndWelcomeUI();this.Kw.hideCoachUI();this.gJe=this.nve=!1;try{this.OX.getSessionSummary(u=>
{u.timeSpentInSeconds=this.Sjc;this.ia.processAction(wb.a.YRc,2);this.ia.processAction(wb.a.XRc,2);window.clearInterval(this.EYg);this.Eze&&this.Rjc.instance.kMa(u,this.qM,this.yZa,this.qGe,()=>{this.kml()})})}catch(u){n.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",u)}}ftj(){let u=",visionFace";this.la.bWk&&(u+=","+ef.HYl+","+ef.GYl);this.la.cWk&&(u+=","+ef.JYl+","+ef.IYl);this.la.aWk&&(u+=","+ef.DYl+","+ef.EYl+","+ef.FYl);return ef.f_l+(Hn(this.yZa,
ef.D8d)?","+ef.D8d:"")+","+ef.Pml+","+ef.gMi+","+ef.FOk+","+ef.KUk+(this.la.CRe&&Hn(this.yZa,ef.dge)?","+ef.dge:"")+(this.la.QQe&&Hn(this.yZa,ef.xKe)?","+ef.xKe:"")+(this.la.pptRehearsalVisionEnabled&&Hn(this.yZa,ef.aTh)?u:"")+(this.la.pptRehearsalPronunciationEnabled&&Hn(this.yZa,ef.hTe)?","+ef.hTe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&Hn(this.yZa,ef.a3d)?","+ef.a3d:"")}nae(u,P,la){const Ca=new us;Ca.disabledCoachRealtimeFeatures="";Ca.userSessionId=t.AFrameworkApplication.userSessionId;var Ta=
new vs;Ta.docId=t.AFrameworkApplication.Pg;Ta.podsSessionId=this.Ya.podSessionId;Ta.userDataCenterClusterId=this.Ya.Ck;Ta.webServiceBase=this.la.podsWebServiceBase;Ca.documentDownloadConfig=Ta;Ta=new Ol.a;Ca.logger=Ta;Ta={};Ta.currentSlideIndex=u.currentSlideIndex.toString();Ca.customSettings=Ta;Ca.fEnableServiceSideAggregationForCoach=this.la.nnd;Ca.httpTimeoutForCoachSummaryData=this.la.nWk;Ca.fSendClientMetaDataOnSessionStart=this.la.R0i;Ca.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;Ca.requestedCoachFeatures=
this.ftj();this.n6b()&&(this.qGe=this.Gy.Sag(!0),Ca.requestedRehearsalOptOutFeatures=this.qGe);Gd.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(Ca.enableTimeStampedCritiqueTelemetry=!0);Ca.entryPoint=gp[this.oGe];Ca.fEnableVision=this.qM;Ca.fEnableVision&&P&&la&&(Ca.webcamConfig=Object.assign(new oo,{videoView:P,workingCanvas:la,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.eWk}));Ca.supportedRehearsalTemplates=this.Kw.getSupportedRehearsalTemplates();
Gd.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.eFg&&(Ca.audioInputDeviceCount=this.Hec);u=Hd.b(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Ca.userId=this.getUserId();Ca.tenantId=t.AFrameworkApplication.fa.Ha("TenantId");Ca.identityProvider=this.la.hostAuthType||t.AFrameworkApplication.fa.Ha("HostAuthType")||"Unknown";Ca.audienceChannel="";Ca.audienceGroup=u.Ring||"Unknown";Ca.buildVersion=t.AFrameworkApplication.buildVersion||"Unknown";Ca.locale=this.la.vKa||
"Unknown";Ca.wacHost=u.Host||"Unknown";Ca.wacDatacenter=u.WACDatacenter||"Unknown";Ca.sourceLanguage=this.la.lNf||Lk(this.la.yya);N.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.vKa,this.la.yya);return Ca}Sfj(){const u=new Ep;u.rootContainer=this.Rea;u.zIndex=ef.yph;u.imagesBaseFilePath=t.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");return u}Rfj(u){const P=new Bk;P.rootContainer=this.Rea;P.slideState=u;P.imagesBaseFilePath=
t.AFrameworkApplication.fa.Ha("CoachImagesBaseFilePath");P.zIndex=ef.yph;P.fEnableVision=this.qM;P.fShowRealtimeFeedbackEnabledCheckbox=this.la.mTk;P.fUseNewRealtimePanel=this.la.Mpd;P.fUseCountdownWelcomeScreen=t.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");P.speechFDBase=ss(this.la.pptEditorSpeechHandlerBaseUri);P.fDontShowTooltips=yd.a.mg;P.fUseNewRealtimeCheckbox=Gd.a("UseNewRealtimeCheckbox");return P}tUl(){2!==this.vna&&(this.Sjc+=1,this.Kw&&this.Kw.updateTimer(this.Sjc))}f7k(){this.Kw.on("CoachSessionStarted",
()=>{this.vna=1;this.EYg=window.setInterval(Object(z.a)(this,this.tUl,"updatePresentationTimer"),1E3);this.OX.enableVoiceStreaming();this.XBl();this.Eze=!0});this.Kw.on("CoachSessionPaused",()=>{this.vna=2;this.OX.pauseSession();this.uka()&&this.Xl.instance.hide()});this.Kw.on("CoachSessionResumed",()=>{this.vna=1;this.OX.resumeSession()})}g7k(){this.OX.on("SpeechRecognitionStarted",()=>{this.uze&&this.uka()&&(this.Xl.instance.hide(),this.uze=!1)});this.OX.on("PPTCoachRealtimeNotification",u=>{this.PDj(u)});
this.OX.on("QualityStatusChanged",u=>{this.zHj(u)});this.OX.on("MediaStatusChanged",u=>{this.cGj(u)});this.OX.on("Error",u=>{this.handleError(u)});this.OX.on("ConnectionRetry",()=>{this.bFj()})}bFj(){this.uze=!0;this.uka()&&this.Xl.instance.show(ef.x5f,qm.a.i_a)}PDj(u){this.Kw.updateCoachRealtimeNotification(u)}handleError(u){u=Object(U.a)(String,u);this.vna=4;u?u.startsWith("ErrorAudio")?(this.Kw&&this.Kw.showCoachDisabledUI(0),this.uka()&&this.Xl.instance.show(ef.b_f,qm.a.i_a)):u.startsWith("ErrorVideo")?
(this.Kw&&this.Kw.showCoachDisabledUI(1),this.uka()&&this.Xl.instance.show(ef.h_f,qm.a.i_a)):N.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):N.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}hHh(){this.Kw&&(this.qM&&this.Kw.enableCoachVideoUI(),this.Kw.showCoachRealtimeUI(this.F0g));this.uka()&&this.Xl.instance.show(ef.$Uf,qm.a.Gid)}cGj(u){"AudioDeviceConnected"===u.mediaStatus?(this.nve=!0,this.qM&&!this.gJe||this.hHh()):"VideoSetupCompleted"===u.mediaStatus&&
(this.gJe=!0,this.nve&&(this.Kw&&this.Kw.enableCoachVideoUI(),this.hHh()))}zHj(u){if(this.la.pptEditorVoiceUXEnabled){var P=u.severity,la=u.shortCode;if(0<la&&la<ef.FIf&&ef.UY[la])switch(P){case 0:this.uka()&&this.Xl.instance.hide();break;case 1:(u=0<la?ef.UY[la]:u.shortString)&&this.uka()&&this.Xl.instance.show(u,qm.a.RIb);break;case 2:(u=0<la?ef.UY[la]:u.shortString)&&this.uka()&&this.Xl.instance.show(u,qm.a.i_a)}else N.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}uka(){return this.la.pptEditorVoiceUXEnabled&&
this.Xl&&this.Xl.instance&&2!==this.vna?!0:!1}XBl(){this.uka()&&(this.Xl.instance.show(ef.aVf,qm.a.Gid),this.dlc=window.setTimeout(Object(z.a)(this,this.Yhe,"hideSoundReminderNotification"),3E3))}Yhe(){this.uka()&&(window.clearTimeout(this.dlc),this.Xl.instance.hide())}n6b(){return this.la.LKb&&!!this.Gy}Yre(){return this.n6b()?this.JFg:!0}Wch(){this.JFg=!0;this.qM=this.Gy.b8d;Gd.a("PollToRefreshCoachEntryPointOnRibbon")&&this.Vv&&this.Vv.SA()}}Object(r.a)(In,"RehearsalManager",null,[912]);class ws{constructor(u,
P,la){this.uo=u;this.ia=P;this.la=la}kMa(u,P,la,Ca,Ta){try{const Cc=document.createElement("div");Cc.id="SummaryPageOverlay";Cc.style.width="100%";Cc.style.height="100%";Cc.style.zIndex="999";Cc.style.display="flex";Cc.style.flexDirection="column";Cc.style.justifyContent="center";Cc.style.position="absolute";var pb=document.getElementById("SummaryPageOverlay");pb&&document.body.removeChild(pb);document.body.insertBefore(Cc,document.body.firstChild);const ed=Cc.parentNode;Le.a.addHandler(ed,Fa.a.Df,
Object(z.a)(this,this.wch,"onParentNodeKeyDownHandler"));var Sb=u.thumbIndices;if(Sb){pb={};let Qf=0;const Af=this.mwj(Sb);for(let Ph=0;Ph<Sb.length;Ph++)pb[Sb[Ph].toString()]=Af[Ph],Af[Ph]||Qf++;N.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Sb.length,Qf);u.slideImageSrcs=pb}else u.slideImageSrcs={},N.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const ad=t.AFrameworkApplication.iF;ad||N.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");la||(la=Cr(this.la,this.la.yya));Sb={};const Zd=Hd.b(t.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Sb.fFeedbackCardEnabled=this.la.oTk&&ad;Sb.fShowFeedbackButton=ad;Sb.fMonotoneEnabled=this.la.QQe&&Hn(la,ef.xKe);Sb.fGrammarEnabled=this.la.CRe&&Hn(la,ef.dge);Sb.fFillersCardEnabled=Hn(la,ef.D8d);Sb.locale=this.la.yya;Sb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&Hn(la,ef.hTe);Sb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&Hn(la,ef.a3d);Sb.fVisionEnabled=P&&this.la.dWk&&this.la.pptRehearsalVisionEnabled;const We=So(this.la,this.la.yya);Gb.a.Xa(We)||(Sb.fPacingGaugeRange=We);Gb.a.Xa(Zd)||(Sb.clientSessionId=Zd);this.la.LKb&&(Sb.rehearsalOptOutFeatures=Ca);(new rehearsalSummaryPage.RehearsalSummaryPageController(Cc,u,()=>{N.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Ta&&Ta();this.ia&&(Cc.parentNode.removeChild(Cc),this.ia.Ja(wb.a.zga,2,{entryPoint:3}))},()=>{Ta&&Ta();Le.a.removeHandler(ed,Fa.a.Df,Object(z.a)(this,this.wch,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.Fmd),()=>{this.wAl()},Sb,ss(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.Szl()})).renderSummaryPage()}catch(Cc){N.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",Cc.toString())}}wch(u){"MainApp"===
u.target.id&&(u.preventDefault(),u.stopPropagation())}Szl(){N.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.LKb&&this.ia.Ja(wb.a.Cvd,2,null)}wAl(){N.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.vVk?this.ia.Ja(wb.a.Dph,2,null):this.ia.Ja(F.a.giveFeedback,2,!1))}mwj(u){const P=Array(u.length);if(!this.uo)return P;const la=this.uo.NL(),Ca=this.uo.DUa();
for(let Ta=0;Ta<u.length;Ta++){const pb=Ca[la[u[Ta]].sid.toString()];pb&&pb.thumbnailImage.length&&(P[Ta]=pb.thumbnailImage)}return P}}Object(r.a)(ws,"RehearsalSummaryPageHelper",null,[]);class rq{constructor(u,P,la,Ca,Ta){this.HXa=!1;this.va=new kn.a;this.ia=u;this.a$c=new ws(P,this.ia,Ca);this.cEe=la;this.Ted=Ta}vb(){this.ia.ya(wb.a.kMa,db.a.application,Object(z.a)(this,this.aCl,"showSummaryPage"));this.ia.ya(wb.a.Dph,db.a.application,Object(z.a)(this,this.EAl,"showFloodgateSurvey"))}kMa(u,P,la,
Ca,Ta){this.a$c.kMa(u,P,la,Ca,Ta)}aCl(u,P,la,Ca,Ta){switch(la){case 2:return this.a$c.kMa(Ta,!1,null,null,null),32;case 1:if(this.HXa)return 32;break;default:N.a.J(509117593,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}EAl(u,P,la){switch(la){case 2:return this.Ted.execute(Ca=>{Ca.hmb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.HXa)return 32;break;default:N.a.J(509117592,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}Rdc(){const u=
Date.now();this.cEe("rehearsalSummaryPage").then(()=>{const P=t.AFrameworkApplication.fa.Ha("RehearsalSummaryPageCssUrl"),la=document.createElement("link");la.setAttribute("rel","stylesheet");la.setAttribute("type","text/css");la.setAttribute("href",P);$addHandler(la,"load",()=>{this.HXa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);N.a.J(509117591,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-u)});document.body.appendChild(la);return null})}Vji(u){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
u)}Vbl(u){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",u)}}Object(r.a)(rq,"RehearsalSummaryPageActor",null,[910]);class sq{constructor(u,P,la,Ca,Ta){this.rtg=this.Vog=!1;this.ia=u;this.Da=P;this.pGe=la;this.Rjc=Ca;this.kxa=Ta;this.pGe.execute(pb=>{pb.eji(Object(z.a)(this,this.Q$g,"onCoachResourcesLoaded"))});this.Rjc.execute(pb=>{pb.Vji(Object(z.a)(this,this.Ych,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.pGe.instance&&this.pGe.instance.ubl(Object(z.a)(this,this.Q$g,"onCoachResourcesLoaded"));
this.Rjc.instance&&this.Rjc.instance.Vbl(Object(z.a)(this,this.Ych,"onRehearsalSummaryResourcesLoaded"))}Q$g(){this.Vog=!0;this.yMh()}Ych(){this.rtg=!0;this.yMh()}yMh(){this.Vog&&this.rtg&&Db.a.get_instance().Vj(10,null).continueWith(()=>{if(this.Da.NDh&&this.Da.$Vk){const u=document.getElementById("rehearsal-loading-dialog-modal");u?(u.style.display="none",N.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):N.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(wb.a.zga,1))if(this.Da.NDh)this.ia.Ja(wb.a.zga,2,{entryPoint:5});else if(!this.Da.qJ&&this.Da.wjh&&this.Da.CVk)try{this.kxa.continueWith(()=>{this.kxa.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),N.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(u){N.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",u)}})}}Object(r.a)(sq,
"RehearsalTrigger",null,[913]);class tq{constructor(){this.K=this.Gy=null}get name(){return"PowerPointWebEditor.Rehearsal"}WIi(){this.K.register(910,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").na().oa(()=>new rq(t.AFrameworkApplication.Qa,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),ci.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ia("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").vb()}Xb(u){this.K=
u;this.K.Ia("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.WIi()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(911,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").na().oa(()=>new dl(t.AFrameworkApplication.Je,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.Gy=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const P=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(912,"PowerPointWebEditor.Rehearsal.IRehearsalManager").na().oa(()=>new In(t.AFrameworkApplication.Qa,P,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
w.a.instance.Ia("PowerPointWebEditor.ISlideShowVoiceNotification"),w.a.instance.Ia("PowerPointWebEditor.ISlideshowToolbar"),w.a.instance.Ia("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.Gy,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").vb();this.K.register(913,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").na().oa(()=>new sq(t.AFrameworkApplication.Qa,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),w.a.instance.Ia("PowerPointWebEditor.Rehearsal.IRehearsalManager"),w.a.instance.Ia("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),Kh.a.Ot(w.a.instance.Ia("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){t.AFrameworkApplication.fa.$e(Object(z.a)(this,this.jn,"onFullAppSettingsReady"))}jn(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").ddc&&Db.a.get_instance().Vj(7,
()=>{this.K.Ia("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").Rdc();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").Rdc();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").LKb){const u=new Zp(ci.a(this.K),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.Gy,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));u.vb();u.me();this.Gy.jTj()}}dispose(){}static main(){m.a.instance.Ac(new tq)}}Object(r.a)(tq,"PPTWebEditorRehearsalPackage",null,[2,3]);class Uo{static P$a(u){try{return caches.open(Uo.Zdf).then(P=>P.match(u))}catch(P){return Promise.reject(null)}}static RTa(u,P){try{return Uo.P$a(u).then(la=>la&&Number.parseInvariant(la.headers.get("cachedTime"))>Date.now()-P?Promise.resolve(la.text().toLocaleString()):
Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(la){return Promise.reject(null)}}static store(u,P){try{return caches.open(Uo.Zdf).then(la=>{la.put(u,P).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(la){return Promise.resolve(!0)}}static vGl(u,P){const la={};la.body=P;const Ca={};Ca.cachedTime=Date.now().toString();la.headers=Ca;P=new Response(P,la);Uo.store(u,P).then(()=>!0)}}Uo.Zdf="ConsentState";Object(r.a)(Uo,"CacheManager",null,[]);class Dr{constructor(){this.message=
null;this.Iv=0}}Object(r.a)(Dr,"HttpRequstToPromiseRejectData",null,[]);class Zn{constructor(u){this.Aca=u}a$(u,P,la,Ca,Ta,pb){B.a.sendTelemetryEvent(Object.assign(new M.a,{name:"Office.Online."+u,dataFields:[Object.assign(new L.a,{name:"EventMessage",string:P}),Object.assign(new L.a,{name:"FormFactor",string:this.Aca.formFactor}),Object.assign(new L.a,{name:"CorrelationId",string:this.Aca.correlationId}),Object.assign(new L.a,{name:"AccountType",string:this.Aca.accountType}),Object.assign(new L.a,
{name:"OSVersion",string:this.Aca.osVersion}),Object.assign(new L.a,{name:"AppId",string:this.Aca.appId}),Object.assign(new L.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new L.a,{name:"ConsentLanguage",string:this.Aca.consentLanguage}),Object.assign(new L.a,{name:"EventCode",string:la}),Object.assign(new L.a,{name:"Region",string:this.Aca.region}),Object.assign(new L.a,{name:"ModelType",string:Ca}),Object.assign(new L.a,{name:"ModelId",string:Ta}),Object.assign(new L.a,{name:"Platform",
string:this.Aca.os}),Object.assign(new L.a,{name:"ReConsentReason",string:""}),Object.assign(new L.a,{name:"ConsentType",string:pb})]}))}}Object(r.a)(Zn,"TelemetryLogger",null,[]);class At{constructor(u,P,la){this.PYh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Ma=u;this.ji=P;this.zQa=la;this.YS=new Zn(la)}H3b(u,P){return new Promise((la,Ca)=>{const Ta=this.Ma.uc("UCNoticeCheckinCallTimeoutMs",5E3);let pb=this.Ma.Ha("UCNoticeCheckinStateUrl");pb&&pb.length||(pb=this.PYh);
this.ji.qW(pb,1,null,this.Lbe(u),null,0,Sb=>{try{if(void 0===Sb||null===Sb||void 0===Sb.data||null===Sb.data||void 0===Sb.data.Wd||null===Sb.data.Wd){this.YS.a$("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);let ed=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Ca(this.Wka(ed,Sb))}else if(Sb.data.Oe!==Ki.a.mx){this.YS.a$("UnifiedConsent.ConsentGetFailed",
"CheckInApi : HTTP failure",Sb.data.Oe.toString(),null,null,null);let ed=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Sb.data.Oe,"UnifiedConsent.ConsentGetFailed");Ca(this.Wka(ed,Sb))}else{var Cc=P(Sb.data.Wd);if(Cc)la(Cc);else{this.YS.a$("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);let ed=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");Ca(this.Wka(ed,Sb))}}}catch(ed){this.YS.a$("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Cc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ed,"UnifiedConsent.ConsentGetFailed"),Ca(this.Wka(Cc,Sb))}},Sb=>{this.YS.a$("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Sb.data.Oe.toString(),null,null,null);const Cc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Sb.data.Oe,"UnifiedConsent.ConsentGetFailed");Ca(this.Wka(Cc,Sb))},null,void 0,void 0,2500,Ta)})}Wka(u,P){const la=new Dr;la.message=u;la.Iv=P&&P.data?P.data.Oe:-1;return la}Lbe(u){const P={};P["Accept-Language"]=this.zQa.consentLanguage;P.consentsurface="AppStart";P.platform="Web";P.formfactor=yd.a.Sbc?"Mobile":"Desktop";P["x-Cid"]=this.zQa.correlationId;P.Authorization="Bearer "+u;return P}}Object(r.a)(At,"HttpRequestToPromiseUtility",null,[]);class rm{constructor(){this.accountType="MSA";this.modelType=
null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(r.a)(rm,"WebSdkAdapterProps",null,[]);class Jm{constructor(u,P,la,Ca){this.dkf=this.KAa=this.qia=this.pca=null;this.uob=Ca;this.Ma=u;this.nXh=la;this.ji=P;this.zQa=this.VVc();this.YS=new Zn(this.zQa)}Vzl(){"MSA"===(this.Ma.Ha("HostAuthType")||
"").toUpperCase()&&Uo.RTa(this.zQa.userId,this.Ma.uc("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.YS.a$(Jm.j5a,"CacheFound","701",this.pca,this.qia,this.KAa);return{}}).catch(()=>{this.nXh.execute(u=>{u.mI("Consent",Jm.zai).then(P=>{P.IsSuccess?(this.YS.a$(Jm.j5a,"CheckInTokenSuccess","702",this.pca,this.qia,this.KAa),this.Dgj(P.Token).then(la=>{this.Uoj(la);this.pca&&""!==this.pca&&u.mI("Consent",Jm.Bai).then(Ca=>{Ca.IsSuccess?(this.YS.a$(Jm.j5a,"WebTokenSuccess","703",this.pca,this.qia,this.KAa),
this.oBl(Ca,this.pca)):this.YS.a$(Jm.j5a,"WebTokenFailed : "+Ca.ErrorMessage,Ca.ErrorCode,this.pca,this.qia,this.KAa);return{}});return{}})):this.YS.a$(Jm.j5a,"CheckInTokenFailed : "+P.ErrorMessage,P.ErrorCode,this.pca,this.qia,this.KAa);return{}})})})}Dgj(u){this.dkf=new At(this.Ma,this.ji,this.zQa);return this.dkf.H3b(u,Object(z.a)(this,this.PQk,"parseConsentCheckinState")).then(P=>Promise.resolve(P),P=>Promise.reject("Error while getting result"+P))}PQk(u){if(void 0===u||null===u)return this.YS.a$(Jm.j5a,
"Checkin response undefined or null","705",this.pca,this.qia,this.KAa),null;try{let P;({Su:P}=Hd.d(u));return P}catch(P){this.YS.a$(Jm.j5a,"Checkin response parse error : "+P.message,"706",this.pca,this.qia,this.KAa)}return null}Uoj(u){for(const P of u.consentValues)if(P.needConsent&&!P.maxPromptsReached){this.qia=P.id;this.KAa=P.consentType;this.pca=P.modelType;return}Uo.vGl(this.zQa.userId,Hd.c(u))}oBl(u,P){if(Ad.a("showConsentNotice")){const la=document.createElement("div");document.body.appendChild(la);
appChrome.api.showConsentNotice(this.Xij(u.Token,P),la)}else this.YS.a$(Jm.f4h,"1JS : ShowConsentNotice API not found","704",this.pca,this.qia,this.KAa)}Xij(u,P){const la=this.zQa;la.token=u;la.modelType=P;return la}VVc(){const u=this.sje(this.Ma.Ha("SessionStartInfoJson"));return Object.assign(new rm,{emailId:this.Ma.Ha("UserPrincipalName"),userId:this.Ma.Ha("LoggableUserId"),accountType:"AAD"===(this.Ma.Ha("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ma.Ha("OfficeApplicationId"),appVersion:this.Ma.Ha("appVersion"),
appName:"Application"in u?u.Application:"",appEnv:this.uob,consentLanguage:this.Ma.Ha("UICulture")||"en-US",formFactor:yd.a.Sbc?"Mobile":"Desktop",os:"Os"in u?u.Os:"",osVersion:"OsVersion"in u?u.OsVersion:"",region:this.Ma.Ha("region"),correlationId:bi.a.create().toString(),isDarkMode:this.Ma.ka("DarkModeIsOn"),useCache:!0})}sje(u){let P={};try{P=Hd.b(u)}catch(la){}return P}}Jm.Bai="https://consentservice.microsoft.com/web";Jm.zai="https://consentservice.microsoft.com/checkin";Jm.f4h="UnifiedConsent.ConsentGetFailed";
Jm.j5a="UnifiedConsent.AuthTokenStatus";Object(r.a)(Jm,"ConsentNoticeManager",null,[971]);class kf{constructor(){this.Ea=null}get name(){return"Common.App.ConsentNoticeDialog"}Xb(u){this.Ea=u;u.register(Jm,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").na().oa(()=>new Jm(t.AFrameworkApplication.fa,t.AFrameworkApplication.Je,u.Ia("Common.App.OAuth.IOAuthManager"),t.AFrameworkApplication.dTa))}init(){this.Ea.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){m.a.instance.Ac(new kf)}}
Object(r.a)(kf,"ConsentNoticeDialogPackage",null,[2,3]);var Er=d(13);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");
Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");
Type.registerNamespace("PowerPointWebEditor.VersionHistory");Object(Er.c)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");Ka.main();Kb.main();af.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");Sd.main();Type.registerNamespace("Common.App.DirectPrint");m.a.instance.Ac(new zd);Type.registerNamespace("Common.App.DisplayEnvironmentName");re.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");
Ae.main();Type.registerNamespace("Common.App.NewAndOpen.UX");m.a.instance.Ac(new Xg);Type.registerNamespace("Common.App.OneDriveFilePickerApi");yi.main();Type.registerNamespace("Common.App.PenMinutesManager");Cj.main();Type.registerNamespace("Common.App.SaveAsToHost");rg.main();Type.registerNamespace("Common.App.SaveToSharePoint");Xi.main();Type.registerNamespace("Common.App.SaveToCloudStorage");jd.main();Type.registerNamespace("Common.App.SaveACopy");Jb.main();Type.registerNamespace("Common.App.PhoneLink");
ne.main();Type.registerNamespace("Common.App.SharedFilePicker");vd.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");Dd.main();Type.registerNamespace("Common.App.WopiIdentity");ek.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");kf.main();th.main();An.main();Sn.main();Gl.main();jf.main();ll.main();m.a.instance.Ac(uc.a(new wp,0));
Yp.main();Type.registerNamespace("Common.App.LivePersonaUtils");Yq.main();tq.main();Object(Er.b)("Chronos2")},345:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.none=null;h.xFi="CoAuth";h.vie="IdeasPaneClosed";h.uBk="MultiSlidesSelected";h.Jkb="Retrigger";h.Vsd="SessionEnded";h.onl="SessionRehydrated";h.slideNavigation="SlideNavigation";h.PPb="SuggestionPaneClosed";h.Bwd="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";h.dSb="WebActionId:";h.A9k="Rehydrated";
h.SVf="DisallowedRequest";h.bNf="CloseSecondPane";h.UNk="OpenEditorPane";Object(K.a)(h,"DesignerResetReason",null,[])},346:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.GJa="NoResult";Object(K.a)(h,"ProviderResultStatus",null,[])},390:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=-1]="notSupported";e[e.OMEX=0]="OMEX";e[e.spCatalog=1]="spCatalog";e[e.spApp=2]=
"spApp";e[e.fileSystem=3]="fileSystem";e[e.exchange=4]="exchange";e[e.oneDrive=5]="oneDrive";e[e.registry=6]="registry";e[e.inMemory=7]="inMemory";e[e.uploadFileDevCatalog=8]="uploadFileDevCatalog";e[e.hardCodedPreinstall=9]="hardCodedPreinstall";e[e.privateCatalog=10]="privateCatalog";e[e.wopiCatalog=16]="wopiCatalog"})(h||(h={}));Object(K.b)("AddinProviderType",h)},400:function(K,S,d){K=d(0);class h{static Apj(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(K.a)(h,"EventReceiverIdCounter",
null,[]);d.d(S,"a",function(){return e});class e{constructor(r,m){this.R_h=r;this._id=h.Apj();this.Q8h=m}get id(){return this._id}notify(r,m){this.Q8h(r,m)}Yda(r,m){return this.R_h.o_k(r,m?this:null)}}Object(K.a)(e,"EventReceiver",null,[880])},453:function(K,S,d){d.d(S,"a",function(){return r});K=d(0);var h=d(395),e=d(201);class r{static yDh(m){return parseInt(r.vnb(e.a.WUd,m)||"-1")<=(new Date).getTime()}static y$d(m){return parseInt(r.vnb(e.a.F7a,m)||"-1")}static bhe(m){return Boolean.parse(r.vnb(e.a.jKc,
m)||"false")}static vnb(m,n){let z=null;try{const t=r.rab();if(void 0!==t&&t){const x=e.a.PUc(m)+n;z=t.getItem(x)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(t){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",m,n)}return z}static fxc(m,n,z){try{const t=r.rab();if(void 0!==t&&t){const x=e.a.PUc(m)+z;t.setItem(x,n)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(t){h.ULS.sendTraceTag(42074648,
220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",m,z)}}static rab(){if(!r.hVa)return null;let m=null;try{m=localStorage}catch(n){r.hVa=!1,m=null}return m}}r.hVa=!0;Object(K.a)(r,"AddinUtil",null,[])},548:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";
e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(K.b)("AddinCommandsLaunchOperationType",h)},549:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"OnlineMediaSearchResult",null,[])},550:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(e,r){this.Bqk=e;this.qtk=r}get f3c(){return this.Bqk}get Ofl(){return this.qtk}}Object(K.a)(h,
"ReportSuggestionSessionActionData",null,[])},551:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}h.YXf="Provider.UCI.Editor";h.RXf="EntityGroup.UCI.Editor";h.iGh="Provider.Designer.Slide";h.hGh="EntityGroup.Designer.Slide.Suggestion";h.sGh="Provider.Designer.TextToSmartArt";h.rGh="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(K.a)(h,"InfraredConstant",null,[])},716:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{}Object(K.a)(h,"ProviderActionInfo",null,[])},
717:function(K,S,d){d.d(S,"a",function(){return h});K=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(K.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20445724/wdjs/ppteditDS.chronos2.js.map